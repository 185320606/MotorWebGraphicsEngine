define(["exports","./when-7ef6387a","./Check-ed6a1804","./Math-85667bf9","./Cartesian3-2a8ef78e","./Ellipsoid-367a1bb3","./Transforms-2448ecca","./Cartesian2-dcadeea9","./ComponentDatatype-a863af81","./GeometryAttribute-a3332dc3","./PrimitiveType-4c1d698a","./GeometryAttributes-cb18da36","./IndexDatatype-f12d39b5","./GeometryOffsetAttribute-5cfc2755","./VertexFormat-d75df48f"],(function(e,t,a,r,i,n,o,m,s,u,l,f,d,c,p){"use strict";var C=new i.Cartesian3,y=new i.Cartesian3,h=new i.Cartesian3,v=new i.Cartesian3,_=new i.Cartesian3,A=new i.Cartesian3(1,1,1),x=Math.cos,b=Math.sin;function w(e){e=t.defaultValue(e,t.defaultValue.EMPTY_OBJECT);var n=t.defaultValue(e.radii,A),o=t.defaultValue(e.innerRadii,n),m=t.defaultValue(e.minimumClock,0),s=t.defaultValue(e.maximumClock,r.CesiumMath.TWO_PI),u=t.defaultValue(e.minimumCone,0),l=t.defaultValue(e.maximumCone,r.CesiumMath.PI),f=Math.round(t.defaultValue(e.stackPartitions,64)),d=Math.round(t.defaultValue(e.slicePartitions,64)),c=t.defaultValue(e.vertexFormat,p.VertexFormat.DEFAULT);if(d<3)throw new a.DeveloperError("options.slicePartitions cannot be less than three.");if(f<3)throw new a.DeveloperError("options.stackPartitions cannot be less than three.");this._radii=i.Cartesian3.clone(n),this._innerRadii=i.Cartesian3.clone(o),this._minimumClock=m,this._maximumClock=s,this._minimumCone=u,this._maximumCone=l,this._stackPartitions=f,this._slicePartitions=d,this._vertexFormat=p.VertexFormat.clone(c),this._offsetAttribute=e.offsetAttribute,this._workerName="createEllipsoidGeometry"}w.packedLength=2*i.Cartesian3.packedLength+p.VertexFormat.packedLength+7,w.pack=function(e,r,n){if(!t.defined(e))throw new a.DeveloperError("value is required");if(!t.defined(r))throw new a.DeveloperError("array is required");return n=t.defaultValue(n,0),i.Cartesian3.pack(e._radii,r,n),n+=i.Cartesian3.packedLength,i.Cartesian3.pack(e._innerRadii,r,n),n+=i.Cartesian3.packedLength,p.VertexFormat.pack(e._vertexFormat,r,n),n+=p.VertexFormat.packedLength,r[n++]=e._minimumClock,r[n++]=e._maximumClock,r[n++]=e._minimumCone,r[n++]=e._maximumCone,r[n++]=e._stackPartitions,r[n++]=e._slicePartitions,r[n]=t.defaultValue(e._offsetAttribute,-1),r};var k,P=new i.Cartesian3,F=new i.Cartesian3,g=new p.VertexFormat,V={radii:P,innerRadii:F,vertexFormat:g,minimumClock:void 0,maximumClock:void 0,minimumCone:void 0,maximumCone:void 0,stackPartitions:void 0,slicePartitions:void 0,offsetAttribute:void 0};w.unpack=function(e,r,n){if(!t.defined(e))throw new a.DeveloperError("array is required");r=t.defaultValue(r,0);var o=i.Cartesian3.unpack(e,r,P);r+=i.Cartesian3.packedLength;var m=i.Cartesian3.unpack(e,r,F);r+=i.Cartesian3.packedLength;var s=p.VertexFormat.unpack(e,r,g);r+=p.VertexFormat.packedLength;var u=e[r++],l=e[r++],f=e[r++],d=e[r++],c=e[r++],C=e[r++],y=e[r];return t.defined(n)?(n._radii=i.Cartesian3.clone(o,n._radii),n._innerRadii=i.Cartesian3.clone(m,n._innerRadii),n._vertexFormat=p.VertexFormat.clone(s,n._vertexFormat),n._minimumClock=u,n._maximumClock=l,n._minimumCone=f,n._maximumCone=d,n._stackPartitions=c,n._slicePartitions=C,n._offsetAttribute=-1===y?void 0:y,n):(V.minimumClock=u,V.maximumClock=l,V.minimumCone=f,V.maximumCone=d,V.stackPartitions=c,V.slicePartitions=C,V.offsetAttribute=-1===y?void 0:y,new w(V))},w.createGeometry=function(e){var a=e._radii;if(!(a.x<=0||a.y<=0||a.z<=0)){var p=e._innerRadii;if(!(p.x<=0||p.y<=0||p.z<=0)){var A,w,k=e._minimumClock,P=e._maximumClock,F=e._minimumCone,g=e._maximumCone,V=e._vertexFormat,D=e._slicePartitions+1,T=e._stackPartitions+1;(D=Math.round(D*Math.abs(P-k)/r.CesiumMath.TWO_PI))<2&&(D=2),(T=Math.round(T*Math.abs(g-F)/r.CesiumMath.PI))<2&&(T=2);var E=0,M=[F],G=[k];for(A=0;A<T;A++)M.push(F+A*(g-F)/(T-1));for(M.push(g),w=0;w<D;w++)G.push(k+w*(P-k)/(D-1));G.push(P);var L=M.length,O=G.length,I=0,z=1,N=p.x!==a.x||p.y!==a.y||p.z!==a.z,R=!1,U=!1,S=!1;N&&(z=2,F>0&&(R=!0,I+=D-1),g<Math.PI&&(U=!0,I+=D-1),(P-k)%r.CesiumMath.TWO_PI?(S=!0,I+=2*(T-1)+1):I+=1);var B=O*L*z,W=new Float64Array(3*B),q=c.arrayFill(new Array(B),!1),Y=c.arrayFill(new Array(B),!1),J=D*T*z,X=6*(J+I+1-(D+T)*z),Z=d.IndexDatatype.createTypedArray(J,X),j=V.normal?new Float32Array(3*B):void 0,H=V.tangent?new Float32Array(3*B):void 0,K=V.bitangent?new Float32Array(3*B):void 0,Q=V.st?new Float32Array(2*B):void 0,$=new Array(L),ee=new Array(L);for(A=0;A<L;A++)$[A]=b(M[A]),ee[A]=x(M[A]);var te=new Array(O),ae=new Array(O);for(w=0;w<O;w++)ae[w]=x(G[w]),te[w]=b(G[w]);for(A=0;A<L;A++)for(w=0;w<O;w++)W[E++]=a.x*$[A]*ae[w],W[E++]=a.y*$[A]*te[w],W[E++]=a.z*ee[A];var re,ie,ne,oe,me=B/2;if(N)for(A=0;A<L;A++)for(w=0;w<O;w++)W[E++]=p.x*$[A]*ae[w],W[E++]=p.y*$[A]*te[w],W[E++]=p.z*ee[A],q[me]=!0,A>0&&A!==L-1&&0!==w&&w!==O-1&&(Y[me]=!0),me++;for(E=0,A=1;A<L-2;A++)for(re=A*O,ie=(A+1)*O,w=1;w<O-2;w++)Z[E++]=ie+w,Z[E++]=ie+w+1,Z[E++]=re+w+1,Z[E++]=ie+w,Z[E++]=re+w+1,Z[E++]=re+w;if(N){var se=L*O;for(A=1;A<L-2;A++)for(re=se+A*O,ie=se+(A+1)*O,w=1;w<O-2;w++)Z[E++]=ie+w,Z[E++]=re+w,Z[E++]=re+w+1,Z[E++]=ie+w,Z[E++]=re+w+1,Z[E++]=ie+w+1}if(N){if(R)for(oe=L*O,A=1;A<O-2;A++)Z[E++]=A,Z[E++]=A+1,Z[E++]=oe+A+1,Z[E++]=A,Z[E++]=oe+A+1,Z[E++]=oe+A;if(U)for(ne=L*O-O,oe=L*O*z-O,A=1;A<O-2;A++)Z[E++]=ne+A+1,Z[E++]=ne+A,Z[E++]=oe+A,Z[E++]=ne+A+1,Z[E++]=oe+A,Z[E++]=oe+A+1}if(S){for(A=1;A<L-2;A++)oe=O*L+O*A,ne=O*A,Z[E++]=oe,Z[E++]=ne+O,Z[E++]=ne,Z[E++]=oe,Z[E++]=oe+O,Z[E++]=ne+O;for(A=1;A<L-2;A++)oe=O*L+O*(A+1)-1,ne=O*(A+1)-1,Z[E++]=ne+O,Z[E++]=oe,Z[E++]=ne,Z[E++]=ne+O,Z[E++]=oe+O,Z[E++]=oe}var ue=new f.GeometryAttributes;V.position&&(ue.position=new u.GeometryAttribute({componentDatatype:s.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:W}));var le,fe=0,de=0,ce=0,pe=0,Ce=B/2,ye=n.Ellipsoid.fromCartesian3(a),he=n.Ellipsoid.fromCartesian3(p);if(V.st||V.normal||V.tangent||V.bitangent){for(A=0;A<B;A++){le=q[A]?he:ye;var ve=i.Cartesian3.fromArray(W,3*A,C),_e=le.geodeticSurfaceNormal(ve,y);if(Y[A]&&i.Cartesian3.negate(_e,_e),V.st){var Ae=m.Cartesian2.negate(_e,_);Q[fe++]=Math.atan2(Ae.y,Ae.x)/r.CesiumMath.TWO_PI+.5,Q[fe++]=Math.asin(_e.z)/Math.PI+.5}if(V.normal&&(j[de++]=_e.x,j[de++]=_e.y,j[de++]=_e.z),V.tangent||V.bitangent){var xe,be=h,we=0;if(q[A]&&(we=Ce),xe=!R&&A>=we&&A<we+2*O?i.Cartesian3.UNIT_X:i.Cartesian3.UNIT_Z,i.Cartesian3.cross(xe,_e,be),i.Cartesian3.normalize(be,be),V.tangent&&(H[ce++]=be.x,H[ce++]=be.y,H[ce++]=be.z),V.bitangent){var ke=i.Cartesian3.cross(_e,be,v);i.Cartesian3.normalize(ke,ke),K[pe++]=ke.x,K[pe++]=ke.y,K[pe++]=ke.z}}}V.st&&(ue.st=new u.GeometryAttribute({componentDatatype:s.ComponentDatatype.FLOAT,componentsPerAttribute:2,values:Q})),V.normal&&(ue.normal=new u.GeometryAttribute({componentDatatype:s.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:j})),V.tangent&&(ue.tangent=new u.GeometryAttribute({componentDatatype:s.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:H})),V.bitangent&&(ue.bitangent=new u.GeometryAttribute({componentDatatype:s.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:K}))}if(t.defined(e._offsetAttribute)){var Pe=W.length,Fe=new Uint8Array(Pe/3),ge=e._offsetAttribute===c.GeometryOffsetAttribute.NONE?0:1;c.arrayFill(Fe,ge),ue.applyOffset=new u.GeometryAttribute({componentDatatype:s.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:Fe})}return new u.Geometry({attributes:ue,indices:Z,primitiveType:l.PrimitiveType.TRIANGLES,boundingSphere:o.BoundingSphere.fromEllipsoid(ye),offsetAttribute:e._offsetAttribute})}}},w.getUnitEllipsoid=function(){return t.defined(k)||(k=w.createGeometry(new w({radii:new i.Cartesian3(1,1,1),vertexFormat:p.VertexFormat.POSITION_ONLY}))),k},e.EllipsoidGeometry=w}));
//# sourceMappingURL=EllipsoidGeometry-4b95ec58.js.map
