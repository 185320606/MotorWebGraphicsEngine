define(["exports","./when-7ef6387a","./DeveloperError-101d8eb9","./Cartesian3-ca5d3f12","./Ellipsoid-57478151","./Transforms-7a1c9ee7","./Cartesian2-d6edb867","./ComponentDatatype-f4fabeaa","./GeometryAttribute-c5b9902a","./PrimitiveType-4c1d698a","./GeometryAttributes-cb18da36","./IndexDatatype-bfeda8ca","./GeometryOffsetAttribute-19130c81","./VertexFormat-64d8e6c6"],(function(e,t,a,r,i,n,o,m,s,u,l,f,d,c){"use strict";var p=new r.Cartesian3,C=new r.Cartesian3,y=new r.Cartesian3,v=new r.Cartesian3,h=new r.Cartesian3,_=new r.Cartesian3(1,1,1),A=Math.cos,x=Math.sin;function b(e){e=t.defaultValue(e,t.defaultValue.EMPTY_OBJECT);var i=t.defaultValue(e.radii,_),n=t.defaultValue(e.innerRadii,i),o=t.defaultValue(e.minimumClock,0),m=t.defaultValue(e.maximumClock,r.CesiumMath.TWO_PI),s=t.defaultValue(e.minimumCone,0),u=t.defaultValue(e.maximumCone,r.CesiumMath.PI),l=Math.round(t.defaultValue(e.stackPartitions,64)),f=Math.round(t.defaultValue(e.slicePartitions,64)),d=t.defaultValue(e.vertexFormat,c.VertexFormat.DEFAULT);if(f<3)throw new a.DeveloperError("options.slicePartitions cannot be less than three.");if(l<3)throw new a.DeveloperError("options.stackPartitions cannot be less than three.");this._radii=r.Cartesian3.clone(i),this._innerRadii=r.Cartesian3.clone(n),this._minimumClock=o,this._maximumClock=m,this._minimumCone=s,this._maximumCone=u,this._stackPartitions=l,this._slicePartitions=f,this._vertexFormat=c.VertexFormat.clone(d),this._offsetAttribute=e.offsetAttribute,this._workerName="createEllipsoidGeometry"}b.packedLength=2*r.Cartesian3.packedLength+c.VertexFormat.packedLength+7,b.pack=function(e,i,n){if(!t.defined(e))throw new a.DeveloperError("value is required");if(!t.defined(i))throw new a.DeveloperError("array is required");return n=t.defaultValue(n,0),r.Cartesian3.pack(e._radii,i,n),n+=r.Cartesian3.packedLength,r.Cartesian3.pack(e._innerRadii,i,n),n+=r.Cartesian3.packedLength,c.VertexFormat.pack(e._vertexFormat,i,n),n+=c.VertexFormat.packedLength,i[n++]=e._minimumClock,i[n++]=e._maximumClock,i[n++]=e._minimumCone,i[n++]=e._maximumCone,i[n++]=e._stackPartitions,i[n++]=e._slicePartitions,i[n]=t.defaultValue(e._offsetAttribute,-1),i};var w,k=new r.Cartesian3,P=new r.Cartesian3,F=new c.VertexFormat,g={radii:k,innerRadii:P,vertexFormat:F,minimumClock:void 0,maximumClock:void 0,minimumCone:void 0,maximumCone:void 0,stackPartitions:void 0,slicePartitions:void 0,offsetAttribute:void 0};b.unpack=function(e,i,n){if(!t.defined(e))throw new a.DeveloperError("array is required");i=t.defaultValue(i,0);var o=r.Cartesian3.unpack(e,i,k);i+=r.Cartesian3.packedLength;var m=r.Cartesian3.unpack(e,i,P);i+=r.Cartesian3.packedLength;var s=c.VertexFormat.unpack(e,i,F);i+=c.VertexFormat.packedLength;var u=e[i++],l=e[i++],f=e[i++],d=e[i++],p=e[i++],C=e[i++],y=e[i];return t.defined(n)?(n._radii=r.Cartesian3.clone(o,n._radii),n._innerRadii=r.Cartesian3.clone(m,n._innerRadii),n._vertexFormat=c.VertexFormat.clone(s,n._vertexFormat),n._minimumClock=u,n._maximumClock=l,n._minimumCone=f,n._maximumCone=d,n._stackPartitions=p,n._slicePartitions=C,n._offsetAttribute=-1===y?void 0:y,n):(g.minimumClock=u,g.maximumClock=l,g.minimumCone=f,g.maximumCone=d,g.stackPartitions=p,g.slicePartitions=C,g.offsetAttribute=-1===y?void 0:y,new b(g))},b.createGeometry=function(e){var a=e._radii;if(!(a.x<=0||a.y<=0||a.z<=0)){var c=e._innerRadii;if(!(c.x<=0||c.y<=0||c.z<=0)){var _,b,w=e._minimumClock,k=e._maximumClock,P=e._minimumCone,F=e._maximumCone,g=e._vertexFormat,V=e._slicePartitions+1,D=e._stackPartitions+1;(V=Math.round(V*Math.abs(k-w)/r.CesiumMath.TWO_PI))<2&&(V=2),(D=Math.round(D*Math.abs(F-P)/r.CesiumMath.PI))<2&&(D=2);var E=0,T=[P],M=[w];for(_=0;_<D;_++)T.push(P+_*(F-P)/(D-1));for(T.push(F),b=0;b<V;b++)M.push(w+b*(k-w)/(V-1));M.push(k);var G=T.length,L=M.length,O=0,I=1,z=c.x!==a.x||c.y!==a.y||c.z!==a.z,N=!1,R=!1,U=!1;z&&(I=2,P>0&&(N=!0,O+=V-1),F<Math.PI&&(R=!0,O+=V-1),(k-w)%r.CesiumMath.TWO_PI?(U=!0,O+=2*(D-1)+1):O+=1);var S=L*G*I,B=new Float64Array(3*S),W=d.arrayFill(new Array(S),!1),q=d.arrayFill(new Array(S),!1),Y=V*D*I,J=6*(Y+O+1-(V+D)*I),X=f.IndexDatatype.createTypedArray(Y,J),Z=g.normal?new Float32Array(3*S):void 0,j=g.tangent?new Float32Array(3*S):void 0,H=g.bitangent?new Float32Array(3*S):void 0,K=g.st?new Float32Array(2*S):void 0,Q=new Array(G),$=new Array(G);for(_=0;_<G;_++)Q[_]=x(T[_]),$[_]=A(T[_]);var ee=new Array(L),te=new Array(L);for(b=0;b<L;b++)te[b]=A(M[b]),ee[b]=x(M[b]);for(_=0;_<G;_++)for(b=0;b<L;b++)B[E++]=a.x*Q[_]*te[b],B[E++]=a.y*Q[_]*ee[b],B[E++]=a.z*$[_];var ae,re,ie,ne,oe=S/2;if(z)for(_=0;_<G;_++)for(b=0;b<L;b++)B[E++]=c.x*Q[_]*te[b],B[E++]=c.y*Q[_]*ee[b],B[E++]=c.z*$[_],W[oe]=!0,_>0&&_!==G-1&&0!==b&&b!==L-1&&(q[oe]=!0),oe++;for(E=0,_=1;_<G-2;_++)for(ae=_*L,re=(_+1)*L,b=1;b<L-2;b++)X[E++]=re+b,X[E++]=re+b+1,X[E++]=ae+b+1,X[E++]=re+b,X[E++]=ae+b+1,X[E++]=ae+b;if(z){var me=G*L;for(_=1;_<G-2;_++)for(ae=me+_*L,re=me+(_+1)*L,b=1;b<L-2;b++)X[E++]=re+b,X[E++]=ae+b,X[E++]=ae+b+1,X[E++]=re+b,X[E++]=ae+b+1,X[E++]=re+b+1}if(z){if(N)for(ne=G*L,_=1;_<L-2;_++)X[E++]=_,X[E++]=_+1,X[E++]=ne+_+1,X[E++]=_,X[E++]=ne+_+1,X[E++]=ne+_;if(R)for(ie=G*L-L,ne=G*L*I-L,_=1;_<L-2;_++)X[E++]=ie+_+1,X[E++]=ie+_,X[E++]=ne+_,X[E++]=ie+_+1,X[E++]=ne+_,X[E++]=ne+_+1}if(U){for(_=1;_<G-2;_++)ne=L*G+L*_,ie=L*_,X[E++]=ne,X[E++]=ie+L,X[E++]=ie,X[E++]=ne,X[E++]=ne+L,X[E++]=ie+L;for(_=1;_<G-2;_++)ne=L*G+L*(_+1)-1,ie=L*(_+1)-1,X[E++]=ie+L,X[E++]=ne,X[E++]=ie,X[E++]=ie+L,X[E++]=ne+L,X[E++]=ne}var se=new l.GeometryAttributes;g.position&&(se.position=new s.GeometryAttribute({componentDatatype:m.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:B}));var ue,le=0,fe=0,de=0,ce=0,pe=S/2,Ce=i.Ellipsoid.fromCartesian3(a),ye=i.Ellipsoid.fromCartesian3(c);if(g.st||g.normal||g.tangent||g.bitangent){for(_=0;_<S;_++){ue=W[_]?ye:Ce;var ve=r.Cartesian3.fromArray(B,3*_,p),he=ue.geodeticSurfaceNormal(ve,C);if(q[_]&&r.Cartesian3.negate(he,he),g.st){var _e=o.Cartesian2.negate(he,h);K[le++]=Math.atan2(_e.y,_e.x)/r.CesiumMath.TWO_PI+.5,K[le++]=Math.asin(he.z)/Math.PI+.5}if(g.normal&&(Z[fe++]=he.x,Z[fe++]=he.y,Z[fe++]=he.z),g.tangent||g.bitangent){var Ae,xe=y,be=0;if(W[_]&&(be=pe),Ae=!N&&_>=be&&_<be+2*L?r.Cartesian3.UNIT_X:r.Cartesian3.UNIT_Z,r.Cartesian3.cross(Ae,he,xe),r.Cartesian3.normalize(xe,xe),g.tangent&&(j[de++]=xe.x,j[de++]=xe.y,j[de++]=xe.z),g.bitangent){var we=r.Cartesian3.cross(he,xe,v);r.Cartesian3.normalize(we,we),H[ce++]=we.x,H[ce++]=we.y,H[ce++]=we.z}}}g.st&&(se.st=new s.GeometryAttribute({componentDatatype:m.ComponentDatatype.FLOAT,componentsPerAttribute:2,values:K})),g.normal&&(se.normal=new s.GeometryAttribute({componentDatatype:m.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:Z})),g.tangent&&(se.tangent=new s.GeometryAttribute({componentDatatype:m.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:j})),g.bitangent&&(se.bitangent=new s.GeometryAttribute({componentDatatype:m.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:H}))}if(t.defined(e._offsetAttribute)){var ke=B.length,Pe=new Uint8Array(ke/3),Fe=e._offsetAttribute===d.GeometryOffsetAttribute.NONE?0:1;d.arrayFill(Pe,Fe),se.applyOffset=new s.GeometryAttribute({componentDatatype:m.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:Pe})}return new s.Geometry({attributes:se,indices:X,primitiveType:u.PrimitiveType.TRIANGLES,boundingSphere:n.BoundingSphere.fromEllipsoid(Ce),offsetAttribute:e._offsetAttribute})}}},b.getUnitEllipsoid=function(){return t.defined(w)||(w=b.createGeometry(new b({radii:new r.Cartesian3(1,1,1),vertexFormat:c.VertexFormat.POSITION_ONLY}))),w},e.EllipsoidGeometry=b}));
//# sourceMappingURL=EllipsoidGeometry-af5b70c6.js.map
