define(["exports","./when-7ef6387a","./DeveloperError-101d8eb9","./Check-71521db1","./Cartesian3-ca5d3f12","./Ellipsoid-57478151","./Matrix4-027dd006","./RuntimeError-5b606d78","./Cartesian2-d6edb867","./FeatureDetection-c366f716"],(function(e,t,r,n,a,i,o,s,u,d){"use strict";function l(e){this._ellipsoid=t.defaultValue(e,i.Ellipsoid.WGS84),this._semimajorAxis=this._ellipsoid.maximumRadius,this._oneOverSemimajorAxis=1/this._semimajorAxis}Object.defineProperties(l.prototype,{ellipsoid:{get:function(){return this._ellipsoid}}}),l.prototype.project=function(e,r){var n=this._semimajorAxis,i=e.longitude*n,o=e.latitude*n,s=e.height;return t.defined(r)?(r.x=i,r.y=o,r.z=s,r):new a.Cartesian3(i,o,s)},l.prototype.unproject=function(e,n){if(!t.defined(e))throw new r.DeveloperError("cartesian is required");var a=this._oneOverSemimajorAxis,o=e.x*a,s=e.y*a,u=e.z;return t.defined(n)?(n.longitude=o,n.latitude=s,n.height=u,n):new i.Cartographic(o,s,u)};var c=Object.freeze({OUTSIDE:-1,INTERSECTING:0,INSIDE:1});function f(e,r){this.start=t.defaultValue(e,0),this.stop=t.defaultValue(r,0)}function h(e,r){this.center=a.Cartesian3.clone(t.defaultValue(e,a.Cartesian3.ZERO)),this.radius=t.defaultValue(r,0)}var p=new a.Cartesian3,m=new a.Cartesian3,y=new a.Cartesian3,C=new a.Cartesian3,v=new a.Cartesian3,w=new a.Cartesian3,g=new a.Cartesian3,O=new a.Cartesian3,x=new a.Cartesian3,E=new a.Cartesian3,_=new a.Cartesian3,b=new a.Cartesian3,q=4/3*a.CesiumMath.PI;h.fromPoints=function(e,r){if(t.defined(r)||(r=new h),!t.defined(e)||0===e.length)return r.center=a.Cartesian3.clone(a.Cartesian3.ZERO,r.center),r.radius=0,r;var n,i=a.Cartesian3.clone(e[0],g),o=a.Cartesian3.clone(i,p),s=a.Cartesian3.clone(i,m),u=a.Cartesian3.clone(i,y),d=a.Cartesian3.clone(i,C),l=a.Cartesian3.clone(i,v),c=a.Cartesian3.clone(i,w),f=e.length;for(n=1;n<f;n++){a.Cartesian3.clone(e[n],i);var q=i.x,D=i.y,S=i.z;q<o.x&&a.Cartesian3.clone(i,o),q>d.x&&a.Cartesian3.clone(i,d),D<s.y&&a.Cartesian3.clone(i,s),D>l.y&&a.Cartesian3.clone(i,l),S<u.z&&a.Cartesian3.clone(i,u),S>c.z&&a.Cartesian3.clone(i,c)}var R=a.Cartesian3.magnitudeSquared(a.Cartesian3.subtract(d,o,O)),M=a.Cartesian3.magnitudeSquared(a.Cartesian3.subtract(l,s,O)),T=a.Cartesian3.magnitudeSquared(a.Cartesian3.subtract(c,u,O)),A=o,I=d,P=R;M>P&&(P=M,A=s,I=l),T>P&&(P=T,A=u,I=c);var U=x;U.x=.5*(A.x+I.x),U.y=.5*(A.y+I.y),U.z=.5*(A.z+I.z);var j=a.Cartesian3.magnitudeSquared(a.Cartesian3.subtract(I,U,O)),k=Math.sqrt(j),N=E;N.x=o.x,N.y=s.y,N.z=u.z;var z=_;z.x=d.x,z.y=l.y,z.z=c.z;var F=a.Cartesian3.midpoint(N,z,b),B=0;for(n=0;n<f;n++){a.Cartesian3.clone(e[n],i);var V=a.Cartesian3.magnitude(a.Cartesian3.subtract(i,F,O));V>B&&(B=V);var L=a.Cartesian3.magnitudeSquared(a.Cartesian3.subtract(i,U,O));if(L>j){var W=Math.sqrt(L);j=(k=.5*(k+W))*k;var Y=W-k;U.x=(k*U.x+Y*i.x)/W,U.y=(k*U.y+Y*i.y)/W,U.z=(k*U.z+Y*i.z)/W}}return k<B?(a.Cartesian3.clone(U,r.center),r.radius=k):(a.Cartesian3.clone(F,r.center),r.radius=B),r},h.fromInstancePoints=function(e,r,n){if(t.defined(r)||(r=new h),!t.defined(e)||0===n)return r.center=a.Cartesian3.clone(a.Cartesian3.ZERO,r.center),r.radius=0,r;var i,o=a.Cartesian3.clone(e[0],g),s=a.Cartesian3.clone(o,p),u=a.Cartesian3.clone(o,m),d=a.Cartesian3.clone(o,y),l=a.Cartesian3.clone(o,C),c=a.Cartesian3.clone(o,v),f=a.Cartesian3.clone(o,w);for(i=1;i<n;i++){a.Cartesian3.clone(e[i],o);var q=o.x,D=o.y,S=o.z;q<s.x&&a.Cartesian3.clone(o,s),q>l.x&&a.Cartesian3.clone(o,l),D<u.y&&a.Cartesian3.clone(o,u),D>c.y&&a.Cartesian3.clone(o,c),S<d.z&&a.Cartesian3.clone(o,d),S>f.z&&a.Cartesian3.clone(o,f)}var R=a.Cartesian3.magnitudeSquared(a.Cartesian3.subtract(l,s,O)),M=a.Cartesian3.magnitudeSquared(a.Cartesian3.subtract(c,u,O)),T=a.Cartesian3.magnitudeSquared(a.Cartesian3.subtract(f,d,O)),A=s,I=l,P=R;M>P&&(P=M,A=u,I=c),T>P&&(P=T,A=d,I=f);var U=x;U.x=.5*(A.x+I.x),U.y=.5*(A.y+I.y),U.z=.5*(A.z+I.z);var j=a.Cartesian3.magnitudeSquared(a.Cartesian3.subtract(I,U,O)),k=Math.sqrt(j),N=E;N.x=s.x,N.y=u.y,N.z=d.z;var z=_;z.x=l.x,z.y=c.y,z.z=f.z;var F=a.Cartesian3.midpoint(N,z,b),B=0;for(i=0;i<n;i++){a.Cartesian3.clone(e[i],o);var V=a.Cartesian3.magnitude(a.Cartesian3.subtract(o,F,O));V>B&&(B=V);var L=a.Cartesian3.magnitudeSquared(a.Cartesian3.subtract(o,U,O));if(L>j){var W=Math.sqrt(L);j=(k=.5*(k+W))*k;var Y=W-k;U.x=(k*U.x+Y*o.x)/W,U.y=(k*U.y+Y*o.y)/W,U.z=(k*U.z+Y*o.z)/W}}return k<B?(a.Cartesian3.clone(U,r.center),r.radius=k):(a.Cartesian3.clone(F,r.center),r.radius=B),r};var D=new l,S=new a.Cartesian3,R=new a.Cartesian3,M=new i.Cartographic,T=new i.Cartographic;h.fromRectangle2D=function(e,t,r){return h.fromRectangleWithHeights2D(e,t,0,0,r)},h.fromRectangleWithHeights2D=function(e,r,n,i,o){if(t.defined(o)||(o=new h),!t.defined(e))return o.center=a.Cartesian3.clone(a.Cartesian3.ZERO,o.center),o.radius=0,o;r=t.defaultValue(r,D),u.Rectangle.southwest(e,M),M.height=n,u.Rectangle.northeast(e,T),T.height=i;var s=r.project(M,S),d=r.project(T,R),l=d.x-s.x,c=d.y-s.y,f=d.z-s.z;o.radius=.5*Math.sqrt(l*l+c*c+f*f);var p=o.center;return p.x=s.x+.5*l,p.y=s.y+.5*c,p.z=s.z+.5*f,o};var A=[];h.fromRectangle3D=function(e,r,n,o){if(r=t.defaultValue(r,i.Ellipsoid.WGS84),n=t.defaultValue(n,0),t.defined(o)||(o=new h),!t.defined(e))return o.center=a.Cartesian3.clone(a.Cartesian3.ZERO,o.center),o.radius=0,o;var s=u.Rectangle.subsample(e,r,n,A);return h.fromPoints(s,o)},h.fromVertices=function(e,r,i,o){if(t.defined(o)||(o=new h),!t.defined(e)||0===e.length)return o.center=a.Cartesian3.clone(a.Cartesian3.ZERO,o.center),o.radius=0,o;r=t.defaultValue(r,a.Cartesian3.ZERO),i=t.defaultValue(i,3),n.Check.typeOf.number.greaterThanOrEquals("stride",i,3);var s=g;s.x=e[0]+r.x,s.y=e[1]+r.y,s.z=e[2]+r.z;var u,d=a.Cartesian3.clone(s,p),l=a.Cartesian3.clone(s,m),c=a.Cartesian3.clone(s,y),f=a.Cartesian3.clone(s,C),q=a.Cartesian3.clone(s,v),D=a.Cartesian3.clone(s,w),S=e.length;for(u=0;u<S;u+=i){var R=e[u]+r.x,M=e[u+1]+r.y,T=e[u+2]+r.z;s.x=R,s.y=M,s.z=T,R<d.x&&a.Cartesian3.clone(s,d),R>f.x&&a.Cartesian3.clone(s,f),M<l.y&&a.Cartesian3.clone(s,l),M>q.y&&a.Cartesian3.clone(s,q),T<c.z&&a.Cartesian3.clone(s,c),T>D.z&&a.Cartesian3.clone(s,D)}var A=a.Cartesian3.magnitudeSquared(a.Cartesian3.subtract(f,d,O)),I=a.Cartesian3.magnitudeSquared(a.Cartesian3.subtract(q,l,O)),P=a.Cartesian3.magnitudeSquared(a.Cartesian3.subtract(D,c,O)),U=d,j=f,k=A;I>k&&(k=I,U=l,j=q),P>k&&(k=P,U=c,j=D);var N=x;N.x=.5*(U.x+j.x),N.y=.5*(U.y+j.y),N.z=.5*(U.z+j.z);var z=a.Cartesian3.magnitudeSquared(a.Cartesian3.subtract(j,N,O)),F=Math.sqrt(z),B=E;B.x=d.x,B.y=l.y,B.z=c.z;var V=_;V.x=f.x,V.y=q.y,V.z=D.z;var L=a.Cartesian3.midpoint(B,V,b),W=0;for(u=0;u<S;u+=i){s.x=e[u]+r.x,s.y=e[u+1]+r.y,s.z=e[u+2]+r.z;var Y=a.Cartesian3.magnitude(a.Cartesian3.subtract(s,L,O));Y>W&&(W=Y);var H=a.Cartesian3.magnitudeSquared(a.Cartesian3.subtract(s,N,O));if(H>z){var J=Math.sqrt(H);z=(F=.5*(F+J))*F;var X=J-F;N.x=(F*N.x+X*s.x)/J,N.y=(F*N.y+X*s.y)/J,N.z=(F*N.z+X*s.z)/J}}return F<W?(a.Cartesian3.clone(N,o.center),o.radius=F):(a.Cartesian3.clone(L,o.center),o.radius=W),o},h.fromEncodedCartesianVertices=function(e,r,n){if(t.defined(n)||(n=new h),!t.defined(e)||!t.defined(r)||e.length!==r.length||0===e.length)return n.center=a.Cartesian3.clone(a.Cartesian3.ZERO,n.center),n.radius=0,n;var i=g;i.x=e[0]+r[0],i.y=e[1]+r[1],i.z=e[2]+r[2];var o,s=a.Cartesian3.clone(i,p),u=a.Cartesian3.clone(i,m),d=a.Cartesian3.clone(i,y),l=a.Cartesian3.clone(i,C),c=a.Cartesian3.clone(i,v),f=a.Cartesian3.clone(i,w),q=e.length;for(o=0;o<q;o+=3){var D=e[o]+r[o],S=e[o+1]+r[o+1],R=e[o+2]+r[o+2];i.x=D,i.y=S,i.z=R,D<s.x&&a.Cartesian3.clone(i,s),D>l.x&&a.Cartesian3.clone(i,l),S<u.y&&a.Cartesian3.clone(i,u),S>c.y&&a.Cartesian3.clone(i,c),R<d.z&&a.Cartesian3.clone(i,d),R>f.z&&a.Cartesian3.clone(i,f)}var M=a.Cartesian3.magnitudeSquared(a.Cartesian3.subtract(l,s,O)),T=a.Cartesian3.magnitudeSquared(a.Cartesian3.subtract(c,u,O)),A=a.Cartesian3.magnitudeSquared(a.Cartesian3.subtract(f,d,O)),I=s,P=l,U=M;T>U&&(U=T,I=u,P=c),A>U&&(U=A,I=d,P=f);var j=x;j.x=.5*(I.x+P.x),j.y=.5*(I.y+P.y),j.z=.5*(I.z+P.z);var k=a.Cartesian3.magnitudeSquared(a.Cartesian3.subtract(P,j,O)),N=Math.sqrt(k),z=E;z.x=s.x,z.y=u.y,z.z=d.z;var F=_;F.x=l.x,F.y=c.y,F.z=f.z;var B=a.Cartesian3.midpoint(z,F,b),V=0;for(o=0;o<q;o+=3){i.x=e[o]+r[o],i.y=e[o+1]+r[o+1],i.z=e[o+2]+r[o+2];var L=a.Cartesian3.magnitude(a.Cartesian3.subtract(i,B,O));L>V&&(V=L);var W=a.Cartesian3.magnitudeSquared(a.Cartesian3.subtract(i,j,O));if(W>k){var Y=Math.sqrt(W);k=(N=.5*(N+Y))*N;var H=Y-N;j.x=(N*j.x+H*i.x)/Y,j.y=(N*j.y+H*i.y)/Y,j.z=(N*j.z+H*i.z)/Y}}return N<V?(a.Cartesian3.clone(j,n.center),n.radius=N):(a.Cartesian3.clone(B,n.center),n.radius=V),n},h.fromCornerPoints=function(e,r,i){n.Check.typeOf.object("corner",e),n.Check.typeOf.object("oppositeCorner",r),t.defined(i)||(i=new h);var o=a.Cartesian3.midpoint(e,r,i.center);return i.radius=a.Cartesian3.distance(o,r),i},h.fromEllipsoid=function(e,r){return n.Check.typeOf.object("ellipsoid",e),t.defined(r)||(r=new h),a.Cartesian3.clone(a.Cartesian3.ZERO,r.center),r.radius=e.maximumRadius,r};var I=new a.Cartesian3;h.fromBoundingSpheres=function(e,r){if(t.defined(r)||(r=new h),!t.defined(e)||0===e.length)return r.center=a.Cartesian3.clone(a.Cartesian3.ZERO,r.center),r.radius=0,r;var n=e.length;if(1===n)return h.clone(e[0],r);if(2===n)return h.union(e[0],e[1],r);var i,o=[];for(i=0;i<n;i++)o.push(e[i].center);var s=(r=h.fromPoints(o,r)).center,u=r.radius;for(i=0;i<n;i++){var d=e[i];u=Math.max(u,a.Cartesian3.distance(s,d.center,I)+d.radius)}return r.radius=u,r};var P=new a.Cartesian3,U=new a.Cartesian3,j=new a.Cartesian3;h.fromOrientedBoundingBox=function(e,r){n.Check.defined("orientedBoundingBox",e),t.defined(r)||(r=new h);var i=e.halfAxes,s=o.Matrix3.getColumn(i,0,P),u=o.Matrix3.getColumn(i,1,U),d=o.Matrix3.getColumn(i,2,j);return a.Cartesian3.add(s,u,s),a.Cartesian3.add(s,d,s),r.center=a.Cartesian3.clone(e.center,r.center),r.radius=a.Cartesian3.magnitude(s),r},h.clone=function(e,r){if(t.defined(e))return t.defined(r)?(r.center=a.Cartesian3.clone(e.center,r.center),r.radius=e.radius,r):new h(e.center,e.radius)},h.packedLength=4,h.pack=function(e,r,a){n.Check.typeOf.object("value",e),n.Check.defined("array",r),a=t.defaultValue(a,0);var i=e.center;return r[a++]=i.x,r[a++]=i.y,r[a++]=i.z,r[a]=e.radius,r},h.unpack=function(e,r,a){n.Check.defined("array",e),r=t.defaultValue(r,0),t.defined(a)||(a=new h);var i=a.center;return i.x=e[r++],i.y=e[r++],i.z=e[r++],a.radius=e[r],a};var k=new a.Cartesian3,N=new a.Cartesian3;h.union=function(e,r,i){n.Check.typeOf.object("left",e),n.Check.typeOf.object("right",r),t.defined(i)||(i=new h);var o=e.center,s=e.radius,u=r.center,d=r.radius,l=a.Cartesian3.subtract(u,o,k),c=a.Cartesian3.magnitude(l);if(s>=c+d)return e.clone(i),i;if(d>=c+s)return r.clone(i),i;var f=.5*(s+c+d),p=a.Cartesian3.multiplyByScalar(l,(-s+f)/c,N);return a.Cartesian3.add(p,o,p),a.Cartesian3.clone(p,i.center),i.radius=f,i};var z=new a.Cartesian3;h.expand=function(e,t,r){n.Check.typeOf.object("sphere",e),n.Check.typeOf.object("point",t),r=h.clone(e,r);var i=a.Cartesian3.magnitude(a.Cartesian3.subtract(t,r.center,z));return i>r.radius&&(r.radius=i),r},h.intersectPlane=function(e,t){n.Check.typeOf.object("sphere",e),n.Check.typeOf.object("plane",t);var r=e.center,i=e.radius,o=t.normal,s=a.Cartesian3.dot(o,r)+t.distance;return s<-i?c.OUTSIDE:s<i?c.INTERSECTING:c.INSIDE},h.transform=function(e,r,a){return n.Check.typeOf.object("sphere",e),n.Check.typeOf.object("transform",r),t.defined(a)||(a=new h),a.center=o.Matrix4.multiplyByPoint(r,e.center,a.center),a.radius=o.Matrix4.getMaximumScale(r)*e.radius,a};var F=new a.Cartesian3;h.distanceSquaredTo=function(e,t){n.Check.typeOf.object("sphere",e),n.Check.typeOf.object("cartesian",t);var r=a.Cartesian3.subtract(e.center,t,F);return a.Cartesian3.magnitudeSquared(r)-e.radius*e.radius},h.transformWithoutScale=function(e,r,a){return n.Check.typeOf.object("sphere",e),n.Check.typeOf.object("transform",r),t.defined(a)||(a=new h),a.center=o.Matrix4.multiplyByPoint(r,e.center,a.center),a.radius=e.radius,a};var B=new a.Cartesian3;h.computePlaneDistances=function(e,r,i,o){n.Check.typeOf.object("sphere",e),n.Check.typeOf.object("position",r),n.Check.typeOf.object("direction",i),t.defined(o)||(o=new f);var s=a.Cartesian3.subtract(e.center,r,B),u=a.Cartesian3.dot(i,s);return o.start=u-e.radius,o.stop=u+e.radius,o};for(var V=new a.Cartesian3,L=new a.Cartesian3,W=new a.Cartesian3,Y=new a.Cartesian3,H=new a.Cartesian3,J=new i.Cartographic,X=new Array(8),G=0;G<8;++G)X[G]=new a.Cartesian3;var Z=new l;function K(e,r,n,a){this.x=t.defaultValue(e,0),this.y=t.defaultValue(r,0),this.z=t.defaultValue(n,0),this.w=t.defaultValue(a,0)}h.projectTo2D=function(e,r,i){n.Check.typeOf.object("sphere",e);var o,s=(r=t.defaultValue(r,Z)).ellipsoid,u=e.center,d=e.radius;o=a.Cartesian3.equals(u,a.Cartesian3.ZERO)?a.Cartesian3.clone(a.Cartesian3.UNIT_X,V):s.geodeticSurfaceNormal(u,V);var l=a.Cartesian3.cross(a.Cartesian3.UNIT_Z,o,L);a.Cartesian3.normalize(l,l);var c=a.Cartesian3.cross(o,l,W);a.Cartesian3.normalize(c,c),a.Cartesian3.multiplyByScalar(o,d,o),a.Cartesian3.multiplyByScalar(c,d,c),a.Cartesian3.multiplyByScalar(l,d,l);var f=a.Cartesian3.negate(c,H),p=a.Cartesian3.negate(l,Y),m=X,y=m[0];a.Cartesian3.add(o,c,y),a.Cartesian3.add(y,l,y),y=m[1],a.Cartesian3.add(o,c,y),a.Cartesian3.add(y,p,y),y=m[2],a.Cartesian3.add(o,f,y),a.Cartesian3.add(y,p,y),y=m[3],a.Cartesian3.add(o,f,y),a.Cartesian3.add(y,l,y),a.Cartesian3.negate(o,o),y=m[4],a.Cartesian3.add(o,c,y),a.Cartesian3.add(y,l,y),y=m[5],a.Cartesian3.add(o,c,y),a.Cartesian3.add(y,p,y),y=m[6],a.Cartesian3.add(o,f,y),a.Cartesian3.add(y,p,y),y=m[7],a.Cartesian3.add(o,f,y),a.Cartesian3.add(y,l,y);for(var C=m.length,v=0;v<C;++v){var w=m[v];a.Cartesian3.add(u,w,w);var g=s.cartesianToCartographic(w,J);r.project(g,w)}var O=(u=(i=h.fromPoints(m,i)).center).x,x=u.y,E=u.z;return u.x=E,u.y=O,u.z=x,i},h.isOccluded=function(e,t){return n.Check.typeOf.object("sphere",e),n.Check.typeOf.object("occluder",t),!t.isBoundingSphereVisible(e)},h.equals=function(e,r){return e===r||t.defined(e)&&t.defined(r)&&a.Cartesian3.equals(e.center,r.center)&&e.radius===r.radius},h.prototype.intersectPlane=function(e){return h.intersectPlane(this,e)},h.prototype.distanceSquaredTo=function(e){return h.distanceSquaredTo(this,e)},h.prototype.computePlaneDistances=function(e,t,r){return h.computePlaneDistances(this,e,t,r)},h.prototype.isOccluded=function(e){return h.isOccluded(this,e)},h.prototype.equals=function(e){return h.equals(this,e)},h.prototype.clone=function(e){return h.clone(this,e)},h.prototype.volume=function(){var e=this.radius;return q*e*e*e};var Q=new a.Cartesian3;K.fromAxisAngle=function(e,r,i){n.Check.typeOf.object("axis",e),n.Check.typeOf.number("angle",r);var o=r/2,s=Math.sin(o),u=(Q=a.Cartesian3.normalize(e,Q)).x*s,d=Q.y*s,l=Q.z*s,c=Math.cos(o);return t.defined(i)?(i.x=u,i.y=d,i.z=l,i.w=c,i):new K(u,d,l,c)};var $=[1,2,0],ee=new Array(3);K.fromRotationMatrix=function(e,r){var a,i,s,u,d;n.Check.typeOf.object("matrix",e);var l=e[o.Matrix3.COLUMN0ROW0],c=e[o.Matrix3.COLUMN1ROW1],f=e[o.Matrix3.COLUMN2ROW2],h=l+c+f;if(h>0)d=.5*(a=Math.sqrt(h+1)),a=.5/a,i=(e[o.Matrix3.COLUMN1ROW2]-e[o.Matrix3.COLUMN2ROW1])*a,s=(e[o.Matrix3.COLUMN2ROW0]-e[o.Matrix3.COLUMN0ROW2])*a,u=(e[o.Matrix3.COLUMN0ROW1]-e[o.Matrix3.COLUMN1ROW0])*a;else{var p=0;c>l&&(p=1),f>l&&f>c&&(p=2);var m=$[p],y=$[m];a=Math.sqrt(e[o.Matrix3.getElementIndex(p,p)]-e[o.Matrix3.getElementIndex(m,m)]-e[o.Matrix3.getElementIndex(y,y)]+1);var C=ee;C[p]=.5*a,a=.5/a,d=(e[o.Matrix3.getElementIndex(y,m)]-e[o.Matrix3.getElementIndex(m,y)])*a,C[m]=(e[o.Matrix3.getElementIndex(m,p)]+e[o.Matrix3.getElementIndex(p,m)])*a,C[y]=(e[o.Matrix3.getElementIndex(y,p)]+e[o.Matrix3.getElementIndex(p,y)])*a,i=-C[0],s=-C[1],u=-C[2]}return t.defined(r)?(r.x=i,r.y=s,r.z=u,r.w=d,r):new K(i,s,u,d)};var te=new K,re=new K,ne=new K,ae=new K;K.fromHeadingPitchRoll=function(e,t){return n.Check.typeOf.object("headingPitchRoll",e),ae=K.fromAxisAngle(a.Cartesian3.UNIT_X,e.roll,te),ne=K.fromAxisAngle(a.Cartesian3.UNIT_Y,-e.pitch,t),t=K.multiply(ne,ae,ne),re=K.fromAxisAngle(a.Cartesian3.UNIT_Z,-e.heading,te),K.multiply(re,t,t)};var ie=new a.Cartesian3,oe=new a.Cartesian3,se=new K,ue=new K,de=new K;K.packedLength=4,K.pack=function(e,r,a){return n.Check.typeOf.object("value",e),n.Check.defined("array",r),a=t.defaultValue(a,0),r[a++]=e.x,r[a++]=e.y,r[a++]=e.z,r[a]=e.w,r},K.unpack=function(e,r,a){return n.Check.defined("array",e),r=t.defaultValue(r,0),t.defined(a)||(a=new K),a.x=e[r],a.y=e[r+1],a.z=e[r+2],a.w=e[r+3],a},K.packedInterpolationLength=3,K.convertPackedArrayForInterpolation=function(e,t,r,n){K.unpack(e,4*r,de),K.conjugate(de,de);for(var a=0,i=r-t+1;a<i;a++){var o=3*a;K.unpack(e,4*(t+a),se),K.multiply(se,de,se),se.w<0&&K.negate(se,se),K.computeAxis(se,ie);var s=K.computeAngle(se);n[o]=ie.x*s,n[o+1]=ie.y*s,n[o+2]=ie.z*s}},K.unpackInterpolationResult=function(e,r,n,i,o){t.defined(o)||(o=new K),a.Cartesian3.fromArray(e,0,oe);var s=a.Cartesian3.magnitude(oe);return K.unpack(r,4*i,ue),0===s?K.clone(K.IDENTITY,se):K.fromAxisAngle(oe,s,se),K.multiply(se,ue,o)},K.clone=function(e,r){if(t.defined(e))return t.defined(r)?(r.x=e.x,r.y=e.y,r.z=e.z,r.w=e.w,r):new K(e.x,e.y,e.z,e.w)},K.conjugate=function(e,t){return n.Check.typeOf.object("quaternion",e),n.Check.typeOf.object("result",t),t.x=-e.x,t.y=-e.y,t.z=-e.z,t.w=e.w,t},K.magnitudeSquared=function(e){return n.Check.typeOf.object("quaternion",e),e.x*e.x+e.y*e.y+e.z*e.z+e.w*e.w},K.magnitude=function(e){return Math.sqrt(K.magnitudeSquared(e))},K.normalize=function(e,t){n.Check.typeOf.object("result",t);var r=1/K.magnitude(e),a=e.x*r,i=e.y*r,o=e.z*r,s=e.w*r;return t.x=a,t.y=i,t.z=o,t.w=s,t},K.inverse=function(e,t){n.Check.typeOf.object("result",t);var r=K.magnitudeSquared(e);return t=K.conjugate(e,t),K.multiplyByScalar(t,1/r,t)},K.add=function(e,t,r){return n.Check.typeOf.object("left",e),n.Check.typeOf.object("right",t),n.Check.typeOf.object("result",r),r.x=e.x+t.x,r.y=e.y+t.y,r.z=e.z+t.z,r.w=e.w+t.w,r},K.subtract=function(e,t,r){return n.Check.typeOf.object("left",e),n.Check.typeOf.object("right",t),n.Check.typeOf.object("result",r),r.x=e.x-t.x,r.y=e.y-t.y,r.z=e.z-t.z,r.w=e.w-t.w,r},K.negate=function(e,t){return n.Check.typeOf.object("quaternion",e),n.Check.typeOf.object("result",t),t.x=-e.x,t.y=-e.y,t.z=-e.z,t.w=-e.w,t},K.dot=function(e,t){return n.Check.typeOf.object("left",e),n.Check.typeOf.object("right",t),e.x*t.x+e.y*t.y+e.z*t.z+e.w*t.w},K.multiply=function(e,t,r){n.Check.typeOf.object("left",e),n.Check.typeOf.object("right",t),n.Check.typeOf.object("result",r);var a=e.x,i=e.y,o=e.z,s=e.w,u=t.x,d=t.y,l=t.z,c=t.w,f=s*u+a*c+i*l-o*d,h=s*d-a*l+i*c+o*u,p=s*l+a*d-i*u+o*c,m=s*c-a*u-i*d-o*l;return r.x=f,r.y=h,r.z=p,r.w=m,r},K.multiplyByScalar=function(e,t,r){return n.Check.typeOf.object("quaternion",e),n.Check.typeOf.number("scalar",t),n.Check.typeOf.object("result",r),r.x=e.x*t,r.y=e.y*t,r.z=e.z*t,r.w=e.w*t,r},K.divideByScalar=function(e,t,r){return n.Check.typeOf.object("quaternion",e),n.Check.typeOf.number("scalar",t),n.Check.typeOf.object("result",r),r.x=e.x/t,r.y=e.y/t,r.z=e.z/t,r.w=e.w/t,r},K.computeAxis=function(e,t){n.Check.typeOf.object("quaternion",e),n.Check.typeOf.object("result",t);var r=e.w;if(Math.abs(r-1)<a.CesiumMath.EPSILON6)return t.x=t.y=t.z=0,t;var i=1/Math.sqrt(1-r*r);return t.x=e.x*i,t.y=e.y*i,t.z=e.z*i,t},K.computeAngle=function(e){return n.Check.typeOf.object("quaternion",e),Math.abs(e.w-1)<a.CesiumMath.EPSILON6?0:2*Math.acos(e.w)};var le=new K;K.lerp=function(e,t,r,a){return n.Check.typeOf.object("start",e),n.Check.typeOf.object("end",t),n.Check.typeOf.number("t",r),n.Check.typeOf.object("result",a),le=K.multiplyByScalar(t,r,le),a=K.multiplyByScalar(e,1-r,a),K.add(le,a,a)};var ce=new K,fe=new K,he=new K;K.slerp=function(e,t,r,i){n.Check.typeOf.object("start",e),n.Check.typeOf.object("end",t),n.Check.typeOf.number("t",r),n.Check.typeOf.object("result",i);var o=K.dot(e,t),s=t;if(o<0&&(o=-o,s=ce=K.negate(t,ce)),1-o<a.CesiumMath.EPSILON6)return K.lerp(e,s,r,i);var u=Math.acos(o);return fe=K.multiplyByScalar(e,Math.sin((1-r)*u),fe),he=K.multiplyByScalar(s,Math.sin(r*u),he),i=K.add(fe,he,i),K.multiplyByScalar(i,1/Math.sin(u),i)},K.log=function(e,t){n.Check.typeOf.object("quaternion",e),n.Check.typeOf.object("result",t);var r=a.CesiumMath.acosClamped(e.w),i=0;return 0!==r&&(i=r/Math.sin(r)),a.Cartesian3.multiplyByScalar(e,i,t)},K.exp=function(e,t){n.Check.typeOf.object("cartesian",e),n.Check.typeOf.object("result",t);var r=a.Cartesian3.magnitude(e),i=0;return 0!==r&&(i=Math.sin(r)/r),t.x=e.x*i,t.y=e.y*i,t.z=e.z*i,t.w=Math.cos(r),t};var pe=new a.Cartesian3,me=new a.Cartesian3,ye=new K,Ce=new K;K.computeInnerQuadrangle=function(e,t,r,i){n.Check.typeOf.object("q0",e),n.Check.typeOf.object("q1",t),n.Check.typeOf.object("q2",r),n.Check.typeOf.object("result",i);var o=K.conjugate(t,ye);K.multiply(o,r,Ce);var s=K.log(Ce,pe);K.multiply(o,e,Ce);var u=K.log(Ce,me);return a.Cartesian3.add(s,u,s),a.Cartesian3.multiplyByScalar(s,.25,s),a.Cartesian3.negate(s,s),K.exp(s,ye),K.multiply(t,ye,i)},K.squad=function(e,t,r,a,i,o){n.Check.typeOf.object("q0",e),n.Check.typeOf.object("q1",t),n.Check.typeOf.object("s0",r),n.Check.typeOf.object("s1",a),n.Check.typeOf.number("t",i),n.Check.typeOf.object("result",o);var s=K.slerp(e,t,i,ye),u=K.slerp(r,a,i,Ce);return K.slerp(s,u,2*i*(1-i),o)};for(var ve=new K,we=1.9011074535173003,ge=d.FeatureDetection.supportsTypedArrays()?new Float32Array(8):[],Oe=d.FeatureDetection.supportsTypedArrays()?new Float32Array(8):[],xe=d.FeatureDetection.supportsTypedArrays()?new Float32Array(8):[],Ee=d.FeatureDetection.supportsTypedArrays()?new Float32Array(8):[],_e=0;_e<7;++_e){var be=_e+1,qe=2*be+1;ge[_e]=1/(be*qe),Oe[_e]=be/qe}function De(e,t,r){n.Check.defined("array",e),n.Check.defined("itemToFind",t),n.Check.defined("comparator",r);for(var a,i,o=0,s=e.length-1;o<=s;)if((i=r(e[a=~~((o+s)/2)],t))<0)o=a+1;else{if(!(i>0))return a;s=a-1}return~(s+1)}function Se(e,t,r,n,a){this.xPoleWander=e,this.yPoleWander=t,this.xPoleOffset=r,this.yPoleOffset=n,this.ut1MinusUtc=a}
/**
    @license
    sprintf.js from the php.js project - https://github.com/kvz/phpjs
    Directly from https://github.com/kvz/phpjs/blob/master/functions/strings/sprintf.js

    php.js is copyright 2012 Kevin van Zonneveld.

    Portions copyright Brett Zamir (http://brett-zamir.me), Kevin van Zonneveld
    (http://kevin.vanzonneveld.net), Onno Marsman, Theriault, Michael White
    (http://getsprink.com), Waldo Malqui Silva, Paulo Freitas, Jack, Jonas
    Raoni Soares Silva (http://www.jsfromhell.com), Philip Peterson, Legaev
    Andrey, Ates Goral (http://magnetiq.com), Alex, Ratheous, Martijn Wieringa,
    Rafa? Kukawski (http://blog.kukawski.pl), lmeyrick
    (https://sourceforge.net/projects/bcmath-js/), Nate, Philippe Baumann,
    Enrique Gonzalez, Webtoolkit.info (http://www.webtoolkit.info/), Carlos R.
    L. Rodrigues (http://www.jsfromhell.com), Ash Searle
    (http://hexmen.com/blog/), Jani Hartikainen, travc, Ole Vrijenhoek,
    Erkekjetter, Michael Grier, Rafa? Kukawski (http://kukawski.pl), Johnny
    Mast (http://www.phpvrouwen.nl), T.Wild, d3x,
    http://stackoverflow.com/questions/57803/how-to-convert-decimal-to-hex-in-javascript,
    Rafa? Kukawski (http://blog.kukawski.pl/), stag019, pilus, WebDevHobo
    (http://webdevhobo.blogspot.com/), marrtins, GeekFG
    (http://geekfg.blogspot.com), Andrea Giammarchi
    (http://webreflection.blogspot.com), Arpad Ray (mailto:arpad@php.net),
    gorthaur, Paul Smith, Tim de Koning (http://www.kingsquare.nl), Joris, Oleg
    Eremeev, Steve Hilder, majak, gettimeofday, KELAN, Josh Fraser
    (http://onlineaspect.com/2007/06/08/auto-detect-a-time-zone-with-javascript/),
    Marc Palau, Martin
    (http://www.erlenwiese.de/), Breaking Par Consulting Inc
    (http://www.breakingpar.com/bkp/home.nsf/0/87256B280015193F87256CFB006C45F7),
    Chris, Mirek Slugen, saulius, Alfonso Jimenez
    (http://www.alfonsojimenez.com), Diplom@t (http://difane.com/), felix,
    Mailfaker (http://www.weedem.fr/), Tyler Akins (http://rumkin.com), Caio
    Ariede (http://caioariede.com), Robin, Kankrelune
    (http://www.webfaktory.info/), Karol Kowalski, Imgen Tata
    (http://www.myipdf.com/), mdsjack (http://www.mdsjack.bo.it), Dreamer,
    Felix Geisendoerfer (http://www.debuggable.com/felix), Lars Fischer, AJ,
    David, Aman Gupta, Michael White, Public Domain
    (http://www.json.org/json2.js), Steven Levithan
    (http://blog.stevenlevithan.com), Sakimori, Pellentesque Malesuada,
    Thunder.m, Dj (http://phpjs.org/functions/htmlentities:425#comment_134018),
    Steve Clay, David James, Francois, class_exists, nobbler, T. Wild, Itsacon
    (http://www.itsacon.net/), date, Ole Vrijenhoek (http://www.nervous.nl/),
    Fox, Raphael (Ao RUDLER), Marco, noname, Mateusz "loonquawl" Zalega, Frank
    Forte, Arno, ger, mktime, john (http://www.jd-tech.net), Nick Kolosov
    (http://sammy.ru), marc andreu, Scott Cariss, Douglas Crockford
    (http://javascript.crockford.com), madipta, Slawomir Kaniecki,
    ReverseSyntax, Nathan, Alex Wilson, kenneth, Bayron Guevara, Adam Wallner
    (http://web2.bitbaro.hu/), paulo kuong, jmweb, Lincoln Ramsay, djmix,
    Pyerre, Jon Hohle, Thiago Mata (http://thiagomata.blog.com), lmeyrick
    (https://sourceforge.net/projects/bcmath-js/this.), Linuxworld, duncan,
    Gilbert, Sanjoy Roy, Shingo, sankai, Oskar Larsson H?gfeldt
    (http://oskar-lh.name/), Denny Wardhana, 0m3r, Everlasto, Subhasis Deb,
    josh, jd, Pier Paolo Ramon (http://www.mastersoup.com/), P, merabi, Soren
    Hansen, Eugene Bulkin (http://doubleaw.com/), Der Simon
    (http://innerdom.sourceforge.net/), echo is bad, Ozh, XoraX
    (http://www.xorax.info), EdorFaus, JB, J A R, Marc Jansen, Francesco, LH,
    Stoyan Kyosev (http://www.svest.org/), nord_ua, omid
    (http://phpjs.org/functions/380:380#comment_137122), Brad Touesnard, MeEtc
    (http://yass.meetcweb.com), Peter-Paul Koch
    (http://www.quirksmode.org/js/beat.html), Olivier Louvignes
    (http://mg-crea.com/), T0bsn, Tim Wiel, Bryan Elliott, Jalal Berrami,
    Martin, JT, David Randall, Thomas Beaucourt (http://www.webapp.fr), taith,
    vlado houba, Pierre-Luc Paour, Kristof Coomans (SCK-CEN Belgian Nucleair
    Research Centre), Martin Pool, Kirk Strobeck, Rick Waldron, Brant Messenger
    (http://www.brantmessenger.com/), Devan Penner-Woelk, Saulo Vallory, Wagner
    B. Soares, Artur Tchernychev, Valentina De Rosa, Jason Wong
    (http://carrot.org/), Christoph, Daniel Esteban, strftime, Mick@el, rezna,
    Simon Willison (http://simonwillison.net), Anton Ongson, Gabriel Paderni,
    Marco van Oort, penutbutterjelly, Philipp Lenssen, Bjorn Roesbeke
    (http://www.bjornroesbeke.be/), Bug?, Eric Nagel, Tomasz Wesolowski,
    Evertjan Garretsen, Bobby Drake, Blues (http://tech.bluesmoon.info/), Luke
    Godfrey, Pul, uestla, Alan C, Ulrich, Rafal Kukawski, Yves Sucaet,
    sowberry, Norman "zEh" Fuchs, hitwork, Zahlii, johnrembo, Nick Callen,
    Steven Levithan (stevenlevithan.com), ejsanders, Scott Baker, Brian Tafoya
    (http://www.premasolutions.com/), Philippe Jausions
    (http://pear.php.net/user/jausions), Aidan Lister
    (http://aidanlister.com/), Rob, e-mike, HKM, ChaosNo1, metjay, strcasecmp,
    strcmp, Taras Bogach, jpfle, Alexander Ermolaev
    (http://snippets.dzone.com/user/AlexanderErmolaev), DxGx, kilops, Orlando,
    dptr1988, Le Torbi, James (http://www.james-bell.co.uk/), Pedro Tainha
    (http://www.pedrotainha.com), James, Arnout Kazemier
    (http://www.3rd-Eden.com), Chris McMacken, gabriel paderni, Yannoo,
    FGFEmperor, baris ozdil, Tod Gentille, Greg Frazier, jakes, 3D-GRAF, Allan
    Jensen (http://www.winternet.no), Howard Yeend, Benjamin Lupton, davook,
    daniel airton wermann (http://wermann.com.br), Atli T¨®r, Maximusya, Ryan
    W Tenney (http://ryan.10e.us), Alexander M Beedie, fearphage
    (http://http/my.opera.com/fearphage/), Nathan Sepulveda, Victor, Matteo,
    Billy, stensi, Cord, Manish, T.J. Leahy, Riddler
    (http://www.frontierwebdev.com/), Rafa? Kukawski, FremyCompany, Matt
    Bradley, Tim de Koning, Luis Salazar (http://www.freaky-media.com/), Diogo
    Resende, Rival, Andrej Pavlovic, Garagoth, Le Torbi
    (http://www.letorbi.de/), Dino, Josep Sanz (http://www.ws3.es/), rem,
    Russell Walker (http://www.nbill.co.uk/), Jamie Beck
    (http://www.terabit.ca/), setcookie, Michael, YUI Library:
    http://developer.yahoo.com/yui/docs/YAHOO.util.DateLocale.html, Blues at
    http://hacks.bluesmoon.info/strftime/strftime.js, Ben
    (http://benblume.co.uk/), DtTvB
    (http://dt.in.th/2008-09-16.string-length-in-bytes.html), Andreas, William,
    meo, incidence, Cagri Ekin, Amirouche, Amir Habibi
    (http://www.residence-mixte.com/), Luke Smith (http://lucassmith.name),
    Kheang Hok Chin (http://www.distantia.ca/), Jay Klehr, Lorenzo Pisani,
    Tony, Yen-Wei Liu, Greenseed, mk.keck, Leslie Hoare, dude, booeyOH, Ben
    Bryan

    Licensed under the MIT (MIT-LICENSE.txt) license.

    Permission is hereby granted, free of charge, to any person obtaining a
    copy of this software and associated documentation files (the
    "Software"), to deal in the Software without restriction, including
    without limitation the rights to use, copy, modify, merge, publish,
    distribute, sublicense, and/or sell copies of the Software, and to
    permit persons to whom the Software is furnished to do so, subject to
    the following conditions:

    The above copyright notice and this permission notice shall be included
    in all copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
    OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
    MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.
    IN NO EVENT SHALL KEVIN VAN ZONNEVELD BE LIABLE FOR ANY CLAIM, DAMAGES
    OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE,
    ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
    OTHER DEALINGS IN THE SOFTWARE.
    */function Re(){var e=/%%|%(\d+\$)?([-+\'#0 ]*)(\*\d+\$|\*|\d+)?(\.(\*\d+\$|\*|\d+))?([scboxXuideEfFgG])/g,t=arguments,r=0,n=t[r++],a=function(e,t,r,n){r||(r=" ");var a=e.length>=t?"":Array(1+t-e.length>>>0).join(r);return n?e+a:a+e},i=function(e,t,r,n,i,o){var s=n-e.length;return s>0&&(e=r||!i?a(e,n,o,r):e.slice(0,t.length)+a("",s,"0",!0)+e.slice(t.length)),e},o=function(e,t,r,n,o,s,u){var d=e>>>0;return e=(r=r&&d&&{2:"0b",8:"0",16:"0x"}[t]||"")+a(d.toString(t),s||0,"0",!1),i(e,r,n,o,u)},s=function(e,t,r,n,a,o){return null!=n&&(e=e.slice(0,n)),i(e,"",t,r,a,o)},u=function(e,n,u,d,l,c,f){var h,p,m,y,C;if("%%"==e)return"%";for(var v=!1,w="",g=!1,O=!1,x=" ",E=u.length,_=0;u&&_<E;_++)switch(u.charAt(_)){case" ":w=" ";break;case"+":w="+";break;case"-":v=!0;break;case"'":x=u.charAt(_+1);break;case"0":g=!0;break;case"#":O=!0}if((d=d?"*"==d?+t[r++]:"*"==d.charAt(0)?+t[d.slice(1,-1)]:+d:0)<0&&(d=-d,v=!0),!isFinite(d))throw new Error("sprintf: (minimum-)width must be finite");switch(c=c?"*"==c?+t[r++]:"*"==c.charAt(0)?+t[c.slice(1,-1)]:+c:"fFeE".indexOf(f)>-1?6:"d"==f?0:void 0,C=n?t[n.slice(0,-1)]:t[r++],f){case"s":return s(String(C),v,d,c,g,x);case"c":return s(String.fromCharCode(+C),v,d,c,g);case"b":return o(C,2,O,v,d,c,g);case"o":return o(C,8,O,v,d,c,g);case"x":return o(C,16,O,v,d,c,g);case"X":return o(C,16,O,v,d,c,g).toUpperCase();case"u":return o(C,10,O,v,d,c,g);case"i":case"d":return h=+C||0,C=(p=(h=Math.round(h-h%1))<0?"-":w)+a(String(Math.abs(h)),c,"0",!1),i(C,p,v,d,g);case"e":case"E":case"f":case"F":case"g":case"G":return p=(h=+C)<0?"-":w,m=["toExponential","toFixed","toPrecision"]["efg".indexOf(f.toLowerCase())],y=["toString","toUpperCase"]["eEfFgG".indexOf(f)%2],C=p+Math.abs(h)[m](c),i(C,p,v,d,g)[y]();default:return e}};return n.replace(e,u)}function Me(e,t,r,n,a,i,o,s){this.year=e,this.month=t,this.day=r,this.hour=n,this.minute=a,this.second=i,this.millisecond=o,this.isLeapSecond=s}function Te(e){if(null===e||isNaN(e))throw new r.DeveloperError("year is required and must be a number.");return e%4==0&&e%100!=0||e%400==0}function Ae(e,t){this.julianDate=e,this.offset=t}ge[7]=we/136,Oe[7]=8*we/17,K.fastSlerp=function(e,t,r,a){n.Check.typeOf.object("start",e),n.Check.typeOf.object("end",t),n.Check.typeOf.number("t",r),n.Check.typeOf.object("result",a);var i,o=K.dot(e,t);o>=0?i=1:(i=-1,o=-o);for(var s=o-1,u=1-r,d=r*r,l=u*u,c=7;c>=0;--c)xe[c]=(ge[c]*d-Oe[c])*s,Ee[c]=(ge[c]*l-Oe[c])*s;var f=i*r*(1+xe[0]*(1+xe[1]*(1+xe[2]*(1+xe[3]*(1+xe[4]*(1+xe[5]*(1+xe[6]*(1+xe[7])))))))),h=u*(1+Ee[0]*(1+Ee[1]*(1+Ee[2]*(1+Ee[3]*(1+Ee[4]*(1+Ee[5]*(1+Ee[6]*(1+Ee[7])))))))),p=K.multiplyByScalar(e,h,ve);return K.multiplyByScalar(t,f,a),K.add(p,a,a)},K.fastSquad=function(e,t,r,a,i,o){n.Check.typeOf.object("q0",e),n.Check.typeOf.object("q1",t),n.Check.typeOf.object("s0",r),n.Check.typeOf.object("s1",a),n.Check.typeOf.number("t",i),n.Check.typeOf.object("result",o);var s=K.fastSlerp(e,t,i,ye),u=K.fastSlerp(r,a,i,Ce);return K.fastSlerp(s,u,2*i*(1-i),o)},K.equals=function(e,r){return e===r||t.defined(e)&&t.defined(r)&&e.x===r.x&&e.y===r.y&&e.z===r.z&&e.w===r.w},K.equalsEpsilon=function(e,r,a){return n.Check.typeOf.number("epsilon",a),e===r||t.defined(e)&&t.defined(r)&&Math.abs(e.x-r.x)<=a&&Math.abs(e.y-r.y)<=a&&Math.abs(e.z-r.z)<=a&&Math.abs(e.w-r.w)<=a},K.ZERO=Object.freeze(new K(0,0,0,0)),K.IDENTITY=Object.freeze(new K(0,0,0,1)),K.prototype.clone=function(e){return K.clone(this,e)},K.prototype.equals=function(e){return K.equals(this,e)},K.prototype.equalsEpsilon=function(e,t){return K.equalsEpsilon(this,e,t)},K.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.z+", "+this.w+")"};var Ie=Object.freeze({SECONDS_PER_MILLISECOND:.001,SECONDS_PER_MINUTE:60,MINUTES_PER_HOUR:60,HOURS_PER_DAY:24,SECONDS_PER_HOUR:3600,MINUTES_PER_DAY:1440,SECONDS_PER_DAY:86400,DAYS_PER_JULIAN_CENTURY:36525,PICOSECOND:1e-9,MODIFIED_JULIAN_DATE_DIFFERENCE:2400000.5}),Pe=Object.freeze({UTC:0,TAI:1}),Ue=new Me,je=[31,28,31,30,31,30,31,31,30,31,30,31];function ke(e,t){return $e.compare(e.julianDate,t.julianDate)}var Ne=new Ae;function ze(e){Ne.julianDate=e;var t=$e.leapSeconds,r=De(t,Ne,ke);r<0&&(r=~r),r>=t.length&&(r=t.length-1);var n=t[r].offset;r>0&&($e.secondsDifference(t[r].julianDate,e)>n&&(n=t[--r].offset));$e.addSeconds(e,n,e)}function Fe(e,t){Ne.julianDate=e;var r=$e.leapSeconds,n=De(r,Ne,ke);if(n<0&&(n=~n),0===n)return $e.addSeconds(e,-r[0].offset,t);if(n>=r.length)return $e.addSeconds(e,-r[n-1].offset,t);var a=$e.secondsDifference(r[n].julianDate,e);return 0===a?$e.addSeconds(e,-r[n].offset,t):a<=1?void 0:$e.addSeconds(e,-r[--n].offset,t)}function Be(e,t,r){var n=t/Ie.SECONDS_PER_DAY|0;return e+=n,(t-=Ie.SECONDS_PER_DAY*n)<0&&(e--,t+=Ie.SECONDS_PER_DAY),r.dayNumber=e,r.secondsOfDay=t,r}function Ve(e,t,r,n,a,i,o){var s=(t-14)/12|0,u=e+4800+s,d=(1461*u/4|0)+(367*(t-2-12*s)/12|0)-(3*((u+100)/100|0)/4|0)+r-32075;(n-=12)<0&&(n+=24);var l=i+(n*Ie.SECONDS_PER_HOUR+a*Ie.SECONDS_PER_MINUTE+o*Ie.SECONDS_PER_MILLISECOND);return l>=43200&&(d-=1),[d,l]}var Le=/^(\d{4})$/,We=/^(\d{4})-(\d{2})$/,Ye=/^(\d{4})-?(\d{3})$/,He=/^(\d{4})-?W(\d{2})-?(\d{1})?$/,Je=/^(\d{4})-?(\d{2})-?(\d{2})$/,Xe=/([Z+\-])?(\d{2})?:?(\d{2})?$/,Ge=/^(\d{2})(\.\d+)?/.source+Xe.source,Ze=/^(\d{2}):?(\d{2})(\.\d+)?/.source+Xe.source,Ke=/^(\d{2}):?(\d{2}):?(\d{2})(\.\d+)?/.source+Xe.source,Qe="Invalid ISO 8601 date.";function $e(e,r,n){this.dayNumber=void 0,this.secondsOfDay=void 0,e=t.defaultValue(e,0),r=t.defaultValue(r,0),n=t.defaultValue(n,Pe.UTC);var a=0|e;Be(a,r+=(e-a)*Ie.SECONDS_PER_DAY,this),n===Pe.UTC&&ze(this)}$e.fromGregorianDate=function(e,n){if(!(e instanceof Me))throw new r.DeveloperError("date must be a valid GregorianDate.");var a=Ve(e.year,e.month,e.day,e.hour,e.minute,e.second,e.millisecond);return t.defined(n)?(Be(a[0],a[1],n),ze(n),n):new $e(a[0],a[1],Pe.UTC)},$e.fromDate=function(e,n){if(!(e instanceof Date)||isNaN(e.getTime()))throw new r.DeveloperError("date must be a valid JavaScript Date.");var a=Ve(e.getUTCFullYear(),e.getUTCMonth()+1,e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds());return t.defined(n)?(Be(a[0],a[1],n),ze(n),n):new $e(a[0],a[1],Pe.UTC)},$e.fromIso8601=function(e,n){if("string"!=typeof e)throw new r.DeveloperError(Qe);var a,i,o,s,u,d=(e=e.replace(",",".")).split("T"),l=1,c=1,f=0,h=0,p=0,m=0,y=d[0],C=d[1];if(!t.defined(y))throw new r.DeveloperError(Qe);if(null!==(d=y.match(Je))){if((s=y.split("-").length-1)>0&&2!==s)throw new r.DeveloperError(Qe);a=+d[1],l=+d[2],c=+d[3]}else if(null!==(d=y.match(We)))a=+d[1],l=+d[2];else if(null!==(d=y.match(Le)))a=+d[1];else{var v;if(null!==(d=y.match(Ye))){if(a=+d[1],v=+d[2],o=Te(a),v<1||o&&v>366||!o&&v>365)throw new r.DeveloperError(Qe)}else{if(null===(d=y.match(He)))throw new r.DeveloperError(Qe);a=+d[1];var w=+d[2],g=+d[3]||0;if((s=y.split("-").length-1)>0&&(!t.defined(d[3])&&1!==s||t.defined(d[3])&&2!==s))throw new r.DeveloperError(Qe);v=7*w+g-new Date(Date.UTC(a,0,4)).getUTCDay()-3}(i=new Date(Date.UTC(a,0,1))).setUTCDate(v),l=i.getUTCMonth()+1,c=i.getUTCDate()}if(o=Te(a),l<1||l>12||c<1||(2!==l||!o)&&c>je[l-1]||o&&2===l&&c>29)throw new r.DeveloperError(Qe);if(t.defined(C)){if(null!==(d=C.match(Ke))){if((s=C.split(":").length-1)>0&&2!==s&&3!==s)throw new r.DeveloperError(Qe);f=+d[1],h=+d[2],p=+d[3],m=1e3*+(d[4]||0),u=5}else if(null!==(d=C.match(Ze))){if((s=C.split(":").length-1)>2)throw new r.DeveloperError(Qe);f=+d[1],h=+d[2],p=60*+(d[3]||0),u=4}else{if(null===(d=C.match(Ge)))throw new r.DeveloperError(Qe);f=+d[1],h=60*+(d[2]||0),u=3}if(h>=60||p>=61||f>24||24===f&&(h>0||p>0||m>0))throw new r.DeveloperError(Qe);var O=d[u],x=+d[u+1],E=+(d[u+2]||0);switch(O){case"+":f-=x,h-=E;break;case"-":f+=x,h+=E;break;case"Z":break;default:h+=new Date(Date.UTC(a,l-1,c,f,h)).getTimezoneOffset()}}var _=60===p;for(_&&p--;h>=60;)h-=60,f++;for(;f>=24;)f-=24,c++;for(i=o&&2===l?29:je[l-1];c>i;)c-=i,++l>12&&(l-=12,a++),i=o&&2===l?29:je[l-1];for(;h<0;)h+=60,f--;for(;f<0;)f+=24,c--;for(;c<1;)--l<1&&(l+=12,a--),c+=i=o&&2===l?29:je[l-1];var b=Ve(a,l,c,f,h,p,m);return t.defined(n)?(Be(b[0],b[1],n),ze(n)):n=new $e(b[0],b[1],Pe.UTC),_&&$e.addSeconds(n,1,n),n},$e.now=function(e){return $e.fromDate(new Date,e)};var et=new $e(0,0,Pe.TAI);
/**
     * @license
     *
     * Grauw URI utilities
     *
     * See: http://hg.grauw.nl/grauw-lib/file/tip/src/uri.js
     *
     * @author Laurens Holst (http://www.grauw.nl/)
     *
     *   Copyright 2012 Laurens Holst
     *
     *   Licensed under the Apache License, Version 2.0 (the "License");
     *   you may not use this file except in compliance with the License.
     *   You may obtain a copy of the License at
     *
     *       http://www.apache.org/licenses/LICENSE-2.0
     *
     *   Unless required by applicable law or agreed to in writing, software
     *   distributed under the License is distributed on an "AS IS" BASIS,
     *   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
     *   See the License for the specific language governing permissions and
     *   limitations under the License.
     *
     */
function tt(e){if(e instanceof tt)this.scheme=e.scheme,this.authority=e.authority,this.path=e.path,this.query=e.query,this.fragment=e.fragment;else if(e){var t=rt.exec(e);this.scheme=t[1],this.authority=t[2],this.path=t[3],this.query=t[4],this.fragment=t[5]}}$e.toGregorianDate=function(e,n){if(!t.defined(e))throw new r.DeveloperError("julianDate is required.");var a=!1,i=Fe(e,et);t.defined(i)||($e.addSeconds(e,-1,et),i=Fe(et,et),a=!0);var o=i.dayNumber,s=i.secondsOfDay;s>=43200&&(o+=1);var u=o+68569|0,d=4*u/146097|0,l=4e3*((u=u-((146097*d+3)/4|0)|0)+1)/1461001|0,c=80*(u=u-(1461*l/4|0)+31|0)/2447|0,f=u-(2447*c/80|0)|0,h=c+2-12*(u=c/11|0)|0,p=100*(d-49)+l+u|0,m=s/Ie.SECONDS_PER_HOUR|0,y=s-m*Ie.SECONDS_PER_HOUR,C=y/Ie.SECONDS_PER_MINUTE|0,v=0|(y-=C*Ie.SECONDS_PER_MINUTE),w=(y-v)/Ie.SECONDS_PER_MILLISECOND;return(m+=12)>23&&(m-=24),a&&(v+=1),t.defined(n)?(n.year=p,n.month=h,n.day=f,n.hour=m,n.minute=C,n.second=v,n.millisecond=w,n.isLeapSecond=a,n):new Me(p,h,f,m,C,v,w,a)},$e.toDate=function(e){if(!t.defined(e))throw new r.DeveloperError("julianDate is required.");var n=$e.toGregorianDate(e,Ue),a=n.second;return n.isLeapSecond&&(a-=1),new Date(Date.UTC(n.year,n.month-1,n.day,n.hour,n.minute,a,n.millisecond))},$e.toIso8601=function(e,n){if(!t.defined(e))throw new r.DeveloperError("julianDate is required.");var a=$e.toGregorianDate(e,Ue),i=a.year,o=a.month,s=a.day,u=a.hour,d=a.minute,l=a.second,c=a.millisecond;return 1e4===i&&1===o&&1===s&&0===u&&0===d&&0===l&&0===c&&(i=9999,o=12,s=31,u=24),t.defined(n)||0===c?t.defined(n)&&0!==n?Re("%04d-%02d-%02dT%02d:%02d:%02d.%sZ",i,o,s,u,d,l,(.01*c).toFixed(n).replace(".","").slice(0,n)):Re("%04d-%02d-%02dT%02d:%02d:%02dZ",i,o,s,u,d,l):Re("%04d-%02d-%02dT%02d:%02d:%02d.%sZ",i,o,s,u,d,l,(.01*c).toString().replace(".",""))},$e.clone=function(e,r){if(t.defined(e))return t.defined(r)?(r.dayNumber=e.dayNumber,r.secondsOfDay=e.secondsOfDay,r):new $e(e.dayNumber,e.secondsOfDay,Pe.TAI)},$e.compare=function(e,n){if(!t.defined(e))throw new r.DeveloperError("left is required.");if(!t.defined(n))throw new r.DeveloperError("right is required.");var a=e.dayNumber-n.dayNumber;return 0!==a?a:e.secondsOfDay-n.secondsOfDay},$e.equals=function(e,r){return e===r||t.defined(e)&&t.defined(r)&&e.dayNumber===r.dayNumber&&e.secondsOfDay===r.secondsOfDay},$e.equalsEpsilon=function(e,n,a){if(!t.defined(a))throw new r.DeveloperError("epsilon is required.");return e===n||t.defined(e)&&t.defined(n)&&Math.abs($e.secondsDifference(e,n))<=a},$e.totalDays=function(e){if(!t.defined(e))throw new r.DeveloperError("julianDate is required.");return e.dayNumber+e.secondsOfDay/Ie.SECONDS_PER_DAY},$e.secondsDifference=function(e,n){if(!t.defined(e))throw new r.DeveloperError("left is required.");if(!t.defined(n))throw new r.DeveloperError("right is required.");return(e.dayNumber-n.dayNumber)*Ie.SECONDS_PER_DAY+(e.secondsOfDay-n.secondsOfDay)},$e.daysDifference=function(e,n){if(!t.defined(e))throw new r.DeveloperError("left is required.");if(!t.defined(n))throw new r.DeveloperError("right is required.");return e.dayNumber-n.dayNumber+(e.secondsOfDay-n.secondsOfDay)/Ie.SECONDS_PER_DAY},$e.computeTaiMinusUtc=function(e){Ne.julianDate=e;var t=$e.leapSeconds,r=De(t,Ne,ke);return r<0&&(r=~r,--r<0&&(r=0)),t[r].offset},$e.addSeconds=function(e,n,a){if(!t.defined(e))throw new r.DeveloperError("julianDate is required.");if(!t.defined(n))throw new r.DeveloperError("seconds is required.");if(!t.defined(a))throw new r.DeveloperError("result is required.");return Be(e.dayNumber,e.secondsOfDay+n,a)},$e.addMinutes=function(e,n,a){if(!t.defined(e))throw new r.DeveloperError("julianDate is required.");if(!t.defined(n))throw new r.DeveloperError("minutes is required.");if(!t.defined(a))throw new r.DeveloperError("result is required.");var i=e.secondsOfDay+n*Ie.SECONDS_PER_MINUTE;return Be(e.dayNumber,i,a)},$e.addHours=function(e,n,a){if(!t.defined(e))throw new r.DeveloperError("julianDate is required.");if(!t.defined(n))throw new r.DeveloperError("hours is required.");if(!t.defined(a))throw new r.DeveloperError("result is required.");var i=e.secondsOfDay+n*Ie.SECONDS_PER_HOUR;return Be(e.dayNumber,i,a)},$e.addDays=function(e,n,a){if(!t.defined(e))throw new r.DeveloperError("julianDate is required.");if(!t.defined(n))throw new r.DeveloperError("days is required.");if(!t.defined(a))throw new r.DeveloperError("result is required.");return Be(e.dayNumber+n,e.secondsOfDay,a)},$e.lessThan=function(e,t){return $e.compare(e,t)<0},$e.lessThanOrEquals=function(e,t){return $e.compare(e,t)<=0},$e.greaterThan=function(e,t){return $e.compare(e,t)>0},$e.greaterThanOrEquals=function(e,t){return $e.compare(e,t)>=0},$e.prototype.clone=function(e){return $e.clone(this,e)},$e.prototype.equals=function(e){return $e.equals(this,e)},$e.prototype.equalsEpsilon=function(e,t){return $e.equalsEpsilon(this,e,t)},$e.prototype.toString=function(){return $e.toIso8601(this)},$e.leapSeconds=[new Ae(new $e(2441317,43210,Pe.TAI),10),new Ae(new $e(2441499,43211,Pe.TAI),11),new Ae(new $e(2441683,43212,Pe.TAI),12),new Ae(new $e(2442048,43213,Pe.TAI),13),new Ae(new $e(2442413,43214,Pe.TAI),14),new Ae(new $e(2442778,43215,Pe.TAI),15),new Ae(new $e(2443144,43216,Pe.TAI),16),new Ae(new $e(2443509,43217,Pe.TAI),17),new Ae(new $e(2443874,43218,Pe.TAI),18),new Ae(new $e(2444239,43219,Pe.TAI),19),new Ae(new $e(2444786,43220,Pe.TAI),20),new Ae(new $e(2445151,43221,Pe.TAI),21),new Ae(new $e(2445516,43222,Pe.TAI),22),new Ae(new $e(2446247,43223,Pe.TAI),23),new Ae(new $e(2447161,43224,Pe.TAI),24),new Ae(new $e(2447892,43225,Pe.TAI),25),new Ae(new $e(2448257,43226,Pe.TAI),26),new Ae(new $e(2448804,43227,Pe.TAI),27),new Ae(new $e(2449169,43228,Pe.TAI),28),new Ae(new $e(2449534,43229,Pe.TAI),29),new Ae(new $e(2450083,43230,Pe.TAI),30),new Ae(new $e(2450630,43231,Pe.TAI),31),new Ae(new $e(2451179,43232,Pe.TAI),32),new Ae(new $e(2453736,43233,Pe.TAI),33),new Ae(new $e(2454832,43234,Pe.TAI),34),new Ae(new $e(2456109,43235,Pe.TAI),35),new Ae(new $e(2457204,43236,Pe.TAI),36),new Ae(new $e(2457754,43237,Pe.TAI),37)],tt.prototype.scheme=null,tt.prototype.authority=null,tt.prototype.path="",tt.prototype.query=null,tt.prototype.fragment=null;var rt=new RegExp("^(?:([^:/?#]+):)?(?://([^/?#]*))?([^?#]*)(?:\\?([^#]*))?(?:#(.*))?$");tt.prototype.getScheme=function(){return this.scheme},tt.prototype.getAuthority=function(){return this.authority},tt.prototype.getPath=function(){return this.path},tt.prototype.getQuery=function(){return this.query},tt.prototype.getFragment=function(){return this.fragment},tt.prototype.isAbsolute=function(){return!!this.scheme&&!this.fragment},tt.prototype.isSameDocumentAs=function(e){return e.scheme==this.scheme&&e.authority==this.authority&&e.path==this.path&&e.query==this.query},tt.prototype.equals=function(e){return this.isSameDocumentAs(e)&&e.fragment==this.fragment},tt.prototype.normalize=function(){this.removeDotSegments(),this.scheme&&(this.scheme=this.scheme.toLowerCase()),this.authority&&(this.authority=this.authority.replace(it,st).replace(nt,ot)),this.path&&(this.path=this.path.replace(nt,ot)),this.query&&(this.query=this.query.replace(nt,ot)),this.fragment&&(this.fragment=this.fragment.replace(nt,ot))};var nt=/%[0-9a-z]{2}/gi,at=/[a-zA-Z0-9\-\._~]/,it=/(.*@)?([^@:]*)(:.*)?/;function ot(e){var t=unescape(e);return at.test(t)?t:e.toUpperCase()}function st(e,t,r,n){return(t||"")+r.toLowerCase()+(n||"")}function ut(e,r){if(null===e||"object"!=typeof e)return e;r=t.defaultValue(r,!1);var n=new e.constructor;for(var a in e)if(e.hasOwnProperty(a)){var i=e[a];r&&(i=ut(i,r)),n[a]=i}return n}function dt(e,r,n){n=t.defaultValue(n,!1);var a,i,o,s={},u=t.defined(e),d=t.defined(r);if(u)for(a in e)e.hasOwnProperty(a)&&(i=e[a],d&&n&&"object"==typeof i&&r.hasOwnProperty(a)?(o=r[a],s[a]="object"==typeof o?dt(i,o,n):i):s[a]=i);if(d)for(a in r)r.hasOwnProperty(a)&&!s.hasOwnProperty(a)&&(o=r[a],s[a]=o);return s}function lt(e,t){var r;return"undefined"!=typeof document&&(r=document),lt._implementation(e,t,r)}tt.prototype.resolve=function(e){var t=new tt;return this.scheme?(t.scheme=this.scheme,t.authority=this.authority,t.path=this.path,t.query=this.query):(t.scheme=e.scheme,this.authority?(t.authority=this.authority,t.path=this.path,t.query=this.query):(t.authority=e.authority,""==this.path?(t.path=e.path,t.query=this.query||e.query):("/"==this.path.charAt(0)?(t.path=this.path,t.removeDotSegments()):(e.authority&&""==e.path?t.path="/"+this.path:t.path=e.path.substring(0,e.path.lastIndexOf("/")+1)+this.path,t.removeDotSegments()),t.query=this.query))),t.fragment=this.fragment,t},tt.prototype.removeDotSegments=function(){var e,t=this.path.split("/"),r=[],n=""==t[0];n&&t.shift();for(""==t[0]&&t.shift();t.length;)".."==(e=t.shift())?r.pop():"."!=e&&r.push(e);"."!=e&&".."!=e||r.push(""),n&&r.unshift(""),this.path=r.join("/")},tt.prototype.toString=function(){var e="";return this.scheme&&(e+=this.scheme+":"),this.authority&&(e+="//"+this.authority),e+=this.path,this.query&&(e+="?"+this.query),this.fragment&&(e+="#"+this.fragment),e},lt._implementation=function(e,n,a){if(!t.defined(e))throw new r.DeveloperError("relative uri is required.");if(!t.defined(n)){if(void 0===a)return e;n=t.defaultValue(a.baseURI,a.location.href)}var i=new tt(n);return new tt(e).resolve(i).toString()};var ct,ft=/^blob:/i;function ht(e){return n.Check.typeOf.string("uri",e),ft.test(e)}var pt=/^data:/i;function mt(e){return n.Check.typeOf.string("uri",e),pt.test(e)}var yt=Object.freeze({UNISSUED:0,ISSUED:1,ACTIVE:2,RECEIVED:3,CANCELLED:4,FAILED:5}),Ct=Object.freeze({TERRAIN:0,IMAGERY:1,TILES3D:2,OTHER:3});function vt(e){e=t.defaultValue(e,t.defaultValue.EMPTY_OBJECT);var r=t.defaultValue(e.throttleByServer,!1),n=t.defaultValue(e.throttle,!1);this.url=e.url,this.requestFunction=e.requestFunction,this.cancelFunction=e.cancelFunction,this.priorityFunction=e.priorityFunction,this.priority=t.defaultValue(e.priority,0),this.throttle=n,this.throttleByServer=r,this.type=t.defaultValue(e.type,Ct.OTHER),this.serverKey=void 0,this.state=yt.UNISSUED,this.deferred=void 0,this.cancelled=!1}function wt(e,t,r){this.statusCode=e,this.response=t,this.responseHeaders=r,"string"==typeof this.responseHeaders&&(this.responseHeaders=function(e){var t={};if(!e)return t;for(var r=e.split("\r\n"),n=0;n<r.length;++n){var a=r[n],i=a.indexOf(": ");if(i>0){var o=a.substring(0,i),s=a.substring(i+2);t[o]=s}}return t}(this.responseHeaders))}function gt(){this._listeners=[],this._scopes=[],this._toRemove=[],this._insideRaiseEvent=!1}function Ot(e,t){return t-e}function xt(e){n.Check.typeOf.object("options",e),n.Check.defined("options.comparator",e.comparator),this._comparator=e.comparator,this._array=[],this._length=0,this._maximumLength=void 0}function Et(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}vt.prototype.cancel=function(){this.cancelled=!0},vt.prototype.clone=function(e){return t.defined(e)?(e.url=this.url,e.requestFunction=this.requestFunction,e.cancelFunction=this.cancelFunction,e.priorityFunction=this.priorityFunction,e.priority=this.priority,e.throttle=this.throttle,e.throttleByServer=this.throttleByServer,e.type=this.type,e.serverKey=this.serverKey,e.state=this.RequestState.UNISSUED,e.deferred=void 0,e.cancelled=!1,e):new vt(this)},wt.prototype.toString=function(){var e="Request has failed.";return t.defined(this.statusCode)&&(e+=" Status Code: "+this.statusCode),e},Object.defineProperties(gt.prototype,{numberOfListeners:{get:function(){return this._listeners.length-this._toRemove.length}}}),gt.prototype.addEventListener=function(e,t){n.Check.typeOf.func("listener",e),this._listeners.push(e),this._scopes.push(t);var r=this;return function(){r.removeEventListener(e,t)}},gt.prototype.removeEventListener=function(e,t){n.Check.typeOf.func("listener",e);for(var r=this._listeners,a=this._scopes,i=-1,o=0;o<r.length;o++)if(r[o]===e&&a[o]===t){i=o;break}return-1!==i&&(this._insideRaiseEvent?(this._toRemove.push(i),r[i]=void 0,a[i]=void 0):(r.splice(i,1),a.splice(i,1)),!0)},gt.prototype.raiseEvent=function(){var e;this._insideRaiseEvent=!0;var r=this._listeners,n=this._scopes,a=r.length;for(e=0;e<a;e++){var i=r[e];t.defined(i)&&r[e].apply(n[e],arguments)}var o=this._toRemove;if((a=o.length)>0){for(o.sort(Ot),e=0;e<a;e++){var s=o[e];r.splice(s,1),n.splice(s,1)}o.length=0}this._insideRaiseEvent=!1},Object.defineProperties(xt.prototype,{length:{get:function(){return this._length}},internalArray:{get:function(){return this._array}},maximumLength:{get:function(){return this._maximumLength},set:function(e){this._maximumLength=e,this._length>e&&e>0&&(this._length=e,this._array.length=e)}},comparator:{get:function(){return this._comparator}}}),xt.prototype.reserve=function(e){e=t.defaultValue(e,this._length),this._array.length=e},xt.prototype.heapify=function(e){e=t.defaultValue(e,0);for(var r=this._length,n=this._comparator,a=this._array,i=-1,o=!0;o;){var s=2*(e+1),u=s-1;i=u<r&&n(a[u],a[e])<0?u:e,s<r&&n(a[s],a[i])<0&&(i=s),i!==e?(Et(a,i,e),e=i):o=!1}},xt.prototype.resort=function(){for(var e=this._length,t=Math.ceil(e/2);t>=0;--t)this.heapify(t)},xt.prototype.insert=function(e){n.Check.defined("element",e);var r,a=this._array,i=this._comparator,o=this._maximumLength,s=this._length++;for(s<a.length?a[s]=e:a.push(e);0!==s;){var u=Math.floor((s-1)/2);if(!(i(a[s],a[u])<0))break;Et(a,s,u),s=u}return t.defined(o)&&this._length>o&&(r=a[o],this._length=o),r},xt.prototype.pop=function(e){if(e=t.defaultValue(e,0),0!==this._length){n.Check.typeOf.number.lessThan("index",e,this._length);var r=this._array,a=r[e];return Et(r,e,--this._length),this.heapify(e),a}};var _t={numberOfAttemptedRequests:0,numberOfActiveRequests:0,numberOfCancelledRequests:0,numberOfCancelledActiveRequests:0,numberOfFailedRequests:0,numberOfActiveRequestsEver:0,lastNumberOfActiveRequests:0},bt=20,qt=new xt({comparator:function(e,t){return e.priority-t.priority}});qt.maximumLength=bt,qt.reserve(bt);var Dt=[],St={},Rt="undefined"!=typeof document?new tt(document.location.href):new tt,Mt=new gt;function Tt(){}function At(e){t.defined(e.priorityFunction)&&(e.priority=e.priorityFunction())}function It(e){var r=t.defaultValue(Tt.requestsByServer[e],Tt.maximumRequestsPerServer);return St[e]<r}function Pt(e){return e.state===yt.UNISSUED&&(e.state=yt.ISSUED,e.deferred=t.when.defer()),e.deferred.promise}function Ut(e){var t=Pt(e);return e.state=yt.ACTIVE,Dt.push(e),++_t.numberOfActiveRequests,++_t.numberOfActiveRequestsEver,++St[e.serverKey],e.requestFunction().then(function(e){return function(t){e.state!==yt.CANCELLED&&(--_t.numberOfActiveRequests,--St[e.serverKey],Mt.raiseEvent(),e.state=yt.RECEIVED,e.deferred.resolve(t))}}(e)).otherwise(function(e){return function(t){e.state!==yt.CANCELLED&&(++_t.numberOfFailedRequests,--_t.numberOfActiveRequests,--St[e.serverKey],Mt.raiseEvent(t),e.state=yt.FAILED,e.deferred.reject(t))}}(e)),t}function jt(e){var r=e.state===yt.ACTIVE;e.state=yt.CANCELLED,++_t.numberOfCancelledRequests,e.deferred.reject(),r&&(--_t.numberOfActiveRequests,--St[e.serverKey],++_t.numberOfCancelledActiveRequests),t.defined(e.cancelFunction)&&e.cancelFunction()}Tt.maximumRequests=50,Tt.maximumRequestsPerServer=6,Tt.requestsByServer={"api.cesium.com:443":18,"assets.cesium.com:443":18},Tt.throttleRequests=!0,Tt.debugShowStatistics=!1,Tt.requestCompletedEvent=Mt,Object.defineProperties(Tt,{statistics:{get:function(){return _t}},priorityHeapLength:{get:function(){return bt},set:function(e){if(e<bt)for(;qt.length>e;){jt(qt.pop())}bt=e,qt.maximumLength=e,qt.reserve(e)}}}),Tt.update=function(){var e,t,r=0,n=Dt.length;for(e=0;e<n;++e)(t=Dt[e]).cancelled&&jt(t),t.state===yt.ACTIVE?r>0&&(Dt[e-r]=t):++r;Dt.length-=r;var a=qt.internalArray,i=qt.length;for(e=0;e<i;++e)At(a[e]);qt.resort();for(var o=Math.max(Tt.maximumRequests-Dt.length,0),s=0;s<o&&qt.length>0;)(t=qt.pop()).cancelled?jt(t):!t.throttleByServer||It(t.serverKey)?(Ut(t),++s):jt(t);!function(){if(!Tt.debugShowStatistics)return;0===_t.numberOfActiveRequests&&_t.lastNumberOfActiveRequests>0&&(_t.numberOfAttemptedRequests>0&&(console.log("Number of attempted requests: "+_t.numberOfAttemptedRequests),_t.numberOfAttemptedRequests=0),_t.numberOfCancelledRequests>0&&(console.log("Number of cancelled requests: "+_t.numberOfCancelledRequests),_t.numberOfCancelledRequests=0),_t.numberOfCancelledActiveRequests>0&&(console.log("Number of cancelled active requests: "+_t.numberOfCancelledActiveRequests),_t.numberOfCancelledActiveRequests=0),_t.numberOfFailedRequests>0&&(console.log("Number of failed requests: "+_t.numberOfFailedRequests),_t.numberOfFailedRequests=0));_t.lastNumberOfActiveRequests=_t.numberOfActiveRequests}()},Tt.getServerKey=function(e){n.Check.typeOf.string("url",e);var r=new tt(e).resolve(Rt);r.normalize();var a=r.authority;/:/.test(a)||(a=a+":"+("https"===r.scheme?"443":"80"));var i=St[a];return t.defined(i)||(St[a]=0),a},Tt.request=function(e){if(n.Check.typeOf.object("request",e),n.Check.typeOf.string("request.url",e.url),n.Check.typeOf.func("request.requestFunction",e.requestFunction),mt(e.url)||ht(e.url))return Mt.raiseEvent(),e.state=yt.RECEIVED,e.requestFunction();if(++_t.numberOfAttemptedRequests,t.defined(e.serverKey)||(e.serverKey=Tt.getServerKey(e.url)),!Tt.throttleRequests||!e.throttleByServer||It(e.serverKey)){if(!Tt.throttleRequests||!e.throttle)return Ut(e);if(!(Dt.length>=Tt.maximumRequests)){At(e);var r=qt.insert(e);if(t.defined(r)){if(r===e)return;jt(r)}return Pt(e)}}},Tt.clearForSpecs=function(){for(;qt.length>0;){jt(qt.pop())}for(var e=Dt.length,t=0;t<e;++t)jt(Dt[t]);Dt.length=0,St={},_t.numberOfAttemptedRequests=0,_t.numberOfActiveRequests=0,_t.numberOfCancelledRequests=0,_t.numberOfCancelledActiveRequests=0,_t.numberOfFailedRequests=0,_t.numberOfActiveRequestsEver=0,_t.lastNumberOfActiveRequests=0},Tt.numberOfActiveRequestsByServer=function(e){return St[e]},Tt.requestHeap=qt;var kt={},Nt={};kt.add=function(e,n){if(!t.defined(e))throw new r.DeveloperError("host is required.");if(!t.defined(n)||n<=0)throw new r.DeveloperError("port is required to be greater than 0.");var a=e.toLowerCase()+":"+n;t.defined(Nt[a])||(Nt[a]=!0)},kt.remove=function(e,n){if(!t.defined(e))throw new r.DeveloperError("host is required.");if(!t.defined(n)||n<=0)throw new r.DeveloperError("port is required to be greater than 0.");var a=e.toLowerCase()+":"+n;t.defined(Nt[a])&&delete Nt[a]},kt.contains=function(e){if(!t.defined(e))throw new r.DeveloperError("url is required.");var n=function(e){var r=new tt(e);r.normalize();var n=r.getAuthority();if(t.defined(n)){if(-1!==n.indexOf("@")){var a=n.split("@");n=a[1]}if(-1===n.indexOf(":")){var i=r.getScheme();if(t.defined(i)||(i=(i=window.location.protocol).substring(0,i.length-1)),"http"===i)n+=":80";else{if("https"!==i)return;n+=":443"}}return n}}(e);return!(!t.defined(n)||!t.defined(Nt[n]))},kt.clear=function(){Nt={}};var zt,Ft=function(){try{var e=new XMLHttpRequest;return e.open("GET","#",!0),e.responseType="blob","blob"===e.responseType}catch(e){return!1}}();function Bt(e,n,a,i){var o,s=e.query;if(!t.defined(s)||0===s.length)return{};if(-1===s.indexOf("=")){var u={};u[s]=void 0,o=u}else o=function(e){if(!t.defined(e))throw new r.DeveloperError("queryString is required.");var n={};if(""===e)return n;for(var a=e.replace(/\+/g,"%20").split(/[&;]/),i=0,o=a.length;i<o;++i){var s=a[i].split("="),u=decodeURIComponent(s[0]),d=s[1];d=t.defined(d)?decodeURIComponent(d):"";var l=n[u];"string"==typeof l?n[u]=[l,d]:Array.isArray(l)?l.push(d):n[u]=d}return n}(s);n._queryParameters=a?Yt(o,n._queryParameters,i):o,e.query=void 0}function Vt(e,n){var a=n._queryParameters,i=Object.keys(a);1!==i.length||t.defined(a[i[0]])?e.query=function(e){if(!t.defined(e))throw new r.DeveloperError("obj is required.");var n="";for(var a in e)if(e.hasOwnProperty(a)){var i=e[a],o=encodeURIComponent(a)+"=";if(Array.isArray(i))for(var s=0,u=i.length;s<u;++s)n+=o+encodeURIComponent(i[s])+"&";else n+=o+encodeURIComponent(i)+"&"}return n=n.slice(0,-1)}(a):e.query=i[0]}function Lt(e,r){return t.defined(e)?t.defined(e.clone)?e.clone():ut(e):r}function Wt(e){if(e.state===yt.ISSUED||e.state===yt.ACTIVE)throw new s.RuntimeError("The Resource is already being fetched.");e.state=yt.UNISSUED,e.deferred=void 0}function Yt(e,r,n){if(!n)return dt(e,r);var a=ut(e,!0);for(var i in r)if(r.hasOwnProperty(i)){var o=a[i],s=r[i];t.defined(o)?(Array.isArray(o)||(o=a[i]=[o]),a[i]=o.concat(s)):a[i]=Array.isArray(s)?s.slice():s}return a}function Ht(e){"string"==typeof(e=t.defaultValue(e,t.defaultValue.EMPTY_OBJECT))&&(e={url:e}),n.Check.typeOf.string("options.url",e.url),this._url=void 0,this._templateValues=Lt(e.templateValues,{}),this._queryParameters=Lt(e.queryParameters,{}),this.headers=Lt(e.headers,{}),this.request=t.defaultValue(e.request,new vt),this.proxy=e.proxy,this.retryCallback=e.retryCallback,this.retryAttempts=t.defaultValue(e.retryAttempts,0),this._retryCount=0;var r=new tt(e.url);Bt(r,this,!0,!0),r.fragment=void 0,this._url=r.toString()}function Jt(e){var r=e.resource,n=e.flipY,a=e.preferImageBitmap,i=r.request;i.url=r.url,i.requestFunction=function(){var e=!1;r.isDataUri||r.isBlobUri||(e=r.isCrossOriginUrl);var o=t.when.defer();return Ht._Implementations.createImage(i,e,o,n,a),o.promise};var o=Tt.request(i);if(t.defined(o))return o.otherwise((function(e){return i.state!==yt.FAILED?t.when.reject(e):r.retryOnError(e).then((function(o){return o?(i.state=yt.UNISSUED,i.deferred=void 0,Jt({resource:r,flipY:n,preferImageBitmap:a})):t.when.reject(e)}))}))}Ht.createIfNeeded=function(e){return e instanceof Ht?e.getDerivedResource({request:e.request}):"string"!=typeof e?e:new Ht({url:e})},Ht.supportsImageBitmapOptions=function(){if(t.defined(zt))return zt;if("function"!=typeof createImageBitmap)return zt=t.when.resolve(!1);return zt=Ht.fetchBlob({url:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWP4////fwAJ+wP9CNHoHgAAAABJRU5ErkJggg=="}).then((function(e){return createImageBitmap(e,{imageOrientation:"flipY",premultiplyAlpha:"none"})})).then((function(e){return!0})).otherwise((function(){return!1}))},Object.defineProperties(Ht,{isBlobSupported:{get:function(){return Ft}}}),Object.defineProperties(Ht.prototype,{queryParameters:{get:function(){return this._queryParameters}},templateValues:{get:function(){return this._templateValues}},url:{get:function(){return this.getUrlComponent(!0,!0)},set:function(e){var t=new tt(e);Bt(t,this,!1),t.fragment=void 0,this._url=t.toString()}},extension:{get:function(){return function(e){if(!t.defined(e))throw new r.DeveloperError("uri is required.");var n=new tt(e);n.normalize();var a=n.path,i=a.lastIndexOf("/");return-1!==i&&(a=a.substr(i+1)),i=a.lastIndexOf("."),a=-1===i?"":a.substr(i+1)}(this._url)}},isDataUri:{get:function(){return mt(this._url)}},isBlobUri:{get:function(){return ht(this._url)}},isCrossOriginUrl:{get:function(){return function(e){t.defined(ct)||(ct=document.createElement("a")),ct.href=window.location.href;var r=ct.host,n=ct.protocol;return ct.href=e,ct.href=ct.href,n!==ct.protocol||r!==ct.host}(this._url)}},hasHeaders:{get:function(){return Object.keys(this.headers).length>0}}}),Ht.prototype.getUrlComponent=function(e,r){if(this.isDataUri)return this._url;var n=new tt(this._url);e&&Vt(n,this);var a=n.toString().replace(/%7B/g,"{").replace(/%7D/g,"}"),i=this._templateValues;return a=a.replace(/{(.*?)}/g,(function(e,r){var n=i[r];return t.defined(n)?encodeURIComponent(n):e})),r&&t.defined(this.proxy)&&(a=this.proxy.getURL(a)),a},Ht.prototype.setQueryParameters=function(e,t){this._queryParameters=t?Yt(this._queryParameters,e,!1):Yt(e,this._queryParameters,!1)},Ht.prototype.appendQueryParameters=function(e){this._queryParameters=Yt(e,this._queryParameters,!0)},Ht.prototype.setTemplateValues=function(e,t){this._templateValues=t?dt(this._templateValues,e):dt(e,this._templateValues)},Ht.prototype.getDerivedResource=function(e){var r=this.clone();if(r._retryCount=0,t.defined(e.url)){var n=new tt(e.url);Bt(n,r,!0,t.defaultValue(e.preserveQueryParameters,!1)),n.fragment=void 0,r._url=n.resolve(new tt(lt(this._url))).toString()}return t.defined(e.queryParameters)&&(r._queryParameters=dt(e.queryParameters,r._queryParameters)),t.defined(e.templateValues)&&(r._templateValues=dt(e.templateValues,r.templateValues)),t.defined(e.headers)&&(r.headers=dt(e.headers,r.headers)),t.defined(e.proxy)&&(r.proxy=e.proxy),t.defined(e.request)&&(r.request=e.request),t.defined(e.retryCallback)&&(r.retryCallback=e.retryCallback),t.defined(e.retryAttempts)&&(r.retryAttempts=e.retryAttempts),r},Ht.prototype.retryOnError=function(e){var r=this.retryCallback;if("function"!=typeof r||this._retryCount>=this.retryAttempts)return t.when(!1);var n=this;return t.when(r(this,e)).then((function(e){return++n._retryCount,e}))},Ht.prototype.clone=function(e){return t.defined(e)||(e=new Ht({url:this._url})),e._url=this._url,e._queryParameters=ut(this._queryParameters),e._templateValues=ut(this._templateValues),e.headers=ut(this.headers),e.proxy=this.proxy,e.retryCallback=this.retryCallback,e.retryAttempts=this.retryAttempts,e._retryCount=0,e.request=this.request.clone(),e},Ht.prototype.getBaseUri=function(e){return function(e,n){if(!t.defined(e))throw new r.DeveloperError("uri is required.");var a="",i=e.lastIndexOf("/");return-1!==i&&(a=e.substring(0,i+1)),n?(e=new tt(e),t.defined(e.query)&&(a+="?"+e.query),t.defined(e.fragment)&&(a+="#"+e.fragment),a):a}(this.getUrlComponent(e),e)},Ht.prototype.appendForwardSlash=function(){var e;this._url=(0!==(e=this._url).length&&"/"===e[e.length-1]||(e+="/"),e)},Ht.prototype.fetchArrayBuffer=function(){return this.fetch({responseType:"arraybuffer"})},Ht.fetchArrayBuffer=function(e){return new Ht(e).fetchArrayBuffer()},Ht.prototype.fetchBlob=function(){return this.fetch({responseType:"blob"})},Ht.fetchBlob=function(e){return new Ht(e).fetchBlob()},Ht.prototype.fetchImage=function(e){e=t.defaultValue(e,t.defaultValue.EMPTY_OBJECT);var r=t.defaultValue(e.preferImageBitmap,!1),n=t.defaultValue(e.preferBlob,!1),a=t.defaultValue(e.flipY,!1);if(Wt(this.request),!Ft||this.isDataUri||this.isBlobUri||!this.hasHeaders&&!n)return Jt({resource:this,flipY:a,preferImageBitmap:r});var i,o,s,u=this.fetchBlob();return t.defined(u)?Ht.supportsImageBitmapOptions().then((function(e){return i=e&&r,u})).then((function(e){if(t.defined(e)){if(s=e,i)return Ht.createImageBitmapFromBlob(e,{flipY:a,premultiplyAlpha:!1});var r=window.URL.createObjectURL(e);return Jt({resource:o=new Ht({url:r}),flipY:a,preferImageBitmap:!1})}})).then((function(e){if(t.defined(e))return e.blob=s,i||window.URL.revokeObjectURL(o.url),e})).otherwise((function(e){return t.defined(o)&&window.URL.revokeObjectURL(o.url),e.blob=s,t.when.reject(e)})):void 0},Ht.fetchImage=function(e){return new Ht(e).fetchImage({flipY:e.flipY,preferBlob:e.preferBlob,preferImageBitmap:e.preferImageBitmap})},Ht.prototype.fetchText=function(){return this.fetch({responseType:"text"})},Ht.fetchText=function(e){return new Ht(e).fetchText()},Ht.prototype.fetchJson=function(){var e=this.fetch({responseType:"text",headers:{Accept:"application/json,*/*;q=0.01"}});if(t.defined(e))return e.then((function(e){if(t.defined(e))return JSON.parse(e)}))},Ht.fetchJson=function(e){return new Ht(e).fetchJson()},Ht.prototype.fetchXML=function(){return this.fetch({responseType:"document",overrideMimeType:"text/xml"})},Ht.fetchXML=function(e){return new Ht(e).fetchXML()},Ht.prototype.fetchJsonp=function(e){var r;e=t.defaultValue(e,"callback"),Wt(this.request);do{r="loadJsonp"+Math.random().toString().substring(2,8)}while(t.defined(window[r]));return function e(r,n,a){var i={};i[n]=a,r.setQueryParameters(i);var o=r.request;o.url=r.url,o.requestFunction=function(){var e=t.when.defer();return window[a]=function(t){e.resolve(t);try{delete window[a]}catch(e){window[a]=void 0}},Ht._Implementations.loadAndExecuteScript(r.url,a,e),e.promise};var s=Tt.request(o);if(!t.defined(s))return;return s.otherwise((function(i){return o.state!==yt.FAILED?t.when.reject(i):r.retryOnError(i).then((function(s){return s?(o.state=yt.UNISSUED,o.deferred=void 0,e(r,n,a)):t.when.reject(i)}))}))}(this,e,r)},Ht.fetchJsonp=function(e){return new Ht(e).fetchJsonp(e.callbackParameterName)},Ht.prototype._makeRequest=function(e){var r=this;Wt(r.request);var n=r.request;n.url=r.url,n.requestFunction=function(){var a=e.responseType,i=dt(e.headers,r.headers),o=e.overrideMimeType,s=e.method,u=e.data,d=t.when.defer(),l=Ht._Implementations.loadWithXhr(r.url,a,s,u,i,d,o);return t.defined(l)&&t.defined(l.abort)&&(n.cancelFunction=function(){l.abort()}),d.promise};var a=Tt.request(n);if(t.defined(a))return a.then((function(e){return e})).otherwise((function(a){return n.state!==yt.FAILED?t.when.reject(a):r.retryOnError(a).then((function(i){return i?(n.state=yt.UNISSUED,n.deferred=void 0,r.fetch(e)):t.when.reject(a)}))}))};var Xt=/^data:(.*?)(;base64)?,(.*)$/;function Gt(e,t){var r=decodeURIComponent(t);return e?atob(r):r}function Zt(e,t){for(var r=Gt(e,t),n=new ArrayBuffer(r.length),a=new Uint8Array(n),i=0;i<r.length;i++)a[i]=r.charCodeAt(i);return n}function Kt(e,t){switch(t){case"text":return e.toString("utf8");case"json":return JSON.parse(e.toString("utf8"));default:return new Uint8Array(e).buffer}}Ht.prototype.fetch=function(e){return(e=Lt(e,{})).method="GET",this._makeRequest(e)},Ht.fetch=function(e){return new Ht(e).fetch({responseType:e.responseType,overrideMimeType:e.overrideMimeType})},Ht.prototype.delete=function(e){return(e=Lt(e,{})).method="DELETE",this._makeRequest(e)},Ht.delete=function(e){return new Ht(e).delete({responseType:e.responseType,overrideMimeType:e.overrideMimeType,data:e.data})},Ht.prototype.head=function(e){return(e=Lt(e,{})).method="HEAD",this._makeRequest(e)},Ht.head=function(e){return new Ht(e).head({responseType:e.responseType,overrideMimeType:e.overrideMimeType})},Ht.prototype.options=function(e){return(e=Lt(e,{})).method="OPTIONS",this._makeRequest(e)},Ht.options=function(e){return new Ht(e).options({responseType:e.responseType,overrideMimeType:e.overrideMimeType})},Ht.prototype.post=function(e,t){return n.Check.defined("data",e),(t=Lt(t,{})).method="POST",t.data=e,this._makeRequest(t)},Ht.post=function(e){return new Ht(e).post(e.data,{responseType:e.responseType,overrideMimeType:e.overrideMimeType})},Ht.prototype.put=function(e,t){return n.Check.defined("data",e),(t=Lt(t,{})).method="PUT",t.data=e,this._makeRequest(t)},Ht.put=function(e){return new Ht(e).put(e.data,{responseType:e.responseType,overrideMimeType:e.overrideMimeType})},Ht.prototype.patch=function(e,t){return n.Check.defined("data",e),(t=Lt(t,{})).method="PATCH",t.data=e,this._makeRequest(t)},Ht.patch=function(e){return new Ht(e).patch(e.data,{responseType:e.responseType,overrideMimeType:e.overrideMimeType})},Ht._Implementations={},Ht._Implementations.createImage=function(e,r,n,a,i){var o=e.url;Ht.supportsImageBitmapOptions().then((function(u){if(u&&i){var d=t.when.defer(),l=Ht._Implementations.loadWithXhr(o,"blob","GET",void 0,void 0,d,void 0,void 0,void 0);return t.defined(l)&&t.defined(l.abort)&&(e.cancelFunction=function(){l.abort()}),d.promise.then((function(e){if(t.defined(e))return Ht.createImageBitmapFromBlob(e,{flipY:a,premultiplyAlpha:!1});n.reject(new s.RuntimeError("Successfully retrieved "+o+" but it contained no content."))})).then(n.resolve)}!function(e,t,r){var n=new Image;n.onload=function(){r.resolve(n)},n.onerror=function(e){r.reject(e)},t&&(kt.contains(e)?n.crossOrigin="use-credentials":n.crossOrigin=""),n.src=e}(o,r,n)})).otherwise(n.reject)},Ht.createImageBitmapFromBlob=function(e,t){return n.Check.defined("options",t),n.Check.typeOf.bool("options.flipY",t.flipY),n.Check.typeOf.bool("options.premultiplyAlpha",t.premultiplyAlpha),createImageBitmap(e,{imageOrientation:t.flipY?"flipY":"none",premultiplyAlpha:t.premultiplyAlpha?"premultiply":"none"})};var Qt="undefined"==typeof XMLHttpRequest;function $t(e){if(e=t.defaultValue(e,t.defaultValue.EMPTY_OBJECT),this._dates=void 0,this._samples=void 0,this._dateColumn=-1,this._xPoleWanderRadiansColumn=-1,this._yPoleWanderRadiansColumn=-1,this._ut1MinusUtcSecondsColumn=-1,this._xCelestialPoleOffsetRadiansColumn=-1,this._yCelestialPoleOffsetRadiansColumn=-1,this._taiMinusUtcSecondsColumn=-1,this._columnCount=0,this._lastIndex=-1,this._downloadPromise=void 0,this._dataError=void 0,this._addNewLeapSeconds=t.defaultValue(e.addNewLeapSeconds,!0),t.defined(e.data))tr(this,e.data);else if(t.defined(e.url)){var r=Ht.createIfNeeded(e.url),n=this;this._downloadPromise=t.when(r.fetchJson(),(function(e){tr(n,e)}),(function(){n._dataError="An error occurred while retrieving the EOP data from the URL "+r.url+"."}))}else tr(this,{columnNames:["dateIso8601","modifiedJulianDateUtc","xPoleWanderRadians","yPoleWanderRadians","ut1MinusUtcSeconds","lengthOfDayCorrectionSeconds","xCelestialPoleOffsetRadians","yCelestialPoleOffsetRadians","taiMinusUtcSeconds"],samples:[]})}function er(e,t){return $e.compare(e.julianDate,t)}function tr(e,r){if(t.defined(r.columnNames))if(t.defined(r.samples)){var n=r.columnNames.indexOf("modifiedJulianDateUtc"),a=r.columnNames.indexOf("xPoleWanderRadians"),i=r.columnNames.indexOf("yPoleWanderRadians"),o=r.columnNames.indexOf("ut1MinusUtcSeconds"),s=r.columnNames.indexOf("xCelestialPoleOffsetRadians"),u=r.columnNames.indexOf("yCelestialPoleOffsetRadians"),d=r.columnNames.indexOf("taiMinusUtcSeconds");if(n<0||a<0||i<0||o<0||s<0||u<0||d<0)e._dataError="Error in loaded EOP data: The columnNames property must include modifiedJulianDateUtc, xPoleWanderRadians, yPoleWanderRadians, ut1MinusUtcSeconds, xCelestialPoleOffsetRadians, yCelestialPoleOffsetRadians, and taiMinusUtcSeconds columns";else{var l,c=e._samples=r.samples,f=e._dates=[];e._dateColumn=n,e._xPoleWanderRadiansColumn=a,e._yPoleWanderRadiansColumn=i,e._ut1MinusUtcSecondsColumn=o,e._xCelestialPoleOffsetRadiansColumn=s,e._yCelestialPoleOffsetRadiansColumn=u,e._taiMinusUtcSecondsColumn=d,e._columnCount=r.columnNames.length,e._lastIndex=void 0;for(var h=e._addNewLeapSeconds,p=0,m=c.length;p<m;p+=e._columnCount){var y=c[p+n],C=c[p+d],v=new $e(y+Ie.MODIFIED_JULIAN_DATE_DIFFERENCE,C,Pe.TAI);if(f.push(v),h){if(C!==l&&t.defined(l)){var w=$e.leapSeconds,g=De(w,v,er);if(g<0){var O=new Ae(v,C);w.splice(~g,0,O)}}l=C}}}}else e._dataError="Error in loaded EOP data: The samples property is required.";else e._dataError="Error in loaded EOP data: The columnNames property is required."}function rr(e,t,r,n,a){var i=r*n;a.xPoleWander=t[i+e._xPoleWanderRadiansColumn],a.yPoleWander=t[i+e._yPoleWanderRadiansColumn],a.xPoleOffset=t[i+e._xCelestialPoleOffsetRadiansColumn],a.yPoleOffset=t[i+e._yCelestialPoleOffsetRadiansColumn],a.ut1MinusUtc=t[i+e._ut1MinusUtcSecondsColumn]}function nr(e,t,r){return t+e*(r-t)}function ar(e,t,r,n,a,i,o){var s=e._columnCount;if(i>t.length-1)return o.xPoleWander=0,o.yPoleWander=0,o.xPoleOffset=0,o.yPoleOffset=0,o.ut1MinusUtc=0,o;var u=t[a],d=t[i];if(u.equals(d)||n.equals(u))return rr(e,r,a,s,o),o;if(n.equals(d))return rr(e,r,i,s,o),o;var l=$e.secondsDifference(n,u)/$e.secondsDifference(d,u),c=a*s,f=i*s,h=r[c+e._ut1MinusUtcSecondsColumn],p=r[f+e._ut1MinusUtcSecondsColumn],m=p-h;if(m>.5||m<-.5){var y=r[c+e._taiMinusUtcSecondsColumn],C=r[f+e._taiMinusUtcSecondsColumn];y!==C&&(d.equals(n)?h=p:p-=C-y)}return o.xPoleWander=nr(l,r[c+e._xPoleWanderRadiansColumn],r[f+e._xPoleWanderRadiansColumn]),o.yPoleWander=nr(l,r[c+e._yPoleWanderRadiansColumn],r[f+e._yPoleWanderRadiansColumn]),o.xPoleOffset=nr(l,r[c+e._xCelestialPoleOffsetRadiansColumn],r[f+e._xCelestialPoleOffsetRadiansColumn]),o.yPoleOffset=nr(l,r[c+e._yCelestialPoleOffsetRadiansColumn],r[f+e._yCelestialPoleOffsetRadiansColumn]),o.ut1MinusUtc=nr(l,h,p),o}function ir(e,r,n){this.heading=t.defaultValue(e,0),this.pitch=t.defaultValue(r,0),this.roll=t.defaultValue(n,0)}Ht._Implementations.loadWithXhr=function(e,n,a,i,o,u,d){var l=Xt.exec(e);if(null===l){if(!Qt){var c=new XMLHttpRequest;if(kt.contains(e)&&(c.withCredentials=!0),c.open(a,e,!0),t.defined(d)&&t.defined(c.overrideMimeType)&&c.overrideMimeType(d),t.defined(o))for(var f in o)o.hasOwnProperty(f)&&c.setRequestHeader(f,o[f]);t.defined(n)&&(c.responseType=n);var h=!1;return"string"==typeof e&&(h=0===e.indexOf("file://")||"undefined"!=typeof window&&"file://"===window.location.origin),c.onload=function(){if(!(c.status<200||c.status>=300)||h&&0===c.status){var e=c.response,r=c.responseType;if("HEAD"===a||"OPTIONS"===a){var i=c.getAllResponseHeaders().trim().split(/[\r\n]+/),o={};return i.forEach((function(e){var t=e.split(": "),r=t.shift();o[r]=t.join(": ")})),void u.resolve(o)}if(204===c.status)u.resolve();else if(!t.defined(e)||t.defined(n)&&r!==n)if("json"===n&&"string"==typeof e)try{u.resolve(JSON.parse(e))}catch(e){u.reject(e)}else(""===r||"document"===r)&&t.defined(c.responseXML)&&c.responseXML.hasChildNodes()?u.resolve(c.responseXML):""!==r&&"text"!==r||!t.defined(c.responseText)?u.reject(new s.RuntimeError("Invalid XMLHttpRequest response type.")):u.resolve(c.responseText);else u.resolve(e)}else u.reject(new wt(c.status,c.response,c.getAllResponseHeaders()))},c.onerror=function(e){u.reject(new wt)},c.send(i),c}!function(e,t,r,n,a,i,o){var u=require("url").parse(e),d="https:"===u.protocol?require("https"):require("http"),l=require("zlib"),c={protocol:u.protocol,hostname:u.hostname,port:u.port,path:u.path,query:u.query,method:r,headers:a};d.request(c).on("response",(function(e){if(e.statusCode<200||e.statusCode>=300)i.reject(new wt(e.statusCode,e,e.headers));else{var r=[];e.on("data",(function(e){r.push(e)})),e.on("end",(function(){var n=Buffer.concat(r);"gzip"===e.headers["content-encoding"]?l.gunzip(n,(function(e,r){e?i.reject(new s.RuntimeError("Error decompressing response.")):i.resolve(Kt(r,t))})):i.resolve(Kt(n,t))}))}})).on("error",(function(e){i.reject(new wt)})).end()}(e,n,a,0,o,u)}else u.resolve(function(e,n){n=t.defaultValue(n,"");var a=e[1],i=!!e[2],o=e[3];switch(n){case"":case"text":return Gt(i,o);case"arraybuffer":return Zt(i,o);case"blob":var s=Zt(i,o);return new Blob([s],{type:a});case"document":return(new DOMParser).parseFromString(Gt(i,o),a);case"json":return JSON.parse(Gt(i,o));default:throw new r.DeveloperError("Unhandled responseType: "+n)}}(l,n))},Ht._Implementations.loadAndExecuteScript=function(e,r,n){return function(e){var r=t.when.defer(),n=document.createElement("script");n.async=!0,n.src=e;var a=document.getElementsByTagName("head")[0];return n.onload=function(){n.onload=void 0,a.removeChild(n),r.resolve()},n.onerror=function(e){r.reject(e)},a.appendChild(n),r.promise}(e).otherwise(n.reject)},Ht._DefaultImplementations={},Ht._DefaultImplementations.createImage=Ht._Implementations.createImage,Ht._DefaultImplementations.loadWithXhr=Ht._Implementations.loadWithXhr,Ht._DefaultImplementations.loadAndExecuteScript=Ht._Implementations.loadAndExecuteScript,Ht.DEFAULT=Object.freeze(new Ht({url:"undefined"==typeof document?"":document.location.href.split("?")[0]})),$t.NONE=Object.freeze({getPromiseToLoad:function(){return t.when()},compute:function(e,r){return t.defined(r)?(r.xPoleWander=0,r.yPoleWander=0,r.xPoleOffset=0,r.yPoleOffset=0,r.ut1MinusUtc=0):r=new Se(0,0,0,0,0),r}}),$t.prototype.getPromiseToLoad=function(){return t.when(this._downloadPromise)},$t.prototype.compute=function(e,r){if(t.defined(this._samples)){if(t.defined(r)||(r=new Se(0,0,0,0,0)),0===this._samples.length)return r.xPoleWander=0,r.yPoleWander=0,r.xPoleOffset=0,r.yPoleOffset=0,r.ut1MinusUtc=0,r;var n=this._dates,a=this._lastIndex,i=0,o=0;if(t.defined(a)){var u=n[a],d=n[a+1],l=$e.lessThanOrEquals(u,e),c=!t.defined(d),f=c||$e.greaterThanOrEquals(d,e);if(l&&f)return i=a,!c&&d.equals(e)&&++i,o=i+1,ar(this,n,this._samples,e,i,o,r),r}var h=De(n,e,$e.compare,this._dateColumn);return h>=0?(h<n.length-1&&n[h+1].equals(e)&&++h,i=h,o=h):(i=(o=~h)-1)<0&&(i=0),this._lastIndex=i,ar(this,n,this._samples,e,i,o,r),r}if(t.defined(this._dataError))throw new s.RuntimeError(this._dataError)},ir.fromQuaternion=function(e,n){if(!t.defined(e))throw new r.DeveloperError("quaternion is required");t.defined(n)||(n=new ir);var i=2*(e.w*e.y-e.z*e.x),o=1-2*(e.x*e.x+e.y*e.y),s=2*(e.w*e.x+e.y*e.z),u=1-2*(e.y*e.y+e.z*e.z),d=2*(e.w*e.z+e.x*e.y);return n.heading=-Math.atan2(d,u),n.roll=Math.atan2(s,o),n.pitch=-a.CesiumMath.asinClamped(i),n},ir.fromDegrees=function(e,n,i,o){if(!t.defined(e))throw new r.DeveloperError("heading is required");if(!t.defined(n))throw new r.DeveloperError("pitch is required");if(!t.defined(i))throw new r.DeveloperError("roll is required");return t.defined(o)||(o=new ir),o.heading=e*a.CesiumMath.RADIANS_PER_DEGREE,o.pitch=n*a.CesiumMath.RADIANS_PER_DEGREE,o.roll=i*a.CesiumMath.RADIANS_PER_DEGREE,o},ir.clone=function(e,r){if(t.defined(e))return t.defined(r)?(r.heading=e.heading,r.pitch=e.pitch,r.roll=e.roll,r):new ir(e.heading,e.pitch,e.roll)},ir.equals=function(e,r){return e===r||t.defined(e)&&t.defined(r)&&e.heading===r.heading&&e.pitch===r.pitch&&e.roll===r.roll},ir.equalsEpsilon=function(e,r,n,i){return e===r||t.defined(e)&&t.defined(r)&&a.CesiumMath.equalsEpsilon(e.heading,r.heading,n,i)&&a.CesiumMath.equalsEpsilon(e.pitch,r.pitch,n,i)&&a.CesiumMath.equalsEpsilon(e.roll,r.roll,n,i)},ir.prototype.clone=function(e){return ir.clone(this,e)},ir.prototype.equals=function(e){return ir.equals(this,e)},ir.prototype.equalsEpsilon=function(e,t,r){return ir.equalsEpsilon(this,e,t,r)},ir.prototype.toString=function(){return"("+this.heading+", "+this.pitch+", "+this.roll+")"};var or,sr,ur,dr=/((?:.*\/)|^)Cesium\.js$/;function lr(e){return"undefined"==typeof document?e:(t.defined(or)||(or=document.createElement("a")),or.href=e,or.href=or.href,or.href)}function cr(){if(t.defined(sr))return sr;var e;if(e="undefined"!=typeof CESIUM_BASE_URL?CESIUM_BASE_URL:"object"==typeof define&&t.defined(define.amd)&&!define.amd.toUrlUndefined&&t.defined(require.toUrl)?lt("..",pr("Core/buildModuleUrl.js")):function(){for(var e=document.getElementsByTagName("script"),t=0,r=e.length;t<r;++t){var n=e[t].getAttribute("src"),a=dr.exec(n);if(null!==a)return a[1]}}(),!t.defined(e))throw new r.DeveloperError("Unable to determine Cesium base URL automatically, try defining a global variable called CESIUM_BASE_URL.");return(sr=new Ht({url:lr(e)})).appendForwardSlash(),sr}function fr(e){return lr(require.toUrl("../"+e))}function hr(e){return cr().getDerivedResource({url:e}).url}function pr(e){return t.defined(ur)||(ur="object"==typeof define&&t.defined(define.amd)&&!define.amd.toUrlUndefined&&t.defined(require.toUrl)?fr:hr),ur(e)}function mr(e,t,r){this.x=e,this.y=t,this.s=r}function yr(e){e=t.defaultValue(e,t.defaultValue.EMPTY_OBJECT),this._xysFileUrlTemplate=Ht.createIfNeeded(e.xysFileUrlTemplate),this._interpolationOrder=t.defaultValue(e.interpolationOrder,9),this._sampleZeroJulianEphemerisDate=t.defaultValue(e.sampleZeroJulianEphemerisDate,2442396.5),this._sampleZeroDateTT=new $e(this._sampleZeroJulianEphemerisDate,0,Pe.TAI),this._stepSizeDays=t.defaultValue(e.stepSizeDays,1),this._samplesPerXysFile=t.defaultValue(e.samplesPerXysFile,1e3),this._totalSamples=t.defaultValue(e.totalSamples,27426),this._samples=new Array(3*this._totalSamples),this._chunkDownloadsInProgress=[];for(var r=this._interpolationOrder,n=this._denominators=new Array(r+1),a=this._xTable=new Array(r+1),i=Math.pow(this._stepSizeDays,r),o=0;o<=r;++o){n[o]=i,a[o]=o*this._stepSizeDays;for(var s=0;s<=r;++s)s!==o&&(n[o]*=o-s);n[o]=1/n[o]}this._work=new Array(r+1),this._coef=new Array(r+1)}pr._cesiumScriptRegex=dr,pr._buildModuleUrlFromBaseUrl=hr,pr._clearBaseResource=function(){sr=void 0},pr.setBaseUrl=function(e){sr=Ht.DEFAULT.getDerivedResource({url:e})},pr.getCesiumBaseUrl=cr;var Cr=new $e(0,0,Pe.TAI);function vr(e,t,r){var n=Cr;return n.dayNumber=t,n.secondsOfDay=r,$e.daysDifference(n,e._sampleZeroDateTT)}function wr(e,r){if(e._chunkDownloadsInProgress[r])return e._chunkDownloadsInProgress[r];var n,a=t.when.defer();e._chunkDownloadsInProgress[r]=a;var i=e._xysFileUrlTemplate;return n=t.defined(i)?i.getDerivedResource({templateValues:{0:r}}):new Ht({url:pr("Assets/IAU2006_XYS/IAU2006_XYS_"+r+".json")}),t.when(n.fetchJson(),(function(t){e._chunkDownloadsInProgress[r]=!1;for(var n=e._samples,i=t.samples,o=r*e._samplesPerXysFile*3,s=0,u=i.length;s<u;++s)n[o+s]=i[s];a.resolve()})),a.promise}yr.prototype.preload=function(e,r,n,a){var i=vr(this,e,r),o=vr(this,n,a),s=i/this._stepSizeDays-this._interpolationOrder/2|0;s<0&&(s=0);var u=o/this._stepSizeDays-this._interpolationOrder/2|0+this._interpolationOrder;u>=this._totalSamples&&(u=this._totalSamples-1);for(var d=s/this._samplesPerXysFile|0,l=u/this._samplesPerXysFile|0,c=[],f=d;f<=l;++f)c.push(wr(this,f));return t.when.all(c)},yr.prototype.computeXysRadians=function(e,r,n){var a=vr(this,e,r);if(!(a<0)){var i=a/this._stepSizeDays|0;if(!(i>=this._totalSamples)){var o=this._interpolationOrder,s=i-(o/2|0);s<0&&(s=0);var u=s+o;u>=this._totalSamples&&(s=(u=this._totalSamples-1)-o)<0&&(s=0);var d=!1,l=this._samples;if(t.defined(l[3*s])||(wr(this,s/this._samplesPerXysFile|0),d=!0),t.defined(l[3*u])||(wr(this,u/this._samplesPerXysFile|0),d=!0),!d){t.defined(n)?(n.x=0,n.y=0,n.s=0):n=new mr(0,0,0);var c,f,h=a-s*this._stepSizeDays,p=this._work,m=this._denominators,y=this._coef,C=this._xTable;for(c=0;c<=o;++c)p[c]=h-C[c];for(c=0;c<=o;++c){for(y[c]=1,f=0;f<=o;++f)f!==c&&(y[c]*=p[f]);y[c]*=m[c];var v=3*(s+c);n.x+=y[c]*l[v++],n.y+=y[c]*l[v++],n.s+=y[c]*l[v]}return n}}}};var gr={},Or={up:{south:"east",north:"west",west:"south",east:"north"},down:{south:"west",north:"east",west:"north",east:"south"},south:{up:"west",down:"east",west:"down",east:"up"},north:{up:"east",down:"west",west:"up",east:"down"},west:{up:"north",down:"south",north:"down",south:"up"},east:{up:"south",down:"north",north:"up",south:"down"}},xr={north:[-1,0,0],east:[0,1,0],up:[0,0,1],south:[1,0,0],west:[0,-1,0],down:[0,0,-1]},Er={},_r={east:new a.Cartesian3,north:new a.Cartesian3,up:new a.Cartesian3,west:new a.Cartesian3,south:new a.Cartesian3,down:new a.Cartesian3},br=new a.Cartesian3,qr=new a.Cartesian3,Dr=new a.Cartesian3;gr.localFrameToFixedFrameGenerator=function(e,n){if(!Or.hasOwnProperty(e)||!Or[e].hasOwnProperty(n))throw new r.DeveloperError("firstAxis and secondAxis must be east, north, up, west, south or down.");var s,u=Or[e][n],d=e+n;return t.defined(Er[d])?s=Er[d]:(s=function(s,d,l){if(!t.defined(s))throw new r.DeveloperError("origin is required.");if(t.defined(l)||(l=new o.Matrix4),a.Cartesian3.equalsEpsilon(s,a.Cartesian3.ZERO,a.CesiumMath.EPSILON14))a.Cartesian3.unpack(xr[e],0,br),a.Cartesian3.unpack(xr[n],0,qr),a.Cartesian3.unpack(xr[u],0,Dr);else if(a.CesiumMath.equalsEpsilon(s.x,0,a.CesiumMath.EPSILON14)&&a.CesiumMath.equalsEpsilon(s.y,0,a.CesiumMath.EPSILON14)){var c=a.CesiumMath.sign(s.z);a.Cartesian3.unpack(xr[e],0,br),"east"!==e&&"west"!==e&&a.Cartesian3.multiplyByScalar(br,c,br),a.Cartesian3.unpack(xr[n],0,qr),"east"!==n&&"west"!==n&&a.Cartesian3.multiplyByScalar(qr,c,qr),a.Cartesian3.unpack(xr[u],0,Dr),"east"!==u&&"west"!==u&&a.Cartesian3.multiplyByScalar(Dr,c,Dr)}else{(d=t.defaultValue(d,i.Ellipsoid.WGS84)).geodeticSurfaceNormal(s,_r.up);var f=_r.up,h=_r.east;h.x=-s.y,h.y=s.x,h.z=0,a.Cartesian3.normalize(h,_r.east),a.Cartesian3.cross(f,h,_r.north),a.Cartesian3.multiplyByScalar(_r.up,-1,_r.down),a.Cartesian3.multiplyByScalar(_r.east,-1,_r.west),a.Cartesian3.multiplyByScalar(_r.north,-1,_r.south),br=_r[e],qr=_r[n],Dr=_r[u]}return l[0]=br.x,l[1]=br.y,l[2]=br.z,l[3]=0,l[4]=qr.x,l[5]=qr.y,l[6]=qr.z,l[7]=0,l[8]=Dr.x,l[9]=Dr.y,l[10]=Dr.z,l[11]=0,l[12]=s.x,l[13]=s.y,l[14]=s.z,l[15]=1,l},Er[d]=s),s},gr.eastNorthUpToFixedFrame=gr.localFrameToFixedFrameGenerator("east","north"),gr.northEastDownToFixedFrame=gr.localFrameToFixedFrameGenerator("north","east"),gr.northUpEastToFixedFrame=gr.localFrameToFixedFrameGenerator("north","up"),gr.northWestUpToFixedFrame=gr.localFrameToFixedFrameGenerator("north","west");var Sr=new K,Rr=new a.Cartesian3(1,1,1),Mr=new o.Matrix4;gr.headingPitchRollToFixedFrame=function(e,r,i,s,u){n.Check.typeOf.object("HeadingPitchRoll",r),s=t.defaultValue(s,gr.eastNorthUpToFixedFrame);var d=K.fromHeadingPitchRoll(r,Sr),l=o.Matrix4.fromTranslationQuaternionRotationScale(a.Cartesian3.ZERO,d,Rr,Mr);return u=s(e,i,u),o.Matrix4.multiply(u,l,u)};var Tr=new o.Matrix4,Ar=new o.Matrix3;gr.headingPitchRollQuaternion=function(e,t,r,a,i){n.Check.typeOf.object("HeadingPitchRoll",t);var s=gr.headingPitchRollToFixedFrame(e,t,r,a,Tr),u=o.Matrix4.getMatrix3(s,Ar);return K.fromRotationMatrix(u,i)};var Ir=new a.Cartesian3(1,1,1),Pr=new a.Cartesian3,Ur=new o.Matrix4,jr=new o.Matrix4,kr=new o.Matrix3,Nr=new K;gr.fixedFrameToHeadingPitchRoll=function(e,r,s,u){n.Check.defined("transform",e),r=t.defaultValue(r,i.Ellipsoid.WGS84),s=t.defaultValue(s,gr.eastNorthUpToFixedFrame),t.defined(u)||(u=new ir);var d=o.Matrix4.getTranslation(e,Pr);if(a.Cartesian3.equals(d,a.Cartesian3.ZERO))return u.heading=0,u.pitch=0,u.roll=0,u;var l=o.Matrix4.inverseTransformation(s(d,r,Ur),Ur),c=o.Matrix4.setScale(e,Ir,jr);c=o.Matrix4.setTranslation(c,a.Cartesian3.ZERO,c),l=o.Matrix4.multiply(l,c,l);var f=K.fromRotationMatrix(o.Matrix4.getMatrix3(l,kr),Nr);return f=K.normalize(f,f),ir.fromQuaternion(f,u)};var zr=a.CesiumMath.TWO_PI/86400,Fr=new $e;gr.computeTemeToPseudoFixedMatrix=function(e,n){if(!t.defined(e))throw new r.DeveloperError("date is required.");var i,s=(Fr=$e.addSeconds(e,-$e.computeTaiMinusUtc(e),Fr)).dayNumber,u=Fr.secondsOfDay,d=s-2451545,l=(24110.54841+(i=u>=43200?(d+.5)/Ie.DAYS_PER_JULIAN_CENTURY:(d-.5)/Ie.DAYS_PER_JULIAN_CENTURY)*(8640184.812866+i*(.093104+-62e-7*i)))*zr%a.CesiumMath.TWO_PI+(72921158553e-15+11772758384668e-32*(s-2451545.5))*((u+.5*Ie.SECONDS_PER_DAY)%Ie.SECONDS_PER_DAY),c=Math.cos(l),f=Math.sin(l);return t.defined(n)?(n[0]=c,n[1]=-f,n[2]=0,n[3]=f,n[4]=c,n[5]=0,n[6]=0,n[7]=0,n[8]=1,n):new o.Matrix3(c,f,0,-f,c,0,0,0,1)},gr.iau2006XysData=new yr,gr.earthOrientationParameters=$t.NONE;gr.preloadIcrfFixed=function(e){var r=e.start.dayNumber,n=e.start.secondsOfDay+32.184,a=e.stop.dayNumber,i=e.stop.secondsOfDay+32.184,o=gr.iau2006XysData.preload(r,n,a,i),s=gr.earthOrientationParameters.getPromiseToLoad();return t.when.all([o,s])},gr.computeIcrfToFixedMatrix=function(e,n){if(!t.defined(e))throw new r.DeveloperError("date is required.");t.defined(n)||(n=new o.Matrix3);var a=gr.computeFixedToIcrfMatrix(e,n);if(t.defined(a))return o.Matrix3.transpose(a,n)};var Br=new mr(0,0,0),Vr=new Se(0,0,0,0,0,0),Lr=new o.Matrix3,Wr=new o.Matrix3;gr.computeFixedToIcrfMatrix=function(e,n){if(!t.defined(e))throw new r.DeveloperError("date is required.");t.defined(n)||(n=new o.Matrix3);var i=gr.earthOrientationParameters.compute(e,Vr);if(t.defined(i)){var s=e.dayNumber,u=e.secondsOfDay+32.184,d=gr.iau2006XysData.computeXysRadians(s,u,Br);if(t.defined(d)){var l=d.x+i.xPoleOffset,c=d.y+i.yPoleOffset,f=1/(1+Math.sqrt(1-l*l-c*c)),h=Lr;h[0]=1-f*l*l,h[3]=-f*l*c,h[6]=l,h[1]=-f*l*c,h[4]=1-f*c*c,h[7]=c,h[2]=-l,h[5]=-c,h[8]=1-f*(l*l+c*c);var p=o.Matrix3.fromRotationZ(-d.s,Wr),m=o.Matrix3.multiply(h,p,Lr),y=e.dayNumber-2451545,C=(e.secondsOfDay-$e.computeTaiMinusUtc(e)+i.ut1MinusUtc)/Ie.SECONDS_PER_DAY,v=.779057273264+C+.00273781191135448*(y+C);v=v%1*a.CesiumMath.TWO_PI;var w=o.Matrix3.fromRotationZ(v,Wr),g=o.Matrix3.multiply(m,w,Lr),O=Math.cos(i.xPoleWander),x=Math.cos(i.yPoleWander),E=Math.sin(i.xPoleWander),_=Math.sin(i.yPoleWander),b=s-2451545+u/Ie.SECONDS_PER_DAY,q=-47e-6*(b/=36525)*a.CesiumMath.RADIANS_PER_DEGREE/3600,D=Math.cos(q),S=Math.sin(q),R=Wr;return R[0]=O*D,R[1]=O*S,R[2]=E,R[3]=-x*S+_*E*D,R[4]=x*D+_*E*S,R[5]=-_*O,R[6]=-_*S-x*E*D,R[7]=_*D-x*E*S,R[8]=x*O,o.Matrix3.multiply(g,R,n)}}};var Yr=new o.Cartesian4;gr.pointToWindowCoordinates=function(e,t,r,n){return(n=gr.pointToGLWindowCoordinates(e,t,r,n)).y=2*t[5]-n.y,n},gr.pointToGLWindowCoordinates=function(e,n,a,i){if(!t.defined(e))throw new r.DeveloperError("modelViewProjectionMatrix is required.");if(!t.defined(n))throw new r.DeveloperError("viewportTransformation is required.");if(!t.defined(a))throw new r.DeveloperError("point is required.");t.defined(i)||(i=new u.Cartesian2);var s=Yr;return o.Matrix4.multiplyByVector(e,o.Cartesian4.fromElements(a.x,a.y,a.z,1,s),s),o.Cartesian4.multiplyByScalar(s,1/s.w,s),o.Matrix4.multiplyByVector(n,s,s),u.Cartesian2.fromCartesian4(s,i)};var Hr=new a.Cartesian3,Jr=new a.Cartesian3,Xr=new a.Cartesian3;gr.rotationMatrixFromPositionVelocity=function(e,n,s,u){if(!t.defined(e))throw new r.DeveloperError("position is required.");if(!t.defined(n))throw new r.DeveloperError("velocity is required.");var d=t.defaultValue(s,i.Ellipsoid.WGS84).geodeticSurfaceNormal(e,Hr),l=a.Cartesian3.cross(n,d,Jr);a.Cartesian3.equalsEpsilon(l,a.Cartesian3.ZERO,a.CesiumMath.EPSILON6)&&(l=a.Cartesian3.clone(a.Cartesian3.UNIT_X,l));var c=a.Cartesian3.cross(l,n,Xr);return a.Cartesian3.normalize(c,c),a.Cartesian3.cross(n,c,l),a.Cartesian3.negate(l,l),a.Cartesian3.normalize(l,l),t.defined(u)||(u=new o.Matrix3),u[0]=n.x,u[1]=n.y,u[2]=n.z,u[3]=l.x,u[4]=l.y,u[5]=l.z,u[6]=c.x,u[7]=c.y,u[8]=c.z,u};var Gr=new o.Matrix4(0,0,1,0,1,0,0,0,0,1,0,0,0,0,0,1),Zr=new i.Cartographic,Kr=new a.Cartesian3,Qr=new a.Cartesian3,$r=new o.Matrix3,en=new o.Matrix4,tn=new o.Matrix4;gr.basisTo2D=function(e,n,i){if(!t.defined(e))throw new r.DeveloperError("projection is required.");if(!t.defined(n))throw new r.DeveloperError("matrix is required.");if(!t.defined(i))throw new r.DeveloperError("result is required.");var s=o.Matrix4.getTranslation(n,Qr),u=e.ellipsoid,d=u.cartesianToCartographic(s,Zr),l=e.project(d,Kr);a.Cartesian3.fromElements(l.z,l.x,l.y,l);var c=gr.eastNorthUpToFixedFrame(s,u,en),f=o.Matrix4.inverseTransformation(c,tn),h=o.Matrix4.getMatrix3(n,$r),p=o.Matrix4.multiplyByMatrix3(f,h,i);return o.Matrix4.multiply(Gr,p,i),o.Matrix4.setTranslation(i,l,i),i},gr.wgs84To2DModelMatrix=function(e,n,i){if(!t.defined(e))throw new r.DeveloperError("projection is required.");if(!t.defined(n))throw new r.DeveloperError("center is required.");if(!t.defined(i))throw new r.DeveloperError("result is required.");var s=e.ellipsoid,u=gr.eastNorthUpToFixedFrame(n,s,en),d=o.Matrix4.inverseTransformation(u,tn),l=s.cartesianToCartographic(n,Zr),c=e.project(l,Kr);a.Cartesian3.fromElements(c.z,c.x,c.y,c);var f=o.Matrix4.fromTranslation(c,en);return o.Matrix4.multiply(Gr,d,i),o.Matrix4.multiply(f,i,i),i},e.BoundingSphere=h,e.GeographicProjection=l,e.Intersect=c,e.Interval=f,e.Quaternion=K,e.Resource=Ht,e.Transforms=gr,e.buildModuleUrl=pr}));
//# sourceMappingURL=Transforms-7a1c9ee7.js.map
