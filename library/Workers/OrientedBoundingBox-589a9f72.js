define(["exports","./when-7ef6387a","./DeveloperError-101d8eb9","./Check-71521db1","./Cartesian3-ca5d3f12","./Ellipsoid-57478151","./Transforms-7a1c9ee7","./Matrix4-027dd006","./Cartesian2-d6edb867","./Plane-08adaa50","./EllipsoidTangentPlane-679fd128"],(function(a,e,t,r,n,i,s,o,d,C,u){"use strict";function c(a,t){this.center=n.Cartesian3.clone(e.defaultValue(a,n.Cartesian3.ZERO)),this.halfAxes=o.Matrix3.clone(e.defaultValue(t,o.Matrix3.ZERO))}c.packedLength=n.Cartesian3.packedLength+o.Matrix3.packedLength,c.pack=function(a,t,i){return r.Check.typeOf.object("value",a),r.Check.defined("array",t),i=e.defaultValue(i,0),n.Cartesian3.pack(a.center,t,i),o.Matrix3.pack(a.halfAxes,t,i+n.Cartesian3.packedLength),t},c.unpack=function(a,t,i){return r.Check.defined("array",a),t=e.defaultValue(t,0),e.defined(i)||(i=new c),n.Cartesian3.unpack(a,t,i.center),o.Matrix3.unpack(a,t+n.Cartesian3.packedLength,i.halfAxes),i};var l=new n.Cartesian3,h=new n.Cartesian3,f=new n.Cartesian3,m=new n.Cartesian3,x=new n.Cartesian3,p=new n.Cartesian3,M=new o.Matrix3,w={unitary:new o.Matrix3,diagonal:new o.Matrix3};c.fromPoints=function(a,t){if(e.defined(t)||(t=new c),!e.defined(a)||0===a.length)return t.halfAxes=o.Matrix3.ZERO,t.center=n.Cartesian3.ZERO,t;var r,i=a.length,s=n.Cartesian3.clone(a[0],l);for(r=1;r<i;r++)n.Cartesian3.add(s,a[r],s);var d=1/i;n.Cartesian3.multiplyByScalar(s,d,s);var C,u=0,g=0,b=0,v=0,y=0,E=0;for(r=0;r<i;r++)u+=(C=n.Cartesian3.subtract(a[r],s,h)).x*C.x,g+=C.x*C.y,b+=C.x*C.z,v+=C.y*C.y,y+=C.y*C.z,E+=C.z*C.z;u*=d,g*=d,b*=d,v*=d,y*=d,E*=d;var O=M;O[0]=u,O[1]=g,O[2]=b,O[3]=g,O[4]=v,O[5]=y,O[6]=b,O[7]=y,O[8]=E;var P=o.Matrix3.computeEigenDecomposition(O,w),N=o.Matrix3.clone(P.unitary,t.halfAxes),A=o.Matrix3.getColumn(N,0,m),T=o.Matrix3.getColumn(N,1,x),R=o.Matrix3.getColumn(N,2,p),I=-Number.MAX_VALUE,D=-Number.MAX_VALUE,L=-Number.MAX_VALUE,z=Number.MAX_VALUE,S=Number.MAX_VALUE,q=Number.MAX_VALUE;for(r=0;r<i;r++)C=a[r],I=Math.max(n.Cartesian3.dot(A,C),I),D=Math.max(n.Cartesian3.dot(T,C),D),L=Math.max(n.Cartesian3.dot(R,C),L),z=Math.min(n.Cartesian3.dot(A,C),z),S=Math.min(n.Cartesian3.dot(T,C),S),q=Math.min(n.Cartesian3.dot(R,C),q);A=n.Cartesian3.multiplyByScalar(A,.5*(z+I),A),T=n.Cartesian3.multiplyByScalar(T,.5*(S+D),T),R=n.Cartesian3.multiplyByScalar(R,.5*(q+L),R);var U=n.Cartesian3.add(A,T,t.center);n.Cartesian3.add(U,R,U);var V=f;return V.x=I-z,V.y=D-S,V.z=L-q,n.Cartesian3.multiplyByScalar(V,.5,V),o.Matrix3.multiplyByScale(t.halfAxes,V,t.halfAxes),t};var g=new n.Cartesian3,b=new n.Cartesian3;function v(a,r,i,s,d,C,u,l,h,f,m){if(!(e.defined(d)&&e.defined(C)&&e.defined(u)&&e.defined(l)&&e.defined(h)&&e.defined(f)))throw new t.DeveloperError("all extents (minimum/maximum X/Y/Z) are required.");e.defined(m)||(m=new c);var x=m.halfAxes;o.Matrix3.setColumn(x,0,r,x),o.Matrix3.setColumn(x,1,i,x),o.Matrix3.setColumn(x,2,s,x);var p=g;p.x=(d+C)/2,p.y=(u+l)/2,p.z=(h+f)/2;var M=b;M.x=(C-d)/2,M.y=(l-u)/2,M.z=(f-h)/2;var w=m.center;return p=o.Matrix3.multiplyByVector(x,p,p),n.Cartesian3.add(a,p,w),o.Matrix3.multiplyByScale(x,M,x),m}var y=new i.Cartographic,E=new n.Cartesian3,O=new i.Cartographic,P=new i.Cartographic,N=new i.Cartographic,A=new i.Cartographic,T=new i.Cartographic,R=new n.Cartesian3,I=new n.Cartesian3,D=new n.Cartesian3,L=new n.Cartesian3,z=new n.Cartesian3,S=new d.Cartesian2,q=new d.Cartesian2,U=new d.Cartesian2,V=new d.Cartesian2,k=new d.Cartesian2,B=new n.Cartesian3,_=new n.Cartesian3,W=new n.Cartesian3,X=new n.Cartesian3,j=new d.Cartesian2,Z=new n.Cartesian3,G=new n.Cartesian3,Y=new n.Cartesian3,F=new C.Plane(n.Cartesian3.UNIT_X,0);c.fromRectangle=function(a,r,s,o,c){if(!e.defined(a))throw new t.DeveloperError("rectangle is required");if(a.width<0||a.width>n.CesiumMath.TWO_PI)throw new t.DeveloperError("Rectangle width must be between 0 and 2*pi");if(a.height<0||a.height>n.CesiumMath.PI)throw new t.DeveloperError("Rectangle height must be between 0 and pi");if(e.defined(o)&&!n.CesiumMath.equalsEpsilon(o.radii.x,o.radii.y,n.CesiumMath.EPSILON15))throw new t.DeveloperError("Ellipsoid must be an ellipsoid of revolution (radii.x == radii.y)");var l,h,f,m,x,p,M;if(r=e.defaultValue(r,0),s=e.defaultValue(s,0),o=e.defaultValue(o,i.Ellipsoid.WGS84),a.width<=n.CesiumMath.PI){var w=d.Rectangle.center(a,y),g=o.cartographicToCartesian(w,E),b=new u.EllipsoidTangentPlane(g,o);M=b.plane;var H=w.longitude,J=a.south<0&&a.north>0?0:w.latitude,K=i.Cartographic.fromRadians(H,a.north,s,O),Q=i.Cartographic.fromRadians(a.west,a.north,s,P),$=i.Cartographic.fromRadians(a.west,J,s,N),aa=i.Cartographic.fromRadians(a.west,a.south,s,A),ea=i.Cartographic.fromRadians(H,a.south,s,T),ta=o.cartographicToCartesian(K,R),ra=o.cartographicToCartesian(Q,I),na=o.cartographicToCartesian($,D),ia=o.cartographicToCartesian(aa,L),sa=o.cartographicToCartesian(ea,z),oa=b.projectPointToNearestOnPlane(ta,S),da=b.projectPointToNearestOnPlane(ra,q),Ca=b.projectPointToNearestOnPlane(na,U),ua=b.projectPointToNearestOnPlane(ia,V),ca=b.projectPointToNearestOnPlane(sa,k);return h=-(l=Math.min(da.x,Ca.x,ua.x)),m=Math.max(da.y,oa.y),f=Math.min(ua.y,ca.y),Q.height=aa.height=r,ra=o.cartographicToCartesian(Q,I),ia=o.cartographicToCartesian(aa,L),x=Math.min(C.Plane.getPointDistance(M,ra),C.Plane.getPointDistance(M,ia)),p=s,v(b.origin,b.xAxis,b.yAxis,b.zAxis,l,h,f,m,x,p,c)}var la=a.south>0,ha=a.north<0,fa=la?a.south:ha?a.north:0,ma=d.Rectangle.center(a,y).longitude,xa=n.Cartesian3.fromRadians(ma,fa,s,o,B);xa.z=0;var pa=Math.abs(xa.x)<n.CesiumMath.EPSILON10&&Math.abs(xa.y)<n.CesiumMath.EPSILON10?n.Cartesian3.UNIT_X:n.Cartesian3.normalize(xa,_),Ma=n.Cartesian3.UNIT_Z,wa=n.Cartesian3.cross(pa,Ma,W);M=C.Plane.fromPointNormal(xa,pa,F);var ga=n.Cartesian3.fromRadians(ma+n.CesiumMath.PI_OVER_TWO,fa,s,o,X);l=-(h=n.Cartesian3.dot(C.Plane.projectPointOntoPlane(M,ga,j),wa)),m=n.Cartesian3.fromRadians(0,a.north,ha?r:s,o,Z).z,f=n.Cartesian3.fromRadians(0,a.south,la?r:s,o,G).z;var ba=n.Cartesian3.fromRadians(a.east,fa,s,o,Y);return v(xa,wa,Ma,pa,l,h,f,m,x=C.Plane.getPointDistance(M,ba),p=0,c)},c.clone=function(a,t){if(e.defined(a))return e.defined(t)?(n.Cartesian3.clone(a.center,t.center),o.Matrix3.clone(a.halfAxes,t.halfAxes),t):new c(a.center,a.halfAxes)},c.intersectPlane=function(a,r){if(!e.defined(a))throw new t.DeveloperError("box is required.");if(!e.defined(r))throw new t.DeveloperError("plane is required.");var i=a.center,d=r.normal,C=a.halfAxes,u=d.x,c=d.y,l=d.z,h=Math.abs(u*C[o.Matrix3.COLUMN0ROW0]+c*C[o.Matrix3.COLUMN0ROW1]+l*C[o.Matrix3.COLUMN0ROW2])+Math.abs(u*C[o.Matrix3.COLUMN1ROW0]+c*C[o.Matrix3.COLUMN1ROW1]+l*C[o.Matrix3.COLUMN1ROW2])+Math.abs(u*C[o.Matrix3.COLUMN2ROW0]+c*C[o.Matrix3.COLUMN2ROW1]+l*C[o.Matrix3.COLUMN2ROW2]),f=n.Cartesian3.dot(d,i)+r.distance;return f<=-h?s.Intersect.OUTSIDE:f>=h?s.Intersect.INSIDE:s.Intersect.INTERSECTING};var H=new n.Cartesian3,J=new n.Cartesian3,K=new n.Cartesian3,Q=new n.Cartesian3;c.distanceSquaredTo=function(a,r){if(!e.defined(a))throw new t.DeveloperError("box is required.");if(!e.defined(r))throw new t.DeveloperError("cartesian is required.");var i=n.Cartesian3.subtract(r,a.center,g),s=a.halfAxes,d=o.Matrix3.getColumn(s,0,H),C=o.Matrix3.getColumn(s,1,J),u=o.Matrix3.getColumn(s,2,K),c=n.Cartesian3.magnitude(d),l=n.Cartesian3.magnitude(C),h=n.Cartesian3.magnitude(u);n.Cartesian3.normalize(d,d),n.Cartesian3.normalize(C,C),n.Cartesian3.normalize(u,u);var f=Q;f.x=n.Cartesian3.dot(i,d),f.y=n.Cartesian3.dot(i,C),f.z=n.Cartesian3.dot(i,u);var m,x=0;return f.x<-c?x+=(m=f.x+c)*m:f.x>c&&(x+=(m=f.x-c)*m),f.y<-l?x+=(m=f.y+l)*m:f.y>l&&(x+=(m=f.y-l)*m),f.z<-h?x+=(m=f.z+h)*m:f.z>h&&(x+=(m=f.z-h)*m),x};var $=new n.Cartesian3,aa=new n.Cartesian3;c.computePlaneDistances=function(a,r,i,d){if(!e.defined(a))throw new t.DeveloperError("box is required.");if(!e.defined(r))throw new t.DeveloperError("position is required.");if(!e.defined(i))throw new t.DeveloperError("direction is required.");e.defined(d)||(d=new s.Interval);var C=Number.POSITIVE_INFINITY,u=Number.NEGATIVE_INFINITY,c=a.center,l=a.halfAxes,h=o.Matrix3.getColumn(l,0,H),f=o.Matrix3.getColumn(l,1,J),m=o.Matrix3.getColumn(l,2,K),x=n.Cartesian3.add(h,f,$);n.Cartesian3.add(x,m,x),n.Cartesian3.add(x,c,x);var p=n.Cartesian3.subtract(x,r,aa),M=n.Cartesian3.dot(i,p);return C=Math.min(M,C),u=Math.max(M,u),n.Cartesian3.add(c,h,x),n.Cartesian3.add(x,f,x),n.Cartesian3.subtract(x,m,x),n.Cartesian3.subtract(x,r,p),M=n.Cartesian3.dot(i,p),C=Math.min(M,C),u=Math.max(M,u),n.Cartesian3.add(c,h,x),n.Cartesian3.subtract(x,f,x),n.Cartesian3.add(x,m,x),n.Cartesian3.subtract(x,r,p),M=n.Cartesian3.dot(i,p),C=Math.min(M,C),u=Math.max(M,u),n.Cartesian3.add(c,h,x),n.Cartesian3.subtract(x,f,x),n.Cartesian3.subtract(x,m,x),n.Cartesian3.subtract(x,r,p),M=n.Cartesian3.dot(i,p),C=Math.min(M,C),u=Math.max(M,u),n.Cartesian3.subtract(c,h,x),n.Cartesian3.add(x,f,x),n.Cartesian3.add(x,m,x),n.Cartesian3.subtract(x,r,p),M=n.Cartesian3.dot(i,p),C=Math.min(M,C),u=Math.max(M,u),n.Cartesian3.subtract(c,h,x),n.Cartesian3.add(x,f,x),n.Cartesian3.subtract(x,m,x),n.Cartesian3.subtract(x,r,p),M=n.Cartesian3.dot(i,p),C=Math.min(M,C),u=Math.max(M,u),n.Cartesian3.subtract(c,h,x),n.Cartesian3.subtract(x,f,x),n.Cartesian3.add(x,m,x),n.Cartesian3.subtract(x,r,p),M=n.Cartesian3.dot(i,p),C=Math.min(M,C),u=Math.max(M,u),n.Cartesian3.subtract(c,h,x),n.Cartesian3.subtract(x,f,x),n.Cartesian3.subtract(x,m,x),n.Cartesian3.subtract(x,r,p),M=n.Cartesian3.dot(i,p),C=Math.min(M,C),u=Math.max(M,u),d.start=C,d.stop=u,d};var ea=new s.BoundingSphere;c.isOccluded=function(a,r){if(!e.defined(a))throw new t.DeveloperError("box is required.");if(!e.defined(r))throw new t.DeveloperError("occluder is required.");var n=s.BoundingSphere.fromOrientedBoundingBox(a,ea);return!r.isBoundingSphereVisible(n)},c.prototype.intersectPlane=function(a){return c.intersectPlane(this,a)},c.prototype.distanceSquaredTo=function(a){return c.distanceSquaredTo(this,a)},c.prototype.computePlaneDistances=function(a,e,t){return c.computePlaneDistances(this,a,e,t)},c.prototype.isOccluded=function(a){return c.isOccluded(this,a)},c.equals=function(a,t){return a===t||e.defined(a)&&e.defined(t)&&n.Cartesian3.equals(a.center,t.center)&&o.Matrix3.equals(a.halfAxes,t.halfAxes)},c.prototype.clone=function(a){return c.clone(this,a)},c.prototype.equals=function(a){return c.equals(this,a)},a.OrientedBoundingBox=c}));
//# sourceMappingURL=OrientedBoundingBox-589a9f72.js.map
