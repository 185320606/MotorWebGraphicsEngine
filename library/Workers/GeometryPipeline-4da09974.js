define(["exports","./when-7ef6387a","./DeveloperError-101d8eb9","./Check-71521db1","./Cartesian3-ca5d3f12","./Ellipsoid-57478151","./Transforms-7a1c9ee7","./Matrix4-027dd006","./Cartesian2-d6edb867","./ComponentDatatype-f4fabeaa","./GeometryAttribute-c5b9902a","./PrimitiveType-4c1d698a","./AttributeCompression-9dc08742","./EncodedCartesian3-2bb7c2ad","./IndexDatatype-bfeda8ca","./IntersectionTests-2926775d","./Plane-08adaa50"],(function(e,t,r,i,a,n,o,s,u,p,d,l,v,f,m,y,c){"use strict";var h=new a.Cartesian3,C=new a.Cartesian3,b=new a.Cartesian3;var w={calculateACMR:function(e){var i=(e=t.defaultValue(e,t.defaultValue.EMPTY_OBJECT)).indices,a=e.maximumIndex,n=t.defaultValue(e.cacheSize,24);if(!t.defined(i))throw new r.DeveloperError("indices is required.");var o=i.length;if(o<3||o%3!=0)throw new r.DeveloperError("indices length must be a multiple of three.");if(a<=0)throw new r.DeveloperError("maximumIndex must be greater than zero.");if(n<3)throw new r.DeveloperError("cacheSize must be greater than two.");if(!t.defined(a)){a=0;for(var s=0,u=i[s];s<o;)u>a&&(a=u),u=i[++s]}for(var p=[],d=0;d<a+1;d++)p[d]=0;for(var l=n+1,v=0;v<o;++v)l-p[i[v]]>n&&(p[i[v]]=l,++l);return(l-n+1)/(o/3)}};w.tipsify=function(e){var i,a=(e=t.defaultValue(e,t.defaultValue.EMPTY_OBJECT)).indices,n=e.maximumIndex,o=t.defaultValue(e.cacheSize,24);function s(e,t,r,a,n,o,s){for(var u,p=-1,d=-1,l=0;l<r.length;){var v=r[l];a[v].numLiveTriangles&&(u=0,n-a[v].timeStamp+2*a[v].numLiveTriangles<=t&&(u=n-a[v].timeStamp),(u>d||-1===d)&&(d=u,p=v)),++l}return-1===p?function(e,t,r,a){for(;t.length>=1;){var n=t[t.length-1];if(t.splice(t.length-1,1),e[n].numLiveTriangles>0)return n}for(;i<a;){if(e[i].numLiveTriangles>0)return++i-1;++i}return-1}(a,o,0,s):p}if(!t.defined(a))throw new r.DeveloperError("indices is required.");var u=a.length;if(u<3||u%3!=0)throw new r.DeveloperError("indices length must be a multiple of three.");if(n<=0)throw new r.DeveloperError("maximumIndex must be greater than zero.");if(o<3)throw new r.DeveloperError("cacheSize must be greater than two.");var p=0,d=0,l=a[d],v=u;if(t.defined(n))p=n+1;else{for(;d<v;)l>p&&(p=l),l=a[++d];if(-1===p)return 0;++p}var f,m=[];for(f=0;f<p;f++)m[f]={numLiveTriangles:0,timeStamp:0,vertexTriangles:[]};d=0;for(var y=0;d<v;)m[a[d]].vertexTriangles.push(y),++m[a[d]].numLiveTriangles,m[a[d+1]].vertexTriangles.push(y),++m[a[d+1]].numLiveTriangles,m[a[d+2]].vertexTriangles.push(y),++m[a[d+2]].numLiveTriangles,++y,d+=3;var c=0,h=o+1;i=1;var C,b,w,g,T=[],E=[],A=0,D=[],x=u/3,P=[];for(f=0;f<x;f++)P[f]=!1;for(;-1!==c;){T=[],g=(b=m[c]).vertexTriangles.length;for(var I=0;I<g;++I)if(!P[y=b.vertexTriangles[I]]){P[y]=!0,d=y+y+y;for(var S=0;S<3;++S)w=a[d],T.push(w),E.push(w),D[A]=w,++A,--(C=m[w]).numLiveTriangles,h-C.timeStamp>o&&(C.timeStamp=h,++h),++d}c=s(0,o,T,m,h,E,p)}return D};var g={};function T(e,t,r,i,a){e[t++]=r,e[t++]=i,e[t++]=i,e[t++]=a,e[t++]=a,e[t]=r}function E(e){var r={};for(var i in e)if(e.hasOwnProperty(i)&&t.defined(e[i])&&t.defined(e[i].values)){var a=e[i];r[i]=new d.GeometryAttribute({componentDatatype:a.componentDatatype,componentsPerAttribute:a.componentsPerAttribute,normalize:a.normalize,values:[]})}return r}function A(e,r,i){for(var a in r)if(r.hasOwnProperty(a)&&t.defined(r[a])&&t.defined(r[a].values))for(var n=r[a],o=0;o<n.componentsPerAttribute;++o)e[a].values.push(n.values[i*n.componentsPerAttribute+o])}g.toWireframe=function(e){if(!t.defined(e))throw new r.DeveloperError("geometry is required.");var i=e.indices;if(t.defined(i)){switch(e.primitiveType){case l.PrimitiveType.TRIANGLES:e.indices=function(e){for(var t=e.length,r=t/3*6,i=m.IndexDatatype.createTypedArray(t,r),a=0,n=0;n<t;n+=3,a+=6)T(i,a,e[n],e[n+1],e[n+2]);return i}(i);break;case l.PrimitiveType.TRIANGLE_STRIP:e.indices=function(e){var t=e.length;if(t>=3){var r=6*(t-2),i=m.IndexDatatype.createTypedArray(t,r);T(i,0,e[0],e[1],e[2]);for(var a=6,n=3;n<t;++n,a+=6)T(i,a,e[n-1],e[n],e[n-2]);return i}return new Uint16Array}(i);break;case l.PrimitiveType.TRIANGLE_FAN:e.indices=function(e){if(e.length>0){for(var t=e.length-1,r=6*(t-1),i=m.IndexDatatype.createTypedArray(t,r),a=e[0],n=0,o=1;o<t;++o,n+=6)T(i,n,a,e[o],e[o+1]);return i}return new Uint16Array}(i);break;default:throw new r.DeveloperError("geometry.primitiveType must be TRIANGLES, TRIANGLE_STRIP, or TRIANGLE_FAN.")}e.primitiveType=l.PrimitiveType.LINES}return e},g.createLineSegmentsForVectors=function(e,i,a){if(i=t.defaultValue(i,"normal"),!t.defined(e))throw new r.DeveloperError("geometry is required.");if(!t.defined(e.attributes.position))throw new r.DeveloperError("geometry.attributes.position is required.");if(!t.defined(e.attributes[i]))throw new r.DeveloperError("geometry.attributes must have an attribute with the same name as the attributeName parameter, "+i+".");a=t.defaultValue(a,1e4);for(var n,s=e.attributes.position.values,u=e.attributes[i].values,v=s.length,f=new Float64Array(2*v),m=0,y=0;y<v;y+=3)f[m++]=s[y],f[m++]=s[y+1],f[m++]=s[y+2],f[m++]=s[y]+u[y]*a,f[m++]=s[y+1]+u[y+1]*a,f[m++]=s[y+2]+u[y+2]*a;var c=e.boundingSphere;return t.defined(c)&&(n=new o.BoundingSphere(c.center,c.radius+a)),new d.Geometry({attributes:{position:new d.GeometryAttribute({componentDatatype:p.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:f})},primitiveType:l.PrimitiveType.LINES,boundingSphere:n})},g.createAttributeLocations=function(e){if(!t.defined(e))throw new r.DeveloperError("geometry is required.");var i,a=["position","positionHigh","positionLow","position3DHigh","position3DLow","position2DHigh","position2DLow","pickColor","normal","st","tangent","bitangent","extrudeDirection","compressedAttributes"],n=e.attributes,o={},s=0,u=a.length;for(i=0;i<u;++i){var p=a[i];t.defined(n[p])&&(o[p]=s++)}for(var d in n)n.hasOwnProperty(d)&&!t.defined(o[d])&&(o[d]=s++);return o},g.reorderForPreVertexCache=function(e){if(!t.defined(e))throw new r.DeveloperError("geometry is required.");var i=d.Geometry.computeNumberOfVertices(e),a=e.indices;if(t.defined(a)){for(var n=new Int32Array(i),o=0;o<i;o++)n[o]=-1;for(var s,u=a,l=u.length,v=m.IndexDatatype.createTypedArray(i,l),f=0,y=0,c=0;f<l;)-1!==(s=n[u[f]])?v[y]=s:(n[s=u[f]]=c,v[y]=c,++c),++f,++y;e.indices=v;var h=e.attributes;for(var C in h)if(h.hasOwnProperty(C)&&t.defined(h[C])&&t.defined(h[C].values)){for(var b=h[C],w=b.values,g=0,T=b.componentsPerAttribute,E=p.ComponentDatatype.createTypedArray(b.componentDatatype,c*T);g<i;){var A=n[g];if(-1!==A)for(var D=0;D<T;D++)E[T*A+D]=w[T*g+D];++g}b.values=E}}return e},g.reorderForPostVertexCache=function(e,i){if(!t.defined(e))throw new r.DeveloperError("geometry is required.");var a=e.indices;if(e.primitiveType===l.PrimitiveType.TRIANGLES&&t.defined(a)){for(var n=a.length,o=0,s=0;s<n;s++)a[s]>o&&(o=a[s]);e.indices=w.tipsify({indices:a,maximumIndex:o,cacheSize:i})}return e},g.fitToUnsignedShortIndices=function(e){if(!t.defined(e))throw new r.DeveloperError("geometry is required.");if(t.defined(e.indices)&&e.primitiveType!==l.PrimitiveType.TRIANGLES&&e.primitiveType!==l.PrimitiveType.LINES&&e.primitiveType!==l.PrimitiveType.POINTS)throw new r.DeveloperError("geometry.primitiveType must equal to PrimitiveType.TRIANGLES, PrimitiveType.LINES, or PrimitiveType.POINTS.");var i=[],n=d.Geometry.computeNumberOfVertices(e);if(t.defined(e.indices)&&n>=a.CesiumMath.SIXTY_FOUR_KILOBYTES){var o,s=[],u=[],p=0,v=E(e.attributes),f=e.indices,m=f.length;e.primitiveType===l.PrimitiveType.TRIANGLES?o=3:e.primitiveType===l.PrimitiveType.LINES?o=2:e.primitiveType===l.PrimitiveType.POINTS&&(o=1);for(var y=0;y<m;y+=o){for(var c=0;c<o;++c){var h=f[y+c],C=s[h];t.defined(C)||(C=p++,s[h]=C,A(v,e.attributes,h)),u.push(C)}p+o>=a.CesiumMath.SIXTY_FOUR_KILOBYTES&&(i.push(new d.Geometry({attributes:v,indices:u,primitiveType:e.primitiveType,boundingSphere:e.boundingSphere,boundingSphereCV:e.boundingSphereCV})),s=[],u=[],p=0,v=E(e.attributes))}0!==u.length&&i.push(new d.Geometry({attributes:v,indices:u,primitiveType:e.primitiveType,boundingSphere:e.boundingSphere,boundingSphereCV:e.boundingSphereCV}))}else i.push(e);return i};var D=new a.Cartesian3,x=new n.Cartographic;g.projectTo2D=function(e,i,n,s,u){if(!t.defined(e))throw new r.DeveloperError("geometry is required.");if(!t.defined(i))throw new r.DeveloperError("attributeName is required.");if(!t.defined(n))throw new r.DeveloperError("attributeName3D is required.");if(!t.defined(s))throw new r.DeveloperError("attributeName2D is required.");if(!t.defined(e.attributes[i]))throw new r.DeveloperError("geometry must have attribute matching the attributeName argument: "+i+".");if(e.attributes[i].componentDatatype!==p.ComponentDatatype.DOUBLE)throw new r.DeveloperError("The attribute componentDatatype must be ComponentDatatype.DOUBLE.");for(var l=e.attributes[i],v=(u=t.defined(u)?u:new o.GeographicProjection).ellipsoid,f=l.values,m=new Float64Array(f.length),y=0,c=0;c<f.length;c+=3){var h=a.Cartesian3.fromArray(f,c,D),C=v.cartesianToCartographic(h,x);if(!t.defined(C))throw new r.DeveloperError("Could not project point ("+h.x+", "+h.y+", "+h.z+") to 2D.");var b=u.project(C,D);m[y++]=b.x,m[y++]=b.y,m[y++]=b.z}return e.attributes[n]=l,e.attributes[s]=new d.GeometryAttribute({componentDatatype:p.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:m}),delete e.attributes[i],e};var P={high:0,low:0};g.encodeAttribute=function(e,i,a,n){if(!t.defined(e))throw new r.DeveloperError("geometry is required.");if(!t.defined(i))throw new r.DeveloperError("attributeName is required.");if(!t.defined(a))throw new r.DeveloperError("attributeHighName is required.");if(!t.defined(n))throw new r.DeveloperError("attributeLowName is required.");if(!t.defined(e.attributes[i]))throw new r.DeveloperError("geometry must have attribute matching the attributeName argument: "+i+".");if(e.attributes[i].componentDatatype!==p.ComponentDatatype.DOUBLE)throw new r.DeveloperError("The attribute componentDatatype must be ComponentDatatype.DOUBLE.");for(var o=e.attributes[i],s=o.values,u=s.length,l=new Float32Array(u),v=new Float32Array(u),m=0;m<u;++m)f.EncodedCartesian3.encode(s[m],P),l[m]=P.high,v[m]=P.low;var y=o.componentsPerAttribute;return e.attributes[a]=new d.GeometryAttribute({componentDatatype:p.ComponentDatatype.FLOAT,componentsPerAttribute:y,values:l}),e.attributes[n]=new d.GeometryAttribute({componentDatatype:p.ComponentDatatype.FLOAT,componentsPerAttribute:y,values:v}),delete e.attributes[i],e};var I=new a.Cartesian3;function S(e,r){if(t.defined(r))for(var i=r.values,n=i.length,o=0;o<n;o+=3)a.Cartesian3.unpack(i,o,I),s.Matrix4.multiplyByPoint(e,I,I),a.Cartesian3.pack(I,i,o)}function N(e,r){if(t.defined(r))for(var i=r.values,n=i.length,o=0;o<n;o+=3)a.Cartesian3.unpack(i,o,I),s.Matrix3.multiplyByVector(e,I,I),I=a.Cartesian3.normalize(I,I),a.Cartesian3.pack(I,i,o)}var O=new s.Matrix4,L=new s.Matrix3;g.transformToWorldCoordinates=function(e){if(!t.defined(e))throw new r.DeveloperError("instance is required.");var i=e.modelMatrix;if(s.Matrix4.equals(i,s.Matrix4.IDENTITY))return e;var a=e.geometry.attributes;S(i,a.position),S(i,a.prevPosition),S(i,a.nextPosition),(t.defined(a.normal)||t.defined(a.tangent)||t.defined(a.bitangent))&&(s.Matrix4.inverse(i,O),s.Matrix4.transpose(O,O),s.Matrix4.getMatrix3(O,L),N(L,a.normal),N(L,a.tangent),N(L,a.bitangent));var n=e.geometry.boundingSphere;return t.defined(n)&&(e.geometry.boundingSphere=o.BoundingSphere.transform(n,i,n)),e.modelMatrix=s.Matrix4.clone(s.Matrix4.IDENTITY),e};var z=new a.Cartesian3;function G(e,i){var n,u,v,f,y=e.length,c=e[0].modelMatrix,h=t.defined(e[0][i].indices),C=e[0][i].primitiveType;for(u=1;u<y;++u){if(!s.Matrix4.equals(e[u].modelMatrix,c))throw new r.DeveloperError("All instances must have the same modelMatrix.");if(t.defined(e[u][i].indices)!==h)throw new r.DeveloperError("All instance geometries must have an indices or not have one.");if(e[u][i].primitiveType!==C)throw new r.DeveloperError("All instance geometries must have the same primitiveType.")}var b,w,g,T,E=function(e,r){var i,a=e.length,n={},o=e[0][r].attributes;for(i in o)if(o.hasOwnProperty(i)&&t.defined(o[i])&&t.defined(o[i].values)){for(var s=o[i],u=s.values.length,l=!0,v=1;v<a;++v){var f=e[v][r].attributes[i];if(!t.defined(f)||s.componentDatatype!==f.componentDatatype||s.componentsPerAttribute!==f.componentsPerAttribute||s.normalize!==f.normalize){l=!1;break}u+=f.values.length}l&&(n[i]=new d.GeometryAttribute({componentDatatype:s.componentDatatype,componentsPerAttribute:s.componentsPerAttribute,normalize:s.normalize,values:p.ComponentDatatype.createTypedArray(s.componentDatatype,u)}))}return n}(e,i);for(n in E)if(E.hasOwnProperty(n))for(b=E[n].values,f=0,u=0;u<y;++u)for(g=(w=e[u][i].attributes[n].values).length,v=0;v<g;++v)b[f++]=w[v];if(h){var A=0;for(u=0;u<y;++u)A+=e[u][i].indices.length;var D=d.Geometry.computeNumberOfVertices(new d.Geometry({attributes:E,primitiveType:l.PrimitiveType.POINTS})),x=m.IndexDatatype.createTypedArray(D,A),P=0,I=0;for(u=0;u<y;++u){var S=e[u][i].indices,N=S.length;for(f=0;f<N;++f)x[P++]=I+S[f];I+=d.Geometry.computeNumberOfVertices(e[u][i])}T=x}var O,L=new a.Cartesian3,G=0;for(u=0;u<y;++u){if(O=e[u][i].boundingSphere,!t.defined(O)){L=void 0;break}a.Cartesian3.add(O.center,L,L)}if(t.defined(L))for(a.Cartesian3.divideByScalar(L,y,L),u=0;u<y;++u){O=e[u][i].boundingSphere;var M=a.Cartesian3.magnitude(a.Cartesian3.subtract(O.center,L,z))+O.radius;M>G&&(G=M)}return new d.Geometry({attributes:E,indices:T,primitiveType:C,boundingSphere:t.defined(L)?new o.BoundingSphere(L,G):void 0})}g.combineInstances=function(e){if(!t.defined(e)||e.length<1)throw new r.DeveloperError("instances is required and must have length greater than zero.");for(var i=[],a=[],n=e.length,o=0;o<n;++o){var s=e[o];t.defined(s.geometry)?i.push(s):t.defined(s.westHemisphereGeometry)&&t.defined(s.eastHemisphereGeometry)&&a.push(s)}var u=[];return i.length>0&&u.push(G(i,"geometry")),a.length>0&&(u.push(G(a,"westHemisphereGeometry")),u.push(G(a,"eastHemisphereGeometry"))),u};var M=new a.Cartesian3,q=new a.Cartesian3,R=new a.Cartesian3,B=new a.Cartesian3;g.computeNormal=function(e){if(!t.defined(e))throw new r.DeveloperError("geometry is required.");if(!t.defined(e.attributes.position)||!t.defined(e.attributes.position.values))throw new r.DeveloperError("geometry.attributes.position.values is required.");if(!t.defined(e.indices))throw new r.DeveloperError("geometry.indices is required.");if(e.indices.length<2||e.indices.length%3!=0)throw new r.DeveloperError("geometry.indices length must be greater than 0 and be a multiple of 3.");if(e.primitiveType!==l.PrimitiveType.TRIANGLES)throw new r.DeveloperError("geometry.primitiveType must be PrimitiveType.TRIANGLES.");var i,n=e.indices,o=e.attributes,s=o.position.values,u=o.position.values.length/3,v=n.length,f=new Array(u),m=new Array(v/3),y=new Array(v);for(i=0;i<u;i++)f[i]={indexOffset:0,count:0,currentCount:0};var c=0;for(i=0;i<v;i+=3){var h=n[i],C=n[i+1],b=n[i+2],w=3*h,g=3*C,T=3*b;q.x=s[w],q.y=s[w+1],q.z=s[w+2],R.x=s[g],R.y=s[g+1],R.z=s[g+2],B.x=s[T],B.y=s[T+1],B.z=s[T+2],f[h].count++,f[C].count++,f[b].count++,a.Cartesian3.subtract(R,q,R),a.Cartesian3.subtract(B,q,B),m[c]=a.Cartesian3.cross(R,B,new a.Cartesian3),c++}var E,A=0;for(i=0;i<u;i++)f[i].indexOffset+=A,A+=f[i].count;for(c=0,i=0;i<v;i+=3){var D=(E=f[n[i]]).indexOffset+E.currentCount;y[D]=c,E.currentCount++,y[D=(E=f[n[i+1]]).indexOffset+E.currentCount]=c,E.currentCount++,y[D=(E=f[n[i+2]]).indexOffset+E.currentCount]=c,E.currentCount++,c++}var x=new Float32Array(3*u);for(i=0;i<u;i++){var P=3*i;if(E=f[i],a.Cartesian3.clone(a.Cartesian3.ZERO,M),E.count>0){for(c=0;c<E.count;c++)a.Cartesian3.add(M,m[y[E.indexOffset+c]],M);a.Cartesian3.equalsEpsilon(a.Cartesian3.ZERO,M,a.CesiumMath.EPSILON10)&&a.Cartesian3.clone(m[y[E.indexOffset]],M)}a.Cartesian3.equalsEpsilon(a.Cartesian3.ZERO,M,a.CesiumMath.EPSILON10)&&(M.z=1),a.Cartesian3.normalize(M,M),x[P]=M.x,x[P+1]=M.y,x[P+2]=M.z}return e.attributes.normal=new d.GeometryAttribute({componentDatatype:p.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:x}),e};var V=new a.Cartesian3,k=new a.Cartesian3,F=new a.Cartesian3;g.computeTangentAndBitangent=function(e){if(!t.defined(e))throw new r.DeveloperError("geometry is required.");var i=e.attributes,n=e.indices;if(!t.defined(i.position)||!t.defined(i.position.values))throw new r.DeveloperError("geometry.attributes.position.values is required.");if(!t.defined(i.normal)||!t.defined(i.normal.values))throw new r.DeveloperError("geometry.attributes.normal.values is required.");if(!t.defined(i.st)||!t.defined(i.st.values))throw new r.DeveloperError("geometry.attributes.st.values is required.");if(!t.defined(n))throw new r.DeveloperError("geometry.indices is required.");if(n.length<2||n.length%3!=0)throw new r.DeveloperError("geometry.indices length must be greater than 0 and be a multiple of 3.");if(e.primitiveType!==l.PrimitiveType.TRIANGLES)throw new r.DeveloperError("geometry.primitiveType must be PrimitiveType.TRIANGLES.");var o,s,u,v,f=e.attributes.position.values,m=e.attributes.normal.values,y=e.attributes.st.values,c=e.attributes.position.values.length/3,h=n.length,C=new Array(3*c);for(o=0;o<C.length;o++)C[o]=0;for(o=0;o<h;o+=3){var b=n[o],w=n[o+1],g=n[o+2];u=3*w,v=3*g;var T=2*b,E=2*w,A=2*g,D=f[s=3*b],x=f[s+1],P=f[s+2],I=y[T],S=y[T+1],N=y[E+1]-S,O=y[A+1]-S,L=1/((y[E]-I)*O-(y[A]-I)*N),z=(O*(f[u]-D)-N*(f[v]-D))*L,G=(O*(f[u+1]-x)-N*(f[v+1]-x))*L,M=(O*(f[u+2]-P)-N*(f[v+2]-P))*L;C[s]+=z,C[s+1]+=G,C[s+2]+=M,C[u]+=z,C[u+1]+=G,C[u+2]+=M,C[v]+=z,C[v+1]+=G,C[v+2]+=M}var q=new Float32Array(3*c),R=new Float32Array(3*c);for(o=0;o<c;o++){u=(s=3*o)+1,v=s+2;var B=a.Cartesian3.fromArray(m,s,V),_=a.Cartesian3.fromArray(C,s,F),U=a.Cartesian3.dot(B,_);a.Cartesian3.multiplyByScalar(B,U,k),a.Cartesian3.normalize(a.Cartesian3.subtract(_,k,_),_),q[s]=_.x,q[u]=_.y,q[v]=_.z,a.Cartesian3.normalize(a.Cartesian3.cross(B,_,_),_),R[s]=_.x,R[u]=_.y,R[v]=_.z}return e.attributes.tangent=new d.GeometryAttribute({componentDatatype:p.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:q}),e.attributes.bitangent=new d.GeometryAttribute({componentDatatype:p.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:R}),e};var _=new u.Cartesian2,U=new a.Cartesian3,Y=new a.Cartesian3,Z=new a.Cartesian3,H=new u.Cartesian2;function W(e){switch(e.primitiveType){case l.PrimitiveType.TRIANGLE_FAN:return function(e){var t=d.Geometry.computeNumberOfVertices(e);if(t<3)throw new r.DeveloperError("The number of vertices must be at least three.");var i=m.IndexDatatype.createTypedArray(t,3*(t-2));i[0]=1,i[1]=0,i[2]=2;for(var a=3,n=3;n<t;++n)i[a++]=n-1,i[a++]=0,i[a++]=n;return e.indices=i,e.primitiveType=l.PrimitiveType.TRIANGLES,e}(e);case l.PrimitiveType.TRIANGLE_STRIP:return function(e){var t=d.Geometry.computeNumberOfVertices(e);if(t<3)throw new r.DeveloperError("The number of vertices must be at least 3.");var i=m.IndexDatatype.createTypedArray(t,3*(t-2));i[0]=0,i[1]=1,i[2]=2,t>3&&(i[3]=0,i[4]=2,i[5]=3);for(var a=6,n=3;n<t-1;n+=2)i[a++]=n,i[a++]=n-1,i[a++]=n+1,n+2<t&&(i[a++]=n,i[a++]=n+1,i[a++]=n+2);return e.indices=i,e.primitiveType=l.PrimitiveType.TRIANGLES,e}(e);case l.PrimitiveType.TRIANGLES:return function(e){if(t.defined(e.indices))return e;var i=d.Geometry.computeNumberOfVertices(e);if(i<3)throw new r.DeveloperError("The number of vertices must be at least three.");if(i%3!=0)throw new r.DeveloperError("The number of vertices must be a multiple of three.");for(var a=m.IndexDatatype.createTypedArray(i,i),n=0;n<i;++n)a[n]=n;return e.indices=a,e}(e);case l.PrimitiveType.LINE_STRIP:return function(e){var t=d.Geometry.computeNumberOfVertices(e);if(t<2)throw new r.DeveloperError("The number of vertices must be at least two.");var i=m.IndexDatatype.createTypedArray(t,2*(t-1));i[0]=0,i[1]=1;for(var a=2,n=2;n<t;++n)i[a++]=n-1,i[a++]=n;return e.indices=i,e.primitiveType=l.PrimitiveType.LINES,e}(e);case l.PrimitiveType.LINE_LOOP:return function(e){var t=d.Geometry.computeNumberOfVertices(e);if(t<2)throw new r.DeveloperError("The number of vertices must be at least two.");var i=m.IndexDatatype.createTypedArray(t,2*t);i[0]=0,i[1]=1;for(var a=2,n=2;n<t;++n)i[a++]=n-1,i[a++]=n;return i[a++]=t-1,i[a]=0,e.indices=i,e.primitiveType=l.PrimitiveType.LINES,e}(e);case l.PrimitiveType.LINES:return function(e){if(t.defined(e.indices))return e;var i=d.Geometry.computeNumberOfVertices(e);if(i<2)throw new r.DeveloperError("The number of vertices must be at least two.");if(i%2!=0)throw new r.DeveloperError("The number of vertices must be a multiple of 2.");for(var a=m.IndexDatatype.createTypedArray(i,i),n=0;n<i;++n)a[n]=n;return e.indices=a,e}(e)}return e}function X(e,t){Math.abs(e.y)<a.CesiumMath.EPSILON6&&(e.y=t?-a.CesiumMath.EPSILON6:a.CesiumMath.EPSILON6)}g.compressVertices=function(e){if(!t.defined(e))throw new r.DeveloperError("geometry is required.");var i,n,o=e.attributes.extrudeDirection;if(t.defined(o)){var s=o.values;n=s.length/3;var l=new Float32Array(2*n),f=0;for(i=0;i<n;++i)a.Cartesian3.fromArray(s,3*i,U),a.Cartesian3.equals(U,a.Cartesian3.ZERO)?f+=2:(H=v.AttributeCompression.octEncodeInRange(U,65535,H),l[f++]=H.x,l[f++]=H.y);return e.attributes.compressedAttributes=new d.GeometryAttribute({componentDatatype:p.ComponentDatatype.FLOAT,componentsPerAttribute:2,values:l}),delete e.attributes.extrudeDirection,e}var m=e.attributes.normal,y=e.attributes.st,c=t.defined(m),h=t.defined(y);if(!c&&!h)return e;var C,b,w,g,T=e.attributes.tangent,E=e.attributes.bitangent,A=t.defined(T),D=t.defined(E);c&&(C=m.values),h&&(b=y.values),A&&(w=T.values),D&&(g=E.values);var x=n=(c?C.length:b.length)/(c?3:2),P=h&&c?2:1;P+=A||D?1:0;var I=new Float32Array(x*=P),S=0;for(i=0;i<n;++i){h&&(u.Cartesian2.fromArray(b,2*i,_),I[S++]=v.AttributeCompression.compressTextureCoordinates(_));var N=3*i;c&&t.defined(w)&&t.defined(g)?(a.Cartesian3.fromArray(C,N,U),a.Cartesian3.fromArray(w,N,Y),a.Cartesian3.fromArray(g,N,Z),v.AttributeCompression.octPack(U,Y,Z,_),I[S++]=_.x,I[S++]=_.y):(c&&(a.Cartesian3.fromArray(C,N,U),I[S++]=v.AttributeCompression.octEncodeFloat(U)),A&&(a.Cartesian3.fromArray(w,N,U),I[S++]=v.AttributeCompression.octEncodeFloat(U)),D&&(a.Cartesian3.fromArray(g,N,U),I[S++]=v.AttributeCompression.octEncodeFloat(U)))}return e.attributes.compressedAttributes=new d.GeometryAttribute({componentDatatype:p.ComponentDatatype.FLOAT,componentsPerAttribute:P,values:I}),c&&delete e.attributes.normal,h&&delete e.attributes.st,D&&delete e.attributes.bitangent,A&&delete e.attributes.tangent,e};var j=new a.Cartesian3;function J(e,t,r,i){a.Cartesian3.add(e,a.Cartesian3.multiplyByScalar(a.Cartesian3.subtract(t,e,j),e.y/(e.y-t.y),j),r),a.Cartesian3.clone(r,i),X(r,!0),X(i,!1)}var K=new a.Cartesian3,Q=new a.Cartesian3,$=new a.Cartesian3,ee=new a.Cartesian3,te={positions:new Array(7),indices:new Array(9)};function re(e,t,r){if(!(e.x>=0||t.x>=0||r.x>=0)){!function(e,t,r){if(0!==e.y&&0!==t.y&&0!==r.y)return X(e,e.y<0),X(t,t.y<0),void X(r,r.y<0);var i=Math.abs(e.y),n=Math.abs(t.y),o=Math.abs(r.y),s=(i>n?i>o?a.CesiumMath.sign(e.y):a.CesiumMath.sign(r.y):n>o?a.CesiumMath.sign(t.y):a.CesiumMath.sign(r.y))<0;X(e,s),X(t,s),X(r,s)}(e,t,r);var i=e.y<0,n=t.y<0,o=r.y<0,s=0;s+=i?1:0,s+=n?1:0;var u=te.indices;1===(s+=o?1:0)?(u[1]=3,u[2]=4,u[5]=6,u[7]=6,u[8]=5,i?(J(e,t,K,$),J(e,r,Q,ee),u[0]=0,u[3]=1,u[4]=2,u[6]=1):n?(J(t,r,K,$),J(t,e,Q,ee),u[0]=1,u[3]=2,u[4]=0,u[6]=2):o&&(J(r,e,K,$),J(r,t,Q,ee),u[0]=2,u[3]=0,u[4]=1,u[6]=0)):2===s&&(u[2]=4,u[4]=4,u[5]=3,u[7]=5,u[8]=6,i?n?o||(J(r,e,K,$),J(r,t,Q,ee),u[0]=0,u[1]=1,u[3]=0,u[6]=2):(J(t,r,K,$),J(t,e,Q,ee),u[0]=2,u[1]=0,u[3]=2,u[6]=1):(J(e,t,K,$),J(e,r,Q,ee),u[0]=1,u[1]=2,u[3]=1,u[6]=0));var p=te.positions;return p[0]=e,p[1]=t,p[2]=r,p.length=3,1!==s&&2!==s||(p[3]=K,p[4]=Q,p[5]=$,p[6]=ee,p.length=7),te}}function ie(e,r){var i=e.attributes;if(0!==i.position.values.length){for(var a in i)if(i.hasOwnProperty(a)&&t.defined(i[a])&&t.defined(i[a].values)){var n=i[a];n.values=p.ComponentDatatype.createTypedArray(n.componentDatatype,n.values)}var s=d.Geometry.computeNumberOfVertices(e);return e.indices=m.IndexDatatype.createTypedArray(s,e.indices),r&&(e.boundingSphere=o.BoundingSphere.fromVertices(i.position.values)),e}}function ae(e){var r=e.attributes,i={};for(var a in r)if(r.hasOwnProperty(a)&&t.defined(r[a])&&t.defined(r[a].values)){var n=r[a];i[a]=new d.GeometryAttribute({componentDatatype:n.componentDatatype,componentsPerAttribute:n.componentsPerAttribute,normalize:n.normalize,values:[]})}return new d.Geometry({attributes:i,indices:[],primitiveType:e.primitiveType})}function ne(e,r,i){var a=t.defined(e.geometry.boundingSphere);r=ie(r,a),i=ie(i,a),t.defined(i)&&!t.defined(r)?e.geometry=i:!t.defined(i)&&t.defined(r)?e.geometry=r:(e.westHemisphereGeometry=r,e.eastHemisphereGeometry=i,e.geometry=void 0)}function oe(e,t){var r=new e,i=new e,a=new e;return function(n,o,s,u,p,d,l,v){var f=e.fromArray(p,n*t,r),m=e.fromArray(p,o*t,i),y=e.fromArray(p,s*t,a);e.multiplyByScalar(f,u.x,f),e.multiplyByScalar(m,u.y,m),e.multiplyByScalar(y,u.z,y);var c=e.add(f,m,f);e.add(c,y,c),v&&e.normalize(c,c),e.pack(c,d,l*t)}}var se=oe(s.Cartesian4,4),ue=oe(a.Cartesian3,3),pe=oe(u.Cartesian2,2),de=new a.Cartesian3,le=new a.Cartesian3,ve=new a.Cartesian3,fe=new a.Cartesian3;function me(e,r,n,o,s,p,d,l,v,f,m,y,c,w,g,T){if(t.defined(p)||t.defined(d)||t.defined(l)||t.defined(v)||t.defined(f)||0!==w){var E=function(e,r,n,o,s){var p,d,l,v,f,m,y,c;if(i.Check.defined("point",e),i.Check.defined("p0",r),i.Check.defined("p1",n),i.Check.defined("p2",o),t.defined(s)||(s=new a.Cartesian3),t.defined(r.z)){if(a.Cartesian3.equalsEpsilon(e,r,a.CesiumMath.EPSILON14))return a.Cartesian3.clone(a.Cartesian3.UNIT_X,s);if(a.Cartesian3.equalsEpsilon(e,n,a.CesiumMath.EPSILON14))return a.Cartesian3.clone(a.Cartesian3.UNIT_Y,s);if(a.Cartesian3.equalsEpsilon(e,o,a.CesiumMath.EPSILON14))return a.Cartesian3.clone(a.Cartesian3.UNIT_Z,s);p=a.Cartesian3.subtract(n,r,h),d=a.Cartesian3.subtract(o,r,C),l=a.Cartesian3.subtract(e,r,b),v=a.Cartesian3.dot(p,p),f=a.Cartesian3.dot(p,d),m=a.Cartesian3.dot(p,l),y=a.Cartesian3.dot(d,d),c=a.Cartesian3.dot(d,l)}else{if(u.Cartesian2.equalsEpsilon(e,r,a.CesiumMath.EPSILON14))return a.Cartesian3.clone(a.Cartesian3.UNIT_X,s);if(u.Cartesian2.equalsEpsilon(e,n,a.CesiumMath.EPSILON14))return a.Cartesian3.clone(a.Cartesian3.UNIT_Y,s);if(u.Cartesian2.equalsEpsilon(e,o,a.CesiumMath.EPSILON14))return a.Cartesian3.clone(a.Cartesian3.UNIT_Z,s);p=u.Cartesian2.subtract(n,r,h),d=u.Cartesian2.subtract(o,r,C),l=u.Cartesian2.subtract(e,r,b),v=u.Cartesian2.dot(p,p),f=u.Cartesian2.dot(p,d),m=u.Cartesian2.dot(p,l),y=u.Cartesian2.dot(d,d),c=u.Cartesian2.dot(d,l)}s.y=y*m-f*c,s.z=v*c-f*m;var w=v*y-f*f;return 0!==s.y&&(s.y/=w),0!==s.z&&(s.z/=w),s.x=1-s.y-s.z,s}(o,a.Cartesian3.fromArray(s,3*e,de),a.Cartesian3.fromArray(s,3*r,le),a.Cartesian3.fromArray(s,3*n,ve),fe);if(t.defined(p)&&ue(e,r,n,E,p,y.normal.values,T,!0),t.defined(f)){var A,D=a.Cartesian3.fromArray(f,3*e,de),x=a.Cartesian3.fromArray(f,3*r,le),P=a.Cartesian3.fromArray(f,3*n,ve);a.Cartesian3.multiplyByScalar(D,E.x,D),a.Cartesian3.multiplyByScalar(x,E.y,x),a.Cartesian3.multiplyByScalar(P,E.z,P),a.Cartesian3.equals(D,a.Cartesian3.ZERO)&&a.Cartesian3.equals(x,a.Cartesian3.ZERO)&&a.Cartesian3.equals(P,a.Cartesian3.ZERO)?((A=de).x=0,A.y=0,A.z=0):(A=a.Cartesian3.add(D,x,D),a.Cartesian3.add(A,P,A),a.Cartesian3.normalize(A,A)),a.Cartesian3.pack(A,y.extrudeDirection.values,3*T)}if(t.defined(m)&&function(e,t,r,i,n,o,s){var u=n[e]*i.x,p=n[t]*i.y,d=n[r]*i.z;o[s]=u+p+d>a.CesiumMath.EPSILON6?1:0}(e,r,n,E,m,y.applyOffset.values,T),t.defined(d)&&ue(e,r,n,E,d,y.tangent.values,T,!0),t.defined(l)&&ue(e,r,n,E,l,y.bitangent.values,T,!0),t.defined(v)&&pe(e,r,n,E,v,y.st.values,T),w>0)for(var I=0;I<w;I++){var S=c[I];ye(e,r,n,E,T,g[S],y[S])}}}function ye(e,t,r,i,a,n,o){var s=n.componentsPerAttribute,u=n.values,p=o.values;switch(s){case 4:se(e,t,r,i,u,p,a,!1);break;case 3:ue(e,t,r,i,u,p,a,!1);break;case 2:pe(e,t,r,i,u,p,a,!1);break;default:p[a]=u[e]*i.x+u[t]*i.y+u[r]*i.z}}function ce(e,t,r,i,a,n){var o=e.position.values.length/3;if(-1!==a){var s=i[a],u=r[s];return-1===u?(r[s]=o,e.position.values.push(n.x,n.y,n.z),t.push(o),o):(t.push(u),u)}return e.position.values.push(n.x,n.y,n.z),t.push(o),o}var he={position:!0,normal:!0,bitangent:!0,tangent:!0,st:!0,extrudeDirection:!0,applyOffset:!0};function Ce(e){var r=e.geometry,i=r.attributes,n=i.position.values,o=t.defined(i.normal)?i.normal.values:void 0,s=t.defined(i.bitangent)?i.bitangent.values:void 0,u=t.defined(i.tangent)?i.tangent.values:void 0,p=t.defined(i.st)?i.st.values:void 0,d=t.defined(i.extrudeDirection)?i.extrudeDirection.values:void 0,l=t.defined(i.applyOffset)?i.applyOffset.values:void 0,v=r.indices,f=[];for(var m in i)i.hasOwnProperty(m)&&!he[m]&&t.defined(i[m])&&f.push(m);var y,c,h,C,b=f.length,w=ae(r),g=ae(r),T=[];T.length=n.length/3;var E=[];for(E.length=n.length/3,C=0;C<T.length;++C)T[C]=-1,E[C]=-1;var A=v.length;for(C=0;C<A;C+=3){var D=v[C],x=v[C+1],P=v[C+2],I=a.Cartesian3.fromArray(n,3*D),S=a.Cartesian3.fromArray(n,3*x),N=a.Cartesian3.fromArray(n,3*P),O=re(I,S,N);if(t.defined(O)&&O.positions.length>3)for(var L=O.positions,z=O.indices,G=z.length,M=0;M<G;++M){var q=z[M],R=L[q];R.y<0?(y=g.attributes,c=g.indices,h=T):(y=w.attributes,c=w.indices,h=E),me(D,x,P,R,n,o,u,s,p,d,l,y,f,b,i,ce(y,c,h,v,q<3?C+q:-1,R))}else t.defined(O)&&(I=O.positions[0],S=O.positions[1],N=O.positions[2]),I.y<0?(y=g.attributes,c=g.indices,h=T):(y=w.attributes,c=w.indices,h=E),me(D,x,P,I,n,o,u,s,p,d,l,y,f,b,i,ce(y,c,h,v,C,I)),me(D,x,P,S,n,o,u,s,p,d,l,y,f,b,i,ce(y,c,h,v,C+1,S)),me(D,x,P,N,n,o,u,s,p,d,l,y,f,b,i,ce(y,c,h,v,C+2,N))}ne(e,g,w)}var be=c.Plane.fromPointNormal(a.Cartesian3.ZERO,a.Cartesian3.UNIT_Y),we=new a.Cartesian3,ge=new a.Cartesian3;function Te(e,r,i,n,o,s,u){if(t.defined(u)){var p=a.Cartesian3.fromArray(n,3*e,de);a.Cartesian3.equalsEpsilon(p,i,a.CesiumMath.EPSILON10)?s.applyOffset.values[o]=u[e]:s.applyOffset.values[o]=u[r]}}function Ee(e){var r,i=e.geometry,n=i.attributes,o=n.position.values,s=t.defined(n.applyOffset)?n.applyOffset.values:void 0,u=i.indices,p=ae(i),d=ae(i),l=u.length,v=[];v.length=o.length/3;var f=[];for(f.length=o.length/3,r=0;r<v.length;++r)v[r]=-1,f[r]=-1;for(r=0;r<l;r+=2){var m=u[r],c=u[r+1],h=a.Cartesian3.fromArray(o,3*m,de),C=a.Cartesian3.fromArray(o,3*c,le);Math.abs(h.y)<a.CesiumMath.EPSILON6&&(h.y<0?h.y=-a.CesiumMath.EPSILON6:h.y=a.CesiumMath.EPSILON6),Math.abs(C.y)<a.CesiumMath.EPSILON6&&(C.y<0?C.y=-a.CesiumMath.EPSILON6:C.y=a.CesiumMath.EPSILON6);var b=p.attributes,w=p.indices,g=f,T=d.attributes,E=d.indices,A=v,D=y.IntersectionTests.lineSegmentPlane(h,C,be,ve);if(t.defined(D)){var x=a.Cartesian3.multiplyByScalar(a.Cartesian3.UNIT_Y,5*a.CesiumMath.EPSILON9,we);h.y<0&&(a.Cartesian3.negate(x,x),b=d.attributes,w=d.indices,g=v,T=p.attributes,E=p.indices,A=f);var P=a.Cartesian3.add(D,x,ge);Te(m,c,h,o,ce(b,w,g,u,r,h),b,s),Te(m,c,P,o,ce(b,w,g,u,-1,P),b,s),a.Cartesian3.negate(x,x),a.Cartesian3.add(D,x,P),Te(m,c,P,o,ce(T,E,A,u,-1,P),T,s),Te(m,c,C,o,ce(T,E,A,u,r+1,C),T,s)}else{var I,S,N;h.y<0?(I=d.attributes,S=d.indices,N=v):(I=p.attributes,S=p.indices,N=f),Te(m,c,h,o,ce(I,S,N,u,r,h),I,s),Te(m,c,C,o,ce(I,S,N,u,r+1,C),I,s)}}ne(e,d,p)}var Ae=new u.Cartesian2,De=new u.Cartesian2,xe=new a.Cartesian3,Pe=new a.Cartesian3,Ie=new a.Cartesian3,Se=new a.Cartesian3,Ne=new a.Cartesian3,Oe=new a.Cartesian3,Le=new s.Cartesian4;function ze(e){for(var t=e.attributes,r=t.position.values,i=t.prevPosition.values,n=t.nextPosition.values,o=r.length,s=0;s<o;s+=3){var u=a.Cartesian3.unpack(r,s,xe);if(!(u.x>0)){var p=a.Cartesian3.unpack(i,s,Pe);(u.y<0&&p.y>0||u.y>0&&p.y<0)&&(s-3>0?(i[s]=r[s-3],i[s+1]=r[s-2],i[s+2]=r[s-1]):a.Cartesian3.pack(u,i,s));var d=a.Cartesian3.unpack(n,s,Ie);(u.y<0&&d.y>0||u.y>0&&d.y<0)&&(s+3<o?(n[s]=r[s+3],n[s+1]=r[s+4],n[s+2]=r[s+5]):a.Cartesian3.pack(u,n,s))}}}var Ge=5*a.CesiumMath.EPSILON9,Me=a.CesiumMath.EPSILON6;g.splitLongitude=function(e){if(!t.defined(e))throw new r.DeveloperError("instance is required.");var i=e.geometry,n=i.boundingSphere;if(t.defined(n)&&(n.center.x-n.radius>0||o.BoundingSphere.intersectPlane(n,c.Plane.ORIGIN_ZX_PLANE)!==o.Intersect.INTERSECTING))return e;if(i.geometryType!==d.GeometryType.NONE)switch(i.geometryType){case d.GeometryType.POLYLINES:!function(e){var r,i,n,o=e.geometry,p=o.attributes,d=p.position.values,l=p.prevPosition.values,v=p.nextPosition.values,f=p.expandAndWidth.values,m=t.defined(p.st)?p.st.values:void 0,c=t.defined(p.color)?p.color.values:void 0,h=ae(o),C=ae(o),b=!1,w=d.length/3;for(r=0;r<w;r+=4){var g=r,T=r+2,E=a.Cartesian3.fromArray(d,3*g,xe),A=a.Cartesian3.fromArray(d,3*T,Pe);if(Math.abs(E.y)<Me)for(E.y=Me*(A.y<0?-1:1),d[3*r+1]=E.y,d[3*(r+1)+1]=E.y,i=3*g;i<3*g+12;i+=3)l[i]=d[3*r],l[i+1]=d[3*r+1],l[i+2]=d[3*r+2];if(Math.abs(A.y)<Me)for(A.y=Me*(E.y<0?-1:1),d[3*(r+2)+1]=A.y,d[3*(r+3)+1]=A.y,i=3*g;i<3*g+12;i+=3)v[i]=d[3*(r+2)],v[i+1]=d[3*(r+2)+1],v[i+2]=d[3*(r+2)+2];var D=h.attributes,x=h.indices,P=C.attributes,I=C.indices,S=y.IntersectionTests.lineSegmentPlane(E,A,be,Se);if(t.defined(S)){b=!0;var N=a.Cartesian3.multiplyByScalar(a.Cartesian3.UNIT_Y,Ge,Ne);E.y<0&&(a.Cartesian3.negate(N,N),D=C.attributes,x=C.indices,P=h.attributes,I=h.indices);var O=a.Cartesian3.add(S,N,Oe);D.position.values.push(E.x,E.y,E.z,E.x,E.y,E.z),D.position.values.push(O.x,O.y,O.z),D.position.values.push(O.x,O.y,O.z),D.prevPosition.values.push(l[3*g],l[3*g+1],l[3*g+2]),D.prevPosition.values.push(l[3*g+3],l[3*g+4],l[3*g+5]),D.prevPosition.values.push(E.x,E.y,E.z,E.x,E.y,E.z),D.nextPosition.values.push(O.x,O.y,O.z),D.nextPosition.values.push(O.x,O.y,O.z),D.nextPosition.values.push(O.x,O.y,O.z),D.nextPosition.values.push(O.x,O.y,O.z),a.Cartesian3.negate(N,N),a.Cartesian3.add(S,N,O),P.position.values.push(O.x,O.y,O.z),P.position.values.push(O.x,O.y,O.z),P.position.values.push(A.x,A.y,A.z,A.x,A.y,A.z),P.prevPosition.values.push(O.x,O.y,O.z),P.prevPosition.values.push(O.x,O.y,O.z),P.prevPosition.values.push(O.x,O.y,O.z),P.prevPosition.values.push(O.x,O.y,O.z),P.nextPosition.values.push(A.x,A.y,A.z,A.x,A.y,A.z),P.nextPosition.values.push(v[3*T],v[3*T+1],v[3*T+2]),P.nextPosition.values.push(v[3*T+3],v[3*T+4],v[3*T+5]);var L=u.Cartesian2.fromArray(f,2*g,Ae),z=Math.abs(L.y);D.expandAndWidth.values.push(-1,z,1,z),D.expandAndWidth.values.push(-1,-z,1,-z),P.expandAndWidth.values.push(-1,z,1,z),P.expandAndWidth.values.push(-1,-z,1,-z);var G=a.Cartesian3.magnitudeSquared(a.Cartesian3.subtract(S,E,Ie));if(G/=a.Cartesian3.magnitudeSquared(a.Cartesian3.subtract(A,E,Ie)),t.defined(c)){var M=s.Cartesian4.fromArray(c,4*g,Le),q=s.Cartesian4.fromArray(c,4*T,Le),R=a.CesiumMath.lerp(M.x,q.x,G),B=a.CesiumMath.lerp(M.y,q.y,G),V=a.CesiumMath.lerp(M.z,q.z,G),k=a.CesiumMath.lerp(M.w,q.w,G);for(i=4*g;i<4*g+8;++i)D.color.values.push(c[i]);for(D.color.values.push(R,B,V,k),D.color.values.push(R,B,V,k),P.color.values.push(R,B,V,k),P.color.values.push(R,B,V,k),i=4*T;i<4*T+8;++i)P.color.values.push(c[i])}if(t.defined(m)){var F=u.Cartesian2.fromArray(m,2*g,Ae),_=u.Cartesian2.fromArray(m,2*(r+3),De),U=a.CesiumMath.lerp(F.x,_.x,G);for(i=2*g;i<2*g+4;++i)D.st.values.push(m[i]);for(D.st.values.push(U,F.y),D.st.values.push(U,_.y),P.st.values.push(U,F.y),P.st.values.push(U,_.y),i=2*T;i<2*T+4;++i)P.st.values.push(m[i])}n=D.position.values.length/3-4,x.push(n,n+2,n+1),x.push(n+1,n+2,n+3),n=P.position.values.length/3-4,I.push(n,n+2,n+1),I.push(n+1,n+2,n+3)}else{var Y,Z;for(E.y<0?(Y=C.attributes,Z=C.indices):(Y=h.attributes,Z=h.indices),Y.position.values.push(E.x,E.y,E.z),Y.position.values.push(E.x,E.y,E.z),Y.position.values.push(A.x,A.y,A.z),Y.position.values.push(A.x,A.y,A.z),i=3*r;i<3*r+12;++i)Y.prevPosition.values.push(l[i]),Y.nextPosition.values.push(v[i]);for(i=2*r;i<2*r+8;++i)Y.expandAndWidth.values.push(f[i]),t.defined(m)&&Y.st.values.push(m[i]);if(t.defined(c))for(i=4*r;i<4*r+16;++i)Y.color.values.push(c[i]);n=Y.position.values.length/3-4,Z.push(n,n+2,n+1),Z.push(n+1,n+2,n+3)}}b&&(ze(C),ze(h)),ne(e,C,h)}(e);break;case d.GeometryType.TRIANGLES:Ce(e);break;case d.GeometryType.LINES:Ee(e)}else W(i),i.primitiveType===l.PrimitiveType.TRIANGLES?Ce(e):i.primitiveType===l.PrimitiveType.LINES&&Ee(e);return e},e.GeometryPipeline=g}));
//# sourceMappingURL=GeometryPipeline-4da09974.js.map
