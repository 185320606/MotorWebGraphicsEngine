{"version":3,"file":"Transforms-7a1c9ee7.js","sources":["../../../../Source/Core/GeographicProjection.js","../../../../Source/Core/Intersect.js","../../../../Source/Core/Interval.js","../../../../Source/Core/BoundingSphere.js","../../../../Source/Core/Quaternion.js","../../../../Source/Core/binarySearch.js","../../../../Source/Core/EarthOrientationParametersSample.js","../../../../Source/ThirdParty/sprintf.js","../../../../Source/Core/GregorianDate.js","../../../../Source/Core/isLeapYear.js","../../../../Source/Core/LeapSecond.js","../../../../Source/Core/TimeConstants.js","../../../../Source/Core/TimeStandard.js","../../../../Source/Core/JulianDate.js","../../../../Source/ThirdParty/Uri.js","../../../../Source/Core/clone.js","../../../../Source/Core/combine.js","../../../../Source/Core/getAbsoluteUri.js","../../../../Source/Core/isBlobUri.js","../../../../Source/Core/isCrossOriginUrl.js","../../../../Source/Core/isDataUri.js","../../../../Source/Core/RequestState.js","../../../../Source/Core/RequestType.js","../../../../Source/Core/Request.js","../../../../Source/Core/RequestErrorEvent.js","../../../../Source/Core/parseResponseHeaders.js","../../../../Source/Core/Event.js","../../../../Source/Core/Heap.js","../../../../Source/Core/RequestScheduler.js","../../../../Source/Core/TrustedServers.js","../../../../Source/Core/Resource.js","../../../../Source/Core/queryToObject.js","../../../../Source/Core/objectToQuery.js","../../../../Source/Core/getExtensionFromUri.js","../../../../Source/Core/getBaseUri.js","../../../../Source/Core/appendForwardSlash.js","../../../../Source/Core/EarthOrientationParameters.js","../../../../Source/Core/HeadingPitchRoll.js","../../../../Source/Core/loadAndExecuteScript.js","../../../../Source/Core/buildModuleUrl.js","../../../../Source/Core/Iau2006XysSample.js","../../../../Source/Core/Iau2006XysData.js","../../../../Source/Core/Transforms.js"],"sourcesContent":["import Cartesian3 from './Cartesian3.js';\r\nimport Cartographic from './Cartographic.js';\r\nimport defaultValue from './defaultValue.js';\r\nimport defined from './defined.js';\r\nimport DeveloperError from './DeveloperError.js';\r\nimport Ellipsoid from './Ellipsoid.js';\r\n\r\n    /**\r\n     * A simple map projection where longitude and latitude are linearly mapped to X and Y by multiplying\r\n     * them by the {@link Ellipsoid#maximumRadius}.  This projection\r\n     * is commonly known as geographic, equirectangular, equidistant cylindrical, or plate carrÃ©e.  It\r\n     * is also known as EPSG:4326.\r\n     *\r\n     * @alias GeographicProjection\r\n     * @constructor\r\n     *\r\n     * @param {Ellipsoid} [ellipsoid=Ellipsoid.WGS84] The ellipsoid.\r\n     *\r\n     * @see WebMercatorProjection\r\n     */\r\n    function GeographicProjection(ellipsoid) {\r\n        this._ellipsoid = defaultValue(ellipsoid, Ellipsoid.WGS84);\r\n        this._semimajorAxis = this._ellipsoid.maximumRadius;\r\n        this._oneOverSemimajorAxis = 1.0 / this._semimajorAxis;\r\n    }\r\n\r\n    Object.defineProperties(GeographicProjection.prototype, {\r\n        /**\r\n         * Gets the {@link Ellipsoid}.\r\n         *\r\n         * @memberof GeographicProjection.prototype\r\n         *\r\n         * @type {Ellipsoid}\r\n         * @readonly\r\n         */\r\n        ellipsoid : {\r\n            get : function() {\r\n                return this._ellipsoid;\r\n            }\r\n        }\r\n    });\r\n\r\n    /**\r\n     * Projects a set of {@link Cartographic} coordinates, in radians, to map coordinates, in meters.\r\n     * X and Y are the longitude and latitude, respectively, multiplied by the maximum radius of the\r\n     * ellipsoid.  Z is the unmodified height.\r\n     *\r\n     * @param {Cartographic} cartographic The coordinates to project.\r\n     * @param {Cartesian3} [result] An instance into which to copy the result.  If this parameter is\r\n     *        undefined, a new instance is created and returned.\r\n     * @returns {Cartesian3} The projected coordinates.  If the result parameter is not undefined, the\r\n     *          coordinates are copied there and that instance is returned.  Otherwise, a new instance is\r\n     *          created and returned.\r\n     */\r\n    GeographicProjection.prototype.project = function(cartographic, result) {\r\n        // Actually this is the special case of equidistant cylindrical called the plate carree\r\n        var semimajorAxis = this._semimajorAxis;\r\n        var x = cartographic.longitude * semimajorAxis;\r\n        var y = cartographic.latitude * semimajorAxis;\r\n        var z = cartographic.height;\r\n\r\n        if (!defined(result)) {\r\n            return new Cartesian3(x, y, z);\r\n        }\r\n\r\n        result.x = x;\r\n        result.y = y;\r\n        result.z = z;\r\n        return result;\r\n    };\r\n\r\n    /**\r\n     * Unprojects a set of projected {@link Cartesian3} coordinates, in meters, to {@link Cartographic}\r\n     * coordinates, in radians.  Longitude and Latitude are the X and Y coordinates, respectively,\r\n     * divided by the maximum radius of the ellipsoid.  Height is the unmodified Z coordinate.\r\n     *\r\n     * @param {Cartesian3} cartesian The Cartesian position to unproject with height (z) in meters.\r\n     * @param {Cartographic} [result] An instance into which to copy the result.  If this parameter is\r\n     *        undefined, a new instance is created and returned.\r\n     * @returns {Cartographic} The unprojected coordinates.  If the result parameter is not undefined, the\r\n     *          coordinates are copied there and that instance is returned.  Otherwise, a new instance is\r\n     *          created and returned.\r\n     */\r\n    GeographicProjection.prototype.unproject = function(cartesian, result) {\r\n        //>>includeStart('debug', pragmas.debug);\r\n        if (!defined(cartesian)) {\r\n            throw new DeveloperError('cartesian is required');\r\n        }\r\n        //>>includeEnd('debug');\r\n\r\n        var oneOverEarthSemimajorAxis = this._oneOverSemimajorAxis;\r\n        var longitude = cartesian.x * oneOverEarthSemimajorAxis;\r\n        var latitude = cartesian.y * oneOverEarthSemimajorAxis;\r\n        var height = cartesian.z;\r\n\r\n        if (!defined(result)) {\r\n            return new Cartographic(longitude, latitude, height);\r\n        }\r\n\r\n        result.longitude = longitude;\r\n        result.latitude = latitude;\r\n        result.height = height;\r\n        return result;\r\n    };\r\nexport default GeographicProjection;\r\n","\r\n    /**\r\n     * This enumerated type is used in determining where, relative to the frustum, an\r\n     * object is located. The object can either be fully contained within the frustum (INSIDE),\r\n     * partially inside the frustum and partially outside (INTERSECTING), or somwhere entirely\r\n     * outside of the frustum's 6 planes (OUTSIDE).\r\n     *\r\n     * @exports Intersect\r\n     */\r\n    var Intersect = {\r\n        /**\r\n         * Represents that an object is not contained within the frustum.\r\n         *\r\n         * @type {Number}\r\n         * @constant\r\n         */\r\n        OUTSIDE : -1,\r\n\r\n        /**\r\n         * Represents that an object intersects one of the frustum's planes.\r\n         *\r\n         * @type {Number}\r\n         * @constant\r\n         */\r\n        INTERSECTING : 0,\r\n\r\n        /**\r\n         * Represents that an object is fully within the frustum.\r\n         *\r\n         * @type {Number}\r\n         * @constant\r\n         */\r\n        INSIDE : 1\r\n    };\r\nexport default Object.freeze(Intersect);\r\n","import defaultValue from './defaultValue.js';\r\n\r\n    /**\r\n     * Represents the closed interval [start, stop].\r\n     * @alias Interval\r\n     * @constructor\r\n     *\r\n     * @param {Number} [start=0.0] The beginning of the interval.\r\n     * @param {Number} [stop=0.0] The end of the interval.\r\n     */\r\n    function Interval(start, stop) {\r\n        /**\r\n         * The beginning of the interval.\r\n         * @type {Number}\r\n         * @default 0.0\r\n         */\r\n        this.start = defaultValue(start, 0.0);\r\n        /**\r\n         * The end of the interval.\r\n         * @type {Number}\r\n         * @default 0.0\r\n         */\r\n        this.stop = defaultValue(stop, 0.0);\r\n    }\r\nexport default Interval;\r\n","import Cartesian3 from './Cartesian3.js';\r\nimport Cartographic from './Cartographic.js';\r\nimport Check from './Check.js';\r\nimport defaultValue from './defaultValue.js';\r\nimport defined from './defined.js';\r\nimport Ellipsoid from './Ellipsoid.js';\r\nimport GeographicProjection from './GeographicProjection.js';\r\nimport Intersect from './Intersect.js';\r\nimport Interval from './Interval.js';\r\nimport CesiumMath from './Math.js';\r\nimport Matrix3 from './Matrix3.js';\r\nimport Matrix4 from './Matrix4.js';\r\nimport Rectangle from './Rectangle.js';\r\n\r\n    /**\r\n     * A bounding sphere with a center and a radius.\r\n     * @alias BoundingSphere\r\n     * @constructor\r\n     *\r\n     * @param {Cartesian3} [center=Cartesian3.ZERO] The center of the bounding sphere.\r\n     * @param {Number} [radius=0.0] The radius of the bounding sphere.\r\n     *\r\n     * @see AxisAlignedBoundingBox\r\n     * @see BoundingRectangle\r\n     * @see Packable\r\n     */\r\n    function BoundingSphere(center, radius) {\r\n        /**\r\n         * The center point of the sphere.\r\n         * @type {Cartesian3}\r\n         * @default {@link Cartesian3.ZERO}\r\n         */\r\n        this.center = Cartesian3.clone(defaultValue(center, Cartesian3.ZERO));\r\n\r\n        /**\r\n         * The radius of the sphere.\r\n         * @type {Number}\r\n         * @default 0.0\r\n         */\r\n        this.radius = defaultValue(radius, 0.0);\r\n    }\r\n\r\n    var fromPointsXMin = new Cartesian3();\r\n    var fromPointsYMin = new Cartesian3();\r\n    var fromPointsZMin = new Cartesian3();\r\n    var fromPointsXMax = new Cartesian3();\r\n    var fromPointsYMax = new Cartesian3();\r\n    var fromPointsZMax = new Cartesian3();\r\n    var fromPointsCurrentPos = new Cartesian3();\r\n    var fromPointsScratch = new Cartesian3();\r\n    var fromPointsRitterCenter = new Cartesian3();\r\n    var fromPointsMinBoxPt = new Cartesian3();\r\n    var fromPointsMaxBoxPt = new Cartesian3();\r\n    var fromPointsNaiveCenterScratch = new Cartesian3();\r\n    var volumeConstant = (4.0 / 3.0) * CesiumMath.PI;\r\n\r\n    /**\r\n     * Computes a tight-fitting bounding sphere enclosing a list of 3D Cartesian points.\r\n     * The bounding sphere is computed by running two algorithms, a naive algorithm and\r\n     * Ritter's algorithm. The smaller of the two spheres is used to ensure a tight fit.\r\n     *\r\n     * @param {Cartesian3[]} [positions] An array of points that the bounding sphere will enclose.  Each point must have <code>x</code>, <code>y</code>, and <code>z</code> properties.\r\n     * @param {BoundingSphere} [result] The object onto which to store the result.\r\n     * @returns {BoundingSphere} The modified result parameter or a new BoundingSphere instance if one was not provided.\r\n     *\r\n     * @see {@link http://help.agi.com/AGIComponents/html/BlogBoundingSphere.htm|Bounding Sphere computation article}\r\n     */\r\n    BoundingSphere.fromPoints = function(positions, result) {\r\n        if (!defined(result)) {\r\n            result = new BoundingSphere();\r\n        }\r\n\r\n        if (!defined(positions) || positions.length === 0) {\r\n            result.center = Cartesian3.clone(Cartesian3.ZERO, result.center);\r\n            result.radius = 0.0;\r\n            return result;\r\n        }\r\n\r\n        var currentPos = Cartesian3.clone(positions[0], fromPointsCurrentPos);\r\n\r\n        var xMin = Cartesian3.clone(currentPos, fromPointsXMin);\r\n        var yMin = Cartesian3.clone(currentPos, fromPointsYMin);\r\n        var zMin = Cartesian3.clone(currentPos, fromPointsZMin);\r\n\r\n        var xMax = Cartesian3.clone(currentPos, fromPointsXMax);\r\n        var yMax = Cartesian3.clone(currentPos, fromPointsYMax);\r\n        var zMax = Cartesian3.clone(currentPos, fromPointsZMax);\r\n\r\n        var numPositions = positions.length;\r\n        var i;\r\n        for (i = 1; i < numPositions; i++) {\r\n            Cartesian3.clone(positions[i], currentPos);\r\n\r\n            var x = currentPos.x;\r\n            var y = currentPos.y;\r\n            var z = currentPos.z;\r\n\r\n            // Store points containing the the smallest and largest components\r\n            if (x < xMin.x) {\r\n                Cartesian3.clone(currentPos, xMin);\r\n            }\r\n\r\n            if (x > xMax.x) {\r\n                Cartesian3.clone(currentPos, xMax);\r\n            }\r\n\r\n            if (y < yMin.y) {\r\n                Cartesian3.clone(currentPos, yMin);\r\n            }\r\n\r\n            if (y > yMax.y) {\r\n                Cartesian3.clone(currentPos, yMax);\r\n            }\r\n\r\n            if (z < zMin.z) {\r\n                Cartesian3.clone(currentPos, zMin);\r\n            }\r\n\r\n            if (z > zMax.z) {\r\n                Cartesian3.clone(currentPos, zMax);\r\n            }\r\n        }\r\n\r\n        // Compute x-, y-, and z-spans (Squared distances b/n each component's min. and max.).\r\n        var xSpan = Cartesian3.magnitudeSquared(Cartesian3.subtract(xMax, xMin, fromPointsScratch));\r\n        var ySpan = Cartesian3.magnitudeSquared(Cartesian3.subtract(yMax, yMin, fromPointsScratch));\r\n        var zSpan = Cartesian3.magnitudeSquared(Cartesian3.subtract(zMax, zMin, fromPointsScratch));\r\n\r\n        // Set the diameter endpoints to the largest span.\r\n        var diameter1 = xMin;\r\n        var diameter2 = xMax;\r\n        var maxSpan = xSpan;\r\n        if (ySpan > maxSpan) {\r\n            maxSpan = ySpan;\r\n            diameter1 = yMin;\r\n            diameter2 = yMax;\r\n        }\r\n        if (zSpan > maxSpan) {\r\n            maxSpan = zSpan;\r\n            diameter1 = zMin;\r\n            diameter2 = zMax;\r\n        }\r\n\r\n        // Calculate the center of the initial sphere found by Ritter's algorithm\r\n        var ritterCenter = fromPointsRitterCenter;\r\n        ritterCenter.x = (diameter1.x + diameter2.x) * 0.5;\r\n        ritterCenter.y = (diameter1.y + diameter2.y) * 0.5;\r\n        ritterCenter.z = (diameter1.z + diameter2.z) * 0.5;\r\n\r\n        // Calculate the radius of the initial sphere found by Ritter's algorithm\r\n        var radiusSquared = Cartesian3.magnitudeSquared(Cartesian3.subtract(diameter2, ritterCenter, fromPointsScratch));\r\n        var ritterRadius = Math.sqrt(radiusSquared);\r\n\r\n        // Find the center of the sphere found using the Naive method.\r\n        var minBoxPt = fromPointsMinBoxPt;\r\n        minBoxPt.x = xMin.x;\r\n        minBoxPt.y = yMin.y;\r\n        minBoxPt.z = zMin.z;\r\n\r\n        var maxBoxPt = fromPointsMaxBoxPt;\r\n        maxBoxPt.x = xMax.x;\r\n        maxBoxPt.y = yMax.y;\r\n        maxBoxPt.z = zMax.z;\r\n\r\n        var naiveCenter = Cartesian3.midpoint(minBoxPt, maxBoxPt, fromPointsNaiveCenterScratch);\r\n\r\n        // Begin 2nd pass to find naive radius and modify the ritter sphere.\r\n        var naiveRadius = 0;\r\n        for (i = 0; i < numPositions; i++) {\r\n            Cartesian3.clone(positions[i], currentPos);\r\n\r\n            // Find the furthest point from the naive center to calculate the naive radius.\r\n            var r = Cartesian3.magnitude(Cartesian3.subtract(currentPos, naiveCenter, fromPointsScratch));\r\n            if (r > naiveRadius) {\r\n                naiveRadius = r;\r\n            }\r\n\r\n            // Make adjustments to the Ritter Sphere to include all points.\r\n            var oldCenterToPointSquared = Cartesian3.magnitudeSquared(Cartesian3.subtract(currentPos, ritterCenter, fromPointsScratch));\r\n            if (oldCenterToPointSquared > radiusSquared) {\r\n                var oldCenterToPoint = Math.sqrt(oldCenterToPointSquared);\r\n                // Calculate new radius to include the point that lies outside\r\n                ritterRadius = (ritterRadius + oldCenterToPoint) * 0.5;\r\n                radiusSquared = ritterRadius * ritterRadius;\r\n                // Calculate center of new Ritter sphere\r\n                var oldToNew = oldCenterToPoint - ritterRadius;\r\n                ritterCenter.x = (ritterRadius * ritterCenter.x + oldToNew * currentPos.x) / oldCenterToPoint;\r\n                ritterCenter.y = (ritterRadius * ritterCenter.y + oldToNew * currentPos.y) / oldCenterToPoint;\r\n                ritterCenter.z = (ritterRadius * ritterCenter.z + oldToNew * currentPos.z) / oldCenterToPoint;\r\n            }\r\n        }\r\n\r\n        if (ritterRadius < naiveRadius) {\r\n            Cartesian3.clone(ritterCenter, result.center);\r\n            result.radius = ritterRadius;\r\n        } else {\r\n            Cartesian3.clone(naiveCenter, result.center);\r\n            result.radius = naiveRadius;\r\n        }\r\n\r\n        return result;\r\n    };\r\n\r\n    BoundingSphere.fromInstancePoints = function(positions, result, numPositions) {\r\n    if (!defined(result)) {\r\n        result = new BoundingSphere();\r\n    }\r\n\r\n    if (!defined(positions) || numPositions === 0) {\r\n        result.center = Cartesian3.clone(Cartesian3.ZERO, result.center);\r\n        result.radius = 0.0;\r\n        return result;\r\n    }\r\n\r\n    var currentPos = Cartesian3.clone(positions[0], fromPointsCurrentPos);\r\n\r\n    var xMin = Cartesian3.clone(currentPos, fromPointsXMin);\r\n    var yMin = Cartesian3.clone(currentPos, fromPointsYMin);\r\n    var zMin = Cartesian3.clone(currentPos, fromPointsZMin);\r\n\r\n    var xMax = Cartesian3.clone(currentPos, fromPointsXMax);\r\n    var yMax = Cartesian3.clone(currentPos, fromPointsYMax);\r\n    var zMax = Cartesian3.clone(currentPos, fromPointsZMax);\r\n\r\n    var i;\r\n    for (i = 1; i < numPositions; i++) {\r\n        Cartesian3.clone(positions[i], currentPos);\r\n\r\n        var x = currentPos.x;\r\n        var y = currentPos.y;\r\n        var z = currentPos.z;\r\n\r\n        // Store points containing the the smallest and largest components\r\n        if (x < xMin.x) {\r\n            Cartesian3.clone(currentPos, xMin);\r\n        }\r\n\r\n        if (x > xMax.x) {\r\n            Cartesian3.clone(currentPos, xMax);\r\n        }\r\n\r\n        if (y < yMin.y) {\r\n            Cartesian3.clone(currentPos, yMin);\r\n        }\r\n\r\n        if (y > yMax.y) {\r\n            Cartesian3.clone(currentPos, yMax);\r\n        }\r\n\r\n        if (z < zMin.z) {\r\n            Cartesian3.clone(currentPos, zMin);\r\n        }\r\n\r\n        if (z > zMax.z) {\r\n            Cartesian3.clone(currentPos, zMax);\r\n        }\r\n    }\r\n\r\n    // Compute x-, y-, and z-spans (Squared distances b/n each component's min. and max.).\r\n    var xSpan = Cartesian3.magnitudeSquared(Cartesian3.subtract(xMax, xMin, fromPointsScratch));\r\n    var ySpan = Cartesian3.magnitudeSquared(Cartesian3.subtract(yMax, yMin, fromPointsScratch));\r\n    var zSpan = Cartesian3.magnitudeSquared(Cartesian3.subtract(zMax, zMin, fromPointsScratch));\r\n\r\n    // Set the diameter endpoints to the largest span.\r\n    var diameter1 = xMin;\r\n    var diameter2 = xMax;\r\n    var maxSpan = xSpan;\r\n    if (ySpan > maxSpan) {\r\n        maxSpan = ySpan;\r\n        diameter1 = yMin;\r\n        diameter2 = yMax;\r\n    }\r\n    if (zSpan > maxSpan) {\r\n        maxSpan = zSpan;\r\n        diameter1 = zMin;\r\n        diameter2 = zMax;\r\n    }\r\n\r\n    // Calculate the center of the initial sphere found by Ritter's algorithm\r\n    var ritterCenter = fromPointsRitterCenter;\r\n    ritterCenter.x = (diameter1.x + diameter2.x) * 0.5;\r\n    ritterCenter.y = (diameter1.y + diameter2.y) * 0.5;\r\n    ritterCenter.z = (diameter1.z + diameter2.z) * 0.5;\r\n\r\n    // Calculate the radius of the initial sphere found by Ritter's algorithm\r\n    var radiusSquared = Cartesian3.magnitudeSquared(Cartesian3.subtract(diameter2, ritterCenter, fromPointsScratch));\r\n    var ritterRadius = Math.sqrt(radiusSquared);\r\n\r\n    // Find the center of the sphere found using the Naive method.\r\n    var minBoxPt = fromPointsMinBoxPt;\r\n    minBoxPt.x = xMin.x;\r\n    minBoxPt.y = yMin.y;\r\n    minBoxPt.z = zMin.z;\r\n\r\n    var maxBoxPt = fromPointsMaxBoxPt;\r\n    maxBoxPt.x = xMax.x;\r\n    maxBoxPt.y = yMax.y;\r\n    maxBoxPt.z = zMax.z;\r\n\r\n    var naiveCenter = Cartesian3.midpoint(minBoxPt, maxBoxPt, fromPointsNaiveCenterScratch);\r\n\r\n    // Begin 2nd pass to find naive radius and modify the ritter sphere.\r\n    var naiveRadius = 0;\r\n    for (i = 0; i < numPositions; i++) {\r\n        Cartesian3.clone(positions[i], currentPos);\r\n\r\n        // Find the furthest point from the naive center to calculate the naive radius.\r\n        var r = Cartesian3.magnitude(Cartesian3.subtract(currentPos, naiveCenter, fromPointsScratch));\r\n        if (r > naiveRadius) {\r\n            naiveRadius = r;\r\n        }\r\n\r\n        // Make adjustments to the Ritter Sphere to include all points.\r\n        var oldCenterToPointSquared = Cartesian3.magnitudeSquared(Cartesian3.subtract(currentPos, ritterCenter, fromPointsScratch));\r\n        if (oldCenterToPointSquared > radiusSquared) {\r\n            var oldCenterToPoint = Math.sqrt(oldCenterToPointSquared);\r\n            // Calculate new radius to include the point that lies outside\r\n            ritterRadius = (ritterRadius + oldCenterToPoint) * 0.5;\r\n            radiusSquared = ritterRadius * ritterRadius;\r\n            // Calculate center of new Ritter sphere\r\n            var oldToNew = oldCenterToPoint - ritterRadius;\r\n            ritterCenter.x = (ritterRadius * ritterCenter.x + oldToNew * currentPos.x) / oldCenterToPoint;\r\n            ritterCenter.y = (ritterRadius * ritterCenter.y + oldToNew * currentPos.y) / oldCenterToPoint;\r\n            ritterCenter.z = (ritterRadius * ritterCenter.z + oldToNew * currentPos.z) / oldCenterToPoint;\r\n        }\r\n    }\r\n\r\n    if (ritterRadius < naiveRadius) {\r\n        Cartesian3.clone(ritterCenter, result.center);\r\n        result.radius = ritterRadius;\r\n    } else {\r\n        Cartesian3.clone(naiveCenter, result.center);\r\n        result.radius = naiveRadius;\r\n    }\r\n\r\n    return result;\r\n};\r\n\r\n    var defaultProjection = new GeographicProjection();\r\n    var fromRectangle2DLowerLeft = new Cartesian3();\r\n    var fromRectangle2DUpperRight = new Cartesian3();\r\n    var fromRectangle2DSouthwest = new Cartographic();\r\n    var fromRectangle2DNortheast = new Cartographic();\r\n\r\n    /**\r\n     * Computes a bounding sphere from a rectangle projected in 2D.\r\n     *\r\n     * @param {Rectangle} [rectangle] The rectangle around which to create a bounding sphere.\r\n     * @param {Object} [projection=GeographicProjection] The projection used to project the rectangle into 2D.\r\n     * @param {BoundingSphere} [result] The object onto which to store the result.\r\n     * @returns {BoundingSphere} The modified result parameter or a new BoundingSphere instance if none was provided.\r\n     */\r\n    BoundingSphere.fromRectangle2D = function(rectangle, projection, result) {\r\n        return BoundingSphere.fromRectangleWithHeights2D(rectangle, projection, 0.0, 0.0, result);\r\n    };\r\n\r\n    /**\r\n     * Computes a bounding sphere from a rectangle projected in 2D.  The bounding sphere accounts for the\r\n     * object's minimum and maximum heights over the rectangle.\r\n     *\r\n     * @param {Rectangle} [rectangle] The rectangle around which to create a bounding sphere.\r\n     * @param {Object} [projection=GeographicProjection] The projection used to project the rectangle into 2D.\r\n     * @param {Number} [minimumHeight=0.0] The minimum height over the rectangle.\r\n     * @param {Number} [maximumHeight=0.0] The maximum height over the rectangle.\r\n     * @param {BoundingSphere} [result] The object onto which to store the result.\r\n     * @returns {BoundingSphere} The modified result parameter or a new BoundingSphere instance if none was provided.\r\n     */\r\n    BoundingSphere.fromRectangleWithHeights2D = function(rectangle, projection, minimumHeight, maximumHeight, result) {\r\n        if (!defined(result)) {\r\n            result = new BoundingSphere();\r\n        }\r\n\r\n        if (!defined(rectangle)) {\r\n            result.center = Cartesian3.clone(Cartesian3.ZERO, result.center);\r\n            result.radius = 0.0;\r\n            return result;\r\n        }\r\n\r\n        projection = defaultValue(projection, defaultProjection);\r\n\r\n        Rectangle.southwest(rectangle, fromRectangle2DSouthwest);\r\n        fromRectangle2DSouthwest.height = minimumHeight;\r\n        Rectangle.northeast(rectangle, fromRectangle2DNortheast);\r\n        fromRectangle2DNortheast.height = maximumHeight;\r\n\r\n        var lowerLeft = projection.project(fromRectangle2DSouthwest, fromRectangle2DLowerLeft);\r\n        var upperRight = projection.project(fromRectangle2DNortheast, fromRectangle2DUpperRight);\r\n\r\n        var width = upperRight.x - lowerLeft.x;\r\n        var height = upperRight.y - lowerLeft.y;\r\n        var elevation = upperRight.z - lowerLeft.z;\r\n\r\n        result.radius = Math.sqrt(width * width + height * height + elevation * elevation) * 0.5;\r\n        var center = result.center;\r\n        center.x = lowerLeft.x + width * 0.5;\r\n        center.y = lowerLeft.y + height * 0.5;\r\n        center.z = lowerLeft.z + elevation * 0.5;\r\n        return result;\r\n    };\r\n\r\n    var fromRectangle3DScratch = [];\r\n\r\n    /**\r\n     * Computes a bounding sphere from a rectangle in 3D. The bounding sphere is created using a subsample of points\r\n     * on the ellipsoid and contained in the rectangle. It may not be accurate for all rectangles on all types of ellipsoids.\r\n     *\r\n     * @param {Rectangle} [rectangle] The valid rectangle used to create a bounding sphere.\r\n     * @param {Ellipsoid} [ellipsoid=Ellipsoid.WGS84] The ellipsoid used to determine positions of the rectangle.\r\n     * @param {Number} [surfaceHeight=0.0] The height above the surface of the ellipsoid.\r\n     * @param {BoundingSphere} [result] The object onto which to store the result.\r\n     * @returns {BoundingSphere} The modified result parameter or a new BoundingSphere instance if none was provided.\r\n     */\r\n    BoundingSphere.fromRectangle3D = function(rectangle, ellipsoid, surfaceHeight, result) {\r\n        ellipsoid = defaultValue(ellipsoid, Ellipsoid.WGS84);\r\n        surfaceHeight = defaultValue(surfaceHeight, 0.0);\r\n\r\n        if (!defined(result)) {\r\n            result = new BoundingSphere();\r\n        }\r\n\r\n        if (!defined(rectangle)) {\r\n            result.center = Cartesian3.clone(Cartesian3.ZERO, result.center);\r\n            result.radius = 0.0;\r\n            return result;\r\n        }\r\n\r\n        var positions = Rectangle.subsample(rectangle, ellipsoid, surfaceHeight, fromRectangle3DScratch);\r\n        return BoundingSphere.fromPoints(positions, result);\r\n    };\r\n\r\n    /**\r\n     * Computes a tight-fitting bounding sphere enclosing a list of 3D points, where the points are\r\n     * stored in a flat array in X, Y, Z, order.  The bounding sphere is computed by running two\r\n     * algorithms, a naive algorithm and Ritter's algorithm. The smaller of the two spheres is used to\r\n     * ensure a tight fit.\r\n     *\r\n     * @param {Number[]} [positions] An array of points that the bounding sphere will enclose.  Each point\r\n     *        is formed from three elements in the array in the order X, Y, Z.\r\n     * @param {Cartesian3} [center=Cartesian3.ZERO] The position to which the positions are relative, which need not be the\r\n     *        origin of the coordinate system.  This is useful when the positions are to be used for\r\n     *        relative-to-center (RTC) rendering.\r\n     * @param {Number} [stride=3] The number of array elements per vertex.  It must be at least 3, but it may\r\n     *        be higher.  Regardless of the value of this parameter, the X coordinate of the first position\r\n     *        is at array index 0, the Y coordinate is at array index 1, and the Z coordinate is at array index\r\n     *        2.  When stride is 3, the X coordinate of the next position then begins at array index 3.  If\r\n     *        the stride is 5, however, two array elements are skipped and the next position begins at array\r\n     *        index 5.\r\n     * @param {BoundingSphere} [result] The object onto which to store the result.\r\n     * @returns {BoundingSphere} The modified result parameter or a new BoundingSphere instance if one was not provided.\r\n     *\r\n     * @example\r\n     * // Compute the bounding sphere from 3 positions, each specified relative to a center.\r\n     * // In addition to the X, Y, and Z coordinates, the points array contains two additional\r\n     * // elements per point which are ignored for the purpose of computing the bounding sphere.\r\n     * var center = new Cesium.Cartesian3(1.0, 2.0, 3.0);\r\n     * var points = [1.0, 2.0, 3.0, 0.1, 0.2,\r\n     *               4.0, 5.0, 6.0, 0.1, 0.2,\r\n     *               7.0, 8.0, 9.0, 0.1, 0.2];\r\n     * var sphere = Cesium.BoundingSphere.fromVertices(points, center, 5);\r\n     *\r\n     * @see {@link http://blogs.agi.com/insight3d/index.php/2008/02/04/a-bounding/|Bounding Sphere computation article}\r\n     */\r\n    BoundingSphere.fromVertices = function(positions, center, stride, result) {\r\n        if (!defined(result)) {\r\n            result = new BoundingSphere();\r\n        }\r\n\r\n        if (!defined(positions) || positions.length === 0) {\r\n            result.center = Cartesian3.clone(Cartesian3.ZERO, result.center);\r\n            result.radius = 0.0;\r\n            return result;\r\n        }\r\n\r\n        center = defaultValue(center, Cartesian3.ZERO);\r\n\r\n        stride = defaultValue(stride, 3);\r\n\r\n        //>>includeStart('debug', pragmas.debug);\r\n        Check.typeOf.number.greaterThanOrEquals('stride', stride, 3);\r\n        //>>includeEnd('debug');\r\n\r\n        var currentPos = fromPointsCurrentPos;\r\n        currentPos.x = positions[0] + center.x;\r\n        currentPos.y = positions[1] + center.y;\r\n        currentPos.z = positions[2] + center.z;\r\n\r\n        var xMin = Cartesian3.clone(currentPos, fromPointsXMin);\r\n        var yMin = Cartesian3.clone(currentPos, fromPointsYMin);\r\n        var zMin = Cartesian3.clone(currentPos, fromPointsZMin);\r\n\r\n        var xMax = Cartesian3.clone(currentPos, fromPointsXMax);\r\n        var yMax = Cartesian3.clone(currentPos, fromPointsYMax);\r\n        var zMax = Cartesian3.clone(currentPos, fromPointsZMax);\r\n\r\n        var numElements = positions.length;\r\n        var i;\r\n        for (i = 0; i < numElements; i += stride) {\r\n            var x = positions[i] + center.x;\r\n            var y = positions[i + 1] + center.y;\r\n            var z = positions[i + 2] + center.z;\r\n\r\n            currentPos.x = x;\r\n            currentPos.y = y;\r\n            currentPos.z = z;\r\n\r\n            // Store points containing the the smallest and largest components\r\n            if (x < xMin.x) {\r\n                Cartesian3.clone(currentPos, xMin);\r\n            }\r\n\r\n            if (x > xMax.x) {\r\n                Cartesian3.clone(currentPos, xMax);\r\n            }\r\n\r\n            if (y < yMin.y) {\r\n                Cartesian3.clone(currentPos, yMin);\r\n            }\r\n\r\n            if (y > yMax.y) {\r\n                Cartesian3.clone(currentPos, yMax);\r\n            }\r\n\r\n            if (z < zMin.z) {\r\n                Cartesian3.clone(currentPos, zMin);\r\n            }\r\n\r\n            if (z > zMax.z) {\r\n                Cartesian3.clone(currentPos, zMax);\r\n            }\r\n        }\r\n\r\n        // Compute x-, y-, and z-spans (Squared distances b/n each component's min. and max.).\r\n        var xSpan = Cartesian3.magnitudeSquared(Cartesian3.subtract(xMax, xMin, fromPointsScratch));\r\n        var ySpan = Cartesian3.magnitudeSquared(Cartesian3.subtract(yMax, yMin, fromPointsScratch));\r\n        var zSpan = Cartesian3.magnitudeSquared(Cartesian3.subtract(zMax, zMin, fromPointsScratch));\r\n\r\n        // Set the diameter endpoints to the largest span.\r\n        var diameter1 = xMin;\r\n        var diameter2 = xMax;\r\n        var maxSpan = xSpan;\r\n        if (ySpan > maxSpan) {\r\n            maxSpan = ySpan;\r\n            diameter1 = yMin;\r\n            diameter2 = yMax;\r\n        }\r\n        if (zSpan > maxSpan) {\r\n            maxSpan = zSpan;\r\n            diameter1 = zMin;\r\n            diameter2 = zMax;\r\n        }\r\n\r\n        // Calculate the center of the initial sphere found by Ritter's algorithm\r\n        var ritterCenter = fromPointsRitterCenter;\r\n        ritterCenter.x = (diameter1.x + diameter2.x) * 0.5;\r\n        ritterCenter.y = (diameter1.y + diameter2.y) * 0.5;\r\n        ritterCenter.z = (diameter1.z + diameter2.z) * 0.5;\r\n\r\n        // Calculate the radius of the initial sphere found by Ritter's algorithm\r\n        var radiusSquared = Cartesian3.magnitudeSquared(Cartesian3.subtract(diameter2, ritterCenter, fromPointsScratch));\r\n        var ritterRadius = Math.sqrt(radiusSquared);\r\n\r\n        // Find the center of the sphere found using the Naive method.\r\n        var minBoxPt = fromPointsMinBoxPt;\r\n        minBoxPt.x = xMin.x;\r\n        minBoxPt.y = yMin.y;\r\n        minBoxPt.z = zMin.z;\r\n\r\n        var maxBoxPt = fromPointsMaxBoxPt;\r\n        maxBoxPt.x = xMax.x;\r\n        maxBoxPt.y = yMax.y;\r\n        maxBoxPt.z = zMax.z;\r\n\r\n        var naiveCenter = Cartesian3.midpoint(minBoxPt, maxBoxPt, fromPointsNaiveCenterScratch);\r\n\r\n        // Begin 2nd pass to find naive radius and modify the ritter sphere.\r\n        var naiveRadius = 0;\r\n        for (i = 0; i < numElements; i += stride) {\r\n            currentPos.x = positions[i] + center.x;\r\n            currentPos.y = positions[i + 1] + center.y;\r\n            currentPos.z = positions[i + 2] + center.z;\r\n\r\n            // Find the furthest point from the naive center to calculate the naive radius.\r\n            var r = Cartesian3.magnitude(Cartesian3.subtract(currentPos, naiveCenter, fromPointsScratch));\r\n            if (r > naiveRadius) {\r\n                naiveRadius = r;\r\n            }\r\n\r\n            // Make adjustments to the Ritter Sphere to include all points.\r\n            var oldCenterToPointSquared = Cartesian3.magnitudeSquared(Cartesian3.subtract(currentPos, ritterCenter, fromPointsScratch));\r\n            if (oldCenterToPointSquared > radiusSquared) {\r\n                var oldCenterToPoint = Math.sqrt(oldCenterToPointSquared);\r\n                // Calculate new radius to include the point that lies outside\r\n                ritterRadius = (ritterRadius + oldCenterToPoint) * 0.5;\r\n                radiusSquared = ritterRadius * ritterRadius;\r\n                // Calculate center of new Ritter sphere\r\n                var oldToNew = oldCenterToPoint - ritterRadius;\r\n                ritterCenter.x = (ritterRadius * ritterCenter.x + oldToNew * currentPos.x) / oldCenterToPoint;\r\n                ritterCenter.y = (ritterRadius * ritterCenter.y + oldToNew * currentPos.y) / oldCenterToPoint;\r\n                ritterCenter.z = (ritterRadius * ritterCenter.z + oldToNew * currentPos.z) / oldCenterToPoint;\r\n            }\r\n        }\r\n\r\n        if (ritterRadius < naiveRadius) {\r\n            Cartesian3.clone(ritterCenter, result.center);\r\n            result.radius = ritterRadius;\r\n        } else {\r\n            Cartesian3.clone(naiveCenter, result.center);\r\n            result.radius = naiveRadius;\r\n        }\r\n\r\n        return result;\r\n    };\r\n\r\n    /**\r\n     * Computes a tight-fitting bounding sphere enclosing a list of EncodedCartesian3s, where the points are\r\n     * stored in parallel flat arrays in X, Y, Z, order.  The bounding sphere is computed by running two\r\n     * algorithms, a naive algorithm and Ritter's algorithm. The smaller of the two spheres is used to\r\n     * ensure a tight fit.\r\n     *\r\n     * @param {Number[]} [positionsHigh] An array of high bits of the encoded cartesians that the bounding sphere will enclose.  Each point\r\n     *        is formed from three elements in the array in the order X, Y, Z.\r\n     * @param {Number[]} [positionsLow] An array of low bits of the encoded cartesians that the bounding sphere will enclose.  Each point\r\n     *        is formed from three elements in the array in the order X, Y, Z.\r\n     * @param {BoundingSphere} [result] The object onto which to store the result.\r\n     * @returns {BoundingSphere} The modified result parameter or a new BoundingSphere instance if one was not provided.\r\n     *\r\n     * @see {@link http://blogs.agi.com/insight3d/index.php/2008/02/04/a-bounding/|Bounding Sphere computation article}\r\n     */\r\n    BoundingSphere.fromEncodedCartesianVertices = function(positionsHigh, positionsLow, result) {\r\n        if (!defined(result)) {\r\n            result = new BoundingSphere();\r\n        }\r\n\r\n        if (!defined(positionsHigh) || !defined(positionsLow) || positionsHigh.length !== positionsLow.length || positionsHigh.length === 0) {\r\n            result.center = Cartesian3.clone(Cartesian3.ZERO, result.center);\r\n            result.radius = 0.0;\r\n            return result;\r\n        }\r\n\r\n        var currentPos = fromPointsCurrentPos;\r\n        currentPos.x = positionsHigh[0] + positionsLow[0];\r\n        currentPos.y = positionsHigh[1] + positionsLow[1];\r\n        currentPos.z = positionsHigh[2] + positionsLow[2];\r\n\r\n        var xMin = Cartesian3.clone(currentPos, fromPointsXMin);\r\n        var yMin = Cartesian3.clone(currentPos, fromPointsYMin);\r\n        var zMin = Cartesian3.clone(currentPos, fromPointsZMin);\r\n\r\n        var xMax = Cartesian3.clone(currentPos, fromPointsXMax);\r\n        var yMax = Cartesian3.clone(currentPos, fromPointsYMax);\r\n        var zMax = Cartesian3.clone(currentPos, fromPointsZMax);\r\n\r\n        var numElements = positionsHigh.length;\r\n        var i;\r\n        for (i = 0; i < numElements; i += 3) {\r\n            var x = positionsHigh[i] + positionsLow[i];\r\n            var y = positionsHigh[i + 1] + positionsLow[i + 1];\r\n            var z = positionsHigh[i + 2] + positionsLow[i + 2];\r\n\r\n            currentPos.x = x;\r\n            currentPos.y = y;\r\n            currentPos.z = z;\r\n\r\n            // Store points containing the the smallest and largest components\r\n            if (x < xMin.x) {\r\n                Cartesian3.clone(currentPos, xMin);\r\n            }\r\n\r\n            if (x > xMax.x) {\r\n                Cartesian3.clone(currentPos, xMax);\r\n            }\r\n\r\n            if (y < yMin.y) {\r\n                Cartesian3.clone(currentPos, yMin);\r\n            }\r\n\r\n            if (y > yMax.y) {\r\n                Cartesian3.clone(currentPos, yMax);\r\n            }\r\n\r\n            if (z < zMin.z) {\r\n                Cartesian3.clone(currentPos, zMin);\r\n            }\r\n\r\n            if (z > zMax.z) {\r\n                Cartesian3.clone(currentPos, zMax);\r\n            }\r\n        }\r\n\r\n        // Compute x-, y-, and z-spans (Squared distances b/n each component's min. and max.).\r\n        var xSpan = Cartesian3.magnitudeSquared(Cartesian3.subtract(xMax, xMin, fromPointsScratch));\r\n        var ySpan = Cartesian3.magnitudeSquared(Cartesian3.subtract(yMax, yMin, fromPointsScratch));\r\n        var zSpan = Cartesian3.magnitudeSquared(Cartesian3.subtract(zMax, zMin, fromPointsScratch));\r\n\r\n        // Set the diameter endpoints to the largest span.\r\n        var diameter1 = xMin;\r\n        var diameter2 = xMax;\r\n        var maxSpan = xSpan;\r\n        if (ySpan > maxSpan) {\r\n            maxSpan = ySpan;\r\n            diameter1 = yMin;\r\n            diameter2 = yMax;\r\n        }\r\n        if (zSpan > maxSpan) {\r\n            maxSpan = zSpan;\r\n            diameter1 = zMin;\r\n            diameter2 = zMax;\r\n        }\r\n\r\n        // Calculate the center of the initial sphere found by Ritter's algorithm\r\n        var ritterCenter = fromPointsRitterCenter;\r\n        ritterCenter.x = (diameter1.x + diameter2.x) * 0.5;\r\n        ritterCenter.y = (diameter1.y + diameter2.y) * 0.5;\r\n        ritterCenter.z = (diameter1.z + diameter2.z) * 0.5;\r\n\r\n        // Calculate the radius of the initial sphere found by Ritter's algorithm\r\n        var radiusSquared = Cartesian3.magnitudeSquared(Cartesian3.subtract(diameter2, ritterCenter, fromPointsScratch));\r\n        var ritterRadius = Math.sqrt(radiusSquared);\r\n\r\n        // Find the center of the sphere found using the Naive method.\r\n        var minBoxPt = fromPointsMinBoxPt;\r\n        minBoxPt.x = xMin.x;\r\n        minBoxPt.y = yMin.y;\r\n        minBoxPt.z = zMin.z;\r\n\r\n        var maxBoxPt = fromPointsMaxBoxPt;\r\n        maxBoxPt.x = xMax.x;\r\n        maxBoxPt.y = yMax.y;\r\n        maxBoxPt.z = zMax.z;\r\n\r\n        var naiveCenter = Cartesian3.midpoint(minBoxPt, maxBoxPt, fromPointsNaiveCenterScratch);\r\n\r\n        // Begin 2nd pass to find naive radius and modify the ritter sphere.\r\n        var naiveRadius = 0;\r\n        for (i = 0; i < numElements; i += 3) {\r\n            currentPos.x = positionsHigh[i] + positionsLow[i];\r\n            currentPos.y = positionsHigh[i + 1] + positionsLow[i + 1];\r\n            currentPos.z = positionsHigh[i + 2] + positionsLow[i + 2];\r\n\r\n            // Find the furthest point from the naive center to calculate the naive radius.\r\n            var r = Cartesian3.magnitude(Cartesian3.subtract(currentPos, naiveCenter, fromPointsScratch));\r\n            if (r > naiveRadius) {\r\n                naiveRadius = r;\r\n            }\r\n\r\n            // Make adjustments to the Ritter Sphere to include all points.\r\n            var oldCenterToPointSquared = Cartesian3.magnitudeSquared(Cartesian3.subtract(currentPos, ritterCenter, fromPointsScratch));\r\n            if (oldCenterToPointSquared > radiusSquared) {\r\n                var oldCenterToPoint = Math.sqrt(oldCenterToPointSquared);\r\n                // Calculate new radius to include the point that lies outside\r\n                ritterRadius = (ritterRadius + oldCenterToPoint) * 0.5;\r\n                radiusSquared = ritterRadius * ritterRadius;\r\n                // Calculate center of new Ritter sphere\r\n                var oldToNew = oldCenterToPoint - ritterRadius;\r\n                ritterCenter.x = (ritterRadius * ritterCenter.x + oldToNew * currentPos.x) / oldCenterToPoint;\r\n                ritterCenter.y = (ritterRadius * ritterCenter.y + oldToNew * currentPos.y) / oldCenterToPoint;\r\n                ritterCenter.z = (ritterRadius * ritterCenter.z + oldToNew * currentPos.z) / oldCenterToPoint;\r\n            }\r\n        }\r\n\r\n        if (ritterRadius < naiveRadius) {\r\n            Cartesian3.clone(ritterCenter, result.center);\r\n            result.radius = ritterRadius;\r\n        } else {\r\n            Cartesian3.clone(naiveCenter, result.center);\r\n            result.radius = naiveRadius;\r\n        }\r\n\r\n        return result;\r\n    };\r\n\r\n    /**\r\n     * Computes a bounding sphere from the corner points of an axis-aligned bounding box.  The sphere\r\n     * tighly and fully encompases the box.\r\n     *\r\n     * @param {Cartesian3} [corner] The minimum height over the rectangle.\r\n     * @param {Cartesian3} [oppositeCorner] The maximum height over the rectangle.\r\n     * @param {BoundingSphere} [result] The object onto which to store the result.\r\n     * @returns {BoundingSphere} The modified result parameter or a new BoundingSphere instance if none was provided.\r\n     *\r\n     * @example\r\n     * // Create a bounding sphere around the unit cube\r\n     * var sphere = Cesium.BoundingSphere.fromCornerPoints(new Cesium.Cartesian3(-0.5, -0.5, -0.5), new Cesium.Cartesian3(0.5, 0.5, 0.5));\r\n     */\r\n    BoundingSphere.fromCornerPoints = function(corner, oppositeCorner, result) {\r\n        //>>includeStart('debug', pragmas.debug);\r\n        Check.typeOf.object('corner', corner);\r\n        Check.typeOf.object('oppositeCorner', oppositeCorner);\r\n        //>>includeEnd('debug');\r\n\r\n        if (!defined(result)) {\r\n            result = new BoundingSphere();\r\n        }\r\n\r\n        var center = Cartesian3.midpoint(corner, oppositeCorner, result.center);\r\n        result.radius = Cartesian3.distance(center, oppositeCorner);\r\n        return result;\r\n    };\r\n\r\n    /**\r\n     * Creates a bounding sphere encompassing an ellipsoid.\r\n     *\r\n     * @param {Ellipsoid} ellipsoid The ellipsoid around which to create a bounding sphere.\r\n     * @param {BoundingSphere} [result] The object onto which to store the result.\r\n     * @returns {BoundingSphere} The modified result parameter or a new BoundingSphere instance if none was provided.\r\n     *\r\n     * @example\r\n     * var boundingSphere = Cesium.BoundingSphere.fromEllipsoid(ellipsoid);\r\n     */\r\n    BoundingSphere.fromEllipsoid = function(ellipsoid, result) {\r\n        //>>includeStart('debug', pragmas.debug);\r\n        Check.typeOf.object('ellipsoid', ellipsoid);\r\n        //>>includeEnd('debug');\r\n\r\n        if (!defined(result)) {\r\n            result = new BoundingSphere();\r\n        }\r\n\r\n        Cartesian3.clone(Cartesian3.ZERO, result.center);\r\n        result.radius = ellipsoid.maximumRadius;\r\n        return result;\r\n    };\r\n\r\n    var fromBoundingSpheresScratch = new Cartesian3();\r\n\r\n    /**\r\n     * Computes a tight-fitting bounding sphere enclosing the provided array of bounding spheres.\r\n     *\r\n     * @param {BoundingSphere[]} [boundingSpheres] The array of bounding spheres.\r\n     * @param {BoundingSphere} [result] The object onto which to store the result.\r\n     * @returns {BoundingSphere} The modified result parameter or a new BoundingSphere instance if none was provided.\r\n     */\r\n    BoundingSphere.fromBoundingSpheres = function(boundingSpheres, result) {\r\n        if (!defined(result)) {\r\n            result = new BoundingSphere();\r\n        }\r\n\r\n        if (!defined(boundingSpheres) || boundingSpheres.length === 0) {\r\n            result.center = Cartesian3.clone(Cartesian3.ZERO, result.center);\r\n            result.radius = 0.0;\r\n            return result;\r\n        }\r\n\r\n        var length = boundingSpheres.length;\r\n        if (length === 1) {\r\n            return BoundingSphere.clone(boundingSpheres[0], result);\r\n        }\r\n\r\n        if (length === 2) {\r\n            return BoundingSphere.union(boundingSpheres[0], boundingSpheres[1], result);\r\n        }\r\n\r\n        var positions = [];\r\n        var i;\r\n        for (i = 0; i < length; i++) {\r\n            positions.push(boundingSpheres[i].center);\r\n        }\r\n\r\n        result = BoundingSphere.fromPoints(positions, result);\r\n\r\n        var center = result.center;\r\n        var radius = result.radius;\r\n        for (i = 0; i < length; i++) {\r\n            var tmp = boundingSpheres[i];\r\n            radius = Math.max(radius, Cartesian3.distance(center, tmp.center, fromBoundingSpheresScratch) + tmp.radius);\r\n        }\r\n        result.radius = radius;\r\n\r\n        return result;\r\n    };\r\n\r\n    var fromOrientedBoundingBoxScratchU = new Cartesian3();\r\n    var fromOrientedBoundingBoxScratchV = new Cartesian3();\r\n    var fromOrientedBoundingBoxScratchW = new Cartesian3();\r\n\r\n    /**\r\n     * Computes a tight-fitting bounding sphere enclosing the provided oriented bounding box.\r\n     *\r\n     * @param {OrientedBoundingBox} orientedBoundingBox The oriented bounding box.\r\n     * @param {BoundingSphere} [result] The object onto which to store the result.\r\n     * @returns {BoundingSphere} The modified result parameter or a new BoundingSphere instance if none was provided.\r\n     */\r\n    BoundingSphere.fromOrientedBoundingBox = function(orientedBoundingBox, result) {\r\n        //>>includeStart('debug', pragmas.debug);\r\n        Check.defined('orientedBoundingBox', orientedBoundingBox);\r\n        //>>includeEnd('debug');\r\n\r\n        if (!defined(result)) {\r\n            result = new BoundingSphere();\r\n        }\r\n\r\n        var halfAxes = orientedBoundingBox.halfAxes;\r\n        var u = Matrix3.getColumn(halfAxes, 0, fromOrientedBoundingBoxScratchU);\r\n        var v = Matrix3.getColumn(halfAxes, 1, fromOrientedBoundingBoxScratchV);\r\n        var w = Matrix3.getColumn(halfAxes, 2, fromOrientedBoundingBoxScratchW);\r\n\r\n        Cartesian3.add(u, v, u);\r\n        Cartesian3.add(u, w, u);\r\n\r\n        result.center = Cartesian3.clone(orientedBoundingBox.center, result.center);\r\n        result.radius = Cartesian3.magnitude(u);\r\n\r\n        return result;\r\n    };\r\n\r\n    /**\r\n     * Duplicates a BoundingSphere instance.\r\n     *\r\n     * @param {BoundingSphere} sphere The bounding sphere to duplicate.\r\n     * @param {BoundingSphere} [result] The object onto which to store the result.\r\n     * @returns {BoundingSphere} The modified result parameter or a new BoundingSphere instance if none was provided. (Returns undefined if sphere is undefined)\r\n     */\r\n    BoundingSphere.clone = function(sphere, result) {\r\n        if (!defined(sphere)) {\r\n            return undefined;\r\n        }\r\n\r\n        if (!defined(result)) {\r\n            return new BoundingSphere(sphere.center, sphere.radius);\r\n        }\r\n\r\n        result.center = Cartesian3.clone(sphere.center, result.center);\r\n        result.radius = sphere.radius;\r\n        return result;\r\n    };\r\n\r\n    /**\r\n     * The number of elements used to pack the object into an array.\r\n     * @type {Number}\r\n     */\r\n    BoundingSphere.packedLength = 4;\r\n\r\n    /**\r\n     * Stores the provided instance into the provided array.\r\n     *\r\n     * @param {BoundingSphere} value The value to pack.\r\n     * @param {Number[]} array The array to pack into.\r\n     * @param {Number} [startingIndex=0] The index into the array at which to start packing the elements.\r\n     *\r\n     * @returns {Number[]} The array that was packed into\r\n     */\r\n    BoundingSphere.pack = function(value, array, startingIndex) {\r\n        //>>includeStart('debug', pragmas.debug);\r\n        Check.typeOf.object('value', value);\r\n        Check.defined('array', array);\r\n        //>>includeEnd('debug');\r\n\r\n        startingIndex = defaultValue(startingIndex, 0);\r\n\r\n        var center = value.center;\r\n        array[startingIndex++] = center.x;\r\n        array[startingIndex++] = center.y;\r\n        array[startingIndex++] = center.z;\r\n        array[startingIndex] = value.radius;\r\n\r\n        return array;\r\n    };\r\n\r\n    /**\r\n     * Retrieves an instance from a packed array.\r\n     *\r\n     * @param {Number[]} array The packed array.\r\n     * @param {Number} [startingIndex=0] The starting index of the element to be unpacked.\r\n     * @param {BoundingSphere} [result] The object into which to store the result.\r\n     * @returns {BoundingSphere} The modified result parameter or a new BoundingSphere instance if one was not provided.\r\n     */\r\n    BoundingSphere.unpack = function(array, startingIndex, result) {\r\n        //>>includeStart('debug', pragmas.debug);\r\n        Check.defined('array', array);\r\n        //>>includeEnd('debug');\r\n\r\n        startingIndex = defaultValue(startingIndex, 0);\r\n\r\n        if (!defined(result)) {\r\n            result = new BoundingSphere();\r\n        }\r\n\r\n        var center = result.center;\r\n        center.x = array[startingIndex++];\r\n        center.y = array[startingIndex++];\r\n        center.z = array[startingIndex++];\r\n        result.radius = array[startingIndex];\r\n        return result;\r\n    };\r\n\r\n    var unionScratch = new Cartesian3();\r\n    var unionScratchCenter = new Cartesian3();\r\n    /**\r\n     * Computes a bounding sphere that contains both the left and right bounding spheres.\r\n     *\r\n     * @param {BoundingSphere} left A sphere to enclose in a bounding sphere.\r\n     * @param {BoundingSphere} right A sphere to enclose in a bounding sphere.\r\n     * @param {BoundingSphere} [result] The object onto which to store the result.\r\n     * @returns {BoundingSphere} The modified result parameter or a new BoundingSphere instance if none was provided.\r\n     */\r\n    BoundingSphere.union = function(left, right, result) {\r\n        //>>includeStart('debug', pragmas.debug);\r\n        Check.typeOf.object('left', left);\r\n        Check.typeOf.object('right', right);\r\n        //>>includeEnd('debug');\r\n\r\n        if (!defined(result)) {\r\n            result = new BoundingSphere();\r\n        }\r\n\r\n        var leftCenter = left.center;\r\n        var leftRadius = left.radius;\r\n        var rightCenter = right.center;\r\n        var rightRadius = right.radius;\r\n\r\n        var toRightCenter = Cartesian3.subtract(rightCenter, leftCenter, unionScratch);\r\n        var centerSeparation = Cartesian3.magnitude(toRightCenter);\r\n\r\n        if (leftRadius >= (centerSeparation + rightRadius)) {\r\n            // Left sphere wins.\r\n            left.clone(result);\r\n            return result;\r\n        }\r\n\r\n        if (rightRadius >= (centerSeparation + leftRadius)) {\r\n            // Right sphere wins.\r\n            right.clone(result);\r\n            return result;\r\n        }\r\n\r\n        // There are two tangent points, one on far side of each sphere.\r\n        var halfDistanceBetweenTangentPoints = (leftRadius + centerSeparation + rightRadius) * 0.5;\r\n\r\n        // Compute the center point halfway between the two tangent points.\r\n        var center = Cartesian3.multiplyByScalar(toRightCenter,\r\n                (-leftRadius + halfDistanceBetweenTangentPoints) / centerSeparation, unionScratchCenter);\r\n        Cartesian3.add(center, leftCenter, center);\r\n        Cartesian3.clone(center, result.center);\r\n        result.radius = halfDistanceBetweenTangentPoints;\r\n\r\n        return result;\r\n    };\r\n\r\n    var expandScratch = new Cartesian3();\r\n    /**\r\n     * Computes a bounding sphere by enlarging the provided sphere to contain the provided point.\r\n     *\r\n     * @param {BoundingSphere} sphere A sphere to expand.\r\n     * @param {Cartesian3} point A point to enclose in a bounding sphere.\r\n     * @param {BoundingSphere} [result] The object onto which to store the result.\r\n     * @returns {BoundingSphere} The modified result parameter or a new BoundingSphere instance if none was provided.\r\n     */\r\n    BoundingSphere.expand = function(sphere, point, result) {\r\n        //>>includeStart('debug', pragmas.debug);\r\n        Check.typeOf.object('sphere', sphere);\r\n        Check.typeOf.object('point', point);\r\n        //>>includeEnd('debug');\r\n\r\n        result = BoundingSphere.clone(sphere, result);\r\n\r\n        var radius = Cartesian3.magnitude(Cartesian3.subtract(point, result.center, expandScratch));\r\n        if (radius > result.radius) {\r\n            result.radius = radius;\r\n        }\r\n\r\n        return result;\r\n    };\r\n\r\n    /**\r\n     * Determines which side of a plane a sphere is located.\r\n     *\r\n     * @param {BoundingSphere} sphere The bounding sphere to test.\r\n     * @param {Plane} plane The plane to test against.\r\n     * @returns {Intersect} {@link Intersect.INSIDE} if the entire sphere is on the side of the plane\r\n     *                      the normal is pointing, {@link Intersect.OUTSIDE} if the entire sphere is\r\n     *                      on the opposite side, and {@link Intersect.INTERSECTING} if the sphere\r\n     *                      intersects the plane.\r\n     */\r\n    BoundingSphere.intersectPlane = function(sphere, plane) {\r\n        //>>includeStart('debug', pragmas.debug);\r\n        Check.typeOf.object('sphere', sphere);\r\n        Check.typeOf.object('plane', plane);\r\n        //>>includeEnd('debug');\r\n\r\n        var center = sphere.center;\r\n        var radius = sphere.radius;\r\n        var normal = plane.normal;\r\n        var distanceToPlane = Cartesian3.dot(normal, center) + plane.distance;\r\n\r\n        if (distanceToPlane < -radius) {\r\n            // The center point is negative side of the plane normal\r\n            return Intersect.OUTSIDE;\r\n        } else if (distanceToPlane < radius) {\r\n            // The center point is positive side of the plane, but radius extends beyond it; partial overlap\r\n            return Intersect.INTERSECTING;\r\n        }\r\n        return Intersect.INSIDE;\r\n    };\r\n\r\n    /**\r\n     * Applies a 4x4 affine transformation matrix to a bounding sphere.\r\n     *\r\n     * @param {BoundingSphere} sphere The bounding sphere to apply the transformation to.\r\n     * @param {Matrix4} transform The transformation matrix to apply to the bounding sphere.\r\n     * @param {BoundingSphere} [result] The object onto which to store the result.\r\n     * @returns {BoundingSphere} The modified result parameter or a new BoundingSphere instance if none was provided.\r\n     */\r\n    BoundingSphere.transform = function(sphere, transform, result) {\r\n        //>>includeStart('debug', pragmas.debug);\r\n        Check.typeOf.object('sphere', sphere);\r\n        Check.typeOf.object('transform', transform);\r\n        //>>includeEnd('debug');\r\n\r\n        if (!defined(result)) {\r\n            result = new BoundingSphere();\r\n        }\r\n\r\n        result.center = Matrix4.multiplyByPoint(transform, sphere.center, result.center);\r\n        result.radius = Matrix4.getMaximumScale(transform) * sphere.radius;\r\n\r\n        return result;\r\n    };\r\n\r\n    var distanceSquaredToScratch = new Cartesian3();\r\n\r\n    /**\r\n     * Computes the estimated distance squared from the closest point on a bounding sphere to a point.\r\n     *\r\n     * @param {BoundingSphere} sphere The sphere.\r\n     * @param {Cartesian3} cartesian The point\r\n     * @returns {Number} The estimated distance squared from the bounding sphere to the point.\r\n     *\r\n     * @example\r\n     * // Sort bounding spheres from back to front\r\n     * spheres.sort(function(a, b) {\r\n     *     return Cesium.BoundingSphere.distanceSquaredTo(b, camera.positionWC) - Cesium.BoundingSphere.distanceSquaredTo(a, camera.positionWC);\r\n     * });\r\n     */\r\n    BoundingSphere.distanceSquaredTo = function(sphere, cartesian) {\r\n        //>>includeStart('debug', pragmas.debug);\r\n        Check.typeOf.object('sphere', sphere);\r\n        Check.typeOf.object('cartesian', cartesian);\r\n        //>>includeEnd('debug');\r\n\r\n        var diff = Cartesian3.subtract(sphere.center, cartesian, distanceSquaredToScratch);\r\n        return Cartesian3.magnitudeSquared(diff) - sphere.radius * sphere.radius;\r\n    };\r\n\r\n    /**\r\n     * Applies a 4x4 affine transformation matrix to a bounding sphere where there is no scale\r\n     * The transformation matrix is not verified to have a uniform scale of 1.\r\n     * This method is faster than computing the general bounding sphere transform using {@link BoundingSphere.transform}.\r\n     *\r\n     * @param {BoundingSphere} sphere The bounding sphere to apply the transformation to.\r\n     * @param {Matrix4} transform The transformation matrix to apply to the bounding sphere.\r\n     * @param {BoundingSphere} [result] The object onto which to store the result.\r\n     * @returns {BoundingSphere} The modified result parameter or a new BoundingSphere instance if none was provided.\r\n     *\r\n     * @example\r\n     * var modelMatrix = Cesium.Transforms.eastNorthUpToFixedFrame(positionOnEllipsoid);\r\n     * var boundingSphere = new Cesium.BoundingSphere();\r\n     * var newBoundingSphere = Cesium.BoundingSphere.transformWithoutScale(boundingSphere, modelMatrix);\r\n     */\r\n    BoundingSphere.transformWithoutScale = function(sphere, transform, result) {\r\n        //>>includeStart('debug', pragmas.debug);\r\n        Check.typeOf.object('sphere', sphere);\r\n        Check.typeOf.object('transform', transform);\r\n        //>>includeEnd('debug');\r\n\r\n        if (!defined(result)) {\r\n            result = new BoundingSphere();\r\n        }\r\n\r\n        result.center = Matrix4.multiplyByPoint(transform, sphere.center, result.center);\r\n        result.radius = sphere.radius;\r\n\r\n        return result;\r\n    };\r\n\r\n    var scratchCartesian3 = new Cartesian3();\r\n    /**\r\n     * The distances calculated by the vector from the center of the bounding sphere to position projected onto direction\r\n     * plus/minus the radius of the bounding sphere.\r\n     * <br>\r\n     * If you imagine the infinite number of planes with normal direction, this computes the smallest distance to the\r\n     * closest and farthest planes from position that intersect the bounding sphere.\r\n     *\r\n     * @param {BoundingSphere} sphere The bounding sphere to calculate the distance to.\r\n     * @param {Cartesian3} position The position to calculate the distance from.\r\n     * @param {Cartesian3} direction The direction from position.\r\n     * @param {Interval} [result] A Interval to store the nearest and farthest distances.\r\n     * @returns {Interval} The nearest and farthest distances on the bounding sphere from position in direction.\r\n     */\r\n    BoundingSphere.computePlaneDistances = function(sphere, position, direction, result) {\r\n        //>>includeStart('debug', pragmas.debug);\r\n        Check.typeOf.object('sphere', sphere);\r\n        Check.typeOf.object('position', position);\r\n        Check.typeOf.object('direction', direction);\r\n        //>>includeEnd('debug');\r\n\r\n        if (!defined(result)) {\r\n            result = new Interval();\r\n        }\r\n\r\n        var toCenter = Cartesian3.subtract(sphere.center, position, scratchCartesian3);\r\n        var mag = Cartesian3.dot(direction, toCenter);\r\n\r\n        result.start = mag - sphere.radius;\r\n        result.stop = mag + sphere.radius;\r\n        return result;\r\n    };\r\n\r\n    var projectTo2DNormalScratch = new Cartesian3();\r\n    var projectTo2DEastScratch = new Cartesian3();\r\n    var projectTo2DNorthScratch = new Cartesian3();\r\n    var projectTo2DWestScratch = new Cartesian3();\r\n    var projectTo2DSouthScratch = new Cartesian3();\r\n    var projectTo2DCartographicScratch = new Cartographic();\r\n    var projectTo2DPositionsScratch = new Array(8);\r\n    for (var n = 0; n < 8; ++n) {\r\n        projectTo2DPositionsScratch[n] = new Cartesian3();\r\n    }\r\n\r\n    var projectTo2DProjection = new GeographicProjection();\r\n    /**\r\n     * Creates a bounding sphere in 2D from a bounding sphere in 3D world coordinates.\r\n     *\r\n     * @param {BoundingSphere} sphere The bounding sphere to transform to 2D.\r\n     * @param {Object} [projection=GeographicProjection] The projection to 2D.\r\n     * @param {BoundingSphere} [result] The object onto which to store the result.\r\n     * @returns {BoundingSphere} The modified result parameter or a new BoundingSphere instance if none was provided.\r\n     */\r\n    BoundingSphere.projectTo2D = function(sphere, projection, result) {\r\n        //>>includeStart('debug', pragmas.debug);\r\n        Check.typeOf.object('sphere', sphere);\r\n        //>>includeEnd('debug');\r\n\r\n        projection = defaultValue(projection, projectTo2DProjection);\r\n\r\n        var ellipsoid = projection.ellipsoid;\r\n        var center = sphere.center;\r\n        var radius = sphere.radius;\r\n\r\n        var normal;\r\n        if (Cartesian3.equals(center, Cartesian3.ZERO)) {\r\n            // Bounding sphere is at the center. The geodetic surface normal is not\r\n            // defined here so pick the x-axis as a fallback.\r\n            normal = Cartesian3.clone(Cartesian3.UNIT_X, projectTo2DNormalScratch);\r\n        } else {\r\n            normal = ellipsoid.geodeticSurfaceNormal(center, projectTo2DNormalScratch);\r\n        }\r\n        var east = Cartesian3.cross(Cartesian3.UNIT_Z, normal, projectTo2DEastScratch);\r\n        Cartesian3.normalize(east, east);\r\n        var north = Cartesian3.cross(normal, east, projectTo2DNorthScratch);\r\n        Cartesian3.normalize(north, north);\r\n\r\n        Cartesian3.multiplyByScalar(normal, radius, normal);\r\n        Cartesian3.multiplyByScalar(north, radius, north);\r\n        Cartesian3.multiplyByScalar(east, radius, east);\r\n\r\n        var south = Cartesian3.negate(north, projectTo2DSouthScratch);\r\n        var west = Cartesian3.negate(east, projectTo2DWestScratch);\r\n\r\n        var positions = projectTo2DPositionsScratch;\r\n\r\n        // top NE corner\r\n        var corner = positions[0];\r\n        Cartesian3.add(normal, north, corner);\r\n        Cartesian3.add(corner, east, corner);\r\n\r\n        // top NW corner\r\n        corner = positions[1];\r\n        Cartesian3.add(normal, north, corner);\r\n        Cartesian3.add(corner, west, corner);\r\n\r\n        // top SW corner\r\n        corner = positions[2];\r\n        Cartesian3.add(normal, south, corner);\r\n        Cartesian3.add(corner, west, corner);\r\n\r\n        // top SE corner\r\n        corner = positions[3];\r\n        Cartesian3.add(normal, south, corner);\r\n        Cartesian3.add(corner, east, corner);\r\n\r\n        Cartesian3.negate(normal, normal);\r\n\r\n        // bottom NE corner\r\n        corner = positions[4];\r\n        Cartesian3.add(normal, north, corner);\r\n        Cartesian3.add(corner, east, corner);\r\n\r\n        // bottom NW corner\r\n        corner = positions[5];\r\n        Cartesian3.add(normal, north, corner);\r\n        Cartesian3.add(corner, west, corner);\r\n\r\n        // bottom SW corner\r\n        corner = positions[6];\r\n        Cartesian3.add(normal, south, corner);\r\n        Cartesian3.add(corner, west, corner);\r\n\r\n        // bottom SE corner\r\n        corner = positions[7];\r\n        Cartesian3.add(normal, south, corner);\r\n        Cartesian3.add(corner, east, corner);\r\n\r\n        var length = positions.length;\r\n        for (var i = 0; i < length; ++i) {\r\n            var position = positions[i];\r\n            Cartesian3.add(center, position, position);\r\n            var cartographic = ellipsoid.cartesianToCartographic(position, projectTo2DCartographicScratch);\r\n            projection.project(cartographic, position);\r\n        }\r\n\r\n        result = BoundingSphere.fromPoints(positions, result);\r\n\r\n        // swizzle center components\r\n        center = result.center;\r\n        var x = center.x;\r\n        var y = center.y;\r\n        var z = center.z;\r\n        center.x = z;\r\n        center.y = x;\r\n        center.z = y;\r\n\r\n        return result;\r\n    };\r\n\r\n    /**\r\n     * Determines whether or not a sphere is hidden from view by the occluder.\r\n     *\r\n     * @param {BoundingSphere} sphere The bounding sphere surrounding the occludee object.\r\n     * @param {Occluder} occluder The occluder.\r\n     * @returns {Boolean} <code>true</code> if the sphere is not visible; otherwise <code>false</code>.\r\n     */\r\n    BoundingSphere.isOccluded = function(sphere, occluder) {\r\n        //>>includeStart('debug', pragmas.debug);\r\n        Check.typeOf.object('sphere', sphere);\r\n        Check.typeOf.object('occluder', occluder);\r\n        //>>includeEnd('debug');\r\n        return !occluder.isBoundingSphereVisible(sphere);\r\n    };\r\n\r\n    /**\r\n     * Compares the provided BoundingSphere componentwise and returns\r\n     * <code>true</code> if they are equal, <code>false</code> otherwise.\r\n     *\r\n     * @param {BoundingSphere} [left] The first BoundingSphere.\r\n     * @param {BoundingSphere} [right] The second BoundingSphere.\r\n     * @returns {Boolean} <code>true</code> if left and right are equal, <code>false</code> otherwise.\r\n     */\r\n    BoundingSphere.equals = function(left, right) {\r\n        return (left === right) ||\r\n               ((defined(left)) &&\r\n                (defined(right)) &&\r\n                Cartesian3.equals(left.center, right.center) &&\r\n                left.radius === right.radius);\r\n    };\r\n\r\n    /**\r\n     * Determines which side of a plane the sphere is located.\r\n     *\r\n     * @param {Plane} plane The plane to test against.\r\n     * @returns {Intersect} {@link Intersect.INSIDE} if the entire sphere is on the side of the plane\r\n     *                      the normal is pointing, {@link Intersect.OUTSIDE} if the entire sphere is\r\n     *                      on the opposite side, and {@link Intersect.INTERSECTING} if the sphere\r\n     *                      intersects the plane.\r\n     */\r\n    BoundingSphere.prototype.intersectPlane = function(plane) {\r\n        return BoundingSphere.intersectPlane(this, plane);\r\n    };\r\n\r\n    /**\r\n     * Computes the estimated distance squared from the closest point on a bounding sphere to a point.\r\n     *\r\n     * @param {Cartesian3} cartesian The point\r\n     * @returns {Number} The estimated distance squared from the bounding sphere to the point.\r\n     *\r\n     * @example\r\n     * // Sort bounding spheres from back to front\r\n     * spheres.sort(function(a, b) {\r\n     *     return b.distanceSquaredTo(camera.positionWC) - a.distanceSquaredTo(camera.positionWC);\r\n     * });\r\n     */\r\n    BoundingSphere.prototype.distanceSquaredTo = function(cartesian) {\r\n        return BoundingSphere.distanceSquaredTo(this, cartesian);\r\n    };\r\n\r\n    /**\r\n     * The distances calculated by the vector from the center of the bounding sphere to position projected onto direction\r\n     * plus/minus the radius of the bounding sphere.\r\n     * <br>\r\n     * If you imagine the infinite number of planes with normal direction, this computes the smallest distance to the\r\n     * closest and farthest planes from position that intersect the bounding sphere.\r\n     *\r\n     * @param {Cartesian3} position The position to calculate the distance from.\r\n     * @param {Cartesian3} direction The direction from position.\r\n     * @param {Interval} [result] A Interval to store the nearest and farthest distances.\r\n     * @returns {Interval} The nearest and farthest distances on the bounding sphere from position in direction.\r\n     */\r\n    BoundingSphere.prototype.computePlaneDistances = function(position, direction, result) {\r\n        return BoundingSphere.computePlaneDistances(this, position, direction, result);\r\n    };\r\n\r\n    /**\r\n     * Determines whether or not a sphere is hidden from view by the occluder.\r\n     *\r\n     * @param {Occluder} occluder The occluder.\r\n     * @returns {Boolean} <code>true</code> if the sphere is not visible; otherwise <code>false</code>.\r\n     */\r\n    BoundingSphere.prototype.isOccluded = function(occluder) {\r\n        return BoundingSphere.isOccluded(this, occluder);\r\n    };\r\n\r\n    /**\r\n     * Compares this BoundingSphere against the provided BoundingSphere componentwise and returns\r\n     * <code>true</code> if they are equal, <code>false</code> otherwise.\r\n     *\r\n     * @param {BoundingSphere} [right] The right hand side BoundingSphere.\r\n     * @returns {Boolean} <code>true</code> if they are equal, <code>false</code> otherwise.\r\n     */\r\n    BoundingSphere.prototype.equals = function(right) {\r\n        return BoundingSphere.equals(this, right);\r\n    };\r\n\r\n    /**\r\n     * Duplicates this BoundingSphere instance.\r\n     *\r\n     * @param {BoundingSphere} [result] The object onto which to store the result.\r\n     * @returns {BoundingSphere} The modified result parameter or a new BoundingSphere instance if none was provided.\r\n     */\r\n    BoundingSphere.prototype.clone = function(result) {\r\n        return BoundingSphere.clone(this, result);\r\n    };\r\n\r\n    /**\r\n     * Computes the radius of the BoundingSphere.\r\n     * @returns {Number} The radius of the BoundingSphere.\r\n     */\r\n    BoundingSphere.prototype.volume = function() {\r\n        var radius = this.radius;\r\n        return volumeConstant * radius * radius * radius;\r\n    };\r\nexport default BoundingSphere;\r\n","import Cartesian3 from './Cartesian3.js';\r\nimport Check from './Check.js';\r\nimport defaultValue from './defaultValue.js';\r\nimport defined from './defined.js';\r\nimport FeatureDetection from './FeatureDetection.js';\r\nimport CesiumMath from './Math.js';\r\nimport Matrix3 from './Matrix3.js';\r\n\r\n    /**\r\n     * A set of 4-dimensional coordinates used to represent rotation in 3-dimensional space.\r\n     * @alias Quaternion\r\n     * @constructor\r\n     *\r\n     * @param {Number} [x=0.0] The X component.\r\n     * @param {Number} [y=0.0] The Y component.\r\n     * @param {Number} [z=0.0] The Z component.\r\n     * @param {Number} [w=0.0] The W component.\r\n     *\r\n     * @see PackableForInterpolation\r\n     */\r\n    function Quaternion(x, y, z, w) {\r\n        /**\r\n         * The X component.\r\n         * @type {Number}\r\n         * @default 0.0\r\n         */\r\n        this.x = defaultValue(x, 0.0);\r\n\r\n        /**\r\n         * The Y component.\r\n         * @type {Number}\r\n         * @default 0.0\r\n         */\r\n        this.y = defaultValue(y, 0.0);\r\n\r\n        /**\r\n         * The Z component.\r\n         * @type {Number}\r\n         * @default 0.0\r\n         */\r\n        this.z = defaultValue(z, 0.0);\r\n\r\n        /**\r\n         * The W component.\r\n         * @type {Number}\r\n         * @default 0.0\r\n         */\r\n        this.w = defaultValue(w, 0.0);\r\n    }\r\n\r\n    var fromAxisAngleScratch = new Cartesian3();\r\n\r\n    /**\r\n     * Computes a quaternion representing a rotation around an axis.\r\n     *\r\n     * @param {Cartesian3} axis The axis of rotation.\r\n     * @param {Number} angle The angle in radians to rotate around the axis.\r\n     * @param {Quaternion} [result] The object onto which to store the result.\r\n     * @returns {Quaternion} The modified result parameter or a new Quaternion instance if one was not provided.\r\n     */\r\n    Quaternion.fromAxisAngle = function(axis, angle, result) {\r\n        //>>includeStart('debug', pragmas.debug);\r\n        Check.typeOf.object('axis', axis);\r\n        Check.typeOf.number('angle', angle);\r\n        //>>includeEnd('debug');\r\n\r\n        var halfAngle = angle / 2.0;\r\n        var s = Math.sin(halfAngle);\r\n        fromAxisAngleScratch = Cartesian3.normalize(axis, fromAxisAngleScratch);\r\n\r\n        var x = fromAxisAngleScratch.x * s;\r\n        var y = fromAxisAngleScratch.y * s;\r\n        var z = fromAxisAngleScratch.z * s;\r\n        var w = Math.cos(halfAngle);\r\n        if (!defined(result)) {\r\n            return new Quaternion(x, y, z, w);\r\n        }\r\n        result.x = x;\r\n        result.y = y;\r\n        result.z = z;\r\n        result.w = w;\r\n        return result;\r\n    };\r\n\r\n    var fromRotationMatrixNext = [1, 2, 0];\r\n    var fromRotationMatrixQuat = new Array(3);\r\n    /**\r\n     * Computes a Quaternion from the provided Matrix3 instance.\r\n     *\r\n     * @param {Matrix3} matrix The rotation matrix.\r\n     * @param {Quaternion} [result] The object onto which to store the result.\r\n     * @returns {Quaternion} The modified result parameter or a new Quaternion instance if one was not provided.\r\n     *\r\n     * @see Matrix3.fromQuaternion\r\n     */\r\n    Quaternion.fromRotationMatrix = function(matrix, result) {\r\n        //>>includeStart('debug', pragmas.debug);\r\n        Check.typeOf.object('matrix', matrix);\r\n        //>>includeEnd('debug');\r\n\r\n        var root;\r\n        var x;\r\n        var y;\r\n        var z;\r\n        var w;\r\n\r\n        var m00 = matrix[Matrix3.COLUMN0ROW0];\r\n        var m11 = matrix[Matrix3.COLUMN1ROW1];\r\n        var m22 = matrix[Matrix3.COLUMN2ROW2];\r\n        var trace = m00 + m11 + m22;\r\n\r\n        if (trace > 0.0) {\r\n            // |w| > 1/2, may as well choose w > 1/2\r\n            root = Math.sqrt(trace + 1.0); // 2w\r\n            w = 0.5 * root;\r\n            root = 0.5 / root; // 1/(4w)\r\n\r\n            x = (matrix[Matrix3.COLUMN1ROW2] - matrix[Matrix3.COLUMN2ROW1]) * root;\r\n            y = (matrix[Matrix3.COLUMN2ROW0] - matrix[Matrix3.COLUMN0ROW2]) * root;\r\n            z = (matrix[Matrix3.COLUMN0ROW1] - matrix[Matrix3.COLUMN1ROW0]) * root;\r\n        } else {\r\n            // |w| <= 1/2\r\n            var next = fromRotationMatrixNext;\r\n\r\n            var i = 0;\r\n            if (m11 > m00) {\r\n                i = 1;\r\n            }\r\n            if (m22 > m00 && m22 > m11) {\r\n                i = 2;\r\n            }\r\n            var j = next[i];\r\n            var k = next[j];\r\n\r\n            root = Math.sqrt(matrix[Matrix3.getElementIndex(i, i)] - matrix[Matrix3.getElementIndex(j, j)] - matrix[Matrix3.getElementIndex(k, k)] + 1.0);\r\n\r\n            var quat = fromRotationMatrixQuat;\r\n            quat[i] = 0.5 * root;\r\n            root = 0.5 / root;\r\n            w = (matrix[Matrix3.getElementIndex(k, j)] - matrix[Matrix3.getElementIndex(j, k)]) * root;\r\n            quat[j] = (matrix[Matrix3.getElementIndex(j, i)] + matrix[Matrix3.getElementIndex(i, j)]) * root;\r\n            quat[k] = (matrix[Matrix3.getElementIndex(k, i)] + matrix[Matrix3.getElementIndex(i, k)]) * root;\r\n\r\n            x = -quat[0];\r\n            y = -quat[1];\r\n            z = -quat[2];\r\n        }\r\n\r\n        if (!defined(result)) {\r\n            return new Quaternion(x, y, z, w);\r\n        }\r\n        result.x = x;\r\n        result.y = y;\r\n        result.z = z;\r\n        result.w = w;\r\n        return result;\r\n    };\r\n\r\n    var scratchHPRQuaternion = new Quaternion();\r\n    var scratchHeadingQuaternion = new Quaternion();\r\n    var scratchPitchQuaternion = new Quaternion();\r\n    var scratchRollQuaternion = new Quaternion();\r\n\r\n    /**\r\n     * Computes a rotation from the given heading, pitch and roll angles. Heading is the rotation about the\r\n     * negative z axis. Pitch is the rotation about the negative y axis. Roll is the rotation about\r\n     * the positive x axis.\r\n     *\r\n     * @param {HeadingPitchRoll} headingPitchRoll The rotation expressed as a heading, pitch and roll.\r\n     * @param {Quaternion} [result] The object onto which to store the result.\r\n     * @returns {Quaternion} The modified result parameter or a new Quaternion instance if none was provided.\r\n     */\r\n    Quaternion.fromHeadingPitchRoll = function(headingPitchRoll, result) {\r\n        //>>includeStart('debug', pragmas.debug);\r\n        Check.typeOf.object('headingPitchRoll', headingPitchRoll);\r\n        //>>includeEnd('debug');\r\n\r\n        scratchRollQuaternion = Quaternion.fromAxisAngle(Cartesian3.UNIT_X, headingPitchRoll.roll, scratchHPRQuaternion);\r\n        scratchPitchQuaternion = Quaternion.fromAxisAngle(Cartesian3.UNIT_Y, -headingPitchRoll.pitch, result);\r\n        result = Quaternion.multiply(scratchPitchQuaternion, scratchRollQuaternion, scratchPitchQuaternion);\r\n        scratchHeadingQuaternion = Quaternion.fromAxisAngle(Cartesian3.UNIT_Z, -headingPitchRoll.heading, scratchHPRQuaternion);\r\n        return Quaternion.multiply(scratchHeadingQuaternion, result, result);\r\n    };\r\n\r\n    var sampledQuaternionAxis = new Cartesian3();\r\n    var sampledQuaternionRotation = new Cartesian3();\r\n    var sampledQuaternionTempQuaternion = new Quaternion();\r\n    var sampledQuaternionQuaternion0 = new Quaternion();\r\n    var sampledQuaternionQuaternion0Conjugate = new Quaternion();\r\n\r\n    /**\r\n     * The number of elements used to pack the object into an array.\r\n     * @type {Number}\r\n     */\r\n    Quaternion.packedLength = 4;\r\n\r\n    /**\r\n     * Stores the provided instance into the provided array.\r\n     *\r\n     * @param {Quaternion} value The value to pack.\r\n     * @param {Number[]} array The array to pack into.\r\n     * @param {Number} [startingIndex=0] The index into the array at which to start packing the elements.\r\n     *\r\n     * @returns {Number[]} The array that was packed into\r\n     */\r\n    Quaternion.pack = function(value, array, startingIndex) {\r\n        //>>includeStart('debug', pragmas.debug);\r\n        Check.typeOf.object('value', value);\r\n        Check.defined('array', array);\r\n        //>>includeEnd('debug');\r\n\r\n        startingIndex = defaultValue(startingIndex, 0);\r\n\r\n        array[startingIndex++] = value.x;\r\n        array[startingIndex++] = value.y;\r\n        array[startingIndex++] = value.z;\r\n        array[startingIndex] = value.w;\r\n\r\n        return array;\r\n    };\r\n\r\n    /**\r\n     * Retrieves an instance from a packed array.\r\n     *\r\n     * @param {Number[]} array The packed array.\r\n     * @param {Number} [startingIndex=0] The starting index of the element to be unpacked.\r\n     * @param {Quaternion} [result] The object into which to store the result.\r\n     * @returns {Quaternion} The modified result parameter or a new Quaternion instance if one was not provided.\r\n     */\r\n    Quaternion.unpack = function(array, startingIndex, result) {\r\n        //>>includeStart('debug', pragmas.debug);\r\n        Check.defined('array', array);\r\n        //>>includeEnd('debug');\r\n\r\n        startingIndex = defaultValue(startingIndex, 0);\r\n\r\n        if (!defined(result)) {\r\n            result = new Quaternion();\r\n        }\r\n        result.x = array[startingIndex];\r\n        result.y = array[startingIndex + 1];\r\n        result.z = array[startingIndex + 2];\r\n        result.w = array[startingIndex + 3];\r\n        return result;\r\n    };\r\n\r\n    /**\r\n     * The number of elements used to store the object into an array in its interpolatable form.\r\n     * @type {Number}\r\n     */\r\n    Quaternion.packedInterpolationLength = 3;\r\n\r\n    /**\r\n     * Converts a packed array into a form suitable for interpolation.\r\n     *\r\n     * @param {Number[]} packedArray The packed array.\r\n     * @param {Number} [startingIndex=0] The index of the first element to be converted.\r\n     * @param {Number} [lastIndex=packedArray.length] The index of the last element to be converted.\r\n     * @param {Number[]} result The object into which to store the result.\r\n     */\r\n    Quaternion.convertPackedArrayForInterpolation = function(packedArray, startingIndex, lastIndex, result) {\r\n        Quaternion.unpack(packedArray, lastIndex * 4, sampledQuaternionQuaternion0Conjugate);\r\n        Quaternion.conjugate(sampledQuaternionQuaternion0Conjugate, sampledQuaternionQuaternion0Conjugate);\r\n\r\n        for (var i = 0, len = lastIndex - startingIndex + 1; i < len; i++) {\r\n            var offset = i * 3;\r\n            Quaternion.unpack(packedArray, (startingIndex + i) * 4, sampledQuaternionTempQuaternion);\r\n\r\n            Quaternion.multiply(sampledQuaternionTempQuaternion, sampledQuaternionQuaternion0Conjugate, sampledQuaternionTempQuaternion);\r\n\r\n            if (sampledQuaternionTempQuaternion.w < 0) {\r\n                Quaternion.negate(sampledQuaternionTempQuaternion, sampledQuaternionTempQuaternion);\r\n            }\r\n\r\n            Quaternion.computeAxis(sampledQuaternionTempQuaternion, sampledQuaternionAxis);\r\n            var angle = Quaternion.computeAngle(sampledQuaternionTempQuaternion);\r\n            result[offset] = sampledQuaternionAxis.x * angle;\r\n            result[offset + 1] = sampledQuaternionAxis.y * angle;\r\n            result[offset + 2] = sampledQuaternionAxis.z * angle;\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Retrieves an instance from a packed array converted with {@link convertPackedArrayForInterpolation}.\r\n     *\r\n     * @param {Number[]} array The array previously packed for interpolation.\r\n     * @param {Number[]} sourceArray The original packed array.\r\n     * @param {Number} [firstIndex=0] The firstIndex used to convert the array.\r\n     * @param {Number} [lastIndex=packedArray.length] The lastIndex used to convert the array.\r\n     * @param {Quaternion} [result] The object into which to store the result.\r\n     * @returns {Quaternion} The modified result parameter or a new Quaternion instance if one was not provided.\r\n     */\r\n    Quaternion.unpackInterpolationResult = function(array, sourceArray, firstIndex, lastIndex, result) {\r\n        if (!defined(result)) {\r\n            result = new Quaternion();\r\n        }\r\n        Cartesian3.fromArray(array, 0, sampledQuaternionRotation);\r\n        var magnitude = Cartesian3.magnitude(sampledQuaternionRotation);\r\n\r\n        Quaternion.unpack(sourceArray, lastIndex * 4, sampledQuaternionQuaternion0);\r\n\r\n        if (magnitude === 0) {\r\n            Quaternion.clone(Quaternion.IDENTITY, sampledQuaternionTempQuaternion);\r\n        } else {\r\n            Quaternion.fromAxisAngle(sampledQuaternionRotation, magnitude, sampledQuaternionTempQuaternion);\r\n        }\r\n\r\n        return Quaternion.multiply(sampledQuaternionTempQuaternion, sampledQuaternionQuaternion0, result);\r\n    };\r\n\r\n    /**\r\n     * Duplicates a Quaternion instance.\r\n     *\r\n     * @param {Quaternion} quaternion The quaternion to duplicate.\r\n     * @param {Quaternion} [result] The object onto which to store the result.\r\n     * @returns {Quaternion} The modified result parameter or a new Quaternion instance if one was not provided. (Returns undefined if quaternion is undefined)\r\n     */\r\n    Quaternion.clone = function(quaternion, result) {\r\n        if (!defined(quaternion)) {\r\n            return undefined;\r\n        }\r\n\r\n        if (!defined(result)) {\r\n            return new Quaternion(quaternion.x, quaternion.y, quaternion.z, quaternion.w);\r\n        }\r\n\r\n        result.x = quaternion.x;\r\n        result.y = quaternion.y;\r\n        result.z = quaternion.z;\r\n        result.w = quaternion.w;\r\n        return result;\r\n    };\r\n\r\n    /**\r\n     * Computes the conjugate of the provided quaternion.\r\n     *\r\n     * @param {Quaternion} quaternion The quaternion to conjugate.\r\n     * @param {Quaternion} result The object onto which to store the result.\r\n     * @returns {Quaternion} The modified result parameter.\r\n     */\r\n    Quaternion.conjugate = function(quaternion, result) {\r\n        //>>includeStart('debug', pragmas.debug);\r\n        Check.typeOf.object('quaternion', quaternion);\r\n        Check.typeOf.object('result', result);\r\n        //>>includeEnd('debug');\r\n\r\n        result.x = -quaternion.x;\r\n        result.y = -quaternion.y;\r\n        result.z = -quaternion.z;\r\n        result.w = quaternion.w;\r\n        return result;\r\n    };\r\n\r\n    /**\r\n     * Computes magnitude squared for the provided quaternion.\r\n     *\r\n     * @param {Quaternion} quaternion The quaternion to conjugate.\r\n     * @returns {Number} The magnitude squared.\r\n     */\r\n    Quaternion.magnitudeSquared = function(quaternion) {\r\n        //>>includeStart('debug', pragmas.debug);\r\n        Check.typeOf.object('quaternion', quaternion);\r\n        //>>includeEnd('debug');\r\n\r\n        return quaternion.x * quaternion.x + quaternion.y * quaternion.y + quaternion.z * quaternion.z + quaternion.w * quaternion.w;\r\n    };\r\n\r\n    /**\r\n     * Computes magnitude for the provided quaternion.\r\n     *\r\n     * @param {Quaternion} quaternion The quaternion to conjugate.\r\n     * @returns {Number} The magnitude.\r\n     */\r\n    Quaternion.magnitude = function(quaternion) {\r\n        return Math.sqrt(Quaternion.magnitudeSquared(quaternion));\r\n    };\r\n\r\n    /**\r\n     * Computes the normalized form of the provided quaternion.\r\n     *\r\n     * @param {Quaternion} quaternion The quaternion to normalize.\r\n     * @param {Quaternion} result The object onto which to store the result.\r\n     * @returns {Quaternion} The modified result parameter.\r\n     */\r\n    Quaternion.normalize = function(quaternion, result) {\r\n        //>>includeStart('debug', pragmas.debug);\r\n        Check.typeOf.object('result', result);\r\n        //>>includeEnd('debug');\r\n\r\n        var inverseMagnitude = 1.0 / Quaternion.magnitude(quaternion);\r\n        var x = quaternion.x * inverseMagnitude;\r\n        var y = quaternion.y * inverseMagnitude;\r\n        var z = quaternion.z * inverseMagnitude;\r\n        var w = quaternion.w * inverseMagnitude;\r\n\r\n        result.x = x;\r\n        result.y = y;\r\n        result.z = z;\r\n        result.w = w;\r\n        return result;\r\n    };\r\n\r\n    /**\r\n     * Computes the inverse of the provided quaternion.\r\n     *\r\n     * @param {Quaternion} quaternion The quaternion to normalize.\r\n     * @param {Quaternion} result The object onto which to store the result.\r\n     * @returns {Quaternion} The modified result parameter.\r\n     */\r\n    Quaternion.inverse = function(quaternion, result) {\r\n        //>>includeStart('debug', pragmas.debug);\r\n        Check.typeOf.object('result', result);\r\n        //>>includeEnd('debug');\r\n\r\n        var magnitudeSquared = Quaternion.magnitudeSquared(quaternion);\r\n        result = Quaternion.conjugate(quaternion, result);\r\n        return Quaternion.multiplyByScalar(result, 1.0 / magnitudeSquared, result);\r\n    };\r\n\r\n    /**\r\n     * Computes the componentwise sum of two quaternions.\r\n     *\r\n     * @param {Quaternion} left The first quaternion.\r\n     * @param {Quaternion} right The second quaternion.\r\n     * @param {Quaternion} result The object onto which to store the result.\r\n     * @returns {Quaternion} The modified result parameter.\r\n     */\r\n    Quaternion.add = function(left, right, result) {\r\n        //>>includeStart('debug', pragmas.debug);\r\n        Check.typeOf.object('left', left);\r\n        Check.typeOf.object('right', right);\r\n        Check.typeOf.object('result', result);\r\n        //>>includeEnd('debug');\r\n\r\n        result.x = left.x + right.x;\r\n        result.y = left.y + right.y;\r\n        result.z = left.z + right.z;\r\n        result.w = left.w + right.w;\r\n        return result;\r\n    };\r\n\r\n    /**\r\n     * Computes the componentwise difference of two quaternions.\r\n     *\r\n     * @param {Quaternion} left The first quaternion.\r\n     * @param {Quaternion} right The second quaternion.\r\n     * @param {Quaternion} result The object onto which to store the result.\r\n     * @returns {Quaternion} The modified result parameter.\r\n     */\r\n    Quaternion.subtract = function(left, right, result) {\r\n        //>>includeStart('debug', pragmas.debug);\r\n        Check.typeOf.object('left', left);\r\n        Check.typeOf.object('right', right);\r\n        Check.typeOf.object('result', result);\r\n        //>>includeEnd('debug');\r\n\r\n        result.x = left.x - right.x;\r\n        result.y = left.y - right.y;\r\n        result.z = left.z - right.z;\r\n        result.w = left.w - right.w;\r\n        return result;\r\n    };\r\n\r\n    /**\r\n     * Negates the provided quaternion.\r\n     *\r\n     * @param {Quaternion} quaternion The quaternion to be negated.\r\n     * @param {Quaternion} result The object onto which to store the result.\r\n     * @returns {Quaternion} The modified result parameter.\r\n     */\r\n    Quaternion.negate = function(quaternion, result) {\r\n        //>>includeStart('debug', pragmas.debug);\r\n        Check.typeOf.object('quaternion', quaternion);\r\n        Check.typeOf.object('result', result);\r\n        //>>includeEnd('debug');\r\n\r\n        result.x = -quaternion.x;\r\n        result.y = -quaternion.y;\r\n        result.z = -quaternion.z;\r\n        result.w = -quaternion.w;\r\n        return result;\r\n    };\r\n\r\n    /**\r\n     * Computes the dot (scalar) product of two quaternions.\r\n     *\r\n     * @param {Quaternion} left The first quaternion.\r\n     * @param {Quaternion} right The second quaternion.\r\n     * @returns {Number} The dot product.\r\n     */\r\n    Quaternion.dot = function(left, right) {\r\n        //>>includeStart('debug', pragmas.debug);\r\n        Check.typeOf.object('left', left);\r\n        Check.typeOf.object('right', right);\r\n        //>>includeEnd('debug');\r\n\r\n        return left.x * right.x + left.y * right.y + left.z * right.z + left.w * right.w;\r\n    };\r\n\r\n    /**\r\n     * Computes the product of two quaternions.\r\n     *\r\n     * @param {Quaternion} left The first quaternion.\r\n     * @param {Quaternion} right The second quaternion.\r\n     * @param {Quaternion} result The object onto which to store the result.\r\n     * @returns {Quaternion} The modified result parameter.\r\n     */\r\n    Quaternion.multiply = function(left, right, result) {\r\n        //>>includeStart('debug', pragmas.debug);\r\n        Check.typeOf.object('left', left);\r\n        Check.typeOf.object('right', right);\r\n        Check.typeOf.object('result', result);\r\n        //>>includeEnd('debug');\r\n\r\n        var leftX = left.x;\r\n        var leftY = left.y;\r\n        var leftZ = left.z;\r\n        var leftW = left.w;\r\n\r\n        var rightX = right.x;\r\n        var rightY = right.y;\r\n        var rightZ = right.z;\r\n        var rightW = right.w;\r\n\r\n        var x = leftW * rightX + leftX * rightW + leftY * rightZ - leftZ * rightY;\r\n        var y = leftW * rightY - leftX * rightZ + leftY * rightW + leftZ * rightX;\r\n        var z = leftW * rightZ + leftX * rightY - leftY * rightX + leftZ * rightW;\r\n        var w = leftW * rightW - leftX * rightX - leftY * rightY - leftZ * rightZ;\r\n\r\n        result.x = x;\r\n        result.y = y;\r\n        result.z = z;\r\n        result.w = w;\r\n        return result;\r\n    };\r\n\r\n    /**\r\n     * Multiplies the provided quaternion componentwise by the provided scalar.\r\n     *\r\n     * @param {Quaternion} quaternion The quaternion to be scaled.\r\n     * @param {Number} scalar The scalar to multiply with.\r\n     * @param {Quaternion} result The object onto which to store the result.\r\n     * @returns {Quaternion} The modified result parameter.\r\n     */\r\n    Quaternion.multiplyByScalar = function(quaternion, scalar, result) {\r\n        //>>includeStart('debug', pragmas.debug);\r\n        Check.typeOf.object('quaternion', quaternion);\r\n        Check.typeOf.number('scalar', scalar);\r\n        Check.typeOf.object('result', result);\r\n        //>>includeEnd('debug');\r\n\r\n        result.x = quaternion.x * scalar;\r\n        result.y = quaternion.y * scalar;\r\n        result.z = quaternion.z * scalar;\r\n        result.w = quaternion.w * scalar;\r\n        return result;\r\n    };\r\n\r\n    /**\r\n     * Divides the provided quaternion componentwise by the provided scalar.\r\n     *\r\n     * @param {Quaternion} quaternion The quaternion to be divided.\r\n     * @param {Number} scalar The scalar to divide by.\r\n     * @param {Quaternion} result The object onto which to store the result.\r\n     * @returns {Quaternion} The modified result parameter.\r\n     */\r\n    Quaternion.divideByScalar = function(quaternion, scalar, result) {\r\n        //>>includeStart('debug', pragmas.debug);\r\n        Check.typeOf.object('quaternion', quaternion);\r\n        Check.typeOf.number('scalar', scalar);\r\n        Check.typeOf.object('result', result);\r\n        //>>includeEnd('debug');\r\n\r\n        result.x = quaternion.x / scalar;\r\n        result.y = quaternion.y / scalar;\r\n        result.z = quaternion.z / scalar;\r\n        result.w = quaternion.w / scalar;\r\n        return result;\r\n    };\r\n\r\n    /**\r\n     * Computes the axis of rotation of the provided quaternion.\r\n     *\r\n     * @param {Quaternion} quaternion The quaternion to use.\r\n     * @param {Cartesian3} result The object onto which to store the result.\r\n     * @returns {Cartesian3} The modified result parameter.\r\n     */\r\n    Quaternion.computeAxis = function(quaternion, result) {\r\n        //>>includeStart('debug', pragmas.debug);\r\n        Check.typeOf.object('quaternion', quaternion);\r\n        Check.typeOf.object('result', result);\r\n        //>>includeEnd('debug');\r\n\r\n        var w = quaternion.w;\r\n        if (Math.abs(w - 1.0) < CesiumMath.EPSILON6) {\r\n            result.x = result.y = result.z = 0;\r\n            return result;\r\n        }\r\n\r\n        var scalar = 1.0 / Math.sqrt(1.0 - (w * w));\r\n\r\n        result.x = quaternion.x * scalar;\r\n        result.y = quaternion.y * scalar;\r\n        result.z = quaternion.z * scalar;\r\n        return result;\r\n    };\r\n\r\n    /**\r\n     * Computes the angle of rotation of the provided quaternion.\r\n     *\r\n     * @param {Quaternion} quaternion The quaternion to use.\r\n     * @returns {Number} The angle of rotation.\r\n     */\r\n    Quaternion.computeAngle = function(quaternion) {\r\n        //>>includeStart('debug', pragmas.debug);\r\n        Check.typeOf.object('quaternion', quaternion);\r\n        //>>includeEnd('debug');\r\n\r\n        if (Math.abs(quaternion.w - 1.0) < CesiumMath.EPSILON6) {\r\n            return 0.0;\r\n        }\r\n        return 2.0 * Math.acos(quaternion.w);\r\n    };\r\n\r\n    var lerpScratch = new Quaternion();\r\n    /**\r\n     * Computes the linear interpolation or extrapolation at t using the provided quaternions.\r\n     *\r\n     * @param {Quaternion} start The value corresponding to t at 0.0.\r\n     * @param {Quaternion} end The value corresponding to t at 1.0.\r\n     * @param {Number} t The point along t at which to interpolate.\r\n     * @param {Quaternion} result The object onto which to store the result.\r\n     * @returns {Quaternion} The modified result parameter.\r\n     */\r\n    Quaternion.lerp = function(start, end, t, result) {\r\n        //>>includeStart('debug', pragmas.debug);\r\n        Check.typeOf.object('start', start);\r\n        Check.typeOf.object('end', end);\r\n        Check.typeOf.number('t', t);\r\n        Check.typeOf.object('result', result);\r\n        //>>includeEnd('debug');\r\n\r\n        lerpScratch = Quaternion.multiplyByScalar(end, t, lerpScratch);\r\n        result = Quaternion.multiplyByScalar(start, 1.0 - t, result);\r\n        return Quaternion.add(lerpScratch, result, result);\r\n    };\r\n\r\n    var slerpEndNegated = new Quaternion();\r\n    var slerpScaledP = new Quaternion();\r\n    var slerpScaledR = new Quaternion();\r\n    /**\r\n     * Computes the spherical linear interpolation or extrapolation at t using the provided quaternions.\r\n     *\r\n     * @param {Quaternion} start The value corresponding to t at 0.0.\r\n     * @param {Quaternion} end The value corresponding to t at 1.0.\r\n     * @param {Number} t The point along t at which to interpolate.\r\n     * @param {Quaternion} result The object onto which to store the result.\r\n     * @returns {Quaternion} The modified result parameter.\r\n     *\r\n     * @see Quaternion#fastSlerp\r\n     */\r\n    Quaternion.slerp = function(start, end, t, result) {\r\n        //>>includeStart('debug', pragmas.debug);\r\n        Check.typeOf.object('start', start);\r\n        Check.typeOf.object('end', end);\r\n        Check.typeOf.number('t', t);\r\n        Check.typeOf.object('result', result);\r\n        //>>includeEnd('debug');\r\n\r\n        var dot = Quaternion.dot(start, end);\r\n\r\n        // The angle between start must be acute. Since q and -q represent\r\n        // the same rotation, negate q to get the acute angle.\r\n        var r = end;\r\n        if (dot < 0.0) {\r\n            dot = -dot;\r\n            r = slerpEndNegated = Quaternion.negate(end, slerpEndNegated);\r\n        }\r\n\r\n        // dot > 0, as the dot product approaches 1, the angle between the\r\n        // quaternions vanishes. use linear interpolation.\r\n        if (1.0 - dot < CesiumMath.EPSILON6) {\r\n            return Quaternion.lerp(start, r, t, result);\r\n        }\r\n\r\n        var theta = Math.acos(dot);\r\n        slerpScaledP = Quaternion.multiplyByScalar(start, Math.sin((1 - t) * theta), slerpScaledP);\r\n        slerpScaledR = Quaternion.multiplyByScalar(r, Math.sin(t * theta), slerpScaledR);\r\n        result = Quaternion.add(slerpScaledP, slerpScaledR, result);\r\n        return Quaternion.multiplyByScalar(result, 1.0 / Math.sin(theta), result);\r\n    };\r\n\r\n    /**\r\n     * The logarithmic quaternion function.\r\n     *\r\n     * @param {Quaternion} quaternion The unit quaternion.\r\n     * @param {Cartesian3} result The object onto which to store the result.\r\n     * @returns {Cartesian3} The modified result parameter.\r\n     */\r\n    Quaternion.log = function(quaternion, result) {\r\n        //>>includeStart('debug', pragmas.debug);\r\n        Check.typeOf.object('quaternion', quaternion);\r\n        Check.typeOf.object('result', result);\r\n        //>>includeEnd('debug');\r\n\r\n        var theta = CesiumMath.acosClamped(quaternion.w);\r\n        var thetaOverSinTheta = 0.0;\r\n\r\n        if (theta !== 0.0) {\r\n            thetaOverSinTheta = theta / Math.sin(theta);\r\n        }\r\n\r\n        return Cartesian3.multiplyByScalar(quaternion, thetaOverSinTheta, result);\r\n    };\r\n\r\n    /**\r\n     * The exponential quaternion function.\r\n     *\r\n     * @param {Cartesian3} cartesian The cartesian.\r\n     * @param {Quaternion} result The object onto which to store the result.\r\n     * @returns {Quaternion} The modified result parameter.\r\n     */\r\n    Quaternion.exp = function(cartesian, result) {\r\n        //>>includeStart('debug', pragmas.debug);\r\n        Check.typeOf.object('cartesian', cartesian);\r\n        Check.typeOf.object('result', result);\r\n        //>>includeEnd('debug');\r\n\r\n        var theta = Cartesian3.magnitude(cartesian);\r\n        var sinThetaOverTheta = 0.0;\r\n\r\n        if (theta !== 0.0) {\r\n            sinThetaOverTheta = Math.sin(theta) / theta;\r\n        }\r\n\r\n        result.x = cartesian.x * sinThetaOverTheta;\r\n        result.y = cartesian.y * sinThetaOverTheta;\r\n        result.z = cartesian.z * sinThetaOverTheta;\r\n        result.w = Math.cos(theta);\r\n\r\n        return result;\r\n    };\r\n\r\n    var squadScratchCartesian0 = new Cartesian3();\r\n    var squadScratchCartesian1 = new Cartesian3();\r\n    var squadScratchQuaternion0 = new Quaternion();\r\n    var squadScratchQuaternion1 = new Quaternion();\r\n\r\n    /**\r\n     * Computes an inner quadrangle point.\r\n     * <p>This will compute quaternions that ensure a squad curve is C<sup>1</sup>.</p>\r\n     *\r\n     * @param {Quaternion} q0 The first quaternion.\r\n     * @param {Quaternion} q1 The second quaternion.\r\n     * @param {Quaternion} q2 The third quaternion.\r\n     * @param {Quaternion} result The object onto which to store the result.\r\n     * @returns {Quaternion} The modified result parameter.\r\n     *\r\n     * @see Quaternion#squad\r\n     */\r\n    Quaternion.computeInnerQuadrangle = function(q0, q1, q2, result) {\r\n        //>>includeStart('debug', pragmas.debug);\r\n        Check.typeOf.object('q0', q0);\r\n        Check.typeOf.object('q1', q1);\r\n        Check.typeOf.object('q2', q2);\r\n        Check.typeOf.object('result', result);\r\n        //>>includeEnd('debug');\r\n\r\n        var qInv = Quaternion.conjugate(q1, squadScratchQuaternion0);\r\n        Quaternion.multiply(qInv, q2, squadScratchQuaternion1);\r\n        var cart0 = Quaternion.log(squadScratchQuaternion1, squadScratchCartesian0);\r\n\r\n        Quaternion.multiply(qInv, q0, squadScratchQuaternion1);\r\n        var cart1 = Quaternion.log(squadScratchQuaternion1, squadScratchCartesian1);\r\n\r\n        Cartesian3.add(cart0, cart1, cart0);\r\n        Cartesian3.multiplyByScalar(cart0, 0.25, cart0);\r\n        Cartesian3.negate(cart0, cart0);\r\n        Quaternion.exp(cart0, squadScratchQuaternion0);\r\n\r\n        return Quaternion.multiply(q1, squadScratchQuaternion0, result);\r\n    };\r\n\r\n    /**\r\n     * Computes the spherical quadrangle interpolation between quaternions.\r\n     *\r\n     * @param {Quaternion} q0 The first quaternion.\r\n     * @param {Quaternion} q1 The second quaternion.\r\n     * @param {Quaternion} s0 The first inner quadrangle.\r\n     * @param {Quaternion} s1 The second inner quadrangle.\r\n     * @param {Number} t The time in [0,1] used to interpolate.\r\n     * @param {Quaternion} result The object onto which to store the result.\r\n     * @returns {Quaternion} The modified result parameter.\r\n     *\r\n     *\r\n     * @example\r\n     * // 1. compute the squad interpolation between two quaternions on a curve\r\n     * var s0 = Cesium.Quaternion.computeInnerQuadrangle(quaternions[i - 1], quaternions[i], quaternions[i + 1], new Cesium.Quaternion());\r\n     * var s1 = Cesium.Quaternion.computeInnerQuadrangle(quaternions[i], quaternions[i + 1], quaternions[i + 2], new Cesium.Quaternion());\r\n     * var q = Cesium.Quaternion.squad(quaternions[i], quaternions[i + 1], s0, s1, t, new Cesium.Quaternion());\r\n     *\r\n     * // 2. compute the squad interpolation as above but where the first quaternion is a end point.\r\n     * var s1 = Cesium.Quaternion.computeInnerQuadrangle(quaternions[0], quaternions[1], quaternions[2], new Cesium.Quaternion());\r\n     * var q = Cesium.Quaternion.squad(quaternions[0], quaternions[1], quaternions[0], s1, t, new Cesium.Quaternion());\r\n     *\r\n     * @see Quaternion#computeInnerQuadrangle\r\n     */\r\n    Quaternion.squad = function(q0, q1, s0, s1, t, result) {\r\n        //>>includeStart('debug', pragmas.debug);\r\n        Check.typeOf.object('q0', q0);\r\n        Check.typeOf.object('q1', q1);\r\n        Check.typeOf.object('s0', s0);\r\n        Check.typeOf.object('s1', s1);\r\n        Check.typeOf.number('t', t);\r\n        Check.typeOf.object('result', result);\r\n        //>>includeEnd('debug');\r\n\r\n        var slerp0 = Quaternion.slerp(q0, q1, t, squadScratchQuaternion0);\r\n        var slerp1 = Quaternion.slerp(s0, s1, t, squadScratchQuaternion1);\r\n        return Quaternion.slerp(slerp0, slerp1, 2.0 * t * (1.0 - t), result);\r\n    };\r\n\r\n    var fastSlerpScratchQuaternion = new Quaternion();\r\n    var opmu = 1.90110745351730037;\r\n    var u = FeatureDetection.supportsTypedArrays() ? new Float32Array(8) : [];\r\n    var v = FeatureDetection.supportsTypedArrays() ? new Float32Array(8) : [];\r\n    var bT = FeatureDetection.supportsTypedArrays() ? new Float32Array(8) : [];\r\n    var bD = FeatureDetection.supportsTypedArrays() ? new Float32Array(8) : [];\r\n\r\n    for (var i = 0; i < 7; ++i) {\r\n        var s = i + 1.0;\r\n        var t = 2.0 * s + 1.0;\r\n        u[i] = 1.0 / (s * t);\r\n        v[i] = s / t;\r\n    }\r\n\r\n    u[7] = opmu / (8.0 * 17.0);\r\n    v[7] = opmu * 8.0 / 17.0;\r\n\r\n    /**\r\n     * Computes the spherical linear interpolation or extrapolation at t using the provided quaternions.\r\n     * This implementation is faster than {@link Quaternion#slerp}, but is only accurate up to 10<sup>-6</sup>.\r\n     *\r\n     * @param {Quaternion} start The value corresponding to t at 0.0.\r\n     * @param {Quaternion} end The value corresponding to t at 1.0.\r\n     * @param {Number} t The point along t at which to interpolate.\r\n     * @param {Quaternion} result The object onto which to store the result.\r\n     * @returns {Quaternion} The modified result parameter.\r\n     *\r\n     * @see Quaternion#slerp\r\n     */\r\n    Quaternion.fastSlerp = function(start, end, t, result) {\r\n        //>>includeStart('debug', pragmas.debug);\r\n        Check.typeOf.object('start', start);\r\n        Check.typeOf.object('end', end);\r\n        Check.typeOf.number('t', t);\r\n        Check.typeOf.object('result', result);\r\n        //>>includeEnd('debug');\r\n\r\n        var x = Quaternion.dot(start, end);\r\n\r\n        var sign;\r\n        if (x >= 0) {\r\n            sign = 1.0;\r\n        } else {\r\n            sign = -1.0;\r\n            x = -x;\r\n        }\r\n\r\n        var xm1 = x - 1.0;\r\n        var d = 1.0 - t;\r\n        var sqrT = t * t;\r\n        var sqrD = d * d;\r\n\r\n        for (var i = 7; i >= 0; --i) {\r\n            bT[i] = (u[i] * sqrT - v[i]) * xm1;\r\n            bD[i] = (u[i] * sqrD - v[i]) * xm1;\r\n        }\r\n\r\n        var cT = sign * t * (\r\n            1.0 + bT[0] * (1.0 + bT[1] * (1.0 + bT[2] * (1.0 + bT[3] * (\r\n            1.0 + bT[4] * (1.0 + bT[5] * (1.0 + bT[6] * (1.0 + bT[7]))))))));\r\n        var cD = d * (\r\n            1.0 + bD[0] * (1.0 + bD[1] * (1.0 + bD[2] * (1.0 + bD[3] * (\r\n            1.0 + bD[4] * (1.0 + bD[5] * (1.0 + bD[6] * (1.0 + bD[7]))))))));\r\n\r\n        var temp = Quaternion.multiplyByScalar(start, cD, fastSlerpScratchQuaternion);\r\n        Quaternion.multiplyByScalar(end, cT, result);\r\n        return Quaternion.add(temp, result, result);\r\n    };\r\n\r\n    /**\r\n     * Computes the spherical quadrangle interpolation between quaternions.\r\n     * An implementation that is faster than {@link Quaternion#squad}, but less accurate.\r\n     *\r\n     * @param {Quaternion} q0 The first quaternion.\r\n     * @param {Quaternion} q1 The second quaternion.\r\n     * @param {Quaternion} s0 The first inner quadrangle.\r\n     * @param {Quaternion} s1 The second inner quadrangle.\r\n     * @param {Number} t The time in [0,1] used to interpolate.\r\n     * @param {Quaternion} result The object onto which to store the result.\r\n     * @returns {Quaternion} The modified result parameter or a new instance if none was provided.\r\n     *\r\n     * @see Quaternion#squad\r\n     */\r\n    Quaternion.fastSquad = function(q0, q1, s0, s1, t, result) {\r\n        //>>includeStart('debug', pragmas.debug);\r\n        Check.typeOf.object('q0', q0);\r\n        Check.typeOf.object('q1', q1);\r\n        Check.typeOf.object('s0', s0);\r\n        Check.typeOf.object('s1', s1);\r\n        Check.typeOf.number('t', t);\r\n        Check.typeOf.object('result', result);\r\n        //>>includeEnd('debug');\r\n\r\n        var slerp0 = Quaternion.fastSlerp(q0, q1, t, squadScratchQuaternion0);\r\n        var slerp1 = Quaternion.fastSlerp(s0, s1, t, squadScratchQuaternion1);\r\n        return Quaternion.fastSlerp(slerp0, slerp1, 2.0 * t * (1.0 - t), result);\r\n    };\r\n\r\n    /**\r\n     * Compares the provided quaternions componentwise and returns\r\n     * <code>true</code> if they are equal, <code>false</code> otherwise.\r\n     *\r\n     * @param {Quaternion} [left] The first quaternion.\r\n     * @param {Quaternion} [right] The second quaternion.\r\n     * @returns {Boolean} <code>true</code> if left and right are equal, <code>false</code> otherwise.\r\n     */\r\n    Quaternion.equals = function(left, right) {\r\n        return (left === right) ||\r\n               ((defined(left)) &&\r\n                (defined(right)) &&\r\n                (left.x === right.x) &&\r\n                (left.y === right.y) &&\r\n                (left.z === right.z) &&\r\n                (left.w === right.w));\r\n    };\r\n\r\n    /**\r\n     * Compares the provided quaternions componentwise and returns\r\n     * <code>true</code> if they are within the provided epsilon,\r\n     * <code>false</code> otherwise.\r\n     *\r\n     * @param {Quaternion} [left] The first quaternion.\r\n     * @param {Quaternion} [right] The second quaternion.\r\n     * @param {Number} epsilon The epsilon to use for equality testing.\r\n     * @returns {Boolean} <code>true</code> if left and right are within the provided epsilon, <code>false</code> otherwise.\r\n     */\r\n    Quaternion.equalsEpsilon = function(left, right, epsilon) {\r\n        //>>includeStart('debug', pragmas.debug);\r\n        Check.typeOf.number('epsilon', epsilon);\r\n        //>>includeEnd('debug');\r\n\r\n        return (left === right) ||\r\n               ((defined(left)) &&\r\n                (defined(right)) &&\r\n                (Math.abs(left.x - right.x) <= epsilon) &&\r\n                (Math.abs(left.y - right.y) <= epsilon) &&\r\n                (Math.abs(left.z - right.z) <= epsilon) &&\r\n                (Math.abs(left.w - right.w) <= epsilon));\r\n    };\r\n\r\n    /**\r\n     * An immutable Quaternion instance initialized to (0.0, 0.0, 0.0, 0.0).\r\n     *\r\n     * @type {Quaternion}\r\n     * @constant\r\n     */\r\n    Quaternion.ZERO = Object.freeze(new Quaternion(0.0, 0.0, 0.0, 0.0));\r\n\r\n    /**\r\n     * An immutable Quaternion instance initialized to (0.0, 0.0, 0.0, 1.0).\r\n     *\r\n     * @type {Quaternion}\r\n     * @constant\r\n     */\r\n    Quaternion.IDENTITY = Object.freeze(new Quaternion(0.0, 0.0, 0.0, 1.0));\r\n\r\n    /**\r\n     * Duplicates this Quaternion instance.\r\n     *\r\n     * @param {Quaternion} [result] The object onto which to store the result.\r\n     * @returns {Quaternion} The modified result parameter or a new Quaternion instance if one was not provided.\r\n     */\r\n    Quaternion.prototype.clone = function(result) {\r\n        return Quaternion.clone(this, result);\r\n    };\r\n\r\n    /**\r\n     * Compares this and the provided quaternion componentwise and returns\r\n     * <code>true</code> if they are equal, <code>false</code> otherwise.\r\n     *\r\n     * @param {Quaternion} [right] The right hand side quaternion.\r\n     * @returns {Boolean} <code>true</code> if left and right are equal, <code>false</code> otherwise.\r\n     */\r\n    Quaternion.prototype.equals = function(right) {\r\n        return Quaternion.equals(this, right);\r\n    };\r\n\r\n    /**\r\n     * Compares this and the provided quaternion componentwise and returns\r\n     * <code>true</code> if they are within the provided epsilon,\r\n     * <code>false</code> otherwise.\r\n     *\r\n     * @param {Quaternion} [right] The right hand side quaternion.\r\n     * @param {Number} epsilon The epsilon to use for equality testing.\r\n     * @returns {Boolean} <code>true</code> if left and right are within the provided epsilon, <code>false</code> otherwise.\r\n     */\r\n    Quaternion.prototype.equalsEpsilon = function(right, epsilon) {\r\n        return Quaternion.equalsEpsilon(this, right, epsilon);\r\n    };\r\n\r\n    /**\r\n     * Returns a string representing this quaternion in the format (x, y, z, w).\r\n     *\r\n     * @returns {String} A string representing this Quaternion.\r\n     */\r\n    Quaternion.prototype.toString = function() {\r\n        return '(' + this.x + ', ' + this.y + ', ' + this.z + ', ' + this.w + ')';\r\n    };\r\nexport default Quaternion;\r\n","import Check from './Check.js';\r\n\r\n    /**\r\n     * Finds an item in a sorted array.\r\n     *\r\n     * @exports binarySearch\r\n     * @param {Array} array The sorted array to search.\r\n     * @param {*} itemToFind The item to find in the array.\r\n     * @param {binarySearch~Comparator} comparator The function to use to compare the item to\r\n     *        elements in the array.\r\n     * @returns {Number} The index of <code>itemToFind</code> in the array, if it exists.  If <code>itemToFind</code>\r\n     *        does not exist, the return value is a negative number which is the bitwise complement (~)\r\n     *        of the index before which the itemToFind should be inserted in order to maintain the\r\n     *        sorted order of the array.\r\n     *\r\n     * @example\r\n     * // Create a comparator function to search through an array of numbers.\r\n     * function comparator(a, b) {\r\n     *     return a - b;\r\n     * };\r\n     * var numbers = [0, 2, 4, 6, 8];\r\n     * var index = Cesium.binarySearch(numbers, 6, comparator); // 3\r\n     */\r\n    function binarySearch(array, itemToFind, comparator) {\r\n        //>>includeStart('debug', pragmas.debug);\r\n        Check.defined('array', array);\r\n        Check.defined('itemToFind', itemToFind);\r\n        Check.defined('comparator', comparator);\r\n        //>>includeEnd('debug');\r\n\r\n        var low = 0;\r\n        var high = array.length - 1;\r\n        var i;\r\n        var comparison;\r\n\r\n        while (low <= high) {\r\n            i = ~~((low + high) / 2);\r\n            comparison = comparator(array[i], itemToFind);\r\n            if (comparison < 0) {\r\n                low = i + 1;\r\n                continue;\r\n            }\r\n            if (comparison > 0) {\r\n                high = i - 1;\r\n                continue;\r\n            }\r\n            return i;\r\n        }\r\n        return ~(high + 1);\r\n    }\r\n\r\n    /**\r\n     * A function used to compare two items while performing a binary search.\r\n     * @callback binarySearch~Comparator\r\n     *\r\n     * @param {*} a An item in the array.\r\n     * @param {*} b The item being searched for.\r\n     * @returns {Number} Returns a negative value if <code>a</code> is less than <code>b</code>,\r\n     *          a positive value if <code>a</code> is greater than <code>b</code>, or\r\n     *          0 if <code>a</code> is equal to <code>b</code>.\r\n     *\r\n     * @example\r\n     * function compareNumbers(a, b) {\r\n     *     return a - b;\r\n     * }\r\n     */\r\nexport default binarySearch;\r\n","\r\n    /**\r\n     * A set of Earth Orientation Parameters (EOP) sampled at a time.\r\n     *\r\n     * @alias EarthOrientationParametersSample\r\n     * @constructor\r\n     *\r\n     * @param {Number} xPoleWander The pole wander about the X axis, in radians.\r\n     * @param {Number} yPoleWander The pole wander about the Y axis, in radians.\r\n     * @param {Number} xPoleOffset The offset to the Celestial Intermediate Pole (CIP) about the X axis, in radians.\r\n     * @param {Number} yPoleOffset The offset to the Celestial Intermediate Pole (CIP) about the Y axis, in radians.\r\n     * @param {Number} ut1MinusUtc The difference in time standards, UT1 - UTC, in seconds.\r\n     *\r\n     * @private\r\n     */\r\n    function EarthOrientationParametersSample(xPoleWander, yPoleWander, xPoleOffset, yPoleOffset, ut1MinusUtc) {\r\n        /**\r\n         * The pole wander about the X axis, in radians.\r\n         * @type {Number}\r\n         */\r\n        this.xPoleWander = xPoleWander;\r\n\r\n        /**\r\n         * The pole wander about the Y axis, in radians.\r\n         * @type {Number}\r\n         */\r\n        this.yPoleWander = yPoleWander;\r\n\r\n        /**\r\n         * The offset to the Celestial Intermediate Pole (CIP) about the X axis, in radians.\r\n         * @type {Number}\r\n         */\r\n        this.xPoleOffset = xPoleOffset;\r\n\r\n        /**\r\n         * The offset to the Celestial Intermediate Pole (CIP) about the Y axis, in radians.\r\n         * @type {Number}\r\n         */\r\n        this.yPoleOffset = yPoleOffset;\r\n\r\n        /**\r\n         * The difference in time standards, UT1 - UTC, in seconds.\r\n         * @type {Number}\r\n         */\r\n        this.ut1MinusUtc = ut1MinusUtc;\r\n    }\r\nexport default EarthOrientationParametersSample;\r\n","/**\r\n@license\r\nsprintf.js from the php.js project - https://github.com/kvz/phpjs\r\nDirectly from https://github.com/kvz/phpjs/blob/master/functions/strings/sprintf.js\r\n\r\nphp.js is copyright 2012 Kevin van Zonneveld.\r\n\r\nPortions copyright Brett Zamir (http://brett-zamir.me), Kevin van Zonneveld\r\n(http://kevin.vanzonneveld.net), Onno Marsman, Theriault, Michael White\r\n(http://getsprink.com), Waldo Malqui Silva, Paulo Freitas, Jack, Jonas\r\nRaoni Soares Silva (http://www.jsfromhell.com), Philip Peterson, Legaev\r\nAndrey, Ates Goral (http://magnetiq.com), Alex, Ratheous, Martijn Wieringa,\r\nRafa? Kukawski (http://blog.kukawski.pl), lmeyrick\r\n(https://sourceforge.net/projects/bcmath-js/), Nate, Philippe Baumann,\r\nEnrique Gonzalez, Webtoolkit.info (http://www.webtoolkit.info/), Carlos R.\r\nL. Rodrigues (http://www.jsfromhell.com), Ash Searle\r\n(http://hexmen.com/blog/), Jani Hartikainen, travc, Ole Vrijenhoek,\r\nErkekjetter, Michael Grier, Rafa? Kukawski (http://kukawski.pl), Johnny\r\nMast (http://www.phpvrouwen.nl), T.Wild, d3x,\r\nhttp://stackoverflow.com/questions/57803/how-to-convert-decimal-to-hex-in-javascript,\r\nRafa? Kukawski (http://blog.kukawski.pl/), stag019, pilus, WebDevHobo\r\n(http://webdevhobo.blogspot.com/), marrtins, GeekFG\r\n(http://geekfg.blogspot.com), Andrea Giammarchi\r\n(http://webreflection.blogspot.com), Arpad Ray (mailto:arpad@php.net),\r\ngorthaur, Paul Smith, Tim de Koning (http://www.kingsquare.nl), Joris, Oleg\r\nEremeev, Steve Hilder, majak, gettimeofday, KELAN, Josh Fraser\r\n(http://onlineaspect.com/2007/06/08/auto-detect-a-time-zone-with-javascript/),\r\nMarc Palau, Martin\r\n(http://www.erlenwiese.de/), Breaking Par Consulting Inc\r\n(http://www.breakingpar.com/bkp/home.nsf/0/87256B280015193F87256CFB006C45F7),\r\nChris, Mirek Slugen, saulius, Alfonso Jimenez\r\n(http://www.alfonsojimenez.com), Diplom@t (http://difane.com/), felix,\r\nMailfaker (http://www.weedem.fr/), Tyler Akins (http://rumkin.com), Caio\r\nAriede (http://caioariede.com), Robin, Kankrelune\r\n(http://www.webfaktory.info/), Karol Kowalski, Imgen Tata\r\n(http://www.myipdf.com/), mdsjack (http://www.mdsjack.bo.it), Dreamer,\r\nFelix Geisendoerfer (http://www.debuggable.com/felix), Lars Fischer, AJ,\r\nDavid, Aman Gupta, Michael White, Public Domain\r\n(http://www.json.org/json2.js), Steven Levithan\r\n(http://blog.stevenlevithan.com), Sakimori, Pellentesque Malesuada,\r\nThunder.m, Dj (http://phpjs.org/functions/htmlentities:425#comment_134018),\r\nSteve Clay, David James, Francois, class_exists, nobbler, T. Wild, Itsacon\r\n(http://www.itsacon.net/), date, Ole Vrijenhoek (http://www.nervous.nl/),\r\nFox, Raphael (Ao RUDLER), Marco, noname, Mateusz \"loonquawl\" Zalega, Frank\r\nForte, Arno, ger, mktime, john (http://www.jd-tech.net), Nick Kolosov\r\n(http://sammy.ru), marc andreu, Scott Cariss, Douglas Crockford\r\n(http://javascript.crockford.com), madipta, Slawomir Kaniecki,\r\nReverseSyntax, Nathan, Alex Wilson, kenneth, Bayron Guevara, Adam Wallner\r\n(http://web2.bitbaro.hu/), paulo kuong, jmweb, Lincoln Ramsay, djmix,\r\nPyerre, Jon Hohle, Thiago Mata (http://thiagomata.blog.com), lmeyrick\r\n(https://sourceforge.net/projects/bcmath-js/this.), Linuxworld, duncan,\r\nGilbert, Sanjoy Roy, Shingo, sankai, Oskar Larsson H?gfeldt\r\n(http://oskar-lh.name/), Denny Wardhana, 0m3r, Everlasto, Subhasis Deb,\r\njosh, jd, Pier Paolo Ramon (http://www.mastersoup.com/), P, merabi, Soren\r\nHansen, Eugene Bulkin (http://doubleaw.com/), Der Simon\r\n(http://innerdom.sourceforge.net/), echo is bad, Ozh, XoraX\r\n(http://www.xorax.info), EdorFaus, JB, J A R, Marc Jansen, Francesco, LH,\r\nStoyan Kyosev (http://www.svest.org/), nord_ua, omid\r\n(http://phpjs.org/functions/380:380#comment_137122), Brad Touesnard, MeEtc\r\n(http://yass.meetcweb.com), Peter-Paul Koch\r\n(http://www.quirksmode.org/js/beat.html), Olivier Louvignes\r\n(http://mg-crea.com/), T0bsn, Tim Wiel, Bryan Elliott, Jalal Berrami,\r\nMartin, JT, David Randall, Thomas Beaucourt (http://www.webapp.fr), taith,\r\nvlado houba, Pierre-Luc Paour, Kristof Coomans (SCK-CEN Belgian Nucleair\r\nResearch Centre), Martin Pool, Kirk Strobeck, Rick Waldron, Brant Messenger\r\n(http://www.brantmessenger.com/), Devan Penner-Woelk, Saulo Vallory, Wagner\r\nB. Soares, Artur Tchernychev, Valentina De Rosa, Jason Wong\r\n(http://carrot.org/), Christoph, Daniel Esteban, strftime, Mick@el, rezna,\r\nSimon Willison (http://simonwillison.net), Anton Ongson, Gabriel Paderni,\r\nMarco van Oort, penutbutterjelly, Philipp Lenssen, Bjorn Roesbeke\r\n(http://www.bjornroesbeke.be/), Bug?, Eric Nagel, Tomasz Wesolowski,\r\nEvertjan Garretsen, Bobby Drake, Blues (http://tech.bluesmoon.info/), Luke\r\nGodfrey, Pul, uestla, Alan C, Ulrich, Rafal Kukawski, Yves Sucaet,\r\nsowberry, Norman \"zEh\" Fuchs, hitwork, Zahlii, johnrembo, Nick Callen,\r\nSteven Levithan (stevenlevithan.com), ejsanders, Scott Baker, Brian Tafoya\r\n(http://www.premasolutions.com/), Philippe Jausions\r\n(http://pear.php.net/user/jausions), Aidan Lister\r\n(http://aidanlister.com/), Rob, e-mike, HKM, ChaosNo1, metjay, strcasecmp,\r\nstrcmp, Taras Bogach, jpfle, Alexander Ermolaev\r\n(http://snippets.dzone.com/user/AlexanderErmolaev), DxGx, kilops, Orlando,\r\ndptr1988, Le Torbi, James (http://www.james-bell.co.uk/), Pedro Tainha\r\n(http://www.pedrotainha.com), James, Arnout Kazemier\r\n(http://www.3rd-Eden.com), Chris McMacken, gabriel paderni, Yannoo,\r\nFGFEmperor, baris ozdil, Tod Gentille, Greg Frazier, jakes, 3D-GRAF, Allan\r\nJensen (http://www.winternet.no), Howard Yeend, Benjamin Lupton, davook,\r\ndaniel airton wermann (http://wermann.com.br), Atli TÂ¨Â®r, Maximusya, Ryan\r\nW Tenney (http://ryan.10e.us), Alexander M Beedie, fearphage\r\n(http://http/my.opera.com/fearphage/), Nathan Sepulveda, Victor, Matteo,\r\nBilly, stensi, Cord, Manish, T.J. Leahy, Riddler\r\n(http://www.frontierwebdev.com/), Rafa? Kukawski, FremyCompany, Matt\r\nBradley, Tim de Koning, Luis Salazar (http://www.freaky-media.com/), Diogo\r\nResende, Rival, Andrej Pavlovic, Garagoth, Le Torbi\r\n(http://www.letorbi.de/), Dino, Josep Sanz (http://www.ws3.es/), rem,\r\nRussell Walker (http://www.nbill.co.uk/), Jamie Beck\r\n(http://www.terabit.ca/), setcookie, Michael, YUI Library:\r\nhttp://developer.yahoo.com/yui/docs/YAHOO.util.DateLocale.html, Blues at\r\nhttp://hacks.bluesmoon.info/strftime/strftime.js, Ben\r\n(http://benblume.co.uk/), DtTvB\r\n(http://dt.in.th/2008-09-16.string-length-in-bytes.html), Andreas, William,\r\nmeo, incidence, Cagri Ekin, Amirouche, Amir Habibi\r\n(http://www.residence-mixte.com/), Luke Smith (http://lucassmith.name),\r\nKheang Hok Chin (http://www.distantia.ca/), Jay Klehr, Lorenzo Pisani,\r\nTony, Yen-Wei Liu, Greenseed, mk.keck, Leslie Hoare, dude, booeyOH, Ben\r\nBryan\r\n\r\nLicensed under the MIT (MIT-LICENSE.txt) license.\r\n\r\nPermission is hereby granted, free of charge, to any person obtaining a\r\ncopy of this software and associated documentation files (the\r\n\"Software\"), to deal in the Software without restriction, including\r\nwithout limitation the rights to use, copy, modify, merge, publish,\r\ndistribute, sublicense, and/or sell copies of the Software, and to\r\npermit persons to whom the Software is furnished to do so, subject to\r\nthe following conditions:\r\n\r\nThe above copyright notice and this permission notice shall be included\r\nin all copies or substantial portions of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\r\nOR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\r\nMERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.\r\nIN NO EVENT SHALL KEVIN VAN ZONNEVELD BE LIABLE FOR ANY CLAIM, DAMAGES\r\nOR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE,\r\nARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR\r\nOTHER DEALINGS IN THE SOFTWARE.\r\n*/\r\n\r\nfunction sprintf () {\r\n  // http://kevin.vanzonneveld.net\r\n  // +   original by: Ash Searle (http://hexmen.com/blog/)\r\n  // + namespaced by: Michael White (http://getsprink.com)\r\n  // +    tweaked by: Jack\r\n  // +   improved by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)\r\n  // +      input by: Paulo Freitas\r\n  // +   improved by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)\r\n  // +      input by: Brett Zamir (http://brett-zamir.me)\r\n  // +   improved by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)\r\n  // +   improved by: Dj\r\n  // +   improved by: Allidylls\r\n  // *     example 1: sprintf(\"%01.2f\", 123.1);\r\n  // *     returns 1: 123.10\r\n  // *     example 2: sprintf(\"[%10s]\", 'monkey');\r\n  // *     returns 2: '[    monkey]'\r\n  // *     example 3: sprintf(\"[%'#10s]\", 'monkey');\r\n  // *     returns 3: '[####monkey]'\r\n  // *     example 4: sprintf(\"%d\", 123456789012345);\r\n  // *     returns 4: '123456789012345'\r\n  var regex = /%%|%(\\d+\\$)?([-+\\'#0 ]*)(\\*\\d+\\$|\\*|\\d+)?(\\.(\\*\\d+\\$|\\*|\\d+))?([scboxXuideEfFgG])/g;\r\n  var a = arguments,\r\n    i = 0,\r\n    format = a[i++];\r\n\r\n  // pad()\r\n  var pad = function (str, len, chr, leftJustify) {\r\n    if (!chr) {\r\n      chr = ' ';\r\n    }\r\n\r\n    var padding = (str.length >= len) ? '' : Array(1 + len - str.length >>> 0).join(chr);\r\n    return leftJustify ? str + padding : padding + str;\r\n  };\r\n\r\n  // justify()\r\n  var justify = function (value, prefix, leftJustify, minWidth, zeroPad, customPadChar) {\r\n    var diff = minWidth - value.length;\r\n    if (diff > 0) {\r\n      if (leftJustify || !zeroPad) {\r\n        value = pad(value, minWidth, customPadChar, leftJustify);\r\n      } else {\r\n        value = value.slice(0, prefix.length) + pad('', diff, '0', true) + value.slice(prefix.length);\r\n      }\r\n    }\r\n    return value;\r\n  };\r\n\r\n  // formatBaseX()\r\n  var formatBaseX = function (value, base, prefix, leftJustify, minWidth, precision, zeroPad) {\r\n    // Note: casts negative numbers to positive ones\r\n    var number = value >>> 0;\r\n    prefix = prefix && number && {\r\n      '2': '0b',\r\n      '8': '0',\r\n      '16': '0x'\r\n    }[base] || '';\r\n    value = prefix + pad(number.toString(base), precision || 0, '0', false);\r\n    return justify(value, prefix, leftJustify, minWidth, zeroPad);\r\n  };\r\n\r\n  // formatString()\r\n  var formatString = function (value, leftJustify, minWidth, precision, zeroPad, customPadChar) {\r\n    if (precision != null) {\r\n      value = value.slice(0, precision);\r\n    }\r\n    return justify(value, '', leftJustify, minWidth, zeroPad, customPadChar);\r\n  };\r\n\r\n  // doFormat()\r\n  var doFormat = function (substring, valueIndex, flags, minWidth, _, precision, type) {\r\n    var number;\r\n    var prefix;\r\n    var method;\r\n    var textTransform;\r\n    var value;\r\n\r\n    if (substring == '%%') {\r\n      return '%';\r\n    }\r\n\r\n    // parse flags\r\n    var leftJustify = false,\r\n      positivePrefix = '',\r\n      zeroPad = false,\r\n      prefixBaseX = false,\r\n      customPadChar = ' ';\r\n    var flagsl = flags.length;\r\n    for (var j = 0; flags && j < flagsl; j++) {\r\n      switch (flags.charAt(j)) {\r\n      case ' ':\r\n        positivePrefix = ' ';\r\n        break;\r\n      case '+':\r\n        positivePrefix = '+';\r\n        break;\r\n      case '-':\r\n        leftJustify = true;\r\n        break;\r\n      case \"'\":\r\n        customPadChar = flags.charAt(j + 1);\r\n        break;\r\n      case '0':\r\n        zeroPad = true;\r\n        break;\r\n      case '#':\r\n        prefixBaseX = true;\r\n        break;\r\n      }\r\n    }\r\n\r\n    // parameters may be null, undefined, empty-string or real valued\r\n    // we want to ignore null, undefined and empty-string values\r\n    if (!minWidth) {\r\n      minWidth = 0;\r\n    } else if (minWidth == '*') {\r\n      minWidth = +a[i++];\r\n    } else if (minWidth.charAt(0) == '*') {\r\n      minWidth = +a[minWidth.slice(1, -1)];\r\n    } else {\r\n      minWidth = +minWidth;\r\n    }\r\n\r\n    // Note: undocumented perl feature:\r\n    if (minWidth < 0) {\r\n      minWidth = -minWidth;\r\n      leftJustify = true;\r\n    }\r\n\r\n    if (!isFinite(minWidth)) {\r\n      throw new Error('sprintf: (minimum-)width must be finite');\r\n    }\r\n\r\n    if (!precision) {\r\n      precision = 'fFeE'.indexOf(type) > -1 ? 6 : (type == 'd') ? 0 : undefined;\r\n    } else if (precision == '*') {\r\n      precision = +a[i++];\r\n    } else if (precision.charAt(0) == '*') {\r\n      precision = +a[precision.slice(1, -1)];\r\n    } else {\r\n      precision = +precision;\r\n    }\r\n\r\n    // grab value using valueIndex if required?\r\n    value = valueIndex ? a[valueIndex.slice(0, -1)] : a[i++];\r\n\r\n    switch (type) {\r\n    case 's':\r\n      return formatString(String(value), leftJustify, minWidth, precision, zeroPad, customPadChar);\r\n    case 'c':\r\n      return formatString(String.fromCharCode(+value), leftJustify, minWidth, precision, zeroPad);\r\n    case 'b':\r\n      return formatBaseX(value, 2, prefixBaseX, leftJustify, minWidth, precision, zeroPad);\r\n    case 'o':\r\n      return formatBaseX(value, 8, prefixBaseX, leftJustify, minWidth, precision, zeroPad);\r\n    case 'x':\r\n      return formatBaseX(value, 16, prefixBaseX, leftJustify, minWidth, precision, zeroPad);\r\n    case 'X':\r\n      return formatBaseX(value, 16, prefixBaseX, leftJustify, minWidth, precision, zeroPad).toUpperCase();\r\n    case 'u':\r\n      return formatBaseX(value, 10, prefixBaseX, leftJustify, minWidth, precision, zeroPad);\r\n    case 'i':\r\n    case 'd':\r\n      number = +value || 0;\r\n      number = Math.round(number - number % 1); // Plain Math.round doesn't just truncate\r\n      prefix = number < 0 ? '-' : positivePrefix;\r\n      value = prefix + pad(String(Math.abs(number)), precision, '0', false);\r\n      return justify(value, prefix, leftJustify, minWidth, zeroPad);\r\n    case 'e':\r\n    case 'E':\r\n    case 'f': // Should handle locales (as per setlocale)\r\n    case 'F':\r\n    case 'g':\r\n    case 'G':\r\n      number = +value;\r\n      prefix = number < 0 ? '-' : positivePrefix;\r\n      method = ['toExponential', 'toFixed', 'toPrecision']['efg'.indexOf(type.toLowerCase())];\r\n      textTransform = ['toString', 'toUpperCase']['eEfFgG'.indexOf(type) % 2];\r\n      value = prefix + Math.abs(number)[method](precision);\r\n      return justify(value, prefix, leftJustify, minWidth, zeroPad)[textTransform]();\r\n    default:\r\n      return substring;\r\n    }\r\n  };\r\n\r\n  return format.replace(regex, doFormat);\r\n}\r\n\r\nexport default sprintf;\r\n","\r\n    /**\r\n     * Represents a Gregorian date in a more precise format than the JavaScript Date object.\r\n     * In addition to submillisecond precision, this object can also represent leap seconds.\r\n     * @alias GregorianDate\r\n     * @constructor\r\n     *\r\n     * @see JulianDate#toGregorianDate\r\n     */\r\n    function GregorianDate(year, month, day, hour, minute, second, millisecond, isLeapSecond) {\r\n        /**\r\n         * Gets or sets the year as a whole number.\r\n         * @type {Number}\r\n         */\r\n        this.year = year;\r\n        /**\r\n         * Gets or sets the month as a whole number with range [1, 12].\r\n         * @type {Number}\r\n         */\r\n        this.month = month;\r\n        /**\r\n         * Gets or sets the day of the month as a whole number starting at 1.\r\n         * @type {Number}\r\n         */\r\n        this.day = day;\r\n        /**\r\n         * Gets or sets the hour as a whole number with range [0, 23].\r\n         * @type {Number}\r\n         */\r\n        this.hour = hour;\r\n        /**\r\n         * Gets or sets the minute of the hour as a whole number with range [0, 59].\r\n         * @type {Number}\r\n         */\r\n        this.minute = minute;\r\n        /**\r\n         * Gets or sets the second of the minute as a whole number with range [0, 60], with 60 representing a leap second.\r\n         * @type {Number}\r\n         */\r\n        this.second = second;\r\n        /**\r\n         * Gets or sets the millisecond of the second as a floating point number with range [0.0, 1000.0).\r\n         * @type {Number}\r\n         */\r\n        this.millisecond = millisecond;\r\n        /**\r\n         * Gets or sets whether this time is during a leap second.\r\n         * @type {Boolean}\r\n         */\r\n        this.isLeapSecond = isLeapSecond;\r\n    }\r\nexport default GregorianDate;\r\n","import DeveloperError from './DeveloperError.js';\r\n\r\n    /**\r\n     * Determines if a given date is a leap year.\r\n     *\r\n     * @exports isLeapYear\r\n     *\r\n     * @param {Number} year The year to be tested.\r\n     * @returns {Boolean} True if <code>year</code> is a leap year.\r\n     *\r\n     * @example\r\n     * var leapYear = Cesium.isLeapYear(2000); // true\r\n     */\r\n    function isLeapYear(year) {\r\n        //>>includeStart('debug', pragmas.debug);\r\n        if (year === null || isNaN(year)) {\r\n            throw new DeveloperError('year is required and must be a number.');\r\n        }\r\n        //>>includeEnd('debug');\r\n\r\n        return ((year % 4 === 0) && (year % 100 !== 0)) || (year % 400 === 0);\r\n    }\r\nexport default isLeapYear;\r\n","\r\n    /**\r\n     * Describes a single leap second, which is constructed from a {@link JulianDate} and a\r\n     * numerical offset representing the number of seconds TAI is ahead of the UTC time standard.\r\n     * @alias LeapSecond\r\n     * @constructor\r\n     *\r\n     * @param {JulianDate} [date] A Julian date representing the time of the leap second.\r\n     * @param {Number} [offset] The cumulative number of seconds that TAI is ahead of UTC at the provided date.\r\n     */\r\n    function LeapSecond(date, offset) {\r\n        /**\r\n         * Gets or sets the date at which this leap second occurs.\r\n         * @type {JulianDate}\r\n         */\r\n        this.julianDate = date;\r\n\r\n        /**\r\n         * Gets or sets the cumulative number of seconds between the UTC and TAI time standards at the time\r\n         * of this leap second.\r\n         * @type {Number}\r\n         */\r\n        this.offset = offset;\r\n    }\r\nexport default LeapSecond;\r\n","\r\n    /**\r\n     * Constants for time conversions like those done by {@link JulianDate}.\r\n     *\r\n     * @exports TimeConstants\r\n     *\r\n     * @see JulianDate\r\n     *\r\n     * @private\r\n     */\r\n    var TimeConstants = {\r\n        /**\r\n         * The number of seconds in one millisecond: <code>0.001</code>\r\n         * @type {Number}\r\n         * @constant\r\n         */\r\n        SECONDS_PER_MILLISECOND : 0.001,\r\n\r\n        /**\r\n         * The number of seconds in one minute: <code>60</code>.\r\n         * @type {Number}\r\n         * @constant\r\n         */\r\n        SECONDS_PER_MINUTE : 60.0,\r\n\r\n        /**\r\n         * The number of minutes in one hour: <code>60</code>.\r\n         * @type {Number}\r\n         * @constant\r\n         */\r\n        MINUTES_PER_HOUR : 60.0,\r\n\r\n        /**\r\n         * The number of hours in one day: <code>24</code>.\r\n         * @type {Number}\r\n         * @constant\r\n         */\r\n        HOURS_PER_DAY : 24.0,\r\n\r\n        /**\r\n         * The number of seconds in one hour: <code>3600</code>.\r\n         * @type {Number}\r\n         * @constant\r\n         */\r\n        SECONDS_PER_HOUR : 3600.0,\r\n\r\n        /**\r\n         * The number of minutes in one day: <code>1440</code>.\r\n         * @type {Number}\r\n         * @constant\r\n         */\r\n        MINUTES_PER_DAY : 1440.0,\r\n\r\n        /**\r\n         * The number of seconds in one day, ignoring leap seconds: <code>86400</code>.\r\n         * @type {Number}\r\n         * @constant\r\n         */\r\n        SECONDS_PER_DAY : 86400.0,\r\n\r\n        /**\r\n         * The number of days in one Julian century: <code>36525</code>.\r\n         * @type {Number}\r\n         * @constant\r\n         */\r\n        DAYS_PER_JULIAN_CENTURY : 36525.0,\r\n\r\n        /**\r\n         * One trillionth of a second.\r\n         * @type {Number}\r\n         * @constant\r\n         */\r\n        PICOSECOND : 0.000000001,\r\n\r\n        /**\r\n         * The number of days to subtract from a Julian date to determine the\r\n         * modified Julian date, which gives the number of days since midnight\r\n         * on November 17, 1858.\r\n         * @type {Number}\r\n         * @constant\r\n         */\r\n        MODIFIED_JULIAN_DATE_DIFFERENCE : 2400000.5\r\n    };\r\nexport default Object.freeze(TimeConstants);\r\n","\r\n    /**\r\n     * Provides the type of time standards which JulianDate can take as input.\r\n     *\r\n     * @exports TimeStandard\r\n     *\r\n     * @see JulianDate\r\n     */\r\n    var TimeStandard = {\r\n        /**\r\n         * Represents the coordinated Universal Time (UTC) time standard.\r\n         *\r\n         * UTC is related to TAI according to the relationship\r\n         * <code>UTC = TAI - deltaT</code> where <code>deltaT</code> is the number of leap\r\n         * seconds which have been introduced as of the time in TAI.\r\n         *\r\n         * @type {Number}\r\n         * @constant\r\n         */\r\n        UTC : 0,\r\n\r\n        /**\r\n         * Represents the International Atomic Time (TAI) time standard.\r\n         * TAI is the principal time standard to which the other time standards are related.\r\n         *\r\n         * @type {Number}\r\n         * @constant\r\n         */\r\n        TAI : 1\r\n    };\r\nexport default Object.freeze(TimeStandard);\r\n","import sprintf from '../ThirdParty/sprintf.js';\r\nimport binarySearch from './binarySearch.js';\r\nimport defaultValue from './defaultValue.js';\r\nimport defined from './defined.js';\r\nimport DeveloperError from './DeveloperError.js';\r\nimport GregorianDate from './GregorianDate.js';\r\nimport isLeapYear from './isLeapYear.js';\r\nimport LeapSecond from './LeapSecond.js';\r\nimport TimeConstants from './TimeConstants.js';\r\nimport TimeStandard from './TimeStandard.js';\r\n\r\n    var gregorianDateScratch = new GregorianDate();\r\n    var daysInMonth = [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];\r\n    var daysInLeapFeburary = 29;\r\n\r\n    function compareLeapSecondDates(leapSecond, dateToFind) {\r\n        return JulianDate.compare(leapSecond.julianDate, dateToFind.julianDate);\r\n    }\r\n\r\n    // we don't really need a leap second instance, anything with a julianDate property will do\r\n    var binarySearchScratchLeapSecond = new LeapSecond();\r\n\r\n    function convertUtcToTai(julianDate) {\r\n        //Even though julianDate is in UTC, we'll treat it as TAI and\r\n        //search the leap second table for it.\r\n        binarySearchScratchLeapSecond.julianDate = julianDate;\r\n        var leapSeconds = JulianDate.leapSeconds;\r\n        var index = binarySearch(leapSeconds, binarySearchScratchLeapSecond, compareLeapSecondDates);\r\n\r\n        if (index < 0) {\r\n            index = ~index;\r\n        }\r\n\r\n        if (index >= leapSeconds.length) {\r\n            index = leapSeconds.length - 1;\r\n        }\r\n\r\n        var offset = leapSeconds[index].offset;\r\n        if (index > 0) {\r\n            //Now we have the index of the closest leap second that comes on or after our UTC time.\r\n            //However, if the difference between the UTC date being converted and the TAI\r\n            //defined leap second is greater than the offset, we are off by one and need to use\r\n            //the previous leap second.\r\n            var difference = JulianDate.secondsDifference(leapSeconds[index].julianDate, julianDate);\r\n            if (difference > offset) {\r\n                index--;\r\n                offset = leapSeconds[index].offset;\r\n            }\r\n        }\r\n\r\n        JulianDate.addSeconds(julianDate, offset, julianDate);\r\n    }\r\n\r\n    function convertTaiToUtc(julianDate, result) {\r\n        binarySearchScratchLeapSecond.julianDate = julianDate;\r\n        var leapSeconds = JulianDate.leapSeconds;\r\n        var index = binarySearch(leapSeconds, binarySearchScratchLeapSecond, compareLeapSecondDates);\r\n        if (index < 0) {\r\n            index = ~index;\r\n        }\r\n\r\n        //All times before our first leap second get the first offset.\r\n        if (index === 0) {\r\n            return JulianDate.addSeconds(julianDate, -leapSeconds[0].offset, result);\r\n        }\r\n\r\n        //All times after our leap second get the last offset.\r\n        if (index >= leapSeconds.length) {\r\n            return JulianDate.addSeconds(julianDate, -leapSeconds[index - 1].offset, result);\r\n        }\r\n\r\n        //Compute the difference between the found leap second and the time we are converting.\r\n        var difference = JulianDate.secondsDifference(leapSeconds[index].julianDate, julianDate);\r\n\r\n        if (difference === 0) {\r\n            //The date is in our leap second table.\r\n            return JulianDate.addSeconds(julianDate, -leapSeconds[index].offset, result);\r\n        }\r\n\r\n        if (difference <= 1.0) {\r\n            //The requested date is during the moment of a leap second, then we cannot convert to UTC\r\n            return undefined;\r\n        }\r\n\r\n        //The time is in between two leap seconds, index is the leap second after the date\r\n        //we're converting, so we subtract one to get the correct LeapSecond instance.\r\n        return JulianDate.addSeconds(julianDate, -leapSeconds[--index].offset, result);\r\n    }\r\n\r\n    function setComponents(wholeDays, secondsOfDay, julianDate) {\r\n        var extraDays = (secondsOfDay / TimeConstants.SECONDS_PER_DAY) | 0;\r\n        wholeDays += extraDays;\r\n        secondsOfDay -= TimeConstants.SECONDS_PER_DAY * extraDays;\r\n\r\n        if (secondsOfDay < 0) {\r\n            wholeDays--;\r\n            secondsOfDay += TimeConstants.SECONDS_PER_DAY;\r\n        }\r\n\r\n        julianDate.dayNumber = wholeDays;\r\n        julianDate.secondsOfDay = secondsOfDay;\r\n        return julianDate;\r\n    }\r\n\r\n    function computeJulianDateComponents(year, month, day, hour, minute, second, millisecond) {\r\n        // Algorithm from page 604 of the Explanatory Supplement to the\r\n        // Astronomical Almanac (Seidelmann 1992).\r\n\r\n        var a = ((month - 14) / 12) | 0;\r\n        var b = year + 4800 + a;\r\n        var dayNumber = (((1461 * b) / 4) | 0) + (((367 * (month - 2 - 12 * a)) / 12) | 0) - (((3 * (((b + 100) / 100) | 0)) / 4) | 0) + day - 32075;\r\n\r\n        // JulianDates are noon-based\r\n        hour = hour - 12;\r\n        if (hour < 0) {\r\n            hour += 24;\r\n        }\r\n\r\n        var secondsOfDay = second + ((hour * TimeConstants.SECONDS_PER_HOUR) + (minute * TimeConstants.SECONDS_PER_MINUTE) + (millisecond * TimeConstants.SECONDS_PER_MILLISECOND));\r\n\r\n        if (secondsOfDay >= 43200.0) {\r\n            dayNumber -= 1;\r\n        }\r\n\r\n        return [dayNumber, secondsOfDay];\r\n    }\r\n\r\n    //Regular expressions used for ISO8601 date parsing.\r\n    //YYYY\r\n    var matchCalendarYear = /^(\\d{4})$/;\r\n    //YYYY-MM (YYYYMM is invalid)\r\n    var matchCalendarMonth = /^(\\d{4})-(\\d{2})$/;\r\n    //YYYY-DDD or YYYYDDD\r\n    var matchOrdinalDate = /^(\\d{4})-?(\\d{3})$/;\r\n    //YYYY-Www or YYYYWww or YYYY-Www-D or YYYYWwwD\r\n    var matchWeekDate = /^(\\d{4})-?W(\\d{2})-?(\\d{1})?$/;\r\n    //YYYY-MM-DD or YYYYMMDD\r\n    var matchCalendarDate = /^(\\d{4})-?(\\d{2})-?(\\d{2})$/;\r\n    // Match utc offset\r\n    var utcOffset = /([Z+\\-])?(\\d{2})?:?(\\d{2})?$/;\r\n    // Match hours HH or HH.xxxxx\r\n    var matchHours = /^(\\d{2})(\\.\\d+)?/.source + utcOffset.source;\r\n    // Match hours/minutes HH:MM HHMM.xxxxx\r\n    var matchHoursMinutes = /^(\\d{2}):?(\\d{2})(\\.\\d+)?/.source + utcOffset.source;\r\n    // Match hours/minutes HH:MM:SS HHMMSS.xxxxx\r\n    var matchHoursMinutesSeconds = /^(\\d{2}):?(\\d{2}):?(\\d{2})(\\.\\d+)?/.source + utcOffset.source;\r\n\r\n    var iso8601ErrorMessage = 'Invalid ISO 8601 date.';\r\n\r\n    /**\r\n     * Represents an astronomical Julian date, which is the number of days since noon on January 1, -4712 (4713 BC).\r\n     * For increased precision, this class stores the whole number part of the date and the seconds\r\n     * part of the date in separate components.  In order to be safe for arithmetic and represent\r\n     * leap seconds, the date is always stored in the International Atomic Time standard\r\n     * {@link TimeStandard.TAI}.\r\n     * @alias JulianDate\r\n     * @constructor\r\n     *\r\n     * @param {Number} [julianDayNumber=0.0] The Julian Day Number representing the number of whole days.  Fractional days will also be handled correctly.\r\n     * @param {Number} [secondsOfDay=0.0] The number of seconds into the current Julian Day Number.  Fractional seconds, negative seconds and seconds greater than a day will be handled correctly.\r\n     * @param {TimeStandard} [timeStandard=TimeStandard.UTC] The time standard in which the first two parameters are defined.\r\n     */\r\n    function JulianDate(julianDayNumber, secondsOfDay, timeStandard) {\r\n        /**\r\n         * Gets or sets the number of whole days.\r\n         * @type {Number}\r\n         */\r\n        this.dayNumber = undefined;\r\n\r\n        /**\r\n         * Gets or sets the number of seconds into the current day.\r\n         * @type {Number}\r\n         */\r\n        this.secondsOfDay = undefined;\r\n\r\n        julianDayNumber = defaultValue(julianDayNumber, 0.0);\r\n        secondsOfDay = defaultValue(secondsOfDay, 0.0);\r\n        timeStandard = defaultValue(timeStandard, TimeStandard.UTC);\r\n\r\n        //If julianDayNumber is fractional, make it an integer and add the number of seconds the fraction represented.\r\n        var wholeDays = julianDayNumber | 0;\r\n        secondsOfDay = secondsOfDay + (julianDayNumber - wholeDays) * TimeConstants.SECONDS_PER_DAY;\r\n\r\n        setComponents(wholeDays, secondsOfDay, this);\r\n\r\n        if (timeStandard === TimeStandard.UTC) {\r\n            convertUtcToTai(this);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Creates a new instance from a GregorianDate.\r\n     *\r\n     * @param {GregorianDate} date A GregorianDate.\r\n     * @param {JulianDate} [result] An existing instance to use for the result.\r\n     * @returns {JulianDate} The modified result parameter or a new instance if none was provided.\r\n     *\r\n     * @exception {DeveloperError} date must be a valid GregorianDate.\r\n     */\r\n    JulianDate.fromGregorianDate = function(date, result) {\r\n        //>>includeStart('debug', pragmas.debug);\r\n        if (!(date instanceof GregorianDate)) {\r\n            throw new DeveloperError('date must be a valid GregorianDate.');\r\n        }\r\n        //>>includeEnd('debug');\r\n\r\n        var components = computeJulianDateComponents(date.year, date.month, date.day, date.hour, date.minute, date.second, date.millisecond);\r\n        if (!defined(result)) {\r\n            return new JulianDate(components[0], components[1], TimeStandard.UTC);\r\n        }\r\n        setComponents(components[0], components[1], result);\r\n        convertUtcToTai(result);\r\n        return result;\r\n    };\r\n\r\n    /**\r\n     * Creates a new instance from a JavaScript Date.\r\n     *\r\n     * @param {Date} date A JavaScript Date.\r\n     * @param {JulianDate} [result] An existing instance to use for the result.\r\n     * @returns {JulianDate} The modified result parameter or a new instance if none was provided.\r\n     *\r\n     * @exception {DeveloperError} date must be a valid JavaScript Date.\r\n     */\r\n    JulianDate.fromDate = function(date, result) {\r\n        //>>includeStart('debug', pragmas.debug);\r\n        if (!(date instanceof Date) || isNaN(date.getTime())) {\r\n            throw new DeveloperError('date must be a valid JavaScript Date.');\r\n        }\r\n        //>>includeEnd('debug');\r\n\r\n        var components = computeJulianDateComponents(date.getUTCFullYear(), date.getUTCMonth() + 1, date.getUTCDate(), date.getUTCHours(), date.getUTCMinutes(), date.getUTCSeconds(), date.getUTCMilliseconds());\r\n        if (!defined(result)) {\r\n            return new JulianDate(components[0], components[1], TimeStandard.UTC);\r\n        }\r\n        setComponents(components[0], components[1], result);\r\n        convertUtcToTai(result);\r\n        return result;\r\n    };\r\n\r\n    /**\r\n     * Creates a new instance from a from an {@link http://en.wikipedia.org/wiki/ISO_8601|ISO 8601} date.\r\n     * This method is superior to <code>Date.parse</code> because it will handle all valid formats defined by the ISO 8601\r\n     * specification, including leap seconds and sub-millisecond times, which discarded by most JavaScript implementations.\r\n     *\r\n     * @param {String} iso8601String An ISO 8601 date.\r\n     * @param {JulianDate} [result] An existing instance to use for the result.\r\n     * @returns {JulianDate} The modified result parameter or a new instance if none was provided.\r\n     *\r\n     * @exception {DeveloperError} Invalid ISO 8601 date.\r\n     */\r\n    JulianDate.fromIso8601 = function(iso8601String, result) {\r\n        //>>includeStart('debug', pragmas.debug);\r\n        if (typeof iso8601String !== 'string') {\r\n            throw new DeveloperError(iso8601ErrorMessage);\r\n        }\r\n        //>>includeEnd('debug');\r\n\r\n        //Comma and decimal point both indicate a fractional number according to ISO 8601,\r\n        //start out by blanket replacing , with . which is the only valid such symbol in JS.\r\n        iso8601String = iso8601String.replace(',', '.');\r\n\r\n        //Split the string into its date and time components, denoted by a mandatory T\r\n        var tokens = iso8601String.split('T');\r\n        var year;\r\n        var month = 1;\r\n        var day = 1;\r\n        var hour = 0;\r\n        var minute = 0;\r\n        var second = 0;\r\n        var millisecond = 0;\r\n\r\n        //Lacking a time is okay, but a missing date is illegal.\r\n        var date = tokens[0];\r\n        var time = tokens[1];\r\n        var tmp;\r\n        var inLeapYear;\r\n        //>>includeStart('debug', pragmas.debug);\r\n        if (!defined(date)) {\r\n            throw new DeveloperError(iso8601ErrorMessage);\r\n        }\r\n\r\n        var dashCount;\r\n        //>>includeEnd('debug');\r\n\r\n        //First match the date against possible regular expressions.\r\n        tokens = date.match(matchCalendarDate);\r\n        if (tokens !== null) {\r\n            //>>includeStart('debug', pragmas.debug);\r\n            dashCount = date.split('-').length - 1;\r\n            if (dashCount > 0 && dashCount !== 2) {\r\n                throw new DeveloperError(iso8601ErrorMessage);\r\n            }\r\n            //>>includeEnd('debug');\r\n            year = +tokens[1];\r\n            month = +tokens[2];\r\n            day = +tokens[3];\r\n        } else {\r\n            tokens = date.match(matchCalendarMonth);\r\n            if (tokens !== null) {\r\n                year = +tokens[1];\r\n                month = +tokens[2];\r\n            } else {\r\n                tokens = date.match(matchCalendarYear);\r\n                if (tokens !== null) {\r\n                    year = +tokens[1];\r\n                } else {\r\n                    //Not a year/month/day so it must be an ordinal date.\r\n                    var dayOfYear;\r\n                    tokens = date.match(matchOrdinalDate);\r\n                    if (tokens !== null) {\r\n\r\n                        year = +tokens[1];\r\n                        dayOfYear = +tokens[2];\r\n                        inLeapYear = isLeapYear(year);\r\n\r\n                        //This validation is only applicable for this format.\r\n                        //>>includeStart('debug', pragmas.debug);\r\n                        if (dayOfYear < 1 || (inLeapYear && dayOfYear > 366) || (!inLeapYear && dayOfYear > 365)) {\r\n                            throw new DeveloperError(iso8601ErrorMessage);\r\n                        }\r\n                        //>>includeEnd('debug')\r\n                    } else {\r\n                        tokens = date.match(matchWeekDate);\r\n                        if (tokens !== null) {\r\n                            //ISO week date to ordinal date from\r\n                            //http://en.wikipedia.org/w/index.php?title=ISO_week_date&oldid=474176775\r\n                            year = +tokens[1];\r\n                            var weekNumber = +tokens[2];\r\n                            var dayOfWeek = +tokens[3] || 0;\r\n\r\n                            //>>includeStart('debug', pragmas.debug);\r\n                            dashCount = date.split('-').length - 1;\r\n                            if (dashCount > 0 &&\r\n                               ((!defined(tokens[3]) && dashCount !== 1) ||\r\n                               (defined(tokens[3]) && dashCount !== 2))) {\r\n                                throw new DeveloperError(iso8601ErrorMessage);\r\n                            }\r\n                            //>>includeEnd('debug')\r\n\r\n                            var january4 = new Date(Date.UTC(year, 0, 4));\r\n                            dayOfYear = (weekNumber * 7) + dayOfWeek - january4.getUTCDay() - 3;\r\n                        } else {\r\n                            //None of our regular expressions succeeded in parsing the date properly.\r\n                            //>>includeStart('debug', pragmas.debug);\r\n                            throw new DeveloperError(iso8601ErrorMessage);\r\n                            //>>includeEnd('debug')\r\n                        }\r\n                    }\r\n                    //Split an ordinal date into month/day.\r\n                    tmp = new Date(Date.UTC(year, 0, 1));\r\n                    tmp.setUTCDate(dayOfYear);\r\n                    month = tmp.getUTCMonth() + 1;\r\n                    day = tmp.getUTCDate();\r\n                }\r\n            }\r\n        }\r\n\r\n        //Now that we have all of the date components, validate them to make sure nothing is out of range.\r\n        inLeapYear = isLeapYear(year);\r\n        //>>includeStart('debug', pragmas.debug);\r\n        if (month < 1 || month > 12 || day < 1 || ((month !== 2 || !inLeapYear) && day > daysInMonth[month - 1]) || (inLeapYear && month === 2 && day > daysInLeapFeburary)) {\r\n            throw new DeveloperError(iso8601ErrorMessage);\r\n        }\r\n        //>>includeEnd('debug')\r\n\r\n        //Now move onto the time string, which is much simpler.\r\n        //If no time is specified, it is considered the beginning of the day, UTC to match Javascript's implementation.\r\n        var offsetIndex;\r\n        if (defined(time)) {\r\n            tokens = time.match(matchHoursMinutesSeconds);\r\n            if (tokens !== null) {\r\n                //>>includeStart('debug', pragmas.debug);\r\n                dashCount = time.split(':').length - 1;\r\n                if (dashCount > 0 && dashCount !== 2 && dashCount !== 3) {\r\n                    throw new DeveloperError(iso8601ErrorMessage);\r\n                }\r\n                //>>includeEnd('debug')\r\n\r\n                hour = +tokens[1];\r\n                minute = +tokens[2];\r\n                second = +tokens[3];\r\n                millisecond = +(tokens[4] || 0) * 1000.0;\r\n                offsetIndex = 5;\r\n            } else {\r\n                tokens = time.match(matchHoursMinutes);\r\n                if (tokens !== null) {\r\n                    //>>includeStart('debug', pragmas.debug);\r\n                    dashCount = time.split(':').length - 1;\r\n                    if (dashCount > 2) {\r\n                        throw new DeveloperError(iso8601ErrorMessage);\r\n                    }\r\n                    //>>includeEnd('debug')\r\n\r\n                    hour = +tokens[1];\r\n                    minute = +tokens[2];\r\n                    second = +(tokens[3] || 0) * 60.0;\r\n                    offsetIndex = 4;\r\n                } else {\r\n                    tokens = time.match(matchHours);\r\n                    if (tokens !== null) {\r\n                        hour = +tokens[1];\r\n                        minute = +(tokens[2] || 0) * 60.0;\r\n                        offsetIndex = 3;\r\n                    } else {\r\n                        //>>includeStart('debug', pragmas.debug);\r\n                        throw new DeveloperError(iso8601ErrorMessage);\r\n                        //>>includeEnd('debug')\r\n                    }\r\n                }\r\n            }\r\n\r\n            //Validate that all values are in proper range.  Minutes and hours have special cases at 60 and 24.\r\n            //>>includeStart('debug', pragmas.debug);\r\n            if (minute >= 60 || second >= 61 || hour > 24 || (hour === 24 && (minute > 0 || second > 0 || millisecond > 0))) {\r\n                throw new DeveloperError(iso8601ErrorMessage);\r\n            }\r\n            //>>includeEnd('debug');\r\n\r\n            //Check the UTC offset value, if no value exists, use local time\r\n            //a Z indicates UTC, + or - are offsets.\r\n            var offset = tokens[offsetIndex];\r\n            var offsetHours = +(tokens[offsetIndex + 1]);\r\n            var offsetMinutes = +(tokens[offsetIndex + 2] || 0);\r\n            switch (offset) {\r\n            case '+':\r\n                hour = hour - offsetHours;\r\n                minute = minute - offsetMinutes;\r\n                break;\r\n            case '-':\r\n                hour = hour + offsetHours;\r\n                minute = minute + offsetMinutes;\r\n                break;\r\n            case 'Z':\r\n                break;\r\n            default:\r\n                minute = minute + new Date(Date.UTC(year, month - 1, day, hour, minute)).getTimezoneOffset();\r\n                break;\r\n            }\r\n        }\r\n\r\n        //ISO8601 denotes a leap second by any time having a seconds component of 60 seconds.\r\n        //If that's the case, we need to temporarily subtract a second in order to build a UTC date.\r\n        //Then we add it back in after converting to TAI.\r\n        var isLeapSecond = second === 60;\r\n        if (isLeapSecond) {\r\n            second--;\r\n        }\r\n\r\n        //Even if we successfully parsed the string into its components, after applying UTC offset or\r\n        //special cases like 24:00:00 denoting midnight, we need to normalize the data appropriately.\r\n\r\n        //milliseconds can never be greater than 1000, and seconds can't be above 60, so we start with minutes\r\n        while (minute >= 60) {\r\n            minute -= 60;\r\n            hour++;\r\n        }\r\n\r\n        while (hour >= 24) {\r\n            hour -= 24;\r\n            day++;\r\n        }\r\n\r\n        tmp = (inLeapYear && month === 2) ? daysInLeapFeburary : daysInMonth[month - 1];\r\n        while (day > tmp) {\r\n            day -= tmp;\r\n            month++;\r\n\r\n            if (month > 12) {\r\n                month -= 12;\r\n                year++;\r\n            }\r\n\r\n            tmp = (inLeapYear && month === 2) ? daysInLeapFeburary : daysInMonth[month - 1];\r\n        }\r\n\r\n        //If UTC offset is at the beginning/end of the day, minutes can be negative.\r\n        while (minute < 0) {\r\n            minute += 60;\r\n            hour--;\r\n        }\r\n\r\n        while (hour < 0) {\r\n            hour += 24;\r\n            day--;\r\n        }\r\n\r\n        while (day < 1) {\r\n            month--;\r\n            if (month < 1) {\r\n                month += 12;\r\n                year--;\r\n            }\r\n\r\n            tmp = (inLeapYear && month === 2) ? daysInLeapFeburary : daysInMonth[month - 1];\r\n            day += tmp;\r\n        }\r\n\r\n        //Now create the JulianDate components from the Gregorian date and actually create our instance.\r\n        var components = computeJulianDateComponents(year, month, day, hour, minute, second, millisecond);\r\n\r\n        if (!defined(result)) {\r\n            result = new JulianDate(components[0], components[1], TimeStandard.UTC);\r\n        } else {\r\n            setComponents(components[0], components[1], result);\r\n            convertUtcToTai(result);\r\n        }\r\n\r\n        //If we were on a leap second, add it back.\r\n        if (isLeapSecond) {\r\n            JulianDate.addSeconds(result, 1, result);\r\n        }\r\n\r\n        return result;\r\n    };\r\n\r\n    /**\r\n     * Creates a new instance that represents the current system time.\r\n     * This is equivalent to calling <code>JulianDate.fromDate(new Date());</code>.\r\n     *\r\n     * @param {JulianDate} [result] An existing instance to use for the result.\r\n     * @returns {JulianDate} The modified result parameter or a new instance if none was provided.\r\n     */\r\n    JulianDate.now = function(result) {\r\n        return JulianDate.fromDate(new Date(), result);\r\n    };\r\n\r\n    var toGregorianDateScratch = new JulianDate(0, 0, TimeStandard.TAI);\r\n\r\n    /**\r\n     * Creates a {@link GregorianDate} from the provided instance.\r\n     *\r\n     * @param {JulianDate} julianDate The date to be converted.\r\n     * @param {GregorianDate} [result] An existing instance to use for the result.\r\n     * @returns {GregorianDate} The modified result parameter or a new instance if none was provided.\r\n     */\r\n    JulianDate.toGregorianDate = function(julianDate, result) {\r\n        //>>includeStart('debug', pragmas.debug);\r\n        if (!defined(julianDate)) {\r\n            throw new DeveloperError('julianDate is required.');\r\n        }\r\n        //>>includeEnd('debug');\r\n\r\n        var isLeapSecond = false;\r\n        var thisUtc = convertTaiToUtc(julianDate, toGregorianDateScratch);\r\n        if (!defined(thisUtc)) {\r\n            //Conversion to UTC will fail if we are during a leap second.\r\n            //If that's the case, subtract a second and convert again.\r\n            //JavaScript doesn't support leap seconds, so this results in second 59 being repeated twice.\r\n            JulianDate.addSeconds(julianDate, -1, toGregorianDateScratch);\r\n            thisUtc = convertTaiToUtc(toGregorianDateScratch, toGregorianDateScratch);\r\n            isLeapSecond = true;\r\n        }\r\n\r\n        var julianDayNumber = thisUtc.dayNumber;\r\n        var secondsOfDay = thisUtc.secondsOfDay;\r\n\r\n        if (secondsOfDay >= 43200.0) {\r\n            julianDayNumber += 1;\r\n        }\r\n\r\n        // Algorithm from page 604 of the Explanatory Supplement to the\r\n        // Astronomical Almanac (Seidelmann 1992).\r\n        var L = (julianDayNumber + 68569) | 0;\r\n        var N = (4 * L / 146097) | 0;\r\n        L = (L - (((146097 * N + 3) / 4) | 0)) | 0;\r\n        var I = ((4000 * (L + 1)) / 1461001) | 0;\r\n        L = (L - (((1461 * I) / 4) | 0) + 31) | 0;\r\n        var J = ((80 * L) / 2447) | 0;\r\n        var day = (L - (((2447 * J) / 80) | 0)) | 0;\r\n        L = (J / 11) | 0;\r\n        var month = (J + 2 - 12 * L) | 0;\r\n        var year = (100 * (N - 49) + I + L) | 0;\r\n\r\n        var hour = (secondsOfDay / TimeConstants.SECONDS_PER_HOUR) | 0;\r\n        var remainingSeconds = secondsOfDay - (hour * TimeConstants.SECONDS_PER_HOUR);\r\n        var minute = (remainingSeconds / TimeConstants.SECONDS_PER_MINUTE) | 0;\r\n        remainingSeconds = remainingSeconds - (minute * TimeConstants.SECONDS_PER_MINUTE);\r\n        var second = remainingSeconds | 0;\r\n        var millisecond = ((remainingSeconds - second) / TimeConstants.SECONDS_PER_MILLISECOND);\r\n\r\n        // JulianDates are noon-based\r\n        hour += 12;\r\n        if (hour > 23) {\r\n            hour -= 24;\r\n        }\r\n\r\n        //If we were on a leap second, add it back.\r\n        if (isLeapSecond) {\r\n            second += 1;\r\n        }\r\n\r\n        if (!defined(result)) {\r\n            return new GregorianDate(year, month, day, hour, minute, second, millisecond, isLeapSecond);\r\n        }\r\n\r\n        result.year = year;\r\n        result.month = month;\r\n        result.day = day;\r\n        result.hour = hour;\r\n        result.minute = minute;\r\n        result.second = second;\r\n        result.millisecond = millisecond;\r\n        result.isLeapSecond = isLeapSecond;\r\n        return result;\r\n    };\r\n\r\n    /**\r\n     * Creates a JavaScript Date from the provided instance.\r\n     * Since JavaScript dates are only accurate to the nearest millisecond and\r\n     * cannot represent a leap second, consider using {@link JulianDate.toGregorianDate} instead.\r\n     * If the provided JulianDate is during a leap second, the previous second is used.\r\n     *\r\n     * @param {JulianDate} julianDate The date to be converted.\r\n     * @returns {Date} A new instance representing the provided date.\r\n     */\r\n    JulianDate.toDate = function(julianDate) {\r\n        //>>includeStart('debug', pragmas.debug);\r\n        if (!defined(julianDate)) {\r\n            throw new DeveloperError('julianDate is required.');\r\n        }\r\n        //>>includeEnd('debug');\r\n\r\n        var gDate = JulianDate.toGregorianDate(julianDate, gregorianDateScratch);\r\n        var second = gDate.second;\r\n        if (gDate.isLeapSecond) {\r\n            second -= 1;\r\n        }\r\n        return new Date(Date.UTC(gDate.year, gDate.month - 1, gDate.day, gDate.hour, gDate.minute, second, gDate.millisecond));\r\n    };\r\n\r\n    /**\r\n     * Creates an ISO8601 representation of the provided date.\r\n     *\r\n     * @param {JulianDate} julianDate The date to be converted.\r\n     * @param {Number} [precision] The number of fractional digits used to represent the seconds component.  By default, the most precise representation is used.\r\n     * @returns {String} The ISO8601 representation of the provided date.\r\n     */\r\n    JulianDate.toIso8601 = function(julianDate, precision) {\r\n        //>>includeStart('debug', pragmas.debug);\r\n        if (!defined(julianDate)) {\r\n            throw new DeveloperError('julianDate is required.');\r\n        }\r\n        //>>includeEnd('debug');\r\n\r\n        var gDate = JulianDate.toGregorianDate(julianDate, gregorianDateScratch);\r\n        var year = gDate.year;\r\n        var month = gDate.month;\r\n        var day = gDate.day;\r\n        var hour = gDate.hour;\r\n        var minute = gDate.minute;\r\n        var second = gDate.second;\r\n        var millisecond = gDate.millisecond;\r\n\r\n        // special case - Iso8601.MAXIMUM_VALUE produces a string which we can't parse unless we adjust.\r\n        // 10000-01-01T00:00:00 is the same instant as 9999-12-31T24:00:00\r\n        if (year === 10000 && month === 1 && day === 1 && hour === 0 && minute === 0 && second === 0 && millisecond === 0) {\r\n            year = 9999;\r\n            month = 12;\r\n            day = 31;\r\n            hour = 24;\r\n        }\r\n\r\n        var millisecondStr;\r\n\r\n        if (!defined(precision) && millisecond !== 0) {\r\n            //Forces milliseconds into a number with at least 3 digits to whatever the default toString() precision is.\r\n            millisecondStr = (millisecond * 0.01).toString().replace('.', '');\r\n            return sprintf('%04d-%02d-%02dT%02d:%02d:%02d.%sZ', year, month, day, hour, minute, second, millisecondStr);\r\n        }\r\n\r\n        //Precision is either 0 or milliseconds is 0 with undefined precision, in either case, leave off milliseconds entirely\r\n        if (!defined(precision) || precision === 0) {\r\n            return sprintf('%04d-%02d-%02dT%02d:%02d:%02dZ', year, month, day, hour, minute, second);\r\n        }\r\n\r\n        //Forces milliseconds into a number with at least 3 digits to whatever the specified precision is.\r\n        millisecondStr = (millisecond * 0.01).toFixed(precision).replace('.', '').slice(0, precision);\r\n        return sprintf('%04d-%02d-%02dT%02d:%02d:%02d.%sZ', year, month, day, hour, minute, second, millisecondStr);\r\n    };\r\n\r\n    /**\r\n     * Duplicates a JulianDate instance.\r\n     *\r\n     * @param {JulianDate} julianDate The date to duplicate.\r\n     * @param {JulianDate} [result] An existing instance to use for the result.\r\n     * @returns {JulianDate} The modified result parameter or a new instance if none was provided. Returns undefined if julianDate is undefined.\r\n     */\r\n    JulianDate.clone = function(julianDate, result) {\r\n        if (!defined(julianDate)) {\r\n            return undefined;\r\n        }\r\n        if (!defined(result)) {\r\n            return new JulianDate(julianDate.dayNumber, julianDate.secondsOfDay, TimeStandard.TAI);\r\n        }\r\n        result.dayNumber = julianDate.dayNumber;\r\n        result.secondsOfDay = julianDate.secondsOfDay;\r\n        return result;\r\n    };\r\n\r\n    /**\r\n     * Compares two instances.\r\n     *\r\n     * @param {JulianDate} left The first instance.\r\n     * @param {JulianDate} right The second instance.\r\n     * @returns {Number} A negative value if left is less than right, a positive value if left is greater than right, or zero if left and right are equal.\r\n     */\r\n    JulianDate.compare = function(left, right) {\r\n        //>>includeStart('debug', pragmas.debug);\r\n        if (!defined(left)) {\r\n            throw new DeveloperError('left is required.');\r\n        }\r\n        if (!defined(right)) {\r\n            throw new DeveloperError('right is required.');\r\n        }\r\n        //>>includeEnd('debug');\r\n\r\n        var julianDayNumberDifference = left.dayNumber - right.dayNumber;\r\n        if (julianDayNumberDifference !== 0) {\r\n            return julianDayNumberDifference;\r\n        }\r\n        return left.secondsOfDay - right.secondsOfDay;\r\n    };\r\n\r\n    /**\r\n     * Compares two instances and returns <code>true</code> if they are equal, <code>false</code> otherwise.\r\n     *\r\n     * @param {JulianDate} [left] The first instance.\r\n     * @param {JulianDate} [right] The second instance.\r\n     * @returns {Boolean} <code>true</code> if the dates are equal; otherwise, <code>false</code>.\r\n     */\r\n    JulianDate.equals = function(left, right) {\r\n        return (left === right) ||\r\n               (defined(left) &&\r\n                defined(right) &&\r\n                left.dayNumber === right.dayNumber &&\r\n                left.secondsOfDay === right.secondsOfDay);\r\n    };\r\n\r\n    /**\r\n     * Compares two instances and returns <code>true</code> if they are within <code>epsilon</code> seconds of\r\n     * each other.  That is, in order for the dates to be considered equal (and for\r\n     * this function to return <code>true</code>), the absolute value of the difference between them, in\r\n     * seconds, must be less than <code>epsilon</code>.\r\n     *\r\n     * @param {JulianDate} [left] The first instance.\r\n     * @param {JulianDate} [right] The second instance.\r\n     * @param {Number} epsilon The maximum number of seconds that should separate the two instances.\r\n     * @returns {Boolean} <code>true</code> if the two dates are within <code>epsilon</code> seconds of each other; otherwise <code>false</code>.\r\n     */\r\n    JulianDate.equalsEpsilon = function(left, right, epsilon) {\r\n        //>>includeStart('debug', pragmas.debug);\r\n        if (!defined(epsilon)) {\r\n            throw new DeveloperError('epsilon is required.');\r\n        }\r\n        //>>includeEnd('debug');\r\n\r\n        return (left === right) ||\r\n               (defined(left) &&\r\n                defined(right) &&\r\n                Math.abs(JulianDate.secondsDifference(left, right)) <= epsilon);\r\n    };\r\n\r\n    /**\r\n     * Computes the total number of whole and fractional days represented by the provided instance.\r\n     *\r\n     * @param {JulianDate} julianDate The date.\r\n     * @returns {Number} The Julian date as single floating point number.\r\n     */\r\n    JulianDate.totalDays = function(julianDate) {\r\n        //>>includeStart('debug', pragmas.debug);\r\n        if (!defined(julianDate)) {\r\n            throw new DeveloperError('julianDate is required.');\r\n        }\r\n        //>>includeEnd('debug');\r\n        return julianDate.dayNumber + (julianDate.secondsOfDay / TimeConstants.SECONDS_PER_DAY);\r\n    };\r\n\r\n    /**\r\n     * Computes the difference in seconds between the provided instance.\r\n     *\r\n     * @param {JulianDate} left The first instance.\r\n     * @param {JulianDate} right The second instance.\r\n     * @returns {Number} The difference, in seconds, when subtracting <code>right</code> from <code>left</code>.\r\n     */\r\n    JulianDate.secondsDifference = function(left, right) {\r\n        //>>includeStart('debug', pragmas.debug);\r\n        if (!defined(left)) {\r\n            throw new DeveloperError('left is required.');\r\n        }\r\n        if (!defined(right)) {\r\n            throw new DeveloperError('right is required.');\r\n        }\r\n        //>>includeEnd('debug');\r\n\r\n        var dayDifference = (left.dayNumber - right.dayNumber) * TimeConstants.SECONDS_PER_DAY;\r\n        return (dayDifference + (left.secondsOfDay - right.secondsOfDay));\r\n    };\r\n\r\n    /**\r\n     * Computes the difference in days between the provided instance.\r\n     *\r\n     * @param {JulianDate} left The first instance.\r\n     * @param {JulianDate} right The second instance.\r\n     * @returns {Number} The difference, in days, when subtracting <code>right</code> from <code>left</code>.\r\n     */\r\n    JulianDate.daysDifference = function(left, right) {\r\n        //>>includeStart('debug', pragmas.debug);\r\n        if (!defined(left)) {\r\n            throw new DeveloperError('left is required.');\r\n        }\r\n        if (!defined(right)) {\r\n            throw new DeveloperError('right is required.');\r\n        }\r\n        //>>includeEnd('debug');\r\n\r\n        var dayDifference = (left.dayNumber - right.dayNumber);\r\n        var secondDifference = (left.secondsOfDay - right.secondsOfDay) / TimeConstants.SECONDS_PER_DAY;\r\n        return dayDifference + secondDifference;\r\n    };\r\n\r\n    /**\r\n     * Computes the number of seconds the provided instance is ahead of UTC.\r\n     *\r\n     * @param {JulianDate} julianDate The date.\r\n     * @returns {Number} The number of seconds the provided instance is ahead of UTC\r\n     */\r\n    JulianDate.computeTaiMinusUtc = function(julianDate) {\r\n        binarySearchScratchLeapSecond.julianDate = julianDate;\r\n        var leapSeconds = JulianDate.leapSeconds;\r\n        var index = binarySearch(leapSeconds, binarySearchScratchLeapSecond, compareLeapSecondDates);\r\n        if (index < 0) {\r\n            index = ~index;\r\n            --index;\r\n            if (index < 0) {\r\n                index = 0;\r\n            }\r\n        }\r\n        return leapSeconds[index].offset;\r\n    };\r\n\r\n    /**\r\n     * Adds the provided number of seconds to the provided date instance.\r\n     *\r\n     * @param {JulianDate} julianDate The date.\r\n     * @param {Number} seconds The number of seconds to add or subtract.\r\n     * @param {JulianDate} result An existing instance to use for the result.\r\n     * @returns {JulianDate} The modified result parameter.\r\n     */\r\n    JulianDate.addSeconds = function(julianDate, seconds, result) {\r\n        //>>includeStart('debug', pragmas.debug);\r\n        if (!defined(julianDate)) {\r\n            throw new DeveloperError('julianDate is required.');\r\n        }\r\n        if (!defined(seconds)) {\r\n            throw new DeveloperError('seconds is required.');\r\n        }\r\n        if (!defined(result)) {\r\n            throw new DeveloperError('result is required.');\r\n        }\r\n        //>>includeEnd('debug');\r\n\r\n        return setComponents(julianDate.dayNumber, julianDate.secondsOfDay + seconds, result);\r\n    };\r\n\r\n    /**\r\n     * Adds the provided number of minutes to the provided date instance.\r\n     *\r\n     * @param {JulianDate} julianDate The date.\r\n     * @param {Number} minutes The number of minutes to add or subtract.\r\n     * @param {JulianDate} result An existing instance to use for the result.\r\n     * @returns {JulianDate} The modified result parameter.\r\n     */\r\n    JulianDate.addMinutes = function(julianDate, minutes, result) {\r\n        //>>includeStart('debug', pragmas.debug);\r\n        if (!defined(julianDate)) {\r\n            throw new DeveloperError('julianDate is required.');\r\n        }\r\n        if (!defined(minutes)) {\r\n            throw new DeveloperError('minutes is required.');\r\n        }\r\n        if (!defined(result)) {\r\n            throw new DeveloperError('result is required.');\r\n        }\r\n        //>>includeEnd('debug');\r\n\r\n        var newSecondsOfDay = julianDate.secondsOfDay + (minutes * TimeConstants.SECONDS_PER_MINUTE);\r\n        return setComponents(julianDate.dayNumber, newSecondsOfDay, result);\r\n    };\r\n\r\n    /**\r\n     * Adds the provided number of hours to the provided date instance.\r\n     *\r\n     * @param {JulianDate} julianDate The date.\r\n     * @param {Number} hours The number of hours to add or subtract.\r\n     * @param {JulianDate} result An existing instance to use for the result.\r\n     * @returns {JulianDate} The modified result parameter.\r\n     */\r\n    JulianDate.addHours = function(julianDate, hours, result) {\r\n        //>>includeStart('debug', pragmas.debug);\r\n        if (!defined(julianDate)) {\r\n            throw new DeveloperError('julianDate is required.');\r\n        }\r\n        if (!defined(hours)) {\r\n            throw new DeveloperError('hours is required.');\r\n        }\r\n        if (!defined(result)) {\r\n            throw new DeveloperError('result is required.');\r\n        }\r\n        //>>includeEnd('debug');\r\n\r\n        var newSecondsOfDay = julianDate.secondsOfDay + (hours * TimeConstants.SECONDS_PER_HOUR);\r\n        return setComponents(julianDate.dayNumber, newSecondsOfDay, result);\r\n    };\r\n\r\n    /**\r\n     * Adds the provided number of days to the provided date instance.\r\n     *\r\n     * @param {JulianDate} julianDate The date.\r\n     * @param {Number} days The number of days to add or subtract.\r\n     * @param {JulianDate} result An existing instance to use for the result.\r\n     * @returns {JulianDate} The modified result parameter.\r\n     */\r\n    JulianDate.addDays = function(julianDate, days, result) {\r\n        //>>includeStart('debug', pragmas.debug);\r\n        if (!defined(julianDate)) {\r\n            throw new DeveloperError('julianDate is required.');\r\n        }\r\n        if (!defined(days)) {\r\n            throw new DeveloperError('days is required.');\r\n        }\r\n        if (!defined(result)) {\r\n            throw new DeveloperError('result is required.');\r\n        }\r\n        //>>includeEnd('debug');\r\n\r\n        var newJulianDayNumber = julianDate.dayNumber + days;\r\n        return setComponents(newJulianDayNumber, julianDate.secondsOfDay, result);\r\n    };\r\n\r\n    /**\r\n     * Compares the provided instances and returns <code>true</code> if <code>left</code> is earlier than <code>right</code>, <code>false</code> otherwise.\r\n     *\r\n     * @param {JulianDate} left The first instance.\r\n     * @param {JulianDate} right The second instance.\r\n     * @returns {Boolean} <code>true</code> if <code>left</code> is earlier than <code>right</code>, <code>false</code> otherwise.\r\n     */\r\n    JulianDate.lessThan = function(left, right) {\r\n        return JulianDate.compare(left, right) < 0;\r\n    };\r\n\r\n    /**\r\n     * Compares the provided instances and returns <code>true</code> if <code>left</code> is earlier than or equal to <code>right</code>, <code>false</code> otherwise.\r\n     *\r\n     * @param {JulianDate} left The first instance.\r\n     * @param {JulianDate} right The second instance.\r\n     * @returns {Boolean} <code>true</code> if <code>left</code> is earlier than or equal to <code>right</code>, <code>false</code> otherwise.\r\n     */\r\n    JulianDate.lessThanOrEquals = function(left, right) {\r\n        return JulianDate.compare(left, right) <= 0;\r\n    };\r\n\r\n    /**\r\n     * Compares the provided instances and returns <code>true</code> if <code>left</code> is later than <code>right</code>, <code>false</code> otherwise.\r\n     *\r\n     * @param {JulianDate} left The first instance.\r\n     * @param {JulianDate} right The second instance.\r\n     * @returns {Boolean} <code>true</code> if <code>left</code> is later than <code>right</code>, <code>false</code> otherwise.\r\n     */\r\n    JulianDate.greaterThan = function(left, right) {\r\n        return JulianDate.compare(left, right) > 0;\r\n    };\r\n\r\n    /**\r\n     * Compares the provided instances and returns <code>true</code> if <code>left</code> is later than or equal to <code>right</code>, <code>false</code> otherwise.\r\n     *\r\n     * @param {JulianDate} left The first instance.\r\n     * @param {JulianDate} right The second instance.\r\n     * @returns {Boolean} <code>true</code> if <code>left</code> is later than or equal to <code>right</code>, <code>false</code> otherwise.\r\n     */\r\n    JulianDate.greaterThanOrEquals = function(left, right) {\r\n        return JulianDate.compare(left, right) >= 0;\r\n    };\r\n\r\n    /**\r\n     * Duplicates this instance.\r\n     *\r\n     * @param {JulianDate} [result] An existing instance to use for the result.\r\n     * @returns {JulianDate} The modified result parameter or a new instance if none was provided.\r\n     */\r\n    JulianDate.prototype.clone = function(result) {\r\n        return JulianDate.clone(this, result);\r\n    };\r\n\r\n    /**\r\n     * Compares this and the provided instance and returns <code>true</code> if they are equal, <code>false</code> otherwise.\r\n     *\r\n     * @param {JulianDate} [right] The second instance.\r\n     * @returns {Boolean} <code>true</code> if the dates are equal; otherwise, <code>false</code>.\r\n     */\r\n    JulianDate.prototype.equals = function(right) {\r\n        return JulianDate.equals(this, right);\r\n    };\r\n\r\n    /**\r\n     * Compares this and the provided instance and returns <code>true</code> if they are within <code>epsilon</code> seconds of\r\n     * each other.  That is, in order for the dates to be considered equal (and for\r\n     * this function to return <code>true</code>), the absolute value of the difference between them, in\r\n     * seconds, must be less than <code>epsilon</code>.\r\n     *\r\n     * @param {JulianDate} [right] The second instance.\r\n     * @param {Number} epsilon The maximum number of seconds that should separate the two instances.\r\n     * @returns {Boolean} <code>true</code> if the two dates are within <code>epsilon</code> seconds of each other; otherwise <code>false</code>.\r\n     */\r\n    JulianDate.prototype.equalsEpsilon = function(right, epsilon) {\r\n        return JulianDate.equalsEpsilon(this, right, epsilon);\r\n    };\r\n\r\n    /**\r\n     * Creates a string representing this date in ISO8601 format.\r\n     *\r\n     * @returns {String} A string representing this date in ISO8601 format.\r\n     */\r\n    JulianDate.prototype.toString = function() {\r\n        return JulianDate.toIso8601(this);\r\n    };\r\n\r\n    /**\r\n     * Gets or sets the list of leap seconds used throughout Cesium.\r\n     * @memberof JulianDate\r\n     * @type {LeapSecond[]}\r\n     */\r\n    JulianDate.leapSeconds = [\r\n                               new LeapSecond(new JulianDate(2441317, 43210.0, TimeStandard.TAI), 10), // January 1, 1972 00:00:00 UTC\r\n                               new LeapSecond(new JulianDate(2441499, 43211.0, TimeStandard.TAI), 11), // July 1, 1972 00:00:00 UTC\r\n                               new LeapSecond(new JulianDate(2441683, 43212.0, TimeStandard.TAI), 12), // January 1, 1973 00:00:00 UTC\r\n                               new LeapSecond(new JulianDate(2442048, 43213.0, TimeStandard.TAI), 13), // January 1, 1974 00:00:00 UTC\r\n                               new LeapSecond(new JulianDate(2442413, 43214.0, TimeStandard.TAI), 14), // January 1, 1975 00:00:00 UTC\r\n                               new LeapSecond(new JulianDate(2442778, 43215.0, TimeStandard.TAI), 15), // January 1, 1976 00:00:00 UTC\r\n                               new LeapSecond(new JulianDate(2443144, 43216.0, TimeStandard.TAI), 16), // January 1, 1977 00:00:00 UTC\r\n                               new LeapSecond(new JulianDate(2443509, 43217.0, TimeStandard.TAI), 17), // January 1, 1978 00:00:00 UTC\r\n                               new LeapSecond(new JulianDate(2443874, 43218.0, TimeStandard.TAI), 18), // January 1, 1979 00:00:00 UTC\r\n                               new LeapSecond(new JulianDate(2444239, 43219.0, TimeStandard.TAI), 19), // January 1, 1980 00:00:00 UTC\r\n                               new LeapSecond(new JulianDate(2444786, 43220.0, TimeStandard.TAI), 20), // July 1, 1981 00:00:00 UTC\r\n                               new LeapSecond(new JulianDate(2445151, 43221.0, TimeStandard.TAI), 21), // July 1, 1982 00:00:00 UTC\r\n                               new LeapSecond(new JulianDate(2445516, 43222.0, TimeStandard.TAI), 22), // July 1, 1983 00:00:00 UTC\r\n                               new LeapSecond(new JulianDate(2446247, 43223.0, TimeStandard.TAI), 23), // July 1, 1985 00:00:00 UTC\r\n                               new LeapSecond(new JulianDate(2447161, 43224.0, TimeStandard.TAI), 24), // January 1, 1988 00:00:00 UTC\r\n                               new LeapSecond(new JulianDate(2447892, 43225.0, TimeStandard.TAI), 25), // January 1, 1990 00:00:00 UTC\r\n                               new LeapSecond(new JulianDate(2448257, 43226.0, TimeStandard.TAI), 26), // January 1, 1991 00:00:00 UTC\r\n                               new LeapSecond(new JulianDate(2448804, 43227.0, TimeStandard.TAI), 27), // July 1, 1992 00:00:00 UTC\r\n                               new LeapSecond(new JulianDate(2449169, 43228.0, TimeStandard.TAI), 28), // July 1, 1993 00:00:00 UTC\r\n                               new LeapSecond(new JulianDate(2449534, 43229.0, TimeStandard.TAI), 29), // July 1, 1994 00:00:00 UTC\r\n                               new LeapSecond(new JulianDate(2450083, 43230.0, TimeStandard.TAI), 30), // January 1, 1996 00:00:00 UTC\r\n                               new LeapSecond(new JulianDate(2450630, 43231.0, TimeStandard.TAI), 31), // July 1, 1997 00:00:00 UTC\r\n                               new LeapSecond(new JulianDate(2451179, 43232.0, TimeStandard.TAI), 32), // January 1, 1999 00:00:00 UTC\r\n                               new LeapSecond(new JulianDate(2453736, 43233.0, TimeStandard.TAI), 33), // January 1, 2006 00:00:00 UTC\r\n                               new LeapSecond(new JulianDate(2454832, 43234.0, TimeStandard.TAI), 34), // January 1, 2009 00:00:00 UTC\r\n                               new LeapSecond(new JulianDate(2456109, 43235.0, TimeStandard.TAI), 35), // July 1, 2012 00:00:00 UTC\r\n                               new LeapSecond(new JulianDate(2457204, 43236.0, TimeStandard.TAI), 36), // July 1, 2015 00:00:00 UTC\r\n                               new LeapSecond(new JulianDate(2457754, 43237.0, TimeStandard.TAI), 37)  // January 1, 2017 00:00:00 UTC\r\n                             ];\r\nexport default JulianDate;\r\n","/**\r\n * @license\r\n *\r\n * Grauw URI utilities\r\n *\r\n * See: http://hg.grauw.nl/grauw-lib/file/tip/src/uri.js\r\n *\r\n * @author Laurens Holst (http://www.grauw.nl/)\r\n *\r\n *   Copyright 2012 Laurens Holst\r\n *\r\n *   Licensed under the Apache License, Version 2.0 (the \"License\");\r\n *   you may not use this file except in compliance with the License.\r\n *   You may obtain a copy of the License at\r\n *\r\n *       http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n *   Unless required by applicable law or agreed to in writing, software\r\n *   distributed under the License is distributed on an \"AS IS\" BASIS,\r\n *   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n *   See the License for the specific language governing permissions and\r\n *   limitations under the License.\r\n *\r\n */\r\n\r\n\t/**\r\n\t * Constructs a URI object.\r\n\t * @constructor\r\n\t * @class Implementation of URI parsing and base URI resolving algorithm in RFC 3986.\r\n\t * @param {string|URI} uri A string or URI object to create the object from.\r\n\t */\r\n\tfunction URI(uri) {\r\n\t\tif (uri instanceof URI) {  // copy constructor\r\n\t\t\tthis.scheme = uri.scheme;\r\n\t\t\tthis.authority = uri.authority;\r\n\t\t\tthis.path = uri.path;\r\n\t\t\tthis.query = uri.query;\r\n\t\t\tthis.fragment = uri.fragment;\r\n\t\t} else if (uri) {  // uri is URI string or cast to string\r\n\t\t\tvar c = parseRegex.exec(uri);\r\n\t\t\tthis.scheme = c[1];\r\n\t\t\tthis.authority = c[2];\r\n\t\t\tthis.path = c[3];\r\n\t\t\tthis.query = c[4];\r\n\t\t\tthis.fragment = c[5];\r\n\t\t}\r\n\t}\r\n\t// Initial values on the prototype\r\n\tURI.prototype.scheme    = null;\r\n\tURI.prototype.authority = null;\r\n\tURI.prototype.path      = '';\r\n\tURI.prototype.query     = null;\r\n\tURI.prototype.fragment  = null;\r\n\r\n\t// Regular expression from RFC 3986 appendix B\r\n\tvar parseRegex = new RegExp('^(?:([^:/?#]+):)?(?://([^/?#]*))?([^?#]*)(?:\\\\?([^#]*))?(?:#(.*))?$');\r\n\r\n\t/**\r\n\t * Returns the scheme part of the URI.\r\n\t * In \"http://example.com:80/a/b?x#y\" this is \"http\".\r\n\t */\r\n\tURI.prototype.getScheme = function() {\r\n\t\treturn this.scheme;\r\n\t};\r\n\r\n\t/**\r\n\t * Returns the authority part of the URI.\r\n\t * In \"http://example.com:80/a/b?x#y\" this is \"example.com:80\".\r\n\t */\r\n\tURI.prototype.getAuthority = function() {\r\n\t\treturn this.authority;\r\n\t};\r\n\r\n\t/**\r\n\t * Returns the path part of the URI.\r\n\t * In \"http://example.com:80/a/b?x#y\" this is \"/a/b\".\r\n\t * In \"mailto:mike@example.com\" this is \"mike@example.com\".\r\n\t */\r\n\tURI.prototype.getPath = function() {\r\n\t\treturn this.path;\r\n\t};\r\n\r\n\t/**\r\n\t * Returns the query part of the URI.\r\n\t * In \"http://example.com:80/a/b?x#y\" this is \"x\".\r\n\t */\r\n\tURI.prototype.getQuery = function() {\r\n\t\treturn this.query;\r\n\t};\r\n\r\n\t/**\r\n\t * Returns the fragment part of the URI.\r\n\t * In \"http://example.com:80/a/b?x#y\" this is \"y\".\r\n\t */\r\n\tURI.prototype.getFragment = function() {\r\n\t\treturn this.fragment;\r\n\t};\r\n\r\n\t/**\r\n\t * Tests whether the URI is an absolute URI.\r\n\t * See RFC 3986 section 4.3.\r\n\t */\r\n\tURI.prototype.isAbsolute = function() {\r\n\t\treturn !!this.scheme && !this.fragment;\r\n\t};\r\n\r\n\t///**\r\n\t//* Extensive validation of the URI against the ABNF in RFC 3986\r\n\t//*/\r\n\t//URI.prototype.validate\r\n\r\n\t/**\r\n\t * Tests whether the URI is a same-document reference.\r\n\t * See RFC 3986 section 4.4.\r\n\t *\r\n\t * To perform more thorough comparison, you can normalise the URI objects.\r\n\t */\r\n\tURI.prototype.isSameDocumentAs = function(uri) {\r\n\t\treturn uri.scheme == this.scheme &&\r\n\t\t    uri.authority == this.authority &&\r\n\t\t         uri.path == this.path &&\r\n\t\t        uri.query == this.query;\r\n\t};\r\n\r\n\t/**\r\n\t * Simple String Comparison of two URIs.\r\n\t * See RFC 3986 section 6.2.1.\r\n\t *\r\n\t * To perform more thorough comparison, you can normalise the URI objects.\r\n\t */\r\n\tURI.prototype.equals = function(uri) {\r\n\t\treturn this.isSameDocumentAs(uri) && uri.fragment == this.fragment;\r\n\t};\r\n\r\n\t/**\r\n\t * Normalizes the URI using syntax-based normalization.\r\n\t * This includes case normalization, percent-encoding normalization and path segment normalization.\r\n\t * XXX: Percent-encoding normalization does not escape characters that need to be escaped.\r\n\t *      (Although that would not be a valid URI in the first place. See validate().)\r\n\t * See RFC 3986 section 6.2.2.\r\n\t */\r\n\tURI.prototype.normalize = function() {\r\n\t\tthis.removeDotSegments();\r\n\t\tif (this.scheme)\r\n\t\t\tthis.scheme = this.scheme.toLowerCase();\r\n\t\tif (this.authority)\r\n\t\t\tthis.authority = this.authority.replace(authorityRegex, replaceAuthority).\r\n\t\t\t\t\t\t\t\t\treplace(caseRegex, replaceCase);\r\n\t\tif (this.path)\r\n\t\t\tthis.path = this.path.replace(caseRegex, replaceCase);\r\n\t\tif (this.query)\r\n\t\t\tthis.query = this.query.replace(caseRegex, replaceCase);\r\n\t\tif (this.fragment)\r\n\t\t\tthis.fragment = this.fragment.replace(caseRegex, replaceCase);\r\n\t};\r\n\r\n\tvar caseRegex = /%[0-9a-z]{2}/gi;\r\n\tvar percentRegex = /[a-zA-Z0-9\\-\\._~]/;\r\n\tvar authorityRegex = /(.*@)?([^@:]*)(:.*)?/;\r\n\r\n\tfunction replaceCase(str) {\r\n\t\tvar dec = unescape(str);\r\n\t\treturn percentRegex.test(dec) ? dec : str.toUpperCase();\r\n\t}\r\n\r\n\tfunction replaceAuthority(str, p1, p2, p3) {\r\n\t\treturn (p1 || '') + p2.toLowerCase() + (p3 || '');\r\n\t}\r\n\r\n\t/**\r\n\t * Resolve a relative URI (this) against a base URI.\r\n\t * The base URI must be an absolute URI.\r\n\t * See RFC 3986 section 5.2\r\n\t */\r\n\tURI.prototype.resolve = function(baseURI) {\r\n\t\tvar uri = new URI();\r\n\t\tif (this.scheme) {\r\n\t\t\turi.scheme = this.scheme;\r\n\t\t\turi.authority = this.authority;\r\n\t\t\turi.path = this.path;\r\n\t\t\turi.query = this.query;\r\n\t\t} else {\r\n\t\t\turi.scheme = baseURI.scheme;\r\n\t\t\tif (this.authority) {\r\n\t\t\t\turi.authority = this.authority;\r\n\t\t\t\turi.path = this.path;\r\n\t\t\t\turi.query = this.query;\r\n\t\t\t} else {\r\n\t\t\t\turi.authority = baseURI.authority;\r\n\t\t\t\tif (this.path == '') {\r\n\t\t\t\t\turi.path = baseURI.path;\r\n\t\t\t\t\turi.query = this.query || baseURI.query;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (this.path.charAt(0) == '/') {\r\n\t\t\t\t\t\turi.path = this.path;\r\n\t\t\t\t\t\turi.removeDotSegments();\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tif (baseURI.authority && baseURI.path == '') {\r\n\t\t\t\t\t\t\turi.path = '/' + this.path;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\turi.path = baseURI.path.substring(0, baseURI.path.lastIndexOf('/') + 1) + this.path;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\turi.removeDotSegments();\r\n\t\t\t\t\t}\r\n\t\t\t\t\turi.query = this.query;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\turi.fragment = this.fragment;\r\n\t\treturn uri;\r\n\t};\r\n\r\n\t/**\r\n\t * Remove dot segments from path.\r\n\t * See RFC 3986 section 5.2.4\r\n\t * @private\r\n\t */\r\n\tURI.prototype.removeDotSegments = function() {\r\n\t\tvar input = this.path.split('/'),\r\n\t\t\toutput = [],\r\n\t\t\tsegment,\r\n\t\t\tabsPath = input[0] == '';\r\n\t\tif (absPath)\r\n\t\t\tinput.shift();\r\n\t\tvar sFirst = input[0] == '' ? input.shift() : null;\r\n\t\twhile (input.length) {\r\n\t\t\tsegment = input.shift();\r\n\t\t\tif (segment == '..') {\r\n\t\t\t\toutput.pop();\r\n\t\t\t} else if (segment != '.') {\r\n\t\t\t\toutput.push(segment);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (segment == '.' || segment == '..')\r\n\t\t\toutput.push('');\r\n\t\tif (absPath)\r\n\t\t\toutput.unshift('');\r\n\t\tthis.path = output.join('/');\r\n\t};\r\n\r\n\t// We don't like this function because it builds up a cache that is never cleared.\r\n//\t/**\r\n//\t * Resolves a relative URI against an absolute base URI.\r\n//\t * Convenience method.\r\n//\t * @param {String} uri the relative URI to resolve\r\n//\t * @param {String} baseURI the base URI (must be absolute) to resolve against\r\n//\t */\r\n//\tURI.resolve = function(sURI, sBaseURI) {\r\n//\t\tvar uri = cache[sURI] || (cache[sURI] = new URI(sURI));\r\n//\t\tvar baseURI = cache[sBaseURI] || (cache[sBaseURI] = new URI(sBaseURI));\r\n//\t\treturn uri.resolve(baseURI).toString();\r\n//\t};\r\n\r\n//\tvar cache = {};\r\n\r\n\t/**\r\n\t * Serialises the URI to a string.\r\n\t */\r\n\tURI.prototype.toString = function() {\r\n\t\tvar result = '';\r\n\t\tif (this.scheme)\r\n\t\t\tresult += this.scheme + ':';\r\n\t\tif (this.authority)\r\n\t\t\tresult += '//' + this.authority;\r\n\t\tresult += this.path;\r\n\t\tif (this.query)\r\n\t\t\tresult += '?' + this.query;\r\n\t\tif (this.fragment)\r\n\t\t\tresult += '#' + this.fragment;\r\n\t\treturn result;\r\n\t};\r\n\r\nexport default URI;\r\n","import defaultValue from './defaultValue.js';\r\n\r\n    /**\r\n     * Clones an object, returning a new object containing the same properties.\r\n     *\r\n     * @exports clone\r\n     *\r\n     * @param {Object} object The object to clone.\r\n     * @param {Boolean} [deep=false] If true, all properties will be deep cloned recursively.\r\n     * @returns {Object} The cloned object.\r\n     */\r\n    function clone(object, deep) {\r\n        if (object === null || typeof object !== 'object') {\r\n            return object;\r\n        }\r\n\r\n        deep = defaultValue(deep, false);\r\n\r\n        var result = new object.constructor();\r\n        for ( var propertyName in object) {\r\n            if (object.hasOwnProperty(propertyName)) {\r\n                var value = object[propertyName];\r\n                if (deep) {\r\n                    value = clone(value, deep);\r\n                }\r\n                result[propertyName] = value;\r\n            }\r\n        }\r\n\r\n        return result;\r\n    }\r\nexport default clone;\r\n","import defaultValue from './defaultValue.js';\r\nimport defined from './defined.js';\r\n\r\n    /**\r\n     * Merges two objects, copying their properties onto a new combined object. When two objects have the same\r\n     * property, the value of the property on the first object is used.  If either object is undefined,\r\n     * it will be treated as an empty object.\r\n     *\r\n     * @example\r\n     * var object1 = {\r\n     *     propOne : 1,\r\n     *     propTwo : {\r\n     *         value1 : 10\r\n     *     }\r\n     * }\r\n     * var object2 = {\r\n     *     propTwo : 2\r\n     * }\r\n     * var final = Cesium.combine(object1, object2);\r\n     *\r\n     * // final === {\r\n     * //     propOne : 1,\r\n     * //     propTwo : {\r\n     * //         value1 : 10\r\n     * //     }\r\n     * // }\r\n     *\r\n     * @param {Object} [object1] The first object to merge.\r\n     * @param {Object} [object2] The second object to merge.\r\n     * @param {Boolean} [deep=false] Perform a recursive merge.\r\n     * @returns {Object} The combined object containing all properties from both objects.\r\n     *\r\n     * @exports combine\r\n     */\r\n    function combine(object1, object2, deep) {\r\n        deep = defaultValue(deep, false);\r\n\r\n        var result = {};\r\n\r\n        var object1Defined = defined(object1);\r\n        var object2Defined = defined(object2);\r\n        var property;\r\n        var object1Value;\r\n        var object2Value;\r\n        if (object1Defined) {\r\n            for (property in object1) {\r\n                if (object1.hasOwnProperty(property)) {\r\n                    object1Value = object1[property];\r\n                    if (object2Defined && deep && typeof object1Value === 'object' && object2.hasOwnProperty(property)) {\r\n                        object2Value = object2[property];\r\n                        if (typeof object2Value === 'object') {\r\n                            result[property] = combine(object1Value, object2Value, deep);\r\n                        } else {\r\n                            result[property] = object1Value;\r\n                        }\r\n                    } else {\r\n                        result[property] = object1Value;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        if (object2Defined) {\r\n            for (property in object2) {\r\n                if (object2.hasOwnProperty(property) && !result.hasOwnProperty(property)) {\r\n                    object2Value = object2[property];\r\n                    result[property] = object2Value;\r\n                }\r\n            }\r\n        }\r\n        return result;\r\n    }\r\nexport default combine;\r\n","import Uri from '../ThirdParty/Uri.js';\r\nimport defaultValue from './defaultValue.js';\r\nimport defined from './defined.js';\r\nimport DeveloperError from './DeveloperError.js';\r\n\r\n    /**\r\n     * Given a relative Uri and a base Uri, returns the absolute Uri of the relative Uri.\r\n     * @exports getAbsoluteUri\r\n     *\r\n     * @param {String} relative The relative Uri.\r\n     * @param {String} [base] The base Uri.\r\n     * @returns {String} The absolute Uri of the given relative Uri.\r\n     *\r\n     * @example\r\n     * //absolute Uri will be \"https://test.com/awesome.png\";\r\n     * var absoluteUri = Cesium.getAbsoluteUri('awesome.png', 'https://test.com');\r\n     */\r\n    function getAbsoluteUri(relative, base) {\r\n        var documentObject;\r\n        if (typeof document !== 'undefined') {\r\n            documentObject = document;\r\n        }\r\n\r\n        return getAbsoluteUri._implementation(relative, base, documentObject);\r\n    }\r\n\r\n    getAbsoluteUri._implementation = function(relative, base, documentObject) {\r\n        //>>includeStart('debug', pragmas.debug);\r\n        if (!defined(relative)) {\r\n            throw new DeveloperError('relative uri is required.');\r\n        }\r\n        //>>includeEnd('debug');\r\n\r\n        if (!defined(base)) {\r\n            if (typeof documentObject === 'undefined') {\r\n                return relative;\r\n            }\r\n            base = defaultValue(documentObject.baseURI, documentObject.location.href);\r\n        }\r\n\r\n        var baseUri = new Uri(base);\r\n        var relativeUri = new Uri(relative);\r\n        return relativeUri.resolve(baseUri).toString();\r\n    };\r\nexport default getAbsoluteUri;\r\n","import Check from './Check.js';\r\n\r\n    var blobUriRegex = /^blob:/i;\r\n\r\n    /**\r\n     * Determines if the specified uri is a blob uri.\r\n     *\r\n     * @exports isBlobUri\r\n     *\r\n     * @param {String} uri The uri to test.\r\n     * @returns {Boolean} true when the uri is a blob uri; otherwise, false.\r\n     *\r\n     * @private\r\n     */\r\n    function isBlobUri(uri) {\r\n        //>>includeStart('debug', pragmas.debug);\r\n        Check.typeOf.string('uri', uri);\r\n        //>>includeEnd('debug');\r\n\r\n        return blobUriRegex.test(uri);\r\n    }\r\nexport default isBlobUri;\r\n","import defined from './defined.js';\r\n\r\n    var a;\r\n\r\n    /**\r\n     * Given a URL, determine whether that URL is considered cross-origin to the current page.\r\n     *\r\n     * @private\r\n     */\r\n    function isCrossOriginUrl(url) {\r\n        if (!defined(a)) {\r\n            a = document.createElement('a');\r\n        }\r\n\r\n        // copy window location into the anchor to get consistent results\r\n        // when the port is default for the protocol (e.g. 80 for HTTP)\r\n        a.href = window.location.href;\r\n\r\n        // host includes both hostname and port if the port is not standard\r\n        var host = a.host;\r\n        var protocol = a.protocol;\r\n\r\n        a.href = url;\r\n        // IE only absolutizes href on get, not set\r\n        a.href = a.href; // eslint-disable-line no-self-assign\r\n\r\n        return protocol !== a.protocol || host !== a.host;\r\n    }\r\nexport default isCrossOriginUrl;\r\n","import Check from './Check.js';\r\n\r\n    var dataUriRegex = /^data:/i;\r\n\r\n    /**\r\n     * Determines if the specified uri is a data uri.\r\n     *\r\n     * @exports isDataUri\r\n     *\r\n     * @param {String} uri The uri to test.\r\n     * @returns {Boolean} true when the uri is a data uri; otherwise, false.\r\n     *\r\n     * @private\r\n     */\r\n    function isDataUri(uri) {\r\n        //>>includeStart('debug', pragmas.debug);\r\n        Check.typeOf.string('uri', uri);\r\n        //>>includeEnd('debug');\r\n\r\n        return dataUriRegex.test(uri);\r\n    }\r\nexport default isDataUri;\r\n","\r\n    /**\r\n     * State of the request.\r\n     *\r\n     * @exports RequestState\r\n     */\r\n    var RequestState = {\r\n        /**\r\n         * Initial unissued state.\r\n         *\r\n         * @type Number\r\n         * @constant\r\n         */\r\n        UNISSUED : 0,\r\n\r\n        /**\r\n         * Issued but not yet active. Will become active when open slots are available.\r\n         *\r\n         * @type Number\r\n         * @constant\r\n         */\r\n        ISSUED : 1,\r\n\r\n        /**\r\n         * Actual http request has been sent.\r\n         *\r\n         * @type Number\r\n         * @constant\r\n         */\r\n        ACTIVE : 2,\r\n\r\n        /**\r\n         * Request completed successfully.\r\n         *\r\n         * @type Number\r\n         * @constant\r\n         */\r\n        RECEIVED : 3,\r\n\r\n        /**\r\n         * Request was cancelled, either explicitly or automatically because of low priority.\r\n         *\r\n         * @type Number\r\n         * @constant\r\n         */\r\n        CANCELLED : 4,\r\n\r\n        /**\r\n         * Request failed.\r\n         *\r\n         * @type Number\r\n         * @constant\r\n         */\r\n        FAILED : 5\r\n    };\r\nexport default Object.freeze(RequestState);\r\n","\r\n    /**\r\n     * An enum identifying the type of request. Used for finer grained logging and priority sorting.\r\n     *\r\n     * @exports RequestType\r\n     */\r\n    var RequestType = {\r\n        /**\r\n         * Terrain request.\r\n         *\r\n         * @type Number\r\n         * @constant\r\n         */\r\n        TERRAIN : 0,\r\n\r\n        /**\r\n         * Imagery request.\r\n         *\r\n         * @type Number\r\n         * @constant\r\n         */\r\n        IMAGERY : 1,\r\n\r\n        /**\r\n         * 3D Tiles request.\r\n         *\r\n         * @type Number\r\n         * @constant\r\n         */\r\n        TILES3D : 2,\r\n\r\n        /**\r\n         * Other request.\r\n         *\r\n         * @type Number\r\n         * @constant\r\n         */\r\n        OTHER : 3\r\n    };\r\nexport default Object.freeze(RequestType);\r\n","import defaultValue from './defaultValue.js';\r\nimport defined from './defined.js';\r\nimport RequestState from './RequestState.js';\r\nimport RequestType from './RequestType.js';\r\n\r\n    /**\r\n     * Stores information for making a request. In general this does not need to be constructed directly.\r\n     *\r\n     * @alias Request\r\n     * @constructor\r\n     * @namespace\r\n     * @exports Request\r\n     * @param {Object} [options] An object with the following properties:\r\n     * @param {String} [options.url] The url to request.\r\n     * @param {Request~RequestCallback} [options.requestFunction] The function that makes the actual data request.\r\n     * @param {Request~CancelCallback} [options.cancelFunction] The function that is called when the request is cancelled.\r\n     * @param {Request~PriorityCallback} [options.priorityFunction] The function that is called to update the request's priority, which occurs once per frame.\r\n     * @param {Number} [options.priority=0.0] The initial priority of the request.\r\n     * @param {Boolean} [options.throttle=false] Whether to throttle and prioritize the request. If false, the request will be sent immediately. If true, the request will be throttled and sent based on priority.\r\n     * @param {Boolean} [options.throttleByServer=false] Whether to throttle the request by server.\r\n     * @param {RequestType} [options.type=RequestType.OTHER] The type of request.\r\n     */\r\n    function Request(options) {\r\n        options = defaultValue(options, defaultValue.EMPTY_OBJECT);\r\n\r\n        var throttleByServer = defaultValue(options.throttleByServer, false);\r\n        var throttle = defaultValue(options.throttle, false);\r\n\r\n        /**\r\n         * The URL to request.\r\n         *\r\n         * @type {String}\r\n         */\r\n        this.url = options.url;\r\n\r\n        /**\r\n         * The function that makes the actual data request.\r\n         *\r\n         * @type {Request~RequestCallback}\r\n         */\r\n        this.requestFunction = options.requestFunction;\r\n\r\n        /**\r\n         * The function that is called when the request is cancelled.\r\n         *\r\n         * @type {Request~CancelCallback}\r\n         */\r\n        this.cancelFunction = options.cancelFunction;\r\n\r\n        /**\r\n         * The function that is called to update the request's priority, which occurs once per frame.\r\n         *\r\n         * @type {Request~PriorityCallback}\r\n         */\r\n        this.priorityFunction = options.priorityFunction;\r\n\r\n        /**\r\n         * Priority is a unit-less value where lower values represent higher priority.\r\n         * For world-based objects, this is usually the distance from the camera.\r\n         * A request that does not have a priority function defaults to a priority of 0.\r\n         *\r\n         * If priorityFunction is defined, this value is updated every frame with the result of that call.\r\n         *\r\n         * @type {Number}\r\n         * @default 0.0\r\n         */\r\n        this.priority = defaultValue(options.priority, 0.0);\r\n\r\n        /**\r\n         * Whether to throttle and prioritize the request. If false, the request will be sent immediately. If true, the\r\n         * request will be throttled and sent based on priority.\r\n         *\r\n         * @type {Boolean}\r\n         * @readonly\r\n         *\r\n         * @default false\r\n         */\r\n        this.throttle = throttle;\r\n\r\n        /**\r\n         * Whether to throttle the request by server. Browsers typically support about 6-8 parallel connections\r\n         * for HTTP/1 servers, and an unlimited amount of connections for HTTP/2 servers. Setting this value\r\n         * to <code>true</code> is preferable for requests going through HTTP/1 servers.\r\n         *\r\n         * @type {Boolean}\r\n         * @readonly\r\n         *\r\n         * @default false\r\n         */\r\n        this.throttleByServer = throttleByServer;\r\n\r\n        /**\r\n         * Type of request.\r\n         *\r\n         * @type {RequestType}\r\n         * @readonly\r\n         *\r\n         * @default RequestType.OTHER\r\n         */\r\n        this.type = defaultValue(options.type, RequestType.OTHER);\r\n\r\n        /**\r\n         * A key used to identify the server that a request is going to. It is derived from the url's authority and scheme.\r\n         *\r\n         * @type {String}\r\n         *\r\n         * @private\r\n         */\r\n        this.serverKey = undefined;\r\n\r\n        /**\r\n         * The current state of the request.\r\n         *\r\n         * @type {RequestState}\r\n         * @readonly\r\n         */\r\n        this.state = RequestState.UNISSUED;\r\n\r\n        /**\r\n         * The requests's deferred promise.\r\n         *\r\n         * @type {Object}\r\n         *\r\n         * @private\r\n         */\r\n        this.deferred = undefined;\r\n\r\n        /**\r\n         * Whether the request was explicitly cancelled.\r\n         *\r\n         * @type {Boolean}\r\n         *\r\n         * @private\r\n         */\r\n        this.cancelled = false;\r\n    }\r\n\r\n    /**\r\n     * Mark the request as cancelled.\r\n     *\r\n     * @private\r\n     */\r\n    Request.prototype.cancel = function() {\r\n        this.cancelled = true;\r\n    };\r\n\r\n    /**\r\n     * Duplicates a Request instance.\r\n     *\r\n     * @param {Request} [result] The object onto which to store the result.\r\n     *\r\n     * @returns {Request} The modified result parameter or a new Resource instance if one was not provided.\r\n     */\r\n    Request.prototype.clone = function(result) {\r\n        if (!defined(result)) {\r\n            return new Request(this);\r\n        }\r\n\r\n        result.url = this.url;\r\n        result.requestFunction = this.requestFunction;\r\n        result.cancelFunction = this.cancelFunction;\r\n        result.priorityFunction = this.priorityFunction;\r\n        result.priority = this.priority;\r\n        result.throttle = this.throttle;\r\n        result.throttleByServer = this.throttleByServer;\r\n        result.type = this.type;\r\n        result.serverKey = this.serverKey;\r\n\r\n        // These get defaulted because the cloned request hasn't been issued\r\n        result.state = this.RequestState.UNISSUED;\r\n        result.deferred = undefined;\r\n        result.cancelled = false;\r\n\r\n        return result;\r\n    };\r\n\r\n    /**\r\n     * The function that makes the actual data request.\r\n     * @callback Request~RequestCallback\r\n     * @returns {Promise} A promise for the requested data.\r\n     */\r\n\r\n    /**\r\n     * The function that is called when the request is cancelled.\r\n     * @callback Request~CancelCallback\r\n     */\r\n\r\n    /**\r\n     * The function that is called to update the request's priority, which occurs once per frame.\r\n     * @callback Request~PriorityCallback\r\n     * @returns {Number} The updated priority value.\r\n     */\r\nexport default Request;\r\n","import defined from './defined.js';\r\nimport parseResponseHeaders from './parseResponseHeaders.js';\r\n\r\n    /**\r\n     * An event that is raised when a request encounters an error.\r\n     *\r\n     * @constructor\r\n     * @alias RequestErrorEvent\r\n     *\r\n     * @param {Number} [statusCode] The HTTP error status code, such as 404.\r\n     * @param {Object} [response] The response included along with the error.\r\n     * @param {String|Object} [responseHeaders] The response headers, represented either as an object literal or as a\r\n     *                        string in the format returned by XMLHttpRequest's getAllResponseHeaders() function.\r\n     */\r\n    function RequestErrorEvent(statusCode, response, responseHeaders) {\r\n        /**\r\n         * The HTTP error status code, such as 404.  If the error does not have a particular\r\n         * HTTP code, this property will be undefined.\r\n         *\r\n         * @type {Number}\r\n         */\r\n        this.statusCode = statusCode;\r\n\r\n        /**\r\n         * The response included along with the error.  If the error does not include a response,\r\n         * this property will be undefined.\r\n         *\r\n         * @type {Object}\r\n         */\r\n        this.response = response;\r\n\r\n        /**\r\n         * The headers included in the response, represented as an object literal of key/value pairs.\r\n         * If the error does not include any headers, this property will be undefined.\r\n         *\r\n         * @type {Object}\r\n         */\r\n        this.responseHeaders = responseHeaders;\r\n\r\n        if (typeof this.responseHeaders === 'string') {\r\n            this.responseHeaders = parseResponseHeaders(this.responseHeaders);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Creates a string representing this RequestErrorEvent.\r\n     * @memberof RequestErrorEvent\r\n     *\r\n     * @returns {String} A string representing the provided RequestErrorEvent.\r\n     */\r\n    RequestErrorEvent.prototype.toString = function() {\r\n        var str = 'Request has failed.';\r\n        if (defined(this.statusCode)) {\r\n            str += ' Status Code: ' + this.statusCode;\r\n        }\r\n        return str;\r\n    };\r\nexport default RequestErrorEvent;\r\n","\r\n    /**\r\n     * Parses the result of XMLHttpRequest's getAllResponseHeaders() method into\r\n     * a dictionary.\r\n     *\r\n     * @exports parseResponseHeaders\r\n     *\r\n     * @param {String} headerString The header string returned by getAllResponseHeaders().  The format is\r\n     *                 described here: http://www.w3.org/TR/XMLHttpRequest/#the-getallresponseheaders()-method\r\n     * @returns {Object} A dictionary of key/value pairs, where each key is the name of a header and the corresponding value\r\n     *                   is that header's value.\r\n     *\r\n     * @private\r\n     */\r\n    function parseResponseHeaders(headerString) {\r\n        var headers = {};\r\n\r\n        if (!headerString) {\r\n          return headers;\r\n        }\r\n\r\n        var headerPairs = headerString.split('\\u000d\\u000a');\r\n\r\n        for (var i = 0; i < headerPairs.length; ++i) {\r\n          var headerPair = headerPairs[i];\r\n          // Can't use split() here because it does the wrong thing\r\n          // if the header value has the string \": \" in it.\r\n          var index = headerPair.indexOf('\\u003a\\u0020');\r\n          if (index > 0) {\r\n            var key = headerPair.substring(0, index);\r\n            var val = headerPair.substring(index + 2);\r\n            headers[key] = val;\r\n          }\r\n        }\r\n\r\n        return headers;\r\n    }\r\nexport default parseResponseHeaders;\r\n","import Check from './Check.js';\r\nimport defined from './defined.js';\r\n\r\n    /**\r\n     * A generic utility class for managing subscribers for a particular event.\r\n     * This class is usually instantiated inside of a container class and\r\n     * exposed as a property for others to subscribe to.\r\n     *\r\n     * @alias Event\r\n     * @constructor\r\n     * @example\r\n     * MyObject.prototype.myListener = function(arg1, arg2) {\r\n     *     this.myArg1Copy = arg1;\r\n     *     this.myArg2Copy = arg2;\r\n     * }\r\n     *\r\n     * var myObjectInstance = new MyObject();\r\n     * var evt = new Cesium.Event();\r\n     * evt.addEventListener(MyObject.prototype.myListener, myObjectInstance);\r\n     * evt.raiseEvent('1', '2');\r\n     * evt.removeEventListener(MyObject.prototype.myListener);\r\n     */\r\n    function Event() {\r\n        this._listeners = [];\r\n        this._scopes = [];\r\n        this._toRemove = [];\r\n        this._insideRaiseEvent = false;\r\n    }\r\n\r\n    Object.defineProperties(Event.prototype, {\r\n        /**\r\n         * The number of listeners currently subscribed to the event.\r\n         * @memberof Event.prototype\r\n         * @type {Number}\r\n         * @readonly\r\n         */\r\n        numberOfListeners : {\r\n            get : function() {\r\n                return this._listeners.length - this._toRemove.length;\r\n            }\r\n        }\r\n    });\r\n\r\n    /**\r\n     * Registers a callback function to be executed whenever the event is raised.\r\n     * An optional scope can be provided to serve as the <code>this</code> pointer\r\n     * in which the function will execute.\r\n     *\r\n     * @param {Function} listener The function to be executed when the event is raised.\r\n     * @param {Object} [scope] An optional object scope to serve as the <code>this</code>\r\n     *        pointer in which the listener function will execute.\r\n     * @returns {Event~RemoveCallback} A function that will remove this event listener when invoked.\r\n     *\r\n     * @see Event#raiseEvent\r\n     * @see Event#removeEventListener\r\n     */\r\n    Event.prototype.addEventListener = function(listener, scope) {\r\n        //>>includeStart('debug', pragmas.debug);\r\n        Check.typeOf.func('listener', listener);\r\n        //>>includeEnd('debug');\r\n\r\n        this._listeners.push(listener);\r\n        this._scopes.push(scope);\r\n\r\n        var event = this;\r\n        return function() {\r\n            event.removeEventListener(listener, scope);\r\n        };\r\n    };\r\n\r\n    /**\r\n     * Unregisters a previously registered callback.\r\n     *\r\n     * @param {Function} listener The function to be unregistered.\r\n     * @param {Object} [scope] The scope that was originally passed to addEventListener.\r\n     * @returns {Boolean} <code>true</code> if the listener was removed; <code>false</code> if the listener and scope are not registered with the event.\r\n     *\r\n     * @see Event#addEventListener\r\n     * @see Event#raiseEvent\r\n     */\r\n    Event.prototype.removeEventListener = function(listener, scope) {\r\n        //>>includeStart('debug', pragmas.debug);\r\n        Check.typeOf.func('listener', listener);\r\n        //>>includeEnd('debug');\r\n\r\n        var listeners = this._listeners;\r\n        var scopes = this._scopes;\r\n\r\n        var index = -1;\r\n        for (var i = 0; i < listeners.length; i++) {\r\n            if (listeners[i] === listener && scopes[i] === scope) {\r\n                index = i;\r\n                break;\r\n            }\r\n        }\r\n\r\n        if (index !== -1) {\r\n            if (this._insideRaiseEvent) {\r\n                //In order to allow removing an event subscription from within\r\n                //a callback, we don't actually remove the items here.  Instead\r\n                //remember the index they are at and undefined their value.\r\n                this._toRemove.push(index);\r\n                listeners[index] = undefined;\r\n                scopes[index] = undefined;\r\n            } else {\r\n                listeners.splice(index, 1);\r\n                scopes.splice(index, 1);\r\n            }\r\n            return true;\r\n        }\r\n\r\n        return false;\r\n    };\r\n\r\n    function compareNumber(a,b) {\r\n        return b - a;\r\n    }\r\n\r\n    /**\r\n     * Raises the event by calling each registered listener with all supplied arguments.\r\n     *\r\n     * @param {*} arguments This method takes any number of parameters and passes them through to the listener functions.\r\n     *\r\n     * @see Event#addEventListener\r\n     * @see Event#removeEventListener\r\n     */\r\n    Event.prototype.raiseEvent = function() {\r\n        this._insideRaiseEvent = true;\r\n\r\n        var i;\r\n        var listeners = this._listeners;\r\n        var scopes = this._scopes;\r\n        var length = listeners.length;\r\n\r\n        for (i = 0; i < length; i++) {\r\n            var listener = listeners[i];\r\n            if (defined(listener)) {\r\n                listeners[i].apply(scopes[i], arguments);\r\n            }\r\n        }\r\n\r\n        //Actually remove items removed in removeEventListener.\r\n        var toRemove = this._toRemove;\r\n        length = toRemove.length;\r\n        if (length > 0) {\r\n            toRemove.sort(compareNumber);\r\n            for (i = 0; i < length; i++) {\r\n                var index = toRemove[i];\r\n                listeners.splice(index, 1);\r\n                scopes.splice(index, 1);\r\n            }\r\n            toRemove.length = 0;\r\n        }\r\n\r\n        this._insideRaiseEvent = false;\r\n    };\r\n\r\n    /**\r\n     * A function that removes a listener.\r\n     * @callback Event~RemoveCallback\r\n     */\r\nexport default Event;\r\n","import Check from './Check.js';\r\nimport defaultValue from './defaultValue.js';\r\nimport defined from './defined.js';\r\n\r\n    /**\r\n     * Array implementation of a heap.\r\n     *\r\n     * @alias Heap\r\n     * @constructor\r\n     * @private\r\n     *\r\n     * @param {Object} options Object with the following properties:\r\n     * @param {Heap~ComparatorCallback} options.comparator The comparator to use for the heap. If comparator(a, b) is less than 0, sort a to a lower index than b, otherwise sort to a higher index.\r\n     */\r\n    function Heap(options) {\r\n        //>>includeStart('debug', pragmas.debug);\r\n        Check.typeOf.object('options', options);\r\n        Check.defined('options.comparator', options.comparator);\r\n        //>>includeEnd('debug');\r\n\r\n        this._comparator = options.comparator;\r\n        this._array = [];\r\n        this._length = 0;\r\n        this._maximumLength = undefined;\r\n    }\r\n\r\n    Object.defineProperties(Heap.prototype, {\r\n        /**\r\n         * Gets the length of the heap.\r\n         *\r\n         * @memberof Heap.prototype\r\n         *\r\n         * @type {Number}\r\n         * @readonly\r\n         */\r\n        length : {\r\n            get : function() {\r\n                return this._length;\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Gets the internal array.\r\n         *\r\n         * @memberof Heap.prototype\r\n         *\r\n         * @type {Array}\r\n         * @readonly\r\n         */\r\n        internalArray : {\r\n            get : function() {\r\n                return this._array;\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Gets and sets the maximum length of the heap.\r\n         *\r\n         * @memberof Heap.prototype\r\n         *\r\n         * @type {Number}\r\n         */\r\n        maximumLength : {\r\n            get : function() {\r\n                return this._maximumLength;\r\n            },\r\n            set : function(value) {\r\n                this._maximumLength = value;\r\n                if (this._length > value && value > 0) {\r\n                    this._length = value;\r\n                    this._array.length = value;\r\n                }\r\n            }\r\n        },\r\n\r\n        /**\r\n         * The comparator to use for the heap. If comparator(a, b) is less than 0, sort a to a lower index than b, otherwise sort to a higher index.\r\n         *\r\n         * @memberof Heap.prototype\r\n         *\r\n         * @type {Heap~ComparatorCallback}\r\n         */\r\n        comparator : {\r\n            get : function() {\r\n                return this._comparator;\r\n            }\r\n        }\r\n    });\r\n\r\n    function swap(array, a, b) {\r\n        var temp = array[a];\r\n        array[a] = array[b];\r\n        array[b] = temp;\r\n    }\r\n\r\n    /**\r\n     * Resizes the internal array of the heap.\r\n     *\r\n     * @param {Number} [length] The length to resize internal array to. Defaults to the current length of the heap.\r\n     */\r\n    Heap.prototype.reserve = function(length) {\r\n        length = defaultValue(length, this._length);\r\n        this._array.length = length;\r\n    };\r\n\r\n    /**\r\n     * Update the heap so that index and all descendants satisfy the heap property.\r\n     *\r\n     * @param {Number} [index=0] The starting index to heapify from.\r\n     */\r\n    Heap.prototype.heapify = function(index) {\r\n        index = defaultValue(index, 0);\r\n        var length = this._length;\r\n        var comparator = this._comparator;\r\n        var array = this._array;\r\n        var candidate = -1;\r\n        var inserting = true;\r\n\r\n        while (inserting) {\r\n            var right = 2 * (index + 1);\r\n            var left = right - 1;\r\n\r\n            if (left < length && comparator(array[left], array[index]) < 0) {\r\n                candidate = left;\r\n            } else {\r\n                candidate = index;\r\n            }\r\n\r\n            if (right < length && comparator(array[right], array[candidate]) < 0) {\r\n                candidate = right;\r\n            }\r\n            if (candidate !== index) {\r\n                swap(array, candidate, index);\r\n                index = candidate;\r\n            } else {\r\n                inserting = false;\r\n            }\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Resort the heap.\r\n     */\r\n    Heap.prototype.resort = function() {\r\n        var length = this._length;\r\n        for (var i = Math.ceil(length / 2); i >= 0; --i) {\r\n            this.heapify(i);\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Insert an element into the heap. If the length would grow greater than maximumLength\r\n     * of the heap, extra elements are removed.\r\n     *\r\n     * @param {*} element The element to insert\r\n     *\r\n     * @return {*} The element that was removed from the heap if the heap is at full capacity.\r\n     */\r\n    Heap.prototype.insert = function(element) {\r\n        //>>includeStart('debug', pragmas.debug);\r\n        Check.defined('element', element);\r\n        //>>includeEnd('debug');\r\n\r\n        var array = this._array;\r\n        var comparator = this._comparator;\r\n        var maximumLength = this._maximumLength;\r\n\r\n        var index = this._length++;\r\n        if (index < array.length) {\r\n            array[index] = element;\r\n        } else {\r\n            array.push(element);\r\n        }\r\n\r\n        while (index !== 0) {\r\n            var parent = Math.floor((index - 1) / 2);\r\n            if (comparator(array[index], array[parent]) < 0) {\r\n                swap(array, index, parent);\r\n                index = parent;\r\n            } else {\r\n                break;\r\n            }\r\n        }\r\n\r\n        var removedElement;\r\n\r\n        if (defined(maximumLength) && (this._length > maximumLength)) {\r\n            removedElement = array[maximumLength];\r\n            this._length = maximumLength;\r\n        }\r\n\r\n        return removedElement;\r\n    };\r\n\r\n    /**\r\n     * Remove the element specified by index from the heap and return it.\r\n     *\r\n     * @param {Number} [index=0] The index to remove.\r\n     * @returns {*} The specified element of the heap.\r\n     */\r\n    Heap.prototype.pop = function(index) {\r\n        index = defaultValue(index, 0);\r\n        if (this._length === 0) {\r\n            return undefined;\r\n        }\r\n        //>>includeStart('debug', pragmas.debug);\r\n        Check.typeOf.number.lessThan('index', index, this._length);\r\n        //>>includeEnd('debug');\r\n\r\n        var array = this._array;\r\n        var root = array[index];\r\n        swap(array, index, --this._length);\r\n        this.heapify(index);\r\n        return root;\r\n    };\r\n\r\n    /**\r\n     * The comparator to use for the heap.\r\n     * @callback Heap~ComparatorCallback\r\n     * @param {*} a An element in the heap.\r\n     * @param {*} b An element in the heap.\r\n     * @returns {Number} If the result of the comparison is less than 0, sort a to a lower index than b, otherwise sort to a higher index.\r\n     */\r\nexport default Heap;\r\n","import Uri from '../ThirdParty/Uri.js';\r\nimport when from '../ThirdParty/when.js';\r\nimport Check from './Check.js';\r\nimport defaultValue from './defaultValue.js';\r\nimport defined from './defined.js';\r\nimport Event from './Event.js';\r\nimport Heap from './Heap.js';\r\nimport isBlobUri from './isBlobUri.js';\r\nimport isDataUri from './isDataUri.js';\r\nimport RequestState from './RequestState.js';\r\n\r\n    function sortRequests(a, b) {\r\n        return a.priority - b.priority;\r\n    }\r\n\r\n    var statistics = {\r\n        numberOfAttemptedRequests : 0,\r\n        numberOfActiveRequests : 0,\r\n        numberOfCancelledRequests : 0,\r\n        numberOfCancelledActiveRequests : 0,\r\n        numberOfFailedRequests : 0,\r\n        numberOfActiveRequestsEver : 0,\r\n        lastNumberOfActiveRequests : 0\r\n    };\r\n\r\n    var priorityHeapLength = 20;\r\n    var requestHeap = new Heap({\r\n        comparator : sortRequests\r\n    });\r\n    requestHeap.maximumLength = priorityHeapLength;\r\n    requestHeap.reserve(priorityHeapLength);\r\n\r\n    var activeRequests = [];\r\n    var numberOfActiveRequestsByServer = {};\r\n\r\n    var pageUri = typeof document !== 'undefined' ? new Uri(document.location.href) : new Uri();\r\n\r\n    var requestCompletedEvent = new Event();\r\n\r\n    /**\r\n     * Tracks the number of active requests and prioritizes incoming requests.\r\n     *\r\n     * @exports RequestScheduler\r\n     *\r\n     * @private\r\n     */\r\n    function RequestScheduler() {\r\n    }\r\n\r\n    /**\r\n     * The maximum number of simultaneous active requests. Un-throttled requests do not observe this limit.\r\n     * @type {Number}\r\n     * @default 50\r\n     */\r\n    RequestScheduler.maximumRequests = 50;\r\n\r\n    /**\r\n     * The maximum number of simultaneous active requests per server. Un-throttled requests or servers specifically\r\n     * listed in requestsByServer do not observe this limit.\r\n     * @type {Number}\r\n     * @default 6\r\n     */\r\n    RequestScheduler.maximumRequestsPerServer = 6;\r\n\r\n    /**\r\n     * A per serverKey list of overrides to use for throttling instead of maximumRequestsPerServer\r\n     */\r\n    RequestScheduler.requestsByServer = {\r\n        'api.cesium.com:443': 18,\r\n        'assets.cesium.com:443': 18\r\n    };\r\n\r\n    /**\r\n     * Specifies if the request scheduler should throttle incoming requests, or let the browser queue requests under its control.\r\n     * @type {Boolean}\r\n     * @default true\r\n     */\r\n    RequestScheduler.throttleRequests = true;\r\n\r\n    /**\r\n     * When true, log statistics to the console every frame\r\n     * @type {Boolean}\r\n     * @default false\r\n     */\r\n    RequestScheduler.debugShowStatistics = false;\r\n\r\n    /**\r\n     * An event that's raised when a request is completed.  Event handlers are passed\r\n     * the error object if the request fails.\r\n     *\r\n     * @type {Event}\r\n     * @default Event()\r\n     */\r\n    RequestScheduler.requestCompletedEvent = requestCompletedEvent;\r\n\r\n    Object.defineProperties(RequestScheduler, {\r\n        /**\r\n         * Returns the statistics used by the request scheduler.\r\n         *\r\n         * @memberof RequestScheduler\r\n         *\r\n         * @type Object\r\n         * @readonly\r\n         */\r\n        statistics : {\r\n            get : function() {\r\n                return statistics;\r\n            }\r\n        },\r\n\r\n        /**\r\n         * The maximum size of the priority heap. This limits the number of requests that are sorted by priority. Only applies to requests that are not yet active.\r\n         *\r\n         * @memberof RequestScheduler\r\n         *\r\n         * @type {Number}\r\n         * @default 20\r\n         */\r\n        priorityHeapLength : {\r\n            get : function() {\r\n                return priorityHeapLength;\r\n            },\r\n            set : function(value) {\r\n                // If the new length shrinks the heap, need to cancel some of the requests.\r\n                // Since this value is not intended to be tweaked regularly it is fine to just cancel the high priority requests.\r\n                if (value < priorityHeapLength) {\r\n                    while (requestHeap.length > value) {\r\n                        var request = requestHeap.pop();\r\n                        cancelRequest(request);\r\n                    }\r\n                }\r\n                priorityHeapLength = value;\r\n                requestHeap.maximumLength = value;\r\n                requestHeap.reserve(value);\r\n            }\r\n        }\r\n    });\r\n\r\n    function updatePriority(request) {\r\n        if (defined(request.priorityFunction)) {\r\n            request.priority = request.priorityFunction();\r\n        }\r\n    }\r\n\r\n    function serverHasOpenSlots(serverKey) {\r\n        var maxRequests = defaultValue(RequestScheduler.requestsByServer[serverKey], RequestScheduler.maximumRequestsPerServer);\r\n        return numberOfActiveRequestsByServer[serverKey] < maxRequests;\r\n    }\r\n\r\n    function issueRequest(request) {\r\n        if (request.state === RequestState.UNISSUED) {\r\n            request.state = RequestState.ISSUED;\r\n            request.deferred = when.defer();\r\n        }\r\n        return request.deferred.promise;\r\n    }\r\n\r\n    function getRequestReceivedFunction(request) {\r\n        return function(results) {\r\n            if (request.state === RequestState.CANCELLED) {\r\n                // If the data request comes back but the request is cancelled, ignore it.\r\n                return;\r\n            }\r\n            --statistics.numberOfActiveRequests;\r\n            --numberOfActiveRequestsByServer[request.serverKey];\r\n            requestCompletedEvent.raiseEvent();\r\n            request.state = RequestState.RECEIVED;\r\n            request.deferred.resolve(results);\r\n        };\r\n    }\r\n\r\n    function getRequestFailedFunction(request) {\r\n        return function(error) {\r\n            if (request.state === RequestState.CANCELLED) {\r\n                // If the data request comes back but the request is cancelled, ignore it.\r\n                return;\r\n            }\r\n            ++statistics.numberOfFailedRequests;\r\n            --statistics.numberOfActiveRequests;\r\n            --numberOfActiveRequestsByServer[request.serverKey];\r\n            requestCompletedEvent.raiseEvent(error);\r\n            request.state = RequestState.FAILED;\r\n            request.deferred.reject(error);\r\n        };\r\n    }\r\n\r\n    function startRequest(request) {\r\n        var promise = issueRequest(request);\r\n        request.state = RequestState.ACTIVE;\r\n        activeRequests.push(request);\r\n        ++statistics.numberOfActiveRequests;\r\n        ++statistics.numberOfActiveRequestsEver;\r\n        ++numberOfActiveRequestsByServer[request.serverKey];\r\n        request.requestFunction().then(getRequestReceivedFunction(request)).otherwise(getRequestFailedFunction(request));\r\n        return promise;\r\n    }\r\n\r\n    function cancelRequest(request) {\r\n        var active = request.state === RequestState.ACTIVE;\r\n        request.state = RequestState.CANCELLED;\r\n        ++statistics.numberOfCancelledRequests;\r\n        request.deferred.reject();\r\n\r\n        if (active) {\r\n            --statistics.numberOfActiveRequests;\r\n            --numberOfActiveRequestsByServer[request.serverKey];\r\n            ++statistics.numberOfCancelledActiveRequests;\r\n        }\r\n\r\n        if (defined(request.cancelFunction)) {\r\n            request.cancelFunction();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Sort requests by priority and start requests.\r\n     */\r\n    RequestScheduler.update = function() {\r\n        var i;\r\n        var request;\r\n\r\n        // Loop over all active requests. Cancelled, failed, or received requests are removed from the array to make room for new requests.\r\n        var removeCount = 0;\r\n        var activeLength = activeRequests.length;\r\n        for (i = 0; i < activeLength; ++i) {\r\n            request = activeRequests[i];\r\n            if (request.cancelled) {\r\n                // Request was explicitly cancelled\r\n                cancelRequest(request);\r\n            }\r\n            if (request.state !== RequestState.ACTIVE) {\r\n                // Request is no longer active, remove from array\r\n                ++removeCount;\r\n                continue;\r\n            }\r\n            if (removeCount > 0) {\r\n                // Shift back to fill in vacated slots from completed requests\r\n                activeRequests[i - removeCount] = request;\r\n            }\r\n        }\r\n        activeRequests.length -= removeCount;\r\n\r\n        // Update priority of issued requests and resort the heap\r\n        var issuedRequests = requestHeap.internalArray;\r\n        var issuedLength = requestHeap.length;\r\n        for (i = 0; i < issuedLength; ++i) {\r\n            updatePriority(issuedRequests[i]);\r\n        }\r\n        requestHeap.resort();\r\n\r\n        // Get the number of open slots and fill with the highest priority requests.\r\n        // Un-throttled requests are automatically added to activeRequests, so activeRequests.length may exceed maximumRequests\r\n        var openSlots = Math.max(RequestScheduler.maximumRequests - activeRequests.length, 0);\r\n        var filledSlots = 0;\r\n        while (filledSlots < openSlots && requestHeap.length > 0) {\r\n            // Loop until all open slots are filled or the heap becomes empty\r\n            request = requestHeap.pop();\r\n            if (request.cancelled) {\r\n                // Request was explicitly cancelled\r\n                cancelRequest(request);\r\n                continue;\r\n            }\r\n\r\n            if (request.throttleByServer && !serverHasOpenSlots(request.serverKey)) {\r\n                // Open slots are available, but the request is throttled by its server. Cancel and try again later.\r\n                cancelRequest(request);\r\n                continue;\r\n            }\r\n\r\n            startRequest(request);\r\n            ++filledSlots;\r\n        }\r\n\r\n        updateStatistics();\r\n    };\r\n\r\n    /**\r\n     * Get the server key from a given url.\r\n     *\r\n     * @param {String} url The url.\r\n     * @returns {String} The server key.\r\n     */\r\n    RequestScheduler.getServerKey = function(url) {\r\n        //>>includeStart('debug', pragmas.debug);\r\n        Check.typeOf.string('url', url);\r\n        //>>includeEnd('debug');\r\n\r\n        var uri = new Uri(url).resolve(pageUri);\r\n        uri.normalize();\r\n        var serverKey = uri.authority;\r\n        if (!/:/.test(serverKey)) {\r\n            // If the authority does not contain a port number, add port 443 for https or port 80 for http\r\n            serverKey = serverKey + ':' + (uri.scheme === 'https' ? '443' : '80');\r\n        }\r\n\r\n        var length = numberOfActiveRequestsByServer[serverKey];\r\n        if (!defined(length)) {\r\n            numberOfActiveRequestsByServer[serverKey] = 0;\r\n        }\r\n\r\n        return serverKey;\r\n    };\r\n\r\n    /**\r\n     * Issue a request. If request.throttle is false, the request is sent immediately. Otherwise the request will be\r\n     * queued and sorted by priority before being sent.\r\n     *\r\n     * @param {Request} request The request object.\r\n     *\r\n     * @returns {Promise|undefined} A Promise for the requested data, or undefined if this request does not have high enough priority to be issued.\r\n     */\r\n    RequestScheduler.request = function(request) {\r\n        //>>includeStart('debug', pragmas.debug);\r\n        Check.typeOf.object('request', request);\r\n        Check.typeOf.string('request.url', request.url);\r\n        Check.typeOf.func('request.requestFunction', request.requestFunction);\r\n        //>>includeEnd('debug');\r\n\r\n        if (isDataUri(request.url) || isBlobUri(request.url)) {\r\n            requestCompletedEvent.raiseEvent();\r\n            request.state = RequestState.RECEIVED;\r\n            return request.requestFunction();\r\n        }\r\n\r\n        ++statistics.numberOfAttemptedRequests;\r\n\r\n        if (!defined(request.serverKey)) {\r\n            request.serverKey = RequestScheduler.getServerKey(request.url);\r\n        }\r\n\r\n        if (RequestScheduler.throttleRequests && request.throttleByServer && !serverHasOpenSlots(request.serverKey)) {\r\n            // Server is saturated. Try again later.\r\n            return undefined;\r\n        }\r\n\r\n        if (!RequestScheduler.throttleRequests || !request.throttle) {\r\n            return startRequest(request);\r\n        }\r\n\r\n        if (activeRequests.length >= RequestScheduler.maximumRequests) {\r\n            // Active requests are saturated. Try again later.\r\n            return undefined;\r\n        }\r\n\r\n        // Insert into the priority heap and see if a request was bumped off. If this request is the lowest\r\n        // priority it will be returned.\r\n        updatePriority(request);\r\n        var removedRequest = requestHeap.insert(request);\r\n\r\n        if (defined(removedRequest)) {\r\n            if (removedRequest === request) {\r\n                // Request does not have high enough priority to be issued\r\n                return undefined;\r\n            }\r\n            // A previously issued request has been bumped off the priority heap, so cancel it\r\n            cancelRequest(removedRequest);\r\n        }\r\n\r\n        return issueRequest(request);\r\n    };\r\n\r\n    function updateStatistics() {\r\n        if (!RequestScheduler.debugShowStatistics) {\r\n            return;\r\n        }\r\n\r\n        if (statistics.numberOfActiveRequests === 0 && statistics.lastNumberOfActiveRequests > 0) {\r\n            if (statistics.numberOfAttemptedRequests > 0) {\r\n                console.log('Number of attempted requests: ' + statistics.numberOfAttemptedRequests);\r\n                statistics.numberOfAttemptedRequests = 0;\r\n            }\r\n\r\n            if (statistics.numberOfCancelledRequests > 0) {\r\n                console.log('Number of cancelled requests: ' + statistics.numberOfCancelledRequests);\r\n                statistics.numberOfCancelledRequests = 0;\r\n            }\r\n\r\n            if (statistics.numberOfCancelledActiveRequests > 0) {\r\n                console.log('Number of cancelled active requests: ' + statistics.numberOfCancelledActiveRequests);\r\n                statistics.numberOfCancelledActiveRequests = 0;\r\n            }\r\n\r\n            if (statistics.numberOfFailedRequests > 0) {\r\n                console.log('Number of failed requests: ' + statistics.numberOfFailedRequests);\r\n                statistics.numberOfFailedRequests = 0;\r\n            }\r\n        }\r\n\r\n        statistics.lastNumberOfActiveRequests = statistics.numberOfActiveRequests;\r\n    }\r\n\r\n    /**\r\n     * For testing only. Clears any requests that may not have completed from previous tests.\r\n     *\r\n     * @private\r\n     */\r\n    RequestScheduler.clearForSpecs = function() {\r\n        while (requestHeap.length > 0) {\r\n            var request = requestHeap.pop();\r\n            cancelRequest(request);\r\n        }\r\n        var length = activeRequests.length;\r\n        for (var i = 0; i < length; ++i) {\r\n            cancelRequest(activeRequests[i]);\r\n        }\r\n        activeRequests.length = 0;\r\n        numberOfActiveRequestsByServer = {};\r\n\r\n        // Clear stats\r\n        statistics.numberOfAttemptedRequests = 0;\r\n        statistics.numberOfActiveRequests = 0;\r\n        statistics.numberOfCancelledRequests = 0;\r\n        statistics.numberOfCancelledActiveRequests = 0;\r\n        statistics.numberOfFailedRequests = 0;\r\n        statistics.numberOfActiveRequestsEver = 0;\r\n        statistics.lastNumberOfActiveRequests = 0;\r\n    };\r\n\r\n    /**\r\n     * For testing only.\r\n     *\r\n     * @private\r\n     */\r\n    RequestScheduler.numberOfActiveRequestsByServer = function(serverKey) {\r\n        return numberOfActiveRequestsByServer[serverKey];\r\n    };\r\n\r\n    /**\r\n     * For testing only.\r\n     *\r\n     * @private\r\n     */\r\n    RequestScheduler.requestHeap = requestHeap;\r\nexport default RequestScheduler;\r\n","import Uri from '../ThirdParty/Uri.js';\r\nimport defined from './defined.js';\r\nimport DeveloperError from './DeveloperError.js';\r\n\r\n    /**\r\n     * A singleton that contains all of the servers that are trusted. Credentials will be sent with\r\n     * any requests to these servers.\r\n     *\r\n     * @exports TrustedServers\r\n     *\r\n     * @see {@link http://www.w3.org/TR/cors/|Cross-Origin Resource Sharing}\r\n     */\r\n    var TrustedServers = {};\r\n    var _servers = {};\r\n\r\n    /**\r\n     * Adds a trusted server to the registry\r\n     *\r\n     * @param {String} host The host to be added.\r\n     * @param {Number} port The port used to access the host.\r\n     *\r\n     * @example\r\n     * // Add a trusted server\r\n     * TrustedServers.add('my.server.com', 80);\r\n     */\r\n    TrustedServers.add = function(host, port) {\r\n        //>>includeStart('debug', pragmas.debug);\r\n        if (!defined(host)) {\r\n            throw new DeveloperError('host is required.');\r\n        }\r\n        if (!defined(port) || port <= 0) {\r\n            throw new DeveloperError('port is required to be greater than 0.');\r\n        }\r\n        //>>includeEnd('debug');\r\n\r\n        var authority = host.toLowerCase() + ':' + port;\r\n        if (!defined(_servers[authority])) {\r\n            _servers[authority] = true;\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Removes a trusted server from the registry\r\n     *\r\n     * @param {String} host The host to be removed.\r\n     * @param {Number} port The port used to access the host.\r\n     *\r\n     * @example\r\n     * // Remove a trusted server\r\n     * TrustedServers.remove('my.server.com', 80);\r\n     */\r\n    TrustedServers.remove = function(host, port) {\r\n        //>>includeStart('debug', pragmas.debug);\r\n        if (!defined(host)) {\r\n            throw new DeveloperError('host is required.');\r\n        }\r\n        if (!defined(port) || port <= 0) {\r\n            throw new DeveloperError('port is required to be greater than 0.');\r\n        }\r\n        //>>includeEnd('debug');\r\n\r\n        var authority = host.toLowerCase() + ':' + port;\r\n        if (defined(_servers[authority])) {\r\n            delete _servers[authority];\r\n        }\r\n    };\r\n\r\n    function getAuthority(url) {\r\n        var uri = new Uri(url);\r\n        uri.normalize();\r\n\r\n        // Removes username:password@ so we just have host[:port]\r\n        var authority = uri.getAuthority();\r\n        if (!defined(authority)) {\r\n            return undefined; // Relative URL\r\n        }\r\n\r\n        if (authority.indexOf('@') !== -1) {\r\n            var parts = authority.split('@');\r\n            authority = parts[1];\r\n        }\r\n\r\n        // If the port is missing add one based on the scheme\r\n        if (authority.indexOf(':') === -1) {\r\n            var scheme = uri.getScheme();\r\n            if (!defined(scheme)) {\r\n                scheme = window.location.protocol;\r\n                scheme = scheme.substring(0, scheme.length-1);\r\n            }\r\n            if (scheme === 'http') {\r\n                authority += ':80';\r\n            } else if (scheme === 'https') {\r\n                authority += ':443';\r\n            } else {\r\n                return undefined;\r\n            }\r\n        }\r\n\r\n        return authority;\r\n    }\r\n\r\n    /**\r\n     * Tests whether a server is trusted or not. The server must have been added with the port if it is included in the url.\r\n     *\r\n     * @param {String} url The url to be tested against the trusted list\r\n     *\r\n     * @returns {boolean} Returns true if url is trusted, false otherwise.\r\n     *\r\n     * @example\r\n     * // Add server\r\n     * TrustedServers.add('my.server.com', 81);\r\n     *\r\n     * // Check if server is trusted\r\n     * if (TrustedServers.contains('https://my.server.com:81/path/to/file.png')) {\r\n     *     // my.server.com:81 is trusted\r\n     * }\r\n     * if (TrustedServers.contains('https://my.server.com/path/to/file.png')) {\r\n     *     // my.server.com isn't trusted\r\n     * }\r\n     */\r\n    TrustedServers.contains = function(url) {\r\n        //>>includeStart('debug', pragmas.debug);\r\n        if (!defined(url)) {\r\n            throw new DeveloperError('url is required.');\r\n        }\r\n        //>>includeEnd('debug');\r\n        var authority = getAuthority(url);\r\n        if (defined(authority) && defined(_servers[authority])) {\r\n            return true;\r\n        }\r\n\r\n        return false;\r\n    };\r\n\r\n    /**\r\n     * Clears the registry\r\n     *\r\n     * @example\r\n     * // Remove a trusted server\r\n     * TrustedServers.clear();\r\n     */\r\n    TrustedServers.clear = function() {\r\n        _servers = {};\r\n    };\r\nexport default TrustedServers;\r\n","import Uri from '../ThirdParty/Uri.js';\r\nimport when from '../ThirdParty/when.js';\r\nimport appendForwardSlash from './appendForwardSlash.js';\r\nimport Check from './Check.js';\r\nimport clone from './clone.js';\r\nimport combine from './combine.js';\r\nimport defaultValue from './defaultValue.js';\r\nimport defined from './defined.js';\r\nimport DeveloperError from './DeveloperError.js';\r\nimport getAbsoluteUri from './getAbsoluteUri.js';\r\nimport getBaseUri from './getBaseUri.js';\r\nimport getExtensionFromUri from './getExtensionFromUri.js';\r\nimport isBlobUri from './isBlobUri.js';\r\nimport isCrossOriginUrl from './isCrossOriginUrl.js';\r\nimport isDataUri from './isDataUri.js';\r\nimport loadAndExecuteScript from './loadAndExecuteScript.js';\r\nimport objectToQuery from './objectToQuery.js';\r\nimport queryToObject from './queryToObject.js';\r\nimport Request from './Request.js';\r\nimport RequestErrorEvent from './RequestErrorEvent.js';\r\nimport RequestScheduler from './RequestScheduler.js';\r\nimport RequestState from './RequestState.js';\r\nimport RuntimeError from './RuntimeError.js';\r\nimport TrustedServers from './TrustedServers.js';\r\n\r\n    var xhrBlobSupported = (function() {\r\n        try {\r\n            var xhr = new XMLHttpRequest();\r\n            xhr.open('GET', '#', true);\r\n            xhr.responseType = 'blob';\r\n            return xhr.responseType === 'blob';\r\n        } catch (e) {\r\n            return false;\r\n        }\r\n    })();\r\n\r\n    /**\r\n     * Parses a query string and returns the object equivalent.\r\n     *\r\n     * @param {Uri} uri The Uri with a query object.\r\n     * @param {Resource} resource The Resource that will be assigned queryParameters.\r\n     * @param {Boolean} merge If true, we'll merge with the resource's existing queryParameters. Otherwise they will be replaced.\r\n     * @param {Boolean} preserveQueryParameters If true duplicate parameters will be concatenated into an array. If false, keys in uri will take precedence.\r\n     *\r\n     * @private\r\n     */\r\n    function parseQuery(uri, resource, merge, preserveQueryParameters) {\r\n        var queryString = uri.query;\r\n        if (!defined(queryString) || (queryString.length === 0)) {\r\n            return {};\r\n        }\r\n\r\n        var query;\r\n        // Special case we run into where the querystring is just a string, not key/value pairs\r\n        if (queryString.indexOf('=') === -1) {\r\n            var result = {};\r\n            result[queryString] = undefined;\r\n            query = result;\r\n        } else {\r\n            query = queryToObject(queryString);\r\n        }\r\n\r\n        if (merge) {\r\n            resource._queryParameters = combineQueryParameters(query, resource._queryParameters, preserveQueryParameters);\r\n        } else {\r\n            resource._queryParameters = query;\r\n        }\r\n        uri.query = undefined;\r\n    }\r\n\r\n    /**\r\n     * Converts a query object into a string.\r\n     *\r\n     * @param {Uri} uri The Uri object that will have the query object set.\r\n     * @param {Resource} resource The resource that has queryParameters\r\n     *\r\n     * @private\r\n     */\r\n    function stringifyQuery(uri, resource) {\r\n        var queryObject = resource._queryParameters;\r\n\r\n        var keys = Object.keys(queryObject);\r\n\r\n        // We have 1 key with an undefined value, so this is just a string, not key/value pairs\r\n        if (keys.length === 1 && !defined(queryObject[keys[0]])) {\r\n            uri.query = keys[0];\r\n        } else {\r\n            uri.query = objectToQuery(queryObject);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Clones a value if it is defined, otherwise returns the default value\r\n     *\r\n     * @param {*} [val] The value to clone.\r\n     * @param {*} [defaultVal] The default value.\r\n     *\r\n     * @returns {*} A clone of val or the defaultVal.\r\n     *\r\n     * @private\r\n     */\r\n    function defaultClone(val, defaultVal) {\r\n        if (!defined(val)) {\r\n            return defaultVal;\r\n        }\r\n\r\n        return defined(val.clone) ? val.clone() : clone(val);\r\n    }\r\n\r\n    /**\r\n     * Checks to make sure the Resource isn't already being requested.\r\n     *\r\n     * @param {Request} request The request to check.\r\n     *\r\n     * @private\r\n     */\r\n    function checkAndResetRequest(request) {\r\n        if (request.state === RequestState.ISSUED || request.state === RequestState.ACTIVE) {\r\n            throw new RuntimeError('The Resource is already being fetched.');\r\n        }\r\n\r\n        request.state = RequestState.UNISSUED;\r\n        request.deferred = undefined;\r\n    }\r\n\r\n    /**\r\n     * This combines a map of query parameters.\r\n     *\r\n     * @param {Object} q1 The first map of query parameters. Values in this map will take precedence if preserveQueryParameters is false.\r\n     * @param {Object} q2 The second map of query parameters.\r\n     * @param {Boolean} preserveQueryParameters If true duplicate parameters will be concatenated into an array. If false, keys in q1 will take precedence.\r\n     *\r\n     * @returns {Object} The combined map of query parameters.\r\n     *\r\n     * @example\r\n     * var q1 = {\r\n     *   a: 1,\r\n     *   b: 2\r\n     * };\r\n     * var q2 = {\r\n     *   a: 3,\r\n     *   c: 4\r\n     * };\r\n     * var q3 = {\r\n     *   b: [5, 6],\r\n     *   d: 7\r\n     * }\r\n     *\r\n     * // Returns\r\n     * // {\r\n     * //   a: [1, 3],\r\n     * //   b: 2,\r\n     * //   c: 4\r\n     * // };\r\n     * combineQueryParameters(q1, q2, true);\r\n     *\r\n     * // Returns\r\n     * // {\r\n     * //   a: 1,\r\n     * //   b: 2,\r\n     * //   c: 4\r\n     * // };\r\n     * combineQueryParameters(q1, q2, false);\r\n     *\r\n     * // Returns\r\n     * // {\r\n     * //   a: 1,\r\n     * //   b: [2, 5, 6],\r\n     * //   d: 7\r\n     * // };\r\n     * combineQueryParameters(q1, q3, true);\r\n     *\r\n     * // Returns\r\n     * // {\r\n     * //   a: 1,\r\n     * //   b: 2,\r\n     * //   d: 7\r\n     * // };\r\n     * combineQueryParameters(q1, q3, false);\r\n     *\r\n     * @private\r\n     */\r\n    function combineQueryParameters(q1, q2, preserveQueryParameters) {\r\n        if (!preserveQueryParameters) {\r\n            return combine(q1, q2);\r\n        }\r\n\r\n        var result = clone(q1, true);\r\n        for (var param in q2) {\r\n            if (q2.hasOwnProperty(param)) {\r\n                var value = result[param];\r\n                var q2Value = q2[param];\r\n                if (defined(value)) {\r\n                    if (!Array.isArray(value)) {\r\n                        value = result[param] = [value];\r\n                    }\r\n\r\n                    result[param] = value.concat(q2Value);\r\n                } else {\r\n                    result[param] = Array.isArray(q2Value) ? q2Value.slice() : q2Value;\r\n                }\r\n            }\r\n        }\r\n\r\n        return result;\r\n    }\r\n\r\n    /**\r\n     * A resource that includes the location and any other parameters we need to retrieve it or create derived resources. It also provides the ability to retry requests.\r\n     *\r\n     * @alias Resource\r\n     * @constructor\r\n     *\r\n     * @param {String|Object} options A url or an object with the following properties\r\n     * @param {String} options.url The url of the resource.\r\n     * @param {Object} [options.queryParameters] An object containing query parameters that will be sent when retrieving the resource.\r\n     * @param {Object} [options.templateValues] Key/Value pairs that are used to replace template values (eg. {x}).\r\n     * @param {Object} [options.headers={}] Additional HTTP headers that will be sent.\r\n     * @param {DefaultProxy} [options.proxy] A proxy to be used when loading the resource.\r\n     * @param {Resource~RetryCallback} [options.retryCallback] The Function to call when a request for this resource fails. If it returns true, the request will be retried.\r\n     * @param {Number} [options.retryAttempts=0] The number of times the retryCallback should be called before giving up.\r\n     * @param {Request} [options.request] A Request object that will be used. Intended for internal use only.\r\n     *\r\n     * @example\r\n     * function refreshTokenRetryCallback(resource, error) {\r\n     *   if (error.statusCode === 403) {\r\n     *     // 403 status code means a new token should be generated\r\n     *     return getNewAccessToken()\r\n     *       .then(function(token) {\r\n     *         resource.queryParameters.access_token = token;\r\n     *         return true;\r\n     *       })\r\n     *       .otherwise(function() {\r\n     *         return false;\r\n     *       });\r\n     *   }\r\n     *\r\n     *   return false;\r\n     * }\r\n     *\r\n     * var resource = new Resource({\r\n     *    url: 'http://server.com/path/to/resource.json',\r\n     *    proxy: new DefaultProxy('/proxy/'),\r\n     *    headers: {\r\n     *      'X-My-Header': 'valueOfHeader'\r\n     *    },\r\n     *    queryParameters: {\r\n     *      'access_token': '123-435-456-000'\r\n     *    },\r\n     *    retryCallback: refreshTokenRetryCallback,\r\n     *    retryAttempts: 1\r\n     * });\r\n     */\r\n    function Resource(options) {\r\n        options = defaultValue(options, defaultValue.EMPTY_OBJECT);\r\n        if (typeof options === 'string') {\r\n            options = {\r\n                url: options\r\n            };\r\n        }\r\n\r\n        //>>includeStart('debug', pragmas.debug);\r\n        Check.typeOf.string('options.url', options.url);\r\n        //>>includeEnd('debug');\r\n\r\n        this._url = undefined;\r\n        this._templateValues = defaultClone(options.templateValues, {});\r\n        this._queryParameters = defaultClone(options.queryParameters, {});\r\n\r\n        /**\r\n         * Additional HTTP headers that will be sent with the request.\r\n         *\r\n         * @type {Object}\r\n         */\r\n        this.headers = defaultClone(options.headers, {});\r\n\r\n        /**\r\n         * A Request object that will be used. Intended for internal use only.\r\n         *\r\n         * @type {Request}\r\n         */\r\n        this.request = defaultValue(options.request, new Request());\r\n\r\n        /**\r\n         * A proxy to be used when loading the resource.\r\n         *\r\n         * @type {DefaultProxy}\r\n         */\r\n        this.proxy = options.proxy;\r\n\r\n        /**\r\n         * Function to call when a request for this resource fails. If it returns true or a Promise that resolves to true, the request will be retried.\r\n         *\r\n         * @type {Function}\r\n         */\r\n        this.retryCallback = options.retryCallback;\r\n\r\n        /**\r\n         * The number of times the retryCallback should be called before giving up.\r\n         *\r\n         * @type {Number}\r\n         */\r\n        this.retryAttempts = defaultValue(options.retryAttempts, 0);\r\n        this._retryCount = 0;\r\n\r\n        var uri = new Uri(options.url);\r\n        parseQuery(uri, this, true, true);\r\n\r\n        // Remove the fragment as it's not sent with a request\r\n        uri.fragment = undefined;\r\n\r\n        this._url = uri.toString();\r\n    }\r\n\r\n    /**\r\n     * A helper function to create a resource depending on whether we have a String or a Resource\r\n     *\r\n     * @param {Resource|String} resource A Resource or a String to use when creating a new Resource.\r\n     *\r\n     * @returns {Resource} If resource is a String, a Resource constructed with the url and options. Otherwise the resource parameter is returned.\r\n     *\r\n     * @private\r\n     */\r\n    Resource.createIfNeeded = function(resource) {\r\n        if (resource instanceof Resource) {\r\n            // Keep existing request object. This function is used internally to duplicate a Resource, so that it can't\r\n            //  be modified outside of a class that holds it (eg. an imagery or terrain provider). Since the Request objects\r\n            //  are managed outside of the providers, by the tile loading code, we want to keep the request property the same so if it is changed\r\n            //  in the underlying tiling code the requests for this resource will use it.\r\n            return  resource.getDerivedResource({\r\n                request: resource.request\r\n            });\r\n        }\r\n\r\n        if (typeof resource !== 'string') {\r\n            return resource;\r\n        }\r\n\r\n        return new Resource({\r\n            url: resource\r\n        });\r\n    };\r\n\r\n    var supportsImageBitmapOptionsPromise;\r\n    /**\r\n     * A helper function to check whether createImageBitmap supports passing ImageBitmapOptions.\r\n     *\r\n     * @returns {Promise<Boolean>} A promise that resolves to true if this browser supports creating an ImageBitmap with options.\r\n     *\r\n     * @private\r\n     */\r\n    Resource.supportsImageBitmapOptions = function() {\r\n        // Until the HTML folks figure out what to do about this, we need to actually try loading an image to\r\n        // know if this browser supports passing options to the createImageBitmap function.\r\n        // https://github.com/whatwg/html/pull/4248\r\n        if (defined(supportsImageBitmapOptionsPromise)) {\r\n            return supportsImageBitmapOptionsPromise;\r\n        }\r\n\r\n        if (typeof createImageBitmap !== 'function') {\r\n            supportsImageBitmapOptionsPromise = when.resolve(false);\r\n            return supportsImageBitmapOptionsPromise;\r\n        }\r\n\r\n        var imageDataUri = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWP4////fwAJ+wP9CNHoHgAAAABJRU5ErkJggg==';\r\n\r\n        supportsImageBitmapOptionsPromise = Resource.fetchBlob({\r\n            url : imageDataUri\r\n        })\r\n            .then(function(blob) {\r\n                return createImageBitmap(blob, {\r\n                    imageOrientation: 'flipY',\r\n                    premultiplyAlpha: 'none'\r\n                });\r\n            })\r\n            .then(function(imageBitmap) {\r\n                return true;\r\n            })\r\n            .otherwise(function() {\r\n                return false;\r\n            });\r\n\r\n        return supportsImageBitmapOptionsPromise;\r\n    };\r\n\r\n    Object.defineProperties(Resource, {\r\n        /**\r\n         * Returns true if blobs are supported.\r\n         *\r\n         * @memberof Resource\r\n         * @type {Boolean}\r\n         *\r\n         * @readonly\r\n         */\r\n        isBlobSupported : {\r\n            get : function() {\r\n                return xhrBlobSupported;\r\n            }\r\n        }\r\n    });\r\n\r\n    Object.defineProperties(Resource.prototype, {\r\n        /**\r\n         * Query parameters appended to the url.\r\n         *\r\n         * @memberof Resource.prototype\r\n         * @type {Object}\r\n         *\r\n         * @readonly\r\n         */\r\n        queryParameters: {\r\n            get: function() {\r\n                return this._queryParameters;\r\n            }\r\n        },\r\n\r\n        /**\r\n         * The key/value pairs used to replace template parameters in the url.\r\n         *\r\n         * @memberof Resource.prototype\r\n         * @type {Object}\r\n         *\r\n         * @readonly\r\n         */\r\n        templateValues: {\r\n            get: function() {\r\n                return this._templateValues;\r\n            }\r\n        },\r\n\r\n        /**\r\n         * The url to the resource with template values replaced, query string appended and encoded by proxy if one was set.\r\n         *\r\n         * @memberof Resource.prototype\r\n         * @type {String}\r\n         */\r\n        url: {\r\n            get: function() {\r\n                return this.getUrlComponent(true, true);\r\n            },\r\n            set: function(value) {\r\n                var uri = new Uri(value);\r\n\r\n                parseQuery(uri, this, false);\r\n\r\n                // Remove the fragment as it's not sent with a request\r\n                uri.fragment = undefined;\r\n\r\n                this._url = uri.toString();\r\n            }\r\n        },\r\n\r\n        /**\r\n         * The file extension of the resource.\r\n         *\r\n         * @memberof Resource.prototype\r\n         * @type {String}\r\n         *\r\n         * @readonly\r\n         */\r\n        extension: {\r\n            get: function() {\r\n                return getExtensionFromUri(this._url);\r\n            }\r\n        },\r\n\r\n        /**\r\n         * True if the Resource refers to a data URI.\r\n         *\r\n         * @memberof Resource.prototype\r\n         * @type {Boolean}\r\n         */\r\n        isDataUri: {\r\n            get: function() {\r\n                return isDataUri(this._url);\r\n            }\r\n        },\r\n\r\n        /**\r\n         * True if the Resource refers to a blob URI.\r\n         *\r\n         * @memberof Resource.prototype\r\n         * @type {Boolean}\r\n         */\r\n        isBlobUri: {\r\n            get: function() {\r\n                return isBlobUri(this._url);\r\n            }\r\n        },\r\n\r\n        /**\r\n         * True if the Resource refers to a cross origin URL.\r\n         *\r\n         * @memberof Resource.prototype\r\n         * @type {Boolean}\r\n         */\r\n        isCrossOriginUrl: {\r\n            get: function() {\r\n                return isCrossOriginUrl(this._url);\r\n            }\r\n        },\r\n\r\n        /**\r\n         * True if the Resource has request headers. This is equivalent to checking if the headers property has any keys.\r\n         *\r\n         * @memberof Resource.prototype\r\n         * @type {Boolean}\r\n         */\r\n        hasHeaders: {\r\n            get: function() {\r\n                return (Object.keys(this.headers).length > 0);\r\n            }\r\n        }\r\n    });\r\n\r\n    /**\r\n     * Returns the url, optional with the query string and processed by a proxy.\r\n     *\r\n     * @param {Boolean} [query=false] If true, the query string is included.\r\n     * @param {Boolean} [proxy=false] If true, the url is processed the proxy object if defined.\r\n     *\r\n     * @returns {String} The url with all the requested components.\r\n     */\r\n    Resource.prototype.getUrlComponent = function(query, proxy) {\r\n        if(this.isDataUri) {\r\n            return this._url;\r\n        }\r\n\r\n        var uri = new Uri(this._url);\r\n\r\n        if (query) {\r\n            stringifyQuery(uri, this);\r\n        }\r\n\r\n        // objectToQuery escapes the placeholders.  Undo that.\r\n        var url = uri.toString().replace(/%7B/g, '{').replace(/%7D/g, '}');\r\n\r\n        var templateValues = this._templateValues;\r\n        url = url.replace(/{(.*?)}/g, function(match, key) {\r\n            var replacement = templateValues[key];\r\n            if (defined(replacement)) {\r\n                // use the replacement value from templateValues if there is one...\r\n                return encodeURIComponent(replacement);\r\n            }\r\n            // otherwise leave it unchanged\r\n            return match;\r\n        });\r\n\r\n        if (proxy && defined(this.proxy)) {\r\n            url = this.proxy.getURL(url);\r\n        }\r\n        return url;\r\n    };\r\n\r\n    /**\r\n     * Combines the specified object and the existing query parameters. This allows you to add many parameters at once,\r\n     *  as opposed to adding them one at a time to the queryParameters property. If a value is already set, it will be replaced with the new value.\r\n     *\r\n     * @param {Object} params The query parameters\r\n     * @param {Boolean} [useAsDefault=false] If true the params will be used as the default values, so they will only be set if they are undefined.\r\n     */\r\n    Resource.prototype.setQueryParameters = function(params, useAsDefault) {\r\n        if (useAsDefault) {\r\n            this._queryParameters = combineQueryParameters(this._queryParameters, params, false);\r\n        } else {\r\n            this._queryParameters = combineQueryParameters(params, this._queryParameters, false);\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Combines the specified object and the existing query parameters. This allows you to add many parameters at once,\r\n     *  as opposed to adding them one at a time to the queryParameters property.\r\n     *\r\n     * @param {Object} params The query parameters\r\n     */\r\n    Resource.prototype.appendQueryParameters = function(params) {\r\n        this._queryParameters = combineQueryParameters(params, this._queryParameters, true);\r\n    };\r\n\r\n    /**\r\n     * Combines the specified object and the existing template values. This allows you to add many values at once,\r\n     *  as opposed to adding them one at a time to the templateValues property. If a value is already set, it will become an array and the new value will be appended.\r\n     *\r\n     * @param {Object} template The template values\r\n     * @param {Boolean} [useAsDefault=false] If true the values will be used as the default values, so they will only be set if they are undefined.\r\n     */\r\n    Resource.prototype.setTemplateValues = function(template, useAsDefault) {\r\n        if (useAsDefault) {\r\n            this._templateValues = combine(this._templateValues, template);\r\n        } else {\r\n            this._templateValues = combine(template, this._templateValues);\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Returns a resource relative to the current instance. All properties remain the same as the current instance unless overridden in options.\r\n     *\r\n     * @param {Object} options An object with the following properties\r\n     * @param {String} [options.url]  The url that will be resolved relative to the url of the current instance.\r\n     * @param {Object} [options.queryParameters] An object containing query parameters that will be combined with those of the current instance.\r\n     * @param {Object} [options.templateValues] Key/Value pairs that are used to replace template values (eg. {x}). These will be combined with those of the current instance.\r\n     * @param {Object} [options.headers={}] Additional HTTP headers that will be sent.\r\n     * @param {DefaultProxy} [options.proxy] A proxy to be used when loading the resource.\r\n     * @param {Resource~RetryCallback} [options.retryCallback] The function to call when loading the resource fails.\r\n     * @param {Number} [options.retryAttempts] The number of times the retryCallback should be called before giving up.\r\n     * @param {Request} [options.request] A Request object that will be used. Intended for internal use only.\r\n     * @param {Boolean} [options.preserveQueryParameters=false] If true, this will keep all query parameters from the current resource and derived resource. If false, derived parameters will replace those of the current resource.\r\n     *\r\n     * @returns {Resource} The resource derived from the current one.\r\n     */\r\n    Resource.prototype.getDerivedResource = function(options) {\r\n        var resource = this.clone();\r\n        resource._retryCount = 0;\r\n\r\n        if (defined(options.url)) {\r\n            var uri = new Uri(options.url);\r\n\r\n            var preserveQueryParameters = defaultValue(options.preserveQueryParameters, false);\r\n            parseQuery(uri, resource, true, preserveQueryParameters);\r\n\r\n            // Remove the fragment as it's not sent with a request\r\n            uri.fragment = undefined;\r\n\r\n            resource._url = uri.resolve(new Uri(getAbsoluteUri(this._url))).toString();\r\n        }\r\n\r\n        if (defined(options.queryParameters)) {\r\n            resource._queryParameters = combine(options.queryParameters, resource._queryParameters);\r\n        }\r\n        if (defined(options.templateValues)) {\r\n            resource._templateValues = combine(options.templateValues, resource.templateValues);\r\n        }\r\n        if (defined(options.headers)) {\r\n            resource.headers = combine(options.headers, resource.headers);\r\n        }\r\n        if (defined(options.proxy)) {\r\n            resource.proxy = options.proxy;\r\n        }\r\n        if (defined(options.request)) {\r\n            resource.request = options.request;\r\n        }\r\n        if (defined(options.retryCallback)) {\r\n            resource.retryCallback = options.retryCallback;\r\n        }\r\n        if (defined(options.retryAttempts)) {\r\n            resource.retryAttempts = options.retryAttempts;\r\n        }\r\n\r\n        return resource;\r\n    };\r\n\r\n    /**\r\n     * Called when a resource fails to load. This will call the retryCallback function if defined until retryAttempts is reached.\r\n     *\r\n     * @param {Error} [error] The error that was encountered.\r\n     *\r\n     * @returns {Promise<Boolean>} A promise to a boolean, that if true will cause the resource request to be retried.\r\n     *\r\n     * @private\r\n     */\r\n    Resource.prototype.retryOnError = function(error) {\r\n        var retryCallback = this.retryCallback;\r\n        if ((typeof retryCallback !== 'function') || (this._retryCount >= this.retryAttempts)) {\r\n            return when(false);\r\n        }\r\n\r\n        var that = this;\r\n        return when(retryCallback(this, error))\r\n            .then(function(result) {\r\n                ++that._retryCount;\r\n\r\n                return result;\r\n            });\r\n    };\r\n\r\n    /**\r\n     * Duplicates a Resource instance.\r\n     *\r\n     * @param {Resource} [result] The object onto which to store the result.\r\n     *\r\n     * @returns {Resource} The modified result parameter or a new Resource instance if one was not provided.\r\n     */\r\n    Resource.prototype.clone = function(result) {\r\n        if (!defined(result)) {\r\n            result = new Resource({\r\n                url : this._url\r\n            });\r\n        }\r\n\r\n        result._url = this._url;\r\n        result._queryParameters = clone(this._queryParameters);\r\n        result._templateValues = clone(this._templateValues);\r\n        result.headers = clone(this.headers);\r\n        result.proxy = this.proxy;\r\n        result.retryCallback = this.retryCallback;\r\n        result.retryAttempts = this.retryAttempts;\r\n        result._retryCount = 0;\r\n        result.request = this.request.clone();\r\n\r\n        return result;\r\n    };\r\n\r\n    /**\r\n     * Returns the base path of the Resource.\r\n     *\r\n     * @param {Boolean} [includeQuery = false] Whether or not to include the query string and fragment form the uri\r\n     *\r\n     * @returns {String} The base URI of the resource\r\n     */\r\n    Resource.prototype.getBaseUri = function(includeQuery) {\r\n        return getBaseUri(this.getUrlComponent(includeQuery), includeQuery);\r\n    };\r\n\r\n    /**\r\n     * Appends a forward slash to the URL.\r\n     */\r\n    Resource.prototype.appendForwardSlash = function() {\r\n        this._url = appendForwardSlash(this._url);\r\n    };\r\n\r\n    /**\r\n     * Asynchronously loads the resource as raw binary data.  Returns a promise that will resolve to\r\n     * an ArrayBuffer once loaded, or reject if the resource failed to load.  The data is loaded\r\n     * using XMLHttpRequest, which means that in order to make requests to another origin,\r\n     * the server must have Cross-Origin Resource Sharing (CORS) headers enabled.\r\n     *\r\n     * @returns {Promise.<ArrayBuffer>|undefined} a promise that will resolve to the requested data when loaded. Returns undefined if <code>request.throttle</code> is true and the request does not have high enough priority.\r\n     *\r\n     * @example\r\n     * // load a single URL asynchronously\r\n     * resource.fetchArrayBuffer().then(function(arrayBuffer) {\r\n     *     // use the data\r\n     * }).otherwise(function(error) {\r\n     *     // an error occurred\r\n     * });\r\n     *\r\n     * @see {@link http://www.w3.org/TR/cors/|Cross-Origin Resource Sharing}\r\n     * @see {@link http://wiki.commonjs.org/wiki/Promises/A|CommonJS Promises/A}\r\n     */\r\n    Resource.prototype.fetchArrayBuffer = function () {\r\n        return this.fetch({\r\n            responseType : 'arraybuffer'\r\n        });\r\n    };\r\n\r\n    /**\r\n     * Creates a Resource and calls fetchArrayBuffer() on it.\r\n     *\r\n     * @param {String|Object} options A url or an object with the following properties\r\n     * @param {String} options.url The url of the resource.\r\n     * @param {Object} [options.queryParameters] An object containing query parameters that will be sent when retrieving the resource.\r\n     * @param {Object} [options.templateValues] Key/Value pairs that are used to replace template values (eg. {x}).\r\n     * @param {Object} [options.headers={}] Additional HTTP headers that will be sent.\r\n     * @param {DefaultProxy} [options.proxy] A proxy to be used when loading the resource.\r\n     * @param {Resource~RetryCallback} [options.retryCallback] The Function to call when a request for this resource fails. If it returns true, the request will be retried.\r\n     * @param {Number} [options.retryAttempts=0] The number of times the retryCallback should be called before giving up.\r\n     * @param {Request} [options.request] A Request object that will be used. Intended for internal use only.\r\n     * @returns {Promise.<ArrayBuffer>|undefined} a promise that will resolve to the requested data when loaded. Returns undefined if <code>request.throttle</code> is true and the request does not have high enough priority.\r\n     */\r\n    Resource.fetchArrayBuffer = function (options) {\r\n        var resource = new Resource(options);\r\n        return resource.fetchArrayBuffer();\r\n    };\r\n\r\n    /**\r\n     * Asynchronously loads the given resource as a blob.  Returns a promise that will resolve to\r\n     * a Blob once loaded, or reject if the resource failed to load.  The data is loaded\r\n     * using XMLHttpRequest, which means that in order to make requests to another origin,\r\n     * the server must have Cross-Origin Resource Sharing (CORS) headers enabled.\r\n     *\r\n     * @returns {Promise.<Blob>|undefined} a promise that will resolve to the requested data when loaded. Returns undefined if <code>request.throttle</code> is true and the request does not have high enough priority.\r\n     *\r\n     * @example\r\n     * // load a single URL asynchronously\r\n     * resource.fetchBlob().then(function(blob) {\r\n     *     // use the data\r\n     * }).otherwise(function(error) {\r\n     *     // an error occurred\r\n     * });\r\n     *\r\n     * @see {@link http://www.w3.org/TR/cors/|Cross-Origin Resource Sharing}\r\n     * @see {@link http://wiki.commonjs.org/wiki/Promises/A|CommonJS Promises/A}\r\n     */\r\n    Resource.prototype.fetchBlob = function () {\r\n        return this.fetch({\r\n            responseType : 'blob'\r\n        });\r\n    };\r\n\r\n    /**\r\n     * Creates a Resource and calls fetchBlob() on it.\r\n     *\r\n     * @param {String|Object} options A url or an object with the following properties\r\n     * @param {String} options.url The url of the resource.\r\n     * @param {Object} [options.queryParameters] An object containing query parameters that will be sent when retrieving the resource.\r\n     * @param {Object} [options.templateValues] Key/Value pairs that are used to replace template values (eg. {x}).\r\n     * @param {Object} [options.headers={}] Additional HTTP headers that will be sent.\r\n     * @param {DefaultProxy} [options.proxy] A proxy to be used when loading the resource.\r\n     * @param {Resource~RetryCallback} [options.retryCallback] The Function to call when a request for this resource fails. If it returns true, the request will be retried.\r\n     * @param {Number} [options.retryAttempts=0] The number of times the retryCallback should be called before giving up.\r\n     * @param {Request} [options.request] A Request object that will be used. Intended for internal use only.\r\n     * @returns {Promise.<Blob>|undefined} a promise that will resolve to the requested data when loaded. Returns undefined if <code>request.throttle</code> is true and the request does not have high enough priority.\r\n     */\r\n    Resource.fetchBlob = function (options) {\r\n        var resource = new Resource(options);\r\n        return resource.fetchBlob();\r\n    };\r\n\r\n    /**\r\n     * Asynchronously loads the given image resource.  Returns a promise that will resolve to\r\n     * an {@link https://developer.mozilla.org/en-US/docs/Web/API/ImageBitmap|ImageBitmap} if <code>preferImageBitmap</code> is true and the browser supports <code>createImageBitmap</code> or otherwise an\r\n     * {@link https://developer.mozilla.org/en-US/docs/Web/API/HTMLImageElement|Image} once loaded, or reject if the image failed to load.\r\n     *\r\n     * @param {Object} [options] An object with the following properties.\r\n     * @param {Boolean} [options.preferBlob=false] If true, we will load the image via a blob.\r\n     * @param {Boolean} [options.preferImageBitmap=false] If true, image will be decoded during fetch and an <code>ImageBitmap</code> is returned.\r\n     * @param {Boolean} [options.flipY=false] If true, image will be vertically flipped during decode. Only applies if the browser supports <code>createImageBitmap</code>.\r\n     * @returns {Promise.<ImageBitmap>|Promise.<Image>|undefined} a promise that will resolve to the requested data when loaded. Returns undefined if <code>request.throttle</code> is true and the request does not have high enough priority.\r\n     *\r\n     *\r\n     * @example\r\n     * // load a single image asynchronously\r\n     * resource.fetchImage().then(function(image) {\r\n     *     // use the loaded image\r\n     * }).otherwise(function(error) {\r\n     *     // an error occurred\r\n     * });\r\n     *\r\n     * // load several images in parallel\r\n     * when.all([resource1.fetchImage(), resource2.fetchImage()]).then(function(images) {\r\n     *     // images is an array containing all the loaded images\r\n     * });\r\n     *\r\n     * @see {@link http://www.w3.org/TR/cors/|Cross-Origin Resource Sharing}\r\n     * @see {@link http://wiki.commonjs.org/wiki/Promises/A|CommonJS Promises/A}\r\n     */\r\n    Resource.prototype.fetchImage = function (options) {\r\n        options = defaultValue(options, defaultValue.EMPTY_OBJECT);\r\n        var preferImageBitmap = defaultValue(options.preferImageBitmap, false);\r\n        var preferBlob = defaultValue(options.preferBlob, false);\r\n        var flipY = defaultValue(options.flipY, false);\r\n\r\n        checkAndResetRequest(this.request);\r\n\r\n        // We try to load the image normally if\r\n        // 1. Blobs aren't supported\r\n        // 2. It's a data URI\r\n        // 3. It's a blob URI\r\n        // 4. It doesn't have request headers and we preferBlob is false\r\n        if (!xhrBlobSupported || this.isDataUri || this.isBlobUri || (!this.hasHeaders && !preferBlob)) {\r\n            return fetchImage({\r\n                resource: this,\r\n                flipY: flipY,\r\n                preferImageBitmap: preferImageBitmap\r\n            });\r\n        }\r\n\r\n        var blobPromise = this.fetchBlob();\r\n        if (!defined(blobPromise)) {\r\n            return;\r\n        }\r\n\r\n        var supportsImageBitmap;\r\n        var useImageBitmap;\r\n        var generatedBlobResource;\r\n        var generatedBlob;\r\n        return Resource.supportsImageBitmapOptions()\r\n            .then(function(result) {\r\n                supportsImageBitmap = result;\r\n                useImageBitmap = supportsImageBitmap && preferImageBitmap;\r\n                return blobPromise;\r\n            })\r\n            .then(function(blob) {\r\n                if (!defined(blob)) {\r\n                    return;\r\n                }\r\n                generatedBlob = blob;\r\n                if (useImageBitmap) {\r\n                    return Resource.createImageBitmapFromBlob(blob, {\r\n                        flipY: flipY,\r\n                        premultiplyAlpha: false\r\n                    });\r\n                }\r\n                var blobUrl = window.URL.createObjectURL(blob);\r\n                generatedBlobResource = new Resource({\r\n                    url: blobUrl\r\n                });\r\n\r\n                return fetchImage({\r\n                    resource: generatedBlobResource,\r\n                    flipY: flipY,\r\n                    preferImageBitmap: false\r\n                });\r\n            })\r\n            .then(function(image) {\r\n                if (!defined(image)) {\r\n                    return;\r\n                }\r\n\r\n                // The blob object may be needed for use by a TileDiscardPolicy,\r\n                // so attach it to the image.\r\n                image.blob = generatedBlob;\r\n\r\n                if (useImageBitmap) {\r\n                    return image;\r\n                }\r\n\r\n                window.URL.revokeObjectURL(generatedBlobResource.url);\r\n                return image;\r\n            })\r\n            .otherwise(function(error) {\r\n                if (defined(generatedBlobResource)) {\r\n                    window.URL.revokeObjectURL(generatedBlobResource.url);\r\n                }\r\n\r\n                // If the blob load succeeded but the image decode failed, attach the blob\r\n                // to the error object for use by a TileDiscardPolicy.\r\n                // In particular, BingMapsImageryProvider uses this to detect the\r\n                // zero-length response that is returned when a tile is not available.\r\n                error.blob = generatedBlob;\r\n\r\n                return when.reject(error);\r\n            });\r\n    };\r\n\r\n    /**\r\n     * Fetches an image and returns a promise to it.\r\n     *\r\n     * @param {Object} [options] An object with the following properties.\r\n     * @param {Resource} [options.resource] Resource object that points to an image to fetch.\r\n     * @param {Boolean} [options.preferImageBitmap] If true, image will be decoded during fetch and an <code>ImageBitmap</code> is returned.\r\n     * @param {Boolean} [options.flipY] If true, image will be vertically flipped during decode. Only applies if the browser supports <code>createImageBitmap</code>.\r\n     *\r\n     * @private\r\n     */\r\n    function fetchImage(options) {\r\n        var resource = options.resource;\r\n        var flipY = options.flipY;\r\n        var preferImageBitmap = options.preferImageBitmap;\r\n\r\n        var request = resource.request;\r\n        request.url = resource.url;\r\n        request.requestFunction = function() {\r\n            var crossOrigin = false;\r\n\r\n            // data URIs can't have crossorigin set.\r\n            if (!resource.isDataUri && !resource.isBlobUri) {\r\n                crossOrigin = resource.isCrossOriginUrl;\r\n            }\r\n\r\n            var deferred = when.defer();\r\n            Resource._Implementations.createImage(request, crossOrigin, deferred, flipY, preferImageBitmap);\r\n\r\n            return deferred.promise;\r\n        };\r\n\r\n        var promise = RequestScheduler.request(request);\r\n        if (!defined(promise)) {\r\n            return;\r\n        }\r\n\r\n        return promise\r\n            .otherwise(function(e) {\r\n                // Don't retry cancelled or otherwise aborted requests\r\n                if (request.state !== RequestState.FAILED) {\r\n                    return when.reject(e);\r\n                }\r\n\r\n                return resource.retryOnError(e)\r\n                    .then(function(retry) {\r\n                        if (retry) {\r\n                            // Reset request so it can try again\r\n                            request.state = RequestState.UNISSUED;\r\n                            request.deferred = undefined;\r\n\r\n                            return fetchImage({\r\n                                resource: resource,\r\n                                flipY: flipY,\r\n                                preferImageBitmap: preferImageBitmap\r\n                            });\r\n                        }\r\n\r\n                        return when.reject(e);\r\n                    });\r\n            });\r\n    }\r\n\r\n    /**\r\n     * Creates a Resource and calls fetchImage() on it.\r\n     *\r\n     * @param {String|Object} options A url or an object with the following properties\r\n     * @param {String} options.url The url of the resource.\r\n     * @param {Object} [options.queryParameters] An object containing query parameters that will be sent when retrieving the resource.\r\n     * @param {Object} [options.templateValues] Key/Value pairs that are used to replace template values (eg. {x}).\r\n     * @param {Object} [options.headers={}] Additional HTTP headers that will be sent.\r\n     * @param {DefaultProxy} [options.proxy] A proxy to be used when loading the resource.\r\n     * @param {Boolean} [options.flipY=false] Whether to vertically flip the image during fetch and decode. Only applies when requesting an image and the browser supports <code>createImageBitmap</code>.\r\n     * @param {Resource~RetryCallback} [options.retryCallback] The Function to call when a request for this resource fails. If it returns true, the request will be retried.\r\n     * @param {Number} [options.retryAttempts=0] The number of times the retryCallback should be called before giving up.\r\n     * @param {Request} [options.request] A Request object that will be used. Intended for internal use only.\r\n     * @param {Boolean} [options.preferBlob=false]  If true, we will load the image via a blob.\r\n     * @param {Boolean} [options.preferImageBitmap=false] If true, image will be decoded during fetch and an <code>ImageBitmap</code> is returned.\r\n     * @returns {Promise.<ImageBitmap>|Promise.<Image>|undefined} a promise that will resolve to the requested data when loaded. Returns undefined if <code>request.throttle</code> is true and the request does not have high enough priority.\r\n     */\r\n    Resource.fetchImage = function (options) {\r\n        var resource = new Resource(options);\r\n        return resource.fetchImage({\r\n            flipY: options.flipY,\r\n            preferBlob: options.preferBlob,\r\n            preferImageBitmap: options.preferImageBitmap\r\n        });\r\n    };\r\n\r\n    /**\r\n     * Asynchronously loads the given resource as text.  Returns a promise that will resolve to\r\n     * a String once loaded, or reject if the resource failed to load.  The data is loaded\r\n     * using XMLHttpRequest, which means that in order to make requests to another origin,\r\n     * the server must have Cross-Origin Resource Sharing (CORS) headers enabled.\r\n     *\r\n     * @returns {Promise.<String>|undefined} a promise that will resolve to the requested data when loaded. Returns undefined if <code>request.throttle</code> is true and the request does not have high enough priority.\r\n     *\r\n     * @example\r\n     * // load text from a URL, setting a custom header\r\n     * var resource = new Resource({\r\n     *   url: 'http://someUrl.com/someJson.txt',\r\n     *   headers: {\r\n     *     'X-Custom-Header' : 'some value'\r\n     *   }\r\n     * });\r\n     * resource.fetchText().then(function(text) {\r\n     *     // Do something with the text\r\n     * }).otherwise(function(error) {\r\n     *     // an error occurred\r\n     * });\r\n     *\r\n     * @see {@link https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest|XMLHttpRequest}\r\n     * @see {@link http://www.w3.org/TR/cors/|Cross-Origin Resource Sharing}\r\n     * @see {@link http://wiki.commonjs.org/wiki/Promises/A|CommonJS Promises/A}\r\n     */\r\n    Resource.prototype.fetchText = function() {\r\n        return this.fetch({\r\n            responseType : 'text'\r\n        });\r\n    };\r\n\r\n    /**\r\n     * Creates a Resource and calls fetchText() on it.\r\n     *\r\n     * @param {String|Object} options A url or an object with the following properties\r\n     * @param {String} options.url The url of the resource.\r\n     * @param {Object} [options.queryParameters] An object containing query parameters that will be sent when retrieving the resource.\r\n     * @param {Object} [options.templateValues] Key/Value pairs that are used to replace template values (eg. {x}).\r\n     * @param {Object} [options.headers={}] Additional HTTP headers that will be sent.\r\n     * @param {DefaultProxy} [options.proxy] A proxy to be used when loading the resource.\r\n     * @param {Resource~RetryCallback} [options.retryCallback] The Function to call when a request for this resource fails. If it returns true, the request will be retried.\r\n     * @param {Number} [options.retryAttempts=0] The number of times the retryCallback should be called before giving up.\r\n     * @param {Request} [options.request] A Request object that will be used. Intended for internal use only.\r\n     * @returns {Promise.<String>|undefined} a promise that will resolve to the requested data when loaded. Returns undefined if <code>request.throttle</code> is true and the request does not have high enough priority.\r\n     */\r\n    Resource.fetchText = function (options) {\r\n        var resource = new Resource(options);\r\n        return resource.fetchText();\r\n    };\r\n\r\n    // note: &#42;&#47;&#42; below is */* but that ends the comment block early\r\n    /**\r\n     * Asynchronously loads the given resource as JSON.  Returns a promise that will resolve to\r\n     * a JSON object once loaded, or reject if the resource failed to load.  The data is loaded\r\n     * using XMLHttpRequest, which means that in order to make requests to another origin,\r\n     * the server must have Cross-Origin Resource Sharing (CORS) headers enabled. This function\r\n     * adds 'Accept: application/json,&#42;&#47;&#42;;q=0.01' to the request headers, if not\r\n     * already specified.\r\n     *\r\n     * @returns {Promise.<Object>|undefined} a promise that will resolve to the requested data when loaded. Returns undefined if <code>request.throttle</code> is true and the request does not have high enough priority.\r\n     *\r\n     *\r\n     * @example\r\n     * resource.fetchJson().then(function(jsonData) {\r\n     *     // Do something with the JSON object\r\n     * }).otherwise(function(error) {\r\n     *     // an error occurred\r\n     * });\r\n     *\r\n     * @see {@link http://www.w3.org/TR/cors/|Cross-Origin Resource Sharing}\r\n     * @see {@link http://wiki.commonjs.org/wiki/Promises/A|CommonJS Promises/A}\r\n     */\r\n    Resource.prototype.fetchJson = function() {\r\n        var promise = this.fetch({\r\n            responseType : 'text',\r\n            headers: {\r\n                Accept : 'application/json,*/*;q=0.01'\r\n            }\r\n        });\r\n\r\n        if (!defined(promise)) {\r\n            return undefined;\r\n        }\r\n\r\n        return promise\r\n            .then(function(value) {\r\n                if (!defined(value)) {\r\n                    return;\r\n                }\r\n                return JSON.parse(value);\r\n            });\r\n    };\r\n\r\n    /**\r\n     * Creates a Resource and calls fetchJson() on it.\r\n     *\r\n     * @param {String|Object} options A url or an object with the following properties\r\n     * @param {String} options.url The url of the resource.\r\n     * @param {Object} [options.queryParameters] An object containing query parameters that will be sent when retrieving the resource.\r\n     * @param {Object} [options.templateValues] Key/Value pairs that are used to replace template values (eg. {x}).\r\n     * @param {Object} [options.headers={}] Additional HTTP headers that will be sent.\r\n     * @param {DefaultProxy} [options.proxy] A proxy to be used when loading the resource.\r\n     * @param {Resource~RetryCallback} [options.retryCallback] The Function to call when a request for this resource fails. If it returns true, the request will be retried.\r\n     * @param {Number} [options.retryAttempts=0] The number of times the retryCallback should be called before giving up.\r\n     * @param {Request} [options.request] A Request object that will be used. Intended for internal use only.\r\n     * @returns {Promise.<Object>|undefined} a promise that will resolve to the requested data when loaded. Returns undefined if <code>request.throttle</code> is true and the request does not have high enough priority.\r\n     */\r\n    Resource.fetchJson = function (options) {\r\n        var resource = new Resource(options);\r\n        return resource.fetchJson();\r\n    };\r\n\r\n    /**\r\n     * Asynchronously loads the given resource as XML.  Returns a promise that will resolve to\r\n     * an XML Document once loaded, or reject if the resource failed to load.  The data is loaded\r\n     * using XMLHttpRequest, which means that in order to make requests to another origin,\r\n     * the server must have Cross-Origin Resource Sharing (CORS) headers enabled.\r\n     *\r\n     * @returns {Promise.<XMLDocument>|undefined} a promise that will resolve to the requested data when loaded. Returns undefined if <code>request.throttle</code> is true and the request does not have high enough priority.\r\n     *\r\n     *\r\n     * @example\r\n     * // load XML from a URL, setting a custom header\r\n     * Cesium.loadXML('http://someUrl.com/someXML.xml', {\r\n     *   'X-Custom-Header' : 'some value'\r\n     * }).then(function(document) {\r\n     *     // Do something with the document\r\n     * }).otherwise(function(error) {\r\n     *     // an error occurred\r\n     * });\r\n     *\r\n     * @see {@link https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest|XMLHttpRequest}\r\n     * @see {@link http://www.w3.org/TR/cors/|Cross-Origin Resource Sharing}\r\n     * @see {@link http://wiki.commonjs.org/wiki/Promises/A|CommonJS Promises/A}\r\n     */\r\n    Resource.prototype.fetchXML = function() {\r\n        return this.fetch({\r\n            responseType : 'document',\r\n            overrideMimeType : 'text/xml'\r\n        });\r\n    };\r\n\r\n    /**\r\n     * Creates a Resource and calls fetchXML() on it.\r\n     *\r\n     * @param {String|Object} options A url or an object with the following properties\r\n     * @param {String} options.url The url of the resource.\r\n     * @param {Object} [options.queryParameters] An object containing query parameters that will be sent when retrieving the resource.\r\n     * @param {Object} [options.templateValues] Key/Value pairs that are used to replace template values (eg. {x}).\r\n     * @param {Object} [options.headers={}] Additional HTTP headers that will be sent.\r\n     * @param {DefaultProxy} [options.proxy] A proxy to be used when loading the resource.\r\n     * @param {Resource~RetryCallback} [options.retryCallback] The Function to call when a request for this resource fails. If it returns true, the request will be retried.\r\n     * @param {Number} [options.retryAttempts=0] The number of times the retryCallback should be called before giving up.\r\n     * @param {Request} [options.request] A Request object that will be used. Intended for internal use only.\r\n     * @returns {Promise.<XMLDocument>|undefined} a promise that will resolve to the requested data when loaded. Returns undefined if <code>request.throttle</code> is true and the request does not have high enough priority.\r\n     */\r\n    Resource.fetchXML = function (options) {\r\n        var resource = new Resource(options);\r\n        return resource.fetchXML();\r\n    };\r\n\r\n    /**\r\n     * Requests a resource using JSONP.\r\n     *\r\n     * @param {String} [callbackParameterName='callback'] The callback parameter name that the server expects.\r\n     * @returns {Promise.<Object>|undefined} a promise that will resolve to the requested data when loaded. Returns undefined if <code>request.throttle</code> is true and the request does not have high enough priority.\r\n     *\r\n     *\r\n     * @example\r\n     * // load a data asynchronously\r\n     * resource.fetchJsonp().then(function(data) {\r\n     *     // use the loaded data\r\n     * }).otherwise(function(error) {\r\n     *     // an error occurred\r\n     * });\r\n     *\r\n     * @see {@link http://wiki.commonjs.org/wiki/Promises/A|CommonJS Promises/A}\r\n     */\r\n    Resource.prototype.fetchJsonp = function(callbackParameterName) {\r\n        callbackParameterName = defaultValue(callbackParameterName, 'callback');\r\n\r\n        checkAndResetRequest(this.request);\r\n\r\n        //generate a unique function name\r\n        var functionName;\r\n        do {\r\n            functionName = 'loadJsonp' + Math.random().toString().substring(2, 8);\r\n        } while (defined(window[functionName]));\r\n\r\n        return fetchJsonp(this, callbackParameterName, functionName);\r\n    };\r\n\r\n    function fetchJsonp(resource, callbackParameterName, functionName) {\r\n        var callbackQuery = {};\r\n        callbackQuery[callbackParameterName] = functionName;\r\n        resource.setQueryParameters(callbackQuery);\r\n\r\n        var request = resource.request;\r\n        request.url = resource.url;\r\n        request.requestFunction = function() {\r\n            var deferred = when.defer();\r\n\r\n            //assign a function with that name in the global scope\r\n            window[functionName] = function(data) {\r\n                deferred.resolve(data);\r\n\r\n                try {\r\n                    delete window[functionName];\r\n                } catch (e) {\r\n                    window[functionName] = undefined;\r\n                }\r\n            };\r\n\r\n            Resource._Implementations.loadAndExecuteScript(resource.url, functionName, deferred);\r\n            return deferred.promise;\r\n        };\r\n\r\n        var promise = RequestScheduler.request(request);\r\n        if (!defined(promise)) {\r\n            return;\r\n        }\r\n\r\n        return promise\r\n            .otherwise(function(e) {\r\n                if (request.state !== RequestState.FAILED) {\r\n                    return when.reject(e);\r\n                }\r\n\r\n                return resource.retryOnError(e)\r\n                    .then(function(retry) {\r\n                        if (retry) {\r\n                            // Reset request so it can try again\r\n                            request.state = RequestState.UNISSUED;\r\n                            request.deferred = undefined;\r\n\r\n                            return fetchJsonp(resource, callbackParameterName, functionName);\r\n                        }\r\n\r\n                        return when.reject(e);\r\n                    });\r\n            });\r\n    }\r\n\r\n    /**\r\n     * Creates a Resource from a URL and calls fetchJsonp() on it.\r\n     *\r\n     * @param {String|Object} options A url or an object with the following properties\r\n     * @param {String} options.url The url of the resource.\r\n     * @param {Object} [options.queryParameters] An object containing query parameters that will be sent when retrieving the resource.\r\n     * @param {Object} [options.templateValues] Key/Value pairs that are used to replace template values (eg. {x}).\r\n     * @param {Object} [options.headers={}] Additional HTTP headers that will be sent.\r\n     * @param {DefaultProxy} [options.proxy] A proxy to be used when loading the resource.\r\n     * @param {Resource~RetryCallback} [options.retryCallback] The Function to call when a request for this resource fails. If it returns true, the request will be retried.\r\n     * @param {Number} [options.retryAttempts=0] The number of times the retryCallback should be called before giving up.\r\n     * @param {Request} [options.request] A Request object that will be used. Intended for internal use only.\r\n     * @param {String} [options.callbackParameterName='callback'] The callback parameter name that the server expects.\r\n     * @returns {Promise.<Object>|undefined} a promise that will resolve to the requested data when loaded. Returns undefined if <code>request.throttle</code> is true and the request does not have high enough priority.\r\n     */\r\n    Resource.fetchJsonp = function (options) {\r\n        var resource = new Resource(options);\r\n        return resource.fetchJsonp(options.callbackParameterName);\r\n    };\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    Resource.prototype._makeRequest = function(options) {\r\n        var resource = this;\r\n        checkAndResetRequest(resource.request);\r\n\r\n        var request = resource.request;\r\n        request.url = resource.url;\r\n\r\n        request.requestFunction = function() {\r\n            var responseType = options.responseType;\r\n            var headers = combine(options.headers, resource.headers);\r\n            var overrideMimeType = options.overrideMimeType;\r\n            var method = options.method;\r\n            var data = options.data;\r\n            var deferred = when.defer();\r\n            var xhr = Resource._Implementations.loadWithXhr(resource.url, responseType, method, data, headers, deferred, overrideMimeType);\r\n            if (defined(xhr) && defined(xhr.abort)) {\r\n                request.cancelFunction = function() {\r\n                    xhr.abort();\r\n                };\r\n            }\r\n            return deferred.promise;\r\n        };\r\n\r\n        var promise = RequestScheduler.request(request);\r\n        if (!defined(promise)) {\r\n            return;\r\n        }\r\n\r\n        return promise\r\n            .then(function(data) {\r\n                return data;\r\n            })\r\n            .otherwise(function(e) {\r\n                if (request.state !== RequestState.FAILED) {\r\n                    return when.reject(e);\r\n                }\r\n\r\n                return resource.retryOnError(e)\r\n                    .then(function(retry) {\r\n                        if (retry) {\r\n                            // Reset request so it can try again\r\n                            request.state = RequestState.UNISSUED;\r\n                            request.deferred = undefined;\r\n\r\n                            return resource.fetch(options);\r\n                        }\r\n\r\n                        return when.reject(e);\r\n                    });\r\n            });\r\n    };\r\n\r\n    var dataUriRegex = /^data:(.*?)(;base64)?,(.*)$/;\r\n\r\n    function decodeDataUriText(isBase64, data) {\r\n        var result = decodeURIComponent(data);\r\n        if (isBase64) {\r\n            return atob(result);\r\n        }\r\n        return result;\r\n    }\r\n\r\n    function decodeDataUriArrayBuffer(isBase64, data) {\r\n        var byteString = decodeDataUriText(isBase64, data);\r\n        var buffer = new ArrayBuffer(byteString.length);\r\n        var view = new Uint8Array(buffer);\r\n        for (var i = 0; i < byteString.length; i++) {\r\n            view[i] = byteString.charCodeAt(i);\r\n        }\r\n        return buffer;\r\n    }\r\n\r\n    function decodeDataUri(dataUriRegexResult, responseType) {\r\n        responseType = defaultValue(responseType, '');\r\n        var mimeType = dataUriRegexResult[1];\r\n        var isBase64 = !!dataUriRegexResult[2];\r\n        var data = dataUriRegexResult[3];\r\n\r\n        switch (responseType) {\r\n            case '':\r\n            case 'text':\r\n                return decodeDataUriText(isBase64, data);\r\n            case 'arraybuffer':\r\n                return decodeDataUriArrayBuffer(isBase64, data);\r\n            case 'blob':\r\n                var buffer = decodeDataUriArrayBuffer(isBase64, data);\r\n                return new Blob([buffer], {\r\n                    type : mimeType\r\n                });\r\n            case 'document':\r\n                var parser = new DOMParser();\r\n                return parser.parseFromString(decodeDataUriText(isBase64, data), mimeType);\r\n            case 'json':\r\n                return JSON.parse(decodeDataUriText(isBase64, data));\r\n            default:\r\n                //>>includeStart('debug', pragmas.debug);\r\n                throw new DeveloperError('Unhandled responseType: ' + responseType);\r\n            //>>includeEnd('debug');\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Asynchronously loads the given resource.  Returns a promise that will resolve to\r\n     * the result once loaded, or reject if the resource failed to load.  The data is loaded\r\n     * using XMLHttpRequest, which means that in order to make requests to another origin,\r\n     * the server must have Cross-Origin Resource Sharing (CORS) headers enabled. It's recommended that you use\r\n     * the more specific functions eg. fetchJson, fetchBlob, etc.\r\n     *\r\n     * @param {Object} [options] Object with the following properties:\r\n     * @param {String} [options.responseType] The type of response.  This controls the type of item returned.\r\n     * @param {Object} [options.headers] Additional HTTP headers to send with the request, if any.\r\n     * @param {String} [options.overrideMimeType] Overrides the MIME type returned by the server.\r\n     * @returns {Promise.<Object>|undefined} a promise that will resolve to the requested data when loaded. Returns undefined if <code>request.throttle</code> is true and the request does not have high enough priority.\r\n     *\r\n     *\r\n     * @example\r\n     * resource.fetch()\r\n     *   .then(function(body) {\r\n     *       // use the data\r\n     *   }).otherwise(function(error) {\r\n     *       // an error occurred\r\n     *   });\r\n     *\r\n     * @see {@link http://www.w3.org/TR/cors/|Cross-Origin Resource Sharing}\r\n     * @see {@link http://wiki.commonjs.org/wiki/Promises/A|CommonJS Promises/A}\r\n     */\r\n    Resource.prototype.fetch = function(options) {\r\n        options = defaultClone(options, {});\r\n        options.method = 'GET';\r\n\r\n        return this._makeRequest(options);\r\n    };\r\n\r\n    /**\r\n     * Creates a Resource from a URL and calls fetch() on it.\r\n     *\r\n     * @param {String|Object} options A url or an object with the following properties\r\n     * @param {String} options.url The url of the resource.\r\n     * @param {Object} [options.queryParameters] An object containing query parameters that will be sent when retrieving the resource.\r\n     * @param {Object} [options.templateValues] Key/Value pairs that are used to replace template values (eg. {x}).\r\n     * @param {Object} [options.headers={}] Additional HTTP headers that will be sent.\r\n     * @param {DefaultProxy} [options.proxy] A proxy to be used when loading the resource.\r\n     * @param {Resource~RetryCallback} [options.retryCallback] The Function to call when a request for this resource fails. If it returns true, the request will be retried.\r\n     * @param {Number} [options.retryAttempts=0] The number of times the retryCallback should be called before giving up.\r\n     * @param {Request} [options.request] A Request object that will be used. Intended for internal use only.\r\n     * @param {String} [options.responseType] The type of response.  This controls the type of item returned.\r\n     * @param {String} [options.overrideMimeType] Overrides the MIME type returned by the server.\r\n     * @returns {Promise.<Object>|undefined} a promise that will resolve to the requested data when loaded. Returns undefined if <code>request.throttle</code> is true and the request does not have high enough priority.\r\n     */\r\n    Resource.fetch = function (options) {\r\n        var resource = new Resource(options);\r\n        return resource.fetch({\r\n            // Make copy of just the needed fields because headers can be passed to both the constructor and to fetch\r\n            responseType: options.responseType,\r\n            overrideMimeType: options.overrideMimeType\r\n        });\r\n    };\r\n\r\n    /**\r\n     * Asynchronously deletes the given resource.  Returns a promise that will resolve to\r\n     * the result once loaded, or reject if the resource failed to load.  The data is loaded\r\n     * using XMLHttpRequest, which means that in order to make requests to another origin,\r\n     * the server must have Cross-Origin Resource Sharing (CORS) headers enabled.\r\n     *\r\n     * @param {Object} [options] Object with the following properties:\r\n     * @param {String} [options.responseType] The type of response.  This controls the type of item returned.\r\n     * @param {Object} [options.headers] Additional HTTP headers to send with the request, if any.\r\n     * @param {String} [options.overrideMimeType] Overrides the MIME type returned by the server.\r\n     * @returns {Promise.<Object>|undefined} a promise that will resolve to the requested data when loaded. Returns undefined if <code>request.throttle</code> is true and the request does not have high enough priority.\r\n     *\r\n     *\r\n     * @example\r\n     * resource.delete()\r\n     *   .then(function(body) {\r\n     *       // use the data\r\n     *   }).otherwise(function(error) {\r\n     *       // an error occurred\r\n     *   });\r\n     *\r\n     * @see {@link http://www.w3.org/TR/cors/|Cross-Origin Resource Sharing}\r\n     * @see {@link http://wiki.commonjs.org/wiki/Promises/A|CommonJS Promises/A}\r\n     */\r\n    Resource.prototype.delete = function(options) {\r\n        options = defaultClone(options, {});\r\n        options.method = 'DELETE';\r\n\r\n        return this._makeRequest(options);\r\n    };\r\n\r\n    /**\r\n     * Creates a Resource from a URL and calls delete() on it.\r\n     *\r\n     * @param {String|Object} options A url or an object with the following properties\r\n     * @param {String} options.url The url of the resource.\r\n     * @param {Object} [options.data] Data that is posted with the resource.\r\n     * @param {Object} [options.queryParameters] An object containing query parameters that will be sent when retrieving the resource.\r\n     * @param {Object} [options.templateValues] Key/Value pairs that are used to replace template values (eg. {x}).\r\n     * @param {Object} [options.headers={}] Additional HTTP headers that will be sent.\r\n     * @param {DefaultProxy} [options.proxy] A proxy to be used when loading the resource.\r\n     * @param {Resource~RetryCallback} [options.retryCallback] The Function to call when a request for this resource fails. If it returns true, the request will be retried.\r\n     * @param {Number} [options.retryAttempts=0] The number of times the retryCallback should be called before giving up.\r\n     * @param {Request} [options.request] A Request object that will be used. Intended for internal use only.\r\n     * @param {String} [options.responseType] The type of response.  This controls the type of item returned.\r\n     * @param {String} [options.overrideMimeType] Overrides the MIME type returned by the server.\r\n     * @returns {Promise.<Object>|undefined} a promise that will resolve to the requested data when loaded. Returns undefined if <code>request.throttle</code> is true and the request does not have high enough priority.\r\n     */\r\n    Resource.delete = function (options) {\r\n        var resource = new Resource(options);\r\n        return resource.delete({\r\n            // Make copy of just the needed fields because headers can be passed to both the constructor and to fetch\r\n            responseType: options.responseType,\r\n            overrideMimeType: options.overrideMimeType,\r\n            data: options.data\r\n        });\r\n    };\r\n\r\n    /**\r\n     * Asynchronously gets headers the given resource.  Returns a promise that will resolve to\r\n     * the result once loaded, or reject if the resource failed to load.  The data is loaded\r\n     * using XMLHttpRequest, which means that in order to make requests to another origin,\r\n     * the server must have Cross-Origin Resource Sharing (CORS) headers enabled.\r\n     *\r\n     * @param {Object} [options] Object with the following properties:\r\n     * @param {String} [options.responseType] The type of response.  This controls the type of item returned.\r\n     * @param {Object} [options.headers] Additional HTTP headers to send with the request, if any.\r\n     * @param {String} [options.overrideMimeType] Overrides the MIME type returned by the server.\r\n     * @returns {Promise.<Object>|undefined} a promise that will resolve to the requested data when loaded. Returns undefined if <code>request.throttle</code> is true and the request does not have high enough priority.\r\n     *\r\n     *\r\n     * @example\r\n     * resource.head()\r\n     *   .then(function(headers) {\r\n     *       // use the data\r\n     *   }).otherwise(function(error) {\r\n     *       // an error occurred\r\n     *   });\r\n     *\r\n     * @see {@link http://www.w3.org/TR/cors/|Cross-Origin Resource Sharing}\r\n     * @see {@link http://wiki.commonjs.org/wiki/Promises/A|CommonJS Promises/A}\r\n     */\r\n    Resource.prototype.head = function(options) {\r\n        options = defaultClone(options, {});\r\n        options.method = 'HEAD';\r\n\r\n        return this._makeRequest(options);\r\n    };\r\n\r\n    /**\r\n     * Creates a Resource from a URL and calls head() on it.\r\n     *\r\n     * @param {String|Object} options A url or an object with the following properties\r\n     * @param {String} options.url The url of the resource.\r\n     * @param {Object} [options.queryParameters] An object containing query parameters that will be sent when retrieving the resource.\r\n     * @param {Object} [options.templateValues] Key/Value pairs that are used to replace template values (eg. {x}).\r\n     * @param {Object} [options.headers={}] Additional HTTP headers that will be sent.\r\n     * @param {DefaultProxy} [options.proxy] A proxy to be used when loading the resource.\r\n     * @param {Resource~RetryCallback} [options.retryCallback] The Function to call when a request for this resource fails. If it returns true, the request will be retried.\r\n     * @param {Number} [options.retryAttempts=0] The number of times the retryCallback should be called before giving up.\r\n     * @param {Request} [options.request] A Request object that will be used. Intended for internal use only.\r\n     * @param {String} [options.responseType] The type of response.  This controls the type of item returned.\r\n     * @param {String} [options.overrideMimeType] Overrides the MIME type returned by the server.\r\n     * @returns {Promise.<Object>|undefined} a promise that will resolve to the requested data when loaded. Returns undefined if <code>request.throttle</code> is true and the request does not have high enough priority.\r\n     */\r\n    Resource.head = function (options) {\r\n        var resource = new Resource(options);\r\n        return resource.head({\r\n            // Make copy of just the needed fields because headers can be passed to both the constructor and to fetch\r\n            responseType: options.responseType,\r\n            overrideMimeType: options.overrideMimeType\r\n        });\r\n    };\r\n\r\n    /**\r\n     * Asynchronously gets options the given resource.  Returns a promise that will resolve to\r\n     * the result once loaded, or reject if the resource failed to load.  The data is loaded\r\n     * using XMLHttpRequest, which means that in order to make requests to another origin,\r\n     * the server must have Cross-Origin Resource Sharing (CORS) headers enabled.\r\n     *\r\n     * @param {Object} [options] Object with the following properties:\r\n     * @param {String} [options.responseType] The type of response.  This controls the type of item returned.\r\n     * @param {Object} [options.headers] Additional HTTP headers to send with the request, if any.\r\n     * @param {String} [options.overrideMimeType] Overrides the MIME type returned by the server.\r\n     * @returns {Promise.<Object>|undefined} a promise that will resolve to the requested data when loaded. Returns undefined if <code>request.throttle</code> is true and the request does not have high enough priority.\r\n     *\r\n     *\r\n     * @example\r\n     * resource.options()\r\n     *   .then(function(headers) {\r\n     *       // use the data\r\n     *   }).otherwise(function(error) {\r\n     *       // an error occurred\r\n     *   });\r\n     *\r\n     * @see {@link http://www.w3.org/TR/cors/|Cross-Origin Resource Sharing}\r\n     * @see {@link http://wiki.commonjs.org/wiki/Promises/A|CommonJS Promises/A}\r\n     */\r\n    Resource.prototype.options = function(options) {\r\n        options = defaultClone(options, {});\r\n        options.method = 'OPTIONS';\r\n\r\n        return this._makeRequest(options);\r\n    };\r\n\r\n    /**\r\n     * Creates a Resource from a URL and calls options() on it.\r\n     *\r\n     * @param {String|Object} options A url or an object with the following properties\r\n     * @param {String} options.url The url of the resource.\r\n     * @param {Object} [options.queryParameters] An object containing query parameters that will be sent when retrieving the resource.\r\n     * @param {Object} [options.templateValues] Key/Value pairs that are used to replace template values (eg. {x}).\r\n     * @param {Object} [options.headers={}] Additional HTTP headers that will be sent.\r\n     * @param {DefaultProxy} [options.proxy] A proxy to be used when loading the resource.\r\n     * @param {Resource~RetryCallback} [options.retryCallback] The Function to call when a request for this resource fails. If it returns true, the request will be retried.\r\n     * @param {Number} [options.retryAttempts=0] The number of times the retryCallback should be called before giving up.\r\n     * @param {Request} [options.request] A Request object that will be used. Intended for internal use only.\r\n     * @param {String} [options.responseType] The type of response.  This controls the type of item returned.\r\n     * @param {String} [options.overrideMimeType] Overrides the MIME type returned by the server.\r\n     * @returns {Promise.<Object>|undefined} a promise that will resolve to the requested data when loaded. Returns undefined if <code>request.throttle</code> is true and the request does not have high enough priority.\r\n     */\r\n    Resource.options = function (options) {\r\n        var resource = new Resource(options);\r\n        return resource.options({\r\n            // Make copy of just the needed fields because headers can be passed to both the constructor and to fetch\r\n            responseType: options.responseType,\r\n            overrideMimeType: options.overrideMimeType\r\n        });\r\n    };\r\n\r\n    /**\r\n     * Asynchronously posts data to the given resource.  Returns a promise that will resolve to\r\n     * the result once loaded, or reject if the resource failed to load.  The data is loaded\r\n     * using XMLHttpRequest, which means that in order to make requests to another origin,\r\n     * the server must have Cross-Origin Resource Sharing (CORS) headers enabled.\r\n     *\r\n     * @param {Object} data Data that is posted with the resource.\r\n     * @param {Object} [options] Object with the following properties:\r\n     * @param {Object} [options.data] Data that is posted with the resource.\r\n     * @param {String} [options.responseType] The type of response.  This controls the type of item returned.\r\n     * @param {Object} [options.headers] Additional HTTP headers to send with the request, if any.\r\n     * @param {String} [options.overrideMimeType] Overrides the MIME type returned by the server.\r\n     * @returns {Promise.<Object>|undefined} a promise that will resolve to the requested data when loaded. Returns undefined if <code>request.throttle</code> is true and the request does not have high enough priority.\r\n     *\r\n     *\r\n     * @example\r\n     * resource.post(data)\r\n     *   .then(function(result) {\r\n     *       // use the result\r\n     *   }).otherwise(function(error) {\r\n     *       // an error occurred\r\n     *   });\r\n     *\r\n     * @see {@link http://www.w3.org/TR/cors/|Cross-Origin Resource Sharing}\r\n     * @see {@link http://wiki.commonjs.org/wiki/Promises/A|CommonJS Promises/A}\r\n     */\r\n    Resource.prototype.post = function(data, options) {\r\n        Check.defined('data', data);\r\n\r\n        options = defaultClone(options, {});\r\n        options.method = 'POST';\r\n        options.data = data;\r\n\r\n        return this._makeRequest(options);\r\n    };\r\n\r\n    /**\r\n     * Creates a Resource from a URL and calls post() on it.\r\n     *\r\n     * @param {Object} options A url or an object with the following properties\r\n     * @param {String} options.url The url of the resource.\r\n     * @param {Object} options.data Data that is posted with the resource.\r\n     * @param {Object} [options.queryParameters] An object containing query parameters that will be sent when retrieving the resource.\r\n     * @param {Object} [options.templateValues] Key/Value pairs that are used to replace template values (eg. {x}).\r\n     * @param {Object} [options.headers={}] Additional HTTP headers that will be sent.\r\n     * @param {DefaultProxy} [options.proxy] A proxy to be used when loading the resource.\r\n     * @param {Resource~RetryCallback} [options.retryCallback] The Function to call when a request for this resource fails. If it returns true, the request will be retried.\r\n     * @param {Number} [options.retryAttempts=0] The number of times the retryCallback should be called before giving up.\r\n     * @param {Request} [options.request] A Request object that will be used. Intended for internal use only.\r\n     * @param {String} [options.responseType] The type of response.  This controls the type of item returned.\r\n     * @param {String} [options.overrideMimeType] Overrides the MIME type returned by the server.\r\n     * @returns {Promise.<Object>|undefined} a promise that will resolve to the requested data when loaded. Returns undefined if <code>request.throttle</code> is true and the request does not have high enough priority.\r\n     */\r\n    Resource.post = function (options) {\r\n        var resource = new Resource(options);\r\n        return resource.post(options.data, {\r\n            // Make copy of just the needed fields because headers can be passed to both the constructor and to post\r\n            responseType: options.responseType,\r\n            overrideMimeType: options.overrideMimeType\r\n        });\r\n    };\r\n\r\n    /**\r\n     * Asynchronously puts data to the given resource.  Returns a promise that will resolve to\r\n     * the result once loaded, or reject if the resource failed to load.  The data is loaded\r\n     * using XMLHttpRequest, which means that in order to make requests to another origin,\r\n     * the server must have Cross-Origin Resource Sharing (CORS) headers enabled.\r\n     *\r\n     * @param {Object} data Data that is posted with the resource.\r\n     * @param {Object} [options] Object with the following properties:\r\n     * @param {String} [options.responseType] The type of response.  This controls the type of item returned.\r\n     * @param {Object} [options.headers] Additional HTTP headers to send with the request, if any.\r\n     * @param {String} [options.overrideMimeType] Overrides the MIME type returned by the server.\r\n     * @returns {Promise.<Object>|undefined} a promise that will resolve to the requested data when loaded. Returns undefined if <code>request.throttle</code> is true and the request does not have high enough priority.\r\n     *\r\n     *\r\n     * @example\r\n     * resource.put(data)\r\n     *   .then(function(result) {\r\n     *       // use the result\r\n     *   }).otherwise(function(error) {\r\n     *       // an error occurred\r\n     *   });\r\n     *\r\n     * @see {@link http://www.w3.org/TR/cors/|Cross-Origin Resource Sharing}\r\n     * @see {@link http://wiki.commonjs.org/wiki/Promises/A|CommonJS Promises/A}\r\n     */\r\n    Resource.prototype.put = function(data, options) {\r\n        Check.defined('data', data);\r\n\r\n        options = defaultClone(options, {});\r\n        options.method = 'PUT';\r\n        options.data = data;\r\n\r\n        return this._makeRequest(options);\r\n    };\r\n\r\n    /**\r\n     * Creates a Resource from a URL and calls put() on it.\r\n     *\r\n     * @param {Object} options A url or an object with the following properties\r\n     * @param {String} options.url The url of the resource.\r\n     * @param {Object} options.data Data that is posted with the resource.\r\n     * @param {Object} [options.queryParameters] An object containing query parameters that will be sent when retrieving the resource.\r\n     * @param {Object} [options.templateValues] Key/Value pairs that are used to replace template values (eg. {x}).\r\n     * @param {Object} [options.headers={}] Additional HTTP headers that will be sent.\r\n     * @param {DefaultProxy} [options.proxy] A proxy to be used when loading the resource.\r\n     * @param {Resource~RetryCallback} [options.retryCallback] The Function to call when a request for this resource fails. If it returns true, the request will be retried.\r\n     * @param {Number} [options.retryAttempts=0] The number of times the retryCallback should be called before giving up.\r\n     * @param {Request} [options.request] A Request object that will be used. Intended for internal use only.\r\n     * @param {String} [options.responseType] The type of response.  This controls the type of item returned.\r\n     * @param {String} [options.overrideMimeType] Overrides the MIME type returned by the server.\r\n     * @returns {Promise.<Object>|undefined} a promise that will resolve to the requested data when loaded. Returns undefined if <code>request.throttle</code> is true and the request does not have high enough priority.\r\n     */\r\n    Resource.put = function (options) {\r\n        var resource = new Resource(options);\r\n        return resource.put(options.data, {\r\n            // Make copy of just the needed fields because headers can be passed to both the constructor and to post\r\n            responseType: options.responseType,\r\n            overrideMimeType: options.overrideMimeType\r\n        });\r\n    };\r\n\r\n    /**\r\n     * Asynchronously patches data to the given resource.  Returns a promise that will resolve to\r\n     * the result once loaded, or reject if the resource failed to load.  The data is loaded\r\n     * using XMLHttpRequest, which means that in order to make requests to another origin,\r\n     * the server must have Cross-Origin Resource Sharing (CORS) headers enabled.\r\n     *\r\n     * @param {Object} data Data that is posted with the resource.\r\n     * @param {Object} [options] Object with the following properties:\r\n     * @param {String} [options.responseType] The type of response.  This controls the type of item returned.\r\n     * @param {Object} [options.headers] Additional HTTP headers to send with the request, if any.\r\n     * @param {String} [options.overrideMimeType] Overrides the MIME type returned by the server.\r\n     * @returns {Promise.<Object>|undefined} a promise that will resolve to the requested data when loaded. Returns undefined if <code>request.throttle</code> is true and the request does not have high enough priority.\r\n     *\r\n     *\r\n     * @example\r\n     * resource.patch(data)\r\n     *   .then(function(result) {\r\n     *       // use the result\r\n     *   }).otherwise(function(error) {\r\n     *       // an error occurred\r\n     *   });\r\n     *\r\n     * @see {@link http://www.w3.org/TR/cors/|Cross-Origin Resource Sharing}\r\n     * @see {@link http://wiki.commonjs.org/wiki/Promises/A|CommonJS Promises/A}\r\n     */\r\n    Resource.prototype.patch = function(data, options) {\r\n        Check.defined('data', data);\r\n\r\n        options = defaultClone(options, {});\r\n        options.method = 'PATCH';\r\n        options.data = data;\r\n\r\n        return this._makeRequest(options);\r\n    };\r\n\r\n    /**\r\n     * Creates a Resource from a URL and calls patch() on it.\r\n     *\r\n     * @param {Object} options A url or an object with the following properties\r\n     * @param {String} options.url The url of the resource.\r\n     * @param {Object} options.data Data that is posted with the resource.\r\n     * @param {Object} [options.queryParameters] An object containing query parameters that will be sent when retrieving the resource.\r\n     * @param {Object} [options.templateValues] Key/Value pairs that are used to replace template values (eg. {x}).\r\n     * @param {Object} [options.headers={}] Additional HTTP headers that will be sent.\r\n     * @param {DefaultProxy} [options.proxy] A proxy to be used when loading the resource.\r\n     * @param {Resource~RetryCallback} [options.retryCallback] The Function to call when a request for this resource fails. If it returns true, the request will be retried.\r\n     * @param {Number} [options.retryAttempts=0] The number of times the retryCallback should be called before giving up.\r\n     * @param {Request} [options.request] A Request object that will be used. Intended for internal use only.\r\n     * @param {String} [options.responseType] The type of response.  This controls the type of item returned.\r\n     * @param {String} [options.overrideMimeType] Overrides the MIME type returned by the server.\r\n     * @returns {Promise.<Object>|undefined} a promise that will resolve to the requested data when loaded. Returns undefined if <code>request.throttle</code> is true and the request does not have high enough priority.\r\n     */\r\n    Resource.patch = function (options) {\r\n        var resource = new Resource(options);\r\n        return resource.patch(options.data, {\r\n            // Make copy of just the needed fields because headers can be passed to both the constructor and to post\r\n            responseType: options.responseType,\r\n            overrideMimeType: options.overrideMimeType\r\n        });\r\n    };\r\n\r\n    /**\r\n     * Contains implementations of functions that can be replaced for testing\r\n     *\r\n     * @private\r\n     */\r\n    Resource._Implementations = {};\r\n\r\n    function loadImageElement(url, crossOrigin, deferred) {\r\n        var image = new Image();\r\n\r\n        image.onload = function() {\r\n            deferred.resolve(image);\r\n        };\r\n\r\n        image.onerror = function(e) {\r\n            deferred.reject(e);\r\n        };\r\n\r\n        if (crossOrigin) {\r\n            if (TrustedServers.contains(url)) {\r\n                image.crossOrigin = 'use-credentials';\r\n            } else {\r\n                image.crossOrigin = '';\r\n            }\r\n        }\r\n\r\n        image.src = url;\r\n    }\r\n\r\n    Resource._Implementations.createImage = function(request, crossOrigin, deferred, flipY, preferImageBitmap) {\r\n        var url = request.url;\r\n        // Passing an Image to createImageBitmap will force it to run on the main thread\r\n        // since DOM elements don't exist on workers. We convert it to a blob so it's non-blocking.\r\n        // See:\r\n        //    https://bugzilla.mozilla.org/show_bug.cgi?id=1044102#c38\r\n        //    https://bugs.chromium.org/p/chromium/issues/detail?id=580202#c10\r\n        Resource.supportsImageBitmapOptions()\r\n            .then(function(supportsImageBitmap) {\r\n                // We can only use ImageBitmap if we can flip on decode.\r\n                // See: https://github.com/CesiumGS/cesium/pull/7579#issuecomment-466146898\r\n                if (!(supportsImageBitmap && preferImageBitmap)) {\r\n                    loadImageElement(url, crossOrigin, deferred);\r\n                    return;\r\n                }\r\n                var responseType = 'blob';\r\n                var method = 'GET';\r\n                var xhrDeferred = when.defer();\r\n                var xhr = Resource._Implementations.loadWithXhr(\r\n                    url,\r\n                    responseType,\r\n                    method,\r\n                    undefined,\r\n                    undefined,\r\n                    xhrDeferred,\r\n                    undefined,\r\n                    undefined,\r\n                    undefined\r\n                );\r\n\r\n                if (defined(xhr) && defined(xhr.abort)) {\r\n                    request.cancelFunction = function() {\r\n                        xhr.abort();\r\n                    };\r\n                }\r\n                return xhrDeferred.promise.then(function(blob) {\r\n                    if (!defined(blob)) {\r\n                        deferred.reject(new RuntimeError('Successfully retrieved ' + url + ' but it contained no content.'));\r\n                        return;\r\n                    }\r\n\r\n                    return Resource.createImageBitmapFromBlob(blob, {\r\n                        flipY: flipY,\r\n                        premultiplyAlpha: false\r\n                    });\r\n                }).then(deferred.resolve);\r\n            })\r\n            .otherwise(deferred.reject);\r\n    };\r\n\r\n    /**\r\n     * Wrapper for createImageBitmap\r\n     *\r\n     * @private\r\n     */\r\n    Resource.createImageBitmapFromBlob = function(blob, options) {\r\n        Check.defined('options', options);\r\n        Check.typeOf.bool('options.flipY', options.flipY);\r\n        Check.typeOf.bool('options.premultiplyAlpha', options.premultiplyAlpha);\r\n\r\n        return createImageBitmap(blob, {\r\n            imageOrientation: options.flipY ? 'flipY' : 'none',\r\n            premultiplyAlpha: options.premultiplyAlpha ? 'premultiply' : 'none'\r\n        });\r\n    };\r\n\r\n    function decodeResponse(loadWithHttpResponse, responseType) {\r\n        switch (responseType) {\r\n          case 'text':\r\n              return loadWithHttpResponse.toString('utf8');\r\n          case 'json':\r\n              return JSON.parse(loadWithHttpResponse.toString('utf8'));\r\n          default:\r\n              return new Uint8Array(loadWithHttpResponse).buffer;\r\n        }\r\n    }\r\n\r\n    function loadWithHttpRequest(url, responseType, method, data, headers, deferred, overrideMimeType) {\r\n        // Note: only the 'json' and 'text' responseTypes transforms the loaded buffer\r\n        var URL = require('url').parse(url); // eslint-disable-line\r\n        var http = URL.protocol === 'https:' ? require('https') : require('http'); // eslint-disable-line\r\n        var zlib = require('zlib'); // eslint-disable-line\r\n        var options = {\r\n            protocol : URL.protocol,\r\n            hostname : URL.hostname,\r\n            port : URL.port,\r\n            path : URL.path,\r\n            query : URL.query,\r\n            method : method,\r\n            headers : headers\r\n        };\r\n\r\n        http.request(options)\r\n            .on('response', function(res) {\r\n                if (res.statusCode < 200 || res.statusCode >= 300) {\r\n                    deferred.reject(new RequestErrorEvent(res.statusCode, res, res.headers));\r\n                    return;\r\n                }\r\n\r\n                var chunkArray = [];\r\n                res.on('data', function(chunk) {\r\n                    chunkArray.push(chunk);\r\n                });\r\n\r\n                res.on('end', function() {\r\n                    var result = Buffer.concat(chunkArray); // eslint-disable-line\r\n                    if (res.headers['content-encoding'] === 'gzip') {\r\n                        zlib.gunzip(result, function(error, resultUnzipped) {\r\n                            if (error) {\r\n                                deferred.reject(new RuntimeError('Error decompressing response.'));\r\n                            } else {\r\n                                deferred.resolve(decodeResponse(resultUnzipped, responseType));\r\n                            }\r\n                        });\r\n                    } else {\r\n                        deferred.resolve(decodeResponse(result, responseType));\r\n                    }\r\n                });\r\n            }).on('error', function(e) {\r\n                deferred.reject(new RequestErrorEvent());\r\n            }).end();\r\n    }\r\n\r\n    var noXMLHttpRequest = typeof XMLHttpRequest === 'undefined';\r\n    Resource._Implementations.loadWithXhr = function(url, responseType, method, data, headers, deferred, overrideMimeType) {\r\n        var dataUriRegexResult = dataUriRegex.exec(url);\r\n        if (dataUriRegexResult !== null) {\r\n            deferred.resolve(decodeDataUri(dataUriRegexResult, responseType));\r\n            return;\r\n        }\r\n\r\n        if (noXMLHttpRequest) {\r\n            loadWithHttpRequest(url, responseType, method, data, headers, deferred, overrideMimeType);\r\n            return;\r\n        }\r\n\r\n        var xhr = new XMLHttpRequest();\r\n\r\n        if (TrustedServers.contains(url)) {\r\n            xhr.withCredentials = true;\r\n        }\r\n\r\n        xhr.open(method, url, true);\r\n\r\n        if (defined(overrideMimeType) && defined(xhr.overrideMimeType)) {\r\n            xhr.overrideMimeType(overrideMimeType);\r\n        }\r\n\r\n        if (defined(headers)) {\r\n            for (var key in headers) {\r\n                if (headers.hasOwnProperty(key)) {\r\n                    xhr.setRequestHeader(key, headers[key]);\r\n                }\r\n            }\r\n        }\r\n\r\n        if (defined(responseType)) {\r\n            xhr.responseType = responseType;\r\n        }\r\n\r\n        // While non-standard, file protocol always returns a status of 0 on success\r\n        var localFile = false;\r\n        if (typeof url === 'string') {\r\n            localFile = (url.indexOf('file://') === 0) || (typeof window !== 'undefined' && window.location.origin === 'file://');\r\n        }\r\n\r\n        xhr.onload = function() {\r\n            if ((xhr.status < 200 || xhr.status >= 300) && !(localFile && xhr.status === 0)) {\r\n                deferred.reject(new RequestErrorEvent(xhr.status, xhr.response, xhr.getAllResponseHeaders()));\r\n                return;\r\n            }\r\n\r\n            var response = xhr.response;\r\n            var browserResponseType = xhr.responseType;\r\n\r\n            if (method === 'HEAD' || method === 'OPTIONS') {\r\n                var responseHeaderString = xhr.getAllResponseHeaders();\r\n                var splitHeaders = responseHeaderString.trim().split(/[\\r\\n]+/);\r\n\r\n                var responseHeaders = {};\r\n                splitHeaders.forEach(function (line) {\r\n                    var parts = line.split(': ');\r\n                    var header = parts.shift();\r\n                    responseHeaders[header] = parts.join(': ');\r\n                });\r\n\r\n                deferred.resolve(responseHeaders);\r\n                return;\r\n            }\r\n\r\n            //All modern browsers will go into either the first or second if block or last else block.\r\n            //Other code paths support older browsers that either do not support the supplied responseType\r\n            //or do not support the xhr.response property.\r\n            if (xhr.status === 204) {\r\n                // accept no content\r\n                deferred.resolve();\r\n            } else if (defined(response) && (!defined(responseType) || (browserResponseType === responseType))) {\r\n                deferred.resolve(response);\r\n            } else if ((responseType === 'json') && typeof response === 'string') {\r\n                try {\r\n                    deferred.resolve(JSON.parse(response));\r\n                } catch (e) {\r\n                    deferred.reject(e);\r\n                }\r\n            } else if ((browserResponseType === '' || browserResponseType === 'document') && defined(xhr.responseXML) && xhr.responseXML.hasChildNodes()) {\r\n                deferred.resolve(xhr.responseXML);\r\n            } else if ((browserResponseType === '' || browserResponseType === 'text') && defined(xhr.responseText)) {\r\n                deferred.resolve(xhr.responseText);\r\n            } else {\r\n                deferred.reject(new RuntimeError('Invalid XMLHttpRequest response type.'));\r\n            }\r\n        };\r\n\r\n        xhr.onerror = function(e) {\r\n            deferred.reject(new RequestErrorEvent());\r\n        };\r\n\r\n        xhr.send(data);\r\n\r\n        return xhr;\r\n    };\r\n\r\n    Resource._Implementations.loadAndExecuteScript = function(url, functionName, deferred) {\r\n        return loadAndExecuteScript(url, functionName).otherwise(deferred.reject);\r\n    };\r\n\r\n    /**\r\n     * The default implementations\r\n     *\r\n     * @private\r\n     */\r\n    Resource._DefaultImplementations = {};\r\n    Resource._DefaultImplementations.createImage = Resource._Implementations.createImage;\r\n    Resource._DefaultImplementations.loadWithXhr = Resource._Implementations.loadWithXhr;\r\n    Resource._DefaultImplementations.loadAndExecuteScript = Resource._Implementations.loadAndExecuteScript;\r\n\r\n    /**\r\n     * A resource instance initialized to the current browser location\r\n     *\r\n     * @type {Resource}\r\n     * @constant\r\n     */\r\n    Resource.DEFAULT = Object.freeze(new Resource({\r\n        url: (typeof document === 'undefined') ? '' : document.location.href.split('?')[0]\r\n    }));\r\n\r\n    /**\r\n     * A function that returns the value of the property.\r\n     * @callback Resource~RetryCallback\r\n     *\r\n     * @param {Resource} [resource] The resource that failed to load.\r\n     * @param {Error} [error] The error that occurred during the loading of the resource.\r\n     * @returns {Boolean|Promise<Boolean>} If true or a promise that resolved to true, the resource will be retried. Otherwise the failure will be returned.\r\n     */\r\nexport default Resource;\r\n","import defined from './defined.js';\r\nimport DeveloperError from './DeveloperError.js';\r\n\r\n    /**\r\n     * Parses a query string into an object, where the keys and values of the object are the\r\n     * name/value pairs from the query string, decoded. If a name appears multiple times,\r\n     * the value in the object will be an array of values.\r\n     * @exports queryToObject\r\n     *\r\n     * @param {String} queryString The query string.\r\n     * @returns {Object} An object containing the parameters parsed from the query string.\r\n     *\r\n     *\r\n     * @example\r\n     * var obj = Cesium.queryToObject('key1=some%20value&key2=a%2Fb&key3=x&key3=y');\r\n     * // obj will be:\r\n     * // {\r\n     * //   key1 : 'some value',\r\n     * //   key2 : 'a/b',\r\n     * //   key3 : ['x', 'y']\r\n     * // }\r\n     *\r\n     * @see objectToQuery\r\n     */\r\n    function queryToObject(queryString) {\r\n        //>>includeStart('debug', pragmas.debug);\r\n        if (!defined(queryString)) {\r\n            throw new DeveloperError('queryString is required.');\r\n        }\r\n        //>>includeEnd('debug');\r\n\r\n        var result = {};\r\n        if (queryString === '') {\r\n            return result;\r\n        }\r\n        var parts = queryString.replace(/\\+/g, '%20').split(/[&;]/);\r\n        for (var i = 0, len = parts.length; i < len; ++i) {\r\n            var subparts = parts[i].split('=');\r\n\r\n            var name = decodeURIComponent(subparts[0]);\r\n            var value = subparts[1];\r\n            if (defined(value)) {\r\n                value = decodeURIComponent(value);\r\n            } else {\r\n                value = '';\r\n            }\r\n\r\n            var resultValue = result[name];\r\n            if (typeof resultValue === 'string') {\r\n                // expand the single value to an array\r\n                result[name] = [resultValue, value];\r\n            } else if (Array.isArray(resultValue)) {\r\n                resultValue.push(value);\r\n            } else {\r\n                result[name] = value;\r\n            }\r\n        }\r\n        return result;\r\n    }\r\nexport default queryToObject;\r\n","import defined from './defined.js';\r\nimport DeveloperError from './DeveloperError.js';\r\n\r\n    /**\r\n     * Converts an object representing a set of name/value pairs into a query string,\r\n     * with names and values encoded properly for use in a URL.  Values that are arrays\r\n     * will produce multiple values with the same name.\r\n     * @exports objectToQuery\r\n     *\r\n     * @param {Object} obj The object containing data to encode.\r\n     * @returns {String} An encoded query string.\r\n     *\r\n     *\r\n     * @example\r\n     * var str = Cesium.objectToQuery({\r\n     *     key1 : 'some value',\r\n     *     key2 : 'a/b',\r\n     *     key3 : ['x', 'y']\r\n     * });\r\n     *\r\n     * @see queryToObject\r\n     * // str will be:\r\n     * // 'key1=some%20value&key2=a%2Fb&key3=x&key3=y'\r\n     */\r\n    function objectToQuery(obj) {\r\n        //>>includeStart('debug', pragmas.debug);\r\n        if (!defined(obj)) {\r\n            throw new DeveloperError('obj is required.');\r\n        }\r\n        //>>includeEnd('debug');\r\n\r\n        var result = '';\r\n        for ( var propName in obj) {\r\n            if (obj.hasOwnProperty(propName)) {\r\n                var value = obj[propName];\r\n\r\n                var part = encodeURIComponent(propName) + '=';\r\n                if (Array.isArray(value)) {\r\n                    for (var i = 0, len = value.length; i < len; ++i) {\r\n                        result += part + encodeURIComponent(value[i]) + '&';\r\n                    }\r\n                } else {\r\n                    result += part + encodeURIComponent(value) + '&';\r\n                }\r\n            }\r\n        }\r\n\r\n        // trim last &\r\n        result = result.slice(0, -1);\r\n\r\n        // This function used to replace %20 with + which is more compact and readable.\r\n        // However, some servers didn't properly handle + as a space.\r\n        // https://github.com/CesiumGS/cesium/issues/2192\r\n\r\n        return result;\r\n    }\r\nexport default objectToQuery;\r\n","import Uri from '../ThirdParty/Uri.js';\r\nimport defined from './defined.js';\r\nimport DeveloperError from './DeveloperError.js';\r\n\r\n    /**\r\n     * Given a URI, returns the extension of the URI.\r\n     * @exports getExtensionFromUri\r\n     *\r\n     * @param {String} uri The Uri.\r\n     * @returns {String} The extension of the Uri.\r\n     *\r\n     * @example\r\n     * //extension will be \"czml\";\r\n     * var extension = Cesium.getExtensionFromUri('/Gallery/simple.czml?value=true&example=false');\r\n     */\r\n    function getExtensionFromUri(uri) {\r\n        //>>includeStart('debug', pragmas.debug);\r\n        if (!defined(uri)) {\r\n            throw new DeveloperError('uri is required.');\r\n        }\r\n        //>>includeEnd('debug');\r\n\r\n        var uriObject = new Uri(uri);\r\n        uriObject.normalize();\r\n        var path = uriObject.path;\r\n        var index = path.lastIndexOf('/');\r\n        if (index !== -1) {\r\n            path = path.substr(index + 1);\r\n        }\r\n        index = path.lastIndexOf('.');\r\n        if (index === -1) {\r\n            path = '';\r\n        } else {\r\n            path = path.substr(index + 1);\r\n        }\r\n        return path;\r\n    }\r\nexport default getExtensionFromUri;\r\n","import Uri from '../ThirdParty/Uri.js';\r\nimport defined from './defined.js';\r\nimport DeveloperError from './DeveloperError.js';\r\n\r\n    /**\r\n     * Given a URI, returns the base path of the URI.\r\n     * @exports getBaseUri\r\n     *\r\n     * @param {String} uri The Uri.\r\n     * @param {Boolean} [includeQuery = false] Whether or not to include the query string and fragment form the uri\r\n     * @returns {String} The base path of the Uri.\r\n     *\r\n     * @example\r\n     * // basePath will be \"/Gallery/\";\r\n     * var basePath = Cesium.getBaseUri('/Gallery/simple.czml?value=true&example=false');\r\n     *\r\n     * // basePath will be \"/Gallery/?value=true&example=false\";\r\n     * var basePath = Cesium.getBaseUri('/Gallery/simple.czml?value=true&example=false', true);\r\n     */\r\n    function getBaseUri(uri, includeQuery) {\r\n        //>>includeStart('debug', pragmas.debug);\r\n        if (!defined(uri)) {\r\n            throw new DeveloperError('uri is required.');\r\n        }\r\n        //>>includeEnd('debug');\r\n\r\n        var basePath = '';\r\n        var i = uri.lastIndexOf('/');\r\n        if (i !== -1) {\r\n            basePath = uri.substring(0, i + 1);\r\n        }\r\n\r\n        if (!includeQuery) {\r\n            return basePath;\r\n        }\r\n\r\n        uri = new Uri(uri);\r\n        if (defined(uri.query)) {\r\n            basePath += '?' + uri.query;\r\n        }\r\n        if (defined(uri.fragment)){\r\n            basePath += '#' + uri.fragment;\r\n        }\r\n\r\n        return basePath;\r\n    }\r\nexport default getBaseUri;\r\n","\r\n    /**\r\n     * @private\r\n     */\r\n    function appendForwardSlash(url) {\r\n        if (url.length === 0 || url[url.length - 1] !== '/') {\r\n            url = url + '/';\r\n        }\r\n        return url;\r\n    }\r\nexport default appendForwardSlash;\r\n","import when from '../ThirdParty/when.js';\r\nimport binarySearch from './binarySearch.js';\r\nimport defaultValue from './defaultValue.js';\r\nimport defined from './defined.js';\r\nimport EarthOrientationParametersSample from './EarthOrientationParametersSample.js';\r\nimport JulianDate from './JulianDate.js';\r\nimport LeapSecond from './LeapSecond.js';\r\nimport Resource from './Resource.js';\r\nimport RuntimeError from './RuntimeError.js';\r\nimport TimeConstants from './TimeConstants.js';\r\nimport TimeStandard from './TimeStandard.js';\r\n\r\n    /**\r\n     * Specifies Earth polar motion coordinates and the difference between UT1 and UTC.\r\n     * These Earth Orientation Parameters (EOP) are primarily used in the transformation from\r\n     * the International Celestial Reference Frame (ICRF) to the International Terrestrial\r\n     * Reference Frame (ITRF).\r\n     *\r\n     * @alias EarthOrientationParameters\r\n     * @constructor\r\n     *\r\n     * @param {Object} [options] Object with the following properties:\r\n     * @param {Resource|String} [options.url] The URL from which to obtain EOP data.  If neither this\r\n     *                 parameter nor options.data is specified, all EOP values are assumed\r\n     *                 to be 0.0.  If options.data is specified, this parameter is\r\n     *                 ignored.\r\n     * @param {Object} [options.data] The actual EOP data.  If neither this\r\n     *                 parameter nor options.data is specified, all EOP values are assumed\r\n     *                 to be 0.0.\r\n     * @param {Boolean} [options.addNewLeapSeconds=true] True if leap seconds that\r\n     *                  are specified in the EOP data but not in {@link JulianDate.leapSeconds}\r\n     *                  should be added to {@link JulianDate.leapSeconds}.  False if\r\n     *                  new leap seconds should be handled correctly in the context\r\n     *                  of the EOP data but otherwise ignored.\r\n     *\r\n     * @example\r\n     * // An example EOP data file, EOP.json:\r\n     * {\r\n     *   \"columnNames\" : [\"dateIso8601\",\"modifiedJulianDateUtc\",\"xPoleWanderRadians\",\"yPoleWanderRadians\",\"ut1MinusUtcSeconds\",\"lengthOfDayCorrectionSeconds\",\"xCelestialPoleOffsetRadians\",\"yCelestialPoleOffsetRadians\",\"taiMinusUtcSeconds\"],\r\n     *   \"samples\" : [\r\n     *      \"2011-07-01T00:00:00Z\",55743.0,2.117957047295119e-7,2.111518721609984e-6,-0.2908948,-2.956e-4,3.393695767766752e-11,3.3452143996557983e-10,34.0,\r\n     *      \"2011-07-02T00:00:00Z\",55744.0,2.193297093339541e-7,2.115460256837405e-6,-0.29065,-1.824e-4,-8.241832578862112e-11,5.623838700870617e-10,34.0,\r\n     *      \"2011-07-03T00:00:00Z\",55745.0,2.262286080161428e-7,2.1191157519929706e-6,-0.2905572,1.9e-6,-3.490658503988659e-10,6.981317007977318e-10,34.0\r\n     *   ]\r\n     * }\r\n     *\r\n     * @example\r\n     * // Loading the EOP data\r\n     * var eop = new Cesium.EarthOrientationParameters({ url : 'Data/EOP.json' });\r\n     * Cesium.Transforms.earthOrientationParameters = eop;\r\n     *\r\n     * @private\r\n     */\r\n    function EarthOrientationParameters(options) {\r\n        options = defaultValue(options, defaultValue.EMPTY_OBJECT);\r\n\r\n        this._dates = undefined;\r\n        this._samples = undefined;\r\n\r\n        this._dateColumn = -1;\r\n        this._xPoleWanderRadiansColumn = -1;\r\n        this._yPoleWanderRadiansColumn = -1;\r\n        this._ut1MinusUtcSecondsColumn = -1;\r\n        this._xCelestialPoleOffsetRadiansColumn = -1;\r\n        this._yCelestialPoleOffsetRadiansColumn = -1;\r\n        this._taiMinusUtcSecondsColumn = -1;\r\n\r\n        this._columnCount = 0;\r\n        this._lastIndex = -1;\r\n\r\n        this._downloadPromise = undefined;\r\n        this._dataError = undefined;\r\n\r\n        this._addNewLeapSeconds = defaultValue(options.addNewLeapSeconds, true);\r\n\r\n        if (defined(options.data)) {\r\n            // Use supplied EOP data.\r\n            onDataReady(this, options.data);\r\n        } else if (defined(options.url)) {\r\n            var resource = Resource.createIfNeeded(options.url);\r\n\r\n            // Download EOP data.\r\n            var that = this;\r\n            this._downloadPromise = when(resource.fetchJson(), function(eopData) {\r\n                onDataReady(that, eopData);\r\n            }, function() {\r\n                that._dataError = 'An error occurred while retrieving the EOP data from the URL ' + resource.url + '.';\r\n            });\r\n        } else {\r\n            // Use all zeros for EOP data.\r\n            onDataReady(this, {\r\n                'columnNames' : ['dateIso8601', 'modifiedJulianDateUtc', 'xPoleWanderRadians', 'yPoleWanderRadians', 'ut1MinusUtcSeconds', 'lengthOfDayCorrectionSeconds', 'xCelestialPoleOffsetRadians', 'yCelestialPoleOffsetRadians', 'taiMinusUtcSeconds'],\r\n                'samples' : []\r\n            });\r\n        }\r\n    }\r\n\r\n    /**\r\n     * A default {@link EarthOrientationParameters} instance that returns zero for all EOP values.\r\n     */\r\n    EarthOrientationParameters.NONE = Object.freeze({\r\n            getPromiseToLoad : function() {\r\n                return when();\r\n            },\r\n            compute : function(date, result) {\r\n                if (!defined(result)) {\r\n                    result = new EarthOrientationParametersSample(0.0, 0.0, 0.0, 0.0, 0.0);\r\n                } else {\r\n                    result.xPoleWander = 0.0;\r\n                    result.yPoleWander = 0.0;\r\n                    result.xPoleOffset = 0.0;\r\n                    result.yPoleOffset = 0.0;\r\n                    result.ut1MinusUtc = 0.0;\r\n                }\r\n                return result;\r\n            }\r\n    });\r\n\r\n    /**\r\n     * Gets a promise that, when resolved, indicates that the EOP data has been loaded and is\r\n     * ready to use.\r\n     *\r\n     * @returns {Promise} The promise.\r\n     *\r\n     * @see when\r\n     */\r\n    EarthOrientationParameters.prototype.getPromiseToLoad = function() {\r\n        return when(this._downloadPromise);\r\n    };\r\n\r\n    /**\r\n     * Computes the Earth Orientation Parameters (EOP) for a given date by interpolating.\r\n     * If the EOP data has not yet been download, this method returns undefined.\r\n     *\r\n     * @param {JulianDate} date The date for each to evaluate the EOP.\r\n     * @param {EarthOrientationParametersSample} [result] The instance to which to copy the result.\r\n     *        If this parameter is undefined, a new instance is created and returned.\r\n     * @returns {EarthOrientationParametersSample} The EOP evaluated at the given date, or\r\n     *          undefined if the data necessary to evaluate EOP at the date has not yet been\r\n     *          downloaded.\r\n     *\r\n     * @exception {RuntimeError} The loaded EOP data has an error and cannot be used.\r\n     *\r\n     * @see EarthOrientationParameters#getPromiseToLoad\r\n     */\r\n    EarthOrientationParameters.prototype.compute = function(date, result) {\r\n        // We cannot compute until the samples are available.\r\n        if (!defined(this._samples)) {\r\n            if (defined(this._dataError)) {\r\n                throw new RuntimeError(this._dataError);\r\n            }\r\n\r\n            return undefined;\r\n        }\r\n\r\n        if (!defined(result)) {\r\n            result = new EarthOrientationParametersSample(0.0, 0.0, 0.0, 0.0, 0.0);\r\n        }\r\n\r\n        if (this._samples.length === 0) {\r\n            result.xPoleWander = 0.0;\r\n            result.yPoleWander = 0.0;\r\n            result.xPoleOffset = 0.0;\r\n            result.yPoleOffset = 0.0;\r\n            result.ut1MinusUtc = 0.0;\r\n            return result;\r\n        }\r\n\r\n        var dates = this._dates;\r\n        var lastIndex = this._lastIndex;\r\n\r\n        var before = 0;\r\n        var after = 0;\r\n        if (defined(lastIndex)) {\r\n            var previousIndexDate = dates[lastIndex];\r\n            var nextIndexDate = dates[lastIndex + 1];\r\n            var isAfterPrevious = JulianDate.lessThanOrEquals(previousIndexDate, date);\r\n            var isAfterLastSample = !defined(nextIndexDate);\r\n            var isBeforeNext = isAfterLastSample || JulianDate.greaterThanOrEquals(nextIndexDate, date);\r\n\r\n            if (isAfterPrevious && isBeforeNext) {\r\n                before = lastIndex;\r\n\r\n                if (!isAfterLastSample && nextIndexDate.equals(date)) {\r\n                    ++before;\r\n                }\r\n                after = before + 1;\r\n\r\n                interpolate(this, dates, this._samples, date, before, after, result);\r\n                return result;\r\n            }\r\n        }\r\n\r\n        var index = binarySearch(dates, date, JulianDate.compare, this._dateColumn);\r\n        if (index >= 0) {\r\n            // If the next entry is the same date, use the later entry.  This way, if two entries\r\n            // describe the same moment, one before a leap second and the other after, then we will use\r\n            // the post-leap second data.\r\n            if (index < dates.length - 1 && dates[index + 1].equals(date)) {\r\n                ++index;\r\n            }\r\n            before = index;\r\n            after = index;\r\n        } else {\r\n            after = ~index;\r\n            before = after - 1;\r\n\r\n            // Use the first entry if the date requested is before the beginning of the data.\r\n            if (before < 0) {\r\n                before = 0;\r\n            }\r\n        }\r\n\r\n        this._lastIndex = before;\r\n\r\n        interpolate(this, dates, this._samples, date, before, after, result);\r\n        return result;\r\n    };\r\n\r\n    function compareLeapSecondDates(leapSecond, dateToFind) {\r\n        return JulianDate.compare(leapSecond.julianDate, dateToFind);\r\n    }\r\n\r\n    function onDataReady(eop, eopData) {\r\n        if (!defined(eopData.columnNames)) {\r\n            eop._dataError = 'Error in loaded EOP data: The columnNames property is required.';\r\n            return;\r\n        }\r\n\r\n        if (!defined(eopData.samples)) {\r\n            eop._dataError = 'Error in loaded EOP data: The samples property is required.';\r\n            return;\r\n        }\r\n\r\n        var dateColumn = eopData.columnNames.indexOf('modifiedJulianDateUtc');\r\n        var xPoleWanderRadiansColumn = eopData.columnNames.indexOf('xPoleWanderRadians');\r\n        var yPoleWanderRadiansColumn = eopData.columnNames.indexOf('yPoleWanderRadians');\r\n        var ut1MinusUtcSecondsColumn = eopData.columnNames.indexOf('ut1MinusUtcSeconds');\r\n        var xCelestialPoleOffsetRadiansColumn = eopData.columnNames.indexOf('xCelestialPoleOffsetRadians');\r\n        var yCelestialPoleOffsetRadiansColumn = eopData.columnNames.indexOf('yCelestialPoleOffsetRadians');\r\n        var taiMinusUtcSecondsColumn = eopData.columnNames.indexOf('taiMinusUtcSeconds');\r\n\r\n        if (dateColumn < 0 || xPoleWanderRadiansColumn < 0 || yPoleWanderRadiansColumn < 0 || ut1MinusUtcSecondsColumn < 0 || xCelestialPoleOffsetRadiansColumn < 0 || yCelestialPoleOffsetRadiansColumn < 0 || taiMinusUtcSecondsColumn < 0) {\r\n            eop._dataError = 'Error in loaded EOP data: The columnNames property must include modifiedJulianDateUtc, xPoleWanderRadians, yPoleWanderRadians, ut1MinusUtcSeconds, xCelestialPoleOffsetRadians, yCelestialPoleOffsetRadians, and taiMinusUtcSeconds columns';\r\n            return;\r\n        }\r\n\r\n        var samples = eop._samples = eopData.samples;\r\n        var dates = eop._dates = [];\r\n\r\n        eop._dateColumn = dateColumn;\r\n        eop._xPoleWanderRadiansColumn = xPoleWanderRadiansColumn;\r\n        eop._yPoleWanderRadiansColumn = yPoleWanderRadiansColumn;\r\n        eop._ut1MinusUtcSecondsColumn = ut1MinusUtcSecondsColumn;\r\n        eop._xCelestialPoleOffsetRadiansColumn = xCelestialPoleOffsetRadiansColumn;\r\n        eop._yCelestialPoleOffsetRadiansColumn = yCelestialPoleOffsetRadiansColumn;\r\n        eop._taiMinusUtcSecondsColumn = taiMinusUtcSecondsColumn;\r\n\r\n        eop._columnCount = eopData.columnNames.length;\r\n        eop._lastIndex = undefined;\r\n\r\n        var lastTaiMinusUtc;\r\n\r\n        var addNewLeapSeconds = eop._addNewLeapSeconds;\r\n\r\n        // Convert the ISO8601 dates to JulianDates.\r\n        for (var i = 0, len = samples.length; i < len; i += eop._columnCount) {\r\n            var mjd = samples[i + dateColumn];\r\n            var taiMinusUtc = samples[i + taiMinusUtcSecondsColumn];\r\n            var day = mjd + TimeConstants.MODIFIED_JULIAN_DATE_DIFFERENCE;\r\n            var date = new JulianDate(day, taiMinusUtc, TimeStandard.TAI);\r\n            dates.push(date);\r\n\r\n            if (addNewLeapSeconds) {\r\n                if (taiMinusUtc !== lastTaiMinusUtc && defined(lastTaiMinusUtc)) {\r\n                    // We crossed a leap second boundary, so add the leap second\r\n                    // if it does not already exist.\r\n                    var leapSeconds = JulianDate.leapSeconds;\r\n                    var leapSecondIndex = binarySearch(leapSeconds, date, compareLeapSecondDates);\r\n                    if (leapSecondIndex < 0) {\r\n                        var leapSecond = new LeapSecond(date, taiMinusUtc);\r\n                        leapSeconds.splice(~leapSecondIndex, 0, leapSecond);\r\n                    }\r\n                }\r\n                lastTaiMinusUtc = taiMinusUtc;\r\n            }\r\n        }\r\n    }\r\n\r\n    function fillResultFromIndex(eop, samples, index, columnCount, result) {\r\n        var start = index * columnCount;\r\n        result.xPoleWander = samples[start + eop._xPoleWanderRadiansColumn];\r\n        result.yPoleWander = samples[start + eop._yPoleWanderRadiansColumn];\r\n        result.xPoleOffset = samples[start + eop._xCelestialPoleOffsetRadiansColumn];\r\n        result.yPoleOffset = samples[start + eop._yCelestialPoleOffsetRadiansColumn];\r\n        result.ut1MinusUtc = samples[start + eop._ut1MinusUtcSecondsColumn];\r\n    }\r\n\r\n    function linearInterp(dx, y1, y2) {\r\n        return y1 + dx * (y2 - y1);\r\n    }\r\n\r\n    function interpolate(eop, dates, samples, date, before, after, result) {\r\n        var columnCount = eop._columnCount;\r\n\r\n        // First check the bounds on the EOP data\r\n        // If we are after the bounds of the data, return zeros.\r\n        // The 'before' index should never be less than zero.\r\n        if (after > dates.length - 1) {\r\n            result.xPoleWander = 0;\r\n            result.yPoleWander = 0;\r\n            result.xPoleOffset = 0;\r\n            result.yPoleOffset = 0;\r\n            result.ut1MinusUtc = 0;\r\n            return result;\r\n        }\r\n\r\n        var beforeDate = dates[before];\r\n        var afterDate = dates[after];\r\n        if (beforeDate.equals(afterDate) || date.equals(beforeDate)) {\r\n            fillResultFromIndex(eop, samples, before, columnCount, result);\r\n            return result;\r\n        } else if (date.equals(afterDate)) {\r\n            fillResultFromIndex(eop, samples, after, columnCount, result);\r\n            return result;\r\n        }\r\n\r\n        var factor = JulianDate.secondsDifference(date, beforeDate) / JulianDate.secondsDifference(afterDate, beforeDate);\r\n\r\n        var startBefore = before * columnCount;\r\n        var startAfter = after * columnCount;\r\n\r\n        // Handle UT1 leap second edge case\r\n        var beforeUt1MinusUtc = samples[startBefore + eop._ut1MinusUtcSecondsColumn];\r\n        var afterUt1MinusUtc = samples[startAfter + eop._ut1MinusUtcSecondsColumn];\r\n\r\n        var offsetDifference = afterUt1MinusUtc - beforeUt1MinusUtc;\r\n        if (offsetDifference > 0.5 || offsetDifference < -0.5) {\r\n            // The absolute difference between the values is more than 0.5, so we may have\r\n            // crossed a leap second.  Check if this is the case and, if so, adjust the\r\n            // afterValue to account for the leap second.  This way, our interpolation will\r\n            // produce reasonable results.\r\n            var beforeTaiMinusUtc = samples[startBefore + eop._taiMinusUtcSecondsColumn];\r\n            var afterTaiMinusUtc = samples[startAfter + eop._taiMinusUtcSecondsColumn];\r\n            if (beforeTaiMinusUtc !== afterTaiMinusUtc) {\r\n                if (afterDate.equals(date)) {\r\n                    // If we are at the end of the leap second interval, take the second value\r\n                    // Otherwise, the interpolation below will yield the wrong side of the\r\n                    // discontinuity\r\n                    // At the end of the leap second, we need to start accounting for the jump\r\n                    beforeUt1MinusUtc = afterUt1MinusUtc;\r\n                } else {\r\n                    // Otherwise, remove the leap second so that the interpolation is correct\r\n                    afterUt1MinusUtc -= afterTaiMinusUtc - beforeTaiMinusUtc;\r\n                }\r\n            }\r\n        }\r\n\r\n        result.xPoleWander = linearInterp(factor, samples[startBefore + eop._xPoleWanderRadiansColumn], samples[startAfter + eop._xPoleWanderRadiansColumn]);\r\n        result.yPoleWander = linearInterp(factor, samples[startBefore + eop._yPoleWanderRadiansColumn], samples[startAfter + eop._yPoleWanderRadiansColumn]);\r\n        result.xPoleOffset = linearInterp(factor, samples[startBefore + eop._xCelestialPoleOffsetRadiansColumn], samples[startAfter + eop._xCelestialPoleOffsetRadiansColumn]);\r\n        result.yPoleOffset = linearInterp(factor, samples[startBefore + eop._yCelestialPoleOffsetRadiansColumn], samples[startAfter + eop._yCelestialPoleOffsetRadiansColumn]);\r\n        result.ut1MinusUtc = linearInterp(factor, beforeUt1MinusUtc, afterUt1MinusUtc);\r\n        return result;\r\n    }\r\nexport default EarthOrientationParameters;\r\n","import defaultValue from './defaultValue.js';\r\nimport defined from './defined.js';\r\nimport DeveloperError from './DeveloperError.js';\r\nimport CesiumMath from './Math.js';\r\n\r\n    /**\r\n     * A rotation expressed as a heading, pitch, and roll. Heading is the rotation about the\r\n     * negative z axis. Pitch is the rotation about the negative y axis. Roll is the rotation about\r\n     * the positive x axis.\r\n     * @alias HeadingPitchRoll\r\n     * @constructor\r\n     *\r\n     * @param {Number} [heading=0.0] The heading component in radians.\r\n     * @param {Number} [pitch=0.0] The pitch component in radians.\r\n     * @param {Number} [roll=0.0] The roll component in radians.\r\n     */\r\n    function HeadingPitchRoll(heading, pitch, roll) {\r\n        this.heading = defaultValue(heading, 0.0);\r\n        this.pitch = defaultValue(pitch, 0.0);\r\n        this.roll = defaultValue(roll, 0.0);\r\n    }\r\n\r\n    /**\r\n     * Computes the heading, pitch and roll from a quaternion (see http://en.wikipedia.org/wiki/Conversion_between_quaternions_and_Euler_angles )\r\n     *\r\n     * @param {Quaternion} quaternion The quaternion from which to retrieve heading, pitch, and roll, all expressed in radians.\r\n     * @param {HeadingPitchRoll} [result] The object in which to store the result. If not provided, a new instance is created and returned.\r\n     * @returns {HeadingPitchRoll} The modified result parameter or a new HeadingPitchRoll instance if one was not provided.\r\n     */\r\n    HeadingPitchRoll.fromQuaternion = function(quaternion, result) {\r\n        //>>includeStart('debug', pragmas.debug);\r\n        if (!defined(quaternion)) {\r\n            throw new DeveloperError('quaternion is required');\r\n        }\r\n        //>>includeEnd('debug');\r\n        if (!defined(result)) {\r\n            result = new HeadingPitchRoll();\r\n        }\r\n        var test = 2 * (quaternion.w * quaternion.y - quaternion.z * quaternion.x);\r\n        var denominatorRoll = 1 - 2 * (quaternion.x * quaternion.x + quaternion.y * quaternion.y);\r\n        var numeratorRoll = 2 * (quaternion.w * quaternion.x + quaternion.y * quaternion.z);\r\n        var denominatorHeading = 1 - 2 * (quaternion.y * quaternion.y + quaternion.z * quaternion.z);\r\n        var numeratorHeading = 2 * (quaternion.w * quaternion.z + quaternion.x * quaternion.y);\r\n        result.heading = -Math.atan2(numeratorHeading, denominatorHeading);\r\n        result.roll = Math.atan2(numeratorRoll, denominatorRoll);\r\n        result.pitch = -CesiumMath.asinClamped(test);\r\n        return result;\r\n    };\r\n\r\n    /**\r\n     * Returns a new HeadingPitchRoll instance from angles given in degrees.\r\n     *\r\n     * @param {Number} heading the heading in degrees\r\n     * @param {Number} pitch the pitch in degrees\r\n     * @param {Number} roll the heading in degrees\r\n     * @param {HeadingPitchRoll} [result] The object in which to store the result. If not provided, a new instance is created and returned.\r\n     * @returns {HeadingPitchRoll} A new HeadingPitchRoll instance\r\n     */\r\n    HeadingPitchRoll.fromDegrees = function(heading, pitch, roll, result) {\r\n        //>>includeStart('debug', pragmas.debug);\r\n        if (!defined(heading)) {\r\n            throw new DeveloperError('heading is required');\r\n        }\r\n        if (!defined(pitch)) {\r\n            throw new DeveloperError('pitch is required');\r\n        }\r\n        if (!defined(roll)) {\r\n            throw new DeveloperError('roll is required');\r\n        }\r\n        //>>includeEnd('debug');\r\n        if (!defined(result)) {\r\n            result = new HeadingPitchRoll();\r\n        }\r\n        result.heading = heading * CesiumMath.RADIANS_PER_DEGREE;\r\n        result.pitch = pitch * CesiumMath.RADIANS_PER_DEGREE;\r\n        result.roll = roll * CesiumMath.RADIANS_PER_DEGREE;\r\n        return result;\r\n    };\r\n\r\n    /**\r\n     * Duplicates a HeadingPitchRoll instance.\r\n     *\r\n     * @param {HeadingPitchRoll} headingPitchRoll The HeadingPitchRoll to duplicate.\r\n     * @param {HeadingPitchRoll} [result] The object onto which to store the result.\r\n     * @returns {HeadingPitchRoll} The modified result parameter or a new HeadingPitchRoll instance if one was not provided. (Returns undefined if headingPitchRoll is undefined)\r\n     */\r\n    HeadingPitchRoll.clone = function(headingPitchRoll, result) {\r\n        if (!defined(headingPitchRoll)) {\r\n            return undefined;\r\n        }\r\n        if (!defined(result)) {\r\n            return new HeadingPitchRoll(headingPitchRoll.heading, headingPitchRoll.pitch, headingPitchRoll.roll);\r\n        }\r\n        result.heading = headingPitchRoll.heading;\r\n        result.pitch = headingPitchRoll.pitch;\r\n        result.roll = headingPitchRoll.roll;\r\n        return result;\r\n    };\r\n\r\n    /**\r\n     * Compares the provided HeadingPitchRolls componentwise and returns\r\n     * <code>true</code> if they are equal, <code>false</code> otherwise.\r\n     *\r\n     * @param {HeadingPitchRoll} [left] The first HeadingPitchRoll.\r\n     * @param {HeadingPitchRoll} [right] The second HeadingPitchRoll.\r\n     * @returns {Boolean} <code>true</code> if left and right are equal, <code>false</code> otherwise.\r\n     */\r\n    HeadingPitchRoll.equals = function(left, right) {\r\n        return (left === right) ||\r\n            ((defined(left)) &&\r\n                (defined(right)) &&\r\n                (left.heading === right.heading) &&\r\n                (left.pitch === right.pitch) &&\r\n                (left.roll === right.roll));\r\n    };\r\n\r\n    /**\r\n     * Compares the provided HeadingPitchRolls componentwise and returns\r\n     * <code>true</code> if they pass an absolute or relative tolerance test,\r\n     * <code>false</code> otherwise.\r\n     *\r\n     * @param {HeadingPitchRoll} [left] The first HeadingPitchRoll.\r\n     * @param {HeadingPitchRoll} [right] The second HeadingPitchRoll.\r\n     * @param {Number} relativeEpsilon The relative epsilon tolerance to use for equality testing.\r\n     * @param {Number} [absoluteEpsilon=relativeEpsilon] The absolute epsilon tolerance to use for equality testing.\r\n     * @returns {Boolean} <code>true</code> if left and right are within the provided epsilon, <code>false</code> otherwise.\r\n     */\r\n    HeadingPitchRoll.equalsEpsilon = function(left, right, relativeEpsilon, absoluteEpsilon) {\r\n        return (left === right) ||\r\n            (defined(left) &&\r\n                defined(right) &&\r\n                CesiumMath.equalsEpsilon(left.heading, right.heading, relativeEpsilon, absoluteEpsilon) &&\r\n                CesiumMath.equalsEpsilon(left.pitch, right.pitch, relativeEpsilon, absoluteEpsilon) &&\r\n                CesiumMath.equalsEpsilon(left.roll, right.roll, relativeEpsilon, absoluteEpsilon));\r\n    };\r\n\r\n    /**\r\n     * Duplicates this HeadingPitchRoll instance.\r\n     *\r\n     * @param {HeadingPitchRoll} [result] The object onto which to store the result.\r\n     * @returns {HeadingPitchRoll} The modified result parameter or a new HeadingPitchRoll instance if one was not provided.\r\n     */\r\n    HeadingPitchRoll.prototype.clone = function(result) {\r\n        return HeadingPitchRoll.clone(this, result);\r\n    };\r\n\r\n    /**\r\n     * Compares this HeadingPitchRoll against the provided HeadingPitchRoll componentwise and returns\r\n     * <code>true</code> if they are equal, <code>false</code> otherwise.\r\n     *\r\n     * @param {HeadingPitchRoll} [right] The right hand side HeadingPitchRoll.\r\n     * @returns {Boolean} <code>true</code> if they are equal, <code>false</code> otherwise.\r\n     */\r\n    HeadingPitchRoll.prototype.equals = function(right) {\r\n        return HeadingPitchRoll.equals(this, right);\r\n    };\r\n\r\n    /**\r\n     * Compares this HeadingPitchRoll against the provided HeadingPitchRoll componentwise and returns\r\n     * <code>true</code> if they pass an absolute or relative tolerance test,\r\n     * <code>false</code> otherwise.\r\n     *\r\n     * @param {HeadingPitchRoll} [right] The right hand side HeadingPitchRoll.\r\n     * @param {Number} relativeEpsilon The relative epsilon tolerance to use for equality testing.\r\n     * @param {Number} [absoluteEpsilon=relativeEpsilon] The absolute epsilon tolerance to use for equality testing.\r\n     * @returns {Boolean} <code>true</code> if they are within the provided epsilon, <code>false</code> otherwise.\r\n     */\r\n    HeadingPitchRoll.prototype.equalsEpsilon = function(right, relativeEpsilon, absoluteEpsilon) {\r\n        return HeadingPitchRoll.equalsEpsilon(this, right, relativeEpsilon, absoluteEpsilon);\r\n    };\r\n\r\n    /**\r\n     * Creates a string representing this HeadingPitchRoll in the format '(heading, pitch, roll)' in radians.\r\n     *\r\n     * @returns {String} A string representing the provided HeadingPitchRoll in the format '(heading, pitch, roll)'.\r\n     */\r\n    HeadingPitchRoll.prototype.toString = function() {\r\n        return '(' + this.heading + ', ' + this.pitch + ', ' + this.roll + ')';\r\n    };\r\nexport default HeadingPitchRoll;\r\n","import when from '../ThirdParty/when.js';\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    function loadAndExecuteScript(url) {\r\n        var deferred = when.defer();\r\n        var script = document.createElement('script');\r\n        script.async = true;\r\n        script.src = url;\r\n\r\n        var head = document.getElementsByTagName('head')[0];\r\n        script.onload = function() {\r\n            script.onload = undefined;\r\n            head.removeChild(script);\r\n            deferred.resolve();\r\n        };\r\n        script.onerror = function(e) {\r\n            deferred.reject(e);\r\n        };\r\n\r\n        head.appendChild(script);\r\n\r\n        return deferred.promise;\r\n    }\r\nexport default loadAndExecuteScript;\r\n","import defined from './defined.js';\r\nimport DeveloperError from './DeveloperError.js';\r\nimport getAbsoluteUri from './getAbsoluteUri.js';\r\nimport Resource from './Resource.js';\r\n\r\n    /*global CESIUM_BASE_URL*/\r\n\r\n    var cesiumScriptRegex = /((?:.*\\/)|^)Cesium\\.js$/;\r\n    function getBaseUrlFromCesiumScript() {\r\n        var scripts = document.getElementsByTagName('script');\r\n        for ( var i = 0, len = scripts.length; i < len; ++i) {\r\n            var src = scripts[i].getAttribute('src');\r\n            var result = cesiumScriptRegex.exec(src);\r\n            if (result !== null) {\r\n                return result[1];\r\n            }\r\n        }\r\n        return undefined;\r\n    }\r\n\r\n    var a;\r\n    function tryMakeAbsolute(url) {\r\n        if (typeof document === 'undefined') {\r\n            //Node.js and Web Workers. In both cases, the URL will already be absolute.\r\n            return url;\r\n        }\r\n\r\n        if (!defined(a)) {\r\n            a = document.createElement('a');\r\n        }\r\n        a.href = url;\r\n\r\n        // IE only absolutizes href on get, not set\r\n        a.href = a.href; // eslint-disable-line no-self-assign\r\n        return a.href;\r\n    }\r\n\r\n    var baseResource;\r\n    function getCesiumBaseUrl() {\r\n        if (defined(baseResource)) {\r\n            return baseResource;\r\n        }\r\n\r\n        var baseUrlString;\r\n        if (typeof CESIUM_BASE_URL !== 'undefined') {\r\n            baseUrlString = CESIUM_BASE_URL;\r\n        } else if (typeof define === 'object' && defined(define.amd) && !define.amd.toUrlUndefined && defined(require.toUrl)) {\r\n            baseUrlString = getAbsoluteUri('..', buildModuleUrl('Core/buildModuleUrl.js'));\r\n        } else {\r\n            baseUrlString = getBaseUrlFromCesiumScript();\r\n        }\r\n\r\n        //>>includeStart('debug', pragmas.debug);\r\n        if (!defined(baseUrlString)) {\r\n            throw new DeveloperError('Unable to determine Cesium base URL automatically, try defining a global variable called CESIUM_BASE_URL.');\r\n        }\r\n        //>>includeEnd('debug');\r\n\r\n        baseResource = new Resource({\r\n            url: tryMakeAbsolute(baseUrlString)\r\n        });\r\n        baseResource.appendForwardSlash();\r\n\r\n        return baseResource;\r\n    }\r\n\r\n    function buildModuleUrlFromRequireToUrl(moduleID) {\r\n        //moduleID will be non-relative, so require it relative to this module, in Core.\r\n        return tryMakeAbsolute(require.toUrl('../' + moduleID));\r\n    }\r\n\r\n    function buildModuleUrlFromBaseUrl(moduleID) {\r\n        var resource = getCesiumBaseUrl().getDerivedResource({\r\n            url: moduleID\r\n        });\r\n        return resource.url;\r\n    }\r\n\r\n    var implementation;\r\n\r\n    /**\r\n     * Given a non-relative moduleID, returns an absolute URL to the file represented by that module ID,\r\n     * using, in order of preference, require.toUrl, the value of a global CESIUM_BASE_URL, or\r\n     * the base URL of the Cesium.js script.\r\n     *\r\n     * @private\r\n     */\r\n    function buildModuleUrl(moduleID) {\r\n        if (!defined(implementation)) {\r\n            //select implementation\r\n            if (typeof define === 'object' && defined(define.amd) && !define.amd.toUrlUndefined && defined(require.toUrl)) {\r\n                implementation = buildModuleUrlFromRequireToUrl;\r\n            } else {\r\n                implementation = buildModuleUrlFromBaseUrl;\r\n            }\r\n        }\r\n\r\n        var url = implementation(moduleID);\r\n        return url;\r\n    }\r\n\r\n    // exposed for testing\r\n    buildModuleUrl._cesiumScriptRegex = cesiumScriptRegex;\r\n    buildModuleUrl._buildModuleUrlFromBaseUrl = buildModuleUrlFromBaseUrl;\r\n    buildModuleUrl._clearBaseResource = function() {\r\n        baseResource = undefined;\r\n    };\r\n\r\n    /**\r\n     * Sets the base URL for resolving modules.\r\n     * @param {String} value The new base URL.\r\n     */\r\n    buildModuleUrl.setBaseUrl = function(value) {\r\n        baseResource = Resource.DEFAULT.getDerivedResource({\r\n            url: value\r\n        });\r\n    };\r\n\r\n    /**\r\n     * Gets the base URL for resolving modules.\r\n     */\r\n    buildModuleUrl.getCesiumBaseUrl = getCesiumBaseUrl;\r\n\r\nexport default buildModuleUrl;\r\n","\r\n    /**\r\n     * An IAU 2006 XYS value sampled at a particular time.\r\n     *\r\n     * @alias Iau2006XysSample\r\n     * @constructor\r\n     *\r\n     * @param {Number} x The X value.\r\n     * @param {Number} y The Y value.\r\n     * @param {Number} s The S value.\r\n     *\r\n     * @private\r\n     */\r\n    function Iau2006XysSample(x, y, s) {\r\n        /**\r\n         * The X value.\r\n         * @type {Number}\r\n         */\r\n        this.x = x;\r\n\r\n        /**\r\n         * The Y value.\r\n         * @type {Number}\r\n         */\r\n        this.y = y;\r\n\r\n        /**\r\n         * The S value.\r\n         * @type {Number}\r\n         */\r\n        this.s = s;\r\n    }\r\nexport default Iau2006XysSample;\r\n","import when from '../ThirdParty/when.js';\r\nimport buildModuleUrl from './buildModuleUrl.js';\r\nimport defaultValue from './defaultValue.js';\r\nimport defined from './defined.js';\r\nimport Iau2006XysSample from './Iau2006XysSample.js';\r\nimport JulianDate from './JulianDate.js';\r\nimport Resource from './Resource.js';\r\nimport TimeStandard from './TimeStandard.js';\r\n\r\n    /**\r\n     * A set of IAU2006 XYS data that is used to evaluate the transformation between the International\r\n     * Celestial Reference Frame (ICRF) and the International Terrestrial Reference Frame (ITRF).\r\n     *\r\n     * @alias Iau2006XysData\r\n     * @constructor\r\n     *\r\n     * @param {Object} [options] Object with the following properties:\r\n     * @param {Resource|String} [options.xysFileUrlTemplate='Assets/IAU2006_XYS/IAU2006_XYS_{0}.json'] A template URL for obtaining the XYS data.  In the template,\r\n     *                 `{0}` will be replaced with the file index.\r\n     * @param {Number} [options.interpolationOrder=9] The order of interpolation to perform on the XYS data.\r\n     * @param {Number} [options.sampleZeroJulianEphemerisDate=2442396.5] The Julian ephemeris date (JED) of the\r\n     *                 first XYS sample.\r\n     * @param {Number} [options.stepSizeDays=1.0] The step size, in days, between successive XYS samples.\r\n     * @param {Number} [options.samplesPerXysFile=1000] The number of samples in each XYS file.\r\n     * @param {Number} [options.totalSamples=27426] The total number of samples in all XYS files.\r\n     *\r\n     * @private\r\n     */\r\n    function Iau2006XysData(options) {\r\n        options = defaultValue(options, defaultValue.EMPTY_OBJECT);\r\n\r\n        this._xysFileUrlTemplate = Resource.createIfNeeded(options.xysFileUrlTemplate);\r\n        this._interpolationOrder = defaultValue(options.interpolationOrder, 9);\r\n        this._sampleZeroJulianEphemerisDate = defaultValue(options.sampleZeroJulianEphemerisDate, 2442396.5);\r\n        this._sampleZeroDateTT = new JulianDate(this._sampleZeroJulianEphemerisDate, 0.0, TimeStandard.TAI);\r\n        this._stepSizeDays = defaultValue(options.stepSizeDays, 1.0);\r\n        this._samplesPerXysFile = defaultValue(options.samplesPerXysFile, 1000);\r\n        this._totalSamples = defaultValue(options.totalSamples, 27426);\r\n        this._samples = new Array(this._totalSamples * 3);\r\n        this._chunkDownloadsInProgress = [];\r\n\r\n        var order = this._interpolationOrder;\r\n\r\n        // Compute denominators and X values for interpolation.\r\n        var denom = this._denominators = new Array(order + 1);\r\n        var xTable = this._xTable = new Array(order + 1);\r\n\r\n        var stepN = Math.pow(this._stepSizeDays, order);\r\n\r\n        for ( var i = 0; i <= order; ++i) {\r\n            denom[i] = stepN;\r\n            xTable[i] = i * this._stepSizeDays;\r\n\r\n            for ( var j = 0; j <= order; ++j) {\r\n                if (j !== i) {\r\n                    denom[i] *= (i - j);\r\n                }\r\n            }\r\n\r\n            denom[i] = 1.0 / denom[i];\r\n        }\r\n\r\n        // Allocate scratch arrays for interpolation.\r\n        this._work = new Array(order + 1);\r\n        this._coef = new Array(order + 1);\r\n    }\r\n\r\n    var julianDateScratch = new JulianDate(0, 0.0, TimeStandard.TAI);\r\n\r\n    function getDaysSinceEpoch(xys, dayTT, secondTT) {\r\n        var dateTT = julianDateScratch;\r\n        dateTT.dayNumber = dayTT;\r\n        dateTT.secondsOfDay = secondTT;\r\n        return JulianDate.daysDifference(dateTT, xys._sampleZeroDateTT);\r\n    }\r\n\r\n    /**\r\n     * Preloads XYS data for a specified date range.\r\n     *\r\n     * @param {Number} startDayTT The Julian day number of the beginning of the interval to preload, expressed in\r\n     *                 the Terrestrial Time (TT) time standard.\r\n     * @param {Number} startSecondTT The seconds past noon of the beginning of the interval to preload, expressed in\r\n     *                 the Terrestrial Time (TT) time standard.\r\n     * @param {Number} stopDayTT The Julian day number of the end of the interval to preload, expressed in\r\n     *                 the Terrestrial Time (TT) time standard.\r\n     * @param {Number} stopSecondTT The seconds past noon of the end of the interval to preload, expressed in\r\n     *                 the Terrestrial Time (TT) time standard.\r\n     * @returns {Promise} A promise that, when resolved, indicates that the requested interval has been\r\n     *                    preloaded.\r\n     */\r\n    Iau2006XysData.prototype.preload = function(startDayTT, startSecondTT, stopDayTT, stopSecondTT) {\r\n        var startDaysSinceEpoch = getDaysSinceEpoch(this, startDayTT, startSecondTT);\r\n        var stopDaysSinceEpoch = getDaysSinceEpoch(this, stopDayTT, stopSecondTT);\r\n\r\n        var startIndex = (startDaysSinceEpoch / this._stepSizeDays - this._interpolationOrder / 2) | 0;\r\n        if (startIndex < 0) {\r\n            startIndex = 0;\r\n        }\r\n\r\n        var stopIndex = (stopDaysSinceEpoch / this._stepSizeDays - this._interpolationOrder / 2) | 0 + this._interpolationOrder;\r\n        if (stopIndex >= this._totalSamples) {\r\n            stopIndex = this._totalSamples - 1;\r\n        }\r\n\r\n        var startChunk = (startIndex / this._samplesPerXysFile) | 0;\r\n        var stopChunk = (stopIndex / this._samplesPerXysFile) | 0;\r\n\r\n        var promises = [];\r\n        for ( var i = startChunk; i <= stopChunk; ++i) {\r\n            promises.push(requestXysChunk(this, i));\r\n        }\r\n\r\n        return when.all(promises);\r\n    };\r\n\r\n    /**\r\n     * Computes the XYS values for a given date by interpolating.  If the required data is not yet downloaded,\r\n     * this method will return undefined.\r\n     *\r\n     * @param {Number} dayTT The Julian day number for which to compute the XYS value, expressed in\r\n     *                 the Terrestrial Time (TT) time standard.\r\n     * @param {Number} secondTT The seconds past noon of the date for which to compute the XYS value, expressed in\r\n     *                 the Terrestrial Time (TT) time standard.\r\n     * @param {Iau2006XysSample} [result] The instance to which to copy the interpolated result.  If this parameter\r\n     *                           is undefined, a new instance is allocated and returned.\r\n     * @returns {Iau2006XysSample} The interpolated XYS values, or undefined if the required data for this\r\n     *                             computation has not yet been downloaded.\r\n     *\r\n     * @see Iau2006XysData#preload\r\n     */\r\n    Iau2006XysData.prototype.computeXysRadians = function(dayTT, secondTT, result) {\r\n        var daysSinceEpoch = getDaysSinceEpoch(this, dayTT, secondTT);\r\n        if (daysSinceEpoch < 0.0) {\r\n            // Can't evaluate prior to the epoch of the data.\r\n            return undefined;\r\n        }\r\n\r\n        var centerIndex = (daysSinceEpoch / this._stepSizeDays) | 0;\r\n        if (centerIndex >= this._totalSamples) {\r\n            // Can't evaluate after the last sample in the data.\r\n            return undefined;\r\n        }\r\n\r\n        var degree = this._interpolationOrder;\r\n\r\n        var firstIndex = centerIndex - ((degree / 2) | 0);\r\n        if (firstIndex < 0) {\r\n            firstIndex = 0;\r\n        }\r\n        var lastIndex = firstIndex + degree;\r\n        if (lastIndex >= this._totalSamples) {\r\n            lastIndex = this._totalSamples - 1;\r\n            firstIndex = lastIndex - degree;\r\n            if (firstIndex < 0) {\r\n                firstIndex = 0;\r\n            }\r\n        }\r\n\r\n        // Are all the samples we need present?\r\n        // We can assume so if the first and last are present\r\n        var isDataMissing = false;\r\n        var samples = this._samples;\r\n        if (!defined(samples[firstIndex * 3])) {\r\n            requestXysChunk(this, (firstIndex / this._samplesPerXysFile) | 0);\r\n            isDataMissing = true;\r\n        }\r\n\r\n        if (!defined(samples[lastIndex * 3])) {\r\n            requestXysChunk(this, (lastIndex / this._samplesPerXysFile) | 0);\r\n            isDataMissing = true;\r\n        }\r\n\r\n        if (isDataMissing) {\r\n            return undefined;\r\n        }\r\n\r\n        if (!defined(result)) {\r\n            result = new Iau2006XysSample(0.0, 0.0, 0.0);\r\n        } else {\r\n            result.x = 0.0;\r\n            result.y = 0.0;\r\n            result.s = 0.0;\r\n        }\r\n\r\n        var x = daysSinceEpoch - firstIndex * this._stepSizeDays;\r\n\r\n        var work = this._work;\r\n        var denom = this._denominators;\r\n        var coef = this._coef;\r\n        var xTable = this._xTable;\r\n\r\n        var i, j;\r\n        for (i = 0; i <= degree; ++i) {\r\n            work[i] = x - xTable[i];\r\n        }\r\n\r\n        for (i = 0; i <= degree; ++i) {\r\n            coef[i] = 1.0;\r\n\r\n            for (j = 0; j <= degree; ++j) {\r\n                if (j !== i) {\r\n                    coef[i] *= work[j];\r\n                }\r\n            }\r\n\r\n            coef[i] *= denom[i];\r\n\r\n            var sampleIndex = (firstIndex + i) * 3;\r\n            result.x += coef[i] * samples[sampleIndex++];\r\n            result.y += coef[i] * samples[sampleIndex++];\r\n            result.s += coef[i] * samples[sampleIndex];\r\n        }\r\n\r\n        return result;\r\n    };\r\n\r\n    function requestXysChunk(xysData, chunkIndex) {\r\n        if (xysData._chunkDownloadsInProgress[chunkIndex]) {\r\n            // Chunk has already been requested.\r\n            return xysData._chunkDownloadsInProgress[chunkIndex];\r\n        }\r\n\r\n        var deferred = when.defer();\r\n\r\n        xysData._chunkDownloadsInProgress[chunkIndex] = deferred;\r\n\r\n        var chunkUrl;\r\n        var xysFileUrlTemplate = xysData._xysFileUrlTemplate;\r\n        if (defined(xysFileUrlTemplate)) {\r\n            chunkUrl = xysFileUrlTemplate.getDerivedResource({\r\n                templateValues: {\r\n                    '0': chunkIndex\r\n                }\r\n            });\r\n        } else {\r\n            chunkUrl = new Resource({\r\n                url : buildModuleUrl('Assets/IAU2006_XYS/IAU2006_XYS_' + chunkIndex + '.json')\r\n            });\r\n        }\r\n\r\n        when(chunkUrl.fetchJson(), function(chunk) {\r\n            xysData._chunkDownloadsInProgress[chunkIndex] = false;\r\n\r\n            var samples = xysData._samples;\r\n            var newSamples = chunk.samples;\r\n            var startIndex = chunkIndex * xysData._samplesPerXysFile * 3;\r\n\r\n            for ( var i = 0, len = newSamples.length; i < len; ++i) {\r\n                samples[startIndex + i] = newSamples[i];\r\n            }\r\n\r\n            deferred.resolve();\r\n        });\r\n\r\n        return deferred.promise;\r\n    }\r\nexport default Iau2006XysData;\r\n","import when from '../ThirdParty/when.js';\r\nimport Cartesian2 from './Cartesian2.js';\r\nimport Cartesian3 from './Cartesian3.js';\r\nimport Cartesian4 from './Cartesian4.js';\r\nimport Cartographic from './Cartographic.js';\r\nimport Check from './Check.js';\r\nimport defaultValue from './defaultValue.js';\r\nimport defined from './defined.js';\r\nimport DeveloperError from './DeveloperError.js';\r\nimport EarthOrientationParameters from './EarthOrientationParameters.js';\r\nimport EarthOrientationParametersSample from './EarthOrientationParametersSample.js';\r\nimport Ellipsoid from './Ellipsoid.js';\r\nimport HeadingPitchRoll from './HeadingPitchRoll.js';\r\nimport Iau2006XysData from './Iau2006XysData.js';\r\nimport Iau2006XysSample from './Iau2006XysSample.js';\r\nimport JulianDate from './JulianDate.js';\r\nimport CesiumMath from './Math.js';\r\nimport Matrix3 from './Matrix3.js';\r\nimport Matrix4 from './Matrix4.js';\r\nimport Quaternion from './Quaternion.js';\r\nimport TimeConstants from './TimeConstants.js';\r\n\r\n    /**\r\n     * Contains functions for transforming positions to various reference frames.\r\n     *\r\n     * @exports Transforms\r\n     * @namespace\r\n     */\r\n    var Transforms = {};\r\n\r\n    var vectorProductLocalFrame = {\r\n        up : {\r\n            south : 'east',\r\n            north : 'west',\r\n            west : 'south',\r\n            east : 'north'\r\n        },\r\n        down : {\r\n            south : 'west',\r\n            north : 'east',\r\n            west : 'north',\r\n            east : 'south'\r\n        },\r\n        south : {\r\n            up : 'west',\r\n            down : 'east',\r\n            west : 'down',\r\n            east : 'up'\r\n        },\r\n        north : {\r\n            up : 'east',\r\n            down : 'west',\r\n            west : 'up',\r\n            east : 'down'\r\n        },\r\n        west : {\r\n            up : 'north',\r\n            down : 'south',\r\n            north : 'down',\r\n            south : 'up'\r\n        },\r\n        east : {\r\n            up : 'south',\r\n            down : 'north',\r\n            north : 'up',\r\n            south : 'down'\r\n        }\r\n    };\r\n\r\n    var degeneratePositionLocalFrame = {\r\n        north : [-1, 0, 0],\r\n        east : [0, 1, 0],\r\n        up : [0, 0, 1],\r\n        south : [1, 0, 0],\r\n        west : [0, -1, 0],\r\n        down : [0, 0, -1]\r\n    };\r\n\r\n    var localFrameToFixedFrameCache = {};\r\n\r\n    var scratchCalculateCartesian = {\r\n        east : new Cartesian3(),\r\n        north : new Cartesian3(),\r\n        up : new Cartesian3(),\r\n        west : new Cartesian3(),\r\n        south : new Cartesian3(),\r\n        down : new Cartesian3()\r\n    };\r\n    var scratchFirstCartesian = new Cartesian3();\r\n    var scratchSecondCartesian = new Cartesian3();\r\n    var scratchThirdCartesian = new Cartesian3();\r\n    /**\r\n    * Generates a function that computes a 4x4 transformation matrix from a reference frame\r\n    * centered at the provided origin to the provided ellipsoid's fixed reference frame.\r\n    * @param  {String} firstAxis  name of the first axis of the local reference frame. Must be\r\n    *  'east', 'north', 'up', 'west', 'south' or 'down'.\r\n    * @param  {String} secondAxis  name of the second axis of the local reference frame. Must be\r\n    *  'east', 'north', 'up', 'west', 'south' or 'down'.\r\n    * @return {localFrameToFixedFrameGenerator~resultat} The function that will computes a\r\n    * 4x4 transformation matrix from a reference frame, with first axis and second axis compliant with the parameters,\r\n    */\r\n    Transforms.localFrameToFixedFrameGenerator = function (firstAxis, secondAxis) {\r\n        if (!vectorProductLocalFrame.hasOwnProperty(firstAxis) || !vectorProductLocalFrame[firstAxis].hasOwnProperty(secondAxis)) {\r\n            throw new DeveloperError('firstAxis and secondAxis must be east, north, up, west, south or down.');\r\n        }\r\n        var thirdAxis = vectorProductLocalFrame[firstAxis][secondAxis];\r\n\r\n        /**\r\n         * Computes a 4x4 transformation matrix from a reference frame\r\n         * centered at the provided origin to the provided ellipsoid's fixed reference frame.\r\n         * @callback Transforms~LocalFrameToFixedFrame\r\n         * @param {Cartesian3} origin The center point of the local reference frame.\r\n         * @param {Ellipsoid} [ellipsoid=Ellipsoid.WGS84] The ellipsoid whose fixed frame is used in the transformation.\r\n         * @param {Matrix4} [result] The object onto which to store the result.\r\n         * @returns {Matrix4} The modified result parameter or a new Matrix4 instance if none was provided.\r\n         */\r\n        var resultat;\r\n        var hashAxis = firstAxis + secondAxis;\r\n        if (defined(localFrameToFixedFrameCache[hashAxis])) {\r\n            resultat = localFrameToFixedFrameCache[hashAxis];\r\n        } else {\r\n            resultat = function (origin, ellipsoid, result) {\r\n                //>>includeStart('debug', pragmas.debug);\r\n                if (!defined(origin)) {\r\n                    throw new DeveloperError('origin is required.');\r\n                }\r\n                //>>includeEnd('debug');\r\n                if (!defined(result)) {\r\n                    result = new Matrix4();\r\n                }\r\n                if (Cartesian3.equalsEpsilon(origin, Cartesian3.ZERO, CesiumMath.EPSILON14)) {\r\n                    // If x, y, and z are zero, use the degenerate local frame, which is a special case\r\n                    Cartesian3.unpack(degeneratePositionLocalFrame[firstAxis], 0, scratchFirstCartesian);\r\n                    Cartesian3.unpack(degeneratePositionLocalFrame[secondAxis], 0, scratchSecondCartesian);\r\n                    Cartesian3.unpack(degeneratePositionLocalFrame[thirdAxis], 0, scratchThirdCartesian);\r\n                } else if (CesiumMath.equalsEpsilon(origin.x, 0.0, CesiumMath.EPSILON14) && CesiumMath.equalsEpsilon(origin.y, 0.0, CesiumMath.EPSILON14)) {\r\n                    // If x and y are zero, assume origin is at a pole, which is a special case.\r\n                    var sign = CesiumMath.sign(origin.z);\r\n\r\n                    Cartesian3.unpack(degeneratePositionLocalFrame[firstAxis], 0, scratchFirstCartesian);\r\n                    if (firstAxis !== 'east' && firstAxis !== 'west') {\r\n                        Cartesian3.multiplyByScalar(scratchFirstCartesian, sign, scratchFirstCartesian);\r\n                    }\r\n\r\n                    Cartesian3.unpack(degeneratePositionLocalFrame[secondAxis], 0, scratchSecondCartesian);\r\n                    if (secondAxis !== 'east' && secondAxis !== 'west') {\r\n                        Cartesian3.multiplyByScalar(scratchSecondCartesian, sign, scratchSecondCartesian);\r\n                    }\r\n\r\n                    Cartesian3.unpack(degeneratePositionLocalFrame[thirdAxis], 0, scratchThirdCartesian);\r\n                    if (thirdAxis !== 'east' && thirdAxis !== 'west') {\r\n                        Cartesian3.multiplyByScalar(scratchThirdCartesian, sign, scratchThirdCartesian);\r\n                    }\r\n                } else {\r\n                    ellipsoid = defaultValue(ellipsoid, Ellipsoid.WGS84);\r\n                    ellipsoid.geodeticSurfaceNormal(origin, scratchCalculateCartesian.up);\r\n\r\n                    var up = scratchCalculateCartesian.up;\r\n                    var east = scratchCalculateCartesian.east;\r\n                    east.x = -origin.y;\r\n                    east.y = origin.x;\r\n                    east.z = 0.0;\r\n                    Cartesian3.normalize(east, scratchCalculateCartesian.east);\r\n                    Cartesian3.cross(up, east, scratchCalculateCartesian.north);\r\n\r\n                    Cartesian3.multiplyByScalar(scratchCalculateCartesian.up, -1, scratchCalculateCartesian.down);\r\n                    Cartesian3.multiplyByScalar(scratchCalculateCartesian.east, -1, scratchCalculateCartesian.west);\r\n                    Cartesian3.multiplyByScalar(scratchCalculateCartesian.north, -1, scratchCalculateCartesian.south);\r\n\r\n                    scratchFirstCartesian = scratchCalculateCartesian[firstAxis];\r\n                    scratchSecondCartesian = scratchCalculateCartesian[secondAxis];\r\n                    scratchThirdCartesian = scratchCalculateCartesian[thirdAxis];\r\n                }\r\n                result[0] = scratchFirstCartesian.x;\r\n                result[1] = scratchFirstCartesian.y;\r\n                result[2] = scratchFirstCartesian.z;\r\n                result[3] = 0.0;\r\n                result[4] = scratchSecondCartesian.x;\r\n                result[5] = scratchSecondCartesian.y;\r\n                result[6] = scratchSecondCartesian.z;\r\n                result[7] = 0.0;\r\n                result[8] = scratchThirdCartesian.x;\r\n                result[9] = scratchThirdCartesian.y;\r\n                result[10] = scratchThirdCartesian.z;\r\n                result[11] = 0.0;\r\n                result[12] = origin.x;\r\n                result[13] = origin.y;\r\n                result[14] = origin.z;\r\n                result[15] = 1.0;\r\n                return result;\r\n            };\r\n            localFrameToFixedFrameCache[hashAxis] = resultat;\r\n        }\r\n        return resultat;\r\n    };\r\n\r\n    /**\r\n     * Computes a 4x4 transformation matrix from a reference frame with an east-north-up axes\r\n     * centered at the provided origin to the provided ellipsoid's fixed reference frame.\r\n     * The local axes are defined as:\r\n     * <ul>\r\n     * <li>The <code>x</code> axis points in the local east direction.</li>\r\n     * <li>The <code>y</code> axis points in the local north direction.</li>\r\n     * <li>The <code>z</code> axis points in the direction of the ellipsoid surface normal which passes through the position.</li>\r\n     * </ul>\r\n     *\r\n     * @function\r\n     * @param {Cartesian3} origin The center point of the local reference frame.\r\n     * @param {Ellipsoid} [ellipsoid=Ellipsoid.WGS84] The ellipsoid whose fixed frame is used in the transformation.\r\n     * @param {Matrix4} [result] The object onto which to store the result.\r\n     * @returns {Matrix4} The modified result parameter or a new Matrix4 instance if none was provided.\r\n     *\r\n     * @example\r\n     * // Get the transform from local east-north-up at cartographic (0.0, 0.0) to Earth's fixed frame.\r\n     * var center = Cesium.Cartesian3.fromDegrees(0.0, 0.0);\r\n     * var transform = Cesium.Transforms.eastNorthUpToFixedFrame(center);\r\n     */\r\n    Transforms.eastNorthUpToFixedFrame = Transforms.localFrameToFixedFrameGenerator('east','north');\r\n\r\n    /**\r\n     * Computes a 4x4 transformation matrix from a reference frame with an north-east-down axes\r\n     * centered at the provided origin to the provided ellipsoid's fixed reference frame.\r\n     * The local axes are defined as:\r\n     * <ul>\r\n     * <li>The <code>x</code> axis points in the local north direction.</li>\r\n     * <li>The <code>y</code> axis points in the local east direction.</li>\r\n     * <li>The <code>z</code> axis points in the opposite direction of the ellipsoid surface normal which passes through the position.</li>\r\n     * </ul>\r\n     *\r\n     * @function\r\n     * @param {Cartesian3} origin The center point of the local reference frame.\r\n     * @param {Ellipsoid} [ellipsoid=Ellipsoid.WGS84] The ellipsoid whose fixed frame is used in the transformation.\r\n     * @param {Matrix4} [result] The object onto which to store the result.\r\n     * @returns {Matrix4} The modified result parameter or a new Matrix4 instance if none was provided.\r\n     *\r\n     * @example\r\n     * // Get the transform from local north-east-down at cartographic (0.0, 0.0) to Earth's fixed frame.\r\n     * var center = Cesium.Cartesian3.fromDegrees(0.0, 0.0);\r\n     * var transform = Cesium.Transforms.northEastDownToFixedFrame(center);\r\n     */\r\n    Transforms.northEastDownToFixedFrame = Transforms.localFrameToFixedFrameGenerator('north','east');\r\n\r\n    /**\r\n     * Computes a 4x4 transformation matrix from a reference frame with an north-up-east axes\r\n     * centered at the provided origin to the provided ellipsoid's fixed reference frame.\r\n     * The local axes are defined as:\r\n     * <ul>\r\n     * <li>The <code>x</code> axis points in the local north direction.</li>\r\n     * <li>The <code>y</code> axis points in the direction of the ellipsoid surface normal which passes through the position.</li>\r\n     * <li>The <code>z</code> axis points in the local east direction.</li>\r\n     * </ul>\r\n     *\r\n     * @function\r\n     * @param {Cartesian3} origin The center point of the local reference frame.\r\n     * @param {Ellipsoid} [ellipsoid=Ellipsoid.WGS84] The ellipsoid whose fixed frame is used in the transformation.\r\n     * @param {Matrix4} [result] The object onto which to store the result.\r\n     * @returns {Matrix4} The modified result parameter or a new Matrix4 instance if none was provided.\r\n     *\r\n     * @example\r\n     * // Get the transform from local north-up-east at cartographic (0.0, 0.0) to Earth's fixed frame.\r\n     * var center = Cesium.Cartesian3.fromDegrees(0.0, 0.0);\r\n     * var transform = Cesium.Transforms.northUpEastToFixedFrame(center);\r\n     */\r\n    Transforms.northUpEastToFixedFrame = Transforms.localFrameToFixedFrameGenerator('north','up');\r\n\r\n    /**\r\n     * Computes a 4x4 transformation matrix from a reference frame with an north-west-up axes\r\n     * centered at the provided origin to the provided ellipsoid's fixed reference frame.\r\n     * The local axes are defined as:\r\n     * <ul>\r\n     * <li>The <code>x</code> axis points in the local north direction.</li>\r\n     * <li>The <code>y</code> axis points in the local west direction.</li>\r\n     * <li>The <code>z</code> axis points in the direction of the ellipsoid surface normal which passes through the position.</li>\r\n     * </ul>\r\n     *\r\n     * @function\r\n     * @param {Cartesian3} origin The center point of the local reference frame.\r\n     * @param {Ellipsoid} [ellipsoid=Ellipsoid.WGS84] The ellipsoid whose fixed frame is used in the transformation.\r\n     * @param {Matrix4} [result] The object onto which to store the result.\r\n     * @returns {Matrix4} The modified result parameter or a new Matrix4 instance if none was provided.\r\n     *\r\n      * @example\r\n     * // Get the transform from local north-West-Up at cartographic (0.0, 0.0) to Earth's fixed frame.\r\n     * var center = Cesium.Cartesian3.fromDegrees(0.0, 0.0);\r\n     * var transform = Cesium.Transforms.northWestUpToFixedFrame(center);\r\n     */\r\n    Transforms.northWestUpToFixedFrame = Transforms.localFrameToFixedFrameGenerator('north','west');\r\n\r\n    var scratchHPRQuaternion = new Quaternion();\r\n    var scratchScale = new Cartesian3(1.0, 1.0, 1.0);\r\n    var scratchHPRMatrix4 = new Matrix4();\r\n\r\n    /**\r\n     * Computes a 4x4 transformation matrix from a reference frame with axes computed from the heading-pitch-roll angles\r\n     * centered at the provided origin to the provided ellipsoid's fixed reference frame. Heading is the rotation from the local north\r\n     * direction where a positive angle is increasing eastward. Pitch is the rotation from the local east-north plane. Positive pitch angles\r\n     * are above the plane. Negative pitch angles are below the plane. Roll is the first rotation applied about the local east axis.\r\n     *\r\n     * @param {Cartesian3} origin The center point of the local reference frame.\r\n     * @param {HeadingPitchRoll} headingPitchRoll The heading, pitch, and roll.\r\n     * @param {Ellipsoid} [ellipsoid=Ellipsoid.WGS84] The ellipsoid whose fixed frame is used in the transformation.\r\n     * @param {Transforms~LocalFrameToFixedFrame} [fixedFrameTransform=Transforms.eastNorthUpToFixedFrame] A 4x4 transformation\r\n     *  matrix from a reference frame to the provided ellipsoid's fixed reference frame\r\n     * @param {Matrix4} [result] The object onto which to store the result.\r\n     * @returns {Matrix4} The modified result parameter or a new Matrix4 instance if none was provided.\r\n     *\r\n     * @example\r\n     * // Get the transform from local heading-pitch-roll at cartographic (0.0, 0.0) to Earth's fixed frame.\r\n     * var center = Cesium.Cartesian3.fromDegrees(0.0, 0.0);\r\n     * var heading = -Cesium.Math.PI_OVER_TWO;\r\n     * var pitch = Cesium.Math.PI_OVER_FOUR;\r\n     * var roll = 0.0;\r\n     * var hpr = new Cesium.HeadingPitchRoll(heading, pitch, roll);\r\n     * var transform = Cesium.Transforms.headingPitchRollToFixedFrame(center, hpr);\r\n     */\r\n    Transforms.headingPitchRollToFixedFrame = function(origin, headingPitchRoll, ellipsoid, fixedFrameTransform, result) {\r\n        //>>includeStart('debug', pragmas.debug);\r\n        Check.typeOf.object( 'HeadingPitchRoll', headingPitchRoll);\r\n        //>>includeEnd('debug');\r\n\r\n        fixedFrameTransform = defaultValue(fixedFrameTransform, Transforms.eastNorthUpToFixedFrame);\r\n        var hprQuaternion = Quaternion.fromHeadingPitchRoll(headingPitchRoll, scratchHPRQuaternion);\r\n        var hprMatrix = Matrix4.fromTranslationQuaternionRotationScale(Cartesian3.ZERO, hprQuaternion, scratchScale, scratchHPRMatrix4);\r\n        result = fixedFrameTransform(origin, ellipsoid, result);\r\n        return Matrix4.multiply(result, hprMatrix, result);\r\n    };\r\n\r\n    var scratchENUMatrix4 = new Matrix4();\r\n    var scratchHPRMatrix3 = new Matrix3();\r\n\r\n    /**\r\n     * Computes a quaternion from a reference frame with axes computed from the heading-pitch-roll angles\r\n     * centered at the provided origin. Heading is the rotation from the local north\r\n     * direction where a positive angle is increasing eastward. Pitch is the rotation from the local east-north plane. Positive pitch angles\r\n     * are above the plane. Negative pitch angles are below the plane. Roll is the first rotation applied about the local east axis.\r\n     *\r\n     * @param {Cartesian3} origin The center point of the local reference frame.\r\n     * @param {HeadingPitchRoll} headingPitchRoll The heading, pitch, and roll.\r\n     * @param {Ellipsoid} [ellipsoid=Ellipsoid.WGS84] The ellipsoid whose fixed frame is used in the transformation.\r\n     * @param {Transforms~LocalFrameToFixedFrame} [fixedFrameTransform=Transforms.eastNorthUpToFixedFrame] A 4x4 transformation\r\n     *  matrix from a reference frame to the provided ellipsoid's fixed reference frame\r\n     * @param {Quaternion} [result] The object onto which to store the result.\r\n     * @returns {Quaternion} The modified result parameter or a new Quaternion instance if none was provided.\r\n     *\r\n     * @example\r\n     * // Get the quaternion from local heading-pitch-roll at cartographic (0.0, 0.0) to Earth's fixed frame.\r\n     * var center = Cesium.Cartesian3.fromDegrees(0.0, 0.0);\r\n     * var heading = -Cesium.Math.PI_OVER_TWO;\r\n     * var pitch = Cesium.Math.PI_OVER_FOUR;\r\n     * var roll = 0.0;\r\n     * var hpr = new HeadingPitchRoll(heading, pitch, roll);\r\n     * var quaternion = Cesium.Transforms.headingPitchRollQuaternion(center, hpr);\r\n     */\r\n    Transforms.headingPitchRollQuaternion = function(origin, headingPitchRoll, ellipsoid, fixedFrameTransform, result) {\r\n        //>>includeStart('debug', pragmas.debug);\r\n        Check.typeOf.object( 'HeadingPitchRoll', headingPitchRoll);\r\n        //>>includeEnd('debug');\r\n\r\n        var transform = Transforms.headingPitchRollToFixedFrame(origin, headingPitchRoll, ellipsoid, fixedFrameTransform, scratchENUMatrix4);\r\n        var rotation = Matrix4.getMatrix3(transform, scratchHPRMatrix3);\r\n        return Quaternion.fromRotationMatrix(rotation, result);\r\n    };\r\n\r\n    var noScale = new Cartesian3(1.0, 1.0, 1.0);\r\n    var hprCenterScratch = new Cartesian3();\r\n    var ffScratch = new Matrix4();\r\n    var hprTransformScratch = new Matrix4();\r\n    var hprRotationScratch = new Matrix3();\r\n    var hprQuaternionScratch = new Quaternion();\r\n    /**\r\n     * Computes heading-pitch-roll angles from a transform in a particular reference frame. Heading is the rotation from the local north\r\n     * direction where a positive angle is increasing eastward. Pitch is the rotation from the local east-north plane. Positive pitch angles\r\n     * are above the plane. Negative pitch angles are below the plane. Roll is the first rotation applied about the local east axis.\r\n     *\r\n     * @param {Matrix4} transform The transform\r\n     * @param {Ellipsoid} [ellipsoid=Ellipsoid.WGS84] The ellipsoid whose fixed frame is used in the transformation.\r\n     * @param {Transforms~LocalFrameToFixedFrame} [fixedFrameTransform=Transforms.eastNorthUpToFixedFrame] A 4x4 transformation\r\n     *  matrix from a reference frame to the provided ellipsoid's fixed reference frame\r\n     * @param {HeadingPitchRoll} [result] The object onto which to store the result.\r\n     * @returns {HeadingPitchRoll} The modified result parameter or a new HeadingPitchRoll instance if none was provided.\r\n     */\r\n    Transforms.fixedFrameToHeadingPitchRoll = function(transform, ellipsoid, fixedFrameTransform, result) {\r\n        //>>includeStart('debug', pragmas.debug);\r\n        Check.defined('transform', transform);\r\n        //>>includeEnd('debug');\r\n\r\n        ellipsoid = defaultValue(ellipsoid, Ellipsoid.WGS84);\r\n        fixedFrameTransform = defaultValue(fixedFrameTransform, Transforms.eastNorthUpToFixedFrame);\r\n        if (!defined(result)) {\r\n            result = new HeadingPitchRoll();\r\n        }\r\n\r\n        var center = Matrix4.getTranslation(transform, hprCenterScratch);\r\n        if (Cartesian3.equals(center, Cartesian3.ZERO)) {\r\n            result.heading = 0;\r\n            result.pitch = 0;\r\n            result.roll = 0;\r\n            return result;\r\n        }\r\n        var toFixedFrame = Matrix4.inverseTransformation(fixedFrameTransform(center, ellipsoid, ffScratch), ffScratch);\r\n        var transformCopy = Matrix4.setScale(transform, noScale, hprTransformScratch);\r\n        transformCopy = Matrix4.setTranslation(transformCopy, Cartesian3.ZERO, transformCopy);\r\n\r\n        toFixedFrame = Matrix4.multiply(toFixedFrame, transformCopy, toFixedFrame);\r\n        var quaternionRotation = Quaternion.fromRotationMatrix(Matrix4.getMatrix3(toFixedFrame, hprRotationScratch), hprQuaternionScratch);\r\n        quaternionRotation = Quaternion.normalize(quaternionRotation, quaternionRotation);\r\n\r\n        return HeadingPitchRoll.fromQuaternion(quaternionRotation, result);\r\n    };\r\n\r\n    var gmstConstant0 = 6 * 3600 + 41 * 60 + 50.54841;\r\n    var gmstConstant1 = 8640184.812866;\r\n    var gmstConstant2 = 0.093104;\r\n    var gmstConstant3 = -6.2E-6;\r\n    var rateCoef = 1.1772758384668e-19;\r\n    var wgs84WRPrecessing = 7.2921158553E-5;\r\n    var twoPiOverSecondsInDay = CesiumMath.TWO_PI / 86400.0;\r\n    var dateInUtc = new JulianDate();\r\n\r\n    /**\r\n     * Computes a rotation matrix to transform a point or vector from True Equator Mean Equinox (TEME) axes to the\r\n     * pseudo-fixed axes at a given time.  This method treats the UT1 time standard as equivalent to UTC.\r\n     *\r\n     * @param {JulianDate} date The time at which to compute the rotation matrix.\r\n     * @param {Matrix3} [result] The object onto which to store the result.\r\n     * @returns {Matrix3} The modified result parameter or a new Matrix3 instance if none was provided.\r\n     *\r\n     * @example\r\n     * //Set the view to the inertial frame.\r\n     * scene.postUpdate.addEventListener(function(scene, time) {\r\n     *    var now = Cesium.JulianDate.now();\r\n     *    var offset = Cesium.Matrix4.multiplyByPoint(camera.transform, camera.position, new Cesium.Cartesian3());\r\n     *    var transform = Cesium.Matrix4.fromRotationTranslation(Cesium.Transforms.computeTemeToPseudoFixedMatrix(now));\r\n     *    var inverseTransform = Cesium.Matrix4.inverseTransformation(transform, new Cesium.Matrix4());\r\n     *    Cesium.Matrix4.multiplyByPoint(inverseTransform, offset, offset);\r\n     *    camera.lookAtTransform(transform, offset);\r\n     * });\r\n     */\r\n    Transforms.computeTemeToPseudoFixedMatrix = function (date, result) {\r\n        //>>includeStart('debug', pragmas.debug);\r\n        if (!defined(date)) {\r\n            throw new DeveloperError('date is required.');\r\n        }\r\n        //>>includeEnd('debug');\r\n\r\n        // GMST is actually computed using UT1.  We're using UTC as an approximation of UT1.\r\n        // We do not want to use the function like convertTaiToUtc in JulianDate because\r\n        // we explicitly do not want to fail when inside the leap second.\r\n\r\n        dateInUtc = JulianDate.addSeconds(date, -JulianDate.computeTaiMinusUtc(date), dateInUtc);\r\n        var utcDayNumber = dateInUtc.dayNumber;\r\n        var utcSecondsIntoDay = dateInUtc.secondsOfDay;\r\n\r\n        var t;\r\n        var diffDays = utcDayNumber - 2451545;\r\n        if (utcSecondsIntoDay >= 43200.0) {\r\n            t = (diffDays + 0.5) / TimeConstants.DAYS_PER_JULIAN_CENTURY;\r\n        } else {\r\n            t = (diffDays - 0.5) / TimeConstants.DAYS_PER_JULIAN_CENTURY;\r\n        }\r\n\r\n        var gmst0 = gmstConstant0 + t * (gmstConstant1 + t * (gmstConstant2 + t * gmstConstant3));\r\n        var angle = (gmst0 * twoPiOverSecondsInDay) % CesiumMath.TWO_PI;\r\n        var ratio = wgs84WRPrecessing + rateCoef * (utcDayNumber - 2451545.5);\r\n        var secondsSinceMidnight = (utcSecondsIntoDay + TimeConstants.SECONDS_PER_DAY * 0.5) % TimeConstants.SECONDS_PER_DAY;\r\n        var gha = angle + (ratio * secondsSinceMidnight);\r\n        var cosGha = Math.cos(gha);\r\n        var sinGha = Math.sin(gha);\r\n\r\n        if (!defined(result)) {\r\n            return new Matrix3(cosGha, sinGha, 0.0,\r\n                              -sinGha, cosGha, 0.0,\r\n                                  0.0,    0.0, 1.0);\r\n        }\r\n        result[0] = cosGha;\r\n        result[1] = -sinGha;\r\n        result[2] = 0.0;\r\n        result[3] = sinGha;\r\n        result[4] = cosGha;\r\n        result[5] = 0.0;\r\n        result[6] = 0.0;\r\n        result[7] = 0.0;\r\n        result[8] = 1.0;\r\n        return result;\r\n    };\r\n\r\n    /**\r\n     * The source of IAU 2006 XYS data, used for computing the transformation between the\r\n     * Fixed and ICRF axes.\r\n     * @type {Iau2006XysData}\r\n     *\r\n     * @see Transforms.computeIcrfToFixedMatrix\r\n     * @see Transforms.computeFixedToIcrfMatrix\r\n     *\r\n     * @private\r\n     */\r\n    Transforms.iau2006XysData = new Iau2006XysData();\r\n\r\n    /**\r\n     * The source of Earth Orientation Parameters (EOP) data, used for computing the transformation\r\n     * between the Fixed and ICRF axes.  By default, zero values are used for all EOP values,\r\n     * yielding a reasonable but not completely accurate representation of the ICRF axes.\r\n     * @type {EarthOrientationParameters}\r\n     *\r\n     * @see Transforms.computeIcrfToFixedMatrix\r\n     * @see Transforms.computeFixedToIcrfMatrix\r\n     *\r\n     * @private\r\n     */\r\n    Transforms.earthOrientationParameters = EarthOrientationParameters.NONE;\r\n\r\n    var ttMinusTai = 32.184;\r\n    var j2000ttDays = 2451545.0;\r\n\r\n    /**\r\n     * Preloads the data necessary to transform between the ICRF and Fixed axes, in either\r\n     * direction, over a given interval.  This function returns a promise that, when resolved,\r\n     * indicates that the preload has completed.\r\n     *\r\n     * @param {TimeInterval} timeInterval The interval to preload.\r\n     * @returns {Promise} A promise that, when resolved, indicates that the preload has completed\r\n     *          and evaluation of the transformation between the fixed and ICRF axes will\r\n     *          no longer return undefined for a time inside the interval.\r\n     *\r\n     *\r\n     * @example\r\n     * var interval = new Cesium.TimeInterval(...);\r\n     * when(Cesium.Transforms.preloadIcrfFixed(interval), function() {\r\n     *     // the data is now loaded\r\n     * });\r\n     *\r\n     * @see Transforms.computeIcrfToFixedMatrix\r\n     * @see Transforms.computeFixedToIcrfMatrix\r\n     * @see when\r\n     */\r\n    Transforms.preloadIcrfFixed = function(timeInterval) {\r\n        var startDayTT = timeInterval.start.dayNumber;\r\n        var startSecondTT = timeInterval.start.secondsOfDay + ttMinusTai;\r\n        var stopDayTT = timeInterval.stop.dayNumber;\r\n        var stopSecondTT = timeInterval.stop.secondsOfDay + ttMinusTai;\r\n\r\n        var xysPromise = Transforms.iau2006XysData.preload(startDayTT, startSecondTT, stopDayTT, stopSecondTT);\r\n        var eopPromise = Transforms.earthOrientationParameters.getPromiseToLoad();\r\n\r\n        return when.all([xysPromise, eopPromise]);\r\n    };\r\n\r\n    /**\r\n     * Computes a rotation matrix to transform a point or vector from the International Celestial\r\n     * Reference Frame (GCRF/ICRF) inertial frame axes to the Earth-Fixed frame axes (ITRF)\r\n     * at a given time.  This function may return undefined if the data necessary to\r\n     * do the transformation is not yet loaded.\r\n     *\r\n     * @param {JulianDate} date The time at which to compute the rotation matrix.\r\n     * @param {Matrix3} [result] The object onto which to store the result.  If this parameter is\r\n     *                  not specified, a new instance is created and returned.\r\n     * @returns {Matrix3} The rotation matrix, or undefined if the data necessary to do the\r\n     *                   transformation is not yet loaded.\r\n     *\r\n     *\r\n     * @example\r\n     * scene.postUpdate.addEventListener(function(scene, time) {\r\n     *   // View in ICRF.\r\n     *   var icrfToFixed = Cesium.Transforms.computeIcrfToFixedMatrix(time);\r\n     *   if (Cesium.defined(icrfToFixed)) {\r\n     *     var offset = Cesium.Cartesian3.clone(camera.position);\r\n     *     var transform = Cesium.Matrix4.fromRotationTranslation(icrfToFixed);\r\n     *     camera.lookAtTransform(transform, offset);\r\n     *   }\r\n     * });\r\n     *\r\n     * @see Transforms.preloadIcrfFixed\r\n     */\r\n    Transforms.computeIcrfToFixedMatrix = function(date, result) {\r\n        //>>includeStart('debug', pragmas.debug);\r\n        if (!defined(date)) {\r\n            throw new DeveloperError('date is required.');\r\n        }\r\n        //>>includeEnd('debug');\r\n        if (!defined(result)) {\r\n            result = new Matrix3();\r\n        }\r\n\r\n        var fixedToIcrfMtx = Transforms.computeFixedToIcrfMatrix(date, result);\r\n        if (!defined(fixedToIcrfMtx)) {\r\n            return undefined;\r\n        }\r\n\r\n        return Matrix3.transpose(fixedToIcrfMtx, result);\r\n    };\r\n\r\n    var xysScratch = new Iau2006XysSample(0.0, 0.0, 0.0);\r\n    var eopScratch = new EarthOrientationParametersSample(0.0, 0.0, 0.0, 0.0, 0.0, 0.0);\r\n    var rotation1Scratch = new Matrix3();\r\n    var rotation2Scratch = new Matrix3();\r\n\r\n    /**\r\n     * Computes a rotation matrix to transform a point or vector from the Earth-Fixed frame axes (ITRF)\r\n     * to the International Celestial Reference Frame (GCRF/ICRF) inertial frame axes\r\n     * at a given time.  This function may return undefined if the data necessary to\r\n     * do the transformation is not yet loaded.\r\n     *\r\n     * @param {JulianDate} date The time at which to compute the rotation matrix.\r\n     * @param {Matrix3} [result] The object onto which to store the result.  If this parameter is\r\n     *                  not specified, a new instance is created and returned.\r\n     * @returns {Matrix3} The rotation matrix, or undefined if the data necessary to do the\r\n     *                   transformation is not yet loaded.\r\n     *\r\n     *\r\n     * @example\r\n     * // Transform a point from the ICRF axes to the Fixed axes.\r\n     * var now = Cesium.JulianDate.now();\r\n     * var pointInFixed = Cesium.Cartesian3.fromDegrees(0.0, 0.0);\r\n     * var fixedToIcrf = Cesium.Transforms.computeIcrfToFixedMatrix(now);\r\n     * var pointInInertial = new Cesium.Cartesian3();\r\n     * if (Cesium.defined(fixedToIcrf)) {\r\n     *     pointInInertial = Cesium.Matrix3.multiplyByVector(fixedToIcrf, pointInFixed, pointInInertial);\r\n     * }\r\n     *\r\n     * @see Transforms.preloadIcrfFixed\r\n     */\r\n    Transforms.computeFixedToIcrfMatrix = function(date, result) {\r\n        //>>includeStart('debug', pragmas.debug);\r\n        if (!defined(date)) {\r\n            throw new DeveloperError('date is required.');\r\n        }\r\n        //>>includeEnd('debug');\r\n\r\n        if (!defined(result)) {\r\n            result = new Matrix3();\r\n        }\r\n\r\n        // Compute pole wander\r\n        var eop = Transforms.earthOrientationParameters.compute(date, eopScratch);\r\n        if (!defined(eop)) {\r\n            return undefined;\r\n        }\r\n\r\n        // There is no external conversion to Terrestrial Time (TT).\r\n        // So use International Atomic Time (TAI) and convert using offsets.\r\n        // Here we are assuming that dayTT and secondTT are positive\r\n        var dayTT = date.dayNumber;\r\n        // It's possible here that secondTT could roll over 86400\r\n        // This does not seem to affect the precision (unit tests check for this)\r\n        var secondTT = date.secondsOfDay + ttMinusTai;\r\n\r\n        var xys = Transforms.iau2006XysData.computeXysRadians(dayTT, secondTT, xysScratch);\r\n        if (!defined(xys)) {\r\n            return undefined;\r\n        }\r\n\r\n        var x = xys.x + eop.xPoleOffset;\r\n        var y = xys.y + eop.yPoleOffset;\r\n\r\n        // Compute XYS rotation\r\n        var a = 1.0 / (1.0 + Math.sqrt(1.0 - x * x - y * y));\r\n\r\n        var rotation1 = rotation1Scratch;\r\n        rotation1[0] = 1.0 - a * x * x;\r\n        rotation1[3] = -a * x * y;\r\n        rotation1[6] = x;\r\n        rotation1[1] = -a * x * y;\r\n        rotation1[4] = 1 - a * y * y;\r\n        rotation1[7] = y;\r\n        rotation1[2] = -x;\r\n        rotation1[5] = -y;\r\n        rotation1[8] = 1 - a * (x * x + y * y);\r\n\r\n        var rotation2 = Matrix3.fromRotationZ(-xys.s, rotation2Scratch);\r\n        var matrixQ = Matrix3.multiply(rotation1, rotation2, rotation1Scratch);\r\n\r\n        // Similar to TT conversions above\r\n        // It's possible here that secondTT could roll over 86400\r\n        // This does not seem to affect the precision (unit tests check for this)\r\n        var dateUt1day = date.dayNumber;\r\n        var dateUt1sec = date.secondsOfDay - JulianDate.computeTaiMinusUtc(date) + eop.ut1MinusUtc;\r\n\r\n        // Compute Earth rotation angle\r\n        // The IERS standard for era is\r\n        //    era = 0.7790572732640 + 1.00273781191135448 * Tu\r\n        // where\r\n        //    Tu = JulianDateInUt1 - 2451545.0\r\n        // However, you get much more precision if you make the following simplification\r\n        //    era = a + (1 + b) * (JulianDayNumber + FractionOfDay - 2451545)\r\n        //    era = a + (JulianDayNumber - 2451545) + FractionOfDay + b (JulianDayNumber - 2451545 + FractionOfDay)\r\n        //    era = a + FractionOfDay + b (JulianDayNumber - 2451545 + FractionOfDay)\r\n        // since (JulianDayNumber - 2451545) represents an integer number of revolutions which will be discarded anyway.\r\n        var daysSinceJ2000 = dateUt1day - 2451545;\r\n        var fractionOfDay = dateUt1sec / TimeConstants.SECONDS_PER_DAY;\r\n        var era = 0.7790572732640 + fractionOfDay + 0.00273781191135448 * (daysSinceJ2000 + fractionOfDay);\r\n        era = (era % 1.0) * CesiumMath.TWO_PI;\r\n\r\n        var earthRotation = Matrix3.fromRotationZ(era, rotation2Scratch);\r\n\r\n        // pseudoFixed to ICRF\r\n        var pfToIcrf = Matrix3.multiply(matrixQ, earthRotation, rotation1Scratch);\r\n\r\n        // Compute pole wander matrix\r\n        var cosxp = Math.cos(eop.xPoleWander);\r\n        var cosyp = Math.cos(eop.yPoleWander);\r\n        var sinxp = Math.sin(eop.xPoleWander);\r\n        var sinyp = Math.sin(eop.yPoleWander);\r\n\r\n        var ttt = (dayTT - j2000ttDays) + secondTT / TimeConstants.SECONDS_PER_DAY;\r\n        ttt /= 36525.0;\r\n\r\n        // approximate sp value in rad\r\n        var sp = -47.0e-6 * ttt * CesiumMath.RADIANS_PER_DEGREE / 3600.0;\r\n        var cossp = Math.cos(sp);\r\n        var sinsp = Math.sin(sp);\r\n\r\n        var fToPfMtx = rotation2Scratch;\r\n        fToPfMtx[0] = cosxp * cossp;\r\n        fToPfMtx[1] = cosxp * sinsp;\r\n        fToPfMtx[2] = sinxp;\r\n        fToPfMtx[3] = -cosyp * sinsp + sinyp * sinxp * cossp;\r\n        fToPfMtx[4] = cosyp * cossp + sinyp * sinxp * sinsp;\r\n        fToPfMtx[5] = -sinyp * cosxp;\r\n        fToPfMtx[6] = -sinyp * sinsp - cosyp * sinxp * cossp;\r\n        fToPfMtx[7] = sinyp * cossp - cosyp * sinxp * sinsp;\r\n        fToPfMtx[8] = cosyp * cosxp;\r\n\r\n        return Matrix3.multiply(pfToIcrf, fToPfMtx, result);\r\n    };\r\n\r\n    var pointToWindowCoordinatesTemp = new Cartesian4();\r\n\r\n    /**\r\n     * Transform a point from model coordinates to window coordinates.\r\n     *\r\n     * @param {Matrix4} modelViewProjectionMatrix The 4x4 model-view-projection matrix.\r\n     * @param {Matrix4} viewportTransformation The 4x4 viewport transformation.\r\n     * @param {Cartesian3} point The point to transform.\r\n     * @param {Cartesian2} [result] The object onto which to store the result.\r\n     * @returns {Cartesian2} The modified result parameter or a new Cartesian2 instance if none was provided.\r\n     */\r\n    Transforms.pointToWindowCoordinates = function (modelViewProjectionMatrix, viewportTransformation, point, result) {\r\n        result = Transforms.pointToGLWindowCoordinates(modelViewProjectionMatrix, viewportTransformation, point, result);\r\n        result.y = 2.0 * viewportTransformation[5] - result.y;\r\n        return result;\r\n    };\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    Transforms.pointToGLWindowCoordinates = function(modelViewProjectionMatrix, viewportTransformation, point, result) {\r\n        //>>includeStart('debug', pragmas.debug);\r\n        if (!defined(modelViewProjectionMatrix)) {\r\n            throw new DeveloperError('modelViewProjectionMatrix is required.');\r\n        }\r\n\r\n        if (!defined(viewportTransformation)) {\r\n            throw new DeveloperError('viewportTransformation is required.');\r\n        }\r\n\r\n        if (!defined(point)) {\r\n            throw new DeveloperError('point is required.');\r\n        }\r\n        //>>includeEnd('debug');\r\n\r\n        if (!defined(result)) {\r\n            result = new Cartesian2();\r\n        }\r\n\r\n        var tmp = pointToWindowCoordinatesTemp;\r\n\r\n        Matrix4.multiplyByVector(modelViewProjectionMatrix, Cartesian4.fromElements(point.x, point.y, point.z, 1, tmp), tmp);\r\n        Cartesian4.multiplyByScalar(tmp, 1.0 / tmp.w, tmp);\r\n        Matrix4.multiplyByVector(viewportTransformation, tmp, tmp);\r\n        return Cartesian2.fromCartesian4(tmp, result);\r\n    };\r\n\r\n    var normalScratch = new Cartesian3();\r\n    var rightScratch = new Cartesian3();\r\n    var upScratch = new Cartesian3();\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    Transforms.rotationMatrixFromPositionVelocity = function(position, velocity, ellipsoid, result) {\r\n        //>>includeStart('debug', pragmas.debug);\r\n        if (!defined(position)) {\r\n            throw new DeveloperError('position is required.');\r\n        }\r\n\r\n        if (!defined(velocity)) {\r\n            throw new DeveloperError('velocity is required.');\r\n        }\r\n        //>>includeEnd('debug');\r\n\r\n        var normal = defaultValue(ellipsoid, Ellipsoid.WGS84).geodeticSurfaceNormal(position, normalScratch);\r\n        var right = Cartesian3.cross(velocity, normal, rightScratch);\r\n\r\n        if (Cartesian3.equalsEpsilon(right, Cartesian3.ZERO, CesiumMath.EPSILON6)) {\r\n            right = Cartesian3.clone(Cartesian3.UNIT_X, right);\r\n        }\r\n\r\n        var up = Cartesian3.cross(right, velocity, upScratch);\r\n        Cartesian3.normalize(up, up);\r\n        Cartesian3.cross(velocity, up, right);\r\n        Cartesian3.negate(right, right);\r\n        Cartesian3.normalize(right, right);\r\n\r\n        if (!defined(result)) {\r\n            result = new Matrix3();\r\n        }\r\n\r\n        result[0] = velocity.x;\r\n        result[1] = velocity.y;\r\n        result[2] = velocity.z;\r\n        result[3] = right.x;\r\n        result[4] = right.y;\r\n        result[5] = right.z;\r\n        result[6] = up.x;\r\n        result[7] = up.y;\r\n        result[8] = up.z;\r\n\r\n        return result;\r\n    };\r\n\r\n    var swizzleMatrix = new Matrix4(\r\n        0.0, 0.0, 1.0, 0.0,\r\n        1.0, 0.0, 0.0, 0.0,\r\n        0.0, 1.0, 0.0, 0.0,\r\n        0.0, 0.0, 0.0, 1.0\r\n    );\r\n\r\n    var scratchCartographic = new Cartographic();\r\n    var scratchCartesian3Projection = new Cartesian3();\r\n    var scratchCenter = new Cartesian3();\r\n    var scratchRotation = new Matrix3();\r\n    var scratchFromENU = new Matrix4();\r\n    var scratchToENU = new Matrix4();\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    Transforms.basisTo2D = function(projection, matrix, result) {\r\n        //>>includeStart('debug', pragmas.debug);\r\n        if (!defined(projection)) {\r\n            throw new DeveloperError('projection is required.');\r\n        }\r\n        if (!defined(matrix)) {\r\n            throw new DeveloperError('matrix is required.');\r\n        }\r\n        if (!defined(result)) {\r\n            throw new DeveloperError('result is required.');\r\n        }\r\n        //>>includeEnd('debug');\r\n\r\n        var rtcCenter = Matrix4.getTranslation(matrix, scratchCenter);\r\n        var ellipsoid = projection.ellipsoid;\r\n\r\n        // Get the 2D Center\r\n        var cartographic = ellipsoid.cartesianToCartographic(rtcCenter, scratchCartographic);\r\n        var projectedPosition = projection.project(cartographic, scratchCartesian3Projection);\r\n        Cartesian3.fromElements(projectedPosition.z, projectedPosition.x, projectedPosition.y, projectedPosition);\r\n\r\n        // Assuming the instance are positioned in WGS84, invert the WGS84 transform to get the local transform and then convert to 2D\r\n        var fromENU = Transforms.eastNorthUpToFixedFrame(rtcCenter, ellipsoid, scratchFromENU);\r\n        var toENU = Matrix4.inverseTransformation(fromENU, scratchToENU);\r\n        var rotation = Matrix4.getMatrix3(matrix, scratchRotation);\r\n        var local = Matrix4.multiplyByMatrix3(toENU, rotation, result);\r\n        Matrix4.multiply(swizzleMatrix, local, result); // Swap x, y, z for 2D\r\n        Matrix4.setTranslation(result, projectedPosition, result); // Use the projected center\r\n\r\n        return result;\r\n    };\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    Transforms.wgs84To2DModelMatrix = function(projection, center, result) {\r\n        //>>includeStart('debug', pragmas.debug);\r\n        if (!defined(projection)) {\r\n            throw new DeveloperError('projection is required.');\r\n        }\r\n        if (!defined(center)) {\r\n            throw new DeveloperError('center is required.');\r\n        }\r\n        if (!defined(result)) {\r\n            throw new DeveloperError('result is required.');\r\n        }\r\n        //>>includeEnd('debug');\r\n\r\n        var ellipsoid = projection.ellipsoid;\r\n\r\n        var fromENU = Transforms.eastNorthUpToFixedFrame(center, ellipsoid, scratchFromENU);\r\n        var toENU = Matrix4.inverseTransformation(fromENU, scratchToENU);\r\n\r\n        var cartographic = ellipsoid.cartesianToCartographic(center, scratchCartographic);\r\n        var projectedPosition = projection.project(cartographic, scratchCartesian3Projection);\r\n        Cartesian3.fromElements(projectedPosition.z, projectedPosition.x, projectedPosition.y, projectedPosition);\r\n\r\n        var translation = Matrix4.fromTranslation(projectedPosition, scratchFromENU);\r\n        Matrix4.multiply(swizzleMatrix, toENU, result);\r\n        Matrix4.multiply(translation, result, result);\r\n\r\n        return result;\r\n    };\r\nexport default Transforms;\r\n"],"names":["GeographicProjection","ellipsoid","this","_ellipsoid","defaultValue","Ellipsoid","WGS84","_semimajorAxis","maximumRadius","_oneOverSemimajorAxis","Object","defineProperties","prototype","get","project","cartographic","result","semimajorAxis","x","longitude","y","latitude","z","height","defined","Cartesian3","unproject","cartesian","DeveloperError","oneOverEarthSemimajorAxis","Cartographic","freeze","OUTSIDE","INTERSECTING","INSIDE","Interval","start","stop","BoundingSphere","center","radius","clone","ZERO","fromPointsXMin","fromPointsYMin","fromPointsZMin","fromPointsXMax","fromPointsYMax","fromPointsZMax","fromPointsCurrentPos","fromPointsScratch","fromPointsRitterCenter","fromPointsMinBoxPt","fromPointsMaxBoxPt","fromPointsNaiveCenterScratch","volumeConstant","CesiumMath","PI","fromPoints","positions","length","i","currentPos","xMin","yMin","zMin","xMax","yMax","zMax","numPositions","xSpan","magnitudeSquared","subtract","ySpan","zSpan","diameter1","diameter2","maxSpan","ritterCenter","radiusSquared","ritterRadius","Math","sqrt","minBoxPt","maxBoxPt","naiveCenter","midpoint","naiveRadius","r","magnitude","oldCenterToPointSquared","oldCenterToPoint","oldToNew","fromInstancePoints","defaultProjection","fromRectangle2DLowerLeft","fromRectangle2DUpperRight","fromRectangle2DSouthwest","fromRectangle2DNortheast","fromRectangle2D","rectangle","projection","fromRectangleWithHeights2D","minimumHeight","maximumHeight","Rectangle","southwest","northeast","lowerLeft","upperRight","width","elevation","fromRectangle3DScratch","fromRectangle3D","surfaceHeight","subsample","fromVertices","stride","Check","typeOf","number","greaterThanOrEquals","numElements","fromEncodedCartesianVertices","positionsHigh","positionsLow","fromCornerPoints","corner","oppositeCorner","object","distance","fromEllipsoid","fromBoundingSpheresScratch","fromBoundingSpheres","boundingSpheres","union","push","tmp","max","fromOrientedBoundingBoxScratchU","fromOrientedBoundingBoxScratchV","fromOrientedBoundingBoxScratchW","fromOrientedBoundingBox","orientedBoundingBox","halfAxes","u","Matrix3","getColumn","v","w","add","sphere","packedLength","pack","value","array","startingIndex","unpack","unionScratch","unionScratchCenter","left","right","leftCenter","leftRadius","rightCenter","rightRadius","toRightCenter","centerSeparation","halfDistanceBetweenTangentPoints","multiplyByScalar","expandScratch","expand","point","intersectPlane","plane","normal","distanceToPlane","dot","Intersect","transform","Matrix4","multiplyByPoint","getMaximumScale","distanceSquaredToScratch","distanceSquaredTo","diff","transformWithoutScale","scratchCartesian3","computePlaneDistances","position","direction","toCenter","mag","projectTo2DNormalScratch","projectTo2DEastScratch","projectTo2DNorthScratch","projectTo2DWestScratch","projectTo2DSouthScratch","projectTo2DCartographicScratch","projectTo2DPositionsScratch","Array","n","projectTo2DProjection","Quaternion","projectTo2D","equals","UNIT_X","geodeticSurfaceNormal","east","cross","UNIT_Z","normalize","north","south","negate","west","cartesianToCartographic","isOccluded","occluder","isBoundingSphereVisible","volume","fromAxisAngleScratch","fromAxisAngle","axis","angle","halfAngle","s","sin","cos","fromRotationMatrixNext","fromRotationMatrixQuat","fromRotationMatrix","matrix","root","m00","COLUMN0ROW0","m11","COLUMN1ROW1","m22","COLUMN2ROW2","trace","COLUMN1ROW2","COLUMN2ROW1","COLUMN2ROW0","COLUMN0ROW2","COLUMN0ROW1","COLUMN1ROW0","j","k","getElementIndex","quat","scratchHPRQuaternion","scratchHeadingQuaternion","scratchPitchQuaternion","scratchRollQuaternion","fromHeadingPitchRoll","headingPitchRoll","roll","UNIT_Y","pitch","multiply","heading","sampledQuaternionAxis","sampledQuaternionRotation","sampledQuaternionTempQuaternion","sampledQuaternionQuaternion0","sampledQuaternionQuaternion0Conjugate","packedInterpolationLength","convertPackedArrayForInterpolation","packedArray","lastIndex","conjugate","len","offset","computeAxis","computeAngle","unpackInterpolationResult","sourceArray","firstIndex","fromArray","IDENTITY","quaternion","inverseMagnitude","inverse","leftX","leftY","leftZ","leftW","rightX","rightY","rightZ","rightW","scalar","divideByScalar","abs","EPSILON6","acos","lerpScratch","lerp","end","t","slerpEndNegated","slerpScaledP","slerpScaledR","slerp","theta","log","acosClamped","thetaOverSinTheta","exp","sinThetaOverTheta","squadScratchCartesian0","squadScratchCartesian1","squadScratchQuaternion0","squadScratchQuaternion1","computeInnerQuadrangle","q0","q1","q2","qInv","cart0","cart1","squad","s0","s1","slerp0","slerp1","fastSlerpScratchQuaternion","opmu","FeatureDetection","supportsTypedArrays","Float32Array","bT","bD","binarySearch","itemToFind","comparator","comparison","low","high","EarthOrientationParametersSample","xPoleWander","yPoleWander","xPoleOffset","yPoleOffset","ut1MinusUtc","sprintf","regex","a","arguments","format","pad","str","chr","leftJustify","padding","join","justify","prefix","minWidth","zeroPad","customPadChar","slice","formatBaseX","base","precision","2","8","16","toString","formatString","doFormat","substring","valueIndex","flags","_","type","method","textTransform","positivePrefix","prefixBaseX","flagsl","charAt","isFinite","Error","indexOf","undefined","String","fromCharCode","toUpperCase","round","toLowerCase","replace","GregorianDate","year","month","day","hour","minute","second","millisecond","isLeapSecond","isLeapYear","isNaN","LeapSecond","date","julianDate","fastSlerp","sign","xm1","d","sqrT","sqrD","cT","cD","temp","fastSquad","equalsEpsilon","epsilon","SECONDS_PER_MILLISECOND","SECONDS_PER_MINUTE","MINUTES_PER_HOUR","HOURS_PER_DAY","SECONDS_PER_HOUR","MINUTES_PER_DAY","SECONDS_PER_DAY","DAYS_PER_JULIAN_CENTURY","PICOSECOND","MODIFIED_JULIAN_DATE_DIFFERENCE","UTC","TAI","gregorianDateScratch","daysInMonth","compareLeapSecondDates","leapSecond","dateToFind","JulianDate","compare","binarySearchScratchLeapSecond","convertUtcToTai","leapSeconds","index","secondsDifference","addSeconds","convertTaiToUtc","difference","setComponents","wholeDays","secondsOfDay","extraDays","TimeConstants","dayNumber","computeJulianDateComponents","b","matchCalendarYear","matchCalendarMonth","matchOrdinalDate","matchWeekDate","matchCalendarDate","utcOffset","matchHours","source","matchHoursMinutes","matchHoursMinutesSeconds","iso8601ErrorMessage","julianDayNumber","timeStandard","TimeStandard","fromGregorianDate","components","fromDate","Date","getTime","getUTCFullYear","getUTCMonth","getUTCDate","getUTCHours","getUTCMinutes","getUTCSeconds","getUTCMilliseconds","fromIso8601","iso8601String","inLeapYear","dashCount","offsetIndex","tokens","split","time","match","dayOfYear","weekNumber","dayOfWeek","getUTCDay","setUTCDate","offsetHours","offsetMinutes","getTimezoneOffset","now","toGregorianDateScratch","URI","uri","scheme","authority","path","query","fragment","c","parseRegex","exec","toGregorianDate","thisUtc","L","N","I","J","remainingSeconds","toDate","gDate","toIso8601","toFixed","julianDayNumberDifference","totalDays","daysDifference","computeTaiMinusUtc","seconds","addMinutes","minutes","newSecondsOfDay","addHours","hours","addDays","days","lessThan","lessThanOrEquals","greaterThan","RegExp","getScheme","getAuthority","getPath","getQuery","getFragment","isAbsolute","isSameDocumentAs","removeDotSegments","authorityRegex","replaceAuthority","caseRegex","replaceCase","percentRegex","dec","unescape","test","p1","p2","p3","deep","constructor","propertyName","hasOwnProperty","combine","object1","object2","property","object1Value","object2Value","object1Defined","object2Defined","getAbsoluteUri","relative","documentObject","document","_implementation","resolve","baseURI","lastIndexOf","segment","input","output","absPath","shift","pop","unshift","location","href","baseUri","Uri","blobUriRegex","isBlobUri","string","dataUriRegex","isDataUri","UNISSUED","ISSUED","ACTIVE","RECEIVED","CANCELLED","FAILED","TERRAIN","IMAGERY","TILES3D","OTHER","Request","options","EMPTY_OBJECT","throttleByServer","throttle","url","requestFunction","cancelFunction","priorityFunction","priority","RequestType","serverKey","state","RequestState","deferred","cancelled","RequestErrorEvent","statusCode","response","responseHeaders","headerString","headers","headerPairs","headerPair","key","val","parseResponseHeaders","Event","_listeners","_scopes","_toRemove","_insideRaiseEvent","compareNumber","Heap","_comparator","_array","_length","_maximumLength","swap","cancel","numberOfListeners","addEventListener","listener","scope","func","event","removeEventListener","listeners","scopes","splice","raiseEvent","apply","toRemove","sort","internalArray","maximumLength","set","reserve","heapify","candidate","inserting","resort","ceil","insert","element","removedElement","parent","floor","statistics","numberOfAttemptedRequests","numberOfActiveRequests","numberOfCancelledRequests","numberOfCancelledActiveRequests","numberOfFailedRequests","numberOfActiveRequestsEver","lastNumberOfActiveRequests","priorityHeapLength","requestHeap","activeRequests","numberOfActiveRequestsByServer","pageUri","requestCompletedEvent","RequestScheduler","updatePriority","request","serverHasOpenSlots","maxRequests","requestsByServer","maximumRequestsPerServer","issueRequest","when","defer","promise","startRequest","then","results","getRequestReceivedFunction","otherwise","error","reject","getRequestFailedFunction","cancelRequest","active","maximumRequests","api.cesium.com:443","assets.cesium.com:443","throttleRequests","debugShowStatistics","update","removeCount","activeLength","issuedRequests","issuedLength","openSlots","filledSlots","console","updateStatistics","getServerKey","removedRequest","clearForSpecs","TrustedServers","_servers","host","port","remove","contains","parts","window","protocol","clear","supportsImageBitmapOptionsPromise","xhrBlobSupported","xhr","XMLHttpRequest","open","responseType","e","parseQuery","resource","merge","preserveQueryParameters","queryString","subparts","name","decodeURIComponent","resultValue","isArray","queryToObject","_queryParameters","combineQueryParameters","stringifyQuery","queryObject","keys","obj","propName","part","encodeURIComponent","objectToQuery","defaultClone","defaultVal","checkAndResetRequest","RuntimeError","param","q2Value","concat","Resource","_url","_templateValues","templateValues","queryParameters","proxy","retryCallback","retryAttempts","_retryCount","fetchImage","flipY","preferImageBitmap","crossOrigin","isCrossOriginUrl","_Implementations","createImage","retryOnError","retry","createIfNeeded","getDerivedResource","supportsImageBitmapOptions","createImageBitmap","fetchBlob","blob","imageOrientation","premultiplyAlpha","imageBitmap","isBlobSupported","getUrlComponent","extension","uriObject","substr","getExtensionFromUri","createElement","hasHeaders","replacement","getURL","setQueryParameters","params","useAsDefault","appendQueryParameters","setTemplateValues","template","that","getBaseUri","includeQuery","basePath","appendForwardSlash","fetchArrayBuffer","fetch","preferBlob","useImageBitmap","generatedBlobResource","generatedBlob","blobPromise","createImageBitmapFromBlob","blobUrl","URL","createObjectURL","image","revokeObjectURL","fetchText","fetchJson","Accept","JSON","parse","fetchXML","overrideMimeType","fetchJsonp","callbackParameterName","functionName","random","callbackQuery","data","loadAndExecuteScript","_makeRequest","loadWithXhr","abort","decodeDataUriText","isBase64","atob","decodeDataUriArrayBuffer","byteString","buffer","ArrayBuffer","view","Uint8Array","charCodeAt","decodeResponse","loadWithHttpResponse","delete","head","post","put","patch","supportsImageBitmap","xhrDeferred","Image","onload","onerror","src","loadImageElement","bool","noXMLHttpRequest","EarthOrientationParameters","_dates","_samples","_dateColumn","_xPoleWanderRadiansColumn","_yPoleWanderRadiansColumn","_ut1MinusUtcSecondsColumn","_xCelestialPoleOffsetRadiansColumn","_yCelestialPoleOffsetRadiansColumn","_taiMinusUtcSecondsColumn","_columnCount","_lastIndex","_downloadPromise","_dataError","_addNewLeapSeconds","addNewLeapSeconds","onDataReady","eopData","columnNames","samples","eop","dateColumn","xPoleWanderRadiansColumn","yPoleWanderRadiansColumn","ut1MinusUtcSecondsColumn","xCelestialPoleOffsetRadiansColumn","yCelestialPoleOffsetRadiansColumn","taiMinusUtcSecondsColumn","lastTaiMinusUtc","dates","mjd","taiMinusUtc","leapSecondIndex","fillResultFromIndex","columnCount","linearInterp","dx","y1","y2","interpolate","before","after","beforeDate","afterDate","factor","startBefore","startAfter","beforeUt1MinusUtc","afterUt1MinusUtc","offsetDifference","beforeTaiMinusUtc","afterTaiMinusUtc","HeadingPitchRoll","dataUriRegexResult","withCredentials","setRequestHeader","localFile","origin","status","browserResponseType","splitHeaders","getAllResponseHeaders","trim","forEach","line","header","responseXML","hasChildNodes","responseText","send","require","http","zlib","hostname","on","res","chunkArray","chunk","Buffer","gunzip","resultUnzipped","loadWithHttpRequest","mimeType","Blob","DOMParser","parseFromString","decodeDataUri","script","async","getElementsByTagName","removeChild","appendChild","_DefaultImplementations","DEFAULT","NONE","getPromiseToLoad","compute","previousIndexDate","nextIndexDate","isAfterPrevious","isAfterLastSample","isBeforeNext","fromQuaternion","denominatorRoll","numeratorRoll","denominatorHeading","numeratorHeading","atan2","asinClamped","fromDegrees","RADIANS_PER_DEGREE","relativeEpsilon","absoluteEpsilon","baseResource","implementation","cesiumScriptRegex","tryMakeAbsolute","getCesiumBaseUrl","baseUrlString","CESIUM_BASE_URL","define","amd","toUrlUndefined","toUrl","buildModuleUrl","scripts","getAttribute","getBaseUrlFromCesiumScript","buildModuleUrlFromRequireToUrl","moduleID","buildModuleUrlFromBaseUrl","Iau2006XysSample","Iau2006XysData","_xysFileUrlTemplate","xysFileUrlTemplate","_interpolationOrder","interpolationOrder","_sampleZeroJulianEphemerisDate","sampleZeroJulianEphemerisDate","_sampleZeroDateTT","_stepSizeDays","stepSizeDays","_samplesPerXysFile","samplesPerXysFile","_totalSamples","totalSamples","_chunkDownloadsInProgress","order","denom","_denominators","xTable","_xTable","stepN","pow","_work","_coef","_cesiumScriptRegex","_buildModuleUrlFromBaseUrl","_clearBaseResource","setBaseUrl","julianDateScratch","getDaysSinceEpoch","xys","dayTT","secondTT","dateTT","requestXysChunk","xysData","chunkIndex","chunkUrl","0","newSamples","startIndex","preload","startDayTT","startSecondTT","stopDayTT","stopSecondTT","startDaysSinceEpoch","stopDaysSinceEpoch","stopIndex","startChunk","stopChunk","promises","all","computeXysRadians","daysSinceEpoch","centerIndex","degree","isDataMissing","work","coef","sampleIndex","Transforms","vectorProductLocalFrame","up","down","degeneratePositionLocalFrame","localFrameToFixedFrameCache","scratchCalculateCartesian","scratchFirstCartesian","scratchSecondCartesian","scratchThirdCartesian","localFrameToFixedFrameGenerator","firstAxis","secondAxis","resultat","thirdAxis","hashAxis","EPSILON14","eastNorthUpToFixedFrame","northEastDownToFixedFrame","northUpEastToFixedFrame","northWestUpToFixedFrame","scratchScale","scratchHPRMatrix4","headingPitchRollToFixedFrame","fixedFrameTransform","hprQuaternion","hprMatrix","fromTranslationQuaternionRotationScale","scratchENUMatrix4","scratchHPRMatrix3","headingPitchRollQuaternion","rotation","getMatrix3","noScale","hprCenterScratch","ffScratch","hprTransformScratch","hprRotationScratch","hprQuaternionScratch","fixedFrameToHeadingPitchRoll","getTranslation","toFixedFrame","inverseTransformation","transformCopy","setScale","setTranslation","quaternionRotation","twoPiOverSecondsInDay","TWO_PI","dateInUtc","computeTemeToPseudoFixedMatrix","utcDayNumber","utcSecondsIntoDay","diffDays","gha","cosGha","sinGha","iau2006XysData","earthOrientationParameters","preloadIcrfFixed","timeInterval","xysPromise","eopPromise","computeIcrfToFixedMatrix","fixedToIcrfMtx","computeFixedToIcrfMatrix","transpose","xysScratch","eopScratch","rotation1Scratch","rotation2Scratch","rotation1","rotation2","fromRotationZ","matrixQ","daysSinceJ2000","fractionOfDay","era","earthRotation","pfToIcrf","cosxp","cosyp","sinxp","sinyp","ttt","sp","cossp","sinsp","fToPfMtx","pointToWindowCoordinatesTemp","Cartesian4","pointToWindowCoordinates","modelViewProjectionMatrix","viewportTransformation","pointToGLWindowCoordinates","Cartesian2","multiplyByVector","fromElements","fromCartesian4","normalScratch","rightScratch","upScratch","rotationMatrixFromPositionVelocity","velocity","swizzleMatrix","scratchCartographic","scratchCartesian3Projection","scratchCenter","scratchRotation","scratchFromENU","scratchToENU","basisTo2D","rtcCenter","projectedPosition","fromENU","toENU","local","multiplyByMatrix3","wgs84To2DModelMatrix","translation","fromTranslation"],"mappings":"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W,QAAS,MAAS+B,GAAarC,KAAM,IACnE,IAAI1B,GAAW,IAAIgC,GAAW,QAAS,MAAS+B,GAAarC,KAAM,IACnE,IAAI1B,GAAW,IAAIgC,GAAW,QAAS,MAAS+B,GAAarC,KAAM,IACnE,IAAI1B,GAAW,IAAIgC,GAAW,QAAS,MAAS+B,GAAarC,KAAM,IACnE,IAAI1B,GAAW,IAAIgC,GAAW,QAAS,MAAS+B,GAAarC,KAAM,IACnE,IAAI1B,GAAW,IAAIgC,GAAW,QAAS,MAAS+B,GAAarC,KAAM,IACnE,IAAI1B,GAAW,IAAIgC,GAAW,QAAS,MAAS+B,GAAarC,KAAM,IACnE,IAAI1B,GAAW,IAAIgC,GAAW,QAAS,MAAS+B,GAAarC,KAAM,IACnE,IAAI1B,GAAW,IAAIgC,GAAW,QAAS,MAAS+B,GAAarC,KAAM,IACnE,IAAI1B,GAAW,IAAIgC,GAAW,QAAS,MAAS+B,GAAarC,KAAM,IACnE,IAAI1B,GAAW,IAAIgC,GAAW,QAAS,MAAS+B,GAAarC,KAAM,IACnE,IAAI1B,GAAW,IAAIgC,GAAW,QAAS,MAAS+B,GAAarC,KAAM,IACnE,IAAI1B,GAAW,IAAIgC,GAAW,QAAS,MAAS+B,GAAarC,KAAM,IACnE,IAAI1B,GAAW,IAAIgC,GAAW,QAAS,MAAS+B,GAAarC,KAAM,IACnE,IAAI1B,GAAW,IAAIgC,GAAW,QAAS,MAAS+B,GAAarC,KAAM,IACnE,IAAI1B,GAAW,IAAIgC,GAAW,QAAS,MAAS+B,GAAarC,KAAM,IACnE,IAAI1B,GAAW,IAAIgC,GAAW,QAAS,MAAS+B,GAAarC,KAAM,IACnE,IAAI1B,GAAW,IAAIgC,GAAW,QAAS,MAAS+B,GAAarC,KAAM,IACnE,IAAI1B,GAAW,IAAIgC,GAAW,QAAS,MAAS+B,GAAarC,KAAM,IACnE,IAAI1B,GAAW,IAAIgC,GAAW,QAAS,MAAS+B,GAAarC,KAAM,IACnE,IAAI1B,GAAW,IAAIgC,GAAW,QAAS,MAAS+B,GAAarC,KAAM,IACnE,IAAI1B,GAAW,IAAIgC,GAAW,QAAS,MAAS+B,GAAarC,KAAM,IACnE,IAAI1B,GAAW,IAAIgC,GAAW,QAAS,MAAS+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"}