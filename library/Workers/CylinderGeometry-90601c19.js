define(["exports","./when-7ef6387a","./Check-ed6a1804","./Cartesian3-cb3509e0","./Transforms-fe3a4031","./Cartesian2-7da3df11","./ComponentDatatype-3593b1c2","./GeometryAttribute-e8505198","./PrimitiveType-4c1d698a","./GeometryAttributes-cb18da36","./IndexDatatype-030efa67","./GeometryOffsetAttribute-e4fca9ed","./VertexFormat-c6d7c90a","./CylinderGeometryLibrary-d9e1d154"],(function(t,e,a,r,n,o,i,s,m,u,d,p,y,f){"use strict";var l=new o.Cartesian2,c=new r.Cartesian3,b=new r.Cartesian3,v=new r.Cartesian3,A=new r.Cartesian3;function g(t){var a=(t=e.defaultValue(t,e.defaultValue.EMPTY_OBJECT)).length,r=t.topRadius,n=t.bottomRadius,o=e.defaultValue(t.vertexFormat,y.VertexFormat.DEFAULT),i=e.defaultValue(t.slices,128);this._length=a,this._topRadius=r,this._bottomRadius=n,this._vertexFormat=y.VertexFormat.clone(o),this._slices=i,this._offsetAttribute=t.offsetAttribute,this._workerName="createCylinderGeometry"}g.packedLength=y.VertexFormat.packedLength+5,g.pack=function(t,a,r){return r=e.defaultValue(r,0),y.VertexFormat.pack(t._vertexFormat,a,r),r+=y.VertexFormat.packedLength,a[r++]=t._length,a[r++]=t._topRadius,a[r++]=t._bottomRadius,a[r++]=t._slices,a[r]=e.defaultValue(t._offsetAttribute,-1),a};var x,_=new y.VertexFormat,h={vertexFormat:_,length:void 0,topRadius:void 0,bottomRadius:void 0,slices:void 0,offsetAttribute:void 0};g.unpack=function(t,a,r){a=e.defaultValue(a,0);var n=y.VertexFormat.unpack(t,a,_);a+=y.VertexFormat.packedLength;var o=t[a++],i=t[a++],s=t[a++],m=t[a++],u=t[a];return e.defined(r)?(r._vertexFormat=y.VertexFormat.clone(n,r._vertexFormat),r._length=o,r._topRadius=i,r._bottomRadius=s,r._slices=m,r._offsetAttribute=-1===u?void 0:u,r):(h.length=o,h.topRadius=i,h.bottomRadius=s,h.slices=m,h.offsetAttribute=-1===u?void 0:u,new g(h))},g.createGeometry=function(t){var a=t._length,y=t._topRadius,g=t._bottomRadius,x=t._vertexFormat,_=t._slices;if(!(a<=0||y<0||g<0||0===y&&0===g)){var h,C=_+_,F=_+C,w=C+C,G=f.CylinderGeometryLibrary.computePositions(a,y,g,_,!0),D=x.st?new Float32Array(2*w):void 0,R=x.normal?new Float32Array(3*w):void 0,V=x.tangent?new Float32Array(3*w):void 0,T=x.bitangent?new Float32Array(3*w):void 0,O=x.normal||x.tangent||x.bitangent;if(O){var L=x.tangent||x.bitangent,P=0,k=0,z=0,E=Math.atan2(g-y,a),M=c;M.z=Math.sin(E);var N=Math.cos(E),I=v,U=b;for(h=0;h<_;h++){var S=h/_*r.CesiumMath.TWO_PI,B=N*Math.cos(S),Y=N*Math.sin(S);O&&(M.x=B,M.y=Y,L&&(I=r.Cartesian3.normalize(r.Cartesian3.cross(r.Cartesian3.UNIT_Z,M,I),I)),x.normal&&(R[P++]=M.x,R[P++]=M.y,R[P++]=M.z,R[P++]=M.x,R[P++]=M.y,R[P++]=M.z),x.tangent&&(V[k++]=I.x,V[k++]=I.y,V[k++]=I.z,V[k++]=I.x,V[k++]=I.y,V[k++]=I.z),x.bitangent&&(U=r.Cartesian3.normalize(r.Cartesian3.cross(M,I,U),U),T[z++]=U.x,T[z++]=U.y,T[z++]=U.z,T[z++]=U.x,T[z++]=U.y,T[z++]=U.z))}for(h=0;h<_;h++)x.normal&&(R[P++]=0,R[P++]=0,R[P++]=-1),x.tangent&&(V[k++]=1,V[k++]=0,V[k++]=0),x.bitangent&&(T[z++]=0,T[z++]=-1,T[z++]=0);for(h=0;h<_;h++)x.normal&&(R[P++]=0,R[P++]=0,R[P++]=1),x.tangent&&(V[k++]=1,V[k++]=0,V[k++]=0),x.bitangent&&(T[z++]=0,T[z++]=1,T[z++]=0)}var Z=12*_-12,J=d.IndexDatatype.createTypedArray(w,Z),W=0,j=0;for(h=0;h<_-1;h++)J[W++]=j,J[W++]=j+2,J[W++]=j+3,J[W++]=j,J[W++]=j+3,J[W++]=j+1,j+=2;for(J[W++]=C-2,J[W++]=0,J[W++]=1,J[W++]=C-2,J[W++]=1,J[W++]=C-1,h=1;h<_-1;h++)J[W++]=C+h+1,J[W++]=C+h,J[W++]=C;for(h=1;h<_-1;h++)J[W++]=F,J[W++]=F+h,J[W++]=F+h+1;var q=0;if(x.st){var H=Math.max(y,g);for(h=0;h<w;h++){var K=r.Cartesian3.fromArray(G,3*h,A);D[q++]=(K.x+H)/(2*H),D[q++]=(K.y+H)/(2*H)}}var Q=new u.GeometryAttributes;x.position&&(Q.position=new s.GeometryAttribute({componentDatatype:i.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:G})),x.normal&&(Q.normal=new s.GeometryAttribute({componentDatatype:i.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:R})),x.tangent&&(Q.tangent=new s.GeometryAttribute({componentDatatype:i.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:V})),x.bitangent&&(Q.bitangent=new s.GeometryAttribute({componentDatatype:i.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:T})),x.st&&(Q.st=new s.GeometryAttribute({componentDatatype:i.ComponentDatatype.FLOAT,componentsPerAttribute:2,values:D})),l.x=.5*a,l.y=Math.max(g,y);var X=new n.BoundingSphere(r.Cartesian3.ZERO,o.Cartesian2.magnitude(l));if(e.defined(t._offsetAttribute)){a=G.length;var $=new Uint8Array(a/3),tt=t._offsetAttribute===p.GeometryOffsetAttribute.NONE?0:1;p.arrayFill($,tt),Q.applyOffset=new s.GeometryAttribute({componentDatatype:i.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:$})}return new s.Geometry({attributes:Q,indices:J,primitiveType:m.PrimitiveType.TRIANGLES,boundingSphere:X,offsetAttribute:t._offsetAttribute})}},g.getUnitCylinder=function(){return e.defined(x)||(x=g.createGeometry(new g({topRadius:1,bottomRadius:1,length:1,vertexFormat:y.VertexFormat.POSITION_ONLY}))),x},t.CylinderGeometry=g}));
