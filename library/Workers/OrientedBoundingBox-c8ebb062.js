define(["exports","./when-7ef6387a","./Check-ed6a1804","./Math-85667bf9","./Cartesian3-2a8ef78e","./Ellipsoid-367a1bb3","./Transforms-2448ecca","./Cartesian2-dcadeea9","./Plane-15b63a5b","./EllipsoidTangentPlane-d61c0913"],(function(a,e,t,r,n,i,s,o,d,C){"use strict";function u(a,t){this.center=n.Cartesian3.clone(e.defaultValue(a,n.Cartesian3.ZERO)),this.halfAxes=s.Matrix3.clone(e.defaultValue(t,s.Matrix3.ZERO))}u.packedLength=n.Cartesian3.packedLength+s.Matrix3.packedLength,u.pack=function(a,r,i){return t.Check.typeOf.object("value",a),t.Check.defined("array",r),i=e.defaultValue(i,0),n.Cartesian3.pack(a.center,r,i),s.Matrix3.pack(a.halfAxes,r,i+n.Cartesian3.packedLength),r},u.unpack=function(a,r,i){return t.Check.defined("array",a),r=e.defaultValue(r,0),e.defined(i)||(i=new u),n.Cartesian3.unpack(a,r,i.center),s.Matrix3.unpack(a,r+n.Cartesian3.packedLength,i.halfAxes),i};var c=new n.Cartesian3,l=new n.Cartesian3,h=new n.Cartesian3,f=new n.Cartesian3,m=new n.Cartesian3,x=new n.Cartesian3,p=new s.Matrix3,M={unitary:new s.Matrix3,diagonal:new s.Matrix3};u.fromPoints=function(a,t){if(e.defined(t)||(t=new u),!e.defined(a)||0===a.length)return t.halfAxes=s.Matrix3.ZERO,t.center=n.Cartesian3.ZERO,t;var r,i=a.length,o=n.Cartesian3.clone(a[0],c);for(r=1;r<i;r++)n.Cartesian3.add(o,a[r],o);var d=1/i;n.Cartesian3.multiplyByScalar(o,d,o);var C,w=0,g=0,b=0,v=0,y=0,E=0;for(r=0;r<i;r++)w+=(C=n.Cartesian3.subtract(a[r],o,l)).x*C.x,g+=C.x*C.y,b+=C.x*C.z,v+=C.y*C.y,y+=C.y*C.z,E+=C.z*C.z;w*=d,g*=d,b*=d,v*=d,y*=d,E*=d;var O=p;O[0]=w,O[1]=g,O[2]=b,O[3]=g,O[4]=v,O[5]=y,O[6]=b,O[7]=y,O[8]=E;var P=s.Matrix3.computeEigenDecomposition(O,M),N=s.Matrix3.clone(P.unitary,t.halfAxes),A=s.Matrix3.getColumn(N,0,f),T=s.Matrix3.getColumn(N,1,m),R=s.Matrix3.getColumn(N,2,x),I=-Number.MAX_VALUE,D=-Number.MAX_VALUE,L=-Number.MAX_VALUE,z=Number.MAX_VALUE,S=Number.MAX_VALUE,q=Number.MAX_VALUE;for(r=0;r<i;r++)C=a[r],I=Math.max(n.Cartesian3.dot(A,C),I),D=Math.max(n.Cartesian3.dot(T,C),D),L=Math.max(n.Cartesian3.dot(R,C),L),z=Math.min(n.Cartesian3.dot(A,C),z),S=Math.min(n.Cartesian3.dot(T,C),S),q=Math.min(n.Cartesian3.dot(R,C),q);A=n.Cartesian3.multiplyByScalar(A,.5*(z+I),A),T=n.Cartesian3.multiplyByScalar(T,.5*(S+D),T),R=n.Cartesian3.multiplyByScalar(R,.5*(q+L),R);var U=n.Cartesian3.add(A,T,t.center);n.Cartesian3.add(U,R,U);var V=h;return V.x=I-z,V.y=D-S,V.z=L-q,n.Cartesian3.multiplyByScalar(V,.5,V),s.Matrix3.multiplyByScale(t.halfAxes,V,t.halfAxes),t};var w=new n.Cartesian3,g=new n.Cartesian3;function b(a,r,i,o,d,C,c,l,h,f,m){if(!(e.defined(d)&&e.defined(C)&&e.defined(c)&&e.defined(l)&&e.defined(h)&&e.defined(f)))throw new t.DeveloperError("all extents (minimum/maximum X/Y/Z) are required.");e.defined(m)||(m=new u);var x=m.halfAxes;s.Matrix3.setColumn(x,0,r,x),s.Matrix3.setColumn(x,1,i,x),s.Matrix3.setColumn(x,2,o,x);var p=w;p.x=(d+C)/2,p.y=(c+l)/2,p.z=(h+f)/2;var M=g;M.x=(C-d)/2,M.y=(l-c)/2,M.z=(f-h)/2;var b=m.center;return p=s.Matrix3.multiplyByVector(x,p,p),n.Cartesian3.add(a,p,b),s.Matrix3.multiplyByScale(x,M,x),m}var v=new i.Cartographic,y=new n.Cartesian3,E=new i.Cartographic,O=new i.Cartographic,P=new i.Cartographic,N=new i.Cartographic,A=new i.Cartographic,T=new n.Cartesian3,R=new n.Cartesian3,I=new n.Cartesian3,D=new n.Cartesian3,L=new n.Cartesian3,z=new o.Cartesian2,S=new o.Cartesian2,q=new o.Cartesian2,U=new o.Cartesian2,V=new o.Cartesian2,k=new n.Cartesian3,B=new n.Cartesian3,_=new n.Cartesian3,W=new n.Cartesian3,X=new o.Cartesian2,j=new n.Cartesian3,Z=new n.Cartesian3,G=new n.Cartesian3,Y=new d.Plane(n.Cartesian3.UNIT_X,0);u.fromRectangle=function(a,s,u,c,l){if(!e.defined(a))throw new t.DeveloperError("rectangle is required");if(a.width<0||a.width>r.CesiumMath.TWO_PI)throw new t.DeveloperError("Rectangle width must be between 0 and 2*pi");if(a.height<0||a.height>r.CesiumMath.PI)throw new t.DeveloperError("Rectangle height must be between 0 and pi");if(e.defined(c)&&!r.CesiumMath.equalsEpsilon(c.radii.x,c.radii.y,r.CesiumMath.EPSILON15))throw new t.DeveloperError("Ellipsoid must be an ellipsoid of revolution (radii.x == radii.y)");var h,f,m,x,p,M,w;if(s=e.defaultValue(s,0),u=e.defaultValue(u,0),c=e.defaultValue(c,i.Ellipsoid.WGS84),a.width<=r.CesiumMath.PI){var g=o.Rectangle.center(a,v),F=c.cartographicToCartesian(g,y),H=new C.EllipsoidTangentPlane(F,c);w=H.plane;var J=g.longitude,K=a.south<0&&a.north>0?0:g.latitude,Q=i.Cartographic.fromRadians(J,a.north,u,E),$=i.Cartographic.fromRadians(a.west,a.north,u,O),aa=i.Cartographic.fromRadians(a.west,K,u,P),ea=i.Cartographic.fromRadians(a.west,a.south,u,N),ta=i.Cartographic.fromRadians(J,a.south,u,A),ra=c.cartographicToCartesian(Q,T),na=c.cartographicToCartesian($,R),ia=c.cartographicToCartesian(aa,I),sa=c.cartographicToCartesian(ea,D),oa=c.cartographicToCartesian(ta,L),da=H.projectPointToNearestOnPlane(ra,z),Ca=H.projectPointToNearestOnPlane(na,S),ua=H.projectPointToNearestOnPlane(ia,q),ca=H.projectPointToNearestOnPlane(sa,U),la=H.projectPointToNearestOnPlane(oa,V);return f=-(h=Math.min(Ca.x,ua.x,ca.x)),x=Math.max(Ca.y,da.y),m=Math.min(ca.y,la.y),$.height=ea.height=s,na=c.cartographicToCartesian($,R),sa=c.cartographicToCartesian(ea,D),p=Math.min(d.Plane.getPointDistance(w,na),d.Plane.getPointDistance(w,sa)),M=u,b(H.origin,H.xAxis,H.yAxis,H.zAxis,h,f,m,x,p,M,l)}var ha=a.south>0,fa=a.north<0,ma=ha?a.south:fa?a.north:0,xa=o.Rectangle.center(a,v).longitude,pa=n.Cartesian3.fromRadians(xa,ma,u,c,k);pa.z=0;var Ma=Math.abs(pa.x)<r.CesiumMath.EPSILON10&&Math.abs(pa.y)<r.CesiumMath.EPSILON10?n.Cartesian3.UNIT_X:n.Cartesian3.normalize(pa,B),wa=n.Cartesian3.UNIT_Z,ga=n.Cartesian3.cross(Ma,wa,_);w=d.Plane.fromPointNormal(pa,Ma,Y);var ba=n.Cartesian3.fromRadians(xa+r.CesiumMath.PI_OVER_TWO,ma,u,c,W);h=-(f=n.Cartesian3.dot(d.Plane.projectPointOntoPlane(w,ba,X),ga)),x=n.Cartesian3.fromRadians(0,a.north,fa?s:u,c,j).z,m=n.Cartesian3.fromRadians(0,a.south,ha?s:u,c,Z).z;var va=n.Cartesian3.fromRadians(a.east,ma,u,c,G);return b(pa,ga,wa,Ma,h,f,m,x,p=d.Plane.getPointDistance(w,va),M=0,l)},u.clone=function(a,t){if(e.defined(a))return e.defined(t)?(n.Cartesian3.clone(a.center,t.center),s.Matrix3.clone(a.halfAxes,t.halfAxes),t):new u(a.center,a.halfAxes)},u.intersectPlane=function(a,r){if(!e.defined(a))throw new t.DeveloperError("box is required.");if(!e.defined(r))throw new t.DeveloperError("plane is required.");var i=a.center,o=r.normal,d=a.halfAxes,C=o.x,u=o.y,c=o.z,l=Math.abs(C*d[s.Matrix3.COLUMN0ROW0]+u*d[s.Matrix3.COLUMN0ROW1]+c*d[s.Matrix3.COLUMN0ROW2])+Math.abs(C*d[s.Matrix3.COLUMN1ROW0]+u*d[s.Matrix3.COLUMN1ROW1]+c*d[s.Matrix3.COLUMN1ROW2])+Math.abs(C*d[s.Matrix3.COLUMN2ROW0]+u*d[s.Matrix3.COLUMN2ROW1]+c*d[s.Matrix3.COLUMN2ROW2]),h=n.Cartesian3.dot(o,i)+r.distance;return h<=-l?s.Intersect.OUTSIDE:h>=l?s.Intersect.INSIDE:s.Intersect.INTERSECTING};var F=new n.Cartesian3,H=new n.Cartesian3,J=new n.Cartesian3,K=new n.Cartesian3;u.distanceSquaredTo=function(a,r){if(!e.defined(a))throw new t.DeveloperError("box is required.");if(!e.defined(r))throw new t.DeveloperError("cartesian is required.");var i=n.Cartesian3.subtract(r,a.center,w),o=a.halfAxes,d=s.Matrix3.getColumn(o,0,F),C=s.Matrix3.getColumn(o,1,H),u=s.Matrix3.getColumn(o,2,J),c=n.Cartesian3.magnitude(d),l=n.Cartesian3.magnitude(C),h=n.Cartesian3.magnitude(u);n.Cartesian3.normalize(d,d),n.Cartesian3.normalize(C,C),n.Cartesian3.normalize(u,u);var f=K;f.x=n.Cartesian3.dot(i,d),f.y=n.Cartesian3.dot(i,C),f.z=n.Cartesian3.dot(i,u);var m,x=0;return f.x<-c?x+=(m=f.x+c)*m:f.x>c&&(x+=(m=f.x-c)*m),f.y<-l?x+=(m=f.y+l)*m:f.y>l&&(x+=(m=f.y-l)*m),f.z<-h?x+=(m=f.z+h)*m:f.z>h&&(x+=(m=f.z-h)*m),x};var Q=new n.Cartesian3,$=new n.Cartesian3;u.computePlaneDistances=function(a,r,i,o){if(!e.defined(a))throw new t.DeveloperError("box is required.");if(!e.defined(r))throw new t.DeveloperError("position is required.");if(!e.defined(i))throw new t.DeveloperError("direction is required.");e.defined(o)||(o=new s.Interval);var d=Number.POSITIVE_INFINITY,C=Number.NEGATIVE_INFINITY,u=a.center,c=a.halfAxes,l=s.Matrix3.getColumn(c,0,F),h=s.Matrix3.getColumn(c,1,H),f=s.Matrix3.getColumn(c,2,J),m=n.Cartesian3.add(l,h,Q);n.Cartesian3.add(m,f,m),n.Cartesian3.add(m,u,m);var x=n.Cartesian3.subtract(m,r,$),p=n.Cartesian3.dot(i,x);return d=Math.min(p,d),C=Math.max(p,C),n.Cartesian3.add(u,l,m),n.Cartesian3.add(m,h,m),n.Cartesian3.subtract(m,f,m),n.Cartesian3.subtract(m,r,x),p=n.Cartesian3.dot(i,x),d=Math.min(p,d),C=Math.max(p,C),n.Cartesian3.add(u,l,m),n.Cartesian3.subtract(m,h,m),n.Cartesian3.add(m,f,m),n.Cartesian3.subtract(m,r,x),p=n.Cartesian3.dot(i,x),d=Math.min(p,d),C=Math.max(p,C),n.Cartesian3.add(u,l,m),n.Cartesian3.subtract(m,h,m),n.Cartesian3.subtract(m,f,m),n.Cartesian3.subtract(m,r,x),p=n.Cartesian3.dot(i,x),d=Math.min(p,d),C=Math.max(p,C),n.Cartesian3.subtract(u,l,m),n.Cartesian3.add(m,h,m),n.Cartesian3.add(m,f,m),n.Cartesian3.subtract(m,r,x),p=n.Cartesian3.dot(i,x),d=Math.min(p,d),C=Math.max(p,C),n.Cartesian3.subtract(u,l,m),n.Cartesian3.add(m,h,m),n.Cartesian3.subtract(m,f,m),n.Cartesian3.subtract(m,r,x),p=n.Cartesian3.dot(i,x),d=Math.min(p,d),C=Math.max(p,C),n.Cartesian3.subtract(u,l,m),n.Cartesian3.subtract(m,h,m),n.Cartesian3.add(m,f,m),n.Cartesian3.subtract(m,r,x),p=n.Cartesian3.dot(i,x),d=Math.min(p,d),C=Math.max(p,C),n.Cartesian3.subtract(u,l,m),n.Cartesian3.subtract(m,h,m),n.Cartesian3.subtract(m,f,m),n.Cartesian3.subtract(m,r,x),p=n.Cartesian3.dot(i,x),d=Math.min(p,d),C=Math.max(p,C),o.start=d,o.stop=C,o};var aa=new s.BoundingSphere;u.isOccluded=function(a,r){if(!e.defined(a))throw new t.DeveloperError("box is required.");if(!e.defined(r))throw new t.DeveloperError("occluder is required.");var n=s.BoundingSphere.fromOrientedBoundingBox(a,aa);return!r.isBoundingSphereVisible(n)},u.prototype.intersectPlane=function(a){return u.intersectPlane(this,a)},u.prototype.distanceSquaredTo=function(a){return u.distanceSquaredTo(this,a)},u.prototype.computePlaneDistances=function(a,e,t){return u.computePlaneDistances(this,a,e,t)},u.prototype.isOccluded=function(a){return u.isOccluded(this,a)},u.equals=function(a,t){return a===t||e.defined(a)&&e.defined(t)&&n.Cartesian3.equals(a.center,t.center)&&s.Matrix3.equals(a.halfAxes,t.halfAxes)},u.prototype.clone=function(a){return u.clone(this,a)},u.prototype.equals=function(a){return u.equals(this,a)},a.OrientedBoundingBox=u}));
//# sourceMappingURL=OrientedBoundingBox-c8ebb062.js.map
