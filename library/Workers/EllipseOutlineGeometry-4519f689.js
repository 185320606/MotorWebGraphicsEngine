define(["exports","./when-7ef6387a","./Check-ed6a1804","./Math-85667bf9","./Cartesian3-2a8ef78e","./Ellipsoid-367a1bb3","./Transforms-2448ecca","./ComponentDatatype-a863af81","./GeometryAttribute-a3332dc3","./PrimitiveType-4c1d698a","./GeometryAttributes-cb18da36","./IndexDatatype-f12d39b5","./GeometryOffsetAttribute-5cfc2755","./EllipseGeometryLibrary-29239805"],(function(e,t,i,r,a,n,o,s,l,u,d,f,p,m){"use strict";var c=new a.Cartesian3,h=new a.Cartesian3;var y=new o.BoundingSphere,b=new o.BoundingSphere;function A(e){var o=(e=t.defaultValue(e,t.defaultValue.EMPTY_OBJECT)).center,s=t.defaultValue(e.ellipsoid,n.Ellipsoid.WGS84),l=e.semiMajorAxis,u=e.semiMinorAxis,d=t.defaultValue(e.granularity,r.CesiumMath.RADIANS_PER_DEGREE);if(!t.defined(o))throw new i.DeveloperError("center is required.");if(!t.defined(l))throw new i.DeveloperError("semiMajorAxis is required.");if(!t.defined(u))throw new i.DeveloperError("semiMinorAxis is required.");if(l<u)throw new i.DeveloperError("semiMajorAxis must be greater than or equal to the semiMinorAxis.");if(d<=0)throw new i.DeveloperError("granularity must be greater than zero.");var f=t.defaultValue(e.height,0),p=t.defaultValue(e.extrudedHeight,f);this._center=a.Cartesian3.clone(o),this._semiMajorAxis=l,this._semiMinorAxis=u,this._ellipsoid=n.Ellipsoid.clone(s),this._rotation=t.defaultValue(e.rotation,0),this._height=Math.max(p,f),this._granularity=d,this._extrudedHeight=Math.min(p,f),this._numberOfVerticalLines=Math.max(t.defaultValue(e.numberOfVerticalLines,16),0),this._offsetAttribute=e.offsetAttribute,this._workerName="createEllipseOutlineGeometry"}A.packedLength=a.Cartesian3.packedLength+n.Ellipsoid.packedLength+8,A.pack=function(e,r,o){if(!t.defined(e))throw new i.DeveloperError("value is required");if(!t.defined(r))throw new i.DeveloperError("array is required");return o=t.defaultValue(o,0),a.Cartesian3.pack(e._center,r,o),o+=a.Cartesian3.packedLength,n.Ellipsoid.pack(e._ellipsoid,r,o),o+=n.Ellipsoid.packedLength,r[o++]=e._semiMajorAxis,r[o++]=e._semiMinorAxis,r[o++]=e._rotation,r[o++]=e._height,r[o++]=e._granularity,r[o++]=e._extrudedHeight,r[o++]=e._numberOfVerticalLines,r[o]=t.defaultValue(e._offsetAttribute,-1),r};var _=new a.Cartesian3,g=new n.Ellipsoid,v={center:_,ellipsoid:g,semiMajorAxis:void 0,semiMinorAxis:void 0,rotation:void 0,height:void 0,granularity:void 0,extrudedHeight:void 0,numberOfVerticalLines:void 0,offsetAttribute:void 0};A.unpack=function(e,r,o){if(!t.defined(e))throw new i.DeveloperError("array is required");r=t.defaultValue(r,0);var s=a.Cartesian3.unpack(e,r,_);r+=a.Cartesian3.packedLength;var l=n.Ellipsoid.unpack(e,r,g);r+=n.Ellipsoid.packedLength;var u=e[r++],d=e[r++],f=e[r++],p=e[r++],m=e[r++],c=e[r++],h=e[r++],y=e[r];return t.defined(o)?(o._center=a.Cartesian3.clone(s,o._center),o._ellipsoid=n.Ellipsoid.clone(l,o._ellipsoid),o._semiMajorAxis=u,o._semiMinorAxis=d,o._rotation=f,o._height=p,o._granularity=m,o._extrudedHeight=c,o._numberOfVerticalLines=h,o._offsetAttribute=-1===y?void 0:y,o):(v.height=p,v.extrudedHeight=c,v.granularity=m,v.rotation=f,v.semiMajorAxis=u,v.semiMinorAxis=d,v.numberOfVerticalLines=h,v.offsetAttribute=-1===y?void 0:y,new A(v))},A.createGeometry=function(e){if(!(e._semiMajorAxis<=0||e._semiMinorAxis<=0)){var i=e._height,n=e._extrudedHeight,A=!r.CesiumMath.equalsEpsilon(i,n,0,r.CesiumMath.EPSILON2);e._center=e._ellipsoid.scaleToGeodeticSurface(e._center,e._center);var _,g={center:e._center,semiMajorAxis:e._semiMajorAxis,semiMinorAxis:e._semiMinorAxis,ellipsoid:e._ellipsoid,rotation:e._rotation,height:i,granularity:e._granularity,numberOfVerticalLines:e._numberOfVerticalLines};if(A)g.extrudedHeight=n,g.offsetAttribute=e._offsetAttribute,_=function(e){var i=e.center,n=e.ellipsoid,u=e.semiMajorAxis,h=a.Cartesian3.multiplyByScalar(n.geodeticSurfaceNormal(i,c),e.height,c);y.center=a.Cartesian3.add(i,h,y.center),y.radius=u,h=a.Cartesian3.multiplyByScalar(n.geodeticSurfaceNormal(i,h),e.extrudedHeight,h),b.center=a.Cartesian3.add(i,h,b.center),b.radius=u;var A=m.EllipseGeometryLibrary.computeEllipsePositions(e,!1,!0).outerPositions,_=new d.GeometryAttributes({position:new l.GeometryAttribute({componentDatatype:s.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:m.EllipseGeometryLibrary.raisePositionsToHeight(A,e,!0)})});A=_.position.values;var g=o.BoundingSphere.union(y,b),v=A.length/3;if(t.defined(e.offsetAttribute)){var E=new Uint8Array(v);if(e.offsetAttribute===p.GeometryOffsetAttribute.TOP)E=p.arrayFill(E,1,0,v/2);else{var x=e.offsetAttribute===p.GeometryOffsetAttribute.NONE?0:1;E=p.arrayFill(E,x)}_.applyOffset=new l.GeometryAttribute({componentDatatype:s.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:E})}var M=t.defaultValue(e.numberOfVerticalLines,16);M=r.CesiumMath.clamp(M,0,v/2);var w=f.IndexDatatype.createTypedArray(v,2*v+2*M);v/=2;var C,D,G=0;for(C=0;C<v;++C)w[G++]=C,w[G++]=(C+1)%v,w[G++]=C+v,w[G++]=(C+1)%v+v;if(M>0){var L=Math.min(M,v);D=Math.round(v/L);var O=Math.min(D*M,v);for(C=0;C<O;C+=D)w[G++]=C,w[G++]=C+v}return{boundingSphere:g,attributes:_,indices:w}}(g);else if(_=function(e){var t=e.center;h=a.Cartesian3.multiplyByScalar(e.ellipsoid.geodeticSurfaceNormal(t,h),e.height,h),h=a.Cartesian3.add(t,h,h);for(var i=new o.BoundingSphere(h,e.semiMajorAxis),r=m.EllipseGeometryLibrary.computeEllipsePositions(e,!1,!0).outerPositions,n=new d.GeometryAttributes({position:new l.GeometryAttribute({componentDatatype:s.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:m.EllipseGeometryLibrary.raisePositionsToHeight(r,e,!1)})}),u=r.length/3,p=f.IndexDatatype.createTypedArray(u,2*u),c=0,y=0;y<u;++y)p[c++]=y,p[c++]=(y+1)%u;return{boundingSphere:i,attributes:n,indices:p}}(g),t.defined(e._offsetAttribute)){var v=_.attributes.position.values.length,E=new Uint8Array(v/3),x=e._offsetAttribute===p.GeometryOffsetAttribute.NONE?0:1;p.arrayFill(E,x),_.attributes.applyOffset=new l.GeometryAttribute({componentDatatype:s.ComponentDatatype.UNSIGNED_BYTE,componentsPerAttribute:1,values:E})}return new l.Geometry({attributes:_.attributes,indices:_.indices,primitiveType:u.PrimitiveType.LINES,boundingSphere:_.boundingSphere,offsetAttribute:e._offsetAttribute})}},e.EllipseOutlineGeometry=A}));
//# sourceMappingURL=EllipseOutlineGeometry-4519f689.js.map
