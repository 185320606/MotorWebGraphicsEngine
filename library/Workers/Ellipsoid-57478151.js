define(["exports","./when-7ef6387a","./DeveloperError-101d8eb9","./Check-71521db1","./Cartesian3-ca5d3f12"],(function(e,i,a,t,r){"use strict";var n=new r.Cartesian3,o=new r.Cartesian3;function d(e,t,d,u,s){if(!i.defined(e))throw new a.DeveloperError("cartesian is required.");if(!i.defined(t))throw new a.DeveloperError("oneOverRadii is required.");if(!i.defined(d))throw new a.DeveloperError("oneOverRadiiSquared is required.");if(!i.defined(u))throw new a.DeveloperError("centerToleranceSquared is required.");var h=e.x,c=e.y,l=e.z,f=t.x,C=t.y,p=t.z,m=h*h*f*f,g=c*c*C*C,y=l*l*p*p,v=m+g+y,_=Math.sqrt(1/v),S=r.Cartesian3.multiplyByScalar(e,_,n);if(v<u)return isFinite(_)?r.Cartesian3.clone(S,s):void 0;var q=d.x,O=d.y,w=d.z,R=o;R.x=S.x*q*2,R.y=S.y*O*2,R.z=S.z*w*2;var T,M,z,b,x,k,E,N=(1-_)*r.Cartesian3.magnitude(e)/(.5*r.Cartesian3.magnitude(R)),A=0;do{A=(T=m*(x=(M=1/(1+(N-=A)*q))*M)+g*(k=(z=1/(1+N*O))*z)+y*(E=(b=1/(1+N*w))*b)-1)/(-2*(m*(x*M)*q+g*(k*z)*O+y*(E*b)*w))}while(Math.abs(T)>r.CesiumMath.EPSILON12);return i.defined(s)?(s.x=h*M,s.y=c*z,s.z=l*b,s):new r.Cartesian3(h*M,c*z,l*b)}function u(e,a,t){this.longitude=i.defaultValue(e,0),this.latitude=i.defaultValue(a,0),this.height=i.defaultValue(t,0)}u.fromRadians=function(e,a,r,n){return t.Check.typeOf.number("longitude",e),t.Check.typeOf.number("latitude",a),r=i.defaultValue(r,0),i.defined(n)?(n.longitude=e,n.latitude=a,n.height=r,n):new u(e,a,r)},u.fromDegrees=function(e,i,a,n){return t.Check.typeOf.number("longitude",e),t.Check.typeOf.number("latitude",i),e=r.CesiumMath.toRadians(e),i=r.CesiumMath.toRadians(i),u.fromRadians(e,i,a,n)};var s=new r.Cartesian3,h=new r.Cartesian3,c=new r.Cartesian3,l=new r.Cartesian3(1/6378137,1/6378137,1/6356752.314245179),f=new r.Cartesian3(1/40680631590769,1/40680631590769,1/40408299984661.445),C=r.CesiumMath.EPSILON1;function p(e,a,n,o){a=i.defaultValue(a,0),n=i.defaultValue(n,0),o=i.defaultValue(o,0),t.Check.typeOf.number.greaterThanOrEquals("x",a,0),t.Check.typeOf.number.greaterThanOrEquals("y",n,0),t.Check.typeOf.number.greaterThanOrEquals("z",o,0),e._radii=new r.Cartesian3(a,n,o),e._radiiSquared=new r.Cartesian3(a*a,n*n,o*o),e._radiiToTheFourth=new r.Cartesian3(a*a*a*a,n*n*n*n,o*o*o*o),e._oneOverRadii=new r.Cartesian3(0===a?0:1/a,0===n?0:1/n,0===o?0:1/o),e._oneOverRadiiSquared=new r.Cartesian3(0===a?0:1/(a*a),0===n?0:1/(n*n),0===o?0:1/(o*o)),e._minimumRadius=Math.min(a,n,o),e._maximumRadius=Math.max(a,n,o),e._centerToleranceSquared=r.CesiumMath.EPSILON1,0!==e._radiiSquared.z&&(e._squaredXOverSquaredZ=e._radiiSquared.x/e._radiiSquared.z)}function m(e,i,a){this._radii=void 0,this._radiiSquared=void 0,this._radiiToTheFourth=void 0,this._oneOverRadii=void 0,this._oneOverRadiiSquared=void 0,this._minimumRadius=void 0,this._maximumRadius=void 0,this._centerToleranceSquared=void 0,this._squaredXOverSquaredZ=void 0,p(this,e,i,a)}u.fromCartesian=function(e,a,t){var n=i.defined(a)?a.oneOverRadii:l,o=i.defined(a)?a.oneOverRadiiSquared:f,p=d(e,n,o,i.defined(a)?a._centerToleranceSquared:C,h);if(i.defined(p)){var m=r.Cartesian3.multiplyComponents(p,o,s);m=r.Cartesian3.normalize(m,m);var g=r.Cartesian3.subtract(e,p,c),y=Math.atan2(m.y,m.x),v=Math.asin(m.z),_=r.CesiumMath.sign(r.Cartesian3.dot(g,e))*r.Cartesian3.magnitude(g);return i.defined(t)?(t.longitude=y,t.latitude=v,t.height=_,t):new u(y,v,_)}},u.toCartesian=function(e,i,a){return t.Check.defined("cartographic",e),r.Cartesian3.fromRadians(e.longitude,e.latitude,e.height,i,a)},u.clone=function(e,a){if(i.defined(e))return i.defined(a)?(a.longitude=e.longitude,a.latitude=e.latitude,a.height=e.height,a):new u(e.longitude,e.latitude,e.height)},u.equals=function(e,a){return e===a||i.defined(e)&&i.defined(a)&&e.longitude===a.longitude&&e.latitude===a.latitude&&e.height===a.height},u.equalsEpsilon=function(e,a,r){return t.Check.typeOf.number("epsilon",r),e===a||i.defined(e)&&i.defined(a)&&Math.abs(e.longitude-a.longitude)<=r&&Math.abs(e.latitude-a.latitude)<=r&&Math.abs(e.height-a.height)<=r},u.ZERO=Object.freeze(new u(0,0,0)),u.prototype.clone=function(e){return u.clone(this,e)},u.prototype.equals=function(e){return u.equals(this,e)},u.prototype.equalsEpsilon=function(e,i){return u.equalsEpsilon(this,e,i)},u.prototype.toString=function(){return"("+this.longitude+", "+this.latitude+", "+this.height+")"},Object.defineProperties(m.prototype,{radii:{get:function(){return this._radii}},radiiSquared:{get:function(){return this._radiiSquared}},radiiToTheFourth:{get:function(){return this._radiiToTheFourth}},oneOverRadii:{get:function(){return this._oneOverRadii}},oneOverRadiiSquared:{get:function(){return this._oneOverRadiiSquared}},minimumRadius:{get:function(){return this._minimumRadius}},maximumRadius:{get:function(){return this._maximumRadius}}}),m.clone=function(e,a){if(i.defined(e)){var t=e._radii;return i.defined(a)?(r.Cartesian3.clone(t,a._radii),r.Cartesian3.clone(e._radiiSquared,a._radiiSquared),r.Cartesian3.clone(e._radiiToTheFourth,a._radiiToTheFourth),r.Cartesian3.clone(e._oneOverRadii,a._oneOverRadii),r.Cartesian3.clone(e._oneOverRadiiSquared,a._oneOverRadiiSquared),a._minimumRadius=e._minimumRadius,a._maximumRadius=e._maximumRadius,a._centerToleranceSquared=e._centerToleranceSquared,a):new m(t.x,t.y,t.z)}},m.fromCartesian3=function(e,a){return i.defined(a)||(a=new m),i.defined(e)?(p(a,e.x,e.y,e.z),a):a},m.WGS84=Object.freeze(new m(6378137,6378137,6356752.314245179)),m.UNIT_SPHERE=Object.freeze(new m(1,1,1)),m.MOON=Object.freeze(new m(r.CesiumMath.LUNAR_RADIUS,r.CesiumMath.LUNAR_RADIUS,r.CesiumMath.LUNAR_RADIUS)),m.prototype.clone=function(e){return m.clone(this,e)},m.packedLength=r.Cartesian3.packedLength,m.pack=function(e,a,n){return t.Check.typeOf.object("value",e),t.Check.defined("array",a),n=i.defaultValue(n,0),r.Cartesian3.pack(e._radii,a,n),a},m.unpack=function(e,a,n){t.Check.defined("array",e),a=i.defaultValue(a,0);var o=r.Cartesian3.unpack(e,a);return m.fromCartesian3(o,n)},m.prototype.geocentricSurfaceNormal=r.Cartesian3.normalize,m.prototype.geodeticSurfaceNormalCartographic=function(e,a){t.Check.typeOf.object("cartographic",e);var n=e.longitude,o=e.latitude,d=Math.cos(o),u=d*Math.cos(n),s=d*Math.sin(n),h=Math.sin(o);return i.defined(a)||(a=new r.Cartesian3),a.x=u,a.y=s,a.z=h,r.Cartesian3.normalize(a,a)},m.prototype.geodeticSurfaceNormal=function(e,a){return i.defined(a)||(a=new r.Cartesian3),a=r.Cartesian3.multiplyComponents(e,this._oneOverRadiiSquared,a),r.Cartesian3.normalize(a,a)};var g=new r.Cartesian3,y=new r.Cartesian3;m.prototype.cartographicToCartesian=function(e,a){var t=g,n=y;this.geodeticSurfaceNormalCartographic(e,t),r.Cartesian3.multiplyComponents(this._radiiSquared,t,n);var o=Math.sqrt(r.Cartesian3.dot(t,n));return r.Cartesian3.divideByScalar(n,o,n),r.Cartesian3.multiplyByScalar(t,e.height,t),i.defined(a)||(a=new r.Cartesian3),r.Cartesian3.add(n,t,a)},m.prototype.cartographicArrayToCartesianArray=function(e,a){t.Check.defined("cartographics",e);var r=e.length;i.defined(a)?a.length=r:a=new Array(r);for(var n=0;n<r;n++)a[n]=this.cartographicToCartesian(e[n],a[n]);return a};var v=new r.Cartesian3,_=new r.Cartesian3,S=new r.Cartesian3;m.prototype.cartesianToCartographic=function(e,a){var t=this.scaleToGeodeticSurface(e,_);if(i.defined(t)){var n=this.geodeticSurfaceNormal(t,v),o=r.Cartesian3.subtract(e,t,S),d=Math.atan2(n.y,n.x),s=Math.asin(n.z),h=r.CesiumMath.sign(r.Cartesian3.dot(o,e))*r.Cartesian3.magnitude(o);return i.defined(a)?(a.longitude=d,a.latitude=s,a.height=h,a):new u(d,s,h)}},m.prototype.cartesianArrayToCartographicArray=function(e,a){t.Check.defined("cartesians",e);var r=e.length;i.defined(a)?a.length=r:a=new Array(r);for(var n=0;n<r;++n)a[n]=this.cartesianToCartographic(e[n],a[n]);return a},m.prototype.scaleToGeodeticSurface=function(e,i){return d(e,this._oneOverRadii,this._oneOverRadiiSquared,this._centerToleranceSquared,i)},m.prototype.scaleToGeocentricSurface=function(e,a){t.Check.typeOf.object("cartesian",e),i.defined(a)||(a=new r.Cartesian3);var n=e.x,o=e.y,d=e.z,u=this._oneOverRadiiSquared,s=1/Math.sqrt(n*n*u.x+o*o*u.y+d*d*u.z);return r.Cartesian3.multiplyByScalar(e,s,a)},m.prototype.transformPositionToScaledSpace=function(e,a){return i.defined(a)||(a=new r.Cartesian3),r.Cartesian3.multiplyComponents(e,this._oneOverRadii,a)},m.prototype.transformPositionFromScaledSpace=function(e,a){return i.defined(a)||(a=new r.Cartesian3),r.Cartesian3.multiplyComponents(e,this._radii,a)},m.prototype.equals=function(e){return this===e||i.defined(e)&&r.Cartesian3.equals(this._radii,e._radii)},m.prototype.toString=function(){return this._radii.toString()},m.prototype.getSurfaceNormalIntersectionWithZAxis=function(e,n,o){if(t.Check.typeOf.object("position",e),!r.CesiumMath.equalsEpsilon(this._radii.x,this._radii.y,r.CesiumMath.EPSILON15))throw new a.DeveloperError("Ellipsoid must be an ellipsoid of revolution (radii.x == radii.y)");t.Check.typeOf.number.greaterThan("Ellipsoid.radii.z",this._radii.z,0),n=i.defaultValue(n,0);var d=this._squaredXOverSquaredZ;if(i.defined(o)||(o=new r.Cartesian3),o.x=0,o.y=0,o.z=e.z*(1-d),!(Math.abs(o.z)>=this._radii.z-n))return o},e.Cartographic=u,e.Ellipsoid=m}));
//# sourceMappingURL=Ellipsoid-57478151.js.map
