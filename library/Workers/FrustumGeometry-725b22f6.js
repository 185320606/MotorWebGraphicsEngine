define(["exports","./when-7ef6387a","./DeveloperError-101d8eb9","./Check-71521db1","./Cartesian3-ca5d3f12","./Transforms-7a1c9ee7","./Matrix4-027dd006","./ComponentDatatype-f4fabeaa","./GeometryAttribute-c5b9902a","./PrimitiveType-4c1d698a","./GeometryAttributes-cb18da36","./Plane-08adaa50","./VertexFormat-64d8e6c6"],(function(e,t,r,a,i,n,o,s,f,u,d,h,p){"use strict";function l(e){this.planes=t.defaultValue(e,[])}var c=[new i.Cartesian3,new i.Cartesian3,new i.Cartesian3];i.Cartesian3.clone(i.Cartesian3.UNIT_X,c[0]),i.Cartesian3.clone(i.Cartesian3.UNIT_Y,c[1]),i.Cartesian3.clone(i.Cartesian3.UNIT_Z,c[2]);var m=new i.Cartesian3,C=new i.Cartesian3,w=new h.Plane(new i.Cartesian3(1,0,0),0);function v(e){e=t.defaultValue(e,t.defaultValue.EMPTY_OBJECT),this.left=e.left,this._left=void 0,this.right=e.right,this._right=void 0,this.top=e.top,this._top=void 0,this.bottom=e.bottom,this._bottom=void 0,this.near=t.defaultValue(e.near,1),this._near=this.near,this.far=t.defaultValue(e.far,5e8),this._far=this.far,this._cullingVolume=new l,this._orthographicMatrix=new o.Matrix4}function _(e){if(!(t.defined(e.right)&&t.defined(e.left)&&t.defined(e.top)&&t.defined(e.bottom)&&t.defined(e.near)&&t.defined(e.far)))throw new r.DeveloperError("right, left, top, bottom, near, or far parameters are not set.");if(e.top!==e._top||e.bottom!==e._bottom||e.left!==e._left||e.right!==e._right||e.near!==e._near||e.far!==e._far){if(e.left>e.right)throw new r.DeveloperError("right must be greater than left.");if(e.bottom>e.top)throw new r.DeveloperError("top must be greater than bottom.");if(e.near<=0||e.near>e.far)throw new r.DeveloperError("near must be greater than zero and less than far.");e._left=e.left,e._right=e.right,e._top=e.top,e._bottom=e.bottom,e._near=e.near,e._far=e.far,e._orthographicMatrix=o.Matrix4.computeOrthographicOffCenter(e.left,e.right,e.bottom,e.top,e.near,e.far,e._orthographicMatrix)}}l.fromBoundingSphere=function(e,a){if(!t.defined(e))throw new r.DeveloperError("boundingSphere is required.");t.defined(a)||(a=new l);var n=c.length,s=a.planes;s.length=2*n;for(var f=e.center,u=e.radius,d=0,h=0;h<n;++h){var p=c[h],w=s[d],v=s[d+1];t.defined(w)||(w=s[d]=new o.Cartesian4),t.defined(v)||(v=s[d+1]=new o.Cartesian4),i.Cartesian3.multiplyByScalar(p,-u,m),i.Cartesian3.add(f,m,m),w.x=p.x,w.y=p.y,w.z=p.z,w.w=-i.Cartesian3.dot(p,m),i.Cartesian3.multiplyByScalar(p,u,m),i.Cartesian3.add(f,m,m),v.x=-p.x,v.y=-p.y,v.z=-p.z,v.w=-i.Cartesian3.dot(i.Cartesian3.negate(p,C),m),d+=2}return a},l.prototype.computeVisibility=function(e){if(!t.defined(e))throw new r.DeveloperError("boundingVolume is required.");for(var a=this.planes,i=!1,o=0,s=a.length;o<s;++o){var f=e.intersectPlane(h.Plane.fromCartesian4(a[o],w));if(f===n.Intersect.OUTSIDE)return n.Intersect.OUTSIDE;f===n.Intersect.INTERSECTING&&(i=!0)}return i?n.Intersect.INTERSECTING:n.Intersect.INSIDE},l.prototype.computeVisibilityWithPlaneMask=function(e,a){if(!t.defined(e))throw new r.DeveloperError("boundingVolume is required.");if(!t.defined(a))throw new r.DeveloperError("parentPlaneMask is required.");if(a===l.MASK_OUTSIDE||a===l.MASK_INSIDE)return a;for(var i=l.MASK_INSIDE,o=this.planes,s=0,f=o.length;s<f;++s){var u=s<31?1<<s:0;if(!(s<31&&0==(a&u))){var d=e.intersectPlane(h.Plane.fromCartesian4(o[s],w));if(d===n.Intersect.OUTSIDE)return l.MASK_OUTSIDE;d===n.Intersect.INTERSECTING&&(i|=u)}}return i},l.MASK_OUTSIDE=4294967295,l.MASK_INSIDE=0,l.MASK_INDETERMINATE=2147483647,Object.defineProperties(v.prototype,{projectionMatrix:{get:function(){return _(this),this._orthographicMatrix}}});var y=new i.Cartesian3,g=new i.Cartesian3,x=new i.Cartesian3,b=new i.Cartesian3;function E(e){e=t.defaultValue(e,t.defaultValue.EMPTY_OBJECT),this._offCenterFrustum=new v,this.width=e.width,this._width=void 0,this.aspectRatio=e.aspectRatio,this._aspectRatio=void 0,this.near=t.defaultValue(e.near,1),this._near=this.near,this.far=t.defaultValue(e.far,5e8),this._far=this.far}function M(e){if(!(t.defined(e.width)&&t.defined(e.aspectRatio)&&t.defined(e.near)&&t.defined(e.far)))throw new r.DeveloperError("width, aspectRatio, near, or far parameters are not set.");var a=e._offCenterFrustum;if(e.width!==e._width||e.aspectRatio!==e._aspectRatio||e.near!==e._near||e.far!==e._far){if(e.aspectRatio<0)throw new r.DeveloperError("aspectRatio must be positive.");if(e.near<0||e.near>e.far)throw new r.DeveloperError("near must be greater than zero and less than far.");e._aspectRatio=e.aspectRatio,e._width=e.width,e._near=e.near,e._far=e.far;var i=1/e.aspectRatio;a.right=.5*e.width,a.left=-a.right,a.top=i*a.right,a.bottom=-a.top,a.near=e.near,a.far=e.far}}function D(e){e=t.defaultValue(e,t.defaultValue.EMPTY_OBJECT),this.left=e.left,this._left=void 0,this.right=e.right,this._right=void 0,this.top=e.top,this._top=void 0,this.bottom=e.bottom,this._bottom=void 0,this.near=t.defaultValue(e.near,1),this._near=this.near,this.far=t.defaultValue(e.far,5e8),this._far=this.far,this._cullingVolume=new l,this._perspectiveMatrix=new o.Matrix4,this._infinitePerspective=new o.Matrix4}function V(e){if(!(t.defined(e.right)&&t.defined(e.left)&&t.defined(e.top)&&t.defined(e.bottom)&&t.defined(e.near)&&t.defined(e.far)))throw new r.DeveloperError("right, left, top, bottom, near, or far parameters are not set.");var a=e.top,i=e.bottom,n=e.right,s=e.left,f=e.near,u=e.far;if(a!==e._top||i!==e._bottom||s!==e._left||n!==e._right||f!==e._near||u!==e._far){if(e.near<=0||e.near>e.far)throw new r.DeveloperError("near must be greater than zero and less than far.");e._left=s,e._right=n,e._top=a,e._bottom=i,e._near=f,e._far=u,e._perspectiveMatrix=o.Matrix4.computePerspectiveOffCenter(s,n,i,a,f,u,e._perspectiveMatrix),e._infinitePerspective=o.Matrix4.computeInfinitePerspectiveOffCenter(s,n,i,a,f,e._infinitePerspective)}}v.prototype.computeCullingVolume=function(e,a,n){if(!t.defined(e))throw new r.DeveloperError("position is required.");if(!t.defined(a))throw new r.DeveloperError("direction is required.");if(!t.defined(n))throw new r.DeveloperError("up is required.");var s=this._cullingVolume.planes,f=this.top,u=this.bottom,d=this.right,h=this.left,p=this.near,l=this.far,c=i.Cartesian3.cross(a,n,y);i.Cartesian3.normalize(c,c);var m=g;i.Cartesian3.multiplyByScalar(a,p,m),i.Cartesian3.add(e,m,m);var C=x;i.Cartesian3.multiplyByScalar(c,h,C),i.Cartesian3.add(m,C,C);var w=s[0];return t.defined(w)||(w=s[0]=new o.Cartesian4),w.x=c.x,w.y=c.y,w.z=c.z,w.w=-i.Cartesian3.dot(c,C),i.Cartesian3.multiplyByScalar(c,d,C),i.Cartesian3.add(m,C,C),w=s[1],t.defined(w)||(w=s[1]=new o.Cartesian4),w.x=-c.x,w.y=-c.y,w.z=-c.z,w.w=-i.Cartesian3.dot(i.Cartesian3.negate(c,b),C),i.Cartesian3.multiplyByScalar(n,u,C),i.Cartesian3.add(m,C,C),w=s[2],t.defined(w)||(w=s[2]=new o.Cartesian4),w.x=n.x,w.y=n.y,w.z=n.z,w.w=-i.Cartesian3.dot(n,C),i.Cartesian3.multiplyByScalar(n,f,C),i.Cartesian3.add(m,C,C),w=s[3],t.defined(w)||(w=s[3]=new o.Cartesian4),w.x=-n.x,w.y=-n.y,w.z=-n.z,w.w=-i.Cartesian3.dot(i.Cartesian3.negate(n,b),C),w=s[4],t.defined(w)||(w=s[4]=new o.Cartesian4),w.x=a.x,w.y=a.y,w.z=a.z,w.w=-i.Cartesian3.dot(a,m),i.Cartesian3.multiplyByScalar(a,l,C),i.Cartesian3.add(e,C,C),w=s[5],t.defined(w)||(w=s[5]=new o.Cartesian4),w.x=-a.x,w.y=-a.y,w.z=-a.z,w.w=-i.Cartesian3.dot(i.Cartesian3.negate(a,b),C),this._cullingVolume},v.prototype.getPixelDimensions=function(e,a,i,n,o){if(_(this),!t.defined(e)||!t.defined(a))throw new r.DeveloperError("Both drawingBufferWidth and drawingBufferHeight are required.");if(e<=0)throw new r.DeveloperError("drawingBufferWidth must be greater than zero.");if(a<=0)throw new r.DeveloperError("drawingBufferHeight must be greater than zero.");if(!t.defined(i))throw new r.DeveloperError("distance is required.");if(!t.defined(n))throw new r.DeveloperError("pixelRatio is required.");if(n<=0)throw new r.DeveloperError("pixelRatio must be greater than zero.");if(!t.defined(o))throw new r.DeveloperError("A result object is required.");var s=n*(this.right-this.left)/e,f=n*(this.top-this.bottom)/a;return o.x=s,o.y=f,o},v.prototype.clone=function(e){return t.defined(e)||(e=new v),e.left=this.left,e.right=this.right,e.top=this.top,e.bottom=this.bottom,e.near=this.near,e.far=this.far,e._left=void 0,e._right=void 0,e._top=void 0,e._bottom=void 0,e._near=void 0,e._far=void 0,e},v.prototype.equals=function(e){return t.defined(e)&&e instanceof v&&this.right===e.right&&this.left===e.left&&this.top===e.top&&this.bottom===e.bottom&&this.near===e.near&&this.far===e.far},v.prototype.equalsEpsilon=function(e,r,a){return e===this||t.defined(e)&&e instanceof v&&i.CesiumMath.equalsEpsilon(this.right,e.right,r,a)&&i.CesiumMath.equalsEpsilon(this.left,e.left,r,a)&&i.CesiumMath.equalsEpsilon(this.top,e.top,r,a)&&i.CesiumMath.equalsEpsilon(this.bottom,e.bottom,r,a)&&i.CesiumMath.equalsEpsilon(this.near,e.near,r,a)&&i.CesiumMath.equalsEpsilon(this.far,e.far,r,a)},E.packedLength=4,E.pack=function(e,r,i){return a.Check.typeOf.object("value",e),a.Check.defined("array",r),i=t.defaultValue(i,0),r[i++]=e.width,r[i++]=e.aspectRatio,r[i++]=e.near,r[i]=e.far,r},E.unpack=function(e,r,i){return a.Check.defined("array",e),r=t.defaultValue(r,0),t.defined(i)||(i=new E),i.width=e[r++],i.aspectRatio=e[r++],i.near=e[r++],i.far=e[r],i},Object.defineProperties(E.prototype,{projectionMatrix:{get:function(){return M(this),this._offCenterFrustum.projectionMatrix}}}),E.prototype.computeCullingVolume=function(e,t,r){return M(this),this._offCenterFrustum.computeCullingVolume(e,t,r)},E.prototype.getPixelDimensions=function(e,t,r,a,i){return M(this),this._offCenterFrustum.getPixelDimensions(e,t,r,a,i)},E.prototype.clone=function(e){return t.defined(e)||(e=new E),e.aspectRatio=this.aspectRatio,e.width=this.width,e.near=this.near,e.far=this.far,e._aspectRatio=void 0,e._width=void 0,e._near=void 0,e._far=void 0,this._offCenterFrustum.clone(e._offCenterFrustum),e},E.prototype.equals=function(e){return!!(t.defined(e)&&e instanceof E)&&(M(this),M(e),this.width===e.width&&this.aspectRatio===e.aspectRatio&&this._offCenterFrustum.equals(e._offCenterFrustum))},E.prototype.equalsEpsilon=function(e,r,a){return!!(t.defined(e)&&e instanceof E)&&(M(this),M(e),i.CesiumMath.equalsEpsilon(this.width,e.width,r,a)&&i.CesiumMath.equalsEpsilon(this.aspectRatio,e.aspectRatio,r,a)&&this._offCenterFrustum.equalsEpsilon(e._offCenterFrustum,r,a))},Object.defineProperties(D.prototype,{projectionMatrix:{get:function(){return V(this),this._perspectiveMatrix}},infiniteProjectionMatrix:{get:function(){return V(this),this._infinitePerspective}}});var F=new i.Cartesian3,O=new i.Cartesian3,z=new i.Cartesian3,R=new i.Cartesian3;function k(e){e=t.defaultValue(e,t.defaultValue.EMPTY_OBJECT),this._offCenterFrustum=new D,this.fov=e.fov,this._fov=void 0,this._fovy=void 0,this._sseDenominator=void 0,this.aspectRatio=e.aspectRatio,this._aspectRatio=void 0,this.near=t.defaultValue(e.near,1),this._near=this.near,this.far=t.defaultValue(e.far,5e8),this._far=this.far,this.xOffset=t.defaultValue(e.xOffset,0),this._xOffset=this.xOffset,this.yOffset=t.defaultValue(e.yOffset,0),this._yOffset=this.yOffset}function P(e){if(!(t.defined(e.fov)&&t.defined(e.aspectRatio)&&t.defined(e.near)&&t.defined(e.far)))throw new r.DeveloperError("fov, aspectRatio, near, or far parameters are not set.");var a=e._offCenterFrustum;if(e.fov!==e._fov||e.aspectRatio!==e._aspectRatio||e.near!==e._near||e.far!==e._far||e.xOffset!==e._xOffset||e.yOffset!==e._yOffset){if(e.fov<0||e.fov>=Math.PI)throw new r.DeveloperError("fov must be in the range [0, PI).");if(e.aspectRatio<0)throw new r.DeveloperError("aspectRatio must be positive.");if(e.near<0||e.near>e.far)throw new r.DeveloperError("near must be greater than zero and less than far.");e._aspectRatio=e.aspectRatio,e._fov=e.fov,e._fovy=e.aspectRatio>1?e.fov:2*Math.atan(Math.tan(.5*e.fov)/e.aspectRatio),e._near=e.near,e._far=e.far,e._sseDenominator=2*Math.tan(.5*e._fovy),e._xOffset=e.xOffset,e._yOffset=e.yOffset,a.top=e.near*Math.tan(.5*e._fovy),a.bottom=-a.top,a.right=e.aspectRatio*a.top,a.left=-a.right,a.near=e.near,a.far=e.far,a.right+=e.xOffset,a.left+=e.xOffset,a.top+=e.yOffset,a.bottom+=e.yOffset}}D.prototype.computeCullingVolume=function(e,a,n){if(!t.defined(e))throw new r.DeveloperError("position is required.");if(!t.defined(a))throw new r.DeveloperError("direction is required.");if(!t.defined(n))throw new r.DeveloperError("up is required.");var s=this._cullingVolume.planes,f=this.top,u=this.bottom,d=this.right,h=this.left,p=this.near,l=this.far,c=i.Cartesian3.cross(a,n,F),m=O;i.Cartesian3.multiplyByScalar(a,p,m),i.Cartesian3.add(e,m,m);var C=z;i.Cartesian3.multiplyByScalar(a,l,C),i.Cartesian3.add(e,C,C);var w=R;i.Cartesian3.multiplyByScalar(c,h,w),i.Cartesian3.add(m,w,w),i.Cartesian3.subtract(w,e,w),i.Cartesian3.normalize(w,w),i.Cartesian3.cross(w,n,w),i.Cartesian3.normalize(w,w);var v=s[0];return t.defined(v)||(v=s[0]=new o.Cartesian4),v.x=w.x,v.y=w.y,v.z=w.z,v.w=-i.Cartesian3.dot(w,e),i.Cartesian3.multiplyByScalar(c,d,w),i.Cartesian3.add(m,w,w),i.Cartesian3.subtract(w,e,w),i.Cartesian3.cross(n,w,w),i.Cartesian3.normalize(w,w),v=s[1],t.defined(v)||(v=s[1]=new o.Cartesian4),v.x=w.x,v.y=w.y,v.z=w.z,v.w=-i.Cartesian3.dot(w,e),i.Cartesian3.multiplyByScalar(n,u,w),i.Cartesian3.add(m,w,w),i.Cartesian3.subtract(w,e,w),i.Cartesian3.cross(c,w,w),i.Cartesian3.normalize(w,w),v=s[2],t.defined(v)||(v=s[2]=new o.Cartesian4),v.x=w.x,v.y=w.y,v.z=w.z,v.w=-i.Cartesian3.dot(w,e),i.Cartesian3.multiplyByScalar(n,f,w),i.Cartesian3.add(m,w,w),i.Cartesian3.subtract(w,e,w),i.Cartesian3.cross(w,c,w),i.Cartesian3.normalize(w,w),v=s[3],t.defined(v)||(v=s[3]=new o.Cartesian4),v.x=w.x,v.y=w.y,v.z=w.z,v.w=-i.Cartesian3.dot(w,e),v=s[4],t.defined(v)||(v=s[4]=new o.Cartesian4),v.x=a.x,v.y=a.y,v.z=a.z,v.w=-i.Cartesian3.dot(a,m),i.Cartesian3.negate(a,w),v=s[5],t.defined(v)||(v=s[5]=new o.Cartesian4),v.x=w.x,v.y=w.y,v.z=w.z,v.w=-i.Cartesian3.dot(w,C),this._cullingVolume},D.prototype.getPixelDimensions=function(e,a,i,n,o){if(V(this),!t.defined(e)||!t.defined(a))throw new r.DeveloperError("Both drawingBufferWidth and drawingBufferHeight are required.");if(e<=0)throw new r.DeveloperError("drawingBufferWidth must be greater than zero.");if(a<=0)throw new r.DeveloperError("drawingBufferHeight must be greater than zero.");if(!t.defined(i))throw new r.DeveloperError("distance is required.");if(!t.defined(n))throw new r.DeveloperError("pixelRatio is required");if(n<=0)throw new r.DeveloperError("pixelRatio must be greater than zero.");if(!t.defined(o))throw new r.DeveloperError("A result object is required.");var s=1/this.near,f=this.top*s,u=2*n*i*f/a,d=2*n*i*(f=this.right*s)/e;return o.x=d,o.y=u,o},D.prototype.clone=function(e){return t.defined(e)||(e=new D),e.right=this.right,e.left=this.left,e.top=this.top,e.bottom=this.bottom,e.near=this.near,e.far=this.far,e._left=void 0,e._right=void 0,e._top=void 0,e._bottom=void 0,e._near=void 0,e._far=void 0,e},D.prototype.equals=function(e){return t.defined(e)&&e instanceof D&&this.right===e.right&&this.left===e.left&&this.top===e.top&&this.bottom===e.bottom&&this.near===e.near&&this.far===e.far},D.prototype.equalsEpsilon=function(e,r,a){return e===this||t.defined(e)&&e instanceof D&&i.CesiumMath.equalsEpsilon(this.right,e.right,r,a)&&i.CesiumMath.equalsEpsilon(this.left,e.left,r,a)&&i.CesiumMath.equalsEpsilon(this.top,e.top,r,a)&&i.CesiumMath.equalsEpsilon(this.bottom,e.bottom,r,a)&&i.CesiumMath.equalsEpsilon(this.near,e.near,r,a)&&i.CesiumMath.equalsEpsilon(this.far,e.far,r,a)},k.packedLength=6,k.pack=function(e,r,i){return a.Check.typeOf.object("value",e),a.Check.defined("array",r),i=t.defaultValue(i,0),r[i++]=e.fov,r[i++]=e.aspectRatio,r[i++]=e.near,r[i++]=e.far,r[i++]=e.xOffset,r[i]=e.yOffset,r},k.unpack=function(e,r,i){return a.Check.defined("array",e),r=t.defaultValue(r,0),t.defined(i)||(i=new k),i.fov=e[r++],i.aspectRatio=e[r++],i.near=e[r++],i.far=e[r++],i.xOffset=e[r++],i.yOffset=e[r],i},Object.defineProperties(k.prototype,{projectionMatrix:{get:function(){return P(this),this._offCenterFrustum.projectionMatrix}},infiniteProjectionMatrix:{get:function(){return P(this),this._offCenterFrustum.infiniteProjectionMatrix}},fovy:{get:function(){return P(this),this._fovy}},sseDenominator:{get:function(){return P(this),this._sseDenominator}}}),k.prototype.computeCullingVolume=function(e,t,r){return P(this),this._offCenterFrustum.computeCullingVolume(e,t,r)},k.prototype.getPixelDimensions=function(e,t,r,a,i){return P(this),this._offCenterFrustum.getPixelDimensions(e,t,r,a,i)},k.prototype.clone=function(e){return t.defined(e)||(e=new k),e.aspectRatio=this.aspectRatio,e.fov=this.fov,e.near=this.near,e.far=this.far,e._aspectRatio=void 0,e._fov=void 0,e._near=void 0,e._far=void 0,this._offCenterFrustum.clone(e._offCenterFrustum),e},k.prototype.equals=function(e){return!!(t.defined(e)&&e instanceof k)&&(P(this),P(e),this.fov===e.fov&&this.aspectRatio===e.aspectRatio&&this._offCenterFrustum.equals(e._offCenterFrustum))},k.prototype.equalsEpsilon=function(e,r,a){return!!(t.defined(e)&&e instanceof k)&&(P(this),P(e),i.CesiumMath.equalsEpsilon(this.fov,e.fov,r,a)&&i.CesiumMath.equalsEpsilon(this.aspectRatio,e.aspectRatio,r,a)&&this._offCenterFrustum.equalsEpsilon(e._offCenterFrustum,r,a))};function q(e){a.Check.typeOf.object("options",e),a.Check.typeOf.object("options.frustum",e.frustum),a.Check.typeOf.object("options.origin",e.origin),a.Check.typeOf.object("options.orientation",e.orientation);var r,o,s=e.frustum,f=e.orientation,u=e.origin,d=t.defaultValue(e.vertexFormat,p.VertexFormat.DEFAULT),h=t.defaultValue(e._drawNearPlane,!0);s instanceof k?(r=0,o=k.packedLength):s instanceof E&&(r=1,o=E.packedLength),this._frustumType=r,this._frustum=s.clone(),this._origin=i.Cartesian3.clone(u),this._orientation=n.Quaternion.clone(f),this._drawNearPlane=h,this._vertexFormat=d,this._workerName="createFrustumGeometry",this.packedLength=2+o+i.Cartesian3.packedLength+n.Quaternion.packedLength+p.VertexFormat.packedLength}q.pack=function(e,r,o){a.Check.typeOf.object("value",e),a.Check.defined("array",r),o=t.defaultValue(o,0);var s=e._frustumType,f=e._frustum;return r[o++]=s,0===s?(k.pack(f,r,o),o+=k.packedLength):(E.pack(f,r,o),o+=E.packedLength),i.Cartesian3.pack(e._origin,r,o),o+=i.Cartesian3.packedLength,n.Quaternion.pack(e._orientation,r,o),o+=n.Quaternion.packedLength,p.VertexFormat.pack(e._vertexFormat,r,o),r[o+=p.VertexFormat.packedLength]=e._drawNearPlane?1:0,r};var S=new k,T=new E,A=new n.Quaternion,I=new i.Cartesian3,B=new p.VertexFormat;function L(e,r,a,i,n,o,s,f){for(var u=e/3*2,d=0;d<4;++d)t.defined(r)&&(r[e]=o.x,r[e+1]=o.y,r[e+2]=o.z),t.defined(a)&&(a[e]=s.x,a[e+1]=s.y,a[e+2]=s.z),t.defined(i)&&(i[e]=f.x,i[e+1]=f.y,i[e+2]=f.z),e+=3;n[u]=0,n[u+1]=0,n[u+2]=1,n[u+3]=0,n[u+4]=1,n[u+5]=1,n[u+6]=0,n[u+7]=1}q.unpack=function(e,r,o){a.Check.defined("array",e),r=t.defaultValue(r,0);var s,f=e[r++];0===f?(s=k.unpack(e,r,S),r+=k.packedLength):(s=E.unpack(e,r,T),r+=E.packedLength);var u=i.Cartesian3.unpack(e,r,I);r+=i.Cartesian3.packedLength;var d=n.Quaternion.unpack(e,r,A);r+=n.Quaternion.packedLength;var h=p.VertexFormat.unpack(e,r,B),l=1===e[r+=p.VertexFormat.packedLength];if(!t.defined(o))return new q({frustum:s,origin:u,orientation:d,vertexFormat:h,_drawNearPlane:l});var c=f===o._frustumType?o._frustum:void 0;return o._frustum=s.clone(c),o._frustumType=f,o._origin=i.Cartesian3.clone(u,o._origin),o._orientation=n.Quaternion.clone(d,o._orientation),o._vertexFormat=p.VertexFormat.clone(h,o._vertexFormat),o._drawNearPlane=l,o};var N=new o.Matrix3,j=new o.Matrix4,G=new o.Matrix4,U=new i.Cartesian3,Q=new i.Cartesian3,K=new i.Cartesian3,W=new i.Cartesian3,Y=new i.Cartesian3,H=new i.Cartesian3,J=new Array(3),X=new Array(4);X[0]=new o.Cartesian4(-1,-1,1,1),X[1]=new o.Cartesian4(1,-1,1,1),X[2]=new o.Cartesian4(1,1,1,1),X[3]=new o.Cartesian4(-1,1,1,1);for(var Z=new Array(4),$=0;$<4;++$)Z[$]=new o.Cartesian4;q._computeNearFarPlanes=function(e,r,a,n,s,f,u,d){var h=o.Matrix3.fromQuaternion(r,N),p=t.defaultValue(f,U),l=t.defaultValue(u,Q),c=t.defaultValue(d,K);p=o.Matrix3.getColumn(h,0,p),l=o.Matrix3.getColumn(h,1,l),c=o.Matrix3.getColumn(h,2,c),i.Cartesian3.normalize(p,p),i.Cartesian3.normalize(l,l),i.Cartesian3.normalize(c,c),i.Cartesian3.negate(p,p);var m,C,w=o.Matrix4.computeView(e,c,l,p,j);if(0===a){var v=n.projectionMatrix,_=o.Matrix4.multiply(v,w,G);C=o.Matrix4.inverse(_,G)}else m=o.Matrix4.inverseTransformation(w,G);t.defined(C)?(J[0]=n.near,J[1]=n.far):(J[0]=0,J[1]=n.near,J[2]=n.far);for(var y=0;y<2;++y)for(var g=0;g<4;++g){var x=o.Cartesian4.clone(X[g],Z[g]);if(t.defined(C)){var b=1/(x=o.Matrix4.multiplyByVector(C,x,x)).w;i.Cartesian3.multiplyByScalar(x,b,x),i.Cartesian3.subtract(x,e,x),i.Cartesian3.normalize(x,x);var E=i.Cartesian3.dot(c,x);i.Cartesian3.multiplyByScalar(x,J[y]/E,x),i.Cartesian3.add(x,e,x)}else{t.defined(n._offCenterFrustum)&&(n=n._offCenterFrustum);var M=J[y],D=J[y+1];x.x=.5*(x.x*(n.right-n.left)+n.left+n.right),x.y=.5*(x.y*(n.top-n.bottom)+n.bottom+n.top),x.z=.5*(x.z*(M-D)-M-D),x.w=1,o.Matrix4.multiplyByVector(m,x,x)}s[12*y+3*g]=x.x,s[12*y+3*g+1]=x.y,s[12*y+3*g+2]=x.z}},q.createGeometry=function(e){var r=e._frustumType,a=e._frustum,o=e._origin,h=e._orientation,p=e._drawNearPlane,l=e._vertexFormat,c=p?6:5,m=new Float64Array(72);q._computeNearFarPlanes(o,h,r,a,m);var C=24;m[C]=m[12],m[C+1]=m[13],m[C+2]=m[14],m[C+3]=m[0],m[C+4]=m[1],m[C+5]=m[2],m[C+6]=m[9],m[C+7]=m[10],m[C+8]=m[11],m[C+9]=m[21],m[C+10]=m[22],m[C+11]=m[23],m[C+=12]=m[15],m[C+1]=m[16],m[C+2]=m[17],m[C+3]=m[3],m[C+4]=m[4],m[C+5]=m[5],m[C+6]=m[0],m[C+7]=m[1],m[C+8]=m[2],m[C+9]=m[12],m[C+10]=m[13],m[C+11]=m[14],m[C+=12]=m[3],m[C+1]=m[4],m[C+2]=m[5],m[C+3]=m[15],m[C+4]=m[16],m[C+5]=m[17],m[C+6]=m[18],m[C+7]=m[19],m[C+8]=m[20],m[C+9]=m[6],m[C+10]=m[7],m[C+11]=m[8],m[C+=12]=m[6],m[C+1]=m[7],m[C+2]=m[8],m[C+3]=m[18],m[C+4]=m[19],m[C+5]=m[20],m[C+6]=m[21],m[C+7]=m[22],m[C+8]=m[23],m[C+9]=m[9],m[C+10]=m[10],m[C+11]=m[11],p||(m=m.subarray(12));var w=new d.GeometryAttributes({position:new f.GeometryAttribute({componentDatatype:s.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:m})});if(t.defined(l.normal)||t.defined(l.tangent)||t.defined(l.bitangent)||t.defined(l.st)){var v=t.defined(l.normal)?new Float32Array(12*c):void 0,_=t.defined(l.tangent)?new Float32Array(12*c):void 0,y=t.defined(l.bitangent)?new Float32Array(12*c):void 0,g=t.defined(l.st)?new Float32Array(8*c):void 0,x=U,b=Q,E=K,M=i.Cartesian3.negate(x,W),D=i.Cartesian3.negate(b,Y),V=i.Cartesian3.negate(E,H);C=0,p&&(L(C,v,_,y,g,V,x,b),C+=12),L(C,v,_,y,g,E,M,b),L(C+=12,v,_,y,g,M,V,b),L(C+=12,v,_,y,g,D,V,M),L(C+=12,v,_,y,g,x,E,b),L(C+=12,v,_,y,g,b,E,M),t.defined(v)&&(w.normal=new f.GeometryAttribute({componentDatatype:s.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:v})),t.defined(_)&&(w.tangent=new f.GeometryAttribute({componentDatatype:s.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:_})),t.defined(y)&&(w.bitangent=new f.GeometryAttribute({componentDatatype:s.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:y})),t.defined(g)&&(w.st=new f.GeometryAttribute({componentDatatype:s.ComponentDatatype.FLOAT,componentsPerAttribute:2,values:g}))}for(var F=new Uint16Array(6*c),O=0;O<c;++O){var z=6*O,R=4*O;F[z]=R,F[z+1]=R+1,F[z+2]=R+2,F[z+3]=R,F[z+4]=R+2,F[z+5]=R+3}return new f.Geometry({attributes:w,indices:F,primitiveType:u.PrimitiveType.TRIANGLES,boundingSphere:n.BoundingSphere.fromVertices(m)})},e.FrustumGeometry=q,e.OrthographicFrustum=E,e.PerspectiveFrustum=k}));
//# sourceMappingURL=FrustumGeometry-725b22f6.js.map
