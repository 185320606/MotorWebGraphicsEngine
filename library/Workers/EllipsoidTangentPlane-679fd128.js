define(["exports","./when-7ef6387a","./DeveloperError-101d8eb9","./Check-71521db1","./Cartesian3-ca5d3f12","./Ellipsoid-57478151","./Transforms-7a1c9ee7","./Matrix4-027dd006","./Cartesian2-d6edb867","./IntersectionTests-2926775d","./Plane-08adaa50"],(function(e,n,t,i,a,r,s,o,c,d,l){"use strict";function m(e,t,i){this.minimum=a.Cartesian3.clone(n.defaultValue(e,a.Cartesian3.ZERO)),this.maximum=a.Cartesian3.clone(n.defaultValue(t,a.Cartesian3.ZERO)),i=n.defined(i)?a.Cartesian3.clone(i):a.Cartesian3.midpoint(this.minimum,this.maximum,new a.Cartesian3),this.center=i}m.fromPoints=function(e,t){if(n.defined(t)||(t=new m),!n.defined(e)||0===e.length)return t.minimum=a.Cartesian3.clone(a.Cartesian3.ZERO,t.minimum),t.maximum=a.Cartesian3.clone(a.Cartesian3.ZERO,t.maximum),t.center=a.Cartesian3.clone(a.Cartesian3.ZERO,t.center),t;for(var i=e[0].x,r=e[0].y,s=e[0].z,o=e[0].x,c=e[0].y,d=e[0].z,l=e.length,u=1;u<l;u++){var f=e[u],h=f.x,C=f.y,p=f.z;i=Math.min(h,i),o=Math.max(h,o),r=Math.min(C,r),c=Math.max(C,c),s=Math.min(p,s),d=Math.max(p,d)}var x=t.minimum;x.x=i,x.y=r,x.z=s;var y=t.maximum;return y.x=o,y.y=c,y.z=d,t.center=a.Cartesian3.midpoint(x,y,t.center),t},m.clone=function(e,t){if(n.defined(e))return n.defined(t)?(t.minimum=a.Cartesian3.clone(e.minimum,t.minimum),t.maximum=a.Cartesian3.clone(e.maximum,t.maximum),t.center=a.Cartesian3.clone(e.center,t.center),t):new m(e.minimum,e.maximum,e.center)},m.equals=function(e,t){return e===t||n.defined(e)&&n.defined(t)&&a.Cartesian3.equals(e.center,t.center)&&a.Cartesian3.equals(e.minimum,t.minimum)&&a.Cartesian3.equals(e.maximum,t.maximum)};var u=new a.Cartesian3;m.intersectPlane=function(e,n){i.Check.defined("box",e),i.Check.defined("plane",n),u=a.Cartesian3.subtract(e.maximum,e.minimum,u);var t=a.Cartesian3.multiplyByScalar(u,.5,u),r=n.normal,o=t.x*Math.abs(r.x)+t.y*Math.abs(r.y)+t.z*Math.abs(r.z),c=a.Cartesian3.dot(e.center,r)+n.distance;return c-o>0?s.Intersect.INSIDE:c+o<0?s.Intersect.OUTSIDE:s.Intersect.INTERSECTING},m.prototype.clone=function(e){return m.clone(this,e)},m.prototype.intersectPlane=function(e){return m.intersectPlane(this,e)},m.prototype.equals=function(e){return m.equals(this,e)};var f=new o.Cartesian4;function h(e,c){if(i.Check.defined("origin",e),e=(c=n.defaultValue(c,r.Ellipsoid.WGS84)).scaleToGeodeticSurface(e),!n.defined(e))throw new t.DeveloperError("origin must not be at the center of the ellipsoid.");var d=s.Transforms.eastNorthUpToFixedFrame(e,c);this._ellipsoid=c,this._origin=e,this._xAxis=a.Cartesian3.fromCartesian4(o.Matrix4.getColumn(d,0,f)),this._yAxis=a.Cartesian3.fromCartesian4(o.Matrix4.getColumn(d,1,f));var m=a.Cartesian3.fromCartesian4(o.Matrix4.getColumn(d,2,f));this._plane=l.Plane.fromPointNormal(e,m)}Object.defineProperties(h.prototype,{ellipsoid:{get:function(){return this._ellipsoid}},origin:{get:function(){return this._origin}},plane:{get:function(){return this._plane}},xAxis:{get:function(){return this._xAxis}},yAxis:{get:function(){return this._yAxis}},zAxis:{get:function(){return this._plane.normal}}});var C=new m;h.fromPoints=function(e,n){return i.Check.defined("cartesians",e),new h(m.fromPoints(e,C).center,n)};var p=new d.Ray,x=new a.Cartesian3;h.prototype.projectPointOntoPlane=function(e,t){i.Check.defined("cartesian",e);var r=p;r.origin=e,a.Cartesian3.normalize(e,r.direction);var s=d.IntersectionTests.rayPlane(r,this._plane,x);if(n.defined(s)||(a.Cartesian3.negate(r.direction,r.direction),s=d.IntersectionTests.rayPlane(r,this._plane,x)),n.defined(s)){var o=a.Cartesian3.subtract(s,this._origin,s),l=a.Cartesian3.dot(this._xAxis,o),m=a.Cartesian3.dot(this._yAxis,o);return n.defined(t)?(t.x=l,t.y=m,t):new c.Cartesian2(l,m)}},h.prototype.projectPointsOntoPlane=function(e,t){i.Check.defined("cartesians",e),n.defined(t)||(t=[]);for(var a=0,r=e.length,s=0;s<r;s++){var o=this.projectPointOntoPlane(e[s],t[a]);n.defined(o)&&(t[a]=o,a++)}return t.length=a,t},h.prototype.projectPointToNearestOnPlane=function(e,t){i.Check.defined("cartesian",e),n.defined(t)||(t=new c.Cartesian2);var r=p;r.origin=e,a.Cartesian3.clone(this._plane.normal,r.direction);var s=d.IntersectionTests.rayPlane(r,this._plane,x);n.defined(s)||(a.Cartesian3.negate(r.direction,r.direction),s=d.IntersectionTests.rayPlane(r,this._plane,x));var o=a.Cartesian3.subtract(s,this._origin,s),l=a.Cartesian3.dot(this._xAxis,o),m=a.Cartesian3.dot(this._yAxis,o);return t.x=l,t.y=m,t},h.prototype.projectPointsToNearestOnPlane=function(e,t){i.Check.defined("cartesians",e),n.defined(t)||(t=[]);var a=e.length;t.length=a;for(var r=0;r<a;r++)t[r]=this.projectPointToNearestOnPlane(e[r],t[r]);return t};var y=new a.Cartesian3;h.prototype.projectPointOntoEllipsoid=function(e,t){i.Check.defined("cartesian",e),n.defined(t)||(t=new a.Cartesian3);var r=this._ellipsoid,s=this._origin,o=this._xAxis,c=this._yAxis,d=y;return a.Cartesian3.multiplyByScalar(o,e.x,d),t=a.Cartesian3.add(s,d,t),a.Cartesian3.multiplyByScalar(c,e.y,d),a.Cartesian3.add(t,d,t),r.scaleToGeocentricSurface(t,t),t},h.prototype.projectPointsOntoEllipsoid=function(e,t){i.Check.defined("cartesians",e);var a=e.length;n.defined(t)?t.length=a:t=new Array(a);for(var r=0;r<a;++r)t[r]=this.projectPointOntoEllipsoid(e[r],t[r]);return t},e.AxisAlignedBoundingBox=m,e.EllipsoidTangentPlane=h}));
//# sourceMappingURL=EllipsoidTangentPlane-679fd128.js.map
