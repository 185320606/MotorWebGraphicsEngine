!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Motor=t():e.Motor=t()}(window,(function(){return function(e){var t={};function i(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}return i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=350)}([function(e,t,i){"use strict";t.a=function(e){return null!=e}},function(e,t,i){"use strict";var n=i(5);function r(e,t){return null!=e?e:t}r.EMPTY_OBJECT=Object(n.a)({}),t.a=r},function(e,t,i){"use strict";var n=i(0);function r(e){var t;this.name="DeveloperError",this.message=e;try{throw new Error}catch(e){t=e.stack}this.stack=t}Object(n.a)(Object.create)&&(r.prototype=Object.create(Error.prototype),r.prototype.constructor=r),r.prototype.toString=function(){var e=this.name+": "+this.message;return Object(n.a)(this.stack)&&(e+="\n"+this.stack.toString()),e},r.throwInstantiationError=function(){throw new r("This function defines an interface and should not be called directly.")},t.a=r},function(e,t,i){"use strict";var n=i(0),r=i(2),a={};function o(e,t,i){return"Expected "+i+" to be typeof "+t+", actual typeof was "+e}a.typeOf={},a.defined=function(e,t){if(!Object(n.a)(t))throw new r.a(function(e){return e+" is required, actual value was undefined"}(e))},a.typeOf.func=function(e,t){if("function"!=typeof t)throw new r.a(o(typeof t,"function",e))},a.typeOf.string=function(e,t){if("string"!=typeof t)throw new r.a(o(typeof t,"string",e))},a.typeOf.number=function(e,t){if("number"!=typeof t)throw new r.a(o(typeof t,"number",e))},a.typeOf.number.lessThan=function(e,t,i){if(a.typeOf.number(e,t),t>=i)throw new r.a("Expected "+e+" to be less than "+i+", actual value was "+t)},a.typeOf.number.lessThanOrEquals=function(e,t,i){if(a.typeOf.number(e,t),t>i)throw new r.a("Expected "+e+" to be less than or equal to "+i+", actual value was "+t)},a.typeOf.number.greaterThan=function(e,t,i){if(a.typeOf.number(e,t),t<=i)throw new r.a("Expected "+e+" to be greater than "+i+", actual value was "+t)},a.typeOf.number.greaterThanOrEquals=function(e,t,i){if(a.typeOf.number(e,t),t<i)throw new r.a("Expected "+e+" to be greater than or equal to"+i+", actual value was "+t)},a.typeOf.object=function(e,t){if("object"!=typeof t)throw new r.a(o(typeof t,"object",e))},a.typeOf.bool=function(e,t){if("boolean"!=typeof t)throw new r.a(o(typeof t,"boolean",e))},a.typeOf.number.equals=function(e,t,i,n){if(a.typeOf.number(e,i),a.typeOf.number(t,n),i!==n)throw new r.a(e+" must be equal to "+t+", the actual values are "+i+" and "+n)},t.a=a},function(e,t,i){"use strict";var n=i(0),r=function(){try{return"x"in Object.defineProperty({},"x",{})}catch(e){return!1}}(),a=Object.defineProperties;r&&Object(n.a)(a)||(a=function(e){return e}),t.a=a},function(e,t,i){"use strict";var n=i(0),r=Object.freeze;Object(n.a)(r)||(r=function(e){return e}),t.a=r},function(e,t,i){"use strict";var n=i(3),r=i(0),a=i(4);function o(){this._listeners=[],this._scopes=[],this._toRemove=[],this._insideRaiseEvent=!1}function s(e,t){return t-e}Object(a.a)(o.prototype,{numberOfListeners:{get:function(){return this._listeners.length-this._toRemove.length}}}),o.prototype.addEventListener=function(e,t){n.a.typeOf.func("listener",e),this._listeners.push(e),this._scopes.push(t);var i=this;return function(){i.removeEventListener(e,t)}},o.prototype.removeEventListener=function(e,t){n.a.typeOf.func("listener",e);for(var i=this._listeners,r=this._scopes,a=-1,o=0;o<i.length;o++)if(i[o]===e&&r[o]===t){a=o;break}return-1!==a&&(this._insideRaiseEvent?(this._toRemove.push(a),i[a]=void 0,r[a]=void 0):(i.splice(a,1),r.splice(a,1)),!0)},o.prototype.raiseEvent=function(){var e;this._insideRaiseEvent=!0;var t=this._listeners,i=this._scopes,n=t.length;for(e=0;e<n;e++){var a=t[e];Object(r.a)(a)&&t[e].apply(i[e],arguments)}var o=this._toRemove;if((n=o.length)>0){for(o.sort(s),e=0;e<n;e++){var c=o[e];t.splice(c,1),i.splice(c,1)}o.length=0}this._insideRaiseEvent=!1},t.a=o},function(e,t,i){"use strict";var n=i(0);function r(e){var t;this.name="RuntimeError",this.message=e;try{throw new Error}catch(e){t=e.stack}this.stack=t}Object(n.a)(Object.create)&&(r.prototype=Object.create(Error.prototype),r.prototype.constructor=r),r.prototype.toString=function(){var e=this.name+": "+this.message;return Object(n.a)(this.stack)&&(e+="\n"+this.stack.toString()),e},t.a=r},function(e,t,i){"use strict";
/**
  @license
  when.js - https://github.com/cujojs/when

  MIT License (c) copyright B Cavalier & J Hann

 * A lightweight CommonJS Promises/A and when() implementation
 * when is part of the cujo.js family of libraries (http://cujojs.com/)
 *
 * Licensed under the MIT License at:
 * http://www.opensource.org/licenses/mit-license.php
 *
 * @version 1.7.1
 */var n,r,a;function o(e,t,i,n){return s(e).then(t,i,n)}function s(e){var t,i,n;return e instanceof c?t=e:h(e)?(i=u(),e.then((function(e){i.resolve(e)}),(function(e){i.reject(e)}),(function(e){i.progress(e)})),t=i.promise):(n=e,t=new c((function(e){try{return s(e?e(n):n)}catch(e){return l(e)}}))),t}function c(e){this.then=e}function l(e){return new c((function(t,i){try{return i?s(i(e)):l(e)}catch(e){return l(e)}}))}function u(){var e,t,i,n,r,o;return e=new c(h),t=[],i=[],n=function(e,n,r){var a,o;return a=u(),o="function"==typeof r?function(e){try{a.progress(r(e))}catch(e){a.progress(e)}}:function(e){a.progress(e)},t.push((function(t){t.then(e,n).then(a.resolve,a.reject,o)})),i.push(o),a.promise},r=function(e){return m(i,e),e},o=function(e){return e=s(e),n=e.then,o=s,r=g,m(t,e),i=t=a,e},{then:h,resolve:d,reject:f,progress:p,promise:e,resolver:{resolve:d,reject:f,progress:p}};function h(e,t,i){return n(e,t,i)}function d(e){return o(e)}function f(e){return o(l(e))}function p(e){return r(e)}}function h(e){return e&&"function"==typeof e.then}function d(e,t,i,n,r){return _(2,arguments),o(e,(function(e){var a,s,c,l,h,d,f,p,m,_;if(m=e.length>>>0,a=Math.max(0,Math.min(t,m)),c=[],s=m-a+1,l=[],h=u(),a)for(p=h.progress,f=function(e){l.push(e),--s||(d=f=g,h.reject(l))},d=function(e){c.push(e),--a||(d=f=g,h.resolve(c))},_=0;_<m;++_)_ in e&&o(e[_],b,v,p);else h.resolve(c);return h.then(i,n,r);function v(e){f(e)}function b(e){d(e)}}))}function f(e,t,i,n){return _(1,arguments),p(e,v).then(t,i,n)}function p(e,t){return o(e,(function(e){var i,n,r,a,s,c;if(r=n=e.length>>>0,i=[],c=u(),r)for(a=function(e,n){o(e,t).then((function(e){i[n]=e,--r||c.resolve(i)}),c.reject)},s=0;s<n;s++)s in e?a(e[s],s):--r;else c.resolve(i);return c.promise}))}function m(e,t){for(var i,n=0;i=e[n++];)i(t)}function _(e,t){for(var i,n=t.length;n>e;)if(null!=(i=t[--n])&&"function"!=typeof i)throw new Error("arg "+n+" must be a function")}function g(){}function v(e){return e}o.defer=u,o.resolve=s,o.reject=function(e){return o(e,l)},o.join=function(){return p(arguments,v)},o.all=f,o.map=p,o.reduce=function(e,t){var i=r.call(arguments,1);return o(e,(function(e){var r;return r=e.length,i[0]=function(e,i,n){return o(e,(function(e){return o(i,(function(i){return t(e,i,n,r)}))}))},n.apply(e,i)}))},o.any=function(e,t,i,n){return d(e,1,(function(e){return t?t(e[0]):e[0]}),i,n)},o.some=d,o.chain=function(e,t,i){var n=arguments.length>2;return o(e,(function(e){return e=n?i:e,t.resolve(e),e}),(function(e){return t.reject(e),l(e)}),t.progress)},o.isPromise=h,c.prototype={always:function(e,t){return this.then(e,e,t)},otherwise:function(e){return this.then(a,e)},yield:function(e){return this.then((function(){return e}))},spread:function(e){return this.then((function(t){return f(t,(function(t){return e.apply(a,t)}))}))}},r=[].slice,n=[].reduce||function(e){var t,i,n,r,a;if(a=0,r=(t=Object(this)).length>>>0,(i=arguments).length<=1)for(;;){if(a in t){n=t[a++];break}if(++a>=r)throw new TypeError}else n=i[1];for(;a<r;++a)a in t&&(n=e(n,t[a],a,t));return n},t.a=o},function(e,t,i){"use strict";(function(e){var n=i(18),r=i(8),a=i(79),o=i(3),s=i(11),c=i(10),l=i(1),u=i(0),h=i(4),d=i(19),f=i(2),p=i(5),m=i(51),_=i(105),g=i(80),v=i(81),b=i(82),y=i(83),w=i(84),O=i(85),x=i(43),E=i(25),T=i(66),C=i(47),S=i(17),A=i(7),P=i(106),I=function(){try{var e=new XMLHttpRequest;return e.open("GET","#",!0),e.responseType="blob","blob"===e.responseType}catch(e){return!1}}();function D(e,t,i,n){var r,a=e.query;if(!Object(u.a)(a)||0===a.length)return{};if(-1===a.indexOf("=")){var o={};o[a]=void 0,r=o}else r=Object(x.a)(a);t._queryParameters=i?R(r,t._queryParameters,n):r,e.query=void 0}function j(e,t){return Object(u.a)(e)?Object(u.a)(e.clone)?e.clone():Object(s.a)(e):t}function M(e){if(e.state===S.a.ISSUED||e.state===S.a.ACTIVE)throw new A.a("The Resource is already being fetched.");e.state=S.a.UNISSUED,e.deferred=void 0}function R(e,t,i){if(!i)return Object(c.a)(e,t);var n=Object(s.a)(e,!0);for(var r in t)if(t.hasOwnProperty(r)){var a=n[r],o=t[r];Object(u.a)(a)?(Array.isArray(a)||(a=n[r]=[a]),n[r]=a.concat(o)):n[r]=Array.isArray(o)?o.slice():o}return n}function L(e){"string"==typeof(e=Object(l.a)(e,l.a.EMPTY_OBJECT))&&(e={url:e}),o.a.typeOf.string("options.url",e.url),this._url=void 0,this._templateValues=j(e.templateValues,{}),this._queryParameters=j(e.queryParameters,{}),this.headers=j(e.headers,{}),this.request=Object(l.a)(e.request,new E.a),this.proxy=e.proxy,this.retryCallback=e.retryCallback,this.retryAttempts=Object(l.a)(e.retryAttempts,0),this._retryCount=0;var t=new n.a(e.url);D(t,this,!0,!0),t.fragment=void 0,this._url=t.toString()}function N(e){var t=e.request;t.url=e.url,t.requestFunction=function(){var t=e.url,i=!1;e.isDataUri||e.isBlobUri||(i=e.isCrossOriginUrl);var n=r.a.defer();return L._Implementations.createImage(t,i,n),n.promise};var i=C.a.request(t);if(Object(u.a)(i))return i.otherwise((function(i){return t.state!==S.a.FAILED?r.a.reject(i):e.retryOnError(i).then((function(n){return n?(t.state=S.a.UNISSUED,t.deferred=void 0,N(e)):r.a.reject(i)}))}))}L.createIfNeeded=function(e){return e instanceof L?e.getDerivedResource({request:e.request}):"string"!=typeof e?e:new L({url:e})},Object(h.a)(L,{isBlobSupported:{get:function(){return I}}}),Object(h.a)(L.prototype,{queryParameters:{get:function(){return this._queryParameters}},templateValues:{get:function(){return this._templateValues}},url:{get:function(){return this.getUrlComponent(!0,!0)},set:function(e){var t=new n.a(e);D(t,this,!1),t.fragment=void 0,this._url=t.toString()}},extension:{get:function(){return Object(g.a)(this._url)}},isDataUri:{get:function(){return Object(y.a)(this._url)}},isBlobUri:{get:function(){return Object(v.a)(this._url)}},isCrossOriginUrl:{get:function(){return Object(b.a)(this._url)}},hasHeaders:{get:function(){return Object.keys(this.headers).length>0}}}),L.prototype.getUrlComponent=function(e,t){if(this.isDataUri)return this._url;var i=new n.a(this._url);e&&function(e,t){var i=t._queryParameters,n=Object.keys(i);1!==n.length||Object(u.a)(i[n[0]])?e.query=Object(O.a)(i):e.query=n[0]}(i,this);var r=i.toString().replace(/%7B/g,"{").replace(/%7D/g,"}"),a=this._templateValues,o=Object.keys(a);if(o.length>0)for(var s=0;s<o.length;s++){var c=o[s],l=a[c];r=r.replace(new RegExp("{"+c+"}","g"),encodeURIComponent(l))}return t&&Object(u.a)(this.proxy)&&(r=this.proxy.getURL(r)),r},L.prototype.setQueryParameters=function(e,t){this._queryParameters=t?R(this._queryParameters,e,!1):R(e,this._queryParameters,!1)},L.prototype.addQueryParameters=function(e,t){return Object(d.a)("Resource.addQueryParameters","addQueryParameters has been deprecated and will be removed 1.45. Use setQueryParameters or appendQueryParameters instead."),this.setQueryParameters(e,t)},L.prototype.appendQueryParameters=function(e){this._queryParameters=R(e,this._queryParameters,!0)},L.prototype.setTemplateValues=function(e,t){this._templateValues=t?Object(c.a)(this._templateValues,e):Object(c.a)(e,this._templateValues)},L.prototype.addTemplateValues=function(e,t){return Object(d.a)("Resource.addTemplateValues","addTemplateValues has been deprecated and will be removed 1.45. Use setTemplateValues."),this.setTemplateValues(e,t)},L.prototype.getDerivedResource=function(e){var t=this.clone();if(t._retryCount=0,Object(u.a)(e.url)){var i=new n.a(e.url);D(i,t,!0,Object(l.a)(e.preserveQueryParameters,!1)),i.fragment=void 0,t._url=i.resolve(new n.a(Object(m.a)(this._url))).toString()}return Object(u.a)(e.queryParameters)&&(t._queryParameters=Object(c.a)(e.queryParameters,t._queryParameters)),Object(u.a)(e.templateValues)&&(t._templateValues=Object(c.a)(e.templateValues,t.templateValues)),Object(u.a)(e.headers)&&(t.headers=Object(c.a)(e.headers,t.headers)),Object(u.a)(e.proxy)&&(t.proxy=e.proxy),Object(u.a)(e.request)&&(t.request=e.request),Object(u.a)(e.retryCallback)&&(t.retryCallback=e.retryCallback),Object(u.a)(e.retryAttempts)&&(t.retryAttempts=e.retryAttempts),t},L.prototype.retryOnError=function(e){var t=this.retryCallback;if("function"!=typeof t||this._retryCount>=this.retryAttempts)return Object(r.a)(!1);var i=this;return Object(r.a)(t(this,e)).then((function(e){return++i._retryCount,e}))},L.prototype.clone=function(e){return Object(u.a)(e)||(e=new L({url:this._url})),e._url=this._url,e._queryParameters=Object(s.a)(this._queryParameters),e._templateValues=Object(s.a)(this._templateValues),e.headers=Object(s.a)(this.headers),e.proxy=this.proxy,e.retryCallback=this.retryCallback,e.retryAttempts=this.retryAttempts,e._retryCount=0,e.request=this.request.clone(),e},L.prototype.getBaseUri=function(e){return Object(_.a)(this.getUrlComponent(e),e)},L.prototype.appendForwardSlash=function(){this._url=Object(a.a)(this._url)},L.prototype.fetchArrayBuffer=function(){return this.fetch({responseType:"arraybuffer"})},L.fetchArrayBuffer=function(e){return new L(e).fetchArrayBuffer()},L.prototype.fetchBlob=function(){return this.fetch({responseType:"blob"})},L.fetchBlob=function(e){return new L(e).fetchBlob()},L.prototype.fetchImage=function(e){if(e=Object(l.a)(e,!1),M(this.request),!I||this.isDataUri||this.isBlobUri||!this.hasHeaders&&!e)return N(this);var t,i,n=this.fetchBlob();return Object(u.a)(n)?n.then((function(e){if(Object(u.a)(e)){i=e;var n=window.URL.createObjectURL(e);return N(t=new L({url:n}))}})).then((function(e){if(Object(u.a)(e))return window.URL.revokeObjectURL(t.url),e.blob=i,e})).otherwise((function(e){return Object(u.a)(t)&&window.URL.revokeObjectURL(t.url),r.a.reject(e)})):void 0},L.fetchImage=function(e){return new L(e).fetchImage(e.preferBlob)},L.prototype.fetchText=function(){return this.fetch({responseType:"text"})},L.fetchText=function(e){return new L(e).fetchText()},L.prototype.fetchJson=function(){var e=this.fetch({responseType:"text",headers:{Accept:"application/json,*/*;q=0.01"}});if(Object(u.a)(e))return e.then((function(e){if(Object(u.a)(e))return JSON.parse(e)}))},L.fetchJson=function(e){return new L(e).fetchJson()},L.prototype.fetchXML=function(){return this.fetch({responseType:"document",overrideMimeType:"text/xml"})},L.fetchXML=function(e){return new L(e).fetchXML()},L.prototype.fetchJsonp=function(e){var t;e=Object(l.a)(e,"callback"),M(this.request);do{t="loadJsonp"+Math.random().toString().substring(2,8)}while(Object(u.a)(window[t]));return function e(t,i,n){var a={};a[i]=n,t.setQueryParameters(a);var o=t.request;o.url=t.url,o.requestFunction=function(){var e=r.a.defer();return window[n]=function(t){e.resolve(t);try{delete window[n]}catch(e){window[n]=void 0}},L._Implementations.loadAndExecuteScript(t.url,n,e),e.promise};var s=C.a.request(o);if(!Object(u.a)(s))return;return s.otherwise((function(a){return o.state!==S.a.FAILED?r.a.reject(a):t.retryOnError(a).then((function(s){return s?(o.state=S.a.UNISSUED,o.deferred=void 0,e(t,i,n)):r.a.reject(a)}))}))}(this,e,t)},L.fetchJsonp=function(e){return new L(e).fetchJsonp(e.callbackParameterName)},L.prototype._makeRequest=function(e){var t=this;M(t.request);var i=t.request;i.url=t.url,i.requestFunction=function(){var n=e.responseType,a=Object(c.a)(e.headers,t.headers),o=e.overrideMimeType,s=e.method,l=e.data,h=r.a.defer(),d=L._Implementations.loadWithXhr(t.url,n,s,l,a,h,o);return Object(u.a)(d)&&Object(u.a)(d.abort)&&(i.cancelFunction=function(){d.abort()}),h.promise};var n=C.a.request(i);if(Object(u.a)(n))return n.then((function(e){return e})).otherwise((function(n){return i.state!==S.a.FAILED?r.a.reject(n):t.retryOnError(n).then((function(a){return a?(i.state=S.a.UNISSUED,i.deferred=void 0,t.fetch(e)):r.a.reject(n)}))}))};var F=/^data:(.*?)(;base64)?,(.*)$/;function k(e,t){var i=decodeURIComponent(t);return e?atob(i):i}function B(e,t){for(var i=k(e,t),n=new ArrayBuffer(i.length),r=new Uint8Array(n),a=0;a<i.length;a++)r[a]=i.charCodeAt(a);return n}function z(e,t){switch(t){case"text":return e.toString("utf8");case"json":return JSON.parse(e.toString("utf8"));default:return new Uint8Array(e).buffer}}L.prototype.fetch=function(e){return(e=j(e,{})).method="GET",this._makeRequest(e)},L.fetch=function(e){return new L(e).fetch({responseType:e.responseType,overrideMimeType:e.overrideMimeType})},L.prototype.delete=function(e){return(e=j(e,{})).method="DELETE",this._makeRequest(e)},L.delete=function(e){return new L(e).delete({responseType:e.responseType,overrideMimeType:e.overrideMimeType,data:e.data})},L.prototype.head=function(e){return(e=j(e,{})).method="HEAD",this._makeRequest(e)},L.head=function(e){return new L(e).head({responseType:e.responseType,overrideMimeType:e.overrideMimeType})},L.prototype.options=function(e){return(e=j(e,{})).method="OPTIONS",this._makeRequest(e)},L.options=function(e){return new L(e).options({responseType:e.responseType,overrideMimeType:e.overrideMimeType})},L.prototype.post=function(e,t){return o.a.defined("data",e),(t=j(t,{})).method="POST",t.data=e,this._makeRequest(t)},L.post=function(e){return new L(e).post(e.data,{responseType:e.responseType,overrideMimeType:e.overrideMimeType})},L.prototype.put=function(e,t){return o.a.defined("data",e),(t=j(t,{})).method="PUT",t.data=e,this._makeRequest(t)},L.put=function(e){return new L(e).put(e.data,{responseType:e.responseType,overrideMimeType:e.overrideMimeType})},L.prototype.patch=function(e,t){return o.a.defined("data",e),(t=j(t,{})).method="PATCH",t.data=e,this._makeRequest(t)},L.patch=function(e){return new L(e).patch(e.data,{responseType:e.responseType,overrideMimeType:e.overrideMimeType})},L._Implementations={},L._Implementations.createImage=function(e,t,i){var n=new Image;n.onload=function(){i.resolve(n)},n.onerror=function(e){i.reject(e)},t&&(P.a.contains(e)?n.crossOrigin="use-credentials":n.crossOrigin=""),n.src=e};var U="undefined"==typeof XMLHttpRequest;L._Implementations.loadWithXhr=function(t,n,r,a,o,s,c){var h=F.exec(t);if(null===h){if(!U){var d=new XMLHttpRequest;if(P.a.contains(t)&&(d.withCredentials=!0),d.open(r,t,!0),Object(u.a)(c)&&Object(u.a)(d.overrideMimeType)&&d.overrideMimeType(c),Object(u.a)(o))for(var p in o)o.hasOwnProperty(p)&&d.setRequestHeader(p,o[p]);Object(u.a)(n)&&(d.responseType=n);var m=!1;return"string"==typeof t&&(m=0===t.indexOf("file://")||"undefined"!=typeof window&&"file://"===window.location.origin),d.onload=function(){if(!(d.status<200||d.status>=300)||m&&0===d.status){var e=d.response,t=d.responseType;if("HEAD"===r||"OPTIONS"===r){var i=d.getAllResponseHeaders().trim().split(/[\r\n]+/),a={};return i.forEach((function(e){var t=e.split(": "),i=t.shift();a[i]=t.join(": ")})),void s.resolve(a)}if(204===d.status)s.resolve();else if(!Object(u.a)(e)||Object(u.a)(n)&&t!==n)if("json"===n&&"string"==typeof e)try{s.resolve(JSON.parse(e))}catch(e){s.reject(e)}else(""===t||"document"===t)&&Object(u.a)(d.responseXML)&&d.responseXML.hasChildNodes()?s.resolve(d.responseXML):""!==t&&"text"!==t||!Object(u.a)(d.responseText)?s.reject(new A.a("Invalid XMLHttpRequest response type.")):s.resolve(d.responseText);else s.resolve(e)}else s.reject(new T.a(d.status,d.response,d.getAllResponseHeaders()))},d.onerror=function(e){s.reject(new T.a)},d.send(a),d}!function(t,n,r,a,o,s,c){var l=i(123).parse(t),u="https:"===l.protocol?i(218):i(148),h=i(89),d={protocol:l.protocol,hostname:l.hostname,port:l.port,path:l.path,query:l.query,method:r,headers:o};u.request(d).on("response",(function(t){if(t.statusCode<200||t.statusCode>=300)s.reject(new T.a(t.statusCode,t,t.headers));else{var i=[];t.on("data",(function(e){i.push(e)})),t.on("end",(function(){var r=e.concat(i);"gzip"===t.headers["content-encoding"]?h.gunzip(r,(function(e,t){e?s.reject(new A.a("Error decompressing response.")):s.resolve(z(t,n))})):s.resolve(z(r,n))}))}})).on("error",(function(e){s.reject(new T.a)})).end()}(t,n,r,0,o,s)}else s.resolve(function(e,t){t=Object(l.a)(t,"");var i=e[1],n=!!e[2],r=e[3];switch(t){case"":case"text":return k(n,r);case"arraybuffer":return B(n,r);case"blob":var a=B(n,r);return new Blob([a],{type:i});case"document":return(new DOMParser).parseFromString(k(n,r),i);case"json":return JSON.parse(k(n,r));default:throw new f.a("Unhandled responseType: "+t)}}(h,n))},L._Implementations.loadAndExecuteScript=function(e,t,i){return Object(w.a)(e,t).otherwise(i.reject)},L._DefaultImplementations={},L._DefaultImplementations.createImage=L._Implementations.createImage,L._DefaultImplementations.loadWithXhr=L._Implementations.loadWithXhr,L._DefaultImplementations.loadAndExecuteScript=L._Implementations.loadAndExecuteScript,L.DEFAULT=Object(p.a)(new L({url:"undefined"==typeof document?"":document.location.href.split("?")[0]})),t.a=L}).call(this,i(15).Buffer)},function(e,t,i){"use strict";var n=i(1),r=i(0);t.a=function e(t,i,a){a=Object(n.a)(a,!1);var o,s,c,l={},u=Object(r.a)(t),h=Object(r.a)(i);if(u)for(o in t)t.hasOwnProperty(o)&&(s=t[o],h&&a&&"object"==typeof s&&i.hasOwnProperty(o)?(c=i[o],l[o]="object"==typeof c?e(s,c,a):s):l[o]=s);if(h)for(o in i)i.hasOwnProperty(o)&&!l.hasOwnProperty(o)&&(c=i[o],l[o]=c);return l}},function(e,t,i){"use strict";var n=i(1);t.a=function e(t,i){if(null===t||"object"!=typeof t)return t;i=Object(n.a)(i,!1);var r=new t.constructor;for(var a in t)if(t.hasOwnProperty(a)){var o=t[a];i&&(o=e(o,i)),r[a]=o}return r}},function(e,t,i){"use strict";var n=i(1),r=i(0),a=i(2),o={};function s(e,t){if(!Object(r.a)(e))throw new a.a("identifier is required.");Object(r.a)(o[e])||(o[e]=!0,console.warn(Object(n.a)(t,e)))}s.geometryOutlines="Entity geometry outlines are unsupported on terrain. Outlines will be disabled. To enable outlines, disable geometry terrain clamping by explicitly setting height to 0.",s.geometryZIndex="Entity geometry with zIndex are unsupported when height or extrudedHeight are defined.  zIndex will be ignored",s.geometryHeightReference="Entity corridor, ellipse, polygon or rectangle with heightReference must also have a defined height.  heightReference will be ignored",s.geometryExtrudedHeightReference="Entity corridor, ellipse, polygon or rectangle with extrudedHeightReference must also have a defined extrudedHeight.  extrudedHeightReference will be ignored",t.a=s},function(e,t,i){"use strict";var n=i(0),r=Array.isArray;Object(n.a)(r)||(r=function(e){return"[object Array]"===Object.prototype.toString.call(e)}),t.a=r},function(e,t,i){var n=i(16);n(n.S+n.F*!i(34),"Object",{defineProperty:i(33).f})},function(e,t,i){"use strict";(function(e){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <http://feross.org>
 * @license  MIT
 */
var n=i(210),r=i(211),a=i(147);function o(){return c.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function s(e,t){if(o()<t)throw new RangeError("Invalid typed array length");return c.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=c.prototype:(null===e&&(e=new c(t)),e.length=t),e}function c(e,t,i){if(!(c.TYPED_ARRAY_SUPPORT||this instanceof c))return new c(e,t,i);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return h(this,e)}return l(this,e,t,i)}function l(e,t,i,n){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,i,n){if(t.byteLength,i<0||t.byteLength<i)throw new RangeError("'offset' is out of bounds");if(t.byteLength<i+(n||0))throw new RangeError("'length' is out of bounds");t=void 0===i&&void 0===n?new Uint8Array(t):void 0===n?new Uint8Array(t,i):new Uint8Array(t,i,n);c.TYPED_ARRAY_SUPPORT?(e=t).__proto__=c.prototype:e=d(e,t);return e}(e,t,i,n):"string"==typeof t?function(e,t,i){"string"==typeof i&&""!==i||(i="utf8");if(!c.isEncoding(i))throw new TypeError('"encoding" must be a valid string encoding');var n=0|p(t,i),r=(e=s(e,n)).write(t,i);r!==n&&(e=e.slice(0,r));return e}(e,t,i):function(e,t){if(c.isBuffer(t)){var i=0|f(t.length);return 0===(e=s(e,i)).length?e:(t.copy(e,0,0,i),e)}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(n=t.length)!=n?s(e,0):d(e,t);if("Buffer"===t.type&&a(t.data))return d(e,t.data)}var n;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function u(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function h(e,t){if(u(t),e=s(e,t<0?0:0|f(t)),!c.TYPED_ARRAY_SUPPORT)for(var i=0;i<t;++i)e[i]=0;return e}function d(e,t){var i=t.length<0?0:0|f(t.length);e=s(e,i);for(var n=0;n<i;n+=1)e[n]=255&t[n];return e}function f(e){if(e>=o())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o().toString(16)+" bytes");return 0|e}function p(e,t){if(c.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var i=e.length;if(0===i)return 0;for(var n=!1;;)switch(t){case"ascii":case"latin1":case"binary":return i;case"utf8":case"utf-8":case void 0:return U(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*i;case"hex":return i>>>1;case"base64":return V(e).length;default:if(n)return U(e).length;t=(""+t).toLowerCase(),n=!0}}function m(e,t,i){var n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===i||i>this.length)&&(i=this.length),i<=0)return"";if((i>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return I(this,t,i);case"utf8":case"utf-8":return C(this,t,i);case"ascii":return A(this,t,i);case"latin1":case"binary":return P(this,t,i);case"base64":return T(this,t,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return D(this,t,i);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function _(e,t,i){var n=e[t];e[t]=e[i],e[i]=n}function g(e,t,i,n,r){if(0===e.length)return-1;if("string"==typeof i?(n=i,i=0):i>2147483647?i=2147483647:i<-2147483648&&(i=-2147483648),i=+i,isNaN(i)&&(i=r?0:e.length-1),i<0&&(i=e.length+i),i>=e.length){if(r)return-1;i=e.length-1}else if(i<0){if(!r)return-1;i=0}if("string"==typeof t&&(t=c.from(t,n)),c.isBuffer(t))return 0===t.length?-1:v(e,t,i,n,r);if("number"==typeof t)return t&=255,c.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?r?Uint8Array.prototype.indexOf.call(e,t,i):Uint8Array.prototype.lastIndexOf.call(e,t,i):v(e,[t],i,n,r);throw new TypeError("val must be string, number or Buffer")}function v(e,t,i,n,r){var a,o=1,s=e.length,c=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;o=2,s/=2,c/=2,i/=2}function l(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}if(r){var u=-1;for(a=i;a<s;a++)if(l(e,a)===l(t,-1===u?0:a-u)){if(-1===u&&(u=a),a-u+1===c)return u*o}else-1!==u&&(a-=a-u),u=-1}else for(i+c>s&&(i=s-c),a=i;a>=0;a--){for(var h=!0,d=0;d<c;d++)if(l(e,a+d)!==l(t,d)){h=!1;break}if(h)return a}return-1}function b(e,t,i,n){i=Number(i)||0;var r=e.length-i;n?(n=Number(n))>r&&(n=r):n=r;var a=t.length;if(a%2!=0)throw new TypeError("Invalid hex string");n>a/2&&(n=a/2);for(var o=0;o<n;++o){var s=parseInt(t.substr(2*o,2),16);if(isNaN(s))return o;e[i+o]=s}return o}function y(e,t,i,n){return H(U(t,e.length-i),e,i,n)}function w(e,t,i,n){return H(function(e){for(var t=[],i=0;i<e.length;++i)t.push(255&e.charCodeAt(i));return t}(t),e,i,n)}function O(e,t,i,n){return w(e,t,i,n)}function x(e,t,i,n){return H(V(t),e,i,n)}function E(e,t,i,n){return H(function(e,t){for(var i,n,r,a=[],o=0;o<e.length&&!((t-=2)<0);++o)i=e.charCodeAt(o),n=i>>8,r=i%256,a.push(r),a.push(n);return a}(t,e.length-i),e,i,n)}function T(e,t,i){return 0===t&&i===e.length?n.fromByteArray(e):n.fromByteArray(e.slice(t,i))}function C(e,t,i){i=Math.min(e.length,i);for(var n=[],r=t;r<i;){var a,o,s,c,l=e[r],u=null,h=l>239?4:l>223?3:l>191?2:1;if(r+h<=i)switch(h){case 1:l<128&&(u=l);break;case 2:128==(192&(a=e[r+1]))&&(c=(31&l)<<6|63&a)>127&&(u=c);break;case 3:a=e[r+1],o=e[r+2],128==(192&a)&&128==(192&o)&&(c=(15&l)<<12|(63&a)<<6|63&o)>2047&&(c<55296||c>57343)&&(u=c);break;case 4:a=e[r+1],o=e[r+2],s=e[r+3],128==(192&a)&&128==(192&o)&&128==(192&s)&&(c=(15&l)<<18|(63&a)<<12|(63&o)<<6|63&s)>65535&&c<1114112&&(u=c)}null===u?(u=65533,h=1):u>65535&&(u-=65536,n.push(u>>>10&1023|55296),u=56320|1023&u),n.push(u),r+=h}return function(e){var t=e.length;if(t<=S)return String.fromCharCode.apply(String,e);var i="",n=0;for(;n<t;)i+=String.fromCharCode.apply(String,e.slice(n,n+=S));return i}(n)}t.Buffer=c,t.SlowBuffer=function(e){+e!=e&&(e=0);return c.alloc(+e)},t.INSPECT_MAX_BYTES=50,c.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=o(),c.poolSize=8192,c._augment=function(e){return e.__proto__=c.prototype,e},c.from=function(e,t,i){return l(null,e,t,i)},c.TYPED_ARRAY_SUPPORT&&(c.prototype.__proto__=Uint8Array.prototype,c.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&c[Symbol.species]===c&&Object.defineProperty(c,Symbol.species,{value:null,configurable:!0})),c.alloc=function(e,t,i){return function(e,t,i,n){return u(t),t<=0?s(e,t):void 0!==i?"string"==typeof n?s(e,t).fill(i,n):s(e,t).fill(i):s(e,t)}(null,e,t,i)},c.allocUnsafe=function(e){return h(null,e)},c.allocUnsafeSlow=function(e){return h(null,e)},c.isBuffer=function(e){return!(null==e||!e._isBuffer)},c.compare=function(e,t){if(!c.isBuffer(e)||!c.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var i=e.length,n=t.length,r=0,a=Math.min(i,n);r<a;++r)if(e[r]!==t[r]){i=e[r],n=t[r];break}return i<n?-1:n<i?1:0},c.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(e,t){if(!a(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return c.alloc(0);var i;if(void 0===t)for(t=0,i=0;i<e.length;++i)t+=e[i].length;var n=c.allocUnsafe(t),r=0;for(i=0;i<e.length;++i){var o=e[i];if(!c.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(n,r),r+=o.length}return n},c.byteLength=p,c.prototype._isBuffer=!0,c.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)_(this,t,t+1);return this},c.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)_(this,t,t+3),_(this,t+1,t+2);return this},c.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)_(this,t,t+7),_(this,t+1,t+6),_(this,t+2,t+5),_(this,t+3,t+4);return this},c.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?C(this,0,e):m.apply(this,arguments)},c.prototype.equals=function(e){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===c.compare(this,e)},c.prototype.inspect=function(){var e="",i=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,i).match(/.{2}/g).join(" "),this.length>i&&(e+=" ... ")),"<Buffer "+e+">"},c.prototype.compare=function(e,t,i,n,r){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===i&&(i=e?e.length:0),void 0===n&&(n=0),void 0===r&&(r=this.length),t<0||i>e.length||n<0||r>this.length)throw new RangeError("out of range index");if(n>=r&&t>=i)return 0;if(n>=r)return-1;if(t>=i)return 1;if(this===e)return 0;for(var a=(r>>>=0)-(n>>>=0),o=(i>>>=0)-(t>>>=0),s=Math.min(a,o),l=this.slice(n,r),u=e.slice(t,i),h=0;h<s;++h)if(l[h]!==u[h]){a=l[h],o=u[h];break}return a<o?-1:o<a?1:0},c.prototype.includes=function(e,t,i){return-1!==this.indexOf(e,t,i)},c.prototype.indexOf=function(e,t,i){return g(this,e,t,i,!0)},c.prototype.lastIndexOf=function(e,t,i){return g(this,e,t,i,!1)},c.prototype.write=function(e,t,i,n){if(void 0===t)n="utf8",i=this.length,t=0;else if(void 0===i&&"string"==typeof t)n=t,i=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(i)?(i|=0,void 0===n&&(n="utf8")):(n=i,i=void 0)}var r=this.length-t;if((void 0===i||i>r)&&(i=r),e.length>0&&(i<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var a=!1;;)switch(n){case"hex":return b(this,e,t,i);case"utf8":case"utf-8":return y(this,e,t,i);case"ascii":return w(this,e,t,i);case"latin1":case"binary":return O(this,e,t,i);case"base64":return x(this,e,t,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return E(this,e,t,i);default:if(a)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),a=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var S=4096;function A(e,t,i){var n="";i=Math.min(e.length,i);for(var r=t;r<i;++r)n+=String.fromCharCode(127&e[r]);return n}function P(e,t,i){var n="";i=Math.min(e.length,i);for(var r=t;r<i;++r)n+=String.fromCharCode(e[r]);return n}function I(e,t,i){var n=e.length;(!t||t<0)&&(t=0),(!i||i<0||i>n)&&(i=n);for(var r="",a=t;a<i;++a)r+=z(e[a]);return r}function D(e,t,i){for(var n=e.slice(t,i),r="",a=0;a<n.length;a+=2)r+=String.fromCharCode(n[a]+256*n[a+1]);return r}function j(e,t,i){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>i)throw new RangeError("Trying to access beyond buffer length")}function M(e,t,i,n,r,a){if(!c.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>r||t<a)throw new RangeError('"value" argument is out of bounds');if(i+n>e.length)throw new RangeError("Index out of range")}function R(e,t,i,n){t<0&&(t=65535+t+1);for(var r=0,a=Math.min(e.length-i,2);r<a;++r)e[i+r]=(t&255<<8*(n?r:1-r))>>>8*(n?r:1-r)}function L(e,t,i,n){t<0&&(t=4294967295+t+1);for(var r=0,a=Math.min(e.length-i,4);r<a;++r)e[i+r]=t>>>8*(n?r:3-r)&255}function N(e,t,i,n,r,a){if(i+n>e.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("Index out of range")}function F(e,t,i,n,a){return a||N(e,0,i,4),r.write(e,t,i,n,23,4),i+4}function k(e,t,i,n,a){return a||N(e,0,i,8),r.write(e,t,i,n,52,8),i+8}c.prototype.slice=function(e,t){var i,n=this.length;if((e=~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),(t=void 0===t?n:~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e),c.TYPED_ARRAY_SUPPORT)(i=this.subarray(e,t)).__proto__=c.prototype;else{var r=t-e;i=new c(r,void 0);for(var a=0;a<r;++a)i[a]=this[a+e]}return i},c.prototype.readUIntLE=function(e,t,i){e|=0,t|=0,i||j(e,t,this.length);for(var n=this[e],r=1,a=0;++a<t&&(r*=256);)n+=this[e+a]*r;return n},c.prototype.readUIntBE=function(e,t,i){e|=0,t|=0,i||j(e,t,this.length);for(var n=this[e+--t],r=1;t>0&&(r*=256);)n+=this[e+--t]*r;return n},c.prototype.readUInt8=function(e,t){return t||j(e,1,this.length),this[e]},c.prototype.readUInt16LE=function(e,t){return t||j(e,2,this.length),this[e]|this[e+1]<<8},c.prototype.readUInt16BE=function(e,t){return t||j(e,2,this.length),this[e]<<8|this[e+1]},c.prototype.readUInt32LE=function(e,t){return t||j(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},c.prototype.readUInt32BE=function(e,t){return t||j(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},c.prototype.readIntLE=function(e,t,i){e|=0,t|=0,i||j(e,t,this.length);for(var n=this[e],r=1,a=0;++a<t&&(r*=256);)n+=this[e+a]*r;return n>=(r*=128)&&(n-=Math.pow(2,8*t)),n},c.prototype.readIntBE=function(e,t,i){e|=0,t|=0,i||j(e,t,this.length);for(var n=t,r=1,a=this[e+--n];n>0&&(r*=256);)a+=this[e+--n]*r;return a>=(r*=128)&&(a-=Math.pow(2,8*t)),a},c.prototype.readInt8=function(e,t){return t||j(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},c.prototype.readInt16LE=function(e,t){t||j(e,2,this.length);var i=this[e]|this[e+1]<<8;return 32768&i?4294901760|i:i},c.prototype.readInt16BE=function(e,t){t||j(e,2,this.length);var i=this[e+1]|this[e]<<8;return 32768&i?4294901760|i:i},c.prototype.readInt32LE=function(e,t){return t||j(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},c.prototype.readInt32BE=function(e,t){return t||j(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},c.prototype.readFloatLE=function(e,t){return t||j(e,4,this.length),r.read(this,e,!0,23,4)},c.prototype.readFloatBE=function(e,t){return t||j(e,4,this.length),r.read(this,e,!1,23,4)},c.prototype.readDoubleLE=function(e,t){return t||j(e,8,this.length),r.read(this,e,!0,52,8)},c.prototype.readDoubleBE=function(e,t){return t||j(e,8,this.length),r.read(this,e,!1,52,8)},c.prototype.writeUIntLE=function(e,t,i,n){(e=+e,t|=0,i|=0,n)||M(this,e,t,i,Math.pow(2,8*i)-1,0);var r=1,a=0;for(this[t]=255&e;++a<i&&(r*=256);)this[t+a]=e/r&255;return t+i},c.prototype.writeUIntBE=function(e,t,i,n){(e=+e,t|=0,i|=0,n)||M(this,e,t,i,Math.pow(2,8*i)-1,0);var r=i-1,a=1;for(this[t+r]=255&e;--r>=0&&(a*=256);)this[t+r]=e/a&255;return t+i},c.prototype.writeUInt8=function(e,t,i){return e=+e,t|=0,i||M(this,e,t,1,255,0),c.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},c.prototype.writeUInt16LE=function(e,t,i){return e=+e,t|=0,i||M(this,e,t,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):R(this,e,t,!0),t+2},c.prototype.writeUInt16BE=function(e,t,i){return e=+e,t|=0,i||M(this,e,t,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):R(this,e,t,!1),t+2},c.prototype.writeUInt32LE=function(e,t,i){return e=+e,t|=0,i||M(this,e,t,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):L(this,e,t,!0),t+4},c.prototype.writeUInt32BE=function(e,t,i){return e=+e,t|=0,i||M(this,e,t,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):L(this,e,t,!1),t+4},c.prototype.writeIntLE=function(e,t,i,n){if(e=+e,t|=0,!n){var r=Math.pow(2,8*i-1);M(this,e,t,i,r-1,-r)}var a=0,o=1,s=0;for(this[t]=255&e;++a<i&&(o*=256);)e<0&&0===s&&0!==this[t+a-1]&&(s=1),this[t+a]=(e/o>>0)-s&255;return t+i},c.prototype.writeIntBE=function(e,t,i,n){if(e=+e,t|=0,!n){var r=Math.pow(2,8*i-1);M(this,e,t,i,r-1,-r)}var a=i-1,o=1,s=0;for(this[t+a]=255&e;--a>=0&&(o*=256);)e<0&&0===s&&0!==this[t+a+1]&&(s=1),this[t+a]=(e/o>>0)-s&255;return t+i},c.prototype.writeInt8=function(e,t,i){return e=+e,t|=0,i||M(this,e,t,1,127,-128),c.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},c.prototype.writeInt16LE=function(e,t,i){return e=+e,t|=0,i||M(this,e,t,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):R(this,e,t,!0),t+2},c.prototype.writeInt16BE=function(e,t,i){return e=+e,t|=0,i||M(this,e,t,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):R(this,e,t,!1),t+2},c.prototype.writeInt32LE=function(e,t,i){return e=+e,t|=0,i||M(this,e,t,4,2147483647,-2147483648),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):L(this,e,t,!0),t+4},c.prototype.writeInt32BE=function(e,t,i){return e=+e,t|=0,i||M(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):L(this,e,t,!1),t+4},c.prototype.writeFloatLE=function(e,t,i){return F(this,e,t,!0,i)},c.prototype.writeFloatBE=function(e,t,i){return F(this,e,t,!1,i)},c.prototype.writeDoubleLE=function(e,t,i){return k(this,e,t,!0,i)},c.prototype.writeDoubleBE=function(e,t,i){return k(this,e,t,!1,i)},c.prototype.copy=function(e,t,i,n){if(i||(i=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<i&&(n=i),n===i)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(i<0||i>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-i&&(n=e.length-t+i);var r,a=n-i;if(this===e&&i<t&&t<n)for(r=a-1;r>=0;--r)e[r+t]=this[r+i];else if(a<1e3||!c.TYPED_ARRAY_SUPPORT)for(r=0;r<a;++r)e[r+t]=this[r+i];else Uint8Array.prototype.set.call(e,this.subarray(i,i+a),t);return a},c.prototype.fill=function(e,t,i,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,i=this.length):"string"==typeof i&&(n=i,i=this.length),1===e.length){var r=e.charCodeAt(0);r<256&&(e=r)}if(void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!c.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<i)throw new RangeError("Out of range index");if(i<=t)return this;var a;if(t>>>=0,i=void 0===i?this.length:i>>>0,e||(e=0),"number"==typeof e)for(a=t;a<i;++a)this[a]=e;else{var o=c.isBuffer(e)?e:U(new c(e,n).toString()),s=o.length;for(a=0;a<i-t;++a)this[a+t]=o[a%s]}return this};var B=/[^+\/0-9A-Za-z-_]/g;function z(e){return e<16?"0"+e.toString(16):e.toString(16)}function U(e,t){var i;t=t||1/0;for(var n=e.length,r=null,a=[],o=0;o<n;++o){if((i=e.charCodeAt(o))>55295&&i<57344){if(!r){if(i>56319){(t-=3)>-1&&a.push(239,191,189);continue}if(o+1===n){(t-=3)>-1&&a.push(239,191,189);continue}r=i;continue}if(i<56320){(t-=3)>-1&&a.push(239,191,189),r=i;continue}i=65536+(r-55296<<10|i-56320)}else r&&(t-=3)>-1&&a.push(239,191,189);if(r=null,i<128){if((t-=1)<0)break;a.push(i)}else if(i<2048){if((t-=2)<0)break;a.push(i>>6|192,63&i|128)}else if(i<65536){if((t-=3)<0)break;a.push(i>>12|224,i>>6&63|128,63&i|128)}else{if(!(i<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;a.push(i>>18|240,i>>12&63|128,i>>6&63|128,63&i|128)}}return a}function V(e){return n.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(B,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function H(e,t,i,n){for(var r=0;r<n&&!(r+i>=t.length||r>=e.length);++r)t[r+i]=e[r];return r}}).call(this,i(40))},function(e,t,i){var n=i(26),r=i(62),a=i(44),o=i(45),s=i(53),c=function(e,t,i){var l,u,h,d,f=e&c.F,p=e&c.G,m=e&c.S,_=e&c.P,g=e&c.B,v=p?n:m?n[t]||(n[t]={}):(n[t]||{}).prototype,b=p?r:r[t]||(r[t]={}),y=b.prototype||(b.prototype={});for(l in p&&(i=t),i)h=((u=!f&&v&&void 0!==v[l])?v:i)[l],d=g&&u?s(h,n):_&&"function"==typeof h?s(Function.call,h):h,v&&o(v,l,h,e&c.U),b[l]!=h&&a(b,l,d),_&&y[l]!=h&&(y[l]=h)};n.core=r,c.F=1,c.G=2,c.S=4,c.P=8,c.B=16,c.W=32,c.U=64,c.R=128,e.exports=c},function(e,t,i){"use strict";var n=i(5);t.a=Object(n.a)({UNISSUED:0,ISSUED:1,ACTIVE:2,RECEIVED:3,CANCELLED:4,FAILED:5})},function(e,t,i){"use strict";
/**
 * @license
 *
 * Grauw URI utilities
 *
 * See: http://hg.grauw.nl/grauw-lib/file/tip/src/uri.js
 *
 * @author Laurens Holst (http://www.grauw.nl/)
 *
 *   Copyright 2012 Laurens Holst
 *
 *   Licensed under the Apache License, Version 2.0 (the "License");
 *   you may not use this file except in compliance with the License.
 *   You may obtain a copy of the License at
 *
 *       http://www.apache.org/licenses/LICENSE-2.0
 *
 *   Unless required by applicable law or agreed to in writing, software
 *   distributed under the License is distributed on an "AS IS" BASIS,
 *   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 *   See the License for the specific language governing permissions and
 *   limitations under the License.
 *
 */function n(e){if(e instanceof n)this.scheme=e.scheme,this.authority=e.authority,this.path=e.path,this.query=e.query,this.fragment=e.fragment;else if(e){var t=r.exec(e);this.scheme=t[1],this.authority=t[2],this.path=t[3],this.query=t[4],this.fragment=t[5]}}n.prototype.scheme=null,n.prototype.authority=null,n.prototype.path="",n.prototype.query=null,n.prototype.fragment=null;var r=new RegExp("^(?:([^:/?#]+):)?(?://([^/?#]*))?([^?#]*)(?:\\?([^#]*))?(?:#(.*))?$");n.prototype.getScheme=function(){return this.scheme},n.prototype.getAuthority=function(){return this.authority},n.prototype.getPath=function(){return this.path},n.prototype.getQuery=function(){return this.query},n.prototype.getFragment=function(){return this.fragment},n.prototype.isAbsolute=function(){return!!this.scheme&&!this.fragment},n.prototype.isSameDocumentAs=function(e){return e.scheme==this.scheme&&e.authority==this.authority&&e.path==this.path&&e.query==this.query},n.prototype.equals=function(e){return this.isSameDocumentAs(e)&&e.fragment==this.fragment},n.prototype.normalize=function(){this.removeDotSegments(),this.scheme&&(this.scheme=this.scheme.toLowerCase()),this.authority&&(this.authority=this.authority.replace(s,l).replace(a,c)),this.path&&(this.path=this.path.replace(a,c)),this.query&&(this.query=this.query.replace(a,c)),this.fragment&&(this.fragment=this.fragment.replace(a,c))};var a=/%[0-9a-z]{2}/gi,o=/[a-zA-Z0-9\-\._~]/,s=/(.*@)?([^@:]*)(:.*)?/;function c(e){var t=unescape(e);return o.test(t)?t:e.toUpperCase()}function l(e,t,i,n){return(t||"")+i.toLowerCase()+(n||"")}n.prototype.resolve=function(e){var t=new n;return this.scheme?(t.scheme=this.scheme,t.authority=this.authority,t.path=this.path,t.query=this.query):(t.scheme=e.scheme,this.authority?(t.authority=this.authority,t.path=this.path,t.query=this.query):(t.authority=e.authority,""==this.path?(t.path=e.path,t.query=this.query||e.query):("/"==this.path.charAt(0)?(t.path=this.path,t.removeDotSegments()):(e.authority&&""==e.path?t.path="/"+this.path:t.path=e.path.substring(0,e.path.lastIndexOf("/")+1)+this.path,t.removeDotSegments()),t.query=this.query))),t.fragment=this.fragment,t},n.prototype.removeDotSegments=function(){var e,t=this.path.split("/"),i=[],n=""==t[0];n&&t.shift();for(""==t[0]&&t.shift();t.length;)".."==(e=t.shift())?i.pop():"."!=e&&i.push(e);"."!=e&&".."!=e||i.push(""),n&&i.unshift(""),this.path=i.join("/")},n.prototype.toString=function(){var e="";return this.scheme&&(e+=this.scheme+":"),this.authority&&(e+="//"+this.authority),e+=this.path,this.query&&(e+="?"+this.query),this.fragment&&(e+="#"+this.fragment),e},t.a=n},function(e,t,i){"use strict";var n=i(0),r=i(2),a=i(12);t.a=function(e,t){if(!Object(n.a)(e)||!Object(n.a)(t))throw new r.a("identifier and message are required.");Object(a.a)(e,t)}},function(e,t,i){i(167)("asyncIterator")},function(e,t,i){"use strict";var n=i(26),r=i(49),a=i(34),o=i(16),s=i(45),c=i(117).KEY,l=i(35),u=i(110),h=i(75),d=i(64),f=i(24),p=i(168),m=i(167),_=i(251),g=i(136),v=i(32),b=i(31),y=i(48),w=i(57),O=i(91),x=i(65),E=i(94),T=i(252),C=i(71),S=i(135),A=i(33),P=i(93),I=C.f,D=A.f,j=T.f,M=n.Symbol,R=n.JSON,L=R&&R.stringify,N=f("_hidden"),F=f("toPrimitive"),k={}.propertyIsEnumerable,B=u("symbol-registry"),z=u("symbols"),U=u("op-symbols"),V=Object.prototype,H="function"==typeof M&&!!S.f,G=n.QObject,q=!G||!G.prototype||!G.prototype.findChild,W=a&&l((function(){return 7!=E(D({},"a",{get:function(){return D(this,"a",{value:7}).a}})).a}))?function(e,t,i){var n=I(V,t);n&&delete V[t],D(e,t,i),n&&e!==V&&D(V,t,n)}:D,Y=function(e){var t=z[e]=E(M.prototype);return t._k=e,t},X=H&&"symbol"==typeof M.iterator?function(e){return"symbol"==typeof e}:function(e){return e instanceof M},Z=function(e,t,i){return e===V&&Z(U,t,i),v(e),t=O(t,!0),v(i),r(z,t)?(i.enumerable?(r(e,N)&&e[N][t]&&(e[N][t]=!1),i=E(i,{enumerable:x(0,!1)})):(r(e,N)||D(e,N,x(1,{})),e[N][t]=!0),W(e,t,i)):D(e,t,i)},Q=function(e,t){v(e);for(var i,n=_(t=w(t)),r=0,a=n.length;a>r;)Z(e,i=n[r++],t[i]);return e},K=function(e){var t=k.call(this,e=O(e,!0));return!(this===V&&r(z,e)&&!r(U,e))&&(!(t||!r(this,e)||!r(z,e)||r(this,N)&&this[N][e])||t)},J=function(e,t){if(e=w(e),t=O(t,!0),e!==V||!r(z,t)||r(U,t)){var i=I(e,t);return!i||!r(z,t)||r(e,N)&&e[N][t]||(i.enumerable=!0),i}},$=function(e){for(var t,i=j(w(e)),n=[],a=0;i.length>a;)r(z,t=i[a++])||t==N||t==c||n.push(t);return n},ee=function(e){for(var t,i=e===V,n=j(i?U:w(e)),a=[],o=0;n.length>o;)!r(z,t=n[o++])||i&&!r(V,t)||a.push(z[t]);return a};H||(s((M=function(){if(this instanceof M)throw TypeError("Symbol is not a constructor!");var e=d(arguments.length>0?arguments[0]:void 0),t=function(i){this===V&&t.call(U,i),r(this,N)&&r(this[N],e)&&(this[N][e]=!1),W(this,e,x(1,i))};return a&&q&&W(V,e,{configurable:!0,set:t}),Y(e)}).prototype,"toString",(function(){return this._k})),C.f=J,A.f=Z,i(72).f=T.f=$,i(131).f=K,S.f=ee,a&&!i(63)&&s(V,"propertyIsEnumerable",K,!0),p.f=function(e){return Y(f(e))}),o(o.G+o.W+o.F*!H,{Symbol:M});for(var te="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),ie=0;te.length>ie;)f(te[ie++]);for(var ne=P(f.store),re=0;ne.length>re;)m(ne[re++]);o(o.S+o.F*!H,"Symbol",{for:function(e){return r(B,e+="")?B[e]:B[e]=M(e)},keyFor:function(e){if(!X(e))throw TypeError(e+" is not a symbol!");for(var t in B)if(B[t]===e)return t},useSetter:function(){q=!0},useSimple:function(){q=!1}}),o(o.S+o.F*!H,"Object",{create:function(e,t){return void 0===t?E(e):Q(E(e),t)},defineProperty:Z,defineProperties:Q,getOwnPropertyDescriptor:J,getOwnPropertyNames:$,getOwnPropertySymbols:ee});var ae=l((function(){S.f(1)}));o(o.S+o.F*ae,"Object",{getOwnPropertySymbols:function(e){return S.f(y(e))}}),R&&o(o.S+o.F*(!H||l((function(){var e=M();return"[null]"!=L([e])||"{}"!=L({a:e})||"{}"!=L(Object(e))}))),"JSON",{stringify:function(e){for(var t,i,n=[e],r=1;arguments.length>r;)n.push(arguments[r++]);if(i=t=n[1],(b(t)||void 0!==e)&&!X(e))return g(t)||(t=function(e,t){if("function"==typeof i&&(t=i.call(this,e,t)),!X(t))return t}),n[1]=t,L.apply(R,n)}}),M.prototype[F]||i(44)(M.prototype,F,M.prototype.valueOf),h(M,"Symbol"),h(Math,"Math",!0),h(n.JSON,"JSON",!0)},function(e,t,i){"use strict";var n=i(5);t.a=Object(n.a)({TERRAIN:0,IMAGERY:1,TILES3D:2,OTHER:3})},function(e,t){var i,n,r=e.exports={};function a(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function s(e){if(i===setTimeout)return setTimeout(e,0);if((i===a||!i)&&setTimeout)return i=setTimeout,setTimeout(e,0);try{return i(e,0)}catch(t){try{return i.call(null,e,0)}catch(t){return i.call(this,e,0)}}}!function(){try{i="function"==typeof setTimeout?setTimeout:a}catch(e){i=a}try{n="function"==typeof clearTimeout?clearTimeout:o}catch(e){n=o}}();var c,l=[],u=!1,h=-1;function d(){u&&c&&(u=!1,c.length?l=c.concat(l):h=-1,l.length&&f())}function f(){if(!u){var e=s(d);u=!0;for(var t=l.length;t;){for(c=l,l=[];++h<t;)c&&c[h].run();h=-1,t=l.length}c=null,u=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===o||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function m(){}r.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)t[i-1]=arguments[i];l.push(new p(e,t)),1!==l.length||u||s(f)},p.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=m,r.addListener=m,r.once=m,r.off=m,r.removeListener=m,r.removeAllListeners=m,r.emit=m,r.prependListener=m,r.prependOnceListener=m,r.listeners=function(e){return[]},r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},function(e,t,i){var n=i(110)("wks"),r=i(64),a=i(26).Symbol,o="function"==typeof a;(e.exports=function(e){return n[e]||(n[e]=o&&a[e]||(o?a:r)("Symbol."+e))}).store=n},function(e,t,i){"use strict";var n=i(1),r=i(0),a=i(17),o=i(22);function s(e){e=Object(n.a)(e,n.a.EMPTY_OBJECT);var t=Object(n.a)(e.throttleByServer,!1),i=t||Object(n.a)(e.throttle,!1);this.url=e.url,this.requestFunction=e.requestFunction,this.cancelFunction=e.cancelFunction,this.priorityFunction=e.priorityFunction,this.priority=Object(n.a)(e.priority,0),this.throttle=i,this.throttleByServer=t,this.type=Object(n.a)(e.type,o.a.OTHER),this.serverKey=void 0,this.state=a.a.UNISSUED,this.deferred=void 0,this.cancelled=!1}s.prototype.cancel=function(){this.cancelled=!0},s.prototype.clone=function(e){return Object(r.a)(e)?(e.url=this.url,e.requestFunction=this.requestFunction,e.cancelFunction=this.cancelFunction,e.priorityFunction=this.priorityFunction,e.priority=this.priority,e.throttle=this.throttle,e.throttleByServer=this.throttleByServer,e.type=this.type,e.serverKey=this.serverKey,e.state=this.RequestState.UNISSUED,e.deferred=void 0,e.cancelled=!1,e):new s(this)},t.a=s},function(e,t){var i=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=i)},function(e,t){e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var i=function(e,t){var i=e[1]||"",n=e[3];if(!n)return i;if(t&&"function"==typeof btoa){var r=(o=n,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(o))))+" */"),a=n.sources.map((function(e){return"/*# sourceURL="+n.sourceRoot+e+" */"}));return[i].concat(a).concat([r]).join("\n")}var o;return[i].join("\n")}(t,e);return t[2]?"@media "+t[2]+"{"+i+"}":i})).join("")},t.i=function(e,i){"string"==typeof e&&(e=[[null,e,""]]);for(var n={},r=0;r<this.length;r++){var a=this[r][0];"number"==typeof a&&(n[a]=!0)}for(r=0;r<e.length;r++){var o=e[r];"number"==typeof o[0]&&n[o[0]]||(i&&!o[2]?o[2]=i:i&&(o[2]="("+o[2]+") and ("+i+")"),t.push(o))}},t}},function(e,t,i){var n=i(16);n(n.S,"Object",{create:i(94)})},function(e,t,i){var n=i(16);n(n.S,"Object",{setPrototypeOf:i(164).set})},function(e,t){"function"==typeof Object.create?e.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,t){if(t){e.super_=t;var i=function(){};i.prototype=t.prototype,e.prototype=new i,e.prototype.constructor=e}}},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t,i){var n=i(31);e.exports=function(e){if(!n(e))throw TypeError(e+" is not an object!");return e}},function(e,t,i){var n=i(32),r=i(161),a=i(91),o=Object.defineProperty;t.f=i(34)?Object.defineProperty:function(e,t,i){if(n(e),t=a(t,!0),n(i),r)try{return o(e,t,i)}catch(e){}if("get"in i||"set"in i)throw TypeError("Accessors not supported!");return"value"in i&&(e[t]=i.value),e}},function(e,t,i){e.exports=!i(35)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t,i){"use strict";var n=i(16),r=i(98)(0),a=i(99)([].forEach,!0);n(n.P+n.F*!a,"Array",{forEach:function(e){return r(this,e,arguments[1])}})},function(e,t,i){"use strict";var n=i(90),r={};r[i(24)("toStringTag")]="z",r+""!="[object z]"&&i(45)(Object.prototype,"toString",(function(){return"[object "+n(this)+"]"}),!0)},function(e,t,i){(function(e){function i(e){return Object.prototype.toString.call(e)}t.isArray=function(e){return Array.isArray?Array.isArray(e):"[object Array]"===i(e)},t.isBoolean=function(e){return"boolean"==typeof e},t.isNull=function(e){return null===e},t.isNullOrUndefined=function(e){return null==e},t.isNumber=function(e){return"number"==typeof e},t.isString=function(e){return"string"==typeof e},t.isSymbol=function(e){return"symbol"==typeof e},t.isUndefined=function(e){return void 0===e},t.isRegExp=function(e){return"[object RegExp]"===i(e)},t.isObject=function(e){return"object"==typeof e&&null!==e},t.isDate=function(e){return"[object Date]"===i(e)},t.isError=function(e){return"[object Error]"===i(e)||e instanceof Error},t.isFunction=function(e){return"function"==typeof e},t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},t.isBuffer=e.isBuffer}).call(this,i(15).Buffer)},function(e,t,i){var n=i(31),r=i(117).onFreeze;i(172)("freeze",(function(e){return function(t){return e&&n(t)?e(r(t)):t}}))},function(e,t){var i;i=function(){return this}();try{i=i||new Function("return this")()}catch(e){"object"==typeof window&&(i=window)}e.exports=i},function(e,t,i){e.exports=r;var n=i(67).EventEmitter;function r(){n.call(this)}i(30)(r,n),r.Readable=i(88),r.Writable=i(231),r.Duplex=i(232),r.Transform=i(233),r.PassThrough=i(234),r.Stream=r,r.prototype.pipe=function(e,t){var i=this;function r(t){e.writable&&!1===e.write(t)&&i.pause&&i.pause()}function a(){i.readable&&i.resume&&i.resume()}i.on("data",r),e.on("drain",a),e._isStdio||t&&!1===t.end||(i.on("end",s),i.on("close",c));var o=!1;function s(){o||(o=!0,e.end())}function c(){o||(o=!0,"function"==typeof e.destroy&&e.destroy())}function l(e){if(u(),0===n.listenerCount(this,"error"))throw e}function u(){i.removeListener("data",r),e.removeListener("drain",a),i.removeListener("end",s),i.removeListener("close",c),i.removeListener("error",l),e.removeListener("error",l),i.removeListener("end",u),i.removeListener("close",u),e.removeListener("close",u)}return i.on("error",l),e.on("error",l),i.on("end",u),i.on("close",u),e.on("close",u),e.emit("pipe",i),e}},function(e,t,i){var n=i(56),r=Math.min;e.exports=function(e){return e>0?r(n(e),9007199254740991):0}},function(e,t,i){"use strict";var n=i(0),r=i(2),a=i(13);t.a=function(e){if(!Object(n.a)(e))throw new r.a("queryString is required.");var t={};if(""===e)return t;for(var i=e.replace(/\+/g,"%20").split(/[&;]/),o=0,s=i.length;o<s;++o){var c=i[o].split("="),l=decodeURIComponent(c[0]),u=c[1];u=Object(n.a)(u)?decodeURIComponent(u):"";var h=t[l];"string"==typeof h?t[l]=[h,u]:Object(a.a)(h)?h.push(u):t[l]=u}return t}},function(e,t,i){var n=i(33),r=i(65);e.exports=i(34)?function(e,t,i){return n.f(e,t,r(1,i))}:function(e,t,i){return e[t]=i,e}},function(e,t,i){var n=i(26),r=i(44),a=i(49),o=i(64)("src"),s=i(248),c=(""+s).split("toString");i(62).inspectSource=function(e){return s.call(e)},(e.exports=function(e,t,i,s){var l="function"==typeof i;l&&(a(i,"name")||r(i,"name",t)),e[t]!==i&&(l&&(a(i,o)||r(i,o,e[t]?""+e[t]:c.join(String(t)))),e===n?e[t]=i:s?e[t]?e[t]=i:r(e,t,i):(delete e[t],r(e,t,i)))})(Function.prototype,"toString",(function(){return"function"==typeof this&&this[o]||s.call(this)}))},function(e,t,i){var n=i(16);n(n.P,"Function",{bind:i(282)})},function(e,t,i){"use strict";var n=i(18),r=i(8),a=i(3),o=i(1),s=i(0),c=i(4),l=i(6),u=i(122),h=i(81),d=i(83),f=i(17);var p={numberOfAttemptedRequests:0,numberOfActiveRequests:0,numberOfCancelledRequests:0,numberOfCancelledActiveRequests:0,numberOfFailedRequests:0,numberOfActiveRequestsEver:0},m=20,_=new u.a({comparator:function(e,t){return e.priority-t.priority}});_.maximumLength=m,_.reserve(m);var g=[],v={},b="undefined"!=typeof document?new n.a(document.location.href):new n.a,y=new l.a;function w(){}function O(e){Object(s.a)(e.priorityFunction)&&(e.priority=e.priorityFunction())}function x(e){var t=Object(o.a)(w.requestsByServer[e],w.maximumRequestsPerServer);return v[e]<t}function E(e){return e.state===f.a.UNISSUED&&(e.state=f.a.ISSUED,e.deferred=r.a.defer()),e.deferred.promise}function T(e){var t=E(e);return e.state=f.a.ACTIVE,g.push(e),++p.numberOfActiveRequests,++p.numberOfActiveRequestsEver,++v[e.serverKey],e.requestFunction().then(function(e){return function(t){e.state!==f.a.CANCELLED&&(--p.numberOfActiveRequests,--v[e.serverKey],y.raiseEvent(),e.state=f.a.RECEIVED,e.deferred.resolve(t))}}(e)).otherwise(function(e){return function(t){e.state!==f.a.CANCELLED&&(++p.numberOfFailedRequests,--p.numberOfActiveRequests,--v[e.serverKey],y.raiseEvent(t),e.state=f.a.FAILED,e.deferred.reject(t))}}(e)),t}function C(e){var t=e.state===f.a.ACTIVE;e.state=f.a.CANCELLED,++p.numberOfCancelledRequests,e.deferred.reject(),t&&(--p.numberOfActiveRequests,--v[e.serverKey],++p.numberOfCancelledActiveRequests),Object(s.a)(e.cancelFunction)&&e.cancelFunction()}w.maximumRequests=50,w.maximumRequestsPerServer=6,w.requestsByServer={"api.cesium.com:443":18,"assets.cesium.com:443":18},w.throttleRequests=!0,w.debugShowStatistics=!1,w.requestCompletedEvent=y,Object(c.a)(w,{statistics:{get:function(){return p}},priorityHeapLength:{get:function(){return m},set:function(e){if(e<m)for(;_.length>e;){C(_.pop())}m=e,_.maximumLength=e,_.reserve(e)}}}),w.update=function(){var e,t,i=0,n=g.length;for(e=0;e<n;++e)(t=g[e]).cancelled&&C(t),t.state===f.a.ACTIVE?i>0&&(g[e-i]=t):++i;g.length-=i;var r=_.internalArray,a=_.length;for(e=0;e<a;++e)O(r[e]);_.resort();for(var o=Math.max(w.maximumRequests-g.length,0),s=0;s<o&&_.length>0;)(t=_.pop()).cancelled?C(t):!t.throttleByServer||x(t.serverKey)?(T(t),++s):C(t);!function(){if(!w.debugShowStatistics)return;p.numberOfAttemptedRequests>0&&console.log("Number of attempted requests: "+p.numberOfAttemptedRequests);p.numberOfActiveRequests>0&&console.log("Number of active requests: "+p.numberOfActiveRequests);p.numberOfCancelledRequests>0&&console.log("Number of cancelled requests: "+p.numberOfCancelledRequests);p.numberOfCancelledActiveRequests>0&&console.log("Number of cancelled active requests: "+p.numberOfCancelledActiveRequests);p.numberOfFailedRequests>0&&console.log("Number of failed requests: "+p.numberOfFailedRequests);p.numberOfAttemptedRequests=0,p.numberOfCancelledRequests=0,p.numberOfCancelledActiveRequests=0}()},w.getServerKey=function(e){a.a.typeOf.string("url",e);var t=new n.a(e).resolve(b);t.normalize();var i=t.authority;/:/.test(i)||(i=i+":"+("https"===t.scheme?"443":"80"));var r=v[i];return Object(s.a)(r)||(v[i]=0),i},w.request=function(e){if(a.a.typeOf.object("request",e),a.a.typeOf.string("request.url",e.url),a.a.typeOf.func("request.requestFunction",e.requestFunction),Object(d.a)(e.url)||Object(h.a)(e.url))return y.raiseEvent(),e.state=f.a.RECEIVED,e.requestFunction();if(++p.numberOfAttemptedRequests,Object(s.a)(e.serverKey)||(e.serverKey=w.getServerKey(e.url)),!w.throttleRequests||!e.throttle)return T(e);if(!(g.length>=w.maximumRequests)&&(!e.throttleByServer||x(e.serverKey))){O(e);var t=_.insert(e);if(Object(s.a)(t)){if(t===e)return;C(t)}return E(e)}},w.clearForSpecs=function(){for(;_.length>0;){C(_.pop())}for(var e=g.length,t=0;t<e;++t)C(g[t]);g.length=0,v={},p.numberOfAttemptedRequests=0,p.numberOfActiveRequests=0,p.numberOfCancelledRequests=0,p.numberOfCancelledActiveRequests=0,p.numberOfFailedRequests=0,p.numberOfActiveRequestsEver=0},w.numberOfActiveRequestsByServer=function(e){return v[e]},w.requestHeap=_,t.a=w},function(e,t,i){var n=i(69);e.exports=function(e){return Object(n(e))}},function(e,t){var i={}.hasOwnProperty;e.exports=function(e,t){return i.call(e,t)}},function(e,t,i){"use strict";var n,r,a,o,s=i(63),c=i(26),l=i(53),u=i(90),h=i(16),d=i(31),f=i(92),p=i(101),m=i(140),_=i(137),g=i(175).set,v=i(256)(),b=i(177),y=i(257),w=i(258),O=i(259),x=c.TypeError,E=c.process,T=E&&E.versions,C=T&&T.v8||"",S=c.Promise,A="process"==u(E),P=function(){},I=r=b.f,D=!!function(){try{var e=S.resolve(1),t=(e.constructor={})[i(24)("species")]=function(e){e(P,P)};return(A||"function"==typeof PromiseRejectionEvent)&&e.then(P)instanceof t&&0!==C.indexOf("6.6")&&-1===w.indexOf("Chrome/66")}catch(e){}}(),j=function(e){var t;return!(!d(e)||"function"!=typeof(t=e.then))&&t},M=function(e,t){if(!e._n){e._n=!0;var i=e._c;v((function(){for(var n=e._v,r=1==e._s,a=0,o=function(t){var i,a,o,s=r?t.ok:t.fail,c=t.resolve,l=t.reject,u=t.domain;try{s?(r||(2==e._h&&N(e),e._h=1),!0===s?i=n:(u&&u.enter(),i=s(n),u&&(u.exit(),o=!0)),i===t.promise?l(x("Promise-chain cycle")):(a=j(i))?a.call(i,c,l):c(i)):l(n)}catch(e){u&&!o&&u.exit(),l(e)}};i.length>a;)o(i[a++]);e._c=[],e._n=!1,t&&!e._h&&R(e)}))}},R=function(e){g.call(c,(function(){var t,i,n,r=e._v,a=L(e);if(a&&(t=y((function(){A?E.emit("unhandledRejection",r,e):(i=c.onunhandledrejection)?i({promise:e,reason:r}):(n=c.console)&&n.error&&n.error("Unhandled promise rejection",r)})),e._h=A||L(e)?2:1),e._a=void 0,a&&t.e)throw t.v}))},L=function(e){return 1!==e._h&&0===(e._a||e._c).length},N=function(e){g.call(c,(function(){var t;A?E.emit("rejectionHandled",e):(t=c.onrejectionhandled)&&t({promise:e,reason:e._v})}))},F=function(e){var t=this;t._d||(t._d=!0,(t=t._w||t)._v=e,t._s=2,t._a||(t._a=t._c.slice()),M(t,!0))},k=function(e){var t,i=this;if(!i._d){i._d=!0,i=i._w||i;try{if(i===e)throw x("Promise can't be resolved itself");(t=j(e))?v((function(){var n={_w:i,_d:!1};try{t.call(e,l(k,n,1),l(F,n,1))}catch(e){F.call(n,e)}})):(i._v=e,i._s=1,M(i,!1))}catch(e){F.call({_w:i,_d:!1},e)}}};D||(S=function(e){p(this,S,"Promise","_h"),f(e),n.call(this);try{e(l(k,this,1),l(F,this,1))}catch(e){F.call(this,e)}},(n=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=i(102)(S.prototype,{then:function(e,t){var i=I(_(this,S));return i.ok="function"!=typeof e||e,i.fail="function"==typeof t&&t,i.domain=A?E.domain:void 0,this._c.push(i),this._a&&this._a.push(i),this._s&&M(this,!1),i.promise},catch:function(e){return this.then(void 0,e)}}),a=function(){var e=new n;this.promise=e,this.resolve=l(k,e,1),this.reject=l(F,e,1)},b.f=I=function(e){return e===S||e===o?new a(e):r(e)}),h(h.G+h.W+h.F*!D,{Promise:S}),i(75)(S,"Promise"),i(114)("Promise"),o=i(62).Promise,h(h.S+h.F*!D,"Promise",{reject:function(e){var t=I(this);return(0,t.reject)(e),t.promise}}),h(h.S+h.F*(s||!D),"Promise",{resolve:function(e){return O(s&&this===o?S:this,e)}}),h(h.S+h.F*!(D&&i(120)((function(e){S.all(e).catch(P)}))),"Promise",{all:function(e){var t=this,i=I(t),n=i.resolve,r=i.reject,a=y((function(){var i=[],a=0,o=1;m(e,!1,(function(e){var s=a++,c=!1;i.push(void 0),o++,t.resolve(e).then((function(e){c||(c=!0,i[s]=e,--o||n(i))}),r)})),--o||n(i)}));return a.e&&r(a.v),i.promise},race:function(e){var t=this,i=I(t),n=i.reject,r=y((function(){m(e,!1,(function(e){t.resolve(e).then(i.resolve,n)}))}));return r.e&&n(r.v),i.promise}})},function(e,t,i){"use strict";var n=i(18),r=i(1),a=i(0),o=i(2);function s(e,t){var i;return"undefined"!=typeof document&&(i=document),s._implementation(e,t,i)}s._implementation=function(e,t,i){if(!Object(a.a)(e))throw new o.a("relative uri is required.");if(!Object(a.a)(t)){if(void 0===i)return e;t=Object(r.a)(i.baseURI,i.location.href)}var s=new n.a(t);return new n.a(e).resolve(s).toString()},t.a=s},function(e,t,i){(function(e){var n=Object.getOwnPropertyDescriptors||function(e){for(var t=Object.keys(e),i={},n=0;n<t.length;n++)i[t[n]]=Object.getOwnPropertyDescriptor(e,t[n]);return i},r=/%[sdj%]/g;t.format=function(e){if(!g(e)){for(var t=[],i=0;i<arguments.length;i++)t.push(s(arguments[i]));return t.join(" ")}i=1;for(var n=arguments,a=n.length,o=String(e).replace(r,(function(e){if("%%"===e)return"%";if(i>=a)return e;switch(e){case"%s":return String(n[i++]);case"%d":return Number(n[i++]);case"%j":try{return JSON.stringify(n[i++])}catch(e){return"[Circular]"}default:return e}})),c=n[i];i<a;c=n[++i])m(c)||!y(c)?o+=" "+c:o+=" "+s(c);return o},t.deprecate=function(i,n){if(void 0!==e&&!0===e.noDeprecation)return i;if(void 0===e)return function(){return t.deprecate(i,n).apply(this,arguments)};var r=!1;return function(){if(!r){if(e.throwDeprecation)throw new Error(n);e.traceDeprecation?console.trace(n):console.error(n),r=!0}return i.apply(this,arguments)}};var a,o={};function s(e,i){var n={seen:[],stylize:l};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),p(i)?n.showHidden=i:i&&t._extend(n,i),v(n.showHidden)&&(n.showHidden=!1),v(n.depth)&&(n.depth=2),v(n.colors)&&(n.colors=!1),v(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=c),u(n,e,n.depth)}function c(e,t){var i=s.styles[t];return i?"["+s.colors[i][0]+"m"+e+"["+s.colors[i][1]+"m":e}function l(e,t){return e}function u(e,i,n){if(e.customInspect&&i&&x(i.inspect)&&i.inspect!==t.inspect&&(!i.constructor||i.constructor.prototype!==i)){var r=i.inspect(n,e);return g(r)||(r=u(e,r,n)),r}var a=function(e,t){if(v(t))return e.stylize("undefined","undefined");if(g(t)){var i="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(i,"string")}if(_(t))return e.stylize(""+t,"number");if(p(t))return e.stylize(""+t,"boolean");if(m(t))return e.stylize("null","null")}(e,i);if(a)return a;var o=Object.keys(i),s=function(e){var t={};return e.forEach((function(e,i){t[e]=!0})),t}(o);if(e.showHidden&&(o=Object.getOwnPropertyNames(i)),O(i)&&(o.indexOf("message")>=0||o.indexOf("description")>=0))return h(i);if(0===o.length){if(x(i)){var c=i.name?": "+i.name:"";return e.stylize("[Function"+c+"]","special")}if(b(i))return e.stylize(RegExp.prototype.toString.call(i),"regexp");if(w(i))return e.stylize(Date.prototype.toString.call(i),"date");if(O(i))return h(i)}var l,y="",E=!1,T=["{","}"];(f(i)&&(E=!0,T=["[","]"]),x(i))&&(y=" [Function"+(i.name?": "+i.name:"")+"]");return b(i)&&(y=" "+RegExp.prototype.toString.call(i)),w(i)&&(y=" "+Date.prototype.toUTCString.call(i)),O(i)&&(y=" "+h(i)),0!==o.length||E&&0!=i.length?n<0?b(i)?e.stylize(RegExp.prototype.toString.call(i),"regexp"):e.stylize("[Object]","special"):(e.seen.push(i),l=E?function(e,t,i,n,r){for(var a=[],o=0,s=t.length;o<s;++o)A(t,String(o))?a.push(d(e,t,i,n,String(o),!0)):a.push("");return r.forEach((function(r){r.match(/^\d+$/)||a.push(d(e,t,i,n,r,!0))})),a}(e,i,n,s,o):o.map((function(t){return d(e,i,n,s,t,E)})),e.seen.pop(),function(e,t,i){if(e.reduce((function(e,t){return t.indexOf("\n")>=0&&0,e+t.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60)return i[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+i[1];return i[0]+t+" "+e.join(", ")+" "+i[1]}(l,y,T)):T[0]+y+T[1]}function h(e){return"["+Error.prototype.toString.call(e)+"]"}function d(e,t,i,n,r,a){var o,s,c;if((c=Object.getOwnPropertyDescriptor(t,r)||{value:t[r]}).get?s=c.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):c.set&&(s=e.stylize("[Setter]","special")),A(n,r)||(o="["+r+"]"),s||(e.seen.indexOf(c.value)<0?(s=m(i)?u(e,c.value,null):u(e,c.value,i-1)).indexOf("\n")>-1&&(s=a?s.split("\n").map((function(e){return"  "+e})).join("\n").substr(2):"\n"+s.split("\n").map((function(e){return"   "+e})).join("\n")):s=e.stylize("[Circular]","special")),v(o)){if(a&&r.match(/^\d+$/))return s;(o=JSON.stringify(""+r)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(o=o.substr(1,o.length-2),o=e.stylize(o,"name")):(o=o.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),o=e.stylize(o,"string"))}return o+": "+s}function f(e){return Array.isArray(e)}function p(e){return"boolean"==typeof e}function m(e){return null===e}function _(e){return"number"==typeof e}function g(e){return"string"==typeof e}function v(e){return void 0===e}function b(e){return y(e)&&"[object RegExp]"===E(e)}function y(e){return"object"==typeof e&&null!==e}function w(e){return y(e)&&"[object Date]"===E(e)}function O(e){return y(e)&&("[object Error]"===E(e)||e instanceof Error)}function x(e){return"function"==typeof e}function E(e){return Object.prototype.toString.call(e)}function T(e){return e<10?"0"+e.toString(10):e.toString(10)}t.debuglog=function(i){if(v(a)&&(a=e.env.NODE_DEBUG||""),i=i.toUpperCase(),!o[i])if(new RegExp("\\b"+i+"\\b","i").test(a)){var n=e.pid;o[i]=function(){var e=t.format.apply(t,arguments);console.error("%s %d: %s",i,n,e)}}else o[i]=function(){};return o[i]},t.inspect=s,s.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},s.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},t.isArray=f,t.isBoolean=p,t.isNull=m,t.isNullOrUndefined=function(e){return null==e},t.isNumber=_,t.isString=g,t.isSymbol=function(e){return"symbol"==typeof e},t.isUndefined=v,t.isRegExp=b,t.isObject=y,t.isDate=w,t.isError=O,t.isFunction=x,t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},t.isBuffer=i(237);var C=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function S(){var e=new Date,t=[T(e.getHours()),T(e.getMinutes()),T(e.getSeconds())].join(":");return[e.getDate(),C[e.getMonth()],t].join(" ")}function A(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.log=function(){console.log("%s - %s",S(),t.format.apply(t,arguments))},t.inherits=i(238),t._extend=function(e,t){if(!t||!y(t))return e;for(var i=Object.keys(t),n=i.length;n--;)e[i[n]]=t[i[n]];return e};var P="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function I(e,t){if(!e){var i=new Error("Promise was rejected with a falsy value");i.reason=e,e=i}return t(e)}t.promisify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');if(P&&e[P]){var t;if("function"!=typeof(t=e[P]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(t,P,{value:t,enumerable:!1,writable:!1,configurable:!0}),t}function t(){for(var t,i,n=new Promise((function(e,n){t=e,i=n})),r=[],a=0;a<arguments.length;a++)r.push(arguments[a]);r.push((function(e,n){e?i(e):t(n)}));try{e.apply(this,r)}catch(e){i(e)}return n}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),P&&Object.defineProperty(t,P,{value:t,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(t,n(e))},t.promisify.custom=P,t.callbackify=function(t){if("function"!=typeof t)throw new TypeError('The "original" argument must be of type Function');function i(){for(var i=[],n=0;n<arguments.length;n++)i.push(arguments[n]);var r=i.pop();if("function"!=typeof r)throw new TypeError("The last argument must be of type Function");var a=this,o=function(){return r.apply(a,arguments)};t.apply(this,i).then((function(t){e.nextTick(o,null,t)}),(function(t){e.nextTick(I,t,o)}))}return Object.setPrototypeOf(i,Object.getPrototypeOf(t)),Object.defineProperties(i,n(t)),i}}).call(this,i(23))},function(e,t,i){var n=i(92);e.exports=function(e,t,i){if(n(e),void 0===t)return e;switch(i){case 1:return function(i){return e.call(t,i)};case 2:return function(i,n){return e.call(t,i,n)};case 3:return function(i,n,r){return e.call(t,i,n,r)}}return function(){return e.apply(t,arguments)}}},function(e,t,i){for(var n=i(55),r=i(93),a=i(45),o=i(26),s=i(44),c=i(76),l=i(24),u=l("iterator"),h=l("toStringTag"),d=c.Array,f={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},p=r(f),m=0;m<p.length;m++){var _,g=p[m],v=f[g],b=o[g],y=b&&b.prototype;if(y&&(y[u]||s(y,u,d),y[h]||s(y,h,g),c[g]=d,v))for(_ in n)y[_]||a(y,_,n[_],!0)}},function(e,t,i){"use strict";var n=i(118),r=i(173),a=i(76),o=i(57);e.exports=i(139)(Array,"Array",(function(e,t){this._t=o(e),this._i=0,this._k=t}),(function(){var e=this._t,t=this._k,i=this._i++;return!e||i>=e.length?(this._t=void 0,r(1)):r(0,"keys"==t?i:"values"==t?e[i]:[i,e[i]])}),"values"),a.Arguments=a.Array,n("keys"),n("values"),n("entries")},function(e,t){var i=Math.ceil,n=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?n:i)(e)}},function(e,t,i){var n=i(165),r=i(69);e.exports=function(e){return n(r(e))}},function(e,t,i){"use strict";var n=i(16),r=i(98)(1);n(n.P+n.F*!i(99)([].map,!0),"Array",{map:function(e){return r(this,e,arguments[1])}})},function(e,t,i){var n=i(33).f,r=Function.prototype,a=/^\s*function ([^ (]*)/;"name"in r||i(34)&&n(r,"name",{configurable:!0,get:function(){try{return(""+this).match(a)[1]}catch(e){return""}}})},function(e,t,i){"use strict";if(i(34)){var n=i(63),r=i(26),a=i(35),o=i(16),s=i(187),c=i(298),l=i(53),u=i(101),h=i(65),d=i(44),f=i(102),p=i(56),m=i(42),_=i(188),g=i(113),v=i(91),b=i(49),y=i(90),w=i(31),O=i(48),x=i(141),E=i(94),T=i(119),C=i(72).f,S=i(142),A=i(64),P=i(24),I=i(98),D=i(112),j=i(137),M=i(55),R=i(76),L=i(120),N=i(114),F=i(144),k=i(299),B=i(33),z=i(71),U=B.f,V=z.f,H=r.RangeError,G=r.TypeError,q=r.Uint8Array,W=Array.prototype,Y=c.ArrayBuffer,X=c.DataView,Z=I(0),Q=I(2),K=I(3),J=I(4),$=I(5),ee=I(6),te=D(!0),ie=D(!1),ne=M.values,re=M.keys,ae=M.entries,oe=W.lastIndexOf,se=W.reduce,ce=W.reduceRight,le=W.join,ue=W.sort,he=W.slice,de=W.toString,fe=W.toLocaleString,pe=P("iterator"),me=P("toStringTag"),_e=A("typed_constructor"),ge=A("def_constructor"),ve=s.CONSTR,be=s.TYPED,ye=s.VIEW,we=I(1,(function(e,t){return Ce(j(e,e[ge]),t)})),Oe=a((function(){return 1===new q(new Uint16Array([1]).buffer)[0]})),xe=!!q&&!!q.prototype.set&&a((function(){new q(1).set({})})),Ee=function(e,t){var i=p(e);if(i<0||i%t)throw H("Wrong offset!");return i},Te=function(e){if(w(e)&&be in e)return e;throw G(e+" is not a typed array!")},Ce=function(e,t){if(!(w(e)&&_e in e))throw G("It is not a typed array constructor!");return new e(t)},Se=function(e,t){return Ae(j(e,e[ge]),t)},Ae=function(e,t){for(var i=0,n=t.length,r=Ce(e,n);n>i;)r[i]=t[i++];return r},Pe=function(e,t,i){U(e,t,{get:function(){return this._d[i]}})},Ie=function(e){var t,i,n,r,a,o,s=O(e),c=arguments.length,u=c>1?arguments[1]:void 0,h=void 0!==u,d=S(s);if(null!=d&&!x(d)){for(o=d.call(s),n=[],t=0;!(a=o.next()).done;t++)n.push(a.value);s=n}for(h&&c>2&&(u=l(u,arguments[2],2)),t=0,i=m(s.length),r=Ce(this,i);i>t;t++)r[t]=h?u(s[t],t):s[t];return r},De=function(){for(var e=0,t=arguments.length,i=Ce(this,t);t>e;)i[e]=arguments[e++];return i},je=!!q&&a((function(){fe.call(new q(1))})),Me=function(){return fe.apply(je?he.call(Te(this)):Te(this),arguments)},Re={copyWithin:function(e,t){return k.call(Te(this),e,t,arguments.length>2?arguments[2]:void 0)},every:function(e){return J(Te(this),e,arguments.length>1?arguments[1]:void 0)},fill:function(e){return F.apply(Te(this),arguments)},filter:function(e){return Se(this,Q(Te(this),e,arguments.length>1?arguments[1]:void 0))},find:function(e){return $(Te(this),e,arguments.length>1?arguments[1]:void 0)},findIndex:function(e){return ee(Te(this),e,arguments.length>1?arguments[1]:void 0)},forEach:function(e){Z(Te(this),e,arguments.length>1?arguments[1]:void 0)},indexOf:function(e){return ie(Te(this),e,arguments.length>1?arguments[1]:void 0)},includes:function(e){return te(Te(this),e,arguments.length>1?arguments[1]:void 0)},join:function(e){return le.apply(Te(this),arguments)},lastIndexOf:function(e){return oe.apply(Te(this),arguments)},map:function(e){return we(Te(this),e,arguments.length>1?arguments[1]:void 0)},reduce:function(e){return se.apply(Te(this),arguments)},reduceRight:function(e){return ce.apply(Te(this),arguments)},reverse:function(){for(var e,t=Te(this).length,i=Math.floor(t/2),n=0;n<i;)e=this[n],this[n++]=this[--t],this[t]=e;return this},some:function(e){return K(Te(this),e,arguments.length>1?arguments[1]:void 0)},sort:function(e){return ue.call(Te(this),e)},subarray:function(e,t){var i=Te(this),n=i.length,r=g(e,n);return new(j(i,i[ge]))(i.buffer,i.byteOffset+r*i.BYTES_PER_ELEMENT,m((void 0===t?n:g(t,n))-r))}},Le=function(e,t){return Se(this,he.call(Te(this),e,t))},Ne=function(e){Te(this);var t=Ee(arguments[1],1),i=this.length,n=O(e),r=m(n.length),a=0;if(r+t>i)throw H("Wrong length!");for(;a<r;)this[t+a]=n[a++]},Fe={entries:function(){return ae.call(Te(this))},keys:function(){return re.call(Te(this))},values:function(){return ne.call(Te(this))}},ke=function(e,t){return w(e)&&e[be]&&"symbol"!=typeof t&&t in e&&String(+t)==String(t)},Be=function(e,t){return ke(e,t=v(t,!0))?h(2,e[t]):V(e,t)},ze=function(e,t,i){return!(ke(e,t=v(t,!0))&&w(i)&&b(i,"value"))||b(i,"get")||b(i,"set")||i.configurable||b(i,"writable")&&!i.writable||b(i,"enumerable")&&!i.enumerable?U(e,t,i):(e[t]=i.value,e)};ve||(z.f=Be,B.f=ze),o(o.S+o.F*!ve,"Object",{getOwnPropertyDescriptor:Be,defineProperty:ze}),a((function(){de.call({})}))&&(de=fe=function(){return le.call(this)});var Ue=f({},Re);f(Ue,Fe),d(Ue,pe,Fe.values),f(Ue,{slice:Le,set:Ne,constructor:function(){},toString:de,toLocaleString:Me}),Pe(Ue,"buffer","b"),Pe(Ue,"byteOffset","o"),Pe(Ue,"byteLength","l"),Pe(Ue,"length","e"),U(Ue,me,{get:function(){return this[be]}}),e.exports=function(e,t,i,c){var l=e+((c=!!c)?"Clamped":"")+"Array",h="get"+e,f="set"+e,p=r[l],g=p||{},v=p&&T(p),b=!p||!s.ABV,O={},x=p&&p.prototype,S=function(e,i){U(e,i,{get:function(){return function(e,i){var n=e._d;return n.v[h](i*t+n.o,Oe)}(this,i)},set:function(e){return function(e,i,n){var r=e._d;c&&(n=(n=Math.round(n))<0?0:n>255?255:255&n),r.v[f](i*t+r.o,n,Oe)}(this,i,e)},enumerable:!0})};b?(p=i((function(e,i,n,r){u(e,p,l,"_d");var a,o,s,c,h=0,f=0;if(w(i)){if(!(i instanceof Y||"ArrayBuffer"==(c=y(i))||"SharedArrayBuffer"==c))return be in i?Ae(p,i):Ie.call(p,i);a=i,f=Ee(n,t);var g=i.byteLength;if(void 0===r){if(g%t)throw H("Wrong length!");if((o=g-f)<0)throw H("Wrong length!")}else if((o=m(r)*t)+f>g)throw H("Wrong length!");s=o/t}else s=_(i),a=new Y(o=s*t);for(d(e,"_d",{b:a,o:f,l:o,e:s,v:new X(a)});h<s;)S(e,h++)})),x=p.prototype=E(Ue),d(x,"constructor",p)):a((function(){p(1)}))&&a((function(){new p(-1)}))&&L((function(e){new p,new p(null),new p(1.5),new p(e)}),!0)||(p=i((function(e,i,n,r){var a;return u(e,p,l),w(i)?i instanceof Y||"ArrayBuffer"==(a=y(i))||"SharedArrayBuffer"==a?void 0!==r?new g(i,Ee(n,t),r):void 0!==n?new g(i,Ee(n,t)):new g(i):be in i?Ae(p,i):Ie.call(p,i):new g(_(i))})),Z(v!==Function.prototype?C(g).concat(C(v)):C(g),(function(e){e in p||d(p,e,g[e])})),p.prototype=x,n||(x.constructor=p));var A=x[pe],P=!!A&&("values"==A.name||null==A.name),I=Fe.values;d(p,_e,!0),d(x,be,l),d(x,ye,!0),d(x,ge,p),(c?new p(1)[me]==l:me in x)||U(x,me,{get:function(){return l}}),O[l]=p,o(o.G+o.W+o.F*(p!=g),O),o(o.S,l,{BYTES_PER_ELEMENT:t}),o(o.S+o.F*a((function(){g.of.call(p,1)})),l,{from:Ie,of:De}),"BYTES_PER_ELEMENT"in x||d(x,"BYTES_PER_ELEMENT",t),o(o.P,l,Re),N(l),o(o.P+o.F*xe,l,{set:Ne}),o(o.P+o.F*!P,l,Fe),n||x.toString==de||(x.toString=de),o(o.P+o.F*a((function(){new p(1).slice()})),l,{slice:Le}),o(o.P+o.F*(a((function(){return[1,2].toLocaleString()!=new p([1,2]).toLocaleString()}))||!a((function(){x.toLocaleString.call([1,2])}))),l,{toLocaleString:Me}),R[l]=P?A:I,n||P||d(x,pe,I)}}else e.exports=function(){}},function(e,t,i){"use strict";var n=i(107),r=Object.keys||function(e){var t=[];for(var i in e)t.push(i);return t};e.exports=h;var a=i(38);a.inherits=i(30);var o=i(151),s=i(125);a.inherits(h,o);for(var c=r(s.prototype),l=0;l<c.length;l++){var u=c[l];h.prototype[u]||(h.prototype[u]=s.prototype[u])}function h(e){if(!(this instanceof h))return new h(e);o.call(this,e),s.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",d)}function d(){this.allowHalfOpen||this._writableState.ended||n.nextTick(f,this)}function f(e){e.end()}Object.defineProperty(h.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(h.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}}),h.prototype._destroy=function(e,t){this.push(null),this.end(),n.nextTick(t,e)}},function(e,t){var i=e.exports={version:"2.6.11"};"number"==typeof __e&&(__e=i)},function(e,t){e.exports=!1},function(e,t){var i=0,n=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++i+n).toString(36))}},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t,i){"use strict";var n=i(0),r=i(121);function a(e,t,i){this.statusCode=e,this.response=t,this.responseHeaders=i,"string"==typeof this.responseHeaders&&(this.responseHeaders=Object(r.a)(this.responseHeaders))}a.prototype.toString=function(){var e="Request has failed.";return Object(n.a)(this.statusCode)&&(e+=" Status Code: "+this.statusCode),e},t.a=a},function(e,t,i){"use strict";var n,r="object"==typeof Reflect?Reflect:null,a=r&&"function"==typeof r.apply?r.apply:function(e,t,i){return Function.prototype.apply.call(e,t,i)};n=r&&"function"==typeof r.ownKeys?r.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var o=Number.isNaN||function(e){return e!=e};function s(){s.init.call(this)}e.exports=s,s.EventEmitter=s,s.prototype._events=void 0,s.prototype._eventsCount=0,s.prototype._maxListeners=void 0;var c=10;function l(e){return void 0===e._maxListeners?s.defaultMaxListeners:e._maxListeners}function u(e,t,i,n){var r,a,o,s;if("function"!=typeof i)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof i);if(void 0===(a=e._events)?(a=e._events=Object.create(null),e._eventsCount=0):(void 0!==a.newListener&&(e.emit("newListener",t,i.listener?i.listener:i),a=e._events),o=a[t]),void 0===o)o=a[t]=i,++e._eventsCount;else if("function"==typeof o?o=a[t]=n?[i,o]:[o,i]:n?o.unshift(i):o.push(i),(r=l(e))>0&&o.length>r&&!o.warned){o.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=e,c.type=t,c.count=o.length,s=c,console&&console.warn&&console.warn(s)}return e}function h(){for(var e=[],t=0;t<arguments.length;t++)e.push(arguments[t]);this.fired||(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,a(this.listener,this.target,e))}function d(e,t,i){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:i},r=h.bind(n);return r.listener=i,n.wrapFn=r,r}function f(e,t,i){var n=e._events;if(void 0===n)return[];var r=n[t];return void 0===r?[]:"function"==typeof r?i?[r.listener||r]:[r]:i?function(e){for(var t=new Array(e.length),i=0;i<t.length;++i)t[i]=e[i].listener||e[i];return t}(r):m(r,r.length)}function p(e){var t=this._events;if(void 0!==t){var i=t[e];if("function"==typeof i)return 1;if(void 0!==i)return i.length}return 0}function m(e,t){for(var i=new Array(t),n=0;n<t;++n)i[n]=e[n];return i}Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return c},set:function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");c=e}}),s.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},s.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},s.prototype.getMaxListeners=function(){return l(this)},s.prototype.emit=function(e){for(var t=[],i=1;i<arguments.length;i++)t.push(arguments[i]);var n="error"===e,r=this._events;if(void 0!==r)n=n&&void 0===r.error;else if(!n)return!1;if(n){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var s=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw s.context=o,s}var c=r[e];if(void 0===c)return!1;if("function"==typeof c)a(c,this,t);else{var l=c.length,u=m(c,l);for(i=0;i<l;++i)a(u[i],this,t)}return!0},s.prototype.addListener=function(e,t){return u(this,e,t,!1)},s.prototype.on=s.prototype.addListener,s.prototype.prependListener=function(e,t){return u(this,e,t,!0)},s.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t);return this.on(e,d(this,e,t)),this},s.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t);return this.prependListener(e,d(this,e,t)),this},s.prototype.removeListener=function(e,t){var i,n,r,a,o;if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t);if(void 0===(n=this._events))return this;if(void 0===(i=n[e]))return this;if(i===t||i.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,i.listener||t));else if("function"!=typeof i){for(r=-1,a=i.length-1;a>=0;a--)if(i[a]===t||i[a].listener===t){o=i[a].listener,r=a;break}if(r<0)return this;0===r?i.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(i,r),1===i.length&&(n[e]=i[0]),void 0!==n.removeListener&&this.emit("removeListener",e,o||t)}return this},s.prototype.off=s.prototype.removeListener,s.prototype.removeAllListeners=function(e){var t,i,n;if(void 0===(i=this._events))return this;if(void 0===i.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==i[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete i[e]),this;if(0===arguments.length){var r,a=Object.keys(i);for(n=0;n<a.length;++n)"removeListener"!==(r=a[n])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=i[e]))this.removeListener(e,t);else if(void 0!==t)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this},s.prototype.listeners=function(e){return f(this,e,!0)},s.prototype.rawListeners=function(e){return f(this,e,!1)},s.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):p.call(e,t)},s.prototype.listenerCount=p,s.prototype.eventNames=function(){return this._eventsCount>0?n(this._events):[]}},function(e,t,i){"use strict";var n=i(226).Buffer,r=n.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function a(e){var t;switch(this.encoding=function(e){var t=function(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}(e);if("string"!=typeof t&&(n.isEncoding===r||!r(e)))throw new Error("Unknown encoding: "+e);return t||e}(e),this.encoding){case"utf16le":this.text=c,this.end=l,t=4;break;case"utf8":this.fillLast=s,t=4;break;case"base64":this.text=u,this.end=h,t=3;break;default:return this.write=d,void(this.end=f)}this.lastNeed=0,this.lastTotal=0,this.lastChar=n.allocUnsafe(t)}function o(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function s(e){var t=this.lastTotal-this.lastNeed,i=function(e,t,i){if(128!=(192&t[0]))return e.lastNeed=0,"�";if(e.lastNeed>1&&t.length>1){if(128!=(192&t[1]))return e.lastNeed=1,"�";if(e.lastNeed>2&&t.length>2&&128!=(192&t[2]))return e.lastNeed=2,"�"}}(this,e);return void 0!==i?i:this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,t,0,e.length),void(this.lastNeed-=e.length))}function c(e,t){if((e.length-t)%2==0){var i=e.toString("utf16le",t);if(i){var n=i.charCodeAt(i.length-1);if(n>=55296&&n<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],i.slice(0,-1)}return i}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1)}function l(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var i=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,i)}return t}function u(e,t){var i=(e.length-t)%3;return 0===i?e.toString("base64",t):(this.lastNeed=3-i,this.lastTotal=3,1===i?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-i))}function h(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function d(e){return e.toString(this.encoding)}function f(e){return e&&e.length?this.write(e):""}t.StringDecoder=a,a.prototype.write=function(e){if(0===e.length)return"";var t,i;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";i=this.lastNeed,this.lastNeed=0}else i=0;return i<e.length?t?t+this.text(e,i):this.text(e,i):t||""},a.prototype.end=function(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"�":t},a.prototype.text=function(e,t){var i=function(e,t,i){var n=t.length-1;if(n<i)return 0;var r=o(t[n]);if(r>=0)return r>0&&(e.lastNeed=r-1),r;if(--n<i||-2===r)return 0;if((r=o(t[n]))>=0)return r>0&&(e.lastNeed=r-2),r;if(--n<i||-2===r)return 0;if((r=o(t[n]))>=0)return r>0&&(2===r?r=0:e.lastNeed=r-3),r;return 0}(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=i;var n=e.length-(i-this.lastNeed);return e.copy(this.lastChar,0,n),e.toString("utf8",t,n)},a.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length}},function(e,t){e.exports=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t){var i={}.toString;e.exports=function(e){return i.call(e).slice(8,-1)}},function(e,t,i){var n=i(131),r=i(65),a=i(57),o=i(91),s=i(49),c=i(161),l=Object.getOwnPropertyDescriptor;t.f=i(34)?l:function(e,t){if(e=a(e),t=o(t,!0),c)try{return l(e,t)}catch(e){}if(s(e,t))return r(!n.f.call(e,t),e[t])}},function(e,t,i){var n=i(166),r=i(133).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return n(e,r)}},function(e,t,i){"use strict";i(249);var n=i(32),r=i(111),a=i(34),o=/./.toString,s=function(e){i(45)(RegExp.prototype,"toString",e,!0)};i(35)((function(){return"/a/b"!=o.call({source:"a",flags:"b"})}))?s((function(){var e=n(this);return"/".concat(e.source,"/","flags"in e?e.flags:!a&&e instanceof RegExp?r.call(e):void 0)})):"toString"!=o.name&&s((function(){return o.call(this)}))},function(e,t,i){var n=Date.prototype,r=n.toString,a=n.getTime;new Date(NaN)+""!="Invalid Date"&&i(45)(n,"toString",(function(){var e=a.call(this);return e==e?r.call(this):"Invalid Date"}))},function(e,t,i){var n=i(33).f,r=i(49),a=i(24)("toStringTag");e.exports=function(e,t,i){e&&!r(e=i?e:e.prototype,a)&&n(e,a,{configurable:!0,value:t})}},function(e,t){e.exports={}},function(e,t,i){"use strict";var n=i(16),r=i(112)(!1),a=[].indexOf,o=!!a&&1/[1].indexOf(1,-0)<0;n(n.P+n.F*(o||!i(99)(a)),"Array",{indexOf:function(e){return o?a.apply(this,arguments)||0:r(this,e,arguments[1])}})},function(e,t,i){(function(t){e.exports=s;var n=Object.keys||function(e){var t=[];for(var i in e)t.push(i);return t},r=i(38);r.inherits=i(30);var a=i(196),o=i(197);function s(e){if(!(this instanceof s))return new s(e);a.call(this,e),o.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",c)}function c(){this.allowHalfOpen||this._writableState.ended||t.nextTick(this.end.bind(this))}r.inherits(s,a),function(e,t){for(var i=0,n=e.length;i<n;i++)t(e[i],i)}(n(o.prototype),(function(e){s.prototype[e]||(s.prototype[e]=o.prototype[e])}))}).call(this,i(23))},function(e,t,i){"use strict";t.a=function(e){return 0!==e.length&&"/"===e[e.length-1]||(e+="/"),e}},function(e,t,i){"use strict";var n=i(18),r=i(0),a=i(2);t.a=function(e){if(!Object(r.a)(e))throw new a.a("uri is required.");var t=new n.a(e);t.normalize();var i=t.path,o=i.lastIndexOf("/");return-1!==o&&(i=i.substr(o+1)),o=i.lastIndexOf("."),i=-1===o?"":i.substr(o+1)}},function(e,t,i){"use strict";var n=i(3),r=/^blob:/i;t.a=function(e){return n.a.typeOf.string("uri",e),r.test(e)}},function(e,t,i){"use strict";var n,r=i(0);t.a=function(e){Object(r.a)(n)||(n=document.createElement("a")),n.href=window.location.href;var t=n.host,i=n.protocol;return n.href=e,n.href=n.href,i!==n.protocol||t!==n.host}},function(e,t,i){"use strict";var n=i(3),r=/^data:/i;t.a=function(e){return n.a.typeOf.string("uri",e),r.test(e)}},function(e,t,i){"use strict";var n=i(8);t.a=function(e){var t=n.a.defer(),i=document.createElement("script");i.async=!0,i.src=e;var r=document.getElementsByTagName("head")[0];return i.onload=function(){i.onload=void 0,r.removeChild(i),t.resolve()},i.onerror=function(e){t.reject(e)},r.appendChild(i),t.promise}},function(e,t,i){"use strict";var n=i(0),r=i(2),a=i(13);t.a=function(e){if(!Object(n.a)(e))throw new r.a("obj is required.");var t="";for(var i in e)if(e.hasOwnProperty(i)){var o=e[i],s=encodeURIComponent(i)+"=";if(Object(a.a)(o))for(var c=0,l=o.length;c<l;++c)t+=s+encodeURIComponent(o[c])+"&";else t+=s+encodeURIComponent(o)+"&"}return t=t.slice(0,-1)}},function(module,__webpack_exports__,__webpack_require__){"use strict";var tmp={};
/*!
 * protobuf.js v6.7.0 (c) 2016, Daniel Wirtz
 * Compiled Wed, 22 Mar 2017 17:30:26 UTC
 * Licensed under the BSD-3-Clause License
 * see: https://github.com/dcodeIO/protobuf.js for details
 */!function(global,undefined){var modules,cache,entries;modules={1:[function(e,t,i){t.exports=function(e,t){for(var i=[],n=2;n<arguments.length;)i.push(arguments[n++]);var r=!0;return new Promise((function(n,a){i.push((function(e){if(r)if(r=!1,e)a(e);else{for(var t=[],i=1;i<arguments.length;)t.push(arguments[i++]);n.apply(null,t)}}));try{e.apply(t||this,i)}catch(e){r&&(r=!1,a(e))}}))}},{}],2:[function(e,t,i){var n=i;n.length=function(e){var t=e.length;if(!t)return 0;for(var i=0;--t%4>1&&"="===e.charAt(t);)++i;return Math.ceil(3*e.length)/4-i};for(var r=new Array(64),a=new Array(123),o=0;o<64;)a[r[o]=o<26?o+65:o<52?o+71:o<62?o-4:o-59|43]=o++;n.encode=function(e,t,i){for(var n,a=[],o=0,s=0;t<i;){var c=e[t++];switch(s){case 0:a[o++]=r[c>>2],n=(3&c)<<4,s=1;break;case 1:a[o++]=r[n|c>>4],n=(15&c)<<2,s=2;break;case 2:a[o++]=r[n|c>>6],a[o++]=r[63&c],s=0}}return s&&(a[o++]=r[n],a[o]=61,1===s&&(a[o+1]=61)),String.fromCharCode.apply(String,a)},n.decode=function(e,t,i){for(var n,r=i,o=0,s=0;s<e.length;){var c=e.charCodeAt(s++);if(61===c&&o>1)break;if((c=a[c])===undefined)throw Error("invalid encoding");switch(o){case 0:n=c,o=1;break;case 1:t[i++]=n<<2|(48&c)>>4,n=c,o=2;break;case 2:t[i++]=(15&n)<<4|(60&c)>>2,n=c,o=3;break;case 3:t[i++]=(3&n)<<6|c,o=0}}if(1===o)throw Error("invalid encoding");return i-r},n.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}},{}],3:[function(e,t,i){function n(){this._listeners={}}t.exports=n,n.prototype.on=function(e,t,i){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:i||this}),this},n.prototype.off=function(e,t){if(e===undefined)this._listeners={};else if(t===undefined)this._listeners[e]=[];else for(var i=this._listeners[e],n=0;n<i.length;)i[n].fn===t?i.splice(n,1):++n;return this},n.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var i=[],n=1;n<arguments.length;)i.push(arguments[n++]);for(n=0;n<t.length;)t[n].fn.apply(t[n++].ctx,i)}return this}},{}],4:[function(require,module,exports){function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}module.exports=inquire},{}],5:[function(e,t,i){t.exports=function(e,t,i){var n=i||8192,r=n>>>1,a=null,o=n;return function(i){if(i<1||i>r)return e(i);o+i>n&&(a=e(n),o=0);var s=t.call(a,o,o+=i);return 7&o&&(o=1+(7|o)),s}}},{}],6:[function(e,t,i){var n=i;n.length=function(e){for(var t=0,i=0,n=0;n<e.length;++n)(i=e.charCodeAt(n))<128?t+=1:i<2048?t+=2:55296==(64512&i)&&56320==(64512&e.charCodeAt(n+1))?(++n,t+=4):t+=3;return t},n.read=function(e,t,i){if(i-t<1)return"";for(var n,r=null,a=[],o=0;t<i;)(n=e[t++])<128?a[o++]=n:n>191&&n<224?a[o++]=(31&n)<<6|63&e[t++]:n>239&&n<365?(n=((7&n)<<18|(63&e[t++])<<12|(63&e[t++])<<6|63&e[t++])-65536,a[o++]=55296+(n>>10),a[o++]=56320+(1023&n)):a[o++]=(15&n)<<12|(63&e[t++])<<6|63&e[t++],o>8191&&((r||(r=[])).push(String.fromCharCode.apply(String,a)),o=0);return r?(o&&r.push(String.fromCharCode.apply(String,a.slice(0,o))),r.join("")):String.fromCharCode.apply(String,a.slice(0,o))},n.write=function(e,t,i){for(var n,r,a=i,o=0;o<e.length;++o)(n=e.charCodeAt(o))<128?t[i++]=n:n<2048?(t[i++]=n>>6|192,t[i++]=63&n|128):55296==(64512&n)&&56320==(64512&(r=e.charCodeAt(o+1)))?(n=65536+((1023&n)<<10)+(1023&r),++o,t[i++]=n>>18|240,t[i++]=n>>12&63|128,t[i++]=n>>6&63|128,t[i++]=63&n|128):(t[i++]=n>>12|224,t[i++]=n>>6&63|128,t[i++]=63&n|128);return i-a}},{}],7:[function(e,t,i){var n=i;function r(){n.Reader._configure(n.BufferReader),n.util._configure()}n.build="minimal",n.roots={},n.Writer=e(14),n.BufferWriter=e(15),n.Reader=e(8),n.BufferReader=e(9),n.util=e(13),n.rpc=e(10),n.configure=r,n.Writer._configure(n.BufferWriter),r()},{10:10,13:13,14:14,15:15,8:8,9:9}],8:[function(e,t,i){t.exports=c;var n,r=e(13),a=r.LongBits,o=r.utf8;function s(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function c(e){this.buf=e,this.pos=0,this.len=e.length}var l,u="undefined"!=typeof Uint8Array?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new c(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new c(e);throw Error("illegal buffer")};function h(){var e=new a(0,0),t=0;if(!(this.len-this.pos>4)){for(;t<3;++t){if(this.pos>=this.len)throw s(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*t)>>>0,e}for(;t<4;++t)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return e;if(t=0,this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw s(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}function d(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}function f(){if(this.pos+8>this.len)throw s(this,8);return new a(d(this.buf,this.pos+=4),d(this.buf,this.pos+=4))}c.create=r.Buffer?function(e){return(c.create=function(e){return r.Buffer.isBuffer(e)?new n(e):u(e)})(e)}:u,c.prototype._slice=r.Array.prototype.subarray||r.Array.prototype.slice,c.prototype.uint32=(l=4294967295,function(){if(l=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return l;if(l=(l|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return l;if(l=(l|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return l;if(l=(l|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return l;if(l=(l|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return l;if((this.pos+=5)>this.len)throw this.pos=this.len,s(this,10);return l}),c.prototype.int32=function(){return 0|this.uint32()},c.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(1&e)|0},c.prototype.bool=function(){return 0!==this.uint32()},c.prototype.fixed32=function(){if(this.pos+4>this.len)throw s(this,4);return d(this.buf,this.pos+=4)},c.prototype.sfixed32=function(){if(this.pos+4>this.len)throw s(this,4);return 0|d(this.buf,this.pos+=4)};var p,m,_="undefined"!=typeof Float32Array?(p=new Float32Array(1),m=new Uint8Array(p.buffer),p[0]=-0,m[3]?function(e,t){return m[0]=e[t],m[1]=e[t+1],m[2]=e[t+2],m[3]=e[t+3],p[0]}:function(e,t){return m[0]=e[t+3],m[1]=e[t+2],m[2]=e[t+1],m[3]=e[t],p[0]}):function(e,t){var i=d(e,t+4),n=2*(i>>31)+1,r=i>>>23&255,a=8388607&i;return 255===r?a?NaN:n*(1/0):0===r?1401298464324817e-60*n*a:n*Math.pow(2,r-150)*(a+8388608)};c.prototype.float=function(){if(this.pos+4>this.len)throw s(this,4);var e=_(this.buf,this.pos);return this.pos+=4,e};var g="undefined"!=typeof Float64Array?function(){var e=new Float64Array(1),t=new Uint8Array(e.buffer);return e[0]=-0,t[7]?function(i,n){return t[0]=i[n],t[1]=i[n+1],t[2]=i[n+2],t[3]=i[n+3],t[4]=i[n+4],t[5]=i[n+5],t[6]=i[n+6],t[7]=i[n+7],e[0]}:function(i,n){return t[0]=i[n+7],t[1]=i[n+6],t[2]=i[n+5],t[3]=i[n+4],t[4]=i[n+3],t[5]=i[n+2],t[6]=i[n+1],t[7]=i[n],e[0]}}():function(e,t){var i=d(e,t+4),n=d(e,t+8),r=2*(n>>31)+1,a=n>>>20&2047,o=4294967296*(1048575&n)+i;return 2047===a?o?NaN:r*(1/0):0===a?5e-324*r*o:r*Math.pow(2,a-1075)*(o+4503599627370496)};c.prototype.double=function(){if(this.pos+8>this.len)throw s(this,4);var e=g(this.buf,this.pos);return this.pos+=8,e},c.prototype.bytes=function(){var e=this.uint32(),t=this.pos,i=this.pos+e;if(i>this.len)throw s(this,e);return this.pos+=e,t===i?new this.buf.constructor(0):this._slice.call(this.buf,t,i)},c.prototype.string=function(){var e=this.bytes();return o.read(e,0,e.length)},c.prototype.skip=function(e){if("number"==typeof e){if(this.pos+e>this.len)throw s(this,e);this.pos+=e}else do{if(this.pos>=this.len)throw s(this)}while(128&this.buf[this.pos++]);return this},c.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(e=7&this.uint32());)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this},c._configure=function(e){n=e;var t=r.Long?"toLong":"toNumber";r.merge(c.prototype,{int64:function(){return h.call(this)[t](!1)},uint64:function(){return h.call(this)[t](!0)},sint64:function(){return h.call(this).zzDecode()[t](!1)},fixed64:function(){return f.call(this)[t](!0)},sfixed64:function(){return f.call(this)[t](!1)}})}},{13:13}],9:[function(e,t,i){t.exports=a;var n=e(8);(a.prototype=Object.create(n.prototype)).constructor=a;var r=e(13);function a(e){n.call(this,e)}r.Buffer&&(a.prototype._slice=r.Buffer.prototype.slice),a.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len))}},{13:13,8:8}],10:[function(e,t,i){i.Service=e(11)},{11:11}],11:[function(e,t,i){t.exports=r;var n=e(13);function r(e,t,i){if("function"!=typeof e)throw TypeError("rpcImpl must be a function");n.EventEmitter.call(this),this.rpcImpl=e,this.requestDelimited=Boolean(t),this.responseDelimited=Boolean(i)}(r.prototype=Object.create(n.EventEmitter.prototype)).constructor=r,r.prototype.rpcCall=function e(t,i,r,a,o){if(!a)throw TypeError("request must be specified");var s=this;if(!o)return n.asPromise(e,s,t,i,r,a);if(!s.rpcImpl)return setTimeout((function(){o(Error("already ended"))}),0),undefined;try{return s.rpcImpl(t,i[s.requestDelimited?"encodeDelimited":"encode"](a).finish(),(function(e,i){if(e)return s.emit("error",e,t),o(e);if(null===i)return s.end(!0),undefined;if(!(i instanceof r))try{i=r[s.responseDelimited?"decodeDelimited":"decode"](i)}catch(e){return s.emit("error",e,t),o(e)}return s.emit("data",i,t),o(null,i)}))}catch(e){return s.emit("error",e,t),setTimeout((function(){o(e)}),0),undefined}},r.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},{13:13}],12:[function(e,t,i){t.exports=r;var n=e(13);function r(e,t){this.lo=e>>>0,this.hi=t>>>0}var a=r.zero=new r(0,0);a.toNumber=function(){return 0},a.zzEncode=a.zzDecode=function(){return this},a.length=function(){return 1};var o=r.zeroHash="\0\0\0\0\0\0\0\0";r.fromNumber=function(e){if(0===e)return a;var t=e<0;t&&(e=-e);var i=e>>>0,n=(e-i)/4294967296>>>0;return t&&(n=~n>>>0,i=~i>>>0,++i>4294967295&&(i=0,++n>4294967295&&(n=0))),new r(i,n)},r.from=function(e){if("number"==typeof e)return r.fromNumber(e);if(n.isString(e)){if(!n.Long)return r.fromNumber(parseInt(e,10));e=n.Long.fromString(e)}return e.low||e.high?new r(e.low>>>0,e.high>>>0):a},r.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=1+~this.lo>>>0,i=~this.hi>>>0;return t||(i=i+1>>>0),-(t+4294967296*i)}return this.lo+4294967296*this.hi},r.prototype.toLong=function(e){return n.Long?new n.Long(0|this.lo,0|this.hi,Boolean(e)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(e)}};var s=String.prototype.charCodeAt;r.fromHash=function(e){return e===o?a:new r((s.call(e,0)|s.call(e,1)<<8|s.call(e,2)<<16|s.call(e,3)<<24)>>>0,(s.call(e,4)|s.call(e,5)<<8|s.call(e,6)<<16|s.call(e,7)<<24)>>>0)},r.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},r.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this},r.prototype.zzDecode=function(){var e=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this},r.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,i=this.hi>>>24;return 0===i?0===t?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:i<128?9:10}},{13:13}],13:[function(e,t,i){var n=i;function r(e,t,i){for(var n=Object.keys(t),r=0;r<n.length;++r)e[n[r]]!==undefined&&i||(e[n[r]]=t[n[r]]);return e}function a(e){function t(e,i){if(!(this instanceof t))return new t(e,i);Object.defineProperty(this,"message",{get:function(){return e}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),i&&r(this,i)}return(t.prototype=Object.create(Error.prototype)).constructor=t,Object.defineProperty(t.prototype,"name",{get:function(){return e}}),t.prototype.toString=function(){return this.name+": "+this.message},t}n.asPromise=e(1),n.base64=e(2),n.EventEmitter=e(3),n.inquire=e(4),n.utf8=e(6),n.pool=e(5),n.LongBits=e(12),n.emptyArray=Object.freeze?Object.freeze([]):[],n.emptyObject=Object.freeze?Object.freeze({}):{},n.isNode=Boolean(global.process&&global.process.versions&&global.process.versions.node),n.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},n.isString=function(e){return"string"==typeof e||e instanceof String},n.isObject=function(e){return e&&"object"==typeof e},n.Buffer=function(){try{var e=n.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch(e){return null}}(),n._Buffer_from=null,n._Buffer_allocUnsafe=null,n.newBuffer=function(e){return"number"==typeof e?n.Buffer?n._Buffer_allocUnsafe(e):new n.Array(e):n.Buffer?n._Buffer_from(e):"undefined"==typeof Uint8Array?e:new Uint8Array(e)},n.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,n.Long=global.dcodeIO&&global.dcodeIO.Long||n.inquire("long"),n.key2Re=/^true|false|0|1$/,n.key32Re=/^-?(?:0|[1-9][0-9]*)$/,n.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,n.longToHash=function(e){return e?n.LongBits.from(e).toHash():n.LongBits.zeroHash},n.longFromHash=function(e,t){var i=n.LongBits.fromHash(e);return n.Long?n.Long.fromBits(i.lo,i.hi,t):i.toNumber(Boolean(t))},n.merge=r,n.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)},n.newError=a,n.ProtocolError=a("ProtocolError"),n.oneOfGetter=function(e){for(var t={},i=0;i<e.length;++i)t[e[i]]=1;return function(){for(var e=Object.keys(this),i=e.length-1;i>-1;--i)if(1===t[e[i]]&&this[e[i]]!==undefined&&null!==this[e[i]])return e[i]}},n.oneOfSetter=function(e){return function(t){for(var i=0;i<e.length;++i)e[i]!==t&&delete this[e[i]]}},n.lazyResolve=function(e,t){for(var i=0;i<t.length;++i)for(var n=Object.keys(t[i]),r=0;r<n.length;++r){for(var a=t[i][n[r]].split("."),o=e;a.length;)o=o[a.shift()];t[i][n[r]]=o}},n.toJSONOptions={longs:String,enums:String,bytes:String},n._configure=function(){var e=n.Buffer;e?(n._Buffer_from=e.from!==Uint8Array.from&&e.from||function(t,i){return new e(t,i)},n._Buffer_allocUnsafe=e.allocUnsafe||function(t){return new e(t)}):n._Buffer_from=n._Buffer_allocUnsafe=null}},{1:1,12:12,2:2,3:3,4:4,5:5,6:6}],14:[function(e,t,i){t.exports=h;var n,r=e(13),a=r.LongBits,o=r.base64,s=r.utf8;function c(e,t,i){this.fn=e,this.len=t,this.next=undefined,this.val=i}function l(){}function u(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function h(){this.len=0,this.head=new c(l,0,0),this.tail=this.head,this.states=null}function d(e,t,i){t[i]=255&e}function f(e,t){this.len=e,this.next=undefined,this.val=t}function p(e,t,i){for(;e.hi;)t[i++]=127&e.lo|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[i++]=127&e.lo|128,e.lo=e.lo>>>7;t[i++]=e.lo}function m(e,t,i){t[i++]=255&e,t[i++]=e>>>8&255,t[i++]=e>>>16&255,t[i]=e>>>24}h.create=r.Buffer?function(){return(h.create=function(){return new n})()}:function(){return new h},h.alloc=function(e){return new r.Array(e)},r.Array!==Array&&(h.alloc=r.pool(h.alloc,r.Array.prototype.subarray)),h.prototype.push=function(e,t,i){return this.tail=this.tail.next=new c(e,t,i),this.len+=t,this},f.prototype=Object.create(c.prototype),f.prototype.fn=function(e,t,i){for(;e>127;)t[i++]=127&e|128,e>>>=7;t[i]=e},h.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new f((e>>>=0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this},h.prototype.int32=function(e){return e<0?this.push(p,10,a.fromNumber(e)):this.uint32(e)},h.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)},h.prototype.uint64=function(e){var t=a.from(e);return this.push(p,t.length(),t)},h.prototype.int64=h.prototype.uint64,h.prototype.sint64=function(e){var t=a.from(e).zzEncode();return this.push(p,t.length(),t)},h.prototype.bool=function(e){return this.push(d,1,e?1:0)},h.prototype.fixed32=function(e){return this.push(m,4,e>>>0)},h.prototype.sfixed32=h.prototype.fixed32,h.prototype.fixed64=function(e){var t=a.from(e);return this.push(m,4,t.lo).push(m,4,t.hi)},h.prototype.sfixed64=h.prototype.fixed64;var _,g,v="undefined"!=typeof Float32Array?(_=new Float32Array(1),g=new Uint8Array(_.buffer),_[0]=-0,g[3]?function(e,t,i){_[0]=e,t[i++]=g[0],t[i++]=g[1],t[i++]=g[2],t[i]=g[3]}:function(e,t,i){_[0]=e,t[i++]=g[3],t[i++]=g[2],t[i++]=g[1],t[i]=g[0]}):function(e,t,i){var n=e<0?1:0;if(n&&(e=-e),0===e)m(1/e>0?0:2147483648,t,i);else if(isNaN(e))m(2147483647,t,i);else if(e>34028234663852886e22)m((n<<31|2139095040)>>>0,t,i);else if(e<11754943508222875e-54)m((n<<31|Math.round(e/1401298464324817e-60))>>>0,t,i);else{var r=Math.floor(Math.log(e)/Math.LN2);m((n<<31|r+127<<23|8388607&Math.round(e*Math.pow(2,-r)*8388608))>>>0,t,i)}};h.prototype.float=function(e){return this.push(v,4,e)};var b="undefined"!=typeof Float64Array?function(){var e=new Float64Array(1),t=new Uint8Array(e.buffer);return e[0]=-0,t[7]?function(i,n,r){e[0]=i,n[r++]=t[0],n[r++]=t[1],n[r++]=t[2],n[r++]=t[3],n[r++]=t[4],n[r++]=t[5],n[r++]=t[6],n[r]=t[7]}:function(i,n,r){e[0]=i,n[r++]=t[7],n[r++]=t[6],n[r++]=t[5],n[r++]=t[4],n[r++]=t[3],n[r++]=t[2],n[r++]=t[1],n[r]=t[0]}}():function(e,t,i){var n=e<0?1:0;if(n&&(e=-e),0===e)m(0,t,i),m(1/e>0?0:2147483648,t,i+4);else if(isNaN(e))m(4294967295,t,i),m(2147483647,t,i+4);else if(e>17976931348623157e292)m(0,t,i),m((n<<31|2146435072)>>>0,t,i+4);else{var r;if(e<22250738585072014e-324)m((r=e/5e-324)>>>0,t,i),m((n<<31|r/4294967296)>>>0,t,i+4);else{var a=Math.floor(Math.log(e)/Math.LN2);1024===a&&(a=1023),m(4503599627370496*(r=e*Math.pow(2,-a))>>>0,t,i),m((n<<31|a+1023<<20|1048576*r&1048575)>>>0,t,i+4)}}};h.prototype.double=function(e){return this.push(b,8,e)};var y=r.Array.prototype.set?function(e,t,i){t.set(e,i)}:function(e,t,i){for(var n=0;n<e.length;++n)t[i+n]=e[n]};h.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this.push(d,1,0);if(r.isString(e)){var i=h.alloc(t=o.length(e));o.decode(e,i,0),e=i}return this.uint32(t).push(y,t,e)},h.prototype.string=function(e){var t=s.length(e);return t?this.uint32(t).push(s.write,t,e):this.push(d,1,0)},h.prototype.fork=function(){return this.states=new u(this),this.head=this.tail=new c(l,0,0),this.len=0,this},h.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new c(l,0,0),this.len=0),this},h.prototype.ldelim=function(){var e=this.head,t=this.tail,i=this.len;return this.reset().uint32(i),i&&(this.tail.next=e.next,this.tail=t,this.len+=i),this},h.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),i=0;e;)e.fn(e.val,t,i),i+=e.len,e=e.next;return t},h._configure=function(e){n=e}},{13:13}],15:[function(e,t,i){t.exports=o;var n=e(14);(o.prototype=Object.create(n.prototype)).constructor=o;var r=e(13),a=r.Buffer;function o(){n.call(this)}o.alloc=function(e){return(o.alloc=r._Buffer_allocUnsafe)(e)};var s=a&&a.prototype instanceof Uint8Array&&"set"===a.prototype.set.name?function(e,t,i){t.set(e,i)}:function(e,t,i){if(e.copy)e.copy(t,i,0,e.length);else for(var n=0;n<e.length;)t[i++]=e[n++]};function c(e,t,i){e.length<40?r.utf8.write(e,t,i):t.utf8Write(e,i)}o.prototype.bytes=function(e){r.isString(e)&&(e=r._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this.push(s,t,e),this},o.prototype.string=function(e){var t=a.byteLength(e);return this.uint32(t),t&&this.push(c,t,e),this}},{13:13,14:14}]},cache={},entries=[7],global.protobuf=function e(t){var i=cache[t];return i||modules[t][0].call(i=cache[t]={exports:{}},e,i,i.exports),i.exports}(entries[0])}(tmp),__webpack_exports__.a=tmp.protobuf},function(e,t,i){"use strict";(function(e){var i;"undefined"!=typeof ko&&(i=ko),function(e){var t=this||(0,eval)("this"),i=t.document,n=t.navigator,r=t.jQuery,a=t.JSON;r||"undefined"==typeof jQuery||(r=jQuery),function(e){e(t.ko={})}((function(o,s){function c(e,t){return(null===e||typeof e in w)&&e===t}function l(t,i){var n;return function(){n||(n=y.a.setTimeout((function(){n=e,t()}),i))}}function u(e,t){var i;return function(){clearTimeout(i),i=y.a.setTimeout(e,t)}}function h(e,t){t&&"change"!==t?"beforeChange"===t?this.pc(e):this.gb(e,t):this.qc(e)}function d(e,t){null!==t&&t.s&&t.s()}function f(e,t){var i=this.qd,n=i[C];n.ra||(this.Qb&&this.mb[t]?(i.uc(t,e,this.mb[t]),this.mb[t]=null,--this.Qb):n.I[t]||i.uc(t,e,n.J?{da:e}:i.$c(e)),e.Ja&&e.gd())}var p,m,_,g,v,b,y=void 0!==o?o:{};y.b=function(e,t){for(var i=e.split("."),n=y,r=0;r<i.length-1;r++)n=n[i[r]];n[i[i.length-1]]=t},y.L=function(e,t,i){e[t]=i},y.version="3.5.1",y.b("version",y.version),y.options={deferUpdates:!1,useOnlyNativeEvents:!1,foreachHidesDestroyed:!1},y.a=function(){function o(e,t){for(var i in e)u.call(e,i)&&t(i,e[i])}function s(e,t){if(t)for(var i in t)u.call(t,i)&&(e[i]=t[i]);return e}function c(e,t){return e.__proto__=t,e}function l(e,t,i,n){var r=e[t].match(v)||[];y.a.D(i.match(v),(function(e){y.a.Na(r,e,n)})),e[t]=r.join(" ")}var u=Object.prototype.hasOwnProperty,h={__proto__:[]}instanceof Array,d="function"==typeof Symbol,f={},p={};f[n&&/Firefox\/2/i.test(n.userAgent)?"KeyboardEvent":"UIEvents"]=["keyup","keydown","keypress"],f.MouseEvents="click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave".split(" "),o(f,(function(e,t){if(t.length)for(var i=0,n=t.length;i<n;i++)p[t[i]]=e}));var m,_={propertychange:!0},g=i&&function(){for(var t=3,n=i.createElement("div"),r=n.getElementsByTagName("i");n.innerHTML="\x3c!--[if gt IE "+ ++t+"]><i></i><![endif]--\x3e",r[0];);return 4<t?t:e}(),v=/\S+/g;return{Jc:["authenticity_token",/^__RequestVerificationToken(_.*)?$/],D:function(e,t,i){for(var n=0,r=e.length;n<r;n++)t.call(i,e[n],n,e)},A:"function"==typeof Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t)}:function(e,t){for(var i=0,n=e.length;i<n;i++)if(e[i]===t)return i;return-1},Lb:function(t,i,n){for(var r=0,a=t.length;r<a;r++)if(i.call(n,t[r],r,t))return t[r];return e},Pa:function(e,t){var i=y.a.A(e,t);0<i?e.splice(i,1):0===i&&e.shift()},wc:function(e){var t=[];return e&&y.a.D(e,(function(e){0>y.a.A(t,e)&&t.push(e)})),t},Mb:function(e,t,i){var n=[];if(e)for(var r=0,a=e.length;r<a;r++)n.push(t.call(i,e[r],r));return n},jb:function(e,t,i){var n=[];if(e)for(var r=0,a=e.length;r<a;r++)t.call(i,e[r],r)&&n.push(e[r]);return n},Nb:function(e,t){if(t instanceof Array)e.push.apply(e,t);else for(var i=0,n=t.length;i<n;i++)e.push(t[i]);return e},Na:function(e,t,i){var n=y.a.A(y.a.bc(e),t);0>n?i&&e.push(t):i||e.splice(n,1)},Ba:h,extend:s,setPrototypeOf:c,Ab:h?c:s,P:o,Ga:function(e,t,i){if(!e)return e;var n,r={};for(n in e)u.call(e,n)&&(r[n]=t.call(i,e[n],n,e));return r},Tb:function(e){for(;e.firstChild;)y.removeNode(e.firstChild)},Yb:function(e){for(var t=((e=y.a.la(e))[0]&&e[0].ownerDocument||i).createElement("div"),n=0,r=e.length;n<r;n++)t.appendChild(y.oa(e[n]));return t},Ca:function(e,t){for(var i=0,n=e.length,r=[];i<n;i++){var a=e[i].cloneNode(!0);r.push(t?y.oa(a):a)}return r},va:function(e,t){if(y.a.Tb(e),t)for(var i=0,n=t.length;i<n;i++)e.appendChild(t[i])},Xc:function(e,t){var i=e.nodeType?[e]:e;if(0<i.length){for(var n=i[0],r=n.parentNode,a=0,o=t.length;a<o;a++)r.insertBefore(t[a],n);for(a=0,o=i.length;a<o;a++)y.removeNode(i[a])}},Ua:function(e,t){if(e.length){for(t=8===t.nodeType&&t.parentNode||t;e.length&&e[0].parentNode!==t;)e.splice(0,1);for(;1<e.length&&e[e.length-1].parentNode!==t;)e.length--;if(1<e.length){var i=e[0],n=e[e.length-1];for(e.length=0;i!==n;)e.push(i),i=i.nextSibling;e.push(n)}}return e},Zc:function(e,t){7>g?e.setAttribute("selected",t):e.selected=t},Db:function(t){return null===t||t===e?"":t.trim?t.trim():t.toString().replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")},Ud:function(e,t){return e=e||"",!(t.length>e.length)&&e.substring(0,t.length)===t},vd:function(e,t){if(e===t)return!0;if(11===e.nodeType)return!1;if(t.contains)return t.contains(1!==e.nodeType?e.parentNode:e);if(t.compareDocumentPosition)return 16==(16&t.compareDocumentPosition(e));for(;e&&e!=t;)e=e.parentNode;return!!e},Sb:function(e){return y.a.vd(e,e.ownerDocument.documentElement)},kd:function(e){return!!y.a.Lb(e,y.a.Sb)},R:function(e){return e&&e.tagName&&e.tagName.toLowerCase()},Ac:function(e){return y.onError?function(){try{return e.apply(this,arguments)}catch(e){throw y.onError&&y.onError(e),e}}:e},setTimeout:function(e,t){return setTimeout(y.a.Ac(e),t)},Gc:function(e){setTimeout((function(){throw y.onError&&y.onError(e),e}),0)},B:function(e,t,i){var n=y.a.Ac(i);if(i=_[t],y.options.useOnlyNativeEvents||i||!r)if(i||"function"!=typeof e.addEventListener){if(void 0===e.attachEvent)throw Error("Browser doesn't support addEventListener or attachEvent");var a=function(t){n.call(e,t)},o="on"+t;e.attachEvent(o,a),y.a.K.za(e,(function(){e.detachEvent(o,a)}))}else e.addEventListener(t,n,!1);else m||(m="function"==typeof r(e).on?"on":"bind"),r(e)[m](t,n)},Fb:function(e,n){if(!e||!e.nodeType)throw Error("element must be a DOM node when calling triggerEvent");var a;if(a=!("input"!==y.a.R(e)||!e.type||"click"!=n.toLowerCase()||"checkbox"!=(a=e.type)&&"radio"!=a),y.options.useOnlyNativeEvents||!r||a)if("function"==typeof i.createEvent){if("function"!=typeof e.dispatchEvent)throw Error("The supplied element doesn't support dispatchEvent");(a=i.createEvent(p[n]||"HTMLEvents")).initEvent(n,!0,!0,t,0,0,0,0,0,!1,!1,!1,!1,0,e),e.dispatchEvent(a)}else if(a&&e.click)e.click();else{if(void 0===e.fireEvent)throw Error("Browser doesn't support triggering events");e.fireEvent("on"+n)}else r(e).trigger(n)},f:function(e){return y.O(e)?e():e},bc:function(e){return y.O(e)?e.v():e},Eb:function(e,t,i){var n;t&&("object"==typeof e.classList?(n=e.classList[i?"add":"remove"],y.a.D(t.match(v),(function(t){n.call(e.classList,t)}))):"string"==typeof e.className.baseVal?l(e.className,"baseVal",t,i):l(e,"className",t,i))},Bb:function(t,i){var n=y.a.f(i);null!==n&&n!==e||(n="");var r=y.h.firstChild(t);!r||3!=r.nodeType||y.h.nextSibling(r)?y.h.va(t,[t.ownerDocument.createTextNode(n)]):r.data=n,y.a.Ad(t)},Yc:function(e,t){if(e.name=t,7>=g)try{var n=e.name.replace(/[&<>'"]/g,(function(e){return"&#"+e.charCodeAt(0)+";"}));e.mergeAttributes(i.createElement("<input name='"+n+"'/>"),!1)}catch(e){}},Ad:function(e){9<=g&&(e=1==e.nodeType?e:e.parentNode).style&&(e.style.zoom=e.style.zoom)},wd:function(e){if(g){var t=e.style.width;e.style.width=0,e.style.width=t}},Pd:function(e,t){e=y.a.f(e),t=y.a.f(t);for(var i=[],n=e;n<=t;n++)i.push(n);return i},la:function(e){for(var t=[],i=0,n=e.length;i<n;i++)t.push(e[i]);return t},Da:function(e){return d?Symbol(e):e},Zd:6===g,$d:7===g,W:g,Lc:function(e,t){for(var i=y.a.la(e.getElementsByTagName("input")).concat(y.a.la(e.getElementsByTagName("textarea"))),n="string"==typeof t?function(e){return e.name===t}:function(e){return t.test(e.name)},r=[],a=i.length-1;0<=a;a--)n(i[a])&&r.push(i[a]);return r},Nd:function(e){return"string"==typeof e&&(e=y.a.Db(e))?a&&a.parse?a.parse(e):new Function("return "+e)():null},hc:function(e,t,i){if(!a||!a.stringify)throw Error("Cannot find JSON.stringify(). Some browsers (e.g., IE < 8) don't support it natively, but you can overcome this by adding a script reference to json2.js, downloadable from http://www.json.org/json2.js");return a.stringify(y.a.f(e),t,i)},Od:function(e,t,n){var r=(n=n||{}).params||{},a=n.includeFields||this.Jc,s=e;if("object"==typeof e&&"form"===y.a.R(e)){s=e.action;for(var c=a.length-1;0<=c;c--)for(var l=y.a.Lc(e,a[c]),u=l.length-1;0<=u;u--)r[l[u].name]=l[u].value}t=y.a.f(t);var h=i.createElement("form");for(var d in h.style.display="none",h.action=s,h.method="post",t)(e=i.createElement("input")).type="hidden",e.name=d,e.value=y.a.hc(y.a.f(t[d])),h.appendChild(e);o(r,(function(e,t){var n=i.createElement("input");n.type="hidden",n.name=e,n.value=t,h.appendChild(n)})),i.body.appendChild(h),n.submitter?n.submitter(h):h.submit(),setTimeout((function(){h.parentNode.removeChild(h)}),0)}}}(),y.b("utils",y.a),y.b("utils.arrayForEach",y.a.D),y.b("utils.arrayFirst",y.a.Lb),y.b("utils.arrayFilter",y.a.jb),y.b("utils.arrayGetDistinctValues",y.a.wc),y.b("utils.arrayIndexOf",y.a.A),y.b("utils.arrayMap",y.a.Mb),y.b("utils.arrayPushAll",y.a.Nb),y.b("utils.arrayRemoveItem",y.a.Pa),y.b("utils.cloneNodes",y.a.Ca),y.b("utils.createSymbolOrString",y.a.Da),y.b("utils.extend",y.a.extend),y.b("utils.fieldsIncludedWithJsonPost",y.a.Jc),y.b("utils.getFormFields",y.a.Lc),y.b("utils.objectMap",y.a.Ga),y.b("utils.peekObservable",y.a.bc),y.b("utils.postJson",y.a.Od),y.b("utils.parseJson",y.a.Nd),y.b("utils.registerEventHandler",y.a.B),y.b("utils.stringifyJson",y.a.hc),y.b("utils.range",y.a.Pd),y.b("utils.toggleDomNodeCssClass",y.a.Eb),y.b("utils.triggerEvent",y.a.Fb),y.b("utils.unwrapObservable",y.a.f),y.b("utils.objectForEach",y.a.P),y.b("utils.addOrRemoveItem",y.a.Na),y.b("utils.setTextContent",y.a.Bb),y.b("unwrap",y.a.f),Function.prototype.bind||(Function.prototype.bind=function(e){var t=this;if(1===arguments.length)return function(){return t.apply(e,arguments)};var i=Array.prototype.slice.call(arguments,1);return function(){var n=i.slice(0);return n.push.apply(n,arguments),t.apply(e,n)}}),y.a.g=new function(){var t,i,n=0,r="__ko__"+(new Date).getTime(),a={};return y.a.W?(t=function(t,i){var o=t[r];if(!o||"null"===o||!a[o]){if(!i)return e;o=t[r]="ko"+n++,a[o]={}}return a[o]},i=function(e){var t=e[r];return!!t&&(delete a[t],e[r]=null,!0)}):(t=function(e,t){var i=e[r];return!i&&t&&(i=e[r]={}),i},i=function(e){return!!e[r]&&(delete e[r],!0)}),{get:function(e,i){var n=t(e,!1);return n&&n[i]},set:function(i,n,r){(i=t(i,r!==e))&&(i[n]=r)},Ub:function(e,i,n){return(e=t(e,!0))[i]||(e[i]=n)},clear:i,Z:function(){return n+++r}}},y.b("utils.domData",y.a.g),y.b("utils.domData.clear",y.a.g.clear),y.a.K=new function(){function t(t,i){var n=y.a.g.get(t,a);return n===e&&i&&(n=[],y.a.g.set(t,a,n)),n}function i(e){if(i=t(e,!1))for(var i=i.slice(0),r=0;r<i.length;r++)i[r](e);y.a.g.clear(e),y.a.K.cleanExternalData(e),s[e.nodeType]&&n(e.childNodes,!0)}function n(e,t){for(var n,r=[],a=0;a<e.length;a++)if((!t||8===e[a].nodeType)&&(i(r[r.length]=n=e[a]),e[a]!==n))for(;a--&&-1==y.a.A(r,e[a]););}var a=y.a.g.Z(),o={1:!0,8:!0,9:!0},s={1:!0,9:!0};return{za:function(e,i){if("function"!=typeof i)throw Error("Callback must be a function");t(e,!0).push(i)},yb:function(i,n){var r=t(i,!1);r&&(y.a.Pa(r,n),0==r.length&&y.a.g.set(i,a,e))},oa:function(e){return y.u.G((function(){o[e.nodeType]&&(i(e),s[e.nodeType]&&n(e.getElementsByTagName("*")))})),e},removeNode:function(e){y.oa(e),e.parentNode&&e.parentNode.removeChild(e)},cleanExternalData:function(e){r&&"function"==typeof r.cleanData&&r.cleanData([e])}}},y.oa=y.a.K.oa,y.removeNode=y.a.K.removeNode,y.b("cleanNode",y.oa),y.b("removeNode",y.removeNode),y.b("utils.domNodeDisposal",y.a.K),y.b("utils.domNodeDisposal.addDisposeCallback",y.a.K.za),y.b("utils.domNodeDisposal.removeDisposeCallback",y.a.K.yb),p=[0,"",""],v={thead:m=[1,"<table>","</table>"],tbody:m,tfoot:m,tr:[2,"<table><tbody>","</tbody></table>"],td:_=[3,"<table><tbody><tr>","</tr></tbody></table>"],th:_,option:g=[1,"<select multiple='multiple'>","</select>"],optgroup:g},b=8>=y.a.W,y.a.ua=function(e,n){var a;if(r){if(r.parseHTML)a=r.parseHTML(e,n)||[];else if((a=r.clean([e],n))&&a[0]){for(var o=a[0];o.parentNode&&11!==o.parentNode.nodeType;)o=o.parentNode;o.parentNode&&o.parentNode.removeChild(o)}}else{(a=n)||(a=i),o=a.parentWindow||a.defaultView||t;var s,c=y.a.Db(e).toLowerCase(),l=a.createElement("div");for(s=(c=c.match(/^(?:\x3c!--.*?--\x3e\s*?)*?<([a-z]+)[\s>]/))&&v[c[1]]||p,c=s[0],s="ignored<div>"+s[1]+e+s[2]+"</div>","function"==typeof o.innerShiv?l.appendChild(o.innerShiv(s)):(b&&a.body.appendChild(l),l.innerHTML=s,b&&l.parentNode.removeChild(l));c--;)l=l.lastChild;a=y.a.la(l.lastChild.childNodes)}return a},y.a.Md=function(e,t){var i=y.a.ua(e,t);return i.length&&i[0].parentElement||y.a.Yb(i)},y.a.fc=function(t,i){if(y.a.Tb(t),null!==(i=y.a.f(i))&&i!==e)if("string"!=typeof i&&(i=i.toString()),r)r(t).html(i);else for(var n=y.a.ua(i,t.ownerDocument),a=0;a<n.length;a++)t.appendChild(n[a])},y.b("utils.parseHtmlFragment",y.a.ua),y.b("utils.setHtml",y.a.fc),y.aa=function(){var t={};return{Xb:function(e){if("function"!=typeof e)throw Error("You can only pass a function to ko.memoization.memoize()");var i=(4294967296*(1+Math.random())|0).toString(16).substring(1)+(4294967296*(1+Math.random())|0).toString(16).substring(1);return t[i]=e,"\x3c!--[ko_memo:"+i+"]--\x3e"},bd:function(i,n){var r=t[i];if(r===e)throw Error("Couldn't find any memo with ID "+i+". Perhaps it's already been unmemoized.");try{return r.apply(null,n||[]),!0}finally{delete t[i]}},cd:function(e,t){var i=[];!function e(t,i){if(t)if(8==t.nodeType)null!=(n=y.aa.Uc(t.nodeValue))&&i.push({ud:t,Kd:n});else if(1==t.nodeType)for(var n=0,r=t.childNodes,a=r.length;n<a;n++)e(r[n],i)}(e,i);for(var n=0,r=i.length;n<r;n++){var a=i[n].ud,o=[a];t&&y.a.Nb(o,t),y.aa.bd(i[n].Kd,o),a.nodeValue="",a.parentNode&&a.parentNode.removeChild(a)}},Uc:function(e){return(e=e.match(/^\[ko_memo\:(.*?)\]$/))?e[1]:null}}}(),y.b("memoization",y.aa),y.b("memoization.memoize",y.aa.Xb),y.b("memoization.unmemoize",y.aa.bd),y.b("memoization.parseMemoText",y.aa.Uc),y.b("memoization.unmemoizeDomNodeAndDescendants",y.aa.cd),y.na=function(){function e(){if(a)for(var e,t=a,i=0;s<a;)if(e=r[s++]){if(s>t){if(5e3<=++i){s=a,y.a.Gc(Error("'Too much recursion' after processing "+i+" task groups."));break}t=a}try{e()}catch(e){y.a.Gc(e)}}}function n(){e(),s=a=r.length=0}var r=[],a=0,o=1,s=0;return{scheduler:t.MutationObserver?function(e){var t=i.createElement("div");return new MutationObserver(e).observe(t,{attributes:!0}),function(){t.classList.toggle("foo")}}(n):i&&"onreadystatechange"in i.createElement("script")?function(e){var t=i.createElement("script");t.onreadystatechange=function(){t.onreadystatechange=null,i.documentElement.removeChild(t),t=null,e()},i.documentElement.appendChild(t)}:function(e){setTimeout(e,0)},zb:function(e){return a||y.na.scheduler(n),r[a++]=e,o++},cancel:function(e){(e-=o-a)>=s&&e<a&&(r[e]=null)},resetForTesting:function(){var e=a-s;return s=a=r.length=0,e},Sd:e}}(),y.b("tasks",y.na),y.b("tasks.schedule",y.na.zb),y.b("tasks.runEarly",y.na.Sd),y.Ta={throttle:function(e,t){e.throttleEvaluation=t;var i=null;return y.$({read:e,write:function(n){clearTimeout(i),i=y.a.setTimeout((function(){e(n)}),t)}})},rateLimit:function(e,t){var i,n,r;"number"==typeof t?i=t:(i=t.timeout,n=t.method),e.Hb=!1,r="function"==typeof n?n:"notifyWhenChangesStop"==n?u:l,e.ub((function(e){return r(e,i,t)}))},deferred:function(t,i){if(!0!==i)throw Error("The 'deferred' extender only accepts the value 'true', because it is not supported to turn deferral off once enabled.");t.Hb||(t.Hb=!0,t.ub((function(i){var n,r=!1;return function(){if(!r){y.na.cancel(n),n=y.na.zb(i);try{r=!0,t.notifySubscribers(e,"dirty")}finally{r=!1}}}})))},notify:function(e,t){e.equalityComparer="always"==t?null:c}};var w={undefined:1,boolean:1,number:1,string:1};y.b("extenders",y.Ta),y.ic=function(e,t,i){this.da=e,this.lc=t,this.mc=i,this.Ib=!1,this.fb=this.Jb=null,y.L(this,"dispose",this.s),y.L(this,"disposeWhenNodeIsRemoved",this.l)},y.ic.prototype.s=function(){this.Ib||(this.fb&&y.a.K.yb(this.Jb,this.fb),this.Ib=!0,this.mc(),this.da=this.lc=this.mc=this.Jb=this.fb=null)},y.ic.prototype.l=function(e){this.Jb=e,y.a.K.za(e,this.fb=this.s.bind(this))},y.T=function(){y.a.Ab(this,O),O.qb(this)};var O={qb:function(e){e.U={change:[]},e.sc=1},subscribe:function(e,t,i){var n=this;i=i||"change";var r=new y.ic(n,t?e.bind(t):e,(function(){y.a.Pa(n.U[i],r),n.hb&&n.hb(i)}));return n.Qa&&n.Qa(i),n.U[i]||(n.U[i]=[]),n.U[i].push(r),r},notifySubscribers:function(e,t){if("change"===(t=t||"change")&&this.Gb(),this.Wa(t)){var i="change"===t&&this.ed||this.U[t].slice(0);try{y.u.xc();for(var n,r=0;n=i[r];++r)n.Ib||n.lc(e)}finally{y.u.end()}}},ob:function(){return this.sc},Dd:function(e){return this.ob()!==e},Gb:function(){++this.sc},ub:function(e){var t,i,n,r,a,o=this,s=y.O(o);o.gb||(o.gb=o.notifySubscribers,o.notifySubscribers=h);var c=e((function(){o.Ja=!1,s&&r===o&&(r=o.nc?o.nc():o());var e=i||a&&o.sb(n,r);a=i=t=!1,e&&o.gb(n=r)}));o.qc=function(e,i){i&&o.Ja||(a=!i),o.ed=o.U.change.slice(0),o.Ja=t=!0,r=e,c()},o.pc=function(e){t||(n=e,o.gb(e,"beforeChange"))},o.rc=function(){a=!0},o.gd=function(){o.sb(n,o.v(!0))&&(i=!0)}},Wa:function(e){return this.U[e]&&this.U[e].length},Bd:function(e){if(e)return this.U[e]&&this.U[e].length||0;var t=0;return y.a.P(this.U,(function(e,i){"dirty"!==e&&(t+=i.length)})),t},sb:function(e,t){return!this.equalityComparer||!this.equalityComparer(e,t)},toString:function(){return"[object Object]"},extend:function(e){var t=this;return e&&y.a.P(e,(function(e,i){var n=y.Ta[e];"function"==typeof n&&(t=n(t,i)||t)})),t}};y.L(O,"init",O.qb),y.L(O,"subscribe",O.subscribe),y.L(O,"extend",O.extend),y.L(O,"getSubscriptionsCount",O.Bd),y.a.Ba&&y.a.setPrototypeOf(O,Function.prototype),y.T.fn=O,y.Qc=function(e){return null!=e&&"function"==typeof e.subscribe&&"function"==typeof e.notifySubscribers},y.b("subscribable",y.T),y.b("isSubscribable",y.Qc),y.S=y.u=function(){function e(e){n.push(i),i=e}function t(){i=n.pop()}var i,n=[],r=0;return{xc:e,end:t,cc:function(e){if(i){if(!y.Qc(e))throw Error("Only subscribable things can act as dependencies");i.od.call(i.pd,e,e.fd||(e.fd=++r))}},G:function(i,n,r){try{return e(),i.apply(n,r||[])}finally{t()}},qa:function(){if(i)return i.o.qa()},Va:function(){if(i)return i.o.Va()},Ya:function(){if(i)return i.Ya},o:function(){if(i)return i.o}}}(),y.b("computedContext",y.S),y.b("computedContext.getDependenciesCount",y.S.qa),y.b("computedContext.getDependencies",y.S.Va),y.b("computedContext.isInitial",y.S.Ya),y.b("computedContext.registerDependency",y.S.cc),y.b("ignoreDependencies",y.Yd=y.u.G);var x=y.a.Da("_latestValue");y.ta=function(e){function t(){return 0<arguments.length?(t.sb(t[x],arguments[0])&&(t.ya(),t[x]=arguments[0],t.xa()),this):(y.u.cc(t),t[x])}return t[x]=e,y.a.Ba||y.a.extend(t,y.T.fn),y.T.fn.qb(t),y.a.Ab(t,E),y.options.deferUpdates&&y.Ta.deferred(t,!0),t};var E={equalityComparer:c,v:function(){return this[x]},xa:function(){this.notifySubscribers(this[x],"spectate"),this.notifySubscribers(this[x])},ya:function(){this.notifySubscribers(this[x],"beforeChange")}};y.a.Ba&&y.a.setPrototypeOf(E,y.T.fn);var T=y.ta.Ma="__ko_proto__";E[T]=y.ta,y.O=function(e){if((e="function"==typeof e&&e[T])&&e!==E[T]&&e!==y.o.fn[T])throw Error("Invalid object that looks like an observable; possibly from another Knockout instance");return!!e},y.Za=function(e){return"function"==typeof e&&(e[T]===E[T]||e[T]===y.o.fn[T]&&e.Nc)},y.b("observable",y.ta),y.b("isObservable",y.O),y.b("isWriteableObservable",y.Za),y.b("isWritableObservable",y.Za),y.b("observable.fn",E),y.L(E,"peek",E.v),y.L(E,"valueHasMutated",E.xa),y.L(E,"valueWillMutate",E.ya),y.Ha=function(e){if("object"!=typeof(e=e||[])||!("length"in e))throw Error("The argument passed when initializing an observable array must be an array, or null, or undefined.");return e=y.ta(e),y.a.Ab(e,y.Ha.fn),e.extend({trackArrayChanges:!0})},y.Ha.fn={remove:function(e){for(var t=this.v(),i=[],n="function"!=typeof e||y.O(e)?function(t){return t===e}:e,r=0;r<t.length;r++){var a=t[r];if(n(a)){if(0===i.length&&this.ya(),t[r]!==a)throw Error("Array modified during remove; cannot remove item");i.push(a),t.splice(r,1),r--}}return i.length&&this.xa(),i},removeAll:function(t){if(t===e){var i=this.v(),n=i.slice(0);return this.ya(),i.splice(0,i.length),this.xa(),n}return t?this.remove((function(e){return 0<=y.a.A(t,e)})):[]},destroy:function(e){var t=this.v(),i="function"!=typeof e||y.O(e)?function(t){return t===e}:e;this.ya();for(var n=t.length-1;0<=n;n--){var r=t[n];i(r)&&(r._destroy=!0)}this.xa()},destroyAll:function(t){return t===e?this.destroy((function(){return!0})):t?this.destroy((function(e){return 0<=y.a.A(t,e)})):[]},indexOf:function(e){var t=this();return y.a.A(t,e)},replace:function(e,t){var i=this.indexOf(e);0<=i&&(this.ya(),this.v()[i]=t,this.xa())},sorted:function(e){var t=this().slice(0);return e?t.sort(e):t.sort()},reversed:function(){return this().slice(0).reverse()}},y.a.Ba&&y.a.setPrototypeOf(y.Ha.fn,y.ta.fn),y.a.D("pop push reverse shift sort splice unshift".split(" "),(function(e){y.Ha.fn[e]=function(){var t=this.v();this.ya(),this.zc(t,e,arguments);var i=t[e].apply(t,arguments);return this.xa(),i===t?this:i}})),y.a.D(["slice"],(function(e){y.Ha.fn[e]=function(){var t=this();return t[e].apply(t,arguments)}})),y.Pc=function(e){return y.O(e)&&"function"==typeof e.remove&&"function"==typeof e.push},y.b("observableArray",y.Ha),y.b("isObservableArray",y.Pc),y.Ta.trackArrayChanges=function(t,i){function n(){function e(){if(l){var e,i=[].concat(t.v()||[]);t.Wa("arrayChange")&&((!c||1<l)&&(c=y.a.Pb(o,i,t.Ob)),e=c),o=i,c=null,l=0,e&&e.length&&t.notifySubscribers(e,"arrayChange")}}s?e():(s=!0,a=t.subscribe((function(){++l}),null,"spectate"),o=[].concat(t.v()||[]),c=null,r=t.subscribe(e))}if(t.Ob={},i&&"object"==typeof i&&y.a.extend(t.Ob,i),t.Ob.sparse=!0,!t.zc){var r,a,o,s=!1,c=null,l=0,u=t.Qa,h=t.hb;t.Qa=function(e){u&&u.call(t,e),"arrayChange"===e&&n()},t.hb=function(i){h&&h.call(t,i),"arrayChange"!==i||t.Wa("arrayChange")||(r&&r.s(),a&&a.s(),a=r=null,s=!1,o=e)},t.zc=function(e,t,i){function n(e,t,i){return r[r.length]={status:e,value:t,index:i}}if(s&&!l){var r=[],a=e.length,o=i.length,u=0;switch(t){case"push":u=a;case"unshift":for(t=0;t<o;t++)n("added",i[t],u+t);break;case"pop":u=a-1;case"shift":a&&n("deleted",e[u],u);break;case"splice":t=Math.min(Math.max(0,0>i[0]?a+i[0]:i[0]),a),a=1===o?a:Math.min(t+(i[1]||0),a),o=t+o-2,u=Math.max(a,o);for(var h=[],d=[],f=2;t<u;++t,++f)t<a&&d.push(n("deleted",e[t],t)),t<o&&h.push(n("added",i[f],t));y.a.Kc(d,h);break;default:return}c=r}}}};var C=y.a.Da("_state");y.o=y.$=function(t,i,n){function r(){if(0<arguments.length){if("function"!=typeof a)throw Error("Cannot write a value to a ko.computed unless you specify a 'write' option. If you wish to read the current value, don't pass any parameters.");return a.apply(o.nb,arguments),this}return o.ra||y.u.cc(r),(o.ka||o.J&&r.Xa())&&r.ha(),o.X}if("object"==typeof t?n=t:(n=n||{},t&&(n.read=t)),"function"!=typeof n.read)throw Error("Pass a function that returns the value of the ko.computed");var a=n.write,o={X:e,sa:!0,ka:!0,rb:!1,jc:!1,ra:!1,wb:!1,J:!1,Wc:n.read,nb:i||n.owner,l:n.disposeWhenNodeIsRemoved||n.l||null,Sa:n.disposeWhen||n.Sa,Rb:null,I:{},V:0,Ic:null};return r[C]=o,r.Nc="function"==typeof a,y.a.Ba||y.a.extend(r,y.T.fn),y.T.fn.qb(r),y.a.Ab(r,S),n.pure?(o.wb=!0,o.J=!0,y.a.extend(r,A)):n.deferEvaluation&&y.a.extend(r,P),y.options.deferUpdates&&y.Ta.deferred(r,!0),o.l&&(o.jc=!0,o.l.nodeType||(o.l=null)),o.J||n.deferEvaluation||r.ha(),o.l&&r.ja()&&y.a.K.za(o.l,o.Rb=function(){r.s()}),r};var S={equalityComparer:c,qa:function(){return this[C].V},Va:function(){var e=[];return y.a.P(this[C].I,(function(t,i){e[i.Ka]=i.da})),e},Vb:function(e){if(!this[C].V)return!1;var t=this.Va();return-1!==y.a.A(t,e)||!!y.a.Lb(t,(function(t){return t.Vb&&t.Vb(e)}))},uc:function(e,t,i){if(this[C].wb&&t===this)throw Error("A 'pure' computed must not be called recursively");this[C].I[e]=i,i.Ka=this[C].V++,i.La=t.ob()},Xa:function(){var e,t,i=this[C].I;for(e in i)if(Object.prototype.hasOwnProperty.call(i,e)&&(t=i[e],this.Ia&&t.da.Ja||t.da.Dd(t.La)))return!0},Jd:function(){this.Ia&&!this[C].rb&&this.Ia(!1)},ja:function(){var e=this[C];return e.ka||0<e.V},Rd:function(){this.Ja?this[C].ka&&(this[C].sa=!0):this.Hc()},$c:function(e){if(e.Hb){var t=e.subscribe(this.Jd,this,"dirty"),i=e.subscribe(this.Rd,this);return{da:e,s:function(){t.s(),i.s()}}}return e.subscribe(this.Hc,this)},Hc:function(){var e=this,t=e.throttleEvaluation;t&&0<=t?(clearTimeout(this[C].Ic),this[C].Ic=y.a.setTimeout((function(){e.ha(!0)}),t)):e.Ia?e.Ia(!0):e.ha(!0)},ha:function(e){var t=this[C],i=t.Sa,n=!1;if(!t.rb&&!t.ra){if(t.l&&!y.a.Sb(t.l)||i&&i()){if(!t.jc)return void this.s()}else t.jc=!1;t.rb=!0;try{n=this.zd(e)}finally{t.rb=!1}return n}},zd:function(t){var i=this[C],n=!1,r=i.wb?e:!i.V;n={qd:this,mb:i.I,Qb:i.V},y.u.xc({pd:n,od:f,o:this,Ya:r}),i.I={},i.V=0;var a=this.yd(i,n);return i.V?n=this.sb(i.X,a):(this.s(),n=!0),n&&(i.J?this.Gb():this.notifySubscribers(i.X,"beforeChange"),i.X=a,this.notifySubscribers(i.X,"spectate"),!i.J&&t&&this.notifySubscribers(i.X),this.rc&&this.rc()),r&&this.notifySubscribers(i.X,"awake"),n},yd:function(e,t){try{var i=e.Wc;return e.nb?i.call(e.nb):i()}finally{y.u.end(),t.Qb&&!e.J&&y.a.P(t.mb,d),e.sa=e.ka=!1}},v:function(e){var t=this[C];return(t.ka&&(e||!t.V)||t.J&&this.Xa())&&this.ha(),t.X},ub:function(e){y.T.fn.ub.call(this,e),this.nc=function(){return this[C].J||(this[C].sa?this.ha():this[C].ka=!1),this[C].X},this.Ia=function(e){this.pc(this[C].X),this[C].ka=!0,e&&(this[C].sa=!0),this.qc(this,!e)}},s:function(){var t=this[C];!t.J&&t.I&&y.a.P(t.I,(function(e,t){t.s&&t.s()})),t.l&&t.Rb&&y.a.K.yb(t.l,t.Rb),t.I=e,t.V=0,t.ra=!0,t.sa=!1,t.ka=!1,t.J=!1,t.l=e,t.Sa=e,t.Wc=e,this.Nc||(t.nb=e)}},A={Qa:function(e){var t=this,i=t[C];if(!i.ra&&i.J&&"change"==e){if(i.J=!1,i.sa||t.Xa())i.I=null,i.V=0,t.ha()&&t.Gb();else{var n=[];y.a.P(i.I,(function(e,t){n[t.Ka]=e})),y.a.D(n,(function(e,n){var r=i.I[e],a=t.$c(r.da);a.Ka=n,a.La=r.La,i.I[e]=a})),t.Xa()&&t.ha()&&t.Gb()}i.ra||t.notifySubscribers(i.X,"awake")}},hb:function(t){var i=this[C];i.ra||"change"!=t||this.Wa("change")||(y.a.P(i.I,(function(e,t){t.s&&(i.I[e]={da:t.da,Ka:t.Ka,La:t.La},t.s())})),i.J=!0,this.notifySubscribers(e,"asleep"))},ob:function(){var e=this[C];return e.J&&(e.sa||this.Xa())&&this.ha(),y.T.fn.ob.call(this)}},P={Qa:function(e){"change"!=e&&"beforeChange"!=e||this.v()}};y.a.Ba&&y.a.setPrototypeOf(S,y.T.fn);var I=y.ta.Ma;S[I]=y.o,y.Oc=function(e){return"function"==typeof e&&e[I]===S[I]},y.Fd=function(e){return y.Oc(e)&&e[C]&&e[C].wb},y.b("computed",y.o),y.b("dependentObservable",y.o),y.b("isComputed",y.Oc),y.b("isPureComputed",y.Fd),y.b("computed.fn",S),y.L(S,"peek",S.v),y.L(S,"dispose",S.s),y.L(S,"isActive",S.ja),y.L(S,"getDependenciesCount",S.qa),y.L(S,"getDependencies",S.Va),y.xb=function(e,t){return"function"==typeof e?y.o(e,t,{pure:!0}):((e=y.a.extend({},e)).pure=!0,y.o(e,t))},y.b("pureComputed",y.xb),function(){function t(n,r,a){if(a=a||new i,"object"!=typeof(n=r(n))||null===n||n===e||n instanceof RegExp||n instanceof Date||n instanceof String||n instanceof Number||n instanceof Boolean)return n;var o=n instanceof Array?[]:{};return a.save(n,o),function(e,t){if(e instanceof Array){for(var i=0;i<e.length;i++)t(i);"function"==typeof e.toJSON&&t("toJSON")}else for(i in e)t(i)}(n,(function(i){var s=r(n[i]);switch(typeof s){case"boolean":case"number":case"string":case"function":o[i]=s;break;case"object":case"undefined":var c=a.get(s);o[i]=c!==e?c:t(s,r,a)}})),o}function i(){this.keys=[],this.values=[]}y.ad=function(e){if(0==arguments.length)throw Error("When calling ko.toJS, pass the object you want to convert.");return t(e,(function(e){for(var t=0;y.O(e)&&10>t;t++)e=e();return e}))},y.toJSON=function(e,t,i){return e=y.ad(e),y.a.hc(e,t,i)},i.prototype={constructor:i,save:function(e,t){var i=y.a.A(this.keys,e);0<=i?this.values[i]=t:(this.keys.push(e),this.values.push(t))},get:function(t){return 0<=(t=y.a.A(this.keys,t))?this.values[t]:e}}}(),y.b("toJS",y.ad),y.b("toJSON",y.toJSON),y.Wd=function(e,t,i){function n(t){var n=y.xb(e,i).extend({ma:"always"}),r=n.subscribe((function(e){e&&(r.s(),t(e))}));return n.notifySubscribers(n.v()),r}return"function"!=typeof Promise||t?n(t.bind(i)):new Promise(n)},y.b("when",y.Wd),y.w={M:function(t){switch(y.a.R(t)){case"option":return!0===t.__ko__hasDomDataOptionValue__?y.a.g.get(t,y.c.options.$b):7>=y.a.W?t.getAttributeNode("value")&&t.getAttributeNode("value").specified?t.value:t.text:t.value;case"select":return 0<=t.selectedIndex?y.w.M(t.options[t.selectedIndex]):e;default:return t.value}},cb:function(t,i,n){switch(y.a.R(t)){case"option":"string"==typeof i?(y.a.g.set(t,y.c.options.$b,e),"__ko__hasDomDataOptionValue__"in t&&delete t.__ko__hasDomDataOptionValue__,t.value=i):(y.a.g.set(t,y.c.options.$b,i),t.__ko__hasDomDataOptionValue__=!0,t.value="number"==typeof i?i:"");break;case"select":""!==i&&null!==i||(i=e);for(var r,a=-1,o=0,s=t.options.length;o<s;++o)if((r=y.w.M(t.options[o]))==i||""===r&&i===e){a=o;break}(n||0<=a||i===e&&1<t.size)&&(t.selectedIndex=a,6===y.a.W&&y.a.setTimeout((function(){t.selectedIndex=a}),0));break;default:null!==i&&i!==e||(i=""),t.value=i}}},y.b("selectExtensions",y.w),y.b("selectExtensions.readValue",y.w.M),y.b("selectExtensions.writeValue",y.w.cb),y.m=function(){function e(e){123===(e=y.a.Db(e)).charCodeAt(0)&&(e=e.slice(1,-1));var t,i=[],o=(e+="\n,").match(n),s=[],c=0;if(1<o.length){for(var l,u=0;l=o[u];++u){var h=l.charCodeAt(0);if(44===h){if(0>=c){i.push(t&&s.length?{key:t,value:s.join("")}:{unknown:t||s.join("")}),t=c=0,s=[];continue}}else if(58===h){if(!c&&!t&&1===s.length){t=s.pop();continue}}else{if(47===h&&1<l.length&&(47===l.charCodeAt(1)||42===l.charCodeAt(1)))continue;47===h&&u&&1<l.length?(h=o[u-1].match(r))&&!a[h[0]]&&(o=(e=e.substr(e.indexOf(l)+1)).match(n),u=-1,l="/"):40===h||123===h||91===h?++c:41===h||125===h||93===h?--c:t||s.length||34!==h&&39!==h||(l=l.slice(1,-1))}s.push(l)}if(0<c)throw Error("Unbalanced parentheses, braces, or brackets")}return i}var t=["true","false","null","undefined"],i=/^(?:[$_a-z][$\w]*|(.+)(\.\s*[$_a-z][$\w]*|\[.+\]))$/i,n=RegExp("\"(?:\\\\.|[^\"])*\"|'(?:\\\\.|[^'])*'|`(?:\\\\.|[^`])*`|/\\*(?:[^*]|\\*+[^*/])*\\*+/|//.*\n|/(?:\\\\.|[^/])+/w*|[^\\s:,/][^,\"'`{}()/:[\\]]*[^\\s,\"'`{}()/:[\\]]|[^\\s]","g"),r=/[\])"'A-Za-z0-9_$]+$/,a={in:1,return:1,typeof:1},o={};return{Ra:[],wa:o,ac:e,vb:function(n,r){function a(e,n){var r;if(!u){var h=y.getBindingHandler(e);if(h&&h.preprocess&&!(n=h.preprocess(n,e,a)))return;(h=o[e])&&(r=n,0<=y.a.A(t,r)?r=!1:(h=r.match(i),r=null!==h&&(h[1]?"Object("+h[1]+")"+h[2]:r)),h=r),h&&c.push("'"+("string"==typeof o[e]?o[e]:e)+"':function(_z){"+r+"=_z}")}l&&(n="function(){return "+n+" }"),s.push("'"+e+"':"+n)}var s=[],c=[],l=(r=r||{}).valueAccessors,u=r.bindingParams,h="string"==typeof n?e(n):n;return y.a.D(h,(function(e){a(e.key||e.unknown,e.value)})),c.length&&a("_ko_property_writers","{"+c.join(",")+" }"),s.join(",")},Id:function(e,t){for(var i=0;i<e.length;i++)if(e[i].key==t)return!0;return!1},eb:function(e,t,i,n,r){e&&y.O(e)?!y.Za(e)||r&&e.v()===n||e(n):(e=t.get("_ko_property_writers"))&&e[i]&&e[i](n)}}}(),y.b("expressionRewriting",y.m),y.b("expressionRewriting.bindingRewriteValidators",y.m.Ra),y.b("expressionRewriting.parseObjectLiteral",y.m.ac),y.b("expressionRewriting.preProcessBindings",y.m.vb),y.b("expressionRewriting._twoWayBindings",y.m.wa),y.b("jsonExpressionRewriting",y.m),y.b("jsonExpressionRewriting.insertPropertyAccessorsIntoJson",y.m.vb),function(){function e(e){return 8==e.nodeType&&o.test(a?e.text:e.nodeValue)}function t(e){return 8==e.nodeType&&s.test(a?e.text:e.nodeValue)}function n(i,n){for(var r=i,a=1,o=[];r=r.nextSibling;){if(t(r)&&(y.a.g.set(r,l,!0),0==--a))return o;o.push(r),e(r)&&a++}if(!n)throw Error("Cannot find closing comment tag to match: "+i.nodeValue);return null}function r(e,t){var i=n(e,t);return i?0<i.length?i[i.length-1].nextSibling:e.nextSibling:null}var a=i&&"\x3c!--test--\x3e"===i.createComment("test").text,o=a?/^\x3c!--\s*ko(?:\s+([\s\S]+))?\s*--\x3e$/:/^\s*ko(?:\s+([\s\S]+))?\s*$/,s=a?/^\x3c!--\s*\/ko\s*--\x3e$/:/^\s*\/ko\s*$/,c={ul:!0,ol:!0},l="__ko_matchedEndComment__";y.h={ea:{},childNodes:function(t){return e(t)?n(t):t.childNodes},Ea:function(t){if(e(t))for(var i=0,n=(t=y.h.childNodes(t)).length;i<n;i++)y.removeNode(t[i]);else y.a.Tb(t)},va:function(t,i){if(e(t)){y.h.Ea(t);for(var n=t.nextSibling,r=0,a=i.length;r<a;r++)n.parentNode.insertBefore(i[r],n)}else y.a.va(t,i)},Vc:function(t,i){var n;e(t)?(n=t.nextSibling,t=t.parentNode):n=t.firstChild,n?i!==n&&t.insertBefore(i,n):t.appendChild(i)},Wb:function(t,i,n){n?(n=n.nextSibling,e(t)&&(t=t.parentNode),n?i!==n&&t.insertBefore(i,n):t.appendChild(i)):y.h.Vc(t,i)},firstChild:function(i){if(e(i))return!i.nextSibling||t(i.nextSibling)?null:i.nextSibling;if(i.firstChild&&t(i.firstChild))throw Error("Found invalid end comment, as the first child of "+i);return i.firstChild},nextSibling:function(i){if(e(i)&&(i=r(i)),i.nextSibling&&t(i.nextSibling)){var n=i.nextSibling;if(t(n)&&!y.a.g.get(n,l))throw Error("Found end comment without a matching opening comment, as child of "+i);return null}return i.nextSibling},Cd:e,Vd:function(e){return(e=(a?e.text:e.nodeValue).match(o))?e[1]:null},Sc:function(i){if(c[y.a.R(i)]){var n=i.firstChild;if(n)do{if(1===n.nodeType){var a,o=null;if(a=n.firstChild)do{if(o)o.push(a);else if(e(a)){var s=r(a,!0);s?a=s:o=[a]}else t(a)&&(o=[a])}while(a=a.nextSibling);if(a=o)for(o=n.nextSibling,s=0;s<a.length;s++)o?i.insertBefore(a[s],o):i.appendChild(a[s])}}while(n=n.nextSibling)}}}}(),y.b("virtualElements",y.h),y.b("virtualElements.allowedBindings",y.h.ea),y.b("virtualElements.emptyNode",y.h.Ea),y.b("virtualElements.insertAfter",y.h.Wb),y.b("virtualElements.prepend",y.h.Vc),y.b("virtualElements.setDomNodeChildren",y.h.va),y.ga=function(){this.nd={}},y.a.extend(y.ga.prototype,{nodeHasBindings:function(e){switch(e.nodeType){case 1:return null!=e.getAttribute("data-bind")||y.j.getComponentNameForNode(e);case 8:return y.h.Cd(e);default:return!1}},getBindings:function(e,t){var i=(i=this.getBindingsString(e,t))?this.parseBindingsString(i,t,e):null;return y.j.tc(i,e,t,!1)},getBindingAccessors:function(e,t){var i=(i=this.getBindingsString(e,t))?this.parseBindingsString(i,t,e,{valueAccessors:!0}):null;return y.j.tc(i,e,t,!0)},getBindingsString:function(e){switch(e.nodeType){case 1:return e.getAttribute("data-bind");case 8:return y.h.Vd(e);default:return null}},parseBindingsString:function(e,t,i,n){try{var r,a=this.nd,o=e+(n&&n.valueAccessors||"");if(!(r=a[o])){var s,c="with($context){with($data||{}){return{"+y.m.vb(e,n)+"}}}";s=new Function("$context","$element",c),r=a[o]=s}return r(t,i)}catch(t){throw t.message="Unable to parse bindings.\nBindings value: "+e+"\nMessage: "+t.message,t}}}),y.ga.instance=new y.ga,y.b("bindingProvider",y.ga),function(){function n(e){var t=(e=y.a.g.get(e,w))&&e.N;t&&(e.N=null,t.Tc())}function a(e,t,i){this.node=e,this.yc=t,this.kb=[],this.H=!1,t.N||y.a.K.za(e,n),i&&i.N&&(i.N.kb.push(e),this.Kb=i)}function o(e){return function(){return e}}function s(e){return e()}function c(e){return y.a.Ga(y.u.G(e),(function(t,i){return function(){return e()[i]}}))}function l(e,t,i){return"function"==typeof e?c(e.bind(null,t,i)):y.a.Ga(e,o)}function u(e,t){return c(this.getBindings.bind(this,e,t))}function h(e,t){var i=y.h.firstChild(t);if(i){var n,r=y.ga.instance,a=r.preprocessNode;if(a){for(;n=i;)i=y.h.nextSibling(n),a.call(r,n);i=y.h.firstChild(t)}for(;n=i;)i=y.h.nextSibling(n),d(e,n)}y.i.ma(t,y.i.H)}function d(e,t){var i=e,n=1===t.nodeType;n&&y.h.Sc(t),(n||y.ga.instance.nodeHasBindings(t))&&(i=f(t,null,e).bindingContextForDescendants),i&&!v[y.a.R(t)]&&h(i,t)}function f(t,i,n){var r,a=y.a.g.Ub(t,w,{}),o=a.hd;if(!i){if(o)throw Error("You cannot apply bindings multiple times to the same element.");a.hd=!0}if(o||(a.context=n),a.Zb||(a.Zb={}),i&&"function"!=typeof i)r=i;else{var c=y.ga.instance,l=c.getBindingAccessors||u,h=y.$((function(){return(r=i?i(n,t):l.call(c,t,n))&&(n[m]&&n[m](),n[g]&&n[g]()),r}),null,{l:t});r&&h.ja()||(h=null)}var d,f=n;if(r){var p=function(){return y.a.Ga(h?h():r,s)},_=h?function(e){return function(){return s(h()[e])}}:function(e){return r[e]};p.get=function(e){return r[e]&&s(_(e))},p.has=function(e){return e in r},y.i.H in r&&y.i.subscribe(t,y.i.H,(function(){var e=(0,r[y.i.H])();if(e){var i=y.h.childNodes(t);i.length&&e(i,y.Ec(i[0]))}})),y.i.pa in r&&(f=y.i.Cb(t,n),y.i.subscribe(t,y.i.pa,(function(){var e=(0,r[y.i.pa])();e&&y.h.firstChild(t)&&e(t)}))),a=function(e){var t=[],i={},n=[];return y.a.P(e,(function r(a){if(!i[a]){var o=y.getBindingHandler(a);o&&(o.after&&(n.push(a),y.a.D(o.after,(function(t){if(e[t]){if(-1!==y.a.A(n,t))throw Error("Cannot combine the following bindings, because they have a cyclic dependency: "+n.join(", "));r(t)}})),n.length--),t.push({key:a,Mc:o})),i[a]=!0}})),t}(r),y.a.D(a,(function(i){var n=i.Mc.init,a=i.Mc.update,o=i.key;if(8===t.nodeType&&!y.h.ea[o])throw Error("The binding '"+o+"' cannot be used with virtual elements");try{"function"==typeof n&&y.u.G((function(){var i=n(t,_(o),p,f.$data,f);if(i&&i.controlsDescendantBindings){if(d!==e)throw Error("Multiple bindings ("+d+" and "+o+") are trying to control descendant bindings of the same element. You cannot use these bindings together on the same element.");d=o}})),"function"==typeof a&&y.$((function(){a(t,_(o),p,f.$data,f)}),null,{l:t})}catch(e){throw e.message='Unable to process binding "'+o+": "+r[o]+'"\nMessage: '+e.message,e}}))}return{shouldBindDescendants:a=d===e,bindingContextForDescendants:a&&f}}function p(t,i){return t&&t instanceof y.fa?t:new y.fa(t,e,e,i)}var m=y.a.Da("_subscribable"),_=y.a.Da("_ancestorBindingInfo"),g=y.a.Da("_dataDependency");y.c={};var v={script:!0,textarea:!0,template:!0};y.getBindingHandler=function(e){return y.c[e]};var b={};y.fa=function(t,i,n,r,a){function o(){var e=h?u():u,t=y.a.f(e);return i?(y.a.extend(c,i),_ in i&&(c[_]=i[_])):(c.$parents=[],c.$root=t,c.ko=y),c[m]=s,l?t=c.$data:(c.$rawData=e,c.$data=t),n&&(c[n]=t),r&&r(c,i,t),i&&i[m]&&!y.S.o().Vb(i[m])&&i[m](),d&&(c[g]=d),c.$data}var s,c=this,l=t===b,u=l?e:t,h="function"==typeof u&&!y.O(u),d=a&&a.dataDependency;a&&a.exportDependencies?o():((s=y.xb(o)).v(),s.ja()?s.equalityComparer=null:c[m]=e)},y.fa.prototype.createChildContext=function(e,t,i,n){if(!n&&t&&"object"==typeof t&&(t=(n=t).as,i=n.extend),t&&n&&n.noChildContext){var r="function"==typeof e&&!y.O(e);return new y.fa(b,this,null,(function(n){i&&i(n),n[t]=r?e():e}),n)}return new y.fa(e,this,t,(function(e,t){e.$parentContext=t,e.$parent=t.$data,e.$parents=(t.$parents||[]).slice(0),e.$parents.unshift(e.$parent),i&&i(e)}),n)},y.fa.prototype.extend=function(e,t){return new y.fa(b,this,null,(function(t){y.a.extend(t,"function"==typeof e?e(t):e)}),t)};var w=y.a.g.Z();a.prototype.Tc=function(){this.Kb&&this.Kb.N&&this.Kb.N.sd(this.node)},a.prototype.sd=function(e){y.a.Pa(this.kb,e),!this.kb.length&&this.H&&this.Cc()},a.prototype.Cc=function(){this.H=!0,this.yc.N&&!this.kb.length&&(this.yc.N=null,y.a.K.yb(this.node,n),y.i.ma(this.node,y.i.pa),this.Tc())},y.i={H:"childrenComplete",pa:"descendantsComplete",subscribe:function(e,t,i,n,r){var a=y.a.g.Ub(e,w,{});return a.Fa||(a.Fa=new y.T),r&&r.notifyImmediately&&a.Zb[t]&&y.u.G(i,n,[e]),a.Fa.subscribe(i,n,t)},ma:function(t,i){var n=y.a.g.get(t,w);if(n&&(n.Zb[i]=!0,n.Fa&&n.Fa.notifySubscribers(t,i),i==y.i.H))if(n.N)n.N.Cc();else if(n.N===e&&n.Fa&&n.Fa.Wa(y.i.pa))throw Error("descendantsComplete event not supported for bindings on this node")},Cb:function(e,t){var i=y.a.g.Ub(e,w,{});return i.N||(i.N=new a(e,i,t[_])),t[_]==i?t:t.extend((function(e){e[_]=i}))}},y.Td=function(e){return(e=y.a.g.get(e,w))&&e.context},y.ib=function(e,t,i){return 1===e.nodeType&&y.h.Sc(e),f(e,t,p(i))},y.ld=function(e,t,i){return i=p(i),y.ib(e,l(t,i,e),i)},y.Oa=function(e,t){1!==t.nodeType&&8!==t.nodeType||h(p(e),t)},y.vc=function(e,n,a){if(!r&&t.jQuery&&(r=t.jQuery),2>arguments.length){if(!(n=i.body))throw Error("ko.applyBindings: could not find document.body; has the document been loaded?")}else if(!n||1!==n.nodeType&&8!==n.nodeType)throw Error("ko.applyBindings: first parameter should be your view model; second parameter should be a DOM node");d(p(e,a),n)},y.Dc=function(t){return!t||1!==t.nodeType&&8!==t.nodeType?e:y.Td(t)},y.Ec=function(t){return(t=y.Dc(t))?t.$data:e},y.b("bindingHandlers",y.c),y.b("bindingEvent",y.i),y.b("bindingEvent.subscribe",y.i.subscribe),y.b("bindingEvent.startPossiblyAsyncContentBinding",y.i.Cb),y.b("applyBindings",y.vc),y.b("applyBindingsToDescendants",y.Oa),y.b("applyBindingAccessorsToNode",y.ib),y.b("applyBindingsToNode",y.ld),y.b("contextFor",y.Dc),y.b("dataFor",y.Ec)}(),function(e){function t(t,n){var o,s=Object.prototype.hasOwnProperty.call(r,t)?r[t]:e;s?s.subscribe(n):((s=r[t]=new y.T).subscribe(n),i(t,(function(e,i){var n=!(!i||!i.synchronous);a[t]={definition:e,Gd:n},delete r[t],o||n?s.notifySubscribers(e):y.na.zb((function(){s.notifySubscribers(e)}))})),o=!0)}function i(e,t){n("getConfig",[e],(function(i){i?n("loadComponent",[e,i],(function(e){t(e,i)})):t(null,null)}))}function n(t,i,r,a){a||(a=y.j.loaders.slice(0));var o=a.shift();if(o){var s=o[t];if(s){var c=!1;if(s.apply(o,i.concat((function(e){c?r(null):null!==e?r(e):n(t,i,r,a)})))!==e&&(c=!0,!o.suppressLoaderExceptions))throw Error("Component loaders must supply values by invoking the callback, not by returning values synchronously.")}else n(t,i,r,a)}else r(null)}var r={},a={};y.j={get:function(i,n){var r=Object.prototype.hasOwnProperty.call(a,i)?a[i]:e;r?r.Gd?y.u.G((function(){n(r.definition)})):y.na.zb((function(){n(r.definition)})):t(i,n)},Bc:function(e){delete a[e]},oc:n},y.j.loaders=[],y.b("components",y.j),y.b("components.get",y.j.get),y.b("components.clearCachedDefinition",y.j.Bc)}(),function(){function e(e,t,i,n){function r(){0==--s&&n(o)}var o={},s=2,c=i.template;i=i.viewModel,c?a(t,c,(function(t){y.j.oc("loadTemplate",[e,t],(function(e){o.template=e,r()}))})):r(),i?a(t,i,(function(t){y.j.oc("loadViewModel",[e,t],(function(e){o[l]=e,r()}))})):r()}function n(e){switch(y.a.R(e)){case"script":return y.a.ua(e.text);case"textarea":return y.a.ua(e.value);case"template":if(r(e.content))return y.a.Ca(e.content.childNodes)}return y.a.Ca(e.childNodes)}function r(e){return t.DocumentFragment?e instanceof DocumentFragment:e&&11===e.nodeType}function a(e,i,n){"string"==typeof i.require?s||t.require?(s||t.require)([i.require],(function(e){e&&"object"==typeof e&&e.Xd&&e.default&&(e=e.default),n(e)})):e("Uses require, but no AMD loader is present"):n(i)}function o(e){return function(t){throw Error("Component '"+e+"': "+t)}}var c={};y.j.register=function(e,t){if(!t)throw Error("Invalid configuration for "+e);if(y.j.tb(e))throw Error("Component "+e+" is already registered");c[e]=t},y.j.tb=function(e){return Object.prototype.hasOwnProperty.call(c,e)},y.j.unregister=function(e){delete c[e],y.j.Bc(e)},y.j.Fc={getConfig:function(e,t){t(y.j.tb(e)?c[e]:null)},loadComponent:function(t,i,n){var r=o(t);a(r,i,(function(i){e(t,r,i,n)}))},loadTemplate:function(e,a,s){if(e=o(e),"string"==typeof a)s(y.a.ua(a));else if(a instanceof Array)s(a);else if(r(a))s(y.a.la(a.childNodes));else if(a.element)if(a=a.element,t.HTMLElement?a instanceof HTMLElement:a&&a.tagName&&1===a.nodeType)s(n(a));else if("string"==typeof a){var c=i.getElementById(a);c?s(n(c)):e("Cannot find element with ID "+a)}else e("Unknown element type: "+a);else e("Unknown template value: "+a)},loadViewModel:function(e,t,i){!function e(t,i,n){if("function"==typeof i)n((function(e){return new i(e)}));else if("function"==typeof i[l])n(i[l]);else if("instance"in i){var r=i.instance;n((function(){return r}))}else"viewModel"in i?e(t,i.viewModel,n):t("Unknown viewModel value: "+i)}(o(e),t,i)}};var l="createViewModel";y.b("components.register",y.j.register),y.b("components.isRegistered",y.j.tb),y.b("components.unregister",y.j.unregister),y.b("components.defaultLoader",y.j.Fc),y.j.loaders.push(y.j.Fc),y.j.dd=c}(),function(){function e(e,i){if(n=e.getAttribute("params")){var n=t.parseBindingsString(n,i,e,{valueAccessors:!0,bindingParams:!0}),r=(n=y.a.Ga(n,(function(t){return y.o(t,null,{l:e})})),y.a.Ga(n,(function(t){var i=t.v();return t.ja()?y.o({read:function(){return y.a.f(t())},write:y.Za(i)&&function(e){t()(e)},l:e}):i})));return Object.prototype.hasOwnProperty.call(r,"$raw")||(r.$raw=n),r}return{$raw:{}}}y.j.getComponentNameForNode=function(e){var t=y.a.R(e);if(y.j.tb(t)&&(-1!=t.indexOf("-")||"[object HTMLUnknownElement]"==""+e||8>=y.a.W&&e.tagName===t))return t},y.j.tc=function(t,i,n,r){if(1===i.nodeType){var a=y.j.getComponentNameForNode(i);if(a){if((t=t||{}).component)throw Error('Cannot use the "component" binding on a custom element matching a component');var o={name:a,params:e(i,n)};t.component=r?function(){return o}:o}}return t};var t=new y.ga;9>y.a.W&&(y.j.register=function(e){return function(t){return e.apply(this,arguments)}}(y.j.register),i.createDocumentFragment=function(e){return function(){var t,i=e(),n=y.j.dd;for(t in n);return i}}(i.createDocumentFragment))}(),function(){var e=0;y.c.component={init:function(t,i,n,r,a){function o(){var e=s&&s.dispose;"function"==typeof e&&e.call(s),l&&l.s(),c=s=l=null}var s,c,l,u=y.a.la(y.h.childNodes(t));return y.h.Ea(t),y.a.K.za(t,o),y.o((function(){var n,r,h=y.a.f(i());if("string"==typeof h?n=h:(n=y.a.f(h.name),r=y.a.f(h.params)),!n)throw Error("No component name specified");var d=y.i.Cb(t,a),f=c=++e;y.j.get(n,(function(e){if(c===f){if(o(),!e)throw Error("Unknown component '"+n+"'");!function(e,t,i){if(!(t=t.template))throw Error("Component '"+e+"' has no template");e=y.a.Ca(t),y.h.va(i,e)}(n,e,t);var i=function(e,t,i){var n=e.createViewModel;return n?n.call(e,t,i):t}(e,r,{element:t,templateNodes:u});e=d.createChildContext(i,{extend:function(e){e.$component=i,e.$componentTemplateNodes=u}}),i&&i.koDescendantsComplete&&(l=y.i.subscribe(t,y.i.pa,i.koDescendantsComplete,i)),s=i,y.Oa(e,t)}}))}),null,{l:t}),{controlsDescendantBindings:!0}}},y.h.ea.component=!0}();var D={class:"className",for:"htmlFor"};y.c.attr={update:function(t,i){var n=y.a.f(i())||{};y.a.P(n,(function(i,n){n=y.a.f(n);var r=i.indexOf(":"),a=(r="lookupNamespaceURI"in t&&0<r&&t.lookupNamespaceURI(i.substr(0,r)),!1===n||null===n||n===e);a?r?t.removeAttributeNS(r,i):t.removeAttribute(i):n=n.toString(),8>=y.a.W&&i in D?(i=D[i],a?t.removeAttribute(i):t[i]=n):a||(r?t.setAttributeNS(r,i,n):t.setAttribute(i,n)),"name"===i&&y.a.Yc(t,a?"":n)}))}},y.c.checked={after:["value","attr"],init:function(t,i,n){function r(){var r=t.checked,c=a();if(!y.S.Ya()&&(r||!s&&!y.S.qa())){var h=y.u.G(i);if(l){var f=u?h.v():h,p=d;d=c,p!==c?r&&(y.a.Na(f,c,!0),y.a.Na(f,p,!1)):y.a.Na(f,c,r),u&&y.Za(h)&&h(f)}else o&&(c===e?c=r:r||(c=e)),y.m.eb(h,n,"checked",c,!0)}}var a=y.xb((function(){return n.has("checkedValue")?y.a.f(n.get("checkedValue")):h?n.has("value")?y.a.f(n.get("value")):t.value:void 0})),o="checkbox"==t.type,s="radio"==t.type;if(o||s){var c=i(),l=o&&y.a.f(c)instanceof Array,u=!(l&&c.push&&c.splice),h=s||l,d=l?a():e;s&&!t.name&&y.c.uniqueName.init(t,(function(){return!0})),y.o(r,null,{l:t}),y.a.B(t,"click",r),y.o((function(){var n=y.a.f(i()),r=a();l?(t.checked=0<=y.a.A(n,r),d=r):t.checked=o&&r===e?!!n:a()===n}),null,{l:t}),c=e}}},y.m.wa.checked=!0,y.c.checkedValue={update:function(e,t){e.value=y.a.f(t())}},y.c.class={update:function(e,t){var i=y.a.Db(y.a.f(t()));y.a.Eb(e,e.__ko__cssValue,!1),e.__ko__cssValue=i,y.a.Eb(e,i,!0)}},y.c.css={update:function(e,t){var i=y.a.f(t());null!==i&&"object"==typeof i?y.a.P(i,(function(t,i){i=y.a.f(i),y.a.Eb(e,t,i)})):y.c.class.update(e,t)}},y.c.enable={update:function(e,t){var i=y.a.f(t());i&&e.disabled?e.removeAttribute("disabled"):i||e.disabled||(e.disabled=!0)}},y.c.disable={update:function(e,t){y.c.enable.update(e,(function(){return!y.a.f(t())}))}},y.c.event={init:function(e,t,i,n,r){var a=t()||{};y.a.P(a,(function(a){"string"==typeof a&&y.a.B(e,a,(function(e){var o,s=t()[a];if(s){try{var c=y.a.la(arguments);n=r.$data,c.unshift(n),o=s.apply(n,c)}finally{!0!==o&&(e.preventDefault?e.preventDefault():e.returnValue=!1)}!1===i.get(a+"Bubble")&&(e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation())}}))}))}},y.c.foreach={Rc:function(e){return function(){var t=e(),i=y.a.bc(t);return i&&"number"!=typeof i.length?(y.a.f(t),{foreach:i.data,as:i.as,noChildContext:i.noChildContext,includeDestroyed:i.includeDestroyed,afterAdd:i.afterAdd,beforeRemove:i.beforeRemove,afterRender:i.afterRender,beforeMove:i.beforeMove,afterMove:i.afterMove,templateEngine:y.ba.Ma}):{foreach:t,templateEngine:y.ba.Ma}}},init:function(e,t){return y.c.template.init(e,y.c.foreach.Rc(t))},update:function(e,t,i,n,r){return y.c.template.update(e,y.c.foreach.Rc(t),i,n,r)}},y.m.Ra.foreach=!1,y.h.ea.foreach=!0,y.c.hasfocus={init:function(e,t,i){function n(n){e.__ko_hasfocusUpdating=!0;var r=e.ownerDocument;if("activeElement"in r){var a;try{a=r.activeElement}catch(e){a=r.body}n=a===e}r=t(),y.m.eb(r,i,"hasfocus",n,!0),e.__ko_hasfocusLastValue=n,e.__ko_hasfocusUpdating=!1}var r=n.bind(null,!0),a=n.bind(null,!1);y.a.B(e,"focus",r),y.a.B(e,"focusin",r),y.a.B(e,"blur",a),y.a.B(e,"focusout",a),e.__ko_hasfocusLastValue=!1},update:function(e,t){var i=!!y.a.f(t());e.__ko_hasfocusUpdating||e.__ko_hasfocusLastValue===i||(i?e.focus():e.blur(),!i&&e.__ko_hasfocusLastValue&&e.ownerDocument.body.focus(),y.u.G(y.a.Fb,null,[e,i?"focusin":"focusout"]))}},y.m.wa.hasfocus=!0,y.c.hasFocus=y.c.hasfocus,y.m.wa.hasFocus="hasfocus",y.c.html={init:function(){return{controlsDescendantBindings:!0}},update:function(e,t){y.a.fc(e,t())}},function(){function e(e,t,i){y.c[e]={init:function(e,n,r,a,o){var s,c,l,u,h,d={};if(t){a=r.get("as");var f=r.get("noChildContext");d={as:a,noChildContext:f,exportDependencies:h=!(a&&f)}}return u=(l="render"==r.get("completeOn"))||r.has(y.i.pa),y.o((function(){var r,a=y.a.f(n()),f=!i!=!a,p=!c;(h||f!==s)&&(u&&(o=y.i.Cb(e,o)),f&&(t&&!h||(d.dataDependency=y.S.o()),r=t?o.createChildContext("function"==typeof a?a:n,d):y.S.qa()?o.extend(null,d):o),p&&y.S.qa()&&(c=y.a.Ca(y.h.childNodes(e),!0)),f?(p||y.h.va(e,y.a.Ca(c)),y.Oa(r,e)):(y.h.Ea(e),l||y.i.ma(e,y.i.H)),s=f)}),null,{l:e}),{controlsDescendantBindings:!0}}},y.m.Ra[e]=!1,y.h.ea[e]=!0}e("if"),e("ifnot",!1,!0),e("with",!0)}(),y.c.let={init:function(e,t,i,n,r){return t=r.extend(t),y.Oa(t,e),{controlsDescendantBindings:!0}}},y.h.ea.let=!0;var j={};y.c.options={init:function(e){if("select"!==y.a.R(e))throw Error("options binding applies only to SELECT elements");for(;0<e.length;)e.remove(0);return{controlsDescendantBindings:!0}},update:function(t,i,n){function r(){return y.a.jb(t.options,(function(e){return e.selected}))}function a(e,t,i){var n=typeof t;return"function"==n?t(e):"string"==n?e[t]:i}function o(e,i){if(p&&u)y.i.ma(t,y.i.H);else if(f.length){var n=0<=y.a.A(f,y.w.M(i[0]));y.a.Zc(i[0],n),p&&!n&&y.u.G(y.a.Fb,null,[t,"change"])}}var s=t.multiple,c=0!=t.length&&s?t.scrollTop:null,l=y.a.f(i()),u=n.get("valueAllowUnset")&&n.has("value"),h=n.get("optionsIncludeDestroyed");i={};var d,f=[];u||(s?f=y.a.Mb(r(),y.w.M):0<=t.selectedIndex&&f.push(y.w.M(t.options[t.selectedIndex]))),l&&(void 0===l.length&&(l=[l]),d=y.a.jb(l,(function(t){return h||t===e||null===t||!y.a.f(t._destroy)})),n.has("optionsCaption")&&null!==(l=y.a.f(n.get("optionsCaption")))&&l!==e&&d.unshift(j));var p=!1;i.beforeRemove=function(e){t.removeChild(e)},l=o,n.has("optionsAfterRender")&&"function"==typeof n.get("optionsAfterRender")&&(l=function(t,i){o(0,i),y.u.G(n.get("optionsAfterRender"),null,[i[0],t!==j?t:e])}),y.a.ec(t,d,(function(i,r,o){return o.length&&(f=!u&&o[0].selected?[y.w.M(o[0])]:[],p=!0),r=t.ownerDocument.createElement("option"),i===j?(y.a.Bb(r,n.get("optionsCaption")),y.w.cb(r,e)):(o=a(i,n.get("optionsValue"),i),y.w.cb(r,y.a.f(o)),i=a(i,n.get("optionsText"),o),y.a.Bb(r,i)),[r]}),i,l),u||(s?f.length&&r().length<f.length:f.length&&0<=t.selectedIndex?y.w.M(t.options[t.selectedIndex])!==f[0]:f.length||0<=t.selectedIndex)&&y.u.G(y.a.Fb,null,[t,"change"]),(u||y.S.Ya())&&y.i.ma(t,y.i.H),y.a.wd(t),c&&20<Math.abs(c-t.scrollTop)&&(t.scrollTop=c)}},y.c.options.$b=y.a.g.Z(),y.c.selectedOptions={init:function(e,t,i){function n(){var n=t(),r=[];y.a.D(e.getElementsByTagName("option"),(function(e){e.selected&&r.push(y.w.M(e))})),y.m.eb(n,i,"selectedOptions",r)}function r(){var i=y.a.f(t()),n=e.scrollTop;i&&"number"==typeof i.length&&y.a.D(e.getElementsByTagName("option"),(function(e){var t=0<=y.a.A(i,y.w.M(e));e.selected!=t&&y.a.Zc(e,t)})),e.scrollTop=n}if("select"!=y.a.R(e))throw Error("selectedOptions binding applies only to SELECT elements");var a;y.i.subscribe(e,y.i.H,(function(){a?n():(y.a.B(e,"change",n),a=y.o(r,null,{l:e}))}),null,{notifyImmediately:!0})},update:function(){}},y.m.wa.selectedOptions=!0,y.c.style={update:function(t,i){var n=y.a.f(i()||{});y.a.P(n,(function(i,n){if(null!==(n=y.a.f(n))&&n!==e&&!1!==n||(n=""),r)r(t).css(i,n);else if(/^--/.test(i))t.style.setProperty(i,n);else{i=i.replace(/-(\w)/g,(function(e,t){return t.toUpperCase()}));var a=t.style[i];t.style[i]=n,n===a||t.style[i]!=a||isNaN(n)||(t.style[i]=n+"px")}}))}},y.c.submit={init:function(e,t,i,n,r){if("function"!=typeof t())throw Error("The value for a submit binding must be a function");y.a.B(e,"submit",(function(i){var n,a=t();try{n=a.call(r.$data,e)}finally{!0!==n&&(i.preventDefault?i.preventDefault():i.returnValue=!1)}}))}},y.c.text={init:function(){return{controlsDescendantBindings:!0}},update:function(e,t){y.a.Bb(e,t())}},y.h.ea.text=!0,function(){if(t&&t.navigator){var i,n,r,a,o,s=function(e){if(e)return parseFloat(e[1])},c=t.navigator.userAgent;(i=t.opera&&t.opera.version&&parseInt(t.opera.version()))||(o=s(c.match(/Edge\/([^ ]+)$/)))||s(c.match(/Chrome\/([^ ]+)/))||(n=s(c.match(/Version\/([^ ]+) Safari/)))||(r=s(c.match(/Firefox\/([^ ]+)/)))||(a=y.a.W||s(c.match(/MSIE ([^ ]+)/)))||(a=s(c.match(/rv:([^ )]+)/)))}if(8<=a&&10>a)var l=y.a.g.Z(),u=y.a.g.Z(),h=function(e){var t=this.activeElement;(t=t&&y.a.g.get(t,u))&&t(e)},d=function(e,t){var i=e.ownerDocument;y.a.g.get(i,l)||(y.a.g.set(i,l,!0),y.a.B(i,"selectionchange",h)),y.a.g.set(e,u,t)};y.c.textInput={init:function(t,s,c){function l(e,i){y.a.B(t,e,i)}function u(){f||(p=t.value,f=y.a.setTimeout(h,4))}function h(){clearTimeout(f),p=f=e;var i=t.value;m!==i&&(m=i,y.m.eb(s(),c,"textInput",i))}var f,p,m=t.value,_=9==y.a.W?u:h,g=!1;a&&l("keypress",h),11>a&&l("propertychange",(function(e){g||"value"!==e.propertyName||_(e)})),8==a&&(l("keyup",h),l("keydown",h)),d&&(d(t,_),l("dragend",u)),(!a||9<=a)&&l("input",_),5>n&&"textarea"===y.a.R(t)?(l("keydown",u),l("paste",u),l("cut",u)):11>i?l("keydown",u):4>r?(l("DOMAutoComplete",h),l("dragdrop",h),l("drop",h)):o&&"number"===t.type&&l("keydown",u),l("change",h),l("blur",h),y.o((function i(){var n=y.a.f(s());null!==n&&n!==e||(n=""),p!==e&&n===p?y.a.setTimeout(i,4):t.value!==n&&(g=!0,t.value=n,g=!1,m=t.value)}),null,{l:t})}},y.m.wa.textInput=!0,y.c.textinput={preprocess:function(e,t,i){i("textInput",e)}}}(),y.c.uniqueName={init:function(e,t){if(t()){var i="ko_unique_"+ ++y.c.uniqueName.rd;y.a.Yc(e,i)}}},y.c.uniqueName.rd=0,y.c.using={init:function(e,t,i,n,r){var a;return i.has("as")&&(a={as:i.get("as"),noChildContext:i.get("noChildContext")}),t=r.createChildContext(t,a),y.Oa(t,e),{controlsDescendantBindings:!0}}},y.h.ea.using=!0,y.c.value={init:function(t,i,n){var r=y.a.R(t),a="input"==r;if(!a||"checkbox"!=t.type&&"radio"!=t.type){var o=[],s=n.get("valueUpdate"),c=!1,l=null;s&&(o="string"==typeof s?[s]:y.a.wc(s),y.a.Pa(o,"change"));var u,h,d=function(){l=null,c=!1;var e=i(),r=y.w.M(t);y.m.eb(e,n,"value",r)};!y.a.W||!a||"text"!=t.type||"off"==t.autocomplete||t.form&&"off"==t.form.autocomplete||-1!=y.a.A(o,"propertychange")||(y.a.B(t,"propertychange",(function(){c=!0})),y.a.B(t,"focus",(function(){c=!1})),y.a.B(t,"blur",(function(){c&&d()}))),y.a.D(o,(function(e){var i=d;y.a.Ud(e,"after")&&(i=function(){l=y.w.M(t),y.a.setTimeout(d,0)},e=e.substring(5)),y.a.B(t,e,i)})),u=a&&"file"==t.type?function(){var n=y.a.f(i());null===n||n===e||""===n?t.value="":y.u.G(d)}:function(){var a=y.a.f(i()),o=y.w.M(t);null!==l&&a===l?y.a.setTimeout(u,0):a===o&&o!==e||("select"===r?(o=n.get("valueAllowUnset"),y.w.cb(t,a,o),o||a===y.w.M(t)||y.u.G(d)):y.w.cb(t,a))},"select"===r?y.i.subscribe(t,y.i.H,(function(){h?n.get("valueAllowUnset")?u():d():(y.a.B(t,"change",d),h=y.o(u,null,{l:t}))}),null,{notifyImmediately:!0}):(y.a.B(t,"change",d),y.o(u,null,{l:t}))}else y.ib(t,{checkedValue:i})},update:function(){}},y.m.wa.value=!0,y.c.visible={update:function(e,t){var i=y.a.f(t()),n="none"!=e.style.display;i&&!n?e.style.display="":!i&&n&&(e.style.display="none")}},y.c.hidden={update:function(e,t){y.c.visible.update(e,(function(){return!y.a.f(t())}))}},function(e){y.c[e]={init:function(t,i,n,r,a){return y.c.event.init.call(this,t,(function(){var t={};return t[e]=i(),t}),n,r,a)}}}("click"),y.ca=function(){},y.ca.prototype.renderTemplateSource=function(){throw Error("Override renderTemplateSource")},y.ca.prototype.createJavaScriptEvaluatorBlock=function(){throw Error("Override createJavaScriptEvaluatorBlock")},y.ca.prototype.makeTemplateSource=function(e,t){if("string"==typeof e){var n=(t=t||i).getElementById(e);if(!n)throw Error("Cannot find template with ID "+e);return new y.C.F(n)}if(1==e.nodeType||8==e.nodeType)return new y.C.ia(e);throw Error("Unknown template type: "+e)},y.ca.prototype.renderTemplate=function(e,t,i,n){return e=this.makeTemplateSource(e,n),this.renderTemplateSource(e,t,i,n)},y.ca.prototype.isTemplateRewritten=function(e,t){return!1===this.allowTemplateRewriting||this.makeTemplateSource(e,t).data("isRewritten")},y.ca.prototype.rewriteTemplate=function(e,t,i){t=t((e=this.makeTemplateSource(e,i)).text()),e.text(t),e.data("isRewritten",!0)},y.b("templateEngine",y.ca),y.kc=function(){function e(e,t,i,n){e=y.m.ac(e);for(var r=y.m.Ra,a=0;a<e.length;a++){var o=e[a].key;if(Object.prototype.hasOwnProperty.call(r,o)){var s=r[o];if("function"==typeof s){if(o=s(e[a].value))throw Error(o)}else if(!s)throw Error("This template engine does not support the '"+o+"' binding within its templates")}}return i="ko.__tr_ambtns(function($context,$element){return(function(){return{ "+y.m.vb(e,{valueAccessors:!0})+" } })()},'"+i.toLowerCase()+"')",n.createJavaScriptEvaluatorBlock(i)+t}var t=/(<([a-z]+\d*)(?:\s+(?!data-bind\s*=\s*)[a-z0-9\-]+(?:=(?:\"[^\"]*\"|\'[^\']*\'|[^>]*))?)*\s+)data-bind\s*=\s*(["'])([\s\S]*?)\3/gi,i=/\x3c!--\s*ko\b\s*([\s\S]*?)\s*--\x3e/g;return{xd:function(e,t,i){t.isTemplateRewritten(e,i)||t.rewriteTemplate(e,(function(e){return y.kc.Ld(e,t)}),i)},Ld:function(n,r){return n.replace(t,(function(t,i,n,a,o){return e(o,i,n,r)})).replace(i,(function(t,i){return e(i,"\x3c!-- ko --\x3e","#comment",r)}))},md:function(e,t){return y.aa.Xb((function(i,n){var r=i.nextSibling;r&&r.nodeName.toLowerCase()===t&&y.ib(r,e,n)}))}}}(),y.b("__tr_ambtns",y.kc.md),function(){y.C={},y.C.F=function(e){if(this.F=e){var t=y.a.R(e);this.ab="script"===t?1:"textarea"===t?2:"template"==t&&e.content&&11===e.content.nodeType?3:4}},y.C.F.prototype.text=function(){var e=1===this.ab?"text":2===this.ab?"value":"innerHTML";if(0==arguments.length)return this.F[e];var t=arguments[0];"innerHTML"===e?y.a.fc(this.F,t):this.F[e]=t};var t=y.a.g.Z()+"_";y.C.F.prototype.data=function(e){if(1===arguments.length)return y.a.g.get(this.F,t+e);y.a.g.set(this.F,t+e,arguments[1])};var i=y.a.g.Z();y.C.F.prototype.nodes=function(){var t=this.F;if(0==arguments.length){var n=y.a.g.get(t,i)||{},r=n.lb||(3===this.ab?t.content:4===this.ab?t:e);if(!r||n.jd){var a=this.text();a&&a!==n.bb&&(r=y.a.Md(a,t.ownerDocument),y.a.g.set(t,i,{lb:r,bb:a,jd:!0}))}return r}n=arguments[0],this.ab!==e&&this.text(""),y.a.g.set(t,i,{lb:n})},y.C.ia=function(e){this.F=e},y.C.ia.prototype=new y.C.F,y.C.ia.prototype.constructor=y.C.ia,y.C.ia.prototype.text=function(){if(0==arguments.length){var t=y.a.g.get(this.F,i)||{};return t.bb===e&&t.lb&&(t.bb=t.lb.innerHTML),t.bb}y.a.g.set(this.F,i,{bb:arguments[0]})},y.b("templateSources",y.C),y.b("templateSources.domElement",y.C.F),y.b("templateSources.anonymousTemplate",y.C.ia)}(),function(){function t(e,t,i){var n;for(t=y.h.nextSibling(t);e&&(n=e)!==t;)i(n,e=y.h.nextSibling(n))}function i(e,i){if(e.length){var n=e[0],r=e[e.length-1],a=n.parentNode,o=y.ga.instance,s=o.preprocessNode;if(s){if(t(n,r,(function(e,t){var i=e.previousSibling,a=s.call(o,e);a&&(e===n&&(n=a[0]||t),e===r&&(r=a[a.length-1]||i))})),e.length=0,!n)return;n===r?e.push(n):(e.push(n,r),y.a.Ua(e,a))}t(n,r,(function(e){1!==e.nodeType&&8!==e.nodeType||y.vc(i,e)})),t(n,r,(function(e){1!==e.nodeType&&8!==e.nodeType||y.aa.cd(e,[i])})),y.a.Ua(e,a)}}function n(e){return e.nodeType?e:0<e.length?e[0]:null}function r(e,t,r,a,s){s=s||{};var c=(e&&n(e)||r||{}).ownerDocument,l=s.templateEngine||o;if(y.kc.xd(r,l,c),"number"!=typeof(r=l.renderTemplate(r,a,s,c)).length||0<r.length&&"number"!=typeof r[0].nodeType)throw Error("Template engine must return an array of DOM nodes");switch(c=!1,t){case"replaceChildren":y.h.va(e,r),c=!0;break;case"replaceNode":y.a.Xc(e,r),c=!0;break;case"ignoreTargetNode":break;default:throw Error("Unknown renderMode: "+t)}return c&&(i(r,a),s.afterRender&&y.u.G(s.afterRender,null,[r,a[s.as||"$data"]]),"replaceChildren"==t&&y.i.ma(e,y.i.H)),r}function a(e,t,i){return y.O(e)?e():"function"==typeof e?e(t,i):e}var o;y.gc=function(t){if(t!=e&&!(t instanceof y.ca))throw Error("templateEngine must inherit from ko.templateEngine");o=t},y.dc=function(t,i,s,c,l){if(((s=s||{}).templateEngine||o)==e)throw Error("Set a template engine before calling renderTemplate");if(l=l||"replaceChildren",c){var u=n(c);return y.$((function(){var e=i&&i instanceof y.fa?i:new y.fa(i,null,null,null,{exportDependencies:!0}),o=a(t,e.$data,e);e=r(c,l,o,e,s),"replaceNode"==l&&(u=n(c=e))}),null,{Sa:function(){return!u||!y.a.Sb(u)},l:u&&"replaceNode"==l?u.parentNode:u})}return y.aa.Xb((function(e){y.dc(t,i,s,e,"replaceNode")}))},y.Qd=function(t,n,o,s,c){function l(e,t){y.u.G(y.a.ec,null,[s,e,h,o,u,t]),y.i.ma(s,y.i.H)}function u(e,t){i(t,d),o.afterRender&&o.afterRender(t,e),d=null}function h(e,i){d=c.createChildContext(e,{as:f,noChildContext:o.noChildContext,extend:function(e){e.$index=i,f&&(e[f+"Index"]=i)}});var n=a(t,e,d);return r(s,"ignoreTargetNode",n,d,o)}var d,f=o.as,p=!1===o.includeDestroyed||y.options.foreachHidesDestroyed&&!o.includeDestroyed;if(p||o.beforeRemove||!y.Pc(n))return y.$((function(){var t=y.a.f(n)||[];void 0===t.length&&(t=[t]),p&&(t=y.a.jb(t,(function(t){return t===e||null===t||!y.a.f(t._destroy)}))),l(t)}),null,{l:s});l(n.v());var m=n.subscribe((function(e){l(n(),e)}),null,"arrayChange");return m.l(s),m};var s=y.a.g.Z(),c=y.a.g.Z();y.c.template={init:function(e,t){var i=y.a.f(t());if("string"==typeof i||"name"in i)y.h.Ea(e);else if("nodes"in i){if(i=i.nodes||[],y.O(i))throw Error('The "nodes" option must be a plain, non-observable array.');var n=i[0]&&i[0].parentNode;n&&y.a.g.get(n,c)||(n=y.a.Yb(i),y.a.g.set(n,c,!0)),new y.C.ia(e).nodes(n)}else{if(!(0<(i=y.h.childNodes(e)).length))throw Error("Anonymous template defined, but no template content was provided");n=y.a.Yb(i),new y.C.ia(e).nodes(n)}return{controlsDescendantBindings:!0}},update:function(t,i,n,r,a){var o=i();n=!0,r=null,"string"==typeof(i=y.a.f(o))?i={}:(o="name"in i?i.name:t,"if"in i&&(n=y.a.f(i.if)),n&&"ifnot"in i&&(n=!y.a.f(i.ifnot)),n&&!o&&(n=!1)),"foreach"in i?r=y.Qd(o,n&&i.foreach||[],i,t,a):n?(n=a,"data"in i&&(n=a.createChildContext(i.data,{as:i.as,noChildContext:i.noChildContext,exportDependencies:!0})),r=y.dc(o,n,i,t)):y.h.Ea(t),a=r,(i=y.a.g.get(t,s))&&"function"==typeof i.s&&i.s(),y.a.g.set(t,s,!a||a.ja&&!a.ja()?e:a)}},y.m.Ra.template=function(e){return 1==(e=y.m.ac(e)).length&&e[0].unknown||y.m.Id(e,"name")?null:"This template engine does not support anonymous templates nested within its templates"},y.h.ea.template=!0}(),y.b("setTemplateEngine",y.gc),y.b("renderTemplate",y.dc),y.a.Kc=function(e,t,i){var n,r,a,o,s;if(e.length&&t.length)for(n=r=0;(!i||n<i)&&(o=e[r]);++r){for(a=0;s=t[a];++a)if(o.value===s.value){o.moved=s.index,s.moved=o.index,t.splice(a,1),n=a=0;break}n+=a}},y.a.Pb=function(){function e(e,t,i,n,r){var a,o,s,c,l,u=Math.min,h=Math.max,d=[],f=e.length,p=t.length,m=p-f||1,_=f+p+1;for(a=0;a<=f;a++)for(c=s,d.push(s=[]),l=u(p,a+m),o=h(0,a-1);o<=l;o++)s[o]=o?a?e[a-1]===t[o-1]?c[o-1]:u(c[o]||_,s[o-1]||_)+1:o+1:a+1;for(u=[],h=[],m=[],a=f,o=p;a||o;)p=d[a][o]-1,o&&p===d[a][o-1]?h.push(u[u.length]={status:i,value:t[--o],index:o}):a&&p===d[a-1][o]?m.push(u[u.length]={status:n,value:e[--a],index:a}):(--o,--a,r.sparse||u.push({status:"retained",value:t[o]}));return y.a.Kc(m,h,!r.dontLimitMoves&&10*f),u.reverse()}return function(t,i,n){return n="boolean"==typeof n?{dontLimitMoves:n}:n||{},i=i||[],(t=t||[]).length<i.length?e(t,i,"added","deleted",n):e(i,t,"deleted","added",n)}}(),y.b("utils.compareArrays",y.a.Pb),function(){function t(t,i,n,r,a){var o=[],s=y.$((function(){var e=i(n,a,y.a.Ua(o,t))||[];0<o.length&&(y.a.Xc(o,e),r&&y.u.G(r,null,[n,e,a])),o.length=0,y.a.Nb(o,e)}),null,{l:t,Sa:function(){return!y.a.kd(o)}});return{Y:o,$:s.ja()?s:e}}var i=y.a.g.Z(),n=y.a.g.Z();y.a.ec=function(r,a,o,s,c,l){function u(e){f={Aa:e,pb:y.ta(O++)},b.push(f),v||S.push(f)}function h(e){f=g[e],O!==f.pb.v()&&C.push(f),f.pb(O++),y.a.Ua(f.Y,r),b.push(f)}function d(e,t){if(e)for(var i=0,n=t.length;i<n;i++)y.a.D(t[i].Y,(function(n){e(n,i,t[i].Aa)}))}void 0===(a=a||[]).length&&(a=[a]),s=s||{};var f,p,m,_,g=y.a.g.get(r,i),v=!g,b=[],w=0,O=0,x=[],E=[],T=[],C=[],S=[],A=0;if(v)y.a.D(a,u);else{if(!l||g&&g._countWaitingForRemove){var P=y.a.Mb(g,(function(e){return e.Aa}));l=y.a.Pb(P,a,{dontLimitMoves:s.dontLimitMoves,sparse:!0})}var I,D,j;for(P=0;I=l[P];P++)switch(D=I.moved,j=I.index,I.status){case"deleted":for(;w<j;)h(w++);D===e&&((f=g[w]).$&&(f.$.s(),f.$=e),y.a.Ua(f.Y,r).length&&(s.beforeRemove&&(b.push(f),A++,f.Aa===n?f=null:T.push(f)),f&&x.push.apply(x,f.Y))),w++;break;case"added":for(;O<j;)h(w++);D!==e?(E.push(b.length),h(D)):u(I.value)}for(;O<a.length;)h(w++);b._countWaitingForRemove=A}y.a.g.set(r,i,b),d(s.beforeMove,C),y.a.D(x,s.beforeRemove?y.oa:y.removeNode);try{_=r.ownerDocument.activeElement}catch(e){}if(E.length)for(;(P=E.shift())!=e;){for(f=b[P],p=e;P;)if((m=b[--P].Y)&&m.length){p=m[m.length-1];break}for(a=0;w=f.Y[a];p=w,a++)y.h.Wb(r,w,p)}for(P=0;f=b[P];P++){for(f.Y||y.a.extend(f,t(r,o,f.Aa,c,f.pb)),a=0;w=f.Y[a];p=w,a++)y.h.Wb(r,w,p);!f.Ed&&c&&(c(f.Aa,f.Y,f.pb),f.Ed=!0,p=f.Y[f.Y.length-1])}for(_&&r.ownerDocument.activeElement!=_&&_.focus(),d(s.beforeRemove,T),P=0;P<T.length;++P)T[P].Aa=n;d(s.afterMove,C),d(s.afterAdd,S)}}(),y.b("utils.setDomNodeChildrenFromArrayMapping",y.a.ec),y.ba=function(){this.allowTemplateRewriting=!1},y.ba.prototype=new y.ca,y.ba.prototype.constructor=y.ba,y.ba.prototype.renderTemplateSource=function(e,t,i,n){return(t=9>y.a.W||!e.nodes?null:e.nodes())?y.a.la(t.cloneNode(!0).childNodes):(e=e.text(),y.a.ua(e,n))},y.ba.Ma=new y.ba,y.gc(y.ba.Ma),y.b("nativeTemplateEngine",y.ba),function(){y.$a=function(){var e=this.Hd=function(){if(!r||!r.tmpl)return 0;try{if(0<=r.tmpl.tag.tmpl.open.toString().indexOf("__"))return 2}catch(e){}return 1}();this.renderTemplateSource=function(t,n,a,o){if(o=o||i,a=a||{},2>e)throw Error("Your version of jQuery.tmpl is too old. Please upgrade to jQuery.tmpl 1.0.0pre or later.");var s=t.data("precompiled");return s||(s=t.text()||"",s=r.template(null,"{{ko_with $item.koBindingContext}}"+s+"{{/ko_with}}"),t.data("precompiled",s)),t=[n.$data],n=r.extend({koBindingContext:n},a.templateOptions),(n=r.tmpl(s,t,n)).appendTo(o.createElement("div")),r.fragments={},n},this.createJavaScriptEvaluatorBlock=function(e){return"{{ko_code ((function() { return "+e+" })()) }}"},this.addTemplate=function(e,t){i.write("<script type='text/html' id='"+e+"'>"+t+"<\/script>")},0<e&&(r.tmpl.tag.ko_code={open:"__.push($1 || '');"},r.tmpl.tag.ko_with={open:"with($1) {",close:"} "})},y.$a.prototype=new y.ca,y.$a.prototype.constructor=y.$a;var e=new y.$a;0<e.Hd&&y.gc(e),y.b("jqueryTmplTemplateEngine",y.$a)}()}))}();var n=ko;"undefined"!=typeof window?(ko=window.ko,void 0!==i?window.ko=i:delete window.ko):(ko=e.ko,void 0!==i?e.ko=i:delete e.ko),t.a=n}).call(this,i(40))},function(e,t,i){(t=e.exports=i(151)).Stream=t,t.Readable=t,t.Writable=i(125),t.Duplex=i(61),t.Transform=i(154),t.PassThrough=i(227)},function(e,t,i){"use strict";(function(e){var n=i(15).Buffer,r=i(41).Transform,a=i(235),o=i(52),s=i(126).ok,c=i(15).kMaxLength,l="Cannot create final Buffer. It would be larger than 0x"+c.toString(16)+" bytes";a.Z_MIN_WINDOWBITS=8,a.Z_MAX_WINDOWBITS=15,a.Z_DEFAULT_WINDOWBITS=15,a.Z_MIN_CHUNK=64,a.Z_MAX_CHUNK=1/0,a.Z_DEFAULT_CHUNK=16384,a.Z_MIN_MEMLEVEL=1,a.Z_MAX_MEMLEVEL=9,a.Z_DEFAULT_MEMLEVEL=8,a.Z_MIN_LEVEL=-1,a.Z_MAX_LEVEL=9,a.Z_DEFAULT_LEVEL=a.Z_DEFAULT_COMPRESSION;for(var u=Object.keys(a),h=0;h<u.length;h++){var d=u[h];d.match(/^Z/)&&Object.defineProperty(t,d,{enumerable:!0,value:a[d],writable:!1})}for(var f={Z_OK:a.Z_OK,Z_STREAM_END:a.Z_STREAM_END,Z_NEED_DICT:a.Z_NEED_DICT,Z_ERRNO:a.Z_ERRNO,Z_STREAM_ERROR:a.Z_STREAM_ERROR,Z_DATA_ERROR:a.Z_DATA_ERROR,Z_MEM_ERROR:a.Z_MEM_ERROR,Z_BUF_ERROR:a.Z_BUF_ERROR,Z_VERSION_ERROR:a.Z_VERSION_ERROR},p=Object.keys(f),m=0;m<p.length;m++){var _=p[m];f[f[_]]=_}function g(e,t,i){var r=[],a=0;function o(){for(var t;null!==(t=e.read());)r.push(t),a+=t.length;e.once("readable",o)}function s(){var t,o=null;a>=c?o=new RangeError(l):t=n.concat(r,a),r=[],e.close(),i(o,t)}e.on("error",(function(t){e.removeListener("end",s),e.removeListener("readable",o),i(t)})),e.on("end",s),e.end(t),o()}function v(e,t){if("string"==typeof t&&(t=n.from(t)),!n.isBuffer(t))throw new TypeError("Not a string or buffer");var i=e._finishFlushFlag;return e._processChunk(t,i)}function b(e){if(!(this instanceof b))return new b(e);S.call(this,e,a.DEFLATE)}function y(e){if(!(this instanceof y))return new y(e);S.call(this,e,a.INFLATE)}function w(e){if(!(this instanceof w))return new w(e);S.call(this,e,a.GZIP)}function O(e){if(!(this instanceof O))return new O(e);S.call(this,e,a.GUNZIP)}function x(e){if(!(this instanceof x))return new x(e);S.call(this,e,a.DEFLATERAW)}function E(e){if(!(this instanceof E))return new E(e);S.call(this,e,a.INFLATERAW)}function T(e){if(!(this instanceof T))return new T(e);S.call(this,e,a.UNZIP)}function C(e){return e===a.Z_NO_FLUSH||e===a.Z_PARTIAL_FLUSH||e===a.Z_SYNC_FLUSH||e===a.Z_FULL_FLUSH||e===a.Z_FINISH||e===a.Z_BLOCK}function S(e,i){var o=this;if(this._opts=e=e||{},this._chunkSize=e.chunkSize||t.Z_DEFAULT_CHUNK,r.call(this,e),e.flush&&!C(e.flush))throw new Error("Invalid flush flag: "+e.flush);if(e.finishFlush&&!C(e.finishFlush))throw new Error("Invalid flush flag: "+e.finishFlush);if(this._flushFlag=e.flush||a.Z_NO_FLUSH,this._finishFlushFlag=void 0!==e.finishFlush?e.finishFlush:a.Z_FINISH,e.chunkSize&&(e.chunkSize<t.Z_MIN_CHUNK||e.chunkSize>t.Z_MAX_CHUNK))throw new Error("Invalid chunk size: "+e.chunkSize);if(e.windowBits&&(e.windowBits<t.Z_MIN_WINDOWBITS||e.windowBits>t.Z_MAX_WINDOWBITS))throw new Error("Invalid windowBits: "+e.windowBits);if(e.level&&(e.level<t.Z_MIN_LEVEL||e.level>t.Z_MAX_LEVEL))throw new Error("Invalid compression level: "+e.level);if(e.memLevel&&(e.memLevel<t.Z_MIN_MEMLEVEL||e.memLevel>t.Z_MAX_MEMLEVEL))throw new Error("Invalid memLevel: "+e.memLevel);if(e.strategy&&e.strategy!=t.Z_FILTERED&&e.strategy!=t.Z_HUFFMAN_ONLY&&e.strategy!=t.Z_RLE&&e.strategy!=t.Z_FIXED&&e.strategy!=t.Z_DEFAULT_STRATEGY)throw new Error("Invalid strategy: "+e.strategy);if(e.dictionary&&!n.isBuffer(e.dictionary))throw new Error("Invalid dictionary: it should be a Buffer instance");this._handle=new a.Zlib(i);var s=this;this._hadError=!1,this._handle.onerror=function(e,i){A(s),s._hadError=!0;var n=new Error(e);n.errno=i,n.code=t.codes[i],s.emit("error",n)};var c=t.Z_DEFAULT_COMPRESSION;"number"==typeof e.level&&(c=e.level);var l=t.Z_DEFAULT_STRATEGY;"number"==typeof e.strategy&&(l=e.strategy),this._handle.init(e.windowBits||t.Z_DEFAULT_WINDOWBITS,c,e.memLevel||t.Z_DEFAULT_MEMLEVEL,l,e.dictionary),this._buffer=n.allocUnsafe(this._chunkSize),this._offset=0,this._level=c,this._strategy=l,this.once("end",this.close),Object.defineProperty(this,"_closed",{get:function(){return!o._handle},configurable:!0,enumerable:!0})}function A(t,i){i&&e.nextTick(i),t._handle&&(t._handle.close(),t._handle=null)}function P(e){e.emit("close")}Object.defineProperty(t,"codes",{enumerable:!0,value:Object.freeze(f),writable:!1}),t.Deflate=b,t.Inflate=y,t.Gzip=w,t.Gunzip=O,t.DeflateRaw=x,t.InflateRaw=E,t.Unzip=T,t.createDeflate=function(e){return new b(e)},t.createInflate=function(e){return new y(e)},t.createDeflateRaw=function(e){return new x(e)},t.createInflateRaw=function(e){return new E(e)},t.createGzip=function(e){return new w(e)},t.createGunzip=function(e){return new O(e)},t.createUnzip=function(e){return new T(e)},t.deflate=function(e,t,i){return"function"==typeof t&&(i=t,t={}),g(new b(t),e,i)},t.deflateSync=function(e,t){return v(new b(t),e)},t.gzip=function(e,t,i){return"function"==typeof t&&(i=t,t={}),g(new w(t),e,i)},t.gzipSync=function(e,t){return v(new w(t),e)},t.deflateRaw=function(e,t,i){return"function"==typeof t&&(i=t,t={}),g(new x(t),e,i)},t.deflateRawSync=function(e,t){return v(new x(t),e)},t.unzip=function(e,t,i){return"function"==typeof t&&(i=t,t={}),g(new T(t),e,i)},t.unzipSync=function(e,t){return v(new T(t),e)},t.inflate=function(e,t,i){return"function"==typeof t&&(i=t,t={}),g(new y(t),e,i)},t.inflateSync=function(e,t){return v(new y(t),e)},t.gunzip=function(e,t,i){return"function"==typeof t&&(i=t,t={}),g(new O(t),e,i)},t.gunzipSync=function(e,t){return v(new O(t),e)},t.inflateRaw=function(e,t,i){return"function"==typeof t&&(i=t,t={}),g(new E(t),e,i)},t.inflateRawSync=function(e,t){return v(new E(t),e)},o.inherits(S,r),S.prototype.params=function(i,n,r){if(i<t.Z_MIN_LEVEL||i>t.Z_MAX_LEVEL)throw new RangeError("Invalid compression level: "+i);if(n!=t.Z_FILTERED&&n!=t.Z_HUFFMAN_ONLY&&n!=t.Z_RLE&&n!=t.Z_FIXED&&n!=t.Z_DEFAULT_STRATEGY)throw new TypeError("Invalid strategy: "+n);if(this._level!==i||this._strategy!==n){var o=this;this.flush(a.Z_SYNC_FLUSH,(function(){s(o._handle,"zlib binding closed"),o._handle.params(i,n),o._hadError||(o._level=i,o._strategy=n,r&&r())}))}else e.nextTick(r)},S.prototype.reset=function(){return s(this._handle,"zlib binding closed"),this._handle.reset()},S.prototype._flush=function(e){this._transform(n.alloc(0),"",e)},S.prototype.flush=function(t,i){var r=this,o=this._writableState;("function"==typeof t||void 0===t&&!i)&&(i=t,t=a.Z_FULL_FLUSH),o.ended?i&&e.nextTick(i):o.ending?i&&this.once("end",i):o.needDrain?i&&this.once("drain",(function(){return r.flush(t,i)})):(this._flushFlag=t,this.write(n.alloc(0),"",i))},S.prototype.close=function(t){A(this,t),e.nextTick(P,this)},S.prototype._transform=function(e,t,i){var r,o=this._writableState,s=(o.ending||o.ended)&&(!e||o.length===e.length);return null===e||n.isBuffer(e)?this._handle?(s?r=this._finishFlushFlag:(r=this._flushFlag,e.length>=o.length&&(this._flushFlag=this._opts.flush||a.Z_NO_FLUSH)),void this._processChunk(e,r,i)):i(new Error("zlib binding closed")):i(new Error("invalid input"))},S.prototype._processChunk=function(e,t,i){var r=e&&e.length,a=this._chunkSize-this._offset,o=0,u=this,h="function"==typeof i;if(!h){var d,f=[],p=0;this.on("error",(function(e){d=e})),s(this._handle,"zlib binding closed");do{var m=this._handle.writeSync(t,e,o,r,this._buffer,this._offset,a)}while(!this._hadError&&v(m[0],m[1]));if(this._hadError)throw d;if(p>=c)throw A(this),new RangeError(l);var _=n.concat(f,p);return A(this),_}s(this._handle,"zlib binding closed");var g=this._handle.write(t,e,o,r,this._buffer,this._offset,a);function v(c,l){if(this&&(this.buffer=null,this.callback=null),!u._hadError){var d=a-l;if(s(d>=0,"have should not go down"),d>0){var m=u._buffer.slice(u._offset,u._offset+d);u._offset+=d,h?u.push(m):(f.push(m),p+=m.length)}if((0===l||u._offset>=u._chunkSize)&&(a=u._chunkSize,u._offset=0,u._buffer=n.allocUnsafe(u._chunkSize)),0===l){if(o+=r-c,r=c,!h)return!0;var _=u._handle.write(t,e,o,r,u._buffer,u._offset,u._chunkSize);return _.callback=v,void(_.buffer=e)}if(!h)return!1;i()}}g.buffer=e,g.callback=v},o.inherits(b,S),o.inherits(y,S),o.inherits(w,S),o.inherits(O,S),o.inherits(x,S),o.inherits(E,S),o.inherits(T,S)}).call(this,i(23))},function(e,t,i){var n=i(70),r=i(24)("toStringTag"),a="Arguments"==n(function(){return arguments}());e.exports=function(e){var t,i,o;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(i=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),r))?i:a?n(t):"Object"==(o=n(t))&&"function"==typeof t.callee?"Arguments":o}},function(e,t,i){var n=i(31);e.exports=function(e,t){if(!n(e))return e;var i,r;if(t&&"function"==typeof(i=e.toString)&&!n(r=i.call(e)))return r;if("function"==typeof(i=e.valueOf)&&!n(r=i.call(e)))return r;if(!t&&"function"==typeof(i=e.toString)&&!n(r=i.call(e)))return r;throw TypeError("Can't convert object to primitive value")}},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t,i){var n=i(166),r=i(133);e.exports=Object.keys||function(e){return n(e,r)}},function(e,t,i){var n=i(32),r=i(169),a=i(133),o=i(132)("IE_PROTO"),s=function(){},c=function(){var e,t=i(130)("iframe"),n=a.length;for(t.style.display="none",i(171).appendChild(t),t.src="javascript:",(e=t.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),c=e.F;n--;)delete c.prototype[a[n]];return c()};e.exports=Object.create||function(e,t){var i;return null!==e?(s.prototype=n(e),i=new s,s.prototype=null,i[o]=e):i=c(),void 0===t?i:r(i,t)}},function(e,t,i){var n=i(48),r=i(93);i(172)("keys",(function(){return function(e){return r(n(e))}}))},function(e,t,i){"use strict";var n=i(134),r=i(32),a=i(137),o=i(157),s=i(42),c=i(159),l=i(129),u=i(35),h=Math.min,d=[].push,f=!u((function(){RegExp(4294967295,"y")}));i(160)("split",2,(function(e,t,i,u){var p;return p="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(e,t){var r=String(this);if(void 0===e&&0===t)return[];if(!n(e))return i.call(r,e,t);for(var a,o,s,c=[],u=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),h=0,f=void 0===t?4294967295:t>>>0,p=new RegExp(e.source,u+"g");(a=l.call(p,r))&&!((o=p.lastIndex)>h&&(c.push(r.slice(h,a.index)),a.length>1&&a.index<r.length&&d.apply(c,a.slice(1)),s=a[0].length,h=o,c.length>=f));)p.lastIndex===a.index&&p.lastIndex++;return h===r.length?!s&&p.test("")||c.push(""):c.push(r.slice(h)),c.length>f?c.slice(0,f):c}:"0".split(void 0,0).length?function(e,t){return void 0===e&&0===t?[]:i.call(this,e,t)}:i,[function(i,n){var r=e(this),a=null==i?void 0:i[t];return void 0!==a?a.call(i,r,n):p.call(String(r),i,n)},function(e,t){var n=u(p,e,this,t,p!==i);if(n.done)return n.value;var l=r(e),d=String(this),m=a(l,RegExp),_=l.unicode,g=(l.ignoreCase?"i":"")+(l.multiline?"m":"")+(l.unicode?"u":"")+(f?"y":"g"),v=new m(f?l:"^(?:"+l.source+")",g),b=void 0===t?4294967295:t>>>0;if(0===b)return[];if(0===d.length)return null===c(v,d)?[d]:[];for(var y=0,w=0,O=[];w<d.length;){v.lastIndex=f?w:0;var x,E=c(v,f?d:d.slice(w));if(null===E||(x=h(s(v.lastIndex+(f?0:w)),d.length))===y)w=o(d,w,_);else{if(O.push(d.slice(y,w)),O.length===b)return O;for(var T=1;T<=E.length-1;T++)if(O.push(E[T]),O.length===b)return O;w=y=x}}return O.push(d.slice(y)),O}]}))},function(e,t,i){"use strict";var n=i(16),r=i(98)(2);n(n.P+n.F*!i(99)([].filter,!0),"Array",{filter:function(e){return r(this,e,arguments[1])}})},function(e,t,i){var n=i(53),r=i(165),a=i(48),o=i(42),s=i(253);e.exports=function(e,t){var i=1==e,c=2==e,l=3==e,u=4==e,h=6==e,d=5==e||h,f=t||s;return function(t,s,p){for(var m,_,g=a(t),v=r(g),b=n(s,p,3),y=o(v.length),w=0,O=i?f(t,y):c?f(t,0):void 0;y>w;w++)if((d||w in v)&&(_=b(m=v[w],w,g),e))if(i)O[w]=_;else if(_)switch(e){case 3:return!0;case 5:return m;case 6:return w;case 2:O.push(m)}else if(u)return!1;return h?-1:l||u?u:O}}},function(e,t,i){"use strict";var n=i(35);e.exports=function(e,t){return!!e&&n((function(){t?e.call(null,(function(){}),1):e.call(null)}))}},function(e,t,i){"use strict";var n=i(158)(!0);i(139)(String,"String",(function(e){this._t=String(e),this._i=0}),(function(){var e,t=this._t,i=this._i;return i>=t.length?{value:void 0,done:!0}:(e=n(t,i),this._i+=e.length,{value:e,done:!1})}))},function(e,t){e.exports=function(e,t,i,n){if(!(e instanceof t)||void 0!==n&&n in e)throw TypeError(i+": incorrect invocation!");return e}},function(e,t,i){var n=i(45);e.exports=function(e,t,i){for(var r in t)n(e,r,t[r],i);return e}},function(e,t,i){var n=i(71),r=i(119),a=i(49),o=i(16),s=i(31),c=i(32);o(o.S,"Reflect",{get:function e(t,i){var o,l,u=arguments.length<3?t:arguments[2];return c(t)===u?t[i]:(o=n.f(t,i))?a(o,"value")?o.value:void 0!==o.get?o.get.call(u):void 0:s(l=r(t))?e(l,i,u):void 0}})},function(e,t,i){"use strict";e.exports={PNG_SIGNATURE:[137,80,78,71,13,10,26,10],TYPE_IHDR:1229472850,TYPE_IEND:1229278788,TYPE_IDAT:1229209940,TYPE_PLTE:1347179589,TYPE_tRNS:1951551059,TYPE_gAMA:1732332865,COLORTYPE_GRAYSCALE:0,COLORTYPE_PALETTE:1,COLORTYPE_COLOR:2,COLORTYPE_ALPHA:4,COLORTYPE_PALETTE_COLOR:3,COLORTYPE_COLOR_ALPHA:6,COLORTYPE_TO_BPP_MAP:{0:1,2:3,3:1,4:2,6:4},GAMMA_DIVISION:1e5}},function(e,t,i){"use strict";var n=i(18),r=i(0),a=i(2);t.a=function(e,t){if(!Object(r.a)(e))throw new a.a("uri is required.");var i="",o=e.lastIndexOf("/");return-1!==o&&(i=e.substring(0,o+1)),t?(e=new n.a(e),Object(r.a)(e.query)&&(i+="?"+e.query),Object(r.a)(e.fragment)&&(i+="#"+e.fragment),i):i}},function(e,t,i){"use strict";var n=i(18),r=i(0),a=i(2),o={},s={};o.add=function(e,t){if(!Object(r.a)(e))throw new a.a("host is required.");if(!Object(r.a)(t)||t<=0)throw new a.a("port is required to be greater than 0.");var i=e.toLowerCase()+":"+t;Object(r.a)(s[i])||(s[i]=!0)},o.remove=function(e,t){if(!Object(r.a)(e))throw new a.a("host is required.");if(!Object(r.a)(t)||t<=0)throw new a.a("port is required to be greater than 0.");var i=e.toLowerCase()+":"+t;Object(r.a)(s[i])&&delete s[i]},o.contains=function(e){if(!Object(r.a)(e))throw new a.a("url is required.");var t=function(e){var t=new n.a(e);t.normalize();var i=t.getAuthority();if(Object(r.a)(i)){if(-1!==i.indexOf("@")){var a=i.split("@");i=a[1]}if(-1===i.indexOf(":")){var o=t.getScheme();if(Object(r.a)(o)||(o=(o=window.location.protocol).substring(0,o.length-1)),"http"===o)i+=":80";else{if("https"!==o)return;i+=":443"}}return i}}(e);return!(!Object(r.a)(t)||!Object(r.a)(s[t]))},o.clear=function(){s={}},t.a=o},function(e,t,i){"use strict";(function(t){void 0===t||!t.version||0===t.version.indexOf("v0.")||0===t.version.indexOf("v1.")&&0!==t.version.indexOf("v1.8.")?e.exports={nextTick:function(e,i,n,r){if("function"!=typeof e)throw new TypeError('"callback" argument must be a function');var a,o,s=arguments.length;switch(s){case 0:case 1:return t.nextTick(e);case 2:return t.nextTick((function(){e.call(null,i)}));case 3:return t.nextTick((function(){e.call(null,i,n)}));case 4:return t.nextTick((function(){e.call(null,i,n,r)}));default:for(a=new Array(s-1),o=0;o<a.length;)a[o++]=arguments[o];return t.nextTick((function(){e.apply(null,a)}))}}}:e.exports=t}).call(this,i(23))},function(e,t,i){"use strict";var n="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;function r(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var i=t.shift();if(i){if("object"!=typeof i)throw new TypeError(i+"must be non-object");for(var n in i)r(i,n)&&(e[n]=i[n])}}return e},t.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var a={arraySet:function(e,t,i,n,r){if(t.subarray&&e.subarray)e.set(t.subarray(i,i+n),r);else for(var a=0;a<n;a++)e[r+a]=t[i+a]},flattenChunks:function(e){var t,i,n,r,a,o;for(n=0,t=0,i=e.length;t<i;t++)n+=e[t].length;for(o=new Uint8Array(n),r=0,t=0,i=e.length;t<i;t++)a=e[t],o.set(a,r),r+=a.length;return o}},o={arraySet:function(e,t,i,n,r){for(var a=0;a<n;a++)e[r+a]=t[i+a]},flattenChunks:function(e){return[].concat.apply([],e)}};t.setTyped=function(e){e?(t.Buf8=Uint8Array,t.Buf16=Uint16Array,t.Buf32=Int32Array,t.assign(t,a)):(t.Buf8=Array,t.Buf16=Array,t.Buf32=Array,t.assign(t,o))},t.setTyped(n)},function(e,t){(function(t){e.exports=t}).call(this,{toUrlUndefined:!0})},function(e,t,i){var n=i(62),r=i(26),a=r["__core-js_shared__"]||(r["__core-js_shared__"]={});(e.exports=function(e,t){return a[e]||(a[e]=void 0!==t?t:{})})("versions",[]).push({version:n.version,mode:i(63)?"pure":"global",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})},function(e,t,i){"use strict";var n=i(32);e.exports=function(){var e=n(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}},function(e,t,i){var n=i(57),r=i(42),a=i(113);e.exports=function(e){return function(t,i,o){var s,c=n(t),l=r(c.length),u=a(o,l);if(e&&i!=i){for(;l>u;)if((s=c[u++])!=s)return!0}else for(;l>u;u++)if((e||u in c)&&c[u]===i)return e||u||0;return!e&&-1}}},function(e,t,i){var n=i(56),r=Math.max,a=Math.min;e.exports=function(e,t){return(e=n(e))<0?r(e+t,0):a(e,t)}},function(e,t,i){"use strict";var n=i(26),r=i(33),a=i(34),o=i(24)("species");e.exports=function(e){var t=n[e];a&&t&&!t[o]&&r.f(t,o,{configurable:!0,get:function(){return this}})}},function(e,t,i){var n=i(16);n(n.S+n.F*!i(34),"Object",{defineProperties:i(169)})},function(e,t,i){var n=i(16),r=i(250),a=i(57),o=i(71),s=i(170);n(n.S,"Object",{getOwnPropertyDescriptors:function(e){for(var t,i,n=a(e),c=o.f,l=r(n),u={},h=0;l.length>h;)void 0!==(i=c(n,t=l[h++]))&&s(u,t,i);return u}})},function(e,t,i){var n=i(64)("meta"),r=i(31),a=i(49),o=i(33).f,s=0,c=Object.isExtensible||function(){return!0},l=!i(35)((function(){return c(Object.preventExtensions({}))})),u=function(e){o(e,n,{value:{i:"O"+ ++s,w:{}}})},h=e.exports={KEY:n,NEED:!1,fastKey:function(e,t){if(!r(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!a(e,n)){if(!c(e))return"F";if(!t)return"E";u(e)}return e[n].i},getWeak:function(e,t){if(!a(e,n)){if(!c(e))return!0;if(!t)return!1;u(e)}return e[n].w},onFreeze:function(e){return l&&h.NEED&&c(e)&&!a(e,n)&&u(e),e}}},function(e,t,i){var n=i(24)("unscopables"),r=Array.prototype;null==r[n]&&i(44)(r,n,{}),e.exports=function(e){r[n][e]=!0}},function(e,t,i){var n=i(49),r=i(48),a=i(132)("IE_PROTO"),o=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=r(e),n(e,a)?e[a]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?o:null}},function(e,t,i){var n=i(24)("iterator"),r=!1;try{var a=[7][n]();a.return=function(){r=!0},Array.from(a,(function(){throw 2}))}catch(e){}e.exports=function(e,t){if(!t&&!r)return!1;var i=!1;try{var a=[7],o=a[n]();o.next=function(){return{done:i=!0}},a[n]=function(){return o},e(a)}catch(e){}return i}},function(e,t,i){"use strict";t.a=function(e){var t={};if(!e)return t;for(var i=e.split("\r\n"),n=0;n<i.length;++n){var r=i[n],a=r.indexOf(": ");if(a>0){var o=r.substring(0,a),s=r.substring(a+2);t[o]=s}}return t}},function(e,t,i){"use strict";var n=i(3),r=i(1),a=i(0),o=i(4);function s(e){n.a.typeOf.object("options",e),n.a.defined("options.comparator",e.comparator),this._comparator=e.comparator,this._array=[],this._length=0,this._maximumLength=void 0}function c(e,t,i){var n=e[t];e[t]=e[i],e[i]=n}Object(o.a)(s.prototype,{length:{get:function(){return this._length}},internalArray:{get:function(){return this._array}},maximumLength:{get:function(){return this._maximumLength},set:function(e){this._maximumLength=e,this._length>e&&e>0&&(this._length=e,this._array.length=e)}},comparator:{get:function(){return this._comparator}}}),s.prototype.reserve=function(e){e=Object(r.a)(e,this._length),this._array.length=e},s.prototype.heapify=function(e){e=Object(r.a)(e,0);for(var t=this._length,i=this._comparator,n=this._array,a=-1,o=!0;o;){var s=2*(e+1),l=s-1;a=l<t&&i(n[l],n[e])<0?l:e,s<t&&i(n[s],n[a])<0&&(a=s),a!==e?(c(n,a,e),e=a):o=!1}},s.prototype.resort=function(){for(var e=this._length,t=Math.ceil(e/2);t>=0;--t)this.heapify(t)},s.prototype.insert=function(e){n.a.defined("element",e);var t,i=this._array,r=this._comparator,o=this._maximumLength,s=this._length++;for(s<i.length?i[s]=e:i.push(e);0!==s;){var l=Math.floor((s-1)/2);if(!(r(i[s],i[l])<0))break;c(i,s,l),s=l}return Object(a.a)(o)&&this._length>o&&(t=i[o],this._length=o),t},s.prototype.pop=function(e){if(e=Object(r.a)(e,0),0!==this._length){n.a.typeOf.number.lessThan("index",e,this._length);var t=this._array,i=t[e];return c(t,e,--this._length),this.heapify(e),i}},t.a=s},function(e,t,i){"use strict";var n=i(212),r=i(214);function a(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}t.parse=b,t.resolve=function(e,t){return b(e,!1,!0).resolve(t)},t.resolveObject=function(e,t){return e?b(e,!1,!0).resolveObject(t):t},t.format=function(e){r.isString(e)&&(e=b(e));return e instanceof a?e.format():a.prototype.format.call(e)},t.Url=a;var o=/^([a-z0-9.+-]+:)/i,s=/:[0-9]*$/,c=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,l=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),u=["'"].concat(l),h=["%","/","?",";","#"].concat(u),d=["/","?","#"],f=/^[+a-z0-9A-Z_-]{0,63}$/,p=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,m={javascript:!0,"javascript:":!0},_={javascript:!0,"javascript:":!0},g={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},v=i(215);function b(e,t,i){if(e&&r.isObject(e)&&e instanceof a)return e;var n=new a;return n.parse(e,t,i),n}a.prototype.parse=function(e,t,i){if(!r.isString(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var a=e.indexOf("?"),s=-1!==a&&a<e.indexOf("#")?"?":"#",l=e.split(s);l[0]=l[0].replace(/\\/g,"/");var b=e=l.join(s);if(b=b.trim(),!i&&1===e.split("#").length){var y=c.exec(b);if(y)return this.path=b,this.href=b,this.pathname=y[1],y[2]?(this.search=y[2],this.query=t?v.parse(this.search.substr(1)):this.search.substr(1)):t&&(this.search="",this.query={}),this}var w=o.exec(b);if(w){var O=(w=w[0]).toLowerCase();this.protocol=O,b=b.substr(w.length)}if(i||w||b.match(/^\/\/[^@\/]+@[^@\/]+/)){var x="//"===b.substr(0,2);!x||w&&_[w]||(b=b.substr(2),this.slashes=!0)}if(!_[w]&&(x||w&&!g[w])){for(var E,T,C=-1,S=0;S<d.length;S++){-1!==(A=b.indexOf(d[S]))&&(-1===C||A<C)&&(C=A)}-1!==(T=-1===C?b.lastIndexOf("@"):b.lastIndexOf("@",C))&&(E=b.slice(0,T),b=b.slice(T+1),this.auth=decodeURIComponent(E)),C=-1;for(S=0;S<h.length;S++){var A;-1!==(A=b.indexOf(h[S]))&&(-1===C||A<C)&&(C=A)}-1===C&&(C=b.length),this.host=b.slice(0,C),b=b.slice(C),this.parseHost(),this.hostname=this.hostname||"";var P="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!P)for(var I=this.hostname.split(/\./),D=(S=0,I.length);S<D;S++){var j=I[S];if(j&&!j.match(f)){for(var M="",R=0,L=j.length;R<L;R++)j.charCodeAt(R)>127?M+="x":M+=j[R];if(!M.match(f)){var N=I.slice(0,S),F=I.slice(S+1),k=j.match(p);k&&(N.push(k[1]),F.unshift(k[2])),F.length&&(b="/"+F.join(".")+b),this.hostname=N.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),P||(this.hostname=n.toASCII(this.hostname));var B=this.port?":"+this.port:"",z=this.hostname||"";this.host=z+B,this.href+=this.host,P&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==b[0]&&(b="/"+b))}if(!m[O])for(S=0,D=u.length;S<D;S++){var U=u[S];if(-1!==b.indexOf(U)){var V=encodeURIComponent(U);V===U&&(V=escape(U)),b=b.split(U).join(V)}}var H=b.indexOf("#");-1!==H&&(this.hash=b.substr(H),b=b.slice(0,H));var G=b.indexOf("?");if(-1!==G?(this.search=b.substr(G),this.query=b.substr(G+1),t&&(this.query=v.parse(this.query)),b=b.slice(0,G)):t&&(this.search="",this.query={}),b&&(this.pathname=b),g[O]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){B=this.pathname||"";var q=this.search||"";this.path=B+q}return this.href=this.format(),this},a.prototype.format=function(){var e=this.auth||"";e&&(e=(e=encodeURIComponent(e)).replace(/%3A/i,":"),e+="@");var t=this.protocol||"",i=this.pathname||"",n=this.hash||"",a=!1,o="";this.host?a=e+this.host:this.hostname&&(a=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(a+=":"+this.port)),this.query&&r.isObject(this.query)&&Object.keys(this.query).length&&(o=v.stringify(this.query));var s=this.search||o&&"?"+o||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||g[t])&&!1!==a?(a="//"+(a||""),i&&"/"!==i.charAt(0)&&(i="/"+i)):a||(a=""),n&&"#"!==n.charAt(0)&&(n="#"+n),s&&"?"!==s.charAt(0)&&(s="?"+s),t+a+(i=i.replace(/[?#]/g,(function(e){return encodeURIComponent(e)})))+(s=s.replace("#","%23"))+n},a.prototype.resolve=function(e){return this.resolveObject(b(e,!1,!0)).format()},a.prototype.resolveObject=function(e){if(r.isString(e)){var t=new a;t.parse(e,!1,!0),e=t}for(var i=new a,n=Object.keys(this),o=0;o<n.length;o++){var s=n[o];i[s]=this[s]}if(i.hash=e.hash,""===e.href)return i.href=i.format(),i;if(e.slashes&&!e.protocol){for(var c=Object.keys(e),l=0;l<c.length;l++){var u=c[l];"protocol"!==u&&(i[u]=e[u])}return g[i.protocol]&&i.hostname&&!i.pathname&&(i.path=i.pathname="/"),i.href=i.format(),i}if(e.protocol&&e.protocol!==i.protocol){if(!g[e.protocol]){for(var h=Object.keys(e),d=0;d<h.length;d++){var f=h[d];i[f]=e[f]}return i.href=i.format(),i}if(i.protocol=e.protocol,e.host||_[e.protocol])i.pathname=e.pathname;else{for(var p=(e.pathname||"").split("/");p.length&&!(e.host=p.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==p[0]&&p.unshift(""),p.length<2&&p.unshift(""),i.pathname=p.join("/")}if(i.search=e.search,i.query=e.query,i.host=e.host||"",i.auth=e.auth,i.hostname=e.hostname||e.host,i.port=e.port,i.pathname||i.search){var m=i.pathname||"",v=i.search||"";i.path=m+v}return i.slashes=i.slashes||e.slashes,i.href=i.format(),i}var b=i.pathname&&"/"===i.pathname.charAt(0),y=e.host||e.pathname&&"/"===e.pathname.charAt(0),w=y||b||i.host&&e.pathname,O=w,x=i.pathname&&i.pathname.split("/")||[],E=(p=e.pathname&&e.pathname.split("/")||[],i.protocol&&!g[i.protocol]);if(E&&(i.hostname="",i.port=null,i.host&&(""===x[0]?x[0]=i.host:x.unshift(i.host)),i.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===p[0]?p[0]=e.host:p.unshift(e.host)),e.host=null),w=w&&(""===p[0]||""===x[0])),y)i.host=e.host||""===e.host?e.host:i.host,i.hostname=e.hostname||""===e.hostname?e.hostname:i.hostname,i.search=e.search,i.query=e.query,x=p;else if(p.length)x||(x=[]),x.pop(),x=x.concat(p),i.search=e.search,i.query=e.query;else if(!r.isNullOrUndefined(e.search)){if(E)i.hostname=i.host=x.shift(),(P=!!(i.host&&i.host.indexOf("@")>0)&&i.host.split("@"))&&(i.auth=P.shift(),i.host=i.hostname=P.shift());return i.search=e.search,i.query=e.query,r.isNull(i.pathname)&&r.isNull(i.search)||(i.path=(i.pathname?i.pathname:"")+(i.search?i.search:"")),i.href=i.format(),i}if(!x.length)return i.pathname=null,i.search?i.path="/"+i.search:i.path=null,i.href=i.format(),i;for(var T=x.slice(-1)[0],C=(i.host||e.host||x.length>1)&&("."===T||".."===T)||""===T,S=0,A=x.length;A>=0;A--)"."===(T=x[A])?x.splice(A,1):".."===T?(x.splice(A,1),S++):S&&(x.splice(A,1),S--);if(!w&&!O)for(;S--;S)x.unshift("..");!w||""===x[0]||x[0]&&"/"===x[0].charAt(0)||x.unshift(""),C&&"/"!==x.join("/").substr(-1)&&x.push("");var P,I=""===x[0]||x[0]&&"/"===x[0].charAt(0);E&&(i.hostname=i.host=I?"":x.length?x.shift():"",(P=!!(i.host&&i.host.indexOf("@")>0)&&i.host.split("@"))&&(i.auth=P.shift(),i.host=i.hostname=P.shift()));return(w=w||i.host&&x.length)&&!I&&x.unshift(""),x.length?i.pathname=x.join("/"):(i.pathname=null,i.path=null),r.isNull(i.pathname)&&r.isNull(i.search)||(i.path=(i.pathname?i.pathname:"")+(i.search?i.search:"")),i.auth=e.auth||i.auth,i.slashes=i.slashes||e.slashes,i.href=i.format(),i},a.prototype.parseHost=function(){var e=this.host,t=s.exec(e);t&&(":"!==(t=t[0])&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)}},function(e,t,i){var n=i(15),r=n.Buffer;function a(e,t){for(var i in e)t[i]=e[i]}function o(e,t,i){return r(e,t,i)}r.from&&r.alloc&&r.allocUnsafe&&r.allocUnsafeSlow?e.exports=n:(a(n,t),t.Buffer=o),a(r,o),o.from=function(e,t,i){if("number"==typeof e)throw new TypeError("Argument must not be a number");return r(e,t,i)},o.alloc=function(e,t,i){if("number"!=typeof e)throw new TypeError("Argument must be a number");var n=r(e);return void 0!==t?"string"==typeof i?n.fill(t,i):n.fill(t):n.fill(0),n},o.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return r(e)},o.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return n.SlowBuffer(e)}},function(e,t,i){"use strict";(function(t,n,r){var a=i(107);function o(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t,i){var n=e.entry;e.entry=null;for(;n;){var r=n.callback;t.pendingcb--,r(i),n=n.next}t.corkedRequestsFree?t.corkedRequestsFree.next=e:t.corkedRequestsFree=e}(t,e)}}e.exports=v;var s,c=!t.browser&&["v0.10","v0.9."].indexOf(t.version.slice(0,5))>-1?n:a.nextTick;v.WritableState=g;var l=i(38);l.inherits=i(30);var u={deprecate:i(225)},h=i(152),d=i(124).Buffer,f=r.Uint8Array||function(){};var p,m=i(153);function _(){}function g(e,t){s=s||i(61),e=e||{};var n=t instanceof s;this.objectMode=!!e.objectMode,n&&(this.objectMode=this.objectMode||!!e.writableObjectMode);var r=e.highWaterMark,l=e.writableHighWaterMark,u=this.objectMode?16:16384;this.highWaterMark=r||0===r?r:n&&(l||0===l)?l:u,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var h=!1===e.decodeStrings;this.decodeStrings=!h,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var i=e._writableState,n=i.sync,r=i.writecb;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(i),t)!function(e,t,i,n,r){--t.pendingcb,i?(a.nextTick(r,n),a.nextTick(E,e,t),e._writableState.errorEmitted=!0,e.emit("error",n)):(r(n),e._writableState.errorEmitted=!0,e.emit("error",n),E(e,t))}(e,i,n,t,r);else{var o=O(i);o||i.corked||i.bufferProcessing||!i.bufferedRequest||w(e,i),n?c(y,e,i,o,r):y(e,i,o,r)}}(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new o(this)}function v(e){if(s=s||i(61),!(p.call(v,this)||this instanceof s))return new v(e);this._writableState=new g(e,this),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final)),h.call(this)}function b(e,t,i,n,r,a,o){t.writelen=n,t.writecb=o,t.writing=!0,t.sync=!0,i?e._writev(r,t.onwrite):e._write(r,a,t.onwrite),t.sync=!1}function y(e,t,i,n){i||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,n(),E(e,t)}function w(e,t){t.bufferProcessing=!0;var i=t.bufferedRequest;if(e._writev&&i&&i.next){var n=t.bufferedRequestCount,r=new Array(n),a=t.corkedRequestsFree;a.entry=i;for(var s=0,c=!0;i;)r[s]=i,i.isBuf||(c=!1),i=i.next,s+=1;r.allBuffers=c,b(e,t,!0,t.length,r,"",a.finish),t.pendingcb++,t.lastBufferedRequest=null,a.next?(t.corkedRequestsFree=a.next,a.next=null):t.corkedRequestsFree=new o(t),t.bufferedRequestCount=0}else{for(;i;){var l=i.chunk,u=i.encoding,h=i.callback;if(b(e,t,!1,t.objectMode?1:l.length,l,u,h),i=i.next,t.bufferedRequestCount--,t.writing)break}null===i&&(t.lastBufferedRequest=null)}t.bufferedRequest=i,t.bufferProcessing=!1}function O(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function x(e,t){e._final((function(i){t.pendingcb--,i&&e.emit("error",i),t.prefinished=!0,e.emit("prefinish"),E(e,t)}))}function E(e,t){var i=O(t);return i&&(!function(e,t){t.prefinished||t.finalCalled||("function"==typeof e._final?(t.pendingcb++,t.finalCalled=!0,a.nextTick(x,e,t)):(t.prefinished=!0,e.emit("prefinish")))}(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"))),i}l.inherits(v,h),g.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(g.prototype,"buffer",{get:u.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(p=Function.prototype[Symbol.hasInstance],Object.defineProperty(v,Symbol.hasInstance,{value:function(e){return!!p.call(this,e)||this===v&&(e&&e._writableState instanceof g)}})):p=function(e){return e instanceof this},v.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},v.prototype.write=function(e,t,i){var n,r=this._writableState,o=!1,s=!r.objectMode&&(n=e,d.isBuffer(n)||n instanceof f);return s&&!d.isBuffer(e)&&(e=function(e){return d.from(e)}(e)),"function"==typeof t&&(i=t,t=null),s?t="buffer":t||(t=r.defaultEncoding),"function"!=typeof i&&(i=_),r.ended?function(e,t){var i=new Error("write after end");e.emit("error",i),a.nextTick(t,i)}(this,i):(s||function(e,t,i,n){var r=!0,o=!1;return null===i?o=new TypeError("May not write null values to stream"):"string"==typeof i||void 0===i||t.objectMode||(o=new TypeError("Invalid non-string/buffer chunk")),o&&(e.emit("error",o),a.nextTick(n,o),r=!1),r}(this,r,e,i))&&(r.pendingcb++,o=function(e,t,i,n,r,a){if(!i){var o=function(e,t,i){e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=d.from(t,i));return t}(t,n,r);n!==o&&(i=!0,r="buffer",n=o)}var s=t.objectMode?1:n.length;t.length+=s;var c=t.length<t.highWaterMark;c||(t.needDrain=!0);if(t.writing||t.corked){var l=t.lastBufferedRequest;t.lastBufferedRequest={chunk:n,encoding:r,isBuf:i,callback:a,next:null},l?l.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else b(e,t,!1,s,n,r,a);return c}(this,r,s,e,t,i)),o},v.prototype.cork=function(){this._writableState.corked++},v.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.finished||e.bufferProcessing||!e.bufferedRequest||w(this,e))},v.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(v.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),v.prototype._write=function(e,t,i){i(new Error("_write() is not implemented"))},v.prototype._writev=null,v.prototype.end=function(e,t,i){var n=this._writableState;"function"==typeof e?(i=e,e=null,t=null):"function"==typeof t&&(i=t,t=null),null!=e&&this.write(e,t),n.corked&&(n.corked=1,this.uncork()),n.ending||n.finished||function(e,t,i){t.ending=!0,E(e,t),i&&(t.finished?a.nextTick(i):e.once("finish",i));t.ended=!0,e.writable=!1}(this,n,i)},Object.defineProperty(v.prototype,"destroyed",{get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),v.prototype.destroy=m.destroy,v.prototype._undestroy=m.undestroy,v.prototype._destroy=function(e,t){this.end(),t(e)}}).call(this,i(23),i(223).setImmediate,i(40))},function(e,t,i){"use strict";(function(t){var n=i(236);
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */function r(e,t){if(e===t)return 0;for(var i=e.length,n=t.length,r=0,a=Math.min(i,n);r<a;++r)if(e[r]!==t[r]){i=e[r],n=t[r];break}return i<n?-1:n<i?1:0}function a(e){return t.Buffer&&"function"==typeof t.Buffer.isBuffer?t.Buffer.isBuffer(e):!(null==e||!e._isBuffer)}var o=i(52),s=Object.prototype.hasOwnProperty,c=Array.prototype.slice,l="foo"===function(){}.name;function u(e){return Object.prototype.toString.call(e)}function h(e){return!a(e)&&("function"==typeof t.ArrayBuffer&&("function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):!!e&&(e instanceof DataView||!!(e.buffer&&e.buffer instanceof ArrayBuffer))))}var d=e.exports=v,f=/\s*function\s+([^\(\s]*)\s*/;function p(e){if(o.isFunction(e)){if(l)return e.name;var t=e.toString().match(f);return t&&t[1]}}function m(e,t){return"string"==typeof e?e.length<t?e:e.slice(0,t):e}function _(e){if(l||!o.isFunction(e))return o.inspect(e);var t=p(e);return"[Function"+(t?": "+t:"")+"]"}function g(e,t,i,n,r){throw new d.AssertionError({message:i,actual:e,expected:t,operator:n,stackStartFunction:r})}function v(e,t){e||g(e,!0,t,"==",d.ok)}function b(e,t,i,n){if(e===t)return!0;if(a(e)&&a(t))return 0===r(e,t);if(o.isDate(e)&&o.isDate(t))return e.getTime()===t.getTime();if(o.isRegExp(e)&&o.isRegExp(t))return e.source===t.source&&e.global===t.global&&e.multiline===t.multiline&&e.lastIndex===t.lastIndex&&e.ignoreCase===t.ignoreCase;if(null!==e&&"object"==typeof e||null!==t&&"object"==typeof t){if(h(e)&&h(t)&&u(e)===u(t)&&!(e instanceof Float32Array||e instanceof Float64Array))return 0===r(new Uint8Array(e.buffer),new Uint8Array(t.buffer));if(a(e)!==a(t))return!1;var s=(n=n||{actual:[],expected:[]}).actual.indexOf(e);return-1!==s&&s===n.expected.indexOf(t)||(n.actual.push(e),n.expected.push(t),function(e,t,i,n){if(null==e||null==t)return!1;if(o.isPrimitive(e)||o.isPrimitive(t))return e===t;if(i&&Object.getPrototypeOf(e)!==Object.getPrototypeOf(t))return!1;var r=y(e),a=y(t);if(r&&!a||!r&&a)return!1;if(r)return e=c.call(e),t=c.call(t),b(e,t,i);var s,l,u=x(e),h=x(t);if(u.length!==h.length)return!1;for(u.sort(),h.sort(),l=u.length-1;l>=0;l--)if(u[l]!==h[l])return!1;for(l=u.length-1;l>=0;l--)if(s=u[l],!b(e[s],t[s],i,n))return!1;return!0}(e,t,i,n))}return i?e===t:e==t}function y(e){return"[object Arguments]"==Object.prototype.toString.call(e)}function w(e,t){if(!e||!t)return!1;if("[object RegExp]"==Object.prototype.toString.call(t))return t.test(e);try{if(e instanceof t)return!0}catch(e){}return!Error.isPrototypeOf(t)&&!0===t.call({},e)}function O(e,t,i,n){var r;if("function"!=typeof t)throw new TypeError('"block" argument must be a function');"string"==typeof i&&(n=i,i=null),r=function(e){var t;try{e()}catch(e){t=e}return t}(t),n=(i&&i.name?" ("+i.name+").":".")+(n?" "+n:"."),e&&!r&&g(r,i,"Missing expected exception"+n);var a="string"==typeof n,s=!e&&r&&!i;if((!e&&o.isError(r)&&a&&w(r,i)||s)&&g(r,i,"Got unwanted exception"+n),e&&r&&i&&!w(r,i)||!e&&r)throw r}d.AssertionError=function(e){this.name="AssertionError",this.actual=e.actual,this.expected=e.expected,this.operator=e.operator,e.message?(this.message=e.message,this.generatedMessage=!1):(this.message=function(e){return m(_(e.actual),128)+" "+e.operator+" "+m(_(e.expected),128)}(this),this.generatedMessage=!0);var t=e.stackStartFunction||g;if(Error.captureStackTrace)Error.captureStackTrace(this,t);else{var i=new Error;if(i.stack){var n=i.stack,r=p(t),a=n.indexOf("\n"+r);if(a>=0){var o=n.indexOf("\n",a+1);n=n.substring(o+1)}this.stack=n}}},o.inherits(d.AssertionError,Error),d.fail=g,d.ok=v,d.equal=function(e,t,i){e!=t&&g(e,t,i,"==",d.equal)},d.notEqual=function(e,t,i){e==t&&g(e,t,i,"!=",d.notEqual)},d.deepEqual=function(e,t,i){b(e,t,!1)||g(e,t,i,"deepEqual",d.deepEqual)},d.deepStrictEqual=function(e,t,i){b(e,t,!0)||g(e,t,i,"deepStrictEqual",d.deepStrictEqual)},d.notDeepEqual=function(e,t,i){b(e,t,!1)&&g(e,t,i,"notDeepEqual",d.notDeepEqual)},d.notDeepStrictEqual=function e(t,i,n){b(t,i,!0)&&g(t,i,n,"notDeepStrictEqual",e)},d.strictEqual=function(e,t,i){e!==t&&g(e,t,i,"===",d.strictEqual)},d.notStrictEqual=function(e,t,i){e===t&&g(e,t,i,"!==",d.notStrictEqual)},d.throws=function(e,t,i){O(!0,e,t,i)},d.doesNotThrow=function(e,t,i){O(!1,e,t,i)},d.ifError=function(e){if(e)throw e},d.strict=n((function e(t,i){t||g(t,!0,i,"==",e)}),d,{equal:d.strictEqual,deepEqual:d.deepStrictEqual,notEqual:d.notStrictEqual,notDeepEqual:d.notDeepStrictEqual}),d.strict.strict=d.strict;var x=Object.keys||function(e){var t=[];for(var i in e)s.call(e,i)&&t.push(i);return t}}).call(this,i(40))},function(e,t){function i(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}i.keys=function(){return[]},i.resolve=i,e.exports=i,i.id=127},function(e,t,i){"use strict";var n=i(32),r=i(48),a=i(42),o=i(56),s=i(157),c=i(159),l=Math.max,u=Math.min,h=Math.floor,d=/\$([$&`']|\d\d?|<[^>]*>)/g,f=/\$([$&`']|\d\d?)/g;i(160)("replace",2,(function(e,t,i,p){return[function(n,r){var a=e(this),o=null==n?void 0:n[t];return void 0!==o?o.call(n,a,r):i.call(String(a),n,r)},function(e,t){var r=p(i,e,this,t);if(r.done)return r.value;var h=n(e),d=String(this),f="function"==typeof t;f||(t=String(t));var _=h.global;if(_){var g=h.unicode;h.lastIndex=0}for(var v=[];;){var b=c(h,d);if(null===b)break;if(v.push(b),!_)break;""===String(b[0])&&(h.lastIndex=s(d,a(h.lastIndex),g))}for(var y,w="",O=0,x=0;x<v.length;x++){b=v[x];for(var E=String(b[0]),T=l(u(o(b.index),d.length),0),C=[],S=1;S<b.length;S++)C.push(void 0===(y=b[S])?y:String(y));var A=b.groups;if(f){var P=[E].concat(C,T,d);void 0!==A&&P.push(A);var I=String(t.apply(void 0,P))}else I=m(E,d,T,C,A,t);T>=O&&(w+=d.slice(O,T)+I,O=T+E.length)}return w+d.slice(O)}];function m(e,t,n,a,o,s){var c=n+e.length,l=a.length,u=f;return void 0!==o&&(o=r(o),u=d),i.call(s,u,(function(i,r){var s;switch(r.charAt(0)){case"$":return"$";case"&":return e;case"`":return t.slice(0,n);case"'":return t.slice(c);case"<":s=o[r.slice(1,-1)];break;default:var u=+r;if(0===u)return i;if(u>l){var d=h(u/10);return 0===d?i:d<=l?void 0===a[d-1]?r.charAt(1):a[d-1]+r.charAt(1):i}s=a[u-1]}return void 0===s?"":s}))}}))},function(e,t,i){"use strict";var n,r,a=i(111),o=RegExp.prototype.exec,s=String.prototype.replace,c=o,l=(n=/a/,r=/b*/g,o.call(n,"a"),o.call(r,"a"),0!==n.lastIndex||0!==r.lastIndex),u=void 0!==/()??/.exec("")[1];(l||u)&&(c=function(e){var t,i,n,r,c=this;return u&&(i=new RegExp("^"+c.source+"$(?!\\s)",a.call(c))),l&&(t=c.lastIndex),n=o.call(c,e),l&&n&&(c.lastIndex=c.global?n.index+n[0].length:t),u&&n&&n.length>1&&s.call(n[0],i,(function(){for(r=1;r<arguments.length-2;r++)void 0===arguments[r]&&(n[r]=void 0)})),n}),e.exports=c},function(e,t,i){var n=i(31),r=i(26).document,a=n(r)&&n(r.createElement);e.exports=function(e){return a?r.createElement(e):{}}},function(e,t){t.f={}.propertyIsEnumerable},function(e,t,i){var n=i(110)("keys"),r=i(64);e.exports=function(e){return n[e]||(n[e]=r(e))}},function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(e,t,i){var n=i(31),r=i(70),a=i(24)("match");e.exports=function(e){var t;return n(e)&&(void 0!==(t=e[a])?!!t:"RegExp"==r(e))}},function(e,t){t.f=Object.getOwnPropertySymbols},function(e,t,i){var n=i(70);e.exports=Array.isArray||function(e){return"Array"==n(e)}},function(e,t,i){var n=i(32),r=i(92),a=i(24)("species");e.exports=function(e,t){var i,o=n(e).constructor;return void 0===o||null==(i=n(o)[a])?t:r(i)}},function(e,t,i){var n=i(16);n(n.S,"Array",{isArray:i(136)})},function(e,t,i){"use strict";var n=i(63),r=i(16),a=i(45),o=i(44),s=i(76),c=i(255),l=i(75),u=i(119),h=i(24)("iterator"),d=!([].keys&&"next"in[].keys()),f=function(){return this};e.exports=function(e,t,i,p,m,_,g){c(i,t,p);var v,b,y,w=function(e){if(!d&&e in T)return T[e];switch(e){case"keys":case"values":return function(){return new i(this,e)}}return function(){return new i(this,e)}},O=t+" Iterator",x="values"==m,E=!1,T=e.prototype,C=T[h]||T["@@iterator"]||m&&T[m],S=C||w(m),A=m?x?w("entries"):S:void 0,P="Array"==t&&T.entries||C;if(P&&(y=u(P.call(new e)))!==Object.prototype&&y.next&&(l(y,O,!0),n||"function"==typeof y[h]||o(y,h,f)),x&&C&&"values"!==C.name&&(E=!0,S=function(){return C.call(this)}),n&&!g||!d&&!E&&T[h]||o(T,h,S),s[t]=S,s[O]=f,m)if(v={values:x?S:w("values"),keys:_?S:w("keys"),entries:A},g)for(b in v)b in T||a(T,b,v[b]);else r(r.P+r.F*(d||E),t,v);return v}},function(e,t,i){var n=i(53),r=i(174),a=i(141),o=i(32),s=i(42),c=i(142),l={},u={};(t=e.exports=function(e,t,i,h,d){var f,p,m,_,g=d?function(){return e}:c(e),v=n(i,h,t?2:1),b=0;if("function"!=typeof g)throw TypeError(e+" is not iterable!");if(a(g)){for(f=s(e.length);f>b;b++)if((_=t?v(o(p=e[b])[0],p[1]):v(e[b]))===l||_===u)return _}else for(m=g.call(e);!(p=m.next()).done;)if((_=r(m,v,p.value,t))===l||_===u)return _}).BREAK=l,t.RETURN=u},function(e,t,i){var n=i(76),r=i(24)("iterator"),a=Array.prototype;e.exports=function(e){return void 0!==e&&(n.Array===e||a[r]===e)}},function(e,t,i){var n=i(90),r=i(24)("iterator"),a=i(76);e.exports=i(62).getIteratorMethod=function(e){if(null!=e)return e[r]||e["@@iterator"]||a[n(e)]}},function(e,t,i){var n=i(31);e.exports=function(e,t){if(!n(e)||e._t!==t)throw TypeError("Incompatible receiver, "+t+" required!");return e}},function(e,t,i){"use strict";var n=i(48),r=i(113),a=i(42);e.exports=function(e){for(var t=n(this),i=a(t.length),o=arguments.length,s=r(o>1?arguments[1]:void 0,i),c=o>2?arguments[2]:void 0,l=void 0===c?i:r(c,i);l>s;)t[s++]=e;return t}},function(e,t,i){var n=i(314),r=i(315),a="undefined"!=typeof Float64Array;function o(e,t){return e[0]-t[0]}function s(){var e,t=this.stride,i=new Array(t.length);for(e=0;e<i.length;++e)i[e]=[Math.abs(t[e]),e];i.sort(o);var n=new Array(i.length);for(e=0;e<n.length;++e)n[e]=i[e][1];return n}function c(e,t){var i=["View",t,"d",e].join("");t<0&&(i="View_Nil"+e);var r="generic"===e;if(-1===t){var a="function "+i+"(a){this.data=a;};var proto="+i+".prototype;proto.dtype='"+e+"';proto.index=function(){return -1};proto.size=0;proto.dimension=-1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function(){return new "+i+"(this.data);};proto.get=proto.set=function(){};proto.pick=function(){return null};return function construct_"+i+"(a){return new "+i+"(a);}";return new Function(a)()}if(0===t){a="function "+i+"(a,d) {this.data = a;this.offset = d};var proto="+i+".prototype;proto.dtype='"+e+"';proto.index=function(){return this.offset};proto.dimension=0;proto.size=1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function "+i+"_copy() {return new "+i+"(this.data,this.offset)};proto.pick=function "+i+"_pick(){return TrivialArray(this.data);};proto.valueOf=proto.get=function "+i+"_get(){return "+(r?"this.data.get(this.offset)":"this.data[this.offset]")+"};proto.set=function "+i+"_set(v){return "+(r?"this.data.set(this.offset,v)":"this.data[this.offset]=v")+"};return function construct_"+i+"(a,b,c,d){return new "+i+"(a,d)}";return new Function("TrivialArray",a)(l[e][0])}a=["'use strict'"];var o=n(t),c=o.map((function(e){return"i"+e})),u="this.offset+"+o.map((function(e){return"this.stride["+e+"]*i"+e})).join("+"),h=o.map((function(e){return"b"+e})).join(","),d=o.map((function(e){return"c"+e})).join(",");a.push("function "+i+"(a,"+h+","+d+",d){this.data=a","this.shape=["+h+"]","this.stride=["+d+"]","this.offset=d|0}","var proto="+i+".prototype","proto.dtype='"+e+"'","proto.dimension="+t),a.push("Object.defineProperty(proto,'size',{get:function "+i+"_size(){return "+o.map((function(e){return"this.shape["+e+"]"})).join("*"),"}})"),1===t?a.push("proto.order=[0]"):(a.push("Object.defineProperty(proto,'order',{get:"),t<4?(a.push("function "+i+"_order(){"),2===t?a.push("return (Math.abs(this.stride[0])>Math.abs(this.stride[1]))?[1,0]:[0,1]}})"):3===t&&a.push("var s0=Math.abs(this.stride[0]),s1=Math.abs(this.stride[1]),s2=Math.abs(this.stride[2]);if(s0>s1){if(s1>s2){return [2,1,0];}else if(s0>s2){return [1,2,0];}else{return [1,0,2];}}else if(s0>s2){return [2,0,1];}else if(s2>s1){return [0,1,2];}else{return [0,2,1];}}})")):a.push("ORDER})")),a.push("proto.set=function "+i+"_set("+c.join(",")+",v){"),r?a.push("return this.data.set("+u+",v)}"):a.push("return this.data["+u+"]=v}"),a.push("proto.get=function "+i+"_get("+c.join(",")+"){"),r?a.push("return this.data.get("+u+")}"):a.push("return this.data["+u+"]}"),a.push("proto.index=function "+i+"_index(",c.join(),"){return "+u+"}"),a.push("proto.hi=function "+i+"_hi("+c.join(",")+"){return new "+i+"(this.data,"+o.map((function(e){return["(typeof i",e,"!=='number'||i",e,"<0)?this.shape[",e,"]:i",e,"|0"].join("")})).join(",")+","+o.map((function(e){return"this.stride["+e+"]"})).join(",")+",this.offset)}");var f=o.map((function(e){return"a"+e+"=this.shape["+e+"]"})),p=o.map((function(e){return"c"+e+"=this.stride["+e+"]"}));a.push("proto.lo=function "+i+"_lo("+c.join(",")+"){var b=this.offset,d=0,"+f.join(",")+","+p.join(","));for(var m=0;m<t;++m)a.push("if(typeof i"+m+"==='number'&&i"+m+">=0){d=i"+m+"|0;b+=c"+m+"*d;a"+m+"-=d}");a.push("return new "+i+"(this.data,"+o.map((function(e){return"a"+e})).join(",")+","+o.map((function(e){return"c"+e})).join(",")+",b)}"),a.push("proto.step=function "+i+"_step("+c.join(",")+"){var "+o.map((function(e){return"a"+e+"=this.shape["+e+"]"})).join(",")+","+o.map((function(e){return"b"+e+"=this.stride["+e+"]"})).join(",")+",c=this.offset,d=0,ceil=Math.ceil");for(m=0;m<t;++m)a.push("if(typeof i"+m+"==='number'){d=i"+m+"|0;if(d<0){c+=b"+m+"*(a"+m+"-1);a"+m+"=ceil(-a"+m+"/d)}else{a"+m+"=ceil(a"+m+"/d)}b"+m+"*=d}");a.push("return new "+i+"(this.data,"+o.map((function(e){return"a"+e})).join(",")+","+o.map((function(e){return"b"+e})).join(",")+",c)}");var _=new Array(t),g=new Array(t);for(m=0;m<t;++m)_[m]="a[i"+m+"]",g[m]="b[i"+m+"]";a.push("proto.transpose=function "+i+"_transpose("+c+"){"+c.map((function(e,t){return e+"=("+e+"===undefined?"+t+":"+e+"|0)"})).join(";"),"var a=this.shape,b=this.stride;return new "+i+"(this.data,"+_.join(",")+","+g.join(",")+",this.offset)}"),a.push("proto.pick=function "+i+"_pick("+c+"){var a=[],b=[],c=this.offset");for(m=0;m<t;++m)a.push("if(typeof i"+m+"==='number'&&i"+m+">=0){c=(c+this.stride["+m+"]*i"+m+")|0}else{a.push(this.shape["+m+"]);b.push(this.stride["+m+"])}");return a.push("var ctor=CTOR_LIST[a.length+1];return ctor(this.data,a,b,c)}"),a.push("return function construct_"+i+"(data,shape,stride,offset){return new "+i+"(data,"+o.map((function(e){return"shape["+e+"]"})).join(",")+","+o.map((function(e){return"stride["+e+"]"})).join(",")+",offset)}"),new Function("CTOR_LIST","ORDER",a.join("\n"))(l[e],s)}var l={float32:[],float64:[],int8:[],int16:[],int32:[],uint8:[],uint16:[],uint32:[],array:[],uint8_clamped:[],buffer:[],generic:[]};e.exports=function(e,t,i,n){if(void 0===e)return(0,l.array[0])([]);"number"==typeof e&&(e=[e]),void 0===t&&(t=[e.length]);var o=t.length;if(void 0===i){i=new Array(o);for(var s=o-1,u=1;s>=0;--s)i[s]=u,u*=t[s]}if(void 0===n){n=0;for(s=0;s<o;++s)i[s]<0&&(n-=(t[s]-1)*i[s])}for(var h=function(e){if(r(e))return"buffer";if(a)switch(Object.prototype.toString.call(e)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8";case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object Uint8ClampedArray]":return"uint8_clamped"}return Array.isArray(e)?"array":"generic"}(e),d=l[h];d.length<=o+1;)d.push(c(h,d.length-1));return(0,d[o+1])(e,t,i,n)}},function(e,t,i){(function(t){e.exports=s;var n=Object.keys||function(e){var t=[];for(var i in e)t.push(i);return t},r=i(38);r.inherits=i(30);var a=i(192),o=i(194);function s(e){if(!(this instanceof s))return new s(e);a.call(this,e),o.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",c)}function c(){this.allowHalfOpen||this._writableState.ended||t.nextTick(this.end.bind(this))}r.inherits(s,a),function(e,t){for(var i=0,n=e.length;i<n;i++)t(e[i],i)}(n(o.prototype),(function(e){s.prototype[e]||(s.prototype[e]=o.prototype[e])}))}).call(this,i(23))},function(e,t){var i={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==i.call(e)}},function(e,t,i){(function(e){var n=i(219),r=i(150),a=i(229),o=i(230),s=i(123),c=t;c.request=function(t,i){t="string"==typeof t?s.parse(t):a(t);var r=-1===e.location.protocol.search(/^https?:$/)?"http:":"",o=t.protocol||r,c=t.hostname||t.host,l=t.port,u=t.path||"/";c&&-1!==c.indexOf(":")&&(c="["+c+"]"),t.url=(c?o+"//"+c:"")+(l?":"+l:"")+u,t.method=(t.method||"GET").toUpperCase(),t.headers=t.headers||{};var h=new n(t);return i&&h.on("response",i),h},c.get=function(e,t){var i=c.request(e,t);return i.end(),i},c.ClientRequest=n,c.IncomingMessage=r.IncomingMessage,c.Agent=function(){},c.Agent.defaultMaxSockets=4,c.globalAgent=new c.Agent,c.STATUS_CODES=o,c.METHODS=["CHECKOUT","CONNECT","COPY","DELETE","GET","HEAD","LOCK","M-SEARCH","MERGE","MKACTIVITY","MKCOL","MOVE","NOTIFY","OPTIONS","PATCH","POST","PROPFIND","PROPPATCH","PURGE","PUT","REPORT","SEARCH","SUBSCRIBE","TRACE","UNLOCK","UNSUBSCRIBE"]}).call(this,i(40))},function(e,t,i){(function(e){t.fetch=s(e.fetch)&&s(e.ReadableStream),t.writableStream=s(e.WritableStream),t.abortController=s(e.AbortController),t.blobConstructor=!1;try{new Blob([new ArrayBuffer(1)]),t.blobConstructor=!0}catch(e){}var i;function n(){if(void 0!==i)return i;if(e.XMLHttpRequest){i=new e.XMLHttpRequest;try{i.open("GET",e.XDomainRequest?"/":"https://example.com")}catch(e){i=null}}else i=null;return i}function r(e){var t=n();if(!t)return!1;try{return t.responseType=e,t.responseType===e}catch(e){}return!1}var a=void 0!==e.ArrayBuffer,o=a&&s(e.ArrayBuffer.prototype.slice);function s(e){return"function"==typeof e}t.arraybuffer=t.fetch||a&&r("arraybuffer"),t.msstream=!t.fetch&&o&&r("ms-stream"),t.mozchunkedarraybuffer=!t.fetch&&a&&r("moz-chunked-arraybuffer"),t.overrideMimeType=t.fetch||!!n()&&s(n().overrideMimeType),t.vbArray=s(e.VBArray),i=null}).call(this,i(40))},function(e,t,i){(function(e,n,r){var a=i(149),o=i(30),s=i(88),c=t.readyStates={UNSENT:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4},l=t.IncomingMessage=function(t,i,o,c){var l=this;if(s.Readable.call(l),l._mode=o,l.headers={},l.rawHeaders=[],l.trailers={},l.rawTrailers=[],l.on("end",(function(){e.nextTick((function(){l.emit("close")}))})),"fetch"===o){if(l._fetchResponse=i,l.url=i.url,l.statusCode=i.status,l.statusMessage=i.statusText,i.headers.forEach((function(e,t){l.headers[t.toLowerCase()]=e,l.rawHeaders.push(t,e)})),a.writableStream){var u=new WritableStream({write:function(e){return new Promise((function(t,i){l._destroyed?i():l.push(new n(e))?t():l._resumeFetch=t}))},close:function(){r.clearTimeout(c),l._destroyed||l.push(null)},abort:function(e){l._destroyed||l.emit("error",e)}});try{return void i.body.pipeTo(u).catch((function(e){r.clearTimeout(c),l._destroyed||l.emit("error",e)}))}catch(e){}}var h=i.body.getReader();!function e(){h.read().then((function(t){if(!l._destroyed){if(t.done)return r.clearTimeout(c),void l.push(null);l.push(new n(t.value)),e()}})).catch((function(e){r.clearTimeout(c),l._destroyed||l.emit("error",e)}))}()}else{if(l._xhr=t,l._pos=0,l.url=t.responseURL,l.statusCode=t.status,l.statusMessage=t.statusText,t.getAllResponseHeaders().split(/\r?\n/).forEach((function(e){var t=e.match(/^([^:]+):\s*(.*)/);if(t){var i=t[1].toLowerCase();"set-cookie"===i?(void 0===l.headers[i]&&(l.headers[i]=[]),l.headers[i].push(t[2])):void 0!==l.headers[i]?l.headers[i]+=", "+t[2]:l.headers[i]=t[2],l.rawHeaders.push(t[1],t[2])}})),l._charset="x-user-defined",!a.overrideMimeType){var d=l.rawHeaders["mime-type"];if(d){var f=d.match(/;\s*charset=([^;])(;|$)/);f&&(l._charset=f[1].toLowerCase())}l._charset||(l._charset="utf-8")}}};o(l,s.Readable),l.prototype._read=function(){var e=this._resumeFetch;e&&(this._resumeFetch=null,e())},l.prototype._onXHRProgress=function(){var e=this,t=e._xhr,i=null;switch(e._mode){case"text:vbarray":if(t.readyState!==c.DONE)break;try{i=new r.VBArray(t.responseBody).toArray()}catch(e){}if(null!==i){e.push(new n(i));break}case"text":try{i=t.responseText}catch(t){e._mode="text:vbarray";break}if(i.length>e._pos){var a=i.substr(e._pos);if("x-user-defined"===e._charset){for(var o=new n(a.length),s=0;s<a.length;s++)o[s]=255&a.charCodeAt(s);e.push(o)}else e.push(a,e._charset);e._pos=i.length}break;case"arraybuffer":if(t.readyState!==c.DONE||!t.response)break;i=t.response,e.push(new n(new Uint8Array(i)));break;case"moz-chunked-arraybuffer":if(i=t.response,t.readyState!==c.LOADING||!i)break;e.push(new n(new Uint8Array(i)));break;case"ms-stream":if(i=t.response,t.readyState!==c.LOADING)break;var l=new r.MSStreamReader;l.onprogress=function(){l.result.byteLength>e._pos&&(e.push(new n(new Uint8Array(l.result.slice(e._pos)))),e._pos=l.result.byteLength)},l.onload=function(){e.push(null)},l.readAsArrayBuffer(i)}e._xhr.readyState===c.DONE&&"ms-stream"!==e._mode&&e.push(null)}}).call(this,i(23),i(15).Buffer,i(40))},function(e,t,i){"use strict";(function(t,n){var r=i(107);e.exports=b;var a,o=i(147);b.ReadableState=v;i(67).EventEmitter;var s=function(e,t){return e.listeners(t).length},c=i(152),l=i(124).Buffer,u=t.Uint8Array||function(){};var h=i(38);h.inherits=i(30);var d=i(220),f=void 0;f=d&&d.debuglog?d.debuglog("stream"):function(){};var p,m=i(221),_=i(153);h.inherits(b,c);var g=["error","close","destroy","pause","resume"];function v(e,t){e=e||{};var n=t instanceof(a=a||i(61));this.objectMode=!!e.objectMode,n&&(this.objectMode=this.objectMode||!!e.readableObjectMode);var r=e.highWaterMark,o=e.readableHighWaterMark,s=this.objectMode?16:16384;this.highWaterMark=r||0===r?r:n&&(o||0===o)?o:s,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new m,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(p||(p=i(68).StringDecoder),this.decoder=new p(e.encoding),this.encoding=e.encoding)}function b(e){if(a=a||i(61),!(this instanceof b))return new b(e);this._readableState=new v(e,this),this.readable=!0,e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy)),c.call(this)}function y(e,t,i,n,r){var a,o=e._readableState;null===t?(o.reading=!1,function(e,t){if(t.ended)return;if(t.decoder){var i=t.decoder.end();i&&i.length&&(t.buffer.push(i),t.length+=t.objectMode?1:i.length)}t.ended=!0,E(e)}(e,o)):(r||(a=function(e,t){var i;n=t,l.isBuffer(n)||n instanceof u||"string"==typeof t||void 0===t||e.objectMode||(i=new TypeError("Invalid non-string/buffer chunk"));var n;return i}(o,t)),a?e.emit("error",a):o.objectMode||t&&t.length>0?("string"==typeof t||o.objectMode||Object.getPrototypeOf(t)===l.prototype||(t=function(e){return l.from(e)}(t)),n?o.endEmitted?e.emit("error",new Error("stream.unshift() after end event")):w(e,o,t,!0):o.ended?e.emit("error",new Error("stream.push() after EOF")):(o.reading=!1,o.decoder&&!i?(t=o.decoder.write(t),o.objectMode||0!==t.length?w(e,o,t,!1):C(e,o)):w(e,o,t,!1))):n||(o.reading=!1));return function(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}(o)}function w(e,t,i,n){t.flowing&&0===t.length&&!t.sync?(e.emit("data",i),e.read(0)):(t.length+=t.objectMode?1:i.length,n?t.buffer.unshift(i):t.buffer.push(i),t.needReadable&&E(e)),C(e,t)}Object.defineProperty(b.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),b.prototype.destroy=_.destroy,b.prototype._undestroy=_.undestroy,b.prototype._destroy=function(e,t){this.push(null),t(e)},b.prototype.push=function(e,t){var i,n=this._readableState;return n.objectMode?i=!0:"string"==typeof e&&((t=t||n.defaultEncoding)!==n.encoding&&(e=l.from(e,t),t=""),i=!0),y(this,e,t,!1,i)},b.prototype.unshift=function(e){return y(this,e,null,!0,!1)},b.prototype.isPaused=function(){return!1===this._readableState.flowing},b.prototype.setEncoding=function(e){return p||(p=i(68).StringDecoder),this._readableState.decoder=new p(e),this._readableState.encoding=e,this};var O=8388608;function x(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=O?e=O:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function E(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(f("emitReadable",t.flowing),t.emittedReadable=!0,t.sync?r.nextTick(T,e):T(e))}function T(e){f("emit readable"),e.emit("readable"),I(e)}function C(e,t){t.readingMore||(t.readingMore=!0,r.nextTick(S,e,t))}function S(e,t){for(var i=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(f("maybeReadMore read 0"),e.read(0),i!==t.length);)i=t.length;t.readingMore=!1}function A(e){f("readable nexttick read 0"),e.read(0)}function P(e,t){t.reading||(f("resume read 0"),e.read(0)),t.resumeScheduled=!1,t.awaitDrain=0,e.emit("resume"),I(e),t.flowing&&!t.reading&&e.read(0)}function I(e){var t=e._readableState;for(f("flow",t.flowing);t.flowing&&null!==e.read(););}function D(e,t){return 0===t.length?null:(t.objectMode?i=t.buffer.shift():!e||e>=t.length?(i=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.head.data:t.buffer.concat(t.length),t.buffer.clear()):i=function(e,t,i){var n;e<t.head.data.length?(n=t.head.data.slice(0,e),t.head.data=t.head.data.slice(e)):n=e===t.head.data.length?t.shift():i?function(e,t){var i=t.head,n=1,r=i.data;e-=r.length;for(;i=i.next;){var a=i.data,o=e>a.length?a.length:e;if(o===a.length?r+=a:r+=a.slice(0,e),0===(e-=o)){o===a.length?(++n,i.next?t.head=i.next:t.head=t.tail=null):(t.head=i,i.data=a.slice(o));break}++n}return t.length-=n,r}(e,t):function(e,t){var i=l.allocUnsafe(e),n=t.head,r=1;n.data.copy(i),e-=n.data.length;for(;n=n.next;){var a=n.data,o=e>a.length?a.length:e;if(a.copy(i,i.length-e,0,o),0===(e-=o)){o===a.length?(++r,n.next?t.head=n.next:t.head=t.tail=null):(t.head=n,n.data=a.slice(o));break}++r}return t.length-=r,i}(e,t);return n}(e,t.buffer,t.decoder),i);var i}function j(e){var t=e._readableState;if(t.length>0)throw new Error('"endReadable()" called on non-empty stream');t.endEmitted||(t.ended=!0,r.nextTick(M,t,e))}function M(e,t){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}function R(e,t){for(var i=0,n=e.length;i<n;i++)if(e[i]===t)return i;return-1}b.prototype.read=function(e){f("read",e),e=parseInt(e,10);var t=this._readableState,i=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return f("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?j(this):E(this),null;if(0===(e=x(e,t))&&t.ended)return 0===t.length&&j(this),null;var n,r=t.needReadable;return f("need readable",r),(0===t.length||t.length-e<t.highWaterMark)&&f("length less than watermark",r=!0),t.ended||t.reading?f("reading or ended",r=!1):r&&(f("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=x(i,t))),null===(n=e>0?D(e,t):null)?(t.needReadable=!0,e=0):t.length-=e,0===t.length&&(t.ended||(t.needReadable=!0),i!==e&&t.ended&&j(this)),null!==n&&this.emit("data",n),n},b.prototype._read=function(e){this.emit("error",new Error("_read() is not implemented"))},b.prototype.pipe=function(e,t){var i=this,a=this._readableState;switch(a.pipesCount){case 0:a.pipes=e;break;case 1:a.pipes=[a.pipes,e];break;default:a.pipes.push(e)}a.pipesCount+=1,f("pipe count=%d opts=%j",a.pipesCount,t);var c=(!t||!1!==t.end)&&e!==n.stdout&&e!==n.stderr?u:b;function l(t,n){f("onunpipe"),t===i&&n&&!1===n.hasUnpiped&&(n.hasUnpiped=!0,f("cleanup"),e.removeListener("close",g),e.removeListener("finish",v),e.removeListener("drain",h),e.removeListener("error",_),e.removeListener("unpipe",l),i.removeListener("end",u),i.removeListener("end",b),i.removeListener("data",m),d=!0,!a.awaitDrain||e._writableState&&!e._writableState.needDrain||h())}function u(){f("onend"),e.end()}a.endEmitted?r.nextTick(c):i.once("end",c),e.on("unpipe",l);var h=function(e){return function(){var t=e._readableState;f("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&s(e,"data")&&(t.flowing=!0,I(e))}}(i);e.on("drain",h);var d=!1;var p=!1;function m(t){f("ondata"),p=!1,!1!==e.write(t)||p||((1===a.pipesCount&&a.pipes===e||a.pipesCount>1&&-1!==R(a.pipes,e))&&!d&&(f("false write response, pause",i._readableState.awaitDrain),i._readableState.awaitDrain++,p=!0),i.pause())}function _(t){f("onerror",t),b(),e.removeListener("error",_),0===s(e,"error")&&e.emit("error",t)}function g(){e.removeListener("finish",v),b()}function v(){f("onfinish"),e.removeListener("close",g),b()}function b(){f("unpipe"),i.unpipe(e)}return i.on("data",m),function(e,t,i){if("function"==typeof e.prependListener)return e.prependListener(t,i);e._events&&e._events[t]?o(e._events[t])?e._events[t].unshift(i):e._events[t]=[i,e._events[t]]:e.on(t,i)}(e,"error",_),e.once("close",g),e.once("finish",v),e.emit("pipe",i),a.flowing||(f("pipe resume"),i.resume()),e},b.prototype.unpipe=function(e){var t=this._readableState,i={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes?this:(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,i),this);if(!e){var n=t.pipes,r=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var a=0;a<r;a++)n[a].emit("unpipe",this,i);return this}var o=R(t.pipes,e);return-1===o?this:(t.pipes.splice(o,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,i),this)},b.prototype.on=function(e,t){var i=c.prototype.on.call(this,e,t);if("data"===e)!1!==this._readableState.flowing&&this.resume();else if("readable"===e){var n=this._readableState;n.endEmitted||n.readableListening||(n.readableListening=n.needReadable=!0,n.emittedReadable=!1,n.reading?n.length&&E(this):r.nextTick(A,this))}return i},b.prototype.addListener=b.prototype.on,b.prototype.resume=function(){var e=this._readableState;return e.flowing||(f("resume"),e.flowing=!0,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,r.nextTick(P,e,t))}(this,e)),this},b.prototype.pause=function(){return f("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(f("pause"),this._readableState.flowing=!1,this.emit("pause")),this},b.prototype.wrap=function(e){var t=this,i=this._readableState,n=!1;for(var r in e.on("end",(function(){if(f("wrapped end"),i.decoder&&!i.ended){var e=i.decoder.end();e&&e.length&&t.push(e)}t.push(null)})),e.on("data",(function(r){(f("wrapped data"),i.decoder&&(r=i.decoder.write(r)),i.objectMode&&null==r)||(i.objectMode||r&&r.length)&&(t.push(r)||(n=!0,e.pause()))})),e)void 0===this[r]&&"function"==typeof e[r]&&(this[r]=function(t){return function(){return e[t].apply(e,arguments)}}(r));for(var a=0;a<g.length;a++)e.on(g[a],this.emit.bind(this,g[a]));return this._read=function(t){f("wrapped _read",t),n&&(n=!1,e.resume())},this},Object.defineProperty(b.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),b._fromList=D}).call(this,i(40),i(23))},function(e,t,i){e.exports=i(67).EventEmitter},function(e,t,i){"use strict";var n=i(107);function r(e,t){e.emit("error",t)}e.exports={destroy:function(e,t){var i=this,a=this._readableState&&this._readableState.destroyed,o=this._writableState&&this._writableState.destroyed;return a||o?(t?t(e):!e||this._writableState&&this._writableState.errorEmitted||n.nextTick(r,this,e),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,(function(e){!t&&e?(n.nextTick(r,i,e),i._writableState&&(i._writableState.errorEmitted=!0)):t&&t(e)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}}},function(e,t,i){"use strict";e.exports=o;var n=i(61),r=i(38);function a(e,t){var i=this._transformState;i.transforming=!1;var n=i.writecb;if(!n)return this.emit("error",new Error("write callback called multiple times"));i.writechunk=null,i.writecb=null,null!=t&&this.push(t),n(e);var r=this._readableState;r.reading=!1,(r.needReadable||r.length<r.highWaterMark)&&this._read(r.highWaterMark)}function o(e){if(!(this instanceof o))return new o(e);n.call(this,e),this._transformState={afterTransform:a.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",s)}function s(){var e=this;"function"==typeof this._flush?this._flush((function(t,i){c(e,t,i)})):c(this,null,null)}function c(e,t,i){if(t)return e.emit("error",t);if(null!=i&&e.push(i),e._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(e._transformState.transforming)throw new Error("Calling transform done when still transforming");return e.push(null)}r.inherits=i(30),r.inherits(o,n),o.prototype.push=function(e,t){return this._transformState.needTransform=!1,n.prototype.push.call(this,e,t)},o.prototype._transform=function(e,t,i){throw new Error("_transform() is not implemented")},o.prototype._write=function(e,t,i){var n=this._transformState;if(n.writecb=i,n.writechunk=e,n.writeencoding=t,!n.transforming){var r=this._readableState;(n.needTransform||r.needReadable||r.length<r.highWaterMark)&&this._read(r.highWaterMark)}},o.prototype._read=function(e){var t=this._transformState;null!==t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0},o.prototype._destroy=function(e,t){var i=this;n.prototype._destroy.call(this,e,(function(e){t(e),i.emit("close")}))}},function(e,t,i){"use strict";e.exports=function(e,t,i,n){for(var r=65535&e|0,a=e>>>16&65535|0,o=0;0!==i;){i-=o=i>2e3?2e3:i;do{a=a+(r=r+t[n++]|0)|0}while(--o);r%=65521,a%=65521}return r|a<<16|0}},function(e,t,i){"use strict";var n=function(){for(var e,t=[],i=0;i<256;i++){e=i;for(var n=0;n<8;n++)e=1&e?3988292384^e>>>1:e>>>1;t[i]=e}return t}();e.exports=function(e,t,i,r){var a=n,o=r+i;e^=-1;for(var s=r;s<o;s++)e=e>>>8^a[255&(e^t[s])];return-1^e}},function(e,t,i){"use strict";var n=i(158)(!0);e.exports=function(e,t,i){return t+(i?n(e,t).length:1)}},function(e,t,i){var n=i(56),r=i(69);e.exports=function(e){return function(t,i){var a,o,s=String(r(t)),c=n(i),l=s.length;return c<0||c>=l?e?"":void 0:(a=s.charCodeAt(c))<55296||a>56319||c+1===l||(o=s.charCodeAt(c+1))<56320||o>57343?e?s.charAt(c):a:e?s.slice(c,c+2):o-56320+(a-55296<<10)+65536}}},function(e,t,i){"use strict";var n=i(90),r=RegExp.prototype.exec;e.exports=function(e,t){var i=e.exec;if("function"==typeof i){var a=i.call(e,t);if("object"!=typeof a)throw new TypeError("RegExp exec method returned something other than an Object or null");return a}if("RegExp"!==n(e))throw new TypeError("RegExp#exec called on incompatible receiver");return r.call(e,t)}},function(e,t,i){"use strict";i(247);var n=i(45),r=i(44),a=i(35),o=i(69),s=i(24),c=i(129),l=s("species"),u=!a((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")})),h=function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var i="ab".split(e);return 2===i.length&&"a"===i[0]&&"b"===i[1]}();e.exports=function(e,t,i){var d=s(e),f=!a((function(){var t={};return t[d]=function(){return 7},7!=""[e](t)})),p=f?!a((function(){var t=!1,i=/a/;return i.exec=function(){return t=!0,null},"split"===e&&(i.constructor={},i.constructor[l]=function(){return i}),i[d](""),!t})):void 0;if(!f||!p||"replace"===e&&!u||"split"===e&&!h){var m=/./[d],_=i(o,d,""[e],(function(e,t,i,n,r){return t.exec===c?f&&!r?{done:!0,value:m.call(t,i,n)}:{done:!0,value:e.call(i,t,n)}:{done:!1}})),g=_[0],v=_[1];n(String.prototype,e,g),r(RegExp.prototype,d,2==t?function(e,t){return v.call(e,this,t)}:function(e){return v.call(e,this)})}}},function(e,t,i){e.exports=!i(34)&&!i(35)((function(){return 7!=Object.defineProperty(i(130)("div"),"a",{get:function(){return 7}}).a}))},function(e,t,i){var n=i(26),r=i(163),a=i(33).f,o=i(72).f,s=i(134),c=i(111),l=n.RegExp,u=l,h=l.prototype,d=/a/g,f=/a/g,p=new l(d)!==d;if(i(34)&&(!p||i(35)((function(){return f[i(24)("match")]=!1,l(d)!=d||l(f)==f||"/a/i"!=l(d,"i")})))){l=function(e,t){var i=this instanceof l,n=s(e),a=void 0===t;return!i&&n&&e.constructor===l&&a?e:r(p?new u(n&&!a?e.source:e,t):u((n=e instanceof l)?e.source:e,n&&a?c.call(e):t),i?this:h,l)};for(var m=function(e){e in l||a(l,e,{configurable:!0,get:function(){return u[e]},set:function(t){u[e]=t}})},_=o(u),g=0;_.length>g;)m(_[g++]);h.constructor=l,l.prototype=h,i(45)(n,"RegExp",l)}i(114)("RegExp")},function(e,t,i){var n=i(31),r=i(164).set;e.exports=function(e,t,i){var a,o=t.constructor;return o!==i&&"function"==typeof o&&(a=o.prototype)!==i.prototype&&n(a)&&r&&r(e,a),e}},function(e,t,i){var n=i(31),r=i(32),a=function(e,t){if(r(e),!n(t)&&null!==t)throw TypeError(t+": can't set as prototype!")};e.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(e,t,n){try{(n=i(53)(Function.call,i(71).f(Object.prototype,"__proto__").set,2))(e,[]),t=!(e instanceof Array)}catch(e){t=!0}return function(e,i){return a(e,i),t?e.__proto__=i:n(e,i),e}}({},!1):void 0),check:a}},function(e,t,i){var n=i(70);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==n(e)?e.split(""):Object(e)}},function(e,t,i){var n=i(49),r=i(57),a=i(112)(!1),o=i(132)("IE_PROTO");e.exports=function(e,t){var i,s=r(e),c=0,l=[];for(i in s)i!=o&&n(s,i)&&l.push(i);for(;t.length>c;)n(s,i=t[c++])&&(~a(l,i)||l.push(i));return l}},function(e,t,i){var n=i(26),r=i(62),a=i(63),o=i(168),s=i(33).f;e.exports=function(e){var t=r.Symbol||(r.Symbol=a?{}:n.Symbol||{});"_"==e.charAt(0)||e in t||s(t,e,{value:o.f(e)})}},function(e,t,i){t.f=i(24)},function(e,t,i){var n=i(33),r=i(32),a=i(93);e.exports=i(34)?Object.defineProperties:function(e,t){r(e);for(var i,o=a(t),s=o.length,c=0;s>c;)n.f(e,i=o[c++],t[i]);return e}},function(e,t,i){"use strict";var n=i(33),r=i(65);e.exports=function(e,t,i){t in e?n.f(e,t,r(0,i)):e[t]=i}},function(e,t,i){var n=i(26).document;e.exports=n&&n.documentElement},function(e,t,i){var n=i(16),r=i(62),a=i(35);e.exports=function(e,t){var i=(r.Object||{})[e]||Object[e],o={};o[e]=t(i),n(n.S+n.F*a((function(){i(1)})),"Object",o)}},function(e,t){e.exports=function(e,t){return{value:t,done:!!e}}},function(e,t,i){var n=i(32);e.exports=function(e,t,i,r){try{return r?t(n(i)[0],i[1]):t(i)}catch(t){var a=e.return;throw void 0!==a&&n(a.call(e)),t}}},function(e,t,i){var n,r,a,o=i(53),s=i(176),c=i(171),l=i(130),u=i(26),h=u.process,d=u.setImmediate,f=u.clearImmediate,p=u.MessageChannel,m=u.Dispatch,_=0,g={},v=function(){var e=+this;if(g.hasOwnProperty(e)){var t=g[e];delete g[e],t()}},b=function(e){v.call(e.data)};d&&f||(d=function(e){for(var t=[],i=1;arguments.length>i;)t.push(arguments[i++]);return g[++_]=function(){s("function"==typeof e?e:Function(e),t)},n(_),_},f=function(e){delete g[e]},"process"==i(70)(h)?n=function(e){h.nextTick(o(v,e,1))}:m&&m.now?n=function(e){m.now(o(v,e,1))}:p?(a=(r=new p).port2,r.port1.onmessage=b,n=o(a.postMessage,a,1)):u.addEventListener&&"function"==typeof postMessage&&!u.importScripts?(n=function(e){u.postMessage(e+"","*")},u.addEventListener("message",b,!1)):n="onreadystatechange"in l("script")?function(e){c.appendChild(l("script")).onreadystatechange=function(){c.removeChild(this),v.call(e)}}:function(e){setTimeout(o(v,e,1),0)}),e.exports={set:d,clear:f}},function(e,t){e.exports=function(e,t,i){var n=void 0===i;switch(t.length){case 0:return n?e():e.call(i);case 1:return n?e(t[0]):e.call(i,t[0]);case 2:return n?e(t[0],t[1]):e.call(i,t[0],t[1]);case 3:return n?e(t[0],t[1],t[2]):e.call(i,t[0],t[1],t[2]);case 4:return n?e(t[0],t[1],t[2],t[3]):e.call(i,t[0],t[1],t[2],t[3])}return e.apply(i,t)}},function(e,t,i){"use strict";var n=i(92);function r(e){var t,i;this.promise=new e((function(e,n){if(void 0!==t||void 0!==i)throw TypeError("Bad Promise constructor");t=e,i=n})),this.resolve=n(t),this.reject=n(i)}e.exports.f=function(e){return new r(e)}},function(e,t,i){var n,r,a={},o=(n=function(){return window&&document&&document.all&&!window.atob},function(){return void 0===r&&(r=n.apply(this,arguments)),r}),s=function(e){return document.querySelector(e)},c=function(e){var t={};return function(e){if("function"==typeof e)return e();if(void 0===t[e]){var i=s.call(this,e);if(window.HTMLIFrameElement&&i instanceof window.HTMLIFrameElement)try{i=i.contentDocument.head}catch(e){i=null}t[e]=i}return t[e]}}(),l=null,u=0,h=[],d=i(281);function f(e,t){for(var i=0;i<e.length;i++){var n=e[i],r=a[n.id];if(r){r.refs++;for(var o=0;o<r.parts.length;o++)r.parts[o](n.parts[o]);for(;o<n.parts.length;o++)r.parts.push(b(n.parts[o],t))}else{var s=[];for(o=0;o<n.parts.length;o++)s.push(b(n.parts[o],t));a[n.id]={id:n.id,refs:1,parts:s}}}}function p(e,t){for(var i=[],n={},r=0;r<e.length;r++){var a=e[r],o=t.base?a[0]+t.base:a[0],s={css:a[1],media:a[2],sourceMap:a[3]};n[o]?n[o].parts.push(s):i.push(n[o]={id:o,parts:[s]})}return i}function m(e,t){var i=c(e.insertInto);if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var n=h[h.length-1];if("top"===e.insertAt)n?n.nextSibling?i.insertBefore(t,n.nextSibling):i.appendChild(t):i.insertBefore(t,i.firstChild),h.push(t);else if("bottom"===e.insertAt)i.appendChild(t);else{if("object"!=typeof e.insertAt||!e.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var r=c(e.insertInto+" "+e.insertAt.before);i.insertBefore(t,r)}}function _(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e);var t=h.indexOf(e);t>=0&&h.splice(t,1)}function g(e){var t=document.createElement("style");return void 0===e.attrs.type&&(e.attrs.type="text/css"),v(t,e.attrs),m(e,t),t}function v(e,t){Object.keys(t).forEach((function(i){e.setAttribute(i,t[i])}))}function b(e,t){var i,n,r,a;if(t.transform&&e.css){if(!(a=t.transform(e.css)))return function(){};e.css=a}if(t.singleton){var o=u++;i=l||(l=g(t)),n=O.bind(null,i,o,!1),r=O.bind(null,i,o,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(i=function(e){var t=document.createElement("link");return void 0===e.attrs.type&&(e.attrs.type="text/css"),e.attrs.rel="stylesheet",v(t,e.attrs),m(e,t),t}(t),n=E.bind(null,i,t),r=function(){_(i),i.href&&URL.revokeObjectURL(i.href)}):(i=g(t),n=x.bind(null,i),r=function(){_(i)});return n(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;n(e=t)}else r()}}e.exports=function(e,t){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(t=t||{}).attrs="object"==typeof t.attrs?t.attrs:{},t.singleton||"boolean"==typeof t.singleton||(t.singleton=o()),t.insertInto||(t.insertInto="head"),t.insertAt||(t.insertAt="bottom");var i=p(e,t);return f(i,t),function(e){for(var n=[],r=0;r<i.length;r++){var o=i[r];(s=a[o.id]).refs--,n.push(s)}e&&f(p(e,t),t);for(r=0;r<n.length;r++){var s;if(0===(s=n[r]).refs){for(var c=0;c<s.parts.length;c++)s.parts[c]();delete a[s.id]}}}};var y,w=(y=[],function(e,t){return y[e]=t,y.filter(Boolean).join("\n")});function O(e,t,i,n){var r=i?"":n.css;if(e.styleSheet)e.styleSheet.cssText=w(t,r);else{var a=document.createTextNode(r),o=e.childNodes;o[t]&&e.removeChild(o[t]),o.length?e.insertBefore(a,o[t]):e.appendChild(a)}}function x(e,t){var i=t.css,n=t.media;if(n&&e.setAttribute("media",n),e.styleSheet)e.styleSheet.cssText=i;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(i))}}function E(e,t,i){var n=i.css,r=i.sourceMap,a=void 0===t.convertToAbsoluteUrls&&r;(t.convertToAbsoluteUrls||a)&&(n=d(n)),r&&(n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+" */");var o=new Blob([n],{type:"text/css"}),s=e.href;e.href=URL.createObjectURL(o),s&&URL.revokeObjectURL(s)}},function(e,t,i){"use strict";var n=i(180),r=i(143);e.exports=i(181)("Map",(function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}}),{get:function(e){var t=n.getEntry(r(this,"Map"),e);return t&&t.v},set:function(e,t){return n.def(r(this,"Map"),0===e?0:e,t)}},n,!0)},function(e,t,i){"use strict";var n=i(33).f,r=i(94),a=i(102),o=i(53),s=i(101),c=i(140),l=i(139),u=i(173),h=i(114),d=i(34),f=i(117).fastKey,p=i(143),m=d?"_s":"size",_=function(e,t){var i,n=f(t);if("F"!==n)return e._i[n];for(i=e._f;i;i=i.n)if(i.k==t)return i};e.exports={getConstructor:function(e,t,i,l){var u=e((function(e,n){s(e,u,t,"_i"),e._t=t,e._i=r(null),e._f=void 0,e._l=void 0,e[m]=0,null!=n&&c(n,i,e[l],e)}));return a(u.prototype,{clear:function(){for(var e=p(this,t),i=e._i,n=e._f;n;n=n.n)n.r=!0,n.p&&(n.p=n.p.n=void 0),delete i[n.i];e._f=e._l=void 0,e[m]=0},delete:function(e){var i=p(this,t),n=_(i,e);if(n){var r=n.n,a=n.p;delete i._i[n.i],n.r=!0,a&&(a.n=r),r&&(r.p=a),i._f==n&&(i._f=r),i._l==n&&(i._l=a),i[m]--}return!!n},forEach:function(e){p(this,t);for(var i,n=o(e,arguments.length>1?arguments[1]:void 0,3);i=i?i.n:this._f;)for(n(i.v,i.k,this);i&&i.r;)i=i.p},has:function(e){return!!_(p(this,t),e)}}),d&&n(u.prototype,"size",{get:function(){return p(this,t)[m]}}),u},def:function(e,t,i){var n,r,a=_(e,t);return a?a.v=i:(e._l=a={i:r=f(t,!0),k:t,v:i,p:n=e._l,n:void 0,r:!1},e._f||(e._f=a),n&&(n.n=a),e[m]++,"F"!==r&&(e._i[r]=a)),e},getEntry:_,setStrong:function(e,t,i){l(e,t,(function(e,i){this._t=p(e,t),this._k=i,this._l=void 0}),(function(){for(var e=this._k,t=this._l;t&&t.r;)t=t.p;return this._t&&(this._l=t=t?t.n:this._t._f)?u(0,"keys"==e?t.k:"values"==e?t.v:[t.k,t.v]):(this._t=void 0,u(1))}),i?"entries":"values",!i,!0),h(t)}}},function(e,t,i){"use strict";var n=i(26),r=i(16),a=i(45),o=i(102),s=i(117),c=i(140),l=i(101),u=i(31),h=i(35),d=i(120),f=i(75),p=i(163);e.exports=function(e,t,i,m,_,g){var v=n[e],b=v,y=_?"set":"add",w=b&&b.prototype,O={},x=function(e){var t=w[e];a(w,e,"delete"==e?function(e){return!(g&&!u(e))&&t.call(this,0===e?0:e)}:"has"==e?function(e){return!(g&&!u(e))&&t.call(this,0===e?0:e)}:"get"==e?function(e){return g&&!u(e)?void 0:t.call(this,0===e?0:e)}:"add"==e?function(e){return t.call(this,0===e?0:e),this}:function(e,i){return t.call(this,0===e?0:e,i),this})};if("function"==typeof b&&(g||w.forEach&&!h((function(){(new b).entries().next()})))){var E=new b,T=E[y](g?{}:-0,1)!=E,C=h((function(){E.has(1)})),S=d((function(e){new b(e)})),A=!g&&h((function(){for(var e=new b,t=5;t--;)e[y](t,t);return!e.has(-0)}));S||((b=t((function(t,i){l(t,b,e);var n=p(new v,t,b);return null!=i&&c(i,_,n[y],n),n}))).prototype=w,w.constructor=b),(C||A)&&(x("delete"),x("has"),_&&x("get")),(A||T)&&x(y),g&&w.clear&&delete w.clear}else b=m.getConstructor(t,e,_,y),o(b.prototype,i),s.NEED=!0;return f(b,e),O[e]=b,r(r.G+r.W+r.F*(b!=v),O),g||m.setStrong(b,e,_),b}},function(e,t,i){"use strict";i(283)("trim",(function(e){return function(){return e(this,3)}}))},function(e,t,i){var n=i(16);n(n.S,"Date",{now:function(){return(new Date).getTime()}})},function(e,t,i){var n=i(134),r=i(69);e.exports=function(e,t,i){if(n(t))throw TypeError("String#"+i+" doesn't accept regex!");return String(r(e))}},function(e,t,i){var n=i(24)("match");e.exports=function(e){var t=/./;try{"/./"[e](t)}catch(i){try{return t[n]=!1,!"/./"[e](t)}catch(e){}}return!0}},function(e,t,i){"use strict";i.r(t),function(e,n,r){i(20),i(21),i(36),i(59),i(14),i(183),i(50),i(290),i(291),i(292),i(293),i(296),i(297),i(300),i(301),i(302),i(303),i(304),i(305),i(46),i(306),i(77),i(128),i(307),i(73),i(74),i(37);function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var o,s=void 0!==s?s:{},c={};for(o in s)s.hasOwnProperty(o)&&(c[o]=s[o]);s.arguments=[],s.thisProgram="./this.program",s.quit=function(e,t){throw t},s.preRun=[],s.postRun=[];var l=!1,u=!1,h=!1,d=!1;if(l="object"===("undefined"==typeof window?"undefined":a(window)),u="function"==typeof importScripts,h="object"===(void 0===e?"undefined":a(e))&&!l&&!u,d=!l&&!h&&!u,s.ENVIRONMENT)throw new Error("Module.ENVIRONMENT has been deprecated. To force the environment, use the ENVIRONMENT compile-time option (for example, -s ENVIRONMENT=web or -s ENVIRONMENT=node)");var f,p,m="";function _(e){return s.locateFile?s.locateFile(e,m):m+e}if(h)m=n+"/",s.read=function(e,t){var n;return f||(f=i(308)),p||(p=i(189)),e=p.normalize(e),n=f.readFileSync(e),t?n:n.toString()},s.readBinary=function(e){var t=s.read(e,!0);return t.buffer||(t=new Uint8Array(t)),C(t.buffer),t},e.argv.length>1&&(s.thisProgram=e.argv[1].replace(/\\/g,"/")),s.arguments=e.argv.slice(2),r.exports=s,e.on("uncaughtException",(function(e){if(!(e instanceof Dt))throw e})),e.on("unhandledRejection",Rt),s.quit=function(t){e.exit(t)},s.inspect=function(){return"[Emscripten Module object]"};else if(d)"undefined"!=typeof read&&(s.read=function(e){return read(e)}),s.readBinary=function(e){var t;return"function"==typeof readbuffer?new Uint8Array(readbuffer(e)):(C("object"===a(t=read(e,"binary"))),t)},"undefined"!=typeof scriptArgs?s.arguments=scriptArgs:void 0!==arguments&&(s.arguments=arguments),"function"==typeof quit&&(s.quit=function(e){quit(e)});else{if(!l&&!u)throw new Error("environment detection error");u?m=self.location.href:document.currentScript&&(m=document.currentScript.src),m=0!==m.indexOf("blob:")?m.substr(0,m.lastIndexOf("/")+1):"",s.read=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},u&&(s.readBinary=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),s.readAsync=function(e,t,i){var n=new XMLHttpRequest;n.open("GET",e,!0),n.responseType="arraybuffer",n.onload=function(){200==n.status||0==n.status&&n.response?t(n.response):i()},n.onerror=i,n.send(null)},s.setWindowTitle=function(e){document.title=e}}var g=s.print||("undefined"!=typeof console?console.log.bind(console):"undefined"!=typeof print?print:null),v=s.printErr||("undefined"!=typeof printErr?printErr:"undefined"!=typeof console&&console.warn.bind(console)||g);for(o in c)c.hasOwnProperty(o)&&(s[o]=c[o]);c=void 0,C(void 0===s.memoryInitializerPrefixURL,"Module.memoryInitializerPrefixURL option was removed, use Module.locateFile instead"),C(void 0===s.pthreadMainPrefixURL,"Module.pthreadMainPrefixURL option was removed, use Module.locateFile instead"),C(void 0===s.cdInitializerPrefixURL,"Module.cdInitializerPrefixURL option was removed, use Module.locateFile instead"),C(void 0===s.filePackagePrefixURL,"Module.filePackagePrefixURL option was removed, use Module.locateFile instead");function b(e){b.shown||(b.shown={}),b.shown[e]||(b.shown[e]=1,v(e))}It=Pt=At=function(){Rt("cannot use the stack before compiled code is ready to run, and has provided stack access")};var y={"f64-rem":function(e,t){return e%t},debugger:function(){}};new Array(0);var w=0,O=function(e){w=e},x=function(){return w};var E;"object"!==("undefined"==typeof WebAssembly?"undefined":a(WebAssembly))&&Rt("No WebAssembly support found. Build with -s WASM=0 to target JavaScript instead.");var T=!1;function C(e,t){e||Rt("Assertion failed: "+t)}function S(e){var t=s["_"+e];return C(t,"Cannot call unknown function "+e+", make sure it is exported"),t}function A(e,t,i,n,r){var a={string:function(e){var t=0;if(null!=e&&0!==e){var i=1+(e.length<<2);R(e,t=At(i),i)}return t},array:function(e){var t=At(e.length);return L(e,t),t}};var o=S(e),s=[],c=0;if(C("array"!==t,'Return type should not be "array".'),n)for(var l=0;l<n.length;l++){var u=a[i[l]];u?(0===c&&(c=It()),s[l]=u(n[l])):s[l]=n[l]}var h=o.apply(null,s);return h=function(e){return"string"===t?j(e):"boolean"===t?Boolean(e):e}(h),0!==c&&Pt(c),h}function P(e,t,i,n){return function(){return A(e,t,i,arguments)}}var I="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;function D(e,t,i){for(var n=t+i,r=t;e[r]&&!(r>=n);)++r;if(r-t>16&&e.subarray&&I)return I.decode(e.subarray(t,r));for(var a="";t<r;){var o=e[t++];if(128&o){var s=63&e[t++];if(192!=(224&o)){var c=63&e[t++];if(224==(240&o)?o=(15&o)<<12|s<<6|c:(240!=(248&o)&&b("Invalid UTF-8 leading byte 0x"+o.toString(16)+" encountered when deserializing a UTF-8 string on the asm.js/wasm heap to a JS string!"),o=(7&o)<<18|s<<12|c<<6|63&e[t++]),o<65536)a+=String.fromCharCode(o);else{var l=o-65536;a+=String.fromCharCode(55296|l>>10,56320|1023&l)}}else a+=String.fromCharCode((31&o)<<6|s)}else a+=String.fromCharCode(o)}return a}function j(e,t){return e?D(V,e,t):""}function M(e,t,i,n){if(!(n>0))return 0;for(var r=i,a=i+n-1,o=0;o<e.length;++o){var s=e.charCodeAt(o);if(s>=55296&&s<=57343)s=65536+((1023&s)<<10)|1023&e.charCodeAt(++o);if(s<=127){if(i>=a)break;t[i++]=s}else if(s<=2047){if(i+1>=a)break;t[i++]=192|s>>6,t[i++]=128|63&s}else if(s<=65535){if(i+2>=a)break;t[i++]=224|s>>12,t[i++]=128|s>>6&63,t[i++]=128|63&s}else{if(i+3>=a)break;s>=2097152&&b("Invalid Unicode code point 0x"+s.toString(16)+" encountered when serializing a JS string to an UTF-8 string on the asm.js/wasm heap! (Valid unicode code points should be in range 0-0x1FFFFF)."),t[i++]=240|s>>18,t[i++]=128|s>>12&63,t[i++]=128|s>>6&63,t[i++]=128|63&s}}return t[i]=0,i-r}function R(e,t,i){return C("number"==typeof i,"stringToUTF8(str, outPtr, maxBytesToWrite) is missing the third parameter that specifies the length of the output buffer!"),M(e,V,t,i)}"undefined"!=typeof TextDecoder&&new TextDecoder("utf-16le");function L(e,t){C(e.length>=0,"writeArrayToMemory array must have a length (should be an array or typed array)"),U.set(e,t)}function N(e){return b("warning: build with  -s DEMANGLE_SUPPORT=1  to link in libcxxabi demangling"),e}function F(e){return e.replace(/__Z[\w\d_]+/g,(function(e){var t=N(e);return e===t?e:t+" ["+e+"]"}))}function k(){var e=new Error;if(!e.stack){try{throw new Error(0)}catch(t){e=t}if(!e.stack)return"(no stack trace available)"}return e.stack.toString()}function B(){var e=k();return s.extraStackTrace&&(e+="\n"+s.extraStackTrace()),F(e)}var z,U,V,H,G,q,W=65536;function Y(e,t){return e%t>0&&(e+=t-e%t),e}function X(e){s.buffer=z=e}function Z(){s.HEAP8=U=new Int8Array(z),s.HEAP16=H=new Int16Array(z),s.HEAP32=G=new Int32Array(z),s.HEAPU8=V=new Uint8Array(z),s.HEAPU16=new Uint16Array(z),s.HEAPU32=q=new Uint32Array(z),s.HEAPF32=new Float32Array(z),s.HEAPF64=new Float64Array(z)}var Q=5888,K=5248768,J=5248768,$=5632;C(Q%16==0,"stack must start aligned"),C(J%16==0,"heap must start aligned");var ee=5242880;s.TOTAL_STACK&&C(ee===s.TOTAL_STACK,"the stack size can no longer be determined at runtime");var te=s.TOTAL_MEMORY||16777216;function ie(){C(0==(3&K)),q[(K>>2)-1]=34821223,q[(K>>2)-2]=2310721022}function ne(){if(34821223==q[(K>>2)-1]&&2310721022==q[(K>>2)-2]||Rt("Stack overflow! Stack cookie has been overwritten, expected hex dwords 0x89BACDFE and 0x02135467, but received 0x"+q[(K>>2)-2].toString(16)+" "+q[(K>>2)-1].toString(16)),1668509029!==G[0])throw"Runtime error: The application has corrupted its heap memory area (address zero)!"}function re(e){Rt("Stack overflow! Attempted to allocate "+e+" bytes on the stack, but stack has only "+(K-It()+e)+" bytes available!")}if(te<ee&&v("TOTAL_MEMORY should be larger than TOTAL_STACK, was "+te+"! (TOTAL_STACK="+ee+")"),C("undefined"!=typeof Int32Array&&"undefined"!=typeof Float64Array&&void 0!==Int32Array.prototype.subarray&&void 0!==Int32Array.prototype.set,"JS engine does not provide full typed array support"),s.buffer?C((z=s.buffer).byteLength===te,"provided buffer should be "+te+" bytes, but it is "+z.byteLength):("object"===("undefined"==typeof WebAssembly?"undefined":a(WebAssembly))&&"function"==typeof WebAssembly.Memory?(C(te%W==0),E=new WebAssembly.Memory({initial:te/W}),z=E.buffer):z=new ArrayBuffer(te),C(z.byteLength===te),s.buffer=z),Z(),G[$>>2]=J,G[0]=1668509029,H[1]=25459,115!==V[2]||99!==V[3])throw"Runtime error: expected the system to be little-endian!";function ae(e){for(;e.length>0;){var t=e.shift();if("function"!=typeof t){var i=t.func;"number"==typeof i?void 0===t.arg?s.dynCall_v(i):s.dynCall_vi(i,t.arg):i(void 0===t.arg?null:t.arg)}else t()}}var oe=[],se=[],ce=[],le=[],ue=!1,he=!1;function de(){if(s.preRun)for("function"==typeof s.preRun&&(s.preRun=[s.preRun]);s.preRun.length;)_e(s.preRun.shift());ae(oe)}function fe(){ne(),ue||(ue=!0,ae(se))}function pe(){ne(),ae(ce)}function me(){if(ne(),s.postRun)for("function"==typeof s.postRun&&(s.postRun=[s.postRun]);s.postRun.length;)ge(s.postRun.shift());ae(le)}function _e(e){oe.unshift(e)}function ge(e){le.unshift(e)}C(Math.imul,"This browser does not support Math.imul(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill"),C(Math.fround,"This browser does not support Math.fround(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill"),C(Math.clz32,"This browser does not support Math.clz32(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill"),C(Math.trunc,"This browser does not support Math.trunc(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill");Math.abs,Math.cos,Math.sin,Math.tan,Math.acos,Math.asin,Math.atan,Math.atan2,Math.exp,Math.log,Math.sqrt,Math.ceil,Math.floor,Math.pow,Math.imul,Math.fround,Math.round,Math.min,Math.max,Math.clz32,Math.trunc;var ve=0,be=null,ye=null,we={};function Oe(e){ve++,s.monitorRunDependencies&&s.monitorRunDependencies(ve),e?(C(!we[e]),we[e]=1,null===be&&"undefined"!=typeof setInterval&&(be=setInterval((function(){if(T)return clearInterval(be),void(be=null);var e=!1;for(var t in we)e||(e=!0,v("still waiting on run dependencies:")),v("dependency: "+t);e&&v("(end of list)")}),1e4))):v("warning: run dependency added without ID")}function xe(e){if(ve--,s.monitorRunDependencies&&s.monitorRunDependencies(ve),e?(C(we[e]),delete we[e]):v("warning: run dependency removed without ID"),0==ve&&(null!==be&&(clearInterval(be),be=null),ye)){var t=ye;ye=null,t()}}s.preloadedImages={},s.preloadedAudios={};var Ee={error:function(){Rt("Filesystem support (FS) was not included. The problem is that you are using files from JS, but files were not used from C/C++, so filesystem support was not auto-included. You can force-include filesystem support with  -s FORCE_FILESYSTEM=1")},init:function(){Ee.error()},createDataFile:function(){Ee.error()},createPreloadedFile:function(){Ee.error()},createLazyFile:function(){Ee.error()},open:function(){Ee.error()},mkdev:function(){Ee.error()},registerDevice:function(){Ee.error()},analyzePath:function(){Ee.error()},loadFilesFromDB:function(){Ee.error()},ErrnoError:function(){Ee.error()}};s.FS_createDataFile=Ee.createDataFile,s.FS_createPreloadedFile=Ee.createPreloadedFile;var Te,Ce="data:application/octet-stream;base64,";function Se(e){return String.prototype.startsWith?e.startsWith(Ce):0===e.indexOf(Ce)}try{Te=MOTOR_BASE_URL?"/"===MOTOR_BASE_URL[MOTOR_BASE_URL.length-1]?MOTOR_BASE_URL+"wasm/edge.wasm":MOTOR_BASE_URL+"/wasm/edge.wasm":"wasm/edge.wasm"}catch(v){Te="wasm/edge.wasm"}function Ae(){try{if(s.wasmBinary)return new Uint8Array(s.wasmBinary);if(s.readBinary)return s.readBinary(Te);throw"both async and sync fetching of the wasm failed"}catch(e){Rt(e)}}function Pe(){return s.wasmBinary||!l&&!u||"function"!=typeof fetch?new Promise((function(e,t){e(Ae())})):fetch(Te,{credentials:"same-origin"}).then((function(e){if(!e.ok)throw"failed to load wasm binary file at '"+Te+"'";return e.arrayBuffer()})).catch((function(){return Ae()}))}function Ie(e){var t={env:e,global:{NaN:NaN,Infinity:1/0},"global.Math":Math,asm2wasm:y};function i(e,t){var i=e.exports;s.asm=i,xe("wasm-instantiate")}if(Oe("wasm-instantiate"),s.instantiateWasm)try{return s.instantiateWasm(t,i)}catch(e){return v("Module.instantiateWasm callback failed with error: "+e),!1}var n=s;function r(e){C(s===n,"the Module object should not be replaced during async compilation - perhaps the order of HTML elements is wrong?"),n=null,i(e.instance)}function a(e){Pe().then((function(e){return WebAssembly.instantiate(e,t)})).then(e,(function(e){v("failed to asynchronously prepare wasm: "+e),Rt(e)}))}return s.wasmBinary||"function"!=typeof WebAssembly.instantiateStreaming||Se(Te)||"function"!=typeof fetch?a(r):WebAssembly.instantiateStreaming(fetch(Te,{credentials:"same-origin"}),t).then(r,(function(e){v("wasm streaming compile failed: "+e),v("falling back to ArrayBuffer instantiation"),a(r)})),{}}Se(Te)||(Te=_(Te)),s.asm=function(e,t,i){t.memory=E,t.table=new WebAssembly.Table({initial:192,maximum:192,element:"anyfunc"}),t.__memory_base=1024,t.__table_base=0;var n=Ie(t);return C(n,"binaryen setup failed (no wasm support?)"),n};var De=5872;function je(e){return St(e)}function Me(){return!!Me.uncaught_exception}function Re(e){try{return Ct(e)}catch(e){v("exception during cxa_free_exception: "+e)}}C(De%8==0);var Le={last:0,caught:[],infos:{},deAdjust:function(e){if(!e||Le.infos[e])return e;for(var t in Le.infos)for(var i=+t,n=Le.infos[i].adjusted,r=n.length,a=0;a<r;a++)if(n[a]===e)return i;return e},addRef:function(e){e&&Le.infos[e].refcount++},decRef:function(e){if(e){var t=Le.infos[e];C(t.refcount>0),t.refcount--,0!==t.refcount||t.rethrown||(t.destructor&&s.dynCall_vi(t.destructor,e),delete Le.infos[e],Re(e))}},clearRef:function(e){e&&(Le.infos[e].refcount=0)}};function Ne(e){var t=Le.infos[e];return t&&!t.caught&&(t.caught=!0,Me.uncaught_exception--),t&&(t.rethrown=!1),Le.caught.push(e),Le.addRef(Le.deAdjust(e)),e}function Fe(e){throw Le.last||(Le.last=e),e+" - Exception catching is disabled, this exception cannot be caught. Compile with -s DISABLE_EXCEPTION_CATCHING=0 or DISABLE_EXCEPTION_CATCHING=2 to catch."}function ke(){var e=Le.last;if(!e)return 0|(O(0),0);var t=Le.infos[e],i=t.type;if(!i)return 0|(O(0),e);var n=Array.prototype.slice.call(arguments);s.___cxa_is_pointer_type(i);ke.buffer||(ke.buffer=St(4)),G[ke.buffer>>2]=e,e=ke.buffer;for(var r=0;r<n.length;r++)if(n[r]&&s.___cxa_can_catch(n[r],i,e))return e=G[e>>2],t.adjusted.push(e),0|(O(n[r]),e);return e=G[e>>2],0|(O(i),e)}function Be(e,t,i){throw Le.infos[e]={ptr:e,adjusted:[e],type:t,destructor:i,refcount:0,caught:!1,rethrown:!1},Le.last=e,"uncaught_exception"in Me?Me.uncaught_exception++:Me.uncaught_exception=1,e+" - Exception catching is disabled, this exception cannot be caught. Compile with -s DISABLE_EXCEPTION_CATCHING=0 or DISABLE_EXCEPTION_CATCHING=2 to catch."}function ze(){}function Ue(){}var Ve={buffers:[null,[],[]],printChar:function(e,t){var i=Ve.buffers[e];C(i),0===t||10===t?((1===e?g:v)(D(i,0)),i.length=0):i.push(t)},varargs:0,get:function(e){return Ve.varargs+=4,G[Ve.varargs-4>>2]},getStr:function(){return j(Ve.get())},get64:function(){var e=Ve.get(),t=Ve.get();return C(e>=0?0===t:-1===t),e},getZero:function(){C(0===Ve.get())}};function He(e,t){Ve.varargs=t;try{var i=Ve.getStreamFromFD(),n=(Ve.get(),Ve.get()),r=Ve.get(),a=Ve.get(),o=n;return Ee.llseek(i,o,a),G[r>>2]=i.position,i.getdents&&0===o&&0===a&&(i.getdents=null),0}catch(e){return void 0!==Ee&&e instanceof Ee.ErrnoError||Rt(e),-e.errno}}function Ge(){var e=s._fflush;e&&e(0);var t=Ve.buffers;t[1].length&&Ve.printChar(1,10),t[2].length&&Ve.printChar(2,10)}function qe(e,t){Ve.varargs=t;try{for(var i=Ve.get(),n=Ve.get(),r=Ve.get(),a=0,o=0;o<r;o++){for(var s=G[n+8*o>>2],c=G[n+(8*o+4)>>2],l=0;l<c;l++)Ve.printChar(i,V[s+l]);a+=c}return a}catch(e){return void 0!==Ee&&e instanceof Ee.ErrnoError||Rt(e),-e.errno}}function We(e,t){Ve.varargs=t;try{return 0}catch(e){return void 0!==Ee&&e instanceof Ee.ErrnoError||Rt(e),-e.errno}}function Ye(e,t){Ve.varargs=t;try{var i=Ve.getStreamFromFD();return Ee.close(i),0}catch(e){return void 0!==Ee&&e instanceof Ee.ErrnoError||Rt(e),-e.errno}}function Xe(){}function Ze(){s.abort()}function Qe(){return te}function Ke(e){Rt("Cannot enlarge memory arrays to size "+e+" bytes (OOM). Either (1) compile with  -s TOTAL_MEMORY=X  with X higher than the current value "+te+", (2) compile with  -s ALLOW_MEMORY_GROWTH=1  which allows increasing the size at runtime, or (3) if you want malloc to return NULL (0) instead of this abort, compile with  -s ABORTING_MALLOC=0 ")}function Je(e){e=Y(e,65536);var t=s.buffer.byteLength;try{return-1!==E.grow((e-t)/65536)?s.buffer=E.buffer:null}catch(i){return console.error("emscripten_realloc_buffer: Attempted to grow from "+t+" bytes to "+e+" bytes, but got error: "+i),null}}function $e(e){var t=Qe();C(e>t);if(e>2147418112)return v("Cannot enlarge memory, asked to go up to "+e+" bytes, but the limit is 2147418112 bytes!"),!1;for(var i=Math.max(t,16777216);i<e;)i<=536870912?i=Y(2*i,65536):(i=Math.min(Y((3*i+2147483648)/4,65536),2147418112))===t&&b("Cannot ask for more memory since we reached the practical limit in browsers (which is just below 2GB), so the request would have failed. Requesting only "+te);Date.now();var n=Je(i);return n&&n.byteLength==i?(X(n),Z(),te=i,q[$>>2]=e,!0):(v("Failed to grow the heap from "+t+" bytes to "+i+" bytes, not enough memory!"),n&&v("Expected to get back a buffer of size "+i+" bytes, but instead got back a buffer of size "+n.byteLength),!1)}function et(e,t,i){V.set(V.subarray(t,t+i),e)}function tt(e){return s.___errno_location?G[s.___errno_location()>>2]=e:v("failed to set errno from JS"),e}function it(e){v("Invalid function pointer called with signature 'ii'. Perhaps this is an invalid value (e.g. caused by calling a virtual method on a NULL pointer)? Or calling a function with an incorrect type, which will fail? (it is worth building your source files with -Werror (warnings are errors), as warnings can indicate undefined behavior which can cause this)"),v("Build with ASSERTIONS=2 for more info."),Rt(e)}function nt(e){v("Invalid function pointer called with signature 'iiii'. Perhaps this is an invalid value (e.g. caused by calling a virtual method on a NULL pointer)? Or calling a function with an incorrect type, which will fail? (it is worth building your source files with -Werror (warnings are errors), as warnings can indicate undefined behavior which can cause this)"),v("Build with ASSERTIONS=2 for more info."),Rt(e)}function rt(e){v("Invalid function pointer called with signature 'v'. Perhaps this is an invalid value (e.g. caused by calling a virtual method on a NULL pointer)? Or calling a function with an incorrect type, which will fail? (it is worth building your source files with -Werror (warnings are errors), as warnings can indicate undefined behavior which can cause this)"),v("Build with ASSERTIONS=2 for more info."),Rt(e)}function at(e){v("Invalid function pointer called with signature 'vi'. Perhaps this is an invalid value (e.g. caused by calling a virtual method on a NULL pointer)? Or calling a function with an incorrect type, which will fail? (it is worth building your source files with -Werror (warnings are errors), as warnings can indicate undefined behavior which can cause this)"),v("Build with ASSERTIONS=2 for more info."),Rt(e)}function ot(e){v("Invalid function pointer called with signature 'viiii'. Perhaps this is an invalid value (e.g. caused by calling a virtual method on a NULL pointer)? Or calling a function with an incorrect type, which will fail? (it is worth building your source files with -Werror (warnings are errors), as warnings can indicate undefined behavior which can cause this)"),v("Build with ASSERTIONS=2 for more info."),Rt(e)}function st(e){v("Invalid function pointer called with signature 'viiiii'. Perhaps this is an invalid value (e.g. caused by calling a virtual method on a NULL pointer)? Or calling a function with an incorrect type, which will fail? (it is worth building your source files with -Werror (warnings are errors), as warnings can indicate undefined behavior which can cause this)"),v("Build with ASSERTIONS=2 for more info."),Rt(e)}function ct(e){v("Invalid function pointer called with signature 'viiiiii'. Perhaps this is an invalid value (e.g. caused by calling a virtual method on a NULL pointer)? Or calling a function with an incorrect type, which will fail? (it is worth building your source files with -Werror (warnings are errors), as warnings can indicate undefined behavior which can cause this)"),v("Build with ASSERTIONS=2 for more info."),Rt(e)}var lt={},ut={abort:Rt,setTempRet0:O,getTempRet0:x,abortStackOverflow:re,nullFunc_ii:it,nullFunc_iiii:nt,nullFunc_v:rt,nullFunc_vi:at,nullFunc_viiii:ot,nullFunc_viiiii:st,nullFunc_viiiiii:ct,__ZSt18uncaught_exceptionv:Me,___cxa_allocate_exception:je,___cxa_begin_catch:Ne,___cxa_find_matching_catch:ke,___cxa_free_exception:Re,___cxa_throw:Be,___gxx_personality_v0:ze,___lock:Ue,___resumeException:Fe,___setErrNo:tt,___syscall140:He,___syscall146:qe,___syscall54:We,___syscall6:Ye,___unlock:Xe,_abort:Ze,_emscripten_get_heap_size:Qe,_emscripten_memcpy_big:et,_emscripten_resize_heap:$e,abortOnCannotGrowMemory:Ke,emscripten_realloc_buffer:Je,flush_NO_FILESYSTEM:Ge,tempDoublePtr:De,DYNAMICTOP_PTR:$},ht=s.asm(lt,ut,z),dt=ht.___cxa_can_catch;ht.___cxa_can_catch=function(){return C(ue,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),C(!he,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),dt.apply(null,arguments)};var ft=ht.___cxa_is_pointer_type;ht.___cxa_is_pointer_type=function(){return C(ue,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),C(!he,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),ft.apply(null,arguments)};var pt=ht.___errno_location;ht.___errno_location=function(){return C(ue,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),C(!he,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),pt.apply(null,arguments)};var mt=ht._fflush;ht._fflush=function(){return C(ue,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),C(!he,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),mt.apply(null,arguments)};var _t=ht._free;ht._free=function(){return C(ue,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),C(!he,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),_t.apply(null,arguments)};var gt=ht._getSize;ht._getSize=function(){return C(ue,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),C(!he,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),gt.apply(null,arguments)};var vt=ht._malloc;ht._malloc=function(){return C(ue,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),C(!he,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),vt.apply(null,arguments)};var bt=ht._memmove;ht._memmove=function(){return C(ue,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),C(!he,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),bt.apply(null,arguments)};var yt=ht._refuse;ht._refuse=function(){return C(ue,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),C(!he,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),yt.apply(null,arguments)};var wt=ht._sbrk;ht._sbrk=function(){return C(ue,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),C(!he,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),wt.apply(null,arguments)};var Ot=ht.establishStackSpace;ht.establishStackSpace=function(){return C(ue,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),C(!he,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),Ot.apply(null,arguments)};var xt=ht.stackAlloc;ht.stackAlloc=function(){return C(ue,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),C(!he,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),xt.apply(null,arguments)};var Et=ht.stackRestore;ht.stackRestore=function(){return C(ue,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),C(!he,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),Et.apply(null,arguments)};var Tt=ht.stackSave;ht.stackSave=function(){return C(ue,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),C(!he,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),Tt.apply(null,arguments)},s.asm=ht;s.___cxa_can_catch=function(){return C(ue,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),C(!he,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),s.asm.___cxa_can_catch.apply(null,arguments)},s.___cxa_is_pointer_type=function(){return C(ue,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),C(!he,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),s.asm.___cxa_is_pointer_type.apply(null,arguments)},s.___errno_location=function(){return C(ue,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),C(!he,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),s.asm.___errno_location.apply(null,arguments)},s._emscripten_replace_memory=function(){return C(ue,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),C(!he,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),s.asm._emscripten_replace_memory.apply(null,arguments)},s._fflush=function(){return C(ue,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),C(!he,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),s.asm._fflush.apply(null,arguments)};var Ct=s._free=function(){return C(ue,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),C(!he,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),s.asm._free.apply(null,arguments)},St=(s._getSize=function(){return C(ue,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),C(!he,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),s.asm._getSize.apply(null,arguments)},s._malloc=function(){return C(ue,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),C(!he,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),s.asm._malloc.apply(null,arguments)}),At=(s._memcpy=function(){return C(ue,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),C(!he,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),s.asm._memcpy.apply(null,arguments)},s._memmove=function(){return C(ue,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),C(!he,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),s.asm._memmove.apply(null,arguments)},s._memset=function(){return C(ue,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),C(!he,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),s.asm._memset.apply(null,arguments)},s._refuse=function(){return C(ue,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),C(!he,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),s.asm._refuse.apply(null,arguments)},s._sbrk=function(){return C(ue,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),C(!he,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),s.asm._sbrk.apply(null,arguments)},s.establishStackSpace=function(){return C(ue,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),C(!he,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),s.asm.establishStackSpace.apply(null,arguments)},s.stackAlloc=function(){return C(ue,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),C(!he,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),s.asm.stackAlloc.apply(null,arguments)}),Pt=s.stackRestore=function(){return C(ue,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),C(!he,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),s.asm.stackRestore.apply(null,arguments)},It=s.stackSave=function(){return C(ue,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),C(!he,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),s.asm.stackSave.apply(null,arguments)};s.dynCall_ii=function(){return C(ue,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),C(!he,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),s.asm.dynCall_ii.apply(null,arguments)},s.dynCall_iiii=function(){return C(ue,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),C(!he,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),s.asm.dynCall_iiii.apply(null,arguments)},s.dynCall_v=function(){return C(ue,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),C(!he,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),s.asm.dynCall_v.apply(null,arguments)},s.dynCall_vi=function(){return C(ue,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),C(!he,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),s.asm.dynCall_vi.apply(null,arguments)},s.dynCall_viiii=function(){return C(ue,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),C(!he,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),s.asm.dynCall_viiii.apply(null,arguments)},s.dynCall_viiiii=function(){return C(ue,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),C(!he,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),s.asm.dynCall_viiiii.apply(null,arguments)},s.dynCall_viiiiii=function(){return C(ue,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),C(!he,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),s.asm.dynCall_viiiiii.apply(null,arguments)};function Dt(e){this.name="ExitStatus",this.message="Program terminated with exit("+e+")",this.status=e}s.asm=ht,s.intArrayFromString||(s.intArrayFromString=function(){Rt("'intArrayFromString' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),s.intArrayToString||(s.intArrayToString=function(){Rt("'intArrayToString' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),s.ccall=A,s.cwrap=P,s.setValue||(s.setValue=function(){Rt("'setValue' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),s.getValue||(s.getValue=function(){Rt("'getValue' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),s.allocate||(s.allocate=function(){Rt("'allocate' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),s.getMemory||(s.getMemory=function(){Rt("'getMemory' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}),s.AsciiToString||(s.AsciiToString=function(){Rt("'AsciiToString' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),s.stringToAscii||(s.stringToAscii=function(){Rt("'stringToAscii' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),s.UTF8ArrayToString||(s.UTF8ArrayToString=function(){Rt("'UTF8ArrayToString' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),s.UTF8ToString||(s.UTF8ToString=function(){Rt("'UTF8ToString' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),s.stringToUTF8Array||(s.stringToUTF8Array=function(){Rt("'stringToUTF8Array' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),s.stringToUTF8||(s.stringToUTF8=function(){Rt("'stringToUTF8' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),s.lengthBytesUTF8||(s.lengthBytesUTF8=function(){Rt("'lengthBytesUTF8' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),s.UTF16ToString||(s.UTF16ToString=function(){Rt("'UTF16ToString' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),s.stringToUTF16||(s.stringToUTF16=function(){Rt("'stringToUTF16' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),s.lengthBytesUTF16||(s.lengthBytesUTF16=function(){Rt("'lengthBytesUTF16' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),s.UTF32ToString||(s.UTF32ToString=function(){Rt("'UTF32ToString' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),s.stringToUTF32||(s.stringToUTF32=function(){Rt("'stringToUTF32' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),s.lengthBytesUTF32||(s.lengthBytesUTF32=function(){Rt("'lengthBytesUTF32' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),s.allocateUTF8||(s.allocateUTF8=function(){Rt("'allocateUTF8' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),s.stackTrace||(s.stackTrace=function(){Rt("'stackTrace' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),s.addOnPreRun||(s.addOnPreRun=function(){Rt("'addOnPreRun' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),s.addOnInit||(s.addOnInit=function(){Rt("'addOnInit' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),s.addOnPreMain||(s.addOnPreMain=function(){Rt("'addOnPreMain' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),s.addOnExit||(s.addOnExit=function(){Rt("'addOnExit' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),s.addOnPostRun||(s.addOnPostRun=function(){Rt("'addOnPostRun' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),s.writeStringToMemory||(s.writeStringToMemory=function(){Rt("'writeStringToMemory' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),s.writeArrayToMemory||(s.writeArrayToMemory=function(){Rt("'writeArrayToMemory' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),s.writeAsciiToMemory||(s.writeAsciiToMemory=function(){Rt("'writeAsciiToMemory' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),s.addRunDependency||(s.addRunDependency=function(){Rt("'addRunDependency' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}),s.removeRunDependency||(s.removeRunDependency=function(){Rt("'removeRunDependency' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}),s.ENV||(s.ENV=function(){Rt("'ENV' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),s.FS||(s.FS=function(){Rt("'FS' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),s.FS_createFolder||(s.FS_createFolder=function(){Rt("'FS_createFolder' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}),s.FS_createPath||(s.FS_createPath=function(){Rt("'FS_createPath' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}),s.FS_createDataFile||(s.FS_createDataFile=function(){Rt("'FS_createDataFile' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}),s.FS_createPreloadedFile||(s.FS_createPreloadedFile=function(){Rt("'FS_createPreloadedFile' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}),s.FS_createLazyFile||(s.FS_createLazyFile=function(){Rt("'FS_createLazyFile' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}),s.FS_createLink||(s.FS_createLink=function(){Rt("'FS_createLink' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}),s.FS_createDevice||(s.FS_createDevice=function(){Rt("'FS_createDevice' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}),s.FS_unlink||(s.FS_unlink=function(){Rt("'FS_unlink' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}),s.GL||(s.GL=function(){Rt("'GL' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),s.dynamicAlloc||(s.dynamicAlloc=function(){Rt("'dynamicAlloc' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),s.warnOnce||(s.warnOnce=function(){Rt("'warnOnce' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),s.loadDynamicLibrary||(s.loadDynamicLibrary=function(){Rt("'loadDynamicLibrary' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),s.loadWebAssemblyModule||(s.loadWebAssemblyModule=function(){Rt("'loadWebAssemblyModule' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),s.getLEB||(s.getLEB=function(){Rt("'getLEB' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),s.getFunctionTables||(s.getFunctionTables=function(){Rt("'getFunctionTables' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),s.alignFunctionTables||(s.alignFunctionTables=function(){Rt("'alignFunctionTables' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),s.registerFunctions||(s.registerFunctions=function(){Rt("'registerFunctions' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),s.addFunction||(s.addFunction=function(){Rt("'addFunction' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),s.removeFunction||(s.removeFunction=function(){Rt("'removeFunction' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),s.getFuncWrapper||(s.getFuncWrapper=function(){Rt("'getFuncWrapper' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),s.prettyPrint||(s.prettyPrint=function(){Rt("'prettyPrint' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),s.makeBigInt||(s.makeBigInt=function(){Rt("'makeBigInt' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),s.dynCall||(s.dynCall=function(){Rt("'dynCall' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),s.getCompilerSetting||(s.getCompilerSetting=function(){Rt("'getCompilerSetting' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),s.stackSave||(s.stackSave=function(){Rt("'stackSave' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),s.stackRestore||(s.stackRestore=function(){Rt("'stackRestore' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),s.stackAlloc||(s.stackAlloc=function(){Rt("'stackAlloc' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),s.establishStackSpace||(s.establishStackSpace=function(){Rt("'establishStackSpace' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),s.print||(s.print=function(){Rt("'print' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),s.printErr||(s.printErr=function(){Rt("'printErr' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),s.getTempRet0||(s.getTempRet0=function(){Rt("'getTempRet0' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),s.setTempRet0||(s.setTempRet0=function(){Rt("'setTempRet0' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),s.Pointer_stringify||(s.Pointer_stringify=function(){Rt("'Pointer_stringify' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),s.ALLOC_NORMAL||Object.defineProperty(s,"ALLOC_NORMAL",{get:function(){Rt("'ALLOC_NORMAL' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}}),s.ALLOC_STACK||Object.defineProperty(s,"ALLOC_STACK",{get:function(){Rt("'ALLOC_STACK' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}}),s.ALLOC_DYNAMIC||Object.defineProperty(s,"ALLOC_DYNAMIC",{get:function(){Rt("'ALLOC_DYNAMIC' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}}),s.ALLOC_NONE||Object.defineProperty(s,"ALLOC_NONE",{get:function(){Rt("'ALLOC_NONE' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}}),Dt.prototype=new Error,Dt.prototype.constructor=Dt;function jt(e){function t(){s.calledRun||(s.calledRun=!0,T||(fe(),pe(),s.onRuntimeInitialized&&s.onRuntimeInitialized(),C(!s._main,'compiled without a main, but one is present. if you added it from JS, use Module["onRuntimeInitialized"]'),me()))}e=e||s.arguments,ve>0||(ie(),de(),ve>0||s.calledRun||(s.setStatus?(s.setStatus("Running..."),setTimeout((function(){setTimeout((function(){s.setStatus("")}),1),t()}),1)):t(),ne()))}ye=function e(){s.calledRun||jt(),s.calledRun||(ye=e)},s.run=jt;var Mt=[];function Rt(e){s.onAbort&&s.onAbort(e),void 0!==e?(g(e),v(e),e=JSON.stringify(e)):e="",T=!0,1;var t="abort("+e+") at "+B();throw Mt&&Mt.forEach((function(i){t=i(t,e)})),t}if(s.abort=Rt,s.preInit)for("function"==typeof s.preInit&&(s.preInit=[s.preInit]);s.preInit.length>0;)s.preInit.pop()();s.noExitRuntime=!0,jt(),t.default=s}.call(this,i(23),"/",i(289)(e))},function(e,t,i){for(var n,r=i(26),a=i(44),o=i(64),s=o("typed_array"),c=o("view"),l=!(!r.ArrayBuffer||!r.DataView),u=l,h=0,d="Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array".split(",");h<9;)(n=r[d[h++]])?(a(n.prototype,s,!0),a(n.prototype,c,!0)):u=!1;e.exports={ABV:l,CONSTR:u,TYPED:s,VIEW:c}},function(e,t,i){var n=i(56),r=i(42);e.exports=function(e){if(void 0===e)return 0;var t=n(e),i=r(t);if(t!==i)throw RangeError("Wrong length!");return i}},function(e,t,i){(function(e){function i(e,t){for(var i=0,n=e.length-1;n>=0;n--){var r=e[n];"."===r?e.splice(n,1):".."===r?(e.splice(n,1),i++):i&&(e.splice(n,1),i--)}if(t)for(;i--;i)e.unshift("..");return e}function n(e,t){if(e.filter)return e.filter(t);for(var i=[],n=0;n<e.length;n++)t(e[n],n,e)&&i.push(e[n]);return i}t.resolve=function(){for(var t="",r=!1,a=arguments.length-1;a>=-1&&!r;a--){var o=a>=0?arguments[a]:e.cwd();if("string"!=typeof o)throw new TypeError("Arguments to path.resolve must be strings");o&&(t=o+"/"+t,r="/"===o.charAt(0))}return(r?"/":"")+(t=i(n(t.split("/"),(function(e){return!!e})),!r).join("/"))||"."},t.normalize=function(e){var a=t.isAbsolute(e),o="/"===r(e,-1);return(e=i(n(e.split("/"),(function(e){return!!e})),!a).join("/"))||a||(e="."),e&&o&&(e+="/"),(a?"/":"")+e},t.isAbsolute=function(e){return"/"===e.charAt(0)},t.join=function(){var e=Array.prototype.slice.call(arguments,0);return t.normalize(n(e,(function(e,t){if("string"!=typeof e)throw new TypeError("Arguments to path.join must be strings");return e})).join("/"))},t.relative=function(e,i){function n(e){for(var t=0;t<e.length&&""===e[t];t++);for(var i=e.length-1;i>=0&&""===e[i];i--);return t>i?[]:e.slice(t,i-t+1)}e=t.resolve(e).substr(1),i=t.resolve(i).substr(1);for(var r=n(e.split("/")),a=n(i.split("/")),o=Math.min(r.length,a.length),s=o,c=0;c<o;c++)if(r[c]!==a[c]){s=c;break}var l=[];for(c=s;c<r.length;c++)l.push("..");return(l=l.concat(a.slice(s))).join("/")},t.sep="/",t.delimiter=":",t.dirname=function(e){if("string"!=typeof e&&(e+=""),0===e.length)return".";for(var t=e.charCodeAt(0),i=47===t,n=-1,r=!0,a=e.length-1;a>=1;--a)if(47===(t=e.charCodeAt(a))){if(!r){n=a;break}}else r=!1;return-1===n?i?"/":".":i&&1===n?"/":e.slice(0,n)},t.basename=function(e,t){var i=function(e){"string"!=typeof e&&(e+="");var t,i=0,n=-1,r=!0;for(t=e.length-1;t>=0;--t)if(47===e.charCodeAt(t)){if(!r){i=t+1;break}}else-1===n&&(r=!1,n=t+1);return-1===n?"":e.slice(i,n)}(e);return t&&i.substr(-1*t.length)===t&&(i=i.substr(0,i.length-t.length)),i},t.extname=function(e){"string"!=typeof e&&(e+="");for(var t=-1,i=0,n=-1,r=!0,a=0,o=e.length-1;o>=0;--o){var s=e.charCodeAt(o);if(47!==s)-1===n&&(r=!1,n=o+1),46===s?-1===t?t=o:1!==a&&(a=1):-1!==t&&(a=-1);else if(!r){i=o+1;break}}return-1===t||-1===n||0===a||1===a&&t===n-1&&t===i+1?"":e.slice(t,n)};var r="b"==="ab".substr(-1)?function(e,t,i){return e.substr(t,i)}:function(e,t,i){return t<0&&(t=e.length+t),e.substr(t,i)}}).call(this,i(23))},function(e,t,i){"use strict";var n=i(319);function r(){this.argTypes=[],this.shimArgs=[],this.arrayArgs=[],this.arrayBlockIndices=[],this.scalarArgs=[],this.offsetArgs=[],this.offsetArgIndex=[],this.indexArgs=[],this.shapeArgs=[],this.funcName="",this.pre=null,this.body=null,this.post=null,this.debug=!1}e.exports=function(e){var t=new r;t.pre=e.pre,t.body=e.body,t.post=e.post;var i=e.args.slice(0);t.argTypes=i;for(var a=0;a<i.length;++a){var o=i[a];if("array"===o||"object"==typeof o&&o.blockIndices){if(t.argTypes[a]="array",t.arrayArgs.push(a),t.arrayBlockIndices.push(o.blockIndices?o.blockIndices:0),t.shimArgs.push("array"+a),a<t.pre.args.length&&t.pre.args[a].count>0)throw new Error("cwise: pre() block may not reference array args");if(a<t.post.args.length&&t.post.args[a].count>0)throw new Error("cwise: post() block may not reference array args")}else if("scalar"===o)t.scalarArgs.push(a),t.shimArgs.push("scalar"+a);else if("index"===o){if(t.indexArgs.push(a),a<t.pre.args.length&&t.pre.args[a].count>0)throw new Error("cwise: pre() block may not reference array index");if(a<t.body.args.length&&t.body.args[a].lvalue)throw new Error("cwise: body() block may not write to array index");if(a<t.post.args.length&&t.post.args[a].count>0)throw new Error("cwise: post() block may not reference array index")}else if("shape"===o){if(t.shapeArgs.push(a),a<t.pre.args.length&&t.pre.args[a].lvalue)throw new Error("cwise: pre() block may not write to array shape");if(a<t.body.args.length&&t.body.args[a].lvalue)throw new Error("cwise: body() block may not write to array shape");if(a<t.post.args.length&&t.post.args[a].lvalue)throw new Error("cwise: post() block may not write to array shape")}else{if("object"!=typeof o||!o.offset)throw new Error("cwise: Unknown argument type "+i[a]);t.argTypes[a]="offset",t.offsetArgs.push({array:o.array,offset:o.offset}),t.offsetArgIndex.push(a)}}if(t.arrayArgs.length<=0)throw new Error("cwise: No array arguments specified");if(t.pre.args.length>i.length)throw new Error("cwise: Too many arguments in pre() block");if(t.body.args.length>i.length)throw new Error("cwise: Too many arguments in body() block");if(t.post.args.length>i.length)throw new Error("cwise: Too many arguments in post() block");return t.debug=!!e.printCode||!!e.debug,t.funcName=e.funcName||"cwise",t.blockSize=e.blockSize||64,n(t)}},function(e,t,i){(function(t){var n=i(41);function r(e,i,r){e=e||function(e){this.queue(e)},i=i||function(){this.queue(null)};var a=!1,o=!1,s=[],c=!1,l=new n;function u(){for(;s.length&&!l.paused;){var e=s.shift();if(null===e)return l.emit("end");l.emit("data",e)}}function h(){l.writable=!1,i.call(l),!l.readable&&l.autoDestroy&&l.destroy()}return l.readable=l.writable=!0,l.paused=!1,l.autoDestroy=!(r&&!1===r.autoDestroy),l.write=function(t){return e.call(this,t),!l.paused},l.queue=l.push=function(e){return c?l:(null===e&&(c=!0),s.push(e),u(),l)},l.on("end",(function(){l.readable=!1,!l.writable&&l.autoDestroy&&t.nextTick((function(){l.destroy()}))})),l.end=function(e){if(!a)return a=!0,arguments.length&&l.write(e),h(),l},l.destroy=function(){if(!o)return o=!0,a=!0,s.length=0,l.writable=l.readable=!1,l.emit("close"),l},l.pause=function(){if(!l.paused)return l.paused=!0,l},l.resume=function(){return l.paused&&(l.paused=!1,l.emit("resume")),u(),l.paused||l.emit("drain"),l},l}e.exports=r,r.through=r}).call(this,i(23))},function(e,t,i){(function(t){e.exports=u;var n=i(193),r=i(15).Buffer;u.ReadableState=l;var a=i(67).EventEmitter;a.listenerCount||(a.listenerCount=function(e,t){return e.listeners(t).length});var o,s=i(41),c=i(38);function l(e,t){var n=(e=e||{}).highWaterMark;this.highWaterMark=n||0===n?n:16384,this.highWaterMark=~~this.highWaterMark,this.buffer=[],this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=!1,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.calledRead=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.objectMode=!!e.objectMode,this.defaultEncoding=e.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(o||(o=i(68).StringDecoder),this.decoder=new o(e.encoding),this.encoding=e.encoding)}function u(e){if(!(this instanceof u))return new u(e);this._readableState=new l(e,this),this.readable=!0,s.call(this)}function h(e,i,n,a,o){var s=function(e,t){var i=null;r.isBuffer(t)||"string"==typeof t||null==t||e.objectMode||(i=new TypeError("Invalid non-string/buffer chunk"));return i}(i,n);if(s)e.emit("error",s);else if(null==n)i.reading=!1,i.ended||function(e,t){if(t.decoder&&!t.ended){var i=t.decoder.end();i&&i.length&&(t.buffer.push(i),t.length+=t.objectMode?1:i.length)}t.ended=!0,t.length>0?p(e):y(e)}(e,i);else if(i.objectMode||n&&n.length>0)if(i.ended&&!o){var c=new Error("stream.push() after EOF");e.emit("error",c)}else if(i.endEmitted&&o){c=new Error("stream.unshift() after end event");e.emit("error",c)}else!i.decoder||o||a||(n=i.decoder.write(n)),i.length+=i.objectMode?1:n.length,o?i.buffer.unshift(n):(i.reading=!1,i.buffer.push(n)),i.needReadable&&p(e),function(e,i){i.readingMore||(i.readingMore=!0,t.nextTick((function(){!function(e,t){var i=t.length;for(;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(e.read(0),i!==t.length);)i=t.length;t.readingMore=!1}(e,i)})))}(e,i);else o||(i.reading=!1);return function(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}(i)}c.inherits=i(30),c.inherits(u,s),u.prototype.push=function(e,t){var i=this._readableState;return"string"!=typeof e||i.objectMode||(t=t||i.defaultEncoding)!==i.encoding&&(e=new r(e,t),t=""),h(this,i,e,t,!1)},u.prototype.unshift=function(e){return h(this,this._readableState,e,"",!0)},u.prototype.setEncoding=function(e){o||(o=i(68).StringDecoder),this._readableState.decoder=new o(e),this._readableState.encoding=e};var d=8388608;function f(e,t){return 0===t.length&&t.ended?0:t.objectMode?0===e?0:1:null===e||isNaN(e)?t.flowing&&t.buffer.length?t.buffer[0].length:t.length:e<=0?0:(e>t.highWaterMark&&(t.highWaterMark=function(e){if(e>=d)e=d;else{e--;for(var t=1;t<32;t<<=1)e|=e>>t;e++}return e}(e)),e>t.length?t.ended?t.length:(t.needReadable=!0,0):e)}function p(e){var i=e._readableState;i.needReadable=!1,i.emittedReadable||(i.emittedReadable=!0,i.sync?t.nextTick((function(){m(e)})):m(e))}function m(e){e.emit("readable")}function _(e){var t,i=e._readableState;function n(e,n,r){!1===e.write(t)&&i.awaitDrain++}for(i.awaitDrain=0;i.pipesCount&&null!==(t=e.read());)if(1===i.pipesCount?n(i.pipes):w(i.pipes,n),e.emit("data",t),i.awaitDrain>0)return;if(0===i.pipesCount)return i.flowing=!1,void(a.listenerCount(e,"data")>0&&v(e));i.ranOut=!0}function g(){this._readableState.ranOut&&(this._readableState.ranOut=!1,_(this))}function v(e,i){if(e._readableState.flowing)throw new Error("Cannot switch to old mode now.");var n=i||!1,r=!1;e.readable=!0,e.pipe=s.prototype.pipe,e.on=e.addListener=s.prototype.on,e.on("readable",(function(){var t;for(r=!0;!n&&null!==(t=e.read());)e.emit("data",t);null===t&&(r=!1,e._readableState.needReadable=!0)})),e.pause=function(){n=!0,this.emit("pause")},e.resume=function(){n=!1,r?t.nextTick((function(){e.emit("readable")})):this.read(0),this.emit("resume")},e.emit("readable")}function b(e,t){var i,n=t.buffer,a=t.length,o=!!t.decoder,s=!!t.objectMode;if(0===n.length)return null;if(0===a)i=null;else if(s)i=n.shift();else if(!e||e>=a)i=o?n.join(""):r.concat(n,a),n.length=0;else{if(e<n[0].length)i=(h=n[0]).slice(0,e),n[0]=h.slice(e);else if(e===n[0].length)i=n.shift();else{i=o?"":new r(e);for(var c=0,l=0,u=n.length;l<u&&c<e;l++){var h=n[0],d=Math.min(e-c,h.length);o?i+=h.slice(0,d):h.copy(i,c,0,d),d<h.length?n[0]=h.slice(d):n.shift(),c+=d}}}return i}function y(e){var i=e._readableState;if(i.length>0)throw new Error("endReadable called on non-empty stream");!i.endEmitted&&i.calledRead&&(i.ended=!0,t.nextTick((function(){i.endEmitted||0!==i.length||(i.endEmitted=!0,e.readable=!1,e.emit("end"))})))}function w(e,t){for(var i=0,n=e.length;i<n;i++)t(e[i],i)}u.prototype.read=function(e){var t=this._readableState;t.calledRead=!0;var i,n=e;if(("number"!=typeof e||e>0)&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return p(this),null;if(0===(e=f(e,t))&&t.ended)return i=null,t.length>0&&t.decoder&&(i=b(e,t),t.length-=i.length),0===t.length&&y(this),i;var r=t.needReadable;return t.length-e<=t.highWaterMark&&(r=!0),(t.ended||t.reading)&&(r=!1),r&&(t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1),r&&!t.reading&&(e=f(n,t)),null===(i=e>0?b(e,t):null)&&(t.needReadable=!0,e=0),t.length-=e,0!==t.length||t.ended||(t.needReadable=!0),t.ended&&!t.endEmitted&&0===t.length&&y(this),i},u.prototype._read=function(e){this.emit("error",new Error("not implemented"))},u.prototype.pipe=function(e,i){var r=this,o=this._readableState;switch(o.pipesCount){case 0:o.pipes=e;break;case 1:o.pipes=[o.pipes,e];break;default:o.pipes.push(e)}o.pipesCount+=1;var s=(!i||!1!==i.end)&&e!==t.stdout&&e!==t.stderr?l:h;function c(e){e===r&&h()}function l(){e.end()}o.endEmitted?t.nextTick(s):r.once("end",s),e.on("unpipe",c);var u=function(e){return function(){var t=e._readableState;t.awaitDrain--,0===t.awaitDrain&&_(e)}}(r);function h(){e.removeListener("close",f),e.removeListener("finish",p),e.removeListener("drain",u),e.removeListener("error",d),e.removeListener("unpipe",c),r.removeListener("end",l),r.removeListener("end",h),e._writableState&&!e._writableState.needDrain||u()}function d(t){m(),e.removeListener("error",d),0===a.listenerCount(e,"error")&&e.emit("error",t)}function f(){e.removeListener("finish",p),m()}function p(){e.removeListener("close",f),m()}function m(){r.unpipe(e)}return e.on("drain",u),e._events&&e._events.error?n(e._events.error)?e._events.error.unshift(d):e._events.error=[d,e._events.error]:e.on("error",d),e.once("close",f),e.once("finish",p),e.emit("pipe",r),o.flowing||(this.on("readable",g),o.flowing=!0,t.nextTick((function(){_(r)}))),e},u.prototype.unpipe=function(e){var t=this._readableState;if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes?this:(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,this.removeListener("readable",g),t.flowing=!1,e&&e.emit("unpipe",this),this);if(!e){var i=t.pipes,n=t.pipesCount;t.pipes=null,t.pipesCount=0,this.removeListener("readable",g),t.flowing=!1;for(var r=0;r<n;r++)i[r].emit("unpipe",this);return this}return-1===(r=function(e,t){for(var i=0,n=e.length;i<n;i++)if(e[i]===t)return i;return-1}(t.pipes,e))?this:(t.pipes.splice(r,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this),this)},u.prototype.on=function(e,t){var i=s.prototype.on.call(this,e,t);if("data"!==e||this._readableState.flowing||v(this),"readable"===e&&this.readable){var n=this._readableState;n.readableListening||(n.readableListening=!0,n.emittedReadable=!1,n.needReadable=!0,n.reading?n.length&&p(this):this.read(0))}return i},u.prototype.addListener=u.prototype.on,u.prototype.resume=function(){v(this),this.read(0),this.emit("resume")},u.prototype.pause=function(){v(this,!0),this.emit("pause")},u.prototype.wrap=function(e){var t=this._readableState,i=!1,n=this;for(var r in e.on("end",(function(){if(t.decoder&&!t.ended){var e=t.decoder.end();e&&e.length&&n.push(e)}n.push(null)})),e.on("data",(function(r){(t.decoder&&(r=t.decoder.write(r)),t.objectMode&&null==r)||(t.objectMode||r&&r.length)&&(n.push(r)||(i=!0,e.pause()))})),e)"function"==typeof e[r]&&void 0===this[r]&&(this[r]=function(t){return function(){return e[t].apply(e,arguments)}}(r));return w(["error","close","destroy","pause","resume"],(function(t){e.on(t,n.emit.bind(n,t))})),n._read=function(t){i&&(i=!1,e.resume())},n},u._fromList=b}).call(this,i(23))},function(e,t){e.exports=Array.isArray||function(e){return"[object Array]"==Object.prototype.toString.call(e)}},function(e,t,i){(function(t){e.exports=c;var n=i(15).Buffer;c.WritableState=s;var r=i(38);r.inherits=i(30);var a=i(41);function o(e,t,i){this.chunk=e,this.encoding=t,this.callback=i}function s(e,i){var n=(e=e||{}).highWaterMark;this.highWaterMark=n||0===n?n:16384,this.objectMode=!!e.objectMode,this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var r=!1===e.decodeStrings;this.decodeStrings=!r,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,i){var n=e._writableState,r=n.sync,a=n.writecb;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(n),i)!function(e,i,n,r,a){n?t.nextTick((function(){a(r)})):a(r);e._writableState.errorEmitted=!0,e.emit("error",r)}(e,0,r,i,a);else{var o=h(e,n);o||n.bufferProcessing||!n.buffer.length||function(e,t){t.bufferProcessing=!0;for(var i=0;i<t.buffer.length;i++){var n=t.buffer[i],r=n.chunk,a=n.encoding,o=n.callback,s=t.objectMode?1:r.length;if(l(e,t,s,r,a,o),t.writing){i++;break}}t.bufferProcessing=!1,i<t.buffer.length?t.buffer=t.buffer.slice(i):t.buffer.length=0}(e,n),r?t.nextTick((function(){u(e,n,o,a)})):u(e,n,o,a)}}(i,e)},this.writecb=null,this.writelen=0,this.buffer=[],this.errorEmitted=!1}function c(e){var t=i(146);if(!(this instanceof c||this instanceof t))return new c(e);this._writableState=new s(e,this),this.writable=!0,a.call(this)}function l(e,t,i,n,r,a){t.writelen=i,t.writecb=a,t.writing=!0,t.sync=!0,e._write(n,r,t.onwrite),t.sync=!1}function u(e,t,i,n){i||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),n(),i&&d(e,t)}function h(e,t){return t.ending&&0===t.length&&!t.finished&&!t.writing}function d(e,t){var i=h(0,t);return i&&(t.finished=!0,e.emit("finish")),i}r.inherits(c,a),c.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe. Not readable."))},c.prototype.write=function(e,i,r){var a=this._writableState,s=!1;return"function"==typeof i&&(r=i,i=null),n.isBuffer(e)?i="buffer":i||(i=a.defaultEncoding),"function"!=typeof r&&(r=function(){}),a.ended?function(e,i,n){var r=new Error("write after end");e.emit("error",r),t.nextTick((function(){n(r)}))}(this,0,r):function(e,i,r,a){var o=!0;if(!n.isBuffer(r)&&"string"!=typeof r&&null!=r&&!i.objectMode){var s=new TypeError("Invalid non-string/buffer chunk");e.emit("error",s),t.nextTick((function(){a(s)})),o=!1}return o}(this,a,e,r)&&(s=function(e,t,i,r,a){i=function(e,t,i){e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=new n(t,i));return t}(t,i,r),n.isBuffer(i)&&(r="buffer");var s=t.objectMode?1:i.length;t.length+=s;var c=t.length<t.highWaterMark;c||(t.needDrain=!0);t.writing?t.buffer.push(new o(i,r,a)):l(e,t,s,i,r,a);return c}(this,a,e,i,r)),s},c.prototype._write=function(e,t,i){i(new Error("not implemented"))},c.prototype.end=function(e,i,n){var r=this._writableState;"function"==typeof e?(n=e,e=null,i=null):"function"==typeof i&&(n=i,i=null),null!=e&&this.write(e,i),r.ending||r.finished||function(e,i,n){i.ending=!0,d(e,i),n&&(i.finished?t.nextTick(n):e.once("finish",n));i.ended=!0}(this,r,n)}}).call(this,i(23))},function(e,t,i){e.exports=o;var n=i(146),r=i(38);function a(e,t){this.afterTransform=function(e,i){return function(e,t,i){var n=e._transformState;n.transforming=!1;var r=n.writecb;if(!r)return e.emit("error",new Error("no writecb in Transform class"));n.writechunk=null,n.writecb=null,null!=i&&e.push(i);r&&r(t);var a=e._readableState;a.reading=!1,(a.needReadable||a.length<a.highWaterMark)&&e._read(a.highWaterMark)}(t,e,i)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null}function o(e){if(!(this instanceof o))return new o(e);n.call(this,e);this._transformState=new a(e,this);var t=this;this._readableState.needReadable=!0,this._readableState.sync=!1,this.once("finish",(function(){"function"==typeof this._flush?this._flush((function(e){s(t,e)})):s(t)}))}function s(e,t){if(t)return e.emit("error",t);var i=e._writableState,n=(e._readableState,e._transformState);if(i.length)throw new Error("calling transform done when ws.length != 0");if(n.transforming)throw new Error("calling transform done when still transforming");return e.push(null)}r.inherits=i(30),r.inherits(o,n),o.prototype.push=function(e,t){return this._transformState.needTransform=!1,n.prototype.push.call(this,e,t)},o.prototype._transform=function(e,t,i){throw new Error("not implemented")},o.prototype._write=function(e,t,i){var n=this._transformState;if(n.writecb=i,n.writechunk=e,n.writeencoding=t,!n.transforming){var r=this._readableState;(n.needTransform||r.needReadable||r.length<r.highWaterMark)&&this._read(r.highWaterMark)}},o.prototype._read=function(e){var t=this._transformState;null!==t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0}},function(e,t,i){(function(t){e.exports=h;var n=i(193),r=i(15).Buffer;h.ReadableState=u;var a=i(67).EventEmitter;a.listenerCount||(a.listenerCount=function(e,t){return e.listeners(t).length});var o,s=i(41),c=i(38);c.inherits=i(30);var l=i(329);function u(e,t){var n=i(78),r=(e=e||{}).highWaterMark,a=e.objectMode?16:16384;this.highWaterMark=r||0===r?r:a,this.highWaterMark=~~this.highWaterMark,this.buffer=[],this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.objectMode=!!e.objectMode,t instanceof n&&(this.objectMode=this.objectMode||!!e.readableObjectMode),this.defaultEncoding=e.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(o||(o=i(68).StringDecoder),this.decoder=new o(e.encoding),this.encoding=e.encoding)}function h(e){i(78);if(!(this instanceof h))return new h(e);this._readableState=new u(e,this),this.readable=!0,s.call(this)}function d(e,i,n,r,a){var o=function(e,t){var i=null;c.isBuffer(t)||c.isString(t)||c.isNullOrUndefined(t)||e.objectMode||(i=new TypeError("Invalid non-string/buffer chunk"));return i}(i,n);if(o)e.emit("error",o);else if(c.isNullOrUndefined(n))i.reading=!1,i.ended||function(e,t){if(t.decoder&&!t.ended){var i=t.decoder.end();i&&i.length&&(t.buffer.push(i),t.length+=t.objectMode?1:i.length)}t.ended=!0,m(e)}(e,i);else if(i.objectMode||n&&n.length>0)if(i.ended&&!a){var s=new Error("stream.push() after EOF");e.emit("error",s)}else if(i.endEmitted&&a){s=new Error("stream.unshift() after end event");e.emit("error",s)}else!i.decoder||a||r||(n=i.decoder.write(n)),a||(i.reading=!1),i.flowing&&0===i.length&&!i.sync?(e.emit("data",n),e.read(0)):(i.length+=i.objectMode?1:n.length,a?i.buffer.unshift(n):i.buffer.push(n),i.needReadable&&m(e)),function(e,i){i.readingMore||(i.readingMore=!0,t.nextTick((function(){!function(e,t){var i=t.length;for(;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(l("maybeReadMore read 0"),e.read(0),i!==t.length);)i=t.length;t.readingMore=!1}(e,i)})))}(e,i);else a||(i.reading=!1);return function(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}(i)}l=l&&l.debuglog?l.debuglog("stream"):function(){},c.inherits(h,s),h.prototype.push=function(e,t){var i=this._readableState;return c.isString(e)&&!i.objectMode&&(t=t||i.defaultEncoding)!==i.encoding&&(e=new r(e,t),t=""),d(this,i,e,t,!1)},h.prototype.unshift=function(e){return d(this,this._readableState,e,"",!0)},h.prototype.setEncoding=function(e){return o||(o=i(68).StringDecoder),this._readableState.decoder=new o(e),this._readableState.encoding=e,this};var f=8388608;function p(e,t){return 0===t.length&&t.ended?0:t.objectMode?0===e?0:1:isNaN(e)||c.isNull(e)?t.flowing&&t.buffer.length?t.buffer[0].length:t.length:e<=0?0:(e>t.highWaterMark&&(t.highWaterMark=function(e){if(e>=f)e=f;else{e--;for(var t=1;t<32;t<<=1)e|=e>>t;e++}return e}(e)),e>t.length?t.ended?t.length:(t.needReadable=!0,0):e)}function m(e){var i=e._readableState;i.needReadable=!1,i.emittedReadable||(l("emitReadable",i.flowing),i.emittedReadable=!0,i.sync?t.nextTick((function(){_(e)})):_(e))}function _(e){l("emit readable"),e.emit("readable"),g(e)}function g(e){var t=e._readableState;if(l("flow",t.flowing),t.flowing)do{var i=e.read()}while(null!==i&&t.flowing)}function v(e,t){var i,n=t.buffer,a=t.length,o=!!t.decoder,s=!!t.objectMode;if(0===n.length)return null;if(0===a)i=null;else if(s)i=n.shift();else if(!e||e>=a)i=o?n.join(""):r.concat(n,a),n.length=0;else{if(e<n[0].length)i=(h=n[0]).slice(0,e),n[0]=h.slice(e);else if(e===n[0].length)i=n.shift();else{i=o?"":new r(e);for(var c=0,l=0,u=n.length;l<u&&c<e;l++){var h=n[0],d=Math.min(e-c,h.length);o?i+=h.slice(0,d):h.copy(i,c,0,d),d<h.length?n[0]=h.slice(d):n.shift(),c+=d}}}return i}function b(e){var i=e._readableState;if(i.length>0)throw new Error("endReadable called on non-empty stream");i.endEmitted||(i.ended=!0,t.nextTick((function(){i.endEmitted||0!==i.length||(i.endEmitted=!0,e.readable=!1,e.emit("end"))})))}h.prototype.read=function(e){l("read",e);var t=this._readableState,i=e;if((!c.isNumber(e)||e>0)&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return l("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?b(this):m(this),null;if(0===(e=p(e,t))&&t.ended)return 0===t.length&&b(this),null;var n,r=t.needReadable;return l("need readable",r),(0===t.length||t.length-e<t.highWaterMark)&&l("length less than watermark",r=!0),(t.ended||t.reading)&&l("reading or ended",r=!1),r&&(l("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1),r&&!t.reading&&(e=p(i,t)),n=e>0?v(e,t):null,c.isNull(n)&&(t.needReadable=!0,e=0),t.length-=e,0!==t.length||t.ended||(t.needReadable=!0),i!==e&&t.ended&&0===t.length&&b(this),c.isNull(n)||this.emit("data",n),n},h.prototype._read=function(e){this.emit("error",new Error("not implemented"))},h.prototype.pipe=function(e,i){var r=this,o=this._readableState;switch(o.pipesCount){case 0:o.pipes=e;break;case 1:o.pipes=[o.pipes,e];break;default:o.pipes.push(e)}o.pipesCount+=1,l("pipe count=%d opts=%j",o.pipesCount,i);var s=(!i||!1!==i.end)&&e!==t.stdout&&e!==t.stderr?u:d;function c(e){l("onunpipe"),e===r&&d()}function u(){l("onend"),e.end()}o.endEmitted?t.nextTick(s):r.once("end",s),e.on("unpipe",c);var h=function(e){return function(){var t=e._readableState;l("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&a.listenerCount(e,"data")&&(t.flowing=!0,g(e))}}(r);function d(){l("cleanup"),e.removeListener("close",m),e.removeListener("finish",_),e.removeListener("drain",h),e.removeListener("error",p),e.removeListener("unpipe",c),r.removeListener("end",u),r.removeListener("end",d),r.removeListener("data",f),!o.awaitDrain||e._writableState&&!e._writableState.needDrain||h()}function f(t){l("ondata"),!1===e.write(t)&&(l("false write response, pause",r._readableState.awaitDrain),r._readableState.awaitDrain++,r.pause())}function p(t){l("onerror",t),v(),e.removeListener("error",p),0===a.listenerCount(e,"error")&&e.emit("error",t)}function m(){e.removeListener("finish",_),v()}function _(){l("onfinish"),e.removeListener("close",m),v()}function v(){l("unpipe"),r.unpipe(e)}return e.on("drain",h),r.on("data",f),e._events&&e._events.error?n(e._events.error)?e._events.error.unshift(p):e._events.error=[p,e._events.error]:e.on("error",p),e.once("close",m),e.once("finish",_),e.emit("pipe",r),o.flowing||(l("pipe resume"),r.resume()),e},h.prototype.unpipe=function(e){var t=this._readableState;if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes?this:(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this),this);if(!e){var i=t.pipes,n=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var r=0;r<n;r++)i[r].emit("unpipe",this);return this}return-1===(r=function(e,t){for(var i=0,n=e.length;i<n;i++)if(e[i]===t)return i;return-1}(t.pipes,e))?this:(t.pipes.splice(r,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this),this)},h.prototype.on=function(e,i){var n=s.prototype.on.call(this,e,i);if("data"===e&&!1!==this._readableState.flowing&&this.resume(),"readable"===e&&this.readable){var r=this._readableState;if(!r.readableListening)if(r.readableListening=!0,r.emittedReadable=!1,r.needReadable=!0,r.reading)r.length&&m(this);else{var a=this;t.nextTick((function(){l("readable nexttick read 0"),a.read(0)}))}}return n},h.prototype.addListener=h.prototype.on,h.prototype.resume=function(){var e=this._readableState;return e.flowing||(l("resume"),e.flowing=!0,e.reading||(l("resume read 0"),this.read(0)),function(e,i){i.resumeScheduled||(i.resumeScheduled=!0,t.nextTick((function(){!function(e,t){t.resumeScheduled=!1,e.emit("resume"),g(e),t.flowing&&!t.reading&&e.read(0)}(e,i)})))}(this,e)),this},h.prototype.pause=function(){return l("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(l("pause"),this._readableState.flowing=!1,this.emit("pause")),this},h.prototype.wrap=function(e){var t=this._readableState,i=!1,n=this;for(var r in e.on("end",(function(){if(l("wrapped end"),t.decoder&&!t.ended){var e=t.decoder.end();e&&e.length&&n.push(e)}n.push(null)})),e.on("data",(function(r){(l("wrapped data"),t.decoder&&(r=t.decoder.write(r)),r&&(t.objectMode||r.length))&&(n.push(r)||(i=!0,e.pause()))})),e)c.isFunction(e[r])&&c.isUndefined(this[r])&&(this[r]=function(t){return function(){return e[t].apply(e,arguments)}}(r));return function(e,t){for(var i=0,n=e.length;i<n;i++)t(e[i],i)}(["error","close","destroy","pause","resume"],(function(t){e.on(t,n.emit.bind(n,t))})),n._read=function(t){l("wrapped _read",t),i&&(i=!1,e.resume())},n},h._fromList=v}).call(this,i(23))},function(e,t,i){(function(t){e.exports=c;var n=i(15).Buffer;c.WritableState=s;var r=i(38);r.inherits=i(30);var a=i(41);function o(e,t,i){this.chunk=e,this.encoding=t,this.callback=i}function s(e,n){var r=i(78),a=(e=e||{}).highWaterMark,o=e.objectMode?16:16384;this.highWaterMark=a||0===a?a:o,this.objectMode=!!e.objectMode,n instanceof r&&(this.objectMode=this.objectMode||!!e.writableObjectMode),this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var s=!1===e.decodeStrings;this.decodeStrings=!s,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,i){var n=e._writableState,r=n.sync,a=n.writecb;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(n),i)!function(e,i,n,r,a){n?t.nextTick((function(){i.pendingcb--,a(r)})):(i.pendingcb--,a(r));e._writableState.errorEmitted=!0,e.emit("error",r)}(e,n,r,i,a);else{var o=d(e,n);o||n.corked||n.bufferProcessing||!n.buffer.length||h(e,n),r?t.nextTick((function(){u(e,n,o,a)})):u(e,n,o,a)}}(n,e)},this.writecb=null,this.writelen=0,this.buffer=[],this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1}function c(e){var t=i(78);if(!(this instanceof c||this instanceof t))return new c(e);this._writableState=new s(e,this),this.writable=!0,a.call(this)}function l(e,t,i,n,r,a,o){t.writelen=n,t.writecb=o,t.writing=!0,t.sync=!0,i?e._writev(r,t.onwrite):e._write(r,a,t.onwrite),t.sync=!1}function u(e,t,i,n){i||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,n(),p(e,t)}function h(e,t){if(t.bufferProcessing=!0,e._writev&&t.buffer.length>1){for(var i=[],n=0;n<t.buffer.length;n++)i.push(t.buffer[n].callback);t.pendingcb++,l(e,t,!0,t.length,t.buffer,"",(function(e){for(var n=0;n<i.length;n++)t.pendingcb--,i[n](e)})),t.buffer=[]}else{for(n=0;n<t.buffer.length;n++){var r=t.buffer[n],a=r.chunk,o=r.encoding,s=r.callback,c=t.objectMode?1:a.length;if(l(e,t,!1,c,a,o,s),t.writing){n++;break}}n<t.buffer.length?t.buffer=t.buffer.slice(n):t.buffer.length=0}t.bufferProcessing=!1}function d(e,t){return t.ending&&0===t.length&&!t.finished&&!t.writing}function f(e,t){t.prefinished||(t.prefinished=!0,e.emit("prefinish"))}function p(e,t){var i=d(0,t);return i&&(0===t.pendingcb?(f(e,t),t.finished=!0,e.emit("finish")):f(e,t)),i}r.inherits(c,a),c.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe. Not readable."))},c.prototype.write=function(e,i,a){var s=this._writableState,c=!1;return r.isFunction(i)&&(a=i,i=null),r.isBuffer(e)?i="buffer":i||(i=s.defaultEncoding),r.isFunction(a)||(a=function(){}),s.ended?function(e,i,n){var r=new Error("write after end");e.emit("error",r),t.nextTick((function(){n(r)}))}(this,0,a):function(e,i,n,a){var o=!0;if(!(r.isBuffer(n)||r.isString(n)||r.isNullOrUndefined(n)||i.objectMode)){var s=new TypeError("Invalid non-string/buffer chunk");e.emit("error",s),t.nextTick((function(){a(s)})),o=!1}return o}(this,s,e,a)&&(s.pendingcb++,c=function(e,t,i,a,s){i=function(e,t,i){!e.objectMode&&!1!==e.decodeStrings&&r.isString(t)&&(t=new n(t,i));return t}(t,i,a),r.isBuffer(i)&&(a="buffer");var c=t.objectMode?1:i.length;t.length+=c;var u=t.length<t.highWaterMark;u||(t.needDrain=!0);t.writing||t.corked?t.buffer.push(new o(i,a,s)):l(e,t,!1,c,i,a,s);return u}(this,s,e,i,a)),c},c.prototype.cork=function(){this._writableState.corked++},c.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.finished||e.bufferProcessing||!e.buffer.length||h(this,e))},c.prototype._write=function(e,t,i){i(new Error("not implemented"))},c.prototype._writev=null,c.prototype.end=function(e,i,n){var a=this._writableState;r.isFunction(e)?(n=e,e=null,i=null):r.isFunction(i)&&(n=i,i=null),r.isNullOrUndefined(e)||this.write(e,i),a.corked&&(a.corked=1,this.uncork()),a.ending||a.finished||function(e,i,n){i.ending=!0,p(e,i),n&&(i.finished?t.nextTick(n):e.once("finish",n));i.ended=!0}(this,a,n)}}).call(this,i(23))},function(e,t,i){e.exports=o;var n=i(78),r=i(38);function a(e,t){this.afterTransform=function(e,i){return function(e,t,i){var n=e._transformState;n.transforming=!1;var a=n.writecb;if(!a)return e.emit("error",new Error("no writecb in Transform class"));n.writechunk=null,n.writecb=null,r.isNullOrUndefined(i)||e.push(i);a&&a(t);var o=e._readableState;o.reading=!1,(o.needReadable||o.length<o.highWaterMark)&&e._read(o.highWaterMark)}(t,e,i)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null}function o(e){if(!(this instanceof o))return new o(e);n.call(this,e),this._transformState=new a(e,this);var t=this;this._readableState.needReadable=!0,this._readableState.sync=!1,this.once("prefinish",(function(){r.isFunction(this._flush)?this._flush((function(e){s(t,e)})):s(t)}))}function s(e,t){if(t)return e.emit("error",t);var i=e._writableState,n=e._transformState;if(i.length)throw new Error("calling transform done when ws.length != 0");if(n.transforming)throw new Error("calling transform done when still transforming");return e.push(null)}r.inherits=i(30),r.inherits(o,n),o.prototype.push=function(e,t){return this._transformState.needTransform=!1,n.prototype.push.call(this,e,t)},o.prototype._transform=function(e,t,i){throw new Error("not implemented")},o.prototype._write=function(e,t,i){var n=this._transformState;if(n.writecb=i,n.writechunk=e,n.writeencoding=t,!n.transforming){var r=this._readableState;(n.needTransform||r.needReadable||r.length<r.highWaterMark)&&this._read(r.highWaterMark)}},o.prototype._read=function(e){var t=this._transformState;r.isNull(t.writechunk)||!t.writecb||t.transforming?t.needTransform=!0:(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform))}},function(e,t,i){"use strict";(function(t,n){var r=i(52),a=i(41),o=e.exports=function(){a.call(this),this._buffers=[],this._buffered=0,this._reads=[],this._paused=!1,this._encoding="utf8",this.writable=!0};r.inherits(o,a),o.prototype.read=function(e,i){this._reads.push({length:Math.abs(e),allowLess:e<0,func:i}),t.nextTick(function(){this._process(),this._paused&&this._reads.length>0&&(this._paused=!1,this.emit("drain"))}.bind(this))},o.prototype.write=function(e,t){return this.writable?(i=n.isBuffer(e)?e:new n(e,t||this._encoding),this._buffers.push(i),this._buffered+=i.length,this._process(),this._reads&&0===this._reads.length&&(this._paused=!0),this.writable&&!this._paused):(this.emit("error",new Error("Stream not writable")),!1);var i},o.prototype.end=function(e,t){e&&this.write(e,t),this.writable=!1,this._buffers&&(0===this._buffers.length?this._end():(this._buffers.push(null),this._process()))},o.prototype.destroySoon=o.prototype.end,o.prototype._end=function(){this._reads.length>0&&this.emit("error",new Error("There are some read requests waitng on finished stream")),this.destroy()},o.prototype.destroy=function(){this._buffers&&(this.writable=!1,this._reads=null,this._buffers=null,this.emit("close"))},o.prototype._processReadAllowingLess=function(e){this._reads.shift();var t=this._buffers[0];t.length>e.length?(this._buffered-=e.length,this._buffers[0]=t.slice(e.length),e.func.call(this,t.slice(0,e.length))):(this._buffered-=t.length,this._buffers.shift(),e.func.call(this,t))},o.prototype._processRead=function(e){this._reads.shift();for(var t=0,i=0,r=new n(e.length);t<e.length;){var a=this._buffers[i++],o=Math.min(a.length,e.length-t);a.copy(r,t,0,o),t+=o,o!==a.length&&(this._buffers[--i]=a.slice(o))}i>0&&this._buffers.splice(0,i),this._buffered-=e.length,e.func.call(this,r)},o.prototype._process=function(){try{for(;this._buffered>0&&this._reads&&this._reads.length>0;){var e=this._reads[0];if(e.allowLess)this._processReadAllowingLess(e);else{if(!(this._buffered>=e.length))break;this._processRead(e)}}this._buffers&&this._buffers.length>0&&null===this._buffers[0]&&this._end()}catch(e){this.emit("error",e)}}}).call(this,i(23),i(15).Buffer)},function(e,t,i){"use strict";(function(t){var n=i(201),r=i(202);function a(e,t,i){var n=e*t;return 8!==i&&(n=Math.ceil(n/(8/i))),n}var o=e.exports=function(e,t){var i=e.width,r=e.height,o=e.interlace,s=e.bpp,c=e.depth;if(this.read=t.read,this.write=t.write,this.complete=t.complete,this._imageIndex=0,this._images=[],o)for(var l=n.getImagePasses(i,r),u=0;u<l.length;u++)this._images.push({byteWidth:a(l[u].width,s,c),height:l[u].height,lineIndex:0});else this._images.push({byteWidth:a(i,s,c),height:r,lineIndex:0});this._xComparison=8===c?s:16===c?2*s:1};o.prototype.start=function(){this.read(this._images[this._imageIndex].byteWidth+1,this._reverseFilterLine.bind(this))},o.prototype._unFilterType1=function(e,t,i){for(var n=this._xComparison,r=n-1,a=0;a<i;a++){var o=e[1+a],s=a>r?t[a-n]:0;t[a]=o+s}},o.prototype._unFilterType2=function(e,t,i){for(var n=this._lastLine,r=0;r<i;r++){var a=e[1+r],o=n?n[r]:0;t[r]=a+o}},o.prototype._unFilterType3=function(e,t,i){for(var n=this._xComparison,r=n-1,a=this._lastLine,o=0;o<i;o++){var s=e[1+o],c=a?a[o]:0,l=o>r?t[o-n]:0,u=Math.floor((l+c)/2);t[o]=s+u}},o.prototype._unFilterType4=function(e,t,i){for(var n=this._xComparison,a=n-1,o=this._lastLine,s=0;s<i;s++){var c=e[1+s],l=o?o[s]:0,u=s>a?t[s-n]:0,h=s>a&&o?o[s-n]:0,d=r(u,l,h);t[s]=c+d}},o.prototype._reverseFilterLine=function(e){var i,n=e[0],r=this._images[this._imageIndex],a=r.byteWidth;if(0===n)i=e.slice(1,a+1);else switch(i=new t(a),n){case 1:this._unFilterType1(e,i,a);break;case 2:this._unFilterType2(e,i,a);break;case 3:this._unFilterType3(e,i,a);break;case 4:this._unFilterType4(e,i,a);break;default:throw new Error("Unrecognised filter type - "+n)}this.write(i),r.lineIndex++,r.lineIndex>=r.height?(this._lastLine=null,this._imageIndex++,r=this._images[this._imageIndex]):this._lastLine=i,r?this.read(r.byteWidth+1,this._reverseFilterLine.bind(this)):(this._lastLine=null,this.complete())}}).call(this,i(15).Buffer)},function(e,t,i){"use strict";var n=[{x:[0],y:[0]},{x:[4],y:[0]},{x:[0,4],y:[4]},{x:[2,6],y:[0,4]},{x:[0,2,4,6],y:[2,6]},{x:[1,3,5,7],y:[0,2,4,6]},{x:[0,1,2,3,4,5,6,7],y:[1,3,5,7]}];t.getImagePasses=function(e,t){for(var i=[],r=e%8,a=t%8,o=(e-r)/8,s=(t-a)/8,c=0;c<n.length;c++){for(var l=n[c],u=o*l.x.length,h=s*l.y.length,d=0;d<l.x.length&&l.x[d]<r;d++)u++;for(d=0;d<l.y.length&&l.y[d]<a;d++)h++;u>0&&h>0&&i.push({width:u,height:h,index:c})}return i},t.getInterlaceIterator=function(e){return function(t,i,r){var a=t%n[r].x.length,o=(t-a)/n[r].x.length*8+n[r].x[a],s=i%n[r].y.length;return 4*o+((i-s)/n[r].y.length*8+n[r].y[s])*e*4}}},function(e,t,i){"use strict";e.exports=function(e,t,i){var n=e+t-i,r=Math.abs(n-e),a=Math.abs(n-t),o=Math.abs(n-i);return r<=a&&r<=o?e:a<=o?t:i}},function(e,t,i){"use strict";(function(t){var n=i(104),r=i(204),a=e.exports=function(e,t){this._options=e,e.checkCRC=!1!==e.checkCRC,this._hasIHDR=!1,this._hasIEND=!1,this._palette=[],this._colorType=0,this._chunks={},this._chunks[n.TYPE_IHDR]=this._handleIHDR.bind(this),this._chunks[n.TYPE_IEND]=this._handleIEND.bind(this),this._chunks[n.TYPE_IDAT]=this._handleIDAT.bind(this),this._chunks[n.TYPE_PLTE]=this._handlePLTE.bind(this),this._chunks[n.TYPE_tRNS]=this._handleTRNS.bind(this),this._chunks[n.TYPE_gAMA]=this._handleGAMA.bind(this),this.read=t.read,this.error=t.error,this.metadata=t.metadata,this.gamma=t.gamma,this.transColor=t.transColor,this.palette=t.palette,this.parsed=t.parsed,this.inflateData=t.inflateData,this.inflateData=t.inflateData,this.finished=t.finished};a.prototype.start=function(){this.read(n.PNG_SIGNATURE.length,this._parseSignature.bind(this))},a.prototype._parseSignature=function(e){for(var t=n.PNG_SIGNATURE,i=0;i<t.length;i++)if(e[i]!==t[i])return void this.error(new Error("Invalid file signature"));this.read(8,this._parseChunkBegin.bind(this))},a.prototype._parseChunkBegin=function(e){for(var i=e.readUInt32BE(0),a=e.readUInt32BE(4),o="",s=4;s<8;s++)o+=String.fromCharCode(e[s]);var c=Boolean(32&e[4]);if(this._hasIHDR||a===n.TYPE_IHDR){if(this._crc=new r,this._crc.write(new t(o)),this._chunks[a])return this._chunks[a](i);c?this.read(i+4,this._skipChunk.bind(this)):this.error(new Error("Unsupported critical chunk type "+o))}else this.error(new Error("Expected IHDR on beggining"))},a.prototype._skipChunk=function(){this.read(8,this._parseChunkBegin.bind(this))},a.prototype._handleChunkEnd=function(){this.read(4,this._parseChunkEnd.bind(this))},a.prototype._parseChunkEnd=function(e){var t=e.readInt32BE(0),i=this._crc.crc32();this._options.checkCRC&&i!==t?this.error(new Error("Crc error - "+t+" - "+i)):this._hasIEND||this.read(8,this._parseChunkBegin.bind(this))},a.prototype._handleIHDR=function(e){this.read(e,this._parseIHDR.bind(this))},a.prototype._parseIHDR=function(e){this._crc.write(e);var t=e.readUInt32BE(0),i=e.readUInt32BE(4),r=e[8],a=e[9],o=e[10],s=e[11],c=e[12];if(8===r||4===r||2===r||1===r||16===r)if(a in n.COLORTYPE_TO_BPP_MAP)if(0===o)if(0===s)if(0===c||1===c){this._colorType=a;var l=n.COLORTYPE_TO_BPP_MAP[this._colorType];this._hasIHDR=!0,this.metadata({width:t,height:i,depth:r,interlace:Boolean(c),palette:Boolean(a&n.COLORTYPE_PALETTE),color:Boolean(a&n.COLORTYPE_COLOR),alpha:Boolean(a&n.COLORTYPE_ALPHA),bpp:l,colorType:a}),this._handleChunkEnd()}else this.error(new Error("Unsupported interlace method"));else this.error(new Error("Unsupported filter method"));else this.error(new Error("Unsupported compression method"));else this.error(new Error("Unsupported color type"));else this.error(new Error("Unsupported bit depth "+r))},a.prototype._handlePLTE=function(e){this.read(e,this._parsePLTE.bind(this))},a.prototype._parsePLTE=function(e){this._crc.write(e);for(var t=Math.floor(e.length/3),i=0;i<t;i++)this._palette.push([e[3*i],e[3*i+1],e[3*i+2],255]);this.palette(this._palette),this._handleChunkEnd()},a.prototype._handleTRNS=function(e){this.read(e,this._parseTRNS.bind(this))},a.prototype._parseTRNS=function(e){if(this._crc.write(e),this._colorType===n.COLORTYPE_PALETTE_COLOR){if(0===this._palette.length)return void this.error(new Error("Transparency chunk must be after palette"));if(e.length>this._palette.length)return void this.error(new Error("More transparent colors than palette size"));for(var t=0;t<e.length;t++)this._palette[t][3]=e[t];this.palette(this._palette)}this._colorType===n.COLORTYPE_GRAYSCALE&&this.transColor([e.readUInt16BE(0)]),this._colorType===n.COLORTYPE_COLOR&&this.transColor([e.readUInt16BE(0),e.readUInt16BE(2),e.readUInt16BE(4)]),this._handleChunkEnd()},a.prototype._handleGAMA=function(e){this.read(e,this._parseGAMA.bind(this))},a.prototype._parseGAMA=function(e){this._crc.write(e),this.gamma(e.readUInt32BE(0)/n.GAMMA_DIVISION),this._handleChunkEnd()},a.prototype._handleIDAT=function(e){this.read(-e,this._parseIDAT.bind(this,e))},a.prototype._parseIDAT=function(e,t){if(this._crc.write(t),this._colorType===n.COLORTYPE_PALETTE_COLOR&&0===this._palette.length)throw new Error("Expected palette not found");this.inflateData(t);var i=e-t.length;i>0?this._handleIDAT(i):this._handleChunkEnd()},a.prototype._handleIEND=function(e){this.read(e,this._parseIEND.bind(this))},a.prototype._parseIEND=function(e){this._crc.write(e),this._hasIEND=!0,this._handleChunkEnd(),this.finished&&this.finished()}}).call(this,i(15).Buffer)},function(e,t,i){"use strict";var n=[];!function(){for(var e=0;e<256;e++){for(var t=e,i=0;i<8;i++)1&t?t=3988292384^t>>>1:t>>>=1;n[e]=t}}();var r=e.exports=function(){this._crc=-1};r.prototype.write=function(e){for(var t=0;t<e.length;t++)this._crc=n[255&(this._crc^e[t])]^this._crc>>>8;return!0},r.prototype.crc32=function(){return-1^this._crc},r.crc32=function(e){for(var t=-1,i=0;i<e.length;i++)t=n[255&(t^e[i])]^t>>>8;return-1^t}},function(e,t,i){"use strict";(function(e){var n=i(201),r={1:{0:0,1:0,2:0,3:255},2:{0:0,1:0,2:0,3:1},3:{0:0,1:1,2:2,3:255},4:{0:0,1:1,2:2,3:3}};function a(e,t,i,n,a,o){for(var s=e.width,c=e.height,l=e.index,u=0;u<c;u++)for(var h=0;h<s;h++){for(var d=i(h,u,l),f=0;f<4;f++){var p=r[n][f];if(f===a.length)throw new Error("Ran out of data");t[d+f]=255!==p?a[p+o]:255}o+=n}return o}function o(e,t,i,n,a,o){for(var s=e.width,c=e.height,l=e.index,u=0;u<c;u++){for(var h=0;h<s;h++)for(var d=a.get(n),f=i(h,u,l),p=0;p<4;p++){var m=r[n][p];t[f+p]=255!==m?d[m]:o}a.resetAfterLine()}}t.dataToBitMap=function(t,i){var r,s=i.width,c=i.height,l=i.depth,u=i.bpp,h=i.interlace;if(8!==l)var d=function(e,t){var i=[],n=0;function r(){if(n===e.length)throw new Error("Ran out of data");var r,a,o,s,c,l,u,h,d=e[n];switch(n++,t){default:throw new Error("unrecognised depth");case 16:u=e[n],n++,i.push((d<<8)+u);break;case 4:u=15&d,h=d>>4,i.push(h,u);break;case 2:c=3&d,l=d>>2&3,u=d>>4&3,h=d>>6&3,i.push(h,u,l,c);break;case 1:r=1&d,a=d>>1&1,o=d>>2&1,s=d>>3&1,c=d>>4&1,l=d>>5&1,u=d>>6&1,h=d>>7&1,i.push(h,u,l,c,s,o,a,r)}}return{get:function(e){for(;i.length<e;)r();var t=i.slice(0,e);return i=i.slice(e),t},resetAfterLine:function(){i.length=0},end:function(){if(n!==e.length)throw new Error("extra data found")}}}(t,l);r=l<=8?new e(s*c*4):new Uint16Array(s*c*4);var f,p,m=Math.pow(2,l)-1,_=0;if(h)f=n.getImagePasses(s,c),p=n.getInterlaceIterator(s,c);else{var g=0;p=function(){var e=g;return g+=4,e},f=[{width:s,height:c}]}for(var v=0;v<f.length;v++)8===l?_=a(f[v],r,p,u,t,_):o(f[v],r,p,u,d,m);if(8===l){if(_!==t.length)throw new Error("extra data found")}else d.end();return r}}).call(this,i(15).Buffer)},function(e,t,i){"use strict";(function(t){e.exports=function(e,i){var n=i.depth,r=i.width,a=i.height,o=i.colorType,s=i.transColor,c=i.palette,l=e;return 3===o?function(e,t,i,n,r){for(var a=0,o=0;o<n;o++)for(var s=0;s<i;s++){var c=r[e[a]];if(!c)throw new Error("index "+e[a]+" not in palette");for(var l=0;l<4;l++)t[a+l]=c[l];a+=4}}(e,l,r,a,c):(s&&function(e,t,i,n,r){for(var a=0,o=0;o<n;o++)for(var s=0;s<i;s++){var c=!1;if(1===r.length?r[0]===e[a]&&(c=!0):r[0]===e[a]&&r[1]===e[a+1]&&r[2]===e[a+2]&&(c=!0),c)for(var l=0;l<4;l++)t[a+l]=0;a+=4}}(e,l,r,a,s),8!==n&&(16===n&&(l=new t(r*a*4)),function(e,t,i,n,r){for(var a=Math.pow(2,r)-1,o=0,s=0;s<n;s++)for(var c=0;c<i;c++){for(var l=0;l<4;l++)t[o+l]=Math.floor(255*e[o+l]/a+.5);o+=4}}(e,l,r,a,n))),l}}).call(this,i(15).Buffer)},function(e,t,i){"use strict";(function(t){var n=i(104),r=i(204),a=i(340),o=i(341),s=i(89),c=e.exports=function(e){if(this._options=e,e.deflateChunkSize=e.deflateChunkSize||32768,e.deflateLevel=null!=e.deflateLevel?e.deflateLevel:9,e.deflateStrategy=null!=e.deflateStrategy?e.deflateStrategy:3,e.inputHasAlpha=null==e.inputHasAlpha||e.inputHasAlpha,e.deflateFactory=e.deflateFactory||s.createDeflate,e.bitDepth=e.bitDepth||8,e.colorType="number"==typeof e.colorType?e.colorType:n.COLORTYPE_COLOR_ALPHA,e.colorType!==n.COLORTYPE_COLOR&&e.colorType!==n.COLORTYPE_COLOR_ALPHA)throw new Error("option color type:"+e.colorType+" is not supported at present");if(8!==e.bitDepth)throw new Error("option bit depth:"+e.bitDepth+" is not supported at present")};c.prototype.getDeflateOptions=function(){return{chunkSize:this._options.deflateChunkSize,level:this._options.deflateLevel,strategy:this._options.deflateStrategy}},c.prototype.createDeflate=function(){return this._options.deflateFactory(this.getDeflateOptions())},c.prototype.filterData=function(e,t,i){var r=a(e,t,i,this._options),s=n.COLORTYPE_TO_BPP_MAP[this._options.colorType];return o(r,t,i,this._options,s)},c.prototype._packChunk=function(e,i){var n=i?i.length:0,a=new t(n+12);return a.writeUInt32BE(n,0),a.writeUInt32BE(e,4),i&&i.copy(a,8),a.writeInt32BE(r.crc32(a.slice(4,a.length-4)),a.length-4),a},c.prototype.packGAMA=function(e){var i=new t(4);return i.writeUInt32BE(Math.floor(e*n.GAMMA_DIVISION),0),this._packChunk(n.TYPE_gAMA,i)},c.prototype.packIHDR=function(e,i){var r=new t(13);return r.writeUInt32BE(e,0),r.writeUInt32BE(i,4),r[8]=this._options.bitDepth,r[9]=this._options.colorType,r[10]=0,r[11]=0,r[12]=0,this._packChunk(n.TYPE_IHDR,r)},c.prototype.packIDAT=function(e){return this._packChunk(n.TYPE_IDAT,e)},c.prototype.packIEND=function(){return this._packChunk(n.TYPE_IEND,null)}}).call(this,i(15).Buffer)},function(e,t,i){"use strict";var n=e.exports=function(e){this._buffer=e,this._reads=[]};n.prototype.read=function(e,t){this._reads.push({length:Math.abs(e),allowLess:e<0,func:t})},n.prototype.process=function(){for(;this._reads.length>0&&this._buffer.length;){var e=this._reads[0];if(!this._buffer.length||!(this._buffer.length>=e.length||e.allowLess))break;this._reads.shift();var t=this._buffer;this._buffer=t.slice(e.length),e.func.call(this,t.slice(0,e.length))}return this._reads.length>0?new Error("There are some read requests waitng on finished stream"):this._buffer.length>0?new Error("unrecognised content at end of stream"):void 0}},function(e,t,i){var n=i(312).MultiRange,r=i(313),a=i(323);function o(){throw new Error("Promises not supported in your environment. Use the callback argument or a Promise polyfill.")}var s={then:o,catch:o};e.exports=function(e,t){var i,o,c;e=e||{},t=t||function(){},"function"==typeof Promise?i=new Promise((function(e,i){o=function(i){t(null,i),e(i)},c=function(e){t(e),i(e)}})):(i=s,o=function(e){t(null,e)},c=t);var l=e.url;if(!l)return c(new Error('"url" option is required.')),i;var u=e.frames;if(!u&&0!==u)return c(new Error('"frames" option is required.')),i;var h=e.outputType||"jpg",d=e.quality,f=e.cumulative,p="all"===u?"all":new n(u),m="undefined"==typeof window?"image/gif":".GIF";return r(l,m,(function(e,t,i){if(e)c(e);else if(t.shape.length<4)c(new Error('"url" input should be multi-frame GIF.'));else{for(var n=[],r=0,s=0;s<t.shape[0];s++)("all"===p||p.has(s))&&function(e){n.push({getImage:function(){if(f&&e>r){for(var i=t.pick(r),n=r+1;n<=e;n++){for(var o=t.pick(n),s=0;s<o.shape[0];s++)for(var c=0;c<o.shape[1];c++)0===o.get(s,c,3)&&(o.set(s,c,0,i.get(s,c,0)),o.set(s,c,1,i.get(s,c,1)),o.set(s,c,2,i.get(s,c,2)),o.set(s,c,3,i.get(s,c,3)));i=o}r=e}return a(t.pick(e),h,{quality:d})},frameIndex:e,frameInfo:i&&i[e]})}(s);o(n)}})),i}},function(e,t,i){"use strict";t.byteLength=function(e){var t=l(e),i=t[0],n=t[1];return 3*(i+n)/4-n},t.toByteArray=function(e){var t,i,n=l(e),o=n[0],s=n[1],c=new a(function(e,t,i){return 3*(t+i)/4-i}(0,o,s)),u=0,h=s>0?o-4:o;for(i=0;i<h;i+=4)t=r[e.charCodeAt(i)]<<18|r[e.charCodeAt(i+1)]<<12|r[e.charCodeAt(i+2)]<<6|r[e.charCodeAt(i+3)],c[u++]=t>>16&255,c[u++]=t>>8&255,c[u++]=255&t;2===s&&(t=r[e.charCodeAt(i)]<<2|r[e.charCodeAt(i+1)]>>4,c[u++]=255&t);1===s&&(t=r[e.charCodeAt(i)]<<10|r[e.charCodeAt(i+1)]<<4|r[e.charCodeAt(i+2)]>>2,c[u++]=t>>8&255,c[u++]=255&t);return c},t.fromByteArray=function(e){for(var t,i=e.length,r=i%3,a=[],o=0,s=i-r;o<s;o+=16383)a.push(u(e,o,o+16383>s?s:o+16383));1===r?(t=e[i-1],a.push(n[t>>2]+n[t<<4&63]+"==")):2===r&&(t=(e[i-2]<<8)+e[i-1],a.push(n[t>>10]+n[t>>4&63]+n[t<<2&63]+"="));return a.join("")};for(var n=[],r=[],a="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,c=o.length;s<c;++s)n[s]=o[s],r[o.charCodeAt(s)]=s;function l(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var i=e.indexOf("=");return-1===i&&(i=t),[i,i===t?0:4-i%4]}function u(e,t,i){for(var r,a,o=[],s=t;s<i;s+=3)r=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2]),o.push(n[(a=r)>>18&63]+n[a>>12&63]+n[a>>6&63]+n[63&a]);return o.join("")}r["-".charCodeAt(0)]=62,r["_".charCodeAt(0)]=63},function(e,t){t.read=function(e,t,i,n,r){var a,o,s=8*r-n-1,c=(1<<s)-1,l=c>>1,u=-7,h=i?r-1:0,d=i?-1:1,f=e[t+h];for(h+=d,a=f&(1<<-u)-1,f>>=-u,u+=s;u>0;a=256*a+e[t+h],h+=d,u-=8);for(o=a&(1<<-u)-1,a>>=-u,u+=n;u>0;o=256*o+e[t+h],h+=d,u-=8);if(0===a)a=1-l;else{if(a===c)return o?NaN:1/0*(f?-1:1);o+=Math.pow(2,n),a-=l}return(f?-1:1)*o*Math.pow(2,a-n)},t.write=function(e,t,i,n,r,a){var o,s,c,l=8*a-r-1,u=(1<<l)-1,h=u>>1,d=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,f=n?0:a-1,p=n?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,o=u):(o=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-o))<1&&(o--,c*=2),(t+=o+h>=1?d/c:d*Math.pow(2,1-h))*c>=2&&(o++,c/=2),o+h>=u?(s=0,o=u):o+h>=1?(s=(t*c-1)*Math.pow(2,r),o+=h):(s=t*Math.pow(2,h-1)*Math.pow(2,r),o=0));r>=8;e[i+f]=255&s,f+=p,s/=256,r-=8);for(o=o<<r|s,l+=r;l>0;e[i+f]=255&o,f+=p,o/=256,l-=8);e[i+f-p]|=128*m}},function(e,t,i){(function(e,n){var r;/*! https://mths.be/punycode v1.4.1 by @mathias */!function(a){t&&t.nodeType,e&&e.nodeType;var o="object"==typeof n&&n;o.global!==o&&o.window!==o&&o.self;var s,c=2147483647,l=36,u=1,h=26,d=38,f=700,p=72,m=128,_="-",g=/^xn--/,v=/[^\x20-\x7E]/,b=/[\x2E\u3002\uFF0E\uFF61]/g,y={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},w=l-u,O=Math.floor,x=String.fromCharCode;function E(e){throw new RangeError(y[e])}function T(e,t){for(var i=e.length,n=[];i--;)n[i]=t(e[i]);return n}function C(e,t){var i=e.split("@"),n="";return i.length>1&&(n=i[0]+"@",e=i[1]),n+T((e=e.replace(b,".")).split("."),t).join(".")}function S(e){for(var t,i,n=[],r=0,a=e.length;r<a;)(t=e.charCodeAt(r++))>=55296&&t<=56319&&r<a?56320==(64512&(i=e.charCodeAt(r++)))?n.push(((1023&t)<<10)+(1023&i)+65536):(n.push(t),r--):n.push(t);return n}function A(e){return T(e,(function(e){var t="";return e>65535&&(t+=x((e-=65536)>>>10&1023|55296),e=56320|1023&e),t+=x(e)})).join("")}function P(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function I(e,t,i){var n=0;for(e=i?O(e/f):e>>1,e+=O(e/t);e>w*h>>1;n+=l)e=O(e/w);return O(n+(w+1)*e/(e+d))}function D(e){var t,i,n,r,a,o,s,d,f,g,v,b=[],y=e.length,w=0,x=m,T=p;for((i=e.lastIndexOf(_))<0&&(i=0),n=0;n<i;++n)e.charCodeAt(n)>=128&&E("not-basic"),b.push(e.charCodeAt(n));for(r=i>0?i+1:0;r<y;){for(a=w,o=1,s=l;r>=y&&E("invalid-input"),((d=(v=e.charCodeAt(r++))-48<10?v-22:v-65<26?v-65:v-97<26?v-97:l)>=l||d>O((c-w)/o))&&E("overflow"),w+=d*o,!(d<(f=s<=T?u:s>=T+h?h:s-T));s+=l)o>O(c/(g=l-f))&&E("overflow"),o*=g;T=I(w-a,t=b.length+1,0==a),O(w/t)>c-x&&E("overflow"),x+=O(w/t),w%=t,b.splice(w++,0,x)}return A(b)}function j(e){var t,i,n,r,a,o,s,d,f,g,v,b,y,w,T,C=[];for(b=(e=S(e)).length,t=m,i=0,a=p,o=0;o<b;++o)(v=e[o])<128&&C.push(x(v));for(n=r=C.length,r&&C.push(_);n<b;){for(s=c,o=0;o<b;++o)(v=e[o])>=t&&v<s&&(s=v);for(s-t>O((c-i)/(y=n+1))&&E("overflow"),i+=(s-t)*y,t=s,o=0;o<b;++o)if((v=e[o])<t&&++i>c&&E("overflow"),v==t){for(d=i,f=l;!(d<(g=f<=a?u:f>=a+h?h:f-a));f+=l)T=d-g,w=l-g,C.push(x(P(g+T%w,0))),d=O(T/w);C.push(x(P(d,0))),a=I(i,y,n==r),i=0,++n}++i,++t}return C.join("")}s={version:"1.4.1",ucs2:{decode:S,encode:A},decode:D,encode:j,toASCII:function(e){return C(e,(function(e){return v.test(e)?"xn--"+j(e):e}))},toUnicode:function(e){return C(e,(function(e){return g.test(e)?D(e.slice(4).toLowerCase()):e}))}},void 0===(r=function(){return s}.call(t,i,t,e))||(e.exports=r)}()}).call(this,i(213)(e),i(40))},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,i){"use strict";e.exports={isString:function(e){return"string"==typeof e},isObject:function(e){return"object"==typeof e&&null!==e},isNull:function(e){return null===e},isNullOrUndefined:function(e){return null==e}}},function(e,t,i){"use strict";t.decode=t.parse=i(216),t.encode=t.stringify=i(217)},function(e,t,i){"use strict";function n(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,t,i,a){t=t||"&",i=i||"=";var o={};if("string"!=typeof e||0===e.length)return o;var s=/\+/g;e=e.split(t);var c=1e3;a&&"number"==typeof a.maxKeys&&(c=a.maxKeys);var l=e.length;c>0&&l>c&&(l=c);for(var u=0;u<l;++u){var h,d,f,p,m=e[u].replace(s,"%20"),_=m.indexOf(i);_>=0?(h=m.substr(0,_),d=m.substr(_+1)):(h=m,d=""),f=decodeURIComponent(h),p=decodeURIComponent(d),n(o,f)?r(o[f])?o[f].push(p):o[f]=[o[f],p]:o[f]=p}return o};var r=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},function(e,t,i){"use strict";var n=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,t,i,s){return t=t||"&",i=i||"=",null===e&&(e=void 0),"object"==typeof e?a(o(e),(function(o){var s=encodeURIComponent(n(o))+i;return r(e[o])?a(e[o],(function(e){return s+encodeURIComponent(n(e))})).join(t):s+encodeURIComponent(n(e[o]))})).join(t):s?encodeURIComponent(n(s))+i+encodeURIComponent(n(e)):""};var r=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function a(e,t){if(e.map)return e.map(t);for(var i=[],n=0;n<e.length;n++)i.push(t(e[n],n));return i}var o=Object.keys||function(e){var t=[];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.push(i);return t}},function(e,t,i){var n=i(148),r=i(123),a=e.exports;for(var o in n)n.hasOwnProperty(o)&&(a[o]=n[o]);function s(e){if("string"==typeof e&&(e=r.parse(e)),e.protocol||(e.protocol="https:"),"https:"!==e.protocol)throw new Error('Protocol "'+e.protocol+'" not supported. Expected "https:"');return e}a.request=function(e,t){return e=s(e),n.request.call(this,e,t)},a.get=function(e,t){return e=s(e),n.get.call(this,e,t)}},function(e,t,i){(function(t,n,r){var a=i(149),o=i(30),s=i(150),c=i(88),l=i(228),u=s.IncomingMessage,h=s.readyStates;var d=e.exports=function(e){var i,n=this;c.Writable.call(n),n._opts=e,n._body=[],n._headers={},e.auth&&n.setHeader("Authorization","Basic "+new t(e.auth).toString("base64")),Object.keys(e.headers).forEach((function(t){n.setHeader(t,e.headers[t])}));var r=!0;if("disable-fetch"===e.mode||"requestTimeout"in e&&!a.abortController)r=!1,i=!0;else if("prefer-streaming"===e.mode)i=!1;else if("allow-wrong-content-type"===e.mode)i=!a.overrideMimeType;else{if(e.mode&&"default"!==e.mode&&"prefer-fast"!==e.mode)throw new Error("Invalid value for opts.mode");i=!0}n._mode=function(e,t){return a.fetch&&t?"fetch":a.mozchunkedarraybuffer?"moz-chunked-arraybuffer":a.msstream?"ms-stream":a.arraybuffer&&e?"arraybuffer":a.vbArray&&e?"text:vbarray":"text"}(i,r),n._fetchTimer=null,n.on("finish",(function(){n._onFinish()}))};o(d,c.Writable),d.prototype.setHeader=function(e,t){var i=e.toLowerCase();-1===f.indexOf(i)&&(this._headers[i]={name:e,value:t})},d.prototype.getHeader=function(e){var t=this._headers[e.toLowerCase()];return t?t.value:null},d.prototype.removeHeader=function(e){delete this._headers[e.toLowerCase()]},d.prototype._onFinish=function(){var e=this;if(!e._destroyed){var i=e._opts,o=e._headers,s=null;"GET"!==i.method&&"HEAD"!==i.method&&(s=a.arraybuffer?l(t.concat(e._body)):a.blobConstructor?new n.Blob(e._body.map((function(e){return l(e)})),{type:(o["content-type"]||{}).value||""}):t.concat(e._body).toString());var c=[];if(Object.keys(o).forEach((function(e){var t=o[e].name,i=o[e].value;Array.isArray(i)?i.forEach((function(e){c.push([t,e])})):c.push([t,i])})),"fetch"===e._mode){var u=null;if(a.abortController){var d=new AbortController;u=d.signal,e._fetchAbortController=d,"requestTimeout"in i&&0!==i.requestTimeout&&(e._fetchTimer=n.setTimeout((function(){e.emit("requestTimeout"),e._fetchAbortController&&e._fetchAbortController.abort()}),i.requestTimeout))}n.fetch(e._opts.url,{method:e._opts.method,headers:c,body:s||void 0,mode:"cors",credentials:i.withCredentials?"include":"same-origin",signal:u}).then((function(t){e._fetchResponse=t,e._connect()}),(function(t){n.clearTimeout(e._fetchTimer),e._destroyed||e.emit("error",t)}))}else{var f=e._xhr=new n.XMLHttpRequest;try{f.open(e._opts.method,e._opts.url,!0)}catch(t){return void r.nextTick((function(){e.emit("error",t)}))}"responseType"in f&&(f.responseType=e._mode.split(":")[0]),"withCredentials"in f&&(f.withCredentials=!!i.withCredentials),"text"===e._mode&&"overrideMimeType"in f&&f.overrideMimeType("text/plain; charset=x-user-defined"),"requestTimeout"in i&&(f.timeout=i.requestTimeout,f.ontimeout=function(){e.emit("requestTimeout")}),c.forEach((function(e){f.setRequestHeader(e[0],e[1])})),e._response=null,f.onreadystatechange=function(){switch(f.readyState){case h.LOADING:case h.DONE:e._onXHRProgress()}},"moz-chunked-arraybuffer"===e._mode&&(f.onprogress=function(){e._onXHRProgress()}),f.onerror=function(){e._destroyed||e.emit("error",new Error("XHR error"))};try{f.send(s)}catch(t){return void r.nextTick((function(){e.emit("error",t)}))}}}},d.prototype._onXHRProgress=function(){(function(e){try{var t=e.status;return null!==t&&0!==t}catch(e){return!1}})(this._xhr)&&!this._destroyed&&(this._response||this._connect(),this._response._onXHRProgress())},d.prototype._connect=function(){var e=this;e._destroyed||(e._response=new u(e._xhr,e._fetchResponse,e._mode,e._fetchTimer),e._response.on("error",(function(t){e.emit("error",t)})),e.emit("response",e._response))},d.prototype._write=function(e,t,i){this._body.push(e),i()},d.prototype.abort=d.prototype.destroy=function(){this._destroyed=!0,n.clearTimeout(this._fetchTimer),this._response&&(this._response._destroyed=!0),this._xhr?this._xhr.abort():this._fetchAbortController&&this._fetchAbortController.abort()},d.prototype.end=function(e,t,i){"function"==typeof e&&(i=e,e=void 0),c.Writable.prototype.end.call(this,e,t,i)},d.prototype.flushHeaders=function(){},d.prototype.setTimeout=function(){},d.prototype.setNoDelay=function(){},d.prototype.setSocketKeepAlive=function(){};var f=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","cookie","cookie2","date","dnt","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","via"]}).call(this,i(15).Buffer,i(40),i(23))},function(e,t){},function(e,t,i){"use strict";var n=i(124).Buffer,r=i(222);function a(e,t,i){e.copy(t,i)}e.exports=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.head=null,this.tail=null,this.length=0}return e.prototype.push=function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length},e.prototype.unshift=function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length},e.prototype.shift=function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}},e.prototype.clear=function(){this.head=this.tail=null,this.length=0},e.prototype.join=function(e){if(0===this.length)return"";for(var t=this.head,i=""+t.data;t=t.next;)i+=e+t.data;return i},e.prototype.concat=function(e){if(0===this.length)return n.alloc(0);if(1===this.length)return this.head.data;for(var t=n.allocUnsafe(e>>>0),i=this.head,r=0;i;)a(i.data,t,r),r+=i.data.length,i=i.next;return t},e}(),r&&r.inspect&&r.inspect.custom&&(e.exports.prototype[r.inspect.custom]=function(){var e=r.inspect({length:this.length});return this.constructor.name+" "+e})},function(e,t){},function(e,t,i){(function(e){var n=void 0!==e&&e||"undefined"!=typeof self&&self||window,r=Function.prototype.apply;function a(e,t){this._id=e,this._clearFn=t}t.setTimeout=function(){return new a(r.call(setTimeout,n,arguments),clearTimeout)},t.setInterval=function(){return new a(r.call(setInterval,n,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},a.prototype.unref=a.prototype.ref=function(){},a.prototype.close=function(){this._clearFn.call(n,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout((function(){e._onTimeout&&e._onTimeout()}),t))},i(224),t.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==e&&e.clearImmediate||this&&this.clearImmediate}).call(this,i(40))},function(e,t,i){(function(e,t){!function(e,i){"use strict";if(!e.setImmediate){var n,r,a,o,s,c=1,l={},u=!1,h=e.document,d=Object.getPrototypeOf&&Object.getPrototypeOf(e);d=d&&d.setTimeout?d:e,"[object process]"==={}.toString.call(e.process)?n=function(e){t.nextTick((function(){p(e)}))}:!function(){if(e.postMessage&&!e.importScripts){var t=!0,i=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=i,t}}()?e.MessageChannel?((a=new MessageChannel).port1.onmessage=function(e){p(e.data)},n=function(e){a.port2.postMessage(e)}):h&&"onreadystatechange"in h.createElement("script")?(r=h.documentElement,n=function(e){var t=h.createElement("script");t.onreadystatechange=function(){p(e),t.onreadystatechange=null,r.removeChild(t),t=null},r.appendChild(t)}):n=function(e){setTimeout(p,0,e)}:(o="setImmediate$"+Math.random()+"$",s=function(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(o)&&p(+t.data.slice(o.length))},e.addEventListener?e.addEventListener("message",s,!1):e.attachEvent("onmessage",s),n=function(t){e.postMessage(o+t,"*")}),d.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),i=0;i<t.length;i++)t[i]=arguments[i+1];var r={callback:e,args:t};return l[c]=r,n(c),c++},d.clearImmediate=f}function f(e){delete l[e]}function p(e){if(u)setTimeout(p,0,e);else{var t=l[e];if(t){u=!0;try{!function(e){var t=e.callback,n=e.args;switch(n.length){case 0:t();break;case 1:t(n[0]);break;case 2:t(n[0],n[1]);break;case 3:t(n[0],n[1],n[2]);break;default:t.apply(i,n)}}(t)}finally{f(e),u=!1}}}}}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,i(40),i(23))},function(e,t,i){(function(t){function i(e){try{if(!t.localStorage)return!1}catch(e){return!1}var i=t.localStorage[e];return null!=i&&"true"===String(i).toLowerCase()}e.exports=function(e,t){if(i("noDeprecation"))return e;var n=!1;return function(){if(!n){if(i("throwDeprecation"))throw new Error(t);i("traceDeprecation")?console.trace(t):console.warn(t),n=!0}return e.apply(this,arguments)}}}).call(this,i(40))},function(e,t,i){var n=i(15),r=n.Buffer;function a(e,t){for(var i in e)t[i]=e[i]}function o(e,t,i){return r(e,t,i)}r.from&&r.alloc&&r.allocUnsafe&&r.allocUnsafeSlow?e.exports=n:(a(n,t),t.Buffer=o),o.prototype=Object.create(r.prototype),a(r,o),o.from=function(e,t,i){if("number"==typeof e)throw new TypeError("Argument must not be a number");return r(e,t,i)},o.alloc=function(e,t,i){if("number"!=typeof e)throw new TypeError("Argument must be a number");var n=r(e);return void 0!==t?"string"==typeof i?n.fill(t,i):n.fill(t):n.fill(0),n},o.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return r(e)},o.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return n.SlowBuffer(e)}},function(e,t,i){"use strict";e.exports=a;var n=i(154),r=i(38);function a(e){if(!(this instanceof a))return new a(e);n.call(this,e)}r.inherits=i(30),r.inherits(a,n),a.prototype._transform=function(e,t,i){i(null,e)}},function(e,t,i){var n=i(15).Buffer;e.exports=function(e){if(e instanceof Uint8Array){if(0===e.byteOffset&&e.byteLength===e.buffer.byteLength)return e.buffer;if("function"==typeof e.buffer.slice)return e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)}if(n.isBuffer(e)){for(var t=new Uint8Array(e.length),i=e.length,r=0;r<i;r++)t[r]=e[r];return t.buffer}throw new Error("Argument must be a Buffer")}},function(e,t){e.exports=function(){for(var e={},t=0;t<arguments.length;t++){var n=arguments[t];for(var r in n)i.call(n,r)&&(e[r]=n[r])}return e};var i=Object.prototype.hasOwnProperty},function(e,t){e.exports={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",208:"Already Reported",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",308:"Permanent Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Payload Too Large",414:"URI Too Long",415:"Unsupported Media Type",416:"Range Not Satisfiable",417:"Expectation Failed",418:"I'm a teapot",421:"Misdirected Request",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",425:"Unordered Collection",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",451:"Unavailable For Legal Reasons",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",508:"Loop Detected",509:"Bandwidth Limit Exceeded",510:"Not Extended",511:"Network Authentication Required"}},function(e,t,i){e.exports=i(125)},function(e,t,i){e.exports=i(61)},function(e,t,i){e.exports=i(88).Transform},function(e,t,i){e.exports=i(88).PassThrough},function(e,t,i){"use strict";(function(e,n){var r=i(126),a=i(239),o=i(240),s=i(243),c=i(246);for(var l in c)t[l]=c[l];t.NONE=0,t.DEFLATE=1,t.INFLATE=2,t.GZIP=3,t.GUNZIP=4,t.DEFLATERAW=5,t.INFLATERAW=6,t.UNZIP=7;function u(e){if("number"!=typeof e||e<t.DEFLATE||e>t.UNZIP)throw new TypeError("Bad argument");this.dictionary=null,this.err=0,this.flush=0,this.init_done=!1,this.level=0,this.memLevel=0,this.mode=e,this.strategy=0,this.windowBits=0,this.write_in_progress=!1,this.pending_close=!1,this.gzip_id_bytes_read=0}u.prototype.close=function(){this.write_in_progress?this.pending_close=!0:(this.pending_close=!1,r(this.init_done,"close before init"),r(this.mode<=t.UNZIP),this.mode===t.DEFLATE||this.mode===t.GZIP||this.mode===t.DEFLATERAW?o.deflateEnd(this.strm):this.mode!==t.INFLATE&&this.mode!==t.GUNZIP&&this.mode!==t.INFLATERAW&&this.mode!==t.UNZIP||s.inflateEnd(this.strm),this.mode=t.NONE,this.dictionary=null)},u.prototype.write=function(e,t,i,n,r,a,o){return this._write(!0,e,t,i,n,r,a,o)},u.prototype.writeSync=function(e,t,i,n,r,a,o){return this._write(!1,e,t,i,n,r,a,o)},u.prototype._write=function(i,a,o,s,c,l,u,h){if(r.equal(arguments.length,8),r(this.init_done,"write before init"),r(this.mode!==t.NONE,"already finalized"),r.equal(!1,this.write_in_progress,"write already in progress"),r.equal(!1,this.pending_close,"close is pending"),this.write_in_progress=!0,r.equal(!1,void 0===a,"must provide flush value"),this.write_in_progress=!0,a!==t.Z_NO_FLUSH&&a!==t.Z_PARTIAL_FLUSH&&a!==t.Z_SYNC_FLUSH&&a!==t.Z_FULL_FLUSH&&a!==t.Z_FINISH&&a!==t.Z_BLOCK)throw new Error("Invalid flush value");if(null==o&&(o=e.alloc(0),c=0,s=0),this.strm.avail_in=c,this.strm.input=o,this.strm.next_in=s,this.strm.avail_out=h,this.strm.output=l,this.strm.next_out=u,this.flush=a,!i)return this._process(),this._checkError()?this._afterSync():void 0;var d=this;return n.nextTick((function(){d._process(),d._after()})),this},u.prototype._afterSync=function(){var e=this.strm.avail_out,t=this.strm.avail_in;return this.write_in_progress=!1,[t,e]},u.prototype._process=function(){var e=null;switch(this.mode){case t.DEFLATE:case t.GZIP:case t.DEFLATERAW:this.err=o.deflate(this.strm,this.flush);break;case t.UNZIP:switch(this.strm.avail_in>0&&(e=this.strm.next_in),this.gzip_id_bytes_read){case 0:if(null===e)break;if(31!==this.strm.input[e]){this.mode=t.INFLATE;break}if(this.gzip_id_bytes_read=1,e++,1===this.strm.avail_in)break;case 1:if(null===e)break;139===this.strm.input[e]?(this.gzip_id_bytes_read=2,this.mode=t.GUNZIP):this.mode=t.INFLATE;break;default:throw new Error("invalid number of gzip magic number bytes read")}case t.INFLATE:case t.GUNZIP:case t.INFLATERAW:for(this.err=s.inflate(this.strm,this.flush),this.err===t.Z_NEED_DICT&&this.dictionary&&(this.err=s.inflateSetDictionary(this.strm,this.dictionary),this.err===t.Z_OK?this.err=s.inflate(this.strm,this.flush):this.err===t.Z_DATA_ERROR&&(this.err=t.Z_NEED_DICT));this.strm.avail_in>0&&this.mode===t.GUNZIP&&this.err===t.Z_STREAM_END&&0!==this.strm.next_in[0];)this.reset(),this.err=s.inflate(this.strm,this.flush);break;default:throw new Error("Unknown mode "+this.mode)}},u.prototype._checkError=function(){switch(this.err){case t.Z_OK:case t.Z_BUF_ERROR:if(0!==this.strm.avail_out&&this.flush===t.Z_FINISH)return this._error("unexpected end of file"),!1;break;case t.Z_STREAM_END:break;case t.Z_NEED_DICT:return null==this.dictionary?this._error("Missing dictionary"):this._error("Bad dictionary"),!1;default:return this._error("Zlib error"),!1}return!0},u.prototype._after=function(){if(this._checkError()){var e=this.strm.avail_out,t=this.strm.avail_in;this.write_in_progress=!1,this.callback(t,e),this.pending_close&&this.close()}},u.prototype._error=function(e){this.strm.msg&&(e=this.strm.msg),this.onerror(e,this.err),this.write_in_progress=!1,this.pending_close&&this.close()},u.prototype.init=function(e,i,n,a,o){r(4===arguments.length||5===arguments.length,"init(windowBits, level, memLevel, strategy, [dictionary])"),r(e>=8&&e<=15,"invalid windowBits"),r(i>=-1&&i<=9,"invalid compression level"),r(n>=1&&n<=9,"invalid memlevel"),r(a===t.Z_FILTERED||a===t.Z_HUFFMAN_ONLY||a===t.Z_RLE||a===t.Z_FIXED||a===t.Z_DEFAULT_STRATEGY,"invalid strategy"),this._init(i,e,n,a,o),this._setDictionary()},u.prototype.params=function(){throw new Error("deflateParams Not supported")},u.prototype.reset=function(){this._reset(),this._setDictionary()},u.prototype._init=function(e,i,n,r,c){switch(this.level=e,this.windowBits=i,this.memLevel=n,this.strategy=r,this.flush=t.Z_NO_FLUSH,this.err=t.Z_OK,this.mode!==t.GZIP&&this.mode!==t.GUNZIP||(this.windowBits+=16),this.mode===t.UNZIP&&(this.windowBits+=32),this.mode!==t.DEFLATERAW&&this.mode!==t.INFLATERAW||(this.windowBits=-1*this.windowBits),this.strm=new a,this.mode){case t.DEFLATE:case t.GZIP:case t.DEFLATERAW:this.err=o.deflateInit2(this.strm,this.level,t.Z_DEFLATED,this.windowBits,this.memLevel,this.strategy);break;case t.INFLATE:case t.GUNZIP:case t.INFLATERAW:case t.UNZIP:this.err=s.inflateInit2(this.strm,this.windowBits);break;default:throw new Error("Unknown mode "+this.mode)}this.err!==t.Z_OK&&this._error("Init error"),this.dictionary=c,this.write_in_progress=!1,this.init_done=!0},u.prototype._setDictionary=function(){if(null!=this.dictionary){switch(this.err=t.Z_OK,this.mode){case t.DEFLATE:case t.DEFLATERAW:this.err=o.deflateSetDictionary(this.strm,this.dictionary)}this.err!==t.Z_OK&&this._error("Failed to set dictionary")}},u.prototype._reset=function(){switch(this.err=t.Z_OK,this.mode){case t.DEFLATE:case t.DEFLATERAW:case t.GZIP:this.err=o.deflateReset(this.strm);break;case t.INFLATE:case t.INFLATERAW:case t.GUNZIP:this.err=s.inflateReset(this.strm)}this.err!==t.Z_OK&&this._error("Failed to reset stream")},t.Zlib=u}).call(this,i(15).Buffer,i(23))},function(e,t,i){"use strict";
/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var n=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable;function o(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},i=0;i<10;i++)t["_"+String.fromCharCode(i)]=i;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var n={};return"abcdefghijklmnopqrst".split("").forEach((function(e){n[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},n)).join("")}catch(e){return!1}}()?Object.assign:function(e,t){for(var i,s,c=o(e),l=1;l<arguments.length;l++){for(var u in i=Object(arguments[l]))r.call(i,u)&&(c[u]=i[u]);if(n){s=n(i);for(var h=0;h<s.length;h++)a.call(i,s[h])&&(c[s[h]]=i[s[h]])}}return c}},function(e,t){e.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},function(e,t){"function"==typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;var i=function(){};i.prototype=t.prototype,e.prototype=new i,e.prototype.constructor=e}},function(e,t,i){"use strict";e.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},function(e,t,i){"use strict";var n,r=i(108),a=i(241),o=i(155),s=i(156),c=i(242),l=0,u=1,h=3,d=4,f=5,p=0,m=1,_=-2,g=-3,v=-5,b=-1,y=1,w=2,O=3,x=4,E=0,T=2,C=8,S=9,A=15,P=8,I=286,D=30,j=19,M=2*I+1,R=15,L=3,N=258,F=N+L+1,k=32,B=42,z=69,U=73,V=91,H=103,G=113,q=666,W=1,Y=2,X=3,Z=4,Q=3;function K(e,t){return e.msg=c[t],t}function J(e){return(e<<1)-(e>4?9:0)}function $(e){for(var t=e.length;--t>=0;)e[t]=0}function ee(e){var t=e.state,i=t.pending;i>e.avail_out&&(i=e.avail_out),0!==i&&(r.arraySet(e.output,t.pending_buf,t.pending_out,i,e.next_out),e.next_out+=i,t.pending_out+=i,e.total_out+=i,e.avail_out-=i,t.pending-=i,0===t.pending&&(t.pending_out=0))}function te(e,t){a._tr_flush_block(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,ee(e.strm)}function ie(e,t){e.pending_buf[e.pending++]=t}function ne(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function re(e,t){var i,n,r=e.max_chain_length,a=e.strstart,o=e.prev_length,s=e.nice_match,c=e.strstart>e.w_size-F?e.strstart-(e.w_size-F):0,l=e.window,u=e.w_mask,h=e.prev,d=e.strstart+N,f=l[a+o-1],p=l[a+o];e.prev_length>=e.good_match&&(r>>=2),s>e.lookahead&&(s=e.lookahead);do{if(l[(i=t)+o]===p&&l[i+o-1]===f&&l[i]===l[a]&&l[++i]===l[a+1]){a+=2,i++;do{}while(l[++a]===l[++i]&&l[++a]===l[++i]&&l[++a]===l[++i]&&l[++a]===l[++i]&&l[++a]===l[++i]&&l[++a]===l[++i]&&l[++a]===l[++i]&&l[++a]===l[++i]&&a<d);if(n=N-(d-a),a=d-N,n>o){if(e.match_start=t,o=n,n>=s)break;f=l[a+o-1],p=l[a+o]}}}while((t=h[t&u])>c&&0!=--r);return o<=e.lookahead?o:e.lookahead}function ae(e){var t,i,n,a,c,l,u,h,d,f,p=e.w_size;do{if(a=e.window_size-e.lookahead-e.strstart,e.strstart>=p+(p-F)){r.arraySet(e.window,e.window,p,p,0),e.match_start-=p,e.strstart-=p,e.block_start-=p,t=i=e.hash_size;do{n=e.head[--t],e.head[t]=n>=p?n-p:0}while(--i);t=i=p;do{n=e.prev[--t],e.prev[t]=n>=p?n-p:0}while(--i);a+=p}if(0===e.strm.avail_in)break;if(l=e.strm,u=e.window,h=e.strstart+e.lookahead,d=a,f=void 0,(f=l.avail_in)>d&&(f=d),i=0===f?0:(l.avail_in-=f,r.arraySet(u,l.input,l.next_in,f,h),1===l.state.wrap?l.adler=o(l.adler,u,f,h):2===l.state.wrap&&(l.adler=s(l.adler,u,f,h)),l.next_in+=f,l.total_in+=f,f),e.lookahead+=i,e.lookahead+e.insert>=L)for(c=e.strstart-e.insert,e.ins_h=e.window[c],e.ins_h=(e.ins_h<<e.hash_shift^e.window[c+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[c+L-1])&e.hash_mask,e.prev[c&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=c,c++,e.insert--,!(e.lookahead+e.insert<L)););}while(e.lookahead<F&&0!==e.strm.avail_in)}function oe(e,t){for(var i,n;;){if(e.lookahead<F){if(ae(e),e.lookahead<F&&t===l)return W;if(0===e.lookahead)break}if(i=0,e.lookahead>=L&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+L-1])&e.hash_mask,i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==i&&e.strstart-i<=e.w_size-F&&(e.match_length=re(e,i)),e.match_length>=L)if(n=a._tr_tally(e,e.strstart-e.match_start,e.match_length-L),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=L){e.match_length--;do{e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+L-1])&e.hash_mask,i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else n=a._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(n&&(te(e,!1),0===e.strm.avail_out))return W}return e.insert=e.strstart<L-1?e.strstart:L-1,t===d?(te(e,!0),0===e.strm.avail_out?X:Z):e.last_lit&&(te(e,!1),0===e.strm.avail_out)?W:Y}function se(e,t){for(var i,n,r;;){if(e.lookahead<F){if(ae(e),e.lookahead<F&&t===l)return W;if(0===e.lookahead)break}if(i=0,e.lookahead>=L&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+L-1])&e.hash_mask,i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=L-1,0!==i&&e.prev_length<e.max_lazy_match&&e.strstart-i<=e.w_size-F&&(e.match_length=re(e,i),e.match_length<=5&&(e.strategy===y||e.match_length===L&&e.strstart-e.match_start>4096)&&(e.match_length=L-1)),e.prev_length>=L&&e.match_length<=e.prev_length){r=e.strstart+e.lookahead-L,n=a._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-L),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=r&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+L-1])&e.hash_mask,i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=L-1,e.strstart++,n&&(te(e,!1),0===e.strm.avail_out))return W}else if(e.match_available){if((n=a._tr_tally(e,0,e.window[e.strstart-1]))&&te(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return W}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(n=a._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<L-1?e.strstart:L-1,t===d?(te(e,!0),0===e.strm.avail_out?X:Z):e.last_lit&&(te(e,!1),0===e.strm.avail_out)?W:Y}function ce(e,t,i,n,r){this.good_length=e,this.max_lazy=t,this.nice_length=i,this.max_chain=n,this.func=r}function le(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=C,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new r.Buf16(2*M),this.dyn_dtree=new r.Buf16(2*(2*D+1)),this.bl_tree=new r.Buf16(2*(2*j+1)),$(this.dyn_ltree),$(this.dyn_dtree),$(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new r.Buf16(R+1),this.heap=new r.Buf16(2*I+1),$(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new r.Buf16(2*I+1),$(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function ue(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=T,(t=e.state).pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?B:G,e.adler=2===t.wrap?0:1,t.last_flush=l,a._tr_init(t),p):K(e,_)}function he(e){var t,i=ue(e);return i===p&&((t=e.state).window_size=2*t.w_size,$(t.head),t.max_lazy_match=n[t.level].max_lazy,t.good_match=n[t.level].good_length,t.nice_match=n[t.level].nice_length,t.max_chain_length=n[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=L-1,t.match_available=0,t.ins_h=0),i}function de(e,t,i,n,a,o){if(!e)return _;var s=1;if(t===b&&(t=6),n<0?(s=0,n=-n):n>15&&(s=2,n-=16),a<1||a>S||i!==C||n<8||n>15||t<0||t>9||o<0||o>x)return K(e,_);8===n&&(n=9);var c=new le;return e.state=c,c.strm=e,c.wrap=s,c.gzhead=null,c.w_bits=n,c.w_size=1<<c.w_bits,c.w_mask=c.w_size-1,c.hash_bits=a+7,c.hash_size=1<<c.hash_bits,c.hash_mask=c.hash_size-1,c.hash_shift=~~((c.hash_bits+L-1)/L),c.window=new r.Buf8(2*c.w_size),c.head=new r.Buf16(c.hash_size),c.prev=new r.Buf16(c.w_size),c.lit_bufsize=1<<a+6,c.pending_buf_size=4*c.lit_bufsize,c.pending_buf=new r.Buf8(c.pending_buf_size),c.d_buf=1*c.lit_bufsize,c.l_buf=3*c.lit_bufsize,c.level=t,c.strategy=o,c.method=i,he(e)}n=[new ce(0,0,0,0,(function(e,t){var i=65535;for(i>e.pending_buf_size-5&&(i=e.pending_buf_size-5);;){if(e.lookahead<=1){if(ae(e),0===e.lookahead&&t===l)return W;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var n=e.block_start+i;if((0===e.strstart||e.strstart>=n)&&(e.lookahead=e.strstart-n,e.strstart=n,te(e,!1),0===e.strm.avail_out))return W;if(e.strstart-e.block_start>=e.w_size-F&&(te(e,!1),0===e.strm.avail_out))return W}return e.insert=0,t===d?(te(e,!0),0===e.strm.avail_out?X:Z):(e.strstart>e.block_start&&(te(e,!1),e.strm.avail_out),W)})),new ce(4,4,8,4,oe),new ce(4,5,16,8,oe),new ce(4,6,32,32,oe),new ce(4,4,16,16,se),new ce(8,16,32,32,se),new ce(8,16,128,128,se),new ce(8,32,128,256,se),new ce(32,128,258,1024,se),new ce(32,258,258,4096,se)],t.deflateInit=function(e,t){return de(e,t,C,A,P,E)},t.deflateInit2=de,t.deflateReset=he,t.deflateResetKeep=ue,t.deflateSetHeader=function(e,t){return e&&e.state?2!==e.state.wrap?_:(e.state.gzhead=t,p):_},t.deflate=function(e,t){var i,r,o,c;if(!e||!e.state||t>f||t<0)return e?K(e,_):_;if(r=e.state,!e.output||!e.input&&0!==e.avail_in||r.status===q&&t!==d)return K(e,0===e.avail_out?v:_);if(r.strm=e,i=r.last_flush,r.last_flush=t,r.status===B)if(2===r.wrap)e.adler=0,ie(r,31),ie(r,139),ie(r,8),r.gzhead?(ie(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),ie(r,255&r.gzhead.time),ie(r,r.gzhead.time>>8&255),ie(r,r.gzhead.time>>16&255),ie(r,r.gzhead.time>>24&255),ie(r,9===r.level?2:r.strategy>=w||r.level<2?4:0),ie(r,255&r.gzhead.os),r.gzhead.extra&&r.gzhead.extra.length&&(ie(r,255&r.gzhead.extra.length),ie(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(e.adler=s(e.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=z):(ie(r,0),ie(r,0),ie(r,0),ie(r,0),ie(r,0),ie(r,9===r.level?2:r.strategy>=w||r.level<2?4:0),ie(r,Q),r.status=G);else{var g=C+(r.w_bits-8<<4)<<8;g|=(r.strategy>=w||r.level<2?0:r.level<6?1:6===r.level?2:3)<<6,0!==r.strstart&&(g|=k),g+=31-g%31,r.status=G,ne(r,g),0!==r.strstart&&(ne(r,e.adler>>>16),ne(r,65535&e.adler)),e.adler=1}if(r.status===z)if(r.gzhead.extra){for(o=r.pending;r.gzindex<(65535&r.gzhead.extra.length)&&(r.pending!==r.pending_buf_size||(r.gzhead.hcrc&&r.pending>o&&(e.adler=s(e.adler,r.pending_buf,r.pending-o,o)),ee(e),o=r.pending,r.pending!==r.pending_buf_size));)ie(r,255&r.gzhead.extra[r.gzindex]),r.gzindex++;r.gzhead.hcrc&&r.pending>o&&(e.adler=s(e.adler,r.pending_buf,r.pending-o,o)),r.gzindex===r.gzhead.extra.length&&(r.gzindex=0,r.status=U)}else r.status=U;if(r.status===U)if(r.gzhead.name){o=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>o&&(e.adler=s(e.adler,r.pending_buf,r.pending-o,o)),ee(e),o=r.pending,r.pending===r.pending_buf_size)){c=1;break}c=r.gzindex<r.gzhead.name.length?255&r.gzhead.name.charCodeAt(r.gzindex++):0,ie(r,c)}while(0!==c);r.gzhead.hcrc&&r.pending>o&&(e.adler=s(e.adler,r.pending_buf,r.pending-o,o)),0===c&&(r.gzindex=0,r.status=V)}else r.status=V;if(r.status===V)if(r.gzhead.comment){o=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>o&&(e.adler=s(e.adler,r.pending_buf,r.pending-o,o)),ee(e),o=r.pending,r.pending===r.pending_buf_size)){c=1;break}c=r.gzindex<r.gzhead.comment.length?255&r.gzhead.comment.charCodeAt(r.gzindex++):0,ie(r,c)}while(0!==c);r.gzhead.hcrc&&r.pending>o&&(e.adler=s(e.adler,r.pending_buf,r.pending-o,o)),0===c&&(r.status=H)}else r.status=H;if(r.status===H&&(r.gzhead.hcrc?(r.pending+2>r.pending_buf_size&&ee(e),r.pending+2<=r.pending_buf_size&&(ie(r,255&e.adler),ie(r,e.adler>>8&255),e.adler=0,r.status=G)):r.status=G),0!==r.pending){if(ee(e),0===e.avail_out)return r.last_flush=-1,p}else if(0===e.avail_in&&J(t)<=J(i)&&t!==d)return K(e,v);if(r.status===q&&0!==e.avail_in)return K(e,v);if(0!==e.avail_in||0!==r.lookahead||t!==l&&r.status!==q){var b=r.strategy===w?function(e,t){for(var i;;){if(0===e.lookahead&&(ae(e),0===e.lookahead)){if(t===l)return W;break}if(e.match_length=0,i=a._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,i&&(te(e,!1),0===e.strm.avail_out))return W}return e.insert=0,t===d?(te(e,!0),0===e.strm.avail_out?X:Z):e.last_lit&&(te(e,!1),0===e.strm.avail_out)?W:Y}(r,t):r.strategy===O?function(e,t){for(var i,n,r,o,s=e.window;;){if(e.lookahead<=N){if(ae(e),e.lookahead<=N&&t===l)return W;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=L&&e.strstart>0&&(n=s[r=e.strstart-1])===s[++r]&&n===s[++r]&&n===s[++r]){o=e.strstart+N;do{}while(n===s[++r]&&n===s[++r]&&n===s[++r]&&n===s[++r]&&n===s[++r]&&n===s[++r]&&n===s[++r]&&n===s[++r]&&r<o);e.match_length=N-(o-r),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=L?(i=a._tr_tally(e,1,e.match_length-L),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(i=a._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),i&&(te(e,!1),0===e.strm.avail_out))return W}return e.insert=0,t===d?(te(e,!0),0===e.strm.avail_out?X:Z):e.last_lit&&(te(e,!1),0===e.strm.avail_out)?W:Y}(r,t):n[r.level].func(r,t);if(b!==X&&b!==Z||(r.status=q),b===W||b===X)return 0===e.avail_out&&(r.last_flush=-1),p;if(b===Y&&(t===u?a._tr_align(r):t!==f&&(a._tr_stored_block(r,0,0,!1),t===h&&($(r.head),0===r.lookahead&&(r.strstart=0,r.block_start=0,r.insert=0))),ee(e),0===e.avail_out))return r.last_flush=-1,p}return t!==d?p:r.wrap<=0?m:(2===r.wrap?(ie(r,255&e.adler),ie(r,e.adler>>8&255),ie(r,e.adler>>16&255),ie(r,e.adler>>24&255),ie(r,255&e.total_in),ie(r,e.total_in>>8&255),ie(r,e.total_in>>16&255),ie(r,e.total_in>>24&255)):(ne(r,e.adler>>>16),ne(r,65535&e.adler)),ee(e),r.wrap>0&&(r.wrap=-r.wrap),0!==r.pending?p:m)},t.deflateEnd=function(e){var t;return e&&e.state?(t=e.state.status)!==B&&t!==z&&t!==U&&t!==V&&t!==H&&t!==G&&t!==q?K(e,_):(e.state=null,t===G?K(e,g):p):_},t.deflateSetDictionary=function(e,t){var i,n,a,s,c,l,u,h,d=t.length;if(!e||!e.state)return _;if(2===(s=(i=e.state).wrap)||1===s&&i.status!==B||i.lookahead)return _;for(1===s&&(e.adler=o(e.adler,t,d,0)),i.wrap=0,d>=i.w_size&&(0===s&&($(i.head),i.strstart=0,i.block_start=0,i.insert=0),h=new r.Buf8(i.w_size),r.arraySet(h,t,d-i.w_size,i.w_size,0),t=h,d=i.w_size),c=e.avail_in,l=e.next_in,u=e.input,e.avail_in=d,e.next_in=0,e.input=t,ae(i);i.lookahead>=L;){n=i.strstart,a=i.lookahead-(L-1);do{i.ins_h=(i.ins_h<<i.hash_shift^i.window[n+L-1])&i.hash_mask,i.prev[n&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=n,n++}while(--a);i.strstart=n,i.lookahead=L-1,ae(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=L-1,i.match_available=0,e.next_in=l,e.input=u,e.avail_in=c,i.wrap=s,p},t.deflateInfo="pako deflate (from Nodeca project)"},function(e,t,i){"use strict";var n=i(108),r=4,a=0,o=1,s=2;function c(e){for(var t=e.length;--t>=0;)e[t]=0}var l=0,u=1,h=2,d=29,f=256,p=f+1+d,m=30,_=19,g=2*p+1,v=15,b=16,y=7,w=256,O=16,x=17,E=18,T=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],C=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],S=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],A=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],P=new Array(2*(p+2));c(P);var I=new Array(2*m);c(I);var D=new Array(512);c(D);var j=new Array(256);c(j);var M=new Array(d);c(M);var R,L,N,F=new Array(m);function k(e,t,i,n,r){this.static_tree=e,this.extra_bits=t,this.extra_base=i,this.elems=n,this.max_length=r,this.has_stree=e&&e.length}function B(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function z(e){return e<256?D[e]:D[256+(e>>>7)]}function U(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function V(e,t,i){e.bi_valid>b-i?(e.bi_buf|=t<<e.bi_valid&65535,U(e,e.bi_buf),e.bi_buf=t>>b-e.bi_valid,e.bi_valid+=i-b):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=i)}function H(e,t,i){V(e,i[2*t],i[2*t+1])}function G(e,t){var i=0;do{i|=1&e,e>>>=1,i<<=1}while(--t>0);return i>>>1}function q(e,t,i){var n,r,a=new Array(v+1),o=0;for(n=1;n<=v;n++)a[n]=o=o+i[n-1]<<1;for(r=0;r<=t;r++){var s=e[2*r+1];0!==s&&(e[2*r]=G(a[s]++,s))}}function W(e){var t;for(t=0;t<p;t++)e.dyn_ltree[2*t]=0;for(t=0;t<m;t++)e.dyn_dtree[2*t]=0;for(t=0;t<_;t++)e.bl_tree[2*t]=0;e.dyn_ltree[2*w]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function Y(e){e.bi_valid>8?U(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function X(e,t,i,n){var r=2*t,a=2*i;return e[r]<e[a]||e[r]===e[a]&&n[t]<=n[i]}function Z(e,t,i){for(var n=e.heap[i],r=i<<1;r<=e.heap_len&&(r<e.heap_len&&X(t,e.heap[r+1],e.heap[r],e.depth)&&r++,!X(t,n,e.heap[r],e.depth));)e.heap[i]=e.heap[r],i=r,r<<=1;e.heap[i]=n}function Q(e,t,i){var n,r,a,o,s=0;if(0!==e.last_lit)do{n=e.pending_buf[e.d_buf+2*s]<<8|e.pending_buf[e.d_buf+2*s+1],r=e.pending_buf[e.l_buf+s],s++,0===n?H(e,r,t):(H(e,(a=j[r])+f+1,t),0!==(o=T[a])&&V(e,r-=M[a],o),H(e,a=z(--n),i),0!==(o=C[a])&&V(e,n-=F[a],o))}while(s<e.last_lit);H(e,w,t)}function K(e,t){var i,n,r,a=t.dyn_tree,o=t.stat_desc.static_tree,s=t.stat_desc.has_stree,c=t.stat_desc.elems,l=-1;for(e.heap_len=0,e.heap_max=g,i=0;i<c;i++)0!==a[2*i]?(e.heap[++e.heap_len]=l=i,e.depth[i]=0):a[2*i+1]=0;for(;e.heap_len<2;)a[2*(r=e.heap[++e.heap_len]=l<2?++l:0)]=1,e.depth[r]=0,e.opt_len--,s&&(e.static_len-=o[2*r+1]);for(t.max_code=l,i=e.heap_len>>1;i>=1;i--)Z(e,a,i);r=c;do{i=e.heap[1],e.heap[1]=e.heap[e.heap_len--],Z(e,a,1),n=e.heap[1],e.heap[--e.heap_max]=i,e.heap[--e.heap_max]=n,a[2*r]=a[2*i]+a[2*n],e.depth[r]=(e.depth[i]>=e.depth[n]?e.depth[i]:e.depth[n])+1,a[2*i+1]=a[2*n+1]=r,e.heap[1]=r++,Z(e,a,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],function(e,t){var i,n,r,a,o,s,c=t.dyn_tree,l=t.max_code,u=t.stat_desc.static_tree,h=t.stat_desc.has_stree,d=t.stat_desc.extra_bits,f=t.stat_desc.extra_base,p=t.stat_desc.max_length,m=0;for(a=0;a<=v;a++)e.bl_count[a]=0;for(c[2*e.heap[e.heap_max]+1]=0,i=e.heap_max+1;i<g;i++)(a=c[2*c[2*(n=e.heap[i])+1]+1]+1)>p&&(a=p,m++),c[2*n+1]=a,n>l||(e.bl_count[a]++,o=0,n>=f&&(o=d[n-f]),s=c[2*n],e.opt_len+=s*(a+o),h&&(e.static_len+=s*(u[2*n+1]+o)));if(0!==m){do{for(a=p-1;0===e.bl_count[a];)a--;e.bl_count[a]--,e.bl_count[a+1]+=2,e.bl_count[p]--,m-=2}while(m>0);for(a=p;0!==a;a--)for(n=e.bl_count[a];0!==n;)(r=e.heap[--i])>l||(c[2*r+1]!==a&&(e.opt_len+=(a-c[2*r+1])*c[2*r],c[2*r+1]=a),n--)}}(e,t),q(a,l,e.bl_count)}function J(e,t,i){var n,r,a=-1,o=t[1],s=0,c=7,l=4;for(0===o&&(c=138,l=3),t[2*(i+1)+1]=65535,n=0;n<=i;n++)r=o,o=t[2*(n+1)+1],++s<c&&r===o||(s<l?e.bl_tree[2*r]+=s:0!==r?(r!==a&&e.bl_tree[2*r]++,e.bl_tree[2*O]++):s<=10?e.bl_tree[2*x]++:e.bl_tree[2*E]++,s=0,a=r,0===o?(c=138,l=3):r===o?(c=6,l=3):(c=7,l=4))}function $(e,t,i){var n,r,a=-1,o=t[1],s=0,c=7,l=4;for(0===o&&(c=138,l=3),n=0;n<=i;n++)if(r=o,o=t[2*(n+1)+1],!(++s<c&&r===o)){if(s<l)do{H(e,r,e.bl_tree)}while(0!=--s);else 0!==r?(r!==a&&(H(e,r,e.bl_tree),s--),H(e,O,e.bl_tree),V(e,s-3,2)):s<=10?(H(e,x,e.bl_tree),V(e,s-3,3)):(H(e,E,e.bl_tree),V(e,s-11,7));s=0,a=r,0===o?(c=138,l=3):r===o?(c=6,l=3):(c=7,l=4)}}c(F);var ee=!1;function te(e,t,i,r){V(e,(l<<1)+(r?1:0),3),function(e,t,i,r){Y(e),r&&(U(e,i),U(e,~i)),n.arraySet(e.pending_buf,e.window,t,i,e.pending),e.pending+=i}(e,t,i,!0)}t._tr_init=function(e){ee||(!function(){var e,t,i,n,r,a=new Array(v+1);for(i=0,n=0;n<d-1;n++)for(M[n]=i,e=0;e<1<<T[n];e++)j[i++]=n;for(j[i-1]=n,r=0,n=0;n<16;n++)for(F[n]=r,e=0;e<1<<C[n];e++)D[r++]=n;for(r>>=7;n<m;n++)for(F[n]=r<<7,e=0;e<1<<C[n]-7;e++)D[256+r++]=n;for(t=0;t<=v;t++)a[t]=0;for(e=0;e<=143;)P[2*e+1]=8,e++,a[8]++;for(;e<=255;)P[2*e+1]=9,e++,a[9]++;for(;e<=279;)P[2*e+1]=7,e++,a[7]++;for(;e<=287;)P[2*e+1]=8,e++,a[8]++;for(q(P,p+1,a),e=0;e<m;e++)I[2*e+1]=5,I[2*e]=G(e,5);R=new k(P,T,f+1,p,v),L=new k(I,C,0,m,v),N=new k(new Array(0),S,0,_,y)}(),ee=!0),e.l_desc=new B(e.dyn_ltree,R),e.d_desc=new B(e.dyn_dtree,L),e.bl_desc=new B(e.bl_tree,N),e.bi_buf=0,e.bi_valid=0,W(e)},t._tr_stored_block=te,t._tr_flush_block=function(e,t,i,n){var c,l,d=0;e.level>0?(e.strm.data_type===s&&(e.strm.data_type=function(e){var t,i=4093624447;for(t=0;t<=31;t++,i>>>=1)if(1&i&&0!==e.dyn_ltree[2*t])return a;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return o;for(t=32;t<f;t++)if(0!==e.dyn_ltree[2*t])return o;return a}(e)),K(e,e.l_desc),K(e,e.d_desc),d=function(e){var t;for(J(e,e.dyn_ltree,e.l_desc.max_code),J(e,e.dyn_dtree,e.d_desc.max_code),K(e,e.bl_desc),t=_-1;t>=3&&0===e.bl_tree[2*A[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),c=e.opt_len+3+7>>>3,(l=e.static_len+3+7>>>3)<=c&&(c=l)):c=l=i+5,i+4<=c&&-1!==t?te(e,t,i,n):e.strategy===r||l===c?(V(e,(u<<1)+(n?1:0),3),Q(e,P,I)):(V(e,(h<<1)+(n?1:0),3),function(e,t,i,n){var r;for(V(e,t-257,5),V(e,i-1,5),V(e,n-4,4),r=0;r<n;r++)V(e,e.bl_tree[2*A[r]+1],3);$(e,e.dyn_ltree,t-1),$(e,e.dyn_dtree,i-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,d+1),Q(e,e.dyn_ltree,e.dyn_dtree)),W(e),n&&Y(e)},t._tr_tally=function(e,t,i){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&i,e.last_lit++,0===t?e.dyn_ltree[2*i]++:(e.matches++,t--,e.dyn_ltree[2*(j[i]+f+1)]++,e.dyn_dtree[2*z(t)]++),e.last_lit===e.lit_bufsize-1},t._tr_align=function(e){V(e,u<<1,3),H(e,w,P),function(e){16===e.bi_valid?(U(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}(e)}},function(e,t,i){"use strict";e.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},function(e,t,i){"use strict";var n=i(108),r=i(155),a=i(156),o=i(244),s=i(245),c=0,l=1,u=2,h=4,d=5,f=6,p=0,m=1,_=2,g=-2,v=-3,b=-4,y=-5,w=8,O=1,x=2,E=3,T=4,C=5,S=6,A=7,P=8,I=9,D=10,j=11,M=12,R=13,L=14,N=15,F=16,k=17,B=18,z=19,U=20,V=21,H=22,G=23,q=24,W=25,Y=26,X=27,Z=28,Q=29,K=30,J=31,$=32,ee=852,te=592,ie=15;function ne(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function re(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new n.Buf16(320),this.work=new n.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function ae(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=O,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new n.Buf32(ee),t.distcode=t.distdyn=new n.Buf32(te),t.sane=1,t.back=-1,p):g}function oe(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,ae(e)):g}function se(e,t){var i,n;return e&&e.state?(n=e.state,t<0?(i=0,t=-t):(i=1+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?g:(null!==n.window&&n.wbits!==t&&(n.window=null),n.wrap=i,n.wbits=t,oe(e))):g}function ce(e,t){var i,n;return e?(n=new re,e.state=n,n.window=null,(i=se(e,t))!==p&&(e.state=null),i):g}var le,ue,he=!0;function de(e){if(he){var t;for(le=new n.Buf32(512),ue=new n.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(s(l,e.lens,0,288,le,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;s(u,e.lens,0,32,ue,0,e.work,{bits:5}),he=!1}e.lencode=le,e.lenbits=9,e.distcode=ue,e.distbits=5}function fe(e,t,i,r){var a,o=e.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new n.Buf8(o.wsize)),r>=o.wsize?(n.arraySet(o.window,t,i-o.wsize,o.wsize,0),o.wnext=0,o.whave=o.wsize):((a=o.wsize-o.wnext)>r&&(a=r),n.arraySet(o.window,t,i-r,a,o.wnext),(r-=a)?(n.arraySet(o.window,t,i-r,r,0),o.wnext=r,o.whave=o.wsize):(o.wnext+=a,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=a))),0}t.inflateReset=oe,t.inflateReset2=se,t.inflateResetKeep=ae,t.inflateInit=function(e){return ce(e,ie)},t.inflateInit2=ce,t.inflate=function(e,t){var i,ee,te,ie,re,ae,oe,se,ce,le,ue,he,pe,me,_e,ge,ve,be,ye,we,Oe,xe,Ee,Te,Ce=0,Se=new n.Buf8(4),Ae=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return g;(i=e.state).mode===M&&(i.mode=R),re=e.next_out,te=e.output,oe=e.avail_out,ie=e.next_in,ee=e.input,ae=e.avail_in,se=i.hold,ce=i.bits,le=ae,ue=oe,xe=p;e:for(;;)switch(i.mode){case O:if(0===i.wrap){i.mode=R;break}for(;ce<16;){if(0===ae)break e;ae--,se+=ee[ie++]<<ce,ce+=8}if(2&i.wrap&&35615===se){i.check=0,Se[0]=255&se,Se[1]=se>>>8&255,i.check=a(i.check,Se,2,0),se=0,ce=0,i.mode=x;break}if(i.flags=0,i.head&&(i.head.done=!1),!(1&i.wrap)||(((255&se)<<8)+(se>>8))%31){e.msg="incorrect header check",i.mode=K;break}if((15&se)!==w){e.msg="unknown compression method",i.mode=K;break}if(ce-=4,Oe=8+(15&(se>>>=4)),0===i.wbits)i.wbits=Oe;else if(Oe>i.wbits){e.msg="invalid window size",i.mode=K;break}i.dmax=1<<Oe,e.adler=i.check=1,i.mode=512&se?D:M,se=0,ce=0;break;case x:for(;ce<16;){if(0===ae)break e;ae--,se+=ee[ie++]<<ce,ce+=8}if(i.flags=se,(255&i.flags)!==w){e.msg="unknown compression method",i.mode=K;break}if(57344&i.flags){e.msg="unknown header flags set",i.mode=K;break}i.head&&(i.head.text=se>>8&1),512&i.flags&&(Se[0]=255&se,Se[1]=se>>>8&255,i.check=a(i.check,Se,2,0)),se=0,ce=0,i.mode=E;case E:for(;ce<32;){if(0===ae)break e;ae--,se+=ee[ie++]<<ce,ce+=8}i.head&&(i.head.time=se),512&i.flags&&(Se[0]=255&se,Se[1]=se>>>8&255,Se[2]=se>>>16&255,Se[3]=se>>>24&255,i.check=a(i.check,Se,4,0)),se=0,ce=0,i.mode=T;case T:for(;ce<16;){if(0===ae)break e;ae--,se+=ee[ie++]<<ce,ce+=8}i.head&&(i.head.xflags=255&se,i.head.os=se>>8),512&i.flags&&(Se[0]=255&se,Se[1]=se>>>8&255,i.check=a(i.check,Se,2,0)),se=0,ce=0,i.mode=C;case C:if(1024&i.flags){for(;ce<16;){if(0===ae)break e;ae--,se+=ee[ie++]<<ce,ce+=8}i.length=se,i.head&&(i.head.extra_len=se),512&i.flags&&(Se[0]=255&se,Se[1]=se>>>8&255,i.check=a(i.check,Se,2,0)),se=0,ce=0}else i.head&&(i.head.extra=null);i.mode=S;case S:if(1024&i.flags&&((he=i.length)>ae&&(he=ae),he&&(i.head&&(Oe=i.head.extra_len-i.length,i.head.extra||(i.head.extra=new Array(i.head.extra_len)),n.arraySet(i.head.extra,ee,ie,he,Oe)),512&i.flags&&(i.check=a(i.check,ee,he,ie)),ae-=he,ie+=he,i.length-=he),i.length))break e;i.length=0,i.mode=A;case A:if(2048&i.flags){if(0===ae)break e;he=0;do{Oe=ee[ie+he++],i.head&&Oe&&i.length<65536&&(i.head.name+=String.fromCharCode(Oe))}while(Oe&&he<ae);if(512&i.flags&&(i.check=a(i.check,ee,he,ie)),ae-=he,ie+=he,Oe)break e}else i.head&&(i.head.name=null);i.length=0,i.mode=P;case P:if(4096&i.flags){if(0===ae)break e;he=0;do{Oe=ee[ie+he++],i.head&&Oe&&i.length<65536&&(i.head.comment+=String.fromCharCode(Oe))}while(Oe&&he<ae);if(512&i.flags&&(i.check=a(i.check,ee,he,ie)),ae-=he,ie+=he,Oe)break e}else i.head&&(i.head.comment=null);i.mode=I;case I:if(512&i.flags){for(;ce<16;){if(0===ae)break e;ae--,se+=ee[ie++]<<ce,ce+=8}if(se!==(65535&i.check)){e.msg="header crc mismatch",i.mode=K;break}se=0,ce=0}i.head&&(i.head.hcrc=i.flags>>9&1,i.head.done=!0),e.adler=i.check=0,i.mode=M;break;case D:for(;ce<32;){if(0===ae)break e;ae--,se+=ee[ie++]<<ce,ce+=8}e.adler=i.check=ne(se),se=0,ce=0,i.mode=j;case j:if(0===i.havedict)return e.next_out=re,e.avail_out=oe,e.next_in=ie,e.avail_in=ae,i.hold=se,i.bits=ce,_;e.adler=i.check=1,i.mode=M;case M:if(t===d||t===f)break e;case R:if(i.last){se>>>=7&ce,ce-=7&ce,i.mode=X;break}for(;ce<3;){if(0===ae)break e;ae--,se+=ee[ie++]<<ce,ce+=8}switch(i.last=1&se,ce-=1,3&(se>>>=1)){case 0:i.mode=L;break;case 1:if(de(i),i.mode=U,t===f){se>>>=2,ce-=2;break e}break;case 2:i.mode=k;break;case 3:e.msg="invalid block type",i.mode=K}se>>>=2,ce-=2;break;case L:for(se>>>=7&ce,ce-=7&ce;ce<32;){if(0===ae)break e;ae--,se+=ee[ie++]<<ce,ce+=8}if((65535&se)!=(se>>>16^65535)){e.msg="invalid stored block lengths",i.mode=K;break}if(i.length=65535&se,se=0,ce=0,i.mode=N,t===f)break e;case N:i.mode=F;case F:if(he=i.length){if(he>ae&&(he=ae),he>oe&&(he=oe),0===he)break e;n.arraySet(te,ee,ie,he,re),ae-=he,ie+=he,oe-=he,re+=he,i.length-=he;break}i.mode=M;break;case k:for(;ce<14;){if(0===ae)break e;ae--,se+=ee[ie++]<<ce,ce+=8}if(i.nlen=257+(31&se),se>>>=5,ce-=5,i.ndist=1+(31&se),se>>>=5,ce-=5,i.ncode=4+(15&se),se>>>=4,ce-=4,i.nlen>286||i.ndist>30){e.msg="too many length or distance symbols",i.mode=K;break}i.have=0,i.mode=B;case B:for(;i.have<i.ncode;){for(;ce<3;){if(0===ae)break e;ae--,se+=ee[ie++]<<ce,ce+=8}i.lens[Ae[i.have++]]=7&se,se>>>=3,ce-=3}for(;i.have<19;)i.lens[Ae[i.have++]]=0;if(i.lencode=i.lendyn,i.lenbits=7,Ee={bits:i.lenbits},xe=s(c,i.lens,0,19,i.lencode,0,i.work,Ee),i.lenbits=Ee.bits,xe){e.msg="invalid code lengths set",i.mode=K;break}i.have=0,i.mode=z;case z:for(;i.have<i.nlen+i.ndist;){for(;ge=(Ce=i.lencode[se&(1<<i.lenbits)-1])>>>16&255,ve=65535&Ce,!((_e=Ce>>>24)<=ce);){if(0===ae)break e;ae--,se+=ee[ie++]<<ce,ce+=8}if(ve<16)se>>>=_e,ce-=_e,i.lens[i.have++]=ve;else{if(16===ve){for(Te=_e+2;ce<Te;){if(0===ae)break e;ae--,se+=ee[ie++]<<ce,ce+=8}if(se>>>=_e,ce-=_e,0===i.have){e.msg="invalid bit length repeat",i.mode=K;break}Oe=i.lens[i.have-1],he=3+(3&se),se>>>=2,ce-=2}else if(17===ve){for(Te=_e+3;ce<Te;){if(0===ae)break e;ae--,se+=ee[ie++]<<ce,ce+=8}ce-=_e,Oe=0,he=3+(7&(se>>>=_e)),se>>>=3,ce-=3}else{for(Te=_e+7;ce<Te;){if(0===ae)break e;ae--,se+=ee[ie++]<<ce,ce+=8}ce-=_e,Oe=0,he=11+(127&(se>>>=_e)),se>>>=7,ce-=7}if(i.have+he>i.nlen+i.ndist){e.msg="invalid bit length repeat",i.mode=K;break}for(;he--;)i.lens[i.have++]=Oe}}if(i.mode===K)break;if(0===i.lens[256]){e.msg="invalid code -- missing end-of-block",i.mode=K;break}if(i.lenbits=9,Ee={bits:i.lenbits},xe=s(l,i.lens,0,i.nlen,i.lencode,0,i.work,Ee),i.lenbits=Ee.bits,xe){e.msg="invalid literal/lengths set",i.mode=K;break}if(i.distbits=6,i.distcode=i.distdyn,Ee={bits:i.distbits},xe=s(u,i.lens,i.nlen,i.ndist,i.distcode,0,i.work,Ee),i.distbits=Ee.bits,xe){e.msg="invalid distances set",i.mode=K;break}if(i.mode=U,t===f)break e;case U:i.mode=V;case V:if(ae>=6&&oe>=258){e.next_out=re,e.avail_out=oe,e.next_in=ie,e.avail_in=ae,i.hold=se,i.bits=ce,o(e,ue),re=e.next_out,te=e.output,oe=e.avail_out,ie=e.next_in,ee=e.input,ae=e.avail_in,se=i.hold,ce=i.bits,i.mode===M&&(i.back=-1);break}for(i.back=0;ge=(Ce=i.lencode[se&(1<<i.lenbits)-1])>>>16&255,ve=65535&Ce,!((_e=Ce>>>24)<=ce);){if(0===ae)break e;ae--,se+=ee[ie++]<<ce,ce+=8}if(ge&&0==(240&ge)){for(be=_e,ye=ge,we=ve;ge=(Ce=i.lencode[we+((se&(1<<be+ye)-1)>>be)])>>>16&255,ve=65535&Ce,!(be+(_e=Ce>>>24)<=ce);){if(0===ae)break e;ae--,se+=ee[ie++]<<ce,ce+=8}se>>>=be,ce-=be,i.back+=be}if(se>>>=_e,ce-=_e,i.back+=_e,i.length=ve,0===ge){i.mode=Y;break}if(32&ge){i.back=-1,i.mode=M;break}if(64&ge){e.msg="invalid literal/length code",i.mode=K;break}i.extra=15&ge,i.mode=H;case H:if(i.extra){for(Te=i.extra;ce<Te;){if(0===ae)break e;ae--,se+=ee[ie++]<<ce,ce+=8}i.length+=se&(1<<i.extra)-1,se>>>=i.extra,ce-=i.extra,i.back+=i.extra}i.was=i.length,i.mode=G;case G:for(;ge=(Ce=i.distcode[se&(1<<i.distbits)-1])>>>16&255,ve=65535&Ce,!((_e=Ce>>>24)<=ce);){if(0===ae)break e;ae--,se+=ee[ie++]<<ce,ce+=8}if(0==(240&ge)){for(be=_e,ye=ge,we=ve;ge=(Ce=i.distcode[we+((se&(1<<be+ye)-1)>>be)])>>>16&255,ve=65535&Ce,!(be+(_e=Ce>>>24)<=ce);){if(0===ae)break e;ae--,se+=ee[ie++]<<ce,ce+=8}se>>>=be,ce-=be,i.back+=be}if(se>>>=_e,ce-=_e,i.back+=_e,64&ge){e.msg="invalid distance code",i.mode=K;break}i.offset=ve,i.extra=15&ge,i.mode=q;case q:if(i.extra){for(Te=i.extra;ce<Te;){if(0===ae)break e;ae--,se+=ee[ie++]<<ce,ce+=8}i.offset+=se&(1<<i.extra)-1,se>>>=i.extra,ce-=i.extra,i.back+=i.extra}if(i.offset>i.dmax){e.msg="invalid distance too far back",i.mode=K;break}i.mode=W;case W:if(0===oe)break e;if(he=ue-oe,i.offset>he){if((he=i.offset-he)>i.whave&&i.sane){e.msg="invalid distance too far back",i.mode=K;break}he>i.wnext?(he-=i.wnext,pe=i.wsize-he):pe=i.wnext-he,he>i.length&&(he=i.length),me=i.window}else me=te,pe=re-i.offset,he=i.length;he>oe&&(he=oe),oe-=he,i.length-=he;do{te[re++]=me[pe++]}while(--he);0===i.length&&(i.mode=V);break;case Y:if(0===oe)break e;te[re++]=i.length,oe--,i.mode=V;break;case X:if(i.wrap){for(;ce<32;){if(0===ae)break e;ae--,se|=ee[ie++]<<ce,ce+=8}if(ue-=oe,e.total_out+=ue,i.total+=ue,ue&&(e.adler=i.check=i.flags?a(i.check,te,ue,re-ue):r(i.check,te,ue,re-ue)),ue=oe,(i.flags?se:ne(se))!==i.check){e.msg="incorrect data check",i.mode=K;break}se=0,ce=0}i.mode=Z;case Z:if(i.wrap&&i.flags){for(;ce<32;){if(0===ae)break e;ae--,se+=ee[ie++]<<ce,ce+=8}if(se!==(4294967295&i.total)){e.msg="incorrect length check",i.mode=K;break}se=0,ce=0}i.mode=Q;case Q:xe=m;break e;case K:xe=v;break e;case J:return b;case $:default:return g}return e.next_out=re,e.avail_out=oe,e.next_in=ie,e.avail_in=ae,i.hold=se,i.bits=ce,(i.wsize||ue!==e.avail_out&&i.mode<K&&(i.mode<X||t!==h))&&fe(e,e.output,e.next_out,ue-e.avail_out)?(i.mode=J,b):(le-=e.avail_in,ue-=e.avail_out,e.total_in+=le,e.total_out+=ue,i.total+=ue,i.wrap&&ue&&(e.adler=i.check=i.flags?a(i.check,te,ue,e.next_out-ue):r(i.check,te,ue,e.next_out-ue)),e.data_type=i.bits+(i.last?64:0)+(i.mode===M?128:0)+(i.mode===U||i.mode===N?256:0),(0===le&&0===ue||t===h)&&xe===p&&(xe=y),xe)},t.inflateEnd=function(e){if(!e||!e.state)return g;var t=e.state;return t.window&&(t.window=null),e.state=null,p},t.inflateGetHeader=function(e,t){var i;return e&&e.state?0==(2&(i=e.state).wrap)?g:(i.head=t,t.done=!1,p):g},t.inflateSetDictionary=function(e,t){var i,n=t.length;return e&&e.state?0!==(i=e.state).wrap&&i.mode!==j?g:i.mode===j&&r(1,t,n,0)!==i.check?v:fe(e,t,n,n)?(i.mode=J,b):(i.havedict=1,p):g},t.inflateInfo="pako inflate (from Nodeca project)"},function(e,t,i){"use strict";e.exports=function(e,t){var i,n,r,a,o,s,c,l,u,h,d,f,p,m,_,g,v,b,y,w,O,x,E,T,C;i=e.state,n=e.next_in,T=e.input,r=n+(e.avail_in-5),a=e.next_out,C=e.output,o=a-(t-e.avail_out),s=a+(e.avail_out-257),c=i.dmax,l=i.wsize,u=i.whave,h=i.wnext,d=i.window,f=i.hold,p=i.bits,m=i.lencode,_=i.distcode,g=(1<<i.lenbits)-1,v=(1<<i.distbits)-1;e:do{p<15&&(f+=T[n++]<<p,p+=8,f+=T[n++]<<p,p+=8),b=m[f&g];t:for(;;){if(f>>>=y=b>>>24,p-=y,0===(y=b>>>16&255))C[a++]=65535&b;else{if(!(16&y)){if(0==(64&y)){b=m[(65535&b)+(f&(1<<y)-1)];continue t}if(32&y){i.mode=12;break e}e.msg="invalid literal/length code",i.mode=30;break e}w=65535&b,(y&=15)&&(p<y&&(f+=T[n++]<<p,p+=8),w+=f&(1<<y)-1,f>>>=y,p-=y),p<15&&(f+=T[n++]<<p,p+=8,f+=T[n++]<<p,p+=8),b=_[f&v];i:for(;;){if(f>>>=y=b>>>24,p-=y,!(16&(y=b>>>16&255))){if(0==(64&y)){b=_[(65535&b)+(f&(1<<y)-1)];continue i}e.msg="invalid distance code",i.mode=30;break e}if(O=65535&b,p<(y&=15)&&(f+=T[n++]<<p,(p+=8)<y&&(f+=T[n++]<<p,p+=8)),(O+=f&(1<<y)-1)>c){e.msg="invalid distance too far back",i.mode=30;break e}if(f>>>=y,p-=y,O>(y=a-o)){if((y=O-y)>u&&i.sane){e.msg="invalid distance too far back",i.mode=30;break e}if(x=0,E=d,0===h){if(x+=l-y,y<w){w-=y;do{C[a++]=d[x++]}while(--y);x=a-O,E=C}}else if(h<y){if(x+=l+h-y,(y-=h)<w){w-=y;do{C[a++]=d[x++]}while(--y);if(x=0,h<w){w-=y=h;do{C[a++]=d[x++]}while(--y);x=a-O,E=C}}}else if(x+=h-y,y<w){w-=y;do{C[a++]=d[x++]}while(--y);x=a-O,E=C}for(;w>2;)C[a++]=E[x++],C[a++]=E[x++],C[a++]=E[x++],w-=3;w&&(C[a++]=E[x++],w>1&&(C[a++]=E[x++]))}else{x=a-O;do{C[a++]=C[x++],C[a++]=C[x++],C[a++]=C[x++],w-=3}while(w>2);w&&(C[a++]=C[x++],w>1&&(C[a++]=C[x++]))}break}}break}}while(n<r&&a<s);n-=w=p>>3,f&=(1<<(p-=w<<3))-1,e.next_in=n,e.next_out=a,e.avail_in=n<r?r-n+5:5-(n-r),e.avail_out=a<s?s-a+257:257-(a-s),i.hold=f,i.bits=p}},function(e,t,i){"use strict";var n=i(108),r=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],a=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],o=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],s=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];e.exports=function(e,t,i,c,l,u,h,d){var f,p,m,_,g,v,b,y,w,O=d.bits,x=0,E=0,T=0,C=0,S=0,A=0,P=0,I=0,D=0,j=0,M=null,R=0,L=new n.Buf16(16),N=new n.Buf16(16),F=null,k=0;for(x=0;x<=15;x++)L[x]=0;for(E=0;E<c;E++)L[t[i+E]]++;for(S=O,C=15;C>=1&&0===L[C];C--);if(S>C&&(S=C),0===C)return l[u++]=20971520,l[u++]=20971520,d.bits=1,0;for(T=1;T<C&&0===L[T];T++);for(S<T&&(S=T),I=1,x=1;x<=15;x++)if(I<<=1,(I-=L[x])<0)return-1;if(I>0&&(0===e||1!==C))return-1;for(N[1]=0,x=1;x<15;x++)N[x+1]=N[x]+L[x];for(E=0;E<c;E++)0!==t[i+E]&&(h[N[t[i+E]]++]=E);if(0===e?(M=F=h,v=19):1===e?(M=r,R-=257,F=a,k-=257,v=256):(M=o,F=s,v=-1),j=0,E=0,x=T,g=u,A=S,P=0,m=-1,_=(D=1<<S)-1,1===e&&D>852||2===e&&D>592)return 1;for(;;){b=x-P,h[E]<v?(y=0,w=h[E]):h[E]>v?(y=F[k+h[E]],w=M[R+h[E]]):(y=96,w=0),f=1<<x-P,T=p=1<<A;do{l[g+(j>>P)+(p-=f)]=b<<24|y<<16|w|0}while(0!==p);for(f=1<<x-1;j&f;)f>>=1;if(0!==f?(j&=f-1,j+=f):j=0,E++,0==--L[x]){if(x===C)break;x=t[i+h[E]]}if(x>S&&(j&_)!==m){for(0===P&&(P=S),g+=T,I=1<<(A=x-P);A+P<C&&!((I-=L[A+P])<=0);)A++,I<<=1;if(D+=1<<A,1===e&&D>852||2===e&&D>592)return 1;l[m=j&_]=S<<24|A<<16|g-u|0}}return 0!==j&&(l[g+j]=x-P<<24|64<<16|0),d.bits=S,0}},function(e,t,i){"use strict";e.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},function(e,t,i){"use strict";var n=i(129);i(16)({target:"RegExp",proto:!0,forced:n!==/./.exec},{exec:n})},function(e,t,i){e.exports=i(110)("native-function-to-string",Function.toString)},function(e,t,i){i(34)&&"g"!=/./g.flags&&i(33).f(RegExp.prototype,"flags",{configurable:!0,get:i(111)})},function(e,t,i){var n=i(72),r=i(135),a=i(32),o=i(26).Reflect;e.exports=o&&o.ownKeys||function(e){var t=n.f(a(e)),i=r.f;return i?t.concat(i(e)):t}},function(e,t,i){var n=i(93),r=i(135),a=i(131);e.exports=function(e){var t=n(e),i=r.f;if(i)for(var o,s=i(e),c=a.f,l=0;s.length>l;)c.call(e,o=s[l++])&&t.push(o);return t}},function(e,t,i){var n=i(57),r=i(72).f,a={}.toString,o="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];e.exports.f=function(e){return o&&"[object Window]"==a.call(e)?function(e){try{return r(e)}catch(e){return o.slice()}}(e):r(n(e))}},function(e,t,i){var n=i(254);e.exports=function(e,t){return new(n(e))(t)}},function(e,t,i){var n=i(31),r=i(136),a=i(24)("species");e.exports=function(e){var t;return r(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!r(t.prototype)||(t=void 0),n(t)&&null===(t=t[a])&&(t=void 0)),void 0===t?Array:t}},function(e,t,i){"use strict";var n=i(94),r=i(65),a=i(75),o={};i(44)(o,i(24)("iterator"),(function(){return this})),e.exports=function(e,t,i){e.prototype=n(o,{next:r(1,i)}),a(e,t+" Iterator")}},function(e,t,i){var n=i(26),r=i(175).set,a=n.MutationObserver||n.WebKitMutationObserver,o=n.process,s=n.Promise,c="process"==i(70)(o);e.exports=function(){var e,t,i,l=function(){var n,r;for(c&&(n=o.domain)&&n.exit();e;){r=e.fn,e=e.next;try{r()}catch(n){throw e?i():t=void 0,n}}t=void 0,n&&n.enter()};if(c)i=function(){o.nextTick(l)};else if(!a||n.navigator&&n.navigator.standalone)if(s&&s.resolve){var u=s.resolve(void 0);i=function(){u.then(l)}}else i=function(){r.call(n,l)};else{var h=!0,d=document.createTextNode("");new a(l).observe(d,{characterData:!0}),i=function(){d.data=h=!h}}return function(n){var r={fn:n,next:void 0};t&&(t.next=r),e||(e=r,i()),t=r}}},function(e,t){e.exports=function(e){try{return{e:!1,v:e()}}catch(e){return{e:!0,v:e}}}},function(e,t,i){var n=i(26).navigator;e.exports=n&&n.userAgent||""},function(e,t,i){var n=i(32),r=i(31),a=i(177);e.exports=function(e,t){if(n(e),r(t)&&t.constructor===e)return t;var i=a.f(e);return(0,i.resolve)(t),i.promise}},function(e,t,i){var n=i(261);"string"==typeof n&&(n=[[e.i,n,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};i(178)(n,r);n.locals&&(e.exports=n.locals)},function(e,t,i){(t=e.exports=i(27)(!1)).i(i(262),""),t.i(i(263),""),t.i(i(264),""),t.i(i(265),""),t.i(i(266),""),t.i(i(267),""),t.i(i(268),""),t.i(i(269),""),t.i(i(270),""),t.i(i(271),""),t.i(i(272),""),t.i(i(273),""),t.i(i(274),""),t.i(i(275),""),t.i(i(276),""),t.i(i(277),""),t.i(i(280),""),t.push([e.i,"\r\n",""])},function(e,t,i){(e.exports=i(27)(!1)).push([e.i,".cesium-svgPath-svg {\r\n    position: absolute;\r\n    top: 0;\r\n    left: 0;\r\n    width: 100%;\r\n    height: 100%;\r\n    overflow: hidden;\r\n}\r\n\r\n.cesium-button {\r\n    display: inline-block;\r\n    position: relative;\r\n    background: #303336;\r\n    border: 1px solid #444;\r\n    color: #edffff; /* For text buttons */\r\n    fill: #edffff; /* For SVG buttons */\r\n    border-radius: 4px;\r\n    padding: 5px 12px;\r\n    margin: 2px 3px;\r\n    cursor: pointer;\r\n    overflow: hidden;\r\n    -moz-user-select: none;\r\n    -webkit-user-select: none;\r\n    -ms-user-select: none;\r\n    user-select: none;\r\n}\r\n\r\n.cesium-button:focus {\r\n    color: #fff; /* For text buttons */\r\n    fill: #fff; /* For SVG buttons */\r\n    border-color: #ea4;\r\n    outline: none;\r\n}\r\n\r\n.cesium-button:hover {\r\n    color: #fff; /* For text buttons */\r\n    fill: #fff; /* For SVG buttons */\r\n    background: #48b;\r\n    border-color: #aef;\r\n    box-shadow: 0 0 8px #fff;\r\n}\r\n\r\n.cesium-button:active {\r\n    color: #000; /* For text buttons */\r\n    fill: #000; /* For SVG buttons */\r\n    background: #adf;\r\n    border-color: #fff;\r\n    box-shadow: 0 0 8px #fff;\r\n}\r\n\r\n.cesium-button:disabled,\r\n.cesium-button-disabled,\r\n.cesium-button-disabled:focus,\r\n.cesium-button-disabled:hover,\r\n.cesium-button-disabled:active {\r\n    background: #303336;\r\n    border-color: #444;\r\n    color: #646464; /* For text buttons */\r\n    fill: #646464; /* For SVG buttons */\r\n    box-shadow: none;\r\n    cursor: default;\r\n}\r\n\r\n.cesium-button option {\r\n    background-color: #000;\r\n    color: #eee;\r\n}\r\n\r\n.cesium-button option:disabled {\r\n    color: #777;\r\n}\r\n\r\n.cesium-button input, .cesium-button label {\r\n    cursor: pointer;\r\n}\r\n\r\n.cesium-button input {\r\n    vertical-align: sub;\r\n}\r\n\r\n.cesium-toolbar-button {\r\n    box-sizing: border-box;\r\n    width: 32px;\r\n    height: 32px;\r\n    border-radius: 14%;\r\n    padding: 0;\r\n    vertical-align: middle;\r\n    z-index: 0; /* Workaround for rounded raster image corners in Chrome */\r\n}\r\n\r\n.cesium-performanceDisplay-defaultContainer {\r\n    position: absolute;\r\n    top: 50px;\r\n    right: 10px;\r\n    text-align: right;\r\n}\r\n\r\n.cesium-performanceDisplay {\r\n    background-color: rgba(40, 40, 40, 0.7);\r\n    padding: 7px;\r\n    border-radius: 5px;\r\n    border: 1px solid #444;\r\n    font: bold 12px sans-serif;\r\n}\r\n\r\n.cesium-performanceDisplay-fps {\r\n    color: #e52;\r\n}\r\n\r\n.cesium-performanceDisplay-throttled {\r\n    color: #a42;\r\n}\r\n\r\n.cesium-performanceDisplay-ms {\r\n    color: #de3;\r\n}\r\n",""])},function(e,t,i){(e.exports=i(27)(!1)).push([e.i,".cesium-animation-theme {\r\n    visibility: hidden;\r\n    display: block;\r\n    position: absolute;\r\n    z-index: -100;\r\n}\r\n\r\n.cesium-animation-themeNormal {\r\n    color: #222;\r\n}\r\n\r\n.cesium-animation-themeHover {\r\n    color: #4488B0;\r\n}\r\n\r\n.cesium-animation-themeSelect {\r\n    color: #242;\r\n}\r\n\r\n.cesium-animation-themeDisabled {\r\n    color: #333;\r\n}\r\n\r\n.cesium-animation-themeKnob {\r\n    color: #222;\r\n}\r\n\r\n.cesium-animation-themePointer {\r\n    color: #2E2;\r\n}\r\n\r\n.cesium-animation-themeSwoosh {\r\n    color: #8AC;\r\n}\r\n\r\n.cesium-animation-themeSwooshHover {\r\n    color: #AEF;\r\n}\r\n\r\n.cesium-animation-svgText {\r\n    fill: #edffff;\r\n    font-family: Sans-Serif;\r\n    font-size: 15px;\r\n    text-anchor: middle;\r\n}\r\n\r\n.cesium-animation-blank {\r\n    fill: #000;\r\n    fill-opacity: 0.01; /* This must be clickable, so it can't be 'fill: none'. */\r\n    stroke: none;\r\n}\r\n\r\n.cesium-animation-rectButton {\r\n    cursor: pointer;\r\n    -moz-user-select: none;\r\n    -webkit-user-select: none;\r\n    -ms-user-select: none;\r\n    user-select: none;\r\n}\r\n\r\n.cesium-animation-rectButton .cesium-animation-buttonGlow {\r\n    fill: #fff;\r\n    stroke: none;\r\n    /* Widget will add: filter: url(#animation_blurred); */\r\n    display: none;\r\n}\r\n\r\n.cesium-animation-rectButton:hover .cesium-animation-buttonGlow {\r\n    display: block;\r\n}\r\n\r\n.cesium-animation-rectButton .cesium-animation-buttonPath {\r\n    fill: #edffff;\r\n}\r\n\r\n.cesium-animation-rectButton .cesium-animation-buttonMain {\r\n    /* Widget will add: fill: url(#animation_buttonNormal); */\r\n    stroke: #444;\r\n    stroke-width: 1.2;\r\n}\r\n\r\n.cesium-animation-rectButton:hover .cesium-animation-buttonMain {\r\n    /* Widget will add: fill: url(#animation_buttonHovered); */\r\n    stroke: #AEF;\r\n}\r\n\r\n.cesium-animation-rectButton:active .cesium-animation-buttonMain {\r\n    fill: #ABD6FF;\r\n}\r\n\r\n.cesium-animation-buttonDisabled {\r\n    -moz-user-select: none;\r\n    -webkit-user-select: none;\r\n    -ms-user-select: none;\r\n    user-select: none;\r\n}\r\n\r\n.cesium-animation-buttonDisabled .cesium-animation-buttonMain {\r\n    /* Widget will add: fill: url(#animation_buttonDisabled); */\r\n    stroke: #555;\r\n}\r\n\r\n.cesium-animation-buttonDisabled .cesium-animation-buttonPath {\r\n    fill: #818181;\r\n}\r\n\r\n.cesium-animation-buttonDisabled .cesium-animation-buttonGlow {\r\n    display: none;\r\n}\r\n\r\n.cesium-animation-buttonToggled .cesium-animation-buttonGlow {\r\n    display: block;\r\n    fill: #2E2;\r\n}\r\n\r\n.cesium-animation-buttonToggled .cesium-animation-buttonMain {\r\n    stroke: #2E2;\r\n}\r\n\r\n.cesium-animation-buttonToggled:hover .cesium-animation-buttonGlow {\r\n    fill: #fff;\r\n}\r\n\r\n.cesium-animation-buttonToggled:hover .cesium-animation-buttonMain {\r\n    stroke: #2E2;\r\n}\r\n\r\n.cesium-animation-shuttleRingG {\r\n    cursor: pointer;\r\n}\r\n\r\n/* Widget will add:\r\n.cesium-animation-shuttleRingG .cesium-animation-shuttleRingSwoosh {\r\n    fill: url(#animation_shuttleRingSwooshGradient);\r\n}\r\n\r\n.cesium-animation-shuttleRingG:hover .cesium-animation-shuttleRingSwoosh {\r\n    fill: url(#animation_shuttleRingSwooshHovered);\r\n}\r\n*/\r\n\r\n.cesium-animation-shuttleRingPointer {\r\n    /* Widget will add: fill: url(#animation_shuttleRingPointerGradient); */\r\n    cursor: pointer;\r\n}\r\n\r\n.cesium-animation-shuttleRingPausePointer {\r\n    /* Widget will add: fill: url(#animation_shuttleRingPointerPaused); */\r\n    cursor: pointer;\r\n}\r\n\r\n.cesium-animation-shuttleRingBack {\r\n    fill: #181818;\r\n    fill-opacity: 0.8;\r\n    stroke: #333;\r\n    stroke-width: 1.2;\r\n}\r\n\r\n.cesium-animation-shuttleRingSwoosh line {\r\n    stroke: #8AC;\r\n    stroke-width: 3;\r\n    stroke-opacity: 0.2;\r\n    stroke-linecap: round;\r\n}\r\n\r\n.cesium-animation-knobOuter {\r\n    /* Widget will add: fill: url(#animation_knobOuter); */\r\n    cursor: pointer;\r\n    stroke: #444;\r\n    stroke-width: 1.2;\r\n}\r\n\r\n.cesium-animation-knobInner {\r\n    /* Widget will add: fill: url(#animation_knobInner); */\r\n    cursor: pointer;\r\n}\r\n",""])},function(e,t,i){(e.exports=i(27)(!1)).push([e.i,".cesium-baseLayerPicker-selected {\r\n    position: absolute;\r\n    top: 0;\r\n    left: 0;\r\n    width: 100%;\r\n    height: 100%;\r\n    border: none;\r\n}\r\n\r\n.cesium-baseLayerPicker-dropDown {\r\n    display: block;\r\n    position: absolute;\r\n    box-sizing: content-box;\r\n    top: auto;\r\n    right: 0;\r\n    width: 320px; /* Includes space needed for scrollbar */\r\n    max-height: 500px;\r\n    margin-top: 5px;\r\n    background-color: rgba(38, 38, 38, 0.75);\r\n    border: 1px solid #444;\r\n    padding: 6px;\r\n    overflow: auto;\r\n    border-radius: 10px;\r\n    -moz-user-select: none;\r\n    -webkit-user-select: none;\r\n    -ms-user-select: none;\r\n    user-select: none;\r\n    transform: translate(0, -20%);\r\n    visibility: hidden;\r\n    opacity: 0;\r\n    transition: visibility 0s 0.2s, opacity 0.2s ease-in, transform 0.2s ease-in;\r\n}\r\n\r\n.cesium-baseLayerPicker-dropDown-visible {\r\n    transform: translate(0, 0);\r\n    visibility: visible;\r\n    opacity: 1;\r\n    transition: opacity 0.2s ease-out, transform 0.2s ease-out;\r\n}\r\n\r\n.cesium-baseLayerPicker-sectionTitle {\r\n    display: block;\r\n    font-family: sans-serif;\r\n    font-size: 16pt;\r\n    text-align: left;\r\n    color: #edffff;\r\n    margin-bottom: 4px;\r\n}\r\n\r\n.cesium-baseLayerPicker-choices {\r\n    margin-bottom: 5px;\r\n}\r\n\r\n.cesium-baseLayerPicker-categoryTitle {\r\n    color: #edffff;\r\n    font-size: 11pt;\r\n}\r\n\r\n.cesium-baseLayerPicker-choices {\r\n    display: block;\r\n    border: 1px solid #888;\r\n    border-radius: 5px;\r\n    padding: 5px 0;\r\n}\r\n\r\n.cesium-baseLayerPicker-item {\r\n    display: inline-block;\r\n    vertical-align: top;\r\n    margin: 2px 5px;\r\n    width: 64px;\r\n    text-align: center;\r\n    cursor: pointer;\r\n}\r\n\r\n.cesium-baseLayerPicker-itemLabel {\r\n    display: block;\r\n    font-family: sans-serif;\r\n    font-size: 8pt;\r\n    text-align: center;\r\n    vertical-align: middle;\r\n    color: #edffff;\r\n    cursor: pointer;\r\n    word-wrap: break-word;\r\n}\r\n\r\n.cesium-baseLayerPicker-item:hover .cesium-baseLayerPicker-itemLabel, .cesium-baseLayerPicker-item:focus .cesium-baseLayerPicker-itemLabel {\r\n    text-decoration: underline;\r\n}\r\n\r\n.cesium-baseLayerPicker-itemIcon {\r\n    display: inline-block;\r\n    position: relative;\r\n    width: inherit;\r\n    height: auto;\r\n    background-size: 100% 100%;\r\n    border: solid 1px #444;\r\n    border-radius: 9px;\r\n    color: #edffff;\r\n    margin: 0;\r\n    padding: 0;\r\n    cursor: pointer;\r\n    box-sizing: border-box;\r\n}\r\n\r\n.cesium-baseLayerPicker-item:hover .cesium-baseLayerPicker-itemIcon {\r\n    border-color: #fff;\r\n    box-shadow: 0 0 8px #fff, 0 0 8px #fff;\r\n}\r\n\r\n.cesium-baseLayerPicker-selectedItem .cesium-baseLayerPicker-itemLabel {\r\n    color: rgb(189, 236, 248);\r\n}\r\n\r\n.cesium-baseLayerPicker-selectedItem .cesium-baseLayerPicker-itemIcon {\r\n    border: double 4px rgb(189, 236, 248);\r\n}\r\n",""])},function(e,t,i){(e.exports=i(27)(!1)).push([e.i,'.cesium-widget {\r\n    position: relative;\r\n}\r\n\r\n.cesium-widget, .cesium-widget canvas {\r\n    width: 100%;\r\n    height: 100%;\r\n    touch-action: none;\r\n}\r\n\r\n.cesium-widget-credits {\r\n    display: block;\r\n    position: absolute;\r\n    bottom: 0;\r\n    left: 0;\r\n    color: #fff;\r\n    font-size: 10px;\r\n    text-shadow: 0px 0px 2px #000000;\r\n    padding-right: 5px;\r\n}\r\n\r\n.cesium-widget-credits a,\r\n.cesium-widget-credits a:visited {\r\n    color: #fff;\r\n}\r\n\r\n.cesium-widget-errorPanel {\r\n    position: absolute;\r\n    top: 0;\r\n    right: 0;\r\n    bottom: 0;\r\n    left: 0;\r\n    text-align: center;\r\n    background: rgba(0, 0, 0, 0.7);\r\n    z-index: 99999;\r\n}\r\n\r\n.cesium-widget-errorPanel:before {\r\n    display: inline-block;\r\n    vertical-align: middle;\r\n    height: 100%;\r\n    content: "";\r\n}\r\n\r\n.cesium-widget-errorPanel-content {\r\n    width: 75%;\r\n    display: inline-block;\r\n    text-align: left;\r\n    vertical-align: middle;\r\n    border: 1px solid #526F82;\r\n    border-radius: 7px;\r\n    background-color: black;\r\n    color: white;\r\n    font-size: 10pt;\r\n    padding: 1em;\r\n}\r\n\r\n.cesium-widget-errorPanel-header {\r\n    font-size: 120%;\r\n    color: #fe4;\r\n}\r\n\r\n.cesium-widget-errorPanel-scroll {\r\n    overflow: auto;\r\n    font-family: monospace;\r\n    white-space: pre-wrap;\r\n    padding: 0;\r\n    margin: 10px 0;\r\n}\r\n\r\n.cesium-widget-errorPanel-buttonPanel {\r\n    text-align: center;\r\n}\r\n',""])},function(e,t,i){(e.exports=i(27)(!1)).push([e.i,".cesium-cesiumInspector {\r\n    border-radius: 5px;\r\n    transition: width ease-in-out 0.25s;\r\n    background: rgba(48, 51, 54, 0.8);\r\n    border: 1px solid #444;\r\n    color: #edffff;\r\n    display: inline-block;\r\n    position: relative;\r\n    padding: 4px 12px;\r\n    -moz-user-select: none;\r\n    -webkit-user-select: none;\r\n    -ms-user-select: none;\r\n    user-select: none;\r\n    overflow: hidden;\r\n}\r\n\r\n.cesium-cesiumInspector-button {\r\n    text-align: center;\r\n    font-size: 11pt;\r\n}\r\n\r\n.cesium-cesiumInspector-visible .cesium-cesiumInspector-button {\r\n    border-bottom: 1px solid #aaa;\r\n    padding-bottom: 3px;\r\n}\r\n\r\n.cesium-cesiumInspector input:enabled, .cesium-cesiumInspector-button {\r\n    cursor: pointer;\r\n}\r\n\r\n.cesium-cesiumInspector-visible {\r\n    width: 185px;\r\n    height: auto;\r\n}\r\n\r\n.cesium-cesiumInspector-hidden {\r\n    width: 122px;\r\n    height: 17px;\r\n}\r\n\r\n.cesium-cesiumInspector-sectionContent {\r\n    max-height: 500px;\r\n}\r\n\r\n.cesium-cesiumInspector-section-collapsed .cesium-cesiumInspector-sectionContent {\r\n    max-height: 0;\r\n    padding: 0 !important;\r\n    overflow: hidden;\r\n}\r\n\r\n.cesium-cesiumInspector-dropDown {\r\n    margin: 5px 0;\r\n    font-family: sans-serif;\r\n    font-size: 10pt;\r\n    width: 185px;\r\n}\r\n\r\n.cesium-cesiumInspector-frustumStatistics {\r\n    padding-left: 10px;\r\n    padding: 5px;\r\n    background-color: rgba(80, 80, 80, 0.75);\r\n}\r\n\r\n.cesium-cesiumInspector-pickButton {\r\n    background-color: rgba(0, 0, 0, 0.3);\r\n    border: 1px solid #444;\r\n    color: #edffff;\r\n    border-radius: 5px;\r\n    padding: 3px 7px;\r\n    cursor: pointer;\r\n    -moz-user-select: none;\r\n    -webkit-user-select: none;\r\n    -ms-user-select: none;\r\n    user-select: none;\r\n    margin: 0 auto;\r\n}\r\n\r\n.cesium-cesiumInspector-pickButton:focus {\r\n    outline: none;\r\n}\r\n\r\n.cesium-cesiumInspector-pickButton:active, .cesium-cesiumInspector-pickButtonHighlight {\r\n    color: #000; /* For text buttons */\r\n    background: #adf;\r\n    border-color: #fff;\r\n    box-shadow: 0 0 8px #fff;\r\n}\r\n\r\n.cesium-cesiumInspector-center {\r\n    text-align: center;\r\n}\r\n\r\n.cesium-cesiumInspector-sectionHeader {\r\n    font-weight: bold;\r\n    font-size: 10pt;\r\n    margin: 0;\r\n    cursor: pointer;\r\n}\r\n\r\n.cesium-cesiumInspector-pickSection {\r\n    border: 1px solid #aaa;\r\n    border-radius: 5px;\r\n    padding: 3px;\r\n    margin-bottom: 5px;\r\n}\r\n\r\n.cesium-cesiumInspector-sectionContent {\r\n    margin-bottom: 10px;\r\n    transition: max-height 0.25s;\r\n}\r\n\r\n.cesium-cesiumInspector-tileText {\r\n    padding-bottom: 10px;\r\n    border-bottom: 1px solid #aaa;\r\n}\r\n\r\n.cesium-cesiumInspector-relativeText {\r\n    padding-top: 10px;\r\n}\r\n\r\n.cesium-cesiumInspector-sectionHeader::before {\r\n    margin-right: 5px;\r\n    content: '-';\r\n    width: 1ch;\r\n    display: inline-block;\r\n}\r\n\r\n.cesium-cesiumInspector-section-collapsed .cesium-cesiumInspector-sectionHeader::before {\r\n    content: '+';\r\n}\r\n",""])},function(e,t,i){(e.exports=i(27)(!1)).push([e.i,"\r\nul.cesium-cesiumInspector-statistics {\r\n    margin: 0;\r\n    padding-top: 3px;\r\n    padding-bottom: 3px;\r\n}\r\n\r\nul.cesium-cesiumInspector-statistics + ul.cesium-cesiumInspector-statistics {\r\n    border-top: 1px solid #aaa;\r\n}\r\n\r\n.cesium-cesiumInspector-slider {\r\n    margin-top: 5px;\r\n}\r\n\r\n.cesium-cesiumInspector-slider input[type=number] {\r\n    text-align: left;\r\n    background-color: #222;\r\n    outline: none;\r\n    border: 1px solid #444;\r\n    color: #edffff;\r\n    width: 100px;\r\n    border-radius: 3px;\r\n    padding: 1px;\r\n    margin-left: 10px;\r\n    cursor: auto;\r\n}\r\n\r\n.cesium-cesiumInspector-slider input[type=number]::-webkit-outer-spin-button,\r\n.cesium-cesiumInspector-slider input[type=number]::-webkit-inner-spin-button {\r\n    -webkit-appearance: none;\r\n    margin: 0;\r\n}\r\n\r\n.cesium-cesiumInspector-slider input[type=range] {\r\n    margin-left: 5px;\r\n    vertical-align: middle;\r\n}\r\n\r\n.cesium-cesiumInspector-hide .cesium-cesiumInspector-styleEditor {\r\n    display: none;\r\n}\r\n\r\n.cesium-cesiumInspector-styleEditor {\r\n    padding: 10px;\r\n    border-radius: 5px;\r\n    background: rgba(48, 51, 54, 0.8);\r\n    border: 1px solid #444;\r\n}\r\n\r\n.cesium-cesiumInspector-styleEditor textarea {\r\n    width: 100%;\r\n    height: 300px;\r\n    background: transparent;\r\n    color: #edffff;\r\n    border: none;\r\n    padding: 0;\r\n    white-space: pre;\r\n    overflow-wrap: normal;\r\n    overflow-x: auto;\r\n}\r\n\r\n.cesium-3DTilesInspector {\r\n    width: 300px;\r\n    pointer-events: all;\r\n}\r\n\r\n.cesium-3DTilesInspector-statistics {\r\n    font-size: 11px;\r\n}\r\n\r\n.cesium-3DTilesInspector div, .cesium-3DTilesInspector input[type=range] {\r\n    width: 100%;\r\n    box-sizing: border-box;\r\n}\r\n\r\n.cesium-cesiumInspector-error {\r\n    color: #ff9e9e;\r\n    overflow: auto;\r\n}\r\n\r\n.cesium-3DTilesInspector .cesium-cesiumInspector-section {\r\n    margin-top: 3px;\r\n}\r\n\r\n.cesium-3DTilesInspector .cesium-cesiumInspector-sectionHeader + .cesium-cesiumInspector-show {\r\n    border-top: 1px solid white;\r\n}\r\n\r\ninput.cesium-cesiumInspector-url {\r\n    overflow: hidden;\r\n    white-space: nowrap;\r\n    overflow-x: scroll;\r\n    background-color: transparent;\r\n    color: white;\r\n    outline: none;\r\n    border: none;\r\n    height: 1em;\r\n    width: 100%;\r\n}\r\n\r\n.cesium-cesiumInspector .field-group {\r\n    display: table;\r\n}\r\n\r\n.cesium-cesiumInspector .field-group > label {\r\n    display: table-cell;\r\n    font-weight: bold;\r\n}\r\n\r\n.cesium-cesiumInspector .field-group > .field {\r\n    display: table-cell;\r\n    width: 100%;\r\n}\r\n",""])},function(e,t,i){(e.exports=i(27)(!1)).push([e.i,".cesium-button.cesium-fullscreenButton {\r\n    display: block;\r\n    width: 100%;\r\n    height: 100%;\r\n    margin: 0;\r\n    border-radius: 0;\r\n}\r\n",""])},function(e,t,i){(e.exports=i(27)(!1)).push([e.i,".cesium-button.cesium-vrButton {\r\n    display: block;\r\n    width: 100%;\r\n    height: 100%;\r\n    margin: 0;\r\n    border-radius: 0;\r\n}\r\n",""])},function(e,t,i){(e.exports=i(27)(!1)).push([e.i,".cesium-viewer-geocoderContainer .cesium-geocoder-input {\r\n    border: solid 1px #444;\r\n    background-color: rgba(40, 40, 40, 0.7);\r\n    color: white;\r\n    display: inline-block;\r\n    vertical-align: middle;\r\n    width: 0;\r\n    height: 32px;\r\n    margin: 0;\r\n    padding: 0 32px 0 0;\r\n    border-radius: 0;\r\n    box-sizing: border-box;\r\n    transition: width ease-in-out 0.25s, background-color 0.2s ease-in-out;\r\n    -webkit-appearance: none;\r\n}\r\n\r\n.cesium-viewer-geocoderContainer:hover .cesium-geocoder-input {\r\n    border-color: #aef;\r\n    box-shadow: 0 0 8px #fff;\r\n}\r\n\r\n.cesium-viewer-geocoderContainer .cesium-geocoder-input:focus {\r\n    border-color: #ea4;\r\n    background-color: rgba(15, 15, 15, 0.9);\r\n    box-shadow: none;\r\n    outline: none;\r\n}\r\n\r\n.cesium-viewer-geocoderContainer:hover .cesium-geocoder-input,\r\n.cesium-viewer-geocoderContainer .cesium-geocoder-input:focus,\r\n.cesium-viewer-geocoderContainer .cesium-geocoder-input-wide {\r\n    padding-left: 4px;\r\n    width: 250px;\r\n}\r\n\r\n.cesium-viewer-geocoderContainer .search-results {\r\n    position: absolute;\r\n    background-color: #000;\r\n    color: #eee;\r\n    overflow-y: auto;\r\n    opacity: 0.8;\r\n    width: 100%;\r\n}\r\n\r\n.cesium-viewer-geocoderContainer .search-results ul {\r\n    list-style-type: none;\r\n    margin: 0;\r\n    padding: 0;\r\n}\r\n\r\n.cesium-viewer-geocoderContainer .search-results ul li {\r\n    font-size: 14px;\r\n    padding: 3px 10px;\r\n}\r\n.cesium-viewer-geocoderContainer .search-results ul li:hover {\r\n    cursor: pointer;\r\n}\r\n\r\n.cesium-viewer-geocoderContainer .search-results ul li.active {\r\n    background: #48b;\r\n}\r\n\r\n.cesium-geocoder-searchButton {\r\n    background-color: #303336;\r\n    display: inline-block;\r\n    position: absolute;\r\n    cursor: pointer;\r\n    width: 32px;\r\n    top: 1px;\r\n    right: 1px;\r\n    height: 30px;\r\n    vertical-align: middle;\r\n    fill: #edffff;\r\n}\r\n\r\n.cesium-geocoder-searchButton:hover {\r\n    background-color: #48b;\r\n}\r\n",""])},function(e,t,i){(e.exports=i(27)(!1)).push([e.i,".cesium-infoBox {\r\n    display: block;\r\n    position: absolute;\r\n    top: 50px;\r\n    right: 0;\r\n    width: 40%;\r\n    max-width: 480px;\r\n    background: rgba(38, 38, 38, 0.95);\r\n    color: #edffff;\r\n    border: 1px solid #444;\r\n    border-right: none;\r\n    border-top-left-radius: 7px;\r\n    border-bottom-left-radius: 7px;\r\n    box-shadow: 0 0 10px 1px #000;\r\n    transform: translate(100%, 0);\r\n    visibility: hidden;\r\n    opacity: 0;\r\n    transition: visibility 0s 0.2s, opacity 0.2s ease-in, transform 0.2s ease-in;\r\n}\r\n\r\n.cesium-infoBox-visible {\r\n    transform: translate(0, 0);\r\n    visibility: visible;\r\n    opacity: 1;\r\n    transition: opacity 0.2s ease-out, transform 0.2s ease-out;\r\n}\r\n\r\n.cesium-infoBox-title {\r\n    display: block;\r\n    height: 20px;\r\n    padding: 5px 30px 5px 25px;\r\n    background: rgba(84, 84, 84, 1.0);\r\n    border-top-left-radius: 7px;\r\n    text-align: center;\r\n    text-overflow: ellipsis;\r\n    white-space: nowrap;\r\n    overflow: hidden;\r\n    box-sizing: content-box;\r\n}\r\n\r\n.cesium-infoBox-bodyless .cesium-infoBox-title {\r\n    border-bottom-left-radius: 7px;\r\n}\r\n\r\nbutton.cesium-infoBox-camera {\r\n    display: block;\r\n    position: absolute;\r\n    top: 4px;\r\n    left: 4px;\r\n    width: 22px;\r\n    height: 22px;\r\n    background: transparent;\r\n    border-color: transparent;\r\n    border-radius: 3px;\r\n    padding: 0 5px;\r\n    margin: 0;\r\n}\r\n\r\nbutton.cesium-infoBox-close {\r\n    display: block;\r\n    position: absolute;\r\n    top: 5px;\r\n    right: 5px;\r\n    height: 20px;\r\n    background: transparent;\r\n    border: none;\r\n    border-radius: 2px;\r\n    font-weight: bold;\r\n    font-size: 16px;\r\n    padding: 0 5px;\r\n    margin: 0;\r\n    color: #edffff;\r\n}\r\n\r\nbutton.cesium-infoBox-close:focus {\r\n    background: rgba(238, 136, 0, 0.44);\r\n    outline: none;\r\n}\r\n\r\nbutton.cesium-infoBox-close:hover {\r\n    background: #888;\r\n    color: #000;\r\n}\r\n\r\nbutton.cesium-infoBox-close:active {\r\n    background: #a00;\r\n    color: #000;\r\n}\r\n\r\n.cesium-infoBox-bodyless .cesium-infoBox-iframe {\r\n    display: none;\r\n}\r\n\r\n.cesium-infoBox-iframe {\r\n    border: none;\r\n    width: 100%; /* Fallback */\r\n    width: calc(100% - 2px);\r\n}\r\n",""])},function(e,t,i){(e.exports=i(27)(!1)).push([e.i,"span.cesium-sceneModePicker-wrapper {\r\n    display: inline-block;\r\n    position: relative;\r\n    margin: 0 3px;\r\n}\r\n\r\n.cesium-sceneModePicker-visible {\r\n    visibility: visible;\r\n    opacity: 1;\r\n    transition: opacity 0.25s linear;\r\n}\r\n\r\n.cesium-sceneModePicker-hidden {\r\n    visibility: hidden;\r\n    opacity: 0;\r\n    transition: visibility 0s 0.25s, opacity 0.25s linear;\r\n}\r\n\r\n.cesium-sceneModePicker-wrapper .cesium-sceneModePicker-none {\r\n    display: none;\r\n}\r\n\r\n.cesium-sceneModePicker-slide-svg {\r\n    transition: left 2s;\r\n    top: 0;\r\n    left: 0;\r\n}\r\n\r\n.cesium-sceneModePicker-wrapper .cesium-sceneModePicker-dropDown-icon {\r\n    box-sizing: border-box;\r\n    padding: 0;\r\n    margin: 3px 0;\r\n}\r\n\r\n.cesium-sceneModePicker-wrapper .cesium-sceneModePicker-button3D,\r\n.cesium-sceneModePicker-wrapper .cesium-sceneModePicker-buttonColumbusView,\r\n.cesium-sceneModePicker-wrapper .cesium-sceneModePicker-button2D {\r\n    margin: 0 0 3px 0;\r\n}\r\n\r\n.cesium-sceneModePicker-wrapper .cesium-sceneModePicker-button3D .cesium-sceneModePicker-icon2D {\r\n    left: 100%;\r\n}\r\n\r\n.cesium-sceneModePicker-wrapper .cesium-sceneModePicker-button3D .cesium-sceneModePicker-iconColumbusView {\r\n    left: 200%;\r\n}\r\n\r\n.cesium-sceneModePicker-wrapper .cesium-sceneModePicker-buttonColumbusView .cesium-sceneModePicker-icon3D {\r\n    left: -200%;\r\n}\r\n\r\n.cesium-sceneModePicker-wrapper .cesium-sceneModePicker-buttonColumbusView .cesium-sceneModePicker-icon2D {\r\n    left: -100%;\r\n}\r\n\r\n.cesium-sceneModePicker-wrapper .cesium-sceneModePicker-button2D .cesium-sceneModePicker-icon3D {\r\n    left: -100%;\r\n}\r\n\r\n.cesium-sceneModePicker-wrapper .cesium-sceneModePicker-button2D .cesium-sceneModePicker-iconColumbusView {\r\n    left: 100%;\r\n}\r\n\r\n.cesium-sceneModePicker-wrapper .cesium-sceneModePicker-selected {\r\n    border-color: #2e2;\r\n    box-shadow: 0 0 8px #fff, 0 0 8px #fff;\r\n}\r\n",""])},function(e,t,i){(e.exports=i(27)(!1)).push([e.i,"span.cesium-projectionPicker-wrapper {\r\n    display: inline-block;\r\n    position: relative;\r\n    margin: 0 3px;\r\n}\r\n\r\n.cesium-projectionPicker-visible {\r\n    visibility: visible;\r\n    opacity: 1;\r\n    transition: opacity 0.25s linear;\r\n}\r\n\r\n.cesium-projectionPicker-hidden {\r\n    visibility: hidden;\r\n    opacity: 0;\r\n    transition: visibility 0s 0.25s, opacity 0.25s linear;\r\n}\r\n\r\n.cesium-projectionPicker-wrapper .cesium-projectionPicker-none {\r\n    display: none;\r\n}\r\n\r\n.cesium-projectionPicker-wrapper .cesium-projectionPicker-dropDown-icon {\r\n    box-sizing: border-box;\r\n    padding: 0;\r\n    margin: 3px 0;\r\n}\r\n\r\n.cesium-projectionPicker-wrapper .cesium-projectionPicker-buttonPerspective,\r\n.cesium-projectionPicker-wrapper .cesium-projectionPicker-buttonOrthographic {\r\n    margin: 0 0 3px 0;\r\n}\r\n\r\n.cesium-projectionPicker-wrapper .cesium-projectionPicker-buttonPerspective .cesium-projectionPicker-iconOrthographic {\r\n    left: 100%;\r\n}\r\n\r\n.cesium-projectionPicker-wrapper .cesium-projectionPicker-buttonOrthographic .cesium-projectionPicker-iconPerspective {\r\n    left: -100%;\r\n}\r\n\r\n.cesium-projectionPicker-wrapper .cesium-projectionPicker-selected {\r\n    border-color: #2e2;\r\n    box-shadow: 0 0 8px #fff, 0 0 8px #fff;\r\n}\r\n",""])},function(e,t,i){(e.exports=i(27)(!1)).push([e.i,".cesium-performance-watchdog-message-area {\r\n    position: relative;\r\n    background-color: yellow;\r\n    color: black;\r\n    padding: 10px;\r\n}\r\n\r\n.cesium-performance-watchdog-message {\r\n    margin-right: 30px;\r\n}\r\n\r\n.cesium-performance-watchdog-message-dismiss {\r\n    position: absolute;\r\n    right: 0;\r\n    margin: 0 10px 0 0;\r\n}\r\n",""])},function(e,t,i){(e.exports=i(27)(!1)).push([e.i,".cesium-navigationHelpButton-wrapper {\r\n    position: relative;\r\n    display: inline-block;\r\n}\r\n\r\n.cesium-navigation-help {\r\n    visibility: hidden;\r\n    position: absolute;\r\n    top: 38px;\r\n    right: 2px;\r\n    width: 250px;\r\n    border-radius: 10px;\r\n    transform: scale(0.01);\r\n    transform-origin: 234px -10px;\r\n    transition: visibility 0s 0.25s, transform 0.25s ease-in;\r\n}\r\n\r\n.cesium-navigation-help-visible {\r\n    visibility: visible;\r\n    transform: scale(1);\r\n    transition: transform 0.25s ease-out;\r\n}\r\n\r\n.cesium-navigation-help-instructions {\r\n    border: 1px solid #444;\r\n    background-color: rgba(38, 38, 38, 0.75);\r\n    padding-bottom: 5px;\r\n    border-radius: 0 0 10px 10px;\r\n}\r\n\r\n.cesium-click-navigation-help {\r\n    display: none;\r\n}\r\n\r\n.cesium-touch-navigation-help {\r\n    display: none;\r\n    padding-top: 5px;\r\n}\r\n\r\n.cesium-click-navigation-help-visible {\r\n    display: block;\r\n}\r\n\r\n.cesium-touch-navigation-help-visible {\r\n    display: block;\r\n}\r\n\r\n.cesium-navigation-help-pan {\r\n    color: #66ccff;\r\n    font-weight: bold;\r\n}\r\n\r\n.cesium-navigation-help-zoom {\r\n    color: #65fd00;\r\n    font-weight: bold;\r\n}\r\n\r\n.cesium-navigation-help-rotate {\r\n    color: #ffd800;\r\n    font-weight: bold;\r\n}\r\n\r\n.cesium-navigation-help-tilt {\r\n    color: #d800d8;\r\n    font-weight: bold;\r\n}\r\n\r\n.cesium-navigation-help-details {\r\n    color: #ffffff;\r\n}\r\n\r\n.cesium-navigation-button {\r\n    color: #fff;\r\n    background-color: transparent;\r\n    border-bottom: none;\r\n    border-top: 1px solid #444;\r\n    border-right: 1px solid #444;\r\n    margin: 0;\r\n    width: 50%;\r\n    cursor: pointer;\r\n}\r\n\r\n.cesium-navigation-button-icon {\r\n    vertical-align: middle;\r\n    padding: 5px 1px;\r\n}\r\n\r\n.cesium-navigation-button:focus {\r\n    outline: none;\r\n}\r\n\r\n.cesium-navigation-button-left {\r\n    border-radius: 10px 0 0 0;\r\n    border-left: 1px solid #444;\r\n}\r\n\r\n.cesium-navigation-button-right {\r\n    border-radius: 0 10px 0 0;\r\n    border-left: none;\r\n}\r\n\r\n.cesium-navigation-button-selected {\r\n    background-color: rgba(38, 38, 38, 0.75);\r\n}\r\n\r\n.cesium-navigation-button-unselected {\r\n    background-color: rgba(0, 0, 0, 0.75);\r\n}\r\n\r\n.cesium-navigation-button-unselected:hover {\r\n    background-color: rgba(76, 76, 76, 0.75);\r\n}\r\n",""])},function(e,t,i){(e.exports=i(27)(!1)).push([e.i,".cesium-selection-wrapper {\r\n    position: absolute;\r\n    width: 160px;\r\n    height: 160px;\r\n    pointer-events: none;\r\n    visibility: hidden;\r\n    opacity: 0;\r\n    transition: visibility 0s 0.2s, opacity 0.2s ease-in;\r\n}\r\n\r\n.cesium-selection-wrapper-visible {\r\n    visibility: visible;\r\n    opacity: 1;\r\n    transition: opacity 0.2s ease-out;\r\n}\r\n\r\n.cesium-selection-wrapper svg {\r\n    fill: #2e2;\r\n    stroke: #000;\r\n    stroke-width: 1.1px;\r\n}\r\n",""])},function(e,t,i){var n=i(278);(e.exports=i(27)(!1)).push([e.i,".cesium-timeline-main {\r\n\tposition: relative;\r\n\tleft: 0;\r\n\tbottom: 0;\r\n\toverflow: hidden;\r\n\tborder: solid 1px #888;\r\n}\r\n\r\n.cesium-timeline-trackContainer {\r\n\twidth: 100%;\r\n\toverflow: auto;\r\n\tborder-top: solid 1px #888;\r\n\tposition: relative;\r\n\ttop: 0;\r\n\tleft: 0;\r\n}\r\n\r\n.cesium-timeline-tracks {\r\n\tposition: absolute;\r\n\ttop: 0;\r\n\tleft: 0;\r\n\twidth: 100%;\r\n}\r\n\r\n.cesium-timeline-needle {\r\n\tposition: absolute;\r\n\tleft: 0;\r\n\ttop: 1.7em;\r\n\tbottom: 0;\r\n\twidth: 1px;\r\n\tbackground: #F00;\r\n}\r\n\r\n.cesium-timeline-bar {\r\n    position: relative;\r\n    left: 0;\r\n    top: 0;\r\n    overflow: hidden;\r\n    cursor: pointer;\r\n    width: 100%;\r\n    height: 1.7em;\r\n    background: linear-gradient(to bottom, rgba(116,117,119,0.8) 0%,rgba(58,68,82,0.8) 11%,rgba(46,50,56,0.8) 46%,rgba(53,53,53,0.8) 81%,rgba(53,53,53,0.8) 100%);\r\n}\r\n\r\n.cesium-timeline-ruler {\r\n\t/* NOTE: The label and the ruler must use the same font/size */\r\n\tvisibility: hidden;\r\n\twhite-space: nowrap;\r\n\tfont-size: 80%;\r\n\tz-index: -200;\r\n}\r\n\r\n.cesium-timeline-highlight {\r\n\tposition: absolute;\r\n\tbottom: 0;\r\n\tleft: 0;\r\n\tbackground: #08F;\r\n}\r\n\r\n.cesium-timeline-ticLabel {\r\n    position: absolute;\r\n    top: 0;\r\n    left: 0;\r\n    white-space: nowrap;\r\n    font-size: 80%;\r\n    color: #eee;\r\n}\r\n\r\n.cesium-timeline-ticMain {\r\n    position: absolute;\r\n    bottom: 0;\r\n    left: 0;\r\n    width: 1px;\r\n    height: 50%;\r\n    background: #eee;\r\n}\r\n\r\n.cesium-timeline-ticSub {\r\n    position: absolute;\r\n    bottom: 0;\r\n    left: 0;\r\n    width: 1px;\r\n    height: 33%;\r\n    background: #aaa;\r\n}\r\n\r\n.cesium-timeline-ticTiny {\r\n\tposition: absolute;\r\n\tbottom: 0;\r\n\tleft: 0;\r\n\twidth: 1px;\r\n\theight: 25%;\r\n\tbackground: #888;\r\n}\r\n\r\n.cesium-timeline-icon16 {\r\n\tdisplay: block;\r\n\tposition: absolute;\r\n\twidth: 16px;\r\n\theight: 16px;\r\n\tbackground-image: url("+n(i(279))+");\r\n\tbackground-repeat: no-repeat;\r\n}\r\n",""])},function(e,t){e.exports=function(e){return"string"!=typeof e?e:(/^['"].*['"]$/.test(e)&&(e=e.slice(1,-1)),/["'() \t\n]/.test(e)?'"'+e.replace(/"/g,'\\"').replace(/\n/g,"\\n")+'"':e)}},function(e,t,i){e.exports=i.p+"images/0ac1be82bd79e6be47a32376d286480f.png"},function(e,t,i){(e.exports=i(27)(!1)).push([e.i,".cesium-viewer {\r\n    font-family: sans-serif;\r\n    font-size: 16px;\r\n    overflow: hidden;\r\n    display: block;\r\n    position: relative;\r\n    top: 0;\r\n    left: 0;\r\n    width: 100%;\r\n    height: 100%;\r\n}\r\n\r\n.cesium-viewer-cesiumWidgetContainer {\r\n    width: 100%;\r\n    height: 100%;\r\n}\r\n\r\n.cesium-viewer-bottom {\r\n    display: block;\r\n    position: absolute;\r\n    bottom: 0;\r\n    left: 0;\r\n    right: 0;\r\n    padding-right: 5px;\r\n}\r\n\r\n.cesium-viewer .cesium-widget-credits {\r\n    display: inline;\r\n    position: static;\r\n    bottom: auto;\r\n    left: auto;\r\n    padding-right: 0;\r\n    color: #ffffff;\r\n    font-size: 10px;\r\n    text-shadow: 0 0 2px #000000;\r\n}\r\n\r\n.cesium-viewer-timelineContainer {\r\n    position: absolute;\r\n    bottom: 0;\r\n    left: 169px;\r\n    right: 29px;\r\n    height: 27px;\r\n    padding: 0;\r\n    margin: 0;\r\n    overflow: hidden;\r\n    font-size: 14px;\r\n}\r\n\r\n.cesium-viewer-animationContainer {\r\n    position: absolute;\r\n    bottom: 0;\r\n    left: 0;\r\n    padding: 0;\r\n    width: 169px;\r\n    height: 112px;\r\n}\r\n\r\n.cesium-viewer-fullscreenContainer {\r\n    position: absolute;\r\n    bottom: 0;\r\n    right: 0;\r\n    padding: 0;\r\n    width: 29px;\r\n    height: 29px;\r\n    overflow: hidden;\r\n}\r\n\r\n.cesium-viewer-vrContainer {\r\n    position: absolute;\r\n    bottom: 0;\r\n    right: 0;\r\n    padding: 0;\r\n    width: 29px;\r\n    height: 29px;\r\n    overflow: hidden;\r\n}\r\n\r\n.cesium-viewer-toolbar {\r\n    display: block;\r\n    position: absolute;\r\n    top: 5px;\r\n    right: 5px;\r\n}\r\n\r\n.cesium-viewer-cesiumInspectorContainer {\r\n    display: block;\r\n    position: absolute;\r\n    top: 50px;\r\n    right: 10px;\r\n}\r\n\r\n.cesium-viewer-geocoderContainer {\r\n    position: relative;\r\n    display: inline-block;\r\n    margin: 0 3px;\r\n}\r\n\r\n.cesium-viewer-cesium3DTilesInspectorContainer {\r\n    display: block;\r\n    position: absolute;\r\n    top: 50px;\r\n    right: 10px;\r\n    max-height: calc(100% - 120px);\r\n    box-sizing: border-box;\r\n    overflow-y: auto;\r\n    overflow-x: hidden;\r\n}\r\n",""])},function(e,t){e.exports=function(e){var t="undefined"!=typeof window&&window.location;if(!t)throw new Error("fixUrls requires window.location");if(!e||"string"!=typeof e)return e;var i=t.protocol+"//"+t.host,n=i+t.pathname.replace(/\/[^\/]*$/,"/");return e.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,(function(e,t){var r,a=t.trim().replace(/^"(.*)"$/,(function(e,t){return t})).replace(/^'(.*)'$/,(function(e,t){return t}));return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(a)?e:(r=0===a.indexOf("//")?a:0===a.indexOf("/")?i+a:n+a.replace(/^\.\//,""),"url("+JSON.stringify(r)+")")}))}},function(e,t,i){"use strict";var n=i(92),r=i(31),a=i(176),o=[].slice,s={},c=function(e,t,i){if(!(t in s)){for(var n=[],r=0;r<t;r++)n[r]="a["+r+"]";s[t]=Function("F,a","return new F("+n.join(",")+")")}return s[t](e,i)};e.exports=Function.bind||function(e){var t=n(this),i=o.call(arguments,1),s=function(){var n=i.concat(o.call(arguments));return this instanceof s?c(t,n.length,n):a(t,n,e)};return r(t.prototype)&&(s.prototype=t.prototype),s}},function(e,t,i){var n=i(16),r=i(69),a=i(35),o=i(284),s="["+o+"]",c=RegExp("^"+s+s+"*"),l=RegExp(s+s+"*$"),u=function(e,t,i){var r={},s=a((function(){return!!o[e]()||"​"!="​"[e]()})),c=r[e]=s?t(h):o[e];i&&(r[i]=c),n(n.P+n.F*s,"String",r)},h=u.trim=function(e,t){return e=String(r(e)),1&t&&(e=e.replace(c,"")),2&t&&(e=e.replace(l,"")),e};e.exports=u},function(e,t){e.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},function(e,t,i){"use strict";var n=i(16),r=i(112)(!0);n(n.P,"Array",{includes:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}}),i(118)("includes")},function(e,t,i){"use strict";var n=i(16),r=i(184);n(n.P+n.F*i(185)("includes"),"String",{includes:function(e){return!!~r(this,e,"includes").indexOf(e,arguments.length>1?arguments[1]:void 0)}})},function(e,t,i){"use strict";var n=i(180),r=i(143);e.exports=i(181)("Set",(function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}}),{add:function(e){return n.def(r(this,"Set"),e=0===e?0:e,e)}},n)},function(e,t,i){"use strict";var n=i(16),r=i(98)(5),a=!0;"find"in[]&&Array(1).find((function(){a=!1})),n(n.P+n.F*a,"Array",{find:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}}),i(118)("find")},function(e,t){e.exports=function(e){if(!e.webpackPolyfill){var t=Object.create(e);t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),Object.defineProperty(t,"exports",{enumerable:!0}),t.webpackPolyfill=1}return t}},function(e,t,i){"use strict";var n=i(16),r=i(42),a=i(184),o="".startsWith;n(n.P+n.F*i(185)("startsWith"),"String",{startsWith:function(e){var t=a(this,e,"startsWith"),i=r(Math.min(arguments.length>1?arguments[1]:void 0,t.length)),n=String(e);return o?o.call(t,n,i):t.slice(i,i+n.length)===n}})},function(e,t,i){var n=i(16);n(n.S,"Math",{trunc:function(e){return(e>0?Math.floor:Math.ceil)(e)}})},function(e,t,i){var n=i(16);n(n.S,"Math",{clz32:function(e){return(e>>>=0)?31-Math.floor(Math.log(e+.5)*Math.LOG2E):32}})},function(e,t,i){var n=i(16);n(n.S,"Math",{fround:i(294)})},function(e,t,i){var n=i(295),r=Math.pow,a=r(2,-52),o=r(2,-23),s=r(2,127)*(2-o),c=r(2,-126);e.exports=Math.fround||function(e){var t,i,r=Math.abs(e),l=n(e);return r<c?l*(r/c/o+1/a-1/a)*c*o:(i=(t=(1+o/a)*r)-(t-r))>s||i!=i?l*(1/0):l*i}},function(e,t){e.exports=Math.sign||function(e){return 0==(e=+e)||e!=e?e:e<0?-1:1}},function(e,t,i){var n=i(16),r=Math.imul;n(n.S+n.F*i(35)((function(){return-5!=r(4294967295,5)||2!=r.length})),"Math",{imul:function(e,t){var i=+e,n=+t,r=65535&i,a=65535&n;return 0|r*a+((65535&i>>>16)*a+r*(65535&n>>>16)<<16>>>0)}})},function(e,t,i){i(60)("Float64",8,(function(e){return function(t,i,n){return e(this,t,i,n)}}))},function(e,t,i){"use strict";var n=i(26),r=i(34),a=i(63),o=i(187),s=i(44),c=i(102),l=i(35),u=i(101),h=i(56),d=i(42),f=i(188),p=i(72).f,m=i(33).f,_=i(144),g=i(75),v="prototype",b="Wrong index!",y=n.ArrayBuffer,w=n.DataView,O=n.Math,x=n.RangeError,E=n.Infinity,T=y,C=O.abs,S=O.pow,A=O.floor,P=O.log,I=O.LN2,D=r?"_b":"buffer",j=r?"_l":"byteLength",M=r?"_o":"byteOffset";function R(e,t,i){var n,r,a,o=new Array(i),s=8*i-t-1,c=(1<<s)-1,l=c>>1,u=23===t?S(2,-24)-S(2,-77):0,h=0,d=e<0||0===e&&1/e<0?1:0;for((e=C(e))!=e||e===E?(r=e!=e?1:0,n=c):(n=A(P(e)/I),e*(a=S(2,-n))<1&&(n--,a*=2),(e+=n+l>=1?u/a:u*S(2,1-l))*a>=2&&(n++,a/=2),n+l>=c?(r=0,n=c):n+l>=1?(r=(e*a-1)*S(2,t),n+=l):(r=e*S(2,l-1)*S(2,t),n=0));t>=8;o[h++]=255&r,r/=256,t-=8);for(n=n<<t|r,s+=t;s>0;o[h++]=255&n,n/=256,s-=8);return o[--h]|=128*d,o}function L(e,t,i){var n,r=8*i-t-1,a=(1<<r)-1,o=a>>1,s=r-7,c=i-1,l=e[c--],u=127&l;for(l>>=7;s>0;u=256*u+e[c],c--,s-=8);for(n=u&(1<<-s)-1,u>>=-s,s+=t;s>0;n=256*n+e[c],c--,s-=8);if(0===u)u=1-o;else{if(u===a)return n?NaN:l?-E:E;n+=S(2,t),u-=o}return(l?-1:1)*n*S(2,u-t)}function N(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]}function F(e){return[255&e]}function k(e){return[255&e,e>>8&255]}function B(e){return[255&e,e>>8&255,e>>16&255,e>>24&255]}function z(e){return R(e,52,8)}function U(e){return R(e,23,4)}function V(e,t,i){m(e[v],t,{get:function(){return this[i]}})}function H(e,t,i,n){var r=f(+i);if(r+t>e[j])throw x(b);var a=e[D]._b,o=r+e[M],s=a.slice(o,o+t);return n?s:s.reverse()}function G(e,t,i,n,r,a){var o=f(+i);if(o+t>e[j])throw x(b);for(var s=e[D]._b,c=o+e[M],l=n(+r),u=0;u<t;u++)s[c+u]=l[a?u:t-u-1]}if(o.ABV){if(!l((function(){y(1)}))||!l((function(){new y(-1)}))||l((function(){return new y,new y(1.5),new y(NaN),"ArrayBuffer"!=y.name}))){for(var q,W=(y=function(e){return u(this,y),new T(f(e))})[v]=T[v],Y=p(T),X=0;Y.length>X;)(q=Y[X++])in y||s(y,q,T[q]);a||(W.constructor=y)}var Z=new w(new y(2)),Q=w[v].setInt8;Z.setInt8(0,2147483648),Z.setInt8(1,2147483649),!Z.getInt8(0)&&Z.getInt8(1)||c(w[v],{setInt8:function(e,t){Q.call(this,e,t<<24>>24)},setUint8:function(e,t){Q.call(this,e,t<<24>>24)}},!0)}else y=function(e){u(this,y,"ArrayBuffer");var t=f(e);this._b=_.call(new Array(t),0),this[j]=t},w=function(e,t,i){u(this,w,"DataView"),u(e,y,"DataView");var n=e[j],r=h(t);if(r<0||r>n)throw x("Wrong offset!");if(r+(i=void 0===i?n-r:d(i))>n)throw x("Wrong length!");this[D]=e,this[M]=r,this[j]=i},r&&(V(y,"byteLength","_l"),V(w,"buffer","_b"),V(w,"byteLength","_l"),V(w,"byteOffset","_o")),c(w[v],{getInt8:function(e){return H(this,1,e)[0]<<24>>24},getUint8:function(e){return H(this,1,e)[0]},getInt16:function(e){var t=H(this,2,e,arguments[1]);return(t[1]<<8|t[0])<<16>>16},getUint16:function(e){var t=H(this,2,e,arguments[1]);return t[1]<<8|t[0]},getInt32:function(e){return N(H(this,4,e,arguments[1]))},getUint32:function(e){return N(H(this,4,e,arguments[1]))>>>0},getFloat32:function(e){return L(H(this,4,e,arguments[1]),23,4)},getFloat64:function(e){return L(H(this,8,e,arguments[1]),52,8)},setInt8:function(e,t){G(this,1,e,F,t)},setUint8:function(e,t){G(this,1,e,F,t)},setInt16:function(e,t){G(this,2,e,k,t,arguments[2])},setUint16:function(e,t){G(this,2,e,k,t,arguments[2])},setInt32:function(e,t){G(this,4,e,B,t,arguments[2])},setUint32:function(e,t){G(this,4,e,B,t,arguments[2])},setFloat32:function(e,t){G(this,4,e,U,t,arguments[2])},setFloat64:function(e,t){G(this,8,e,z,t,arguments[2])}});g(y,"ArrayBuffer"),g(w,"DataView"),s(w[v],o.VIEW,!0),t.ArrayBuffer=y,t.DataView=w},function(e,t,i){"use strict";var n=i(48),r=i(113),a=i(42);e.exports=[].copyWithin||function(e,t){var i=n(this),o=a(i.length),s=r(e,o),c=r(t,o),l=arguments.length>2?arguments[2]:void 0,u=Math.min((void 0===l?o:r(l,o))-c,o-s),h=1;for(c<s&&s<c+u&&(h=-1,c+=u-1,s+=u-1);u-- >0;)c in i?i[s]=i[c]:delete i[s],s+=h,c+=h;return i}},function(e,t,i){i(60)("Float32",4,(function(e){return function(t,i,n){return e(this,t,i,n)}}))},function(e,t,i){i(60)("Uint32",4,(function(e){return function(t,i,n){return e(this,t,i,n)}}))},function(e,t,i){i(60)("Uint16",2,(function(e){return function(t,i,n){return e(this,t,i,n)}}))},function(e,t,i){i(60)("Int32",4,(function(e){return function(t,i,n){return e(this,t,i,n)}}))},function(e,t,i){i(60)("Int16",2,(function(e){return function(t,i,n){return e(this,t,i,n)}}))},function(e,t,i){i(60)("Int8",1,(function(e){return function(t,i,n){return e(this,t,i,n)}}))},function(e,t,i){"use strict";var n=i(16),r=i(57),a=i(56),o=i(42),s=[].lastIndexOf,c=!!s&&1/[1].lastIndexOf(1,-0)<0;n(n.P+n.F*(c||!i(99)(s)),"Array",{lastIndexOf:function(e){if(c)return s.apply(this,arguments)||0;var t=r(this),i=o(t.length),n=i-1;for(arguments.length>1&&(n=Math.min(n,a(arguments[1]))),n<0&&(n=i+n);n>=0;n--)if(n in t&&t[n]===e)return n||0;return-1}})},function(e,t,i){i(60)("Uint8",1,(function(e){return function(t,i,n){return e(this,t,i,n)}}))},function(e,t){},function(e,t,i){var n=i(33),r=i(71),a=i(119),o=i(49),s=i(16),c=i(65),l=i(32),u=i(31);s(s.S,"Reflect",{set:function e(t,i,s){var h,d,f=arguments.length<4?t:arguments[3],p=r.f(l(t),i);if(!p){if(u(d=a(t)))return e(d,i,s,f);p=c(0)}if(o(p,"value")){if(!1===p.writable||!u(f))return!1;if(h=r.f(f,i)){if(h.get||h.set||!1===h.writable)return!1;h.value=s,n.f(f,i,h)}else n.f(f,i,c(0,s));return!0}return void 0!==p.set&&(p.set.call(f,s),!0)}})},function(e,t,i){var n=i(311);"string"==typeof n&&(n=[[e.i,n,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};i(178)(n,r);n.locals&&(e.exports=n.locals)},function(e,t,i){(e.exports=i(27)(!1)).push([e.i,".cesium-viewer-fullscreenContainer {\n  right: 0;\n  top: 0;\n  width: 40px;\n  height: 40px;\n}\n.cesium-button {\n  background: #00000080;\n}\n",""])},function(e,t,i){"use strict";
/*! multi-integer-range (c) 2015 Soichiro Miki */var n=function(){function e(t){function i(e){return"[object Array]"===Object.prototype.toString.call(e)}if(this.ranges=[],"string"==typeof t)this.parseString(t);else if("number"==typeof t)this.appendRange(t,t);else if(t instanceof e)this.ranges=t.getRanges();else if(i(t))for(var n=0,r=t;n<r.length;n++){var a=r[n];if(i(a)){if(2!==a.length)throw new TypeError("Invalid array initializer");this.appendRange(a[0],a[1])}else{if("number"!=typeof a)throw new TypeError("Invalid array initialzer");this.append(a)}}else if(void 0!==t)throw new TypeError("Invalid input")}return e.prototype.parseString=function(e){function t(e){var t=e.match(/^\(?(\-?\d+)/);return parseInt(t[1],10)}var i=e.replace(/\s/g,"");if(i.length)for(var n,r=0,a=i.split(",");r<a.length;r++){var o=a[r];if(n=o.match(/^(\d+|\(\-?\d+\))$/)){var s=t(n[1]);this.appendRange(s,s)}else{if(!(n=o.match(/^(\d+|\(\-?\d+\))?\-(\d+|\(\-?\d+\))?$/)))throw new SyntaxError("Invalid input");var c=void 0===n[1]?-1/0:t(n[1]),l=void 0===n[2]?1/0:t(n[2]);this.appendRange(c,l)}}},e.prototype.clone=function(){return new e(this)},e.prototype.append=function(t){if(void 0===t)throw new TypeError("Invalid input");if(t instanceof e){for(var i=0,n=t.ranges;i<n.length;i++){var r=n[i];this.appendRange(r[0],r[1])}return this}return this.append(new e(t))},e.prototype.appendRange=function(e,t){var i=[e,t];if(i[0]>i[1]&&(i=[i[1],i[0]]),i[0]===1/0&&i[1]===1/0||i[0]===-1/0&&i[1]===-1/0)throw new RangeError("Infinity can be used only within an unbounded range segment");var n=this.findOverlap(i);return this.ranges.splice(n.lo,n.count,n.union),this},e.prototype.subtract=function(t){if(void 0===t)throw new TypeError("Invalid input");if(t instanceof e){for(var i=0,n=t.ranges;i<n.length;i++){var r=n[i];this.subtractRange(r[0],r[1])}return this}return this.subtract(new e(t))},e.prototype.subtractRange=function(e,t){var i=[e,t];i[0]>i[1]&&(i=[i[1],i[0]]);var n=this.findOverlap(i);if(n.count>0){var r=[];this.ranges[n.lo][0]<i[0]&&r.push([this.ranges[n.lo][0],i[0]-1]),i[1]<this.ranges[n.lo+n.count-1][1]&&r.push([i[1]+1,this.ranges[n.lo+n.count-1][1]]),this.ranges.splice.apply(this.ranges,[n.lo,n.count].concat(r))}return this},e.prototype.intersect=function(t){if(void 0===t)throw new TypeError("Invalid input");if(t instanceof e){for(var i=[],n=0,r=0;r<this.ranges.length;r++)for(var a=this.ranges[r],o=n;o<t.ranges.length;o++){var s=t.ranges[o];if(a[0]<=s[1]&&a[1]>=s[0]){n=o;var c=Math.max(a[0],s[0]),l=Math.min(a[1],s[1]);i.push([c,l])}else if(a[1]<s[0])break}return this.ranges=i,this}return this.intersect(new e(t))},e.prototype.findOverlap=function(e){for(var t=this.ranges.length-1;t>=0;t--){var i=this.ranges[t],n=void 0;if(n=this.calcUnion(i,e)){for(var r=1,a=void 0;t-r>=0&&(a=this.calcUnion(n,this.ranges[t-r]));)n=a,r++;return{lo:t+1-r,count:r,union:n}}if(i[1]<e[0])return{lo:t+1,count:0,union:e}}return{lo:0,count:0,union:e}},e.prototype.calcUnion=function(e,t){return e[1]+1<t[0]||e[0]-1>t[1]?null:[Math.min(e[0],t[0]),Math.max(e[1],t[1])]},e.prototype.getRanges=function(){for(var e=[],t=0,i=this.ranges;t<i.length;t++){var n=i[t];e.push([n[0],n[1]])}return e},e.prototype.has=function(t){if(void 0===t)throw new TypeError("Invalid input");if(t instanceof e){for(var i=this.ranges.length,n=0,r=t.ranges;n<r.length;n++){var a=r[n],o=void 0;for(o=0;o<i;o++){var s=this.ranges[o];if(a[0]>=s[0]&&a[1]<=s[1]&&a[1]>=s[0]&&a[1]<=s[1])break}if(o===i)return!1}return!0}return this.has(new e(t))},e.prototype.hasRange=function(t,i){return this.has(new e([[t,i]]))},e.prototype.segmentLength=function(){return this.ranges.length},e.prototype.length=function(){if(this.isUnbounded())return 1/0;for(var e=0,t=0,i=this.ranges;t<i.length;t++){var n=i[t];e+=n[1]-n[0]+1}return e},e.prototype.equals=function(t){if(void 0===t)throw new TypeError("Invalid input");if(t instanceof e){if(t===this)return!0;if(this.ranges.length!==t.ranges.length)return!1;for(var i=0;i<this.ranges.length;i++)if(this.ranges[i][0]!==t.ranges[i][0]||this.ranges[i][1]!==t.ranges[i][1])return!1;return!0}return this.equals(new e(t))},e.prototype.isUnbounded=function(){return this.ranges.length>0&&(this.ranges[0][0]===-1/0||this.ranges[this.ranges.length-1][1]===1/0)},e.prototype.min=function(){if(0!==this.ranges.length)return this.ranges[0][0]},e.prototype.max=function(){if(0!==this.ranges.length)return this.ranges[this.ranges.length-1][1]},e.prototype.shift=function(){var e=this.min();if(e===-1/0)throw new RangeError("shift() was invoked on an unbounded MultiRange which contains -Infinity");return void 0!==e&&this.subtract(e),e},e.prototype.pop=function(){var e=this.max();if(e===1/0)throw new RangeError("pop() was invoked on an unbounded MultiRange which contains +Infinity");return void 0!==e&&this.subtract(e),e},e.prototype.toString=function(){function e(e){return e>=0?String(e):"("+e+")"}for(var t=[],i=0,n=this.ranges;i<n.length;i++){var r=n[i];r[0]===-1/0?r[1]===1/0?t.push("-"):t.push("-"+e(r[1])):r[1]===1/0?t.push(e(r[0])+"-"):r[0]==r[1]?t.push(e(r[0])):t.push(e(r[0])+"-"+e(r[1]))}return t.join(",")},e.prototype.toArray=function(){if(this.isUnbounded())throw new RangeError("You cannot build an array from an unbounded range");for(var e=new Array(this.length()),t=0,i=0,n=this.ranges;i<n.length;i++)for(var r=n[i],a=r[0];a<=r[1];a++)e[t++]=a;return e},e.prototype.getIterator=function(){var e=this;if(this.isUnbounded())throw new RangeError("Unbounded ranges cannot be iterated over");var t=0,i=this.ranges[t],n=i?i[0]:void 0;return{next:function(){if(!i)return{done:!0};var r=n;return++n>i[1]&&(i=e.ranges[++t],n=i?i[0]:void 0),{value:r}}}},e}();t.MultiRange=n,"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator&&(n.prototype[Symbol.iterator]=n.prototype.getIterator),t.multirange=function(e){return new n(e)}},function(e,t,i){"use strict";(function(t,n){var r=i(189),a=i(145),o=i(316).GifReader,s=(i(317),i(191),i(322));function c(e,t){var i;try{i=new o(e)}catch(e){return void t(e)}if(i.numFrames()>0){var n=[],r=[i.numFrames(),i.height,i.width,4],s=new Uint8Array(r[0]*r[1]*r[2]*r[3]),c=a(s,r);try{for(var l=0;l<i.numFrames();++l)i.decodeAndBlitFrameRGBA(l,s.subarray(c.index(l,0,0,0),c.index(l+1,0,0,0))),n.push(i.frameInfo(l))}catch(e){return void t(e)}t(null,c.transpose(0,2,1),n)}else{r=[i.height,i.width,4],s=new Uint8Array(r[0]*r[1]*r[2]),c=a(s,r);try{i.decodeAndBlitFrameRGBA(0,s)}catch(e){return void t(e)}t(null,c.transpose(1,0))}}function l(e,i){t.nextTick((function(){try{var t=s(e);t?c(function(e){if(void 0===e[0]){for(var t=e.length,i=new Uint8Array(t),n=0;n<t;++n)i[n]=e.get(n);return i}return new Uint8Array(e)}(t),i):i(new Error("Error parsing data URI"))}catch(e){i(e)}}))}e.exports=function(e,t,i){i||(i=t,t="");var o=r.extname(e);switch(t||o.toUpperCase()){case".GIF":!function(e,t){var i=new XMLHttpRequest;i.open("GET",e,!0),i.responseType="arraybuffer",i.overrideMimeType&&i.overrideMimeType("application/binary"),i.onerror=function(e){t(e)},i.onload=function(){4===i.readyState&&c(new Uint8Array(i.response),t)},i.send()}(e,i);break;default:n.isBuffer(e)&&(e="data:"+t+";base64,"+e.toString("base64")),0===e.indexOf("data:image/gif;")?l(e,i):function(e,t){var i=new Image;i.crossOrigin="Anonymous",i.onload=function(){var e=document.createElement("canvas");e.width=i.width,e.height=i.height;var n=e.getContext("2d");n.drawImage(i,0,0);var r=n.getImageData(0,0,i.width,i.height);t(null,a(new Uint8Array(r.data),[i.width,i.height,4],[4,4*i.width,1],0))},i.onerror=function(e){t(e)},i.src=e}(e,i)}}}).call(this,i(23),i(15).Buffer)},function(e,t,i){"use strict";e.exports=function(e){for(var t=new Array(e),i=0;i<e;++i)t[i]=i;return t}},function(e,t){function i(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}
/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
e.exports=function(e){return null!=e&&(i(e)||function(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&i(e.slice(0,0))}(e)||!!e._isBuffer)}},function(e,t,i){"use strict";function n(e,t,i,n){for(var r=e[t++],a=1<<r,o=a+1,s=o+1,c=r+1,l=(1<<c)-1,u=0,h=0,d=0,f=e[t++],p=new Int32Array(4096),m=null;;){for(;u<16&&0!==f;)h|=e[t++]<<u,u+=8,1===f?f=e[t++]:--f;if(u<c)break;var _=h&l;if(h>>=c,u-=c,_!==a){if(_===o)break;for(var g=_<s?_:m,v=0,b=g;b>a;)b=p[b]>>8,++v;var y=b;if(d+v+(g!==_?1:0)>n)return void console.log("Warning, gif stream longer than expected.");i[d++]=y;var w=d+=v;for(g!==_&&(i[d++]=y),b=g;v--;)b=p[b],i[--w]=255&b,b>>=8;null!==m&&s<4096&&(p[s++]=m<<8|y,s>=l+1&&c<12&&(++c,l=l<<1|1)),m=_}else s=o+1,l=(1<<(c=r+1))-1,m=null}return d!==n&&console.log("Warning, gif stream shorter than expected."),i}try{t.GifWriter=function(e,t,i,n){var r=0,a=void 0===(n=void 0===n?{}:n).loop?null:n.loop,o=void 0===n.palette?null:n.palette;if(t<=0||i<=0||t>65535||i>65535)throw new Error("Width/Height invalid.");function s(e){var t=e.length;if(t<2||t>256||t&t-1)throw new Error("Invalid code/color length, must be power of 2 and 2 .. 256.");return t}e[r++]=71,e[r++]=73,e[r++]=70,e[r++]=56,e[r++]=57,e[r++]=97;var c=0,l=0;if(null!==o){for(var u=s(o);u>>=1;)++c;if(u=1<<c,--c,void 0!==n.background){if((l=n.background)>=u)throw new Error("Background index out of range.");if(0===l)throw new Error("Background index explicitly passed as 0.")}}if(e[r++]=255&t,e[r++]=t>>8&255,e[r++]=255&i,e[r++]=i>>8&255,e[r++]=(null!==o?128:0)|c,e[r++]=l,e[r++]=0,null!==o)for(var h=0,d=o.length;h<d;++h){var f=o[h];e[r++]=f>>16&255,e[r++]=f>>8&255,e[r++]=255&f}if(null!==a){if(a<0||a>65535)throw new Error("Loop count invalid.");e[r++]=33,e[r++]=255,e[r++]=11,e[r++]=78,e[r++]=69,e[r++]=84,e[r++]=83,e[r++]=67,e[r++]=65,e[r++]=80,e[r++]=69,e[r++]=50,e[r++]=46,e[r++]=48,e[r++]=3,e[r++]=1,e[r++]=255&a,e[r++]=a>>8&255,e[r++]=0}var p=!1;this.addFrame=function(t,i,n,a,c,l){if(!0===p&&(--r,p=!1),l=void 0===l?{}:l,t<0||i<0||t>65535||i>65535)throw new Error("x/y invalid.");if(n<=0||a<=0||n>65535||a>65535)throw new Error("Width/Height invalid.");if(c.length<n*a)throw new Error("Not enough pixels for the frame size.");var u=!0,h=l.palette;if(null==h&&(u=!1,h=o),null==h)throw new Error("Must supply either a local or global palette.");for(var d=s(h),f=0;d>>=1;)++f;d=1<<f;var m=void 0===l.delay?0:l.delay,_=void 0===l.disposal?0:l.disposal;if(_<0||_>3)throw new Error("Disposal out of range.");var g=!1,v=0;if(void 0!==l.transparent&&null!==l.transparent&&(g=!0,(v=l.transparent)<0||v>=d))throw new Error("Transparent color index.");if((0!==_||g||0!==m)&&(e[r++]=33,e[r++]=249,e[r++]=4,e[r++]=_<<2|(!0===g?1:0),e[r++]=255&m,e[r++]=m>>8&255,e[r++]=v,e[r++]=0),e[r++]=44,e[r++]=255&t,e[r++]=t>>8&255,e[r++]=255&i,e[r++]=i>>8&255,e[r++]=255&n,e[r++]=n>>8&255,e[r++]=255&a,e[r++]=a>>8&255,e[r++]=!0===u?128|f-1:0,!0===u)for(var b=0,y=h.length;b<y;++b){var w=h[b];e[r++]=w>>16&255,e[r++]=w>>8&255,e[r++]=255&w}return r=function(e,t,i,n){e[t++]=i;var r=t++,a=1<<i,o=a-1,s=a+1,c=s+1,l=i+1,u=0,h=0;function d(i){for(;u>=i;)e[t++]=255&h,h>>=8,u-=8,t===r+256&&(e[r]=255,r=t++)}function f(e){h|=e<<u,u+=l,d(8)}var p=n[0]&o,m={};f(a);for(var _=1,g=n.length;_<g;++_){var v=n[_]&o,b=p<<8|v,y=m[b];if(void 0===y){for(h|=p<<u,u+=l;u>=8;)e[t++]=255&h,h>>=8,u-=8,t===r+256&&(e[r]=255,r=t++);4096===c?(f(a),c=s+1,l=i+1,m={}):(c>=1<<l&&++l,m[b]=c++),p=v}else p=y}f(p),f(s),d(1),r+1===t?e[r]=0:(e[r]=t-r-1,e[t++]=0);return t}(e,r,f<2?2:f,c)},this.end=function(){return!1===p&&(e[r++]=59,p=!0),r},this.getOutputBuffer=function(){return e},this.setOutputBuffer=function(t){e=t},this.getOutputBufferPosition=function(){return r},this.setOutputBufferPosition=function(e){r=e}},t.GifReader=function(e){var t=0;if(71!==e[t++]||73!==e[t++]||70!==e[t++]||56!==e[t++]||56!=(e[t++]+1&253)||97!==e[t++])throw new Error("Invalid GIF 87a/89a header.");var i=e[t++]|e[t++]<<8,r=e[t++]|e[t++]<<8,a=e[t++],o=a>>7,s=1<<(7&a)+1;e[t++],e[t++];var c=null,l=null;o&&(c=t,l=s,t+=3*s);var u=!0,h=[],d=0,f=null,p=0,m=null;for(this.width=i,this.height=r;u&&t<e.length;)switch(e[t++]){case 33:switch(e[t++]){case 255:if(11!==e[t]||78==e[t+1]&&69==e[t+2]&&84==e[t+3]&&83==e[t+4]&&67==e[t+5]&&65==e[t+6]&&80==e[t+7]&&69==e[t+8]&&50==e[t+9]&&46==e[t+10]&&48==e[t+11]&&3==e[t+12]&&1==e[t+13]&&0==e[t+16])t+=14,m=e[t++]|e[t++]<<8,t++;else for(t+=12;;){if(!((A=e[t++])>=0))throw Error("Invalid block size");if(0===A)break;t+=A}break;case 249:if(4!==e[t++]||0!==e[t+4])throw new Error("Invalid graphics extension block.");var _=e[t++];d=e[t++]|e[t++]<<8,f=e[t++],0==(1&_)&&(f=null),p=_>>2&7,t++;break;case 254:for(;;){if(!((A=e[t++])>=0))throw Error("Invalid block size");if(0===A)break;t+=A}break;default:throw new Error("Unknown graphic control label: 0x"+e[t-1].toString(16))}break;case 44:var g=e[t++]|e[t++]<<8,v=e[t++]|e[t++]<<8,b=e[t++]|e[t++]<<8,y=e[t++]|e[t++]<<8,w=e[t++],O=w>>6&1,x=1<<(7&w)+1,E=c,T=l,C=!1;if(w>>7){C=!0;E=t,T=x,t+=3*x}var S=t;for(t++;;){var A;if(!((A=e[t++])>=0))throw Error("Invalid block size");if(0===A)break;t+=A}h.push({x:g,y:v,width:b,height:y,has_local_palette:C,palette_offset:E,palette_size:T,data_offset:S,data_length:t-S,transparent_index:f,interlaced:!!O,delay:d,disposal:p});break;case 59:u=!1;break;default:throw new Error("Unknown gif block: 0x"+e[t-1].toString(16))}this.numFrames=function(){return h.length},this.loopCount=function(){return m},this.frameInfo=function(e){if(e<0||e>=h.length)throw new Error("Frame index out of range.");return h[e]},this.decodeAndBlitFrameBGRA=function(t,r){var a=this.frameInfo(t),o=a.width*a.height,s=new Uint8Array(o);n(e,a.data_offset,s,o);var c=a.palette_offset,l=a.transparent_index;null===l&&(l=256);var u=a.width,h=i-u,d=u,f=4*(a.y*i+a.x),p=4*((a.y+a.height)*i+a.x),m=f,_=4*h;!0===a.interlaced&&(_+=4*i*7);for(var g=8,v=0,b=s.length;v<b;++v){var y=s[v];if(0===d&&(d=u,(m+=_)>=p&&(_=4*h+4*i*(g-1),m=f+(u+h)*(g<<1),g>>=1)),y===l)m+=4;else{var w=e[c+3*y],O=e[c+3*y+1],x=e[c+3*y+2];r[m++]=x,r[m++]=O,r[m++]=w,r[m++]=255}--d}},this.decodeAndBlitFrameRGBA=function(t,r){var a=this.frameInfo(t),o=a.width*a.height,s=new Uint8Array(o);n(e,a.data_offset,s,o);var c=a.palette_offset,l=a.transparent_index;null===l&&(l=256);var u=a.width,h=i-u,d=u,f=4*(a.y*i+a.x),p=4*((a.y+a.height)*i+a.x),m=f,_=4*h;!0===a.interlaced&&(_+=4*i*7);for(var g=8,v=0,b=s.length;v<b;++v){var y=s[v];if(0===d&&(d=u,(m+=_)>=p&&(_=4*h+4*i*(g-1),m=f+(u+h)*(g<<1),g>>=1)),y===l)m+=4;else{var w=e[c+3*y],O=e[c+3*y+1],x=e[c+3*y+2];r[m++]=w,r[m++]=O,r[m++]=x,r[m++]=255}--d}}}}catch(e){}},function(e,t,i){"use strict";var n=i(145),r=i(318);e.exports=function(e,t){for(var i=[],a=e,o=1;Array.isArray(a);)i.push(a.length),o*=a.length,a=a[0];return 0===i.length?n():(t||(t=n(new Float64Array(o),i)),r(t,e),t)}},function(e,t,i){e.exports=i(190)({args:["array","scalar","index"],pre:{body:"{}",args:[],thisVars:[],localVars:[]},body:{body:"{\nvar _inline_1_v=_inline_1_arg1_,_inline_1_i\nfor(_inline_1_i=0;_inline_1_i<_inline_1_arg2_.length-1;++_inline_1_i) {\n_inline_1_v=_inline_1_v[_inline_1_arg2_[_inline_1_i]]\n}\n_inline_1_arg0_=_inline_1_v[_inline_1_arg2_[_inline_1_arg2_.length-1]]\n}",args:[{name:"_inline_1_arg0_",lvalue:!0,rvalue:!1,count:1},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_1_arg2_",lvalue:!1,rvalue:!0,count:4}],thisVars:[],localVars:["_inline_1_i","_inline_1_v"]},post:{body:"{}",args:[],thisVars:[],localVars:[]},funcName:"convert",blockSize:64})},function(e,t,i){"use strict";var n=i(320);e.exports=function(e){var t=["'use strict'","var CACHED={}"],i=[],r=e.funcName+"_cwise_thunk";t.push(["return function ",r,"(",e.shimArgs.join(","),"){"].join(""));for(var a=[],o=[],s=[["array",e.arrayArgs[0],".shape.slice(",Math.max(0,e.arrayBlockIndices[0]),e.arrayBlockIndices[0]<0?","+e.arrayBlockIndices[0]+")":")"].join("")],c=[],l=[],u=0;u<e.arrayArgs.length;++u){var h=e.arrayArgs[u];i.push(["t",h,"=array",h,".dtype,","r",h,"=array",h,".order"].join("")),a.push("t"+h),a.push("r"+h),o.push("t"+h),o.push("r"+h+".join()"),s.push("array"+h+".data"),s.push("array"+h+".stride"),s.push("array"+h+".offset|0"),u>0&&(c.push("array"+e.arrayArgs[0]+".shape.length===array"+h+".shape.length+"+(Math.abs(e.arrayBlockIndices[0])-Math.abs(e.arrayBlockIndices[u]))),l.push("array"+e.arrayArgs[0]+".shape[shapeIndex+"+Math.max(0,e.arrayBlockIndices[0])+"]===array"+h+".shape[shapeIndex+"+Math.max(0,e.arrayBlockIndices[u])+"]"))}for(e.arrayArgs.length>1&&(t.push("if (!("+c.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same dimensionality!')"),t.push("for(var shapeIndex=array"+e.arrayArgs[0]+".shape.length-"+Math.abs(e.arrayBlockIndices[0])+"; shapeIndex--\x3e0;) {"),t.push("if (!("+l.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same shape!')"),t.push("}")),u=0;u<e.scalarArgs.length;++u)s.push("scalar"+e.scalarArgs[u]);return i.push(["type=[",o.join(","),"].join()"].join("")),i.push("proc=CACHED[type]"),t.push("var "+i.join(",")),t.push(["if(!proc){","CACHED[type]=proc=compile([",a.join(","),"])}","return proc(",s.join(","),")}"].join("")),e.debug&&console.log("-----Generated thunk:\n"+t.join("\n")+"\n----------"),new Function("compile",t.join("\n"))(n.bind(void 0,e))}},function(e,t,i){"use strict";var n=i(321);function r(e,t,i){var n,r,a=e.length,o=t.arrayArgs.length,s=t.indexArgs.length>0,c=[],l=[],u=0,h=0;for(n=0;n<a;++n)l.push(["i",n,"=0"].join(""));for(r=0;r<o;++r)for(n=0;n<a;++n)h=u,u=e[n],0===n?l.push(["d",r,"s",n,"=t",r,"p",u].join("")):l.push(["d",r,"s",n,"=(t",r,"p",u,"-s",h,"*t",r,"p",h,")"].join(""));for(l.length>0&&c.push("var "+l.join(",")),n=a-1;n>=0;--n)u=e[n],c.push(["for(i",n,"=0;i",n,"<s",u,";++i",n,"){"].join(""));for(c.push(i),n=0;n<a;++n){for(h=u,u=e[n],r=0;r<o;++r)c.push(["p",r,"+=d",r,"s",n].join(""));s&&(n>0&&c.push(["index[",h,"]-=s",h].join("")),c.push(["++index[",u,"]"].join(""))),c.push("}")}return c.join("\n")}function a(e,t,i){for(var n=e.body,r=[],a=[],o=0;o<e.args.length;++o){var s=e.args[o];if(!(s.count<=0)){var c=new RegExp(s.name,"g"),l="",u=t.arrayArgs.indexOf(o);switch(t.argTypes[o]){case"offset":var h=t.offsetArgIndex.indexOf(o);u=t.offsetArgs[h].array,l="+q"+h;case"array":l="p"+u+l;var d="l"+o,f="a"+u;if(0===t.arrayBlockIndices[u])1===s.count?"generic"===i[u]?s.lvalue?(r.push(["var ",d,"=",f,".get(",l,")"].join("")),n=n.replace(c,d),a.push([f,".set(",l,",",d,")"].join(""))):n=n.replace(c,[f,".get(",l,")"].join("")):n=n.replace(c,[f,"[",l,"]"].join("")):"generic"===i[u]?(r.push(["var ",d,"=",f,".get(",l,")"].join("")),n=n.replace(c,d),s.lvalue&&a.push([f,".set(",l,",",d,")"].join(""))):(r.push(["var ",d,"=",f,"[",l,"]"].join("")),n=n.replace(c,d),s.lvalue&&a.push([f,"[",l,"]=",d].join("")));else{for(var p=[s.name],m=[l],_=0;_<Math.abs(t.arrayBlockIndices[u]);_++)p.push("\\s*\\[([^\\]]+)\\]"),m.push("$"+(_+1)+"*t"+u+"b"+_);if(c=new RegExp(p.join(""),"g"),l=m.join("+"),"generic"===i[u])throw new Error("cwise: Generic arrays not supported in combination with blocks!");n=n.replace(c,[f,"[",l,"]"].join(""))}break;case"scalar":n=n.replace(c,"Y"+t.scalarArgs.indexOf(o));break;case"index":n=n.replace(c,"index");break;case"shape":n=n.replace(c,"shape")}}}return[r.join("\n"),n,a.join("\n")].join("\n").trim()}function o(e){for(var t=new Array(e.length),i=!0,n=0;n<e.length;++n){var r=e[n],a=r.match(/\d+/);a=a?a[0]:"",0===r.charAt(0)?t[n]="u"+r.charAt(1)+a:t[n]=r.charAt(0)+a,n>0&&(i=i&&t[n]===t[n-1])}return i?t[0]:t.join("")}e.exports=function(e,t){for(var i=t[1].length-Math.abs(e.arrayBlockIndices[0])|0,s=new Array(e.arrayArgs.length),c=new Array(e.arrayArgs.length),l=0;l<e.arrayArgs.length;++l)c[l]=t[2*l],s[l]=t[2*l+1];var u=[],h=[],d=[],f=[],p=[];for(l=0;l<e.arrayArgs.length;++l){e.arrayBlockIndices[l]<0?(d.push(0),f.push(i),u.push(i),h.push(i+e.arrayBlockIndices[l])):(d.push(e.arrayBlockIndices[l]),f.push(e.arrayBlockIndices[l]+i),u.push(0),h.push(e.arrayBlockIndices[l]));for(var m=[],_=0;_<s[l].length;_++)d[l]<=s[l][_]&&s[l][_]<f[l]&&m.push(s[l][_]-d[l]);p.push(m)}var g=["SS"],v=["'use strict'"],b=[];for(_=0;_<i;++_)b.push(["s",_,"=SS[",_,"]"].join(""));for(l=0;l<e.arrayArgs.length;++l){g.push("a"+l),g.push("t"+l),g.push("p"+l);for(_=0;_<i;++_)b.push(["t",l,"p",_,"=t",l,"[",d[l]+_,"]"].join(""));for(_=0;_<Math.abs(e.arrayBlockIndices[l]);++_)b.push(["t",l,"b",_,"=t",l,"[",u[l]+_,"]"].join(""))}for(l=0;l<e.scalarArgs.length;++l)g.push("Y"+l);if(e.shapeArgs.length>0&&b.push("shape=SS.slice(0)"),e.indexArgs.length>0){var y=new Array(i);for(l=0;l<i;++l)y[l]="0";b.push(["index=[",y.join(","),"]"].join(""))}for(l=0;l<e.offsetArgs.length;++l){var w=e.offsetArgs[l],O=[];for(_=0;_<w.offset.length;++_)0!==w.offset[_]&&(1===w.offset[_]?O.push(["t",w.array,"p",_].join("")):O.push([w.offset[_],"*t",w.array,"p",_].join("")));0===O.length?b.push("q"+l+"=0"):b.push(["q",l,"=",O.join("+")].join(""))}var x=n([].concat(e.pre.thisVars).concat(e.body.thisVars).concat(e.post.thisVars));for((b=b.concat(x)).length>0&&v.push("var "+b.join(",")),l=0;l<e.arrayArgs.length;++l)v.push("p"+l+"|=0");e.pre.body.length>3&&v.push(a(e.pre,e,c));var E=a(e.body,e,c),T=function(e){for(var t=0,i=e[0].length;t<i;){for(var n=1;n<e.length;++n)if(e[n][t]!==e[0][t])return t;++t}return t}(p);T<i?v.push(function(e,t,i,n){for(var a=t.length,o=i.arrayArgs.length,s=i.blockSize,c=i.indexArgs.length>0,l=[],u=0;u<o;++u)l.push(["var offset",u,"=p",u].join(""));for(u=e;u<a;++u)l.push(["for(var j"+u+"=SS[",t[u],"]|0;j",u,">0;){"].join("")),l.push(["if(j",u,"<",s,"){"].join("")),l.push(["s",t[u],"=j",u].join("")),l.push(["j",u,"=0"].join("")),l.push(["}else{s",t[u],"=",s].join("")),l.push(["j",u,"-=",s,"}"].join("")),c&&l.push(["index[",t[u],"]=j",u].join(""));for(u=0;u<o;++u){for(var h=["offset"+u],d=e;d<a;++d)h.push(["j",d,"*t",u,"p",t[d]].join(""));l.push(["p",u,"=(",h.join("+"),")"].join(""))}for(l.push(r(t,i,n)),u=e;u<a;++u)l.push("}");return l.join("\n")}(T,p[0],e,E)):v.push(r(p[0],e,E)),e.post.body.length>3&&v.push(a(e.post,e,c)),e.debug&&console.log("-----Generated cwise routine for ",t,":\n"+v.join("\n")+"\n----------");var C=[e.funcName||"unnamed","_cwise_loop_",s[0].join("s"),"m",T,o(c)].join("");return new Function(["function ",C,"(",g.join(","),"){",v.join("\n"),"} return ",C].join(""))()}},function(e,t,i){"use strict";e.exports=function(e,t,i){return 0===e.length?e:t?(i||e.sort(t),function(e,t){for(var i=1,n=e.length,r=e[0],a=e[0],o=1;o<n;++o)if(a=r,t(r=e[o],a)){if(o===i){i++;continue}e[i++]=r}return e.length=i,e}(e,t)):(i||e.sort(),function(e){for(var t=1,i=e.length,n=e[0],r=e[0],a=1;a<i;++a,r=n)if(r=n,(n=e[a])!==r){if(a===t){t++;continue}e[t++]=n}return e.length=t,e}(e))}},function(e,t,i){(function(t){e.exports=function(e){if(!/^data\:/i.test(e))throw new TypeError('`uri` does not appear to be a Data URI (must begin with "data:")');var i=(e=e.replace(/\r?\n/g,"")).indexOf(",");if(-1===i||i<=4)throw new TypeError("malformed data: URI");for(var n=e.substring(5,i).split(";"),r=!1,a="US-ASCII",o=0;o<n.length;o++)"base64"==n[o]?r=!0:0==n[o].indexOf("charset=")&&(a=n[o].substring(8));var s=unescape(e.substring(i+1)),c=new t(s,r?"base64":"ascii");return c.type=n[0]||"text/plain",c.charset=a,c}}).call(this,i(15).Buffer)},function(e,t,i){"use strict";(function(t){var n=i(324),r=i(327),a=i(333),o=i(336).PNG,s=i(145),c=i(346),l=i(191);function u(e,t,i){if(4===e.shape.length)return u(e.pick(i),t,0);if(3===e.shape.length)if(3===e.shape[2])c.assign(s(t,[e.shape[0],e.shape[1],3],[4,4*e.shape[0],1]),e),c.assigns(s(t,[e.shape[0]*e.shape[1]],[4],3),255);else if(4===e.shape[2])c.assign(s(t,[e.shape[0],e.shape[1],4],[4,4*e.shape[0],1]),e);else{if(1!==e.shape[2])return new Error("Incompatible array shape");c.assign(s(t,[e.shape[0],e.shape[1],3],[4,4*e.shape[0],1]),s(e.data,[e.shape[0],e.shape[1],3],[e.stride[0],e.stride[1],0],e.offset)),c.assigns(s(t,[e.shape[0]*e.shape[1]],[4],3),255)}else{if(2!==e.shape.length)return new Error("Incompatible array shape");c.assign(s(t,[e.shape[0],e.shape[1],3],[4,4*e.shape[0],1]),s(e.data,[e.shape[0],e.shape[1],3],[e.stride[0],e.stride[1],0],e.offset)),c.assigns(s(t,[e.shape[0]*e.shape[1]],[4],3),255)}return t}function h(e){var t=l();return t.emit("error",e),t}e.exports=function(e,i,s){switch(s=s||{},i.toUpperCase()){case"JPG":case".JPG":case"JPEG":case".JPEG":case"JPE":case".JPE":var c=e.shape[0],l=e.shape[1],d={data:m=u(e,m=new t(c*l*4)),width:c,height:l},f=a.encode(d,s.quality);return new n(f.data);case"GIF":case".GIF":var p=4===e.shape.length?e.shape[0]:1,m=(c=4===e.shape.length?e.shape[1]:e.shape[0],l=4===e.shape.length?e.shape[2]:e.shape[1],new t(c*l*4)),_=new r(c,l);_.writeHeader();for(var g=0;g<p;g++)m=u(e,m,g),_.addFrame(m);return _.finish(),_;case"PNG":case".PNG":var v=new o({width:e.shape[0],height:e.shape[1]});return"Error"==typeof(m=u(e,v.data))?h(m):(v.data=m,v.pack());case"CANVAS":var b=document.createElement("canvas"),y=b.getContext("2d");b.width=e.shape[0],b.height=e.shape[1];var w=y.getImageData(0,0,b.width,b.height);return"Error"==typeof(m=u(e,m=w.data))?h(m):(y.putImageData(w,0,0),b);default:return h(new Error("Unsupported file type: "+i))}}}).call(this,i(15).Buffer)},function(e,t,i){"use strict";(function(t){
/**!
 * contentstream - index.js
 *
 * Copyright(c) fengmk2 and other contributors.
 * MIT Licensed
 *
 * Authors:
 *   fengmk2 <fengmk2@gmail.com> (http://fengmk2.github.com)
 */
var n=i(325).Readable,r=i(52);function a(e,t){if(!(this instanceof a))return new a(e,t);n.call(this,t),null==e&&(e=String(e)),this._obj=e}e.exports=a,r.inherits(a,n),a.prototype._read=function(e){var i=this._obj;"string"==typeof i?this.push(new t(i)):t.isBuffer(i)?this.push(i):this.push(new t(JSON.stringify(i))),this.push(null)}}).call(this,i(15).Buffer)},function(e,t,i){(function(n){var r=i(41);(t=e.exports=i(192)).Stream=r,t.Readable=t,t.Writable=i(194),t.Duplex=i(146),t.Transform=i(195),t.PassThrough=i(326),n.browser||"disable"!==n.env.READABLE_STREAM||(e.exports=i(41))}).call(this,i(23))},function(e,t,i){e.exports=a;var n=i(195),r=i(38);function a(e){if(!(this instanceof a))return new a(e);n.call(this,e)}r.inherits=i(30),r.inherits(a,n),a.prototype._transform=function(e,t,i){i(null,e)}},function(e,t,i){(function(t){i(126),i(67).EventEmitter;var n=i(328),r=i(52),a=i(331),o=i(332);function s(e){n.call(this,e),this.okayToPush=!0,this.resetData()}function c(e,t,i){var n=(i=i||{}).highWaterMark;s.call(this,{highWaterMark:n||0===n?n:65536}),this.width=~~e,this.height=~~t,this.transparent=null,this.transIndex=0,this.repeat=-1,this.delay=0,this.pixels=null,this.indexedPixels=null,this.colorDepth=null,this.colorTab=null,this.usedEntry=[],this.palSize=7,this.dispose=-1,this.firstFrame=!0,this.sample=10;var r=this;function a(){r.flushData()}this.on("writeHeader#stop",a),this.on("frame#stop",a),this.on("finish#stop",(function(){a(),r.push(null)}))}r.inherits(s,n),s.prototype._read=function(){this.okayToPush=!0},s.prototype.resetData=function(){this.data=[]},s.prototype.flushData=function(){if(!this.okayToPush){var e=new Error("GIF memory limit exceeded. Please `read` from GIF before writing additional frames/information.");return this.emit("error",e)}var i=new t(this.data);this.resetData(),this.okayToPush=this.push(i)},s.prototype.writeByte=function(e){this.data.push(e)},s.prototype.writeUTFBytes=function(e){for(var t=e.length,i=0;i<t;i++)this.writeByte(e.charCodeAt(i))},s.prototype.writeBytes=function(e,t,i){for(var n=i||e.length,r=t||0;r<n;r++)this.writeByte(e[r])},r.inherits(c,s),c.prototype.setDelay=function(e){this.delay=Math.round(e/10)},c.prototype.setFrameRate=function(e){this.delay=Math.round(100/e)},c.prototype.setDispose=function(e){e>=0&&(this.dispose=e)},c.prototype.setRepeat=function(e){this.repeat=e},c.prototype.setTransparent=function(e){this.transparent=e},c.prototype.analyzeImage=function(e){this.setImagePixels(this.removeAlphaChannel(e)),this.analyzePixels()},c.prototype.writeImageInfo=function(){this.firstFrame&&(this.writeLSD(),this.writePalette(),this.repeat>=0&&this.writeNetscapeExt()),this.writeGraphicCtrlExt(),this.writeImageDesc(),this.firstFrame||this.writePalette(),this.firstFrame=!1},c.prototype.outputImage=function(){this.writePixels()},c.prototype.addFrame=function(e){this.emit("frame#start"),this.analyzeImage(e),this.writeImageInfo(),this.outputImage(),this.emit("frame#stop")},c.prototype.finish=function(){this.emit("finish#start"),this.writeByte(59),this.emit("finish#stop")},c.prototype.setQuality=function(e){e<1&&(e=1),this.sample=e},c.prototype.writeHeader=function(){this.emit("writeHeader#start"),this.writeUTFBytes("GIF89a"),this.emit("writeHeader#stop")},c.prototype.analyzePixels=function(){var e=this.pixels.length/3;this.indexedPixels=new Uint8Array(e);var t=new a(this.pixels,this.sample);t.buildColormap(),this.colorTab=t.getColormap();for(var i=0,n=0;n<e;n++){var r=t.lookupRGB(255&this.pixels[i++],255&this.pixels[i++],255&this.pixels[i++]);this.usedEntry[r]=!0,this.indexedPixels[n]=r}this.pixels=null,this.colorDepth=8,this.palSize=7,null!==this.transparent&&(this.transIndex=this.findClosest(this.transparent))},c.prototype.findClosest=function(e){if(null===this.colorTab)return-1;for(var t=(16711680&e)>>16,i=(65280&e)>>8,n=255&e,r=0,a=16777216,o=this.colorTab.length,s=0;s<o;){var c=t-(255&this.colorTab[s++]),l=i-(255&this.colorTab[s++]),u=n-(255&this.colorTab[s]),h=c*c+l*l+u*u,d=s/3;this.usedEntry[d]&&h<a&&(a=h,r=d),s++}return r},c.prototype.removeAlphaChannel=function(e){for(var t=this.width,i=this.height,n=new Uint8Array(t*i*3),r=0,a=0;a<i;a++)for(var o=0;o<t;o++){var s=a*t*4+4*o;n[r++]=e[s],n[r++]=e[s+1],n[r++]=e[s+2]}return n},c.prototype.setImagePixels=function(e){this.pixels=e},c.prototype.writeGraphicCtrlExt=function(){var e,t;this.writeByte(33),this.writeByte(249),this.writeByte(4),null===this.transparent?(e=0,t=0):(e=1,t=2),this.dispose>=0&&(t=7&dispose),t<<=2,this.writeByte(0|t|e),this.writeShort(this.delay),this.writeByte(this.transIndex),this.writeByte(0)},c.prototype.writeImageDesc=function(){this.writeByte(44),this.writeShort(0),this.writeShort(0),this.writeShort(this.width),this.writeShort(this.height),this.firstFrame?this.writeByte(0):this.writeByte(128|this.palSize)},c.prototype.writeLSD=function(){this.writeShort(this.width),this.writeShort(this.height),this.writeByte(240|this.palSize),this.writeByte(0),this.writeByte(0)},c.prototype.writeNetscapeExt=function(){this.writeByte(33),this.writeByte(255),this.writeByte(11),this.writeUTFBytes("NETSCAPE2.0"),this.writeByte(3),this.writeByte(1),this.writeShort(this.repeat),this.writeByte(0)},c.prototype.writePalette=function(){this.writeBytes(this.colorTab);for(var e=768-this.colorTab.length,t=0;t<e;t++)this.writeByte(0)},c.prototype.writeShort=function(e){this.writeByte(255&e),this.writeByte(e>>8&255)},c.prototype.writePixels=function(){new o(this.width,this.height,this.indexedPixels,this.colorDepth).encode(this)},c.prototype.stream=function(){return this},c.ByteCapacitor=s,e.exports=c}).call(this,i(15).Buffer)},function(e,t,i){(function(n){(t=e.exports=i(196)).Stream=i(41),t.Readable=t,t.Writable=i(197),t.Duplex=i(78),t.Transform=i(198),t.PassThrough=i(330),n.browser||"disable"!==n.env.READABLE_STREAM||(e.exports=i(41))}).call(this,i(23))},function(e,t){},function(e,t,i){e.exports=a;var n=i(198),r=i(38);function a(e){if(!(this instanceof a))return new a(e);n.call(this,e)}r.inherits=i(30),r.inherits(a,n),a.prototype._transform=function(e,t,i){i(null,e)}},function(e,t){var i=100,n=256,r=n-1,a=4,o=16,s=1<<o,c=10,l=10,u=s>>l,h=s<<c-l,d=6,f=(n>>3)*(1<<d),p=30,m=1024,_=256,g=1<<18,v=499,b=491,y=487,w=503,O=3*w;e.exports=function(e,t){var x,E,T,C,S;function A(e,t,i,n,r){x[t][0]-=e*(x[t][0]-i)/m,x[t][1]-=e*(x[t][1]-n)/m,x[t][2]-=e*(x[t][2]-r)/m}function P(e,t,i,r,a){for(var o,s,c=Math.abs(t-e),l=Math.min(t+e,n),u=t+1,h=t-1,d=1;u<l||h>c;)s=S[d++],u<l&&((o=x[u++])[0]-=s*(o[0]-i)/g,o[1]-=s*(o[1]-r)/g,o[2]-=s*(o[2]-a)/g),h>c&&((o=x[h--])[0]-=s*(o[0]-i)/g,o[1]-=s*(o[1]-r)/g,o[2]-=s*(o[2]-a)/g)}function I(e,t,i){var r,s,d,f,p,m=~(1<<31),_=m,g=-1,v=g;for(r=0;r<n;r++)s=x[r],(d=Math.abs(s[0]-e)+Math.abs(s[1]-t)+Math.abs(s[2]-i))<m&&(m=d,g=r),(f=d-(T[r]>>o-a))<_&&(_=f,v=r),p=C[r]>>l,C[r]-=p,T[r]+=p<<c;return C[g]+=u,T[g]-=h,v}this.buildColormap=function(){!function(){var e,t;for(x=[],E=new Int32Array(256),T=new Int32Array(n),C=new Int32Array(n),S=new Int32Array(n>>3),e=0;e<n;e++)t=(e<<a+8)/n,x[e]=new Float64Array([t,t,t,0]),C[e]=s/n,T[e]=0}(),function(){var n,r,o,s,c,l,u=e.length,h=30+(t-1)/3,g=u/(3*t),x=~~(g/i),E=m,T=f,C=T>>d;for(C<=1&&(C=0),n=0;n<C;n++)S[n]=E*((C*C-n*n)*_/(C*C));u<O?(t=1,r=3):r=u%v!=0?3*v:u%b!=0?3*b:u%y!=0?3*y:3*w;var D=0;for(n=0;n<g;)if(A(E,l=I(o=(255&e[D])<<a,s=(255&e[D+1])<<a,c=(255&e[D+2])<<a),o,s,c),0!==C&&P(C,l,o,s,c),(D+=r)>=u&&(D-=u),0===x&&(x=1),++n%x==0)for(E-=E/h,(C=(T-=T/p)>>d)<=1&&(C=0),l=0;l<C;l++)S[l]=E*((C*C-l*l)*_/(C*C))}(),function(){for(var e=0;e<n;e++)x[e][0]>>=a,x[e][1]>>=a,x[e][2]>>=a,x[e][3]=e}(),function(){var e,t,i,a,o,s,c=0,l=0;for(e=0;e<n;e++){for(o=e,s=(i=x[e])[1],t=e+1;t<n;t++)(a=x[t])[1]<s&&(o=t,s=a[1]);if(a=x[o],e!=o&&(t=a[0],a[0]=i[0],i[0]=t,t=a[1],a[1]=i[1],i[1]=t,t=a[2],a[2]=i[2],i[2]=t,t=a[3],a[3]=i[3],i[3]=t),s!=c){for(E[c]=l+e>>1,t=c+1;t<s;t++)E[t]=e;c=s,l=e}}for(E[c]=l+r>>1,t=c+1;t<256;t++)E[t]=r}()},this.getColormap=function(){for(var e=[],t=[],i=0;i<n;i++)t[x[i][3]]=i;for(var r=0,a=0;a<n;a++){var o=t[a];e[r++]=x[o][0],e[r++]=x[o][1],e[r++]=x[o][2]}return e},this.lookupRGB=function(e,t,i){for(var r,a,o,s=1e3,c=-1,l=E[t],u=l-1;l<n||u>=0;)l<n&&((o=(a=x[l])[1]-t)>=s?l=n:(l++,o<0&&(o=-o),(r=a[0]-e)<0&&(r=-r),(o+=r)<s&&((r=a[2]-i)<0&&(r=-r),(o+=r)<s&&(s=o,c=a[3])))),u>=0&&((o=t-(a=x[u])[1])>=s?u=-1:(u--,o<0&&(o=-o),(r=a[0]-e)<0&&(r=-r),(o+=r)<s&&((r=a[2]-i)<0&&(r=-r),(o+=r)<s&&(s=o,c=a[3]))));return c}}},function(e,t){var i=-1,n=12,r=5003,a=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535];e.exports=function(e,t,o,s){var c,l,u,h,d,f,p,m,_,g=Math.max(2,s),v=new Uint8Array(256),b=new Int32Array(r),y=new Int32Array(r),w=0,O=0,x=!1;function E(e,t){v[l++]=e,l>=254&&S(t)}function T(e){C(r),O=m+2,x=!0,I(m,e)}function C(e){for(var t=0;t<e;++t)b[t]=-1}function S(e){l>0&&(e.writeByte(l),e.writeBytes(v,0,l),l=0)}function A(e){return(1<<e)-1}function P(){return 0===h?i:(--h,255&o[d++])}function I(e,t){for(c&=a[w],w>0?c|=e<<w:c=e,w+=f;w>=8;)E(255&c,t),c>>=8,w-=8;if((O>u||x)&&(x?(u=A(f=p),x=!1):(++f,u=f==n?1<<n:A(f))),e==_){for(;w>0;)E(255&c,t),c>>=8,w-=8;S(t)}}this.encode=function(a){a.writeByte(g),h=e*t,d=0,function(e,t){var a,o,s,c,h,d,g;for(x=!1,u=A(f=p=e),_=(m=1<<e-1)+1,O=m+2,l=0,c=P(),g=0,a=r;a<65536;a*=2)++g;g=8-g,C(d=r),I(m,t);e:for(;(o=P())!=i;)if(a=(o<<n)+c,b[s=o<<g^c]!==a){if(b[s]>=0){h=d-s,0===s&&(h=1);do{if((s-=h)<0&&(s+=d),b[s]===a){c=y[s];continue e}}while(b[s]>=0)}I(c,t),c=o,O<1<<n?(y[s]=O++,b[s]=a):T(t)}else c=y[s];I(c,t),I(_,t)}(g+1,a),a.writeByte(0)}}},function(e,t,i){var n=i(334),r=i(335);e.exports={encode:n,decode:r}},function(e,t,i){(function(t){function i(e){Math.round;var i,n,r,a,o,s=Math.floor,c=new Array(64),l=new Array(64),u=new Array(64),h=new Array(64),d=new Array(65535),f=new Array(65535),p=new Array(64),m=new Array(64),_=[],g=0,v=7,b=new Array(64),y=new Array(64),w=new Array(64),O=new Array(256),x=new Array(2048),E=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],T=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],C=[0,1,2,3,4,5,6,7,8,9,10,11],S=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],A=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],P=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],I=[0,1,2,3,4,5,6,7,8,9,10,11],D=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],j=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function M(e,t){for(var i=0,n=0,r=new Array,a=1;a<=16;a++){for(var o=1;o<=e[a];o++)r[t[n]]=[],r[t[n]][0]=i,r[t[n]][1]=a,n++,i++;i*=2}return r}function R(e){for(var t=e[0],i=e[1]-1;i>=0;)t&1<<i&&(g|=1<<v),i--,--v<0&&(255==g?(L(255),L(0)):L(g),v=7,g=0)}function L(e){_.push(e)}function N(e){L(e>>8&255),L(255&e)}function F(e,t,i,n,r){for(var a,o=r[0],s=r[240],c=function(e,t){var i,n,r,a,o,s,c,l,u,h,d=0;for(u=0;u<8;++u){i=e[d],n=e[d+1],r=e[d+2],a=e[d+3],o=e[d+4],s=e[d+5],c=e[d+6];var f=i+(l=e[d+7]),m=i-l,_=n+c,g=n-c,v=r+s,b=r-s,y=a+o,w=a-o,O=f+y,x=f-y,E=_+v,T=_-v;e[d]=O+E,e[d+4]=O-E;var C=.707106781*(T+x);e[d+2]=x+C,e[d+6]=x-C;var S=.382683433*((O=w+b)-(T=g+m)),A=.5411961*O+S,P=1.306562965*T+S,I=.707106781*(E=b+g),D=m+I,j=m-I;e[d+5]=j+A,e[d+3]=j-A,e[d+1]=D+P,e[d+7]=D-P,d+=8}for(d=0,u=0;u<8;++u){i=e[d],n=e[d+8],r=e[d+16],a=e[d+24],o=e[d+32],s=e[d+40],c=e[d+48];var M=i+(l=e[d+56]),R=i-l,L=n+c,N=n-c,F=r+s,k=r-s,B=a+o,z=a-o,U=M+B,V=M-B,H=L+F,G=L-F;e[d]=U+H,e[d+32]=U-H;var q=.707106781*(G+V);e[d+16]=V+q,e[d+48]=V-q;var W=.382683433*((U=z+k)-(G=N+R)),Y=.5411961*U+W,X=1.306562965*G+W,Z=.707106781*(H=k+N),Q=R+Z,K=R-Z;e[d+40]=K+Y,e[d+24]=K-Y,e[d+8]=Q+X,e[d+56]=Q-X,d++}for(u=0;u<64;++u)h=e[u]*t[u],p[u]=h>0?h+.5|0:h-.5|0;return p}(e,t),l=0;l<64;++l)m[E[l]]=c[l];var u=m[0]-i;i=m[0],0==u?R(n[0]):(R(n[f[a=32767+u]]),R(d[a]));for(var h=63;h>0&&0==m[h];h--);if(0==h)return R(o),i;for(var _,g=1;g<=h;){for(var v=g;0==m[g]&&g<=h;++g);var b=g-v;if(b>=16){_=b>>4;for(var y=1;y<=_;++y)R(s);b&=15}a=32767+m[g],R(r[(b<<4)+f[a]]),R(d[a]),g++}return 63!=h&&R(o),i}function k(e){if(e<=0&&(e=1),e>100&&(e=100),o!=e){(function(e){for(var t=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],i=0;i<64;i++){var n=s((t[i]*e+50)/100);n<1?n=1:n>255&&(n=255),c[E[i]]=n}for(var r=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],a=0;a<64;a++){var o=s((r[a]*e+50)/100);o<1?o=1:o>255&&(o=255),l[E[a]]=o}for(var d=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],f=0,p=0;p<8;p++)for(var m=0;m<8;m++)u[f]=1/(c[E[f]]*d[p]*d[m]*8),h[f]=1/(l[E[f]]*d[p]*d[m]*8),f++})(e<50?Math.floor(5e3/e):Math.floor(200-2*e)),o=e}}this.encode=function(e,o){(new Date).getTime();o&&k(o),_=new Array,g=0,v=7,N(65496),N(65504),N(16),L(74),L(70),L(73),L(70),L(0),L(1),L(1),L(0),N(1),N(1),L(0),L(0),function(){N(65499),N(132),L(0);for(var e=0;e<64;e++)L(c[e]);L(1);for(var t=0;t<64;t++)L(l[t])}(),function(e,t){N(65472),N(17),L(8),N(t),N(e),L(3),L(1),L(17),L(0),L(2),L(17),L(1),L(3),L(17),L(1)}(e.width,e.height),function(){N(65476),N(418),L(0);for(var e=0;e<16;e++)L(T[e+1]);for(var t=0;t<=11;t++)L(C[t]);L(16);for(var i=0;i<16;i++)L(S[i+1]);for(var n=0;n<=161;n++)L(A[n]);L(1);for(var r=0;r<16;r++)L(P[r+1]);for(var a=0;a<=11;a++)L(I[a]);L(17);for(var o=0;o<16;o++)L(D[o+1]);for(var s=0;s<=161;s++)L(j[s])}(),N(65498),N(12),L(3),L(1),L(0),L(2),L(17),L(3),L(17),L(0),L(63),L(0);var s=0,d=0,f=0;g=0,v=7,this.encode.displayName="_encode_";for(var p,m,O,E,M,B,z,U,V,H=e.data,G=e.width,q=e.height,W=4*G,Y=0;Y<q;){for(p=0;p<W;){for(B=M=W*Y+p,z=-1,U=0,V=0;V<64;V++)B=M+(U=V>>3)*W+(z=4*(7&V)),Y+U>=q&&(B-=W*(Y+1+U-q)),p+z>=W&&(B-=p+z-W+4),m=H[B++],O=H[B++],E=H[B++],b[V]=(x[m]+x[O+256>>0]+x[E+512>>0]>>16)-128,y[V]=(x[m+768>>0]+x[O+1024>>0]+x[E+1280>>0]>>16)-128,w[V]=(x[m+1280>>0]+x[O+1536>>0]+x[E+1792>>0]>>16)-128;s=F(b,u,s,i,r),d=F(y,h,d,n,a),f=F(w,h,f,n,a),p+=32}Y+=8}if(v>=0){var X=[];X[1]=v+1,X[0]=(1<<v+1)-1,R(X)}return N(65497),new t(_)},function(){(new Date).getTime();e||(e=50),function(){for(var e=String.fromCharCode,t=0;t<256;t++)O[t]=e(t)}(),i=M(T,C),n=M(P,I),r=M(S,A),a=M(D,j),function(){for(var e=1,t=2,i=1;i<=15;i++){for(var n=e;n<t;n++)f[32767+n]=i,d[32767+n]=[],d[32767+n][1]=i,d[32767+n][0]=n;for(var r=-(t-1);r<=-e;r++)f[32767+r]=i,d[32767+r]=[],d[32767+r][1]=i,d[32767+r][0]=t-1+r;e<<=1,t<<=1}}(),function(){for(var e=0;e<256;e++)x[e]=19595*e,x[e+256>>0]=38470*e,x[e+512>>0]=7471*e+32768,x[e+768>>0]=-11059*e,x[e+1024>>0]=-21709*e,x[e+1280>>0]=32768*e+8421375,x[e+1536>>0]=-27439*e,x[e+1792>>0]=-5329*e}(),k(e),(new Date).getTime()}()}e.exports=function(e,t){void 0===t&&(t=50);return{data:new i(t).encode(e,t),width:e.width,height:e.height}}}).call(this,i(15).Buffer)},function(e,t,i){(function(t){var i=function(){"use strict";var e=new Int32Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]),t=4017,i=799,n=3406,r=2276,a=1567,o=3784,s=5793,c=2896;function l(){}function u(e,t){for(var i,n,r=0,a=[],o=16;o>0&&!e[o-1];)o--;a.push({children:[],index:0});var s,c=a[0];for(i=0;i<o;i++){for(n=0;n<e[i];n++){for((c=a.pop()).children[c.index]=t[r];c.index>0;)c=a.pop();for(c.index++,a.push(c);a.length<=i;)a.push(s={children:[],index:0}),c.children[c.index]=s.children,c=s;r++}i+1<o&&(a.push(s={children:[],index:0}),c.children[c.index]=s.children,c=s)}return a[0].children}function h(t,i,n,r,a,o,s,c,l){n.precision,n.samplesPerLine,n.scanLines;var u=n.mcusPerLine,h=n.progressive,d=(n.maxH,n.maxV,i),f=0,p=0;function m(){if(p>0)return p--,f>>p&1;if(255==(f=t[i++])){var e=t[i++];if(e)throw new Error("unexpected marker: "+(f<<8|e).toString(16))}return p=7,f>>>7}function _(e){for(var t,i=e;null!==(t=m());){if("number"==typeof(i=i[t]))return i;if("object"!=typeof i)throw new Error("invalid huffman sequence")}return null}function g(e){for(var t=0;e>0;){var i=m();if(null===i)return;t=t<<1|i,e--}return t}function v(e){var t=g(e);return t>=1<<e-1?t:t+(-1<<e)+1}var b=0;var y,w=0;function O(e,t,i,n,r){var a=i%u,o=(i/u|0)*e.v+n,s=a*e.h+r;t(e,e.blocks[o][s])}function x(e,t,i){var n=i/e.blocksPerLine|0,r=i%e.blocksPerLine;t(e,e.blocks[n][r])}var E,T,C,S,A,P,I=r.length;P=h?0===o?0===c?function(e,t){var i=_(e.huffmanTableDC),n=0===i?0:v(i)<<l;t[0]=e.pred+=n}:function(e,t){t[0]|=m()<<l}:0===c?function(t,i){if(b>0)b--;else for(var n=o,r=s;n<=r;){var a=_(t.huffmanTableAC),c=15&a,u=a>>4;if(0!==c){i[e[n+=u]]=v(c)*(1<<l),n++}else{if(u<15){b=g(u)+(1<<u)-1;break}n+=16}}}:function(t,i){for(var n=o,r=s,a=0;n<=r;){var c=e[n],u=i[c]<0?-1:1;switch(w){case 0:var h=_(t.huffmanTableAC),d=15&h;a=h>>4;if(0===d)a<15?(b=g(a)+(1<<a),w=4):(a=16,w=1);else{if(1!==d)throw new Error("invalid ACn encoding");y=v(d),w=a?2:3}continue;case 1:case 2:i[c]?i[c]+=(m()<<l)*u:0===--a&&(w=2==w?3:0);break;case 3:i[c]?i[c]+=(m()<<l)*u:(i[c]=y<<l,w=0);break;case 4:i[c]&&(i[c]+=(m()<<l)*u)}n++}4===w&&0===--b&&(w=0)}:function(t,i){var n=_(t.huffmanTableDC),r=0===n?0:v(n);i[0]=t.pred+=r;for(var a=1;a<64;){var o=_(t.huffmanTableAC),s=15&o,c=o>>4;if(0!==s){i[e[a+=c]]=v(s),a++}else{if(c<15)break;a+=16}}};var D,j,M,R,L=0;for(j=1==I?r[0].blocksPerLine*r[0].blocksPerColumn:u*n.mcusPerColumn,a||(a=j);L<j;){for(T=0;T<I;T++)r[T].pred=0;if(b=0,1==I)for(E=r[0],A=0;A<a;A++)x(E,P,L),L++;else for(A=0;A<a;A++){for(T=0;T<I;T++)for(M=(E=r[T]).h,R=E.v,C=0;C<R;C++)for(S=0;S<M;S++)O(E,P,L,C,S);if(++L===j)break}if(p=0,(D=t[i]<<8|t[i+1])<65280)throw new Error("marker was not found");if(!(D>=65488&&D<=65495))break;i+=2}return i-d}function d(e,l){var u,h,d=[],f=l.blocksPerLine,p=l.blocksPerColumn,m=f<<3,_=new Int32Array(64),g=new Uint8Array(64);function v(e,u,h){var d,f,p,m,_,g,v,b,y,w,O=l.quantizationTable,x=h;for(w=0;w<64;w++)x[w]=e[w]*O[w];for(w=0;w<8;++w){var E=8*w;0!=x[1+E]||0!=x[2+E]||0!=x[3+E]||0!=x[4+E]||0!=x[5+E]||0!=x[6+E]||0!=x[7+E]?(d=s*x[0+E]+128>>8,f=s*x[4+E]+128>>8,p=x[2+E],m=x[6+E],_=c*(x[1+E]-x[7+E])+128>>8,b=c*(x[1+E]+x[7+E])+128>>8,g=x[3+E]<<4,v=x[5+E]<<4,y=d-f+1>>1,d=d+f+1>>1,f=y,y=p*o+m*a+128>>8,p=p*a-m*o+128>>8,m=y,y=_-v+1>>1,_=_+v+1>>1,v=y,y=b+g+1>>1,g=b-g+1>>1,b=y,y=d-m+1>>1,d=d+m+1>>1,m=y,y=f-p+1>>1,f=f+p+1>>1,p=y,y=_*r+b*n+2048>>12,_=_*n-b*r+2048>>12,b=y,y=g*i+v*t+2048>>12,g=g*t-v*i+2048>>12,v=y,x[0+E]=d+b,x[7+E]=d-b,x[1+E]=f+v,x[6+E]=f-v,x[2+E]=p+g,x[5+E]=p-g,x[3+E]=m+_,x[4+E]=m-_):(y=s*x[0+E]+512>>10,x[0+E]=y,x[1+E]=y,x[2+E]=y,x[3+E]=y,x[4+E]=y,x[5+E]=y,x[6+E]=y,x[7+E]=y)}for(w=0;w<8;++w){var T=w;0!=x[8+T]||0!=x[16+T]||0!=x[24+T]||0!=x[32+T]||0!=x[40+T]||0!=x[48+T]||0!=x[56+T]?(d=s*x[0+T]+2048>>12,f=s*x[32+T]+2048>>12,p=x[16+T],m=x[48+T],_=c*(x[8+T]-x[56+T])+2048>>12,b=c*(x[8+T]+x[56+T])+2048>>12,g=x[24+T],v=x[40+T],y=d-f+1>>1,d=d+f+1>>1,f=y,y=p*o+m*a+2048>>12,p=p*a-m*o+2048>>12,m=y,y=_-v+1>>1,_=_+v+1>>1,v=y,y=b+g+1>>1,g=b-g+1>>1,b=y,y=d-m+1>>1,d=d+m+1>>1,m=y,y=f-p+1>>1,f=f+p+1>>1,p=y,y=_*r+b*n+2048>>12,_=_*n-b*r+2048>>12,b=y,y=g*i+v*t+2048>>12,g=g*t-v*i+2048>>12,v=y,x[0+T]=d+b,x[56+T]=d-b,x[8+T]=f+v,x[48+T]=f-v,x[16+T]=p+g,x[40+T]=p-g,x[24+T]=m+_,x[32+T]=m-_):(y=s*h[w+0]+8192>>14,x[0+T]=y,x[8+T]=y,x[16+T]=y,x[24+T]=y,x[32+T]=y,x[40+T]=y,x[48+T]=y,x[56+T]=y)}for(w=0;w<64;++w){var C=128+(x[w]+8>>4);u[w]=C<0?0:C>255?255:C}}for(var b=0;b<p;b++){var y=b<<3;for(u=0;u<8;u++)d.push(new Uint8Array(m));for(var w=0;w<f;w++){v(l.blocks[b][w],g,_);var O=0,x=w<<3;for(h=0;h<8;h++){var E=d[y+h];for(u=0;u<8;u++)E[x+u]=g[O++]}}}return d}function f(e){return e<0?0:e>255?255:e}return l.prototype={load:function(e){var t=new XMLHttpRequest;t.open("GET",e,!0),t.responseType="arraybuffer",t.onload=function(){var e=new Uint8Array(t.response||t.mozResponseArrayBuffer);this.parse(e),this.onload&&this.onload()}.bind(this),t.send(null)},parse:function(t){var i=0;t.length;function n(){var e=t[i]<<8|t[i+1];return i+=2,e}function r(){var e=n(),r=t.subarray(i,i+e-2);return i+=r.length,r}function a(e){var t,i,n=0,r=0;for(i in e.components)e.components.hasOwnProperty(i)&&(n<(t=e.components[i]).h&&(n=t.h),r<t.v&&(r=t.v));var a=Math.ceil(e.samplesPerLine/8/n),o=Math.ceil(e.scanLines/8/r);for(i in e.components)if(e.components.hasOwnProperty(i)){t=e.components[i];for(var s=Math.ceil(Math.ceil(e.samplesPerLine/8)*t.h/n),c=Math.ceil(Math.ceil(e.scanLines/8)*t.v/r),l=a*t.h,u=o*t.v,h=[],d=0;d<u;d++){for(var f=[],p=0;p<l;p++)f.push(new Int32Array(64));h.push(f)}t.blocksPerLine=s,t.blocksPerColumn=c,t.blocks=h}e.maxH=n,e.maxV=r,e.mcusPerLine=a,e.mcusPerColumn=o}var o,s,c=null,l=null,f=[],p=[],m=[],_=[],g=n();if(65496!=g)throw new Error("SOI not found");for(g=n();65497!=g;){switch(g){case 65280:break;case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:var v=r();65504===g&&74===v[0]&&70===v[1]&&73===v[2]&&70===v[3]&&0===v[4]&&(c={version:{major:v[5],minor:v[6]},densityUnits:v[7],xDensity:v[8]<<8|v[9],yDensity:v[10]<<8|v[11],thumbWidth:v[12],thumbHeight:v[13],thumbData:v.subarray(14,14+3*v[12]*v[13])}),65518===g&&65===v[0]&&100===v[1]&&111===v[2]&&98===v[3]&&101===v[4]&&0===v[5]&&(l={version:v[6],flags0:v[7]<<8|v[8],flags1:v[9]<<8|v[10],transformCode:v[11]});break;case 65499:for(var b=n()+i-2;i<b;){var y=t[i++],w=new Int32Array(64);if(y>>4==0)for(U=0;U<64;U++){w[e[U]]=t[i++]}else{if(y>>4!=1)throw new Error("DQT: invalid table spec");for(U=0;U<64;U++){w[e[U]]=n()}}f[15&y]=w}break;case 65472:case 65473:case 65474:n(),(o={}).extended=65473===g,o.progressive=65474===g,o.precision=t[i++],o.scanLines=n(),o.samplesPerLine=n(),o.components={},o.componentsOrder=[];var O,x=t[i++];for(B=0;B<x;B++){O=t[i];var E=t[i+1]>>4,T=15&t[i+1],C=t[i+2];o.componentsOrder.push(O),o.components[O]={h:E,v:T,quantizationIdx:C},i+=3}a(o),p.push(o);break;case 65476:var S=n();for(B=2;B<S;){var A=t[i++],P=new Uint8Array(16),I=0;for(U=0;U<16;U++,i++)I+=P[U]=t[i];var D=new Uint8Array(I);for(U=0;U<I;U++,i++)D[U]=t[i];B+=17+I,(A>>4==0?_:m)[15&A]=u(P,D)}break;case 65501:n(),s=n();break;case 65498:n();var j=t[i++],M=[];for(B=0;B<j;B++){V=o.components[t[i++]];var R=t[i++];V.huffmanTableDC=_[R>>4],V.huffmanTableAC=m[15&R],M.push(V)}var L=t[i++],N=t[i++],F=t[i++],k=h(t,i,o,M,s,L,N,F>>4,15&F);i+=k;break;case 65535:255!==t[i]&&i--;break;default:if(255==t[i-3]&&t[i-2]>=192&&t[i-2]<=254){i-=3;break}throw new Error("unknown JPEG marker "+g.toString(16))}g=n()}if(1!=p.length)throw new Error("only single frame JPEGs supported");for(var B=0;B<p.length;B++){var z=p[B].components;for(var U in z)z[U].quantizationTable=f[z[U].quantizationIdx],delete z[U].quantizationIdx}this.width=o.samplesPerLine,this.height=o.scanLines,this.jfif=c,this.adobe=l,this.components=[];for(B=0;B<o.componentsOrder.length;B++){var V=o.components[o.componentsOrder[B]];this.components.push({lines:d(0,V),scaleX:V.h/o.maxH,scaleY:V.v/o.maxV})}},getData:function(e,t){var i,n,r,a,o,s,c,l,u,h,d,p,m,_,g,v,b,y,w,O,x,E=this.width/e,T=this.height/t,C=0,S=e*t*this.components.length,A=new Uint8Array(S);switch(this.components.length){case 1:for(i=this.components[0],h=0;h<t;h++)for(o=i.lines[0|h*i.scaleY*T],u=0;u<e;u++)d=o[0|u*i.scaleX*E],A[C++]=d;break;case 2:for(i=this.components[0],n=this.components[1],h=0;h<t;h++)for(o=i.lines[0|h*i.scaleY*T],s=n.lines[0|h*n.scaleY*T],u=0;u<e;u++)d=o[0|u*i.scaleX*E],A[C++]=d,d=s[0|u*n.scaleX*E],A[C++]=d;break;case 3:for(x=!0,this.adobe&&this.adobe.transformCode?x=!0:void 0!==this.colorTransform&&(x=!!this.colorTransform),i=this.components[0],n=this.components[1],r=this.components[2],h=0;h<t;h++)for(o=i.lines[0|h*i.scaleY*T],s=n.lines[0|h*n.scaleY*T],c=r.lines[0|h*r.scaleY*T],u=0;u<e;u++)x?(d=o[0|u*i.scaleX*E],p=s[0|u*n.scaleX*E],y=f(d+1.402*((m=c[0|u*r.scaleX*E])-128)),w=f(d-.3441363*(p-128)-.71413636*(m-128)),O=f(d+1.772*(p-128))):(y=o[0|u*i.scaleX*E],w=s[0|u*n.scaleX*E],O=c[0|u*r.scaleX*E]),A[C++]=y,A[C++]=w,A[C++]=O;break;case 4:if(!this.adobe)throw new Error("Unsupported color mode (4 components)");for(x=!1,this.adobe&&this.adobe.transformCode?x=!0:void 0!==this.colorTransform&&(x=!!this.colorTransform),i=this.components[0],n=this.components[1],r=this.components[2],a=this.components[3],h=0;h<t;h++)for(o=i.lines[0|h*i.scaleY*T],s=n.lines[0|h*n.scaleY*T],c=r.lines[0|h*r.scaleY*T],l=a.lines[0|h*a.scaleY*T],u=0;u<e;u++)x?(d=o[0|u*i.scaleX*E],p=s[0|u*n.scaleX*E],m=c[0|u*r.scaleX*E],_=l[0|u*a.scaleX*E],g=255-f(d+1.402*(m-128)),v=255-f(d-.3441363*(p-128)-.71413636*(m-128)),b=255-f(d+1.772*(p-128))):(g=o[0|u*i.scaleX*E],v=s[0|u*n.scaleX*E],b=c[0|u*r.scaleX*E],_=l[0|u*a.scaleX*E]),A[C++]=255-g,A[C++]=255-v,A[C++]=255-b,A[C++]=255-_;break;default:throw new Error("Unsupported color mode")}return A},copyToImageData:function(e){var t,i,n,r,a,o,s,c,l,u=e.width,h=e.height,d=e.data,p=this.getData(u,h),m=0,_=0;switch(this.components.length){case 1:for(i=0;i<h;i++)for(t=0;t<u;t++)n=p[m++],d[_++]=n,d[_++]=n,d[_++]=n,d[_++]=255;break;case 3:for(i=0;i<h;i++)for(t=0;t<u;t++)s=p[m++],c=p[m++],l=p[m++],d[_++]=s,d[_++]=c,d[_++]=l,d[_++]=255;break;case 4:for(i=0;i<h;i++)for(t=0;t<u;t++)a=p[m++],o=p[m++],n=p[m++],s=255-f(a*(1-(r=p[m++])/255)+r),c=255-f(o*(1-r/255)+r),l=255-f(n*(1-r/255)+r),d[_++]=s,d[_++]=c,d[_++]=l,d[_++]=255;break;default:throw new Error("Unsupported color mode")}}},l}();e.exports=function(e,n){var r={useTArray:!1,colorTransform:!0};n?"object"==typeof n?n={useTArray:void 0===n.useTArray?r.useTArray:n.useTArray,colorTransform:void 0===n.colorTransform?r.colorTransform:n.colorTransform}:(n=r).useTArray=!0:n=r;var a=new Uint8Array(e),o=new i;o.parse(a),o.colorTransform=n.colorTransform;var s={width:o.width,height:o.height,data:n.useTArray?new Uint8Array(o.width*o.height*4):new t(o.width*o.height*4)};return o.copyToImageData(s),s}}).call(this,i(15).Buffer)},function(e,t,i){"use strict";(function(e,n){var r=i(52),a=i(41),o=i(337),s=i(339),c=i(342),l=t.PNG=function(t){a.call(this),t=t||{},this.width=t.width||0,this.height=t.height||0,this.data=this.width>0&&this.height>0?new e(4*this.width*this.height):null,t.fill&&this.data&&this.data.fill(0),this.gamma=0,this.readable=this.writable=!0,this._parser=new o(t),this._parser.on("error",this.emit.bind(this,"error")),this._parser.on("close",this._handleClose.bind(this)),this._parser.on("metadata",this._metadata.bind(this)),this._parser.on("gamma",this._gamma.bind(this)),this._parser.on("parsed",function(e){this.data=e,this.emit("parsed",e)}.bind(this)),this._packer=new s(t),this._packer.on("data",this.emit.bind(this,"data")),this._packer.on("end",this.emit.bind(this,"end")),this._parser.on("close",this._handleClose.bind(this)),this._packer.on("error",this.emit.bind(this,"error"))};r.inherits(l,a),l.sync=c,l.prototype.pack=function(){return this.data&&this.data.length?(n.nextTick(function(){this._packer.pack(this.data,this.width,this.height,this.gamma)}.bind(this)),this):(this.emit("error","No data provided"),this)},l.prototype.parse=function(e,t){var i,n;t&&(i=function(e){this.removeListener("error",n),this.data=e,t(null,this)}.bind(this),n=function(e){this.removeListener("parsed",i),t(e,null)}.bind(this),this.once("parsed",i),this.once("error",n));return this.end(e),this},l.prototype.write=function(e){return this._parser.write(e),!0},l.prototype.end=function(e){this._parser.end(e)},l.prototype._metadata=function(e){this.width=e.width,this.height=e.height,this.emit("metadata",e)},l.prototype._gamma=function(e){this.gamma=e},l.prototype._handleClose=function(){this._parser.writable||this._packer.readable||this.emit("close")},l.bitblt=function(e,t,i,n,r,a,o,s){if(i>e.width||n>e.height||i+r>e.width||n+a>e.height)throw new Error("bitblt reading outside image");if(o>t.width||s>t.height||o+r>t.width||s+a>t.height)throw new Error("bitblt writing outside image");for(var c=0;c<a;c++)e.data.copy(t.data,(s+c)*t.width+o<<2,(n+c)*e.width+i<<2,(n+c)*e.width+i+r<<2)},l.prototype.bitblt=function(e,t,i,n,r,a,o){return l.bitblt(this,e,t,i,n,r,a,o),this},l.adjustGamma=function(e){if(e.gamma){for(var t=0;t<e.height;t++)for(var i=0;i<e.width;i++)for(var n=e.width*t+i<<2,r=0;r<3;r++){var a=e.data[n+r]/255;a=Math.pow(a,1/2.2/e.gamma),e.data[n+r]=Math.round(255*a)}e.gamma=0}},l.prototype.adjustGamma=function(){l.adjustGamma(this)}}).call(this,i(15).Buffer,i(23))},function(e,t,i){"use strict";var n=i(52),r=i(89),a=i(199),o=i(338),s=i(203),c=i(205),l=i(206),u=e.exports=function(e){a.call(this),this._parser=new s(e,{read:this.read.bind(this),error:this._handleError.bind(this),metadata:this._handleMetaData.bind(this),gamma:this.emit.bind(this,"gamma"),palette:this._handlePalette.bind(this),transColor:this._handleTransColor.bind(this),finished:this._finished.bind(this),inflateData:this._inflateData.bind(this)}),this._options=e,this.writable=!0,this._parser.start()};n.inherits(u,a),u.prototype._handleError=function(e){this.emit("error",e),this.writable=!1,this.destroy(),this._inflate&&this._inflate.destroy&&this._inflate.destroy(),this.errord=!0},u.prototype._inflateData=function(e){this._inflate||(this._inflate=r.createInflate(),this._inflate.on("error",this.emit.bind(this,"error")),this._filter.on("complete",this._complete.bind(this)),this._inflate.pipe(this._filter)),this._inflate.write(e)},u.prototype._handleMetaData=function(e){this.emit("metadata",e),this._bitmapInfo=Object.create(e),this._filter=new o(this._bitmapInfo)},u.prototype._handleTransColor=function(e){this._bitmapInfo.transColor=e},u.prototype._handlePalette=function(e){this._bitmapInfo.palette=e},u.prototype._finished=function(){this.errord||(this._inflate?this._inflate.end():this.emit("error","No Inflate block"),this.destroySoon())},u.prototype._complete=function(e){if(!this.errord){try{var t=c.dataToBitMap(e,this._bitmapInfo),i=l(t,this._bitmapInfo);t=null}catch(e){return void this._handleError(e)}this.emit("parsed",i)}}},function(e,t,i){"use strict";(function(t){var n=i(52),r=i(199),a=i(200),o=e.exports=function(e){r.call(this);var i=[],n=this;this._filter=new a(e,{read:this.read.bind(this),write:function(e){i.push(e)},complete:function(){n.emit("complete",t.concat(i))}}),this._filter.start()};n.inherits(o,r)}).call(this,i(15).Buffer)},function(e,t,i){"use strict";(function(t){var n=i(52),r=i(41),a=i(104),o=i(207),s=e.exports=function(e){r.call(this);var t=e||{};this._packer=new o(t),this._deflate=this._packer.createDeflate(),this.readable=!0};n.inherits(s,r),s.prototype.pack=function(e,i,n,r){this.emit("data",new t(a.PNG_SIGNATURE)),this.emit("data",this._packer.packIHDR(i,n)),r&&this.emit("data",this._packer.packGAMA(r));var o=this._packer.filterData(e,i,n);this._deflate.on("error",this.emit.bind(this,"error")),this._deflate.on("data",function(e){this.emit("data",this._packer.packIDAT(e))}.bind(this)),this._deflate.on("end",function(){this.emit("data",this._packer.packIEND()),this.emit("end")}.bind(this)),this._deflate.end(o)}}).call(this,i(15).Buffer)},function(e,t,i){"use strict";(function(t){var n=i(104);e.exports=function(e,i,r,a){var o=a.colorType===n.COLORTYPE_COLOR_ALPHA;if(a.inputHasAlpha&&o)return e;if(!a.inputHasAlpha&&!o)return e;var s=o?4:3,c=new t(i*r*s),l=a.inputHasAlpha?4:3,u=0,h=0,d=a.bgColor||{};void 0===d.red&&(d.red=255),void 0===d.green&&(d.green=255),void 0===d.blue&&(d.blue=255);for(var f=0;f<r;f++)for(var p=0;p<i;p++){var m,_=e[u],g=e[u+1],v=e[u+2];a.inputHasAlpha?(m=e[u+3],o||(m/=255,_=Math.min(Math.max(Math.round((1-m)*d.red+m*_),0),255),g=Math.min(Math.max(Math.round((1-m)*d.green+m*g),0),255),v=Math.min(Math.max(Math.round((1-m)*d.blue+m*v),0),255))):m=255,c[h]=_,c[h+1]=g,c[h+2]=v,o&&(c[h+3]=m),u+=l,h+=s}return c}}).call(this,i(15).Buffer)},function(e,t,i){"use strict";(function(t){var n=i(202);var r={0:function(e,t,i,n,r){e.copy(n,r,t,t+i)},1:function(e,t,i,n,r,a){for(var o=0;o<i;o++){var s=o>=a?e[t+o-a]:0,c=e[t+o]-s;n[r+o]=c}},2:function(e,t,i,n,r){for(var a=0;a<i;a++){var o=t>0?e[t+a-i]:0,s=e[t+a]-o;n[r+a]=s}},3:function(e,t,i,n,r,a){for(var o=0;o<i;o++){var s=o>=a?e[t+o-a]:0,c=t>0?e[t+o-i]:0,l=e[t+o]-(s+c>>1);n[r+o]=l}},4:function(e,t,i,r,a,o){for(var s=0;s<i;s++){var c=s>=o?e[t+s-o]:0,l=t>0?e[t+s-i]:0,u=t>0&&s>=o?e[t+s-(i+o)]:0,h=e[t+s]-n(c,l,u);r[a+s]=h}}},a={0:function(e,t,i){for(var n=0,r=t+i,a=t;a<r;a++)n+=Math.abs(e[a]);return n},1:function(e,t,i,n){for(var r=0,a=0;a<i;a++){var o=a>=n?e[t+a-n]:0,s=e[t+a]-o;r+=Math.abs(s)}return r},2:function(e,t,i){for(var n=0,r=t+i,a=t;a<r;a++){var o=t>0?e[a-i]:0,s=e[a]-o;n+=Math.abs(s)}return n},3:function(e,t,i,n){for(var r=0,a=0;a<i;a++){var o=a>=n?e[t+a-n]:0,s=t>0?e[t+a-i]:0,c=e[t+a]-(o+s>>1);r+=Math.abs(c)}return r},4:function(e,t,i,r){for(var a=0,o=0;o<i;o++){var s=o>=r?e[t+o-r]:0,c=t>0?e[t+o-i]:0,l=t>0&&o>=r?e[t+o-(i+r)]:0,u=e[t+o]-n(s,c,l);a+=Math.abs(u)}return a}};e.exports=function(e,i,n,o,s){var c;if("filterType"in o&&-1!==o.filterType){if("number"!=typeof o.filterType)throw new Error("unrecognised filter types");c=[o.filterType]}else c=[0,1,2,3,4];for(var l=i*s,u=0,h=0,d=new t((l+1)*n),f=c[0],p=0;p<n;p++){if(c.length>1)for(var m=1/0,_=0;_<c.length;_++){var g=a[c[_]](e,h,l,s);g<m&&(f=c[_],m=g)}d[u]=f,u++,r[f](e,h,l,d,u,s),u+=l,h+=l}return d}}).call(this,i(15).Buffer)},function(e,t,i){"use strict";var n=i(343),r=i(345);t.read=function(e,t){return n(e,t||{})},t.write=function(e){return r(e)}},function(e,t,i){"use strict";(function(t){var n=!0,r=i(89);r.deflateSync||(n=!1);var a=i(208),o=i(344),s=i(203),c=i(205),l=i(206);e.exports=function(e,i){if(!n)throw new Error("To use the sync capability of this library in old node versions, please also add a dependency on node-zlb-backport");var u,h,d;var f=[];var p=new a(e);if(new s(i,{read:p.read.bind(p),error:function(e){u=e},metadata:function(e){h=e},gamma:function(e){d=e},palette:function(e){h.palette=e},transColor:function(e){h.transColor=e},inflateData:function(e){f.push(e)}}).start(),p.process(),u)throw u;var m=t.concat(f);f.length=0;var _=r.inflateSync(m);if(m=null,!_||!_.length)throw new Error("bad png - invalid inflate data response");var g=o.process(_,h);m=null;var v=c.dataToBitMap(g,h);g=null;var b=l(v,h);return h.data=b,h.gamma=d||0,h}}).call(this,i(15).Buffer)},function(e,t,i){"use strict";(function(e){var n=i(208),r=i(200);t.process=function(t,i){var a=[],o=new n(t);return new r(i,{read:o.read.bind(o),write:function(e){a.push(e)},complete:function(){}}).start(),o.process(),e.concat(a)}}).call(this,i(15).Buffer)},function(e,t,i){"use strict";(function(t){var n=!0,r=i(89);r.deflateSync||(n=!1);var a=i(104),o=i(207);e.exports=function(e,i){if(!n)throw new Error("To use the sync capability of this library in old node versions, please also add a dependency on node-zlb-backport");var s=new o(i||{}),c=[];c.push(new t(a.PNG_SIGNATURE)),c.push(s.packIHDR(e.width,e.height)),e.gamma&&c.push(s.packGAMA(e.gamma));var l=s.filterData(e.data,e.width,e.height),u=r.deflateSync(l,s.getDeflateOptions());if(l=null,!u||!u.length)throw new Error("bad png - invalid compressed data response");return c.push(s.packIDAT(u)),c.push(s.packIEND()),t.concat(c)}}).call(this,i(15).Buffer)},function(e,t,i){"use strict";var n=i(190),r={body:"",args:[],thisVars:[],localVars:[]};function a(e){if(!e)return r;for(var t=0;t<e.args.length;++t){var i=e.args[t];e.args[t]=0===t?{name:i,lvalue:!0,rvalue:!!e.rvalue,count:e.count||1}:{name:i,lvalue:!1,rvalue:!0,count:1}}return e.thisVars||(e.thisVars=[]),e.localVars||(e.localVars=[]),e}function o(e){for(var t=[],i=0;i<e.args.length;++i)t.push("a"+i);return new Function("P",["return function ",e.funcName,"_ndarrayops(",t.join(","),") {P(",t.join(","),");return a0}"].join(""))(function(e){return n({args:e.args,pre:a(e.pre),body:a(e.body),post:a(e.proc),funcName:e.funcName})}(e))}var s={add:"+",sub:"-",mul:"*",div:"/",mod:"%",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"};!function(){for(var e in s){var i=s[e];t[e]=o({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+i+"c"},funcName:e}),t[e+"eq"]=o({args:["array","array"],body:{args:["a","b"],body:"a"+i+"=b"},rvalue:!0,funcName:e+"eq"}),t[e+"s"]=o({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+i+"s"},funcName:e+"s"}),t[e+"seq"]=o({args:["array","scalar"],body:{args:["a","s"],body:"a"+i+"=s"},rvalue:!0,funcName:e+"seq"})}}();var c={not:"!",bnot:"~",neg:"-",recip:"1.0/"};!function(){for(var e in c){var i=c[e];t[e]=o({args:["array","array"],body:{args:["a","b"],body:"a="+i+"b"},funcName:e}),t[e+"eq"]=o({args:["array"],body:{args:["a"],body:"a="+i+"a"},rvalue:!0,count:2,funcName:e+"eq"})}}();var l={and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">="};!function(){for(var e in l){var i=l[e];t[e]=o({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+i+"c"},funcName:e}),t[e+"s"]=o({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+i+"s"},funcName:e+"s"}),t[e+"eq"]=o({args:["array","array"],body:{args:["a","b"],body:"a=a"+i+"b"},rvalue:!0,count:2,funcName:e+"eq"}),t[e+"seq"]=o({args:["array","scalar"],body:{args:["a","s"],body:"a=a"+i+"s"},rvalue:!0,count:2,funcName:e+"seq"})}}();var u=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan"];!function(){for(var e=0;e<u.length;++e){var i=u[e];t[i]=o({args:["array","array"],pre:{args:[],body:"this_f=Math."+i,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b)",thisVars:["this_f"]},funcName:i}),t[i+"eq"]=o({args:["array"],pre:{args:[],body:"this_f=Math."+i,thisVars:["this_f"]},body:{args:["a"],body:"a=this_f(a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:i+"eq"})}}();var h=["max","min","atan2","pow"];!function(){for(var e=0;e<h.length;++e){var i=h[e];t[i]=o({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+i,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:i}),t[i+"s"]=o({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+i,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:i+"s"}),t[i+"eq"]=o({args:["array","array"],pre:{args:[],body:"this_f=Math."+i,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:i+"eq"}),t[i+"seq"]=o({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+i,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:i+"seq"})}}();var d=["atan2","pow"];!function(){for(var e=0;e<d.length;++e){var i=d[e];t[i+"op"]=o({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+i,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:i+"op"}),t[i+"ops"]=o({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+i,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:i+"ops"}),t[i+"opeq"]=o({args:["array","array"],pre:{args:[],body:"this_f=Math."+i,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:i+"opeq"}),t[i+"opseq"]=o({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+i,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:i+"opseq"})}}(),t.any=n({args:["array"],pre:r,body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"if(a){return true}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return false"},funcName:"any"}),t.all=n({args:["array"],pre:r,body:{args:[{name:"x",lvalue:!1,rvalue:!0,count:1}],body:"if(!x){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"all"}),t.sum=n({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"this_s+=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"sum"}),t.prod=n({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=1"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"this_s*=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"prod"}),t.norm2squared=n({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm2squared"}),t.norm2=n({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return Math.sqrt(this_s)"},funcName:"norm2"}),t.norminf=n({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:4}],body:"if(-a>this_s){this_s=-a}else if(a>this_s){this_s=a}",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norminf"}),t.norm1=n({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:3}],body:"this_s+=a<0?-a:a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm1"}),t.sup=n({args:["array"],pre:{body:"this_h=-Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_>this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}}),t.inf=n({args:["array"],pre:{body:"this_h=Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_<this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}}),t.argmin=n({args:["index","array","shape"],pre:{body:"{this_v=Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg1_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg2_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_<this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}}),t.argmax=n({args:["index","array","shape"],pre:{body:"{this_v=-Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg1_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg2_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_>this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}}),t.random=o({args:["array"],pre:{args:[],body:"this_f=Math.random",thisVars:["this_f"]},body:{args:["a"],body:"a=this_f()",thisVars:["this_f"]},funcName:"random"}),t.assign=o({args:["array","array"],body:{args:["a","b"],body:"a=b"},funcName:"assign"}),t.assigns=o({args:["array","scalar"],body:{args:["a","b"],body:"a=b"},funcName:"assigns"}),t.equals=n({args:["array","array"],pre:r,body:{args:[{name:"x",lvalue:!1,rvalue:!0,count:1},{name:"y",lvalue:!1,rvalue:!0,count:1}],body:"if(x!==y){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"equals"})},function(e,t,i){var n=i(16);n(n.P,"Array",{fill:i(144)}),i(118)("fill")},function(e,t,i){"use strict";var n=i(53),r=i(16),a=i(48),o=i(174),s=i(141),c=i(42),l=i(170),u=i(142);r(r.S+r.F*!i(120)((function(e){Array.from(e)})),"Array",{from:function(e){var t,i,r,h,d=a(e),f="function"==typeof this?this:Array,p=arguments.length,m=p>1?arguments[1]:void 0,_=void 0!==m,g=0,v=u(d);if(_&&(m=n(m,p>2?arguments[2]:void 0,2)),null==v||f==Array&&s(v))for(i=new f(t=c(d.length));t>g;g++)l(i,g,_?m(d[g],g):d[g]);else for(h=v.call(d),i=new f;!(r=h.next()).done;g++)l(i,g,_?o(h,m,[r.value,g],!0):r.value);return i.length=g,i}})},function(e,t,i){"use strict";var n=i(16),r=i(48),a=i(91);n(n.P+n.F*i(35)((function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})})),"Date",{toJSON:function(e){var t=r(this),i=a(t);return"number"!=typeof i||isFinite(i)?t.toISOString():null}})},function(e,t,n){"use strict";n.r(t);var r={};n.r(r),n.d(r,"VERSION",(function(){return BCe})),n.d(r,"appendForwardSlash",(function(){return l.a})),n.d(r,"ApproximateTerrainHeights",(function(){return Xt})),n.d(r,"ArcType",(function(){return Zt})),n.d(r,"arrayFill",(function(){return Qt})),n.d(r,"arrayRemoveDuplicates",(function(){return $t})),n.d(r,"arraySlice",(function(){return Li})),n.d(r,"AssociativeArray",(function(){return Fi})),n.d(r,"AttributeCompression",(function(){return Gi})),n.d(r,"AxisAlignedBoundingBox",(function(){return Yi})),n.d(r,"barycentricCoordinates",(function(){return Ki})),n.d(r,"binarySearch",(function(){return Ji})),n.d(r,"BingMapsApi",(function(){return en})),n.d(r,"BingMapsGeocoderService",(function(){return rn})),n.d(r,"BoundingRectangle",(function(){return ln})),n.d(r,"BoundingSphere",(function(){return St})),n.d(r,"BoxGeometry",(function(){return Ya})),n.d(r,"BoxOutlineGeometry",(function(){return $a})),n.d(r,"buildModuleUrl",(function(){return y})),n.d(r,"cancelAnimationFrame",(function(){return to})),n.d(r,"Cartesian2",(function(){return Rt})),n.d(r,"Cartesian3",(function(){return z})),n.d(r,"Cartesian4",(function(){return Te})),n.d(r,"Cartographic",(function(){return K})),n.d(r,"CartographicGeocoderService",(function(){return no})),n.d(r,"CatmullRomSpline",(function(){return To})),n.d(r,"CesiumTerrainProvider",(function(){return vu})),n.d(r,"Check",(function(){return x.a})),n.d(r,"CircleGeometry",(function(){return Rd})),n.d(r,"CircleOutlineGeometry",(function(){return Yd})),n.d(r,"Clock",(function(){return tf})),n.d(r,"ClockRange",(function(){return Xd})),n.d(r,"ClockStep",(function(){return Zd})),n.d(r,"clone",(function(){return nf.a})),n.d(r,"Color",(function(){return uf})),n.d(r,"ColorGeometryInstanceAttribute",(function(){return df})),n.d(r,"combine",(function(){return ff.a})),n.d(r,"ComponentDatatype",(function(){return dn})),n.d(r,"CompressedTextureBuffer",(function(){return mf})),n.d(r,"CoplanarPolygonGeometry",(function(){return cm})),n.d(r,"CoplanarPolygonGeometryLibrary",(function(){return xf})),n.d(r,"CoplanarPolygonOutlineGeometry",(function(){return dm})),n.d(r,"CornerType",(function(){return fm})),n.d(r,"CorridorGeometry",(function(){return xg})),n.d(r,"CorridorGeometryLibrary",(function(){return Q_})),n.d(r,"CorridorOutlineGeometry",(function(){return Dg})),n.d(r,"createGuid",(function(){return Mg})),n.d(r,"createWorldTerrain",(function(){return zg})),n.d(r,"Credit",(function(){return Jo})),n.d(r,"CubicRealPolynomial",(function(){return bs})),n.d(r,"CullingVolume",(function(){return Wg})),n.d(r,"CylinderGeometry",(function(){return rv})),n.d(r,"CylinderGeometryLibrary",(function(){return Xg})),n.d(r,"CylinderOutlineGeometry",(function(){return cv})),n.d(r,"decodeGoogleEarthEnterpriseData",(function(){return dv})),n.d(r,"DefaultProxy",(function(){return pv})),n.d(r,"defaultValue",(function(){return w.a})),n.d(r,"defined",(function(){return u.a})),n.d(r,"defineProperties",(function(){return O.a})),n.d(r,"deprecationWarning",(function(){return mv.a})),n.d(r,"destroyObject",(function(){return rl})),n.d(r,"DeveloperError",(function(){return h.a})),n.d(r,"DistanceDisplayCondition",(function(){return gv})),n.d(r,"DistanceDisplayConditionGeometryInstanceAttribute",(function(){return bv})),n.d(r,"DoublyLinkedList",(function(){return xv})),n.d(r,"EarthOrientationParameters",(function(){return jr})),n.d(r,"EarthOrientationParametersSample",(function(){return Jn})),n.d(r,"EasingFunction",(function(){return Pv})),n.d(r,"EllipseGeometry",(function(){return Id})),n.d(r,"EllipseGeometryLibrary",(function(){return ju})),n.d(r,"EllipseOutlineGeometry",(function(){return Hd})),n.d(r,"Ellipsoid",(function(){return ae})),n.d(r,"EllipsoidalOccluder",(function(){return fs})),n.d(r,"EllipsoidGeodesic",(function(){return bm})),n.d(r,"EllipsoidGeometry",(function(){return Hv})),n.d(r,"EllipsoidOutlineGeometry",(function(){return Qv})),n.d(r,"EllipsoidRhumbLine",(function(){return Df})),n.d(r,"EllipsoidTangentPlane",(function(){return fc})),n.d(r,"EllipsoidTerrainProvider",(function(){return Jv})),n.d(r,"EncodedCartesian3",(function(){return Fu})),n.d(r,"Event",(function(){return $o.a})),n.d(r,"EventHelper",(function(){return eb})),n.d(r,"ExtrapolationType",(function(){return tb})),n.d(r,"FeatureDetection",(function(){return Ri})),n.d(r,"formatError",(function(){return cu})),n.d(r,"freezeObject",(function(){return E.a})),n.d(r,"FrustumGeometry",(function(){return Gb})),n.d(r,"FrustumOutlineGeometry",(function(){return Jb})),n.d(r,"Fullscreen",(function(){return wi})),n.d(r,"GeocoderService",(function(){return ey})),n.d(r,"GeocodeType",(function(){return ty})),n.d(r,"GeographicProjection",(function(){return se})),n.d(r,"GeographicTilingScheme",(function(){return Nt})),n.d(r,"Geometry",(function(){return La})),n.d(r,"GeometryAttribute",(function(){return Na})),n.d(r,"GeometryAttributes",(function(){return Fa})),n.d(r,"GeometryInstance",(function(){return Mu})),n.d(r,"GeometryInstanceAttribute",(function(){return iy})),n.d(r,"GeometryOffsetAttribute",(function(){return fn})),n.d(r,"GeometryPipeline",(function(){return id})),n.d(r,"GeometryType",(function(){return pn})),n.d(r,"getAbsoluteUri",(function(){return d.a})),n.d(r,"getBaseUri",(function(){return ny.a})),n.d(r,"getExtensionFromUri",(function(){return ry.a})),n.d(r,"getFilenameFromUri",(function(){return ay})),n.d(r,"getImagePixels",(function(){return sy})),n.d(r,"getMagic",(function(){return cy})),n.d(r,"getStringFromTypedArray",(function(){return is})),n.d(r,"getTimestamp",(function(){return Qd})),n.d(r,"GoogleEarthEnterpriseMetadata",(function(){return wy})),n.d(r,"GoogleEarthEnterpriseTerrainData",(function(){return Ny})),n.d(r,"GoogleEarthEnterpriseTerrainProvider",(function(){return Gy})),n.d(r,"GoogleEarthEnterpriseTileInformation",(function(){return fy})),n.d(r,"GregorianDate",(function(){return er})),n.d(r,"GroundPolylineGeometry",(function(){return wO})),n.d(r,"HeadingPitchRange",(function(){return xO})),n.d(r,"HeadingPitchRoll",(function(){return Rr})),n.d(r,"Heap",(function(){return EO.a})),n.d(r,"HeightmapTerrainData",(function(){return Tl})),n.d(r,"HeightmapTessellator",(function(){return il})),n.d(r,"HermitePolynomialApproximation",(function(){return PO})),n.d(r,"HermiteSpline",(function(){return vo})),n.d(r,"Iau2000Orientation",(function(){return NO})),n.d(r,"Iau2006XysData",(function(){return zr})),n.d(r,"Iau2006XysSample",(function(){return Lr})),n.d(r,"IauOrientationAxes",(function(){return HO})),n.d(r,"IauOrientationParameters",(function(){return IO})),n.d(r,"IndexDatatype",(function(){return Sl})),n.d(r,"InterpolationAlgorithm",(function(){return qO})),n.d(r,"Intersect",(function(){return ce})),n.d(r,"Intersections2D",(function(){return Pl})),n.d(r,"IntersectionTests",(function(){return tc})),n.d(r,"Interval",(function(){return le})),n.d(r,"Ion",(function(){return Ng})),n.d(r,"IonGeocoderService",(function(){return ZO})),n.d(r,"IonResource",(function(){return Bg})),n.d(r,"isArray",(function(){return ym.a})),n.d(r,"isBitSet",(function(){return uy})),n.d(r,"isBlobUri",(function(){return QO.a})),n.d(r,"isCrossOriginUrl",(function(){return al.a})),n.d(r,"isDataUri",(function(){return KO.a})),n.d(r,"isLeapYear",(function(){return tr})),n.d(r,"Iso8601",(function(){return nx})),n.d(r,"JulianDate",(function(){return Tr})),n.d(r,"KeyboardEventModifier",(function(){return rx})),n.d(r,"LagrangePolynomialApproximation",(function(){return ox})),n.d(r,"LeapSecond",(function(){return ir})),n.d(r,"LinearApproximation",(function(){return cx})),n.d(r,"LinearSpline",(function(){return so})),n.d(r,"loadAndExecuteScript",(function(){return py.a})),n.d(r,"loadCRN",(function(){return ux})),n.d(r,"loadImageFromTypedArray",(function(){return hx})),n.d(r,"loadKTX",(function(){return Ox})),n.d(r,"ManagedArray",(function(){return Tx})),n.d(r,"MapboxApi",(function(){return Px})),n.d(r,"MapProjection",(function(){return Dx})),n.d(r,"Math",(function(){return I})),n.d(r,"Matrix2",(function(){return vn})),n.d(r,"Matrix3",(function(){return be})),n.d(r,"Matrix4",(function(){return Be})),n.d(r,"mergeSort",(function(){return Lx})),n.d(r,"NearFarScalar",(function(){return Fx})),n.d(r,"objectToQuery",(function(){return kx.a})),n.d(r,"Occluder",(function(){return $x})),n.d(r,"OffsetGeometryInstanceAttribute",(function(){return tE})),n.d(r,"oneTimeWarning",(function(){return iE.a})),n.d(r,"OpenCageGeocoderService",(function(){return aE})),n.d(r,"OrientedBoundingBox",(function(){return Fc})),n.d(r,"OrthographicFrustum",(function(){return hb})),n.d(r,"OrthographicOffCenterFrustum",(function(){return cb})),n.d(r,"Packable",(function(){return oE})),n.d(r,"PackableForInterpolation",(function(){return sE})),n.d(r,"parseResponseHeaders",(function(){return cE.a})),n.d(r,"PeliasGeocoderService",(function(){return YO})),n.d(r,"PerspectiveFrustum",(function(){return wb})),n.d(r,"PerspectiveOffCenterFrustum",(function(){return vb})),n.d(r,"PinBuilder",(function(){return gE})),n.d(r,"PixelFormat",(function(){return gx})),n.d(r,"Plane",(function(){return oc})),n.d(r,"PlaneGeometry",(function(){return xE})),n.d(r,"PlaneOutlineGeometry",(function(){return SE})),n.d(r,"pointInsideTriangle",(function(){return PE})),n.d(r,"PolygonGeometry",(function(){return lT})),n.d(r,"PolygonGeometryLibrary",(function(){return Vp})),n.d(r,"PolygonHierarchy",(function(){return uT})),n.d(r,"PolygonOutlineGeometry",(function(){return vT})),n.d(r,"PolygonPipeline",(function(){return wp})),n.d(r,"PolylineGeometry",(function(){return PT})),n.d(r,"PolylinePipeline",(function(){return Gm})),n.d(r,"PolylineVolumeGeometry",(function(){return LT})),n.d(r,"PolylineVolumeGeometryLibrary",(function(){return C_})),n.d(r,"PolylineVolumeOutlineGeometry",(function(){return zT})),n.d(r,"PrimitiveType",(function(){return yn})),n.d(r,"QuadraticRealPolynomial",(function(){return _s})),n.d(r,"QuantizedMeshTerrainData",(function(){return Ul})),n.d(r,"QuarticRealPolynomial",(function(){return xs})),n.d(r,"Quaternion",(function(){return Kn})),n.d(r,"QuaternionSpline",(function(){return VT})),n.d(r,"queryToObject",(function(){return HT.a})),n.d(r,"Queue",(function(){return xp})),n.d(r,"Ray",(function(){return Ts})),n.d(r,"Rectangle",(function(){return Ve})),n.d(r,"RectangleCollisionChecker",(function(){return pC})),n.d(r,"RectangleGeometry",(function(){return nS})),n.d(r,"RectangleGeometryLibrary",(function(){return TC})),n.d(r,"RectangleOutlineGeometry",(function(){return pS})),n.d(r,"ReferenceFrame",(function(){return mS})),n.d(r,"Request",(function(){return Vl.a})),n.d(r,"requestAnimationFrame",(function(){return gS})),n.d(r,"RequestErrorEvent",(function(){return vS.a})),n.d(r,"RequestScheduler",(function(){return bS.a})),n.d(r,"RequestState",(function(){return Fy.a})),n.d(r,"RequestType",(function(){return Hl.a})),n.d(r,"Resource",(function(){return f.a})),n.d(r,"RuntimeError",(function(){return Ce.a})),n.d(r,"sampleTerrain",(function(){return OS})),n.d(r,"sampleTerrainMostDetailed",(function(){return ES})),n.d(r,"scaleToGeodeticSurface",(function(){return H})),n.d(r,"ScreenSpaceEventHandler",(function(){return aA})),n.d(r,"ScreenSpaceEventType",(function(){return TS})),n.d(r,"ShowGeometryInstanceAttribute",(function(){return sA})),n.d(r,"Simon1994PlanetaryPositions",(function(){return OP})),n.d(r,"SimplePolylineGeometry",(function(){return AP})),n.d(r,"SphereGeometry",(function(){return jP})),n.d(r,"SphereOutlineGeometry",(function(){return NP})),n.d(r,"Spherical",(function(){return kP})),n.d(r,"Spline",(function(){return ao})),n.d(r,"subdivideArray",(function(){return BP})),n.d(r,"TaskProcessor",(function(){return pl})),n.d(r,"TerrainData",(function(){return UP})),n.d(r,"TerrainEncoding",(function(){return Xc})),n.d(r,"TerrainMesh",(function(){return ml})),n.d(r,"TerrainProvider",(function(){return vl})),n.d(r,"TerrainQuantization",(function(){return kc})),n.d(r,"TileAvailability",(function(){return su})),n.d(r,"TileProviderError",(function(){return uu})),n.d(r,"TilingScheme",(function(){return HP})),n.d(r,"TimeConstants",(function(){return nr})),n.d(r,"TimeInterval",(function(){return ex})),n.d(r,"TimeIntervalCollection",(function(){return eI})),n.d(r,"TimeStandard",(function(){return rr})),n.d(r,"Tipsify",(function(){return Bu})),n.d(r,"Transforms",(function(){return xa})),n.d(r,"TranslationRotationScale",(function(){return aI})),n.d(r,"TridiagonalSystemSolver",(function(){return lo})),n.d(r,"TrustedServers",(function(){return oI.a})),n.d(r,"VertexFormat",(function(){return Ba})),n.d(r,"VideoSynchronizer",(function(){return cI})),n.d(r,"Visibility",(function(){return Bx})),n.d(r,"VRTheWorldTerrainProvider",(function(){return pI})),n.d(r,"WallGeometry",(function(){return LI})),n.d(r,"WallGeometryLibrary",(function(){return OI})),n.d(r,"WallOutlineGeometry",(function(){return UI})),n.d(r,"WebGLConstants",(function(){return un})),n.d(r,"webGLConstantToGlslType",(function(){return VI})),n.d(r,"WebMercatorProjection",(function(){return Qc})),n.d(r,"WebMercatorTilingScheme",(function(){return GI})),n.d(r,"WeightSpline",(function(){return WI})),n.d(r,"WindingOrder",(function(){return op})),n.d(r,"wrapFunction",(function(){return YI})),n.d(r,"writeTextToCanvas",(function(){return hE})),n.d(r,"BillboardGraphics",(function(){return $I})),n.d(r,"BillboardVisualizer",(function(){return TD})),n.d(r,"BoundingSphereState",(function(){return nD})),n.d(r,"BoxGeometryUpdater",(function(){return fU})),n.d(r,"BoxGraphics",(function(){return HB})),n.d(r,"CallbackProperty",(function(){return tM})),n.d(r,"CheckerboardMaterialProperty",(function(){return vU})),n.d(r,"ColorMaterialProperty",(function(){return oM})),n.d(r,"CompositeEntityCollection",(function(){return jU})),n.d(r,"CompositeMaterialProperty",(function(){return NU})),n.d(r,"CompositePositionProperty",(function(){return kU})),n.d(r,"CompositeProperty",(function(){return RU})),n.d(r,"ConstantPositionProperty",(function(){return XB})),n.d(r,"ConstantProperty",(function(){return ZI})),n.d(r,"CorridorGeometryUpdater",(function(){return ZU})),n.d(r,"CorridorGraphics",(function(){return QB})),n.d(r,"createMaterialPropertyDescriptor",(function(){return UB})),n.d(r,"createPropertyDescriptor",(function(){return KI})),n.d(r,"createRawPropertyDescriptor",(function(){return JB})),n.d(r,"CustomDataSource",(function(){return Kq})),n.d(r,"CylinderGeometryUpdater",(function(){return aW})),n.d(r,"CylinderGraphics",(function(){return ez})),n.d(r,"CzmlDataSource",(function(){return sX})),n.d(r,"DataSource",(function(){return KU})),n.d(r,"DataSourceClock",(function(){return lW})),n.d(r,"DataSourceCollection",(function(){return hX})),n.d(r,"DataSourceDisplay",(function(){return Cee})),n.d(r,"DiffusionRingMaterialProperty",(function(){return zW})),n.d(r,"DirectionMaterialProperty",(function(){return Iee})),n.d(r,"DynamicGeometryBatch",(function(){return k6})),n.d(r,"DynamicGeometryUpdater",(function(){return aU})),n.d(r,"EllipseGeometryUpdater",(function(){return W6})),n.d(r,"EllipseGraphics",(function(){return iz})),n.d(r,"EllipsoidGeometryUpdater",(function(){return i8})),n.d(r,"EllipsoidGraphics",(function(){return rz})),n.d(r,"Entity",(function(){return zz})),n.d(r,"EntityCluster",(function(){return Zq})),n.d(r,"EntityCollection",(function(){return OU})),n.d(r,"EntityView",(function(){return Xee})),n.d(r,"GeoJsonDataSource",(function(){return Pte})),n.d(r,"GeometryUpdater",(function(){return Qz})),n.d(r,"GeometryVisualizer",(function(){return z7})),n.d(r,"GridMaterialProperty",(function(){return mW})),n.d(r,"GroundGeometryUpdater",(function(){return UU})),n.d(r,"heightReferenceOnEntityPropertyChanged",(function(){return tU})),n.d(r,"ImageMaterialProperty",(function(){return BB})),n.d(r,"KmlCamera",(function(){return Ite})),n.d(r,"KmlDataSource",(function(){return cne})),n.d(r,"KmlLookAt",(function(){return Lte})),n.d(r,"KmlTour",(function(){return zte})),n.d(r,"KmlTourFlyTo",(function(){return Vte})),n.d(r,"KmlTourWait",(function(){return Gte})),n.d(r,"LabelGraphics",(function(){return oz})),n.d(r,"LabelVisualizer",(function(){return h9})),n.d(r,"MaterialProperty",(function(){return nU})),n.d(r,"ModelGraphics",(function(){return mz})),n.d(r,"ModelVisualizer",(function(){return E9})),n.d(r,"NodeTransformationProperty",(function(){return lz})),n.d(r,"PathGraphics",(function(){return gz})),n.d(r,"PathVisualizer",(function(){return N9})),n.d(r,"PlaneGeometryUpdater",(function(){return _8})),n.d(r,"PlaneGraphics",(function(){return bz})),n.d(r,"PointGraphics",(function(){return wz})),n.d(r,"PointVisualizer",(function(){return X9})),n.d(r,"PolygonGeometryUpdater",(function(){return C8})),n.d(r,"PolygonGraphics",(function(){return xz})),n.d(r,"PolylineArrowMaterialProperty",(function(){return gW})),n.d(r,"PolylineDashDynamicMaterialProperty",(function(){return FW})),n.d(r,"PolylineDashMaterialProperty",(function(){return wW})),n.d(r,"PolylineDynamicMaterialProperty",(function(){return jW})),n.d(r,"PolylineGeometryUpdater",(function(){return lee})),n.d(r,"PolylineGlowMaterialProperty",(function(){return EW})),n.d(r,"PolylineGraphics",(function(){return Tz})),n.d(r,"PolylineOutlineMaterialProperty",(function(){return AW})),n.d(r,"PolylineVisualizer",(function(){return Oee})),n.d(r,"PolylineVolumeGeometryUpdater",(function(){return D8})),n.d(r,"PolylineVolumeGraphics",(function(){return Sz})),n.d(r,"PositionProperty",(function(){return WB})),n.d(r,"PositionPropertyArray",(function(){return VW})),n.d(r,"Property",(function(){return aD})),n.d(r,"PropertyArray",(function(){return GW})),n.d(r,"PropertyBag",(function(){return dz})),n.d(r,"RadarMaterialProperty",(function(){return AY})),n.d(r,"RectangleGeometryUpdater",(function(){return U8})),n.d(r,"RectangleGraphics",(function(){return Pz})),n.d(r,"ReferenceProperty",(function(){return YW})),n.d(r,"RoadNetWorkMaterialProperty",(function(){return une})),n.d(r,"Rotation",(function(){return XW})),n.d(r,"SampledPositionProperty",(function(){return rY})),n.d(r,"SampledProperty",(function(){return iY})),n.d(r,"ScaledPositionProperty",(function(){return C9})),n.d(r,"StaticGeometryColorBatch",(function(){return e7})),n.d(r,"StaticGeometryPerMaterialBatch",(function(){return c7})),n.d(r,"StaticGroundGeometryColorBatch",(function(){return m7})),n.d(r,"StaticGroundGeometryPerMaterialBatch",(function(){return y7})),n.d(r,"StaticGroundPolylinePerMaterialBatch",(function(){return mee})),n.d(r,"StaticOutlineGeometryBatch",(function(){return A7})),n.d(r,"StripeMaterialProperty",(function(){return uY})),n.d(r,"StripeOrientation",(function(){return aY})),n.d(r,"TerrainOffsetProperty",(function(){return eU})),n.d(r,"TimeIntervalCollectionPositionProperty",(function(){return dY})),n.d(r,"TimeIntervalCollectionProperty",(function(){return pY})),n.d(r,"VelocityOrientationProperty",(function(){return EY})),n.d(r,"VelocityVectorProperty",(function(){return bY})),n.d(r,"Visualizer",(function(){return fne})),n.d(r,"WallGeometryUpdater",(function(){return M7})),n.d(r,"WallGraphics",(function(){return Dz})),n.d(r,"AutomaticUniforms",(function(){return kM})),n.d(r,"Buffer",(function(){return ZN})),n.d(r,"BufferUsage",(function(){return YN})),n.d(r,"ClearCommand",(function(){return fX})),n.d(r,"ComputeCommand",(function(){return OX})),n.d(r,"ComputeEngine",(function(){return vne})),n.d(r,"Context",(function(){return ere})),n.d(r,"ContextLimits",(function(){return HD})),n.d(r,"createUniform",(function(){return eR})),n.d(r,"createUniformArray",(function(){return fR})),n.d(r,"CubeMap",(function(){return nj})),n.d(r,"CubeMapFace",(function(){return qD})),n.d(r,"DrawCommand",(function(){return cM})),n.d(r,"Framebuffer",(function(){return cj})),n.d(r,"freezeRenderState",(function(){return uM})),n.d(r,"loadCubeMap",(function(){return tre})),n.d(r,"MipmapHint",(function(){return YD})),n.d(r,"modernizeShader",(function(){return OR})),n.d(r,"Pass",(function(){return lM})),n.d(r,"PassState",(function(){return bne})),n.d(r,"PixelDatatype",(function(){return mx})),n.d(r,"Renderbuffer",(function(){return are})),n.d(r,"RenderbufferFormat",(function(){return nre})),n.d(r,"RenderState",(function(){return RM})),n.d(r,"Sampler",(function(){return tj})),n.d(r,"ShaderCache",(function(){return One})),n.d(r,"ShaderProgram",(function(){return bR})),n.d(r,"ShaderSource",(function(){return UN})),n.d(r,"Texture",(function(){return hj})),n.d(r,"TextureCache",(function(){return Ene})),n.d(r,"TextureMagnificationFilter",(function(){return ZD})),n.d(r,"TextureMinificationFilter",(function(){return KD})),n.d(r,"TextureWrap",(function(){return $D})),n.d(r,"UniformState",(function(){return Vne})),n.d(r,"VertexArray",(function(){return tF})),n.d(r,"VertexArrayFacade",(function(){return YV})),n.d(r,"Appearance",(function(){return UD})),n.d(r,"ArcGisMapServerImageryProvider",(function(){return _re})),n.d(r,"AttributeType",(function(){return _X})),n.d(r,"AutoExposure",(function(){return Ore})),n.d(r,"Axis",(function(){return mX})),n.d(r,"Batched3DModel3DTileContent",(function(){return s1})),n.d(r,"BatchTable",(function(){return hF})),n.d(r,"Billboard",(function(){return UV})),n.d(r,"BillboardCollection",(function(){return nG})),n.d(r,"BingMapsImageryProvider",(function(){return Are})),n.d(r,"BingMapsStyle",(function(){return xre})),n.d(r,"BlendEquation",(function(){return MD})),n.d(r,"BlendFunction",(function(){return LD})),n.d(r,"BlendingState",(function(){return FD})),n.d(r,"BlendOption",(function(){return QV})),n.d(r,"BoxEmitter",(function(){return jre})),n.d(r,"BrdfLutGenerator",(function(){return Lre})),n.d(r,"Camera",(function(){return ose})),n.d(r,"CameraEventAggregator",(function(){return mse})),n.d(r,"CameraEventType",(function(){return sse})),n.d(r,"CameraFlightPath",(function(){return Kre})),n.d(r,"Cesium3DTile",(function(){return r5})),n.d(r,"Cesium3DTileBatchTable",(function(){return ZX})),n.d(r,"Cesium3DTileColorBlendMode",(function(){return gX})),n.d(r,"Cesium3DTileContent",(function(){return gse})),n.d(r,"Cesium3DTileContentFactory",(function(){return b4})),n.d(r,"Cesium3DTileContentState",(function(){return y4})),n.d(r,"Cesium3DTileFeature",(function(){return KX})),n.d(r,"Cesium3DTileFeatureTable",(function(){return eZ})),n.d(r,"Cesium3DTileOptimizationHint",(function(){return w4})),n.d(r,"Cesium3DTileOptimizations",(function(){return s5})),n.d(r,"Cesium3DTilePointFeature",(function(){return A2})),n.d(r,"Cesium3DTileRefine",(function(){return H1})),n.d(r,"Cesium3DTileset",(function(){return zse})),n.d(r,"Cesium3DTilesetAsyncTraversal",(function(){return v5})),n.d(r,"Cesium3DTilesetCache",(function(){return y5})),n.d(r,"Cesium3DTilesetStatistics",(function(){return x5})),n.d(r,"Cesium3DTilesetTraversal",(function(){return K5})),n.d(r,"Cesium3DTileStyle",(function(){return Wse})),n.d(r,"Cesium3DTileStyleEngine",(function(){return $5})),n.d(r,"CircleEmitter",(function(){return Xse})),n.d(r,"ClassificationModel",(function(){return FK})),n.d(r,"ClassificationPrimitive",(function(){return tB})),n.d(r,"ClassificationType",(function(){return iM})),n.d(r,"ClippingPlane",(function(){return VK})),n.d(r,"ClippingPlaneCollection",(function(){return iJ})),n.d(r,"ColorBlendMode",(function(){return sW})),n.d(r,"Composite3DTileContent",(function(){return u1})),n.d(r,"computeFlyToLocationForRectangle",(function(){return Qse})),n.d(r,"ConditionsExpression",(function(){return Hse})),n.d(r,"ConeEmitter",(function(){return $se})),n.d(r,"createBillboardPointCallback",(function(){return E2})),n.d(r,"createOpenStreetMapImageryProvider",(function(){return wce})),n.d(r,"createTangentSpaceDebugPrimitive",(function(){return Oce})),n.d(r,"createTileMapServiceImageryProvider",(function(){return xce})),n.d(r,"createWorldImagery",(function(){return lle})),n.d(r,"CreditDisplay",(function(){return Ole})),n.d(r,"CullFace",(function(){return BD})),n.d(r,"DebugAppearance",(function(){return Ele})),n.d(r,"DebugCameraPrimitive",(function(){return Lle})),n.d(r,"DebugModelMatrixPrimitive",(function(){return Fle})),n.d(r,"DepthFunction",(function(){return qN})),n.d(r,"DepthPlane",(function(){return Wle})),n.d(r,"DerivedCommand",(function(){return $le})),n.d(r,"DeviceOrientationCameraController",(function(){return rue})),n.d(r,"DiscardMissingTileImagePolicy",(function(){return sre})),n.d(r,"DracoLoader",(function(){return fJ})),n.d(r,"DracoTaskProcessorPool",(function(){return aJ})),n.d(r,"EllipsoidPrimitive",(function(){return uue})),n.d(r,"EllipsoidSurfaceAppearance",(function(){return pue})),n.d(r,"Empty3DTileContent",(function(){return x4})),n.d(r,"Expression",(function(){return sK})),n.d(r,"ExpressionNodeType",(function(){return DQ})),n.d(r,"Fog",(function(){return Eue})),n.d(r,"FrameRateMonitor",(function(){return Cue})),n.d(r,"FrameState",(function(){return Sue})),n.d(r,"FrustumCommands",(function(){return Aue})),n.d(r,"Geometry3DTileContent",(function(){return b1})),n.d(r,"getBinaryAccessor",(function(){return yX})),n.d(r,"getClipAndStyleCode",(function(){return pJ})),n.d(r,"getClippingFunction",(function(){return _J})),n.d(r,"GetFeatureInfoFormat",(function(){return Gce})),n.d(r,"Globe",(function(){return Cde})),n.d(r,"GlobeDepth",(function(){return Fde})),n.d(r,"GlobeSurfaceShaderSet",(function(){return Rue})),n.d(r,"GlobeSurfaceTile",(function(){return Que})),n.d(r,"GlobeSurfaceTileProvider",(function(){return Bhe})),n.d(r,"GoogleEarthEnterpriseImageryProvider",(function(){return zde})),n.d(r,"GoogleEarthEnterpriseMapsProvider",(function(){return Tce})),n.d(r,"GridImageryProvider",(function(){return qde})),n.d(r,"GroundPolylinePrimitive",(function(){return LB})),n.d(r,"GroundPrimitive",(function(){return mB})),n.d(r,"HeightReference",(function(){return eD})),n.d(r,"HorizontalOrigin",(function(){return tD})),n.d(r,"Imagery",(function(){return ehe})),n.d(r,"ImageryLayer",(function(){return phe})),n.d(r,"ImageryLayerCollection",(function(){return Ghe})),n.d(r,"ImageryLayerFeatureInfo",(function(){return lre})),n.d(r,"ImageryProvider",(function(){return fre})),n.d(r,"ImagerySplitDirection",(function(){return the})),n.d(r,"ImageryState",(function(){return Lue})),n.d(r,"Instanced3DModel3DTileContent",(function(){return V1})),n.d(r,"InvertClassification",(function(){return Qde})),n.d(r,"IonImageryProvider",(function(){return sle})),n.d(r,"IonWorldImageryStyle",(function(){return cle})),n.d(r,"JobScheduler",(function(){return $de})),n.d(r,"JobType",(function(){return gJ})),n.d(r,"Label",(function(){return pG})),n.d(r,"LabelCollection",(function(){return jG})),n.d(r,"LabelStyle",(function(){return rG})),n.d(r,"MapboxImageryProvider",(function(){return Pce})),n.d(r,"MapMode2D",(function(){return Jre})),n.d(r,"Material",(function(){return qj})),n.d(r,"MaterialAppearance",(function(){return Yj})),n.d(r,"Model",(function(){return J0})),n.d(r,"ModelAnimation",(function(){return PJ})),n.d(r,"ModelAnimationCache",(function(){return TJ})),n.d(r,"ModelAnimationCollection",(function(){return LJ})),n.d(r,"ModelAnimationLoop",(function(){return CJ})),n.d(r,"ModelAnimationState",(function(){return SJ})),n.d(r,"ModelInstance",(function(){return w1})),n.d(r,"ModelInstanceCollection",(function(){return N1})),n.d(r,"ModelLoadResources",(function(){return QZ})),n.d(r,"ModelMaterial",(function(){return FJ})),n.d(r,"ModelMesh",(function(){return BJ})),n.d(r,"ModelNode",(function(){return UJ})),n.d(r,"ModelUtility",(function(){return wQ})),n.d(r,"Moon",(function(){return afe})),n.d(r,"NeverTileDiscardPolicy",(function(){return sfe})),n.d(r,"OctahedralProjectedCubeMap",(function(){return o$})),n.d(r,"OIT",(function(){return Ofe})),n.d(r,"OrderedGroundPrimitiveCollection",(function(){return N6})),n.d(r,"Particle",(function(){return Cfe})),n.d(r,"ParticleBurst",(function(){return Afe})),n.d(r,"ParticleEmitter",(function(){return Ife})),n.d(r,"ParticleSystem",(function(){return Bfe})),n.d(r,"PerformanceDisplay",(function(){return Vfe})),n.d(r,"PerInstanceColorAppearance",(function(){return $j})),n.d(r,"PickDepth",(function(){return Zfe})),n.d(r,"PickDepthFramebuffer",(function(){return Jfe})),n.d(r,"PickFramebuffer",(function(){return tpe})),n.d(r,"PointCloud",(function(){return m2})),n.d(r,"PointCloud3DTileContent",(function(){return w2})),n.d(r,"PointCloudEyeDomeLighting",(function(){return c6})),n.d(r,"PointCloudShading",(function(){return u6})),n.d(r,"PointPrimitive",(function(){return XG})),n.d(r,"PointPrimitiveCollection",(function(){return Tq})),n.d(r,"Polyline",(function(){return B2})),n.d(r,"PolylineCollection",(function(){return A3})),n.d(r,"PolylineColorAppearance",(function(){return TB})),n.d(r,"PolylineMaterialAppearance",(function(){return DB})),n.d(r,"PostProcessStage",(function(){return hpe})),n.d(r,"PostProcessStageCollection",(function(){return nme})),n.d(r,"PostProcessStageComposite",(function(){return Mpe})),n.d(r,"PostProcessStageLibrary",(function(){return Upe})),n.d(r,"PostProcessStageSampleMode",(function(){return ipe})),n.d(r,"PostProcessStageTextureCache",(function(){return Zpe})),n.d(r,"Primitive",(function(){return ck})),n.d(r,"PrimitiveCollection",(function(){return R6})),n.d(r,"PrimitivePipeline",(function(){return yF})),n.d(r,"PrimitiveState",(function(){return wF})),n.d(r,"processModelMaterialsCommon",(function(){return xQ})),n.d(r,"processPbrMaterials",(function(){return CQ})),n.d(r,"QuadtreeOccluders",(function(){return Whe})),n.d(r,"QuadtreePrimitive",(function(){return pde})),n.d(r,"QuadtreeTile",(function(){return Zhe})),n.d(r,"QuadtreeTileLoadState",(function(){return Nue})),n.d(r,"QuadtreeTileProvider",(function(){return ame})),n.d(r,"Scene",(function(){return xOe})),n.d(r,"SceneFramebuffer",(function(){return gbe})),n.d(r,"SceneMode",(function(){return xF})),n.d(r,"SceneTransforms",(function(){return gV})),n.d(r,"SceneTransitioner",(function(){return h_e})),n.d(r,"ScreenSpaceCameraController",(function(){return xve})),n.d(r,"ShadowMap",(function(){return dbe})),n.d(r,"ShadowMapShader",(function(){return Tve})),n.d(r,"ShadowMode",(function(){return rM})),n.d(r,"ShadowVolumeAppearance",(function(){return Fk})),n.d(r,"SingleTileImageryProvider",(function(){return Dce})),n.d(r,"SkyAtmosphere",(function(){return SOe})),n.d(r,"SkyBox",(function(){return DOe})),n.d(r,"SphereEmitter",(function(){return MOe})),n.d(r,"StencilConstants",(function(){return Hk})),n.d(r,"StencilFunction",(function(){return Bk})),n.d(r,"StencilOperation",(function(){return Uk})),n.d(r,"StyleExpression",(function(){return LOe})),n.d(r,"Sun",(function(){return GOe})),n.d(r,"SunPostProcess",(function(){return xbe})),n.d(r,"TerrainState",(function(){return Fue})),n.d(r,"TextureAtlas",(function(){return nH})),n.d(r,"TileBoundingRegion",(function(){return B4})),n.d(r,"TileBoundingSphere",(function(){return U4})),n.d(r,"TileBoundingVolume",(function(){return WOe})),n.d(r,"TileCoordinatesImageryProvider",(function(){return XOe})),n.d(r,"TileDiscardPolicy",(function(){return QOe})),n.d(r,"TileImagery",(function(){return nhe})),n.d(r,"TileOrientedBoundingBox",(function(){return H4})),n.d(r,"TileReplacementQueue",(function(){return $he})),n.d(r,"Tileset3DTileContent",(function(){return x2})),n.d(r,"TileState",(function(){return KOe})),n.d(r,"TileTerrain",(function(){return Uue})),n.d(r,"TimeDynamicImagery",(function(){return Zce})),n.d(r,"TimeDynamicPointCloud",(function(){return dxe})),n.d(r,"Tonemapper",(function(){return Kpe})),n.d(r,"TweenCollection",(function(){return p_e})),n.d(r,"UrlTemplateImageryProvider",(function(){return bce})),n.d(r,"Vector3DTileBatch",(function(){return SQ})),n.d(r,"Vector3DTileContent",(function(){return l4})),n.d(r,"Vector3DTileGeometry",(function(){return m1})),n.d(r,"Vector3DTilePoints",(function(){return V3})),n.d(r,"Vector3DTilePolygons",(function(){return Y3})),n.d(r,"Vector3DTilePolylines",(function(){return r4})),n.d(r,"Vector3DTilePrimitive",(function(){return EK})),n.d(r,"VerticalOrigin",(function(){return iD})),n.d(r,"View",(function(){return jbe})),n.d(r,"ViewportQuad",(function(){return mxe})),n.d(r,"WebMapServiceImageryProvider",(function(){return $ce})),n.d(r,"WebMapTileServiceImageryProvider",(function(){return nle})),n.d(r,"_shadersAdjustTranslucentFS",(function(){return cfe})),n.d(r,"_shadersBillboardCollectionFS",(function(){return XV})),n.d(r,"_shadersBillboardCollectionVS",(function(){return ZV})),n.d(r,"_shadersBrdfLutGeneratorFS",(function(){return Mre})),n.d(r,"_shadersCompositeOITFS",(function(){return lfe})),n.d(r,"_shadersDepthPlaneFS",(function(){return kle})),n.d(r,"_shadersDepthPlaneVS",(function(){return Ble})),n.d(r,"_shadersEllipsoidFS",(function(){return aue})),n.d(r,"_shadersEllipsoidVS",(function(){return oue})),n.d(r,"_shadersGlobeFS",(function(){return Pue})),n.d(r,"_shadersGlobeVS",(function(){return Iue})),n.d(r,"_shadersGroundAtmosphere",(function(){return Due})),n.d(r,"_shadersOctahedralProjectionAtlasFS",(function(){return VJ})),n.d(r,"_shadersOctahedralProjectionFS",(function(){return HJ})),n.d(r,"_shadersOctahedralProjectionVS",(function(){return GJ})),n.d(r,"_shadersPointPrimitiveCollectionFS",(function(){return ZG})),n.d(r,"_shadersPointPrimitiveCollectionVS",(function(){return QG})),n.d(r,"_shadersPolylineCommon",(function(){return wB})),n.d(r,"_shadersPolylineFS",(function(){return SB})),n.d(r,"_shadersPolylineShadowVolumeFS",(function(){return gB})),n.d(r,"_shadersPolylineShadowVolumeMorphFS",(function(){return bB})),n.d(r,"_shadersPolylineShadowVolumeMorphVS",(function(){return vB})),n.d(r,"_shadersPolylineShadowVolumeVS",(function(){return _B})),n.d(r,"_shadersPolylineVS",(function(){return P2})),n.d(r,"_shadersReprojectWebMercatorFS",(function(){return Kue})),n.d(r,"_shadersReprojectWebMercatorVS",(function(){return Jue})),n.d(r,"_shadersShadowVolumeAppearanceFS",(function(){return lk})),n.d(r,"_shadersShadowVolumeAppearanceVS",(function(){return HN})),n.d(r,"_shadersShadowVolumeFS",(function(){return VN})),n.d(r,"_shadersSkyAtmosphereFS",(function(){return EOe})),n.d(r,"_shadersSkyAtmosphereVS",(function(){return TOe})),n.d(r,"_shadersSkyBoxFS",(function(){return AOe})),n.d(r,"_shadersSkyBoxVS",(function(){return POe})),n.d(r,"_shadersSunFS",(function(){return NOe})),n.d(r,"_shadersSunTextureFS",(function(){return FOe})),n.d(r,"_shadersSunVS",(function(){return kOe})),n.d(r,"_shadersVector3DTilePolylinesVS",(function(){return X3})),n.d(r,"_shadersVectorTileVS",(function(){return AQ})),n.d(r,"_shadersViewportQuadFS",(function(){return fxe})),n.d(r,"_shadersViewportQuadVS",(function(){return pne})),n.d(r,"Autolinker",(function(){return jte})),n.d(r,"bitmap_sdf",(function(){return bxe})),n.d(r,"earcut_2_2_1",(function(){return rp})),n.d(r,"graphemesplitter",(function(){return yxe})),n.d(r,"jsep",(function(){return IQ})),n.d(r,"kdbush",(function(){return jq})),n.d(r,"knockout_3_5_1",(function(){return wxe.a})),n.d(r,"knockout_es5",(function(){return Pxe})),n.d(r,"knockout",(function(){return Dxe})),n.d(r,"LercDecode",(function(){return Mxe})),n.d(r,"measureText",(function(){return uE})),n.d(r,"mersenne_twister",(function(){return C})),n.d(r,"NoSleep",(function(){return Lxe})),n.d(r,"protobuf_minimal",(function(){return ly.a})),n.d(r,"purify",(function(){return Xo})),n.d(r,"quickselect",(function(){return WT})),n.d(r,"rbush",(function(){return cC})),n.d(r,"sprintf",(function(){return $n})),n.d(r,"topojson",(function(){return Qee})),n.d(r,"Tween",(function(){return Sv})),n.d(r,"Uri",(function(){return Co.a})),n.d(r,"when",(function(){return Oi.a})),n.d(r,"zip",(function(){return Rte})),n.d(r,"ClockViewModel",(function(){return Fxe})),n.d(r,"Command",(function(){return kxe})),n.d(r,"createCommand",(function(){return Bxe})),n.d(r,"getElement",(function(){return zfe})),n.d(r,"InspectorShared",(function(){return Uxe})),n.d(r,"subscribeAndEvaluate",(function(){return Vxe})),n.d(r,"SvgPathBindingHandler",(function(){return Ixe})),n.d(r,"ToggleButtonViewModel",(function(){return qxe})),n.d(r,"_shadersAllMaterialAppearanceFS",(function(){return CD})),n.d(r,"_shadersAllMaterialAppearanceVS",(function(){return SD})),n.d(r,"_shadersBasicMaterialAppearanceFS",(function(){return AD})),n.d(r,"_shadersBasicMaterialAppearanceVS",(function(){return PD})),n.d(r,"_shadersEllipsoidSurfaceAppearanceFS",(function(){return hue})),n.d(r,"_shadersEllipsoidSurfaceAppearanceVS",(function(){return due})),n.d(r,"_shadersPerInstanceColorAppearanceFS",(function(){return Xj})),n.d(r,"_shadersPerInstanceColorAppearanceVS",(function(){return Zj})),n.d(r,"_shadersPerInstanceFlatColorAppearanceFS",(function(){return Qj})),n.d(r,"_shadersPerInstanceFlatColorAppearanceVS",(function(){return Kj})),n.d(r,"_shadersPolylineColorAppearanceVS",(function(){return yB})),n.d(r,"_shadersPolylineMaterialAppearanceVS",(function(){return CB})),n.d(r,"_shadersTexturedMaterialAppearanceFS",(function(){return ID})),n.d(r,"_shadersTexturedMaterialAppearanceVS",(function(){return DD})),n.d(r,"_shadersCzmBuiltins",(function(){return DN})),n.d(r,"_shadersBumpMapMaterial",(function(){return dj})),n.d(r,"_shadersCheckerboardMaterial",(function(){return fj})),n.d(r,"_shadersDotMaterial",(function(){return pj})),n.d(r,"_shadersElevationContourMaterial",(function(){return mj})),n.d(r,"_shadersElevationRampMaterial",(function(){return _j})),n.d(r,"_shadersFadeMaterial",(function(){return gj})),n.d(r,"_shadersGridMaterial",(function(){return vj})),n.d(r,"_shadersNormalMapMaterial",(function(){return bj})),n.d(r,"_shadersPolylineArrowMaterial",(function(){return yj})),n.d(r,"_shadersPolylineDashMaterial",(function(){return wj})),n.d(r,"_shadersPolylineGlowMaterial",(function(){return xj})),n.d(r,"_shadersPolylineOutlineMaterial",(function(){return Ej})),n.d(r,"_shadersRimLightingMaterial",(function(){return Tj})),n.d(r,"_shadersSlopeRampMaterial",(function(){return Cj})),n.d(r,"_shadersStripeMaterial",(function(){return Sj})),n.d(r,"_shadersWater",(function(){return Aj})),n.d(r,"_shadersAcesTonemapping",(function(){return dpe})),n.d(r,"_shadersAdditiveBlend",(function(){return fbe})),n.d(r,"_shadersAmbientOcclusionGenerate",(function(){return fpe})),n.d(r,"_shadersAmbientOcclusionModulate",(function(){return ppe})),n.d(r,"_shadersBlackAndWhite",(function(){return mpe})),n.d(r,"_shadersBloomComposite",(function(){return _pe})),n.d(r,"_shadersBrightness",(function(){return gpe})),n.d(r,"_shadersBrightPass",(function(){return pbe})),n.d(r,"_shadersContrastBias",(function(){return vpe})),n.d(r,"_shadersDepthOfField",(function(){return bpe})),n.d(r,"_shadersDepthView",(function(){return ype})),n.d(r,"_shadersDepthViewPacked",(function(){return Sde})),n.d(r,"_shadersEdgeDetection",(function(){return wpe})),n.d(r,"_shadersFilmicTonemapping",(function(){return Ope})),n.d(r,"_shadersFXAA",(function(){return xpe})),n.d(r,"_shadersGaussianBlur1D",(function(){return Epe})),n.d(r,"_shadersLensFlare",(function(){return Tpe})),n.d(r,"_shadersModifiedReinhardTonemapping",(function(){return Cpe})),n.d(r,"_shadersNightVision",(function(){return Spe})),n.d(r,"_shadersPassThrough",(function(){return Ade})),n.d(r,"_shadersPassThroughDepth",(function(){return Pde})),n.d(r,"_shadersPointCloudEyeDomeLighting",(function(){return e6})),n.d(r,"_shadersReinhardTonemapping",(function(){return Ape})),n.d(r,"_shadersSilhouette",(function(){return Ppe})),n.d(r,"addBuffer",(function(){return jZ})),n.d(r,"addDefaults",(function(){return cZ})),n.d(r,"addExtensionsRequired",(function(){return TZ})),n.d(r,"addExtensionsUsed",(function(){return _Z})),n.d(r,"addPipelineExtras",(function(){return uZ})),n.d(r,"addToArray",(function(){return tZ})),n.d(r,"findAccessorMinMax",(function(){return vZ})),n.d(r,"ForEach",(function(){return rZ})),n.d(r,"getAccessorByteStride",(function(){return oZ})),n.d(r,"getComponentReader",(function(){return gZ})),n.d(r,"hasExtension",(function(){return iZ})),n.d(r,"moveTechniqueRenderStates",(function(){return EZ})),n.d(r,"moveTechniquesToExtension",(function(){return CZ})),n.d(r,"numberOfComponentsForType",(function(){return aZ})),n.d(r,"parseGlb",(function(){return mZ})),n.d(r,"readAccessorPacked",(function(){return MZ})),n.d(r,"removeExtensionsRequired",(function(){return hZ})),n.d(r,"removeExtensionsUsed",(function(){return dZ})),n.d(r,"removePipelineExtras",(function(){return BK})),n.d(r,"removeUnusedElements",(function(){return DZ})),n.d(r,"updateAccessorComponentTypes",(function(){return LZ})),n.d(r,"updateVersion",(function(){return XZ})),n.d(r,"FXAA3_11",(function(){return Dpe})),n.d(r,"Animation",(function(){return uEe})),n.d(r,"AnimationViewModel",(function(){return gEe})),n.d(r,"BaseLayerPicker",(function(){return wEe})),n.d(r,"BaseLayerPickerViewModel",(function(){return bEe})),n.d(r,"createDefaultImageryProviderViewModels",(function(){return EEe})),n.d(r,"createDefaultTerrainProviderViewModels",(function(){return TEe})),n.d(r,"ProviderViewModel",(function(){return xEe})),n.d(r,"Cesium3DTilesInspector",(function(){return zEe})),n.d(r,"Cesium3DTilesInspectorViewModel",(function(){return NEe})),n.d(r,"CesiumInspector",(function(){return qEe})),n.d(r,"CesiumInspectorViewModel",(function(){return HEe})),n.d(r,"CesiumWidget",(function(){return QEe})),n.d(r,"FullscreenButton",(function(){return iTe})),n.d(r,"FullscreenButtonViewModel",(function(){return JEe})),n.d(r,"Geocoder",(function(){return pTe})),n.d(r,"GeocoderViewModel",(function(){return uTe})),n.d(r,"HomeButton",(function(){return vTe})),n.d(r,"HomeButtonViewModel",(function(){return _Te})),n.d(r,"InfoBox",(function(){return ETe})),n.d(r,"InfoBoxViewModel",(function(){return OTe})),n.d(r,"NavigationHelpButton",(function(){return ATe})),n.d(r,"NavigationHelpButtonViewModel",(function(){return CTe})),n.d(r,"PerformanceWatchdog",(function(){return jTe})),n.d(r,"PerformanceWatchdogViewModel",(function(){return ITe})),n.d(r,"ProjectionPicker",(function(){return kTe})),n.d(r,"ProjectionPickerViewModel",(function(){return RTe})),n.d(r,"SceneModePicker",(function(){return qTe})),n.d(r,"SceneModePickerViewModel",(function(){return zTe}));n.d(r,"SelectionIndicator",(function(){return KTe})),n.d(r,"SelectionIndicatorViewModel",(function(){return ZTe})),n.d(r,"Timeline",(function(){return lCe})),n.d(r,"TimelineHighlightRange",(function(){return $Te})),n.d(r,"TimelineTrack",(function(){return tCe})),n.d(r,"Viewer",(function(){return ACe})),n.d(r,"viewerCesium3DTilesInspectorMixin",(function(){return PCe})),n.d(r,"viewerCesiumInspectorMixin",(function(){return ICe})),n.d(r,"viewerDragDropMixin",(function(){return NCe})),n.d(r,"viewerPerformanceWatchdogMixin",(function(){return FCe})),n.d(r,"VRButton",(function(){return gCe})),n.d(r,"VRButtonViewModel",(function(){return fCe})),n.d(r,"_shadersdegreesPerRadian",(function(){return xR})),n.d(r,"_shadersdepthRange",(function(){return ER})),n.d(r,"_shadersepsilon1",(function(){return TR})),n.d(r,"_shadersepsilon2",(function(){return CR})),n.d(r,"_shadersepsilon3",(function(){return SR})),n.d(r,"_shadersepsilon4",(function(){return AR})),n.d(r,"_shadersepsilon5",(function(){return PR})),n.d(r,"_shadersepsilon6",(function(){return IR})),n.d(r,"_shadersepsilon7",(function(){return DR})),n.d(r,"_shadersinfinity",(function(){return jR})),n.d(r,"_shadersoneOverPi",(function(){return MR})),n.d(r,"_shadersoneOverTwoPi",(function(){return RR})),n.d(r,"_shaderspassCesium3DTile",(function(){return LR})),n.d(r,"_shaderspassCesium3DTileClassification",(function(){return NR})),n.d(r,"_shaderspassCesium3DTileClassificationIgnoreShow",(function(){return FR})),n.d(r,"_shaderspassClassification",(function(){return kR})),n.d(r,"_shaderspassCompute",(function(){return BR})),n.d(r,"_shaderspassEnvironment",(function(){return zR})),n.d(r,"_shaderspassGlobe",(function(){return UR})),n.d(r,"_shaderspassOpaque",(function(){return VR})),n.d(r,"_shaderspassOverlay",(function(){return HR})),n.d(r,"_shaderspassTerrainClassification",(function(){return GR})),n.d(r,"_shaderspassTranslucent",(function(){return qR})),n.d(r,"_shaderspi",(function(){return WR})),n.d(r,"_shaderspiOverFour",(function(){return YR})),n.d(r,"_shaderspiOverSix",(function(){return XR})),n.d(r,"_shaderspiOverThree",(function(){return ZR})),n.d(r,"_shaderspiOverTwo",(function(){return QR})),n.d(r,"_shadersradiansPerDegree",(function(){return KR})),n.d(r,"_shaderssceneMode2D",(function(){return JR})),n.d(r,"_shaderssceneMode3D",(function(){return $R})),n.d(r,"_shaderssceneModeColumbusView",(function(){return eL})),n.d(r,"_shaderssceneModeMorphing",(function(){return tL})),n.d(r,"_shaderssolarRadius",(function(){return iL})),n.d(r,"_shadersthreePiOver2",(function(){return nL})),n.d(r,"_shaderstwoPi",(function(){return rL})),n.d(r,"_shaderswebMercatorMaxLatitude",(function(){return aL})),n.d(r,"_shadersalphaWeight",(function(){return pL})),n.d(r,"_shadersantialias",(function(){return mL})),n.d(r,"_shadersapproximateSphericalCoordinates",(function(){return _L})),n.d(r,"_shadersbranchFreeTernary",(function(){return gL})),n.d(r,"_shaderscascadeColor",(function(){return vL})),n.d(r,"_shaderscascadeDistance",(function(){return bL})),n.d(r,"_shaderscascadeMatrix",(function(){return yL})),n.d(r,"_shaderscascadeWeights",(function(){return wL})),n.d(r,"_shaderscolumbusViewMorph",(function(){return OL})),n.d(r,"_shaderscomputePosition",(function(){return xL})),n.d(r,"_shaderscosineAndSine",(function(){return EL})),n.d(r,"_shadersdecompressTextureCoordinates",(function(){return TL})),n.d(r,"_shadersdepthClampFarPlane",(function(){return CL})),n.d(r,"_shaderseastNorthUpToEyeCoordinates",(function(){return SL})),n.d(r,"_shadersellipsoidContainsPoint",(function(){return AL})),n.d(r,"_shadersellipsoidNew",(function(){return PL})),n.d(r,"_shadersellipsoidWgs84TextureCoordinates",(function(){return IL})),n.d(r,"_shadersequalsEpsilon",(function(){return DL})),n.d(r,"_shaderseyeOffset",(function(){return jL})),n.d(r,"_shaderseyeToWindowCoordinates",(function(){return ML})),n.d(r,"_shadersfastApproximateAtan",(function(){return RL})),n.d(r,"_shadersfog",(function(){return LL})),n.d(r,"_shadersgammaCorrect",(function(){return NL})),n.d(r,"_shadersgeodeticSurfaceNormal",(function(){return FL})),n.d(r,"_shadersgetDefaultMaterial",(function(){return kL})),n.d(r,"_shadersgetLambertDiffuse",(function(){return BL})),n.d(r,"_shadersgetSpecular",(function(){return zL})),n.d(r,"_shadersgetWaterNoise",(function(){return UL})),n.d(r,"_shadersgetWgs84EllipsoidEC",(function(){return VL})),n.d(r,"_shadersHSBToRGB",(function(){return HL})),n.d(r,"_shadersHSLToRGB",(function(){return GL})),n.d(r,"_shadershue",(function(){return qL})),n.d(r,"_shadersinverseGamma",(function(){return WL})),n.d(r,"_shadersisEmpty",(function(){return YL})),n.d(r,"_shadersisFull",(function(){return XL})),n.d(r,"_shaderslatitudeToWebMercatorFraction",(function(){return ZL})),n.d(r,"_shaderslineDistance",(function(){return QL})),n.d(r,"_shadersluminance",(function(){return KL})),n.d(r,"_shadersmetersPerPixel",(function(){return JL})),n.d(r,"_shadersmodelToWindowCoordinates",(function(){return $L})),n.d(r,"_shadersmultiplyWithColorBalance",(function(){return eN})),n.d(r,"_shadersnearFarScalar",(function(){return tN})),n.d(r,"_shadersoctDecode",(function(){return iN})),n.d(r,"_shaderspackDepth",(function(){return nN})),n.d(r,"_shadersphong",(function(){return rN})),n.d(r,"_shadersplaneDistance",(function(){return aN})),n.d(r,"_shaderspointAlongRay",(function(){return oN})),n.d(r,"_shadersrayEllipsoidIntersectionInterval",(function(){return sN})),n.d(r,"_shadersreadDepth",(function(){return cN})),n.d(r,"_shadersreverseLogDepth",(function(){return lN})),n.d(r,"_shadersRGBToHSB",(function(){return uN})),n.d(r,"_shadersRGBToHSL",(function(){return hN})),n.d(r,"_shadersRGBToXYZ",(function(){return dN})),n.d(r,"_shaderssampleOctahedralProjection",(function(){return fN})),n.d(r,"_shaderssaturation",(function(){return pN})),n.d(r,"_shadersshadowDepthCompare",(function(){return mN})),n.d(r,"_shadersshadowVisibility",(function(){return _N})),n.d(r,"_shaderssignNotZero",(function(){return gN})),n.d(r,"_shaderssphericalHarmonics",(function(){return vN})),n.d(r,"_shaderstangentToEyeSpaceMatrix",(function(){return bN})),n.d(r,"_shaderstransformPlane",(function(){return yN})),n.d(r,"_shaderstranslateRelativeToEye",(function(){return wN})),n.d(r,"_shaderstranslucentPhong",(function(){return ON})),n.d(r,"_shaderstranspose",(function(){return xN})),n.d(r,"_shadersunpackDepth",(function(){return EN})),n.d(r,"_shadersunpackFloat",(function(){return TN})),n.d(r,"_shadersvertexLogDepth",(function(){return CN})),n.d(r,"_shaderswindowToEyeCoordinates",(function(){return SN})),n.d(r,"_shaderswriteDepthClampedToFarPlane",(function(){return AN})),n.d(r,"_shaderswriteLogDepth",(function(){return PN})),n.d(r,"_shadersXYZToRGB",(function(){return IN})),n.d(r,"_shaderscombineMaterial",(function(){return oL})),n.d(r,"_shadersdepthRangeStruct",(function(){return sL})),n.d(r,"_shadersellipsoid",(function(){return cL})),n.d(r,"_shadersmaterial",(function(){return lL})),n.d(r,"_shadersmaterialInput",(function(){return uL})),n.d(r,"_shadersray",(function(){return hL})),n.d(r,"_shadersraySegment",(function(){return dL})),n.d(r,"_shadersshadowParameters",(function(){return fL})),n.d(r,"createTaskProcessorWorker",(function(){return kCe}));var a={};n.r(a),n.d(a,"VERSION",(function(){return BAe})),n.d(a,"_shadersBackground",(function(){return Fpe})),n.d(a,"_shadersClearMRTColorTextureFS",(function(){return Ide})),n.d(a,"_shadersColorCorrection",(function(){return Ipe})),n.d(a,"_shadersCompositeWaterFS",(function(){return zCe})),n.d(a,"_shadersDiffusionRingMaterial",(function(){return Ij})),n.d(a,"_shadersDirectionMaterial",(function(){return Mj})),n.d(a,"_shadersModelPlanishFS",(function(){return Uye})),n.d(a,"_shadersModelPlanishInfoFS",(function(){return zye})),n.d(a,"_shadersModelPlanishVS",(function(){return KZ})),n.d(a,"_shadersMotionVectorFS",(function(){return UCe})),n.d(a,"_shadersMotionVectorVS",(function(){return VCe})),n.d(a,"_shadersPolylineDashDynamicMaterial",(function(){return Oj})),n.d(a,"_shadersRadarMaterial",(function(){return jj})),n.d(a,"_shadersRainFS",(function(){return Lpe})),n.d(a,"_shadersRoadNetWorkMaterial",(function(){return Dj})),n.d(a,"_shadersShadowPlaneCompositeFS",(function(){return HCe})),n.d(a,"_shadersShadowPlaneFS",(function(){return GCe})),n.d(a,"_shadersShadowPlaneVS",(function(){return qCe})),n.d(a,"_shadersSharpenFS",(function(){return Npe})),n.d(a,"_shadersSnowFS",(function(){return Rpe})),n.d(a,"_shadersSurfaceWaterFS",(function(){return Nye})),n.d(a,"_shadersSurfaceWaterVS",(function(){return Lye})),n.d(a,"_shadersTaaFS",(function(){return WCe})),n.d(a,"_shadersTaaVS",(function(){return YCe})),n.d(a,"_shadersTemporalSuperSamplingFS",(function(){return Aye})),n.d(a,"_shadersTrail",(function(){return Pj})),n.d(a,"_shadersTransformInstancePosition",(function(){return d$})),n.d(a,"_shadersViewshedLineFS",(function(){return Fbe})),n.d(a,"_shadersViewshedLineVS",(function(){return kbe})),n.d(a,"_shadersVignetteFS",(function(){return jye})),n.d(a,"_shadersVignetteVS",(function(){return Dye})),n.d(a,"_shadersVolumeRendering1FS",(function(){return XCe})),n.d(a,"_shadersVolumeRendering1VS",(function(){return ZCe})),n.d(a,"_shadersVolumeRendering2FS",(function(){return QCe})),n.d(a,"_shadersVolumeRendering2VS",(function(){return KCe})),n.d(a,"_shadersWater2FS",(function(){return JCe})),n.d(a,"_shadersWater2VS",(function(){return $Ce})),n.d(a,"_shadersWaterFS",(function(){return eSe})),n.d(a,"_shadersWaterVS",(function(){return tSe})),n.d(a,"Cesium3DTilesetForJson",(function(){return D6})),n.d(a,"Cesium3DTilesetForSingleGltf",(function(){return OSe})),n.d(a,"DebugMRT",(function(){return Zye})),n.d(a,"DynamicCircle",(function(){return ESe})),n.d(a,"DynamicCircleCollection",(function(){return bse})),n.d(a,"EdgeLoader",(function(){return h$})),n.d(a,"EnvironmentVariables",(function(){return fx})),n.d(a,"Gltf3DTileContent",(function(){return g4})),n.d(a,"GradualRender",(function(){return Sye})),n.d(a,"NormalRender",(function(){return CSe})),n.d(a,"ShadowPlane",(function(){return PSe})),n.d(a,"VignetteCommand",(function(){return Rye})),n.d(a,"VolumeRender",(function(){return jSe})),n.d(a,"_shadersBlinnPhongFunctions",(function(){return MSe})),n.d(a,"_shadersPBRFunctions",(function(){return RSe})),n.d(a,"_shadersPBRHelperFunctions",(function(){return LSe})),n.d(a,"CombineMaterialTexture",(function(){return sJ})),n.d(a,"TexturesPool",(function(){return rj})),n.d(a,"Instanced3DModelContent",(function(){return kSe})),n.d(a,"Instanced3DModelTileset",(function(){return zSe})),n.d(a,"ModelInstancelod",(function(){return VSe})),n.d(a,"ModelInstancelodCollection",(function(){return GSe})),n.d(a,"ModelPlanishBorderInfos",(function(){return Bye})),n.d(a,"ModelPlanishCollection",(function(){return Wye})),n.d(a,"TaaRenderPass",(function(){return Iye})),n.d(a,"UniformBuffer",(function(){return cJ})),n.d(a,"ViewShed",(function(){return Tye})),n.d(a,"ViewShed2",(function(){return DAe})),n.d(a,"ViewShedShader",(function(){return Nbe})),n.d(a,"BLWater",(function(){return MAe})),n.d(a,"BLWater2",(function(){return NAe})),n.d(a,"BLWaterCollection",(function(){return Rbe})),n.d(a,"SurfaceWater",(function(){return kye})),n.d(a,"_shaderscombineMaterialStruct",(function(){return FAe})),n.d(a,"_shaderslightStruct",(function(){return kAe}));var o,s,c,l=n(79),u=n(0),h=n(2),d=n(51),f=n(9),p=/((?:.*\/)|^)cesium[\w-]*\.js(?:\W|$)/i;function m(e){return"undefined"==typeof document?e:(Object(u.a)(o)||(o=document.createElement("a")),o.href=e,o.href=o.href,o.href)}function _(){if(Object(u.a)(s))return s;var e;if(e="undefined"!=typeof CESIUM_BASE_URL?CESIUM_BASE_URL:"object"==typeof define&&Object(u.a)(n(109))&&!n(109).toUrlUndefined&&Object(u.a)(n(127).toUrl)?Object(d.a)("..",b("Core/buildModuleUrl.js")):function(){for(var e=document.getElementsByTagName("script"),t=0,i=e.length;t<i;++t){var n=e[t].getAttribute("src"),r=p.exec(n);if(null!==r)return r[1]}}(),!Object(u.a)(e))throw new h.a("Unable to determine Cesium base URL automatically, try defining a global variable called CESIUM_BASE_URL.");return(s=new f.a({url:m(e)})).appendForwardSlash(),s}function g(e){return m(n(127).toUrl("../"+e))}function v(e){return _().getDerivedResource({url:e}).url}function b(e){return Object(u.a)(c)||(c="object"==typeof define&&Object(u.a)(n(109))&&!n(109).toUrlUndefined&&Object(u.a)(n(127).toUrl)?g:v),c(e)}b._cesiumScriptRegex=p,b._buildModuleUrlFromBaseUrl=v,b._clearBaseResource=function(){s=void 0},b.setBaseUrl=function(e){s=f.a.DEFAULT.getDerivedResource({url:e})},b.getCesiumBaseUrl=_;var y=b,w=n(1),O=n(4),x=n(3),E=n(5),T=function(e){null==e&&(e=(new Date).getTime()),this.N=624,this.M=397,this.MATRIX_A=2567483615,this.UPPER_MASK=2147483648,this.LOWER_MASK=2147483647,this.mt=new Array(this.N),this.mti=this.N+1,this.init_genrand(e)};T.prototype.init_genrand=function(e){for(this.mt[0]=e>>>0,this.mti=1;this.mti<this.N;this.mti++){e=this.mt[this.mti-1]^this.mt[this.mti-1]>>>30;this.mt[this.mti]=(1812433253*((4294901760&e)>>>16)<<16)+1812433253*(65535&e)+this.mti,this.mt[this.mti]>>>=0}},T.prototype.genrand_int32=function(){var e,t=new Array(0,this.MATRIX_A);if(this.mti>=this.N){var i;for(this.mti==this.N+1&&this.init_genrand(5489),i=0;i<this.N-this.M;i++)e=this.mt[i]&this.UPPER_MASK|this.mt[i+1]&this.LOWER_MASK,this.mt[i]=this.mt[i+this.M]^e>>>1^t[1&e];for(;i<this.N-1;i++)e=this.mt[i]&this.UPPER_MASK|this.mt[i+1]&this.LOWER_MASK,this.mt[i]=this.mt[i+(this.M-this.N)]^e>>>1^t[1&e];e=this.mt[this.N-1]&this.UPPER_MASK|this.mt[0]&this.LOWER_MASK,this.mt[this.N-1]=this.mt[this.M-1]^e>>>1^t[1&e],this.mti=0}return e=this.mt[this.mti++],e^=e>>>11,e^=e<<7&2636928640,e^=e<<15&4022730752,(e^=e>>>18)>>>0},T.prototype.random=function(){return this.genrand_int32()*(1/4294967296)};var C=T,S={EPSILON1:.1,EPSILON2:.01,EPSILON3:.001,EPSILON4:1e-4,EPSILON5:1e-5,EPSILON6:1e-6,EPSILON7:1e-7,EPSILON8:1e-8,EPSILON9:1e-9,EPSILON10:1e-10,EPSILON11:1e-11,EPSILON12:1e-12,EPSILON13:1e-13,EPSILON14:1e-14,EPSILON15:1e-15,EPSILON16:1e-16,EPSILON17:1e-17,EPSILON18:1e-18,EPSILON19:1e-19,EPSILON20:1e-20,EPSILON21:1e-21,GRAVITATIONALPARAMETER:3986004418e5,SOLAR_RADIUS:6955e5,LUNAR_RADIUS:1737400,SIXTY_FOUR_KILOBYTES:65536};S.sign=Object(w.a)(Math.sign,(function(e){return 0===(e=+e)||e!=e?e:e>0?1:-1})),S.signNotZero=function(e){return e<0?-1:1},S.toSNorm=function(e,t){return t=Object(w.a)(t,255),Math.round((.5*S.clamp(e,-1,1)+.5)*t)},S.fromSNorm=function(e,t){return t=Object(w.a)(t,255),S.clamp(e,0,t)/t*2-1},S.sinh=Object(w.a)(Math.sinh,(function(e){return(Math.exp(e)-Math.exp(-e))/2})),S.cosh=Object(w.a)(Math.cosh,(function(e){return(Math.exp(e)+Math.exp(-e))/2})),S.lerp=function(e,t,i){return(1-i)*e+i*t},S.PI=Math.PI,S.ONE_OVER_PI=1/Math.PI,S.PI_OVER_TWO=Math.PI/2,S.PI_OVER_THREE=Math.PI/3,S.PI_OVER_FOUR=Math.PI/4,S.PI_OVER_SIX=Math.PI/6,S.THREE_PI_OVER_TWO=3*Math.PI/2,S.TWO_PI=2*Math.PI,S.ONE_OVER_TWO_PI=1/(2*Math.PI),S.RADIANS_PER_DEGREE=Math.PI/180,S.DEGREES_PER_RADIAN=180/Math.PI,S.RADIANS_PER_ARCSECOND=S.RADIANS_PER_DEGREE/3600,S.toRadians=function(e){if(!Object(u.a)(e))throw new h.a("degrees is required.");return e*S.RADIANS_PER_DEGREE},S.toDegrees=function(e){if(!Object(u.a)(e))throw new h.a("radians is required.");return e*S.DEGREES_PER_RADIAN},S.convertLongitudeRange=function(e){if(!Object(u.a)(e))throw new h.a("angle is required.");var t=S.TWO_PI,i=e-Math.floor(e/t)*t;return i<-Math.PI?i+t:i>=Math.PI?i-t:i},S.clampToLatitudeRange=function(e){if(!Object(u.a)(e))throw new h.a("angle is required.");return S.clamp(e,-1*S.PI_OVER_TWO,S.PI_OVER_TWO)},S.negativePiToPi=function(e){if(!Object(u.a)(e))throw new h.a("angle is required.");return S.zeroToTwoPi(e+S.PI)-S.PI},S.zeroToTwoPi=function(e){if(!Object(u.a)(e))throw new h.a("angle is required.");var t=S.mod(e,S.TWO_PI);return Math.abs(t)<S.EPSILON14&&Math.abs(e)>S.EPSILON14?S.TWO_PI:t},S.mod=function(e,t){if(!Object(u.a)(e))throw new h.a("m is required.");if(!Object(u.a)(t))throw new h.a("n is required.");return(e%t+t)%t},S.equalsEpsilon=function(e,t,i,n){if(!Object(u.a)(e))throw new h.a("left is required.");if(!Object(u.a)(t))throw new h.a("right is required.");if(!Object(u.a)(i))throw new h.a("relativeEpsilon is required.");n=Object(w.a)(n,i);var r=Math.abs(e-t);return r<=n||r<=i*Math.max(Math.abs(e),Math.abs(t))};var A=[1];S.factorial=function(e){if("number"!=typeof e||e<0)throw new h.a("A number greater than or equal to 0 is required.");var t=A.length;if(e>=t)for(var i=A[t-1],n=t;n<=e;n++)A.push(i*n);return A[e]},S.incrementWrap=function(e,t,i){if(i=Object(w.a)(i,0),!Object(u.a)(e))throw new h.a("n is required.");if(t<=i)throw new h.a("maximumValue must be greater than minimumValue.");return++e>t&&(e=i),e},S.isPowerOfTwo=function(e){if("number"!=typeof e||e<0)throw new h.a("A number greater than or equal to 0 is required.");return 0!==e&&0==(e&e-1)},S.nextPowerOfTwo=function(e){if("number"!=typeof e||e<0)throw new h.a("A number greater than or equal to 0 is required.");return--e,e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,e|=e>>16,++e},S.clamp=function(e,t,i){if(!Object(u.a)(e))throw new h.a("value is required");if(!Object(u.a)(t))throw new h.a("min is required.");if(!Object(u.a)(i))throw new h.a("max is required.");return e<t?t:e>i?i:e};var P=new C;S.setRandomNumberSeed=function(e){if(!Object(u.a)(e))throw new h.a("seed is required.");P=new C(e)},S.nextRandomNumber=function(){return P.random()},S.randomBetween=function(e,t){return S.nextRandomNumber()*(t-e)+e},S.acosClamped=function(e){if(!Object(u.a)(e))throw new h.a("value is required.");return Math.acos(S.clamp(e,-1,1))},S.asinClamped=function(e){if(!Object(u.a)(e))throw new h.a("value is required.");return Math.asin(S.clamp(e,-1,1))},S.chordLength=function(e,t){if(!Object(u.a)(e))throw new h.a("angle is required.");if(!Object(u.a)(t))throw new h.a("radius is required.");return 2*t*Math.sin(.5*e)},S.logBase=function(e,t){if(!Object(u.a)(e))throw new h.a("number is required.");if(!Object(u.a)(t))throw new h.a("base is required.");return Math.log(e)/Math.log(t)},S.cbrt=Object(w.a)(Math.cbrt,(function(e){var t=Math.pow(Math.abs(e),1/3);return e<0?-t:t})),S.log2=Object(w.a)(Math.log2,(function(e){return Math.log(e)*Math.LOG2E})),S.fog=function(e,t){var i=e*t;return 1-Math.exp(-i*i)},S.fastApproximateAtan=function(e){return x.a.typeOf.number("x",e),e*(-.1784*Math.abs(e)-.0663*e*e+1.0301)},S.fastApproximateAtan2=function(e,t){var i,n;x.a.typeOf.number("x",e),x.a.typeOf.number("y",t);var r=Math.abs(e);i=Math.abs(t),n=Math.max(r,i);var a=(i=Math.min(r,i))/n;if(isNaN(a))throw new h.a("either x or y must be nonzero");return r=S.fastApproximateAtan(a),r=Math.abs(t)>Math.abs(e)?S.PI_OVER_TWO-r:r,r=e<0?S.PI-r:r,r=t<0?-r:r};var I=S;function D(e,t,i){this.x=Object(w.a)(e,0),this.y=Object(w.a)(t,0),this.z=Object(w.a)(i,0)}D.fromSpherical=function(e,t){x.a.typeOf.object("spherical",e),Object(u.a)(t)||(t=new D);var i=e.clock,n=e.cone,r=Object(w.a)(e.magnitude,1),a=r*Math.sin(n);return t.x=a*Math.cos(i),t.y=a*Math.sin(i),t.z=r*Math.cos(n),t},D.fromElements=function(e,t,i,n){return Object(u.a)(n)?(n.x=e,n.y=t,n.z=i,n):new D(e,t,i)},D.clone=function(e,t){if(Object(u.a)(e))return Object(u.a)(t)?(t.x=e.x,t.y=e.y,t.z=e.z,t):new D(e.x,e.y,e.z)},D.fromCartesian4=D.clone,D.packedLength=3,D.pack=function(e,t,i){return x.a.typeOf.object("value",e),x.a.defined("array",t),i=Object(w.a)(i,0),t[i++]=e.x,t[i++]=e.y,t[i]=e.z,t},D.unpack=function(e,t,i){return x.a.defined("array",e),t=Object(w.a)(t,0),Object(u.a)(i)||(i=new D),i.x=e[t++],i.y=e[t++],i.z=e[t],i},D.packArray=function(e,t){x.a.defined("array",e);var i=e.length;Object(u.a)(t)?t.length=3*i:t=new Array(3*i);for(var n=0;n<i;++n)D.pack(e[n],t,3*n);return t},D.unpackArray=function(e,t){if(x.a.defined("array",e),x.a.typeOf.number.greaterThanOrEquals("array.length",e.length,3),e.length%3!=0)throw new h.a("array length must be a multiple of 3.");var i=e.length;Object(u.a)(t)?t.length=i/3:t=new Array(i/3);for(var n=0;n<i;n+=3){var r=n/3;t[r]=D.unpack(e,n,t[r])}return t},D.fromArray=D.unpack,D.maximumComponent=function(e){return x.a.typeOf.object("cartesian",e),Math.max(e.x,e.y,e.z)},D.minimumComponent=function(e){return x.a.typeOf.object("cartesian",e),Math.min(e.x,e.y,e.z)},D.minimumByComponent=function(e,t,i){return x.a.typeOf.object("first",e),x.a.typeOf.object("second",t),x.a.typeOf.object("result",i),i.x=Math.min(e.x,t.x),i.y=Math.min(e.y,t.y),i.z=Math.min(e.z,t.z),i},D.maximumByComponent=function(e,t,i){return x.a.typeOf.object("first",e),x.a.typeOf.object("second",t),x.a.typeOf.object("result",i),i.x=Math.max(e.x,t.x),i.y=Math.max(e.y,t.y),i.z=Math.max(e.z,t.z),i},D.magnitudeSquared=function(e){return x.a.typeOf.object("cartesian",e),e.x*e.x+e.y*e.y+e.z*e.z},D.magnitude=function(e){return Math.sqrt(D.magnitudeSquared(e))};var j=new D;D.distance=function(e,t){return x.a.typeOf.object("left",e),x.a.typeOf.object("right",t),D.subtract(e,t,j),D.magnitude(j)},D.distanceSquared=function(e,t){return x.a.typeOf.object("left",e),x.a.typeOf.object("right",t),D.subtract(e,t,j),D.magnitudeSquared(j)},D.normalize=function(e,t){x.a.typeOf.object("cartesian",e),x.a.typeOf.object("result",t);var i=D.magnitude(e);if(t.x=e.x/i,t.y=e.y/i,t.z=e.z/i,isNaN(t.x)||isNaN(t.y)||isNaN(t.z))throw new h.a("normalized result is not a number");return t},D.dot=function(e,t){return x.a.typeOf.object("left",e),x.a.typeOf.object("right",t),e.x*t.x+e.y*t.y+e.z*t.z},D.multiplyComponents=function(e,t,i){return x.a.typeOf.object("left",e),x.a.typeOf.object("right",t),x.a.typeOf.object("result",i),i.x=e.x*t.x,i.y=e.y*t.y,i.z=e.z*t.z,i},D.divideComponents=function(e,t,i){return x.a.typeOf.object("left",e),x.a.typeOf.object("right",t),x.a.typeOf.object("result",i),i.x=e.x/t.x,i.y=e.y/t.y,i.z=e.z/t.z,i},D.add=function(e,t,i){return x.a.typeOf.object("left",e),x.a.typeOf.object("right",t),x.a.typeOf.object("result",i),i.x=e.x+t.x,i.y=e.y+t.y,i.z=e.z+t.z,i},D.subtract=function(e,t,i){return x.a.typeOf.object("left",e),x.a.typeOf.object("right",t),x.a.typeOf.object("result",i),i.x=e.x-t.x,i.y=e.y-t.y,i.z=e.z-t.z,i},D.multiplyByScalar=function(e,t,i){return x.a.typeOf.object("cartesian",e),x.a.typeOf.number("scalar",t),x.a.typeOf.object("result",i),i.x=e.x*t,i.y=e.y*t,i.z=e.z*t,i},D.divideByScalar=function(e,t,i){return x.a.typeOf.object("cartesian",e),x.a.typeOf.number("scalar",t),x.a.typeOf.object("result",i),i.x=e.x/t,i.y=e.y/t,i.z=e.z/t,i},D.negate=function(e,t){return x.a.typeOf.object("cartesian",e),x.a.typeOf.object("result",t),t.x=-e.x,t.y=-e.y,t.z=-e.z,t},D.abs=function(e,t){return x.a.typeOf.object("cartesian",e),x.a.typeOf.object("result",t),t.x=Math.abs(e.x),t.y=Math.abs(e.y),t.z=Math.abs(e.z),t};var M=new D;D.lerp=function(e,t,i,n){return x.a.typeOf.object("start",e),x.a.typeOf.object("end",t),x.a.typeOf.number("t",i),x.a.typeOf.object("result",n),D.multiplyByScalar(t,i,M),n=D.multiplyByScalar(e,1-i,n),D.add(M,n,n)};var R=new D,L=new D;D.angleBetween=function(e,t){x.a.typeOf.object("left",e),x.a.typeOf.object("right",t),D.normalize(e,R),D.normalize(t,L);var i=D.dot(R,L),n=D.magnitude(D.cross(R,L,R));return Math.atan2(n,i)};var N=new D;D.mostOrthogonalAxis=function(e,t){x.a.typeOf.object("cartesian",e),x.a.typeOf.object("result",t);var i=D.normalize(e,N);return D.abs(i,i),t=i.x<=i.y?i.x<=i.z?D.clone(D.UNIT_X,t):D.clone(D.UNIT_Z,t):i.y<=i.z?D.clone(D.UNIT_Y,t):D.clone(D.UNIT_Z,t)},D.projectVector=function(e,t,i){x.a.defined("a",e),x.a.defined("b",t),x.a.defined("result",i);var n=D.dot(e,t)/D.dot(t,t);return D.multiplyByScalar(t,n,i)},D.equals=function(e,t){return e===t||Object(u.a)(e)&&Object(u.a)(t)&&e.x===t.x&&e.y===t.y&&e.z===t.z},D.equalsArray=function(e,t,i){return e.x===t[i]&&e.y===t[i+1]&&e.z===t[i+2]},D.equalsEpsilon=function(e,t,i,n){return e===t||Object(u.a)(e)&&Object(u.a)(t)&&I.equalsEpsilon(e.x,t.x,i,n)&&I.equalsEpsilon(e.y,t.y,i,n)&&I.equalsEpsilon(e.z,t.z,i,n)},D.cross=function(e,t,i){x.a.typeOf.object("left",e),x.a.typeOf.object("right",t),x.a.typeOf.object("result",i);var n=e.x,r=e.y,a=e.z,o=t.x,s=t.y,c=t.z,l=r*c-a*s,u=a*o-n*c,h=n*s-r*o;return i.x=l,i.y=u,i.z=h,i},D.midpoint=function(e,t,i){return x.a.typeOf.object("left",e),x.a.typeOf.object("right",t),x.a.typeOf.object("result",i),i.x=.5*(e.x+t.x),i.y=.5*(e.y+t.y),i.z=.5*(e.z+t.z),i},D.fromDegrees=function(e,t,i,n,r){return x.a.typeOf.number("longitude",e),x.a.typeOf.number("latitude",t),e=I.toRadians(e),t=I.toRadians(t),D.fromRadians(e,t,i,n,r)};var F=new D,k=new D,B=new D(40680631590769,40680631590769,40408299984661.445);D.fromRadians=function(e,t,i,n,r){x.a.typeOf.number("longitude",e),x.a.typeOf.number("latitude",t),i=Object(w.a)(i,0);var a=Object(u.a)(n)?n.radiiSquared:B,o=Math.cos(t);F.x=o*Math.cos(e),F.y=o*Math.sin(e),F.z=Math.sin(t),F=D.normalize(F,F),D.multiplyComponents(a,F,k);var s=Math.sqrt(D.dot(F,k));return k=D.divideByScalar(k,s,k),F=D.multiplyByScalar(F,i,F),Object(u.a)(r)||(r=new D),D.add(k,F,r)},D.fromDegreesArray=function(e,t,i){if(x.a.defined("coordinates",e),e.length<2||e.length%2!=0)throw new h.a("the number of coordinates must be a multiple of 2 and at least 2");var n=e.length;Object(u.a)(i)?i.length=n/2:i=new Array(n/2);for(var r=0;r<n;r+=2){var a=e[r],o=e[r+1],s=r/2;i[s]=D.fromDegrees(a,o,0,t,i[s])}return i},D.fromRadiansArray=function(e,t,i){if(x.a.defined("coordinates",e),e.length<2||e.length%2!=0)throw new h.a("the number of coordinates must be a multiple of 2 and at least 2");var n=e.length;Object(u.a)(i)?i.length=n/2:i=new Array(n/2);for(var r=0;r<n;r+=2){var a=e[r],o=e[r+1],s=r/2;i[s]=D.fromRadians(a,o,0,t,i[s])}return i},D.fromDegreesArrayHeights=function(e,t,i){if(x.a.defined("coordinates",e),e.length<3||e.length%3!=0)throw new h.a("the number of coordinates must be a multiple of 3 and at least 3");var n=e.length;Object(u.a)(i)?i.length=n/3:i=new Array(n/3);for(var r=0;r<n;r+=3){var a=e[r],o=e[r+1],s=e[r+2],c=r/3;i[c]=D.fromDegrees(a,o,s,t,i[c])}return i},D.fromRadiansArrayHeights=function(e,t,i){if(x.a.defined("coordinates",e),e.length<3||e.length%3!=0)throw new h.a("the number of coordinates must be a multiple of 3 and at least 3");var n=e.length;Object(u.a)(i)?i.length=n/3:i=new Array(n/3);for(var r=0;r<n;r+=3){var a=e[r],o=e[r+1],s=e[r+2],c=r/3;i[c]=D.fromRadians(a,o,s,t,i[c])}return i},D.ZERO=Object(E.a)(new D(0,0,0)),D.UNIT_X=Object(E.a)(new D(1,0,0)),D.UNIT_Y=Object(E.a)(new D(0,1,0)),D.UNIT_Z=Object(E.a)(new D(0,0,1)),D.prototype.clone=function(e){return D.clone(this,e)},D.prototype.equals=function(e){return D.equals(this,e)},D.prototype.equalsEpsilon=function(e,t,i){return D.equalsEpsilon(this,e,t,i)},D.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.z+")"};var z=D,U=new z,V=new z;var H=function(e,t,i,n,r){if(!Object(u.a)(e))throw new h.a("cartesian is required.");if(!Object(u.a)(t))throw new h.a("oneOverRadii is required.");if(!Object(u.a)(i))throw new h.a("oneOverRadiiSquared is required.");if(!Object(u.a)(n))throw new h.a("centerToleranceSquared is required.");var a=e.x,o=e.y,s=e.z,c=t.x,l=t.y,d=t.z,f=a*a*c*c,p=o*o*l*l,m=s*s*d*d,_=f+p+m,g=Math.sqrt(1/_),v=z.multiplyByScalar(e,g,U);if(_<n)return isFinite(g)?z.clone(v,r):void 0;var b=i.x,y=i.y,w=i.z,O=V;O.x=v.x*b*2,O.y=v.y*y*2,O.z=v.z*w*2;var x,E,T,C,S,A,P,D=(1-g)*z.magnitude(e)/(.5*z.magnitude(O)),j=0;do{j=(x=f*(S=(E=1/(1+(D-=j)*b))*E)+p*(A=(T=1/(1+D*y))*T)+m*(P=(C=1/(1+D*w))*C)-1)/(-2*(f*(S*E)*b+p*(A*T)*y+m*(P*C)*w))}while(Math.abs(x)>I.EPSILON12);return Object(u.a)(r)?(r.x=a*E,r.y=o*T,r.z=s*C,r):new z(a*E,o*T,s*C)};function G(e,t,i){this.longitude=Object(w.a)(e,0),this.latitude=Object(w.a)(t,0),this.height=Object(w.a)(i,0)}G.fromRadians=function(e,t,i,n){return x.a.typeOf.number("longitude",e),x.a.typeOf.number("latitude",t),i=Object(w.a)(i,0),Object(u.a)(n)?(n.longitude=e,n.latitude=t,n.height=i,n):new G(e,t,i)},G.fromDegrees=function(e,t,i,n){return x.a.typeOf.number("longitude",e),x.a.typeOf.number("latitude",t),e=I.toRadians(e),t=I.toRadians(t),G.fromRadians(e,t,i,n)};var q=new z,W=new z,Y=new z,X=new z(1/6378137,1/6378137,1/6356752.314245179),Z=new z(1/40680631590769,1/40680631590769,1/40408299984661.445),Q=I.EPSILON1;G.fromCartesian=function(e,t,i){var n=Object(u.a)(t)?t.oneOverRadii:X,r=Object(u.a)(t)?t.oneOverRadiiSquared:Z,a=Object(u.a)(t)?t._centerToleranceSquared:Q,o=H(e,n,r,a,W);if(Object(u.a)(o)){var s=z.multiplyComponents(o,r,q);s=z.normalize(s,s);var c=z.subtract(e,o,Y),l=Math.atan2(s.y,s.x),h=Math.asin(s.z),d=I.sign(z.dot(c,e))*z.magnitude(c);return Object(u.a)(i)?(i.longitude=l,i.latitude=h,i.height=d,i):new G(l,h,d)}},G.toCartesian=function(e,t,i){return x.a.defined("cartographic",e),z.fromRadians(e.longitude,e.latitude,e.height,t,i)},G.clone=function(e,t){if(Object(u.a)(e))return Object(u.a)(t)?(t.longitude=e.longitude,t.latitude=e.latitude,t.height=e.height,t):new G(e.longitude,e.latitude,e.height)},G.equals=function(e,t){return e===t||Object(u.a)(e)&&Object(u.a)(t)&&e.longitude===t.longitude&&e.latitude===t.latitude&&e.height===t.height},G.equalsEpsilon=function(e,t,i){return x.a.typeOf.number("epsilon",i),e===t||Object(u.a)(e)&&Object(u.a)(t)&&Math.abs(e.longitude-t.longitude)<=i&&Math.abs(e.latitude-t.latitude)<=i&&Math.abs(e.height-t.height)<=i},G.ZERO=Object(E.a)(new G(0,0,0)),G.prototype.clone=function(e){return G.clone(this,e)},G.prototype.equals=function(e){return G.equals(this,e)},G.prototype.equalsEpsilon=function(e,t){return G.equalsEpsilon(this,e,t)},G.prototype.toString=function(){return"("+this.longitude+", "+this.latitude+", "+this.height+")"};var K=G;function J(e,t,i,n){t=Object(w.a)(t,0),i=Object(w.a)(i,0),n=Object(w.a)(n,0),x.a.typeOf.number.greaterThanOrEquals("x",t,0),x.a.typeOf.number.greaterThanOrEquals("y",i,0),x.a.typeOf.number.greaterThanOrEquals("z",n,0),e._radii=new z(t,i,n),e._radiiSquared=new z(t*t,i*i,n*n),e._radiiToTheFourth=new z(t*t*t*t,i*i*i*i,n*n*n*n),e._oneOverRadii=new z(0===t?0:1/t,0===i?0:1/i,0===n?0:1/n),e._oneOverRadiiSquared=new z(0===t?0:1/(t*t),0===i?0:1/(i*i),0===n?0:1/(n*n)),e._minimumRadius=Math.min(t,i,n),e._maximumRadius=Math.max(t,i,n),e._centerToleranceSquared=I.EPSILON1,0!==e._radiiSquared.z&&(e._squaredXOverSquaredZ=e._radiiSquared.x/e._radiiSquared.z)}function $(e,t,i){this._radii=void 0,this._radiiSquared=void 0,this._radiiToTheFourth=void 0,this._oneOverRadii=void 0,this._oneOverRadiiSquared=void 0,this._minimumRadius=void 0,this._maximumRadius=void 0,this._centerToleranceSquared=void 0,this._squaredXOverSquaredZ=void 0,J(this,e,t,i)}Object(O.a)($.prototype,{radii:{get:function(){return this._radii}},radiiSquared:{get:function(){return this._radiiSquared}},radiiToTheFourth:{get:function(){return this._radiiToTheFourth}},oneOverRadii:{get:function(){return this._oneOverRadii}},oneOverRadiiSquared:{get:function(){return this._oneOverRadiiSquared}},minimumRadius:{get:function(){return this._minimumRadius}},maximumRadius:{get:function(){return this._maximumRadius}}}),$.clone=function(e,t){if(Object(u.a)(e)){var i=e._radii;return Object(u.a)(t)?(z.clone(i,t._radii),z.clone(e._radiiSquared,t._radiiSquared),z.clone(e._radiiToTheFourth,t._radiiToTheFourth),z.clone(e._oneOverRadii,t._oneOverRadii),z.clone(e._oneOverRadiiSquared,t._oneOverRadiiSquared),t._minimumRadius=e._minimumRadius,t._maximumRadius=e._maximumRadius,t._centerToleranceSquared=e._centerToleranceSquared,t):new $(i.x,i.y,i.z)}},$.fromCartesian3=function(e,t){return Object(u.a)(t)||(t=new $),Object(u.a)(e)?(J(t,e.x,e.y,e.z),t):t},$.WGS84=Object(E.a)(new $(6378137,6378137,6356752.314245179)),$.CGCS2000=Object(E.a)(new $(6378137,6378137,6356752.31414)),$.UNIT_SPHERE=Object(E.a)(new $(1,1,1)),$.MOON=Object(E.a)(new $(I.LUNAR_RADIUS,I.LUNAR_RADIUS,I.LUNAR_RADIUS)),$.prototype.clone=function(e){return $.clone(this,e)},$.packedLength=z.packedLength,$.pack=function(e,t,i){return x.a.typeOf.object("value",e),x.a.defined("array",t),i=Object(w.a)(i,0),z.pack(e._radii,t,i),t},$.unpack=function(e,t,i){x.a.defined("array",e),t=Object(w.a)(t,0);var n=z.unpack(e,t);return $.fromCartesian3(n,i)},$.prototype.geocentricSurfaceNormal=z.normalize,$.prototype.geodeticSurfaceNormalCartographic=function(e,t){x.a.typeOf.object("cartographic",e);var i=e.longitude,n=e.latitude,r=Math.cos(n),a=r*Math.cos(i),o=r*Math.sin(i),s=Math.sin(n);return Object(u.a)(t)||(t=new z),t.x=a,t.y=o,t.z=s,z.normalize(t,t)},$.prototype.geodeticSurfaceNormal=function(e,t){return Object(u.a)(t)||(t=new z),t=z.multiplyComponents(e,this._oneOverRadiiSquared,t),z.normalize(t,t)};var ee=new z,te=new z;$.prototype.cartographicToCartesian=function(e,t){var i=ee,n=te;this.geodeticSurfaceNormalCartographic(e,i),z.multiplyComponents(this._radiiSquared,i,n);var r=Math.sqrt(z.dot(i,n));return z.divideByScalar(n,r,n),z.multiplyByScalar(i,e.height,i),Object(u.a)(t)||(t=new z),z.add(n,i,t)},$.prototype.cartographicArrayToCartesianArray=function(e,t){x.a.defined("cartographics",e);var i=e.length;Object(u.a)(t)?t.length=i:t=new Array(i);for(var n=0;n<i;n++)t[n]=this.cartographicToCartesian(e[n],t[n]);return t};var ie=new z,ne=new z,re=new z;$.prototype.cartesianToCartographic=function(e,t){var i=this.scaleToGeodeticSurface(e,ne);if(Object(u.a)(i)){var n=this.geodeticSurfaceNormal(i,ie),r=z.subtract(e,i,re),a=Math.atan2(n.y,n.x),o=Math.asin(n.z),s=I.sign(z.dot(r,e))*z.magnitude(r);return Object(u.a)(t)?(t.longitude=a,t.latitude=o,t.height=s,t):new K(a,o,s)}},$.prototype.cartesianArrayToCartographicArray=function(e,t){x.a.defined("cartesians",e);var i=e.length;Object(u.a)(t)?t.length=i:t=new Array(i);for(var n=0;n<i;++n)t[n]=this.cartesianToCartographic(e[n],t[n]);return t},$.prototype.scaleToGeodeticSurface=function(e,t){return H(e,this._oneOverRadii,this._oneOverRadiiSquared,this._centerToleranceSquared,t)},$.prototype.scaleToGeocentricSurface=function(e,t){x.a.typeOf.object("cartesian",e),Object(u.a)(t)||(t=new z);var i=e.x,n=e.y,r=e.z,a=this._oneOverRadiiSquared,o=1/Math.sqrt(i*i*a.x+n*n*a.y+r*r*a.z);return z.multiplyByScalar(e,o,t)},$.prototype.transformPositionToScaledSpace=function(e,t){return Object(u.a)(t)||(t=new z),z.multiplyComponents(e,this._oneOverRadii,t)},$.prototype.transformPositionFromScaledSpace=function(e,t){return Object(u.a)(t)||(t=new z),z.multiplyComponents(e,this._radii,t)},$.prototype.equals=function(e){return this===e||Object(u.a)(e)&&z.equals(this._radii,e._radii)},$.prototype.toString=function(){return this._radii.toString()},$.prototype.getSurfaceNormalIntersectionWithZAxis=function(e,t,i){if(x.a.typeOf.object("position",e),!I.equalsEpsilon(this._radii.x,this._radii.y,I.EPSILON15))throw new h.a("Ellipsoid must be an ellipsoid of revolution (radii.x == radii.y)");x.a.typeOf.number.greaterThan("Ellipsoid.radii.z",this._radii.z,0),t=Object(w.a)(t,0);var n=this._squaredXOverSquaredZ;if(Object(u.a)(i)||(i=new z),i.x=0,i.y=0,i.z=e.z*(1-n),!(Math.abs(i.z)>=this._radii.z-t))return i};var ae=$;function oe(e){this._ellipsoid=Object(w.a)(e,ae.WGS84),this._semimajorAxis=this._ellipsoid.maximumRadius,this._oneOverSemimajorAxis=1/this._semimajorAxis}Object(O.a)(oe.prototype,{ellipsoid:{get:function(){return this._ellipsoid}}}),oe.prototype.project=function(e,t){var i=this._semimajorAxis,n=e.longitude*i,r=e.latitude*i,a=e.height;return Object(u.a)(t)?(t.x=n,t.y=r,t.z=a,t):new z(n,r,a)},oe.prototype.unproject=function(e,t){if(!Object(u.a)(e))throw new h.a("cartesian is required");var i=this._oneOverSemimajorAxis,n=e.x*i,r=e.y*i,a=e.z;return Object(u.a)(t)?(t.longitude=n,t.latitude=r,t.height=a,t):new K(n,r,a)};var se=oe,ce=Object(E.a)({OUTSIDE:-1,INTERSECTING:0,INSIDE:1});var le=function(e,t){this.start=Object(w.a)(e,0),this.stop=Object(w.a)(t,0)};function ue(e,t,i,n,r,a,o,s,c){this[0]=Object(w.a)(e,0),this[1]=Object(w.a)(n,0),this[2]=Object(w.a)(o,0),this[3]=Object(w.a)(t,0),this[4]=Object(w.a)(r,0),this[5]=Object(w.a)(s,0),this[6]=Object(w.a)(i,0),this[7]=Object(w.a)(a,0),this[8]=Object(w.a)(c,0)}ue.packedLength=9,ue.pack=function(e,t,i){return x.a.typeOf.object("value",e),x.a.defined("array",t),i=Object(w.a)(i,0),t[i++]=e[0],t[i++]=e[1],t[i++]=e[2],t[i++]=e[3],t[i++]=e[4],t[i++]=e[5],t[i++]=e[6],t[i++]=e[7],t[i++]=e[8],t},ue.unpack=function(e,t,i){return x.a.defined("array",e),t=Object(w.a)(t,0),Object(u.a)(i)||(i=new ue),i[0]=e[t++],i[1]=e[t++],i[2]=e[t++],i[3]=e[t++],i[4]=e[t++],i[5]=e[t++],i[6]=e[t++],i[7]=e[t++],i[8]=e[t++],i},ue.clone=function(e,t){if(Object(u.a)(e))return Object(u.a)(t)?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t):new ue(e[0],e[3],e[6],e[1],e[4],e[7],e[2],e[5],e[8])},ue.fromArray=function(e,t,i){return x.a.defined("array",e),t=Object(w.a)(t,0),Object(u.a)(i)||(i=new ue),i[0]=e[t],i[1]=e[t+1],i[2]=e[t+2],i[3]=e[t+3],i[4]=e[t+4],i[5]=e[t+5],i[6]=e[t+6],i[7]=e[t+7],i[8]=e[t+8],i},ue.fromColumnMajorArray=function(e,t){return x.a.defined("values",e),ue.clone(e,t)},ue.fromRowMajorArray=function(e,t){return x.a.defined("values",e),Object(u.a)(t)?(t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],t):new ue(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8])},ue.fromQuaternion=function(e,t){x.a.typeOf.object("quaternion",e);var i=e.x*e.x,n=e.x*e.y,r=e.x*e.z,a=e.x*e.w,o=e.y*e.y,s=e.y*e.z,c=e.y*e.w,l=e.z*e.z,h=e.z*e.w,d=e.w*e.w,f=i-o-l+d,p=2*(n-h),m=2*(r+c),_=2*(n+h),g=-i+o-l+d,v=2*(s-a),b=2*(r-c),y=2*(s+a),w=-i-o+l+d;return Object(u.a)(t)?(t[0]=f,t[1]=_,t[2]=b,t[3]=p,t[4]=g,t[5]=y,t[6]=m,t[7]=v,t[8]=w,t):new ue(f,p,m,_,g,v,b,y,w)},ue.fromHeadingPitchRoll=function(e,t){x.a.typeOf.object("headingPitchRoll",e);var i=Math.cos(-e.pitch),n=Math.cos(-e.heading),r=Math.cos(e.roll),a=Math.sin(-e.pitch),o=Math.sin(-e.heading),s=Math.sin(e.roll),c=i*n,l=-r*o+s*a*n,h=s*o+r*a*n,d=i*o,f=r*n+s*a*o,p=-s*n+r*a*o,m=-a,_=s*i,g=r*i;return Object(u.a)(t)?(t[0]=c,t[1]=d,t[2]=m,t[3]=l,t[4]=f,t[5]=_,t[6]=h,t[7]=p,t[8]=g,t):new ue(c,l,h,d,f,p,m,_,g)},ue.fromScale=function(e,t){return x.a.typeOf.object("scale",e),Object(u.a)(t)?(t[0]=e.x,t[1]=0,t[2]=0,t[3]=0,t[4]=e.y,t[5]=0,t[6]=0,t[7]=0,t[8]=e.z,t):new ue(e.x,0,0,0,e.y,0,0,0,e.z)},ue.fromUniformScale=function(e,t){return x.a.typeOf.number("scale",e),Object(u.a)(t)?(t[0]=e,t[1]=0,t[2]=0,t[3]=0,t[4]=e,t[5]=0,t[6]=0,t[7]=0,t[8]=e,t):new ue(e,0,0,0,e,0,0,0,e)},ue.fromCrossProduct=function(e,t){return x.a.typeOf.object("vector",e),Object(u.a)(t)?(t[0]=0,t[1]=e.z,t[2]=-e.y,t[3]=-e.z,t[4]=0,t[5]=e.x,t[6]=e.y,t[7]=-e.x,t[8]=0,t):new ue(0,-e.z,e.y,e.z,0,-e.x,-e.y,e.x,0)},ue.fromRotationX=function(e,t){x.a.typeOf.number("angle",e);var i=Math.cos(e),n=Math.sin(e);return Object(u.a)(t)?(t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=i,t[5]=n,t[6]=0,t[7]=-n,t[8]=i,t):new ue(1,0,0,0,i,-n,0,n,i)},ue.fromRotationY=function(e,t){x.a.typeOf.number("angle",e);var i=Math.cos(e),n=Math.sin(e);return Object(u.a)(t)?(t[0]=i,t[1]=0,t[2]=-n,t[3]=0,t[4]=1,t[5]=0,t[6]=n,t[7]=0,t[8]=i,t):new ue(i,0,n,0,1,0,-n,0,i)},ue.fromRotationZ=function(e,t){x.a.typeOf.number("angle",e);var i=Math.cos(e),n=Math.sin(e);return Object(u.a)(t)?(t[0]=i,t[1]=n,t[2]=0,t[3]=-n,t[4]=i,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t):new ue(i,-n,0,n,i,0,0,0,1)},ue.toArray=function(e,t){return x.a.typeOf.object("matrix",e),Object(u.a)(t)?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t):[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8]]},ue.getElementIndex=function(e,t){return x.a.typeOf.number.greaterThanOrEquals("row",t,0),x.a.typeOf.number.lessThanOrEquals("row",t,2),x.a.typeOf.number.greaterThanOrEquals("column",e,0),x.a.typeOf.number.lessThanOrEquals("column",e,2),3*e+t},ue.getColumn=function(e,t,i){x.a.typeOf.object("matrix",e),x.a.typeOf.number.greaterThanOrEquals("index",t,0),x.a.typeOf.number.lessThanOrEquals("index",t,2),x.a.typeOf.object("result",i);var n=3*t,r=e[n],a=e[n+1],o=e[n+2];return i.x=r,i.y=a,i.z=o,i},ue.setColumn=function(e,t,i,n){x.a.typeOf.object("matrix",e),x.a.typeOf.number.greaterThanOrEquals("index",t,0),x.a.typeOf.number.lessThanOrEquals("index",t,2),x.a.typeOf.object("cartesian",i),x.a.typeOf.object("result",n);var r=3*t;return(n=ue.clone(e,n))[r]=i.x,n[r+1]=i.y,n[r+2]=i.z,n},ue.getRow=function(e,t,i){x.a.typeOf.object("matrix",e),x.a.typeOf.number.greaterThanOrEquals("index",t,0),x.a.typeOf.number.lessThanOrEquals("index",t,2),x.a.typeOf.object("result",i);var n=e[t],r=e[t+3],a=e[t+6];return i.x=n,i.y=r,i.z=a,i},ue.setRow=function(e,t,i,n){return x.a.typeOf.object("matrix",e),x.a.typeOf.number.greaterThanOrEquals("index",t,0),x.a.typeOf.number.lessThanOrEquals("index",t,2),x.a.typeOf.object("cartesian",i),x.a.typeOf.object("result",n),(n=ue.clone(e,n))[t]=i.x,n[t+3]=i.y,n[t+6]=i.z,n};var he=new z;ue.getScale=function(e,t){return x.a.typeOf.object("matrix",e),x.a.typeOf.object("result",t),t.x=z.magnitude(z.fromElements(e[0],e[1],e[2],he)),t.y=z.magnitude(z.fromElements(e[3],e[4],e[5],he)),t.z=z.magnitude(z.fromElements(e[6],e[7],e[8],he)),t};var de=new z;ue.getMaximumScale=function(e){return ue.getScale(e,de),z.maximumComponent(de)},ue.multiply=function(e,t,i){x.a.typeOf.object("left",e),x.a.typeOf.object("right",t),x.a.typeOf.object("result",i);var n=e[0]*t[0]+e[3]*t[1]+e[6]*t[2],r=e[1]*t[0]+e[4]*t[1]+e[7]*t[2],a=e[2]*t[0]+e[5]*t[1]+e[8]*t[2],o=e[0]*t[3]+e[3]*t[4]+e[6]*t[5],s=e[1]*t[3]+e[4]*t[4]+e[7]*t[5],c=e[2]*t[3]+e[5]*t[4]+e[8]*t[5],l=e[0]*t[6]+e[3]*t[7]+e[6]*t[8],u=e[1]*t[6]+e[4]*t[7]+e[7]*t[8],h=e[2]*t[6]+e[5]*t[7]+e[8]*t[8];return i[0]=n,i[1]=r,i[2]=a,i[3]=o,i[4]=s,i[5]=c,i[6]=l,i[7]=u,i[8]=h,i},ue.add=function(e,t,i){return x.a.typeOf.object("left",e),x.a.typeOf.object("right",t),x.a.typeOf.object("result",i),i[0]=e[0]+t[0],i[1]=e[1]+t[1],i[2]=e[2]+t[2],i[3]=e[3]+t[3],i[4]=e[4]+t[4],i[5]=e[5]+t[5],i[6]=e[6]+t[6],i[7]=e[7]+t[7],i[8]=e[8]+t[8],i},ue.subtract=function(e,t,i){return x.a.typeOf.object("left",e),x.a.typeOf.object("right",t),x.a.typeOf.object("result",i),i[0]=e[0]-t[0],i[1]=e[1]-t[1],i[2]=e[2]-t[2],i[3]=e[3]-t[3],i[4]=e[4]-t[4],i[5]=e[5]-t[5],i[6]=e[6]-t[6],i[7]=e[7]-t[7],i[8]=e[8]-t[8],i},ue.multiplyByVector=function(e,t,i){x.a.typeOf.object("matrix",e),x.a.typeOf.object("cartesian",t),x.a.typeOf.object("result",i);var n=t.x,r=t.y,a=t.z,o=e[0]*n+e[3]*r+e[6]*a,s=e[1]*n+e[4]*r+e[7]*a,c=e[2]*n+e[5]*r+e[8]*a;return i.x=o,i.y=s,i.z=c,i},ue.multiplyByScalar=function(e,t,i){return x.a.typeOf.object("matrix",e),x.a.typeOf.number("scalar",t),x.a.typeOf.object("result",i),i[0]=e[0]*t,i[1]=e[1]*t,i[2]=e[2]*t,i[3]=e[3]*t,i[4]=e[4]*t,i[5]=e[5]*t,i[6]=e[6]*t,i[7]=e[7]*t,i[8]=e[8]*t,i},ue.multiplyByScale=function(e,t,i){return x.a.typeOf.object("matrix",e),x.a.typeOf.object("scale",t),x.a.typeOf.object("result",i),i[0]=e[0]*t.x,i[1]=e[1]*t.x,i[2]=e[2]*t.x,i[3]=e[3]*t.y,i[4]=e[4]*t.y,i[5]=e[5]*t.y,i[6]=e[6]*t.z,i[7]=e[7]*t.z,i[8]=e[8]*t.z,i},ue.negate=function(e,t){return x.a.typeOf.object("matrix",e),x.a.typeOf.object("result",t),t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t[4]=-e[4],t[5]=-e[5],t[6]=-e[6],t[7]=-e[7],t[8]=-e[8],t},ue.transpose=function(e,t){x.a.typeOf.object("matrix",e),x.a.typeOf.object("result",t);var i=e[0],n=e[3],r=e[6],a=e[1],o=e[4],s=e[7],c=e[2],l=e[5],u=e[8];return t[0]=i,t[1]=n,t[2]=r,t[3]=a,t[4]=o,t[5]=s,t[6]=c,t[7]=l,t[8]=u,t};var fe=[1,0,0],pe=[2,2,1];function me(e){for(var t=0,i=0;i<3;++i){var n=e[ue.getElementIndex(pe[i],fe[i])];t+=2*n*n}return Math.sqrt(t)}function _e(e,t){for(var i=I.EPSILON15,n=0,r=1,a=0;a<3;++a){var o=Math.abs(e[ue.getElementIndex(pe[a],fe[a])]);o>n&&(r=a,n=o)}var s=1,c=0,l=fe[r],u=pe[r];if(Math.abs(e[ue.getElementIndex(u,l)])>i){var h,d=(e[ue.getElementIndex(u,u)]-e[ue.getElementIndex(l,l)])/2/e[ue.getElementIndex(u,l)];c=(h=d<0?-1/(-d+Math.sqrt(1+d*d)):1/(d+Math.sqrt(1+d*d)))*(s=1/Math.sqrt(1+h*h))}return(t=ue.clone(ue.IDENTITY,t))[ue.getElementIndex(l,l)]=t[ue.getElementIndex(u,u)]=s,t[ue.getElementIndex(u,l)]=c,t[ue.getElementIndex(l,u)]=-c,t}var ge=new ue,ve=new ue;ue.computeEigenDecomposition=function(e,t){x.a.typeOf.object("matrix",e);var i=I.EPSILON20,n=0,r=0;Object(u.a)(t)||(t={});for(var a=t.unitary=ue.clone(ue.IDENTITY,t.unitary),o=t.diagonal=ue.clone(e,t.diagonal),s=i*function(e){for(var t=0,i=0;i<9;++i){var n=e[i];t+=n*n}return Math.sqrt(t)}(o);r<10&&me(o)>s;)_e(o,ge),ue.transpose(ge,ve),ue.multiply(o,ge,o),ue.multiply(ve,o,o),ue.multiply(a,ge,a),++n>2&&(++r,n=0);return t},ue.abs=function(e,t){return x.a.typeOf.object("matrix",e),x.a.typeOf.object("result",t),t[0]=Math.abs(e[0]),t[1]=Math.abs(e[1]),t[2]=Math.abs(e[2]),t[3]=Math.abs(e[3]),t[4]=Math.abs(e[4]),t[5]=Math.abs(e[5]),t[6]=Math.abs(e[6]),t[7]=Math.abs(e[7]),t[8]=Math.abs(e[8]),t},ue.determinant=function(e){x.a.typeOf.object("matrix",e);var t=e[0],i=e[3],n=e[6],r=e[1],a=e[4],o=e[7],s=e[2],c=e[5],l=e[8];return t*(a*l-c*o)+r*(c*n-i*l)+s*(i*o-a*n)},ue.inverse=function(e,t){x.a.typeOf.object("matrix",e),x.a.typeOf.object("result",t);var i=e[0],n=e[1],r=e[2],a=e[3],o=e[4],s=e[5],c=e[6],l=e[7],u=e[8],d=ue.determinant(e);if(Math.abs(d)<=I.EPSILON15)throw new h.a("matrix is not invertible");t[0]=o*u-l*s,t[1]=l*r-n*u,t[2]=n*s-o*r,t[3]=c*s-a*u,t[4]=i*u-c*r,t[5]=a*r-i*s,t[6]=a*l-c*o,t[7]=c*n-i*l,t[8]=i*o-a*n;var f=1/d;return ue.multiplyByScalar(t,f,t)},ue.equals=function(e,t){return e===t||Object(u.a)(e)&&Object(u.a)(t)&&e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]},ue.equalsEpsilon=function(e,t,i){return x.a.typeOf.number("epsilon",i),e===t||Object(u.a)(e)&&Object(u.a)(t)&&Math.abs(e[0]-t[0])<=i&&Math.abs(e[1]-t[1])<=i&&Math.abs(e[2]-t[2])<=i&&Math.abs(e[3]-t[3])<=i&&Math.abs(e[4]-t[4])<=i&&Math.abs(e[5]-t[5])<=i&&Math.abs(e[6]-t[6])<=i&&Math.abs(e[7]-t[7])<=i&&Math.abs(e[8]-t[8])<=i},ue.IDENTITY=Object(E.a)(new ue(1,0,0,0,1,0,0,0,1)),ue.ZERO=Object(E.a)(new ue(0,0,0,0,0,0,0,0,0)),ue.COLUMN0ROW0=0,ue.COLUMN0ROW1=1,ue.COLUMN0ROW2=2,ue.COLUMN1ROW0=3,ue.COLUMN1ROW1=4,ue.COLUMN1ROW2=5,ue.COLUMN2ROW0=6,ue.COLUMN2ROW1=7,ue.COLUMN2ROW2=8,Object(O.a)(ue.prototype,{length:{get:function(){return ue.packedLength}}}),ue.prototype.clone=function(e){return ue.clone(this,e)},ue.prototype.equals=function(e){return ue.equals(this,e)},ue.equalsArray=function(e,t,i){return e[0]===t[i]&&e[1]===t[i+1]&&e[2]===t[i+2]&&e[3]===t[i+3]&&e[4]===t[i+4]&&e[5]===t[i+5]&&e[6]===t[i+6]&&e[7]===t[i+7]&&e[8]===t[i+8]},ue.prototype.equalsEpsilon=function(e,t){return ue.equalsEpsilon(this,e,t)},ue.prototype.toString=function(){return"("+this[0]+", "+this[3]+", "+this[6]+")\n("+this[1]+", "+this[4]+", "+this[7]+")\n("+this[2]+", "+this[5]+", "+this[8]+")"};var be=ue;function ye(e,t,i,n){this.x=Object(w.a)(e,0),this.y=Object(w.a)(t,0),this.z=Object(w.a)(i,0),this.w=Object(w.a)(n,0)}ye.fromElements=function(e,t,i,n,r){return Object(u.a)(r)?(r.x=e,r.y=t,r.z=i,r.w=n,r):new ye(e,t,i,n)},ye.fromColor=function(e,t){return x.a.typeOf.object("color",e),Object(u.a)(t)?(t.x=e.red,t.y=e.green,t.z=e.blue,t.w=e.alpha,t):new ye(e.red,e.green,e.blue,e.alpha)},ye.clone=function(e,t){if(Object(u.a)(e))return Object(u.a)(t)?(t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t):new ye(e.x,e.y,e.z,e.w)},ye.packedLength=4,ye.pack=function(e,t,i){return x.a.typeOf.object("value",e),x.a.defined("array",t),i=Object(w.a)(i,0),t[i++]=e.x,t[i++]=e.y,t[i++]=e.z,t[i]=e.w,t},ye.unpack=function(e,t,i){return x.a.defined("array",e),t=Object(w.a)(t,0),Object(u.a)(i)||(i=new ye),i.x=e[t++],i.y=e[t++],i.z=e[t++],i.w=e[t],i},ye.packArray=function(e,t){x.a.defined("array",e);var i=e.length;Object(u.a)(t)?t.length=4*i:t=new Array(4*i);for(var n=0;n<i;++n)ye.pack(e[n],t,4*n);return t},ye.unpackArray=function(e,t){x.a.defined("array",e);var i=e.length;Object(u.a)(t)?t.length=i/4:t=new Array(i/4);for(var n=0;n<i;n+=4){var r=n/4;t[r]=ye.unpack(e,n,t[r])}return t},ye.fromArray=ye.unpack,ye.maximumComponent=function(e){return x.a.typeOf.object("cartesian",e),Math.max(e.x,e.y,e.z,e.w)},ye.minimumComponent=function(e){return x.a.typeOf.object("cartesian",e),Math.min(e.x,e.y,e.z,e.w)},ye.minimumByComponent=function(e,t,i){return x.a.typeOf.object("first",e),x.a.typeOf.object("second",t),x.a.typeOf.object("result",i),i.x=Math.min(e.x,t.x),i.y=Math.min(e.y,t.y),i.z=Math.min(e.z,t.z),i.w=Math.min(e.w,t.w),i},ye.maximumByComponent=function(e,t,i){return x.a.typeOf.object("first",e),x.a.typeOf.object("second",t),x.a.typeOf.object("result",i),i.x=Math.max(e.x,t.x),i.y=Math.max(e.y,t.y),i.z=Math.max(e.z,t.z),i.w=Math.max(e.w,t.w),i},ye.magnitudeSquared=function(e){return x.a.typeOf.object("cartesian",e),e.x*e.x+e.y*e.y+e.z*e.z+e.w*e.w},ye.magnitude=function(e){return Math.sqrt(ye.magnitudeSquared(e))};var we=new ye;ye.distance=function(e,t){return x.a.typeOf.object("left",e),x.a.typeOf.object("right",t),ye.subtract(e,t,we),ye.magnitude(we)},ye.distanceSquared=function(e,t){return x.a.typeOf.object("left",e),x.a.typeOf.object("right",t),ye.subtract(e,t,we),ye.magnitudeSquared(we)},ye.normalize=function(e,t){x.a.typeOf.object("cartesian",e),x.a.typeOf.object("result",t);var i=ye.magnitude(e);if(t.x=e.x/i,t.y=e.y/i,t.z=e.z/i,t.w=e.w/i,isNaN(t.x)||isNaN(t.y)||isNaN(t.z)||isNaN(t.w))throw new h.a("normalized result is not a number");return t},ye.dot=function(e,t){return x.a.typeOf.object("left",e),x.a.typeOf.object("right",t),e.x*t.x+e.y*t.y+e.z*t.z+e.w*t.w},ye.multiplyComponents=function(e,t,i){return x.a.typeOf.object("left",e),x.a.typeOf.object("right",t),x.a.typeOf.object("result",i),i.x=e.x*t.x,i.y=e.y*t.y,i.z=e.z*t.z,i.w=e.w*t.w,i},ye.divideComponents=function(e,t,i){return x.a.typeOf.object("left",e),x.a.typeOf.object("right",t),x.a.typeOf.object("result",i),i.x=e.x/t.x,i.y=e.y/t.y,i.z=e.z/t.z,i.w=e.w/t.w,i},ye.add=function(e,t,i){return x.a.typeOf.object("left",e),x.a.typeOf.object("right",t),x.a.typeOf.object("result",i),i.x=e.x+t.x,i.y=e.y+t.y,i.z=e.z+t.z,i.w=e.w+t.w,i},ye.subtract=function(e,t,i){return x.a.typeOf.object("left",e),x.a.typeOf.object("right",t),x.a.typeOf.object("result",i),i.x=e.x-t.x,i.y=e.y-t.y,i.z=e.z-t.z,i.w=e.w-t.w,i},ye.multiplyByScalar=function(e,t,i){return x.a.typeOf.object("cartesian",e),x.a.typeOf.number("scalar",t),x.a.typeOf.object("result",i),i.x=e.x*t,i.y=e.y*t,i.z=e.z*t,i.w=e.w*t,i},ye.divideByScalar=function(e,t,i){return x.a.typeOf.object("cartesian",e),x.a.typeOf.number("scalar",t),x.a.typeOf.object("result",i),i.x=e.x/t,i.y=e.y/t,i.z=e.z/t,i.w=e.w/t,i},ye.negate=function(e,t){return x.a.typeOf.object("cartesian",e),x.a.typeOf.object("result",t),t.x=-e.x,t.y=-e.y,t.z=-e.z,t.w=-e.w,t},ye.abs=function(e,t){return x.a.typeOf.object("cartesian",e),x.a.typeOf.object("result",t),t.x=Math.abs(e.x),t.y=Math.abs(e.y),t.z=Math.abs(e.z),t.w=Math.abs(e.w),t};var Oe=new ye;ye.lerp=function(e,t,i,n){return x.a.typeOf.object("start",e),x.a.typeOf.object("end",t),x.a.typeOf.number("t",i),x.a.typeOf.object("result",n),ye.multiplyByScalar(t,i,Oe),n=ye.multiplyByScalar(e,1-i,n),ye.add(Oe,n,n)};var xe=new ye;ye.mostOrthogonalAxis=function(e,t){x.a.typeOf.object("cartesian",e),x.a.typeOf.object("result",t);var i=ye.normalize(e,xe);return ye.abs(i,i),t=i.x<=i.y?i.x<=i.z?i.x<=i.w?ye.clone(ye.UNIT_X,t):ye.clone(ye.UNIT_W,t):i.z<=i.w?ye.clone(ye.UNIT_Z,t):ye.clone(ye.UNIT_W,t):i.y<=i.z?i.y<=i.w?ye.clone(ye.UNIT_Y,t):ye.clone(ye.UNIT_W,t):i.z<=i.w?ye.clone(ye.UNIT_Z,t):ye.clone(ye.UNIT_W,t)},ye.equals=function(e,t){return e===t||Object(u.a)(e)&&Object(u.a)(t)&&e.x===t.x&&e.y===t.y&&e.z===t.z&&e.w===t.w},ye.equalsArray=function(e,t,i){return e.x===t[i]&&e.y===t[i+1]&&e.z===t[i+2]&&e.w===t[i+3]},ye.equalsEpsilon=function(e,t,i,n){return e===t||Object(u.a)(e)&&Object(u.a)(t)&&I.equalsEpsilon(e.x,t.x,i,n)&&I.equalsEpsilon(e.y,t.y,i,n)&&I.equalsEpsilon(e.z,t.z,i,n)&&I.equalsEpsilon(e.w,t.w,i,n)},ye.ZERO=Object(E.a)(new ye(0,0,0,0)),ye.UNIT_X=Object(E.a)(new ye(1,0,0,0)),ye.UNIT_Y=Object(E.a)(new ye(0,1,0,0)),ye.UNIT_Z=Object(E.a)(new ye(0,0,1,0)),ye.UNIT_W=Object(E.a)(new ye(0,0,0,1)),ye.prototype.clone=function(e){return ye.clone(this,e)},ye.prototype.equals=function(e){return ye.equals(this,e)},ye.prototype.equalsEpsilon=function(e,t,i){return ye.equalsEpsilon(this,e,t,i)},ye.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.z+", "+this.w+")"};var Ee=new Float32Array(1);ye.packFloat=function(e,t){if(x.a.typeOf.number("value",e),Object(u.a)(t)||(t=new ye),Ee[0]=e,0===(e=Ee[0]))return ye.clone(ye.ZERO,t);var i,n=e<0?1:0;isFinite(e)?(e=Math.abs(e),i=Math.floor(I.logBase(e,10))+1,e/=Math.pow(10,i)):(e=.1,i=38);var r=256*e;return t.x=Math.floor(r),r=256*(r-t.x),t.y=Math.floor(r),r=256*(r-t.y),t.z=Math.floor(r),t.w=2*(i+38)+n,t},ye.unpackFloat=function(e){x.a.typeOf.object("packedFloat",e);var t=e.w/2,i=Math.floor(t),n=2*(t-i);if(n=-(n=2*n-1),(i-=38)>=38)return n<0?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY;var r=n*e.x*(1/256);return r+=n*e.y*(1/65536),(r+=n*e.z*(1/16777216))*Math.pow(10,i)};var Te=ye,Ce=n(7);function Se(e,t,i,n,r,a,o,s,c,l,u,h,d,f,p,m){this[0]=Object(w.a)(e,0),this[1]=Object(w.a)(r,0),this[2]=Object(w.a)(c,0),this[3]=Object(w.a)(d,0),this[4]=Object(w.a)(t,0),this[5]=Object(w.a)(a,0),this[6]=Object(w.a)(l,0),this[7]=Object(w.a)(f,0),this[8]=Object(w.a)(i,0),this[9]=Object(w.a)(o,0),this[10]=Object(w.a)(u,0),this[11]=Object(w.a)(p,0),this[12]=Object(w.a)(n,0),this[13]=Object(w.a)(s,0),this[14]=Object(w.a)(h,0),this[15]=Object(w.a)(m,0)}Se.packedLength=16,Se.pack=function(e,t,i){return x.a.typeOf.object("value",e),x.a.defined("array",t),i=Object(w.a)(i,0),t[i++]=e[0],t[i++]=e[1],t[i++]=e[2],t[i++]=e[3],t[i++]=e[4],t[i++]=e[5],t[i++]=e[6],t[i++]=e[7],t[i++]=e[8],t[i++]=e[9],t[i++]=e[10],t[i++]=e[11],t[i++]=e[12],t[i++]=e[13],t[i++]=e[14],t[i]=e[15],t},Se.unpack=function(e,t,i){return x.a.defined("array",e),t=Object(w.a)(t,0),Object(u.a)(i)||(i=new Se),i[0]=e[t++],i[1]=e[t++],i[2]=e[t++],i[3]=e[t++],i[4]=e[t++],i[5]=e[t++],i[6]=e[t++],i[7]=e[t++],i[8]=e[t++],i[9]=e[t++],i[10]=e[t++],i[11]=e[t++],i[12]=e[t++],i[13]=e[t++],i[14]=e[t++],i[15]=e[t],i},Se.clone=function(e,t){if(Object(u.a)(e))return Object(u.a)(t)?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t):new Se(e[0],e[4],e[8],e[12],e[1],e[5],e[9],e[13],e[2],e[6],e[10],e[14],e[3],e[7],e[11],e[15])},Se.fromArray=Se.unpack,Se.fromColumnMajorArray=function(e,t){return x.a.defined("values",e),Se.clone(e,t)},Se.fromRowMajorArray=function(e,t){return x.a.defined("values",e),Object(u.a)(t)?(t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15],t):new Se(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15])},Se.fromRotationTranslation=function(e,t,i){return x.a.typeOf.object("rotation",e),t=Object(w.a)(t,z.ZERO),Object(u.a)(i)?(i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=0,i[4]=e[3],i[5]=e[4],i[6]=e[5],i[7]=0,i[8]=e[6],i[9]=e[7],i[10]=e[8],i[11]=0,i[12]=t.x,i[13]=t.y,i[14]=t.z,i[15]=1,i):new Se(e[0],e[3],e[6],t.x,e[1],e[4],e[7],t.y,e[2],e[5],e[8],t.z,0,0,0,1)},Se.fromTranslationQuaternionRotationScale=function(e,t,i,n){x.a.typeOf.object("translation",e),x.a.typeOf.object("rotation",t),x.a.typeOf.object("scale",i),Object(u.a)(n)||(n=new Se);var r=i.x,a=i.y,o=i.z,s=t.x*t.x,c=t.x*t.y,l=t.x*t.z,h=t.x*t.w,d=t.y*t.y,f=t.y*t.z,p=t.y*t.w,m=t.z*t.z,_=t.z*t.w,g=t.w*t.w,v=s-d-m+g,b=2*(c-_),y=2*(l+p),w=2*(c+_),O=-s+d-m+g,E=2*(f-h),T=2*(l-p),C=2*(f+h),S=-s-d+m+g;return n[0]=v*r,n[1]=w*r,n[2]=T*r,n[3]=0,n[4]=b*a,n[5]=O*a,n[6]=C*a,n[7]=0,n[8]=y*o,n[9]=E*o,n[10]=S*o,n[11]=0,n[12]=e.x,n[13]=e.y,n[14]=e.z,n[15]=1,n},Se.fromTranslationRotationScale=function(e,t){return x.a.typeOf.object("translationRotationScale",e),Se.fromTranslationQuaternionRotationScale(e.translation,e.rotation,e.scale,t)},Se.fromTranslation=function(e,t){return x.a.typeOf.object("translation",e),Se.fromRotationTranslation(be.IDENTITY,e,t)},Se.fromScale=function(e,t){return x.a.typeOf.object("scale",e),Object(u.a)(t)?(t[0]=e.x,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e.y,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e.z,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t):new Se(e.x,0,0,0,0,e.y,0,0,0,0,e.z,0,0,0,0,1)},Se.fromUniformScale=function(e,t){return x.a.typeOf.number("scale",e),Object(u.a)(t)?(t[0]=e,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t):new Se(e,0,0,0,0,e,0,0,0,0,e,0,0,0,0,1)};var Ae=new z,Pe=new z,Ie=new z;Se.fromCamera=function(e,t){x.a.typeOf.object("camera",e);var i=e.position,n=e.direction,r=e.up;x.a.typeOf.object("camera.position",i),x.a.typeOf.object("camera.direction",n),x.a.typeOf.object("camera.up",r),z.normalize(n,Ae),z.normalize(z.cross(Ae,r,Pe),Pe),z.normalize(z.cross(Pe,Ae,Ie),Ie);var a=Pe.x,o=Pe.y,s=Pe.z,c=Ae.x,l=Ae.y,h=Ae.z,d=Ie.x,f=Ie.y,p=Ie.z,m=i.x,_=i.y,g=i.z,v=a*-m+o*-_+s*-g,b=d*-m+f*-_+p*-g,y=c*m+l*_+h*g;return Object(u.a)(t)?(t[0]=a,t[1]=d,t[2]=-c,t[3]=0,t[4]=o,t[5]=f,t[6]=-l,t[7]=0,t[8]=s,t[9]=p,t[10]=-h,t[11]=0,t[12]=v,t[13]=b,t[14]=y,t[15]=1,t):new Se(a,o,s,v,d,f,p,b,-c,-l,-h,y,0,0,0,1)},Se.computePerspectiveFieldOfView=function(e,t,i,n,r){x.a.typeOf.number.greaterThan("fovY",e,0),x.a.typeOf.number.lessThan("fovY",e,Math.PI),x.a.typeOf.number.greaterThan("near",i,0),x.a.typeOf.number.greaterThan("far",n,0),x.a.typeOf.object("result",r);var a=1/Math.tan(.5*e),o=a/t,s=(n+i)/(i-n),c=2*n*i/(i-n);return r[0]=o,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=a,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=s,r[11]=-1,r[12]=0,r[13]=0,r[14]=c,r[15]=0,r},Se.computeOrthographicOffCenter=function(e,t,i,n,r,a,o){x.a.typeOf.number("left",e),x.a.typeOf.number("right",t),x.a.typeOf.number("bottom",i),x.a.typeOf.number("top",n),x.a.typeOf.number("near",r),x.a.typeOf.number("far",a),x.a.typeOf.object("result",o);var s=1/(t-e),c=1/(n-i),l=1/(a-r),u=-(t+e)*s,h=-(n+i)*c,d=-(a+r)*l;return s*=2,c*=2,l*=-2,o[0]=s,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=c,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=l,o[11]=0,o[12]=u,o[13]=h,o[14]=d,o[15]=1,o},Se.computePerspectiveOffCenter=function(e,t,i,n,r,a,o){x.a.typeOf.number("left",e),x.a.typeOf.number("right",t),x.a.typeOf.number("bottom",i),x.a.typeOf.number("top",n),x.a.typeOf.number("near",r),x.a.typeOf.number("far",a),x.a.typeOf.object("result",o);var s=2*r/(t-e),c=2*r/(n-i),l=(t+e)/(t-e),u=(n+i)/(n-i),h=-(a+r)/(a-r),d=-2*a*r/(a-r);return o[0]=s,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=c,o[6]=0,o[7]=0,o[8]=l,o[9]=u,o[10]=h,o[11]=-1,o[12]=0,o[13]=0,o[14]=d,o[15]=0,o},Se.computeInfinitePerspectiveOffCenter=function(e,t,i,n,r,a){x.a.typeOf.number("left",e),x.a.typeOf.number("right",t),x.a.typeOf.number("bottom",i),x.a.typeOf.number("top",n),x.a.typeOf.number("near",r),x.a.typeOf.object("result",a);var o=2*r/(t-e),s=2*r/(n-i),c=(t+e)/(t-e),l=(n+i)/(n-i),u=-2*r;return a[0]=o,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=s,a[6]=0,a[7]=0,a[8]=c,a[9]=l,a[10]=-1,a[11]=-1,a[12]=0,a[13]=0,a[14]=u,a[15]=0,a},Se.computeViewportTransformation=function(e,t,i,n){x.a.typeOf.object("result",n),e=Object(w.a)(e,w.a.EMPTY_OBJECT);var r=Object(w.a)(e.x,0),a=Object(w.a)(e.y,0),o=Object(w.a)(e.width,0),s=Object(w.a)(e.height,0);t=Object(w.a)(t,0);var c=.5*o,l=.5*s,u=.5*((i=Object(w.a)(i,1))-t),h=c,d=l,f=u,p=r+c,m=a+l,_=t+u;return n[0]=h,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=d,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=f,n[11]=0,n[12]=p,n[13]=m,n[14]=_,n[15]=1,n},Se.computeView=function(e,t,i,n,r){return x.a.typeOf.object("position",e),x.a.typeOf.object("direction",t),x.a.typeOf.object("up",i),x.a.typeOf.object("right",n),x.a.typeOf.object("result",r),r[0]=n.x,r[1]=i.x,r[2]=-t.x,r[3]=0,r[4]=n.y,r[5]=i.y,r[6]=-t.y,r[7]=0,r[8]=n.z,r[9]=i.z,r[10]=-t.z,r[11]=0,r[12]=-z.dot(n,e),r[13]=-z.dot(i,e),r[14]=z.dot(t,e),r[15]=1,r},Se.toArray=function(e,t){return x.a.typeOf.object("matrix",e),Object(u.a)(t)?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t):[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15]]},Se.getElementIndex=function(e,t){return x.a.typeOf.number.greaterThanOrEquals("row",t,0),x.a.typeOf.number.lessThanOrEquals("row",t,3),x.a.typeOf.number.greaterThanOrEquals("column",e,0),x.a.typeOf.number.lessThanOrEquals("column",e,3),4*e+t},Se.getColumn=function(e,t,i){x.a.typeOf.object("matrix",e),x.a.typeOf.number.greaterThanOrEquals("index",t,0),x.a.typeOf.number.lessThanOrEquals("index",t,3),x.a.typeOf.object("result",i);var n=4*t,r=e[n],a=e[n+1],o=e[n+2],s=e[n+3];return i.x=r,i.y=a,i.z=o,i.w=s,i},Se.setColumn=function(e,t,i,n){x.a.typeOf.object("matrix",e),x.a.typeOf.number.greaterThanOrEquals("index",t,0),x.a.typeOf.number.lessThanOrEquals("index",t,3),x.a.typeOf.object("cartesian",i),x.a.typeOf.object("result",n);var r=4*t;return(n=Se.clone(e,n))[r]=i.x,n[r+1]=i.y,n[r+2]=i.z,n[r+3]=i.w,n},Se.setTranslation=function(e,t,i){return x.a.typeOf.object("matrix",e),x.a.typeOf.object("translation",t),x.a.typeOf.object("result",i),i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i[4]=e[4],i[5]=e[5],i[6]=e[6],i[7]=e[7],i[8]=e[8],i[9]=e[9],i[10]=e[10],i[11]=e[11],i[12]=t.x,i[13]=t.y,i[14]=t.z,i[15]=e[15],i};var De=new z;Se.setScale=function(e,t,i){x.a.typeOf.object("matrix",e),x.a.typeOf.object("scale",t),x.a.typeOf.object("result",i);var n=Se.getScale(e,De),r=z.divideComponents(t,n,De);return Se.multiplyByScale(e,r,i)},Se.getRow=function(e,t,i){x.a.typeOf.object("matrix",e),x.a.typeOf.number.greaterThanOrEquals("index",t,0),x.a.typeOf.number.lessThanOrEquals("index",t,3),x.a.typeOf.object("result",i);var n=e[t],r=e[t+4],a=e[t+8],o=e[t+12];return i.x=n,i.y=r,i.z=a,i.w=o,i},Se.setRow=function(e,t,i,n){return x.a.typeOf.object("matrix",e),x.a.typeOf.number.greaterThanOrEquals("index",t,0),x.a.typeOf.number.lessThanOrEquals("index",t,3),x.a.typeOf.object("cartesian",i),x.a.typeOf.object("result",n),(n=Se.clone(e,n))[t]=i.x,n[t+4]=i.y,n[t+8]=i.z,n[t+12]=i.w,n};var je=new z;Se.getScale=function(e,t){return x.a.typeOf.object("matrix",e),x.a.typeOf.object("result",t),t.x=z.magnitude(z.fromElements(e[0],e[1],e[2],je)),t.y=z.magnitude(z.fromElements(e[4],e[5],e[6],je)),t.z=z.magnitude(z.fromElements(e[8],e[9],e[10],je)),t};var Me=new z;Se.getMaximumScale=function(e){return Se.getScale(e,Me),z.maximumComponent(Me)},Se.multiply=function(e,t,i){x.a.typeOf.object("left",e),x.a.typeOf.object("right",t),x.a.typeOf.object("result",i);var n=e[0],r=e[1],a=e[2],o=e[3],s=e[4],c=e[5],l=e[6],u=e[7],h=e[8],d=e[9],f=e[10],p=e[11],m=e[12],_=e[13],g=e[14],v=e[15],b=t[0],y=t[1],w=t[2],O=t[3],E=t[4],T=t[5],C=t[6],S=t[7],A=t[8],P=t[9],I=t[10],D=t[11],j=t[12],M=t[13],R=t[14],L=t[15],N=n*b+s*y+h*w+m*O,F=r*b+c*y+d*w+_*O,k=a*b+l*y+f*w+g*O,B=o*b+u*y+p*w+v*O,z=n*E+s*T+h*C+m*S,U=r*E+c*T+d*C+_*S,V=a*E+l*T+f*C+g*S,H=o*E+u*T+p*C+v*S,G=n*A+s*P+h*I+m*D,q=r*A+c*P+d*I+_*D,W=a*A+l*P+f*I+g*D,Y=o*A+u*P+p*I+v*D,X=n*j+s*M+h*R+m*L,Z=r*j+c*M+d*R+_*L,Q=a*j+l*M+f*R+g*L,K=o*j+u*M+p*R+v*L;return i[0]=N,i[1]=F,i[2]=k,i[3]=B,i[4]=z,i[5]=U,i[6]=V,i[7]=H,i[8]=G,i[9]=q,i[10]=W,i[11]=Y,i[12]=X,i[13]=Z,i[14]=Q,i[15]=K,i},Se.add=function(e,t,i){return x.a.typeOf.object("left",e),x.a.typeOf.object("right",t),x.a.typeOf.object("result",i),i[0]=e[0]+t[0],i[1]=e[1]+t[1],i[2]=e[2]+t[2],i[3]=e[3]+t[3],i[4]=e[4]+t[4],i[5]=e[5]+t[5],i[6]=e[6]+t[6],i[7]=e[7]+t[7],i[8]=e[8]+t[8],i[9]=e[9]+t[9],i[10]=e[10]+t[10],i[11]=e[11]+t[11],i[12]=e[12]+t[12],i[13]=e[13]+t[13],i[14]=e[14]+t[14],i[15]=e[15]+t[15],i},Se.subtract=function(e,t,i){return x.a.typeOf.object("left",e),x.a.typeOf.object("right",t),x.a.typeOf.object("result",i),i[0]=e[0]-t[0],i[1]=e[1]-t[1],i[2]=e[2]-t[2],i[3]=e[3]-t[3],i[4]=e[4]-t[4],i[5]=e[5]-t[5],i[6]=e[6]-t[6],i[7]=e[7]-t[7],i[8]=e[8]-t[8],i[9]=e[9]-t[9],i[10]=e[10]-t[10],i[11]=e[11]-t[11],i[12]=e[12]-t[12],i[13]=e[13]-t[13],i[14]=e[14]-t[14],i[15]=e[15]-t[15],i},Se.multiplyTransformation=function(e,t,i){x.a.typeOf.object("left",e),x.a.typeOf.object("right",t),x.a.typeOf.object("result",i);var n=e[0],r=e[1],a=e[2],o=e[4],s=e[5],c=e[6],l=e[8],u=e[9],h=e[10],d=e[12],f=e[13],p=e[14],m=t[0],_=t[1],g=t[2],v=t[4],b=t[5],y=t[6],w=t[8],O=t[9],E=t[10],T=t[12],C=t[13],S=t[14],A=n*m+o*_+l*g,P=r*m+s*_+u*g,I=a*m+c*_+h*g,D=n*v+o*b+l*y,j=r*v+s*b+u*y,M=a*v+c*b+h*y,R=n*w+o*O+l*E,L=r*w+s*O+u*E,N=a*w+c*O+h*E,F=n*T+o*C+l*S+d,k=r*T+s*C+u*S+f,B=a*T+c*C+h*S+p;return i[0]=A,i[1]=P,i[2]=I,i[3]=0,i[4]=D,i[5]=j,i[6]=M,i[7]=0,i[8]=R,i[9]=L,i[10]=N,i[11]=0,i[12]=F,i[13]=k,i[14]=B,i[15]=1,i},Se.multiplyByMatrix3=function(e,t,i){x.a.typeOf.object("matrix",e),x.a.typeOf.object("rotation",t),x.a.typeOf.object("result",i);var n=e[0],r=e[1],a=e[2],o=e[4],s=e[5],c=e[6],l=e[8],u=e[9],h=e[10],d=t[0],f=t[1],p=t[2],m=t[3],_=t[4],g=t[5],v=t[6],b=t[7],y=t[8],w=n*d+o*f+l*p,O=r*d+s*f+u*p,E=a*d+c*f+h*p,T=n*m+o*_+l*g,C=r*m+s*_+u*g,S=a*m+c*_+h*g,A=n*v+o*b+l*y,P=r*v+s*b+u*y,I=a*v+c*b+h*y;return i[0]=w,i[1]=O,i[2]=E,i[3]=0,i[4]=T,i[5]=C,i[6]=S,i[7]=0,i[8]=A,i[9]=P,i[10]=I,i[11]=0,i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15],i},Se.multiplyByTranslation=function(e,t,i){x.a.typeOf.object("matrix",e),x.a.typeOf.object("translation",t),x.a.typeOf.object("result",i);var n=t.x,r=t.y,a=t.z,o=n*e[0]+r*e[4]+a*e[8]+e[12],s=n*e[1]+r*e[5]+a*e[9]+e[13],c=n*e[2]+r*e[6]+a*e[10]+e[14];return i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i[4]=e[4],i[5]=e[5],i[6]=e[6],i[7]=e[7],i[8]=e[8],i[9]=e[9],i[10]=e[10],i[11]=e[11],i[12]=o,i[13]=s,i[14]=c,i[15]=e[15],i};var Re=new z;Se.multiplyByUniformScale=function(e,t,i){return x.a.typeOf.object("matrix",e),x.a.typeOf.number("scale",t),x.a.typeOf.object("result",i),Re.x=t,Re.y=t,Re.z=t,Se.multiplyByScale(e,Re,i)},Se.multiplyByScale=function(e,t,i){x.a.typeOf.object("matrix",e),x.a.typeOf.object("scale",t),x.a.typeOf.object("result",i);var n=t.x,r=t.y,a=t.z;return 1===n&&1===r&&1===a?Se.clone(e,i):(i[0]=n*e[0],i[1]=n*e[1],i[2]=n*e[2],i[3]=0,i[4]=r*e[4],i[5]=r*e[5],i[6]=r*e[6],i[7]=0,i[8]=a*e[8],i[9]=a*e[9],i[10]=a*e[10],i[11]=0,i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=1,i)},Se.multiplyByVector=function(e,t,i){x.a.typeOf.object("matrix",e),x.a.typeOf.object("cartesian",t),x.a.typeOf.object("result",i);var n=t.x,r=t.y,a=t.z,o=t.w,s=e[0]*n+e[4]*r+e[8]*a+e[12]*o,c=e[1]*n+e[5]*r+e[9]*a+e[13]*o,l=e[2]*n+e[6]*r+e[10]*a+e[14]*o,u=e[3]*n+e[7]*r+e[11]*a+e[15]*o;return i.x=s,i.y=c,i.z=l,i.w=u,i},Se.multiplyByPointAsVector=function(e,t,i){x.a.typeOf.object("matrix",e),x.a.typeOf.object("cartesian",t),x.a.typeOf.object("result",i);var n=t.x,r=t.y,a=t.z,o=e[0]*n+e[4]*r+e[8]*a,s=e[1]*n+e[5]*r+e[9]*a,c=e[2]*n+e[6]*r+e[10]*a;return i.x=o,i.y=s,i.z=c,i},Se.multiplyByPoint=function(e,t,i){x.a.typeOf.object("matrix",e),x.a.typeOf.object("cartesian",t),x.a.typeOf.object("result",i);var n=t.x,r=t.y,a=t.z,o=e[0]*n+e[4]*r+e[8]*a+e[12],s=e[1]*n+e[5]*r+e[9]*a+e[13],c=e[2]*n+e[6]*r+e[10]*a+e[14];return i.x=o,i.y=s,i.z=c,i},Se.multiplyByScalar=function(e,t,i){return x.a.typeOf.object("matrix",e),x.a.typeOf.number("scalar",t),x.a.typeOf.object("result",i),i[0]=e[0]*t,i[1]=e[1]*t,i[2]=e[2]*t,i[3]=e[3]*t,i[4]=e[4]*t,i[5]=e[5]*t,i[6]=e[6]*t,i[7]=e[7]*t,i[8]=e[8]*t,i[9]=e[9]*t,i[10]=e[10]*t,i[11]=e[11]*t,i[12]=e[12]*t,i[13]=e[13]*t,i[14]=e[14]*t,i[15]=e[15]*t,i},Se.negate=function(e,t){return x.a.typeOf.object("matrix",e),x.a.typeOf.object("result",t),t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t[4]=-e[4],t[5]=-e[5],t[6]=-e[6],t[7]=-e[7],t[8]=-e[8],t[9]=-e[9],t[10]=-e[10],t[11]=-e[11],t[12]=-e[12],t[13]=-e[13],t[14]=-e[14],t[15]=-e[15],t},Se.transpose=function(e,t){x.a.typeOf.object("matrix",e),x.a.typeOf.object("result",t);var i=e[1],n=e[2],r=e[3],a=e[6],o=e[7],s=e[11];return t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=i,t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=n,t[9]=a,t[10]=e[10],t[11]=e[14],t[12]=r,t[13]=o,t[14]=s,t[15]=e[15],t},Se.abs=function(e,t){return x.a.typeOf.object("matrix",e),x.a.typeOf.object("result",t),t[0]=Math.abs(e[0]),t[1]=Math.abs(e[1]),t[2]=Math.abs(e[2]),t[3]=Math.abs(e[3]),t[4]=Math.abs(e[4]),t[5]=Math.abs(e[5]),t[6]=Math.abs(e[6]),t[7]=Math.abs(e[7]),t[8]=Math.abs(e[8]),t[9]=Math.abs(e[9]),t[10]=Math.abs(e[10]),t[11]=Math.abs(e[11]),t[12]=Math.abs(e[12]),t[13]=Math.abs(e[13]),t[14]=Math.abs(e[14]),t[15]=Math.abs(e[15]),t},Se.equals=function(e,t){return e===t||Object(u.a)(e)&&Object(u.a)(t)&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[3]===t[3]&&e[7]===t[7]&&e[11]===t[11]&&e[15]===t[15]},Se.equalsEpsilon=function(e,t,i){return x.a.typeOf.number("epsilon",i),e===t||Object(u.a)(e)&&Object(u.a)(t)&&Math.abs(e[0]-t[0])<=i&&Math.abs(e[1]-t[1])<=i&&Math.abs(e[2]-t[2])<=i&&Math.abs(e[3]-t[3])<=i&&Math.abs(e[4]-t[4])<=i&&Math.abs(e[5]-t[5])<=i&&Math.abs(e[6]-t[6])<=i&&Math.abs(e[7]-t[7])<=i&&Math.abs(e[8]-t[8])<=i&&Math.abs(e[9]-t[9])<=i&&Math.abs(e[10]-t[10])<=i&&Math.abs(e[11]-t[11])<=i&&Math.abs(e[12]-t[12])<=i&&Math.abs(e[13]-t[13])<=i&&Math.abs(e[14]-t[14])<=i&&Math.abs(e[15]-t[15])<=i},Se.getTranslation=function(e,t){return x.a.typeOf.object("matrix",e),x.a.typeOf.object("result",t),t.x=e[12],t.y=e[13],t.z=e[14],t},Se.getRotation=function(e,t){return x.a.typeOf.object("matrix",e),x.a.typeOf.object("result",t),t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t};var Le=new be,Ne=new be,Fe=new Te,ke=new Te(0,0,0,1);Se.inverse=function(e,t){x.a.typeOf.object("matrix",e),x.a.typeOf.object("result",t);var i=e[0],n=e[4],r=e[8],a=e[12],o=e[1],s=e[5],c=e[9],l=e[13],u=e[2],h=e[6],d=e[10],f=e[14],p=e[3],m=e[7],_=e[11],g=e[15],v=d*g,b=f*_,y=h*g,w=f*m,O=h*_,E=d*m,T=u*g,C=f*p,S=u*_,A=d*p,P=u*m,D=h*p,j=v*s+w*c+O*l-(b*s+y*c+E*l),M=b*o+T*c+A*l-(v*o+C*c+S*l),R=y*o+C*s+P*l-(w*o+T*s+D*l),L=E*o+S*s+D*c-(O*o+A*s+P*c),N=b*n+y*r+E*a-(v*n+w*r+O*a),F=v*i+C*r+S*a-(b*i+T*r+A*a),k=w*i+T*n+D*a-(y*i+C*n+P*a),B=O*i+A*n+P*r-(E*i+S*n+D*r),z=(v=r*l)*m+(w=a*s)*_+(O=n*c)*g-((b=a*c)*m+(y=n*l)*_+(E=r*s)*g),U=b*p+(T=i*l)*_+(A=r*o)*g-(v*p+(C=a*o)*_+(S=i*c)*g),V=y*p+C*m+(P=i*s)*g-(w*p+T*m+(D=n*o)*g),H=E*p+S*m+D*_-(O*p+A*m+P*_),G=y*d+E*f+b*h-(O*f+v*h+w*d),q=S*f+v*u+C*d-(T*d+A*f+b*u),W=T*h+D*f+w*u-(P*f+y*u+C*h),Y=P*d+O*u+A*h-(S*h+D*d+E*u),X=i*j+n*M+r*R+a*L;if(Math.abs(X)<I.EPSILON21){if(be.equalsEpsilon(Se.getRotation(e,Le),Ne,I.EPSILON7)&&Te.equals(Se.getRow(e,3,Fe),ke))return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=0,t[11]=0,t[12]=-e[12],t[13]=-e[13],t[14]=-e[14],t[15]=1,t;throw new Ce.a("matrix is not invertible because its determinate is zero.")}return X=1/X,t[0]=j*X,t[1]=M*X,t[2]=R*X,t[3]=L*X,t[4]=N*X,t[5]=F*X,t[6]=k*X,t[7]=B*X,t[8]=z*X,t[9]=U*X,t[10]=V*X,t[11]=H*X,t[12]=G*X,t[13]=q*X,t[14]=W*X,t[15]=Y*X,t},Se.inverseTransformation=function(e,t){x.a.typeOf.object("matrix",e),x.a.typeOf.object("result",t);var i=e[0],n=e[1],r=e[2],a=e[4],o=e[5],s=e[6],c=e[8],l=e[9],u=e[10],h=e[12],d=e[13],f=e[14],p=-i*h-n*d-r*f,m=-a*h-o*d-s*f,_=-c*h-l*d-u*f;return t[0]=i,t[1]=a,t[2]=c,t[3]=0,t[4]=n,t[5]=o,t[6]=l,t[7]=0,t[8]=r,t[9]=s,t[10]=u,t[11]=0,t[12]=p,t[13]=m,t[14]=_,t[15]=1,t},Se.IDENTITY=Object(E.a)(new Se(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)),Se.ZERO=Object(E.a)(new Se(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)),Se.COLUMN0ROW0=0,Se.COLUMN0ROW1=1,Se.COLUMN0ROW2=2,Se.COLUMN0ROW3=3,Se.COLUMN1ROW0=4,Se.COLUMN1ROW1=5,Se.COLUMN1ROW2=6,Se.COLUMN1ROW3=7,Se.COLUMN2ROW0=8,Se.COLUMN2ROW1=9,Se.COLUMN2ROW2=10,Se.COLUMN2ROW3=11,Se.COLUMN3ROW0=12,Se.COLUMN3ROW1=13,Se.COLUMN3ROW2=14,Se.COLUMN3ROW3=15,Object(O.a)(Se.prototype,{length:{get:function(){return Se.packedLength}}}),Se.prototype.clone=function(e){return Se.clone(this,e)},Se.prototype.equals=function(e){return Se.equals(this,e)},Se.equalsArray=function(e,t,i){return e[0]===t[i]&&e[1]===t[i+1]&&e[2]===t[i+2]&&e[3]===t[i+3]&&e[4]===t[i+4]&&e[5]===t[i+5]&&e[6]===t[i+6]&&e[7]===t[i+7]&&e[8]===t[i+8]&&e[9]===t[i+9]&&e[10]===t[i+10]&&e[11]===t[i+11]&&e[12]===t[i+12]&&e[13]===t[i+13]&&e[14]===t[i+14]&&e[15]===t[i+15]},Se.prototype.equalsEpsilon=function(e,t){return Se.equalsEpsilon(this,e,t)},Se.prototype.toString=function(){return"("+this[0]+", "+this[4]+", "+this[8]+", "+this[12]+")\n("+this[1]+", "+this[5]+", "+this[9]+", "+this[13]+")\n("+this[2]+", "+this[6]+", "+this[10]+", "+this[14]+")\n("+this[3]+", "+this[7]+", "+this[11]+", "+this[15]+")"};var Be=Se;function ze(e,t,i,n){this.west=Object(w.a)(e,0),this.south=Object(w.a)(t,0),this.east=Object(w.a)(i,0),this.north=Object(w.a)(n,0)}Object(O.a)(ze.prototype,{width:{get:function(){return ze.computeWidth(this)}},height:{get:function(){return ze.computeHeight(this)}}}),ze.packedLength=4,ze.pack=function(e,t,i){return x.a.typeOf.object("value",e),x.a.defined("array",t),i=Object(w.a)(i,0),t[i++]=e.west,t[i++]=e.south,t[i++]=e.east,t[i]=e.north,t},ze.unpack=function(e,t,i){return x.a.defined("array",e),t=Object(w.a)(t,0),Object(u.a)(i)||(i=new ze),i.west=e[t++],i.south=e[t++],i.east=e[t++],i.north=e[t],i},ze.computeWidth=function(e){x.a.typeOf.object("rectangle",e);var t=e.east,i=e.west;return t<i&&(t+=I.TWO_PI),t-i},ze.computeHeight=function(e){return x.a.typeOf.object("rectangle",e),e.north-e.south},ze.fromDegrees=function(e,t,i,n,r){return e=I.toRadians(Object(w.a)(e,0)),t=I.toRadians(Object(w.a)(t,0)),i=I.toRadians(Object(w.a)(i,0)),n=I.toRadians(Object(w.a)(n,0)),Object(u.a)(r)?(r.west=e,r.south=t,r.east=i,r.north=n,r):new ze(e,t,i,n)},ze.fromRadians=function(e,t,i,n,r){return Object(u.a)(r)?(r.west=Object(w.a)(e,0),r.south=Object(w.a)(t,0),r.east=Object(w.a)(i,0),r.north=Object(w.a)(n,0),r):new ze(e,t,i,n)},ze.fromCartographicArray=function(e,t){x.a.defined("cartographics",e);for(var i=Number.MAX_VALUE,n=-Number.MAX_VALUE,r=Number.MAX_VALUE,a=-Number.MAX_VALUE,o=Number.MAX_VALUE,s=-Number.MAX_VALUE,c=0,l=e.length;c<l;c++){var h=e[c];i=Math.min(i,h.longitude),n=Math.max(n,h.longitude),o=Math.min(o,h.latitude),s=Math.max(s,h.latitude);var d=h.longitude>=0?h.longitude:h.longitude+I.TWO_PI;r=Math.min(r,d),a=Math.max(a,d)}return n-i>a-r&&(i=r,(n=a)>I.PI&&(n-=I.TWO_PI),i>I.PI&&(i-=I.TWO_PI)),Object(u.a)(t)?(t.west=i,t.south=o,t.east=n,t.north=s,t):new ze(i,o,n,s)},ze.fromCartesianArray=function(e,t,i){x.a.defined("cartesians",e),t=Object(w.a)(t,ae.WGS84);for(var n=Number.MAX_VALUE,r=-Number.MAX_VALUE,a=Number.MAX_VALUE,o=-Number.MAX_VALUE,s=Number.MAX_VALUE,c=-Number.MAX_VALUE,l=0,h=e.length;l<h;l++){var d=t.cartesianToCartographic(e[l]);n=Math.min(n,d.longitude),r=Math.max(r,d.longitude),s=Math.min(s,d.latitude),c=Math.max(c,d.latitude);var f=d.longitude>=0?d.longitude:d.longitude+I.TWO_PI;a=Math.min(a,f),o=Math.max(o,f)}return r-n>o-a&&(n=a,(r=o)>I.PI&&(r-=I.TWO_PI),n>I.PI&&(n-=I.TWO_PI)),Object(u.a)(i)?(i.west=n,i.south=s,i.east=r,i.north=c,i):new ze(n,s,r,c)},ze.clone=function(e,t){if(Object(u.a)(e))return Object(u.a)(t)?(t.west=e.west,t.south=e.south,t.east=e.east,t.north=e.north,t):new ze(e.west,e.south,e.east,e.north)},ze.equalsEpsilon=function(e,t,i){return x.a.typeOf.number("absoluteEpsilon",i),e===t||Object(u.a)(e)&&Object(u.a)(t)&&Math.abs(e.west-t.west)<=i&&Math.abs(e.south-t.south)<=i&&Math.abs(e.east-t.east)<=i&&Math.abs(e.north-t.north)<=i},ze.prototype.clone=function(e){return ze.clone(this,e)},ze.prototype.equals=function(e){return ze.equals(this,e)},ze.equals=function(e,t){return e===t||Object(u.a)(e)&&Object(u.a)(t)&&e.west===t.west&&e.south===t.south&&e.east===t.east&&e.north===t.north},ze.prototype.equalsEpsilon=function(e,t){return x.a.typeOf.number("epsilon",t),ze.equalsEpsilon(this,e,t)},ze.validate=function(e){x.a.typeOf.object("rectangle",e);var t=e.north;x.a.typeOf.number.greaterThanOrEquals("north",t,-I.PI_OVER_TWO),x.a.typeOf.number.lessThanOrEquals("north",t,I.PI_OVER_TWO);var i=e.south;x.a.typeOf.number.greaterThanOrEquals("south",i,-I.PI_OVER_TWO),x.a.typeOf.number.lessThanOrEquals("south",i,I.PI_OVER_TWO);var n=e.west;x.a.typeOf.number.greaterThanOrEquals("west",n,-Math.PI),x.a.typeOf.number.lessThanOrEquals("west",n,Math.PI);var r=e.east;x.a.typeOf.number.greaterThanOrEquals("east",r,-Math.PI),x.a.typeOf.number.lessThanOrEquals("east",r,Math.PI)},ze.southwest=function(e,t){return x.a.typeOf.object("rectangle",e),Object(u.a)(t)?(t.longitude=e.west,t.latitude=e.south,t.height=0,t):new K(e.west,e.south)},ze.northwest=function(e,t){return x.a.typeOf.object("rectangle",e),Object(u.a)(t)?(t.longitude=e.west,t.latitude=e.north,t.height=0,t):new K(e.west,e.north)},ze.northeast=function(e,t){return x.a.typeOf.object("rectangle",e),Object(u.a)(t)?(t.longitude=e.east,t.latitude=e.north,t.height=0,t):new K(e.east,e.north)},ze.southeast=function(e,t){return x.a.typeOf.object("rectangle",e),Object(u.a)(t)?(t.longitude=e.east,t.latitude=e.south,t.height=0,t):new K(e.east,e.south)},ze.center=function(e,t){x.a.typeOf.object("rectangle",e);var i=e.east,n=e.west;i<n&&(i+=I.TWO_PI);var r=I.negativePiToPi(.5*(n+i)),a=.5*(e.south+e.north);return Object(u.a)(t)?(t.longitude=r,t.latitude=a,t.height=0,t):new K(r,a)},ze.intersection=function(e,t,i){x.a.typeOf.object("rectangle",e),x.a.typeOf.object("otherRectangle",t);var n=e.east,r=e.west,a=t.east,o=t.west;n<r&&a>0?n+=I.TWO_PI:a<o&&n>0&&(a+=I.TWO_PI),n<r&&o<0?o+=I.TWO_PI:a<o&&r<0&&(r+=I.TWO_PI);var s=I.negativePiToPi(Math.max(r,o)),c=I.negativePiToPi(Math.min(n,a));if(!((e.west<e.east||t.west<t.east)&&c<=s)){var l=Math.max(e.south,t.south),h=Math.min(e.north,t.north);if(!(l>=h))return Object(u.a)(i)?(i.west=s,i.south=l,i.east=c,i.north=h,i):new ze(s,l,c,h)}},ze.simpleIntersection=function(e,t,i){x.a.typeOf.object("rectangle",e),x.a.typeOf.object("otherRectangle",t);var n=Math.max(e.west,t.west),r=Math.max(e.south,t.south),a=Math.min(e.east,t.east),o=Math.min(e.north,t.north);if(!(r>=o||n>=a))return Object(u.a)(i)?(i.west=n,i.south=r,i.east=a,i.north=o,i):new ze(n,r,a,o)},ze.union=function(e,t,i){x.a.typeOf.object("rectangle",e),x.a.typeOf.object("otherRectangle",t),Object(u.a)(i)||(i=new ze);var n=e.east,r=e.west,a=t.east,o=t.west;n<r&&a>0?n+=I.TWO_PI:a<o&&n>0&&(a+=I.TWO_PI),n<r&&o<0?o+=I.TWO_PI:a<o&&r<0&&(r+=I.TWO_PI);var s=I.convertLongitudeRange(Math.min(r,o)),c=I.convertLongitudeRange(Math.max(n,a));return i.west=s,i.south=Math.min(e.south,t.south),i.east=c,i.north=Math.max(e.north,t.north),i},ze.expand=function(e,t,i){return x.a.typeOf.object("rectangle",e),x.a.typeOf.object("cartographic",t),Object(u.a)(i)||(i=new ze),i.west=Math.min(e.west,t.longitude),i.south=Math.min(e.south,t.latitude),i.east=Math.max(e.east,t.longitude),i.north=Math.max(e.north,t.latitude),i},ze.contains=function(e,t){x.a.typeOf.object("rectangle",e),x.a.typeOf.object("cartographic",t);var i=t.longitude,n=t.latitude,r=e.west,a=e.east;return a<r&&(a+=I.TWO_PI,i<0&&(i+=I.TWO_PI)),(i>r||I.equalsEpsilon(i,r,I.EPSILON14))&&(i<a||I.equalsEpsilon(i,a,I.EPSILON14))&&n>=e.south&&n<=e.north};var Ue=new K;ze.subsample=function(e,t,i,n){x.a.typeOf.object("rectangle",e),t=Object(w.a)(t,ae.WGS84),i=Object(w.a)(i,0),Object(u.a)(n)||(n=[]);var r=0,a=e.north,o=e.south,s=e.east,c=e.west,l=Ue;l.height=i,l.longitude=c,l.latitude=a,n[r]=t.cartographicToCartesian(l,n[r]),r++,l.longitude=s,n[r]=t.cartographicToCartesian(l,n[r]),r++,l.latitude=o,n[r]=t.cartographicToCartesian(l,n[r]),r++,l.longitude=c,n[r]=t.cartographicToCartesian(l,n[r]),r++,l.latitude=a<0?a:o>0?o:0;for(var h=1;h<8;++h)l.longitude=-Math.PI+h*I.PI_OVER_TWO,ze.contains(e,l)&&(n[r]=t.cartographicToCartesian(l,n[r]),r++);return 0===l.latitude&&(l.longitude=c,n[r]=t.cartographicToCartesian(l,n[r]),r++,l.longitude=s,n[r]=t.cartographicToCartesian(l,n[r]),r++),n.length=r,n},ze.MAX_VALUE=Object(E.a)(new ze(-Math.PI,-I.PI_OVER_TWO,Math.PI,I.PI_OVER_TWO));var Ve=ze;function He(e,t){this.center=z.clone(Object(w.a)(e,z.ZERO)),this.radius=Object(w.a)(t,0)}var Ge=new z,qe=new z,We=new z,Ye=new z,Xe=new z,Ze=new z,Qe=new z,Ke=new z,Je=new z,$e=new z,et=new z,tt=new z,it=4/3*I.PI;He.fromPoints=function(e,t){if(Object(u.a)(t)||(t=new He),!Object(u.a)(e)||0===e.length)return t.center=z.clone(z.ZERO,t.center),t.radius=0,t;var i,n=z.clone(e[0],Qe),r=z.clone(n,Ge),a=z.clone(n,qe),o=z.clone(n,We),s=z.clone(n,Ye),c=z.clone(n,Xe),l=z.clone(n,Ze),h=e.length;for(i=1;i<h;i++){z.clone(e[i],n);var d=n.x,f=n.y,p=n.z;d<r.x&&z.clone(n,r),d>s.x&&z.clone(n,s),f<a.y&&z.clone(n,a),f>c.y&&z.clone(n,c),p<o.z&&z.clone(n,o),p>l.z&&z.clone(n,l)}var m=z.magnitudeSquared(z.subtract(s,r,Ke)),_=z.magnitudeSquared(z.subtract(c,a,Ke)),g=z.magnitudeSquared(z.subtract(l,o,Ke)),v=r,b=s,y=m;_>y&&(y=_,v=a,b=c),g>y&&(y=g,v=o,b=l);var w=Je;w.x=.5*(v.x+b.x),w.y=.5*(v.y+b.y),w.z=.5*(v.z+b.z);var O=z.magnitudeSquared(z.subtract(b,w,Ke)),x=Math.sqrt(O),E=$e;E.x=r.x,E.y=a.y,E.z=o.z;var T=et;T.x=s.x,T.y=c.y,T.z=l.z;var C=z.midpoint(E,T,tt),S=0;for(i=0;i<h;i++){z.clone(e[i],n);var A=z.magnitude(z.subtract(n,C,Ke));A>S&&(S=A);var P=z.magnitudeSquared(z.subtract(n,w,Ke));if(P>O){var I=Math.sqrt(P);O=(x=.5*(x+I))*x;var D=I-x;w.x=(x*w.x+D*n.x)/I,w.y=(x*w.y+D*n.y)/I,w.z=(x*w.z+D*n.z)/I}}return x<S?(z.clone(w,t.center),t.radius=x):(z.clone(C,t.center),t.radius=S),t},He.fromInstancePoints=function(e,t,i){if(Object(u.a)(t)||(t=new He),!Object(u.a)(e)||0===i)return t.center=z.clone(z.ZERO,t.center),t.radius=0,t;var n,r=z.clone(e[0],Qe),a=z.clone(r,Ge),o=z.clone(r,qe),s=z.clone(r,We),c=z.clone(r,Ye),l=z.clone(r,Xe),h=z.clone(r,Ze);for(n=1;n<i&&e[n];n++){z.clone(e[n],r);var d=r.x,f=r.y,p=r.z;d<a.x&&z.clone(r,a),d>c.x&&z.clone(r,c),f<o.y&&z.clone(r,o),f>l.y&&z.clone(r,l),p<s.z&&z.clone(r,s),p>h.z&&z.clone(r,h)}var m=z.magnitudeSquared(z.subtract(c,a,Ke)),_=z.magnitudeSquared(z.subtract(l,o,Ke)),g=z.magnitudeSquared(z.subtract(h,s,Ke)),v=a,b=c,y=m;_>y&&(y=_,v=o,b=l),g>y&&(y=g,v=s,b=h);var w=Je;w.x=.5*(v.x+b.x),w.y=.5*(v.y+b.y),w.z=.5*(v.z+b.z);var O=z.magnitudeSquared(z.subtract(b,w,Ke)),x=Math.sqrt(O),E=$e;E.x=a.x,E.y=o.y,E.z=s.z;var T=et;T.x=c.x,T.y=l.y,T.z=h.z;var C=z.midpoint(E,T,tt),S=0;for(n=0;n<i&&e[n];n++){z.clone(e[n],r);var A=z.magnitude(z.subtract(r,C,Ke));A>S&&(S=A);var P=z.magnitudeSquared(z.subtract(r,w,Ke));if(P>O){var I=Math.sqrt(P);O=(x=.5*(x+I))*x;var D=I-x;w.x=(x*w.x+D*r.x)/I,w.y=(x*w.y+D*r.y)/I,w.z=(x*w.z+D*r.z)/I}}return x<S?(z.clone(w,t.center),t.radius=x):(z.clone(C,t.center),t.radius=S),t};var nt=new se,rt=new z,at=new z,ot=new K,st=new K;He.fromRectangle2D=function(e,t,i){return He.fromRectangleWithHeights2D(e,t,0,0,i)},He.fromRectangleWithHeights2D=function(e,t,i,n,r){if(Object(u.a)(r)||(r=new He),!Object(u.a)(e))return r.center=z.clone(z.ZERO,r.center),r.radius=0,r;t=Object(w.a)(t,nt),Ve.southwest(e,ot),ot.height=i,Ve.northeast(e,st),st.height=n;var a=t.project(ot,rt),o=t.project(st,at),s=o.x-a.x,c=o.y-a.y,l=o.z-a.z;r.radius=.5*Math.sqrt(s*s+c*c+l*l);var h=r.center;return h.x=a.x+.5*s,h.y=a.y+.5*c,h.z=a.z+.5*l,r};var ct=[];He.fromRectangle3D=function(e,t,i,n){if(t=Object(w.a)(t,ae.WGS84),i=Object(w.a)(i,0),Object(u.a)(n)||(n=new He),!Object(u.a)(e))return n.center=z.clone(z.ZERO,n.center),n.radius=0,n;var r=Ve.subsample(e,t,i,ct);return He.fromPoints(r,n)},He.fromVertices=function(e,t,i,n){if(Object(u.a)(n)||(n=new He),!Object(u.a)(e)||0===e.length)return n.center=z.clone(z.ZERO,n.center),n.radius=0,n;t=Object(w.a)(t,z.ZERO),i=Object(w.a)(i,3),x.a.typeOf.number.greaterThanOrEquals("stride",i,3);var r=Qe;r.x=e[0]+t.x,r.y=e[1]+t.y,r.z=e[2]+t.z;var a,o=z.clone(r,Ge),s=z.clone(r,qe),c=z.clone(r,We),l=z.clone(r,Ye),h=z.clone(r,Xe),d=z.clone(r,Ze),f=e.length;for(a=0;a<f;a+=i){var p=e[a]+t.x,m=e[a+1]+t.y,_=e[a+2]+t.z;r.x=p,r.y=m,r.z=_,p<o.x&&z.clone(r,o),p>l.x&&z.clone(r,l),m<s.y&&z.clone(r,s),m>h.y&&z.clone(r,h),_<c.z&&z.clone(r,c),_>d.z&&z.clone(r,d)}var g=z.magnitudeSquared(z.subtract(l,o,Ke)),v=z.magnitudeSquared(z.subtract(h,s,Ke)),b=z.magnitudeSquared(z.subtract(d,c,Ke)),y=o,O=l,E=g;v>E&&(E=v,y=s,O=h),b>E&&(E=b,y=c,O=d);var T=Je;T.x=.5*(y.x+O.x),T.y=.5*(y.y+O.y),T.z=.5*(y.z+O.z);var C=z.magnitudeSquared(z.subtract(O,T,Ke)),S=Math.sqrt(C),A=$e;A.x=o.x,A.y=s.y,A.z=c.z;var P=et;P.x=l.x,P.y=h.y,P.z=d.z;var I=z.midpoint(A,P,tt),D=0;for(a=0;a<f;a+=i){r.x=e[a]+t.x,r.y=e[a+1]+t.y,r.z=e[a+2]+t.z;var j=z.magnitude(z.subtract(r,I,Ke));j>D&&(D=j);var M=z.magnitudeSquared(z.subtract(r,T,Ke));if(M>C){var R=Math.sqrt(M);C=(S=.5*(S+R))*S;var L=R-S;T.x=(S*T.x+L*r.x)/R,T.y=(S*T.y+L*r.y)/R,T.z=(S*T.z+L*r.z)/R}}return S<D?(z.clone(T,n.center),n.radius=S):(z.clone(I,n.center),n.radius=D),n},He.fromEncodedCartesianVertices=function(e,t,i){if(Object(u.a)(i)||(i=new He),!Object(u.a)(e)||!Object(u.a)(t)||e.length!==t.length||0===e.length)return i.center=z.clone(z.ZERO,i.center),i.radius=0,i;var n=Qe;n.x=e[0]+t[0],n.y=e[1]+t[1],n.z=e[2]+t[2];var r,a=z.clone(n,Ge),o=z.clone(n,qe),s=z.clone(n,We),c=z.clone(n,Ye),l=z.clone(n,Xe),h=z.clone(n,Ze),d=e.length;for(r=0;r<d;r+=3){var f=e[r]+t[r],p=e[r+1]+t[r+1],m=e[r+2]+t[r+2];n.x=f,n.y=p,n.z=m,f<a.x&&z.clone(n,a),f>c.x&&z.clone(n,c),p<o.y&&z.clone(n,o),p>l.y&&z.clone(n,l),m<s.z&&z.clone(n,s),m>h.z&&z.clone(n,h)}var _=z.magnitudeSquared(z.subtract(c,a,Ke)),g=z.magnitudeSquared(z.subtract(l,o,Ke)),v=z.magnitudeSquared(z.subtract(h,s,Ke)),b=a,y=c,w=_;g>w&&(w=g,b=o,y=l),v>w&&(w=v,b=s,y=h);var O=Je;O.x=.5*(b.x+y.x),O.y=.5*(b.y+y.y),O.z=.5*(b.z+y.z);var x=z.magnitudeSquared(z.subtract(y,O,Ke)),E=Math.sqrt(x),T=$e;T.x=a.x,T.y=o.y,T.z=s.z;var C=et;C.x=c.x,C.y=l.y,C.z=h.z;var S=z.midpoint(T,C,tt),A=0;for(r=0;r<d;r+=3){n.x=e[r]+t[r],n.y=e[r+1]+t[r+1],n.z=e[r+2]+t[r+2];var P=z.magnitude(z.subtract(n,S,Ke));P>A&&(A=P);var I=z.magnitudeSquared(z.subtract(n,O,Ke));if(I>x){var D=Math.sqrt(I);x=(E=.5*(E+D))*E;var j=D-E;O.x=(E*O.x+j*n.x)/D,O.y=(E*O.y+j*n.y)/D,O.z=(E*O.z+j*n.z)/D}}return E<A?(z.clone(O,i.center),i.radius=E):(z.clone(S,i.center),i.radius=A),i},He.fromCornerPoints=function(e,t,i){x.a.typeOf.object("corner",e),x.a.typeOf.object("oppositeCorner",t),Object(u.a)(i)||(i=new He);var n=z.midpoint(e,t,i.center);return i.radius=z.distance(n,t),i},He.fromEllipsoid=function(e,t){return x.a.typeOf.object("ellipsoid",e),Object(u.a)(t)||(t=new He),z.clone(z.ZERO,t.center),t.radius=e.maximumRadius,t};var lt=new z;He.fromBoundingSpheres=function(e,t){if(Object(u.a)(t)||(t=new He),!Object(u.a)(e)||0===e.length)return t.center=z.clone(z.ZERO,t.center),t.radius=0,t;var i=e.length;if(1===i)return He.clone(e[0],t);if(2===i)return He.union(e[0],e[1],t);var n,r=[];for(n=0;n<i;n++)r.push(e[n].center);var a=(t=He.fromPoints(r,t)).center,o=t.radius;for(n=0;n<i;n++){var s=e[n];o=Math.max(o,z.distance(a,s.center,lt)+s.radius)}return t.radius=o,t};var ut=new z,ht=new z,dt=new z;He.fromOrientedBoundingBox=function(e,t){x.a.defined("orientedBoundingBox",e),Object(u.a)(t)||(t=new He);var i=e.halfAxes,n=be.getColumn(i,0,ut),r=be.getColumn(i,1,ht),a=be.getColumn(i,2,dt);return z.add(n,r,n),z.add(n,a,n),t.center=z.clone(e.center,t.center),t.radius=z.magnitude(n),t},He.clone=function(e,t){if(Object(u.a)(e))return Object(u.a)(t)?(t.center=z.clone(e.center,t.center),t.radius=e.radius,t):new He(e.center,e.radius)},He.packedLength=4,He.pack=function(e,t,i){x.a.typeOf.object("value",e),x.a.defined("array",t),i=Object(w.a)(i,0);var n=e.center;return t[i++]=n.x,t[i++]=n.y,t[i++]=n.z,t[i]=e.radius,t},He.unpack=function(e,t,i){x.a.defined("array",e),t=Object(w.a)(t,0),Object(u.a)(i)||(i=new He);var n=i.center;return n.x=e[t++],n.y=e[t++],n.z=e[t++],i.radius=e[t],i};var ft=new z,pt=new z;He.union=function(e,t,i){x.a.typeOf.object("left",e),x.a.typeOf.object("right",t),Object(u.a)(i)||(i=new He);var n=e.center,r=e.radius,a=t.center,o=t.radius,s=z.subtract(a,n,ft),c=z.magnitude(s);if(r>=c+o)return e.clone(i),i;if(o>=c+r)return t.clone(i),i;var l=.5*(r+c+o),h=z.multiplyByScalar(s,(-r+l)/c,pt);return z.add(h,n,h),z.clone(h,i.center),i.radius=l,i};var mt=new z;He.expand=function(e,t,i){x.a.typeOf.object("sphere",e),x.a.typeOf.object("point",t),i=He.clone(e,i);var n=z.magnitude(z.subtract(t,i.center,mt));return n>i.radius&&(i.radius=n),i},He.intersectPlane=function(e,t){x.a.typeOf.object("sphere",e),x.a.typeOf.object("plane",t);var i=e.center,n=e.radius,r=t.normal,a=z.dot(r,i)+t.distance;return a<-n?ce.OUTSIDE:a<n?ce.INTERSECTING:ce.INSIDE},He.transform=function(e,t,i){return x.a.typeOf.object("sphere",e),x.a.typeOf.object("transform",t),Object(u.a)(i)||(i=new He),i.center=Be.multiplyByPoint(t,e.center,i.center),i.radius=Be.getMaximumScale(t)*e.radius,i};var _t=new z;He.distanceSquaredTo=function(e,t){x.a.typeOf.object("sphere",e),x.a.typeOf.object("cartesian",t);var i=z.subtract(e.center,t,_t);return z.magnitudeSquared(i)-e.radius*e.radius},He.transformWithoutScale=function(e,t,i){return x.a.typeOf.object("sphere",e),x.a.typeOf.object("transform",t),Object(u.a)(i)||(i=new He),i.center=Be.multiplyByPoint(t,e.center,i.center),i.radius=e.radius,i};var gt=new z;He.computePlaneDistances=function(e,t,i,n){x.a.typeOf.object("sphere",e),x.a.typeOf.object("position",t),x.a.typeOf.object("direction",i),Object(u.a)(n)||(n=new le);var r=z.subtract(e.center,t,gt),a=z.dot(i,r);return n.start=a-e.radius,n.stop=a+e.radius,n};for(var vt=new z,bt=new z,yt=new z,wt=new z,Ot=new z,xt=new K,Et=new Array(8),Tt=0;Tt<8;++Tt)Et[Tt]=new z;var Ct=new se;He.projectTo2D=function(e,t,i){x.a.typeOf.object("sphere",e);var n=(t=Object(w.a)(t,Ct)).ellipsoid,r=e.center,a=e.radius,o=n.geodeticSurfaceNormal(r,vt),s=z.cross(z.UNIT_Z,o,bt);z.normalize(s,s);var c=z.cross(o,s,yt);z.normalize(c,c),z.multiplyByScalar(o,a,o),z.multiplyByScalar(c,a,c),z.multiplyByScalar(s,a,s);var l=z.negate(c,Ot),u=z.negate(s,wt),h=Et,d=h[0];z.add(o,c,d),z.add(d,s,d),d=h[1],z.add(o,c,d),z.add(d,u,d),d=h[2],z.add(o,l,d),z.add(d,u,d),d=h[3],z.add(o,l,d),z.add(d,s,d),z.negate(o,o),d=h[4],z.add(o,c,d),z.add(d,s,d),d=h[5],z.add(o,c,d),z.add(d,u,d),d=h[6],z.add(o,l,d),z.add(d,u,d),d=h[7],z.add(o,l,d),z.add(d,s,d);for(var f=h.length,p=0;p<f;++p){var m=h[p];z.add(r,m,m);var _=n.cartesianToCartographic(m,xt);t.project(_,m)}var g=(r=(i=He.fromPoints(h,i)).center).x,v=r.y,b=r.z;return r.x=b,r.y=g,r.z=v,i},He.isOccluded=function(e,t){return x.a.typeOf.object("sphere",e),x.a.typeOf.object("occluder",t),!t.isBoundingSphereVisible(e)},He.equals=function(e,t){return e===t||Object(u.a)(e)&&Object(u.a)(t)&&z.equals(e.center,t.center)&&e.radius===t.radius},He.prototype.intersectPlane=function(e){return He.intersectPlane(this,e)},He.prototype.distanceSquaredTo=function(e){return He.distanceSquaredTo(this,e)},He.prototype.computePlaneDistances=function(e,t,i){return He.computePlaneDistances(this,e,t,i)},He.prototype.isOccluded=function(e){return He.isOccluded(this,e)},He.prototype.equals=function(e){return He.equals(this,e)},He.prototype.clone=function(e){return He.clone(this,e)},He.prototype.volume=function(){var e=this.radius;return it*e*e*e};var St=He;function At(e,t){this.x=Object(w.a)(e,0),this.y=Object(w.a)(t,0)}At.fromElements=function(e,t,i){return Object(u.a)(i)?(i.x=e,i.y=t,i):new At(e,t)},At.clone=function(e,t){if(Object(u.a)(e))return Object(u.a)(t)?(t.x=e.x,t.y=e.y,t):new At(e.x,e.y)},At.fromCartesian3=At.clone,At.fromCartesian4=At.clone,At.packedLength=2,At.pack=function(e,t,i){return x.a.typeOf.object("value",e),x.a.defined("array",t),i=Object(w.a)(i,0),t[i++]=e.x,t[i]=e.y,t},At.unpack=function(e,t,i){return x.a.defined("array",e),t=Object(w.a)(t,0),Object(u.a)(i)||(i=new At),i.x=e[t++],i.y=e[t],i},At.packArray=function(e,t){x.a.defined("array",e);var i=e.length;Object(u.a)(t)?t.length=2*i:t=new Array(2*i);for(var n=0;n<i;++n)At.pack(e[n],t,2*n);return t},At.unpackArray=function(e,t){x.a.defined("array",e);var i=e.length;Object(u.a)(t)?t.length=i/2:t=new Array(i/2);for(var n=0;n<i;n+=2){var r=n/2;t[r]=At.unpack(e,n,t[r])}return t},At.fromArray=At.unpack,At.maximumComponent=function(e){return x.a.typeOf.object("cartesian",e),Math.max(e.x,e.y)},At.minimumComponent=function(e){return x.a.typeOf.object("cartesian",e),Math.min(e.x,e.y)},At.minimumByComponent=function(e,t,i){return x.a.typeOf.object("first",e),x.a.typeOf.object("second",t),x.a.typeOf.object("result",i),i.x=Math.min(e.x,t.x),i.y=Math.min(e.y,t.y),i},At.maximumByComponent=function(e,t,i){return x.a.typeOf.object("first",e),x.a.typeOf.object("second",t),x.a.typeOf.object("result",i),i.x=Math.max(e.x,t.x),i.y=Math.max(e.y,t.y),i},At.magnitudeSquared=function(e){return x.a.typeOf.object("cartesian",e),e.x*e.x+e.y*e.y},At.magnitude=function(e){return Math.sqrt(At.magnitudeSquared(e))};var Pt=new At;At.distance=function(e,t){return x.a.typeOf.object("left",e),x.a.typeOf.object("right",t),At.subtract(e,t,Pt),At.magnitude(Pt)},At.distanceSquared=function(e,t){return x.a.typeOf.object("left",e),x.a.typeOf.object("right",t),At.subtract(e,t,Pt),At.magnitudeSquared(Pt)},At.normalize=function(e,t){x.a.typeOf.object("cartesian",e),x.a.typeOf.object("result",t);var i=At.magnitude(e);if(t.x=e.x/i,t.y=e.y/i,isNaN(t.x)||isNaN(t.y))throw new h.a("normalized result is not a number");return t},At.dot=function(e,t){return x.a.typeOf.object("left",e),x.a.typeOf.object("right",t),e.x*t.x+e.y*t.y},At.multiplyComponents=function(e,t,i){return x.a.typeOf.object("left",e),x.a.typeOf.object("right",t),x.a.typeOf.object("result",i),i.x=e.x*t.x,i.y=e.y*t.y,i},At.divideComponents=function(e,t,i){return x.a.typeOf.object("left",e),x.a.typeOf.object("right",t),x.a.typeOf.object("result",i),i.x=e.x/t.x,i.y=e.y/t.y,i},At.add=function(e,t,i){return x.a.typeOf.object("left",e),x.a.typeOf.object("right",t),x.a.typeOf.object("result",i),i.x=e.x+t.x,i.y=e.y+t.y,i},At.subtract=function(e,t,i){return x.a.typeOf.object("left",e),x.a.typeOf.object("right",t),x.a.typeOf.object("result",i),i.x=e.x-t.x,i.y=e.y-t.y,i},At.multiplyByScalar=function(e,t,i){return x.a.typeOf.object("cartesian",e),x.a.typeOf.number("scalar",t),x.a.typeOf.object("result",i),i.x=e.x*t,i.y=e.y*t,i},At.divideByScalar=function(e,t,i){return x.a.typeOf.object("cartesian",e),x.a.typeOf.number("scalar",t),x.a.typeOf.object("result",i),i.x=e.x/t,i.y=e.y/t,i},At.negate=function(e,t){return x.a.typeOf.object("cartesian",e),x.a.typeOf.object("result",t),t.x=-e.x,t.y=-e.y,t},At.abs=function(e,t){return x.a.typeOf.object("cartesian",e),x.a.typeOf.object("result",t),t.x=Math.abs(e.x),t.y=Math.abs(e.y),t};var It=new At;At.lerp=function(e,t,i,n){return x.a.typeOf.object("start",e),x.a.typeOf.object("end",t),x.a.typeOf.number("t",i),x.a.typeOf.object("result",n),At.multiplyByScalar(t,i,It),n=At.multiplyByScalar(e,1-i,n),At.add(It,n,n)};var Dt=new At,jt=new At;At.angleBetween=function(e,t){return x.a.typeOf.object("left",e),x.a.typeOf.object("right",t),At.normalize(e,Dt),At.normalize(t,jt),I.acosClamped(At.dot(Dt,jt))};var Mt=new At;At.mostOrthogonalAxis=function(e,t){x.a.typeOf.object("cartesian",e),x.a.typeOf.object("result",t);var i=At.normalize(e,Mt);return At.abs(i,i),t=i.x<=i.y?At.clone(At.UNIT_X,t):At.clone(At.UNIT_Y,t)},At.equals=function(e,t){return e===t||Object(u.a)(e)&&Object(u.a)(t)&&e.x===t.x&&e.y===t.y},At.equalsArray=function(e,t,i){return e.x===t[i]&&e.y===t[i+1]},At.equalsEpsilon=function(e,t,i,n){return e===t||Object(u.a)(e)&&Object(u.a)(t)&&I.equalsEpsilon(e.x,t.x,i,n)&&I.equalsEpsilon(e.y,t.y,i,n)},At.ZERO=Object(E.a)(new At(0,0)),At.UNIT_X=Object(E.a)(new At(1,0)),At.UNIT_Y=Object(E.a)(new At(0,1)),At.prototype.clone=function(e){return At.clone(this,e)},At.prototype.equals=function(e){return At.equals(this,e)},At.prototype.equalsEpsilon=function(e,t,i){return At.equalsEpsilon(this,e,t,i)},At.prototype.toString=function(){return"("+this.x+", "+this.y+")"};var Rt=At;function Lt(e){e=Object(w.a)(e,{}),this._ellipsoid=Object(w.a)(e.ellipsoid,ae.WGS84),this._rectangle=Object(w.a)(e.rectangle,Ve.MAX_VALUE),this._projection=new se(this._ellipsoid),this._numberOfLevelZeroTilesX=Object(w.a)(e.numberOfLevelZeroTilesX,2),this._numberOfLevelZeroTilesY=Object(w.a)(e.numberOfLevelZeroTilesY,1)}Object(O.a)(Lt.prototype,{ellipsoid:{get:function(){return this._ellipsoid}},rectangle:{get:function(){return this._rectangle}},projection:{get:function(){return this._projection}}}),Lt.prototype.getNumberOfXTilesAtLevel=function(e){return this._numberOfLevelZeroTilesX<<e},Lt.prototype.getNumberOfYTilesAtLevel=function(e){return this._numberOfLevelZeroTilesY<<e},Lt.prototype.rectangleToNativeRectangle=function(e,t){x.a.defined("rectangle",e);var i=I.toDegrees(e.west),n=I.toDegrees(e.south),r=I.toDegrees(e.east),a=I.toDegrees(e.north);return Object(u.a)(t)?(t.west=i,t.south=n,t.east=r,t.north=a,t):new Ve(i,n,r,a)},Lt.prototype.tileXYToNativeRectangle=function(e,t,i,n){var r=this.tileXYToRectangle(e,t,i,n);return r.west=I.toDegrees(r.west),r.south=I.toDegrees(r.south),r.east=I.toDegrees(r.east),r.north=I.toDegrees(r.north),r},Lt.prototype.tileXYToRectangle=function(e,t,i,n){var r=this._rectangle,a=this.getNumberOfXTilesAtLevel(i),o=this.getNumberOfYTilesAtLevel(i),s=r.width/a,c=e*s+r.west,l=(e+1)*s+r.west,h=r.height/o,d=r.north-t*h,f=r.north-(t+1)*h;return Object(u.a)(n)||(n=new Ve(c,f,l,d)),n.west=c,n.south=f,n.east=l,n.north=d,n},Lt.prototype.positionToTileXY=function(e,t,i){var n=this._rectangle;if(Ve.contains(n,e)){var r=this.getNumberOfXTilesAtLevel(t),a=this.getNumberOfYTilesAtLevel(t),o=n.width/r,s=n.height/a,c=e.longitude;n.east<n.west&&(c+=I.TWO_PI);var l=(c-n.west)/o|0;l>=r&&(l=r-1);var h=(n.north-e.latitude)/s|0;return h>=a&&(h=a-1),Object(u.a)(i)?(i.x=l,i.y=h,i):new Rt(l,h)}};var Nt=Lt,Ft=new z,kt=new z,Bt=new K,zt=new z,Ut=new z,Vt=new St,Ht=new Nt,Gt=[new K,new K,new K,new K],qt=new Rt,Wt={};function Yt(e){K.fromRadians(e.east,e.north,0,Gt[0]),K.fromRadians(e.west,e.north,0,Gt[1]),K.fromRadians(e.east,e.south,0,Gt[2]),K.fromRadians(e.west,e.south,0,Gt[3]);var t,i=0,n=0,r=0,a=0,o=Wt._terrainHeightsMaxLevel;for(t=0;t<=o;++t){for(var s=!1,c=0;c<4;++c){var l=Gt[c];if(Ht.positionToTileXY(l,t,qt),0===c)r=qt.x,a=qt.y;else if(r!==qt.x||a!==qt.y){s=!0;break}}if(s)break;i=r,n=a}if(0!==t)return{x:i,y:n,level:t>o?o:t-1}}Wt.initialize=function(){var e=Wt._initPromise;return Object(u.a)(e)?e:(e=f.a.fetchJson(y("Assets/approximateTerrainHeights.json")).then((function(e){Wt._terrainHeights=e})),Wt._initPromise=e,e)},Wt.getMinimumMaximumHeights=function(e,t){if(x.a.defined("rectangle",e),!Object(u.a)(Wt._terrainHeights))throw new h.a("You must call ApproximateTerrainHeights.initialize and wait for the promise to resolve before using this function");t=Object(w.a)(t,ae.WGS84);var i=Yt(e),n=Wt._defaultMinTerrainHeight,r=Wt._defaultMaxTerrainHeight;if(Object(u.a)(i)){var a=i.level+"-"+i.x+"-"+i.y,o=Wt._terrainHeights[a];Object(u.a)(o)&&(n=o[0],r=o[1]),t.cartographicToCartesian(Ve.northeast(e,Bt),Ft),t.cartographicToCartesian(Ve.southwest(e,Bt),kt),z.midpoint(kt,Ft,zt);var s=t.scaleToGeodeticSurface(zt,Ut);if(Object(u.a)(s)){var c=z.distance(zt,s);n=Math.min(n,-c)}else n=Wt._defaultMinTerrainHeight}return{minimumTerrainHeight:n=Math.max(Wt._defaultMinTerrainHeight,n),maximumTerrainHeight:r}},Wt.getBoundingSphere=function(e,t){if(x.a.defined("rectangle",e),!Object(u.a)(Wt._terrainHeights))throw new h.a("You must call ApproximateTerrainHeights.initialize and wait for the promise to resolve before using this function");t=Object(w.a)(t,ae.WGS84);var i=Yt(e),n=Wt._defaultMaxTerrainHeight;if(Object(u.a)(i)){var r=i.level+"-"+i.x+"-"+i.y,a=Wt._terrainHeights[r];Object(u.a)(a)&&(n=a[1])}var o=St.fromRectangle3D(e,t,0);return St.fromRectangle3D(e,t,n,Vt),St.union(o,Vt,o)},Wt._terrainHeightsMaxLevel=6,Wt._defaultMaxTerrainHeight=9e3,Wt._defaultMinTerrainHeight=-1e5,Wt._terrainHeights=void 0,Wt._initPromise=void 0,Object(O.a)(Wt,{initialized:{get:function(){return Object(u.a)(Wt._terrainHeights)}}});var Xt=Wt,Zt=Object(E.a)({NONE:0,GEODESIC:1,RHUMB:2});var Qt=function(e,t,i,n){if(x.a.defined("array",e),x.a.defined("value",t),Object(u.a)(i)&&x.a.typeOf.number("start",i),Object(u.a)(n)&&x.a.typeOf.number("end",n),"function"==typeof e.fill)return e.fill(t,i,n);for(var r=e.length>>>0,a=Object(w.a)(i,0),o=a<0?Math.max(r+a,0):Math.min(a,r),s=Object(w.a)(n,r),c=s<0?Math.max(r+s,0):Math.min(s,r);o<c;)e[o]=t,o++;return e},Kt=I.EPSILON10;var Jt,$t=function(e,t,i){if(x.a.defined("equalsEpsilon",t),Object(u.a)(e)){i=Object(w.a)(i,!1);var n,r,a,o=e.length;if(o<2)return e;for(n=1;n<o&&!t(r=e[n-1],a=e[n],Kt);++n);if(n===o)return i&&t(e[0],e[e.length-1],Kt)?e.slice(1):e;for(var s=e.slice(0,n);n<o;++n)t(r,a=e[n],Kt)||(s.push(a),r=a);return i&&s.length>1&&t(s[0],s[s.length-1],Kt)&&s.shift(),s}},ei={requestFullscreen:void 0,exitFullscreen:void 0,fullscreenEnabled:void 0,fullscreenElement:void 0,fullscreenchange:void 0,fullscreenerror:void 0},ti={};Object(O.a)(ti,{element:{get:function(){if(ti.supportsFullscreen())return document[ei.fullscreenElement]}},changeEventName:{get:function(){if(ti.supportsFullscreen())return ei.fullscreenchange}},errorEventName:{get:function(){if(ti.supportsFullscreen())return ei.fullscreenerror}},enabled:{get:function(){if(ti.supportsFullscreen())return document[ei.fullscreenEnabled]}},fullscreen:{get:function(){if(ti.supportsFullscreen())return null!==ti.element}}}),ti.supportsFullscreen=function(){if(Object(u.a)(Jt))return Jt;Jt=!1;var e=document.body;if("function"==typeof e.requestFullscreen)return ei.requestFullscreen="requestFullscreen",ei.exitFullscreen="exitFullscreen",ei.fullscreenEnabled="fullscreenEnabled",ei.fullscreenElement="fullscreenElement",ei.fullscreenchange="fullscreenchange",ei.fullscreenerror="fullscreenerror",Jt=!0;for(var t,i=["webkit","moz","o","ms","khtml"],n=0,r=i.length;n<r;++n){var a=i[n];"function"==typeof e[t=a+"RequestFullscreen"]?(ei.requestFullscreen=t,Jt=!0):"function"==typeof e[t=a+"RequestFullScreen"]&&(ei.requestFullscreen=t,Jt=!0),t=a+"ExitFullscreen","function"==typeof document[t]?ei.exitFullscreen=t:(t=a+"CancelFullScreen","function"==typeof document[t]&&(ei.exitFullscreen=t)),t=a+"FullscreenEnabled",void 0!==document[t]?ei.fullscreenEnabled=t:(t=a+"FullScreenEnabled",void 0!==document[t]&&(ei.fullscreenEnabled=t)),t=a+"FullscreenElement",void 0!==document[t]?ei.fullscreenElement=t:(t=a+"FullScreenElement",void 0!==document[t]&&(ei.fullscreenElement=t)),t=a+"fullscreenchange",void 0!==document["on"+t]&&("ms"===a&&(t="MSFullscreenChange"),ei.fullscreenchange=t),t=a+"fullscreenerror",void 0!==document["on"+t]&&("ms"===a&&(t="MSFullscreenError"),ei.fullscreenerror=t)}return Jt},ti.requestFullscreen=function(e,t){ti.supportsFullscreen()&&e[ei.requestFullscreen]({vrDisplay:t})},ti.exitFullscreen=function(){ti.supportsFullscreen()&&document[ei.exitFullscreen]()};var ii,ni,ri,ai,oi,si,ci,li,ui,hi,di,fi,pi,mi,_i,gi,vi,bi,yi,wi=ti,Oi=n(8);function xi(e){for(var t=e.split("."),i=0,n=t.length;i<n;++i)t[i]=parseInt(t[i],10);return t}function Ei(){if(!Object(u.a)(ni)&&(ni=!1,!Ai())){var e=/ Chrome\/([\.0-9]+)/.exec(ii.userAgent);null!==e&&(ni=!0,ri=xi(e[1]))}return ni}function Ti(){if(!Object(u.a)(ai)&&(ai=!1,!Ei()&&!Ai()&&/ Safari\/[\.0-9]+/.test(ii.userAgent))){var e=/ Version\/([\.0-9]+)/.exec(ii.userAgent);null!==e&&(ai=!0,oi=xi(e[1]))}return ai}function Ci(){if(!Object(u.a)(si)){si=!1;var e=/ AppleWebKit\/([\.0-9]+)(\+?)/.exec(ii.userAgent);null!==e&&(si=!0,(ci=xi(e[1])).isNightly=!!e[2])}return si}function Si(){var e;Object(u.a)(li)||(li=!1,"Microsoft Internet Explorer"===ii.appName?null!==(e=/MSIE ([0-9]{1,}[\.0-9]{0,})/.exec(ii.userAgent))&&(li=!0,ui=xi(e[1])):"Netscape"===ii.appName&&null!==(e=/Trident\/.*rv:([0-9]{1,}[\.0-9]{0,})/.exec(ii.userAgent))&&(li=!0,ui=xi(e[1])));return li}function Ai(){if(!Object(u.a)(hi)){hi=!1;var e=/ Edge\/([\.0-9]+)/.exec(ii.userAgent);null!==e&&(hi=!0,di=xi(e[1]))}return hi}function Pi(){if(!Object(u.a)(fi)){fi=!1;var e=/Firefox\/([\.0-9]+)/.exec(ii.userAgent);null!==e&&(fi=!0,pi=xi(e[1]))}return fi}function Ii(){if(!Object(u.a)(vi)){var e=document.createElement("canvas");e.setAttribute("style","image-rendering: -moz-crisp-edges;image-rendering: pixelated;");var t=e.style.imageRendering;(vi=Object(u.a)(t)&&""!==t)&&(gi=t)}return vi}function Di(){if(Object(u.a)(yi))return yi.promise;yi=Oi.a.defer(),Ai()&&(bi=!1,yi.resolve(bi));var e=new Image;return e.onload=function(){bi=e.width>0&&e.height>0,yi.resolve(bi)},e.onerror=function(){bi=!1,yi.resolve(bi)},e.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",yi.promise}ii="undefined"!=typeof navigator?navigator:{};var ji=[];"undefined"!=typeof ArrayBuffer&&(ji.push(Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array),"undefined"!=typeof Uint8ClampedArray&&ji.push(Uint8ClampedArray),"undefined"!=typeof CanvasPixelArray&&ji.push(CanvasPixelArray));var Mi={isChrome:Ei,chromeVersion:function(){return Ei()&&ri},isSafari:Ti,safariVersion:function(){return Ti()&&oi},isWebkit:Ci,webkitVersion:function(){return Ci()&&ci},isInternetExplorer:Si,internetExplorerVersion:function(){return Si()&&ui},isEdge:Ai,edgeVersion:function(){return Ai()&&di},isFirefox:Pi,firefoxVersion:function(){return Pi()&&pi},isWindows:function(){return Object(u.a)(mi)||(mi=/Windows/i.test(ii.appVersion)),mi},hardwareConcurrency:Object(w.a)(ii.hardwareConcurrency,3),supportsPointerEvents:function(){return Object(u.a)(_i)||(_i=!Pi()&&"undefined"!=typeof PointerEvent&&(!Object(u.a)(ii.pointerEnabled)||ii.pointerEnabled)),_i},supportsImageRenderingPixelated:Ii,supportsWebP:Di,supportsWebPSync:function(){return Object(u.a)(yi)||Di(),bi},imageRenderingValue:function(){return Ii()?gi:void 0},typedArrayTypes:ji,maxDecodingWorkers:1,supportsFullscreen:function(){return wi.supportsFullscreen()},supportsTypedArrays:function(){return"undefined"!=typeof ArrayBuffer},supportsWebWorkers:function(){return"undefined"!=typeof Worker},supportsWebAssembly:function(){return"undefined"!=typeof WebAssembly&&!Mi.isEdge()}},Ri=Mi;var Li=function(e,t,i){if(x.a.defined("array",e),Object(u.a)(t)&&x.a.typeOf.number("begin",t),Object(u.a)(i)&&x.a.typeOf.number("end",i),"function"==typeof e.slice)return e.slice(t,i);for(var n=Array.prototype.slice.call(e,t,i),r=Ri.typedArrayTypes,a=r.length,o=0;o<a;++o)if(e instanceof r[o]){n=new r[o](n);break}return n};function Ni(){this._array=[],this._hash={}}Object(O.a)(Ni.prototype,{length:{get:function(){return this._array.length}},values:{get:function(){return this._array}}}),Ni.prototype.contains=function(e){if("string"!=typeof e&&"number"!=typeof e)throw new h.a("key is required to be a string or number.");return Object(u.a)(this._hash[e])},Ni.prototype.set=function(e,t){if("string"!=typeof e&&"number"!=typeof e)throw new h.a("key is required to be a string or number.");t!==this._hash[e]&&(this.remove(e),this._hash[e]=t,this._array.push(t))},Ni.prototype.get=function(e){if("string"!=typeof e&&"number"!=typeof e)throw new h.a("key is required to be a string or number.");return this._hash[e]},Ni.prototype.remove=function(e){if(Object(u.a)(e)&&"string"!=typeof e&&"number"!=typeof e)throw new h.a("key is required to be a string or number.");var t=this._hash[e],i=Object(u.a)(t);if(i){var n=this._array;n.splice(n.indexOf(t),1),delete this._hash[e]}return i},Ni.prototype.removeAll=function(){var e=this._array;e.length>0&&(this._hash={},e.length=0)};var Fi=Ni,ki={octEncodeInRange:function(e,t,i){x.a.defined("vector",e),x.a.defined("result",i);var n=z.magnitudeSquared(e);if(Math.abs(n-1)>I.EPSILON6)throw new h.a("vector must be normalized.");if(i.x=e.x/(Math.abs(e.x)+Math.abs(e.y)+Math.abs(e.z)),i.y=e.y/(Math.abs(e.x)+Math.abs(e.y)+Math.abs(e.z)),e.z<0){var r=i.x,a=i.y;i.x=(1-Math.abs(a))*I.signNotZero(r),i.y=(1-Math.abs(r))*I.signNotZero(a)}return i.x=I.toSNorm(i.x,t),i.y=I.toSNorm(i.y,t),i},octEncode:function(e,t){return ki.octEncodeInRange(e,255,t)}},Bi=new Rt,zi=new Uint8Array(1);function Ui(e){return zi[0]=e,zi[0]}ki.octEncodeToCartesian4=function(e,t){return ki.octEncodeInRange(e,65535,Bi),t.x=Ui(Bi.x*(1/256)),t.y=Ui(Bi.x),t.z=Ui(Bi.y*(1/256)),t.w=Ui(Bi.y),t},ki.octDecodeInRange=function(e,t,i,n){if(x.a.defined("result",n),e<0||e>i||t<0||t>i)throw new h.a("x and y must be unsigned normalized integers between 0 and "+i);if(n.x=I.fromSNorm(e,i),n.y=I.fromSNorm(t,i),n.z=1-(Math.abs(n.x)+Math.abs(n.y)),n.z<0){var r=n.x;n.x=(1-Math.abs(n.y))*I.signNotZero(r),n.y=(1-Math.abs(r))*I.signNotZero(n.y)}return z.normalize(n,n)},ki.octDecode=function(e,t,i){return ki.octDecodeInRange(e,t,255,i)},ki.octDecodeFromCartesian4=function(e,t){x.a.typeOf.object("encoded",e),x.a.typeOf.object("result",t);var i=e.x,n=e.y,r=e.z,a=e.w;if(i<0||i>255||n<0||n>255||r<0||r>255||a<0||a>255)throw new h.a("x, y, z, and w must be unsigned normalized integers between 0 and 255");var o=256*i+n,s=256*r+a;return ki.octDecodeInRange(o,s,65535,t)},ki.octPackFloat=function(e){return x.a.defined("encoded",e),256*e.x+e.y};var Vi=new Rt;function Hi(e){return e>>1^-(1&e)}ki.octEncodeFloat=function(e){return ki.octEncode(e,Vi),ki.octPackFloat(Vi)},ki.octDecodeFloat=function(e,t){x.a.defined("value",e);var i=e/256,n=Math.floor(i),r=256*(i-n);return ki.octDecode(n,r,t)},ki.octPack=function(e,t,i,n){x.a.defined("v1",e),x.a.defined("v2",t),x.a.defined("v3",i),x.a.defined("result",n);var r=ki.octEncodeFloat(e),a=ki.octEncodeFloat(t),o=ki.octEncode(i,Vi);return n.x=65536*o.x+r,n.y=65536*o.y+a,n},ki.octUnpack=function(e,t,i,n){x.a.defined("packed",e),x.a.defined("v1",t),x.a.defined("v2",i),x.a.defined("v3",n);var r=e.x/65536,a=Math.floor(r),o=65536*(r-a);r=e.y/65536;var s=Math.floor(r),c=65536*(r-s);ki.octDecodeFloat(o,t),ki.octDecodeFloat(c,i),ki.octDecode(a,s,n)},ki.compressTextureCoordinates=function(e){return x.a.defined("textureCoordinates",e),4096*(4095*e.x|0)+(4095*e.y|0)},ki.decompressTextureCoordinates=function(e,t){x.a.defined("compressed",e),x.a.defined("result",t);var i=e/4096,n=Math.floor(i);return t.x=n/4095,t.y=(e-4096*n)/4095,t},ki.zigZagDeltaDecode=function(e,t,i){x.a.defined("uBuffer",e),x.a.defined("vBuffer",t),x.a.typeOf.number.equals("uBuffer.length","vBuffer.length",e.length,t.length),Object(u.a)(i)&&x.a.typeOf.number.equals("uBuffer.length","heightBuffer.length",e.length,i.length);for(var n=e.length,r=0,a=0,o=0,s=0;s<n;++s)r+=Hi(e[s]),a+=Hi(t[s]),e[s]=r,t[s]=a,Object(u.a)(i)&&(o+=Hi(i[s]),i[s]=o)};var Gi=ki;function qi(e,t,i){this.minimum=z.clone(Object(w.a)(e,z.ZERO)),this.maximum=z.clone(Object(w.a)(t,z.ZERO)),i=Object(u.a)(i)?z.clone(i):z.midpoint(this.minimum,this.maximum,new z),this.center=i}qi.fromPoints=function(e,t){if(Object(u.a)(t)||(t=new qi),!Object(u.a)(e)||0===e.length)return t.minimum=z.clone(z.ZERO,t.minimum),t.maximum=z.clone(z.ZERO,t.maximum),t.center=z.clone(z.ZERO,t.center),t;for(var i=e[0].x,n=e[0].y,r=e[0].z,a=e[0].x,o=e[0].y,s=e[0].z,c=e.length,l=1;l<c;l++){var h=e[l],d=h.x,f=h.y,p=h.z;i=Math.min(d,i),a=Math.max(d,a),n=Math.min(f,n),o=Math.max(f,o),r=Math.min(p,r),s=Math.max(p,s)}var m=t.minimum;m.x=i,m.y=n,m.z=r;var _=t.maximum;return _.x=a,_.y=o,_.z=s,t.center=z.midpoint(m,_,t.center),t},qi.clone=function(e,t){if(Object(u.a)(e))return Object(u.a)(t)?(t.minimum=z.clone(e.minimum,t.minimum),t.maximum=z.clone(e.maximum,t.maximum),t.center=z.clone(e.center,t.center),t):new qi(e.minimum,e.maximum,e.center)},qi.equals=function(e,t){return e===t||Object(u.a)(e)&&Object(u.a)(t)&&z.equals(e.center,t.center)&&z.equals(e.minimum,t.minimum)&&z.equals(e.maximum,t.maximum)};var Wi=new z;qi.intersectPlane=function(e,t){x.a.defined("box",e),x.a.defined("plane",t),Wi=z.subtract(e.maximum,e.minimum,Wi);var i=z.multiplyByScalar(Wi,.5,Wi),n=t.normal,r=i.x*Math.abs(n.x)+i.y*Math.abs(n.y)+i.z*Math.abs(n.z),a=z.dot(e.center,n)+t.distance;return a-r>0?ce.INSIDE:a+r<0?ce.OUTSIDE:ce.INTERSECTING},qi.prototype.clone=function(e){return qi.clone(this,e)},qi.prototype.intersectPlane=function(e){return qi.intersectPlane(this,e)},qi.prototype.equals=function(e){return qi.equals(this,e)};var Yi=qi,Xi=new z,Zi=new z,Qi=new z;var Ki=function(e,t,i,n,r){var a,o,s,c,l,h,d,f;if(x.a.defined("point",e),x.a.defined("p0",t),x.a.defined("p1",i),x.a.defined("p2",n),Object(u.a)(r)||(r=new z),Object(u.a)(t.z)){if(z.equalsEpsilon(e,t,I.EPSILON14))return z.clone(z.UNIT_X,r);if(z.equalsEpsilon(e,i,I.EPSILON14))return z.clone(z.UNIT_Y,r);if(z.equalsEpsilon(e,n,I.EPSILON14))return z.clone(z.UNIT_Z,r);a=z.subtract(i,t,Xi),o=z.subtract(n,t,Zi),s=z.subtract(e,t,Qi),c=z.dot(a,a),l=z.dot(a,o),h=z.dot(a,s),d=z.dot(o,o),f=z.dot(o,s)}else{if(Rt.equalsEpsilon(e,t,I.EPSILON14))return z.clone(z.UNIT_X,r);if(Rt.equalsEpsilon(e,i,I.EPSILON14))return z.clone(z.UNIT_Y,r);if(Rt.equalsEpsilon(e,n,I.EPSILON14))return z.clone(z.UNIT_Z,r);a=Rt.subtract(i,t,Xi),o=Rt.subtract(n,t,Zi),s=Rt.subtract(e,t,Qi),c=Rt.dot(a,a),l=Rt.dot(a,o),h=Rt.dot(a,s),d=Rt.dot(o,o),f=Rt.dot(o,s)}var p=1/(c*d-l*l);return r.y=(d*h-l*f)*p,r.z=(c*f-l*h)*p,r.x=1-r.y-r.z,r};var Ji=function(e,t,i){x.a.defined("array",e),x.a.defined("itemToFind",t),x.a.defined("comparator",i);for(var n,r,a=0,o=e.length-1;a<=o;)if((r=i(e[n=~~((a+o)/2)],t))<0)a=n+1;else{if(!(r>0))return n;o=n-1}return~(o+1)},$i={defaultKey:void 0,getKey:function(e){return Object(u.a)(e)?e:$i.defaultKey}},en=$i,tn="https://dev.virtualearth.net/REST/v1/Locations";function nn(e){var t=(e=Object(w.a)(e,w.a.EMPTY_OBJECT)).key;this._key=en.getKey(t),this._resource=new f.a({url:tn,queryParameters:{key:this._key}})}Object(O.a)(nn.prototype,{url:{get:function(){return tn}},key:{get:function(){return this._key}}}),nn.prototype.geocode=function(e){return x.a.typeOf.string("query",e),this._resource.getDerivedResource({queryParameters:{query:e}}).fetchJsonp("jsonp").then((function(e){return 0===e.resourceSets.length?[]:e.resourceSets[0].resources.map((function(e){var t=e.bbox,i=t[0],n=t[1],r=t[2],a=t[3];return{displayName:e.name,destination:Ve.fromDegrees(n,i,a,r)}}))}))};var rn=nn;function an(e,t,i,n){this.x=Object(w.a)(e,0),this.y=Object(w.a)(t,0),this.width=Object(w.a)(i,0),this.height=Object(w.a)(n,0)}an.packedLength=4,an.pack=function(e,t,i){return x.a.typeOf.object("value",e),x.a.defined("array",t),i=Object(w.a)(i,0),t[i++]=e.x,t[i++]=e.y,t[i++]=e.width,t[i]=e.height,t},an.unpack=function(e,t,i){return x.a.defined("array",e),t=Object(w.a)(t,0),Object(u.a)(i)||(i=new an),i.x=e[t++],i.y=e[t++],i.width=e[t++],i.height=e[t],i},an.fromPoints=function(e,t){if(Object(u.a)(t)||(t=new an),!Object(u.a)(e)||0===e.length)return t.x=0,t.y=0,t.width=0,t.height=0,t;for(var i=e.length,n=e[0].x,r=e[0].y,a=e[0].x,o=e[0].y,s=1;s<i;s++){var c=e[s],l=c.x,h=c.y;n=Math.min(l,n),a=Math.max(l,a),r=Math.min(h,r),o=Math.max(h,o)}return t.x=n,t.y=r,t.width=a-n,t.height=o-r,t};var on=new se,sn=new K,cn=new K;an.fromRectangle=function(e,t,i){if(Object(u.a)(i)||(i=new an),!Object(u.a)(e))return i.x=0,i.y=0,i.width=0,i.height=0,i;var n=(t=Object(w.a)(t,on)).project(Ve.southwest(e,sn)),r=t.project(Ve.northeast(e,cn));return Rt.subtract(r,n,r),i.x=n.x,i.y=n.y,i.width=r.x,i.height=r.y,i},an.clone=function(e,t){if(Object(u.a)(e))return Object(u.a)(t)?(t.x=e.x,t.y=e.y,t.width=e.width,t.height=e.height,t):new an(e.x,e.y,e.width,e.height)},an.union=function(e,t,i){x.a.typeOf.object("left",e),x.a.typeOf.object("right",t),Object(u.a)(i)||(i=new an);var n=Math.min(e.x,t.x),r=Math.min(e.y,t.y),a=Math.max(e.x+e.width,t.x+t.width),o=Math.max(e.y+e.height,t.y+t.height);return i.x=n,i.y=r,i.width=a-n,i.height=o-r,i},an.expand=function(e,t,i){x.a.typeOf.object("rectangle",e),x.a.typeOf.object("point",t),i=an.clone(e,i);var n=t.x-i.x,r=t.y-i.y;return n>i.width?i.width=n:n<0&&(i.width-=n,i.x=t.x),r>i.height?i.height=r:r<0&&(i.height-=r,i.y=t.y),i},an.intersect=function(e,t){x.a.typeOf.object("left",e),x.a.typeOf.object("right",t);var i=e.x,n=e.y,r=t.x,a=t.y;return i>r+t.width||i+e.width<r||n+e.height<a||n>a+t.height?ce.OUTSIDE:ce.INTERSECTING},an.equals=function(e,t){return e===t||Object(u.a)(e)&&Object(u.a)(t)&&e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height},an.prototype.clone=function(e){return an.clone(this,e)},an.prototype.intersect=function(e){return an.intersect(this,e)},an.prototype.equals=function(e){return an.equals(this,e)};var ln=an,un=Object(E.a)({DEPTH_BUFFER_BIT:256,STENCIL_BUFFER_BIT:1024,COLOR_BUFFER_BIT:16384,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,ZERO:0,ONE:1,SRC_COLOR:768,ONE_MINUS_SRC_COLOR:769,SRC_ALPHA:770,ONE_MINUS_SRC_ALPHA:771,DST_ALPHA:772,ONE_MINUS_DST_ALPHA:773,DST_COLOR:774,ONE_MINUS_DST_COLOR:775,SRC_ALPHA_SATURATE:776,FUNC_ADD:32774,BLEND_EQUATION:32777,BLEND_EQUATION_RGB:32777,BLEND_EQUATION_ALPHA:34877,FUNC_SUBTRACT:32778,FUNC_REVERSE_SUBTRACT:32779,BLEND_DST_RGB:32968,BLEND_SRC_RGB:32969,BLEND_DST_ALPHA:32970,BLEND_SRC_ALPHA:32971,CONSTANT_COLOR:32769,ONE_MINUS_CONSTANT_COLOR:32770,CONSTANT_ALPHA:32771,ONE_MINUS_CONSTANT_ALPHA:32772,BLEND_COLOR:32773,ARRAY_BUFFER:34962,ELEMENT_ARRAY_BUFFER:34963,ARRAY_BUFFER_BINDING:34964,ELEMENT_ARRAY_BUFFER_BINDING:34965,STREAM_DRAW:35040,STATIC_DRAW:35044,DYNAMIC_DRAW:35048,BUFFER_SIZE:34660,BUFFER_USAGE:34661,CURRENT_VERTEX_ATTRIB:34342,FRONT:1028,BACK:1029,FRONT_AND_BACK:1032,CULL_FACE:2884,BLEND:3042,DITHER:3024,STENCIL_TEST:2960,DEPTH_TEST:2929,SCISSOR_TEST:3089,POLYGON_OFFSET_FILL:32823,SAMPLE_ALPHA_TO_COVERAGE:32926,SAMPLE_COVERAGE:32928,NO_ERROR:0,INVALID_ENUM:1280,INVALID_VALUE:1281,INVALID_OPERATION:1282,OUT_OF_MEMORY:1285,CW:2304,CCW:2305,LINE_WIDTH:2849,ALIASED_POINT_SIZE_RANGE:33901,ALIASED_LINE_WIDTH_RANGE:33902,CULL_FACE_MODE:2885,FRONT_FACE:2886,DEPTH_RANGE:2928,DEPTH_WRITEMASK:2930,DEPTH_CLEAR_VALUE:2931,DEPTH_FUNC:2932,STENCIL_CLEAR_VALUE:2961,STENCIL_FUNC:2962,STENCIL_FAIL:2964,STENCIL_PASS_DEPTH_FAIL:2965,STENCIL_PASS_DEPTH_PASS:2966,STENCIL_REF:2967,STENCIL_VALUE_MASK:2963,STENCIL_WRITEMASK:2968,STENCIL_BACK_FUNC:34816,STENCIL_BACK_FAIL:34817,STENCIL_BACK_PASS_DEPTH_FAIL:34818,STENCIL_BACK_PASS_DEPTH_PASS:34819,STENCIL_BACK_REF:36003,STENCIL_BACK_VALUE_MASK:36004,STENCIL_BACK_WRITEMASK:36005,VIEWPORT:2978,SCISSOR_BOX:3088,COLOR_CLEAR_VALUE:3106,COLOR_WRITEMASK:3107,UNPACK_ALIGNMENT:3317,PACK_ALIGNMENT:3333,MAX_TEXTURE_SIZE:3379,MAX_VIEWPORT_DIMS:3386,SUBPIXEL_BITS:3408,RED_BITS:3410,GREEN_BITS:3411,BLUE_BITS:3412,ALPHA_BITS:3413,DEPTH_BITS:3414,STENCIL_BITS:3415,POLYGON_OFFSET_UNITS:10752,POLYGON_OFFSET_FACTOR:32824,TEXTURE_BINDING_2D:32873,SAMPLE_BUFFERS:32936,SAMPLES:32937,SAMPLE_COVERAGE_VALUE:32938,SAMPLE_COVERAGE_INVERT:32939,COMPRESSED_TEXTURE_FORMATS:34467,DONT_CARE:4352,FASTEST:4353,NICEST:4354,GENERATE_MIPMAP_HINT:33170,BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,DEPTH_COMPONENT:6402,ALPHA:6406,RGB:6407,RGBA:6408,LUMINANCE:6409,LUMINANCE_ALPHA:6410,UNSIGNED_SHORT_4_4_4_4:32819,UNSIGNED_SHORT_5_5_5_1:32820,UNSIGNED_SHORT_5_6_5:33635,FRAGMENT_SHADER:35632,VERTEX_SHADER:35633,MAX_VERTEX_ATTRIBS:34921,MAX_VERTEX_UNIFORM_VECTORS:36347,MAX_VARYING_VECTORS:36348,MAX_COMBINED_TEXTURE_IMAGE_UNITS:35661,MAX_VERTEX_TEXTURE_IMAGE_UNITS:35660,MAX_TEXTURE_IMAGE_UNITS:34930,MAX_FRAGMENT_UNIFORM_VECTORS:36349,SHADER_TYPE:35663,DELETE_STATUS:35712,LINK_STATUS:35714,VALIDATE_STATUS:35715,ATTACHED_SHADERS:35717,ACTIVE_UNIFORMS:35718,ACTIVE_ATTRIBUTES:35721,SHADING_LANGUAGE_VERSION:35724,CURRENT_PROGRAM:35725,NEVER:512,LESS:513,EQUAL:514,LEQUAL:515,GREATER:516,NOTEQUAL:517,GEQUAL:518,ALWAYS:519,KEEP:7680,REPLACE:7681,INCR:7682,DECR:7683,INVERT:5386,INCR_WRAP:34055,DECR_WRAP:34056,VENDOR:7936,RENDERER:7937,VERSION:7938,NEAREST:9728,LINEAR:9729,NEAREST_MIPMAP_NEAREST:9984,LINEAR_MIPMAP_NEAREST:9985,NEAREST_MIPMAP_LINEAR:9986,LINEAR_MIPMAP_LINEAR:9987,TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,TEXTURE_2D:3553,TEXTURE:5890,TEXTURE_CUBE_MAP:34067,TEXTURE_BINDING_CUBE_MAP:34068,TEXTURE_CUBE_MAP_POSITIVE_X:34069,TEXTURE_CUBE_MAP_NEGATIVE_X:34070,TEXTURE_CUBE_MAP_POSITIVE_Y:34071,TEXTURE_CUBE_MAP_NEGATIVE_Y:34072,TEXTURE_CUBE_MAP_POSITIVE_Z:34073,TEXTURE_CUBE_MAP_NEGATIVE_Z:34074,MAX_CUBE_MAP_TEXTURE_SIZE:34076,TEXTURE0:33984,TEXTURE1:33985,TEXTURE2:33986,TEXTURE3:33987,TEXTURE4:33988,TEXTURE5:33989,TEXTURE6:33990,TEXTURE7:33991,TEXTURE8:33992,TEXTURE9:33993,TEXTURE10:33994,TEXTURE11:33995,TEXTURE12:33996,TEXTURE13:33997,TEXTURE14:33998,TEXTURE15:33999,TEXTURE16:34e3,TEXTURE17:34001,TEXTURE18:34002,TEXTURE19:34003,TEXTURE20:34004,TEXTURE21:34005,TEXTURE22:34006,TEXTURE23:34007,TEXTURE24:34008,TEXTURE25:34009,TEXTURE26:34010,TEXTURE27:34011,TEXTURE28:34012,TEXTURE29:34013,TEXTURE30:34014,TEXTURE31:34015,ACTIVE_TEXTURE:34016,REPEAT:10497,CLAMP_TO_EDGE:33071,MIRRORED_REPEAT:33648,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,INT_VEC2:35667,INT_VEC3:35668,INT_VEC4:35669,BOOL:35670,BOOL_VEC2:35671,BOOL_VEC3:35672,BOOL_VEC4:35673,FLOAT_MAT2:35674,FLOAT_MAT3:35675,FLOAT_MAT4:35676,SAMPLER_2D:35678,SAMPLER_CUBE:35680,VERTEX_ATTRIB_ARRAY_ENABLED:34338,VERTEX_ATTRIB_ARRAY_SIZE:34339,VERTEX_ATTRIB_ARRAY_STRIDE:34340,VERTEX_ATTRIB_ARRAY_TYPE:34341,VERTEX_ATTRIB_ARRAY_NORMALIZED:34922,VERTEX_ATTRIB_ARRAY_POINTER:34373,VERTEX_ATTRIB_ARRAY_BUFFER_BINDING:34975,IMPLEMENTATION_COLOR_READ_TYPE:35738,IMPLEMENTATION_COLOR_READ_FORMAT:35739,COMPILE_STATUS:35713,LOW_FLOAT:36336,MEDIUM_FLOAT:36337,HIGH_FLOAT:36338,LOW_INT:36339,MEDIUM_INT:36340,HIGH_INT:36341,FRAMEBUFFER:36160,RENDERBUFFER:36161,RGBA4:32854,RGB5_A1:32855,RGB565:36194,DEPTH_COMPONENT16:33189,STENCIL_INDEX:6401,STENCIL_INDEX8:36168,DEPTH_STENCIL:34041,RENDERBUFFER_WIDTH:36162,RENDERBUFFER_HEIGHT:36163,RENDERBUFFER_INTERNAL_FORMAT:36164,RENDERBUFFER_RED_SIZE:36176,RENDERBUFFER_GREEN_SIZE:36177,RENDERBUFFER_BLUE_SIZE:36178,RENDERBUFFER_ALPHA_SIZE:36179,RENDERBUFFER_DEPTH_SIZE:36180,RENDERBUFFER_STENCIL_SIZE:36181,FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE:36048,FRAMEBUFFER_ATTACHMENT_OBJECT_NAME:36049,FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL:36050,FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE:36051,COLOR_ATTACHMENT0:36064,DEPTH_ATTACHMENT:36096,STENCIL_ATTACHMENT:36128,DEPTH_STENCIL_ATTACHMENT:33306,NONE:0,FRAMEBUFFER_COMPLETE:36053,FRAMEBUFFER_INCOMPLETE_ATTACHMENT:36054,FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:36055,FRAMEBUFFER_INCOMPLETE_DIMENSIONS:36057,FRAMEBUFFER_UNSUPPORTED:36061,FRAMEBUFFER_BINDING:36006,RENDERBUFFER_BINDING:36007,MAX_RENDERBUFFER_SIZE:34024,INVALID_FRAMEBUFFER_OPERATION:1286,UNPACK_FLIP_Y_WEBGL:37440,UNPACK_PREMULTIPLY_ALPHA_WEBGL:37441,CONTEXT_LOST_WEBGL:37442,UNPACK_COLORSPACE_CONVERSION_WEBGL:37443,BROWSER_DEFAULT_WEBGL:37444,COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,COMPRESSED_RGBA_S3TC_DXT3_EXT:33778,COMPRESSED_RGBA_S3TC_DXT5_EXT:33779,COMPRESSED_RGB_PVRTC_4BPPV1_IMG:35840,COMPRESSED_RGB_PVRTC_2BPPV1_IMG:35841,COMPRESSED_RGBA_PVRTC_4BPPV1_IMG:35842,COMPRESSED_RGBA_PVRTC_2BPPV1_IMG:35843,COMPRESSED_RGB_ETC1_WEBGL:36196,HALF_FLOAT_OES:36193,DOUBLE:5130,READ_BUFFER:3074,UNPACK_ROW_LENGTH:3314,UNPACK_SKIP_ROWS:3315,UNPACK_SKIP_PIXELS:3316,PACK_ROW_LENGTH:3330,PACK_SKIP_ROWS:3331,PACK_SKIP_PIXELS:3332,COLOR:6144,DEPTH:6145,STENCIL:6146,RED:6403,RGB8:32849,RGBA8:32856,RGB10_A2:32857,TEXTURE_BINDING_3D:32874,UNPACK_SKIP_IMAGES:32877,UNPACK_IMAGE_HEIGHT:32878,TEXTURE_3D:32879,TEXTURE_WRAP_R:32882,MAX_3D_TEXTURE_SIZE:32883,UNSIGNED_INT_2_10_10_10_REV:33640,MAX_ELEMENTS_VERTICES:33e3,MAX_ELEMENTS_INDICES:33001,TEXTURE_MIN_LOD:33082,TEXTURE_MAX_LOD:33083,TEXTURE_BASE_LEVEL:33084,TEXTURE_MAX_LEVEL:33085,MIN:32775,MAX:32776,DEPTH_COMPONENT24:33190,MAX_TEXTURE_LOD_BIAS:34045,TEXTURE_COMPARE_MODE:34892,TEXTURE_COMPARE_FUNC:34893,CURRENT_QUERY:34917,QUERY_RESULT:34918,QUERY_RESULT_AVAILABLE:34919,STREAM_READ:35041,STREAM_COPY:35042,STATIC_READ:35045,STATIC_COPY:35046,DYNAMIC_READ:35049,DYNAMIC_COPY:35050,MAX_DRAW_BUFFERS:34852,DRAW_BUFFER0:34853,DRAW_BUFFER1:34854,DRAW_BUFFER2:34855,DRAW_BUFFER3:34856,DRAW_BUFFER4:34857,DRAW_BUFFER5:34858,DRAW_BUFFER6:34859,DRAW_BUFFER7:34860,DRAW_BUFFER8:34861,DRAW_BUFFER9:34862,DRAW_BUFFER10:34863,DRAW_BUFFER11:34864,DRAW_BUFFER12:34865,DRAW_BUFFER13:34866,DRAW_BUFFER14:34867,DRAW_BUFFER15:34868,MAX_FRAGMENT_UNIFORM_COMPONENTS:35657,MAX_VERTEX_UNIFORM_COMPONENTS:35658,SAMPLER_3D:35679,SAMPLER_2D_SHADOW:35682,FRAGMENT_SHADER_DERIVATIVE_HINT:35723,PIXEL_PACK_BUFFER:35051,PIXEL_UNPACK_BUFFER:35052,PIXEL_PACK_BUFFER_BINDING:35053,PIXEL_UNPACK_BUFFER_BINDING:35055,FLOAT_MAT2x3:35685,FLOAT_MAT2x4:35686,FLOAT_MAT3x2:35687,FLOAT_MAT3x4:35688,FLOAT_MAT4x2:35689,FLOAT_MAT4x3:35690,SRGB:35904,SRGB8:35905,SRGB8_ALPHA8:35907,COMPARE_REF_TO_TEXTURE:34894,RGBA32F:34836,RGB32F:34837,RGBA16F:34842,RGB16F:34843,VERTEX_ATTRIB_ARRAY_INTEGER:35069,MAX_ARRAY_TEXTURE_LAYERS:35071,MIN_PROGRAM_TEXEL_OFFSET:35076,MAX_PROGRAM_TEXEL_OFFSET:35077,MAX_VARYING_COMPONENTS:35659,TEXTURE_2D_ARRAY:35866,TEXTURE_BINDING_2D_ARRAY:35869,R11F_G11F_B10F:35898,UNSIGNED_INT_10F_11F_11F_REV:35899,RGB9_E5:35901,UNSIGNED_INT_5_9_9_9_REV:35902,TRANSFORM_FEEDBACK_BUFFER_MODE:35967,MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS:35968,TRANSFORM_FEEDBACK_VARYINGS:35971,TRANSFORM_FEEDBACK_BUFFER_START:35972,TRANSFORM_FEEDBACK_BUFFER_SIZE:35973,TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN:35976,RASTERIZER_DISCARD:35977,MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS:35978,MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS:35979,INTERLEAVED_ATTRIBS:35980,SEPARATE_ATTRIBS:35981,TRANSFORM_FEEDBACK_BUFFER:35982,TRANSFORM_FEEDBACK_BUFFER_BINDING:35983,RGBA32UI:36208,RGB32UI:36209,RGBA16UI:36214,RGB16UI:36215,RGBA8UI:36220,RGB8UI:36221,RGBA32I:36226,RGB32I:36227,RGBA16I:36232,RGB16I:36233,RGBA8I:36238,RGB8I:36239,RED_INTEGER:36244,RGB_INTEGER:36248,RGBA_INTEGER:36249,SAMPLER_2D_ARRAY:36289,SAMPLER_2D_ARRAY_SHADOW:36292,SAMPLER_CUBE_SHADOW:36293,UNSIGNED_INT_VEC2:36294,UNSIGNED_INT_VEC3:36295,UNSIGNED_INT_VEC4:36296,INT_SAMPLER_2D:36298,INT_SAMPLER_3D:36299,INT_SAMPLER_CUBE:36300,INT_SAMPLER_2D_ARRAY:36303,UNSIGNED_INT_SAMPLER_2D:36306,UNSIGNED_INT_SAMPLER_3D:36307,UNSIGNED_INT_SAMPLER_CUBE:36308,UNSIGNED_INT_SAMPLER_2D_ARRAY:36311,DEPTH_COMPONENT32F:36012,DEPTH32F_STENCIL8:36013,FLOAT_32_UNSIGNED_INT_24_8_REV:36269,FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING:33296,FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE:33297,FRAMEBUFFER_ATTACHMENT_RED_SIZE:33298,FRAMEBUFFER_ATTACHMENT_GREEN_SIZE:33299,FRAMEBUFFER_ATTACHMENT_BLUE_SIZE:33300,FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE:33301,FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE:33302,FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE:33303,FRAMEBUFFER_DEFAULT:33304,UNSIGNED_INT_24_8:34042,DEPTH24_STENCIL8:35056,UNSIGNED_NORMALIZED:35863,DRAW_FRAMEBUFFER_BINDING:36006,READ_FRAMEBUFFER:36008,DRAW_FRAMEBUFFER:36009,READ_FRAMEBUFFER_BINDING:36010,RENDERBUFFER_SAMPLES:36011,FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER:36052,MAX_COLOR_ATTACHMENTS:36063,COLOR_ATTACHMENT1:36065,COLOR_ATTACHMENT2:36066,COLOR_ATTACHMENT3:36067,COLOR_ATTACHMENT4:36068,COLOR_ATTACHMENT5:36069,COLOR_ATTACHMENT6:36070,COLOR_ATTACHMENT7:36071,COLOR_ATTACHMENT8:36072,COLOR_ATTACHMENT9:36073,COLOR_ATTACHMENT10:36074,COLOR_ATTACHMENT11:36075,COLOR_ATTACHMENT12:36076,COLOR_ATTACHMENT13:36077,COLOR_ATTACHMENT14:36078,COLOR_ATTACHMENT15:36079,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE:36182,MAX_SAMPLES:36183,HALF_FLOAT:5131,RG:33319,RG_INTEGER:33320,R8:33321,RG8:33323,R16F:33325,R32F:33326,RG16F:33327,RG32F:33328,R8I:33329,R8UI:33330,R16I:33331,R16UI:33332,R32I:33333,R32UI:33334,RG8I:33335,RG8UI:33336,RG16I:33337,RG16UI:33338,RG32I:33339,RG32UI:33340,VERTEX_ARRAY_BINDING:34229,R8_SNORM:36756,RG8_SNORM:36757,RGB8_SNORM:36758,RGBA8_SNORM:36759,SIGNED_NORMALIZED:36764,COPY_READ_BUFFER:36662,COPY_WRITE_BUFFER:36663,COPY_READ_BUFFER_BINDING:36662,COPY_WRITE_BUFFER_BINDING:36663,UNIFORM_BUFFER:35345,UNIFORM_BUFFER_BINDING:35368,UNIFORM_BUFFER_START:35369,UNIFORM_BUFFER_SIZE:35370,MAX_VERTEX_UNIFORM_BLOCKS:35371,MAX_FRAGMENT_UNIFORM_BLOCKS:35373,MAX_COMBINED_UNIFORM_BLOCKS:35374,MAX_UNIFORM_BUFFER_BINDINGS:35375,MAX_UNIFORM_BLOCK_SIZE:35376,MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS:35377,MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS:35379,UNIFORM_BUFFER_OFFSET_ALIGNMENT:35380,ACTIVE_UNIFORM_BLOCKS:35382,UNIFORM_TYPE:35383,UNIFORM_SIZE:35384,UNIFORM_BLOCK_INDEX:35386,UNIFORM_OFFSET:35387,UNIFORM_ARRAY_STRIDE:35388,UNIFORM_MATRIX_STRIDE:35389,UNIFORM_IS_ROW_MAJOR:35390,UNIFORM_BLOCK_BINDING:35391,UNIFORM_BLOCK_DATA_SIZE:35392,UNIFORM_BLOCK_ACTIVE_UNIFORMS:35394,UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES:35395,UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER:35396,UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER:35398,INVALID_INDEX:4294967295,MAX_VERTEX_OUTPUT_COMPONENTS:37154,MAX_FRAGMENT_INPUT_COMPONENTS:37157,MAX_SERVER_WAIT_TIMEOUT:37137,OBJECT_TYPE:37138,SYNC_CONDITION:37139,SYNC_STATUS:37140,SYNC_FLAGS:37141,SYNC_FENCE:37142,SYNC_GPU_COMMANDS_COMPLETE:37143,UNSIGNALED:37144,SIGNALED:37145,ALREADY_SIGNALED:37146,TIMEOUT_EXPIRED:37147,CONDITION_SATISFIED:37148,WAIT_FAILED:37149,SYNC_FLUSH_COMMANDS_BIT:1,VERTEX_ATTRIB_ARRAY_DIVISOR:35070,ANY_SAMPLES_PASSED:35887,ANY_SAMPLES_PASSED_CONSERVATIVE:36202,SAMPLER_BINDING:35097,RGB10_A2UI:36975,INT_2_10_10_10_REV:36255,TRANSFORM_FEEDBACK:36386,TRANSFORM_FEEDBACK_PAUSED:36387,TRANSFORM_FEEDBACK_ACTIVE:36388,TRANSFORM_FEEDBACK_BINDING:36389,COMPRESSED_R11_EAC:37488,COMPRESSED_SIGNED_R11_EAC:37489,COMPRESSED_RG11_EAC:37490,COMPRESSED_SIGNED_RG11_EAC:37491,COMPRESSED_RGB8_ETC2:37492,COMPRESSED_SRGB8_ETC2:37493,COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:37494,COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:37495,COMPRESSED_RGBA8_ETC2_EAC:37496,COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:37497,TEXTURE_IMMUTABLE_FORMAT:37167,MAX_ELEMENT_INDEX:36203,TEXTURE_IMMUTABLE_LEVELS:33503,MAX_TEXTURE_MAX_ANISOTROPY_EXT:34047}),hn={BYTE:un.BYTE,UNSIGNED_BYTE:un.UNSIGNED_BYTE,SHORT:un.SHORT,UNSIGNED_SHORT:un.UNSIGNED_SHORT,INT:un.INT,UNSIGNED_INT:un.UNSIGNED_INT,FLOAT:un.FLOAT,DOUBLE:un.DOUBLE,getSizeInBytes:function(e){if(!Object(u.a)(e))throw new h.a("value is required.");switch(e){case hn.BYTE:return Int8Array.BYTES_PER_ELEMENT;case hn.UNSIGNED_BYTE:return Uint8Array.BYTES_PER_ELEMENT;case hn.SHORT:return Int16Array.BYTES_PER_ELEMENT;case hn.UNSIGNED_SHORT:return Uint16Array.BYTES_PER_ELEMENT;case hn.INT:return Int32Array.BYTES_PER_ELEMENT;case hn.UNSIGNED_INT:return Uint32Array.BYTES_PER_ELEMENT;case hn.FLOAT:return Float32Array.BYTES_PER_ELEMENT;case hn.DOUBLE:return Float64Array.BYTES_PER_ELEMENT;default:throw new h.a("componentDatatype is not a valid value.")}},fromTypedArray:function(e){return e instanceof Int8Array?hn.BYTE:e instanceof Uint8Array?hn.UNSIGNED_BYTE:e instanceof Int16Array?hn.SHORT:e instanceof Uint16Array?hn.UNSIGNED_SHORT:e instanceof Int32Array?hn.INT:e instanceof Uint32Array?hn.UNSIGNED_INT:e instanceof Float32Array?hn.FLOAT:e instanceof Float64Array?hn.DOUBLE:void 0},validate:function(e){return Object(u.a)(e)&&(e===hn.BYTE||e===hn.UNSIGNED_BYTE||e===hn.SHORT||e===hn.UNSIGNED_SHORT||e===hn.INT||e===hn.UNSIGNED_INT||e===hn.FLOAT||e===hn.DOUBLE)},createTypedArray:function(e,t){if(!Object(u.a)(e))throw new h.a("componentDatatype is required.");if(!Object(u.a)(t))throw new h.a("valuesOrLength is required.");switch(e){case hn.BYTE:return new Int8Array(t);case hn.UNSIGNED_BYTE:return new Uint8Array(t);case hn.SHORT:return new Int16Array(t);case hn.UNSIGNED_SHORT:return new Uint16Array(t);case hn.INT:return new Int32Array(t);case hn.UNSIGNED_INT:return new Uint32Array(t);case hn.FLOAT:return new Float32Array(t);case hn.DOUBLE:return new Float64Array(t);default:throw new h.a("componentDatatype is not a valid value.")}},createArrayBufferView:function(e,t,i,n){if(!Object(u.a)(e))throw new h.a("componentDatatype is required.");if(!Object(u.a)(t))throw new h.a("buffer is required.");switch(i=Object(w.a)(i,0),n=Object(w.a)(n,(t.byteLength-i)/hn.getSizeInBytes(e)),e){case hn.BYTE:return new Int8Array(t,i,n);case hn.UNSIGNED_BYTE:return new Uint8Array(t,i,n);case hn.SHORT:return new Int16Array(t,i,n);case hn.UNSIGNED_SHORT:return new Uint16Array(t,i,n);case hn.INT:return new Int32Array(t,i,n);case hn.UNSIGNED_INT:return new Uint32Array(t,i,n);case hn.FLOAT:return new Float32Array(t,i,n);case hn.DOUBLE:return new Float64Array(t,i,n);default:throw new h.a("componentDatatype is not a valid value.")}},fromName:function(e){switch(e){case"BYTE":return hn.BYTE;case"UNSIGNED_BYTE":return hn.UNSIGNED_BYTE;case"SHORT":return hn.SHORT;case"UNSIGNED_SHORT":return hn.UNSIGNED_SHORT;case"INT":return hn.INT;case"UNSIGNED_INT":return hn.UNSIGNED_INT;case"FLOAT":return hn.FLOAT;case"DOUBLE":return hn.DOUBLE;default:throw new h.a("name is not a valid value.")}}},dn=Object(E.a)(hn),fn=Object(E.a)({NONE:0,TOP:1,ALL:2}),pn=Object(E.a)({NONE:0,TRIANGLES:1,LINES:2,POLYLINES:3});function mn(e,t,i,n){this[0]=Object(w.a)(e,0),this[1]=Object(w.a)(i,0),this[2]=Object(w.a)(t,0),this[3]=Object(w.a)(n,0)}mn.packedLength=4,mn.pack=function(e,t,i){return x.a.typeOf.object("value",e),x.a.defined("array",t),i=Object(w.a)(i,0),t[i++]=e[0],t[i++]=e[1],t[i++]=e[2],t[i++]=e[3],t},mn.unpack=function(e,t,i){return x.a.defined("array",e),t=Object(w.a)(t,0),Object(u.a)(i)||(i=new mn),i[0]=e[t++],i[1]=e[t++],i[2]=e[t++],i[3]=e[t++],i},mn.clone=function(e,t){if(Object(u.a)(e))return Object(u.a)(t)?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t):new mn(e[0],e[2],e[1],e[3])},mn.fromArray=function(e,t,i){return x.a.defined("array",e),t=Object(w.a)(t,0),Object(u.a)(i)||(i=new mn),i[0]=e[t],i[1]=e[t+1],i[2]=e[t+2],i[3]=e[t+3],i},mn.fromColumnMajorArray=function(e,t){return x.a.defined("values",e),mn.clone(e,t)},mn.fromRowMajorArray=function(e,t){return x.a.defined("values",e),Object(u.a)(t)?(t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3],t):new mn(e[0],e[1],e[2],e[3])},mn.fromScale=function(e,t){return x.a.typeOf.object("scale",e),Object(u.a)(t)?(t[0]=e.x,t[1]=0,t[2]=0,t[3]=e.y,t):new mn(e.x,0,0,e.y)},mn.fromUniformScale=function(e,t){return x.a.typeOf.number("scale",e),Object(u.a)(t)?(t[0]=e,t[1]=0,t[2]=0,t[3]=e,t):new mn(e,0,0,e)},mn.fromRotation=function(e,t){x.a.typeOf.number("angle",e);var i=Math.cos(e),n=Math.sin(e);return Object(u.a)(t)?(t[0]=i,t[1]=n,t[2]=-n,t[3]=i,t):new mn(i,-n,n,i)},mn.toArray=function(e,t){return x.a.typeOf.object("matrix",e),Object(u.a)(t)?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t):[e[0],e[1],e[2],e[3]]},mn.getElementIndex=function(e,t){return x.a.typeOf.number.greaterThanOrEquals("row",t,0),x.a.typeOf.number.lessThanOrEquals("row",t,1),x.a.typeOf.number.greaterThanOrEquals("column",e,0),x.a.typeOf.number.lessThanOrEquals("column",e,1),2*e+t},mn.getColumn=function(e,t,i){x.a.typeOf.object("matrix",e),x.a.typeOf.number.greaterThanOrEquals("index",t,0),x.a.typeOf.number.lessThanOrEquals("index",t,1),x.a.typeOf.object("result",i);var n=2*t,r=e[n],a=e[n+1];return i.x=r,i.y=a,i},mn.setColumn=function(e,t,i,n){x.a.typeOf.object("matrix",e),x.a.typeOf.number.greaterThanOrEquals("index",t,0),x.a.typeOf.number.lessThanOrEquals("index",t,1),x.a.typeOf.object("cartesian",i),x.a.typeOf.object("result",n);var r=2*t;return(n=mn.clone(e,n))[r]=i.x,n[r+1]=i.y,n},mn.getRow=function(e,t,i){x.a.typeOf.object("matrix",e),x.a.typeOf.number.greaterThanOrEquals("index",t,0),x.a.typeOf.number.lessThanOrEquals("index",t,1),x.a.typeOf.object("result",i);var n=e[t],r=e[t+2];return i.x=n,i.y=r,i},mn.setRow=function(e,t,i,n){return x.a.typeOf.object("matrix",e),x.a.typeOf.number.greaterThanOrEquals("index",t,0),x.a.typeOf.number.lessThanOrEquals("index",t,1),x.a.typeOf.object("cartesian",i),x.a.typeOf.object("result",n),(n=mn.clone(e,n))[t]=i.x,n[t+2]=i.y,n};var _n=new Rt;mn.getScale=function(e,t){return x.a.typeOf.object("matrix",e),x.a.typeOf.object("result",t),t.x=Rt.magnitude(Rt.fromElements(e[0],e[1],_n)),t.y=Rt.magnitude(Rt.fromElements(e[2],e[3],_n)),t};var gn=new Rt;mn.getMaximumScale=function(e){return mn.getScale(e,gn),Rt.maximumComponent(gn)},mn.multiply=function(e,t,i){x.a.typeOf.object("left",e),x.a.typeOf.object("right",t),x.a.typeOf.object("result",i);var n=e[0]*t[0]+e[2]*t[1],r=e[0]*t[2]+e[2]*t[3],a=e[1]*t[0]+e[3]*t[1],o=e[1]*t[2]+e[3]*t[3];return i[0]=n,i[1]=a,i[2]=r,i[3]=o,i},mn.add=function(e,t,i){return x.a.typeOf.object("left",e),x.a.typeOf.object("right",t),x.a.typeOf.object("result",i),i[0]=e[0]+t[0],i[1]=e[1]+t[1],i[2]=e[2]+t[2],i[3]=e[3]+t[3],i},mn.subtract=function(e,t,i){return x.a.typeOf.object("left",e),x.a.typeOf.object("right",t),x.a.typeOf.object("result",i),i[0]=e[0]-t[0],i[1]=e[1]-t[1],i[2]=e[2]-t[2],i[3]=e[3]-t[3],i},mn.multiplyByVector=function(e,t,i){x.a.typeOf.object("matrix",e),x.a.typeOf.object("cartesian",t),x.a.typeOf.object("result",i);var n=e[0]*t.x+e[2]*t.y,r=e[1]*t.x+e[3]*t.y;return i.x=n,i.y=r,i},mn.multiplyByScalar=function(e,t,i){return x.a.typeOf.object("matrix",e),x.a.typeOf.number("scalar",t),x.a.typeOf.object("result",i),i[0]=e[0]*t,i[1]=e[1]*t,i[2]=e[2]*t,i[3]=e[3]*t,i},mn.multiplyByScale=function(e,t,i){return x.a.typeOf.object("matrix",e),x.a.typeOf.object("scale",t),x.a.typeOf.object("result",i),i[0]=e[0]*t.x,i[1]=e[1]*t.x,i[2]=e[2]*t.y,i[3]=e[3]*t.y,i},mn.negate=function(e,t){return x.a.typeOf.object("matrix",e),x.a.typeOf.object("result",t),t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},mn.transpose=function(e,t){x.a.typeOf.object("matrix",e),x.a.typeOf.object("result",t);var i=e[0],n=e[2],r=e[1],a=e[3];return t[0]=i,t[1]=n,t[2]=r,t[3]=a,t},mn.abs=function(e,t){return x.a.typeOf.object("matrix",e),x.a.typeOf.object("result",t),t[0]=Math.abs(e[0]),t[1]=Math.abs(e[1]),t[2]=Math.abs(e[2]),t[3]=Math.abs(e[3]),t},mn.equals=function(e,t){return e===t||Object(u.a)(e)&&Object(u.a)(t)&&e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]},mn.equalsArray=function(e,t,i){return e[0]===t[i]&&e[1]===t[i+1]&&e[2]===t[i+2]&&e[3]===t[i+3]},mn.equalsEpsilon=function(e,t,i){return x.a.typeOf.number("epsilon",i),e===t||Object(u.a)(e)&&Object(u.a)(t)&&Math.abs(e[0]-t[0])<=i&&Math.abs(e[1]-t[1])<=i&&Math.abs(e[2]-t[2])<=i&&Math.abs(e[3]-t[3])<=i},mn.IDENTITY=Object(E.a)(new mn(1,0,0,1)),mn.ZERO=Object(E.a)(new mn(0,0,0,0)),mn.COLUMN0ROW0=0,mn.COLUMN0ROW1=1,mn.COLUMN1ROW0=2,mn.COLUMN1ROW1=3,Object(O.a)(mn.prototype,{length:{get:function(){return mn.packedLength}}}),mn.prototype.clone=function(e){return mn.clone(this,e)},mn.prototype.equals=function(e){return mn.equals(this,e)},mn.prototype.equalsEpsilon=function(e,t){return mn.equalsEpsilon(this,e,t)},mn.prototype.toString=function(){return"("+this[0]+", "+this[2]+")\n("+this[1]+", "+this[3]+")"};var vn=mn,bn={POINTS:un.POINTS,LINES:un.LINES,LINE_LOOP:un.LINE_LOOP,LINE_STRIP:un.LINE_STRIP,TRIANGLES:un.TRIANGLES,TRIANGLE_STRIP:un.TRIANGLE_STRIP,TRIANGLE_FAN:un.TRIANGLE_FAN,validate:function(e){return e===bn.POINTS||e===bn.LINES||e===bn.LINE_LOOP||e===bn.LINE_STRIP||e===bn.TRIANGLES||e===bn.TRIANGLE_STRIP||e===bn.TRIANGLE_FAN}},yn=Object(E.a)(bn);function wn(e,t,i,n){this.x=Object(w.a)(e,0),this.y=Object(w.a)(t,0),this.z=Object(w.a)(i,0),this.w=Object(w.a)(n,0)}var On=new z;wn.fromAxisAngle=function(e,t,i){x.a.typeOf.object("axis",e),x.a.typeOf.number("angle",t);var n=t/2,r=Math.sin(n),a=(On=z.normalize(e,On)).x*r,o=On.y*r,s=On.z*r,c=Math.cos(n);return Object(u.a)(i)?(i.x=a,i.y=o,i.z=s,i.w=c,i):new wn(a,o,s,c)};var xn=[1,2,0],En=new Array(3);wn.fromRotationMatrix=function(e,t){var i,n,r,a,o;x.a.typeOf.object("matrix",e);var s=e[be.COLUMN0ROW0],c=e[be.COLUMN1ROW1],l=e[be.COLUMN2ROW2],h=s+c+l;if(h>0)o=.5*(i=Math.sqrt(h+1)),i=.5/i,n=(e[be.COLUMN1ROW2]-e[be.COLUMN2ROW1])*i,r=(e[be.COLUMN2ROW0]-e[be.COLUMN0ROW2])*i,a=(e[be.COLUMN0ROW1]-e[be.COLUMN1ROW0])*i;else{var d=0;c>s&&(d=1),l>s&&l>c&&(d=2);var f=xn[d],p=xn[f];i=Math.sqrt(e[be.getElementIndex(d,d)]-e[be.getElementIndex(f,f)]-e[be.getElementIndex(p,p)]+1);var m=En;m[d]=.5*i,i=.5/i,o=(e[be.getElementIndex(p,f)]-e[be.getElementIndex(f,p)])*i,m[f]=(e[be.getElementIndex(f,d)]+e[be.getElementIndex(d,f)])*i,m[p]=(e[be.getElementIndex(p,d)]+e[be.getElementIndex(d,p)])*i,n=-m[0],r=-m[1],a=-m[2]}return Object(u.a)(t)?(t.x=n,t.y=r,t.z=a,t.w=o,t):new wn(n,r,a,o)};var Tn=new wn,Cn=new wn,Sn=new wn,An=new wn;wn.fromHeadingPitchRoll=function(e,t){return x.a.typeOf.object("headingPitchRoll",e),An=wn.fromAxisAngle(z.UNIT_X,e.roll,Tn),Sn=wn.fromAxisAngle(z.UNIT_Y,-e.pitch,t),t=wn.multiply(Sn,An,Sn),Cn=wn.fromAxisAngle(z.UNIT_Z,-e.heading,Tn),wn.multiply(Cn,t,t)};var Pn=new z,In=new z,Dn=new wn,jn=new wn,Mn=new wn;wn.packedLength=4,wn.pack=function(e,t,i){return x.a.typeOf.object("value",e),x.a.defined("array",t),i=Object(w.a)(i,0),t[i++]=e.x,t[i++]=e.y,t[i++]=e.z,t[i]=e.w,t},wn.unpack=function(e,t,i){return x.a.defined("array",e),t=Object(w.a)(t,0),Object(u.a)(i)||(i=new wn),i.x=e[t],i.y=e[t+1],i.z=e[t+2],i.w=e[t+3],i},wn.packedInterpolationLength=3,wn.convertPackedArrayForInterpolation=function(e,t,i,n){wn.unpack(e,4*i,Mn),wn.conjugate(Mn,Mn);for(var r=0,a=i-t+1;r<a;r++){var o=3*r;wn.unpack(e,4*(t+r),Dn),wn.multiply(Dn,Mn,Dn),Dn.w<0&&wn.negate(Dn,Dn),wn.computeAxis(Dn,Pn);var s=wn.computeAngle(Dn);n[o]=Pn.x*s,n[o+1]=Pn.y*s,n[o+2]=Pn.z*s}},wn.unpackInterpolationResult=function(e,t,i,n,r){Object(u.a)(r)||(r=new wn),z.fromArray(e,0,In);var a=z.magnitude(In);return wn.unpack(t,4*n,jn),0===a?wn.clone(wn.IDENTITY,Dn):wn.fromAxisAngle(In,a,Dn),wn.multiply(Dn,jn,r)},wn.clone=function(e,t){if(Object(u.a)(e))return Object(u.a)(t)?(t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t):new wn(e.x,e.y,e.z,e.w)},wn.conjugate=function(e,t){return x.a.typeOf.object("quaternion",e),x.a.typeOf.object("result",t),t.x=-e.x,t.y=-e.y,t.z=-e.z,t.w=e.w,t},wn.magnitudeSquared=function(e){return x.a.typeOf.object("quaternion",e),e.x*e.x+e.y*e.y+e.z*e.z+e.w*e.w},wn.magnitude=function(e){return Math.sqrt(wn.magnitudeSquared(e))},wn.normalize=function(e,t){x.a.typeOf.object("result",t);var i=1/wn.magnitude(e),n=e.x*i,r=e.y*i,a=e.z*i,o=e.w*i;return t.x=n,t.y=r,t.z=a,t.w=o,t},wn.inverse=function(e,t){x.a.typeOf.object("result",t);var i=wn.magnitudeSquared(e);return t=wn.conjugate(e,t),wn.multiplyByScalar(t,1/i,t)},wn.add=function(e,t,i){return x.a.typeOf.object("left",e),x.a.typeOf.object("right",t),x.a.typeOf.object("result",i),i.x=e.x+t.x,i.y=e.y+t.y,i.z=e.z+t.z,i.w=e.w+t.w,i},wn.subtract=function(e,t,i){return x.a.typeOf.object("left",e),x.a.typeOf.object("right",t),x.a.typeOf.object("result",i),i.x=e.x-t.x,i.y=e.y-t.y,i.z=e.z-t.z,i.w=e.w-t.w,i},wn.negate=function(e,t){return x.a.typeOf.object("quaternion",e),x.a.typeOf.object("result",t),t.x=-e.x,t.y=-e.y,t.z=-e.z,t.w=-e.w,t},wn.dot=function(e,t){return x.a.typeOf.object("left",e),x.a.typeOf.object("right",t),e.x*t.x+e.y*t.y+e.z*t.z+e.w*t.w},wn.multiply=function(e,t,i){x.a.typeOf.object("left",e),x.a.typeOf.object("right",t),x.a.typeOf.object("result",i);var n=e.x,r=e.y,a=e.z,o=e.w,s=t.x,c=t.y,l=t.z,u=t.w,h=o*s+n*u+r*l-a*c,d=o*c-n*l+r*u+a*s,f=o*l+n*c-r*s+a*u,p=o*u-n*s-r*c-a*l;return i.x=h,i.y=d,i.z=f,i.w=p,i},wn.multiplyByScalar=function(e,t,i){return x.a.typeOf.object("quaternion",e),x.a.typeOf.number("scalar",t),x.a.typeOf.object("result",i),i.x=e.x*t,i.y=e.y*t,i.z=e.z*t,i.w=e.w*t,i},wn.divideByScalar=function(e,t,i){return x.a.typeOf.object("quaternion",e),x.a.typeOf.number("scalar",t),x.a.typeOf.object("result",i),i.x=e.x/t,i.y=e.y/t,i.z=e.z/t,i.w=e.w/t,i},wn.computeAxis=function(e,t){x.a.typeOf.object("quaternion",e),x.a.typeOf.object("result",t);var i=e.w;if(Math.abs(i-1)<I.EPSILON6)return t.x=t.y=t.z=0,t;var n=1/Math.sqrt(1-i*i);return t.x=e.x*n,t.y=e.y*n,t.z=e.z*n,t},wn.computeAngle=function(e){return x.a.typeOf.object("quaternion",e),Math.abs(e.w-1)<I.EPSILON6?0:2*Math.acos(e.w)};var Rn=new wn;wn.lerp=function(e,t,i,n){return x.a.typeOf.object("start",e),x.a.typeOf.object("end",t),x.a.typeOf.number("t",i),x.a.typeOf.object("result",n),Rn=wn.multiplyByScalar(t,i,Rn),n=wn.multiplyByScalar(e,1-i,n),wn.add(Rn,n,n)};var Ln=new wn,Nn=new wn,Fn=new wn;wn.slerp=function(e,t,i,n){x.a.typeOf.object("start",e),x.a.typeOf.object("end",t),x.a.typeOf.number("t",i),x.a.typeOf.object("result",n);var r=wn.dot(e,t),a=t;if(r<0&&(r=-r,a=Ln=wn.negate(t,Ln)),1-r<I.EPSILON6)return wn.lerp(e,a,i,n);var o=Math.acos(r);return Nn=wn.multiplyByScalar(e,Math.sin((1-i)*o),Nn),Fn=wn.multiplyByScalar(a,Math.sin(i*o),Fn),n=wn.add(Nn,Fn,n),wn.multiplyByScalar(n,1/Math.sin(o),n)},wn.log=function(e,t){x.a.typeOf.object("quaternion",e),x.a.typeOf.object("result",t);var i=I.acosClamped(e.w),n=0;return 0!==i&&(n=i/Math.sin(i)),z.multiplyByScalar(e,n,t)},wn.exp=function(e,t){x.a.typeOf.object("cartesian",e),x.a.typeOf.object("result",t);var i=z.magnitude(e),n=0;return 0!==i&&(n=Math.sin(i)/i),t.x=e.x*n,t.y=e.y*n,t.z=e.z*n,t.w=Math.cos(i),t};var kn=new z,Bn=new z,zn=new wn,Un=new wn;wn.computeInnerQuadrangle=function(e,t,i,n){x.a.typeOf.object("q0",e),x.a.typeOf.object("q1",t),x.a.typeOf.object("q2",i),x.a.typeOf.object("result",n);var r=wn.conjugate(t,zn);wn.multiply(r,i,Un);var a=wn.log(Un,kn);wn.multiply(r,e,Un);var o=wn.log(Un,Bn);return z.add(a,o,a),z.multiplyByScalar(a,.25,a),z.negate(a,a),wn.exp(a,zn),wn.multiply(t,zn,n)},wn.squad=function(e,t,i,n,r,a){x.a.typeOf.object("q0",e),x.a.typeOf.object("q1",t),x.a.typeOf.object("s0",i),x.a.typeOf.object("s1",n),x.a.typeOf.number("t",r),x.a.typeOf.object("result",a);var o=wn.slerp(e,t,r,zn),s=wn.slerp(i,n,r,Un);return wn.slerp(o,s,2*r*(1-r),a)};for(var Vn=new wn,Hn=1.9011074535173003,Gn=Ri.supportsTypedArrays()?new Float32Array(8):[],qn=Ri.supportsTypedArrays()?new Float32Array(8):[],Wn=Ri.supportsTypedArrays()?new Float32Array(8):[],Yn=Ri.supportsTypedArrays()?new Float32Array(8):[],Xn=0;Xn<7;++Xn){var Zn=Xn+1,Qn=2*Zn+1;Gn[Xn]=1/(Zn*Qn),qn[Xn]=Zn/Qn}Gn[7]=Hn/136,qn[7]=8*Hn/17,wn.fastSlerp=function(e,t,i,n){x.a.typeOf.object("start",e),x.a.typeOf.object("end",t),x.a.typeOf.number("t",i),x.a.typeOf.object("result",n);var r,a=wn.dot(e,t);a>=0?r=1:(r=-1,a=-a);for(var o=a-1,s=1-i,c=i*i,l=s*s,u=7;u>=0;--u)Wn[u]=(Gn[u]*c-qn[u])*o,Yn[u]=(Gn[u]*l-qn[u])*o;var h=r*i*(1+Wn[0]*(1+Wn[1]*(1+Wn[2]*(1+Wn[3]*(1+Wn[4]*(1+Wn[5]*(1+Wn[6]*(1+Wn[7])))))))),d=s*(1+Yn[0]*(1+Yn[1]*(1+Yn[2]*(1+Yn[3]*(1+Yn[4]*(1+Yn[5]*(1+Yn[6]*(1+Yn[7])))))))),f=wn.multiplyByScalar(e,d,Vn);return wn.multiplyByScalar(t,h,n),wn.add(f,n,n)},wn.fastSquad=function(e,t,i,n,r,a){x.a.typeOf.object("q0",e),x.a.typeOf.object("q1",t),x.a.typeOf.object("s0",i),x.a.typeOf.object("s1",n),x.a.typeOf.number("t",r),x.a.typeOf.object("result",a);var o=wn.fastSlerp(e,t,r,zn),s=wn.fastSlerp(i,n,r,Un);return wn.fastSlerp(o,s,2*r*(1-r),a)},wn.equals=function(e,t){return e===t||Object(u.a)(e)&&Object(u.a)(t)&&e.x===t.x&&e.y===t.y&&e.z===t.z&&e.w===t.w},wn.equalsEpsilon=function(e,t,i){return x.a.typeOf.number("epsilon",i),e===t||Object(u.a)(e)&&Object(u.a)(t)&&Math.abs(e.x-t.x)<=i&&Math.abs(e.y-t.y)<=i&&Math.abs(e.z-t.z)<=i&&Math.abs(e.w-t.w)<=i},wn.ZERO=Object(E.a)(new wn(0,0,0,0)),wn.IDENTITY=Object(E.a)(new wn(0,0,0,1)),wn.prototype.clone=function(e){return wn.clone(this,e)},wn.prototype.equals=function(e){return wn.equals(this,e)},wn.prototype.equalsEpsilon=function(e,t){return wn.equalsEpsilon(this,e,t)},wn.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.z+", "+this.w+")"};var Kn=wn;var Jn=function(e,t,i,n,r){this.xPoleWander=e,this.yPoleWander=t,this.xPoleOffset=i,this.yPoleOffset=n,this.ut1MinusUtc=r};
/**
@license
sprintf.js from the php.js project - https://github.com/kvz/phpjs
Directly from https://github.com/kvz/phpjs/blob/master/functions/strings/sprintf.js

php.js is copyright 2012 Kevin van Zonneveld.

Portions copyright Brett Zamir (http://brett-zamir.me), Kevin van Zonneveld
(http://kevin.vanzonneveld.net), Onno Marsman, Theriault, Michael White
(http://getsprink.com), Waldo Malqui Silva, Paulo Freitas, Jack, Jonas
Raoni Soares Silva (http://www.jsfromhell.com), Philip Peterson, Legaev
Andrey, Ates Goral (http://magnetiq.com), Alex, Ratheous, Martijn Wieringa,
Rafa? Kukawski (http://blog.kukawski.pl), lmeyrick
(https://sourceforge.net/projects/bcmath-js/), Nate, Philippe Baumann,
Enrique Gonzalez, Webtoolkit.info (http://www.webtoolkit.info/), Carlos R.
L. Rodrigues (http://www.jsfromhell.com), Ash Searle
(http://hexmen.com/blog/), Jani Hartikainen, travc, Ole Vrijenhoek,
Erkekjetter, Michael Grier, Rafa? Kukawski (http://kukawski.pl), Johnny
Mast (http://www.phpvrouwen.nl), T.Wild, d3x,
http://stackoverflow.com/questions/57803/how-to-convert-decimal-to-hex-in-javascript,
Rafa? Kukawski (http://blog.kukawski.pl/), stag019, pilus, WebDevHobo
(http://webdevhobo.blogspot.com/), marrtins, GeekFG
(http://geekfg.blogspot.com), Andrea Giammarchi
(http://webreflection.blogspot.com), Arpad Ray (mailto:arpad@php.net),
gorthaur, Paul Smith, Tim de Koning (http://www.kingsquare.nl), Joris, Oleg
Eremeev, Steve Hilder, majak, gettimeofday, KELAN, Josh Fraser
(http://onlineaspect.com/2007/06/08/auto-detect-a-time-zone-with-javascript/),
Marc Palau, Martin
(http://www.erlenwiese.de/), Breaking Par Consulting Inc
(http://www.breakingpar.com/bkp/home.nsf/0/87256B280015193F87256CFB006C45F7),
Chris, Mirek Slugen, saulius, Alfonso Jimenez
(http://www.alfonsojimenez.com), Diplom@t (http://difane.com/), felix,
Mailfaker (http://www.weedem.fr/), Tyler Akins (http://rumkin.com), Caio
Ariede (http://caioariede.com), Robin, Kankrelune
(http://www.webfaktory.info/), Karol Kowalski, Imgen Tata
(http://www.myipdf.com/), mdsjack (http://www.mdsjack.bo.it), Dreamer,
Felix Geisendoerfer (http://www.debuggable.com/felix), Lars Fischer, AJ,
David, Aman Gupta, Michael White, Public Domain
(http://www.json.org/json2.js), Steven Levithan
(http://blog.stevenlevithan.com), Sakimori, Pellentesque Malesuada,
Thunder.m, Dj (http://phpjs.org/functions/htmlentities:425#comment_134018),
Steve Clay, David James, Francois, class_exists, nobbler, T. Wild, Itsacon
(http://www.itsacon.net/), date, Ole Vrijenhoek (http://www.nervous.nl/),
Fox, Raphael (Ao RUDLER), Marco, noname, Mateusz "loonquawl" Zalega, Frank
Forte, Arno, ger, mktime, john (http://www.jd-tech.net), Nick Kolosov
(http://sammy.ru), marc andreu, Scott Cariss, Douglas Crockford
(http://javascript.crockford.com), madipta, Slawomir Kaniecki,
ReverseSyntax, Nathan, Alex Wilson, kenneth, Bayron Guevara, Adam Wallner
(http://web2.bitbaro.hu/), paulo kuong, jmweb, Lincoln Ramsay, djmix,
Pyerre, Jon Hohle, Thiago Mata (http://thiagomata.blog.com), lmeyrick
(https://sourceforge.net/projects/bcmath-js/this.), Linuxworld, duncan,
Gilbert, Sanjoy Roy, Shingo, sankai, Oskar Larsson H?gfeldt
(http://oskar-lh.name/), Denny Wardhana, 0m3r, Everlasto, Subhasis Deb,
josh, jd, Pier Paolo Ramon (http://www.mastersoup.com/), P, merabi, Soren
Hansen, Eugene Bulkin (http://doubleaw.com/), Der Simon
(http://innerdom.sourceforge.net/), echo is bad, Ozh, XoraX
(http://www.xorax.info), EdorFaus, JB, J A R, Marc Jansen, Francesco, LH,
Stoyan Kyosev (http://www.svest.org/), nord_ua, omid
(http://phpjs.org/functions/380:380#comment_137122), Brad Touesnard, MeEtc
(http://yass.meetcweb.com), Peter-Paul Koch
(http://www.quirksmode.org/js/beat.html), Olivier Louvignes
(http://mg-crea.com/), T0bsn, Tim Wiel, Bryan Elliott, Jalal Berrami,
Martin, JT, David Randall, Thomas Beaucourt (http://www.webapp.fr), taith,
vlado houba, Pierre-Luc Paour, Kristof Coomans (SCK-CEN Belgian Nucleair
Research Centre), Martin Pool, Kirk Strobeck, Rick Waldron, Brant Messenger
(http://www.brantmessenger.com/), Devan Penner-Woelk, Saulo Vallory, Wagner
B. Soares, Artur Tchernychev, Valentina De Rosa, Jason Wong
(http://carrot.org/), Christoph, Daniel Esteban, strftime, Mick@el, rezna,
Simon Willison (http://simonwillison.net), Anton Ongson, Gabriel Paderni,
Marco van Oort, penutbutterjelly, Philipp Lenssen, Bjorn Roesbeke
(http://www.bjornroesbeke.be/), Bug?, Eric Nagel, Tomasz Wesolowski,
Evertjan Garretsen, Bobby Drake, Blues (http://tech.bluesmoon.info/), Luke
Godfrey, Pul, uestla, Alan C, Ulrich, Rafal Kukawski, Yves Sucaet,
sowberry, Norman "zEh" Fuchs, hitwork, Zahlii, johnrembo, Nick Callen,
Steven Levithan (stevenlevithan.com), ejsanders, Scott Baker, Brian Tafoya
(http://www.premasolutions.com/), Philippe Jausions
(http://pear.php.net/user/jausions), Aidan Lister
(http://aidanlister.com/), Rob, e-mike, HKM, ChaosNo1, metjay, strcasecmp,
strcmp, Taras Bogach, jpfle, Alexander Ermolaev
(http://snippets.dzone.com/user/AlexanderErmolaev), DxGx, kilops, Orlando,
dptr1988, Le Torbi, James (http://www.james-bell.co.uk/), Pedro Tainha
(http://www.pedrotainha.com), James, Arnout Kazemier
(http://www.3rd-Eden.com), Chris McMacken, gabriel paderni, Yannoo,
FGFEmperor, baris ozdil, Tod Gentille, Greg Frazier, jakes, 3D-GRAF, Allan
Jensen (http://www.winternet.no), Howard Yeend, Benjamin Lupton, davook,
daniel airton wermann (http://wermann.com.br), Atli T¨®r, Maximusya, Ryan
W Tenney (http://ryan.10e.us), Alexander M Beedie, fearphage
(http://http/my.opera.com/fearphage/), Nathan Sepulveda, Victor, Matteo,
Billy, stensi, Cord, Manish, T.J. Leahy, Riddler
(http://www.frontierwebdev.com/), Rafa? Kukawski, FremyCompany, Matt
Bradley, Tim de Koning, Luis Salazar (http://www.freaky-media.com/), Diogo
Resende, Rival, Andrej Pavlovic, Garagoth, Le Torbi
(http://www.letorbi.de/), Dino, Josep Sanz (http://www.ws3.es/), rem,
Russell Walker (http://www.nbill.co.uk/), Jamie Beck
(http://www.terabit.ca/), setcookie, Michael, YUI Library:
http://developer.yahoo.com/yui/docs/YAHOO.util.DateLocale.html, Blues at
http://hacks.bluesmoon.info/strftime/strftime.js, Ben
(http://benblume.co.uk/), DtTvB
(http://dt.in.th/2008-09-16.string-length-in-bytes.html), Andreas, William,
meo, incidence, Cagri Ekin, Amirouche, Amir Habibi
(http://www.residence-mixte.com/), Luke Smith (http://lucassmith.name),
Kheang Hok Chin (http://www.distantia.ca/), Jay Klehr, Lorenzo Pisani,
Tony, Yen-Wei Liu, Greenseed, mk.keck, Leslie Hoare, dude, booeyOH, Ben
Bryan

Licensed under the MIT (MIT-LICENSE.txt) license.

Permission is hereby granted, free of charge, to any person obtaining a
copy of this software and associated documentation files (the
"Software"), to deal in the Software without restriction, including
without limitation the rights to use, copy, modify, merge, publish,
distribute, sublicense, and/or sell copies of the Software, and to
permit persons to whom the Software is furnished to do so, subject to
the following conditions:

The above copyright notice and this permission notice shall be included
in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.
IN NO EVENT SHALL KEVIN VAN ZONNEVELD BE LIABLE FOR ANY CLAIM, DAMAGES
OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE,
ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
OTHER DEALINGS IN THE SOFTWARE.
*/var $n=function(){var e=arguments,t=0,i=e[t++],n=function(e,t,i,n){i||(i=" ");var r=e.length>=t?"":Array(1+t-e.length>>>0).join(i);return n?e+r:r+e},r=function(e,t,i,r,a,o){var s=r-e.length;return s>0&&(e=i||!a?n(e,r,o,i):e.slice(0,t.length)+n("",s,"0",!0)+e.slice(t.length)),e},a=function(e,t,i,a,o,s,c){var l=e>>>0;return e=(i=i&&l&&{2:"0b",8:"0",16:"0x"}[t]||"")+n(l.toString(t),s||0,"0",!1),r(e,i,a,o,c)},o=function(e,t,i,n,a,o){return null!=n&&(e=e.slice(0,n)),r(e,"",t,i,a,o)};return i.replace(/%%|%(\d+\$)?([-+\'#0 ]*)(\*\d+\$|\*|\d+)?(\.(\*\d+\$|\*|\d+))?([scboxXuideEfFgG])/g,(function(i,s,c,l,u,h,d){var f,p,m,_,g;if("%%"==i)return"%";for(var v=!1,b="",y=!1,w=!1,O=" ",x=c.length,E=0;c&&E<x;E++)switch(c.charAt(E)){case" ":b=" ";break;case"+":b="+";break;case"-":v=!0;break;case"'":O=c.charAt(E+1);break;case"0":y=!0;break;case"#":w=!0}if((l=l?"*"==l?+e[t++]:"*"==l.charAt(0)?+e[l.slice(1,-1)]:+l:0)<0&&(l=-l,v=!0),!isFinite(l))throw new Error("sprintf: (minimum-)width must be finite");switch(h=h?"*"==h?+e[t++]:"*"==h.charAt(0)?+e[h.slice(1,-1)]:+h:"fFeE".indexOf(d)>-1?6:"d"==d?0:void 0,g=s?e[s.slice(0,-1)]:e[t++],d){case"s":return o(String(g),v,l,h,y,O);case"c":return o(String.fromCharCode(+g),v,l,h,y);case"b":return a(g,2,w,v,l,h,y);case"o":return a(g,8,w,v,l,h,y);case"x":return a(g,16,w,v,l,h,y);case"X":return a(g,16,w,v,l,h,y).toUpperCase();case"u":return a(g,10,w,v,l,h,y);case"i":case"d":return f=+g||0,g=(p=(f=Math.round(f-f%1))<0?"-":b)+n(String(Math.abs(f)),h,"0",!1),r(g,p,v,l,y);case"e":case"E":case"f":case"F":case"g":case"G":return p=(f=+g)<0?"-":b,m=["toExponential","toFixed","toPrecision"]["efg".indexOf(d.toLowerCase())],_=["toString","toUpperCase"]["eEfFgG".indexOf(d)%2],g=p+Math.abs(f)[m](h),r(g,p,v,l,y)[_]();default:return i}}))};var er=function(e,t,i,n,r,a,o,s){this.year=e,this.month=t,this.day=i,this.hour=n,this.minute=r,this.second=a,this.millisecond=o,this.isLeapSecond=s};var tr=function(e){if(null===e||isNaN(e))throw new h.a("year is required and must be a number.");return e%4==0&&e%100!=0||e%400==0};var ir=function(e,t){this.julianDate=e,this.offset=t},nr=Object(E.a)({SECONDS_PER_MILLISECOND:.001,SECONDS_PER_MINUTE:60,MINUTES_PER_HOUR:60,HOURS_PER_DAY:24,SECONDS_PER_HOUR:3600,MINUTES_PER_DAY:1440,SECONDS_PER_DAY:86400,DAYS_PER_JULIAN_CENTURY:36525,PICOSECOND:1e-9,MODIFIED_JULIAN_DATE_DIFFERENCE:2400000.5}),rr=Object(E.a)({UTC:0,TAI:1}),ar=new er,or=[31,28,31,30,31,30,31,31,30,31,30,31];function sr(e,t){return xr.compare(e.julianDate,t.julianDate)}var cr=new ir;function lr(e){cr.julianDate=e;var t=xr.leapSeconds,i=Ji(t,cr,sr);i<0&&(i=~i),i>=t.length&&(i=t.length-1);var n=t[i].offset;i>0&&(xr.secondsDifference(t[i].julianDate,e)>n&&(n=t[--i].offset));xr.addSeconds(e,n,e)}function ur(e,t){cr.julianDate=e;var i=xr.leapSeconds,n=Ji(i,cr,sr);if(n<0&&(n=~n),0===n)return xr.addSeconds(e,-i[0].offset,t);if(n>=i.length)return xr.addSeconds(e,-i[n-1].offset,t);var r=xr.secondsDifference(i[n].julianDate,e);return 0===r?xr.addSeconds(e,-i[n].offset,t):r<=1?void 0:xr.addSeconds(e,-i[--n].offset,t)}function hr(e,t,i){var n=t/nr.SECONDS_PER_DAY|0;return e+=n,(t-=nr.SECONDS_PER_DAY*n)<0&&(e--,t+=nr.SECONDS_PER_DAY),i.dayNumber=e,i.secondsOfDay=t,i}function dr(e,t,i,n,r,a,o){var s=(t-14)/12|0,c=e+4800+s,l=(1461*c/4|0)+(367*(t-2-12*s)/12|0)-(3*((c+100)/100|0)/4|0)+i-32075;(n-=12)<0&&(n+=24);var u=a+(n*nr.SECONDS_PER_HOUR+r*nr.SECONDS_PER_MINUTE+o*nr.SECONDS_PER_MILLISECOND);return u>=43200&&(l-=1),[l,u]}var fr=/^(\d{4})$/,pr=/^(\d{4})-(\d{2})$/,mr=/^(\d{4})-?(\d{3})$/,_r=/^(\d{4})-?W(\d{2})-?(\d{1})?$/,gr=/^(\d{4})-?(\d{2})-?(\d{2})$/,vr=/([Z+\-])?(\d{2})?:?(\d{2})?$/,br=/^(\d{2})(\.\d+)?/.source+vr.source,yr=/^(\d{2}):?(\d{2})(\.\d+)?/.source+vr.source,wr=/^(\d{2}):?(\d{2}):?(\d{2})(\.\d+)?/.source+vr.source,Or="Invalid ISO 8601 date.";function xr(e,t,i){this.dayNumber=void 0,this.secondsOfDay=void 0,e=Object(w.a)(e,0),t=Object(w.a)(t,0),i=Object(w.a)(i,rr.UTC);var n=0|e;hr(n,t+=(e-n)*nr.SECONDS_PER_DAY,this),i===rr.UTC&&lr(this)}xr.fromGregorianDate=function(e,t){if(!(e instanceof er))throw new h.a("date must be a valid GregorianDate.");var i=dr(e.year,e.month,e.day,e.hour,e.minute,e.second,e.millisecond);return Object(u.a)(t)?(hr(i[0],i[1],t),lr(t),t):new xr(i[0],i[1],rr.UTC)},xr.fromDate=function(e,t){if(!(e instanceof Date)||isNaN(e.getTime()))throw new h.a("date must be a valid JavaScript Date.");var i=dr(e.getUTCFullYear(),e.getUTCMonth()+1,e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds());return Object(u.a)(t)?(hr(i[0],i[1],t),lr(t),t):new xr(i[0],i[1],rr.UTC)},xr.fromIso8601=function(e,t){if("string"!=typeof e)throw new h.a(Or);var i,n,r,a,o,s=(e=e.replace(",",".")).split("T"),c=1,l=1,d=0,f=0,p=0,m=0,_=s[0],g=s[1];if(!Object(u.a)(_))throw new h.a(Or);if(null!==(s=_.match(gr))){if((a=_.split("-").length-1)>0&&2!==a)throw new h.a(Or);i=+s[1],c=+s[2],l=+s[3]}else if(null!==(s=_.match(pr)))i=+s[1],c=+s[2];else if(null!==(s=_.match(fr)))i=+s[1];else{var v;if(null!==(s=_.match(mr))){if(i=+s[1],v=+s[2],r=tr(i),v<1||r&&v>366||!r&&v>365)throw new h.a(Or)}else{if(null===(s=_.match(_r)))throw new h.a(Or);i=+s[1];var b=+s[2],y=+s[3]||0;if((a=_.split("-").length-1)>0&&(!Object(u.a)(s[3])&&1!==a||Object(u.a)(s[3])&&2!==a))throw new h.a(Or);v=7*b+y-new Date(Date.UTC(i,0,4)).getUTCDay()-3}(n=new Date(Date.UTC(i,0,1))).setUTCDate(v),c=n.getUTCMonth()+1,l=n.getUTCDate()}if(r=tr(i),c<1||c>12||l<1||(2!==c||!r)&&l>or[c-1]||r&&2===c&&l>29)throw new h.a(Or);if(Object(u.a)(g)){if(null!==(s=g.match(wr))){if((a=g.split(":").length-1)>0&&2!==a&&3!==a)throw new h.a(Or);d=+s[1],f=+s[2],p=+s[3],m=1e3*+(s[4]||0),o=5}else if(null!==(s=g.match(yr))){if((a=g.split(":").length-1)>2)throw new h.a(Or);d=+s[1],f=+s[2],p=60*+(s[3]||0),o=4}else{if(null===(s=g.match(br)))throw new h.a(Or);d=+s[1],f=60*+(s[2]||0),o=3}if(f>=60||p>=61||d>24||24===d&&(f>0||p>0||m>0))throw new h.a(Or);var w=s[o],O=+s[o+1],x=+(s[o+2]||0);switch(w){case"+":d-=O,f-=x;break;case"-":d+=O,f+=x;break;case"Z":break;default:f+=new Date(Date.UTC(i,c-1,l,d,f)).getTimezoneOffset()}}var E=60===p;for(E&&p--;f>=60;)f-=60,d++;for(;d>=24;)d-=24,l++;for(n=r&&2===c?29:or[c-1];l>n;)l-=n,++c>12&&(c-=12,i++),n=r&&2===c?29:or[c-1];for(;f<0;)f+=60,d--;for(;d<0;)d+=24,l--;for(;l<1;)--c<1&&(c+=12,i--),l+=n=r&&2===c?29:or[c-1];var T=dr(i,c,l,d,f,p,m);return Object(u.a)(t)?(hr(T[0],T[1],t),lr(t)):t=new xr(T[0],T[1],rr.UTC),E&&xr.addSeconds(t,1,t),t},xr.now=function(e){return xr.fromDate(new Date,e)};var Er=new xr(0,0,rr.TAI);xr.toGregorianDate=function(e,t){if(!Object(u.a)(e))throw new h.a("julianDate is required.");var i=!1,n=ur(e,Er);Object(u.a)(n)||(xr.addSeconds(e,-1,Er),n=ur(Er,Er),i=!0);var r=n.dayNumber,a=n.secondsOfDay;a>=43200&&(r+=1);var o=r+68569|0,s=4*o/146097|0,c=4e3*((o=o-((146097*s+3)/4|0)|0)+1)/1461001|0,l=80*(o=o-(1461*c/4|0)+31|0)/2447|0,d=o-(2447*l/80|0)|0,f=l+2-12*(o=l/11|0)|0,p=100*(s-49)+c+o|0,m=a/nr.SECONDS_PER_HOUR|0,_=a-m*nr.SECONDS_PER_HOUR,g=_/nr.SECONDS_PER_MINUTE|0,v=0|(_-=g*nr.SECONDS_PER_MINUTE),b=(_-v)/nr.SECONDS_PER_MILLISECOND;return(m+=12)>23&&(m-=24),i&&(v+=1),Object(u.a)(t)?(t.year=p,t.month=f,t.day=d,t.hour=m,t.minute=g,t.second=v,t.millisecond=b,t.isLeapSecond=i,t):new er(p,f,d,m,g,v,b,i)},xr.toDate=function(e){if(!Object(u.a)(e))throw new h.a("julianDate is required.");var t=xr.toGregorianDate(e,ar),i=t.second;return t.isLeapSecond&&(i-=1),new Date(Date.UTC(t.year,t.month-1,t.day,t.hour,t.minute,i,t.millisecond))},xr.toIso8601=function(e,t){if(!Object(u.a)(e))throw new h.a("julianDate is required.");var i,n=xr.toGregorianDate(e,ar),r=n.year,a=n.month,o=n.day,s=n.hour,c=n.minute,l=n.second,d=n.millisecond;return 1e4===r&&1===a&&1===o&&0===s&&0===c&&0===l&&0===d&&(r=9999,a=12,o=31,s=24),Object(u.a)(t)||0===d?Object(u.a)(t)&&0!==t?(i=(.01*d).toFixed(t).replace(".","").slice(0,t),$n("%04d-%02d-%02dT%02d:%02d:%02d.%sZ",r,a,o,s,c,l,i)):$n("%04d-%02d-%02dT%02d:%02d:%02dZ",r,a,o,s,c,l):(i=(.01*d).toString().replace(".",""),$n("%04d-%02d-%02dT%02d:%02d:%02d.%sZ",r,a,o,s,c,l,i))},xr.clone=function(e,t){if(Object(u.a)(e))return Object(u.a)(t)?(t.dayNumber=e.dayNumber,t.secondsOfDay=e.secondsOfDay,t):new xr(e.dayNumber,e.secondsOfDay,rr.TAI)},xr.compare=function(e,t){if(!Object(u.a)(e))throw new h.a("left is required.");if(!Object(u.a)(t))throw new h.a("right is required.");var i=e.dayNumber-t.dayNumber;return 0!==i?i:e.secondsOfDay-t.secondsOfDay},xr.equals=function(e,t){return e===t||Object(u.a)(e)&&Object(u.a)(t)&&e.dayNumber===t.dayNumber&&e.secondsOfDay===t.secondsOfDay},xr.equalsEpsilon=function(e,t,i){if(!Object(u.a)(i))throw new h.a("epsilon is required.");return e===t||Object(u.a)(e)&&Object(u.a)(t)&&Math.abs(xr.secondsDifference(e,t))<=i},xr.totalDays=function(e){if(!Object(u.a)(e))throw new h.a("julianDate is required.");return e.dayNumber+e.secondsOfDay/nr.SECONDS_PER_DAY},xr.secondsDifference=function(e,t){if(!Object(u.a)(e))throw new h.a("left is required.");if(!Object(u.a)(t))throw new h.a("right is required.");return(e.dayNumber-t.dayNumber)*nr.SECONDS_PER_DAY+(e.secondsOfDay-t.secondsOfDay)},xr.daysDifference=function(e,t){if(!Object(u.a)(e))throw new h.a("left is required.");if(!Object(u.a)(t))throw new h.a("right is required.");return e.dayNumber-t.dayNumber+(e.secondsOfDay-t.secondsOfDay)/nr.SECONDS_PER_DAY},xr.computeTaiMinusUtc=function(e){cr.julianDate=e;var t=xr.leapSeconds,i=Ji(t,cr,sr);return i<0&&(i=~i,--i<0&&(i=0)),t[i].offset},xr.addSeconds=function(e,t,i){if(!Object(u.a)(e))throw new h.a("julianDate is required.");if(!Object(u.a)(t))throw new h.a("seconds is required.");if(!Object(u.a)(i))throw new h.a("result is required.");return hr(e.dayNumber,e.secondsOfDay+t,i)},xr.addMinutes=function(e,t,i){if(!Object(u.a)(e))throw new h.a("julianDate is required.");if(!Object(u.a)(t))throw new h.a("minutes is required.");if(!Object(u.a)(i))throw new h.a("result is required.");var n=e.secondsOfDay+t*nr.SECONDS_PER_MINUTE;return hr(e.dayNumber,n,i)},xr.addHours=function(e,t,i){if(!Object(u.a)(e))throw new h.a("julianDate is required.");if(!Object(u.a)(t))throw new h.a("hours is required.");if(!Object(u.a)(i))throw new h.a("result is required.");var n=e.secondsOfDay+t*nr.SECONDS_PER_HOUR;return hr(e.dayNumber,n,i)},xr.addDays=function(e,t,i){if(!Object(u.a)(e))throw new h.a("julianDate is required.");if(!Object(u.a)(t))throw new h.a("days is required.");if(!Object(u.a)(i))throw new h.a("result is required.");return hr(e.dayNumber+t,e.secondsOfDay,i)},xr.lessThan=function(e,t){return xr.compare(e,t)<0},xr.lessThanOrEquals=function(e,t){return xr.compare(e,t)<=0},xr.greaterThan=function(e,t){return xr.compare(e,t)>0},xr.greaterThanOrEquals=function(e,t){return xr.compare(e,t)>=0},xr.prototype.clone=function(e){return xr.clone(this,e)},xr.prototype.equals=function(e){return xr.equals(this,e)},xr.prototype.equalsEpsilon=function(e,t){return xr.equalsEpsilon(this,e,t)},xr.prototype.toString=function(){return xr.toIso8601(this)},xr.leapSeconds=[new ir(new xr(2441317,43210,rr.TAI),10),new ir(new xr(2441499,43211,rr.TAI),11),new ir(new xr(2441683,43212,rr.TAI),12),new ir(new xr(2442048,43213,rr.TAI),13),new ir(new xr(2442413,43214,rr.TAI),14),new ir(new xr(2442778,43215,rr.TAI),15),new ir(new xr(2443144,43216,rr.TAI),16),new ir(new xr(2443509,43217,rr.TAI),17),new ir(new xr(2443874,43218,rr.TAI),18),new ir(new xr(2444239,43219,rr.TAI),19),new ir(new xr(2444786,43220,rr.TAI),20),new ir(new xr(2445151,43221,rr.TAI),21),new ir(new xr(2445516,43222,rr.TAI),22),new ir(new xr(2446247,43223,rr.TAI),23),new ir(new xr(2447161,43224,rr.TAI),24),new ir(new xr(2447892,43225,rr.TAI),25),new ir(new xr(2448257,43226,rr.TAI),26),new ir(new xr(2448804,43227,rr.TAI),27),new ir(new xr(2449169,43228,rr.TAI),28),new ir(new xr(2449534,43229,rr.TAI),29),new ir(new xr(2450083,43230,rr.TAI),30),new ir(new xr(2450630,43231,rr.TAI),31),new ir(new xr(2451179,43232,rr.TAI),32),new ir(new xr(2453736,43233,rr.TAI),33),new ir(new xr(2454832,43234,rr.TAI),34),new ir(new xr(2456109,43235,rr.TAI),35),new ir(new xr(2457204,43236,rr.TAI),36),new ir(new xr(2457754,43237,rr.TAI),37)];var Tr=xr;function Cr(e){if(e=Object(w.a)(e,w.a.EMPTY_OBJECT),this._dates=void 0,this._samples=void 0,this._dateColumn=-1,this._xPoleWanderRadiansColumn=-1,this._yPoleWanderRadiansColumn=-1,this._ut1MinusUtcSecondsColumn=-1,this._xCelestialPoleOffsetRadiansColumn=-1,this._yCelestialPoleOffsetRadiansColumn=-1,this._taiMinusUtcSecondsColumn=-1,this._columnCount=0,this._lastIndex=-1,this._downloadPromise=void 0,this._dataError=void 0,this._addNewLeapSeconds=Object(w.a)(e.addNewLeapSeconds,!0),Object(u.a)(e.data))Ar(this,e.data);else if(Object(u.a)(e.url)){var t=f.a.createIfNeeded(e.url),i=this;this._downloadPromise=Object(Oi.a)(t.fetchJson(),(function(e){Ar(i,e)}),(function(){i._dataError="An error occurred while retrieving the EOP data from the URL "+t.url+"."}))}else Ar(this,{columnNames:["dateIso8601","modifiedJulianDateUtc","xPoleWanderRadians","yPoleWanderRadians","ut1MinusUtcSeconds","lengthOfDayCorrectionSeconds","xCelestialPoleOffsetRadians","yCelestialPoleOffsetRadians","taiMinusUtcSeconds"],samples:[]})}function Sr(e,t){return Tr.compare(e.julianDate,t)}function Ar(e,t){if(Object(u.a)(t.columnNames))if(Object(u.a)(t.samples)){var i=t.columnNames.indexOf("modifiedJulianDateUtc"),n=t.columnNames.indexOf("xPoleWanderRadians"),r=t.columnNames.indexOf("yPoleWanderRadians"),a=t.columnNames.indexOf("ut1MinusUtcSeconds"),o=t.columnNames.indexOf("xCelestialPoleOffsetRadians"),s=t.columnNames.indexOf("yCelestialPoleOffsetRadians"),c=t.columnNames.indexOf("taiMinusUtcSeconds");if(i<0||n<0||r<0||a<0||o<0||s<0||c<0)e._dataError="Error in loaded EOP data: The columnNames property must include modifiedJulianDateUtc, xPoleWanderRadians, yPoleWanderRadians, ut1MinusUtcSeconds, xCelestialPoleOffsetRadians, yCelestialPoleOffsetRadians, and taiMinusUtcSeconds columns";else{var l,h=e._samples=t.samples,d=e._dates=[];e._dateColumn=i,e._xPoleWanderRadiansColumn=n,e._yPoleWanderRadiansColumn=r,e._ut1MinusUtcSecondsColumn=a,e._xCelestialPoleOffsetRadiansColumn=o,e._yCelestialPoleOffsetRadiansColumn=s,e._taiMinusUtcSecondsColumn=c,e._columnCount=t.columnNames.length,e._lastIndex=void 0;for(var f=e._addNewLeapSeconds,p=0,m=h.length;p<m;p+=e._columnCount){var _=h[p+i],g=h[p+c],v=_+nr.MODIFIED_JULIAN_DATE_DIFFERENCE,b=new Tr(v,g,rr.TAI);if(d.push(b),f){if(g!==l&&Object(u.a)(l)){var y=Tr.leapSeconds,w=Ji(y,b,Sr);if(w<0){var O=new ir(b,g);y.splice(~w,0,O)}}l=g}}}}else e._dataError="Error in loaded EOP data: The samples property is required.";else e._dataError="Error in loaded EOP data: The columnNames property is required."}function Pr(e,t,i,n,r){var a=i*n;r.xPoleWander=t[a+e._xPoleWanderRadiansColumn],r.yPoleWander=t[a+e._yPoleWanderRadiansColumn],r.xPoleOffset=t[a+e._xCelestialPoleOffsetRadiansColumn],r.yPoleOffset=t[a+e._yCelestialPoleOffsetRadiansColumn],r.ut1MinusUtc=t[a+e._ut1MinusUtcSecondsColumn]}function Ir(e,t,i){return t+e*(i-t)}function Dr(e,t,i,n,r,a,o){var s=e._columnCount;if(a>t.length-1)return o.xPoleWander=0,o.yPoleWander=0,o.xPoleOffset=0,o.yPoleOffset=0,o.ut1MinusUtc=0,o;var c=t[r],l=t[a];if(c.equals(l)||n.equals(c))return Pr(e,i,r,s,o),o;if(n.equals(l))return Pr(e,i,a,s,o),o;var u=Tr.secondsDifference(n,c)/Tr.secondsDifference(l,c),h=r*s,d=a*s,f=i[h+e._ut1MinusUtcSecondsColumn],p=i[d+e._ut1MinusUtcSecondsColumn],m=p-f;if(m>.5||m<-.5){var _=i[h+e._taiMinusUtcSecondsColumn],g=i[d+e._taiMinusUtcSecondsColumn];_!==g&&(l.equals(n)?f=p:p-=g-_)}return o.xPoleWander=Ir(u,i[h+e._xPoleWanderRadiansColumn],i[d+e._xPoleWanderRadiansColumn]),o.yPoleWander=Ir(u,i[h+e._yPoleWanderRadiansColumn],i[d+e._yPoleWanderRadiansColumn]),o.xPoleOffset=Ir(u,i[h+e._xCelestialPoleOffsetRadiansColumn],i[d+e._xCelestialPoleOffsetRadiansColumn]),o.yPoleOffset=Ir(u,i[h+e._yCelestialPoleOffsetRadiansColumn],i[d+e._yCelestialPoleOffsetRadiansColumn]),o.ut1MinusUtc=Ir(u,f,p),o}Cr.NONE=Object(E.a)({getPromiseToLoad:function(){return Object(Oi.a)()},compute:function(e,t){return Object(u.a)(t)?(t.xPoleWander=0,t.yPoleWander=0,t.xPoleOffset=0,t.yPoleOffset=0,t.ut1MinusUtc=0):t=new Jn(0,0,0,0,0),t}}),Cr.prototype.getPromiseToLoad=function(){return Object(Oi.a)(this._downloadPromise)},Cr.prototype.compute=function(e,t){if(Object(u.a)(this._samples)){if(Object(u.a)(t)||(t=new Jn(0,0,0,0,0)),0===this._samples.length)return t.xPoleWander=0,t.yPoleWander=0,t.xPoleOffset=0,t.yPoleOffset=0,t.ut1MinusUtc=0,t;var i=this._dates,n=this._lastIndex,r=0,a=0;if(Object(u.a)(n)){var o=i[n],s=i[n+1],c=Tr.lessThanOrEquals(o,e),l=!Object(u.a)(s),h=l||Tr.greaterThanOrEquals(s,e);if(c&&h)return r=n,!l&&s.equals(e)&&++r,a=r+1,Dr(this,i,this._samples,e,r,a,t),t}var d=Ji(i,e,Tr.compare,this._dateColumn);return d>=0?(d<i.length-1&&i[d+1].equals(e)&&++d,r=d,a=d):(r=(a=~d)-1)<0&&(r=0),this._lastIndex=r,Dr(this,i,this._samples,e,r,a,t),t}if(Object(u.a)(this._dataError))throw new Ce.a(this._dataError)};var jr=Cr;function Mr(e,t,i){this.heading=Object(w.a)(e,0),this.pitch=Object(w.a)(t,0),this.roll=Object(w.a)(i,0)}Mr.fromQuaternion=function(e,t){if(!Object(u.a)(e))throw new h.a("quaternion is required");Object(u.a)(t)||(t=new Mr);var i=2*(e.w*e.y-e.z*e.x),n=1-2*(e.x*e.x+e.y*e.y),r=2*(e.w*e.x+e.y*e.z),a=1-2*(e.y*e.y+e.z*e.z),o=2*(e.w*e.z+e.x*e.y);return t.heading=-Math.atan2(o,a),t.roll=Math.atan2(r,n),t.pitch=-Math.asin(i),t},Mr.fromDegrees=function(e,t,i,n){if(!Object(u.a)(e))throw new h.a("heading is required");if(!Object(u.a)(t))throw new h.a("pitch is required");if(!Object(u.a)(i))throw new h.a("roll is required");return Object(u.a)(n)||(n=new Mr),n.heading=e*I.RADIANS_PER_DEGREE,n.pitch=t*I.RADIANS_PER_DEGREE,n.roll=i*I.RADIANS_PER_DEGREE,n},Mr.clone=function(e,t){if(Object(u.a)(e))return Object(u.a)(t)?(t.heading=e.heading,t.pitch=e.pitch,t.roll=e.roll,t):new Mr(e.heading,e.pitch,e.roll)},Mr.equals=function(e,t){return e===t||Object(u.a)(e)&&Object(u.a)(t)&&e.heading===t.heading&&e.pitch===t.pitch&&e.roll===t.roll},Mr.equalsEpsilon=function(e,t,i,n){return e===t||Object(u.a)(e)&&Object(u.a)(t)&&I.equalsEpsilon(e.heading,t.heading,i,n)&&I.equalsEpsilon(e.pitch,t.pitch,i,n)&&I.equalsEpsilon(e.roll,t.roll,i,n)},Mr.prototype.clone=function(e){return Mr.clone(this,e)},Mr.prototype.equals=function(e){return Mr.equals(this,e)},Mr.prototype.equalsEpsilon=function(e,t,i){return Mr.equalsEpsilon(this,e,t,i)},Mr.prototype.toString=function(){return"("+this.heading+", "+this.pitch+", "+this.roll+")"};var Rr=Mr;var Lr=function(e,t,i){this.x=e,this.y=t,this.s=i};function Nr(e){e=Object(w.a)(e,w.a.EMPTY_OBJECT),this._xysFileUrlTemplate=f.a.createIfNeeded(e.xysFileUrlTemplate),this._interpolationOrder=Object(w.a)(e.interpolationOrder,9),this._sampleZeroJulianEphemerisDate=Object(w.a)(e.sampleZeroJulianEphemerisDate,2442396.5),this._sampleZeroDateTT=new Tr(this._sampleZeroJulianEphemerisDate,0,rr.TAI),this._stepSizeDays=Object(w.a)(e.stepSizeDays,1),this._samplesPerXysFile=Object(w.a)(e.samplesPerXysFile,1e3),this._totalSamples=Object(w.a)(e.totalSamples,27426),this._samples=new Array(3*this._totalSamples),this._chunkDownloadsInProgress=[];for(var t=this._interpolationOrder,i=this._denominators=new Array(t+1),n=this._xTable=new Array(t+1),r=Math.pow(this._stepSizeDays,t),a=0;a<=t;++a){i[a]=r,n[a]=a*this._stepSizeDays;for(var o=0;o<=t;++o)o!==a&&(i[a]*=a-o);i[a]=1/i[a]}this._work=new Array(t+1),this._coef=new Array(t+1)}var Fr=new Tr(0,0,rr.TAI);function kr(e,t,i){var n=Fr;return n.dayNumber=t,n.secondsOfDay=i,Tr.daysDifference(n,e._sampleZeroDateTT)}function Br(e,t){if(e._chunkDownloadsInProgress[t])return e._chunkDownloadsInProgress[t];var i,n=Oi.a.defer();e._chunkDownloadsInProgress[t]=n;var r=e._xysFileUrlTemplate;return i=Object(u.a)(r)?r.getDerivedResource({templateValues:{0:t}}):new f.a({url:y("Assets/IAU2006_XYS/IAU2006_XYS_"+t+".json")}),Object(Oi.a)(i.fetchJson(),(function(i){e._chunkDownloadsInProgress[t]=!1;for(var r=e._samples,a=i.samples,o=t*e._samplesPerXysFile*3,s=0,c=a.length;s<c;++s)r[o+s]=a[s];n.resolve()})),n.promise}Nr.prototype.preload=function(e,t,i,n){var r=kr(this,e,t),a=kr(this,i,n),o=r/this._stepSizeDays-this._interpolationOrder/2|0;o<0&&(o=0);var s=a/this._stepSizeDays-this._interpolationOrder/2|0+this._interpolationOrder;s>=this._totalSamples&&(s=this._totalSamples-1);for(var c=o/this._samplesPerXysFile|0,l=s/this._samplesPerXysFile|0,u=[],h=c;h<=l;++h)u.push(Br(this,h));return Oi.a.all(u)},Nr.prototype.computeXysRadians=function(e,t,i){var n=kr(this,e,t);if(!(n<0)){var r=n/this._stepSizeDays|0;if(!(r>=this._totalSamples)){var a=this._interpolationOrder,o=r-(a/2|0);o<0&&(o=0);var s=o+a;s>=this._totalSamples&&(o=(s=this._totalSamples-1)-a)<0&&(o=0);var c=!1,l=this._samples;if(Object(u.a)(l[3*o])||(Br(this,o/this._samplesPerXysFile|0),c=!0),Object(u.a)(l[3*s])||(Br(this,s/this._samplesPerXysFile|0),c=!0),!c){Object(u.a)(i)?(i.x=0,i.y=0,i.s=0):i=new Lr(0,0,0);var h,d,f=n-o*this._stepSizeDays,p=this._work,m=this._denominators,_=this._coef,g=this._xTable;for(h=0;h<=a;++h)p[h]=f-g[h];for(h=0;h<=a;++h){for(_[h]=1,d=0;d<=a;++d)d!==h&&(_[h]*=p[d]);_[h]*=m[h];var v=3*(o+h);i.x+=_[h]*l[v++],i.y+=_[h]*l[v++],i.s+=_[h]*l[v]}return i}}}};var zr=Nr,Ur={},Vr={up:{south:"east",north:"west",west:"south",east:"north"},down:{south:"west",north:"east",west:"north",east:"south"},south:{up:"west",down:"east",west:"down",east:"up"},north:{up:"east",down:"west",west:"up",east:"down"},west:{up:"north",down:"south",north:"down",south:"up"},east:{up:"south",down:"north",north:"up",south:"down"}},Hr={north:[-1,0,0],east:[0,1,0],up:[0,0,1],south:[1,0,0],west:[0,-1,0],down:[0,0,-1]},Gr={},qr={east:new z,north:new z,up:new z,west:new z,south:new z,down:new z},Wr=new z,Yr=new z,Xr=new z;Ur.localFrameToFixedFrameGenerator=function(e,t){if(!Vr.hasOwnProperty(e)||!Vr[e].hasOwnProperty(t))throw new h.a("firstAxis and secondAxis must be east, north, up, west, south or down.");var i,n=Vr[e][t],r=e+t;return Object(u.a)(Gr[r])?i=Gr[r]:(i=function(i,r,a){if(!Object(u.a)(i))throw new h.a("origin is required.");if(Object(u.a)(a)||(a=new Be),I.equalsEpsilon(i.x,0,I.EPSILON14)&&I.equalsEpsilon(i.y,0,I.EPSILON14)){var o=I.sign(i.z);z.unpack(Hr[e],0,Wr),"east"!==e&&"west"!==e&&z.multiplyByScalar(Wr,o,Wr),z.unpack(Hr[t],0,Yr),"east"!==t&&"west"!==t&&z.multiplyByScalar(Yr,o,Yr),z.unpack(Hr[n],0,Xr),"east"!==n&&"west"!==n&&z.multiplyByScalar(Xr,o,Xr)}else{(r=Object(w.a)(r,ae.WGS84)).geodeticSurfaceNormal(i,qr.up);var s=qr.up,c=qr.east;c.x=-i.y,c.y=i.x,c.z=0,z.normalize(c,qr.east),z.cross(s,c,qr.north),z.multiplyByScalar(qr.up,-1,qr.down),z.multiplyByScalar(qr.east,-1,qr.west),z.multiplyByScalar(qr.north,-1,qr.south),Wr=qr[e],Yr=qr[t],Xr=qr[n]}return a[0]=Wr.x,a[1]=Wr.y,a[2]=Wr.z,a[3]=0,a[4]=Yr.x,a[5]=Yr.y,a[6]=Yr.z,a[7]=0,a[8]=Xr.x,a[9]=Xr.y,a[10]=Xr.z,a[11]=0,a[12]=i.x,a[13]=i.y,a[14]=i.z,a[15]=1,a},Gr[r]=i),i},Ur.eastNorthUpToFixedFrame=Ur.localFrameToFixedFrameGenerator("east","north"),Ur.northEastDownToFixedFrame=Ur.localFrameToFixedFrameGenerator("north","east"),Ur.northUpEastToFixedFrame=Ur.localFrameToFixedFrameGenerator("north","up"),Ur.northWestUpToFixedFrame=Ur.localFrameToFixedFrameGenerator("north","west");var Zr=new Kn,Qr=new z(1,1,1),Kr=new Be;Ur.headingPitchRollToFixedFrame=function(e,t,i,n,r){x.a.typeOf.object("HeadingPitchRoll",t),n=Object(w.a)(n,Ur.eastNorthUpToFixedFrame);var a=Kn.fromHeadingPitchRoll(t,Zr),o=Be.fromTranslationQuaternionRotationScale(z.ZERO,a,Qr,Kr);return r=n(e,i,r),Be.multiply(r,o,r)};var Jr=new Be,$r=new be;Ur.headingPitchRollQuaternion=function(e,t,i,n,r){x.a.typeOf.object("HeadingPitchRoll",t);var a=Ur.headingPitchRollToFixedFrame(e,t,i,n,Jr),o=Be.getRotation(a,$r);return Kn.fromRotationMatrix(o,r)};var ea=new z(1,1,1),ta=new z,ia=new Be,na=new Be,ra=new be,aa=new Kn;Ur.fixedFrameToHeadingPitchRoll=function(e,t,i,n){x.a.defined("transform",e),t=Object(w.a)(t,ae.WGS84),i=Object(w.a)(i,Ur.eastNorthUpToFixedFrame),Object(u.a)(n)||(n=new Rr);var r=Be.getTranslation(e,ta);if(z.equals(r,z.ZERO))return n.heading=0,n.pitch=0,n.roll=0,n;var a=Be.inverseTransformation(i(r,t,ia),ia),o=Be.setScale(e,ea,na);o=Be.setTranslation(o,z.ZERO,o),a=Be.multiply(a,o,a);var s=Kn.fromRotationMatrix(Be.getRotation(a,ra),aa);return s=Kn.normalize(s,s),Rr.fromQuaternion(s,n)};var oa=I.TWO_PI/86400,sa=new Tr;Ur.computeTemeToPseudoFixedMatrix=function(e,t){if(!Object(u.a)(e))throw new h.a("date is required.");var i,n=(sa=Tr.addSeconds(e,-Tr.computeTaiMinusUtc(e),sa)).dayNumber,r=sa.secondsOfDay,a=n-2451545,o=(24110.54841+(i=r>=43200?(a+.5)/nr.DAYS_PER_JULIAN_CENTURY:(a-.5)/nr.DAYS_PER_JULIAN_CENTURY)*(8640184.812866+i*(.093104+-62e-7*i)))*oa%I.TWO_PI+(72921158553e-15+11772758384668e-32*(n-2451545.5))*((r+.5*nr.SECONDS_PER_DAY)%nr.SECONDS_PER_DAY),s=Math.cos(o),c=Math.sin(o);return Object(u.a)(t)?(t[0]=s,t[1]=-c,t[2]=0,t[3]=c,t[4]=s,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t):new be(s,c,0,-c,s,0,0,0,1)},Ur.iau2006XysData=new zr,Ur.earthOrientationParameters=jr.NONE;Ur.preloadIcrfFixed=function(e){var t=e.start.dayNumber,i=e.start.secondsOfDay+32.184,n=e.stop.dayNumber,r=e.stop.secondsOfDay+32.184,a=Ur.iau2006XysData.preload(t,i,n,r),o=Ur.earthOrientationParameters.getPromiseToLoad();return Oi.a.all([a,o])},Ur.computeIcrfToFixedMatrix=function(e,t){if(!Object(u.a)(e))throw new h.a("date is required.");Object(u.a)(t)||(t=new be);var i=Ur.computeFixedToIcrfMatrix(e,t);if(Object(u.a)(i))return be.transpose(i,t)};var ca=new Lr(0,0,0),la=new Jn(0,0,0,0,0,0),ua=new be,ha=new be;Ur.computeFixedToIcrfMatrix=function(e,t){if(!Object(u.a)(e))throw new h.a("date is required.");Object(u.a)(t)||(t=new be);var i=Ur.earthOrientationParameters.compute(e,la);if(Object(u.a)(i)){var n=e.dayNumber,r=e.secondsOfDay+32.184,a=Ur.iau2006XysData.computeXysRadians(n,r,ca);if(Object(u.a)(a)){var o=a.x+i.xPoleOffset,s=a.y+i.yPoleOffset,c=1/(1+Math.sqrt(1-o*o-s*s)),l=ua;l[0]=1-c*o*o,l[3]=-c*o*s,l[6]=o,l[1]=-c*o*s,l[4]=1-c*s*s,l[7]=s,l[2]=-o,l[5]=-s,l[8]=1-c*(o*o+s*s);var d=be.fromRotationZ(-a.s,ha),f=be.multiply(l,d,ua),p=e.dayNumber-2451545,m=(e.secondsOfDay-Tr.computeTaiMinusUtc(e)+i.ut1MinusUtc)/nr.SECONDS_PER_DAY,_=.779057273264+m+.00273781191135448*(p+m);_=_%1*I.TWO_PI;var g=be.fromRotationZ(_,ha),v=be.multiply(f,g,ua),b=Math.cos(i.xPoleWander),y=Math.cos(i.yPoleWander),w=Math.sin(i.xPoleWander),O=Math.sin(i.yPoleWander),x=n-2451545+r/nr.SECONDS_PER_DAY,E=-47e-6*(x/=36525)*I.RADIANS_PER_DEGREE/3600,T=Math.cos(E),C=Math.sin(E),S=ha;return S[0]=b*T,S[1]=b*C,S[2]=w,S[3]=-y*C+O*w*T,S[4]=y*T+O*w*C,S[5]=-O*b,S[6]=-O*C-y*w*T,S[7]=O*T-y*w*C,S[8]=y*b,be.multiply(v,S,t)}}};var da=new Te;Ur.pointToWindowCoordinates=function(e,t,i,n){return(n=Ur.pointToGLWindowCoordinates(e,t,i,n)).y=2*t[5]-n.y,n},Ur.pointToGLWindowCoordinates=function(e,t,i,n){if(!Object(u.a)(e))throw new h.a("modelViewProjectionMatrix is required.");if(!Object(u.a)(t))throw new h.a("viewportTransformation is required.");if(!Object(u.a)(i))throw new h.a("point is required.");Object(u.a)(n)||(n=new Rt);var r=da;return Be.multiplyByVector(e,Te.fromElements(i.x,i.y,i.z,1,r),r),Te.multiplyByScalar(r,1/r.w,r),Be.multiplyByVector(t,r,r),Rt.fromCartesian4(r,n)};var fa=new z,pa=new z,ma=new z;Ur.rotationMatrixFromPositionVelocity=function(e,t,i,n){if(!Object(u.a)(e))throw new h.a("position is required.");if(!Object(u.a)(t))throw new h.a("velocity is required.");var r=Object(w.a)(i,ae.WGS84).geodeticSurfaceNormal(e,fa),a=z.cross(t,r,pa);z.equalsEpsilon(a,z.ZERO,I.EPSILON6)&&(a=z.clone(z.UNIT_X,a));var o=z.cross(a,t,ma);return z.normalize(o,o),z.cross(t,o,a),z.negate(a,a),z.normalize(a,a),Object(u.a)(n)||(n=new be),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=a.x,n[4]=a.y,n[5]=a.z,n[6]=o.x,n[7]=o.y,n[8]=o.z,n};var _a=new Be(0,0,1,0,1,0,0,0,0,1,0,0,0,0,0,1),ga=new K,va=new z,ba=new z,ya=new be,wa=new Be,Oa=new Be;Ur.basisTo2D=function(e,t,i){if(!Object(u.a)(e))throw new h.a("projection is required.");if(!Object(u.a)(t))throw new h.a("matrix is required.");if(!Object(u.a)(i))throw new h.a("result is required.");var n=Be.getTranslation(t,ba),r=e.ellipsoid,a=r.cartesianToCartographic(n,ga),o=e.project(a,va);z.fromElements(o.z,o.x,o.y,o);var s=Ur.eastNorthUpToFixedFrame(n,r,wa),c=Be.inverseTransformation(s,Oa),l=Be.getRotation(t,ya),d=Be.multiplyByMatrix3(c,l,i);return Be.multiply(_a,d,i),Be.setTranslation(i,o,i),i},Ur.wgs84To2DModelMatrix=function(e,t,i){if(!Object(u.a)(e))throw new h.a("projection is required.");if(!Object(u.a)(t))throw new h.a("center is required.");if(!Object(u.a)(i))throw new h.a("result is required.");var n=e.ellipsoid,r=Ur.eastNorthUpToFixedFrame(t,n,wa),a=Be.inverseTransformation(r,Oa),o=n.cartesianToCartographic(t,ga),s=e.project(o,va);z.fromElements(s.z,s.x,s.y,s);var c=Be.fromTranslation(s,wa);return Be.multiply(_a,a,i),Be.multiply(c,i,i),i};var xa=Ur;function Ea(e){e=Object(w.a)(e,w.a.EMPTY_OBJECT),x.a.typeOf.object("options.attributes",e.attributes),this.attributes=e.attributes,this.indices=e.indices,this.primitiveType=Object(w.a)(e.primitiveType,yn.TRIANGLES),this.boundingSphere=e.boundingSphere,this.geometryType=Object(w.a)(e.geometryType,pn.NONE),this.boundingSphereCV=e.boundingSphereCV,this.offsetAttribute=e.offsetAttribute}Ea.computeNumberOfVertices=function(e){x.a.typeOf.object("geometry",e);var t=-1;for(var i in e.attributes)if(e.attributes.hasOwnProperty(i)&&Object(u.a)(e.attributes[i])&&Object(u.a)(e.attributes[i].values)){var n=e.attributes[i],r=n.values.length/n.componentsPerAttribute;if(t!==r&&-1!==t)throw new h.a("All attribute lists must have the same number of attributes.");t=r}return t};var Ta=new K,Ca=new z,Sa=new Be,Aa=[new K,new K,new K],Pa=[new Rt,new Rt,new Rt],Ia=[new Rt,new Rt,new Rt],Da=new z,ja=new Kn,Ma=new Be,Ra=new vn;Ea._textureCoordinateRotationPoints=function(e,t,i,n){var r,a=Ve.center(n,Ta),o=K.toCartesian(a,i,Ca),s=xa.eastNorthUpToFixedFrame(o,i,Sa),c=Be.inverse(s,Sa),l=Pa,u=Aa;u[0].longitude=n.west,u[0].latitude=n.south,u[1].longitude=n.west,u[1].latitude=n.north,u[2].longitude=n.east,u[2].latitude=n.south;var h=Da;for(r=0;r<3;r++)K.toCartesian(u[r],i,h),h=Be.multiplyByPointAsVector(c,h,h),l[r].x=h.x,l[r].y=h.y;var d=Kn.fromAxisAngle(z.UNIT_Z,-t,ja),f=be.fromQuaternion(d,Ma),p=e.length,m=Number.POSITIVE_INFINITY,_=Number.POSITIVE_INFINITY,g=Number.NEGATIVE_INFINITY,v=Number.NEGATIVE_INFINITY;for(r=0;r<p;r++)h=Be.multiplyByPointAsVector(c,e[r],h),h=be.multiplyByVector(f,h,h),m=Math.min(m,h.x),_=Math.min(_,h.y),g=Math.max(g,h.x),v=Math.max(v,h.y);var b=vn.fromRotation(t,Ra),y=Ia;y[0].x=m,y[0].y=_,y[1].x=m,y[1].y=v,y[2].x=g,y[2].y=_;var w=l[0],O=l[2].x-w.x,x=l[1].y-w.y;for(r=0;r<3;r++){var E=y[r];vn.multiplyByVector(b,E,E),E.x=(E.x-w.x)/O,E.y=(E.y-w.y)/x}var T=y[0],C=y[1],S=y[2],A=new Array(6);return Rt.pack(T,A),Rt.pack(C,A,2),Rt.pack(S,A,4),A};var La=Ea;var Na=function(e){if(e=Object(w.a)(e,w.a.EMPTY_OBJECT),!Object(u.a)(e.componentDatatype))throw new h.a("options.componentDatatype is required.");if(!Object(u.a)(e.componentsPerAttribute))throw new h.a("options.componentsPerAttribute is required.");if(e.componentsPerAttribute<1||e.componentsPerAttribute>4)throw new h.a("options.componentsPerAttribute must be between 1 and 4.");if(!Object(u.a)(e.values))throw new h.a("options.values is required.");this.componentDatatype=e.componentDatatype,this.componentsPerAttribute=e.componentsPerAttribute,this.normalize=Object(w.a)(e.normalize,!1),this.values=e.values};var Fa=function(e){e=Object(w.a)(e,w.a.EMPTY_OBJECT),this.position=e.position,this.normal=e.normal,this.st=e.st,this.bitangent=e.bitangent,this.tangent=e.tangent,this.color=e.color};function ka(e){e=Object(w.a)(e,w.a.EMPTY_OBJECT),this.position=Object(w.a)(e.position,!1),this.normal=Object(w.a)(e.normal,!1),this.st=Object(w.a)(e.st,!1),this.bitangent=Object(w.a)(e.bitangent,!1),this.tangent=Object(w.a)(e.tangent,!1),this.color=Object(w.a)(e.color,!1)}ka.POSITION_ONLY=Object(E.a)(new ka({position:!0})),ka.POSITION_AND_NORMAL=Object(E.a)(new ka({position:!0,normal:!0})),ka.POSITION_NORMAL_AND_ST=Object(E.a)(new ka({position:!0,normal:!0,st:!0})),ka.POSITION_AND_ST=Object(E.a)(new ka({position:!0,st:!0})),ka.POSITION_AND_COLOR=Object(E.a)(new ka({position:!0,color:!0})),ka.ALL=Object(E.a)(new ka({position:!0,normal:!0,st:!0,tangent:!0,bitangent:!0})),ka.DEFAULT=ka.POSITION_NORMAL_AND_ST,ka.packedLength=6,ka.pack=function(e,t,i){if(!Object(u.a)(e))throw new h.a("value is required");if(!Object(u.a)(t))throw new h.a("array is required");return i=Object(w.a)(i,0),t[i++]=e.position?1:0,t[i++]=e.normal?1:0,t[i++]=e.st?1:0,t[i++]=e.tangent?1:0,t[i++]=e.bitangent?1:0,t[i]=e.color?1:0,t},ka.unpack=function(e,t,i){if(!Object(u.a)(e))throw new h.a("array is required");return t=Object(w.a)(t,0),Object(u.a)(i)||(i=new ka),i.position=1===e[t++],i.normal=1===e[t++],i.st=1===e[t++],i.tangent=1===e[t++],i.bitangent=1===e[t++],i.color=1===e[t],i},ka.clone=function(e,t){if(Object(u.a)(e))return Object(u.a)(t)||(t=new ka),t.position=e.position,t.normal=e.normal,t.st=e.st,t.tangent=e.tangent,t.bitangent=e.bitangent,t.color=e.color,t};var Ba=ka,za=new z;function Ua(e){var t=(e=Object(w.a)(e,w.a.EMPTY_OBJECT)).minimum,i=e.maximum;if(x.a.typeOf.object("min",t),x.a.typeOf.object("max",i),Object(u.a)(e.offsetAttribute)&&e.offsetAttribute===fn.TOP)throw new h.a("GeometryOffsetAttribute.TOP is not a supported options.offsetAttribute for this geometry.");var n=Object(w.a)(e.vertexFormat,Ba.DEFAULT);this._minimum=z.clone(t),this._maximum=z.clone(i),this._vertexFormat=n,this._offsetAttribute=e.offsetAttribute,this._workerName="createBoxGeometry"}Ua.fromDimensions=function(e){var t=(e=Object(w.a)(e,w.a.EMPTY_OBJECT)).dimensions;x.a.typeOf.object("dimensions",t),x.a.typeOf.number.greaterThanOrEquals("dimensions.x",t.x,0),x.a.typeOf.number.greaterThanOrEquals("dimensions.y",t.y,0),x.a.typeOf.number.greaterThanOrEquals("dimensions.z",t.z,0);var i=z.multiplyByScalar(t,.5,new z);return new Ua({minimum:z.negate(i,new z),maximum:i,vertexFormat:e.vertexFormat,offsetAttribute:e.offsetAttribute})},Ua.fromAxisAlignedBoundingBox=function(e){return x.a.typeOf.object("boundingBox",e),new Ua({minimum:e.minimum,maximum:e.maximum})},Ua.packedLength=2*z.packedLength+Ba.packedLength+1,Ua.pack=function(e,t,i){return x.a.typeOf.object("value",e),x.a.defined("array",t),i=Object(w.a)(i,0),z.pack(e._minimum,t,i),z.pack(e._maximum,t,i+z.packedLength),Ba.pack(e._vertexFormat,t,i+2*z.packedLength),t[i+2*z.packedLength+Ba.packedLength]=Object(w.a)(e._offsetAttribute,-1),t};var Va,Ha=new z,Ga=new z,qa=new Ba,Wa={minimum:Ha,maximum:Ga,vertexFormat:qa,offsetAttribute:void 0};Ua.unpack=function(e,t,i){x.a.defined("array",e),t=Object(w.a)(t,0);var n=z.unpack(e,t,Ha),r=z.unpack(e,t+z.packedLength,Ga),a=Ba.unpack(e,t+2*z.packedLength,qa),o=e[t+2*z.packedLength+Ba.packedLength];return Object(u.a)(i)?(i._minimum=z.clone(n,i._minimum),i._maximum=z.clone(r,i._maximum),i._vertexFormat=Ba.clone(a,i._vertexFormat),i._offsetAttribute=-1===o?void 0:o,i):(Wa.offsetAttribute=-1===o?void 0:o,new Ua(Wa))},Ua.createGeometry=function(e){var t=e._minimum,i=e._maximum,n=e._vertexFormat;if(!z.equals(t,i)){var r,a,o=new Fa;if(n.position&&(n.st||n.normal||n.tangent||n.bitangent)){if(n.position&&((a=new Float64Array(72))[0]=t.x,a[1]=t.y,a[2]=i.z,a[3]=i.x,a[4]=t.y,a[5]=i.z,a[6]=i.x,a[7]=i.y,a[8]=i.z,a[9]=t.x,a[10]=i.y,a[11]=i.z,a[12]=t.x,a[13]=t.y,a[14]=t.z,a[15]=i.x,a[16]=t.y,a[17]=t.z,a[18]=i.x,a[19]=i.y,a[20]=t.z,a[21]=t.x,a[22]=i.y,a[23]=t.z,a[24]=i.x,a[25]=t.y,a[26]=t.z,a[27]=i.x,a[28]=i.y,a[29]=t.z,a[30]=i.x,a[31]=i.y,a[32]=i.z,a[33]=i.x,a[34]=t.y,a[35]=i.z,a[36]=t.x,a[37]=t.y,a[38]=t.z,a[39]=t.x,a[40]=i.y,a[41]=t.z,a[42]=t.x,a[43]=i.y,a[44]=i.z,a[45]=t.x,a[46]=t.y,a[47]=i.z,a[48]=t.x,a[49]=i.y,a[50]=t.z,a[51]=i.x,a[52]=i.y,a[53]=t.z,a[54]=i.x,a[55]=i.y,a[56]=i.z,a[57]=t.x,a[58]=i.y,a[59]=i.z,a[60]=t.x,a[61]=t.y,a[62]=t.z,a[63]=i.x,a[64]=t.y,a[65]=t.z,a[66]=i.x,a[67]=t.y,a[68]=i.z,a[69]=t.x,a[70]=t.y,a[71]=i.z,o.position=new Na({componentDatatype:dn.DOUBLE,componentsPerAttribute:3,values:a})),n.normal){var s=new Float32Array(72);s[0]=0,s[1]=0,s[2]=1,s[3]=0,s[4]=0,s[5]=1,s[6]=0,s[7]=0,s[8]=1,s[9]=0,s[10]=0,s[11]=1,s[12]=0,s[13]=0,s[14]=-1,s[15]=0,s[16]=0,s[17]=-1,s[18]=0,s[19]=0,s[20]=-1,s[21]=0,s[22]=0,s[23]=-1,s[24]=1,s[25]=0,s[26]=0,s[27]=1,s[28]=0,s[29]=0,s[30]=1,s[31]=0,s[32]=0,s[33]=1,s[34]=0,s[35]=0,s[36]=-1,s[37]=0,s[38]=0,s[39]=-1,s[40]=0,s[41]=0,s[42]=-1,s[43]=0,s[44]=0,s[45]=-1,s[46]=0,s[47]=0,s[48]=0,s[49]=1,s[50]=0,s[51]=0,s[52]=1,s[53]=0,s[54]=0,s[55]=1,s[56]=0,s[57]=0,s[58]=1,s[59]=0,s[60]=0,s[61]=-1,s[62]=0,s[63]=0,s[64]=-1,s[65]=0,s[66]=0,s[67]=-1,s[68]=0,s[69]=0,s[70]=-1,s[71]=0,o.normal=new Na({componentDatatype:dn.FLOAT,componentsPerAttribute:3,values:s})}if(n.st){var c=new Float32Array(48);c[0]=0,c[1]=0,c[2]=1,c[3]=0,c[4]=1,c[5]=1,c[6]=0,c[7]=1,c[8]=1,c[9]=0,c[10]=0,c[11]=0,c[12]=0,c[13]=1,c[14]=1,c[15]=1,c[16]=0,c[17]=0,c[18]=1,c[19]=0,c[20]=1,c[21]=1,c[22]=0,c[23]=1,c[24]=1,c[25]=0,c[26]=0,c[27]=0,c[28]=0,c[29]=1,c[30]=1,c[31]=1,c[32]=1,c[33]=0,c[34]=0,c[35]=0,c[36]=0,c[37]=1,c[38]=1,c[39]=1,c[40]=0,c[41]=0,c[42]=1,c[43]=0,c[44]=1,c[45]=1,c[46]=0,c[47]=1,o.st=new Na({componentDatatype:dn.FLOAT,componentsPerAttribute:2,values:c})}if(n.tangent){var l=new Float32Array(72);l[0]=1,l[1]=0,l[2]=0,l[3]=1,l[4]=0,l[5]=0,l[6]=1,l[7]=0,l[8]=0,l[9]=1,l[10]=0,l[11]=0,l[12]=-1,l[13]=0,l[14]=0,l[15]=-1,l[16]=0,l[17]=0,l[18]=-1,l[19]=0,l[20]=0,l[21]=-1,l[22]=0,l[23]=0,l[24]=0,l[25]=1,l[26]=0,l[27]=0,l[28]=1,l[29]=0,l[30]=0,l[31]=1,l[32]=0,l[33]=0,l[34]=1,l[35]=0,l[36]=0,l[37]=-1,l[38]=0,l[39]=0,l[40]=-1,l[41]=0,l[42]=0,l[43]=-1,l[44]=0,l[45]=0,l[46]=-1,l[47]=0,l[48]=-1,l[49]=0,l[50]=0,l[51]=-1,l[52]=0,l[53]=0,l[54]=-1,l[55]=0,l[56]=0,l[57]=-1,l[58]=0,l[59]=0,l[60]=1,l[61]=0,l[62]=0,l[63]=1,l[64]=0,l[65]=0,l[66]=1,l[67]=0,l[68]=0,l[69]=1,l[70]=0,l[71]=0,o.tangent=new Na({componentDatatype:dn.FLOAT,componentsPerAttribute:3,values:l})}if(n.bitangent){var h=new Float32Array(72);h[0]=0,h[1]=1,h[2]=0,h[3]=0,h[4]=1,h[5]=0,h[6]=0,h[7]=1,h[8]=0,h[9]=0,h[10]=1,h[11]=0,h[12]=0,h[13]=1,h[14]=0,h[15]=0,h[16]=1,h[17]=0,h[18]=0,h[19]=1,h[20]=0,h[21]=0,h[22]=1,h[23]=0,h[24]=0,h[25]=0,h[26]=1,h[27]=0,h[28]=0,h[29]=1,h[30]=0,h[31]=0,h[32]=1,h[33]=0,h[34]=0,h[35]=1,h[36]=0,h[37]=0,h[38]=1,h[39]=0,h[40]=0,h[41]=1,h[42]=0,h[43]=0,h[44]=1,h[45]=0,h[46]=0,h[47]=1,h[48]=0,h[49]=0,h[50]=1,h[51]=0,h[52]=0,h[53]=1,h[54]=0,h[55]=0,h[56]=1,h[57]=0,h[58]=0,h[59]=1,h[60]=0,h[61]=0,h[62]=1,h[63]=0,h[64]=0,h[65]=1,h[66]=0,h[67]=0,h[68]=1,h[69]=0,h[70]=0,h[71]=1,o.bitangent=new Na({componentDatatype:dn.FLOAT,componentsPerAttribute:3,values:h})}(r=new Uint16Array(36))[0]=0,r[1]=1,r[2]=2,r[3]=0,r[4]=2,r[5]=3,r[6]=6,r[7]=5,r[8]=4,r[9]=7,r[10]=6,r[11]=4,r[12]=8,r[13]=9,r[14]=10,r[15]=8,r[16]=10,r[17]=11,r[18]=14,r[19]=13,r[20]=12,r[21]=15,r[22]=14,r[23]=12,r[24]=18,r[25]=17,r[26]=16,r[27]=19,r[28]=18,r[29]=16,r[30]=20,r[31]=21,r[32]=22,r[33]=20,r[34]=22,r[35]=23}else(a=new Float64Array(24))[0]=t.x,a[1]=t.y,a[2]=t.z,a[3]=i.x,a[4]=t.y,a[5]=t.z,a[6]=i.x,a[7]=i.y,a[8]=t.z,a[9]=t.x,a[10]=i.y,a[11]=t.z,a[12]=t.x,a[13]=t.y,a[14]=i.z,a[15]=i.x,a[16]=t.y,a[17]=i.z,a[18]=i.x,a[19]=i.y,a[20]=i.z,a[21]=t.x,a[22]=i.y,a[23]=i.z,o.position=new Na({componentDatatype:dn.DOUBLE,componentsPerAttribute:3,values:a}),(r=new Uint16Array(36))[0]=4,r[1]=5,r[2]=6,r[3]=4,r[4]=6,r[5]=7,r[6]=1,r[7]=0,r[8]=3,r[9]=1,r[10]=3,r[11]=2,r[12]=1,r[13]=6,r[14]=5,r[15]=1,r[16]=2,r[17]=6,r[18]=2,r[19]=3,r[20]=7,r[21]=2,r[22]=7,r[23]=6,r[24]=3,r[25]=0,r[26]=4,r[27]=3,r[28]=4,r[29]=7,r[30]=0,r[31]=1,r[32]=5,r[33]=0,r[34]=5,r[35]=4;var d=z.subtract(i,t,za),f=.5*z.magnitude(d);if(Object(u.a)(e._offsetAttribute)){var p=a.length,m=new Uint8Array(p/3),_=e._offsetAttribute===fn.NONE?0:1;Qt(m,_),o.applyOffset=new Na({componentDatatype:dn.UNSIGNED_BYTE,componentsPerAttribute:1,values:m})}return new La({attributes:o,indices:r,primitiveType:yn.TRIANGLES,boundingSphere:new St(z.ZERO,f),offsetAttribute:e._offsetAttribute})}},Ua.getUnitBox=function(){return Object(u.a)(Va)||(Va=Ua.createGeometry(Ua.fromDimensions({dimensions:new z(1,1,1),vertexFormat:Ba.POSITION_ONLY}))),Va};var Ya=Ua,Xa=new z;function Za(e){var t=(e=Object(w.a)(e,w.a.EMPTY_OBJECT)).minimum,i=e.maximum;if(x.a.typeOf.object("min",t),x.a.typeOf.object("max",i),Object(u.a)(e.offsetAttribute)&&e.offsetAttribute===fn.TOP)throw new h.a("GeometryOffsetAttribute.TOP is not a supported options.offsetAttribute for this geometry.");this._min=z.clone(t),this._max=z.clone(i),this._offsetAttribute=e.offsetAttribute,this._workerName="createBoxOutlineGeometry"}Za.fromDimensions=function(e){var t=(e=Object(w.a)(e,w.a.EMPTY_OBJECT)).dimensions;x.a.typeOf.object("dimensions",t),x.a.typeOf.number.greaterThanOrEquals("dimensions.x",t.x,0),x.a.typeOf.number.greaterThanOrEquals("dimensions.y",t.y,0),x.a.typeOf.number.greaterThanOrEquals("dimensions.z",t.z,0);var i=z.multiplyByScalar(t,.5,new z);return new Za({minimum:z.negate(i,new z),maximum:i,offsetAttribute:e.offsetAttribute})},Za.fromAxisAlignedBoundingBox=function(e){return x.a.typeOf.object("boundindBox",e),new Za({minimum:e.minimum,maximum:e.maximum})},Za.packedLength=2*z.packedLength+1,Za.pack=function(e,t,i){return x.a.typeOf.object("value",e),x.a.defined("array",t),i=Object(w.a)(i,0),z.pack(e._min,t,i),z.pack(e._max,t,i+z.packedLength),t[i+2*z.packedLength]=Object(w.a)(e._offsetAttribute,-1),t};var Qa=new z,Ka=new z,Ja={minimum:Qa,maximum:Ka,offsetAttribute:void 0};Za.unpack=function(e,t,i){x.a.defined("array",e),t=Object(w.a)(t,0);var n=z.unpack(e,t,Qa),r=z.unpack(e,t+z.packedLength,Ka),a=e[t+2*z.packedLength];return Object(u.a)(i)?(i._min=z.clone(n,i._min),i._max=z.clone(r,i._max),i._offsetAttribute=-1===a?void 0:a,i):(Ja.offsetAttribute=-1===a?void 0:a,new Za(Ja))},Za.createGeometry=function(e){var t=e._min,i=e._max;if(!z.equals(t,i)){var n=new Fa,r=new Uint16Array(24),a=new Float64Array(24);a[0]=t.x,a[1]=t.y,a[2]=t.z,a[3]=i.x,a[4]=t.y,a[5]=t.z,a[6]=i.x,a[7]=i.y,a[8]=t.z,a[9]=t.x,a[10]=i.y,a[11]=t.z,a[12]=t.x,a[13]=t.y,a[14]=i.z,a[15]=i.x,a[16]=t.y,a[17]=i.z,a[18]=i.x,a[19]=i.y,a[20]=i.z,a[21]=t.x,a[22]=i.y,a[23]=i.z,n.position=new Na({componentDatatype:dn.DOUBLE,componentsPerAttribute:3,values:a}),r[0]=4,r[1]=5,r[2]=5,r[3]=6,r[4]=6,r[5]=7,r[6]=7,r[7]=4,r[8]=0,r[9]=1,r[10]=1,r[11]=2,r[12]=2,r[13]=3,r[14]=3,r[15]=0,r[16]=0,r[17]=4,r[18]=1,r[19]=5,r[20]=2,r[21]=6,r[22]=3,r[23]=7;var o=z.subtract(i,t,Xa),s=.5*z.magnitude(o);if(Object(u.a)(e._offsetAttribute)){var c=a.length,l=new Uint8Array(c/3),h=e._offsetAttribute===fn.NONE?0:1;Qt(l,h),n.applyOffset=new Na({componentDatatype:dn.UNSIGNED_BYTE,componentsPerAttribute:1,values:l})}return new La({attributes:n,indices:r,primitiveType:yn.LINES,boundingSphere:new St(z.ZERO,s),offsetAttribute:e._offsetAttribute})}};var $a=Za,eo=window.cancelAnimationFrame;!function(){if(!Object(u.a)(eo))for(var e=["webkit","moz","ms","o"],t=0,i=e.length;t<i&&!Object(u.a)(eo);)eo=window[e[t]+"CancelAnimationFrame"],Object(u.a)(eo)||(eo=window[e[t]+"CancelRequestAnimationFrame"]),++t;Object(u.a)(eo)||(eo=clearTimeout)}();var to=function(e){eo(e)};function io(){}io.prototype.geocode=function(e){x.a.typeOf.string("query",e);var t=e.match(/[^\s,\n]+/g);if(2===t.length||3===t.length){var i=+t[0],n=+t[1],r=3===t.length?+t[2]:300;if(isNaN(i)&&isNaN(n))for(var a=/^(\d+.?\d*)([nsew])/i,o=0;o<t.length;++o){var s=t[o].match(a);a.test(t[o])&&3===s.length&&(/^[ns]/i.test(s[2])?n=/^[n]/i.test(s[2])?+s[1]:-s[1]:/^[ew]/i.test(s[2])&&(i=/^[e]/i.test(s[2])?+s[1]:-s[1]))}if(!isNaN(i)&&!isNaN(n)&&!isNaN(r)){var c={displayName:e,destination:z.fromDegrees(i,n,r)};return Oi.a.resolve([c])}}return Oi.a.resolve([])};var no=io;function ro(){this.times=void 0,this.points=void 0,h.a.throwInstantiationError()}ro.prototype.evaluate=h.a.throwInstantiationError,ro.prototype.findTimeInterval=function(e,t){var i,n=this.times,r=n.length;if(!Object(u.a)(e))throw new h.a("time is required.");if(e<n[0]||e>n[r-1])throw new h.a("time is out of range.");if(e>=n[t=Object(w.a)(t,0)]){if(t+1<r&&e<n[t+1])return t;if(t+2<r&&e<n[t+2])return t+1}else if(t-1>=0&&e>=n[t-1])return t-1;if(e>n[t])for(i=t;i<r-1&&!(e>=n[i]&&e<n[i+1]);++i);else for(i=t-1;i>=0&&!(e>=n[i]&&e<n[i+1]);--i);return i===r-1&&(i=r-2),i},ro.prototype.wrapTime=function(e){x.a.typeOf.number("time",e);var t=this.times,i=t[t.length-1],n=t[0],r=i-n;return e<n&&(e+=(Math.floor((n-e)/r)+1)*r),e>i&&(e-=(Math.floor((e-i)/r)+1)*r),e},ro.prototype.clampTime=function(e){x.a.typeOf.number("time",e);var t=this.times;return I.clamp(e,t[0],t[t.length-1])};var ao=ro;function oo(e){var t=(e=Object(w.a)(e,w.a.EMPTY_OBJECT)).points,i=e.times;if(!Object(u.a)(t)||!Object(u.a)(i))throw new h.a("points and times are required.");if(t.length<2)throw new h.a("points.length must be greater than or equal to 2.");if(i.length!==t.length)throw new h.a("times.length must be equal to points.length.");this._times=i,this._points=t,this._lastTimeIndex=0}Object(O.a)(oo.prototype,{times:{get:function(){return this._times}},points:{get:function(){return this._points}}}),oo.prototype.findTimeInterval=ao.prototype.findTimeInterval,oo.prototype.wrapTime=ao.prototype.wrapTime,oo.prototype.clampTime=ao.prototype.clampTime,oo.prototype.evaluate=function(e,t){var i=this.points,n=this.times,r=this._lastTimeIndex=this.findTimeInterval(e,this._lastTimeIndex),a=(e-n[r])/(n[r+1]-n[r]);return Object(u.a)(t)||(t=new z),z.lerp(i[r],i[r+1],a,t)};var so=oo,co={solve:function(e,t,i,n){if(!(Object(u.a)(e)&&e instanceof Array))throw new h.a("The array lower is required.");if(!(Object(u.a)(t)&&t instanceof Array))throw new h.a("The array diagonal is required.");if(!(Object(u.a)(i)&&i instanceof Array))throw new h.a("The array upper is required.");if(!(Object(u.a)(n)&&n instanceof Array))throw new h.a("The array right is required.");if(t.length!==n.length)throw new h.a("diagonal and right must have the same lengths.");if(e.length!==i.length)throw new h.a("lower and upper must have the same lengths.");if(e.length!==t.length-1)throw new h.a("lower and upper must be one less than the length of diagonal.");var r,a,o=new Array(i.length),s=new Array(n.length),c=new Array(n.length);for(r=0;r<s.length;r++)s[r]=new z,c[r]=new z;for(o[0]=i[0]/t[0],s[0]=z.multiplyByScalar(n[0],1/t[0],s[0]),r=1;r<o.length;++r)a=1/(t[r]-o[r-1]*e[r-1]),o[r]=i[r]*a,s[r]=z.subtract(n[r],z.multiplyByScalar(s[r-1],e[r-1],s[r]),s[r]),s[r]=z.multiplyByScalar(s[r],a,s[r]);for(a=1/(t[r]-o[r-1]*e[r-1]),s[r]=z.subtract(n[r],z.multiplyByScalar(s[r-1],e[r-1],s[r]),s[r]),s[r]=z.multiplyByScalar(s[r],a,s[r]),c[c.length-1]=s[s.length-1],r=c.length-2;r>=0;--r)c[r]=z.subtract(s[r],z.multiplyByScalar(c[r+1],o[r],c[r]),c[r]);return c}},lo=co,uo=[],ho=[],fo=[],po=[];function mo(e){var t=(e=Object(w.a)(e,w.a.EMPTY_OBJECT)).points,i=e.times,n=e.inTangents,r=e.outTangents;if(!(Object(u.a)(t)&&Object(u.a)(i)&&Object(u.a)(n)&&Object(u.a)(r)))throw new h.a("times, points, inTangents, and outTangents are required.");if(t.length<2)throw new h.a("points.length must be greater than or equal to 2.");if(i.length!==t.length)throw new h.a("times.length must be equal to points.length.");if(n.length!==r.length||n.length!==t.length-1)throw new h.a("inTangents and outTangents must have a length equal to points.length - 1.");this._times=i,this._points=t,this._inTangents=n,this._outTangents=r,this._lastTimeIndex=0}Object(O.a)(mo.prototype,{times:{get:function(){return this._times}},points:{get:function(){return this._points}},inTangents:{get:function(){return this._inTangents}},outTangents:{get:function(){return this._outTangents}}}),mo.createC1=function(e){var t=(e=Object(w.a)(e,w.a.EMPTY_OBJECT)).times,i=e.points,n=e.tangents;if(!Object(u.a)(i)||!Object(u.a)(t)||!Object(u.a)(n))throw new h.a("points, times and tangents are required.");if(i.length<2)throw new h.a("points.length must be greater than or equal to 2.");if(t.length!==i.length||t.length!==n.length)throw new h.a("times, points and tangents must have the same length.");var r=n.slice(0,n.length-1);return new mo({times:t,points:i,inTangents:n.slice(1,n.length),outTangents:r})},mo.createNaturalCubic=function(e){var t=(e=Object(w.a)(e,w.a.EMPTY_OBJECT)).times,i=e.points;if(!Object(u.a)(i)||!Object(u.a)(t))throw new h.a("points and times are required.");if(i.length<2)throw new h.a("points.length must be greater than or equal to 2.");if(t.length!==i.length)throw new h.a("times.length must be equal to points.length.");if(i.length<3)return new so({points:i,times:t});var n=function(e){var t,i=uo,n=fo,r=ho,a=po;i.length=n.length=e.length-1,r.length=a.length=e.length,i[0]=n[0]=1,r[0]=2;var o=a[0];for(Object(u.a)(o)||(o=a[0]=new z),z.subtract(e[1],e[0],o),z.multiplyByScalar(o,3,o),t=1;t<i.length;++t)i[t]=n[t]=1,r[t]=4,o=a[t],Object(u.a)(o)||(o=a[t]=new z),z.subtract(e[t+1],e[t-1],o),z.multiplyByScalar(o,3,o);return r[t]=2,o=a[t],Object(u.a)(o)||(o=a[t]=new z),z.subtract(e[t],e[t-1],o),z.multiplyByScalar(o,3,o),lo.solve(i,r,n,a)}(i),r=n.slice(0,n.length-1);return new mo({times:t,points:i,inTangents:n.slice(1,n.length),outTangents:r})},mo.createClampedCubic=function(e){var t=(e=Object(w.a)(e,w.a.EMPTY_OBJECT)).times,i=e.points,n=e.firstTangent,r=e.lastTangent;if(!(Object(u.a)(i)&&Object(u.a)(t)&&Object(u.a)(n)&&Object(u.a)(r)))throw new h.a("points, times, firstTangent and lastTangent are required.");if(i.length<2)throw new h.a("points.length must be greater than or equal to 2.");if(t.length!==i.length)throw new h.a("times.length must be equal to points.length.");if(i.length<3)return new so({points:i,times:t});var a=function(e,t,i){var n,r=uo,a=fo,o=ho,s=po;r.length=a.length=e.length-1,o.length=s.length=e.length,r[0]=o[0]=1,a[0]=0;var c=s[0];for(Object(u.a)(c)||(c=s[0]=new z),z.clone(t,c),n=1;n<r.length-1;++n)r[n]=a[n]=1,o[n]=4,c=s[n],Object(u.a)(c)||(c=s[n]=new z),z.subtract(e[n+1],e[n-1],c),z.multiplyByScalar(c,3,c);return r[n]=0,a[n]=1,o[n]=4,c=s[n],Object(u.a)(c)||(c=s[n]=new z),z.subtract(e[n+1],e[n-1],c),z.multiplyByScalar(c,3,c),o[n+1]=1,c=s[n+1],Object(u.a)(c)||(c=s[n+1]=new z),z.clone(i,c),lo.solve(r,o,a,s)}(i,n,r),o=a.slice(0,a.length-1);return new mo({times:t,points:i,inTangents:a.slice(1,a.length),outTangents:o})},mo.hermiteCoefficientMatrix=new Be(2,-3,0,1,-2,3,0,0,1,-2,1,0,1,-1,0,0),mo.prototype.findTimeInterval=ao.prototype.findTimeInterval;var _o=new Te,go=new z;mo.prototype.wrapTime=ao.prototype.wrapTime,mo.prototype.clampTime=ao.prototype.clampTime,mo.prototype.evaluate=function(e,t){Object(u.a)(t)||(t=new z);var i=this.points,n=this.times,r=this.inTangents,a=this.outTangents,o=this._lastTimeIndex=this.findTimeInterval(e,this._lastTimeIndex),s=(e-n[o])/(n[o+1]-n[o]),c=_o;c.z=s,c.y=s*s,c.x=c.y*s,c.w=1;var l=Be.multiplyByVector(mo.hermiteCoefficientMatrix,c,c);return t=z.multiplyByScalar(i[o],l.x,t),z.multiplyByScalar(i[o+1],l.y,go),z.add(t,go,t),z.multiplyByScalar(a[o],l.z,go),z.add(t,go,t),z.multiplyByScalar(r[o],l.w,go),z.add(t,go,t)};var vo=mo,bo=new Te,yo=new z,wo=new z;var Oo=new z,xo=new z;function Eo(e){var t=(e=Object(w.a)(e,w.a.EMPTY_OBJECT)).points,i=e.times,n=e.firstTangent,r=e.lastTangent;if(x.a.defined("points",t),x.a.defined("times",i),x.a.typeOf.number.greaterThanOrEquals("points.length",t.length,2),x.a.typeOf.number.equals("times.length","points.length",i.length,t.length),t.length>2&&(Object(u.a)(n)||(n=Oo,z.multiplyByScalar(t[1],2,n),z.subtract(n,t[2],n),z.subtract(n,t[0],n),z.multiplyByScalar(n,.5,n)),!Object(u.a)(r))){var a=t.length-1;r=xo,z.multiplyByScalar(t[a-1],2,r),z.subtract(t[a],r,r),z.add(r,t[a-2],r),z.multiplyByScalar(r,.5,r)}this._times=i,this._points=t,this._firstTangent=z.clone(n),this._lastTangent=z.clone(r),this._evaluateFunction=function(e){var t=e.points,i=e.times;if(t.length<3){var n=i[0],r=1/(i[1]-n),a=t[0],o=t[1];return function(e,t){Object(u.a)(t)||(t=new z);var i=(e-n)*r;return z.lerp(a,o,i,t)}}return function(n,r){Object(u.a)(r)||(r=new z);var a,o,s,c,l,h=e._lastTimeIndex=e.findTimeInterval(n,e._lastTimeIndex),d=(n-i[h])/(i[h+1]-i[h]),f=bo;return f.z=d,f.y=d*d,f.x=f.y*d,f.w=1,0===h?(a=t[0],o=t[1],s=e.firstTangent,c=z.subtract(t[2],a,yo),z.multiplyByScalar(c,.5,c),l=Be.multiplyByVector(vo.hermiteCoefficientMatrix,f,f)):h===t.length-2?(a=t[h],o=t[h+1],c=e.lastTangent,s=z.subtract(o,t[h-1],yo),z.multiplyByScalar(s,.5,s),l=Be.multiplyByVector(vo.hermiteCoefficientMatrix,f,f)):(a=t[h-1],o=t[h],s=t[h+1],c=t[h+2],l=Be.multiplyByVector(Eo.catmullRomCoefficientMatrix,f,f)),r=z.multiplyByScalar(a,l.x,r),z.multiplyByScalar(o,l.y,wo),z.add(r,wo,r),z.multiplyByScalar(s,l.z,wo),z.add(r,wo,r),z.multiplyByScalar(c,l.w,wo),z.add(r,wo,r)}}(this),this._lastTimeIndex=0}Object(O.a)(Eo.prototype,{times:{get:function(){return this._times}},points:{get:function(){return this._points}},firstTangent:{get:function(){return this._firstTangent}},lastTangent:{get:function(){return this._lastTangent}}}),Eo.catmullRomCoefficientMatrix=new Be(-.5,1,-.5,0,1.5,-2.5,0,1,-1.5,2,.5,0,.5,-.5,0,0),Eo.prototype.findTimeInterval=ao.prototype.findTimeInterval,Eo.prototype.wrapTime=ao.prototype.wrapTime,Eo.prototype.clampTime=ao.prototype.clampTime,Eo.prototype.evaluate=function(e,t){return this._evaluateFunction(e,t)};var To=Eo,Co=n(18),So=["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"],Ao=["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","audio","canvas","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","video","view","vkern"],Po=["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"],Io=["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmuliscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mpspace","msqrt","mystyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"],Do=["#text"],jo=["accept","action","align","alt","autocomplete","background","bgcolor","border","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","coords","crossorigin","datetime","default","dir","disabled","download","enctype","face","for","headers","height","hidden","high","href","hreflang","id","integrity","ismap","label","lang","list","loop","low","max","maxlength","media","method","min","multiple","name","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","type","usemap","valign","value","width","xmlns"],Mo=["accent-height","accumulate","additivive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","tabindex","targetx","targety","transform","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"],Ro=["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"],Lo=["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"];function No(e,t){for(var i=t.length;i--;)"string"==typeof t[i]&&(t[i]=t[i].toLowerCase()),e[t[i]]=!0;return e}function Fo(e){var t={},i=void 0;for(i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}var ko=/\{\{[\s\S]*|[\s\S]*\}\}/gm,Bo=/<%[\s\S]*|[\s\S]*%>/gm,zo=/^data-[\-\w.\u00B7-\uFFFF]/,Uo=/^aria-[\-\w]+$/,Vo=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,Ho=/^(?:\w+script|data):/i,Go=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,qo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function Wo(e){if(Array.isArray(e)){for(var t=0,i=Array(e.length);t<e.length;t++)i[t]=e[t];return i}return Array.from(e)}var Yo=function(){return"undefined"==typeof window?null:window};var Xo=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Yo(),i=function(t){return e(t)};if(i.version="1.0.8",i.removed=[],!t||!t.document||9!==t.document.nodeType)return i.isSupported=!1,i;var n=t.document,r=!1,a=!1,o=t.document,s=t.DocumentFragment,c=t.HTMLTemplateElement,l=t.Node,u=t.NodeFilter,h=t.NamedNodeMap,d=void 0===h?t.NamedNodeMap||t.MozNamedAttrMap:h,f=t.Text,p=t.Comment,m=t.DOMParser;if("function"==typeof c){var _=o.createElement("template");_.content&&_.content.ownerDocument&&(o=_.content.ownerDocument)}var g=o,v=g.implementation,b=g.createNodeIterator,y=g.getElementsByTagName,w=g.createDocumentFragment,O=n.importNode,x={};i.isSupported=v&&void 0!==v.createHTMLDocument&&9!==o.documentMode;var E=ko,T=Bo,C=zo,S=Uo,A=Ho,P=Go,I=Vo,D=null,j=No({},[].concat(Wo(So),Wo(Ao),Wo(Po),Wo(Io),Wo(Do))),M=null,R=No({},[].concat(Wo(jo),Wo(Mo),Wo(Ro),Wo(Lo))),L=null,N=null,F=!0,k=!0,B=!1,z=!1,U=!1,V=!1,H=!1,G=!1,q=!1,W=!1,Y=!1,X=!0,Z=!0,Q=!1,K={},J=No({},["audio","head","math","script","style","template","svg","video"]),$=No({},["audio","video","img","source","image"]),ee=No({},["alt","class","for","id","label","name","pattern","placeholder","summary","title","value","style","xmlns"]),te=null,ie=o.createElement("form"),ne=function(e){"object"!==(void 0===e?"undefined":qo(e))&&(e={}),D="ALLOWED_TAGS"in e?No({},e.ALLOWED_TAGS):j,M="ALLOWED_ATTR"in e?No({},e.ALLOWED_ATTR):R,L="FORBID_TAGS"in e?No({},e.FORBID_TAGS):{},N="FORBID_ATTR"in e?No({},e.FORBID_ATTR):{},K="USE_PROFILES"in e&&e.USE_PROFILES,F=!1!==e.ALLOW_ARIA_ATTR,k=!1!==e.ALLOW_DATA_ATTR,B=e.ALLOW_UNKNOWN_PROTOCOLS||!1,z=e.SAFE_FOR_JQUERY||!1,U=e.SAFE_FOR_TEMPLATES||!1,V=e.WHOLE_DOCUMENT||!1,q=e.RETURN_DOM||!1,W=e.RETURN_DOM_FRAGMENT||!1,Y=e.RETURN_DOM_IMPORT||!1,G=e.FORCE_BODY||!1,X=!1!==e.SANITIZE_DOM,Z=!1!==e.KEEP_CONTENT,Q=e.IN_PLACE||!1,I=e.ALLOWED_URI_REGEXP||I,U&&(k=!1),W&&(q=!0),K&&(D=No({},[].concat(Wo(Do))),M=[],!0===K.html&&(No(D,So),No(M,jo)),!0===K.svg&&(No(D,Ao),No(M,Mo),No(M,Lo)),!0===K.svgFilters&&(No(D,Po),No(M,Mo),No(M,Lo)),!0===K.mathMl&&(No(D,Io),No(M,Ro),No(M,Lo))),e.ADD_TAGS&&(D===j&&(D=Fo(D)),No(D,e.ADD_TAGS)),e.ADD_ATTR&&(M===R&&(M=Fo(M)),No(M,e.ADD_ATTR)),e.ADD_URI_SAFE_ATTR&&No(ee,e.ADD_URI_SAFE_ATTR),Z&&(D["#text"]=!0),V&&No(D,["html","head","body"]),D.table&&No(D,["tbody"]),Object&&"freeze"in Object&&Object.freeze(e),te=e},re=function(e){i.removed.push({element:e});try{e.parentNode.removeChild(e)}catch(t){e.outerHTML=""}},ae=function(e,t){try{i.removed.push({attribute:t.getAttributeNode(e),from:t})}catch(e){i.removed.push({attribute:null,from:t})}t.removeAttribute(e)},oe=function(e){var t=void 0,i=void 0;if(G)e="<remove></remove>"+e;else{var n=e.match(/^[\s]+/);(i=n&&n[0])&&(e=e.slice(i.length))}if(r)try{t=(new m).parseFromString(e,"text/html")}catch(e){}if(a&&No(L,["title"]),!t||!t.documentElement){var s=(t=v.createHTMLDocument("")).body;s.parentNode.removeChild(s.parentNode.firstElementChild),s.outerHTML=e}return i&&t.body.insertBefore(o.createTextNode(i),t.body.childNodes[0]||null),y.call(t,V?"html":"body")[0]};i.isSupported&&(function(){try{oe('<svg><p><style><img src="</style><img src=x onerror=alert(1)//">').querySelector("svg img")&&(r=!0)}catch(e){}}(),function(){try{oe("<x/><title>&lt;/title&gt;&lt;img&gt;").querySelector("title").textContent.match(/<\/title/)&&(a=!0)}catch(e){}}());var se=function(e){return b.call(e.ownerDocument||e,e,u.SHOW_ELEMENT|u.SHOW_COMMENT|u.SHOW_TEXT,(function(){return u.FILTER_ACCEPT}),!1)},ce=function(e){return"object"===(void 0===l?"undefined":qo(l))?e instanceof l:e&&"object"===(void 0===e?"undefined":qo(e))&&"number"==typeof e.nodeType&&"string"==typeof e.nodeName},le=function(e,t,n){x[e]&&x[e].forEach((function(e){e.call(i,t,n,te)}))},ue=function(e){var t,n=void 0;if(le("beforeSanitizeElements",e,null),!((t=e)instanceof f||t instanceof p||"string"==typeof t.nodeName&&"string"==typeof t.textContent&&"function"==typeof t.removeChild&&t.attributes instanceof d&&"function"==typeof t.removeAttribute&&"function"==typeof t.setAttribute))return re(e),!0;var r=e.nodeName.toLowerCase();if(le("uponSanitizeElement",e,{tagName:r,allowedTags:D}),!D[r]||L[r]){if(Z&&!J[r]&&"function"==typeof e.insertAdjacentHTML)try{e.insertAdjacentHTML("AfterEnd",e.innerHTML)}catch(e){}return re(e),!0}return!z||e.firstElementChild||e.content&&e.content.firstElementChild||!/</g.test(e.textContent)||(i.removed.push({element:e.cloneNode()}),e.innerHTML?e.innerHTML=e.innerHTML.replace(/</g,"&lt;"):e.innerHTML=e.textContent.replace(/</g,"&lt;")),U&&3===e.nodeType&&(n=(n=(n=e.textContent).replace(E," ")).replace(T," "),e.textContent!==n&&(i.removed.push({element:e.cloneNode()}),e.textContent=n)),le("afterSanitizeElements",e,null),!1},he=function(e,t,i){if(X&&("id"===t||"name"===t)&&(i in o||i in ie))return!1;if(U&&(i=(i=i.replace(E," ")).replace(T," ")),k&&C.test(t));else if(F&&S.test(t));else{if(!M[t]||N[t])return!1;if(ee[t]);else if(I.test(i.replace(P,"")));else if("src"!==t&&"xlink:href"!==t||"script"===e||0!==i.indexOf("data:")||!$[e]){if(B&&!A.test(i.replace(P,"")));else if(i)return!1}else;}return!0},de=function(e){var t=void 0,n=void 0,r=void 0,a=void 0,o=void 0;le("beforeSanitizeAttributes",e,null);var s=e.attributes;if(s){var c={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:M};for(o=s.length;o--;){var l=t=s[o],u=l.name,h=l.namespaceURI;if(n=t.value.trim(),r=u.toLowerCase(),c.attrName=r,c.attrValue=n,c.keepAttr=!0,le("uponSanitizeAttribute",e,c),n=c.attrValue,"name"===r&&"IMG"===e.nodeName&&s.id)a=s.id,s=Array.prototype.slice.apply(s),ae("id",e),ae(u,e),s.indexOf(a)>o&&e.setAttribute("id",a.value);else{if("INPUT"===e.nodeName&&"type"===r&&"file"===n&&(M[r]||!N[r]))continue;"id"===u&&e.setAttribute(u,""),ae(u,e)}if(c.keepAttr){var d=e.nodeName.toLowerCase();if(he(d,r,n))try{h?e.setAttributeNS(h,u,n):e.setAttribute(u,n),i.removed.pop()}catch(e){}}}le("afterSanitizeAttributes",e,null)}},fe=function e(t){var i=void 0,n=se(t);for(le("beforeSanitizeShadowDOM",t,null);i=n.nextNode();)le("uponSanitizeShadowNode",i,null),ue(i)||(i.content instanceof s&&e(i.content),de(i));le("afterSanitizeShadowDOM",t,null)};return i.sanitize=function(e,r){var a=void 0,o=void 0,c=void 0,u=void 0,h=void 0;if(e||(e="\x3c!--\x3e"),"string"!=typeof e&&!ce(e)){if("function"!=typeof e.toString)throw new TypeError("toString is not a function");if("string"!=typeof(e=e.toString()))throw new TypeError("dirty is not a string, aborting")}if(!i.isSupported){if("object"===qo(t.toStaticHTML)||"function"==typeof t.toStaticHTML){if("string"==typeof e)return t.toStaticHTML(e);if(ce(e))return t.toStaticHTML(e.outerHTML)}return e}if(H||ne(r),i.removed=[],Q);else if(e instanceof l)1===(o=(a=oe("\x3c!--\x3e")).ownerDocument.importNode(e,!0)).nodeType&&"BODY"===o.nodeName?a=o:a.appendChild(o);else{if(!q&&!V&&-1===e.indexOf("<"))return e;if(!(a=oe(e)))return q?null:""}a&&G&&re(a.firstChild);for(var d=se(Q?e:a);c=d.nextNode();)3===c.nodeType&&c===u||ue(c)||(c.content instanceof s&&fe(c.content),de(c),u=c);if(Q)return e;if(q){if(W)for(h=w.call(a.ownerDocument);a.firstChild;)h.appendChild(a.firstChild);else h=a;return Y&&(h=O.call(n,h,!0)),h}return V?a.outerHTML:a.innerHTML},i.setConfig=function(e){ne(e),H=!0},i.clearConfig=function(){te=null,H=!1},i.isValidAttribute=function(e,t,i){te||ne({});var n=e.toLowerCase(),r=t.toLowerCase();return he(n,r,i)},i.addHook=function(e,t){"function"==typeof t&&(x[e]=x[e]||[],x[e].push(t))},i.removeHook=function(e){x[e]&&x[e].pop()},i.removeHooks=function(e){x[e]&&(x[e]=[])},i.removeAllHooks=function(){x={}},i}(),Zo=0,Qo={};function Ko(e,t){var i;x.a.typeOf.string("html",e);var n=e;Object(u.a)(Qo[n])?i=Qo[n]:(i=Zo++,Qo[n]=i),t=Object(w.a)(t,!1),this._id=i,this._html=e,this._showOnScreen=t,this._element=void 0}Object(O.a)(Ko.prototype,{html:{get:function(){return this._html}},id:{get:function(){return this._id}},showOnScreen:{get:function(){return this._showOnScreen}},element:{get:function(){if(!Object(u.a)(this._element)){var e=Xo.sanitize(this._html),t=document.createElement("div");t._creditId=this._id,t.style.display="inline",t.innerHTML=e;for(var i=t.querySelectorAll("a"),n=0;n<i.length;n++)i[n].setAttribute("target","_blank");this._element=t}return this._element}}}),Ko.equals=function(e,t){return e===t||Object(u.a)(e)&&Object(u.a)(t)&&e._id===t._id},Ko.prototype.equals=function(e){return Ko.equals(this,e)},Ko.getIonCredit=function(e){var t=Object(u.a)(e.collapsible)&&!e.collapsible,i=new Ko(e.html,t);return i._isIon=-1!==i.html.indexOf("ion-credit.png"),i},Ko.clone=function(e){if(Object(u.a)(e))return new Ko(e.html,e.showOnScreen)};var Jo=Ko,$o=n(6);function es(e,t,i){if(!Object(u.a)(e))throw new h.a("uint8Array is required.");if(t<0)throw new h.a("byteOffset cannot be negative.");if(i<0)throw new h.a("byteLength cannot be negative.");if(t+i>e.byteLength)throw new h.a("sub-region exceeds array bounds.");return t=Object(w.a)(t,0),i=Object(w.a)(i,e.byteLength-t),e=e.subarray(t,t+i),es.decode(e)}function ts(e,t,i){return t<=e&&e<=i}es.decodeWithTextDecoder=function(e){return new TextDecoder("utf-8").decode(e)},es.decodeWithFromCharCode=function(e){for(var t="",i=function(e){for(var t=0,i=0,n=0,r=128,a=191,o=[],s=e.length,c=0;c<s;++c){var l=e[c];if(0===n){if(ts(l,0,127)){o.push(l);continue}if(ts(l,194,223)){n=1,t=31&l;continue}if(ts(l,224,239)){224===l&&(r=160),237===l&&(a=159),n=2,t=15&l;continue}if(ts(l,240,244)){240===l&&(r=144),244===l&&(a=143),n=3,t=7&l;continue}throw new Ce.a("String decoding failed.")}ts(l,r,a)?(r=128,a=191,t=t<<6|63&l,++i===n&&(o.push(t),t=n=i=0)):(t=n=i=0,r=128,a=191,--c)}return o}(e),n=i.length,r=0;r<n;++r){var a=i[r];a<=65535?t+=String.fromCharCode(a):(a-=65536,t+=String.fromCharCode(55296+(a>>10),56320+(1023&a)))}return t},"undefined"!=typeof TextDecoder?es.decode=es.decodeWithTextDecoder:es.decode=es.decodeWithFromCharCode;var is=es;function ns(e,t){x.a.typeOf.object("ellipsoid",e),this._ellipsoid=e,this._cameraPosition=new z,this._cameraPositionInScaledSpace=new z,this._distanceToLimbInScaledSpaceSquared=0,Object(u.a)(t)&&(this.cameraPosition=t)}Object(O.a)(ns.prototype,{ellipsoid:{get:function(){return this._ellipsoid}},cameraPosition:{get:function(){return this._cameraPosition},set:function(e){var t=this._ellipsoid.transformPositionToScaledSpace(e,this._cameraPositionInScaledSpace),i=z.magnitudeSquared(t)-1;z.clone(e,this._cameraPosition),this._cameraPositionInScaledSpace=t,this._distanceToLimbInScaledSpaceSquared=i}}});var rs=new z;ns.prototype.isPointVisible=function(e){var t=this._ellipsoid.transformPositionToScaledSpace(e,rs);return this.isScaledSpacePointVisible(t)},ns.prototype.isScaledSpacePointVisible=function(e){var t=this._cameraPositionInScaledSpace,i=this._distanceToLimbInScaledSpaceSquared,n=z.subtract(e,t,rs),r=-z.dot(n,t);return!(i<0?r>0:r>i&&r*r/z.magnitudeSquared(n)>i)},ns.prototype.computeHorizonCullingPoint=function(e,t,i){x.a.typeOf.object("directionToPoint",e),x.a.defined("positions",t),Object(u.a)(i)||(i=new z);for(var n=this._ellipsoid,r=ds(n,e),a=0,o=0,s=t.length;o<s;++o){var c=ls(n,t[o],r);a=Math.max(a,c)}return us(r,a,i)};var as=new z;ns.prototype.computeHorizonCullingPointFromVertices=function(e,t,i,n,r){x.a.typeOf.object("directionToPoint",e),x.a.defined("vertices",t),x.a.typeOf.number("stride",i),Object(u.a)(r)||(r=new z),n=Object(w.a)(n,z.ZERO);for(var a=this._ellipsoid,o=ds(a,e),s=0,c=0,l=t.length;c<l;c+=i){as.x=t[c]+n.x,as.y=t[c+1]+n.y,as.z=t[c+2]+n.z;var h=ls(a,as,o);s=Math.max(s,h)}return us(o,s,r)};var os=[];ns.prototype.computeHorizonCullingPointFromRectangle=function(e,t,i){x.a.typeOf.object("rectangle",e);var n=Ve.subsample(e,t,0,os),r=St.fromPoints(n);if(!(z.magnitude(r.center)<.1*t.minimumRadius))return this.computeHorizonCullingPoint(r.center,n,i)};var ss=new z,cs=new z;function ls(e,t,i){var n=e.transformPositionToScaledSpace(t,ss),r=z.magnitudeSquared(n),a=Math.sqrt(r),o=z.divideByScalar(n,a,cs);r=Math.max(1,r);var s=1/(a=Math.max(1,a));return 1/(z.dot(o,i)*s-z.magnitude(z.cross(o,i,o))*(Math.sqrt(r-1)*s))}function us(e,t,i){if(!(t<=0||t===1/0||t!=t))return z.multiplyByScalar(e,t,i)}var hs=new z;function ds(e,t){return z.equals(t,z.ZERO)?t:(e.transformPositionToScaledSpace(t,hs),z.normalize(hs,hs))}var fs=ns,ps={};function ms(e,t,i){var n=e+t;return I.sign(e)!==I.sign(t)&&Math.abs(n/Math.max(Math.abs(e),Math.abs(t)))<i?0:n}ps.computeDiscriminant=function(e,t,i){if("number"!=typeof e)throw new h.a("a is a required number.");if("number"!=typeof t)throw new h.a("b is a required number.");if("number"!=typeof i)throw new h.a("c is a required number.");return t*t-4*e*i},ps.computeRealRoots=function(e,t,i){if("number"!=typeof e)throw new h.a("a is a required number.");if("number"!=typeof t)throw new h.a("b is a required number.");if("number"!=typeof i)throw new h.a("c is a required number.");var n;if(0===e)return 0===t?[]:[-i/t];if(0===t){if(0===i)return[0,0];var r=Math.abs(i),a=Math.abs(e);if(r<a&&r/a<I.EPSILON14)return[0,0];if(r>a&&a/r<I.EPSILON14)return[];if((n=-i/e)<0)return[];var o=Math.sqrt(n);return[-o,o]}if(0===i)return(n=-t/e)<0?[n,0]:[0,n];var s=ms(t*t,-(4*e*i),I.EPSILON14);if(s<0)return[];var c=-.5*ms(t,I.sign(t)*Math.sqrt(s),I.EPSILON14);return t>0?[c/e,i/c]:[i/c,c/e]};var _s=ps,gs={};function vs(e,t,i,n){var r,a,o=e,s=t/3,c=i/3,l=n,u=o*c,h=s*l,d=s*s,f=c*c,p=o*c-d,m=o*l-s*c,_=s*l-f,g=4*p*_-m*m;if(g<0){var v,b,y;d*h>=u*f?(v=o,b=p,y=-2*s*p+o*m):(v=l,b=_,y=-l*m+2*c*_);var w=-(y<0?-1:1)*Math.abs(v)*Math.sqrt(-g),O=(a=-y+w)/2,x=O<0?-Math.pow(-O,1/3):Math.pow(O,1/3),E=a===w?-x:-b/x;return r=b<=0?x+E:-y/(x*x+E*E+b),d*h>=u*f?[(r-s)/o]:[-l/(r+c)]}var T=p,C=-2*s*p+o*m,S=_,A=-l*m+2*c*_,P=Math.sqrt(g),I=Math.sqrt(3)/2,D=Math.abs(Math.atan2(o*P,-C)/3);r=2*Math.sqrt(-T);var j=Math.cos(D);a=r*j;var M=r*(-j/2-I*Math.sin(D)),R=a+M>2*s?a-s:M-s,L=o,N=R/L;D=Math.abs(Math.atan2(l*P,-A)/3);var F=-l,k=(a=(r=2*Math.sqrt(-S))*(j=Math.cos(D)))+(M=r*(-j/2-I*Math.sin(D)))<2*c?a+c:M+c,B=F/k,z=-R*k-L*F,U=(c*z-s*(R*F))/(-s*z+c*(L*k));return N<=U?N<=B?U<=B?[N,U,B]:[N,B,U]:[B,N,U]:N<=B?[U,N,B]:U<=B?[U,B,N]:[B,U,N]}gs.computeDiscriminant=function(e,t,i,n){if("number"!=typeof e)throw new h.a("a is a required number.");if("number"!=typeof t)throw new h.a("b is a required number.");if("number"!=typeof i)throw new h.a("c is a required number.");if("number"!=typeof n)throw new h.a("d is a required number.");var r=t*t,a=i*i;return 18*e*t*i*n+r*a-27*(e*e)*(n*n)-4*(e*a*i+r*t*n)},gs.computeRealRoots=function(e,t,i,n){if("number"!=typeof e)throw new h.a("a is a required number.");if("number"!=typeof t)throw new h.a("b is a required number.");if("number"!=typeof i)throw new h.a("c is a required number.");if("number"!=typeof n)throw new h.a("d is a required number.");var r,a;if(0===e)return _s.computeRealRoots(t,i,n);if(0===t){if(0===i){if(0===n)return[0,0,0];var o=(a=-n/e)<0?-Math.pow(-a,1/3):Math.pow(a,1/3);return[o,o,o]}return 0===n?0===(r=_s.computeRealRoots(e,0,i)).Length?[0]:[r[0],0,r[1]]:vs(e,0,i,n)}return 0===i?0===n?(a=-t/e)<0?[a,0,0]:[0,0,a]:vs(e,t,0,n):0===n?0===(r=_s.computeRealRoots(e,t,i)).length?[0]:r[1]<=0?[r[0],r[1],0]:r[0]>=0?[0,r[0],r[1]]:[r[0],0,r[1]]:vs(e,t,i,n)};var bs=gs,ys={};function ws(e,t,i,n){var r=e*e,a=t-3*r/8,o=i-t*e/2+r*e/8,s=n-i*e/4+t*r/16-3*r*r/256,c=bs.computeRealRoots(1,2*a,a*a-4*s,-o*o);if(c.length>0){var l=-e/4,u=c[c.length-1];if(Math.abs(u)<I.EPSILON14){var h=_s.computeRealRoots(1,a,s);if(2===h.length){var d,f=h[0],p=h[1];if(f>=0&&p>=0){var m=Math.sqrt(f),_=Math.sqrt(p);return[l-_,l-m,l+m,l+_]}if(f>=0&&p<0)return[l-(d=Math.sqrt(f)),l+d];if(f<0&&p>=0)return[l-(d=Math.sqrt(p)),l+d]}return[]}if(u>0){var g=Math.sqrt(u),v=(a+u-o/g)/2,b=(a+u+o/g)/2,y=_s.computeRealRoots(1,g,v),w=_s.computeRealRoots(1,-g,b);return 0!==y.length?(y[0]+=l,y[1]+=l,0!==w.length?(w[0]+=l,w[1]+=l,y[1]<=w[0]?[y[0],y[1],w[0],w[1]]:w[1]<=y[0]?[w[0],w[1],y[0],y[1]]:y[0]>=w[0]&&y[1]<=w[1]?[w[0],y[0],y[1],w[1]]:w[0]>=y[0]&&w[1]<=y[1]?[y[0],w[0],w[1],y[1]]:y[0]>w[0]&&y[0]<w[1]?[w[0],y[0],w[1],y[1]]:[y[0],w[0],y[1],w[1]]):y):0!==w.length?(w[0]+=l,w[1]+=l,w):[]}}return[]}function Os(e,t,i,n){var r=e*e,a=-2*t,o=i*e+t*t-4*n,s=r*n-i*t*e+i*i,c=bs.computeRealRoots(1,a,o,s);if(c.length>0){var l,u,h,d,f,p,m=c[0],_=t-m,g=_*_,v=e/2,b=_/2,y=g-4*n,w=g+4*Math.abs(n),O=r-4*m,x=r+4*Math.abs(m);if(m<0||y*x<O*w){var E=Math.sqrt(O);l=E/2,u=0===E?0:(e*b-i)/E}else{var T=Math.sqrt(y);l=0===T?0:(e*b-i)/T,u=T/2}0===v&&0===l?(h=0,d=0):I.sign(v)===I.sign(l)?d=m/(h=v+l):h=m/(d=v-l),0===b&&0===u?(f=0,p=0):I.sign(b)===I.sign(u)?p=n/(f=b+u):f=n/(p=b-u);var C=_s.computeRealRoots(1,h,f),S=_s.computeRealRoots(1,d,p);if(0!==C.length)return 0!==S.length?C[1]<=S[0]?[C[0],C[1],S[0],S[1]]:S[1]<=C[0]?[S[0],S[1],C[0],C[1]]:C[0]>=S[0]&&C[1]<=S[1]?[S[0],C[0],C[1],S[1]]:S[0]>=C[0]&&S[1]<=C[1]?[C[0],S[0],S[1],C[1]]:C[0]>S[0]&&C[0]<S[1]?[S[0],C[0],S[1],C[1]]:[C[0],S[0],C[1],S[1]]:C;if(0!==S.length)return S}return[]}ys.computeDiscriminant=function(e,t,i,n,r){if("number"!=typeof e)throw new h.a("a is a required number.");if("number"!=typeof t)throw new h.a("b is a required number.");if("number"!=typeof i)throw new h.a("c is a required number.");if("number"!=typeof n)throw new h.a("d is a required number.");if("number"!=typeof r)throw new h.a("e is a required number.");var a=e*e,o=t*t,s=o*t,c=i*i,l=c*i,u=n*n,d=u*n,f=r*r;return o*c*u-4*s*d-4*e*l*u+18*e*t*i*d-27*a*u*u+256*(a*e)*(f*r)+r*(18*s*i*n-4*o*l+16*e*c*c-80*e*t*c*n-6*e*o*u+144*a*i*u)+f*(144*e*o*i-27*o*o-128*a*c-192*a*t*n)},ys.computeRealRoots=function(e,t,i,n,r){if("number"!=typeof e)throw new h.a("a is a required number.");if("number"!=typeof t)throw new h.a("b is a required number.");if("number"!=typeof i)throw new h.a("c is a required number.");if("number"!=typeof n)throw new h.a("d is a required number.");if("number"!=typeof r)throw new h.a("e is a required number.");if(Math.abs(e)<I.EPSILON15)return bs.computeRealRoots(t,i,n,r);var a=t/e,o=i/e,s=n/e,c=r/e,l=a<0?1:0;switch(l+=o<0?l+1:l,l+=s<0?l+1:l,l+=c<0?l+1:l){case 0:return ws(a,o,s,c);case 1:case 2:return Os(a,o,s,c);case 3:case 4:return ws(a,o,s,c);case 5:return Os(a,o,s,c);case 6:case 7:return ws(a,o,s,c);case 8:return Os(a,o,s,c);case 9:case 10:return ws(a,o,s,c);case 11:return Os(a,o,s,c);case 12:case 13:case 14:case 15:return ws(a,o,s,c);default:return}};var xs=ys;function Es(e,t){t=z.clone(Object(w.a)(t,z.ZERO)),z.equals(t,z.ZERO)||z.normalize(t,t),this.origin=z.clone(Object(w.a)(e,z.ZERO)),this.direction=t}Es.clone=function(e,t){if(Object(u.a)(e))return Object(u.a)(t)?(t.origin=z.clone(e.origin),t.direction=z.clone(e.direction),t):new Es(e.origin,e.direction)},Es.getPoint=function(e,t,i){return x.a.typeOf.object("ray",e),x.a.typeOf.number("t",t),Object(u.a)(i)||(i=new z),i=z.multiplyByScalar(e.direction,t,i),z.add(e.origin,i,i)};var Ts=Es,Cs={rayPlane:function(e,t,i){if(!Object(u.a)(e))throw new h.a("ray is required.");if(!Object(u.a)(t))throw new h.a("plane is required.");Object(u.a)(i)||(i=new z);var n=e.origin,r=e.direction,a=t.normal,o=z.dot(a,r);if(!(Math.abs(o)<I.EPSILON15)){var s=(-t.distance-z.dot(a,n))/o;if(!(s<0))return i=z.multiplyByScalar(r,s,i),z.add(n,i,i)}}},Ss=new z,As=new z,Ps=new z,Is=new z,Ds=new z;Cs.rayTriangleParametric=function(e,t,i,n,r){if(!Object(u.a)(e))throw new h.a("ray is required.");if(!Object(u.a)(t))throw new h.a("p0 is required.");if(!Object(u.a)(i))throw new h.a("p1 is required.");if(!Object(u.a)(n))throw new h.a("p2 is required.");r=Object(w.a)(r,!1);var a,o,s,c,l,d=e.origin,f=e.direction,p=z.subtract(i,t,Ss),m=z.subtract(n,t,As),_=z.cross(f,m,Ps),g=z.dot(p,_);if(r){if(g<I.EPSILON6)return;if(a=z.subtract(d,t,Is),(s=z.dot(a,_))<0||s>g)return;if(o=z.cross(a,p,Ds),(c=z.dot(f,o))<0||s+c>g)return;l=z.dot(m,o)/g}else{if(Math.abs(g)<I.EPSILON6)return;var v=1/g;if(a=z.subtract(d,t,Is),(s=z.dot(a,_)*v)<0||s>1)return;if(o=z.cross(a,p,Ds),(c=z.dot(f,o)*v)<0||s+c>1)return;l=z.dot(m,o)*v}return l},Cs.rayTriangle=function(e,t,i,n,r,a){var o=Cs.rayTriangleParametric(e,t,i,n,r);if(Object(u.a)(o)&&!(o<0))return Object(u.a)(a)||(a=new z),z.multiplyByScalar(e.direction,o,a),z.add(e.origin,a,a)};var js=new Ts;Cs.lineSegmentTriangle=function(e,t,i,n,r,a,o){if(!Object(u.a)(e))throw new h.a("v0 is required.");if(!Object(u.a)(t))throw new h.a("v1 is required.");if(!Object(u.a)(i))throw new h.a("p0 is required.");if(!Object(u.a)(n))throw new h.a("p1 is required.");if(!Object(u.a)(r))throw new h.a("p2 is required.");var s=js;z.clone(e,s.origin),z.subtract(t,e,s.direction),z.normalize(s.direction,s.direction);var c=Cs.rayTriangleParametric(s,i,n,r,a);if(!(!Object(u.a)(c)||c<0||c>z.distance(e,t)))return Object(u.a)(o)||(o=new z),z.multiplyByScalar(s.direction,c,o),z.add(s.origin,o,o)};var Ms={root0:0,root1:0};function Rs(e,t,i){Object(u.a)(i)||(i=new le);var n=e.origin,r=e.direction,a=t.center,o=t.radius*t.radius,s=z.subtract(n,a,Ps),c=function(e,t,i,n){var r=t*t-4*e*i;if(!(r<0)){if(r>0){var a=1/(2*e),o=Math.sqrt(r),s=(-t+o)*a,c=(-t-o)*a;return s<c?(n.root0=s,n.root1=c):(n.root0=c,n.root1=s),n}var l=-t/(2*e);if(0!==l)return n.root0=n.root1=l,n}}(z.dot(r,r),2*z.dot(r,s),z.magnitudeSquared(s)-o,Ms);if(Object(u.a)(c))return i.start=c.root0,i.stop=c.root1,i}Cs.raySphere=function(e,t,i){if(!Object(u.a)(e))throw new h.a("ray is required.");if(!Object(u.a)(t))throw new h.a("sphere is required.");if(i=Rs(e,t,i),Object(u.a)(i)&&!(i.stop<0))return i.start=Math.max(i.start,0),i};var Ls=new Ts;Cs.lineSegmentSphere=function(e,t,i,n){if(!Object(u.a)(e))throw new h.a("p0 is required.");if(!Object(u.a)(t))throw new h.a("p1 is required.");if(!Object(u.a)(i))throw new h.a("sphere is required.");var r=Ls;z.clone(e,r.origin);var a=z.subtract(t,e,r.direction),o=z.magnitude(a);if(z.normalize(a,a),n=Rs(r,i,n),!(!Object(u.a)(n)||n.stop<0||n.start>o))return n.start=Math.max(n.start,0),n.stop=Math.min(n.stop,o),n};var Ns=new z,Fs=new z;function ks(e,t,i){var n=e+t;return I.sign(e)!==I.sign(t)&&Math.abs(n/Math.max(Math.abs(e),Math.abs(t)))<i?0:n}Cs.rayEllipsoid=function(e,t){if(!Object(u.a)(e))throw new h.a("ray is required.");if(!Object(u.a)(t))throw new h.a("ellipsoid is required.");var i,n,r,a,o,s=t.oneOverRadii,c=z.multiplyComponents(s,e.origin,Ns),l=z.multiplyComponents(s,e.direction,Fs),d=z.magnitudeSquared(c),f=z.dot(c,l);if(d>1){if(f>=0)return;var p=f*f;if(i=d-1,p<(r=(n=z.magnitudeSquared(l))*i))return;if(p>r){a=f*f-r;var m=(o=-f+Math.sqrt(a))/n,_=i/o;return m<_?new le(m,_):{start:_,stop:m}}var g=Math.sqrt(i/n);return new le(g,g)}return d<1?(i=d-1,a=f*f-(r=(n=z.magnitudeSquared(l))*i),o=-f+Math.sqrt(a),new le(0,o/n)):f<0?(n=z.magnitudeSquared(l),new le(0,-f/n)):void 0};var Bs=new z,zs=new z,Us=new z,Vs=new z,Hs=new z,Gs=new be,qs=new be,Ws=new be,Ys=new be,Xs=new be,Zs=new be,Qs=new be,Ks=new z,Js=new z,$s=new K;Cs.grazingAltitudeLocation=function(e,t){if(!Object(u.a)(e))throw new h.a("ray is required.");if(!Object(u.a)(t))throw new h.a("ellipsoid is required.");var i=e.origin,n=e.direction;if(!z.equals(i,z.ZERO)){var r=t.geodeticSurfaceNormal(i,Bs);if(z.dot(n,r)>=0)return i}var a=Object(u.a)(this.rayEllipsoid(e,t)),o=t.transformPositionToScaledSpace(n,Bs),s=z.normalize(o,o),c=z.mostOrthogonalAxis(o,Vs),l=z.normalize(z.cross(c,s,zs),zs),d=z.normalize(z.cross(s,l,Us),Us),f=Gs;f[0]=s.x,f[1]=s.y,f[2]=s.z,f[3]=l.x,f[4]=l.y,f[5]=l.z,f[6]=d.x,f[7]=d.y,f[8]=d.z;var p=be.transpose(f,qs),m=be.fromScale(t.radii,Ws),_=be.fromScale(t.oneOverRadii,Ys),g=Xs;g[0]=0,g[1]=-n.z,g[2]=n.y,g[3]=n.z,g[4]=0,g[5]=-n.x,g[6]=-n.y,g[7]=n.x,g[8]=0;var v,b,y=be.multiply(be.multiply(p,_,Zs),g,Zs),w=be.multiply(be.multiply(y,m,Qs),f,Qs),O=be.multiplyByVector(y,i,Hs),x=function(e,t,i,n,r){var a,o=n*n,s=r*r,c=(e[be.COLUMN1ROW1]-e[be.COLUMN2ROW2])*s,l=r*(n*ks(e[be.COLUMN1ROW0],e[be.COLUMN0ROW1],I.EPSILON15)+t.y),u=e[be.COLUMN0ROW0]*o+e[be.COLUMN2ROW2]*s+n*t.x+i,h=s*ks(e[be.COLUMN2ROW1],e[be.COLUMN1ROW2],I.EPSILON15),d=r*(n*ks(e[be.COLUMN2ROW0],e[be.COLUMN0ROW2])+t.z),f=[];if(0===d&&0===h){if(0===(a=_s.computeRealRoots(c,l,u)).length)return f;var p=a[0],m=Math.sqrt(Math.max(1-p*p,0));if(f.push(new z(n,r*p,r*-m)),f.push(new z(n,r*p,r*m)),2===a.length){var _=a[1],g=Math.sqrt(Math.max(1-_*_,0));f.push(new z(n,r*_,r*-g)),f.push(new z(n,r*_,r*g))}return f}var v=d*d,b=h*h,y=d*h,w=c*c+b,O=2*(l*c+y),x=2*u*c+l*l-b+v,E=2*(u*l-y),T=u*u-v;if(0===w&&0===O&&0===x&&0===E)return f;var C=(a=xs.computeRealRoots(w,O,x,E,T)).length;if(0===C)return f;for(var S=0;S<C;++S){var A=a[S],P=A*A,D=Math.max(1-P,0),j=Math.sqrt(D),M=(I.sign(c)===I.sign(u)?ks(c*P+u,l*A,I.EPSILON12):I.sign(u)===I.sign(l*A)?ks(c*P,l*A+u,I.EPSILON12):ks(c*P+l*A,u,I.EPSILON12))*ks(h*A,d,I.EPSILON15);M<0?f.push(new z(n,r*A,r*j)):M>0?f.push(new z(n,r*A,r*-j)):0!==j?(f.push(new z(n,r*A,r*-j)),f.push(new z(n,r*A,r*j)),++S):f.push(new z(n,r*A,r*j))}return f}(w,z.negate(O,Bs),0,0,1),E=x.length;if(E>0){for(var T=z.clone(z.ZERO,Js),C=Number.NEGATIVE_INFINITY,S=0;S<E;++S){v=be.multiplyByVector(m,be.multiplyByVector(f,x[S],Ks),Ks);var A=z.normalize(z.subtract(v,i,Vs),Vs),P=z.dot(A,n);P>C&&(C=P,T=z.clone(v,T))}var D=t.cartesianToCartographic(T,$s);return C=I.clamp(C,0,1),b=z.magnitude(z.subtract(T,i,Vs))*Math.sqrt(1-C*C),b=a?-b:b,D.height=b,t.cartographicToCartesian(D,new z)}};var ec=new z;Cs.lineSegmentPlane=function(e,t,i,n){if(!Object(u.a)(e))throw new h.a("endPoint0 is required.");if(!Object(u.a)(t))throw new h.a("endPoint1 is required.");if(!Object(u.a)(i))throw new h.a("plane is required.");Object(u.a)(n)||(n=new z);var r=z.subtract(t,e,ec),a=i.normal,o=z.dot(a,r);if(!(Math.abs(o)<I.EPSILON6)){var s=z.dot(a,e),c=-(i.distance+s)/o;if(!(c<0||c>1))return z.multiplyByScalar(r,c,n),z.add(e,n,n),n}},Cs.trianglePlaneIntersection=function(e,t,i,n){if(!(Object(u.a)(e)&&Object(u.a)(t)&&Object(u.a)(i)&&Object(u.a)(n)))throw new h.a("p0, p1, p2, and plane are required.");var r,a,o=n.normal,s=n.distance,c=z.dot(o,e)+s<0,l=z.dot(o,t)+s<0,d=z.dot(o,i)+s<0,f=0;if(f+=c?1:0,f+=l?1:0,1!==(f+=d?1:0)&&2!==f||(r=new z,a=new z),1===f){if(c)return Cs.lineSegmentPlane(e,t,n,r),Cs.lineSegmentPlane(e,i,n,a),{positions:[e,t,i,r,a],indices:[0,3,4,1,2,4,1,4,3]};if(l)return Cs.lineSegmentPlane(t,i,n,r),Cs.lineSegmentPlane(t,e,n,a),{positions:[e,t,i,r,a],indices:[1,3,4,2,0,4,2,4,3]};if(d)return Cs.lineSegmentPlane(i,e,n,r),Cs.lineSegmentPlane(i,t,n,a),{positions:[e,t,i,r,a],indices:[2,3,4,0,1,4,0,4,3]}}else if(2===f){if(!c)return Cs.lineSegmentPlane(t,e,n,r),Cs.lineSegmentPlane(i,e,n,a),{positions:[e,t,i,r,a],indices:[1,2,4,1,4,3,0,3,4]};if(!l)return Cs.lineSegmentPlane(i,t,n,r),Cs.lineSegmentPlane(e,t,n,a),{positions:[e,t,i,r,a],indices:[2,0,4,2,4,3,1,3,4]};if(!d)return Cs.lineSegmentPlane(e,i,n,r),Cs.lineSegmentPlane(t,i,n,a),{positions:[e,t,i,r,a],indices:[0,1,4,0,4,3,2,3,4]}}};var tc=Cs;function ic(e,t){if(x.a.typeOf.object("normal",e),!I.equalsEpsilon(z.magnitude(e),1,I.EPSILON6))throw new h.a("normal must be normalized.");x.a.typeOf.number("distance",t),this.normal=z.clone(e),this.distance=t}ic.fromPointNormal=function(e,t,i){if(x.a.typeOf.object("point",e),x.a.typeOf.object("normal",t),!I.equalsEpsilon(z.magnitude(t),1,I.EPSILON6))throw new h.a("normal must be normalized.");var n=-z.dot(t,e);return Object(u.a)(i)?(z.clone(t,i.normal),i.distance=n,i):new ic(t,n)};var nc=new z;ic.fromCartesian4=function(e,t){x.a.typeOf.object("coefficients",e);var i=z.fromCartesian4(e,nc),n=e.w;if(!I.equalsEpsilon(z.magnitude(i),1,I.EPSILON6))throw new h.a("normal must be normalized.");return Object(u.a)(t)?(z.clone(i,t.normal),t.distance=n,t):new ic(i,n)},ic.getPointDistance=function(e,t){return x.a.typeOf.object("plane",e),x.a.typeOf.object("point",t),z.dot(e.normal,t)+e.distance};var rc=new z;ic.projectPointOntoPlane=function(e,t,i){x.a.typeOf.object("plane",e),x.a.typeOf.object("point",t),Object(u.a)(i)||(i=new z);var n=ic.getPointDistance(e,t),r=z.multiplyByScalar(e.normal,n,rc);return z.subtract(t,r,i)};var ac=new z;ic.transform=function(e,t,i){return x.a.typeOf.object("plane",e),x.a.typeOf.object("transform",t),Be.multiplyByPointAsVector(t,e.normal,nc),z.normalize(nc,nc),z.multiplyByScalar(e.normal,-e.distance,ac),Be.multiplyByPoint(t,ac,ac),ic.fromPointNormal(ac,nc,i)},ic.clone=function(e,t){return x.a.typeOf.object("plane",e),Object(u.a)(t)?(z.clone(e.normal,t.normal),t.distance=e.distance,t):new ic(e.normal,e.distance)},ic.equals=function(e,t){return x.a.typeOf.object("left",e),x.a.typeOf.object("right",t),e.distance===t.distance&&z.equals(e.normal,t.normal)},ic.ORIGIN_XY_PLANE=Object(E.a)(new ic(z.UNIT_Z,0)),ic.ORIGIN_YZ_PLANE=Object(E.a)(new ic(z.UNIT_X,0)),ic.ORIGIN_ZX_PLANE=Object(E.a)(new ic(z.UNIT_Y,0));var oc=ic,sc=new Te;function cc(e,t){if(x.a.defined("origin",e),e=(t=Object(w.a)(t,ae.WGS84)).scaleToGeodeticSurface(e),!Object(u.a)(e))throw new h.a("origin must not be at the center of the ellipsoid.");var i=xa.eastNorthUpToFixedFrame(e,t);this._ellipsoid=t,this._origin=e,this._xAxis=z.fromCartesian4(Be.getColumn(i,0,sc)),this._yAxis=z.fromCartesian4(Be.getColumn(i,1,sc));var n=z.fromCartesian4(Be.getColumn(i,2,sc));this._plane=oc.fromPointNormal(e,n)}Object(O.a)(cc.prototype,{ellipsoid:{get:function(){return this._ellipsoid}},origin:{get:function(){return this._origin}},plane:{get:function(){return this._plane}},xAxis:{get:function(){return this._xAxis}},yAxis:{get:function(){return this._yAxis}},zAxis:{get:function(){return this._plane.normal}}});var lc=new Yi;cc.fromPoints=function(e,t){return x.a.defined("cartesians",e),new cc(Yi.fromPoints(e,lc).center,t)};var uc=new Ts,hc=new z;cc.prototype.projectPointOntoPlane=function(e,t){x.a.defined("cartesian",e);var i=uc;i.origin=e,z.normalize(e,i.direction);var n=tc.rayPlane(i,this._plane,hc);if(Object(u.a)(n)||(z.negate(i.direction,i.direction),n=tc.rayPlane(i,this._plane,hc)),Object(u.a)(n)){var r=z.subtract(n,this._origin,n),a=z.dot(this._xAxis,r),o=z.dot(this._yAxis,r);return Object(u.a)(t)?(t.x=a,t.y=o,t):new Rt(a,o)}},cc.prototype.projectPointsOntoPlane=function(e,t){x.a.defined("cartesians",e),Object(u.a)(t)||(t=[]);for(var i=0,n=e.length,r=0;r<n;r++){var a=this.projectPointOntoPlane(e[r],t[i]);Object(u.a)(a)&&(t[i]=a,i++)}return t.length=i,t},cc.prototype.projectPointToNearestOnPlane=function(e,t){x.a.defined("cartesian",e),Object(u.a)(t)||(t=new Rt);var i=uc;i.origin=e,z.clone(this._plane.normal,i.direction);var n=tc.rayPlane(i,this._plane,hc);Object(u.a)(n)||(z.negate(i.direction,i.direction),n=tc.rayPlane(i,this._plane,hc));var r=z.subtract(n,this._origin,n),a=z.dot(this._xAxis,r),o=z.dot(this._yAxis,r);return t.x=a,t.y=o,t},cc.prototype.projectPointsToNearestOnPlane=function(e,t){x.a.defined("cartesians",e),Object(u.a)(t)||(t=[]);var i=e.length;t.length=i;for(var n=0;n<i;n++)t[n]=this.projectPointToNearestOnPlane(e[n],t[n]);return t};var dc=new z;cc.prototype.projectPointOntoEllipsoid=function(e,t){x.a.defined("cartesian",e),Object(u.a)(t)||(t=new z);var i=this._ellipsoid,n=this._origin,r=this._xAxis,a=this._yAxis,o=dc;return z.multiplyByScalar(r,e.x,o),t=z.add(n,o,t),z.multiplyByScalar(a,e.y,o),z.add(t,o,t),i.scaleToGeocentricSurface(t,t),t},cc.prototype.projectPointsOntoEllipsoid=function(e,t){x.a.defined("cartesians",e);var i=e.length;Object(u.a)(t)?t.length=i:t=new Array(i);for(var n=0;n<i;++n)t[n]=this.projectPointOntoEllipsoid(e[n],t[n]);return t};var fc=cc;function pc(e,t){this.center=z.clone(Object(w.a)(e,z.ZERO)),this.halfAxes=be.clone(Object(w.a)(t,be.ZERO))}pc.packedLength=z.packedLength+be.packedLength,pc.pack=function(e,t,i){return x.a.typeOf.object("value",e),x.a.defined("array",t),i=Object(w.a)(i,0),z.pack(e.center,t,i),be.pack(e.halfAxes,t,i+z.packedLength),t},pc.unpack=function(e,t,i){return x.a.defined("array",e),t=Object(w.a)(t,0),Object(u.a)(i)||(i=new pc),z.unpack(e,t,i.center),be.unpack(e,t+z.packedLength,i.halfAxes),i};var mc=new z,_c=new z,gc=new z,vc=new z,bc=new z,yc=new z,wc=new be,Oc={unitary:new be,diagonal:new be};pc.fromPoints=function(e,t){if(Object(u.a)(t)||(t=new pc),!Object(u.a)(e)||0===e.length)return t.halfAxes=be.ZERO,t.center=z.ZERO,t;var i,n=e.length,r=z.clone(e[0],mc);for(i=1;i<n;i++)z.add(r,e[i],r);var a=1/n;z.multiplyByScalar(r,a,r);var o,s=0,c=0,l=0,h=0,d=0,f=0;for(i=0;i<n;i++)s+=(o=z.subtract(e[i],r,_c)).x*o.x,c+=o.x*o.y,l+=o.x*o.z,h+=o.y*o.y,d+=o.y*o.z,f+=o.z*o.z;s*=a,c*=a,l*=a,h*=a,d*=a,f*=a;var p=wc;p[0]=s,p[1]=c,p[2]=l,p[3]=c,p[4]=h,p[5]=d,p[6]=l,p[7]=d,p[8]=f;var m=be.computeEigenDecomposition(p,Oc),_=be.clone(m.unitary,t.halfAxes),g=be.getColumn(_,0,vc),v=be.getColumn(_,1,bc),b=be.getColumn(_,2,yc),y=-Number.MAX_VALUE,w=-Number.MAX_VALUE,O=-Number.MAX_VALUE,x=Number.MAX_VALUE,E=Number.MAX_VALUE,T=Number.MAX_VALUE;for(i=0;i<n;i++)o=e[i],y=Math.max(z.dot(g,o),y),w=Math.max(z.dot(v,o),w),O=Math.max(z.dot(b,o),O),x=Math.min(z.dot(g,o),x),E=Math.min(z.dot(v,o),E),T=Math.min(z.dot(b,o),T);g=z.multiplyByScalar(g,.5*(x+y),g),v=z.multiplyByScalar(v,.5*(E+w),v),b=z.multiplyByScalar(b,.5*(T+O),b);var C=z.add(g,v,t.center);z.add(C,b,C);var S=gc;return S.x=y-x,S.y=w-E,S.z=O-T,z.multiplyByScalar(S,.5,S),be.multiplyByScale(t.halfAxes,S,t.halfAxes),t};var xc=new z,Ec=new z;var Tc=new K,Cc=new z,Sc=[new K,new K,new K,new K,new K,new K,new K,new K],Ac=[new z,new z,new z,new z,new z,new z,new z,new z],Pc=[new Rt,new Rt,new Rt,new Rt,new Rt,new Rt,new Rt,new Rt];pc.fromRectangle=function(e,t,i,n,r){if(!Object(u.a)(e))throw new h.a("rectangle is required");if(e.width<0||e.width>I.TWO_PI)throw new h.a("Rectangle width must be between 0 and 2*pi");if(e.height<0||e.height>I.PI)throw new h.a("Rectangle height must be between 0 and pi");if(Object(u.a)(n)&&!I.equalsEpsilon(n.radii.x,n.radii.y,I.EPSILON15))throw new h.a("Ellipsoid must be an ellipsoid of revolution (radii.x == radii.y)");t=Object(w.a)(t,0),i=Object(w.a)(i,0),n=Object(w.a)(n,ae.WGS84);var a=Ve.center(e,Tc),o=n.cartographicToCartesian(a,Cc),s=new fc(o,n),c=s.plane,l=Sc[0],d=Sc[1],f=Sc[2],p=Sc[3],m=Sc[4],_=Sc[5],g=Sc[6],v=Sc[7],b=a.longitude,y=e.south<0&&e.north>0?0:a.latitude;g.latitude=_.latitude=m.latitude=e.south,v.latitude=p.latitude=y,l.latitude=d.latitude=f.latitude=e.north,g.longitude=v.longitude=l.longitude=e.west,_.longitude=d.longitude=b,m.longitude=p.longitude=f.longitude=e.east,f.height=d.height=l.height=v.height=g.height=_.height=m.height=p.height=i,n.cartographicArrayToCartesianArray(Sc,Ac),s.projectPointsToNearestOnPlane(Ac,Pc);var O=Math.min(Pc[6].x,Pc[7].x,Pc[0].x),x=Math.max(Pc[2].x,Pc[3].x,Pc[4].x),E=Math.min(Pc[4].y,Pc[5].y,Pc[6].y),T=Math.max(Pc[0].y,Pc[1].y,Pc[2].y);return f.height=l.height=m.height=g.height=t,n.cartographicArrayToCartesianArray(Sc,Ac),function(e,t,i,n,r,a,o,s){if(!(Object(u.a)(t)&&Object(u.a)(i)&&Object(u.a)(n)&&Object(u.a)(r)&&Object(u.a)(a)&&Object(u.a)(o)))throw new h.a("all extents (minimum/maximum X/Y/Z) are required.");Object(u.a)(s)||(s=new pc);var c=s.halfAxes;be.setColumn(c,0,e.xAxis,c),be.setColumn(c,1,e.yAxis,c),be.setColumn(c,2,e.zAxis,c);var l=xc;l.x=(t+i)/2,l.y=(n+r)/2,l.z=(a+o)/2;var d=Ec;d.x=(i-t)/2,d.y=(r-n)/2,d.z=(o-a)/2;var f=s.center;return l=be.multiplyByVector(c,l,l),z.add(e.origin,l,f),be.multiplyByScale(c,d,c),s}(s,O,x,E,T,Math.min(oc.getPointDistance(c,Ac[0]),oc.getPointDistance(c,Ac[2]),oc.getPointDistance(c,Ac[4]),oc.getPointDistance(c,Ac[6])),i,r)},pc.clone=function(e,t){if(Object(u.a)(e))return Object(u.a)(t)?(z.clone(e.center,t.center),be.clone(e.halfAxes,t.halfAxes),t):new pc(e.center,e.halfAxes)},pc.intersectPlane=function(e,t){if(!Object(u.a)(e))throw new h.a("box is required.");if(!Object(u.a)(t))throw new h.a("plane is required.");var i=e.center,n=t.normal,r=e.halfAxes,a=n.x,o=n.y,s=n.z,c=Math.abs(a*r[be.COLUMN0ROW0]+o*r[be.COLUMN0ROW1]+s*r[be.COLUMN0ROW2])+Math.abs(a*r[be.COLUMN1ROW0]+o*r[be.COLUMN1ROW1]+s*r[be.COLUMN1ROW2])+Math.abs(a*r[be.COLUMN2ROW0]+o*r[be.COLUMN2ROW1]+s*r[be.COLUMN2ROW2]),l=z.dot(n,i)+t.distance;return l<=-c?ce.OUTSIDE:l>=c?ce.INSIDE:ce.INTERSECTING};var Ic=new z,Dc=new z,jc=new z,Mc=new z;pc.distanceSquaredTo=function(e,t){if(!Object(u.a)(e))throw new h.a("box is required.");if(!Object(u.a)(t))throw new h.a("cartesian is required.");var i=z.subtract(t,e.center,xc),n=e.halfAxes,r=be.getColumn(n,0,Ic),a=be.getColumn(n,1,Dc),o=be.getColumn(n,2,jc),s=z.magnitude(r),c=z.magnitude(a),l=z.magnitude(o);z.normalize(r,r),z.normalize(a,a),z.normalize(o,o);var d=Mc;d.x=z.dot(i,r),d.y=z.dot(i,a),d.z=z.dot(i,o);var f,p=0;return d.x<-s?p+=(f=d.x+s)*f:d.x>s&&(p+=(f=d.x-s)*f),d.y<-c?p+=(f=d.y+c)*f:d.y>c&&(p+=(f=d.y-c)*f),d.z<-l?p+=(f=d.z+l)*f:d.z>l&&(p+=(f=d.z-l)*f),p};var Rc=new z,Lc=new z;pc.computePlaneDistances=function(e,t,i,n){if(!Object(u.a)(e))throw new h.a("box is required.");if(!Object(u.a)(t))throw new h.a("position is required.");if(!Object(u.a)(i))throw new h.a("direction is required.");Object(u.a)(n)||(n=new le);var r=Number.POSITIVE_INFINITY,a=Number.NEGATIVE_INFINITY,o=e.center,s=e.halfAxes,c=be.getColumn(s,0,Ic),l=be.getColumn(s,1,Dc),d=be.getColumn(s,2,jc),f=z.add(c,l,Rc);z.add(f,d,f),z.add(f,o,f);var p=z.subtract(f,t,Lc),m=z.dot(i,p);return r=Math.min(m,r),a=Math.max(m,a),z.add(o,c,f),z.add(f,l,f),z.subtract(f,d,f),z.subtract(f,t,p),m=z.dot(i,p),r=Math.min(m,r),a=Math.max(m,a),z.add(o,c,f),z.subtract(f,l,f),z.add(f,d,f),z.subtract(f,t,p),m=z.dot(i,p),r=Math.min(m,r),a=Math.max(m,a),z.add(o,c,f),z.subtract(f,l,f),z.subtract(f,d,f),z.subtract(f,t,p),m=z.dot(i,p),r=Math.min(m,r),a=Math.max(m,a),z.subtract(o,c,f),z.add(f,l,f),z.add(f,d,f),z.subtract(f,t,p),m=z.dot(i,p),r=Math.min(m,r),a=Math.max(m,a),z.subtract(o,c,f),z.add(f,l,f),z.subtract(f,d,f),z.subtract(f,t,p),m=z.dot(i,p),r=Math.min(m,r),a=Math.max(m,a),z.subtract(o,c,f),z.subtract(f,l,f),z.add(f,d,f),z.subtract(f,t,p),m=z.dot(i,p),r=Math.min(m,r),a=Math.max(m,a),z.subtract(o,c,f),z.subtract(f,l,f),z.subtract(f,d,f),z.subtract(f,t,p),m=z.dot(i,p),r=Math.min(m,r),a=Math.max(m,a),n.start=r,n.stop=a,n};var Nc=new St;pc.isOccluded=function(e,t){if(!Object(u.a)(e))throw new h.a("box is required.");if(!Object(u.a)(t))throw new h.a("occluder is required.");var i=St.fromOrientedBoundingBox(e,Nc);return!t.isBoundingSphereVisible(i)},pc.prototype.intersectPlane=function(e){return pc.intersectPlane(this,e)},pc.prototype.distanceSquaredTo=function(e){return pc.distanceSquaredTo(this,e)},pc.prototype.computePlaneDistances=function(e,t,i){return pc.computePlaneDistances(this,e,t,i)},pc.prototype.isOccluded=function(e){return pc.isOccluded(this,e)},pc.equals=function(e,t){return e===t||Object(u.a)(e)&&Object(u.a)(t)&&z.equals(e.center,t.center)&&be.equals(e.halfAxes,t.halfAxes)},pc.prototype.clone=function(e){return pc.clone(this,e)},pc.prototype.equals=function(e){return pc.equals(this,e)};var Fc=pc,kc=Object(E.a)({NONE:0,BITS12:1}),Bc=new z,zc=new z,Uc=new Rt,Vc=new Be,Hc=new Be,Gc=Math.pow(2,12);function qc(e,t,i,n,r,a){var o,s,c,l;if(Object(u.a)(e)&&Object(u.a)(t)&&Object(u.a)(i)&&Object(u.a)(n)){var h=e.minimum,d=e.maximum,f=z.subtract(d,h,zc),p=i-t;o=Math.max(z.maximumComponent(f),p)<Gc-1?kc.BITS12:kc.NONE,s=e.center,c=Be.inverseTransformation(n,new Be);var m=z.negate(h,Bc);Be.multiply(Be.fromTranslation(m,Vc),c,c);var _=Bc;_.x=1/f.x,_.y=1/f.y,_.z=1/f.z,Be.multiply(Be.fromScale(_,Vc),c,c),l=Be.clone(n),Be.setTranslation(l,z.ZERO,l),n=Be.clone(n,new Be);var g=Be.fromTranslation(h,Vc),v=Be.fromScale(f,Hc),b=Be.multiply(g,v,Vc);Be.multiply(n,b,n),Be.multiply(l,b,l)}this.quantization=o,this.minimumHeight=t,this.maximumHeight=i,this.center=s,this.toScaledENU=c,this.fromScaledENU=n,this.matrix=l,this.hasVertexNormals=r,this.hasWebMercatorT=Object(w.a)(a,!1)}qc.prototype.encode=function(e,t,i,n,r,a,o){var s=n.x,c=n.y;if(this.quantization===kc.BITS12){(i=Be.multiplyByPoint(this.toScaledENU,i,Bc)).x=I.clamp(i.x,0,1),i.y=I.clamp(i.y,0,1),i.z=I.clamp(i.z,0,1);var l=this.maximumHeight-this.minimumHeight,u=I.clamp((r-this.minimumHeight)/l,0,1);Rt.fromElements(i.x,i.y,Uc);var h=Gi.compressTextureCoordinates(Uc);Rt.fromElements(i.z,u,Uc);var d=Gi.compressTextureCoordinates(Uc);Rt.fromElements(s,c,Uc);var f=Gi.compressTextureCoordinates(Uc);if(e[t++]=h,e[t++]=d,e[t++]=f,this.hasWebMercatorT){Rt.fromElements(o,0,Uc);var p=Gi.compressTextureCoordinates(Uc);e[t++]=p}}else z.subtract(i,this.center,Bc),e[t++]=Bc.x,e[t++]=Bc.y,e[t++]=Bc.z,e[t++]=r,e[t++]=s,e[t++]=c,this.hasWebMercatorT&&(e[t++]=o);return this.hasVertexNormals&&(e[t++]=Gi.octPackFloat(a)),t},qc.prototype.decodePosition=function(e,t,i){if(Object(u.a)(i)||(i=new z),t*=this.getStride(),this.quantization===kc.BITS12){var n=Gi.decompressTextureCoordinates(e[t],Uc);i.x=n.x,i.y=n.y;var r=Gi.decompressTextureCoordinates(e[t+1],Uc);return i.z=r.x,Be.multiplyByPoint(this.fromScaledENU,i,i)}return i.x=e[t],i.y=e[t+1],i.z=e[t+2],z.add(i,this.center,i)},qc.prototype.decodeTextureCoordinates=function(e,t,i){return Object(u.a)(i)||(i=new Rt),t*=this.getStride(),this.quantization===kc.BITS12?Gi.decompressTextureCoordinates(e[t+2],i):Rt.fromElements(e[t+4],e[t+5],i)},qc.prototype.decodeHeight=function(e,t){return t*=this.getStride(),this.quantization===kc.BITS12?Gi.decompressTextureCoordinates(e[t+1],Uc).y*(this.maximumHeight-this.minimumHeight)+this.minimumHeight:e[t+3]},qc.prototype.getOctEncodedNormal=function(e,t,i){var n=e[t=(t+1)*this.getStride()-1]/256,r=Math.floor(n),a=256*(n-r);return Rt.fromElements(r,a,i)},qc.prototype.getStride=function(){var e;switch(this.quantization){case kc.BITS12:e=3;break;default:e=6}return this.hasWebMercatorT&&++e,this.hasVertexNormals&&++e,e};var Wc={position3DAndHeight:0,textureCoordAndEncodedNormals:1},Yc={compressed0:0,compressed1:1};qc.prototype.getAttributes=function(e){var t,i=dn.FLOAT,n=dn.getSizeInBytes(i);if(this.quantization===kc.NONE){var r=2;return this.hasWebMercatorT&&++r,this.hasVertexNormals&&++r,[{index:Wc.position3DAndHeight,vertexBuffer:e,componentDatatype:i,componentsPerAttribute:4,offsetInBytes:0,strideInBytes:t=(4+r)*n},{index:Wc.textureCoordAndEncodedNormals,vertexBuffer:e,componentDatatype:i,componentsPerAttribute:r,offsetInBytes:4*n,strideInBytes:t}]}var a=3,o=0;return(this.hasWebMercatorT||this.hasVertexNormals)&&++a,this.hasWebMercatorT&&this.hasVertexNormals?(++o,[{index:Yc.compressed0,vertexBuffer:e,componentDatatype:i,componentsPerAttribute:a,offsetInBytes:0,strideInBytes:t=(a+o)*n},{index:Yc.compressed1,vertexBuffer:e,componentDatatype:i,componentsPerAttribute:o,offsetInBytes:a*n,strideInBytes:t}]):[{index:Yc.compressed0,vertexBuffer:e,componentDatatype:i,componentsPerAttribute:a}]},qc.prototype.getAttributeLocations=function(){return this.quantization===kc.NONE?Wc:Yc},qc.clone=function(e,t){return Object(u.a)(t)||(t=new qc),t.quantization=e.quantization,t.minimumHeight=e.minimumHeight,t.maximumHeight=e.maximumHeight,t.center=z.clone(e.center),t.toScaledENU=Be.clone(e.toScaledENU),t.fromScaledENU=Be.clone(e.fromScaledENU),t.matrix=Be.clone(e.matrix),t.hasVertexNormals=e.hasVertexNormals,t.hasWebMercatorT=e.hasWebMercatorT,t};var Xc=qc;function Zc(e){this._ellipsoid=Object(w.a)(e,ae.WGS84),this._semimajorAxis=this._ellipsoid.maximumRadius,this._oneOverSemimajorAxis=1/this._semimajorAxis}Object(O.a)(Zc.prototype,{ellipsoid:{get:function(){return this._ellipsoid}}}),Zc.mercatorAngleToGeodeticLatitude=function(e){return I.PI_OVER_TWO-2*Math.atan(Math.exp(-e))},Zc.geodeticLatitudeToMercatorAngle=function(e){e>Zc.MaximumLatitude?e=Zc.MaximumLatitude:e<-Zc.MaximumLatitude&&(e=-Zc.MaximumLatitude);var t=Math.sin(e);return.5*Math.log((1+t)/(1-t))},Zc.MaximumLatitude=Zc.mercatorAngleToGeodeticLatitude(Math.PI),Zc.prototype.project=function(e,t){var i=this._semimajorAxis,n=e.longitude*i,r=Zc.geodeticLatitudeToMercatorAngle(e.latitude)*i,a=e.height;return Object(u.a)(t)?(t.x=n,t.y=r,t.z=a,t):new z(n,r,a)},Zc.prototype.unproject=function(e,t){if(!Object(u.a)(e))throw new h.a("cartesian is required");var i=this._oneOverSemimajorAxis,n=e.x*i,r=Zc.mercatorAngleToGeodeticLatitude(e.y*i),a=e.z;return Object(u.a)(t)?(t.longitude=n,t.latitude=r,t.height=a,t):new K(n,r,a)};var Qc=Zc,Kc={};Kc.DEFAULT_STRUCTURE=Object(E.a)({heightScale:1,heightOffset:0,elementsPerHeight:1,stride:1,elementMultiplier:256,isBigEndian:!1});var Jc=new z,$c=new Be,el=new z,tl=new z;Kc.computeVertices=function(e){if(!Object(u.a)(e)||!Object(u.a)(e.heightmap))throw new h.a("options.heightmap is required.");if(!Object(u.a)(e.width)||!Object(u.a)(e.height))throw new h.a("options.width and options.height are required.");if(!Object(u.a)(e.nativeRectangle))throw new h.a("options.nativeRectangle is required.");if(!Object(u.a)(e.skirtHeight))throw new h.a("options.skirtHeight is required.");var t,i,n,r,a=Math.cos,o=Math.sin,s=Math.sqrt,c=Math.atan,l=Math.exp,d=I.PI_OVER_TWO,f=I.toRadians,p=e.heightmap,m=e.width,_=e.height,g=e.skirtHeight,v=Object(w.a)(e.isGeographic,!0),b=Object(w.a)(e.ellipsoid,ae.WGS84),y=1/b.maximumRadius,O=e.nativeRectangle,x=e.rectangle;Object(u.a)(x)?(t=x.west,i=x.south,n=x.east,r=x.north):v?(t=f(O.west),i=f(O.south),n=f(O.east),r=f(O.north)):(t=O.west*y,i=d-2*c(l(-O.south*y)),n=O.east*y,r=d-2*c(l(-O.north*y)));var E=e.relativeToCenter,T=Object(u.a)(E);E=T?E:z.ZERO;var C=Object(w.a)(e.exaggeration,1),S=Object(w.a)(e.includeWebMercatorT,!1),A=Object(w.a)(e.structure,Kc.DEFAULT_STRUCTURE),P=Object(w.a)(A.heightScale,Kc.DEFAULT_STRUCTURE.heightScale),D=Object(w.a)(A.heightOffset,Kc.DEFAULT_STRUCTURE.heightOffset),j=Object(w.a)(A.elementsPerHeight,Kc.DEFAULT_STRUCTURE.elementsPerHeight),M=Object(w.a)(A.stride,Kc.DEFAULT_STRUCTURE.stride),R=Object(w.a)(A.elementMultiplier,Kc.DEFAULT_STRUCTURE.elementMultiplier),L=Object(w.a)(A.isBigEndian,Kc.DEFAULT_STRUCTURE.isBigEndian),N=Ve.computeWidth(O),F=Ve.computeHeight(O),k=N/(m-1),B=F/(_-1);v||(N*=y,F*=y);var U,V,H=b.radiiSquared,G=H.x,q=H.y,W=H.z,Y=65536,X=-65536,Z=xa.eastNorthUpToFixedFrame(E,b),Q=Be.inverseTransformation(Z,$c);S&&(U=Qc.geodeticLatitudeToMercatorAngle(i),V=1/(Qc.geodeticLatitudeToMercatorAngle(r)-U));var K=el;K.x=Number.POSITIVE_INFINITY,K.y=Number.POSITIVE_INFINITY,K.z=Number.POSITIVE_INFINITY;var J=tl;J.x=Number.NEGATIVE_INFINITY,J.y=Number.NEGATIVE_INFINITY,J.z=Number.NEGATIVE_INFINITY;var $=Number.POSITIVE_INFINITY,ee=(m+(g>0?2:0))*(_+(g>0?2:0)),te=new Array(ee),ie=new Array(ee),ne=new Array(ee),re=S?new Array(ee):[],oe=0,se=_,ce=0,le=m;g>0&&(--oe,++se,--ce,++le);for(var ue=0,he=oe;he<se;++he){var de=he;de<0&&(de=0),de>=_&&(de=_-1);var fe,pe=O.north-B*de,me=a(pe=v?f(pe):d-2*c(l(-pe*y))),_e=o(pe),ge=W*_e,ve=(pe-i)/(r-i);ve=I.clamp(ve,0,1),S&&(fe=(Qc.geodeticLatitudeToMercatorAngle(pe)-U)*V);for(var be=ce;be<le;++be){var ye=be;ye<0&&(ye=0),ye>=m&&(ye=m-1);var we=O.west+k*ye;v?we=f(we):we*=y;var Oe,xe,Ee=de*(m*M)+ye*M;if(1===j)Oe=p[Ee];else if(Oe=0,L)for(xe=0;xe<j;++xe)Oe=Oe*R+p[Ee+xe];else for(xe=j-1;xe>=0;--xe)Oe=Oe*R+p[Ee+xe];Oe=(Oe*P+D)*C;var Te=(we-t)/(n-t);if(Te=I.clamp(Te,0,1),ne[ue]=new Rt(Te,ve),X=Math.max(X,Oe),Y=Math.min(Y,Oe),be!==ye||he!==de){be<0?we-=1e-5*N:we+=1e-5*N,he<0?pe+=1e-5*F:pe-=1e-5*F,me=a(pe),ge=W*(_e=o(pe)),Oe-=g}var Ce=me*a(we),Se=me*o(we),Ae=G*Ce,Pe=q*Se,Ie=1/s(Ae*Ce+Pe*Se+ge*_e),De=Ae*Ie,je=Pe*Ie,Me=ge*Ie,Re=new z;Re.x=De+Ce*Oe,Re.y=je+Se*Oe,Re.z=Me+_e*Oe,te[ue]=Re,ie[ue]=Oe,S&&(re[ue]=fe),ue++,Be.multiplyByPoint(Q,Re,Jc),z.minimumByComponent(Jc,K,K),z.maximumByComponent(Jc,J,J),$=Math.min($,Oe)}}var Le,Ne,Fe=St.fromPoints(te);(Object(u.a)(x)&&x.width<I.PI_OVER_TWO+I.EPSILON5&&(Le=Fc.fromRectangle(x,Y,X,b)),T)&&(Ne=new fs(b).computeHorizonCullingPoint(E,te));for(var ke=new Yi(K,J,E),ze=new Xc(ke,$,X,Z,!1,S),Ue=new Float32Array(ee*ze.getStride()),He=0,Ge=0;Ge<ee;++Ge)He=ze.encode(Ue,He,te[Ge],ne[Ge],ie[Ge],void 0,re[Ge]);return{vertices:Ue,maximumHeight:X,minimumHeight:Y,encoding:ze,boundingSphere3D:Fe,orientedBoundingBox:Le,occludeePointInScaledSpace:Ne}};var il=Kc;function nl(){return!0}var rl=function(e,t){function i(){throw new h.a(t)}for(var n in t=Object(w.a)(t,"This object was destroyed, i.e., destroy() was called."),e)"function"==typeof e[n]&&(e[n]=i);e.isDestroyed=nl},al=n(82);function ol(){if(!Object(u.a)(dl._canTransferArrayBuffer)){var e=new Worker(ul("Workers/transferTypedArrayTest.js"));e.postMessage=Object(w.a)(e.webkitPostMessage,e.postMessage);var t=new Int8Array([99]);try{e.postMessage({array:t},[t.buffer])}catch(e){return dl._canTransferArrayBuffer=!1,dl._canTransferArrayBuffer}var i=Oi.a.defer();e.onmessage=function(t){var n=t.data.array,r=Object(u.a)(n)&&99===n[0];i.resolve(r),e.terminate(),dl._canTransferArrayBuffer=r},dl._canTransferArrayBuffer=i.promise}return dl._canTransferArrayBuffer}var sl,cl=new $o.a;function ll(e,t){--e._activeTasks;var i=t.id;if(Object(u.a)(i)){var n=e._deferreds,r=n[i];if(Object(u.a)(t.error)){var a=t.error;"RuntimeError"===a.name?(a=new Ce.a(t.error.message)).stack=t.error.stack:"DeveloperError"===a.name&&((a=new h.a(t.error.message)).stack=t.error.stack),cl.raiseEvent(a),r.reject(a)}else cl.raiseEvent(),r.resolve(t.result);delete n[i]}}function ul(e){var t=y(e);if(Object(al.a)(t)){var i,n='importScripts("'+t+'");';try{i=new Blob([n],{type:"application/javascript"})}catch(e){var r=new(window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder);r.append(n),i=r.getBlob("application/javascript")}t=(window.URL||window.webkitURL).createObjectURL(i)}return t}function hl(e){var t=new Worker((Object(u.a)(sl)||(sl=ul("Workers/cesiumWorkerBootstrapper.js")),sl));t.postMessage=Object(w.a)(t.webkitPostMessage,t.postMessage);var i={loaderConfig:{},workerModule:dl._workerModulePrefix+e._workerName};return Object(u.a)(dl._loaderConfig)?i.loaderConfig=dl._loaderConfig:(i.loaderConfig.paths={Workers:y("Workers")},i.loaderConfig.baseUrl=y.getCesiumBaseUrl().url),t.postMessage(i),t.onmessage=function(t){ll(e,t.data)},t}function dl(e,t){this._workerName=e,this._maximumActiveTasks=Object(w.a)(t,5),this._activeTasks=0,this._deferreds={},this._nextID=0}var fl=[];dl.prototype.scheduleTask=function(e,t){if(Object(u.a)(this._worker)||(this._worker=hl(this)),!(this._activeTasks>=this._maximumActiveTasks)){++this._activeTasks;var i=this;return Object(Oi.a)(ol(),(function(n){Object(u.a)(t)?n||(t.length=0):t=fl;var r=i._nextID++,a=Oi.a.defer();return i._deferreds[r]=a,i._worker.postMessage({id:r,parameters:e,canTransferArrayBuffer:n},t),a.promise}))}},dl.prototype.initWebAssemblyModule=function(e){Object(u.a)(this._worker)||(this._worker=hl(this));var t=Oi.a.defer(),i=this,n=this._worker;return function(e,t){var i={modulePath:void 0,wasmBinaryFile:void 0,wasmBinary:void 0};if(!Ri.supportsWebAssembly()){if(!Object(u.a)(t.fallbackModulePath))throw new Ce.a("This browser does not support Web Assembly, and no backup module was provided for "+e._workerName);return i.modulePath=y(t.fallbackModulePath),Oi.a.resolve(i)}return i.modulePath=y(t.modulePath),i.wasmBinaryFile=y(t.wasmBinaryFile),f.a.fetchArrayBuffer({url:i.wasmBinaryFile}).then((function(e){return i.wasmBinary=e,i}))}(this,e).then((function(e){return Object(Oi.a)(ol(),(function(r){var a,o=e.wasmBinary;Object(u.a)(o)&&r&&(a=[o]),n.onmessage=function(e){n.onmessage=function(e){ll(i,e.data)},t.resolve(e.data)},n.postMessage({webAssemblyConfig:e},a)}))})),t},dl.prototype.isDestroyed=function(){return!1},dl.prototype.destroy=function(){return Object(u.a)(this._worker)&&this._worker.terminate(),rl(this)},dl.prototype.isBusy=function(){return this._activeTasks>=this._maximumActiveTasks},dl.taskCompletedEvent=cl,dl._defaultWorkerModulePrefix="Workers/",dl._workerModulePrefix=dl._defaultWorkerModulePrefix,dl._loaderConfig=void 0,dl._canTransferArrayBuffer=void 0;var pl=dl;var ml=function(e,t,i,n,r,a,o,s,c,l,u){this.center=e,this.vertices=t,this.stride=Object(w.a)(s,6),this.indices=i,this.minimumHeight=n,this.maximumHeight=r,this.boundingSphere3D=a,this.occludeePointInScaledSpace=o,this.orientedBoundingBox=c,this.encoding=l,this.exaggeration=u};function _l(){h.a.throwInstantiationError()}Object(O.a)(_l.prototype,{errorEvent:{get:h.a.throwInstantiationError},credit:{get:h.a.throwInstantiationError},tilingScheme:{get:h.a.throwInstantiationError},ready:{get:h.a.throwInstantiationError},readyPromise:{get:h.a.throwInstantiationError},hasWaterMask:{get:h.a.throwInstantiationError},hasVertexNormals:{get:h.a.throwInstantiationError},availability:{get:h.a.throwInstantiationError}});var gl=[];_l.getRegularGridIndices=function(e,t){if(e*t>=I.SIXTY_FOUR_KILOBYTES)throw new h.a("The total number of vertices (width * height) must be less than 65536.");var i=gl[e];Object(u.a)(i)||(gl[e]=i=[]);var n=i[t];if(!Object(u.a)(n)){n=i[t]=new Uint16Array((e-1)*(t-1)*6);for(var r=0,a=0,o=0;o<t-1;++o){for(var s=0;s<e-1;++s){var c=r,l=c+e,d=l+1,f=c+1;n[a++]=c,n[a++]=l,n[a++]=f,n[a++]=f,n[a++]=l,n[a++]=d,++r}++r}}return n},_l.heightmapTerrainQuality=.25,_l.getEstimatedLevelZeroGeometricErrorForAHeightmap=function(e,t,i){return 2*e.maximumRadius*Math.PI*_l.heightmapTerrainQuality/(t*i)},_l.prototype.requestTileGeometry=h.a.throwInstantiationError,_l.prototype.getLevelMaximumGeometricError=h.a.throwInstantiationError,_l.prototype.getTileDataAvailable=h.a.throwInstantiationError,_l.prototype.loadTileDataAvailability=h.a.throwInstantiationError;var vl=_l;function bl(e){if(!Object(u.a)(e)||!Object(u.a)(e.buffer))throw new h.a("options.buffer is required.");if(!Object(u.a)(e.width))throw new h.a("options.width is required.");if(!Object(u.a)(e.height))throw new h.a("options.height is required.");this._buffer=e.buffer,this._width=e.width,this._height=e.height,this._childTileMask=Object(w.a)(e.childTileMask,15);var t=il.DEFAULT_STRUCTURE,i=e.structure;Object(u.a)(i)?i!==t&&(i.heightScale=Object(w.a)(i.heightScale,t.heightScale),i.heightOffset=Object(w.a)(i.heightOffset,t.heightOffset),i.elementsPerHeight=Object(w.a)(i.elementsPerHeight,t.elementsPerHeight),i.stride=Object(w.a)(i.stride,t.stride),i.elementMultiplier=Object(w.a)(i.elementMultiplier,t.elementMultiplier),i.isBigEndian=Object(w.a)(i.isBigEndian,t.isBigEndian)):i=t,this._structure=i,this._createdByUpsampling=Object(w.a)(e.createdByUpsampling,!1),this._waterMask=e.waterMask,this._skirtHeight=void 0,this._bufferType=this._buffer.constructor,this._mesh=void 0}Object(O.a)(bl.prototype,{credits:{get:function(){}},waterMask:{get:function(){return this._waterMask}}});var yl=new pl("createVerticesFromHeightmap");function wl(e,t,i,n,r,a,o,s,c,l,u){var h=(c-a.west)*(o-1)/(a.east-a.west),d=(l-a.south)*(s-1)/(a.north-a.south);r>0&&(h+=1,d+=1,o+=2,s+=2);var f=0|h,p=f+1;p>=(r>0?o-1:o)&&(p=o-1,f=o-2);var m=0|d,_=m+1;_>=(r>0?s-1:s)&&(_=s-1,m=s-2);var g=d-m;return m=s-1-m,_=s-1-_,Ol(h-f,g,(t.decodeHeight(e,m*o+f)/u-i)/n,(t.decodeHeight(e,m*o+p)/u-i)/n,(t.decodeHeight(e,_*o+f)/u-i)/n,(t.decodeHeight(e,_*o+p)/u-i)/n)}function Ol(e,t,i,n,r,a){return t<e?i+e*(n-i)+t*(a-n):i+e*(a-r)+t*(r-i)}function xl(e,t,i,n,r,a){a*=n;var o,s=0;if(r)for(o=0;o<t;++o)s=s*i+e[a+o];else for(o=t-1;o>=0;--o)s=s*i+e[a+o];return s}function El(e,t,i,n,r,a,o,s){var c;if(o*=r,a)for(c=0;c<t-1;++c)e[o+c]=s/n|0,s-=e[o+c]*n,n/=i;else for(c=t-1;c>0;--c)e[o+c]=s/n|0,s-=e[o+c]*n,n/=i;e[o+c]=s}bl.prototype.createMesh=function(e,t,i,n,r){if(!Object(u.a)(e))throw new h.a("tilingScheme is required.");if(!Object(u.a)(t))throw new h.a("x is required.");if(!Object(u.a)(i))throw new h.a("y is required.");if(!Object(u.a)(n))throw new h.a("level is required.");var a=e.ellipsoid,o=e.tileXYToNativeRectangle(t,i,n),s=e.tileXYToRectangle(t,i,n);r=Object(w.a)(r,1);var c=a.cartographicToCartesian(Ve.center(s)),l=this._structure,d=vl.getEstimatedLevelZeroGeometricErrorForAHeightmap(a,this._width,e.getNumberOfXTilesAtLevel(0))/(1<<n);this._skirtHeight=Math.min(4*d,1e3);var f=yl.scheduleTask({heightmap:this._buffer,structure:l,includeWebMercatorT:!0,width:this._width,height:this._height,nativeRectangle:o,rectangle:s,relativeToCenter:c,ellipsoid:a,skirtHeight:this._skirtHeight,isGeographic:e.projection instanceof se,exaggeration:r});if(Object(u.a)(f)){var p=this;return Object(Oi.a)(f,(function(e){return p._mesh=new ml(c,new Float32Array(e.vertices),vl.getRegularGridIndices(e.gridWidth,e.gridHeight),e.minimumHeight,e.maximumHeight,e.boundingSphere3D,e.occludeePointInScaledSpace,e.numberOfAttributes,e.orientedBoundingBox,Xc.clone(e.encoding),r),p._buffer=void 0,p._mesh}))}},bl.prototype.interpolateHeight=function(e,t,i){var n,r=this._width,a=this._height,o=this._structure,s=o.stride,c=o.elementsPerHeight,l=o.elementMultiplier,h=o.isBigEndian,d=o.heightOffset,f=o.heightScale;Object(u.a)(this._mesh)?n=wl(this._mesh.vertices,this._mesh.encoding,d,f,this._skirtHeight,e,r,a,t,i,this._mesh.exaggeration):n=(n=function(e,t,i,n,r,a,o,s,c,l){var u=(c-a.west)*(o-1)/(a.east-a.west),h=(l-a.south)*(s-1)/(a.north-a.south),d=0|u,f=d+1;f>=o&&(f=o-1,d=o-2);var p=0|h,m=p+1;m>=s&&(m=s-1,p=s-2);var _=u-d,g=h-p;m=s-1-m;var v=xl(e,t,i,n,r,(p=s-1-p)*o+d),b=xl(e,t,i,n,r,p*o+f),y=xl(e,t,i,n,r,m*o+d),w=xl(e,t,i,n,r,m*o+f);return Ol(_,g,v,b,y,w)}(this._buffer,c,l,s,h,e,r,a,t,i))*f+d;return n},bl.prototype.upsample=function(e,t,i,n,r,a,o){if(!Object(u.a)(e))throw new h.a("tilingScheme is required.");if(!Object(u.a)(t))throw new h.a("thisX is required.");if(!Object(u.a)(i))throw new h.a("thisY is required.");if(!Object(u.a)(n))throw new h.a("thisLevel is required.");if(!Object(u.a)(r))throw new h.a("descendantX is required.");if(!Object(u.a)(a))throw new h.a("descendantY is required.");if(!Object(u.a)(o))throw new h.a("descendantLevel is required.");if(o-n>1)throw new h.a("Upsampling through more than one level at a time is not currently supported.");var s=this._width,c=this._height,l=this._structure,d=this._skirtHeight,f=l.stride,p=new this._bufferType(s*c*f),m=this._mesh;if(Object(u.a)(m)){for(var _=m.vertices,g=m.encoding,v=e.tileXYToRectangle(t,i,n),b=e.tileXYToRectangle(r,a,o),y=l.heightOffset,w=l.heightScale,O=m.exaggeration,x=l.elementsPerHeight,E=l.elementMultiplier,T=l.isBigEndian,C=Math.pow(E,x-1),S=0;S<c;++S)for(var A=I.lerp(b.north,b.south,S/(c-1)),P=0;P<s;++P){var D=wl(_,g,y,w,d,v,s,c,I.lerp(b.west,b.east,P/(s-1)),A,O);El(p,x,E,C,f,T,S*s+P,D=(D=D<l.lowestEncodedHeight?l.lowestEncodedHeight:D)>l.highestEncodedHeight?l.highestEncodedHeight:D)}return new bl({buffer:p,width:s,height:c,childTileMask:0,structure:this._structure,createdByUpsampling:!0})}},bl.prototype.isChildAvailable=function(e,t,i,n){if(!Object(u.a)(e))throw new h.a("thisX is required.");if(!Object(u.a)(t))throw new h.a("thisY is required.");if(!Object(u.a)(i))throw new h.a("childX is required.");if(!Object(u.a)(n))throw new h.a("childY is required.");var r=2;return i!==2*e&&++r,n!==2*t&&(r-=2),0!=(this._childTileMask&1<<r)},bl.prototype.wasCreatedByUpsampling=function(){return this._createdByUpsampling};var Tl=bl,Cl={UNSIGNED_BYTE:un.UNSIGNED_BYTE,UNSIGNED_SHORT:un.UNSIGNED_SHORT,UNSIGNED_INT:un.UNSIGNED_INT,getSizeInBytes:function(e){switch(e){case Cl.UNSIGNED_BYTE:return Uint8Array.BYTES_PER_ELEMENT;case Cl.UNSIGNED_SHORT:return Uint16Array.BYTES_PER_ELEMENT;case Cl.UNSIGNED_INT:return Uint32Array.BYTES_PER_ELEMENT}throw new h.a("indexDatatype is required and must be a valid IndexDatatype constant.")},validate:function(e){return Object(u.a)(e)&&(e===Cl.UNSIGNED_BYTE||e===Cl.UNSIGNED_SHORT||e===Cl.UNSIGNED_INT)},createTypedArray:function(e,t){if(!Object(u.a)(e))throw new h.a("numberOfVertices is required.");return e>=I.SIXTY_FOUR_KILOBYTES?new Uint32Array(t):new Uint16Array(t)},createTypedArrayFromArrayBuffer:function(e,t,i,n){if(!Object(u.a)(e))throw new h.a("numberOfVertices is required.");if(!Object(u.a)(t))throw new h.a("sourceArray is required.");if(!Object(u.a)(i))throw new h.a("byteOffset is required.");return e>=I.SIXTY_FOUR_KILOBYTES?new Uint32Array(t,i,n):new Uint16Array(t,i,n)}},Sl=Object(E.a)(Cl),Al={clipTriangleAtAxisAlignedThreshold:function(e,t,i,n,r,a){if(!Object(u.a)(e))throw new h.a("threshold is required.");if(!Object(u.a)(t))throw new h.a("keepAbove is required.");if(!Object(u.a)(i))throw new h.a("u0 is required.");if(!Object(u.a)(n))throw new h.a("u1 is required.");if(!Object(u.a)(r))throw new h.a("u2 is required.");var o,s,c;Object(u.a)(a)?a.length=0:a=[],t?(o=i<e,s=n<e,c=r<e):(o=i>e,s=n>e,c=r>e);var l,d,f,p,m,_,g=o+s+c;return 1===g?o?(l=(e-i)/(n-i),d=(e-i)/(r-i),a.push(1),a.push(2),1!==d&&(a.push(-1),a.push(0),a.push(2),a.push(d)),1!==l&&(a.push(-1),a.push(0),a.push(1),a.push(l))):s?(f=(e-n)/(r-n),p=(e-n)/(i-n),a.push(2),a.push(0),1!==p&&(a.push(-1),a.push(1),a.push(0),a.push(p)),1!==f&&(a.push(-1),a.push(1),a.push(2),a.push(f))):c&&(m=(e-r)/(i-r),_=(e-r)/(n-r),a.push(0),a.push(1),1!==_&&(a.push(-1),a.push(2),a.push(1),a.push(_)),1!==m&&(a.push(-1),a.push(2),a.push(0),a.push(m))):2===g?o||i===e?s||n===e?c||r===e||(d=(e-i)/(r-i),f=(e-n)/(r-n),a.push(2),a.push(-1),a.push(0),a.push(2),a.push(d),a.push(-1),a.push(1),a.push(2),a.push(f)):(_=(e-r)/(n-r),l=(e-i)/(n-i),a.push(1),a.push(-1),a.push(2),a.push(1),a.push(_),a.push(-1),a.push(0),a.push(1),a.push(l)):(p=(e-n)/(i-n),m=(e-r)/(i-r),a.push(0),a.push(-1),a.push(1),a.push(0),a.push(p),a.push(-1),a.push(2),a.push(0),a.push(m)):3!==g&&(a.push(0),a.push(1),a.push(2)),a},computeBarycentricCoordinates:function(e,t,i,n,r,a,o,s,c){if(!Object(u.a)(e))throw new h.a("x is required.");if(!Object(u.a)(t))throw new h.a("y is required.");if(!Object(u.a)(i))throw new h.a("x1 is required.");if(!Object(u.a)(n))throw new h.a("y1 is required.");if(!Object(u.a)(r))throw new h.a("x2 is required.");if(!Object(u.a)(a))throw new h.a("y2 is required.");if(!Object(u.a)(o))throw new h.a("x3 is required.");if(!Object(u.a)(s))throw new h.a("y3 is required.");var l=i-o,d=o-r,f=a-s,p=n-s,m=1/(f*l+d*p),_=t-s,g=e-o,v=(f*g+d*_)*m,b=(-p*g+l*_)*m,y=1-v-b;return Object(u.a)(c)?(c.x=v,c.y=b,c.z=y,c):new z(v,b,y)},computeLineSegmentLineSegmentIntersection:function(e,t,i,n,r,a,o,s,c){x.a.typeOf.number("x00",e),x.a.typeOf.number("y00",t),x.a.typeOf.number("x01",i),x.a.typeOf.number("y01",n),x.a.typeOf.number("x10",r),x.a.typeOf.number("y10",a),x.a.typeOf.number("x11",o),x.a.typeOf.number("y11",s);var l=(s-a)*(i-e)-(o-r)*(n-t);if(0!==l){var h=((o-r)*(t-a)-(s-a)*(e-r))/l,d=((i-e)*(t-a)-(n-t)*(e-r))/l;return h>=0&&h<=1&&d>=0&&d<=1?(Object(u.a)(c)||(c=new Rt),c.x=e+h*(i-e),c.y=t+h*(n-t),c):void 0}}},Pl=Al;function Il(e){if(!Object(u.a)(e)||!Object(u.a)(e.quantizedVertices))throw new h.a("options.quantizedVertices is required.");if(!Object(u.a)(e.indices))throw new h.a("options.indices is required.");if(!Object(u.a)(e.minimumHeight))throw new h.a("options.minimumHeight is required.");if(!Object(u.a)(e.maximumHeight))throw new h.a("options.maximumHeight is required.");if(!Object(u.a)(e.maximumHeight))throw new h.a("options.maximumHeight is required.");if(!Object(u.a)(e.boundingSphere))throw new h.a("options.boundingSphere is required.");if(!Object(u.a)(e.horizonOcclusionPoint))throw new h.a("options.horizonOcclusionPoint is required.");if(!Object(u.a)(e.westIndices))throw new h.a("options.westIndices is required.");if(!Object(u.a)(e.southIndices))throw new h.a("options.southIndices is required.");if(!Object(u.a)(e.eastIndices))throw new h.a("options.eastIndices is required.");if(!Object(u.a)(e.northIndices))throw new h.a("options.northIndices is required.");if(!Object(u.a)(e.westSkirtHeight))throw new h.a("options.westSkirtHeight is required.");if(!Object(u.a)(e.southSkirtHeight))throw new h.a("options.southSkirtHeight is required.");if(!Object(u.a)(e.eastSkirtHeight))throw new h.a("options.eastSkirtHeight is required.");if(!Object(u.a)(e.northSkirtHeight))throw new h.a("options.northSkirtHeight is required.");this._quantizedVertices=e.quantizedVertices,this._encodedNormals=e.encodedNormals,this._indices=e.indices,this._minimumHeight=e.minimumHeight,this._maximumHeight=e.maximumHeight,this._boundingSphere=e.boundingSphere,this._orientedBoundingBox=e.orientedBoundingBox,this._horizonOcclusionPoint=e.horizonOcclusionPoint,this._credits=e.credits;var t=this._quantizedVertices.length/3,i=this._uValues=this._quantizedVertices.subarray(0,t),n=this._vValues=this._quantizedVertices.subarray(t,2*t);function r(e,t){return n[e]-n[t]}function a(e,t){return i[e]-i[t]}this._heightValues=this._quantizedVertices.subarray(2*t,3*t),this._westIndices=jl(e.westIndices,r,t),this._southIndices=jl(e.southIndices,a,t),this._eastIndices=jl(e.eastIndices,r,t),this._northIndices=jl(e.northIndices,a,t),this._westSkirtHeight=e.westSkirtHeight,this._southSkirtHeight=e.southSkirtHeight,this._eastSkirtHeight=e.eastSkirtHeight,this._northSkirtHeight=e.northSkirtHeight,this._childTileMask=Object(w.a)(e.childTileMask,15),this._createdByUpsampling=Object(w.a)(e.createdByUpsampling,!1),this._waterMask=e.waterMask,this._mesh=void 0}Object(O.a)(Il.prototype,{credits:{get:function(){return this._credits}},waterMask:{get:function(){return this._waterMask}}});var Dl=[];function jl(e,t,i){Dl.length=e.length;for(var n=!1,r=0,a=e.length;r<a;++r)Dl[r]=e[r],n=n||r>0&&t(e[r-1],e[r])>0;return n?(Dl.sort(t),Sl.createTypedArray(i,Dl)):e}var Ml=new pl("createVerticesFromQuantizedTerrainMesh");Il.prototype.createMesh=function(e,t,i,n,r){if(!Object(u.a)(e))throw new h.a("tilingScheme is required.");if(!Object(u.a)(t))throw new h.a("x is required.");if(!Object(u.a)(i))throw new h.a("y is required.");if(!Object(u.a)(n))throw new h.a("level is required.");var a=e.ellipsoid,o=e.tileXYToRectangle(t,i,n);r=Object(w.a)(r,1);var s=Ml.scheduleTask({minimumHeight:this._minimumHeight,maximumHeight:this._maximumHeight,quantizedVertices:this._quantizedVertices,octEncodedNormals:this._encodedNormals,includeWebMercatorT:!0,indices:this._indices,westIndices:this._westIndices,southIndices:this._southIndices,eastIndices:this._eastIndices,northIndices:this._northIndices,westSkirtHeight:this._westSkirtHeight,southSkirtHeight:this._southSkirtHeight,eastSkirtHeight:this._eastSkirtHeight,northSkirtHeight:this._northSkirtHeight,rectangle:o,relativeToCenter:this._boundingSphere.center,ellipsoid:a,exaggeration:r});if(Object(u.a)(s)){var c=this;return Object(Oi.a)(s,(function(e){var t=c._quantizedVertices.length/3;t+=c._westIndices.length+c._southIndices.length+c._eastIndices.length+c._northIndices.length;var i=Sl.createTypedArray(t,e.indices),n=new Float32Array(e.vertices),a=e.center,o=e.minimumHeight,s=e.maximumHeight,l=Object(w.a)(e.boundingSphere,c._boundingSphere),u=Object(w.a)(e.orientedBoundingBox,c._orientedBoundingBox),h=c._horizonOcclusionPoint,d=e.vertexStride,f=Xc.clone(e.encoding);return c._skirtIndex=e.skirtIndex,c._vertexCountWithoutSkirts=c._quantizedVertices.length/3,c._mesh=new ml(a,n,i,o,s,l,h,d,u,f,r),c._quantizedVertices=void 0,c._encodedNormals=void 0,c._indices=void 0,c._uValues=void 0,c._vValues=void 0,c._heightValues=void 0,c._westIndices=void 0,c._southIndices=void 0,c._eastIndices=void 0,c._northIndices=void 0,c._mesh}))}};var Rl=new pl("upsampleQuantizedTerrainMesh");Il.prototype.upsample=function(e,t,i,n,r,a,o){if(!Object(u.a)(e))throw new h.a("tilingScheme is required.");if(!Object(u.a)(t))throw new h.a("thisX is required.");if(!Object(u.a)(i))throw new h.a("thisY is required.");if(!Object(u.a)(n))throw new h.a("thisLevel is required.");if(!Object(u.a)(r))throw new h.a("descendantX is required.");if(!Object(u.a)(a))throw new h.a("descendantY is required.");if(!Object(u.a)(o))throw new h.a("descendantLevel is required.");if(o-n>1)throw new h.a("Upsampling through more than one level at a time is not currently supported.");var s=this._mesh;if(Object(u.a)(this._mesh)){var c=2*t!==r,l=2*i===a,d=e.ellipsoid,f=e.tileXYToRectangle(r,a,o),p=Rl.scheduleTask({vertices:s.vertices,vertexCountWithoutSkirts:this._vertexCountWithoutSkirts,indices:s.indices,skirtIndex:this._skirtIndex,encoding:s.encoding,minimumHeight:this._minimumHeight,maximumHeight:this._maximumHeight,isEastChild:c,isNorthChild:l,childRectangle:f,ellipsoid:d,exaggeration:s.exaggeration});if(Object(u.a)(p)){var m=Math.min(this._westSkirtHeight,this._eastSkirtHeight);m=Math.min(m,this._southSkirtHeight),m=Math.min(m,this._northSkirtHeight);var _=c?.5*m:this._westSkirtHeight,g=l?.5*m:this._southSkirtHeight,v=c?this._eastSkirtHeight:.5*m,b=l?this._northSkirtHeight:.5*m,y=this._credits;return Object(Oi.a)(p).then((function(e){var t,i=new Uint16Array(e.vertices),n=Sl.createTypedArray(i.length/3,e.indices);return Object(u.a)(e.encodedNormals)&&(t=new Uint8Array(e.encodedNormals)),new Il({quantizedVertices:i,indices:n,encodedNormals:t,minimumHeight:e.minimumHeight,maximumHeight:e.maximumHeight,boundingSphere:St.clone(e.boundingSphere),orientedBoundingBox:Fc.clone(e.orientedBoundingBox),horizonOcclusionPoint:z.clone(e.horizonOcclusionPoint),westIndices:e.westIndices,southIndices:e.southIndices,eastIndices:e.eastIndices,northIndices:e.northIndices,westSkirtHeight:_,southSkirtHeight:g,eastSkirtHeight:v,northSkirtHeight:b,childTileMask:0,credits:y,createdByUpsampling:!0})}))}}};var Ll=32767,Nl=new z;function Fl(e,t,i,n,r,a,o,s){var c=Math.min(i,r,o),l=Math.max(i,r,o),u=Math.min(n,a,s),h=Math.max(n,a,s);return e>=c&&e<=l&&t>=u&&t<=h}Il.prototype.interpolateHeight=function(e,t,i){var n=I.clamp((t-e.west)/e.width,0,1);n*=Ll;var r=I.clamp((i-e.south)/e.height,0,1);return r*=Ll,Object(u.a)(this._mesh)?function(e,t,i){for(var n=e._mesh,r=n.vertices,a=n.encoding,o=n.indices,s=0,c=o.length;s<c;s+=3){var l=o[s],u=o[s+1],h=o[s+2],d=a.decodeTextureCoordinates(r,l,kl),f=a.decodeTextureCoordinates(r,u,Bl),p=a.decodeTextureCoordinates(r,h,zl);if(Fl(t,i,d.x,d.y,f.x,f.y,p.x,p.y)){var m=Pl.computeBarycentricCoordinates(t,i,d.x,d.y,f.x,f.y,p.x,p.y,Nl);if(m.x>=-1e-15&&m.y>=-1e-15&&m.z>=-1e-15){var _=a.decodeHeight(r,l),g=a.decodeHeight(r,u),v=a.decodeHeight(r,h);return m.x*_+m.y*g+m.z*v}}}return}(this,n,r):function(e,t,i){for(var n=e._uValues,r=e._vValues,a=e._heightValues,o=e._indices,s=0,c=o.length;s<c;s+=3){var l=o[s],u=o[s+1],h=o[s+2],d=n[l],f=n[u],p=n[h],m=r[l],_=r[u],g=r[h];if(Fl(t,i,d,m,f,_,p,g)){var v=Pl.computeBarycentricCoordinates(t,i,d,m,f,_,p,g,Nl);if(v.x>=-1e-15&&v.y>=-1e-15&&v.z>=-1e-15){var b=v.x*a[l]+v.y*a[u]+v.z*a[h];return I.lerp(e._minimumHeight,e._maximumHeight,b/Ll)}}}return}(this,n,r)};var kl=new Rt,Bl=new Rt,zl=new Rt;Il.prototype.isChildAvailable=function(e,t,i,n){if(!Object(u.a)(e))throw new h.a("thisX is required.");if(!Object(u.a)(t))throw new h.a("thisY is required.");if(!Object(u.a)(i))throw new h.a("childX is required.");if(!Object(u.a)(n))throw new h.a("childY is required.");var r=2;return i!==2*e&&++r,n!==2*t&&(r-=2),0!=(this._childTileMask&1<<r)},Il.prototype.wasCreatedByUpsampling=function(){return this._createdByUpsampling};var Ul=Il,Vl=n(25),Hl=n(22);function Gl(e,t){this._tilingScheme=e,this._maximumLevel=t,this._rootNodes=[]}var ql=new Ve;function Wl(e,t,i,n){for(var r=n.length,a=0;a<r;++a){var o=n[a];if(o.x===t&&o.y===i&&o.level===e)return!0}return!1}Gl.prototype.addAvailableTileRange=function(e,t,i,n,r){var a=this._tilingScheme,o=this._rootNodes;if(0===e)for(var s=i;s<=r;++s)for(var c=t;c<=n;++c)Wl(e,c,s,o)||o.push(new Jl(a,void 0,0,c,s));a.tileXYToRectangle(t,i,e,ql);var l=ql.west,u=ql.north;a.tileXYToRectangle(n,r,e,ql);for(var h=ql.east,d=new $l(e,l,ql.south,h,u),f=0;f<o.length;++f){var p=o[f];eu(p.extent,d)&&tu(this._maximumLevel,p,d)}},Gl.prototype.computeMaximumLevelAtPosition=function(e){for(var t,i=0;i<this._rootNodes.length;++i){var n=this._rootNodes[i];if(ru(n.extent,e)){t=n;break}}return Object(u.a)(t)?function e(t,i,n){var r=0,a=!1;for(;!a;){var o=i._nw&&ru(i._nw.extent,n),s=i._ne&&ru(i._ne.extent,n),c=i._sw&&ru(i._sw.extent,n),l=i._se&&ru(i._se.extent,n);if(o+s+c+l>1){o&&(r=Math.max(r,e(i,i._nw,n))),s&&(r=Math.max(r,e(i,i._ne,n))),c&&(r=Math.max(r,e(i,i._sw,n))),l&&(r=Math.max(r,e(i,i._se,n)));break}o?i=i._nw:s?i=i._ne:c?i=i._sw:l?i=i._se:a=!0}for(;i!==t;){for(var u=i.rectangles,h=u.length-1;h>=0&&u[h].level>r;--h){var d=u[h];ru(d,n)&&(r=d.level)}i=i.parent}return r}(void 0,t,e):-1};var Yl=[],Xl=[],Zl=new Ve,Ql=new Ve;Gl.prototype.computeBestAvailableLevelOverRectangle=function(e){var t=Yl;t.length=0,e.east<e.west?(t.push(Ve.fromRadians(-Math.PI,e.south,e.east,e.north,Zl)),t.push(Ve.fromRadians(e.west,e.south,Math.PI,e.north,Ql))):t.push(e);var i,n=Xl;for(n.length=0,i=0;i<this._rootNodes.length;++i)au(n,this._rootNodes[i],t);for(i=n.length-1;i>=0;--i)if(Object(u.a)(n[i])&&0===n[i].length)return i;return 0};var Kl=new K;function Jl(e,t,i,n,r){this.tilingScheme=e,this.parent=t,this.level=i,this.x=n,this.y=r,this.extent=e.tileXYToRectangle(n,r,i),this.rectangles=[],this._sw=void 0,this._se=void 0,this._nw=void 0,this._ne=void 0}function $l(e,t,i,n,r){this.level=e,this.west=t,this.south=i,this.east=n,this.north=r}function eu(e,t){var i=Math.max(e.west,t.west),n=Math.max(e.south,t.south),r=Math.min(e.east,t.east);return n<Math.min(e.north,t.north)&&i<r}function tu(e,t,i){for(;t.level<e;)if(nu(t.nw.extent,i))t=t.nw;else if(nu(t.ne.extent,i))t=t.ne;else if(nu(t.sw.extent,i))t=t.sw;else{if(!nu(t.se.extent,i))break;t=t.se}if(0===t.rectangles.length||t.rectangles[t.rectangles.length-1].level<=i.level)t.rectangles.push(i);else{var n=Ji(t.rectangles,i.level,iu);n<=0&&(n=~n),t.rectangles.splice(n,0,i)}}function iu(e,t){return e.level-t}function nu(e,t){return t.west>=e.west&&t.east<=e.east&&t.south>=e.south&&t.north<=e.north}function ru(e,t){return t.longitude>=e.west&&t.longitude<=e.east&&t.latitude>=e.south&&t.latitude<=e.north}function au(e,t,i){if(t){var n,r=!1;for(n=0;n<i.length;++n)r=r||eu(t.extent,i[n]);if(r){var a=t.rectangles;for(n=0;n<a.length;++n){var o=a[n];e[o.level]||(e[o.level]=i),e[o.level]=ou(e[o.level],o)}au(e,t._nw,i),au(e,t._ne,i),au(e,t._sw,i),au(e,t._se,i)}}}function ou(e,t){for(var i=[],n=0;n<e.length;++n){var r=e[n];eu(r,t)?(r.west<t.west&&i.push(new Ve(r.west,r.south,t.west,r.north)),r.east>t.east&&i.push(new Ve(t.east,r.south,r.east,r.north)),r.south<t.south&&i.push(new Ve(Math.max(t.west,r.west),r.south,Math.min(t.east,r.east),t.south)),r.north>t.north&&i.push(new Ve(Math.max(t.west,r.west),t.north,Math.min(t.east,r.east),r.north))):i.push(r)}return i}Gl.prototype.isTileAvailable=function(e,t,i){var n=this._tilingScheme.tileXYToRectangle(t,i,e,ql);return Ve.center(n,Kl),this.computeMaximumLevelAtPosition(Kl)>=e},Gl.prototype.computeChildMaskForTile=function(e,t,i){var n=e+1;if(n>=this._maximumLevel)return 0;var r=0;return r|=this.isTileAvailable(n,2*t,2*i+1)?1:0,r|=this.isTileAvailable(n,2*t+1,2*i+1)?2:0,r|=this.isTileAvailable(n,2*t,2*i)?4:0,r|=this.isTileAvailable(n,2*t+1,2*i)?8:0},Object(O.a)(Jl.prototype,{nw:{get:function(){return this._nw||(this._nw=new Jl(this.tilingScheme,this,this.level+1,2*this.x,2*this.y)),this._nw}},ne:{get:function(){return this._ne||(this._ne=new Jl(this.tilingScheme,this,this.level+1,2*this.x+1,2*this.y)),this._ne}},sw:{get:function(){return this._sw||(this._sw=new Jl(this.tilingScheme,this,this.level+1,2*this.x,2*this.y+1)),this._sw}},se:{get:function(){return this._se||(this._se=new Jl(this.tilingScheme,this,this.level+1,2*this.x+1,2*this.y+1)),this._se}}});var su=Gl;var cu=function(e){var t,i=e.name,n=e.message;t=Object(u.a)(i)&&Object(u.a)(n)?i+": "+n:e.toString();var r=e.stack;return Object(u.a)(r)&&(t+="\n"+r),t};function lu(e,t,i,n,r,a,o){this.provider=e,this.message=t,this.x=i,this.y=n,this.level=r,this.timesRetried=Object(w.a)(a,0),this.retry=!1,this.error=o}lu.handleError=function(e,t,i,n,r,a,o,s,c){var l=e;return Object(u.a)(e)?(l.provider=t,l.message=n,l.x=r,l.y=a,l.level=o,l.retry=!1,l.error=c,++l.timesRetried):l=new lu(t,n,r,a,o,0,c),i.numberOfListeners>0?i.raiseEvent(l):console.log('An error occurred in "'+t.constructor.name+'": '+cu(n)),l.retry&&Object(u.a)(s)&&s(),l},lu.handleSuccess=function(e){Object(u.a)(e)&&(e.timesRetried=-1)};var uu=lu;function hu(e){this.resource=e.resource,this.version=e.version,this.isHeightmap=e.isHeightmap,this.tileUrlTemplates=e.tileUrlTemplates,this.availability=e.availability,this.hasVertexNormals=e.hasVertexNormals,this.hasWaterMask=e.hasWaterMask,this.hasMetadata=e.hasMetadata,this.availabilityLevels=e.availabilityLevels,this.availabilityTilesLoaded=e.availabilityTilesLoaded,this.littleEndianExtensionSize=e.littleEndianExtensionSize,this.availabilityTilesLoaded=e.availabilityTilesLoaded,this.availabilityPromiseCache={}}function du(e){if(!Object(u.a)(e)||!Object(u.a)(e.url))throw new h.a("options.url is required.");this._tilingScheme=new Nt({numberOfLevelZeroTilesX:2,numberOfLevelZeroTilesY:1,ellipsoid:e.ellipsoid}),this._heightmapWidth=65,this._levelZeroMaximumGeometricError=vl.getEstimatedLevelZeroGeometricErrorForAHeightmap(this._tilingScheme.ellipsoid,this._heightmapWidth,this._tilingScheme.getNumberOfXTilesAtLevel(0)),this._heightmapStructure=void 0,this._hasWaterMask=!1,this._hasVertexNormals=!1,this._requestVertexNormals=Object(w.a)(e.requestVertexNormals,!1),this._requestWaterMask=Object(w.a)(e.requestWaterMask,!1),this._requestMetadata=Object(w.a)(e.requestMetadata,!0),this._errorEvent=new $o.a;var t=e.credit;"string"==typeof t&&(t=new Jo(t)),this._credit=t,this._availability=void 0;var i=Oi.a.defer();this._ready=!1,this._readyPromise=i,this._tileCredits=void 0;var n,r,a,o=this,s=this._layers=[],c="",l=[],d=0;function p(e){var t;if(!e.format)return t="The tile format is not specified in the layer.json file.",void(a=uu.handleError(a,o,o._errorEvent,t,void 0,void 0,void 0,v));if(!e.tiles||0===e.tiles.length)return t="The layer.json file does not specify any tile URL templates.",void(a=uu.handleError(a,o,o._errorEvent,t,void 0,void 0,void 0,v));var i=!1,h=!1,f=!1,_=!0,g=!1;if("heightmap-1.0"===e.format)g=!0,Object(u.a)(o._heightmapStructure)||(o._heightmapStructure={heightScale:.2,heightOffset:-1e3,elementsPerHeight:1,stride:1,elementMultiplier:256,isBigEndian:!1,lowestEncodedHeight:0,highestEncodedHeight:65535}),h=!0,o._requestWaterMask=!0;else if(0!==e.format.indexOf("quantized-mesh-1."))return t='The tile format "'+e.format+'" is invalid or not supported.',void(a=uu.handleError(a,o,o._errorEvent,t,void 0,void 0,void 0,v));var b,y=e.tiles,w=e.maxzoom;d=Math.max(d,w),Object(u.a)(e.extensions)&&-1!==e.extensions.indexOf("octvertexnormals")?i=!0:Object(u.a)(e.extensions)&&-1!==e.extensions.indexOf("vertexnormals")&&(i=!0,_=!1),Object(u.a)(e.extensions)&&-1!==e.extensions.indexOf("watermask")&&(h=!0),Object(u.a)(e.extensions)&&-1!==e.extensions.indexOf("metadata")&&(f=!0);var O,x=e.metadataAvailability,E=e.available;if(Object(u.a)(E)&&!Object(u.a)(x)){O=new su(o._tilingScheme,E.length);for(var T=0;T<E.length;++T){var C=E[T],S=o._tilingScheme.getNumberOfYTilesAtLevel(T);Object(u.a)(l[T])||(l[T]=[]);for(var A=0;A<C.length;++A){var P=C[A],I=S-P.endY-1,D=S-P.startY-1;l[T].push([P.startX,I,P.endX,D]),O.addAvailableTileRange(T,P.startX,I,P.endX,D)}}}else Object(u.a)(x)&&(b=new su(o._tilingScheme,w),O=new su(o._tilingScheme,w),l[0]=[[0,0,1,0]],O.addAvailableTileRange(0,0,0,1,0));o._hasWaterMask=o._hasWaterMask||h,o._hasVertexNormals=o._hasVertexNormals||i,o._hasMetadata=o._hasMetadata||f,Object(u.a)(e.attribution)&&(c.length>0&&(c+=" "),c+=e.attribution),s.push(new hu({resource:n,version:e.version,isHeightmap:g,tileUrlTemplates:y,availability:O,hasVertexNormals:i,hasWaterMask:h,hasMetadata:f,availabilityLevels:x,availabilityTilesLoaded:b,littleEndianExtensionSize:_}));var j=e.parentUrl;if(Object(u.a)(j)){if(!Object(u.a)(O))return console.log("A layer.json can't have a parentUrl if it does't have an available array."),Oi.a.resolve();(n=n.getDerivedResource({url:j})).appendForwardSlash();var M=(r=n.getDerivedResource({url:"layer.json"})).fetchJson();return Object(Oi.a)(M,p,m)}return Oi.a.resolve()}function m(e){var t="An error occurred while accessing "+r.url+".";a=uu.handleError(a,o,o._errorEvent,t,void 0,void 0,void 0,v)}function _(e){p(e).then((function(){if(!Object(u.a)(a)){var e=l.length;if(e>0)for(var t=o._availability=new su(o._tilingScheme,d),i=0;i<e;++i)for(var n=l[i],r=0;r<n.length;++r){var s=n[r];t.addAvailableTileRange(i,s[0],s[1],s[2],s[3])}if(c.length>0){var h=new Jo(c);Object(u.a)(o._tileCredits)?o._tileCredits.push(h):o._tileCredits=[h]}o._ready=!0,o._readyPromise.resolve(!0)}}))}function g(e){Object(u.a)(e)&&404===e.statusCode?_({tilejson:"2.1.0",format:"heightmap-1.0",version:"1.0.0",scheme:"tms",tiles:["{z}/{x}/{y}.terrain?v={version}"]}):m()}function v(){Object(Oi.a)(r.fetchJson()).then(_).otherwise(g)}Object(Oi.a)(e.url).then((function(e){var t=f.a.createIfNeeded(e);t.appendForwardSlash(),r=(n=t).getDerivedResource({url:"layer.json"}),o._tileCredits=t.credits,v()})).otherwise((function(e){i.reject(e)}))}var fu={OCT_VERTEX_NORMALS:1,WATER_MASK:2,METADATA:4};function pu(e){return Object(u.a)(e)&&0!==e.length?{Accept:"application/vnd.quantized-mesh;extensions="+e.join("-")+",application/octet-stream;q=0.9,*/*;q=0.01"}:{Accept:"application/vnd.quantized-mesh,application/octet-stream;q=0.9,*/*;q=0.01"}}function mu(e,t,i,n,r,a){if(!Object(u.a)(r))return Oi.a.reject(new Ce.a("Terrain tile doesn't exist"));var o=r.tileUrlTemplates;if(0!==o.length){var s,c,l=e._tilingScheme.getNumberOfYTilesAtLevel(n)-i-1,h=[];e._requestVertexNormals&&r.hasVertexNormals&&h.push(r.littleEndianExtensionSize?"octvertexnormals":"vertexnormals"),e._requestWaterMask&&r.hasWaterMask&&h.push("watermask"),e._requestMetadata&&r.hasMetadata&&h.push("metadata");var d=o[(t+l+n)%o.length],f=r.resource;Object(u.a)(f._ionEndpoint)&&!Object(u.a)(f._ionEndpoint.externalType)?(0!==h.length&&(c={extensions:h.join("-")}),s=pu(void 0)):s=pu(h);var p=f.getDerivedResource({url:d,templateValues:{version:r.version,z:n,x:t,y:l},queryParameters:c,headers:s,request:a}).fetchArrayBuffer();if(Object(u.a)(p))return p.then((function(a){return Object(u.a)(e._heightmapStructure)?function(e,t,i,n,r,a){var o=new Uint16Array(t,0,e._heightmapWidth*e._heightmapWidth);return new Tl({buffer:o,childTileMask:new Uint8Array(t,o.byteLength,1)[0],waterMask:new Uint8Array(t,o.byteLength+1,t.byteLength-o.byteLength-1),width:e._heightmapWidth,height:e._heightmapWidth,structure:e._heightmapStructure,credits:e._tileCredits})}(e,a):function(e,t,i,n,r,a,o){var s=o.littleEndianExtensionSize,c=0,l=3*Float64Array.BYTES_PER_ELEMENT,h=4*Float64Array.BYTES_PER_ELEMENT,d=3*Uint16Array.BYTES_PER_ELEMENT,f=Uint16Array.BYTES_PER_ELEMENT,p=3*f,m=new DataView(t),_=new z(m.getFloat64(c,!0),m.getFloat64(c+8,!0),m.getFloat64(c+16,!0));c+=l;var g=m.getFloat32(c,!0);c+=Float32Array.BYTES_PER_ELEMENT;var v=m.getFloat32(c,!0);c+=Float32Array.BYTES_PER_ELEMENT;var b=new St(new z(m.getFloat64(c,!0),m.getFloat64(c+8,!0),m.getFloat64(c+16,!0)),m.getFloat64(c+l,!0));c+=h;var y=new z(m.getFloat64(c,!0),m.getFloat64(c+8,!0),m.getFloat64(c+16,!0));c+=l;var w=m.getUint32(c,!0);c+=Uint32Array.BYTES_PER_ELEMENT;var O=new Uint16Array(t,c,3*w);c+=w*d,w>65536&&(p=3*(f=Uint32Array.BYTES_PER_ELEMENT));var x=O.subarray(0,w),E=O.subarray(w,2*w),T=O.subarray(2*w,3*w);Gi.zigZagDeltaDecode(x,E,T),c%f!=0&&(c+=f-c%f);var C=m.getUint32(c,!0);c+=Uint32Array.BYTES_PER_ELEMENT;var S=Sl.createTypedArrayFromArrayBuffer(w,t,c,3*C);c+=C*p;for(var A=0,P=S.length,D=0;D<P;++D){var j=S[D];S[D]=A-j,0===j&&++A}var M=m.getUint32(c,!0);c+=Uint32Array.BYTES_PER_ELEMENT;var R=Sl.createTypedArrayFromArrayBuffer(w,t,c,M);c+=M*f;var L=m.getUint32(c,!0);c+=Uint32Array.BYTES_PER_ELEMENT;var N=Sl.createTypedArrayFromArrayBuffer(w,t,c,L);c+=L*f;var F=m.getUint32(c,!0);c+=Uint32Array.BYTES_PER_ELEMENT;var k=Sl.createTypedArrayFromArrayBuffer(w,t,c,F);c+=F*f;var B=m.getUint32(c,!0);c+=Uint32Array.BYTES_PER_ELEMENT;var U,V,H=Sl.createTypedArrayFromArrayBuffer(w,t,c,B);for(c+=B*f;c<m.byteLength;){var G=m.getUint8(c,!0);c+=Uint8Array.BYTES_PER_ELEMENT;var q=m.getUint32(c,s);if(c+=Uint32Array.BYTES_PER_ELEMENT,G===fu.OCT_VERTEX_NORMALS&&e._requestVertexNormals)U=new Uint8Array(t,c,2*w);else if(G===fu.WATER_MASK&&e._requestWaterMask)V=new Uint8Array(t,c,q);else if(G===fu.METADATA&&e._requestMetadata){var W=m.getUint32(c,!0);if(W>0){var Y=is(new Uint8Array(t),c+Uint32Array.BYTES_PER_ELEMENT,W),X=JSON.parse(Y).available;if(Object(u.a)(X))for(var Z=0;Z<X.length;++Z)for(var Q=i+Z+1,K=X[Z],J=e._tilingScheme.getNumberOfYTilesAtLevel(Q),$=0;$<K.length;++$){var ee=K[$],te=J-ee.endY-1,ie=J-ee.startY-1;e.availability.addAvailableTileRange(Q,ee.startX,te,ee.endX,ie),o.availability.addAvailableTileRange(Q,ee.startX,te,ee.endX,ie)}}o.availabilityTilesLoaded.addAvailableTileRange(i,n,r,n,r)}c+=q}var ne,re=5*e.getLevelMaximumGeometricError(i),ae=e._tilingScheme.tileXYToRectangle(n,r,i);return ae.width<I.PI_OVER_TWO+I.EPSILON5&&(ne=Fc.fromRectangle(ae,g,v,e._tilingScheme.ellipsoid)),new Ul({center:_,minimumHeight:g,maximumHeight:v,boundingSphere:b,orientedBoundingBox:ne,horizonOcclusionPoint:y,quantizedVertices:O,encodedNormals:U,indices:S,westIndices:R,southIndices:N,eastIndices:k,northIndices:H,westSkirtHeight:re,southSkirtHeight:re,eastSkirtHeight:re,northSkirtHeight:re,childTileMask:e.availability.computeChildMaskForTile(i,n,r),waterMask:V,credits:e._tileCredits})}(e,a,n,t,i,0,r)}))}}function _u(e,t,i,n){if(0!==n){var r=e.availabilityLevels,a=n%r==0?n-r:(n/r|0)*r,o=1<<n-a;return{level:a,x:t/o|0,y:i/o|0}}}function gu(e,t,i,n,r,a){if(!Object(u.a)(r.availabilityLevels))return{result:!1};for(var o,s=function(){delete r.availabilityPromiseCache[o]},c=r.availabilityTilesLoaded,l=r.availability,h=_u(r,t,i,n);Object(u.a)(h);){if(l.isTileAvailable(h.level,h.x,h.y)&&!c.isTileAvailable(h.level,h.x,h.y)){var d;if(!a&&(o=h.level+"-"+h.x+"-"+h.y,d=r.availabilityPromiseCache[o],!Object(u.a)(d))){var f=new Vl.a({throttle:!0,throttleByServer:!0,type:Hl.a.TERRAIN});d=mu(e,h.x,h.y,h.level,r,f),Object(u.a)(d)&&(r.availabilityPromiseCache[o]=d,d.then(s))}return{result:!0,promise:d}}h=_u(r,h.x,h.y,h.level)}return{result:!1}}du.prototype.requestTileGeometry=function(e,t,i,n){if(!this._ready)throw new h.a("requestTileGeometry must not be called before the terrain provider is ready.");var r,a=this._layers,o=a.length;if(1===o)r=a[0];else for(var s=0;s<o;++s){var c=a[s];if(!Object(u.a)(c.availability)||c.availability.isTileAvailable(i,e,t)){r=c;break}}return mu(this,e,t,i,r,n)},Object(O.a)(du.prototype,{errorEvent:{get:function(){return this._errorEvent}},credit:{get:function(){if(!this._ready)throw new h.a("credit must not be called before the terrain provider is ready.");return this._credit}},tilingScheme:{get:function(){if(!this._ready)throw new h.a("tilingScheme must not be called before the terrain provider is ready.");return this._tilingScheme}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise.promise}},hasWaterMask:{get:function(){if(!this._ready)throw new h.a("hasWaterMask must not be called before the terrain provider is ready.");return this._hasWaterMask&&this._requestWaterMask}},hasVertexNormals:{get:function(){if(!this._ready)throw new h.a("hasVertexNormals must not be called before the terrain provider is ready.");return this._hasVertexNormals&&this._requestVertexNormals}},hasMetadata:{get:function(){if(!this._ready)throw new h.a("hasMetadata must not be called before the terrain provider is ready.");return this._hasMetadata&&this._requestMetadata}},requestVertexNormals:{get:function(){return this._requestVertexNormals}},requestWaterMask:{get:function(){return this._requestWaterMask}},requestMetadata:{get:function(){return this._requestMetadata}},availability:{get:function(){if(!this._ready)throw new h.a("availability must not be called before the terrain provider is ready.");return this._availability}}}),du.prototype.getLevelMaximumGeometricError=function(e){return this._levelZeroMaximumGeometricError/(1<<e)},du.prototype.getTileDataAvailable=function(e,t,i){if(Object(u.a)(this._availability)){if(i>this._availability._maximumLevel)return!1;if(this._availability.isTileAvailable(i,e,t))return!0;if(!this._hasMetadata)return!1;for(var n=this._layers,r=n.length,a=0;a<r;++a){if(gu(this,e,t,i,n[a],0===a).result)return}return!1}},du.prototype.loadTileDataAvailability=function(e,t,i){if(!(!Object(u.a)(this._availability)||i>this._availability._maximumLevel||this._availability.isTileAvailable(i,e,t))&&this._hasMetadata)for(var n=this._layers,r=n.length,a=0;a<r;++a){var o=gu(this,e,t,i,n[a],0===a);if(Object(u.a)(o.promise))return o.promise}},du._getAvailabilityTile=_u;var vu=du,bu={},yu=new z,wu=new z,Ou=new Kn,xu=new be;function Eu(e,t,i,n,r,a,o,s,c,l){var u=e+t;z.multiplyByScalar(n,Math.cos(u),yu),z.multiplyByScalar(i,Math.sin(u),wu),z.add(yu,wu,yu);var h=Math.cos(e);h*=h;var d=Math.sin(e);d*=d;var f=a/Math.sqrt(o*h+r*d)/s;return Kn.fromAxisAngle(yu,f,Ou),be.fromQuaternion(Ou,xu),be.multiplyByVector(xu,c,l),z.normalize(l,l),z.multiplyByScalar(l,s,l),l}var Tu=new z,Cu=new z,Su=new z,Au=new z;bu.raisePositionsToHeight=function(e,t,i){for(var n=t.ellipsoid,r=t.height,a=t.extrudedHeight,o=i?e.length/3*2:e.length/3,s=new Float64Array(3*o),c=e.length,l=i?c:0,u=0;u<c;u+=3){var h=u+1,d=u+2,f=z.fromArray(e,u,Tu);n.scaleToGeodeticSurface(f,f);var p=z.clone(f,Cu),m=n.geodeticSurfaceNormal(f,Au),_=z.multiplyByScalar(m,r,Su);z.add(f,_,f),i&&(z.multiplyByScalar(m,a,_),z.add(p,_,p),s[u+l]=p.x,s[h+l]=p.y,s[d+l]=p.z),s[u]=f.x,s[h]=f.y,s[d]=f.z}return s};var Pu=new z,Iu=new z,Du=new z;bu.computeEllipsePositions=function(e,t,i){var n=e.semiMinorAxis,r=e.semiMajorAxis,a=e.rotation,o=e.center,s=8*e.granularity,c=n*n,l=r*r,u=r*n,h=z.magnitude(o),d=z.normalize(o,Pu),f=z.cross(z.UNIT_Z,o,Iu);f=z.normalize(f,f);var p=z.cross(d,f,Du),m=1+Math.ceil(I.PI_OVER_TWO/s),_=I.PI_OVER_TWO/(m-1),g=I.PI_OVER_TWO-m*_;g<0&&(m-=Math.ceil(Math.abs(g)/_));var v,b,y,w,O,x=t?new Array(3*(m*(m+2)*2)):void 0,E=0,T=Tu,C=Cu,S=4*m*3,A=S-1,P=0,D=i?new Array(S):void 0;for(T=Eu(g=I.PI_OVER_TWO,a,p,f,c,u,l,h,d,T),t&&(x[E++]=T.x,x[E++]=T.y,x[E++]=T.z),i&&(D[A--]=T.z,D[A--]=T.y,D[A--]=T.x),g=I.PI_OVER_TWO-_,v=1;v<m+1;++v){if(T=Eu(g,a,p,f,c,u,l,h,d,T),C=Eu(Math.PI-g,a,p,f,c,u,l,h,d,C),t){for(x[E++]=T.x,x[E++]=T.y,x[E++]=T.z,y=2*v+2,b=1;b<y-1;++b)w=b/(y-1),O=z.lerp(T,C,w,Su),x[E++]=O.x,x[E++]=O.y,x[E++]=O.z;x[E++]=C.x,x[E++]=C.y,x[E++]=C.z}i&&(D[A--]=T.z,D[A--]=T.y,D[A--]=T.x,D[P++]=C.x,D[P++]=C.y,D[P++]=C.z),g=I.PI_OVER_TWO-(v+1)*_}for(v=m;v>1;--v){if(T=Eu(-(g=I.PI_OVER_TWO-(v-1)*_),a,p,f,c,u,l,h,d,T),C=Eu(g+Math.PI,a,p,f,c,u,l,h,d,C),t){for(x[E++]=T.x,x[E++]=T.y,x[E++]=T.z,y=2*(v-1)+2,b=1;b<y-1;++b)w=b/(y-1),O=z.lerp(T,C,w,Su),x[E++]=O.x,x[E++]=O.y,x[E++]=O.z;x[E++]=C.x,x[E++]=C.y,x[E++]=C.z}i&&(D[A--]=T.z,D[A--]=T.y,D[A--]=T.x,D[P++]=C.x,D[P++]=C.y,D[P++]=C.z)}T=Eu(-(g=I.PI_OVER_TWO),a,p,f,c,u,l,h,d,T);var j={};return t&&(x[E++]=T.x,x[E++]=T.y,x[E++]=T.z,j.positions=x,j.numPts=m),i&&(D[A--]=T.z,D[A--]=T.y,D[A--]=T.x,j.outerPositions=D),j};var ju=bu;var Mu=function(e){if(e=Object(w.a)(e,w.a.EMPTY_OBJECT),!Object(u.a)(e.geometry))throw new h.a("options.geometry is required.");this.geometry=e.geometry,this.modelMatrix=Be.clone(Object(w.a)(e.modelMatrix,Be.IDENTITY)),this.id=e.id,this.pickPrimitive=e.pickPrimitive,this.attributes=Object(w.a)(e.attributes,{}),this.westHemisphereGeometry=void 0,this.eastHemisphereGeometry=void 0};function Ru(){this.high=z.clone(z.ZERO),this.low=z.clone(z.ZERO)}Ru.encode=function(e,t){var i;return x.a.typeOf.number("value",e),Object(u.a)(t)||(t={high:0,low:0}),e>=0?(i=65536*Math.floor(e/65536),t.high=i,t.low=e-i):(i=65536*Math.floor(-e/65536),t.high=-i,t.low=e+i),t};var Lu={high:0,low:0};Ru.fromCartesian=function(e,t){x.a.typeOf.object("cartesian",e),Object(u.a)(t)||(t=new Ru);var i=t.high,n=t.low;return Ru.encode(e.x,Lu),i.x=Lu.high,n.x=Lu.low,Ru.encode(e.y,Lu),i.y=Lu.high,n.y=Lu.low,Ru.encode(e.z,Lu),i.z=Lu.high,n.z=Lu.low,t};var Nu=new Ru;Ru.writeElements=function(e,t,i){x.a.defined("cartesianArray",t),x.a.typeOf.number("index",i),x.a.typeOf.number.greaterThanOrEquals("index",i,0),Ru.fromCartesian(e,Nu);var n=Nu.high,r=Nu.low;t[i]=n.x,t[i+1]=n.y,t[i+2]=n.z,t[i+3]=r.x,t[i+4]=r.y,t[i+5]=r.z};var Fu=Ru,ku={calculateACMR:function(e){var t=(e=Object(w.a)(e,w.a.EMPTY_OBJECT)).indices,i=e.maximumIndex,n=Object(w.a)(e.cacheSize,24);if(!Object(u.a)(t))throw new h.a("indices is required.");var r=t.length;if(r<3||r%3!=0)throw new h.a("indices length must be a multiple of three.");if(i<=0)throw new h.a("maximumIndex must be greater than zero.");if(n<3)throw new h.a("cacheSize must be greater than two.");if(!Object(u.a)(i)){i=0;for(var a=0,o=t[a];a<r;)o>i&&(i=o),o=t[++a]}for(var s=[],c=0;c<i+1;c++)s[c]=0;for(var l=n+1,d=0;d<r;++d)l-s[t[d]]>n&&(s[t[d]]=l,++l);return(l-n+1)/(r/3)}};ku.tipsify=function(e){var t,i=(e=Object(w.a)(e,w.a.EMPTY_OBJECT)).indices,n=e.maximumIndex,r=Object(w.a)(e.cacheSize,24);function a(e,i,n,r,a,o,s){for(var c,l=-1,u=-1,h=0;h<n.length;){var d=n[h];r[d].numLiveTriangles&&(c=0,a-r[d].timeStamp+2*r[d].numLiveTriangles<=i&&(c=a-r[d].timeStamp),(c>u||-1===u)&&(u=c,l=d)),++h}return-1===l?function(e,i,n,r){for(;i.length>=1;){var a=i[i.length-1];if(i.splice(i.length-1,1),e[a].numLiveTriangles>0)return a}for(;t<r;){if(e[t].numLiveTriangles>0)return++t-1;++t}return-1}(r,o,0,s):l}if(!Object(u.a)(i))throw new h.a("indices is required.");var o=i.length;if(o<3||o%3!=0)throw new h.a("indices length must be a multiple of three.");if(n<=0)throw new h.a("maximumIndex must be greater than zero.");if(r<3)throw new h.a("cacheSize must be greater than two.");var s=0,c=0,l=i[c],d=o;if(Object(u.a)(n))s=n+1;else{for(;c<d;)l>s&&(s=l),l=i[++c];if(-1===s)return 0;++s}var f,p=[];for(f=0;f<s;f++)p[f]={numLiveTriangles:0,timeStamp:0,vertexTriangles:[]};c=0;for(var m=0;c<d;)p[i[c]].vertexTriangles.push(m),++p[i[c]].numLiveTriangles,p[i[c+1]].vertexTriangles.push(m),++p[i[c+1]].numLiveTriangles,p[i[c+2]].vertexTriangles.push(m),++p[i[c+2]].numLiveTriangles,++m,c+=3;var _=0,g=r+1;t=1;var v,b,y,O,x=[],E=[],T=0,C=[],S=o/3,A=[];for(f=0;f<S;f++)A[f]=!1;for(;-1!==_;){x=[],O=(b=p[_]).vertexTriangles.length;for(var P=0;P<O;++P)if(!A[m=b.vertexTriangles[P]]){A[m]=!0,c=m+m+m;for(var I=0;I<3;++I)y=i[c],x.push(y),E.push(y),C[T]=y,++T,--(v=p[y]).numLiveTriangles,g-v.timeStamp>r&&(v.timeStamp=g,++g),++c}_=a(0,r,x,p,g,E,s)}return C};var Bu=ku,zu={};function Uu(e,t,i,n,r){e[t++]=i,e[t++]=n,e[t++]=n,e[t++]=r,e[t++]=r,e[t]=i}function Vu(e){var t={};for(var i in e)if(e.hasOwnProperty(i)&&Object(u.a)(e[i])&&Object(u.a)(e[i].values)){var n=e[i];t[i]=new Na({componentDatatype:n.componentDatatype,componentsPerAttribute:n.componentsPerAttribute,normalize:n.normalize,values:[]})}return t}function Hu(e,t,i){for(var n in t)if(t.hasOwnProperty(n)&&Object(u.a)(t[n])&&Object(u.a)(t[n].values))for(var r=t[n],a=0;a<r.componentsPerAttribute;++a)e[n].values.push(r.values[i*r.componentsPerAttribute+a])}zu.toWireframe=function(e){if(!Object(u.a)(e))throw new h.a("geometry is required.");var t=e.indices;if(Object(u.a)(t)){switch(e.primitiveType){case yn.TRIANGLES:e.indices=function(e){for(var t=e.length,i=t/3*6,n=Sl.createTypedArray(t,i),r=0,a=0;a<t;a+=3,r+=6)Uu(n,r,e[a],e[a+1],e[a+2]);return n}(t);break;case yn.TRIANGLE_STRIP:e.indices=function(e){var t=e.length;if(t>=3){var i=6*(t-2),n=Sl.createTypedArray(t,i);Uu(n,0,e[0],e[1],e[2]);for(var r=6,a=3;a<t;++a,r+=6)Uu(n,r,e[a-1],e[a],e[a-2]);return n}return new Uint16Array}(t);break;case yn.TRIANGLE_FAN:e.indices=function(e){if(e.length>0){for(var t=e.length-1,i=6*(t-1),n=Sl.createTypedArray(t,i),r=e[0],a=0,o=1;o<t;++o,a+=6)Uu(n,a,r,e[o],e[o+1]);return n}return new Uint16Array}(t);break;default:throw new h.a("geometry.primitiveType must be TRIANGLES, TRIANGLE_STRIP, or TRIANGLE_FAN.")}e.primitiveType=yn.LINES}return e},zu.createLineSegmentsForVectors=function(e,t,i){if(t=Object(w.a)(t,"normal"),!Object(u.a)(e))throw new h.a("geometry is required.");if(!Object(u.a)(e.attributes.position))throw new h.a("geometry.attributes.position is required.");if(!Object(u.a)(e.attributes[t]))throw new h.a("geometry.attributes must have an attribute with the same name as the attributeName parameter, "+t+".");i=Object(w.a)(i,1e4);for(var n,r=e.attributes.position.values,a=e.attributes[t].values,o=r.length,s=new Float64Array(2*o),c=0,l=0;l<o;l+=3)s[c++]=r[l],s[c++]=r[l+1],s[c++]=r[l+2],s[c++]=r[l]+a[l]*i,s[c++]=r[l+1]+a[l+1]*i,s[c++]=r[l+2]+a[l+2]*i;var d=e.boundingSphere;return Object(u.a)(d)&&(n=new St(d.center,d.radius+i)),new La({attributes:{position:new Na({componentDatatype:dn.DOUBLE,componentsPerAttribute:3,values:s})},primitiveType:yn.LINES,boundingSphere:n})},zu.createAttributeLocations=function(e){if(!Object(u.a)(e))throw new h.a("geometry is required.");var t,i=["position","positionHigh","positionLow","position3DHigh","position3DLow","position2DHigh","position2DLow","pickColor","normal","st","tangent","bitangent","extrudeDirection","compressedAttributes"],n=e.attributes,r={},a=0,o=i.length;for(t=0;t<o;++t){var s=i[t];Object(u.a)(n[s])&&(r[s]=a++)}for(var c in n)n.hasOwnProperty(c)&&!Object(u.a)(r[c])&&(r[c]=a++);return r},zu.reorderForPreVertexCache=function(e){if(!Object(u.a)(e))throw new h.a("geometry is required.");var t=La.computeNumberOfVertices(e),i=e.indices;if(Object(u.a)(i)){for(var n=new Int32Array(t),r=0;r<t;r++)n[r]=-1;for(var a,o=i,s=o.length,c=Sl.createTypedArray(t,s),l=0,d=0,f=0;l<s;)-1!==(a=n[o[l]])?c[d]=a:(n[a=o[l]]=f,c[d]=f,++f),++l,++d;e.indices=c;var p=e.attributes;for(var m in p)if(p.hasOwnProperty(m)&&Object(u.a)(p[m])&&Object(u.a)(p[m].values)){for(var _=p[m],g=_.values,v=0,b=_.componentsPerAttribute,y=dn.createTypedArray(_.componentDatatype,f*b);v<t;){var w=n[v];if(-1!==w)for(var O=0;O<b;O++)y[b*w+O]=g[b*v+O];++v}_.values=y}}return e},zu.reorderForPostVertexCache=function(e,t){if(!Object(u.a)(e))throw new h.a("geometry is required.");var i=e.indices;if(e.primitiveType===yn.TRIANGLES&&Object(u.a)(i)){for(var n=i.length,r=0,a=0;a<n;a++)i[a]>r&&(r=i[a]);e.indices=Bu.tipsify({indices:i,maximumIndex:r,cacheSize:t})}return e},zu.fitToUnsignedShortIndices=function(e){if(!Object(u.a)(e))throw new h.a("geometry is required.");if(Object(u.a)(e.indices)&&e.primitiveType!==yn.TRIANGLES&&e.primitiveType!==yn.LINES&&e.primitiveType!==yn.POINTS)throw new h.a("geometry.primitiveType must equal to PrimitiveType.TRIANGLES, PrimitiveType.LINES, or PrimitiveType.POINTS.");var t=[],i=La.computeNumberOfVertices(e);if(Object(u.a)(e.indices)&&i>=I.SIXTY_FOUR_KILOBYTES){var n,r=[],a=[],o=0,s=Vu(e.attributes),c=e.indices,l=c.length;e.primitiveType===yn.TRIANGLES?n=3:e.primitiveType===yn.LINES?n=2:e.primitiveType===yn.POINTS&&(n=1);for(var d=0;d<l;d+=n){for(var f=0;f<n;++f){var p=c[d+f],m=r[p];Object(u.a)(m)||(m=o++,r[p]=m,Hu(s,e.attributes,p)),a.push(m)}o+n>=I.SIXTY_FOUR_KILOBYTES&&(t.push(new La({attributes:s,indices:a,primitiveType:e.primitiveType,boundingSphere:e.boundingSphere,boundingSphereCV:e.boundingSphereCV})),r=[],a=[],o=0,s=Vu(e.attributes))}0!==a.length&&t.push(new La({attributes:s,indices:a,primitiveType:e.primitiveType,boundingSphere:e.boundingSphere,boundingSphereCV:e.boundingSphereCV}))}else t.push(e);return t};var Gu=new z,qu=new K;zu.projectTo2D=function(e,t,i,n,r){if(!Object(u.a)(e))throw new h.a("geometry is required.");if(!Object(u.a)(t))throw new h.a("attributeName is required.");if(!Object(u.a)(i))throw new h.a("attributeName3D is required.");if(!Object(u.a)(n))throw new h.a("attributeName2D is required.");if(!Object(u.a)(e.attributes[t]))throw new h.a("geometry must have attribute matching the attributeName argument: "+t+".");if(e.attributes[t].componentDatatype!==dn.DOUBLE)throw new h.a("The attribute componentDatatype must be ComponentDatatype.DOUBLE.");for(var a=e.attributes[t],o=(r=Object(u.a)(r)?r:new se).ellipsoid,s=a.values,c=new Float64Array(s.length),l=0,d=0;d<s.length;d+=3){var f=z.fromArray(s,d,Gu),p=o.cartesianToCartographic(f,qu);if(!Object(u.a)(p))throw new h.a("Could not project point ("+f.x+", "+f.y+", "+f.z+") to 2D.");var m=r.project(p,Gu);c[l++]=m.x,c[l++]=m.y,c[l++]=m.z}return e.attributes[i]=a,e.attributes[n]=new Na({componentDatatype:dn.DOUBLE,componentsPerAttribute:3,values:c}),delete e.attributes[t],e};var Wu={high:0,low:0};zu.encodeAttribute=function(e,t,i,n){if(!Object(u.a)(e))throw new h.a("geometry is required.");if(!Object(u.a)(t))throw new h.a("attributeName is required.");if(!Object(u.a)(i))throw new h.a("attributeHighName is required.");if(!Object(u.a)(n))throw new h.a("attributeLowName is required.");if(!Object(u.a)(e.attributes[t]))throw new h.a("geometry must have attribute matching the attributeName argument: "+t+".");if(e.attributes[t].componentDatatype!==dn.DOUBLE)throw new h.a("The attribute componentDatatype must be ComponentDatatype.DOUBLE.");for(var r=e.attributes[t],a=r.values,o=a.length,s=new Float32Array(o),c=new Float32Array(o),l=0;l<o;++l)Fu.encode(a[l],Wu),s[l]=Wu.high,c[l]=Wu.low;var d=r.componentsPerAttribute;return e.attributes[i]=new Na({componentDatatype:dn.FLOAT,componentsPerAttribute:d,values:s}),e.attributes[n]=new Na({componentDatatype:dn.FLOAT,componentsPerAttribute:d,values:c}),delete e.attributes[t],e};var Yu=new z;function Xu(e,t){if(Object(u.a)(t))for(var i=t.values,n=i.length,r=0;r<n;r+=3)z.unpack(i,r,Yu),Be.multiplyByPoint(e,Yu,Yu),z.pack(Yu,i,r)}function Zu(e,t){if(Object(u.a)(t))for(var i=t.values,n=i.length,r=0;r<n;r+=3)z.unpack(i,r,Yu),be.multiplyByVector(e,Yu,Yu),Yu=z.normalize(Yu,Yu),z.pack(Yu,i,r)}var Qu=new Be,Ku=new be;zu.transformToWorldCoordinates=function(e){if(!Object(u.a)(e))throw new h.a("instance is required.");var t=e.modelMatrix;if(Be.equals(t,Be.IDENTITY))return e;var i=e.geometry.attributes;Xu(t,i.position),Xu(t,i.prevPosition),Xu(t,i.nextPosition),(Object(u.a)(i.normal)||Object(u.a)(i.tangent)||Object(u.a)(i.bitangent))&&(Be.inverse(t,Qu),Be.transpose(Qu,Qu),Be.getRotation(Qu,Ku),Zu(Ku,i.normal),Zu(Ku,i.tangent),Zu(Ku,i.bitangent));var n=e.geometry.boundingSphere;return Object(u.a)(n)&&(e.geometry.boundingSphere=St.transform(n,t,n)),e.modelMatrix=Be.clone(Be.IDENTITY),e};var Ju=new z;function $u(e,t){var i,n,r,a,o=e.length,s=e[0].modelMatrix,c=Object(u.a)(e[0][t].indices),l=e[0][t].primitiveType;for(n=1;n<o;++n){if(!Be.equals(e[n].modelMatrix,s))throw new h.a("All instances must have the same modelMatrix.");if(Object(u.a)(e[n][t].indices)!==c)throw new h.a("All instance geometries must have an indices or not have one.");if(e[n][t].primitiveType!==l)throw new h.a("All instance geometries must have the same primitiveType.")}var d,f,p,m,_=function(e,t){var i,n=e.length,r={},a=e[0][t].attributes;for(i in a)if(a.hasOwnProperty(i)&&Object(u.a)(a[i])&&Object(u.a)(a[i].values)){for(var o=a[i],s=o.values.length,c=!0,l=1;l<n;++l){var h=e[l][t].attributes[i];if(!Object(u.a)(h)||o.componentDatatype!==h.componentDatatype||o.componentsPerAttribute!==h.componentsPerAttribute||o.normalize!==h.normalize){c=!1;break}s+=h.values.length}c&&(r[i]=new Na({componentDatatype:o.componentDatatype,componentsPerAttribute:o.componentsPerAttribute,normalize:o.normalize,values:dn.createTypedArray(o.componentDatatype,s)}))}return r}(e,t);for(i in _)if(_.hasOwnProperty(i))for(d=_[i].values,a=0,n=0;n<o;++n)for(p=(f=e[n][t].attributes[i].values).length,r=0;r<p;++r)d[a++]=f[r];if(c){var g=0;for(n=0;n<o;++n)g+=e[n][t].indices.length;var v=La.computeNumberOfVertices(new La({attributes:_,primitiveType:yn.POINTS})),b=Sl.createTypedArray(v,g),y=0,w=0;for(n=0;n<o;++n){var O=e[n][t].indices,x=O.length;for(a=0;a<x;++a)b[y++]=w+O[a];w+=La.computeNumberOfVertices(e[n][t])}m=b}var E,T=new z,C=0;for(n=0;n<o;++n){if(E=e[n][t].boundingSphere,!Object(u.a)(E)){T=void 0;break}z.add(E.center,T,T)}if(Object(u.a)(T))for(z.divideByScalar(T,o,T),n=0;n<o;++n){E=e[n][t].boundingSphere;var S=z.magnitude(z.subtract(E.center,T,Ju))+E.radius;S>C&&(C=S)}return new La({attributes:_,indices:m,primitiveType:l,boundingSphere:Object(u.a)(T)?new St(T,C):void 0})}zu.combineInstances=function(e){if(!Object(u.a)(e)||e.length<1)throw new h.a("instances is required and must have length greater than zero.");for(var t=[],i=[],n=e.length,r=0;r<n;++r){var a=e[r];Object(u.a)(a.geometry)?t.push(a):Object(u.a)(a.westHemisphereGeometry)&&Object(u.a)(a.eastHemisphereGeometry)&&i.push(a)}var o=[];return t.length>0&&o.push($u(t,"geometry")),i.length>0&&(o.push($u(i,"westHemisphereGeometry")),o.push($u(i,"eastHemisphereGeometry"))),o};var eh=new z,th=new z,ih=new z,nh=new z;zu.computeNormal=function(e){if(!Object(u.a)(e))throw new h.a("geometry is required.");if(!Object(u.a)(e.attributes.position)||!Object(u.a)(e.attributes.position.values))throw new h.a("geometry.attributes.position.values is required.");if(!Object(u.a)(e.indices))throw new h.a("geometry.indices is required.");if(e.indices.length<2||e.indices.length%3!=0)throw new h.a("geometry.indices length must be greater than 0 and be a multiple of 3.");if(e.primitiveType!==yn.TRIANGLES)throw new h.a("geometry.primitiveType must be PrimitiveType.TRIANGLES.");var t,i=e.indices,n=e.attributes,r=n.position.values,a=n.position.values.length/3,o=i.length,s=new Array(a),c=new Array(o/3),l=new Array(o);for(t=0;t<a;t++)s[t]={indexOffset:0,count:0,currentCount:0};var d=0;for(t=0;t<o;t+=3){var f=i[t],p=i[t+1],m=i[t+2],_=3*f,g=3*p,v=3*m;th.x=r[_],th.y=r[_+1],th.z=r[_+2],ih.x=r[g],ih.y=r[g+1],ih.z=r[g+2],nh.x=r[v],nh.y=r[v+1],nh.z=r[v+2],s[f].count++,s[p].count++,s[m].count++,z.subtract(ih,th,ih),z.subtract(nh,th,nh),c[d]=z.cross(ih,nh,new z),d++}var b,y=0;for(t=0;t<a;t++)s[t].indexOffset+=y,y+=s[t].count;for(d=0,t=0;t<o;t+=3){var w=(b=s[i[t]]).indexOffset+b.currentCount;l[w]=d,b.currentCount++,l[w=(b=s[i[t+1]]).indexOffset+b.currentCount]=d,b.currentCount++,l[w=(b=s[i[t+2]]).indexOffset+b.currentCount]=d,b.currentCount++,d++}var O=new Float32Array(3*a);for(t=0;t<a;t++){var x=3*t;if(b=s[t],z.clone(z.ZERO,eh),b.count>0){for(d=0;d<b.count;d++)z.add(eh,c[l[b.indexOffset+d]],eh);z.equalsEpsilon(z.ZERO,eh,I.EPSILON10)&&z.clone(c[l[b.indexOffset]],eh)}z.equalsEpsilon(z.ZERO,eh,I.EPSILON10)&&(eh.z=1),z.normalize(eh,eh),O[x]=eh.x,O[x+1]=eh.y,O[x+2]=eh.z}return e.attributes.normal=new Na({componentDatatype:dn.FLOAT,componentsPerAttribute:3,values:O}),e};var rh=new z,ah=new z,oh=new z;zu.computeTangentAndBitangent=function(e){if(!Object(u.a)(e))throw new h.a("geometry is required.");var t=e.attributes,i=e.indices;if(!Object(u.a)(t.position)||!Object(u.a)(t.position.values))throw new h.a("geometry.attributes.position.values is required.");if(!Object(u.a)(t.normal)||!Object(u.a)(t.normal.values))throw new h.a("geometry.attributes.normal.values is required.");if(!Object(u.a)(t.st)||!Object(u.a)(t.st.values))throw new h.a("geometry.attributes.st.values is required.");if(!Object(u.a)(i))throw new h.a("geometry.indices is required.");if(i.length<2||i.length%3!=0)throw new h.a("geometry.indices length must be greater than 0 and be a multiple of 3.");if(e.primitiveType!==yn.TRIANGLES)throw new h.a("geometry.primitiveType must be PrimitiveType.TRIANGLES.");var n,r,a,o,s=e.attributes.position.values,c=e.attributes.normal.values,l=e.attributes.st.values,d=e.attributes.position.values.length/3,f=i.length,p=new Array(3*d);for(n=0;n<p.length;n++)p[n]=0;for(n=0;n<f;n+=3){var m=i[n],_=i[n+1],g=i[n+2];a=3*_,o=3*g;var v=2*m,b=2*_,y=2*g,w=s[r=3*m],O=s[r+1],x=s[r+2],E=l[v],T=l[v+1],C=l[b+1]-T,S=l[y+1]-T,A=1/((l[b]-E)*S-(l[y]-E)*C),P=(S*(s[a]-w)-C*(s[o]-w))*A,I=(S*(s[a+1]-O)-C*(s[o+1]-O))*A,D=(S*(s[a+2]-x)-C*(s[o+2]-x))*A;p[r]+=P,p[r+1]+=I,p[r+2]+=D,p[a]+=P,p[a+1]+=I,p[a+2]+=D,p[o]+=P,p[o+1]+=I,p[o+2]+=D}var j=new Float32Array(3*d),M=new Float32Array(3*d);for(n=0;n<d;n++){a=(r=3*n)+1,o=r+2;var R=z.fromArray(c,r,rh),L=z.fromArray(p,r,oh),N=z.dot(R,L);z.multiplyByScalar(R,N,ah),z.normalize(z.subtract(L,ah,L),L),j[r]=L.x,j[a]=L.y,j[o]=L.z,z.normalize(z.cross(R,L,L),L),M[r]=L.x,M[a]=L.y,M[o]=L.z}return e.attributes.tangent=new Na({componentDatatype:dn.FLOAT,componentsPerAttribute:3,values:j}),e.attributes.bitangent=new Na({componentDatatype:dn.FLOAT,componentsPerAttribute:3,values:M}),e};var sh=new Rt,ch=new z,lh=new z,uh=new z,hh=new Rt;function dh(e){switch(e.primitiveType){case yn.TRIANGLE_FAN:return function(e){var t=La.computeNumberOfVertices(e);if(t<3)throw new h.a("The number of vertices must be at least three.");var i=Sl.createTypedArray(t,3*(t-2));i[0]=1,i[1]=0,i[2]=2;for(var n=3,r=3;r<t;++r)i[n++]=r-1,i[n++]=0,i[n++]=r;return e.indices=i,e.primitiveType=yn.TRIANGLES,e}(e);case yn.TRIANGLE_STRIP:return function(e){var t=La.computeNumberOfVertices(e);if(t<3)throw new h.a("The number of vertices must be at least 3.");var i=Sl.createTypedArray(t,3*(t-2));i[0]=0,i[1]=1,i[2]=2,t>3&&(i[3]=0,i[4]=2,i[5]=3);for(var n=6,r=3;r<t-1;r+=2)i[n++]=r,i[n++]=r-1,i[n++]=r+1,r+2<t&&(i[n++]=r,i[n++]=r+1,i[n++]=r+2);return e.indices=i,e.primitiveType=yn.TRIANGLES,e}(e);case yn.TRIANGLES:return function(e){if(Object(u.a)(e.indices))return e;var t=La.computeNumberOfVertices(e);if(t<3)throw new h.a("The number of vertices must be at least three.");if(t%3!=0)throw new h.a("The number of vertices must be a multiple of three.");for(var i=Sl.createTypedArray(t,t),n=0;n<t;++n)i[n]=n;return e.indices=i,e}(e);case yn.LINE_STRIP:return function(e){var t=La.computeNumberOfVertices(e);if(t<2)throw new h.a("The number of vertices must be at least two.");var i=Sl.createTypedArray(t,2*(t-1));i[0]=0,i[1]=1;for(var n=2,r=2;r<t;++r)i[n++]=r-1,i[n++]=r;return e.indices=i,e.primitiveType=yn.LINES,e}(e);case yn.LINE_LOOP:return function(e){var t=La.computeNumberOfVertices(e);if(t<2)throw new h.a("The number of vertices must be at least two.");var i=Sl.createTypedArray(t,2*t);i[0]=0,i[1]=1;for(var n=2,r=2;r<t;++r)i[n++]=r-1,i[n++]=r;return i[n++]=t-1,i[n]=0,e.indices=i,e.primitiveType=yn.LINES,e}(e);case yn.LINES:return function(e){if(Object(u.a)(e.indices))return e;var t=La.computeNumberOfVertices(e);if(t<2)throw new h.a("The number of vertices must be at least two.");if(t%2!=0)throw new h.a("The number of vertices must be a multiple of 2.");for(var i=Sl.createTypedArray(t,t),n=0;n<t;++n)i[n]=n;return e.indices=i,e}(e)}return e}function fh(e,t){Math.abs(e.y)<I.EPSILON6&&(e.y=t?-I.EPSILON6:I.EPSILON6)}zu.compressVertices=function(e){if(!Object(u.a)(e))throw new h.a("geometry is required.");var t,i,n=e.attributes.extrudeDirection;if(Object(u.a)(n)){var r=n.values;i=r.length/3;var a=new Float32Array(2*i),o=0;for(t=0;t<i;++t)z.fromArray(r,3*t,ch),z.equals(ch,z.ZERO)?o+=2:(hh=Gi.octEncodeInRange(ch,65535,hh),a[o++]=hh.x,a[o++]=hh.y);return e.attributes.compressedAttributes=new Na({componentDatatype:dn.FLOAT,componentsPerAttribute:2,values:a}),delete e.attributes.extrudeDirection,e}var s=e.attributes.normal,c=e.attributes.st,l=Object(u.a)(s),d=Object(u.a)(c);if(!l&&!d)return e;var f,p,m,_,g=e.attributes.tangent,v=e.attributes.bitangent,b=Object(u.a)(g),y=Object(u.a)(v);l&&(f=s.values),d&&(p=c.values),b&&(m=g.values),y&&(_=v.values);var w=i=(l?f.length:p.length)/(l?3:2),O=d&&l?2:1;O+=b||y?1:0;var x=new Float32Array(w*=O),E=0;for(t=0;t<i;++t){d&&(Rt.fromArray(p,2*t,sh),x[E++]=Gi.compressTextureCoordinates(sh));var T=3*t;l&&Object(u.a)(m)&&Object(u.a)(_)?(z.fromArray(f,T,ch),z.fromArray(m,T,lh),z.fromArray(_,T,uh),Gi.octPack(ch,lh,uh,sh),x[E++]=sh.x,x[E++]=sh.y):(l&&(z.fromArray(f,T,ch),x[E++]=Gi.octEncodeFloat(ch)),b&&(z.fromArray(m,T,ch),x[E++]=Gi.octEncodeFloat(ch)),y&&(z.fromArray(_,T,ch),x[E++]=Gi.octEncodeFloat(ch)))}return e.attributes.compressedAttributes=new Na({componentDatatype:dn.FLOAT,componentsPerAttribute:O,values:x}),l&&delete e.attributes.normal,d&&delete e.attributes.st,y&&delete e.attributes.bitangent,b&&delete e.attributes.tangent,e};var ph=new z;function mh(e,t,i,n){z.add(e,z.multiplyByScalar(z.subtract(t,e,ph),e.y/(e.y-t.y),ph),i),z.clone(i,n),fh(i,!0),fh(n,!1)}var _h=new z,gh=new z,vh=new z,bh=new z,yh={positions:new Array(7),indices:new Array(9)};function wh(e,t,i){if(!(e.x>=0||t.x>=0||i.x>=0)){!function(e,t,i){if(0!==e.y&&0!==t.y&&0!==i.y)return fh(e,e.y<0),fh(t,t.y<0),void fh(i,i.y<0);var n=Math.abs(e.y),r=Math.abs(t.y),a=Math.abs(i.y),o=(n>r?n>a?I.sign(e.y):I.sign(i.y):r>a?I.sign(t.y):I.sign(i.y))<0;fh(e,o),fh(t,o),fh(i,o)}(e,t,i);var n=e.y<0,r=t.y<0,a=i.y<0,o=0;o+=n?1:0,o+=r?1:0,o+=a?1:0;var s=yh.indices;1===o?(s[1]=3,s[2]=4,s[5]=6,s[7]=6,s[8]=5,n?(mh(e,t,_h,vh),mh(e,i,gh,bh),s[0]=0,s[3]=1,s[4]=2,s[6]=1):r?(mh(t,i,_h,vh),mh(t,e,gh,bh),s[0]=1,s[3]=2,s[4]=0,s[6]=2):a&&(mh(i,e,_h,vh),mh(i,t,gh,bh),s[0]=2,s[3]=0,s[4]=1,s[6]=0)):2===o&&(s[2]=4,s[4]=4,s[5]=3,s[7]=5,s[8]=6,n?r?a||(mh(i,e,_h,vh),mh(i,t,gh,bh),s[0]=0,s[1]=1,s[3]=0,s[6]=2):(mh(t,i,_h,vh),mh(t,e,gh,bh),s[0]=2,s[1]=0,s[3]=2,s[6]=1):(mh(e,t,_h,vh),mh(e,i,gh,bh),s[0]=1,s[1]=2,s[3]=1,s[6]=0));var c=yh.positions;return c[0]=e,c[1]=t,c[2]=i,c.length=3,1!==o&&2!==o||(c[3]=_h,c[4]=gh,c[5]=vh,c[6]=bh,c.length=7),yh}}function Oh(e,t){var i=e.attributes;if(0!==i.position.values.length){for(var n in i)if(i.hasOwnProperty(n)&&Object(u.a)(i[n])&&Object(u.a)(i[n].values)){var r=i[n];r.values=dn.createTypedArray(r.componentDatatype,r.values)}var a=La.computeNumberOfVertices(e);return e.indices=Sl.createTypedArray(a,e.indices),t&&(e.boundingSphere=St.fromVertices(i.position.values)),e}}function xh(e){var t=e.attributes,i={};for(var n in t)if(t.hasOwnProperty(n)&&Object(u.a)(t[n])&&Object(u.a)(t[n].values)){var r=t[n];i[n]=new Na({componentDatatype:r.componentDatatype,componentsPerAttribute:r.componentsPerAttribute,normalize:r.normalize,values:[]})}return new La({attributes:i,indices:[],primitiveType:e.primitiveType})}function Eh(e,t,i){var n=Object(u.a)(e.geometry.boundingSphere);t=Oh(t,n),i=Oh(i,n),Object(u.a)(i)&&!Object(u.a)(t)?e.geometry=i:!Object(u.a)(i)&&Object(u.a)(t)?e.geometry=t:(e.westHemisphereGeometry=t,e.eastHemisphereGeometry=i,e.geometry=void 0)}function Th(e,t){var i=new e,n=new e,r=new e;return function(a,o,s,c,l,u,h,d){var f=e.fromArray(l,a*t,i),p=e.fromArray(l,o*t,n),m=e.fromArray(l,s*t,r);e.multiplyByScalar(f,c.x,f),e.multiplyByScalar(p,c.y,p),e.multiplyByScalar(m,c.z,m);var _=e.add(f,p,f);e.add(_,m,_),d&&e.normalize(_,_),e.pack(_,u,h*t)}}var Ch=Th(Te,4),Sh=Th(z,3),Ah=Th(Rt,2),Ph=function(e,t,i,n,r,a,o){var s=r[e]*n.x,c=r[t]*n.y,l=r[i]*n.z;a[o]=s+c+l>I.EPSILON6?1:0},Ih=new z,Dh=new z,jh=new z,Mh=new z;function Rh(e,t,i,n,r,a,o,s,c,l,h,d,f,p,m,_){if(Object(u.a)(a)||Object(u.a)(o)||Object(u.a)(s)||Object(u.a)(c)||Object(u.a)(l)||0!==p){var g=z.fromArray(r,3*e,Ih),v=z.fromArray(r,3*t,Dh),b=z.fromArray(r,3*i,jh),y=Ki(n,g,v,b,Mh);if(Object(u.a)(a)&&Sh(e,t,i,y,a,d.normal.values,_,!0),Object(u.a)(l)){var w,O=z.fromArray(l,3*e,Ih),x=z.fromArray(l,3*t,Dh),E=z.fromArray(l,3*i,jh);z.multiplyByScalar(O,y.x,O),z.multiplyByScalar(x,y.y,x),z.multiplyByScalar(E,y.z,E),z.equals(O,z.ZERO)&&z.equals(x,z.ZERO)&&z.equals(E,z.ZERO)?((w=Ih).x=0,w.y=0,w.z=0):(w=z.add(O,x,O),z.add(w,E,w),z.normalize(w,w)),z.pack(w,d.extrudeDirection.values,3*_)}if(Object(u.a)(h)&&Ph(e,t,i,y,h,d.applyOffset.values,_),Object(u.a)(o)&&Sh(e,t,i,y,o,d.tangent.values,_,!0),Object(u.a)(s)&&Sh(e,t,i,y,s,d.bitangent.values,_,!0),Object(u.a)(c)&&Ah(e,t,i,y,c,d.st.values,_),p>0)for(var T=0;T<p;T++){var C=f[T];Lh(e,t,i,y,_,m[C],d[C])}}}function Lh(e,t,i,n,r,a,o){var s=a.componentsPerAttribute,c=a.values,l=o.values;switch(s){case 4:Ch(e,t,i,n,c,l,r,!1);break;case 3:Sh(e,t,i,n,c,l,r,!1);break;case 2:Ah(e,t,i,n,c,l,r,!1);break;default:l[r]=c[e]*n.x+c[t]*n.y+c[i]*n.z}}function Nh(e,t,i,n,r,a){var o=e.position.values.length/3;if(-1!==r){var s=n[r],c=i[s];return-1===c?(i[s]=o,e.position.values.push(a.x,a.y,a.z),t.push(o),o):(t.push(c),c)}return e.position.values.push(a.x,a.y,a.z),t.push(o),o}var Fh={position:!0,normal:!0,bitangent:!0,tangent:!0,st:!0,extrudeDirection:!0,applyOffset:!0};function kh(e){var t=e.geometry,i=t.attributes,n=i.position.values,r=Object(u.a)(i.normal)?i.normal.values:void 0,a=Object(u.a)(i.bitangent)?i.bitangent.values:void 0,o=Object(u.a)(i.tangent)?i.tangent.values:void 0,s=Object(u.a)(i.st)?i.st.values:void 0,c=Object(u.a)(i.extrudeDirection)?i.extrudeDirection.values:void 0,l=Object(u.a)(i.applyOffset)?i.applyOffset.values:void 0,h=t.indices,d=[];for(var f in i)i.hasOwnProperty(f)&&!Fh[f]&&Object(u.a)(i[f])&&d.push(f);var p,m,_,g,v=d.length,b=xh(t),y=xh(t),w=[];w.length=n.length/3;var O=[];for(O.length=n.length/3,g=0;g<w.length;++g)w[g]=-1,O[g]=-1;var x=h.length;for(g=0;g<x;g+=3){var E=h[g],T=h[g+1],C=h[g+2],S=z.fromArray(n,3*E),A=z.fromArray(n,3*T),P=z.fromArray(n,3*C),I=wh(S,A,P);if(Object(u.a)(I)&&I.positions.length>3)for(var D=I.positions,j=I.indices,M=j.length,R=0;R<M;++R){var L=j[R],N=D[L];N.y<0?(p=y.attributes,m=y.indices,_=w):(p=b.attributes,m=b.indices,_=O),Rh(E,T,C,N,n,r,o,a,s,c,l,p,d,v,i,Nh(p,m,_,h,L<3?g+L:-1,N))}else Object(u.a)(I)&&(S=I.positions[0],A=I.positions[1],P=I.positions[2]),S.y<0?(p=y.attributes,m=y.indices,_=w):(p=b.attributes,m=b.indices,_=O),Rh(E,T,C,S,n,r,o,a,s,c,l,p,d,v,i,Nh(p,m,_,h,g,S)),Rh(E,T,C,A,n,r,o,a,s,c,l,p,d,v,i,Nh(p,m,_,h,g+1,A)),Rh(E,T,C,P,n,r,o,a,s,c,l,p,d,v,i,Nh(p,m,_,h,g+2,P))}Eh(e,y,b)}var Bh=oc.fromPointNormal(z.ZERO,z.UNIT_Y),zh=new z,Uh=new z;function Vh(e,t,i,n,r,a,o){if(Object(u.a)(o)){var s=z.fromArray(n,3*e,Ih);z.equalsEpsilon(s,i,I.EPSILON10)?a.applyOffset.values[r]=o[e]:a.applyOffset.values[r]=o[t]}}function Hh(e){var t,i=e.geometry,n=i.attributes,r=n.position.values,a=Object(u.a)(n.applyOffset)?n.applyOffset.values:void 0,o=i.indices,s=xh(i),c=xh(i),l=o.length,h=[];h.length=r.length/3;var d=[];for(d.length=r.length/3,t=0;t<h.length;++t)h[t]=-1,d[t]=-1;for(t=0;t<l;t+=2){var f=o[t],p=o[t+1],m=z.fromArray(r,3*f,Ih),_=z.fromArray(r,3*p,Dh);Math.abs(m.y)<I.EPSILON6&&(m.y<0?m.y=-I.EPSILON6:m.y=I.EPSILON6),Math.abs(_.y)<I.EPSILON6&&(_.y<0?_.y=-I.EPSILON6:_.y=I.EPSILON6);var g=s.attributes,v=s.indices,b=d,y=c.attributes,w=c.indices,O=h,x=tc.lineSegmentPlane(m,_,Bh,jh);if(Object(u.a)(x)){var E=z.multiplyByScalar(z.UNIT_Y,5*I.EPSILON9,zh);m.y<0&&(z.negate(E,E),g=c.attributes,v=c.indices,b=h,y=s.attributes,w=s.indices,O=d);var T=z.add(x,E,Uh);Vh(f,p,m,r,Nh(g,v,b,o,t,m),g,a),Vh(f,p,T,r,Nh(g,v,b,o,-1,T),g,a),z.negate(E,E),z.add(x,E,T),Vh(f,p,T,r,Nh(y,w,O,o,-1,T),y,a),Vh(f,p,_,r,Nh(y,w,O,o,t+1,_),y,a)}else{var C,S,A;m.y<0?(C=c.attributes,S=c.indices,A=h):(C=s.attributes,S=s.indices,A=d),Vh(f,p,m,r,Nh(C,S,A,o,t,m),C,a),Vh(f,p,_,r,Nh(C,S,A,o,t+1,_),C,a)}}Eh(e,c,s)}var Gh=new Rt,qh=new Rt,Wh=new z,Yh=new z,Xh=new z,Zh=new z,Qh=new z,Kh=new z,Jh=new Te;function $h(e){for(var t=e.attributes,i=t.position.values,n=t.prevPosition.values,r=t.nextPosition.values,a=i.length,o=0;o<a;o+=3){var s=z.unpack(i,o,Wh);if(!(s.x>0)){var c=z.unpack(n,o,Yh);(s.y<0&&c.y>0||s.y>0&&c.y<0)&&(o-3>0?(n[o]=i[o-3],n[o+1]=i[o-2],n[o+2]=i[o-1]):z.pack(s,n,o));var l=z.unpack(r,o,Xh);(s.y<0&&l.y>0||s.y>0&&l.y<0)&&(o+3<a?(r[o]=i[o+3],r[o+1]=i[o+4],r[o+2]=i[o+5]):z.pack(s,r,o))}}}var ed=5*I.EPSILON9,td=I.EPSILON6;zu.splitLongitude=function(e){if(!Object(u.a)(e))throw new h.a("instance is required.");var t=e.geometry,i=t.boundingSphere;if(Object(u.a)(i)&&(i.center.x-i.radius>0||St.intersectPlane(i,oc.ORIGIN_ZX_PLANE)!==ce.INTERSECTING))return e;if(t.geometryType!==pn.NONE)switch(t.geometryType){case pn.POLYLINES:!function(e){var t,i,n,r=e.geometry,a=r.attributes,o=a.position.values,s=a.prevPosition.values,c=a.nextPosition.values,l=a.expandAndWidth.values,h=Object(u.a)(a.st)?a.st.values:void 0,d=Object(u.a)(a.color)?a.color.values:void 0,f=xh(r),p=xh(r),m=!1,_=o.length/3;for(t=0;t<_;t+=4){var g=t,v=t+2,b=z.fromArray(o,3*g,Wh),y=z.fromArray(o,3*v,Yh);if(Math.abs(b.y)<td)for(b.y=td*(y.y<0?-1:1),o[3*t+1]=b.y,o[3*(t+1)+1]=b.y,i=3*g;i<3*g+12;i+=3)s[i]=o[3*t],s[i+1]=o[3*t+1],s[i+2]=o[3*t+2];if(Math.abs(y.y)<td)for(y.y=td*(b.y<0?-1:1),o[3*(t+2)+1]=y.y,o[3*(t+3)+1]=y.y,i=3*g;i<3*g+12;i+=3)c[i]=o[3*(t+2)],c[i+1]=o[3*(t+2)+1],c[i+2]=o[3*(t+2)+2];var w=f.attributes,O=f.indices,x=p.attributes,E=p.indices,T=tc.lineSegmentPlane(b,y,Bh,Zh);if(Object(u.a)(T)){m=!0;var C=z.multiplyByScalar(z.UNIT_Y,ed,Qh);b.y<0&&(z.negate(C,C),w=p.attributes,O=p.indices,x=f.attributes,E=f.indices);var S=z.add(T,C,Kh);w.position.values.push(b.x,b.y,b.z,b.x,b.y,b.z),w.position.values.push(S.x,S.y,S.z),w.position.values.push(S.x,S.y,S.z),w.prevPosition.values.push(s[3*g],s[3*g+1],s[3*g+2]),w.prevPosition.values.push(s[3*g+3],s[3*g+4],s[3*g+5]),w.prevPosition.values.push(b.x,b.y,b.z,b.x,b.y,b.z),w.nextPosition.values.push(S.x,S.y,S.z),w.nextPosition.values.push(S.x,S.y,S.z),w.nextPosition.values.push(S.x,S.y,S.z),w.nextPosition.values.push(S.x,S.y,S.z),z.negate(C,C),z.add(T,C,S),x.position.values.push(S.x,S.y,S.z),x.position.values.push(S.x,S.y,S.z),x.position.values.push(y.x,y.y,y.z,y.x,y.y,y.z),x.prevPosition.values.push(S.x,S.y,S.z),x.prevPosition.values.push(S.x,S.y,S.z),x.prevPosition.values.push(S.x,S.y,S.z),x.prevPosition.values.push(S.x,S.y,S.z),x.nextPosition.values.push(y.x,y.y,y.z,y.x,y.y,y.z),x.nextPosition.values.push(c[3*v],c[3*v+1],c[3*v+2]),x.nextPosition.values.push(c[3*v+3],c[3*v+4],c[3*v+5]);var A=Rt.fromArray(l,2*g,Gh),P=Math.abs(A.y);w.expandAndWidth.values.push(-1,P,1,P),w.expandAndWidth.values.push(-1,-P,1,-P),x.expandAndWidth.values.push(-1,P,1,P),x.expandAndWidth.values.push(-1,-P,1,-P);var D=z.magnitudeSquared(z.subtract(T,b,Xh));if(D/=z.magnitudeSquared(z.subtract(y,b,Xh)),Object(u.a)(d)){var j=Te.fromArray(d,4*g,Jh),M=Te.fromArray(d,4*v,Jh),R=I.lerp(j.x,M.x,D),L=I.lerp(j.y,M.y,D),N=I.lerp(j.z,M.z,D),F=I.lerp(j.w,M.w,D);for(i=4*g;i<4*g+8;++i)w.color.values.push(d[i]);for(w.color.values.push(R,L,N,F),w.color.values.push(R,L,N,F),x.color.values.push(R,L,N,F),x.color.values.push(R,L,N,F),i=4*v;i<4*v+8;++i)x.color.values.push(d[i])}if(Object(u.a)(h)){var k=Rt.fromArray(h,2*g,Gh),B=Rt.fromArray(h,2*(t+3),qh),U=I.lerp(k.x,B.x,D);for(i=2*g;i<2*g+4;++i)w.st.values.push(h[i]);for(w.st.values.push(U,k.y),w.st.values.push(U,B.y),x.st.values.push(U,k.y),x.st.values.push(U,B.y),i=2*v;i<2*v+4;++i)x.st.values.push(h[i])}n=w.position.values.length/3-4,O.push(n,n+2,n+1),O.push(n+1,n+2,n+3),n=x.position.values.length/3-4,E.push(n,n+2,n+1),E.push(n+1,n+2,n+3)}else{var V,H;for(b.y<0?(V=p.attributes,H=p.indices):(V=f.attributes,H=f.indices),V.position.values.push(b.x,b.y,b.z),V.position.values.push(b.x,b.y,b.z),V.position.values.push(y.x,y.y,y.z),V.position.values.push(y.x,y.y,y.z),i=3*t;i<3*t+12;++i)V.prevPosition.values.push(s[i]),V.nextPosition.values.push(c[i]);for(i=2*t;i<2*t+8;++i)V.expandAndWidth.values.push(l[i]),Object(u.a)(h)&&V.st.values.push(h[i]);if(Object(u.a)(d))for(i=4*t;i<4*t+16;++i)V.color.values.push(d[i]);n=V.position.values.length/3-4,H.push(n,n+2,n+1),H.push(n+1,n+2,n+3)}}m&&($h(p),$h(f)),Eh(e,p,f)}(e);break;case pn.TRIANGLES:kh(e);break;case pn.LINES:Hh(e)}else dh(t),t.primitiveType===yn.TRIANGLES?kh(e):t.primitiveType===yn.LINES&&Hh(e);return e};var id=zu,nd=new z,rd=new z,ad=new z,od=new z,sd=new Rt,cd=new be,ld=new be,ud=new Kn,hd=new z,dd=new z,fd=new z,pd=new K,md=new z,_d=new Rt,gd=new Rt;function vd(e,t,i){var n=t.vertexFormat,r=t.center,a=t.semiMajorAxis,o=t.semiMinorAxis,s=t.ellipsoid,c=t.stRotation,l=i?e.length/3*2:e.length/3,h=t.shadowVolume,d=n.st?new Float32Array(2*l):void 0,f=n.normal?new Float32Array(3*l):void 0,p=n.tangent?new Float32Array(3*l):void 0,m=n.bitangent?new Float32Array(3*l):void 0,_=h?new Float32Array(3*l):void 0,g=0,v=hd,b=dd,y=fd,w=new se(s),O=w.project(s.cartesianToCartographic(r,pd),md),x=s.scaleToGeodeticSurface(r,nd);s.geodeticSurfaceNormal(x,x);var E=cd,T=ld;if(0!==c){var C=Kn.fromAxisAngle(x,c,ud);E=be.fromQuaternion(C,E),C=Kn.fromAxisAngle(x,-c,ud),T=be.fromQuaternion(C,T)}else E=be.clone(be.IDENTITY,E),T=be.clone(be.IDENTITY,T);for(var S=Rt.fromElements(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,_d),A=Rt.fromElements(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,gd),P=e.length,I=i?P:0,D=I/3*2,j=0;j<P;j+=3){var M=j+1,R=j+2,L=z.fromArray(e,j,nd);if(n.st){var N=be.multiplyByVector(E,L,rd),F=w.project(s.cartesianToCartographic(N,pd),ad);z.subtract(F,O,F),sd.x=(F.x+a)/(2*a),sd.y=(F.y+o)/(2*o),S.x=Math.min(sd.x,S.x),S.y=Math.min(sd.y,S.y),A.x=Math.max(sd.x,A.x),A.y=Math.max(sd.y,A.y),i&&(d[g+D]=sd.x,d[g+1+D]=sd.y),d[g++]=sd.x,d[g++]=sd.y}(n.normal||n.tangent||n.bitangent||h)&&(v=s.geodeticSurfaceNormal(L,v),h&&(_[j+I]=-v.x,_[M+I]=-v.y,_[R+I]=-v.z),(n.normal||n.tangent||n.bitangent)&&((n.tangent||n.bitangent)&&(b=z.normalize(z.cross(z.UNIT_Z,v,b),b),be.multiplyByVector(T,b,b)),n.normal&&(f[j]=v.x,f[M]=v.y,f[R]=v.z,i&&(f[j+I]=-v.x,f[M+I]=-v.y,f[R+I]=-v.z)),n.tangent&&(p[j]=b.x,p[M]=b.y,p[R]=b.z,i&&(p[j+I]=-b.x,p[M+I]=-b.y,p[R+I]=-b.z)),n.bitangent&&(y=z.normalize(z.cross(v,b,y),y),m[j]=y.x,m[M]=y.y,m[R]=y.z,i&&(m[j+I]=y.x,m[M+I]=y.y,m[R+I]=y.z))))}if(n.st){P=d.length;for(var k=0;k<P;k+=2)d[k]=(d[k]-S.x)/(A.x-S.x),d[k+1]=(d[k+1]-S.y)/(A.y-S.y)}var B=new Fa;if(n.position){var U=ju.raisePositionsToHeight(e,t,i);B.position=new Na({componentDatatype:dn.DOUBLE,componentsPerAttribute:3,values:U})}if(n.st&&(B.st=new Na({componentDatatype:dn.FLOAT,componentsPerAttribute:2,values:d})),n.normal&&(B.normal=new Na({componentDatatype:dn.FLOAT,componentsPerAttribute:3,values:f})),n.tangent&&(B.tangent=new Na({componentDatatype:dn.FLOAT,componentsPerAttribute:3,values:p})),n.bitangent&&(B.bitangent=new Na({componentDatatype:dn.FLOAT,componentsPerAttribute:3,values:m})),h&&(B.extrudeDirection=new Na({componentDatatype:dn.FLOAT,componentsPerAttribute:3,values:_})),i&&Object(u.a)(t.offsetAttribute)){var V=new Uint8Array(l);if(t.offsetAttribute===fn.TOP)V=Qt(V,1,0,l/2);else{var H=t.offsetAttribute===fn.NONE?0:1;V=Qt(V,H)}B.applyOffset=new Na({componentDatatype:dn.UNSIGNED_BYTE,componentsPerAttribute:1,values:V})}return B}function bd(e){var t,i,n,r,a,o=new Array(e*(e+1)*12-6),s=0;for(t=0,n=1,r=0;r<3;r++)o[s++]=n++,o[s++]=t,o[s++]=n;for(r=2;r<e+1;++r){for(n=r*(r+1)-1,t=(r-1)*r-1,o[s++]=n++,o[s++]=t,o[s++]=n,i=2*r,a=0;a<i-1;++a)o[s++]=n,o[s++]=t++,o[s++]=t,o[s++]=n++,o[s++]=t,o[s++]=n;o[s++]=n++,o[s++]=t,o[s++]=n}for(i=2*e,++n,++t,r=0;r<i-1;++r)o[s++]=n,o[s++]=t++,o[s++]=t,o[s++]=n++,o[s++]=t,o[s++]=n;for(o[s++]=n,o[s++]=t++,o[s++]=t,o[s++]=n++,o[s++]=t++,o[s++]=t,++t,r=e-1;r>1;--r){for(o[s++]=t++,o[s++]=t,o[s++]=n,i=2*r,a=0;a<i-1;++a)o[s++]=n,o[s++]=t++,o[s++]=t,o[s++]=n++,o[s++]=t,o[s++]=n;o[s++]=t++,o[s++]=t++,o[s++]=n++}for(r=0;r<3;r++)o[s++]=t++,o[s++]=t,o[s++]=n;return o}var yd=new z;var wd=new St,Od=new St;function xd(e){var t=e.center,i=e.ellipsoid,n=e.semiMajorAxis,r=z.multiplyByScalar(i.geodeticSurfaceNormal(t,nd),e.height,nd);wd.center=z.add(t,r,wd.center),wd.radius=n,r=z.multiplyByScalar(i.geodeticSurfaceNormal(t,r),e.extrudedHeight,r),Od.center=z.add(t,r,Od.center),Od.radius=n;var a=ju.computeEllipsePositions(e,!0,!0),o=a.positions,s=a.numPts,c=a.outerPositions,l=St.union(wd,Od),h=vd(o,e,!0),d=bd(s),f=d.length;d.length=2*f;for(var p=o.length/3,m=0;m<f;m+=3)d[m+f]=d[m+2]+p,d[m+1+f]=d[m+1]+p,d[m+2+f]=d[m]+p;var _=Sl.createTypedArray(2*p/3,d),g=new La({attributes:h,indices:_,primitiveType:yn.TRIANGLES}),v=function(e,t){var i=t.vertexFormat,n=t.center,r=t.semiMajorAxis,a=t.semiMinorAxis,o=t.ellipsoid,s=t.height,c=t.extrudedHeight,l=t.stRotation,h=e.length/3*2,d=new Float64Array(3*h),f=i.st?new Float32Array(2*h):void 0,p=i.normal?new Float32Array(3*h):void 0,m=i.tangent?new Float32Array(3*h):void 0,_=i.bitangent?new Float32Array(3*h):void 0,g=t.shadowVolume,v=g?new Float32Array(3*h):void 0,b=0,y=hd,w=dd,O=fd,x=new se(o),E=x.project(o.cartesianToCartographic(n,pd),md),T=o.scaleToGeodeticSurface(n,nd);o.geodeticSurfaceNormal(T,T);for(var C=Kn.fromAxisAngle(T,l,ud),S=be.fromQuaternion(C,cd),A=Rt.fromElements(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,_d),P=Rt.fromElements(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,gd),I=e.length,D=I/3*2,j=0;j<I;j+=3){var M,R=j+1,L=j+2,N=z.fromArray(e,j,nd);if(i.st){var F=be.multiplyByVector(S,N,rd),k=x.project(o.cartesianToCartographic(F,pd),ad);z.subtract(k,E,k),sd.x=(k.x+r)/(2*r),sd.y=(k.y+a)/(2*a),A.x=Math.min(sd.x,A.x),A.y=Math.min(sd.y,A.y),P.x=Math.max(sd.x,P.x),P.y=Math.max(sd.y,P.y),f[b+D]=sd.x,f[b+1+D]=sd.y,f[b++]=sd.x,f[b++]=sd.y}N=o.scaleToGeodeticSurface(N,N),M=z.clone(N,rd),y=o.geodeticSurfaceNormal(N,y),g&&(v[j+I]=-y.x,v[R+I]=-y.y,v[L+I]=-y.z);var B=z.multiplyByScalar(y,s,od);if(N=z.add(N,B,N),B=z.multiplyByScalar(y,c,B),M=z.add(M,B,M),i.position&&(d[j+I]=M.x,d[R+I]=M.y,d[L+I]=M.z,d[j]=N.x,d[R]=N.y,d[L]=N.z),i.normal||i.tangent||i.bitangent){O=z.clone(y,O);var U=z.fromArray(e,(j+3)%I,od);z.subtract(U,N,U);var V=z.subtract(M,N,ad);y=z.normalize(z.cross(V,U,y),y),i.normal&&(p[j]=y.x,p[R]=y.y,p[L]=y.z,p[j+I]=y.x,p[R+I]=y.y,p[L+I]=y.z),i.tangent&&(w=z.normalize(z.cross(O,y,w),w),m[j]=w.x,m[R]=w.y,m[L]=w.z,m[j+I]=w.x,m[j+1+I]=w.y,m[j+2+I]=w.z),i.bitangent&&(_[j]=O.x,_[R]=O.y,_[L]=O.z,_[j+I]=O.x,_[R+I]=O.y,_[L+I]=O.z)}}if(i.st){I=f.length;for(var H=0;H<I;H+=2)f[H]=(f[H]-A.x)/(P.x-A.x),f[H+1]=(f[H+1]-A.y)/(P.y-A.y)}var G=new Fa;if(i.position&&(G.position=new Na({componentDatatype:dn.DOUBLE,componentsPerAttribute:3,values:d})),i.st&&(G.st=new Na({componentDatatype:dn.FLOAT,componentsPerAttribute:2,values:f})),i.normal&&(G.normal=new Na({componentDatatype:dn.FLOAT,componentsPerAttribute:3,values:p})),i.tangent&&(G.tangent=new Na({componentDatatype:dn.FLOAT,componentsPerAttribute:3,values:m})),i.bitangent&&(G.bitangent=new Na({componentDatatype:dn.FLOAT,componentsPerAttribute:3,values:_})),g&&(G.extrudeDirection=new Na({componentDatatype:dn.FLOAT,componentsPerAttribute:3,values:v})),Object(u.a)(t.offsetAttribute)){var q=new Uint8Array(h);if(t.offsetAttribute===fn.TOP)q=Qt(q,1,0,h/2);else{var W=t.offsetAttribute===fn.NONE?0:1;q=Qt(q,W)}G.applyOffset=new Na({componentDatatype:dn.UNSIGNED_BYTE,componentsPerAttribute:1,values:q})}return G}(c,e);d=function(e){for(var t=e.length/3,i=Sl.createTypedArray(t,6*t),n=0,r=0;r<t;r++){var a=r,o=r+t,s=(a+1)%t,c=s+t;i[n++]=a,i[n++]=o,i[n++]=s,i[n++]=s,i[n++]=o,i[n++]=c}return i}(c);var b=Sl.createTypedArray(2*c.length/3,d),y=new La({attributes:v,indices:b,primitiveType:yn.TRIANGLES}),w=id.combineInstances([new Mu({geometry:g}),new Mu({geometry:y})]);return{boundingSphere:l,attributes:w[0].attributes,indices:w[0].indices}}function Ed(e,t,i,n,r,a,o){for(var s=ju.computeEllipsePositions({center:e,semiMajorAxis:t,semiMinorAxis:i,rotation:n,granularity:r},!1,!0).outerPositions,c=s.length/3,l=new Array(c),u=0;u<c;++u)l[u]=z.fromArray(s,3*u);var h=Ve.fromCartesianArray(l,a,o);return h.width>I.PI&&(h.north=h.north>0?I.PI_OVER_TWO-I.EPSILON7:h.north,h.south=h.south<0?I.EPSILON7-I.PI_OVER_TWO:h.south,h.east=I.PI,h.west=-I.PI),h}function Td(e){var t=(e=Object(w.a)(e,w.a.EMPTY_OBJECT)).center,i=Object(w.a)(e.ellipsoid,ae.WGS84),n=e.semiMajorAxis,r=e.semiMinorAxis,a=Object(w.a)(e.granularity,I.RADIANS_PER_DEGREE),o=Object(w.a)(e.vertexFormat,Ba.DEFAULT);if(x.a.defined("options.center",t),x.a.typeOf.number("options.semiMajorAxis",n),x.a.typeOf.number("options.semiMinorAxis",r),n<r)throw new h.a("semiMajorAxis must be greater than or equal to the semiMinorAxis.");if(a<=0)throw new h.a("granularity must be greater than zero.");var s=Object(w.a)(e.height,0),c=Object(w.a)(e.extrudedHeight,s);this._center=z.clone(t),this._semiMajorAxis=n,this._semiMinorAxis=r,this._ellipsoid=ae.clone(i),this._rotation=Object(w.a)(e.rotation,0),this._stRotation=Object(w.a)(e.stRotation,0),this._height=Math.max(c,s),this._granularity=a,this._vertexFormat=Ba.clone(o),this._extrudedHeight=Math.min(c,s),this._shadowVolume=Object(w.a)(e.shadowVolume,!1),this._workerName="createEllipseGeometry",this._offsetAttribute=e.offsetAttribute,this._rectangle=void 0,this._textureCoordinateRotationPoints=void 0}Td.packedLength=z.packedLength+ae.packedLength+Ba.packedLength+9,Td.pack=function(e,t,i){return x.a.defined("value",e),x.a.defined("array",t),i=Object(w.a)(i,0),z.pack(e._center,t,i),i+=z.packedLength,ae.pack(e._ellipsoid,t,i),i+=ae.packedLength,Ba.pack(e._vertexFormat,t,i),i+=Ba.packedLength,t[i++]=e._semiMajorAxis,t[i++]=e._semiMinorAxis,t[i++]=e._rotation,t[i++]=e._stRotation,t[i++]=e._height,t[i++]=e._granularity,t[i++]=e._extrudedHeight,t[i++]=e._shadowVolume?1:0,t[i]=Object(w.a)(e._offsetAttribute,-1),t};var Cd=new z,Sd=new ae,Ad=new Ba,Pd={center:Cd,ellipsoid:Sd,vertexFormat:Ad,semiMajorAxis:void 0,semiMinorAxis:void 0,rotation:void 0,stRotation:void 0,height:void 0,granularity:void 0,extrudedHeight:void 0,shadowVolume:void 0,offsetAttribute:void 0};Td.unpack=function(e,t,i){x.a.defined("array",e),t=Object(w.a)(t,0);var n=z.unpack(e,t,Cd);t+=z.packedLength;var r=ae.unpack(e,t,Sd);t+=ae.packedLength;var a=Ba.unpack(e,t,Ad);t+=Ba.packedLength;var o=e[t++],s=e[t++],c=e[t++],l=e[t++],h=e[t++],d=e[t++],f=e[t++],p=1===e[t++],m=e[t];return Object(u.a)(i)?(i._center=z.clone(n,i._center),i._ellipsoid=ae.clone(r,i._ellipsoid),i._vertexFormat=Ba.clone(a,i._vertexFormat),i._semiMajorAxis=o,i._semiMinorAxis=s,i._rotation=c,i._stRotation=l,i._height=h,i._granularity=d,i._extrudedHeight=f,i._shadowVolume=p,i._offsetAttribute=-1===m?void 0:m,i):(Pd.height=h,Pd.extrudedHeight=f,Pd.granularity=d,Pd.stRotation=l,Pd.rotation=c,Pd.semiMajorAxis=o,Pd.semiMinorAxis=s,Pd.shadowVolume=p,Pd.offsetAttribute=-1===m?void 0:m,new Td(Pd))},Td.computeRectangle=function(e,t){var i=(e=Object(w.a)(e,w.a.EMPTY_OBJECT)).center,n=Object(w.a)(e.ellipsoid,ae.WGS84),r=e.semiMajorAxis,a=e.semiMinorAxis,o=Object(w.a)(e.granularity,I.RADIANS_PER_DEGREE),s=Object(w.a)(e.rotation,0);if(x.a.defined("options.center",i),x.a.typeOf.number("options.semiMajorAxis",r),x.a.typeOf.number("options.semiMinorAxis",a),r<a)throw new h.a("semiMajorAxis must be greater than or equal to the semiMinorAxis.");if(o<=0)throw new h.a("granularity must be greater than zero.");return Ed(i,r,a,s,o,n,t)},Td.createGeometry=function(e){if(!(e._semiMajorAxis<=0||e._semiMinorAxis<=0)){var t=e._height,i=e._extrudedHeight,n=!I.equalsEpsilon(t,i,0,I.EPSILON2);e._center=e._ellipsoid.scaleToGeodeticSurface(e._center,e._center);var r,a={center:e._center,semiMajorAxis:e._semiMajorAxis,semiMinorAxis:e._semiMinorAxis,ellipsoid:e._ellipsoid,rotation:e._rotation,height:t,granularity:e._granularity,vertexFormat:e._vertexFormat,stRotation:e._stRotation};if(n)a.extrudedHeight=i,a.shadowVolume=e._shadowVolume,a.offsetAttribute=e._offsetAttribute,r=xd(a);else if(r=function(e){var t=e.center;yd=z.multiplyByScalar(e.ellipsoid.geodeticSurfaceNormal(t,yd),e.height,yd),yd=z.add(t,yd,yd);var i=new St(yd,e.semiMajorAxis),n=ju.computeEllipsePositions(e,!0,!1),r=n.positions,a=n.numPts,o=vd(r,e,!1),s=bd(a);return{boundingSphere:i,attributes:o,indices:s=Sl.createTypedArray(r.length/3,s)}}(a),Object(u.a)(e._offsetAttribute)){var o=r.attributes.position.values.length,s=new Uint8Array(o/3),c=e._offsetAttribute===fn.NONE?0:1;Qt(s,c),r.attributes.applyOffset=new Na({componentDatatype:dn.UNSIGNED_BYTE,componentsPerAttribute:1,values:s})}return new La({attributes:r.attributes,indices:r.indices,primitiveType:yn.TRIANGLES,boundingSphere:r.boundingSphere,offsetAttribute:e._offsetAttribute})}},Td.createShadowVolume=function(e,t,i){var n=e._granularity,r=e._ellipsoid,a=t(n,r),o=i(n,r);return new Td({center:e._center,semiMajorAxis:e._semiMajorAxis,semiMinorAxis:e._semiMinorAxis,ellipsoid:r,rotation:e._rotation,stRotation:e._stRotation,granularity:n,extrudedHeight:a,height:o,vertexFormat:Ba.POSITION_ONLY,shadowVolume:!0})},Object(O.a)(Td.prototype,{rectangle:{get:function(){return Object(u.a)(this._rectangle)||(this._rectangle=Ed(this._center,this._semiMajorAxis,this._semiMinorAxis,this._rotation,this._granularity,this._ellipsoid)),this._rectangle}},textureCoordinateRotationPoints:{get:function(){return Object(u.a)(this._textureCoordinateRotationPoints)||(this._textureCoordinateRotationPoints=function(e){var t=-e._stRotation;if(0===t)return[0,0,0,1,1,0];for(var i=ju.computeEllipsePositions({center:e._center,semiMajorAxis:e._semiMajorAxis,semiMinorAxis:e._semiMinorAxis,rotation:e._rotation,granularity:e._granularity},!1,!0).outerPositions,n=i.length/3,r=new Array(n),a=0;a<n;++a)r[a]=z.fromArray(i,3*a);var o=e._ellipsoid,s=e.rectangle;return La._textureCoordinateRotationPoints(r,t,o,s)}(this)),this._textureCoordinateRotationPoints}}});var Id=Td;function Dd(e){var t=(e=Object(w.a)(e,w.a.EMPTY_OBJECT)).radius;x.a.typeOf.number("radius",t);var i={center:e.center,semiMajorAxis:t,semiMinorAxis:t,ellipsoid:e.ellipsoid,height:e.height,extrudedHeight:e.extrudedHeight,granularity:e.granularity,vertexFormat:e.vertexFormat,stRotation:e.stRotation,shadowVolume:e.shadowVolume};this._ellipseGeometry=new Id(i),this._workerName="createCircleGeometry"}Dd.packedLength=Id.packedLength,Dd.pack=function(e,t,i){return x.a.typeOf.object("value",e),Id.pack(e._ellipseGeometry,t,i)};var jd=new Id({center:new z,semiMajorAxis:1,semiMinorAxis:1}),Md={center:new z,radius:void 0,ellipsoid:ae.clone(ae.UNIT_SPHERE),height:void 0,extrudedHeight:void 0,granularity:void 0,vertexFormat:new Ba,stRotation:void 0,semiMajorAxis:void 0,semiMinorAxis:void 0,shadowVolume:void 0};Dd.unpack=function(e,t,i){var n=Id.unpack(e,t,jd);return Md.center=z.clone(n._center,Md.center),Md.ellipsoid=ae.clone(n._ellipsoid,Md.ellipsoid),Md.height=n._height,Md.extrudedHeight=n._extrudedHeight,Md.granularity=n._granularity,Md.vertexFormat=Ba.clone(n._vertexFormat,Md.vertexFormat),Md.stRotation=n._stRotation,Md.shadowVolume=n._shadowVolume,Object(u.a)(i)?(Md.semiMajorAxis=n._semiMajorAxis,Md.semiMinorAxis=n._semiMinorAxis,i._ellipseGeometry=new Id(Md),i):(Md.radius=n._semiMajorAxis,new Dd(Md))},Dd.createGeometry=function(e){return Id.createGeometry(e._ellipseGeometry)},Dd.createShadowVolume=function(e,t,i){var n=e._ellipseGeometry._granularity,r=e._ellipseGeometry._ellipsoid,a=t(n,r),o=i(n,r);return new Dd({center:e._ellipseGeometry._center,radius:e._ellipseGeometry._semiMajorAxis,ellipsoid:r,stRotation:e._ellipseGeometry._stRotation,granularity:n,extrudedHeight:a,height:o,vertexFormat:Ba.POSITION_ONLY,shadowVolume:!0})},Object(O.a)(Dd.prototype,{rectangle:{get:function(){return this._ellipseGeometry.rectangle}},textureCoordinateRotationPoints:{get:function(){return this._ellipseGeometry.textureCoordinateRotationPoints}}});var Rd=Dd,Ld=new z,Nd=new z;var Fd=new St,kd=new St;function Bd(e){var t=(e=Object(w.a)(e,w.a.EMPTY_OBJECT)).center,i=Object(w.a)(e.ellipsoid,ae.WGS84),n=e.semiMajorAxis,r=e.semiMinorAxis,a=Object(w.a)(e.granularity,I.RADIANS_PER_DEGREE);if(!Object(u.a)(t))throw new h.a("center is required.");if(!Object(u.a)(n))throw new h.a("semiMajorAxis is required.");if(!Object(u.a)(r))throw new h.a("semiMinorAxis is required.");if(n<r)throw new h.a("semiMajorAxis must be greater than or equal to the semiMinorAxis.");if(a<=0)throw new h.a("granularity must be greater than zero.");var o=Object(w.a)(e.height,0),s=Object(w.a)(e.extrudedHeight,o);this._center=z.clone(t),this._semiMajorAxis=n,this._semiMinorAxis=r,this._ellipsoid=ae.clone(i),this._rotation=Object(w.a)(e.rotation,0),this._height=Math.max(s,o),this._granularity=a,this._extrudedHeight=Math.min(s,o),this._numberOfVerticalLines=Math.max(Object(w.a)(e.numberOfVerticalLines,16),0),this._offsetAttribute=e.offsetAttribute,this._workerName="createEllipseOutlineGeometry"}Bd.packedLength=z.packedLength+ae.packedLength+8,Bd.pack=function(e,t,i){if(!Object(u.a)(e))throw new h.a("value is required");if(!Object(u.a)(t))throw new h.a("array is required");return i=Object(w.a)(i,0),z.pack(e._center,t,i),i+=z.packedLength,ae.pack(e._ellipsoid,t,i),i+=ae.packedLength,t[i++]=e._semiMajorAxis,t[i++]=e._semiMinorAxis,t[i++]=e._rotation,t[i++]=e._height,t[i++]=e._granularity,t[i++]=e._extrudedHeight,t[i++]=e._numberOfVerticalLines,t[i]=Object(w.a)(e._offsetAttribute,-1),t};var zd=new z,Ud=new ae,Vd={center:zd,ellipsoid:Ud,semiMajorAxis:void 0,semiMinorAxis:void 0,rotation:void 0,height:void 0,granularity:void 0,extrudedHeight:void 0,numberOfVerticalLines:void 0,offsetAttribute:void 0};Bd.unpack=function(e,t,i){if(!Object(u.a)(e))throw new h.a("array is required");t=Object(w.a)(t,0);var n=z.unpack(e,t,zd);t+=z.packedLength;var r=ae.unpack(e,t,Ud);t+=ae.packedLength;var a=e[t++],o=e[t++],s=e[t++],c=e[t++],l=e[t++],d=e[t++],f=e[t++],p=e[t];return Object(u.a)(i)?(i._center=z.clone(n,i._center),i._ellipsoid=ae.clone(r,i._ellipsoid),i._semiMajorAxis=a,i._semiMinorAxis=o,i._rotation=s,i._height=c,i._granularity=l,i._extrudedHeight=d,i._numberOfVerticalLines=f,i._offsetAttribute=-1===p?void 0:p,i):(Vd.height=c,Vd.extrudedHeight=d,Vd.granularity=l,Vd.rotation=s,Vd.semiMajorAxis=a,Vd.semiMinorAxis=o,Vd.numberOfVerticalLines=f,Vd.offsetAttribute=-1===p?void 0:p,new Bd(Vd))},Bd.createGeometry=function(e){if(!(e._semiMajorAxis<=0||e._semiMinorAxis<=0)){var t=e._height,i=e._extrudedHeight,n=!I.equalsEpsilon(t,i,0,I.EPSILON2);e._center=e._ellipsoid.scaleToGeodeticSurface(e._center,e._center);var r,a={center:e._center,semiMajorAxis:e._semiMajorAxis,semiMinorAxis:e._semiMinorAxis,ellipsoid:e._ellipsoid,rotation:e._rotation,height:t,granularity:e._granularity,numberOfVerticalLines:e._numberOfVerticalLines};if(n)a.extrudedHeight=i,a.offsetAttribute=e._offsetAttribute,r=function(e){var t=e.center,i=e.ellipsoid,n=e.semiMajorAxis,r=z.multiplyByScalar(i.geodeticSurfaceNormal(t,Ld),e.height,Ld);Fd.center=z.add(t,r,Fd.center),Fd.radius=n,r=z.multiplyByScalar(i.geodeticSurfaceNormal(t,r),e.extrudedHeight,r),kd.center=z.add(t,r,kd.center),kd.radius=n;var a=ju.computeEllipsePositions(e,!1,!0).outerPositions,o=new Fa({position:new Na({componentDatatype:dn.DOUBLE,componentsPerAttribute:3,values:ju.raisePositionsToHeight(a,e,!0)})});a=o.position.values;var s=St.union(Fd,kd),c=a.length/3;if(Object(u.a)(e.offsetAttribute)){var l=new Uint8Array(c);if(e.offsetAttribute===fn.TOP)l=Qt(l,1,0,c/2);else{var h=e.offsetAttribute===fn.NONE?0:1;l=Qt(l,h)}o.applyOffset=new Na({componentDatatype:dn.UNSIGNED_BYTE,componentsPerAttribute:1,values:l})}var d=Object(w.a)(e.numberOfVerticalLines,16);d=I.clamp(d,0,c/2);var f=Sl.createTypedArray(c,2*c+2*d);c/=2;var p,m,_=0;for(p=0;p<c;++p)f[_++]=p,f[_++]=(p+1)%c,f[_++]=p+c,f[_++]=(p+1)%c+c;if(d>0){var g=Math.min(d,c);m=Math.round(c/g);var v=Math.min(m*d,c);for(p=0;p<v;p+=m)f[_++]=p,f[_++]=p+c}return{boundingSphere:s,attributes:o,indices:f}}(a);else if(r=function(e){var t=e.center;Nd=z.multiplyByScalar(e.ellipsoid.geodeticSurfaceNormal(t,Nd),e.height,Nd),Nd=z.add(t,Nd,Nd);for(var i=new St(Nd,e.semiMajorAxis),n=ju.computeEllipsePositions(e,!1,!0).outerPositions,r=new Fa({position:new Na({componentDatatype:dn.DOUBLE,componentsPerAttribute:3,values:ju.raisePositionsToHeight(n,e,!1)})}),a=n.length/3,o=Sl.createTypedArray(a,2*a),s=0,c=0;c<a;++c)o[s++]=c,o[s++]=(c+1)%a;return{boundingSphere:i,attributes:r,indices:o}}(a),Object(u.a)(e._offsetAttribute)){var o=r.attributes.position.values.length,s=new Uint8Array(o/3),c=e._offsetAttribute===fn.NONE?0:1;Qt(s,c),r.attributes.applyOffset=new Na({componentDatatype:dn.UNSIGNED_BYTE,componentsPerAttribute:1,values:s})}return new La({attributes:r.attributes,indices:r.indices,primitiveType:yn.LINES,boundingSphere:r.boundingSphere,offsetAttribute:e._offsetAttribute})}};var Hd=Bd;function Gd(e){var t=(e=Object(w.a)(e,w.a.EMPTY_OBJECT)).radius;x.a.typeOf.number("radius",t);var i={center:e.center,semiMajorAxis:t,semiMinorAxis:t,ellipsoid:e.ellipsoid,height:e.height,extrudedHeight:e.extrudedHeight,granularity:e.granularity,numberOfVerticalLines:e.numberOfVerticalLines};this._ellipseGeometry=new Hd(i),this._workerName="createCircleOutlineGeometry"}Gd.packedLength=Hd.packedLength,Gd.pack=function(e,t,i){return x.a.typeOf.object("value",e),Hd.pack(e._ellipseGeometry,t,i)};var qd=new Hd({center:new z,semiMajorAxis:1,semiMinorAxis:1}),Wd={center:new z,radius:void 0,ellipsoid:ae.clone(ae.UNIT_SPHERE),height:void 0,extrudedHeight:void 0,granularity:void 0,numberOfVerticalLines:void 0,semiMajorAxis:void 0,semiMinorAxis:void 0};Gd.unpack=function(e,t,i){var n=Hd.unpack(e,t,qd);return Wd.center=z.clone(n._center,Wd.center),Wd.ellipsoid=ae.clone(n._ellipsoid,Wd.ellipsoid),Wd.height=n._height,Wd.extrudedHeight=n._extrudedHeight,Wd.granularity=n._granularity,Wd.numberOfVerticalLines=n._numberOfVerticalLines,Object(u.a)(i)?(Wd.semiMajorAxis=n._semiMajorAxis,Wd.semiMinorAxis=n._semiMinorAxis,i._ellipseGeometry=new Hd(Wd),i):(Wd.radius=n._semiMajorAxis,new Gd(Wd))},Gd.createGeometry=function(e){return Hd.createGeometry(e._ellipseGeometry)};var Yd=Gd,Xd=Object(E.a)({UNBOUNDED:0,CLAMPED:1,LOOP_STOP:2}),Zd=Object(E.a)({TICK_DEPENDENT:0,SYSTEM_CLOCK_MULTIPLIER:1,SYSTEM_CLOCK:2}),Qd="undefined"!=typeof performance&&"function"==typeof performance.now&&isFinite(performance.now())?function(){return performance.now()}:function(){return Date.now()};function Kd(e){var t=(e=Object(w.a)(e,w.a.EMPTY_OBJECT)).currentTime,i=e.startTime,n=e.stopTime;if(t=Object(u.a)(t)?Tr.clone(t):Object(u.a)(i)?Tr.clone(i):Object(u.a)(n)?Tr.addDays(n,-1,new Tr):Tr.now(),i=Object(u.a)(i)?Tr.clone(i):Tr.clone(t),n=Object(u.a)(n)?Tr.clone(n):Tr.addDays(i,1,new Tr),Tr.greaterThan(i,n))throw new h.a("startTime must come before stopTime.");this.startTime=i,this.stopTime=n,this.clockRange=Object(w.a)(e.clockRange,Xd.UNBOUNDED),this.canAnimate=Object(w.a)(e.canAnimate,!0),this.onTick=new $o.a,this.onStop=new $o.a,this._currentTime=void 0,this._multiplier=void 0,this._clockStep=void 0,this._shouldAnimate=void 0,this._lastSystemTime=Qd(),this.currentTime=t,this.multiplier=Object(w.a)(e.multiplier,1),this.shouldAnimate=Object(w.a)(e.shouldAnimate,!1),this.clockStep=Object(w.a)(e.clockStep,Zd.SYSTEM_CLOCK_MULTIPLIER)}Object(O.a)(Kd.prototype,{currentTime:{get:function(){return this._currentTime},set:function(e){Tr.equals(this._currentTime,e)||(this._clockStep===Zd.SYSTEM_CLOCK&&(this._clockStep=Zd.SYSTEM_CLOCK_MULTIPLIER),this._currentTime=e)}},multiplier:{get:function(){return this._multiplier},set:function(e){this._multiplier!==e&&(this._clockStep===Zd.SYSTEM_CLOCK&&(this._clockStep=Zd.SYSTEM_CLOCK_MULTIPLIER),this._multiplier=e)}},clockStep:{get:function(){return this._clockStep},set:function(e){e===Zd.SYSTEM_CLOCK&&(this._multiplier=1,this._shouldAnimate=!0,this._currentTime=Tr.now()),this._clockStep=e}},shouldAnimate:{get:function(){return this._shouldAnimate},set:function(e){this._shouldAnimate!==e&&(this._clockStep===Zd.SYSTEM_CLOCK&&(this._clockStep=Zd.SYSTEM_CLOCK_MULTIPLIER),this._shouldAnimate=e)}}}),Kd.prototype.tick=function(){var e=Qd(),t=Tr.clone(this._currentTime);if(this.canAnimate&&this._shouldAnimate){var i=this._clockStep;if(i===Zd.SYSTEM_CLOCK)t=Tr.now(t);else{var n=this._multiplier;if(i===Zd.TICK_DEPENDENT)t=Tr.addSeconds(t,n,t);else{var r=e-this._lastSystemTime;t=Tr.addSeconds(t,n*(r/1e3),t)}var a=this.clockRange,o=this.startTime,s=this.stopTime;if(a===Xd.CLAMPED)Tr.lessThan(t,o)?t=Tr.clone(o,t):Tr.greaterThan(t,s)&&(t=Tr.clone(s,t),this.onStop.raiseEvent(this));else if(a===Xd.LOOP_STOP)for(Tr.lessThan(t,o)&&(t=Tr.clone(o,t));Tr.greaterThan(t,s);)t=Tr.addSeconds(o,Tr.secondsDifference(t,s),t),this.onStop.raiseEvent(this)}}return this._currentTime=t,this._lastSystemTime=e,this.onTick.raiseEvent(this),t};var Jd,$d,ef,tf=Kd,nf=n(11);function rf(e,t,i){return i<0&&(i+=1),i>1&&(i-=1),6*i<1?e+6*(t-e)*i:2*i<1?t:3*i<2?e+(t-e)*(2/3-i)*6:e}function af(e,t,i,n){this.red=Object(w.a)(e,1),this.green=Object(w.a)(t,1),this.blue=Object(w.a)(i,1),this.alpha=Object(w.a)(n,1)}af.fromCartesian4=function(e,t){return x.a.typeOf.object("cartesian",e),Object(u.a)(t)?(t.red=e.x,t.green=e.y,t.blue=e.z,t.alpha=e.w,t):new af(e.x,e.y,e.z,e.w)},af.fromBytes=function(e,t,i,n,r){return e=af.byteToFloat(Object(w.a)(e,255)),t=af.byteToFloat(Object(w.a)(t,255)),i=af.byteToFloat(Object(w.a)(i,255)),n=af.byteToFloat(Object(w.a)(n,255)),Object(u.a)(r)?(r.red=e,r.green=t,r.blue=i,r.alpha=n,r):new af(e,t,i,n)},af.fromAlpha=function(e,t,i){return x.a.typeOf.object("color",e),x.a.typeOf.number("alpha",t),Object(u.a)(i)?(i.red=e.red,i.green=e.green,i.blue=e.blue,i.alpha=t,i):new af(e.red,e.green,e.blue,t)},Ri.supportsTypedArrays()&&(Jd=new ArrayBuffer(4),$d=new Uint32Array(Jd),ef=new Uint8Array(Jd)),af.fromRgba=function(e,t){return $d[0]=e,af.fromBytes(ef[0],ef[1],ef[2],ef[3],t)},af.fromHsl=function(e,t,i,n,r){e=Object(w.a)(e,0)%1,t=Object(w.a)(t,0),i=Object(w.a)(i,0),n=Object(w.a)(n,1);var a=i,o=i,s=i;if(0!==t){var c,l=2*i-(c=i<.5?i*(1+t):i+t-i*t);a=rf(l,c,e+1/3),o=rf(l,c,e),s=rf(l,c,e-1/3)}return Object(u.a)(r)?(r.red=a,r.green=o,r.blue=s,r.alpha=n,r):new af(a,o,s,n)},af.fromRandom=function(e,t){var i=(e=Object(w.a)(e,w.a.EMPTY_OBJECT)).red;if(!Object(u.a)(i)){var n=Object(w.a)(e.minimumRed,0),r=Object(w.a)(e.maximumRed,1);x.a.typeOf.number.lessThanOrEquals("minimumRed",n,r),i=n+I.nextRandomNumber()*(r-n)}var a=e.green;if(!Object(u.a)(a)){var o=Object(w.a)(e.minimumGreen,0),s=Object(w.a)(e.maximumGreen,1);x.a.typeOf.number.lessThanOrEquals("minimumGreen",o,s),a=o+I.nextRandomNumber()*(s-o)}var c=e.blue;if(!Object(u.a)(c)){var l=Object(w.a)(e.minimumBlue,0),h=Object(w.a)(e.maximumBlue,1);x.a.typeOf.number.lessThanOrEquals("minimumBlue",l,h),c=l+I.nextRandomNumber()*(h-l)}var d=e.alpha;if(!Object(u.a)(d)){var f=Object(w.a)(e.minimumAlpha,0),p=Object(w.a)(e.maximumAlpha,1);x.a.typeOf.number.lessThanOrEquals("minumumAlpha",f,p),d=f+I.nextRandomNumber()*(p-f)}return Object(u.a)(t)?(t.red=i,t.green=a,t.blue=c,t.alpha=d,t):new af(i,a,c,d)};var of=/^#([0-9a-f])([0-9a-f])([0-9a-f])$/i,sf=/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i,cf=/^rgba?\(\s*([0-9.]+%?)\s*,\s*([0-9.]+%?)\s*,\s*([0-9.]+%?)(?:\s*,\s*([0-9.]+))?\s*\)$/i,lf=/^hsla?\(\s*([0-9.]+)\s*,\s*([0-9.]+%)\s*,\s*([0-9.]+%)(?:\s*,\s*([0-9.]+))?\s*\)$/i;af.fromCssColorString=function(e,t){x.a.typeOf.string("color",e),Object(u.a)(t)||(t=new af);var i=af[e.toUpperCase()];if(Object(u.a)(i))return af.clone(i,t),t;var n=of.exec(e);return null!==n?(t.red=parseInt(n[1],16)/15,t.green=parseInt(n[2],16)/15,t.blue=parseInt(n[3],16)/15,t.alpha=1,t):null!==(n=sf.exec(e))?(t.red=parseInt(n[1],16)/255,t.green=parseInt(n[2],16)/255,t.blue=parseInt(n[3],16)/255,t.alpha=1,t):null!==(n=cf.exec(e))?(t.red=parseFloat(n[1])/("%"===n[1].substr(-1)?100:255),t.green=parseFloat(n[2])/("%"===n[2].substr(-1)?100:255),t.blue=parseFloat(n[3])/("%"===n[3].substr(-1)?100:255),t.alpha=parseFloat(Object(w.a)(n[4],"1.0")),t):null!==(n=lf.exec(e))?af.fromHsl(parseFloat(n[1])/360,parseFloat(n[2])/100,parseFloat(n[3])/100,parseFloat(Object(w.a)(n[4],"1.0")),t):t=void 0},af.packedLength=4,af.pack=function(e,t,i){return x.a.typeOf.object("value",e),x.a.defined("array",t),i=Object(w.a)(i,0),t[i++]=e.red,t[i++]=e.green,t[i++]=e.blue,t[i]=e.alpha,t},af.unpack=function(e,t,i){return x.a.defined("array",e),t=Object(w.a)(t,0),Object(u.a)(i)||(i=new af),i.red=e[t++],i.green=e[t++],i.blue=e[t++],i.alpha=e[t],i},af.byteToFloat=function(e){return e/255},af.floatToByte=function(e){return 1===e?255:256*e|0},af.clone=function(e,t){if(Object(u.a)(e))return Object(u.a)(t)?(t.red=e.red,t.green=e.green,t.blue=e.blue,t.alpha=e.alpha,t):new af(e.red,e.green,e.blue,e.alpha)},af.equals=function(e,t){return e===t||Object(u.a)(e)&&Object(u.a)(t)&&e.red===t.red&&e.green===t.green&&e.blue===t.blue&&e.alpha===t.alpha},af.equalsArray=function(e,t,i){return e.red===t[i]&&e.green===t[i+1]&&e.blue===t[i+2]&&e.alpha===t[i+3]},af.prototype.clone=function(e){return af.clone(this,e)},af.prototype.equals=function(e){return af.equals(this,e)},af.prototype.equalsEpsilon=function(e,t){return this===e||Object(u.a)(e)&&Math.abs(this.red-e.red)<=t&&Math.abs(this.green-e.green)<=t&&Math.abs(this.blue-e.blue)<=t&&Math.abs(this.alpha-e.alpha)<=t},af.prototype.toString=function(){return"("+this.red+", "+this.green+", "+this.blue+", "+this.alpha+")"},af.prototype.toCssColorString=function(){var e=af.floatToByte(this.red),t=af.floatToByte(this.green),i=af.floatToByte(this.blue);return 1===this.alpha?"rgb("+e+","+t+","+i+")":"rgba("+e+","+t+","+i+","+this.alpha+")"},af.prototype.toBytes=function(e){var t=af.floatToByte(this.red),i=af.floatToByte(this.green),n=af.floatToByte(this.blue),r=af.floatToByte(this.alpha);return Object(u.a)(e)?(e[0]=t,e[1]=i,e[2]=n,e[3]=r,e):[t,i,n,r]},af.prototype.toRgba=function(){return ef[0]=af.floatToByte(this.red),ef[1]=af.floatToByte(this.green),ef[2]=af.floatToByte(this.blue),ef[3]=af.floatToByte(this.alpha),$d[0]},af.prototype.brighten=function(e,t){return x.a.typeOf.number("magnitude",e),x.a.typeOf.number.greaterThanOrEquals("magnitude",e,0),x.a.typeOf.object("result",t),e=1-e,t.red=1-(1-this.red)*e,t.green=1-(1-this.green)*e,t.blue=1-(1-this.blue)*e,t.alpha=this.alpha,t},af.prototype.darken=function(e,t){return x.a.typeOf.number("magnitude",e),x.a.typeOf.number.greaterThanOrEquals("magnitude",e,0),x.a.typeOf.object("result",t),e=1-e,t.red=this.red*e,t.green=this.green*e,t.blue=this.blue*e,t.alpha=this.alpha,t},af.prototype.withAlpha=function(e,t){return af.fromAlpha(this,e,t)},af.add=function(e,t,i){return x.a.typeOf.object("left",e),x.a.typeOf.object("right",t),x.a.typeOf.object("result",i),i.red=e.red+t.red,i.green=e.green+t.green,i.blue=e.blue+t.blue,i.alpha=e.alpha+t.alpha,i},af.subtract=function(e,t,i){return x.a.typeOf.object("left",e),x.a.typeOf.object("right",t),x.a.typeOf.object("result",i),i.red=e.red-t.red,i.green=e.green-t.green,i.blue=e.blue-t.blue,i.alpha=e.alpha-t.alpha,i},af.multiply=function(e,t,i){return x.a.typeOf.object("left",e),x.a.typeOf.object("right",t),x.a.typeOf.object("result",i),i.red=e.red*t.red,i.green=e.green*t.green,i.blue=e.blue*t.blue,i.alpha=e.alpha*t.alpha,i},af.divide=function(e,t,i){return x.a.typeOf.object("left",e),x.a.typeOf.object("right",t),x.a.typeOf.object("result",i),i.red=e.red/t.red,i.green=e.green/t.green,i.blue=e.blue/t.blue,i.alpha=e.alpha/t.alpha,i},af.mod=function(e,t,i){return x.a.typeOf.object("left",e),x.a.typeOf.object("right",t),x.a.typeOf.object("result",i),i.red=e.red%t.red,i.green=e.green%t.green,i.blue=e.blue%t.blue,i.alpha=e.alpha%t.alpha,i},af.multiplyByScalar=function(e,t,i){return x.a.typeOf.object("color",e),x.a.typeOf.number("scalar",t),x.a.typeOf.object("result",i),i.red=e.red*t,i.green=e.green*t,i.blue=e.blue*t,i.alpha=e.alpha*t,i},af.divideByScalar=function(e,t,i){return x.a.typeOf.object("color",e),x.a.typeOf.number("scalar",t),x.a.typeOf.object("result",i),i.red=e.red/t,i.green=e.green/t,i.blue=e.blue/t,i.alpha=e.alpha/t,i},af.ALICEBLUE=Object(E.a)(af.fromCssColorString("#F0F8FF")),af.ANTIQUEWHITE=Object(E.a)(af.fromCssColorString("#FAEBD7")),af.AQUA=Object(E.a)(af.fromCssColorString("#00FFFF")),af.AQUAMARINE=Object(E.a)(af.fromCssColorString("#7FFFD4")),af.AZURE=Object(E.a)(af.fromCssColorString("#F0FFFF")),af.BEIGE=Object(E.a)(af.fromCssColorString("#F5F5DC")),af.BISQUE=Object(E.a)(af.fromCssColorString("#FFE4C4")),af.BLACK=Object(E.a)(af.fromCssColorString("#000000")),af.BLANCHEDALMOND=Object(E.a)(af.fromCssColorString("#FFEBCD")),af.BLUE=Object(E.a)(af.fromCssColorString("#0000FF")),af.BLUEVIOLET=Object(E.a)(af.fromCssColorString("#8A2BE2")),af.BROWN=Object(E.a)(af.fromCssColorString("#A52A2A")),af.BURLYWOOD=Object(E.a)(af.fromCssColorString("#DEB887")),af.CADETBLUE=Object(E.a)(af.fromCssColorString("#5F9EA0")),af.CHARTREUSE=Object(E.a)(af.fromCssColorString("#7FFF00")),af.CHOCOLATE=Object(E.a)(af.fromCssColorString("#D2691E")),af.CORAL=Object(E.a)(af.fromCssColorString("#FF7F50")),af.CORNFLOWERBLUE=Object(E.a)(af.fromCssColorString("#6495ED")),af.CORNSILK=Object(E.a)(af.fromCssColorString("#FFF8DC")),af.CRIMSON=Object(E.a)(af.fromCssColorString("#DC143C")),af.CYAN=Object(E.a)(af.fromCssColorString("#00FFFF")),af.DARKBLUE=Object(E.a)(af.fromCssColorString("#00008B")),af.DARKCYAN=Object(E.a)(af.fromCssColorString("#008B8B")),af.DARKGOLDENROD=Object(E.a)(af.fromCssColorString("#B8860B")),af.DARKGRAY=Object(E.a)(af.fromCssColorString("#A9A9A9")),af.DARKGREEN=Object(E.a)(af.fromCssColorString("#006400")),af.DARKGREY=af.DARKGRAY,af.DARKKHAKI=Object(E.a)(af.fromCssColorString("#BDB76B")),af.DARKMAGENTA=Object(E.a)(af.fromCssColorString("#8B008B")),af.DARKOLIVEGREEN=Object(E.a)(af.fromCssColorString("#556B2F")),af.DARKORANGE=Object(E.a)(af.fromCssColorString("#FF8C00")),af.DARKORCHID=Object(E.a)(af.fromCssColorString("#9932CC")),af.DARKRED=Object(E.a)(af.fromCssColorString("#8B0000")),af.DARKSALMON=Object(E.a)(af.fromCssColorString("#E9967A")),af.DARKSEAGREEN=Object(E.a)(af.fromCssColorString("#8FBC8F")),af.DARKSLATEBLUE=Object(E.a)(af.fromCssColorString("#483D8B")),af.DARKSLATEGRAY=Object(E.a)(af.fromCssColorString("#2F4F4F")),af.DARKSLATEGREY=af.DARKSLATEGRAY,af.DARKTURQUOISE=Object(E.a)(af.fromCssColorString("#00CED1")),af.DARKVIOLET=Object(E.a)(af.fromCssColorString("#9400D3")),af.DEEPPINK=Object(E.a)(af.fromCssColorString("#FF1493")),af.DEEPSKYBLUE=Object(E.a)(af.fromCssColorString("#00BFFF")),af.DIMGRAY=Object(E.a)(af.fromCssColorString("#696969")),af.DIMGREY=af.DIMGRAY,af.DODGERBLUE=Object(E.a)(af.fromCssColorString("#1E90FF")),af.FIREBRICK=Object(E.a)(af.fromCssColorString("#B22222")),af.FLORALWHITE=Object(E.a)(af.fromCssColorString("#FFFAF0")),af.FORESTGREEN=Object(E.a)(af.fromCssColorString("#228B22")),af.FUCHSIA=Object(E.a)(af.fromCssColorString("#FF00FF")),af.GAINSBORO=Object(E.a)(af.fromCssColorString("#DCDCDC")),af.GHOSTWHITE=Object(E.a)(af.fromCssColorString("#F8F8FF")),af.GOLD=Object(E.a)(af.fromCssColorString("#FFD700")),af.GOLDENROD=Object(E.a)(af.fromCssColorString("#DAA520")),af.GRAY=Object(E.a)(af.fromCssColorString("#808080")),af.GREEN=Object(E.a)(af.fromCssColorString("#008000")),af.GREENYELLOW=Object(E.a)(af.fromCssColorString("#ADFF2F")),af.GREY=af.GRAY,af.HONEYDEW=Object(E.a)(af.fromCssColorString("#F0FFF0")),af.HOTPINK=Object(E.a)(af.fromCssColorString("#FF69B4")),af.INDIANRED=Object(E.a)(af.fromCssColorString("#CD5C5C")),af.INDIGO=Object(E.a)(af.fromCssColorString("#4B0082")),af.IVORY=Object(E.a)(af.fromCssColorString("#FFFFF0")),af.KHAKI=Object(E.a)(af.fromCssColorString("#F0E68C")),af.LAVENDER=Object(E.a)(af.fromCssColorString("#E6E6FA")),af.LAVENDAR_BLUSH=Object(E.a)(af.fromCssColorString("#FFF0F5")),af.LAWNGREEN=Object(E.a)(af.fromCssColorString("#7CFC00")),af.LEMONCHIFFON=Object(E.a)(af.fromCssColorString("#FFFACD")),af.LIGHTBLUE=Object(E.a)(af.fromCssColorString("#ADD8E6")),af.LIGHTCORAL=Object(E.a)(af.fromCssColorString("#F08080")),af.LIGHTCYAN=Object(E.a)(af.fromCssColorString("#E0FFFF")),af.LIGHTGOLDENRODYELLOW=Object(E.a)(af.fromCssColorString("#FAFAD2")),af.LIGHTGRAY=Object(E.a)(af.fromCssColorString("#D3D3D3")),af.LIGHTGREEN=Object(E.a)(af.fromCssColorString("#90EE90")),af.LIGHTGREY=af.LIGHTGRAY,af.LIGHTPINK=Object(E.a)(af.fromCssColorString("#FFB6C1")),af.LIGHTSEAGREEN=Object(E.a)(af.fromCssColorString("#20B2AA")),af.LIGHTSKYBLUE=Object(E.a)(af.fromCssColorString("#87CEFA")),af.LIGHTSLATEGRAY=Object(E.a)(af.fromCssColorString("#778899")),af.LIGHTSLATEGREY=af.LIGHTSLATEGRAY,af.LIGHTSTEELBLUE=Object(E.a)(af.fromCssColorString("#B0C4DE")),af.LIGHTYELLOW=Object(E.a)(af.fromCssColorString("#FFFFE0")),af.LIME=Object(E.a)(af.fromCssColorString("#00FF00")),af.LIMEGREEN=Object(E.a)(af.fromCssColorString("#32CD32")),af.LINEN=Object(E.a)(af.fromCssColorString("#FAF0E6")),af.MAGENTA=Object(E.a)(af.fromCssColorString("#FF00FF")),af.MAROON=Object(E.a)(af.fromCssColorString("#800000")),af.MEDIUMAQUAMARINE=Object(E.a)(af.fromCssColorString("#66CDAA")),af.MEDIUMBLUE=Object(E.a)(af.fromCssColorString("#0000CD")),af.MEDIUMORCHID=Object(E.a)(af.fromCssColorString("#BA55D3")),af.MEDIUMPURPLE=Object(E.a)(af.fromCssColorString("#9370DB")),af.MEDIUMSEAGREEN=Object(E.a)(af.fromCssColorString("#3CB371")),af.MEDIUMSLATEBLUE=Object(E.a)(af.fromCssColorString("#7B68EE")),af.MEDIUMSPRINGGREEN=Object(E.a)(af.fromCssColorString("#00FA9A")),af.MEDIUMTURQUOISE=Object(E.a)(af.fromCssColorString("#48D1CC")),af.MEDIUMVIOLETRED=Object(E.a)(af.fromCssColorString("#C71585")),af.MIDNIGHTBLUE=Object(E.a)(af.fromCssColorString("#191970")),af.MINTCREAM=Object(E.a)(af.fromCssColorString("#F5FFFA")),af.MISTYROSE=Object(E.a)(af.fromCssColorString("#FFE4E1")),af.MOCCASIN=Object(E.a)(af.fromCssColorString("#FFE4B5")),af.NAVAJOWHITE=Object(E.a)(af.fromCssColorString("#FFDEAD")),af.NAVY=Object(E.a)(af.fromCssColorString("#000080")),af.OLDLACE=Object(E.a)(af.fromCssColorString("#FDF5E6")),af.OLIVE=Object(E.a)(af.fromCssColorString("#808000")),af.OLIVEDRAB=Object(E.a)(af.fromCssColorString("#6B8E23")),af.ORANGE=Object(E.a)(af.fromCssColorString("#FFA500")),af.ORANGERED=Object(E.a)(af.fromCssColorString("#FF4500")),af.ORCHID=Object(E.a)(af.fromCssColorString("#DA70D6")),af.PALEGOLDENROD=Object(E.a)(af.fromCssColorString("#EEE8AA")),af.PALEGREEN=Object(E.a)(af.fromCssColorString("#98FB98")),af.PALETURQUOISE=Object(E.a)(af.fromCssColorString("#AFEEEE")),af.PALEVIOLETRED=Object(E.a)(af.fromCssColorString("#DB7093")),af.PAPAYAWHIP=Object(E.a)(af.fromCssColorString("#FFEFD5")),af.PEACHPUFF=Object(E.a)(af.fromCssColorString("#FFDAB9")),af.PERU=Object(E.a)(af.fromCssColorString("#CD853F")),af.PINK=Object(E.a)(af.fromCssColorString("#FFC0CB")),af.PLUM=Object(E.a)(af.fromCssColorString("#DDA0DD")),af.POWDERBLUE=Object(E.a)(af.fromCssColorString("#B0E0E6")),af.PURPLE=Object(E.a)(af.fromCssColorString("#800080")),af.RED=Object(E.a)(af.fromCssColorString("#FF0000")),af.ROSYBROWN=Object(E.a)(af.fromCssColorString("#BC8F8F")),af.ROYALBLUE=Object(E.a)(af.fromCssColorString("#4169E1")),af.SADDLEBROWN=Object(E.a)(af.fromCssColorString("#8B4513")),af.SALMON=Object(E.a)(af.fromCssColorString("#FA8072")),af.SANDYBROWN=Object(E.a)(af.fromCssColorString("#F4A460")),af.SEAGREEN=Object(E.a)(af.fromCssColorString("#2E8B57")),af.SEASHELL=Object(E.a)(af.fromCssColorString("#FFF5EE")),af.SIENNA=Object(E.a)(af.fromCssColorString("#A0522D")),af.SILVER=Object(E.a)(af.fromCssColorString("#C0C0C0")),af.SKYBLUE=Object(E.a)(af.fromCssColorString("#87CEEB")),af.SLATEBLUE=Object(E.a)(af.fromCssColorString("#6A5ACD")),af.SLATEGRAY=Object(E.a)(af.fromCssColorString("#708090")),af.SLATEGREY=af.SLATEGRAY,af.SNOW=Object(E.a)(af.fromCssColorString("#FFFAFA")),af.SPRINGGREEN=Object(E.a)(af.fromCssColorString("#00FF7F")),af.STEELBLUE=Object(E.a)(af.fromCssColorString("#4682B4")),af.TAN=Object(E.a)(af.fromCssColorString("#D2B48C")),af.TEAL=Object(E.a)(af.fromCssColorString("#008080")),af.THISTLE=Object(E.a)(af.fromCssColorString("#D8BFD8")),af.TOMATO=Object(E.a)(af.fromCssColorString("#FF6347")),af.TURQUOISE=Object(E.a)(af.fromCssColorString("#40E0D0")),af.VIOLET=Object(E.a)(af.fromCssColorString("#EE82EE")),af.WHEAT=Object(E.a)(af.fromCssColorString("#F5DEB3")),af.WHITE=Object(E.a)(af.fromCssColorString("#FFFFFF")),af.WHITESMOKE=Object(E.a)(af.fromCssColorString("#F5F5F5")),af.YELLOW=Object(E.a)(af.fromCssColorString("#FFFF00")),af.YELLOWGREEN=Object(E.a)(af.fromCssColorString("#9ACD32")),af.TRANSPARENT=Object(E.a)(new af(0,0,0,0));var uf=af;function hf(e,t,i,n){e=Object(w.a)(e,1),t=Object(w.a)(t,1),i=Object(w.a)(i,1),n=Object(w.a)(n,1),this.value=new Uint8Array([uf.floatToByte(e),uf.floatToByte(t),uf.floatToByte(i),uf.floatToByte(n)])}Object(O.a)(hf.prototype,{componentDatatype:{get:function(){return dn.UNSIGNED_BYTE}},componentsPerAttribute:{get:function(){return 4}},normalize:{get:function(){return!0}}}),hf.fromColor=function(e){if(!Object(u.a)(e))throw new h.a("color is required.");return new hf(e.red,e.green,e.blue,e.alpha)},hf.toValue=function(e,t){if(!Object(u.a)(e))throw new h.a("color is required.");return Object(u.a)(t)?e.toBytes(t):new Uint8Array(e.toBytes())},hf.equals=function(e,t){return e===t||Object(u.a)(e)&&Object(u.a)(t)&&e.value[0]===t.value[0]&&e.value[1]===t.value[1]&&e.value[2]===t.value[2]&&e.value[3]===t.value[3]};var df=hf,ff=n(10);function pf(e,t,i,n){this._format=e,this._width=t,this._height=i,this._buffer=n}Object(O.a)(pf.prototype,{internalFormat:{get:function(){return this._format}},width:{get:function(){return this._width}},height:{get:function(){return this._height}},bufferView:{get:function(){return this._buffer}}}),pf.clone=function(e){if(Object(u.a)(e))return new pf(e._format,e._width,e._height,e._buffer)},pf.prototype.clone=function(){return pf.clone(this)};var mf=pf,_f={},gf=new z,vf=new z,bf=new z,yf=new z,wf=new Fc;function Of(e,t,i,n,r){var a=z.subtract(e,t,gf),o=z.dot(i,a),s=z.dot(n,a);return Rt.fromElements(o,s,r)}_f.validOutline=function(e){x.a.defined("positions",e);var t=Fc.fromPoints(e,wf).halfAxes,i=be.getColumn(t,0,vf),n=be.getColumn(t,1,bf),r=be.getColumn(t,2,yf),a=z.magnitude(i),o=z.magnitude(n),s=z.magnitude(r);return!(0===a&&(0===o||0===s)||0===o&&0===s)},_f.computeProjectTo2DArguments=function(e,t,i,n){x.a.defined("positions",e),x.a.defined("centerResult",t),x.a.defined("planeAxis1Result",i),x.a.defined("planeAxis2Result",n);var r,a,o=Fc.fromPoints(e,wf),s=o.halfAxes,c=be.getColumn(s,0,vf),l=be.getColumn(s,1,bf),u=be.getColumn(s,2,yf),h=z.magnitude(c),d=z.magnitude(l),f=z.magnitude(u),p=Math.min(h,d,f);return(0!==h||0!==d&&0!==f)&&(0!==d||0!==f)&&(p!==d&&p!==f||(r=c),p===h?r=l:p===f&&(a=l),p!==h&&p!==d||(a=u),z.normalize(r,i),z.normalize(a,n),z.clone(o.center,t),!0)},_f.createProjectPointsTo2DFunction=function(e,t,i){return function(n){for(var r=new Array(n.length),a=0;a<n.length;a++)r[a]=Of(n[a],e,t,i);return r}},_f.createProjectPointTo2DFunction=function(e,t,i){return function(n,r){return Of(n,e,t,i,r)}};var xf=_f;function Ef(e,t,i){if(0===e)return t*i;var n=e*e,r=n*n,a=r*n,o=a*n,s=o*n,c=s*n,l=i;return t*((1-n/4-3*r/64-5*a/256-175*o/16384-441*s/65536-4851*c/1048576)*l-(3*n/8+3*r/32+45*a/1024+105*o/4096+2205*s/131072+6237*c/524288)*Math.sin(2*l)+(15*r/256+45*a/1024+525*o/16384+1575*s/65536+155925*c/8388608)*Math.sin(4*l)-(35*a/3072+175*o/12288+3675*s/262144+13475*c/1048576)*Math.sin(6*l)+(315*o/131072+2205*s/524288+43659*c/8388608)*Math.sin(8*l)-(693*s/1310720+6237*c/5242880)*Math.sin(10*l)+1001*c/8388608*Math.sin(12*l))}function Tf(e,t){if(0===e)return Math.log(Math.tan(.5*(I.PI_OVER_TWO+t)));var i=e*Math.sin(t);return Math.log(Math.tan(.5*(I.PI_OVER_TWO+t)))-e/2*Math.log((1+i)/(1-i))}var Cf=new z,Sf=new z;function Af(e,t,i,n){var r=z.normalize(n.cartographicToCartesian(t,Sf),Cf),a=z.normalize(n.cartographicToCartesian(i,Sf),Sf);x.a.typeOf.number.greaterThanOrEquals("value",Math.abs(Math.abs(z.angleBetween(r,a))-Math.PI),.0125);var o=n.maximumRadius,s=n.minimumRadius,c=o*o,l=s*s;e._ellipticitySquared=(c-l)/c,e._ellipticity=Math.sqrt(e._ellipticitySquared),e._start=K.clone(t,e._start),e._start.height=0,e._end=K.clone(i,e._end),e._end.height=0,e._heading=function(e,t,i,n,r){var a=Tf(e._ellipticity,i),o=Tf(e._ellipticity,r);return Math.atan2(I.negativePiToPi(n-t),o-a)}(e,t.longitude,t.latitude,i.longitude,i.latitude),e._distance=function(e,t,i,n,r,a,o){var s=e._heading,c=a-n,l=0;if(I.equalsEpsilon(Math.abs(s),I.PI_OVER_TWO,I.EPSILON8))if(t===i)l=t*Math.cos(r)*I.negativePiToPi(c);else{var u=Math.sin(r);l=t*Math.cos(r)*I.negativePiToPi(c)/Math.sqrt(1-e._ellipticitySquared*u*u)}else{var h=Ef(e._ellipticity,t,r);l=(Ef(e._ellipticity,t,o)-h)/Math.cos(s)}return Math.abs(l)}(e,n.maximumRadius,n.minimumRadius,t.longitude,t.latitude,i.longitude,i.latitude)}function Pf(e,t,i,n,r,a){var o,s,c,l=r*r;if(Math.abs(I.PI_OVER_TWO-Math.abs(t))>I.EPSILON8){s=function(e,t,i){var n=e/i;if(0===t)return n;var r=n*n,a=r*n,o=a*n,s=t*t,c=s*s,l=c*s,u=l*s,h=u*s,d=h*s,f=Math.sin(2*n),p=Math.cos(2*n),m=Math.sin(4*n),_=Math.cos(4*n),g=Math.sin(6*n),v=Math.cos(6*n),b=Math.sin(8*n),y=Math.cos(8*n),w=Math.sin(10*n);return n+n*s/4+7*n*c/64+15*n*l/256+579*n*u/16384+1515*n*h/65536+16837*n*d/1048576+(3*n*c/16+45*n*l/256-n*(32*r-561)*u/4096-n*(232*r-1677)*h/16384+n*(399985-90560*r+512*o)*d/5242880)*p+(21*n*l/256+483*n*u/4096-n*(224*r-1969)*h/16384-n*(33152*r-112599)*d/1048576)*_+(151*n*u/4096+4681*n*h/65536+1479*n*d/16384-453*a*d/32768)*v+(1097*n*h/65536+42783*n*d/1048576)*y+8011*n*d/1048576*Math.cos(10*n)+(3*s/8+3*c/16+213*l/2048-3*r*l/64+255*u/4096-33*r*u/512+20861*h/524288-33*r*h/512+o*h/1024+28273*d/1048576-471*r*d/8192+9*o*d/4096)*f+(21*c/256+21*l/256+533*u/8192-21*r*u/512+197*h/4096-315*r*h/4096+584039*d/16777216-12517*r*d/131072+7*o*d/2048)*m+(151*l/6144+151*u/4096+5019*h/131072-453*r*h/16384+26965*d/786432-8607*r*d/131072)*g+(1097*u/131072+1097*h/65536+225797*d/10485760-1097*r*d/65536)*b+(8011*h/2621440+8011*d/1048576)*w+293393*d/251658240*Math.sin(12*n)}(Ef(r,n,e.latitude)+i*Math.cos(t),r,n);var h=Tf(r,e.latitude),d=Tf(r,s);c=Math.tan(t)*(d-h),o=I.negativePiToPi(e.longitude+c)}else{var f;if(s=e.latitude,0===r)f=n*Math.cos(e.latitude);else{var p=Math.sin(e.latitude);f=n*Math.cos(e.latitude)/Math.sqrt(1-l*p*p)}c=i/f,o=t>0?I.negativePiToPi(e.longitude+c):I.negativePiToPi(e.longitude-c)}return Object(u.a)(a)?(a.longitude=o,a.latitude=s,a.height=0,a):new K(o,s,0)}function If(e,t,i){var n=Object(w.a)(i,ae.WGS84);this._ellipsoid=n,this._start=new K,this._end=new K,this._heading=void 0,this._distance=void 0,this._ellipticity=void 0,this._ellipticitySquared=void 0,Object(u.a)(e)&&Object(u.a)(t)&&Af(this,e,t,n)}Object(O.a)(If.prototype,{ellipsoid:{get:function(){return this._ellipsoid}},surfaceDistance:{get:function(){return x.a.defined("distance",this._distance),this._distance}},start:{get:function(){return this._start}},end:{get:function(){return this._end}},heading:{get:function(){return x.a.defined("distance",this._distance),this._heading}}}),If.fromStartHeadingDistance=function(e,t,i,n,r){x.a.defined("start",e),x.a.defined("heading",t),x.a.defined("distance",i),x.a.typeOf.number.greaterThan("distance",i,0);var a=Object(w.a)(n,ae.WGS84),o=a.maximumRadius,s=a.minimumRadius,c=o*o,l=s*s,h=Math.sqrt((c-l)/c),d=Pf(e,t=I.negativePiToPi(t),i,a.maximumRadius,h);return!Object(u.a)(r)||Object(u.a)(n)&&!n.equals(r.ellipsoid)?new If(e,d,a):(r.setEndPoints(e,d),r)},If.prototype.setEndPoints=function(e,t){x.a.defined("start",e),x.a.defined("end",t),Af(this,e,t,this._ellipsoid)},If.prototype.interpolateUsingFraction=function(e,t){return this.interpolateUsingSurfaceDistance(e*this._distance,t)},If.prototype.interpolateUsingSurfaceDistance=function(e,t){if(x.a.typeOf.number("distance",e),!Object(u.a)(this._distance)||0===this._distance)throw new h.a("EllipsoidRhumbLine must have distinct start and end set.");return Pf(this._start,this._heading,e,this._ellipsoid.maximumRadius,this._ellipticity,t)},If.prototype.findIntersectionWithLongitude=function(e,t){if(x.a.typeOf.number("intersectionLongitude",e),!Object(u.a)(this._distance)||0===this._distance)throw new h.a("EllipsoidRhumbLine must have distinct start and end set.");var i=this._ellipticity,n=this._heading,r=Math.abs(n),a=this._start;if(e=I.negativePiToPi(e),Object(u.a)(t)||(t=new K),Math.abs(I.PI_OVER_TWO-r)<=I.EPSILON8)return t.longitude=e,t.latitude=a.latitude,t.height=0,t;if(I.equalsEpsilon(Math.abs(I.PI_OVER_TWO-r),I.PI_OVER_TWO,I.EPSILON8)){if(I.equalsEpsilon(e,a.longitude,I.EPSILON12))return;return t.longitude=e,t.latitude=I.PI_OVER_TWO*Math.sign(I.PI_OVER_TWO-n),t.height=0,t}var o,s=a.latitude,c=i*Math.sin(s),l=Math.tan(.5*(I.PI_OVER_TWO+s))*Math.exp((e-a.longitude)/Math.tan(n)),d=(1+c)/(1-c),f=a.latitude;do{o=f;var p=i*Math.sin(o),m=(1+p)/(1-p);f=2*Math.atan(l*Math.pow(m/d,i/2))-I.PI_OVER_TWO}while(!I.equalsEpsilon(f,o,I.EPSILON12));return t.longitude=e,t.latitude=o,t.height=0,t},If.prototype.findIntersectionWithLatitude=function(e,t){if(x.a.typeOf.number("intersectionLatitude",e),!Object(u.a)(this._distance)||0===this._distance)throw new h.a("EllipsoidRhumbLine must have distinct start and end set.");var i=this._ellipticity,n=this._heading,r=this._start;if(!I.equalsEpsilon(Math.abs(n),I.PI_OVER_TWO,I.EPSILON8)){var a=Tf(i,r.latitude),o=Tf(i,e),s=Math.tan(n)*(o-a),c=I.negativePiToPi(r.longitude+s);return Object(u.a)(t)?(t.longitude=c,t.latitude=e,t.height=0,t):new K(c,e,0)}};var Df=If;function jf(e,t,i){i=i||2;var n,r,a,o,s,c,l,u=t&&t.length,h=u?t[0]*i:e.length,d=Mf(e,0,h,i,!0),f=[];if(!d||d.next===d.prev)return f;if(u&&(d=function(e,t,i,n){var r,a,o,s,c,l=[];for(r=0,a=t.length;r<a;r++)o=t[r]*n,s=r<a-1?t[r+1]*n:e.length,(c=Mf(e,o,s,n,!1))===c.next&&(c.steiner=!0),l.push(Gf(c));for(l.sort(zf),r=0;r<l.length;r++)Uf(l[r],i),i=Rf(i,i.next);return i}(e,t,d,i)),e.length>80*i){n=a=e[0],r=o=e[1];for(var p=i;p<h;p+=i)(s=e[p])<n&&(n=s),(c=e[p+1])<r&&(r=c),s>a&&(a=s),c>o&&(o=c);l=0!==(l=Math.max(a-n,o-r))?1/l:0}return Lf(d,f,i,n,r,l),f}function Mf(e,t,i,n,r){var a,o;if(r===np(e,t,i,n)>0)for(a=t;a<i;a+=n)o=ep(a,e[a],e[a+1],o);else for(a=i-n;a>=t;a-=n)o=ep(a,e[a],e[a+1],o);return o&&Xf(o,o.next)&&(tp(o),o=o.next),o}function Rf(e,t){if(!e)return e;t||(t=e);var i,n=e;do{if(i=!1,n.steiner||!Xf(n,n.next)&&0!==Yf(n.prev,n,n.next))n=n.next;else{if(tp(n),(n=t=n.prev)===n.next)break;i=!0}}while(i||n!==t);return t}function Lf(e,t,i,n,r,a,o){if(e){!o&&a&&function(e,t,i,n){var r=e;do{null===r.z&&(r.z=Hf(r.x,r.y,t,i,n)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==e);r.prevZ.nextZ=null,r.prevZ=null,function(e){var t,i,n,r,a,o,s,c,l=1;do{for(i=e,e=null,a=null,o=0;i;){for(o++,n=i,s=0,t=0;t<l&&(s++,n=n.nextZ);t++);for(c=l;s>0||c>0&&n;)0!==s&&(0===c||!n||i.z<=n.z)?(r=i,i=i.nextZ,s--):(r=n,n=n.nextZ,c--),a?a.nextZ=r:e=r,r.prevZ=a,a=r;i=n}a.nextZ=null,l*=2}while(o>1)}(r)}(e,n,r,a);for(var s,c,l=e;e.prev!==e.next;)if(s=e.prev,c=e.next,a?Ff(e,n,r,a):Nf(e))t.push(s.i/i),t.push(e.i/i),t.push(c.i/i),tp(e),e=c.next,l=c.next;else if((e=c)===l){o?1===o?Lf(e=kf(Rf(e),t,i),t,i,n,r,a,2):2===o&&Bf(e,t,i,n,r,a):Lf(Rf(e),t,i,n,r,a,1);break}}}function Nf(e){var t=e.prev,i=e,n=e.next;if(Yf(t,i,n)>=0)return!1;for(var r=e.next.next;r!==e.prev;){if(qf(t.x,t.y,i.x,i.y,n.x,n.y,r.x,r.y)&&Yf(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}function Ff(e,t,i,n){var r=e.prev,a=e,o=e.next;if(Yf(r,a,o)>=0)return!1;for(var s=r.x<a.x?r.x<o.x?r.x:o.x:a.x<o.x?a.x:o.x,c=r.y<a.y?r.y<o.y?r.y:o.y:a.y<o.y?a.y:o.y,l=r.x>a.x?r.x>o.x?r.x:o.x:a.x>o.x?a.x:o.x,u=r.y>a.y?r.y>o.y?r.y:o.y:a.y>o.y?a.y:o.y,h=Hf(s,c,t,i,n),d=Hf(l,u,t,i,n),f=e.prevZ,p=e.nextZ;f&&f.z>=h&&p&&p.z<=d;){if(f!==e.prev&&f!==e.next&&qf(r.x,r.y,a.x,a.y,o.x,o.y,f.x,f.y)&&Yf(f.prev,f,f.next)>=0)return!1;if(f=f.prevZ,p!==e.prev&&p!==e.next&&qf(r.x,r.y,a.x,a.y,o.x,o.y,p.x,p.y)&&Yf(p.prev,p,p.next)>=0)return!1;p=p.nextZ}for(;f&&f.z>=h;){if(f!==e.prev&&f!==e.next&&qf(r.x,r.y,a.x,a.y,o.x,o.y,f.x,f.y)&&Yf(f.prev,f,f.next)>=0)return!1;f=f.prevZ}for(;p&&p.z<=d;){if(p!==e.prev&&p!==e.next&&qf(r.x,r.y,a.x,a.y,o.x,o.y,p.x,p.y)&&Yf(p.prev,p,p.next)>=0)return!1;p=p.nextZ}return!0}function kf(e,t,i){var n=e;do{var r=n.prev,a=n.next.next;!Xf(r,a)&&Zf(r,n,n.next,a)&&Jf(r,a)&&Jf(a,r)&&(t.push(r.i/i),t.push(n.i/i),t.push(a.i/i),tp(n),tp(n.next),n=e=a),n=n.next}while(n!==e);return Rf(n)}function Bf(e,t,i,n,r,a){var o=e;do{for(var s=o.next.next;s!==o.prev;){if(o.i!==s.i&&Wf(o,s)){var c=$f(o,s);return o=Rf(o,o.next),c=Rf(c,c.next),Lf(o,t,i,n,r,a),void Lf(c,t,i,n,r,a)}s=s.next}o=o.next}while(o!==e)}function zf(e,t){return e.x-t.x}function Uf(e,t){if(t=function(e,t){var i,n=t,r=e.x,a=e.y,o=-1/0;do{if(a<=n.y&&a>=n.next.y&&n.next.y!==n.y){var s=n.x+(a-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(s<=r&&s>o){if(o=s,s===r){if(a===n.y)return n;if(a===n.next.y)return n.next}i=n.x<n.next.x?n:n.next}}n=n.next}while(n!==t);if(!i)return null;if(r===o)return i;var c,l=i,u=i.x,h=i.y,d=1/0;n=i;do{r>=n.x&&n.x>=u&&r!==n.x&&qf(a<h?r:o,a,u,h,a<h?o:r,a,n.x,n.y)&&(c=Math.abs(a-n.y)/(r-n.x),Jf(n,e)&&(c<d||c===d&&(n.x>i.x||n.x===i.x&&Vf(i,n)))&&(i=n,d=c)),n=n.next}while(n!==l);return i}(e,t)){var i=$f(t,e);Rf(i,i.next)}}function Vf(e,t){return Yf(e.prev,e,t.prev)<0&&Yf(t.next,e,e.next)<0}function Hf(e,t,i,n,r){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-i)*r)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*r)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function Gf(e){var t=e,i=e;do{(t.x<i.x||t.x===i.x&&t.y<i.y)&&(i=t),t=t.next}while(t!==e);return i}function qf(e,t,i,n,r,a,o,s){return(r-o)*(t-s)-(e-o)*(a-s)>=0&&(e-o)*(n-s)-(i-o)*(t-s)>=0&&(i-o)*(a-s)-(r-o)*(n-s)>=0}function Wf(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var i=e;do{if(i.i!==e.i&&i.next.i!==e.i&&i.i!==t.i&&i.next.i!==t.i&&Zf(i,i.next,e,t))return!0;i=i.next}while(i!==e);return!1}(e,t)&&(Jf(e,t)&&Jf(t,e)&&function(e,t){var i=e,n=!1,r=(e.x+t.x)/2,a=(e.y+t.y)/2;do{i.y>a!=i.next.y>a&&i.next.y!==i.y&&r<(i.next.x-i.x)*(a-i.y)/(i.next.y-i.y)+i.x&&(n=!n),i=i.next}while(i!==e);return n}(e,t)&&(Yf(e.prev,e,t.prev)||Yf(e,t.prev,t))||Xf(e,t)&&Yf(e.prev,e,e.next)>0&&Yf(t.prev,t,t.next)>0)}function Yf(e,t,i){return(t.y-e.y)*(i.x-t.x)-(t.x-e.x)*(i.y-t.y)}function Xf(e,t){return e.x===t.x&&e.y===t.y}function Zf(e,t,i,n){var r=Kf(Yf(e,t,i)),a=Kf(Yf(e,t,n)),o=Kf(Yf(i,n,e)),s=Kf(Yf(i,n,t));return r!==a&&o!==s||(!(0!==r||!Qf(e,i,t))||(!(0!==a||!Qf(e,n,t))||(!(0!==o||!Qf(i,e,n))||!(0!==s||!Qf(i,t,n)))))}function Qf(e,t,i){return t.x<=Math.max(e.x,i.x)&&t.x>=Math.min(e.x,i.x)&&t.y<=Math.max(e.y,i.y)&&t.y>=Math.min(e.y,i.y)}function Kf(e){return e>0?1:e<0?-1:0}function Jf(e,t){return Yf(e.prev,e,e.next)<0?Yf(e,t,e.next)>=0&&Yf(e,e.prev,t)>=0:Yf(e,t,e.prev)<0||Yf(e,e.next,t)<0}function $f(e,t){var i=new ip(e.i,e.x,e.y),n=new ip(t.i,t.x,t.y),r=e.next,a=t.prev;return e.next=t,t.prev=e,i.next=r,r.prev=i,n.next=i,i.prev=n,a.next=n,n.prev=a,n}function ep(e,t,i,n){var r=new ip(e,t,i);return n?(r.next=n.next,r.prev=n,n.next.prev=r,n.next=r):(r.prev=r,r.next=r),r}function tp(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function ip(e,t,i){this.i=e,this.x=t,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function np(e,t,i,n){for(var r=0,a=t,o=i-n;a<i;a+=n)r+=(e[o]-e[a])*(e[a+1]+e[o+1]),o=a;return r}jf.deviation=function(e,t,i,n){var r=t&&t.length,a=r?t[0]*i:e.length,o=Math.abs(np(e,0,a,i));if(r)for(var s=0,c=t.length;s<c;s++){var l=t[s]*i,u=s<c-1?t[s+1]*i:e.length;o-=Math.abs(np(e,l,u,i))}var h=0;for(s=0;s<n.length;s+=3){var d=n[s]*i,f=n[s+1]*i,p=n[s+2]*i;h+=Math.abs((e[d]-e[p])*(e[f+1]-e[d+1])-(e[d]-e[f])*(e[p+1]-e[d+1]))}return 0===o&&0===h?0:Math.abs((h-o)/o)},jf.flatten=function(e){for(var t=e[0][0].length,i={vertices:[],holes:[],dimensions:t},n=0,r=0;r<e.length;r++){for(var a=0;a<e[r].length;a++)for(var o=0;o<t;o++)i.vertices.push(e[r][a][o]);r>0&&(n+=e[r-1].length,i.holes.push(n))}return i};var rp=jf,ap={CLOCKWISE:un.CW,COUNTER_CLOCKWISE:un.CCW,validate:function(e){return e===ap.CLOCKWISE||e===ap.COUNTER_CLOCKWISE}},op=Object(E.a)(ap),sp=new z,cp=new z,lp={computeArea2D:function(e){x.a.defined("positions",e),x.a.typeOf.number.greaterThanOrEquals("positions.length",e.length,3);for(var t=e.length,i=0,n=t-1,r=0;r<t;n=r++){var a=e[n],o=e[r];i+=a.x*o.y-o.x*a.y}return.5*i},computeWindingOrder2D:function(e){return lp.computeArea2D(e)>0?op.COUNTER_CLOCKWISE:op.CLOCKWISE},triangulate:function(e,t){x.a.defined("positions",e);var i=Rt.packArray(e);return rp(i,t,2)}},up=new z,hp=new z,dp=new z,fp=new z,pp=new z,mp=new z,_p=new z;lp.computeSubdivision=function(e,t,i,n){n=Object(w.a)(n,I.RADIANS_PER_DEGREE),x.a.typeOf.object("ellipsoid",e),x.a.defined("positions",t),x.a.defined("indices",i),x.a.typeOf.number.greaterThanOrEquals("indices.length",i.length,3),x.a.typeOf.number.equals("indices.length % 3","0",i.length%3,0),x.a.typeOf.number.greaterThan("granularity",n,0);var r,a=i.slice(0),o=t.length,s=new Array(3*o),c=0;for(r=0;r<o;r++){var l=t[r];s[c++]=l.x,s[c++]=l.y,s[c++]=l.z}for(var h=[],d={},f=e.maximumRadius,p=I.chordLength(n,f),m=p*p;a.length>0;){var _,g,v=a.pop(),b=a.pop(),y=a.pop(),O=z.fromArray(s,3*y,up),E=z.fromArray(s,3*b,hp),T=z.fromArray(s,3*v,dp),C=z.multiplyByScalar(z.normalize(O,fp),f,fp),S=z.multiplyByScalar(z.normalize(E,pp),f,pp),A=z.multiplyByScalar(z.normalize(T,mp),f,mp),P=z.magnitudeSquared(z.subtract(C,S,_p)),D=z.magnitudeSquared(z.subtract(S,A,_p)),j=z.magnitudeSquared(z.subtract(A,C,_p)),M=Math.max(P,D,j);M>m?P===M?(r=d[_=Math.min(y,b)+" "+Math.max(y,b)],Object(u.a)(r)||(g=z.add(O,E,_p),z.multiplyByScalar(g,.5,g),s.push(g.x,g.y,g.z),r=s.length/3-1,d[_]=r),a.push(y,r,v),a.push(r,b,v)):D===M?(r=d[_=Math.min(b,v)+" "+Math.max(b,v)],Object(u.a)(r)||(g=z.add(E,T,_p),z.multiplyByScalar(g,.5,g),s.push(g.x,g.y,g.z),r=s.length/3-1,d[_]=r),a.push(b,r,y),a.push(r,v,y)):j===M&&(r=d[_=Math.min(v,y)+" "+Math.max(v,y)],Object(u.a)(r)||(g=z.add(T,O,_p),z.multiplyByScalar(g,.5,g),s.push(g.x,g.y,g.z),r=s.length/3-1,d[_]=r),a.push(v,r,b),a.push(r,y,b)):(h.push(y),h.push(b),h.push(v))}return new La({attributes:{position:new Na({componentDatatype:dn.DOUBLE,componentsPerAttribute:3,values:s})},indices:h,primitiveType:yn.TRIANGLES})};var gp=new K,vp=new K,bp=new K,yp=new K;lp.computeRhumbLineSubdivision=function(e,t,i,n){n=Object(w.a)(n,I.RADIANS_PER_DEGREE),x.a.typeOf.object("ellipsoid",e),x.a.defined("positions",t),x.a.defined("indices",i),x.a.typeOf.number.greaterThanOrEquals("indices.length",i.length,3),x.a.typeOf.number.equals("indices.length % 3","0",i.length%3,0),x.a.typeOf.number.greaterThan("granularity",n,0);var r,a=i.slice(0),o=t.length,s=new Array(3*o),c=0;for(r=0;r<o;r++){var l=t[r];s[c++]=l.x,s[c++]=l.y,s[c++]=l.z}for(var h=[],d={},f=e.maximumRadius,p=I.chordLength(n,f),m=new Df(void 0,void 0,e),_=new Df(void 0,void 0,e),g=new Df(void 0,void 0,e);a.length>0;){var v=a.pop(),b=a.pop(),y=a.pop(),O=z.fromArray(s,3*y,up),E=z.fromArray(s,3*b,hp),T=z.fromArray(s,3*v,dp),C=e.cartesianToCartographic(O,gp),S=e.cartesianToCartographic(E,vp),A=e.cartesianToCartographic(T,bp);m.setEndPoints(C,S);var P=m.surfaceDistance;_.setEndPoints(S,A);var D=_.surfaceDistance;g.setEndPoints(A,C);var j,M,R,L,N=g.surfaceDistance,F=Math.max(P,D,N);F>p?P===F?(r=d[j=Math.min(y,b)+" "+Math.max(y,b)],Object(u.a)(r)||(M=m.interpolateUsingFraction(.5,yp),R=.5*(C.height+S.height),L=z.fromRadians(M.longitude,M.latitude,R,e,_p),s.push(L.x,L.y,L.z),r=s.length/3-1,d[j]=r),a.push(y,r,v),a.push(r,b,v)):D===F?(r=d[j=Math.min(b,v)+" "+Math.max(b,v)],Object(u.a)(r)||(M=_.interpolateUsingFraction(.5,yp),R=.5*(S.height+A.height),L=z.fromRadians(M.longitude,M.latitude,R,e,_p),s.push(L.x,L.y,L.z),r=s.length/3-1,d[j]=r),a.push(b,r,y),a.push(r,v,y)):N===F&&(r=d[j=Math.min(v,y)+" "+Math.max(v,y)],Object(u.a)(r)||(M=g.interpolateUsingFraction(.5,yp),R=.5*(A.height+C.height),L=z.fromRadians(M.longitude,M.latitude,R,e,_p),s.push(L.x,L.y,L.z),r=s.length/3-1,d[j]=r),a.push(v,r,b),a.push(r,y,b)):(h.push(y),h.push(b),h.push(v))}return new La({attributes:{position:new Na({componentDatatype:dn.DOUBLE,componentsPerAttribute:3,values:s})},indices:h,primitiveType:yn.TRIANGLES})},lp.scaleToGeodeticHeight=function(e,t,i,n){i=Object(w.a)(i,ae.WGS84);var r=sp,a=cp;if(t=Object(w.a)(t,0),n=Object(w.a)(n,!0),Object(u.a)(e))for(var o=e.length,s=0;s<o;s+=3)z.fromArray(e,s,a),n&&(a=i.scaleToGeodeticSurface(a,a)),0!==t&&(r=i.geodeticSurfaceNormal(a,r),z.multiplyByScalar(r,t,r),z.add(a,r,a)),e[s]=a.x,e[s+1]=a.y,e[s+2]=a.z;return e};var wp=lp;function Op(){this._array=[],this._offset=0,this._length=0}Object(O.a)(Op.prototype,{length:{get:function(){return this._length}}}),Op.prototype.enqueue=function(e){this._array.push(e),this._length++},Op.prototype.dequeue=function(){if(0!==this._length){var e=this._array,t=this._offset,i=e[t];return e[t]=void 0,++t>10&&2*t>e.length&&(this._array=e.slice(t),t=0),this._offset=t,this._length--,i}},Op.prototype.peek=function(){if(0!==this._length)return this._array[this._offset]},Op.prototype.contains=function(e){return-1!==this._array.indexOf(e)},Op.prototype.clear=function(){this._array.length=this._offset=this._length=0},Op.prototype.sort=function(e){this._offset>0&&(this._array=this._array.slice(this._offset),this._offset=0),this._array.sort(e)};var xp=Op,Ep={computeHierarchyPackedLength:function(e){for(var t=0,i=[e];i.length>0;){var n=i.pop();if(Object(u.a)(n)){t+=2;var r=n.positions,a=n.holes;if(Object(u.a)(r)&&(t+=r.length*z.packedLength),Object(u.a)(a))for(var o=a.length,s=0;s<o;++s)i.push(a[s])}}return t},packPolygonHierarchy:function(e,t,i){for(var n=[e];n.length>0;){var r=n.pop();if(Object(u.a)(r)){var a=r.positions,o=r.holes;if(t[i++]=Object(u.a)(a)?a.length:0,t[i++]=Object(u.a)(o)?o.length:0,Object(u.a)(a))for(var s=a.length,c=0;c<s;++c,i+=3)z.pack(a[c],t,i);if(Object(u.a)(o))for(var l=o.length,h=0;h<l;++h)n.push(o[h])}}return i},unpackPolygonHierarchy:function(e,t){for(var i=e[t++],n=e[t++],r=new Array(i),a=n>0?new Array(n):void 0,o=0;o<i;++o,t+=z.packedLength)r[o]=z.unpack(e,t);for(var s=0;s<n;++s)a[s]=Ep.unpackPolygonHierarchy(e,t),t=a[s].startingIndex,delete a[s].startingIndex;return{positions:r,holes:a,startingIndex:t}}},Tp=new z;function Cp(e,t,i,n){return z.subtract(t,e,Tp),z.multiplyByScalar(Tp,i/n,Tp),z.add(e,Tp,Tp),[Tp.x,Tp.y,Tp.z]}Ep.subdivideLineCount=function(e,t,i){var n=z.distance(e,t)/i,r=Math.max(0,Math.ceil(I.log2(n)));return Math.pow(2,r)};var Sp=new K,Ap=new K,Pp=new K,Ip=new z;Ep.subdivideRhumbLineCount=function(e,t,i,n){var r=e.cartesianToCartographic(t,Sp),a=e.cartesianToCartographic(i,Ap),o=new Df(r,a,e).surfaceDistance/n,s=Math.max(0,Math.ceil(I.log2(o)));return Math.pow(2,s)},Ep.subdivideLine=function(e,t,i,n){var r=Ep.subdivideLineCount(e,t,i),a=z.distance(e,t),o=a/r;Object(u.a)(n)||(n=[]);var s=n;s.length=3*r;for(var c=0,l=0;l<r;l++){var h=Cp(e,t,l*o,a);s[c++]=h[0],s[c++]=h[1],s[c++]=h[2]}return s},Ep.subdivideRhumbLine=function(e,t,i,n,r){var a=e.cartesianToCartographic(t,Sp),o=e.cartesianToCartographic(i,Ap),s=new Df(a,o,e),c=s.surfaceDistance/n,l=Math.max(0,Math.ceil(I.log2(c))),h=Math.pow(2,l),d=s.surfaceDistance/h;Object(u.a)(r)||(r=[]);var f=r;f.length=3*h;for(var p=0,m=0;m<h;m++){var _=s.interpolateUsingSurfaceDistance(m*d,Pp),g=e.cartographicToCartesian(_,Ip);f[p++]=g.x,f[p++]=g.y,f[p++]=g.z}return f};var Dp=new z,jp=new z,Mp=new z,Rp=new z;Ep.scaleToGeodeticHeightExtruded=function(e,t,i,n,r){n=Object(w.a)(n,ae.WGS84);var a=Dp,o=jp,s=Mp,c=Rp;if(Object(u.a)(e)&&Object(u.a)(e.attributes)&&Object(u.a)(e.attributes.position))for(var l=e.attributes.position.values,h=l.length/2,d=0;d<h;d+=3)z.fromArray(l,d,s),n.geodeticSurfaceNormal(s,a),c=n.scaleToGeodeticSurface(s,c),o=z.multiplyByScalar(a,i,o),o=z.add(c,o,o),l[d+h]=o.x,l[d+1+h]=o.y,l[d+2+h]=o.z,r&&(c=z.clone(s,c)),o=z.multiplyByScalar(a,t,o),o=z.add(c,o,o),l[d]=o.x,l[d+1]=o.y,l[d+2]=o.z;return e},Ep.polygonOutlinesFromHierarchy=function(e,t,i){var n,r,a,o=[],s=new xp;for(s.enqueue(e);0!==s.length;){var c=s.dequeue(),l=c.positions;if(t)for(a=l.length,n=0;n<a;n++)i.scaleToGeodeticSurface(l[n],l[n]);if(!((l=$t(l,z.equalsEpsilon,!0)).length<3)){var h=c.holes?c.holes.length:0;for(n=0;n<h;n++){var d=c.holes[n],f=d.positions;if(t)for(a=f.length,r=0;r<a;++r)i.scaleToGeodeticSurface(f[r],f[r]);if(!((f=$t(f,z.equalsEpsilon,!0)).length<3)){o.push(f);var p=0;for(Object(u.a)(d.holes)&&(p=d.holes.length),r=0;r<p;r++)s.enqueue(d.holes[r])}}o.push(l)}}return o},Ep.polygonsFromHierarchy=function(e,t,i,n){var r=[],a=[],o=new xp;for(o.enqueue(e);0!==o.length;){var s,c,l=o.dequeue(),h=l.positions,d=l.holes;if(i)for(c=h.length,s=0;s<c;s++)n.scaleToGeodeticSurface(h[s],h[s]);if(!((h=$t(h,z.equalsEpsilon,!0)).length<3)){var f=t(h);if(Object(u.a)(f)){var p=[],m=wp.computeWindingOrder2D(f);m===op.CLOCKWISE&&(f.reverse(),h=h.slice().reverse());var _,g=h.slice(),v=Object(u.a)(d)?d.length:0,b=[];for(s=0;s<v;s++){var y=d[s],w=y.positions;if(i)for(c=w.length,_=0;_<c;++_)n.scaleToGeodeticSurface(w[_],w[_]);if(!((w=$t(w,z.equalsEpsilon,!0)).length<3)){var O=t(w);if(Object(u.a)(O)){(m=wp.computeWindingOrder2D(O))===op.CLOCKWISE&&(O.reverse(),w=w.slice().reverse()),b.push(w),p.push(g.length),g=g.concat(w),f=f.concat(O);var x=0;for(Object(u.a)(y.holes)&&(x=y.holes.length),_=0;_<x;_++)o.enqueue(y.holes[_])}}}r.push({outerRing:h,holes:b}),a.push({positions:g,positions2D:f,holes:p})}}}return{hierarchy:r,polygons:a}};var Lp=new Rt,Np=new z,Fp=new Kn,kp=new be;Ep.computeBoundingRectangle=function(e,t,i,n,r){for(var a=Kn.fromAxisAngle(e,n,Fp),o=be.fromQuaternion(a,kp),s=Number.POSITIVE_INFINITY,c=Number.NEGATIVE_INFINITY,l=Number.POSITIVE_INFINITY,h=Number.NEGATIVE_INFINITY,d=i.length,f=0;f<d;++f){var p=z.clone(i[f],Np);be.multiplyByVector(o,p,p);var m=t(p,Lp);Object(u.a)(m)&&(s=Math.min(s,m.x),c=Math.max(c,m.x),l=Math.min(l,m.y),h=Math.max(h,m.y))}return r.x=s,r.y=l,r.width=c-s,r.height=h-l,r},Ep.createGeometryFromPositions=function(e,t,i,n,r,a){var o=wp.triangulate(t.positions2D,t.holes);o.length<3&&(o=[0,1,2]);var s=t.positions;if(n){for(var c=s.length,l=new Array(3*c),u=0,h=0;h<c;h++){var d=s[h];l[u++]=d.x,l[u++]=d.y,l[u++]=d.z}var f=new La({attributes:{position:new Na({componentDatatype:dn.DOUBLE,componentsPerAttribute:3,values:l})},indices:o,primitiveType:yn.TRIANGLES});return r.normal?id.computeNormal(f):f}return a===Zt.GEODESIC?wp.computeSubdivision(e,s,o,i):a===Zt.RHUMB?wp.computeRhumbLineSubdivision(e,s,o,i):void 0};var Bp=[],zp=new z,Up=new z;Ep.computeWallGeometry=function(e,t,i,n,r){var a,o,s,c,l,u=e.length,h=0;if(n)for(o=3*u*2,a=new Array(2*o),s=0;s<u;s++)c=e[s],l=e[(s+1)%u],a[h]=a[h+o]=c.x,a[++h]=a[h+o]=c.y,a[++h]=a[h+o]=c.z,a[++h]=a[h+o]=l.x,a[++h]=a[h+o]=l.y,a[++h]=a[h+o]=l.z,++h;else{var d=I.chordLength(i,t.maximumRadius),f=0;if(r===Zt.GEODESIC)for(s=0;s<u;s++)f+=Ep.subdivideLineCount(e[s],e[(s+1)%u],d);else if(r===Zt.RHUMB)for(s=0;s<u;s++)f+=Ep.subdivideRhumbLineCount(t,e[s],e[(s+1)%u],d);for(o=3*(f+u),a=new Array(2*o),s=0;s<u;s++){var p;c=e[s],l=e[(s+1)%u],r===Zt.GEODESIC?p=Ep.subdivideLine(c,l,d,Bp):r===Zt.RHUMB&&(p=Ep.subdivideRhumbLine(t,c,l,d,Bp));for(var m=p.length,_=0;_<m;++_,++h)a[h]=p[_],a[h+o]=p[_];a[h]=l.x,a[h+o]=l.x,a[++h]=l.y,a[h+o]=l.y,a[++h]=l.z,a[h+o]=l.z,++h}}u=a.length;var g=Sl.createTypedArray(u/3,u-6*e.length),v=0;for(u/=6,s=0;s<u;s++){var b=s,y=b+1,w=b+u,O=w+1;c=z.fromArray(a,3*b,zp),l=z.fromArray(a,3*y,Up),z.equalsEpsilon(c,l,I.EPSILON14)||(g[v++]=b,g[v++]=w,g[v++]=y,g[v++]=y,g[v++]=w,g[v++]=O)}return new La({attributes:new Fa({position:new Na({componentDatatype:dn.DOUBLE,componentsPerAttribute:3,values:a})}),indices:g,primitiveType:yn.TRIANGLES})};var Vp=Ep,Hp=new z,Gp=new ln,qp=new Rt,Wp=new Rt,Yp=new z,Xp=new z,Zp=new z,Qp=new z,Kp=new z,Jp=new z,$p=new Kn,em=new be,tm=new be,im=new z;function nm(e,t,i,n,r,a,o,s){var c=e.positions,l=wp.triangulate(e.positions2D,e.holes);l.length<3&&(l=[0,1,2]);var u=Sl.createTypedArray(c.length,l.length);u.set(l);var h=em;if(0!==n){var d=Kn.fromAxisAngle(a,n,$p);if(h=be.fromQuaternion(d,h),t.tangent||t.bitangent){d=Kn.fromAxisAngle(a,-n,$p);var f=be.fromQuaternion(d,tm);o=z.normalize(be.multiplyByVector(f,o,o),o),t.bitangent&&(s=z.normalize(z.cross(a,o,s),s))}}else h=be.clone(be.IDENTITY,h);var p=Wp;t.st&&(p.x=i.x,p.y=i.y);for(var m=c.length,_=3*m,g=new Float64Array(_),v=t.normal?new Float32Array(_):void 0,b=t.tangent?new Float32Array(_):void 0,y=t.bitangent?new Float32Array(_):void 0,w=t.st?new Float32Array(2*m):void 0,O=0,x=0,E=0,T=0,C=0,S=0;S<m;S++){var A=c[S];if(g[O++]=A.x,g[O++]=A.y,g[O++]=A.z,t.st){var P=r(be.multiplyByVector(h,A,Hp),qp);Rt.subtract(P,p,P);var D=I.clamp(P.x/i.width,0,1),j=I.clamp(P.y/i.height,0,1);w[C++]=D,w[C++]=j}t.normal&&(v[x++]=a.x,v[x++]=a.y,v[x++]=a.z),t.tangent&&(b[T++]=o.x,b[T++]=o.y,b[T++]=o.z),t.bitangent&&(y[E++]=s.x,y[E++]=s.y,y[E++]=s.z)}var M=new Fa;return t.position&&(M.position=new Na({componentDatatype:dn.DOUBLE,componentsPerAttribute:3,values:g})),t.normal&&(M.normal=new Na({componentDatatype:dn.FLOAT,componentsPerAttribute:3,values:v})),t.tangent&&(M.tangent=new Na({componentDatatype:dn.FLOAT,componentsPerAttribute:3,values:b})),t.bitangent&&(M.bitangent=new Na({componentDatatype:dn.FLOAT,componentsPerAttribute:3,values:y})),t.st&&(M.st=new Na({componentDatatype:dn.FLOAT,componentsPerAttribute:2,values:w})),new La({attributes:M,indices:u,primitiveType:yn.TRIANGLES})}function rm(e){var t=(e=Object(w.a)(e,w.a.EMPTY_OBJECT)).polygonHierarchy;x.a.defined("options.polygonHierarchy",t);var i=Object(w.a)(e.vertexFormat,Ba.DEFAULT);this._vertexFormat=Ba.clone(i),this._polygonHierarchy=t,this._stRotation=Object(w.a)(e.stRotation,0),this._ellipsoid=ae.clone(Object(w.a)(e.ellipsoid,ae.WGS84)),this._workerName="createCoplanarPolygonGeometry",this.packedLength=Vp.computeHierarchyPackedLength(t)+Ba.packedLength+ae.packedLength+2}rm.fromPositions=function(e){return e=Object(w.a)(e,w.a.EMPTY_OBJECT),x.a.defined("options.positions",e.positions),new rm({polygonHierarchy:{positions:e.positions},vertexFormat:e.vertexFormat,stRotation:e.stRotation,ellipsoid:e.ellipsoid})},rm.pack=function(e,t,i){return x.a.typeOf.object("value",e),x.a.defined("array",t),i=Object(w.a)(i,0),i=Vp.packPolygonHierarchy(e._polygonHierarchy,t,i),ae.pack(e._ellipsoid,t,i),i+=ae.packedLength,Ba.pack(e._vertexFormat,t,i),i+=Ba.packedLength,t[i++]=e._stRotation,t[i]=e.packedLength,t};var am=ae.clone(ae.UNIT_SPHERE),om=new Ba,sm={polygonHierarchy:{}};rm.unpack=function(e,t,i){x.a.defined("array",e),t=Object(w.a)(t,0);var n=Vp.unpackPolygonHierarchy(e,t);t=n.startingIndex,delete n.startingIndex;var r=ae.unpack(e,t,am);t+=ae.packedLength;var a=Ba.unpack(e,t,om);t+=Ba.packedLength;var o=e[t++],s=e[t];return Object(u.a)(i)||(i=new rm(sm)),i._polygonHierarchy=n,i._ellipsoid=ae.clone(r,i._ellipsoid),i._vertexFormat=Ba.clone(a,i._vertexFormat),i._stRotation=o,i.packedLength=s,i},rm.createGeometry=function(e){var t=e._vertexFormat,i=e._polygonHierarchy,n=e._stRotation,r=i.positions;if(!((r=$t(r,z.equalsEpsilon,!0)).length<3)){var a=Yp,o=Xp,s=Zp,c=Kp,l=Jp;if(xf.computeProjectTo2DArguments(r,Qp,c,l)){if(a=z.cross(c,l,a),a=z.normalize(a,a),!z.equalsEpsilon(Qp,z.ZERO,I.EPSILON6)){var u=e._ellipsoid.geodeticSurfaceNormal(Qp,im);z.dot(a,u)<0&&(a=z.negate(a,a),c=z.negate(c,c))}var h=xf.createProjectPointsTo2DFunction(Qp,c,l),d=xf.createProjectPointTo2DFunction(Qp,c,l);t.tangent&&(o=z.clone(c,o)),t.bitangent&&(s=z.clone(l,s));var f=Vp.polygonsFromHierarchy(i,h,!1),p=f.hierarchy,m=f.polygons;if(0!==p.length){r=p[0].outerRing;for(var _=St.fromPoints(r),g=Vp.computeBoundingRectangle(a,d,r,n,Gp),v=[],b=0;b<m.length;b++){var y=new Mu({geometry:nm(m[b],t,g,n,d,a,o,s)});v.push(y)}var w=id.combineInstances(v)[0];w.attributes.position.values=new Float64Array(w.attributes.position.values),w.indices=Sl.createTypedArray(w.attributes.position.values.length/3,w.indices);var O=w.attributes;return t.position||delete O.position,new La({attributes:O,indices:w.indices,primitiveType:w.primitiveType,boundingSphere:_})}}}};var cm=rm;function lm(e){for(var t=e.length,i=new Float64Array(3*t),n=Sl.createTypedArray(t,2*t),r=0,a=0,o=0;o<t;o++){var s=e[o];i[r++]=s.x,i[r++]=s.y,i[r++]=s.z,n[a++]=o,n[a++]=(o+1)%t}var c=new Fa({position:new Na({componentDatatype:dn.DOUBLE,componentsPerAttribute:3,values:i})});return new La({attributes:c,indices:n,primitiveType:yn.LINES})}function um(e){var t=(e=Object(w.a)(e,w.a.EMPTY_OBJECT)).polygonHierarchy;x.a.defined("options.polygonHierarchy",t),this._polygonHierarchy=t,this._workerName="createCoplanarPolygonOutlineGeometry",this.packedLength=Vp.computeHierarchyPackedLength(t)+1}um.fromPositions=function(e){return e=Object(w.a)(e,w.a.EMPTY_OBJECT),x.a.defined("options.positions",e.positions),new um({polygonHierarchy:{positions:e.positions}})},um.pack=function(e,t,i){return x.a.typeOf.object("value",e),x.a.defined("array",t),i=Object(w.a)(i,0),t[i=Vp.packPolygonHierarchy(e._polygonHierarchy,t,i)]=e.packedLength,t};var hm={polygonHierarchy:{}};um.unpack=function(e,t,i){x.a.defined("array",e),t=Object(w.a)(t,0);var n=Vp.unpackPolygonHierarchy(e,t);t=n.startingIndex,delete n.startingIndex;var r=e[t];return Object(u.a)(i)||(i=new um(hm)),i._polygonHierarchy=n,i.packedLength=r,i},um.createGeometry=function(e){var t=e._polygonHierarchy,i=t.positions;if(!((i=$t(i,z.equalsEpsilon,!0)).length<3)&&xf.validOutline(i)){var n=Vp.polygonOutlinesFromHierarchy(t,!1);if(0!==n.length){for(var r=[],a=0;a<n.length;a++){var o=new Mu({geometry:lm(n[a])});r.push(o)}var s=id.combineInstances(r)[0],c=St.fromPoints(t.positions);return new La({attributes:s.attributes,indices:s.indices,primitiveType:s.primitiveType,boundingSphere:c})}}};var dm=um,fm=Object(E.a)({ROUNDED:0,MITERED:1,BEVELED:2});function pm(e,t,i,n,r,a,o){var s=function(e,t){return e*t*(4+e*(4-3*t))/16}(e,i);return(1-s)*e*t*(n+s*r*(o+s*a*(2*o*o-1)))}var mm=new z,_m=new z;function gm(e,t,i,n){var r=z.normalize(n.cartographicToCartesian(t,_m),mm),a=z.normalize(n.cartographicToCartesian(i,_m),_m);x.a.typeOf.number.greaterThanOrEquals("value",Math.abs(Math.abs(z.angleBetween(r,a))-Math.PI),.0125),function(e,t,i,n,r,a,o){var s,c,l,u,h,d=(t-i)/t,f=a-n,p=Math.atan((1-d)*Math.tan(r)),m=Math.atan((1-d)*Math.tan(o)),_=Math.cos(p),g=Math.sin(p),v=Math.cos(m),b=Math.sin(m),y=_*v,w=_*b,O=g*b,x=g*v,E=f,T=I.TWO_PI,C=Math.cos(E),S=Math.sin(E);do{C=Math.cos(E),S=Math.sin(E);var A,P=w-x*C;l=Math.sqrt(v*v*S*S+P*P),c=O+y*C,s=Math.atan2(l,c),0===l?(A=0,u=1):u=1-(A=y*S/l)*A,T=E,h=c-2*O/u,isNaN(h)&&(h=0),E=f+pm(d,A,u,s,l,c,h)}while(Math.abs(E-T)>I.EPSILON12);var D=u*(t*t-i*i)/(i*i),j=D*(256+D*(D*(74-47*D)-128))/1024,M=h*h,R=i*(1+D*(4096+D*(D*(320-175*D)-768))/16384)*(s-j*l*(h+j*(c*(2*M-1)-j*h*(4*l*l-3)*(4*M-3)/6)/4)),L=Math.atan2(v*S,w-x*C),N=Math.atan2(_*S,w*C-x);e._distance=R,e._startHeading=L,e._endHeading=N,e._uSquared=D}(e,n.maximumRadius,n.minimumRadius,t.longitude,t.latitude,i.longitude,i.latitude),e._start=K.clone(t,e._start),e._end=K.clone(i,e._end),e._start.height=0,e._end.height=0,function(e){var t=e._uSquared,i=e._ellipsoid.maximumRadius,n=e._ellipsoid.minimumRadius,r=(i-n)/i,a=Math.cos(e._startHeading),o=Math.sin(e._startHeading),s=(1-r)*Math.tan(e._start.latitude),c=1/Math.sqrt(1+s*s),l=c*s,u=Math.atan2(s,a),h=c*o,d=h*h,f=1-d,p=Math.sqrt(f),m=t/4,_=m*m,g=_*m,v=_*_,b=1+m-3*_/4+5*g/4-175*v/64,y=1-m+15*_/8-35*g/8,w=1-3*m+35*_/4,O=1-5*m,x=b*u-y*Math.sin(2*u)*m/2-w*Math.sin(4*u)*_/16-O*Math.sin(6*u)*g/48-5*Math.sin(8*u)*v/512,E=e._constants;E.a=i,E.b=n,E.f=r,E.cosineHeading=a,E.sineHeading=o,E.tanU=s,E.cosineU=c,E.sineU=l,E.sigma=u,E.sineAlpha=h,E.sineSquaredAlpha=d,E.cosineSquaredAlpha=f,E.cosineAlpha=p,E.u2Over4=m,E.u4Over16=_,E.u6Over64=g,E.u8Over256=v,E.a0=b,E.a1=y,E.a2=w,E.a3=O,E.distanceRatio=x}(e)}function vm(e,t,i){var n=Object(w.a)(i,ae.WGS84);this._ellipsoid=n,this._start=new K,this._end=new K,this._constants={},this._startHeading=void 0,this._endHeading=void 0,this._distance=void 0,this._uSquared=void 0,Object(u.a)(e)&&Object(u.a)(t)&&gm(this,e,t,n)}Object(O.a)(vm.prototype,{ellipsoid:{get:function(){return this._ellipsoid}},surfaceDistance:{get:function(){return x.a.defined("distance",this._distance),this._distance}},start:{get:function(){return this._start}},end:{get:function(){return this._end}},startHeading:{get:function(){return x.a.defined("distance",this._distance),this._startHeading}},endHeading:{get:function(){return x.a.defined("distance",this._distance),this._endHeading}}}),vm.prototype.setEndPoints=function(e,t){x.a.defined("start",e),x.a.defined("end",t),gm(this,e,t,this._ellipsoid)},vm.prototype.interpolateUsingFraction=function(e,t){return this.interpolateUsingSurfaceDistance(this._distance*e,t)},vm.prototype.interpolateUsingSurfaceDistance=function(e,t){x.a.defined("distance",this._distance);var i=this._constants,n=i.distanceRatio+e/i.b,r=Math.cos(2*n),a=Math.cos(4*n),o=Math.cos(6*n),s=Math.sin(2*n),c=Math.sin(4*n),l=Math.sin(6*n),h=Math.sin(8*n),d=n*n,f=n*d,p=i.u8Over256,m=i.u2Over4,_=i.u6Over64,g=i.u4Over16,v=2*f*p*r/3+n*(1-m+7*g/4-15*_/4+579*p/64-(g-15*_/4+187*p/16)*r-(5*_/4-115*p/16)*a-29*p*o/16)+(m/2-g+71*_/32-85*p/16)*s+(5*g/16-5*_/4+383*p/96)*c-d*((_-11*p/2)*s+5*p*c/2)+(29*_/96-29*p/16)*l+539*p*h/1536,b=Math.asin(Math.sin(v)*i.cosineAlpha),y=Math.atan(i.a/i.b*Math.tan(b));v-=i.sigma;var w=Math.cos(2*i.sigma+v),O=Math.sin(v),E=Math.cos(v),T=i.cosineU*E,C=i.sineU*O,S=Math.atan2(O*i.sineHeading,T-C*i.cosineHeading)-pm(i.f,i.sineAlpha,i.cosineSquaredAlpha,v,O,E,w);return Object(u.a)(t)?(t.longitude=this._start.longitude+S,t.latitude=y,t.height=0,t):new K(this._start.longitude+S,y,0)};var bm=vm,ym=n(13),wm={numberOfPoints:function(e,t,i){var n=z.distance(e,t);return Math.ceil(n/i)},numberOfPointsRhumbLine:function(e,t,i){var n=Math.pow(e.longitude-t.longitude,2)+Math.pow(e.latitude-t.latitude,2);return Math.ceil(Math.sqrt(n/(i*i)))}},Om=new K;wm.extractHeights=function(e,t){for(var i=e.length,n=new Array(i),r=0;r<i;r++){var a=e[r];n[r]=t.cartesianToCartographic(a,Om).height}return n};var xm=new Be,Em=new z,Tm=new z,Cm=new oc(z.UNIT_X,0),Sm=new z,Am=new oc(z.UNIT_X,0),Pm=new z,Im=new z,Dm=[];function jm(e,t,i){var n,r=Dm;if(r.length=e,t===i){for(n=0;n<e;n++)r[n]=t;return r}var a=(i-t)/e;for(n=0;n<e;n++){var o=t+n*a;r[n]=o}return r}var Mm=new K,Rm=new K,Lm=new z,Nm=new z,Fm=new z,km=new bm,Bm=new Df;function zm(e,t,i,n,r,a,o,s){var c=n.scaleToGeodeticSurface(e,Nm),l=n.scaleToGeodeticSurface(t,Fm),u=wm.numberOfPoints(e,t,i),h=n.cartesianToCartographic(c,Mm),d=n.cartesianToCartographic(l,Rm),f=jm(u,r,a);km.setEndPoints(h,d);var p=km.surfaceDistance/u,m=s;h.height=r;var _=n.cartographicToCartesian(h,Lm);z.pack(_,o,m),m+=3;for(var g=1;g<u;g++){var v=km.interpolateUsingSurfaceDistance(g*p,Rm);v.height=f[g],_=n.cartographicToCartesian(v,Lm),z.pack(_,o,m),m+=3}return m}function Um(e,t,i,n,r,a,o,s){var c=n.scaleToGeodeticSurface(e,Nm),l=n.scaleToGeodeticSurface(t,Fm),u=n.cartesianToCartographic(c,Mm),h=n.cartesianToCartographic(l,Rm),d=wm.numberOfPointsRhumbLine(u,h,i),f=jm(d,r,a);Bm.ellipsoid.equals(n)||(Bm=new Df(void 0,void 0,n)),Bm.setEndPoints(u,h);var p=Bm.surfaceDistance/d,m=s;u.height=r;var _=n.cartographicToCartesian(u,Lm);z.pack(_,o,m),m+=3;for(var g=1;g<d;g++){var v=Bm.interpolateUsingSurfaceDistance(g*p,Rm);v.height=f[g],_=n.cartographicToCartesian(v,Lm),z.pack(_,o,m),m+=3}return m}wm.wrapLongitude=function(e,t){var i=[],n=[];if(Object(u.a)(e)&&e.length>0){t=Object(w.a)(t,Be.IDENTITY);var r=Be.inverseTransformation(t,xm),a=Be.multiplyByPoint(r,z.ZERO,Em),o=z.normalize(Be.multiplyByPointAsVector(r,z.UNIT_Y,Tm),Tm),s=oc.fromPointNormal(a,o,Cm),c=z.normalize(Be.multiplyByPointAsVector(r,z.UNIT_X,Sm),Sm),l=oc.fromPointNormal(a,c,Am),h=1;i.push(z.clone(e[0]));for(var d=i[0],f=e.length,p=1;p<f;++p){var m=e[p];if(oc.getPointDistance(l,d)<0||oc.getPointDistance(l,m)<0){var _=tc.lineSegmentPlane(d,m,s,Pm);if(Object(u.a)(_)){var g=z.multiplyByScalar(o,5e-9,Im);oc.getPointDistance(s,d)<0&&z.negate(g,g),i.push(z.add(_,g,new z)),n.push(h+1),z.negate(g,g),i.push(z.add(_,g,new z)),h=1}}i.push(z.clone(e[p])),h++,d=m}n.push(h)}return{positions:i,lengths:n}},wm.generateArc=function(e){Object(u.a)(e)||(e={});var t=e.positions;if(!Object(u.a)(t))throw new h.a("options.positions is required.");var i=t.length,n=Object(w.a)(e.ellipsoid,ae.WGS84),r=Object(w.a)(e.height,0),a=Object(ym.a)(r);if(i<1)return[];if(1===i){var o=n.scaleToGeodeticSurface(t[0],Nm);if(0!==(r=a?r[0]:r)){var s=n.geodeticSurfaceNormal(o,Lm);z.multiplyByScalar(s,r,s),z.add(o,s,o)}return[o.x,o.y,o.z]}var c=e.minDistance;if(!Object(u.a)(c)){var l=Object(w.a)(e.granularity,I.RADIANS_PER_DEGREE);c=I.chordLength(l,n.maximumRadius)}var d,f=0;for(d=0;d<i-1;d++)f+=wm.numberOfPoints(t[d],t[d+1],c);var p=3*(f+1),m=new Array(p),_=0;for(d=0;d<i-1;d++){_=zm(t[d],t[d+1],c,n,a?r[d]:r,a?r[d+1]:r,m,_)}Dm.length=0;var g=t[i-1],v=n.cartesianToCartographic(g,Mm);v.height=a?r[i-1]:r;var b=n.cartographicToCartesian(v,Lm);return z.pack(b,m,p-3),m};var Vm=new K,Hm=new K;wm.generateRhumbArc=function(e){Object(u.a)(e)||(e={});var t=e.positions;if(!Object(u.a)(t))throw new h.a("options.positions is required.");var i=t.length,n=Object(w.a)(e.ellipsoid,ae.WGS84),r=Object(w.a)(e.height,0),a=Object(ym.a)(r);if(i<1)return[];if(1===i){var o=n.scaleToGeodeticSurface(t[0],Nm);if(0!==(r=a?r[0]:r)){var s=n.geodeticSurfaceNormal(o,Lm);z.multiplyByScalar(s,r,s),z.add(o,s,o)}return[o.x,o.y,o.z]}var c,l,d=Object(w.a)(e.granularity,I.RADIANS_PER_DEGREE),f=0,p=n.cartesianToCartographic(t[0],Vm);for(c=0;c<i-1;c++)l=n.cartesianToCartographic(t[c+1],Hm),f+=wm.numberOfPointsRhumbLine(p,l,d),p=K.clone(l,Vm);var m=3*(f+1),_=new Array(m),g=0;for(c=0;c<i-1;c++){g=Um(t[c],t[c+1],d,n,a?r[c]:r,a?r[c+1]:r,_,g)}Dm.length=0;var v=t[i-1],b=n.cartesianToCartographic(v,Mm);b.height=a?r[i-1]:r;var y=n.cartographicToCartesian(b,Lm);return z.pack(y,_,m-3),_},wm.generateCartesianArc=function(e){for(var t=wm.generateArc(e),i=t.length/3,n=new Array(i),r=0;r<i;r++)n[r]=z.unpack(t,3*r);return n},wm.generateCartesianRhumbArc=function(e){for(var t=wm.generateRhumbArc(e),i=t.length/3,n=new Array(i),r=0;r<i;r++)n[r]=z.unpack(t,3*r);return n};var Gm=wm,qm=[new z,new z],Wm=new z,Ym=new z,Xm=new z,Zm=new z,Qm=new z,Km=new z,Jm=new z,$m=new z,e_=new z,t_=new z,i_=new z,n_={},r_=new K;function a_(e,t,i,n){var r,a=e[0],o=e[1],s=z.angleBetween(a,o),c=Math.ceil(s/n),l=new Array(c);if(t===i){for(r=0;r<c;r++)l[r]=t;return l.push(i),l}var u=(i-t)/c;for(r=1;r<c;r++){var h=t+r*u;l[r]=h}return l[0]=t,l.push(i),l}var o_=new z,s_=new z;var c_=new z(-1,0,0),l_=new Be,u_=new Be,h_=new be,d_=be.IDENTITY.clone(),f_=new z,p_=new Te,m_=new z;function __(e,t,i,n,r,a,o,s){var c=f_,l=p_;l_=xa.eastNorthUpToFixedFrame(e,r,l_),c=Be.multiplyByPointAsVector(l_,c_,c);var u=function(e,t,i,n){var r=new fc(i,n),a=r.projectPointOntoPlane(z.add(i,e,o_),o_),o=r.projectPointOntoPlane(z.add(i,t,s_),s_),s=Rt.angleBetween(a,o);return o.x*a.y-o.y*a.x>=0?-s:s}(c=z.normalize(c,c),t,e,r);h_=be.fromRotationZ(u,h_),m_.z=a,l_=Be.multiplyTransformation(l_,Be.fromRotationTranslation(h_,m_,u_),l_);var h=d_;h[0]=o;for(var d=0;d<s;d++)for(var f=0;f<i.length;f+=3)l=z.fromArray(i,f,l),l=be.multiplyByVector(h,l,l),l=Be.multiplyByPoint(l_,l,l),n.push(l.x,l.y,l.z);return n}var g_=new z;function v_(e,t,i,n,r,a,o){for(var s=0;s<e.length;s+=3){n=__(z.fromArray(e,s,g_),t,i,n,r,a[s/3],o,1)}return n}function b_(e,t){for(var i=e.length,n=new Array(3*i),r=0,a=t.x+t.width/2,o=t.y+t.height/2,s=0;s<i;s++)n[r++]=e[s].x-a,n[r++]=0,n[r++]=e[s].y-o;return n}var y_=new Kn,w_=new z,O_=new be;function x_(e,t,i,n,r,a,o,s,c,l){var u,h,d=z.angleBetween(z.subtract(t,e,t_),z.subtract(i,e,i_)),f=n===fm.BEVELED?0:Math.ceil(d/I.toRadians(5));if(u=r?be.fromQuaternion(Kn.fromAxisAngle(z.negate(e,t_),d/(f+1),y_),O_):be.fromQuaternion(Kn.fromAxisAngle(e,d/(f+1),y_),O_),t=z.clone(t,w_),f>0)for(var p=l?2:1,m=0;m<f;m++)t=be.multiplyByVector(u,t,t),h=z.subtract(t,e,t_),h=z.normalize(h,h),r||(h=z.negate(h,h)),o=__(a.scaleToGeodeticSurface(t,i_),h,s,o,a,c,1,p);else h=z.subtract(t,e,t_),h=z.normalize(h,h),r||(h=z.negate(h,h)),o=__(a.scaleToGeodeticSurface(t,i_),h,s,o,a,c,1,1),i=z.clone(i,w_),h=z.subtract(i,e,t_),h=z.normalize(h,h),r||(h=z.negate(h,h)),o=__(a.scaleToGeodeticSurface(i,i_),h,s,o,a,c,1,1);return o}n_.removeDuplicatesFromShape=function(e){for(var t=e.length,i=[],n=t-1,r=0;r<t;n=r++){var a=e[n],o=e[r];Rt.equals(a,o)||i.push(o)}return i},n_.angleIsGreaterThanPi=function(e,t,i,n){var r=new fc(i,n),a=r.projectPointOntoPlane(z.add(i,e,o_),o_),o=r.projectPointOntoPlane(z.add(i,t,s_),s_);return o.x*a.y-o.y*a.x>=0};var E_=new z,T_=new z;n_.computePositions=function(e,t,i,n,r){var a=n._ellipsoid,o=function(e,t){for(var i=new Array(e.length),n=0;n<e.length;n++){var r=e[n];r_=t.cartesianToCartographic(r,r_),i[n]=r_.height,e[n]=t.scaleToGeodeticSurface(r,r)}return i}(e,a),s=n._granularity,c=n._cornerType,l=r?function(e,t){var i=e.length,n=new Array(6*i),r=0,a=t.x+t.width/2,o=t.y+t.height/2,s=e[0];n[r++]=s.x-a,n[r++]=0,n[r++]=s.y-o;for(var c=1;c<i;c++){var l=(s=e[c]).x-a,u=s.y-o;n[r++]=l,n[r++]=0,n[r++]=u,n[r++]=l,n[r++]=0,n[r++]=u}return s=e[0],n[r++]=s.x-a,n[r++]=0,n[r++]=s.y-o,n}(t,i):b_(t,i),u=r?b_(t,i):void 0,h=i.height/2,d=i.width/2,f=e.length,p=[],m=r?[]:void 0,_=Wm,g=Ym,v=Xm,b=Zm,y=Qm,w=Km,O=Jm,x=$m,E=e_,T=e[0],C=e[1];b=a.geodeticSurfaceNormal(T,b),_=z.subtract(C,T,_),_=z.normalize(_,_),x=z.cross(b,_,x),x=z.normalize(x,x);var S,A=o[0],P=o[1];r&&(m=__(T,x,u,m,a,A+h,1,1)),E=z.clone(T,E),T=C,g=z.negate(_,g);for(var D=1;D<f-1;D++){var j=r?2:1;C=e[D+1],_=z.subtract(C,T,_),_=z.normalize(_,_),v=z.add(_,g,v),v=z.normalize(v,v),b=a.geodeticSurfaceNormal(T,b);var M=z.multiplyByScalar(b,z.dot(_,b),E_);z.subtract(_,M,M),z.normalize(M,M);var R=z.multiplyByScalar(b,z.dot(g,b),T_);if(z.subtract(g,R,R),z.normalize(R,R),!I.equalsEpsilon(Math.abs(z.dot(M,R)),1,I.EPSILON7)){v=z.cross(v,b,v),v=z.cross(b,v,v),v=z.normalize(v,v);var L=1/Math.max(.25,z.magnitude(z.cross(v,g,t_))),N=n_.angleIsGreaterThanPi(_,g,T,a);N?(y=z.add(T,z.multiplyByScalar(v,L*d,v),y),w=z.add(y,z.multiplyByScalar(x,d,w),w),qm[0]=z.clone(E,qm[0]),qm[1]=z.clone(w,qm[1]),S=a_(qm,A+h,P+h,s),p=v_(Gm.generateArc({positions:qm,granularity:s,ellipsoid:a}),x,l,p,a,S,1),x=z.cross(b,_,x),x=z.normalize(x,x),O=z.add(y,z.multiplyByScalar(x,d,O),O),c===fm.ROUNDED||c===fm.BEVELED?x_(y,w,O,c,N,a,p,l,P+h,r):p=__(T,v=z.negate(v,v),l,p,a,P+h,L,j),E=z.clone(O,E)):(y=z.add(T,z.multiplyByScalar(v,L*d,v),y),w=z.add(y,z.multiplyByScalar(x,-d,w),w),qm[0]=z.clone(E,qm[0]),qm[1]=z.clone(w,qm[1]),S=a_(qm,A+h,P+h,s),p=v_(Gm.generateArc({positions:qm,granularity:s,ellipsoid:a}),x,l,p,a,S,1),x=z.cross(b,_,x),x=z.normalize(x,x),O=z.add(y,z.multiplyByScalar(x,-d,O),O),c===fm.ROUNDED||c===fm.BEVELED?x_(y,w,O,c,N,a,p,l,P+h,r):p=__(T,v,l,p,a,P+h,L,j),E=z.clone(O,E)),g=z.negate(_,g)}else p=__(E,x,l,p,a,A+h,1,1),E=T;A=P,P=o[D+1],T=C}qm[0]=z.clone(E,qm[0]),qm[1]=z.clone(T,qm[1]),S=a_(qm,A+h,P+h,s),p=v_(Gm.generateArc({positions:qm,granularity:s,ellipsoid:a}),x,l,p,a,S,1),r&&(m=__(T,x,u,m,a,P+h,1,1)),f=p.length;var F=r?f+m.length:f,k=new Float64Array(F);return k.set(p),r&&k.set(m,f),k};var C_=n_,S_={},A_=new z,P_=new z,I_=new z,D_=new z,j_=[new z,new z],M_=new z,R_=new z,L_=new z,N_=new z,F_=new z,k_=new z,B_=new z,z_=new z,U_=new z,V_=new z,H_=new Kn,G_=new be;function q_(e,t,i,n,r){var a,o=z.angleBetween(z.subtract(t,e,A_),z.subtract(i,e,P_)),s=n===fm.BEVELED?1:Math.ceil(o/I.toRadians(5))+1,c=3*s,l=new Array(c);l[c-3]=i.x,l[c-2]=i.y,l[c-1]=i.z,a=r?be.fromQuaternion(Kn.fromAxisAngle(z.negate(e,A_),o/s,H_),G_):be.fromQuaternion(Kn.fromAxisAngle(e,o/s,H_),G_);var u=0;t=z.clone(t,A_);for(var h=0;h<s;h++)t=be.multiplyByVector(a,t,t),l[u++]=t.x,l[u++]=t.y,l[u++]=t.z;return l}function W_(e,t,i,n){var r=A_;return n?r=z.add(e,t,r):(t=z.negate(t,t),r=z.add(e,t,r)),[r.x,r.y,r.z,i.x,i.y,i.z]}function Y_(e,t,i,n){for(var r=new Array(e.length),a=new Array(e.length),o=z.multiplyByScalar(t,i,A_),s=z.negate(o,P_),c=0,l=e.length-1,u=0;u<e.length;u+=3){var h=z.fromArray(e,u,I_),d=z.add(h,s,D_);r[c++]=d.x,r[c++]=d.y,r[c++]=d.z;var f=z.add(h,o,D_);a[l--]=f.z,a[l--]=f.y,a[l--]=f.x}return n.push(r,a),n}S_.addAttribute=function(e,t,i,n){var r=t.x,a=t.y,o=t.z;Object(u.a)(i)&&(e[i]=r,e[i+1]=a,e[i+2]=o),Object(u.a)(n)&&(e[n]=o,e[n-1]=a,e[n-2]=r)};var X_=new z,Z_=new z;S_.computePositions=function(e){var t=e.granularity,i=e.positions,n=e.ellipsoid,r=e.width/2,a=e.cornerType,o=e.saveAttributes,s=M_,c=R_,l=L_,u=N_,h=F_,d=k_,f=B_,p=z_,m=U_,_=V_,g=[],v=o?[]:void 0,b=o?[]:void 0,y=i[0],w=i[1];c=z.normalize(z.subtract(w,y,c),c),s=n.geodeticSurfaceNormal(y,s),u=z.normalize(z.cross(s,c,u),u),o&&(v.push(u.x,u.y,u.z),b.push(s.x,s.y,s.z)),f=z.clone(y,f),y=w,l=z.negate(c,l);var O,x,E=[],T=i.length;for(O=1;O<T-1;O++){s=n.geodeticSurfaceNormal(y,s),w=i[O+1],c=z.normalize(z.subtract(w,y,c),c),h=z.normalize(z.add(c,l,h),h);var C=z.multiplyByScalar(s,z.dot(c,s),X_);z.subtract(c,C,C),z.normalize(C,C);var S=z.multiplyByScalar(s,z.dot(l,s),Z_);if(z.subtract(l,S,S),z.normalize(S,S),!I.equalsEpsilon(Math.abs(z.dot(C,S)),1,I.EPSILON7)){h=z.cross(h,s,h),h=z.cross(s,h,h),h=z.normalize(h,h);var A=r/Math.max(.25,z.magnitude(z.cross(h,l,A_))),P=C_.angleIsGreaterThanPi(c,l,y,n);h=z.multiplyByScalar(h,A,h),P?(p=z.add(y,h,p),_=z.add(p,z.multiplyByScalar(u,r,_),_),m=z.add(p,z.multiplyByScalar(u,2*r,m),m),j_[0]=z.clone(f,j_[0]),j_[1]=z.clone(_,j_[1]),g=Y_(Gm.generateArc({positions:j_,granularity:t,ellipsoid:n}),u,r,g),o&&(v.push(u.x,u.y,u.z),b.push(s.x,s.y,s.z)),d=z.clone(m,d),u=z.normalize(z.cross(s,c,u),u),m=z.add(p,z.multiplyByScalar(u,2*r,m),m),f=z.add(p,z.multiplyByScalar(u,r,f),f),a===fm.ROUNDED||a===fm.BEVELED?E.push({leftPositions:q_(p,d,m,a,P)}):E.push({leftPositions:W_(y,z.negate(h,h),m,P)})):(m=z.add(y,h,m),_=z.add(m,z.negate(z.multiplyByScalar(u,r,_),_),_),p=z.add(m,z.negate(z.multiplyByScalar(u,2*r,p),p),p),j_[0]=z.clone(f,j_[0]),j_[1]=z.clone(_,j_[1]),g=Y_(Gm.generateArc({positions:j_,granularity:t,ellipsoid:n}),u,r,g),o&&(v.push(u.x,u.y,u.z),b.push(s.x,s.y,s.z)),d=z.clone(p,d),u=z.normalize(z.cross(s,c,u),u),p=z.add(m,z.negate(z.multiplyByScalar(u,2*r,p),p),p),f=z.add(m,z.negate(z.multiplyByScalar(u,r,f),f),f),a===fm.ROUNDED||a===fm.BEVELED?E.push({rightPositions:q_(m,d,p,a,P)}):E.push({rightPositions:W_(y,h,p,P)})),l=z.negate(c,l)}y=w}return s=n.geodeticSurfaceNormal(y,s),j_[0]=z.clone(f,j_[0]),j_[1]=z.clone(y,j_[1]),g=Y_(Gm.generateArc({positions:j_,granularity:t,ellipsoid:n}),u,r,g),o&&(v.push(u.x,u.y,u.z),b.push(s.x,s.y,s.z)),a===fm.ROUNDED&&(x=function(e){var t=M_,i=R_,n=L_,r=e[1];i=z.fromArray(e[1],r.length-3,i),n=z.fromArray(e[0],0,n);var a=q_(t=z.midpoint(i,n,t),i,n,fm.ROUNDED,!1),o=e.length-1,s=e[o-1];return r=e[o],i=z.fromArray(s,s.length-3,i),n=z.fromArray(r,0,n),[a,q_(t=z.midpoint(i,n,t),i,n,fm.ROUNDED,!1)]}(g)),{positions:g,corners:E,lefts:v,normals:b,endPositions:x}};var Q_=S_,K_=new z,J_=new z,$_=new z,eg=new z,tg=new z,ig=new z,ng=new z,rg=new z;function ag(e,t){for(var i=0;i<e.length;i++)e[i]=t.scaleToGeodeticSurface(e[i],e[i]);return e}function og(e,t,i,n,r,a){var o=e.normals,s=e.tangents,c=e.bitangents,l=z.normalize(z.cross(i,t,ng),ng);a.normal&&Q_.addAttribute(o,t,n,r),a.tangent&&Q_.addAttribute(s,l,n,r),a.bitangent&&Q_.addAttribute(c,i,n,r)}function sg(e,t,i){var n,r,a,o=e.positions,s=e.corners,c=e.endPositions,l=e.lefts,h=e.normals,d=new Fa,f=0,p=0,m=0;for(r=0;r<o.length;r+=2)f+=a=o[r].length-3,m+=2*a,p+=o[r+1].length-3;for(f+=3,p+=3,r=0;r<s.length;r++){n=s[r];var _=s[r].leftPositions;Object(u.a)(_)?(f+=a=_.length,m+=a):(p+=a=s[r].rightPositions.length,m+=a)}var g,v=Object(u.a)(c);v&&(f+=g=c[0].length-3,p+=g,m+=6*(g/=3));var b,y,w,O,x,E,T=f+p,C=new Float64Array(T),S={normals:t.normal?new Float32Array(T):void 0,tangents:t.tangent?new Float32Array(T):void 0,bitangents:t.bitangent?new Float32Array(T):void 0},A=0,P=T-1,D=K_,j=J_,M=g/2,R=Sl.createTypedArray(T/3,m),L=0;if(v){E=$_,x=eg;var N=c[0];for(D=z.fromArray(h,0,D),j=z.fromArray(l,0,j),r=0;r<M;r++)E=z.fromArray(N,3*(M-1-r),E),x=z.fromArray(N,3*(M+r),x),Q_.addAttribute(C,x,A),Q_.addAttribute(C,E,void 0,P),og(S,D,j,A,P,t),O=(y=A/3)+1,w=(b=(P-2)/3)-1,R[L++]=b,R[L++]=y,R[L++]=w,R[L++]=w,R[L++]=y,R[L++]=O,A+=3,P-=3}var F,k,B=0,U=0,V=o[B++],H=o[B++];for(C.set(V,A),C.set(H,P-H.length+1),j=z.fromArray(l,U,j),a=H.length-3,r=0;r<a;r+=3)F=i.geodeticSurfaceNormal(z.fromArray(V,r,ng),ng),k=i.geodeticSurfaceNormal(z.fromArray(H,a-r,rg),rg),og(S,D=z.normalize(z.add(F,k,D),D),j,A,P,t),O=(y=A/3)+1,w=(b=(P-2)/3)-1,R[L++]=b,R[L++]=y,R[L++]=w,R[L++]=w,R[L++]=y,R[L++]=O,A+=3,P-=3;for(F=i.geodeticSurfaceNormal(z.fromArray(V,a,ng),ng),k=i.geodeticSurfaceNormal(z.fromArray(H,a,rg),rg),D=z.normalize(z.add(F,k,D),D),U+=3,r=0;r<s.length;r++){var G,q,W,Y=(n=s[r]).leftPositions,X=n.rightPositions,Z=ig,Q=$_,K=eg;if(D=z.fromArray(h,U,D),Object(u.a)(Y)){for(og(S,D,j,void 0,P,t),P-=3,q=O,W=w,G=0;G<Y.length/3;G++)Z=z.fromArray(Y,3*G,Z),R[L++]=q,R[L++]=W-G-1,R[L++]=W-G,Q_.addAttribute(C,Z,void 0,P),Q=z.fromArray(C,3*(W-G-1),Q),K=z.fromArray(C,3*q,K),og(S,D,j=z.normalize(z.subtract(Q,K,j),j),void 0,P,t),P-=3;Z=z.fromArray(C,3*q,Z),Q=z.subtract(z.fromArray(C,3*W,Q),Z,Q),K=z.subtract(z.fromArray(C,3*(W-G),K),Z,K),og(S,D,j=z.normalize(z.add(Q,K,j),j),A,void 0,t),A+=3}else{for(og(S,D,j,A,void 0,t),A+=3,q=w,W=O,G=0;G<X.length/3;G++)Z=z.fromArray(X,3*G,Z),R[L++]=q,R[L++]=W+G,R[L++]=W+G+1,Q_.addAttribute(C,Z,A),Q=z.fromArray(C,3*q,Q),K=z.fromArray(C,3*(W+G),K),og(S,D,j=z.normalize(z.subtract(Q,K,j),j),A,void 0,t),A+=3;Z=z.fromArray(C,3*q,Z),Q=z.subtract(z.fromArray(C,3*(W+G),Q),Z,Q),K=z.subtract(z.fromArray(C,3*W,K),Z,K),og(S,D,j=z.normalize(z.negate(z.add(K,Q,j),j),j),void 0,P,t),P-=3}for(V=o[B++],H=o[B++],V.splice(0,3),H.splice(H.length-3,3),C.set(V,A),C.set(H,P-H.length+1),a=H.length-3,U+=3,j=z.fromArray(l,U,j),G=0;G<H.length;G+=3)F=i.geodeticSurfaceNormal(z.fromArray(V,G,ng),ng),k=i.geodeticSurfaceNormal(z.fromArray(H,a-G,rg),rg),og(S,D=z.normalize(z.add(F,k,D),D),j,A,P,t),y=(O=A/3)-1,b=(w=(P-2)/3)+1,R[L++]=b,R[L++]=y,R[L++]=w,R[L++]=w,R[L++]=y,R[L++]=O,A+=3,P-=3;A-=3,P+=3}if(og(S,D=z.fromArray(h,h.length-3,D),j,A,P,t),v){A+=3,P-=3,E=$_,x=eg;var J=c[1];for(r=0;r<M;r++)E=z.fromArray(J,3*(g-r-1),E),x=z.fromArray(J,3*r,x),Q_.addAttribute(C,E,void 0,P),Q_.addAttribute(C,x,A),og(S,D,j,A,P,t),y=(O=A/3)-1,b=(w=(P-2)/3)+1,R[L++]=b,R[L++]=y,R[L++]=w,R[L++]=w,R[L++]=y,R[L++]=O,A+=3,P-=3}if(d.position=new Na({componentDatatype:dn.DOUBLE,componentsPerAttribute:3,values:C}),t.st){var $,ee,te=new Float32Array(T/3*2),ie=0;if(v){f/=3,p/=3;var ne,re=Math.PI/(g+1);ee=1/(f-g+1),$=1/(p-g+1);var ae=g/2;for(r=ae+1;r<g+1;r++)ne=I.PI_OVER_TWO+re*r,te[ie++]=$*(1+Math.cos(ne)),te[ie++]=.5*(1+Math.sin(ne));for(r=1;r<p-g+1;r++)te[ie++]=r*$,te[ie++]=0;for(r=g;r>ae;r--)ne=I.PI_OVER_TWO-r*re,te[ie++]=1-$*(1+Math.cos(ne)),te[ie++]=.5*(1+Math.sin(ne));for(r=ae;r>0;r--)ne=I.PI_OVER_TWO-re*r,te[ie++]=1-ee*(1+Math.cos(ne)),te[ie++]=.5*(1+Math.sin(ne));for(r=f-g;r>0;r--)te[ie++]=r*ee,te[ie++]=1;for(r=1;r<ae+1;r++)ne=I.PI_OVER_TWO+re*r,te[ie++]=ee*(1+Math.cos(ne)),te[ie++]=.5*(1+Math.sin(ne))}else{for(ee=1/((f/=3)-1),$=1/((p/=3)-1),r=0;r<p;r++)te[ie++]=r*$,te[ie++]=0;for(r=f;r>0;r--)te[ie++]=(r-1)*ee,te[ie++]=1}d.st=new Na({componentDatatype:dn.FLOAT,componentsPerAttribute:2,values:te})}return t.normal&&(d.normal=new Na({componentDatatype:dn.FLOAT,componentsPerAttribute:3,values:S.normals})),t.tangent&&(d.tangent=new Na({componentDatatype:dn.FLOAT,componentsPerAttribute:3,values:S.tangents})),t.bitangent&&(d.bitangent=new Na({componentDatatype:dn.FLOAT,componentsPerAttribute:3,values:S.bitangents})),{attributes:d,indices:R}}function cg(e,t,i){i[t++]=e[0],i[t++]=e[1],i[t++]=e[2];for(var n=3;n<e.length;n+=3){var r=e[n],a=e[n+1],o=e[n+2];i[t++]=r,i[t++]=a,i[t++]=o,i[t++]=r,i[t++]=a,i[t++]=o}return i[t++]=e[0],i[t++]=e[1],i[t++]=e[2],i}function lg(e,t){var i=new Ba({position:t.position,normal:t.normal||t.bitangent||e.shadowVolume,tangent:t.tangent,bitangent:t.normal||t.bitangent,st:t.st}),n=e.ellipsoid,r=sg(Q_.computePositions(e),i,n),a=e.height,o=e.extrudedHeight,s=r.attributes,c=r.indices,l=s.position.values,h=l.length,d=new Float64Array(6*h),f=new Float64Array(h);f.set(l);var p,m=new Float64Array(4*h);m=cg(l=wp.scaleToGeodeticHeight(l,a,n),0,m),m=cg(f=wp.scaleToGeodeticHeight(f,o,n),2*h,m),d.set(l),d.set(f,h),d.set(m,2*h),s.position.values=d,s=function(e,t){if(!(t.normal||t.tangent||t.bitangent||t.st))return e;var i,n,r=e.position.values;(t.normal||t.bitangent)&&(i=e.normal.values,n=e.bitangent.values);var a,o=e.position.values.length/18,s=3*o,c=2*o,l=2*s;if(t.normal||t.bitangent||t.tangent){var u=t.normal?new Float32Array(6*s):void 0,h=t.tangent?new Float32Array(6*s):void 0,d=t.bitangent?new Float32Array(6*s):void 0,f=K_,p=J_,m=$_,_=eg,g=tg,v=ig,b=l;for(a=0;a<s;a+=3){var y=b+l;f=z.fromArray(r,a,f),p=z.fromArray(r,a+s,p),m=z.fromArray(r,(a+3)%s,m),p=z.subtract(p,f,p),m=z.subtract(m,f,m),_=z.normalize(z.cross(p,m,_),_),t.normal&&(Q_.addAttribute(u,_,y),Q_.addAttribute(u,_,y+3),Q_.addAttribute(u,_,b),Q_.addAttribute(u,_,b+3)),(t.tangent||t.bitangent)&&(v=z.fromArray(i,a,v),t.bitangent&&(Q_.addAttribute(d,v,y),Q_.addAttribute(d,v,y+3),Q_.addAttribute(d,v,b),Q_.addAttribute(d,v,b+3)),t.tangent&&(g=z.normalize(z.cross(v,_,g),g),Q_.addAttribute(h,g,y),Q_.addAttribute(h,g,y+3),Q_.addAttribute(h,g,b),Q_.addAttribute(h,g,b+3))),b+=6}if(t.normal){for(u.set(i),a=0;a<s;a+=3)u[a+s]=-i[a],u[a+s+1]=-i[a+1],u[a+s+2]=-i[a+2];e.normal.values=u}else e.normal=void 0;if(t.bitangent?(d.set(n),d.set(n,s),e.bitangent.values=d):e.bitangent=void 0,t.tangent){var w=e.tangent.values;h.set(w),h.set(w,s),e.tangent.values=h}}if(t.st){var O=e.st.values,x=new Float32Array(6*c);x.set(O),x.set(O,c);for(var E=2*c,T=0;T<2;T++){for(x[E++]=O[0],x[E++]=O[1],a=2;a<c;a+=2){var C=O[a],S=O[a+1];x[E++]=C,x[E++]=S,x[E++]=C,x[E++]=S}x[E++]=O[0],x[E++]=O[1]}e.st.values=x}return e}(s,t);var _=h/3;if(e.shadowVolume){var g=s.normal.values;h=g.length;var v=new Float32Array(6*h);for(p=0;p<h;p++)g[p]=-g[p];v.set(g,h),v=cg(g,4*h,v),s.extrudeDirection=new Na({componentDatatype:dn.FLOAT,componentsPerAttribute:3,values:v}),t.normal||(s.normal=void 0)}if(Object(u.a)(e.offsetAttribute)){var b=new Uint8Array(6*_);if(e.offsetAttribute===fn.TOP)b=Qt(b,1,0,_),b=Qt(b,1,2*_,4*_);else{var y=e.offsetAttribute===fn.NONE?0:1;b=Qt(b,y)}s.applyOffset=new Na({componentDatatype:dn.UNSIGNED_BYTE,componentsPerAttribute:1,values:b})}var w=c.length,O=_+_,x=Sl.createTypedArray(d.length/3,2*w+3*O);x.set(c);var E,T,C,S,A=w;for(p=0;p<w;p+=3){var P=c[p],I=c[p+1],D=c[p+2];x[A++]=D+_,x[A++]=I+_,x[A++]=P+_}for(p=0;p<O;p+=2)C=(E=p+O)+1,S=(T=E+O)+1,x[A++]=E,x[A++]=T,x[A++]=C,x[A++]=C,x[A++]=T,x[A++]=S;return{attributes:s,indices:x}}var ug=new z,hg=new z,dg=new K;function fg(e,t,i,n,r,a){var o=z.subtract(t,e,ug);z.normalize(o,o);var s=i.geodeticSurfaceNormal(e,hg),c=z.cross(o,s,ug);z.multiplyByScalar(c,n,c);var l=r.latitude,u=r.longitude,h=a.latitude,d=a.longitude;z.add(e,c,hg),i.cartesianToCartographic(hg,dg);var f=dg.latitude,p=dg.longitude;l=Math.min(l,f),u=Math.min(u,p),h=Math.max(h,f),d=Math.max(d,p),z.subtract(e,c,hg),i.cartesianToCartographic(hg,dg),f=dg.latitude,p=dg.longitude,l=Math.min(l,f),u=Math.min(u,p),h=Math.max(h,f),d=Math.max(d,p),r.latitude=l,r.longitude=u,a.latitude=h,a.longitude=d}var pg=new z,mg=new z,_g=new K,gg=new K;function vg(e,t,i,n,r){e=ag(e,t);var a=$t(e,z.equalsEpsilon),o=a.length;if(o<2||i<=0)return new Ve;var s,c,l=.5*i;if(_g.latitude=Number.POSITIVE_INFINITY,_g.longitude=Number.POSITIVE_INFINITY,gg.latitude=Number.NEGATIVE_INFINITY,gg.longitude=Number.NEGATIVE_INFINITY,n===fm.ROUNDED){var h=a[0];z.subtract(h,a[1],pg),z.normalize(pg,pg),z.multiplyByScalar(pg,l,pg),z.add(h,pg,mg),t.cartesianToCartographic(mg,dg),s=dg.latitude,c=dg.longitude,_g.latitude=Math.min(_g.latitude,s),_g.longitude=Math.min(_g.longitude,c),gg.latitude=Math.max(gg.latitude,s),gg.longitude=Math.max(gg.longitude,c)}for(var d=0;d<o-1;++d)fg(a[d],a[d+1],t,l,_g,gg);var f=a[o-1];z.subtract(f,a[o-2],pg),z.normalize(pg,pg),z.multiplyByScalar(pg,l,pg),z.add(f,pg,mg),fg(f,mg,t,l,_g,gg),n===fm.ROUNDED&&(t.cartesianToCartographic(mg,dg),s=dg.latitude,c=dg.longitude,_g.latitude=Math.min(_g.latitude,s),_g.longitude=Math.min(_g.longitude,c),gg.latitude=Math.max(gg.latitude,s),gg.longitude=Math.max(gg.longitude,c));var p=Object(u.a)(r)?r:new Ve;return p.north=gg.latitude,p.south=_g.latitude,p.east=gg.longitude,p.west=_g.longitude,p}function bg(e){var t=(e=Object(w.a)(e,w.a.EMPTY_OBJECT)).positions,i=e.width;x.a.defined("options.positions",t),x.a.defined("options.width",i);var n=Object(w.a)(e.height,0),r=Object(w.a)(e.extrudedHeight,n);this._positions=t,this._ellipsoid=ae.clone(Object(w.a)(e.ellipsoid,ae.WGS84)),this._vertexFormat=Ba.clone(Object(w.a)(e.vertexFormat,Ba.DEFAULT)),this._width=i,this._height=Math.max(n,r),this._extrudedHeight=Math.min(n,r),this._cornerType=Object(w.a)(e.cornerType,fm.ROUNDED),this._granularity=Object(w.a)(e.granularity,I.RADIANS_PER_DEGREE),this._shadowVolume=Object(w.a)(e.shadowVolume,!1),this._workerName="createCorridorGeometry",this._offsetAttribute=e.offsetAttribute,this._rectangle=void 0,this.packedLength=1+t.length*z.packedLength+ae.packedLength+Ba.packedLength+7}bg.pack=function(e,t,i){x.a.defined("value",e),x.a.defined("array",t),i=Object(w.a)(i,0);var n=e._positions,r=n.length;t[i++]=r;for(var a=0;a<r;++a,i+=z.packedLength)z.pack(n[a],t,i);return ae.pack(e._ellipsoid,t,i),i+=ae.packedLength,Ba.pack(e._vertexFormat,t,i),i+=Ba.packedLength,t[i++]=e._width,t[i++]=e._height,t[i++]=e._extrudedHeight,t[i++]=e._cornerType,t[i++]=e._granularity,t[i++]=e._shadowVolume?1:0,t[i]=Object(w.a)(e._offsetAttribute,-1),t};var yg=ae.clone(ae.UNIT_SPHERE),wg=new Ba,Og={positions:void 0,ellipsoid:yg,vertexFormat:wg,width:void 0,height:void 0,extrudedHeight:void 0,cornerType:void 0,granularity:void 0,shadowVolume:void 0,offsetAttribute:void 0};bg.unpack=function(e,t,i){x.a.defined("array",e),t=Object(w.a)(t,0);for(var n=e[t++],r=new Array(n),a=0;a<n;++a,t+=z.packedLength)r[a]=z.unpack(e,t);var o=ae.unpack(e,t,yg);t+=ae.packedLength;var s=Ba.unpack(e,t,wg);t+=Ba.packedLength;var c=e[t++],l=e[t++],h=e[t++],d=e[t++],f=e[t++],p=1===e[t++],m=e[t];return Object(u.a)(i)?(i._positions=r,i._ellipsoid=ae.clone(o,i._ellipsoid),i._vertexFormat=Ba.clone(s,i._vertexFormat),i._width=c,i._height=l,i._extrudedHeight=h,i._cornerType=d,i._granularity=f,i._shadowVolume=p,i._offsetAttribute=-1===m?void 0:m,i):(Og.positions=r,Og.width=c,Og.height=l,Og.extrudedHeight=h,Og.cornerType=d,Og.granularity=f,Og.shadowVolume=p,Og.offsetAttribute=-1===m?void 0:m,new bg(Og))},bg.computeRectangle=function(e,t){var i=(e=Object(w.a)(e,w.a.EMPTY_OBJECT)).positions,n=e.width;return x.a.defined("options.positions",i),x.a.defined("options.width",n),vg(i,Object(w.a)(e.ellipsoid,ae.WGS84),n,Object(w.a)(e.cornerType,fm.ROUNDED),t)},bg.createGeometry=function(e){var t=e._positions,i=e._width,n=e._ellipsoid;t=ag(t,n);var r=$t(t,z.equalsEpsilon);if(!(r.length<2||i<=0)){var a,o=e._height,s=e._extrudedHeight,c=!I.equalsEpsilon(o,s,0,I.EPSILON2),l=e._vertexFormat,h={ellipsoid:n,positions:r,width:i,cornerType:e._cornerType,granularity:e._granularity,saveAttributes:!0};if(c)h.height=o,h.extrudedHeight=s,h.shadowVolume=e._shadowVolume,h.offsetAttribute=e._offsetAttribute,a=lg(h,l);else if((a=sg(Q_.computePositions(h),l,n)).attributes.position.values=wp.scaleToGeodeticHeight(a.attributes.position.values,o,n),Object(u.a)(e._offsetAttribute)){var d=e._offsetAttribute===fn.NONE?0:1,f=a.attributes.position.values.length,p=new Uint8Array(f/3);Qt(p,d),a.attributes.applyOffset=new Na({componentDatatype:dn.UNSIGNED_BYTE,componentsPerAttribute:1,values:p})}var m=a.attributes,_=St.fromVertices(m.position.values,void 0,3);return l.position||(a.attributes.position.values=void 0),new La({attributes:m,indices:a.indices,primitiveType:yn.TRIANGLES,boundingSphere:_,offsetAttribute:e._offsetAttribute})}},bg.createShadowVolume=function(e,t,i){var n=e._granularity,r=e._ellipsoid,a=t(n,r),o=i(n,r);return new bg({positions:e._positions,width:e._width,cornerType:e._cornerType,ellipsoid:r,granularity:n,extrudedHeight:a,height:o,vertexFormat:Ba.POSITION_ONLY,shadowVolume:!0})},Object(O.a)(bg.prototype,{rectangle:{get:function(){return Object(u.a)(this._rectangle)||(this._rectangle=vg(this._positions,this._ellipsoid,this._width,this._cornerType)),this._rectangle}},textureCoordinateRotationPoints:{get:function(){return[0,0,0,1,1,0]}}});var xg=bg,Eg=new z,Tg=new z,Cg=new z;function Sg(e,t){var i,n,r,a=[],o=e.positions,s=e.corners,c=e.endPositions,l=new Fa,h=0,d=0,f=0;for(n=0;n<o.length;n+=2)h+=r=o[n].length-3,f+=r/3*4,d+=o[n+1].length-3;for(h+=3,d+=3,n=0;n<s.length;n++){i=s[n];var p=s[n].leftPositions;Object(u.a)(p)?(h+=r=p.length,f+=r/3*2):(d+=r=s[n].rightPositions.length,f+=r/3*2)}var m,_=Object(u.a)(c);_&&(h+=m=c[0].length-3,d+=m,f+=4*(m/=3));var g,v,b,y,w,O,x=h+d,E=new Float64Array(x),T=0,C=x-1,S=m/2,A=Sl.createTypedArray(x/3,f+4),P=0;if(A[P++]=T/3,A[P++]=(C-2)/3,_){a.push(T/3),O=Eg,w=Tg;var I=c[0];for(n=0;n<S;n++)O=z.fromArray(I,3*(S-1-n),O),w=z.fromArray(I,3*(S+n),w),Q_.addAttribute(E,w,T),Q_.addAttribute(E,O,void 0,C),y=(v=T/3)+1,b=(g=(C-2)/3)-1,A[P++]=g,A[P++]=b,A[P++]=v,A[P++]=y,T+=3,C-=3}var D=0,j=o[D++],M=o[D++];for(E.set(j,T),E.set(M,C-M.length+1),r=M.length-3,a.push(T/3,(C-2)/3),n=0;n<r;n+=3)y=(v=T/3)+1,b=(g=(C-2)/3)-1,A[P++]=g,A[P++]=b,A[P++]=v,A[P++]=y,T+=3,C-=3;for(n=0;n<s.length;n++){var R,L,N=(i=s[n]).leftPositions,F=i.rightPositions,k=Cg;if(Object(u.a)(N)){for(C-=3,L=b,a.push(y),R=0;R<N.length/3;R++)k=z.fromArray(N,3*R,k),A[P++]=L-R-1,A[P++]=L-R,Q_.addAttribute(E,k,void 0,C),C-=3;a.push(L-Math.floor(N.length/6)),t===fm.BEVELED&&a.push((C-2)/3+1),T+=3}else{for(T+=3,L=y,a.push(b),R=0;R<F.length/3;R++)k=z.fromArray(F,3*R,k),A[P++]=L+R,A[P++]=L+R+1,Q_.addAttribute(E,k,T),T+=3;a.push(L+Math.floor(F.length/6)),t===fm.BEVELED&&a.push(T/3-1),C-=3}for(j=o[D++],M=o[D++],j.splice(0,3),M.splice(M.length-3,3),E.set(j,T),E.set(M,C-M.length+1),r=M.length-3,R=0;R<M.length;R+=3)v=(y=T/3)-1,g=(b=(C-2)/3)+1,A[P++]=g,A[P++]=b,A[P++]=v,A[P++]=y,T+=3,C-=3;T-=3,C+=3,a.push(T/3,(C-2)/3)}if(_){T+=3,C-=3,O=Eg,w=Tg;var B=c[1];for(n=0;n<S;n++)O=z.fromArray(B,3*(m-n-1),O),w=z.fromArray(B,3*n,w),Q_.addAttribute(E,O,void 0,C),Q_.addAttribute(E,w,T),v=(y=T/3)-1,g=(b=(C-2)/3)+1,A[P++]=g,A[P++]=b,A[P++]=v,A[P++]=y,T+=3,C-=3;a.push(T/3)}else a.push(T/3,(C-2)/3);return A[P++]=T/3,A[P++]=(C-2)/3,l.position=new Na({componentDatatype:dn.DOUBLE,componentsPerAttribute:3,values:E}),{attributes:l,indices:A,wallIndices:a}}function Ag(e){var t=(e=Object(w.a)(e,w.a.EMPTY_OBJECT)).positions,i=e.width;x.a.typeOf.object("options.positions",t),x.a.typeOf.number("options.width",i);var n=Object(w.a)(e.height,0),r=Object(w.a)(e.extrudedHeight,n);this._positions=t,this._ellipsoid=ae.clone(Object(w.a)(e.ellipsoid,ae.WGS84)),this._width=i,this._height=Math.max(n,r),this._extrudedHeight=Math.min(n,r),this._cornerType=Object(w.a)(e.cornerType,fm.ROUNDED),this._granularity=Object(w.a)(e.granularity,I.RADIANS_PER_DEGREE),this._offsetAttribute=e.offsetAttribute,this._workerName="createCorridorOutlineGeometry",this.packedLength=1+t.length*z.packedLength+ae.packedLength+6}Ag.pack=function(e,t,i){x.a.typeOf.object("value",e),x.a.typeOf.object("array",t),i=Object(w.a)(i,0);var n=e._positions,r=n.length;t[i++]=r;for(var a=0;a<r;++a,i+=z.packedLength)z.pack(n[a],t,i);return ae.pack(e._ellipsoid,t,i),i+=ae.packedLength,t[i++]=e._width,t[i++]=e._height,t[i++]=e._extrudedHeight,t[i++]=e._cornerType,t[i++]=e._granularity,t[i]=Object(w.a)(e._offsetAttribute,-1),t};var Pg=ae.clone(ae.UNIT_SPHERE),Ig={positions:void 0,ellipsoid:Pg,width:void 0,height:void 0,extrudedHeight:void 0,cornerType:void 0,granularity:void 0,offsetAttribute:void 0};Ag.unpack=function(e,t,i){x.a.typeOf.object("array",e),t=Object(w.a)(t,0);for(var n=e[t++],r=new Array(n),a=0;a<n;++a,t+=z.packedLength)r[a]=z.unpack(e,t);var o=ae.unpack(e,t,Pg);t+=ae.packedLength;var s=e[t++],c=e[t++],l=e[t++],h=e[t++],d=e[t++],f=e[t];return Object(u.a)(i)?(i._positions=r,i._ellipsoid=ae.clone(o,i._ellipsoid),i._width=s,i._height=c,i._extrudedHeight=l,i._cornerType=h,i._granularity=d,i._offsetAttribute=-1===f?void 0:f,i):(Ig.positions=r,Ig.width=s,Ig.height=c,Ig.extrudedHeight=l,Ig.cornerType=h,Ig.granularity=d,Ig.offsetAttribute=-1===f?void 0:f,new Ag(Ig))},Ag.createGeometry=function(e){var t=e._positions,i=e._width,n=e._ellipsoid;t=function(e,t){for(var i=0;i<e.length;i++)e[i]=t.scaleToGeodeticSurface(e[i],e[i]);return e}(t,n);var r=$t(t,z.equalsEpsilon);if(!(r.length<2||i<=0)){var a,o=e._height,s=e._extrudedHeight,c=!I.equalsEpsilon(o,s,0,I.EPSILON2),l={ellipsoid:n,positions:r,width:i,cornerType:e._cornerType,granularity:e._granularity,saveAttributes:!1};if(c)l.height=o,l.extrudedHeight=s,l.offsetAttribute=e._offsetAttribute,a=function(e){var t=e.ellipsoid,i=Sg(Q_.computePositions(e),e.cornerType),n=i.wallIndices,r=e.height,a=e.extrudedHeight,o=i.attributes,s=i.indices,c=o.position.values,l=c.length,h=new Float64Array(l);h.set(c);var d,f=new Float64Array(2*l);if(c=wp.scaleToGeodeticHeight(c,r,t),h=wp.scaleToGeodeticHeight(h,a,t),f.set(c),f.set(h,l),o.position.values=f,l/=3,Object(u.a)(e.offsetAttribute)){var p=new Uint8Array(2*l);if(e.offsetAttribute===fn.TOP)p=Qt(p,1,0,l);else{var m=e.offsetAttribute===fn.NONE?0:1;p=Qt(p,m)}o.applyOffset=new Na({componentDatatype:dn.UNSIGNED_BYTE,componentsPerAttribute:1,values:p})}var _=s.length,g=Sl.createTypedArray(f.length/3,2*(_+n.length));g.set(s);var v,b,y=_;for(d=0;d<_;d+=2){var w=s[d],O=s[d+1];g[y++]=w+l,g[y++]=O+l}for(d=0;d<n.length;d++)b=(v=n[d])+l,g[y++]=v,g[y++]=b;return{attributes:o,indices:g}}(l);else if((a=Sg(Q_.computePositions(l),l.cornerType)).attributes.position.values=wp.scaleToGeodeticHeight(a.attributes.position.values,o,n),Object(u.a)(e._offsetAttribute)){var h=a.attributes.position.values.length,d=new Uint8Array(h/3),f=e._offsetAttribute===fn.NONE?0:1;Qt(d,f),a.attributes.applyOffset=new Na({componentDatatype:dn.UNSIGNED_BYTE,componentsPerAttribute:1,values:d})}var p=a.attributes,m=St.fromVertices(p.position.values,void 0,3);return new La({attributes:p,indices:a.indices,primitiveType:yn.LINES,boundingSphere:m,offsetAttribute:e._offsetAttribute})}};var Dg=Ag;var jg,Mg=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))},Rg="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiIxMmRjYjRlZS05YjAzLTRmYTQtOTIxZS0wMjgzZjVjOGYxMzYiLCJpZCI6MjU5LCJzY29wZXMiOlsiYXNyIiwiZ2MiXSwiaWF0IjoxNTQ5MDM0MjI0fQ.Ree22k5kI_uYMLsV4a9L4INmNjE1VNxMQV0s3AOCcSs",Lg={};Lg.defaultAccessToken=Rg,Lg.defaultServer=new f.a({url:"https://api.cesium.com/"}),Lg.getDefaultTokenCredit=function(e){if(e===Rg){if(!Object(u.a)(jg)){jg=new Jo('<b>             This application is using Cesium\'s default ion access token. Please assign <i>Cesium.Ion.defaultAccessToken</i>             with an access token from your ion account before making any Cesium API calls.             You can sign up for a free ion account at <a href="https://cesium.com">https://cesium.com</a>.</b>',!0)}return jg}};var Ng=Lg;function Fg(e,t){var i;x.a.defined("endpoint",e),x.a.defined("endpointResource",t);var n=e.externalType,r=Object(u.a)(n);if(r){if("3DTILES"!==n&&"STK_TERRAIN_SERVER"!==n)throw new Ce.a("Ion.createResource does not support external imagery assets; use IonImageryProvider instead.");i={url:e.options.url}}else i={url:e.url,retryAttempts:1,retryCallback:kg};f.a.call(this,i),this._ionEndpoint=e,this._ionEndpointResource=t,this._ionRoot=void 0,this._pendingPromise=void 0,this._credits=void 0,this._isExternal=r}function kg(e,t){var i=Object(w.a)(e._ionRoot,e),n=i._ionEndpointResource;return Object(u.a)(t)&&(401===t.statusCode||t.target instanceof Image)?(Object(u.a)(i._pendingPromise)||(i._pendingPromise=n.fetchJson().then((function(e){return i._ionEndpoint=e,e})).always((function(e){return i._pendingPromise=void 0,e}))),i._pendingPromise.then((function(t){return e._ionEndpoint=t,!0}))):Oi.a.resolve(!1)}Object(u.a)(Object.create)&&(Fg.prototype=Object.create(f.a.prototype),Fg.prototype.constructor=Fg),Fg.fromAssetId=function(e,t){var i=Fg._createEndpointResource(e,t);return i.fetchJson().then((function(e){return new Fg(e,i)}))},Object(O.a)(Fg.prototype,{credits:{get:function(){return Object(u.a)(this._ionRoot)?this._ionRoot.credits:Object(u.a)(this._credits)?this._credits:(this._credits=Fg.getCreditsFromEndpoint(this._ionEndpoint,this._ionEndpointResource),this._credits)}}}),Fg.getCreditsFromEndpoint=function(e,t){var i=e.attributions.map(Jo.getIonCredit),n=Ng.getDefaultTokenCredit(t.queryParameters.access_token);return Object(u.a)(n)&&i.push(Jo.clone(n)),i},Fg.prototype.clone=function(e){var t=Object(w.a)(this._ionRoot,this);return Object(u.a)(e)||(e=new Fg(t._ionEndpoint,t._ionEndpointResource)),(e=f.a.prototype.clone.call(this,e))._ionRoot=t,e._isExternal=this._isExternal,e},Fg.prototype.fetchImage=function(e,t){return f.a.prototype.fetchImage.call(this,!this._isExternal||e,t)},Fg.prototype._makeRequest=function(e){if(this._isExternal)return f.a.prototype._makeRequest.call(this,e);var t="*/*;access_token="+this._ionEndpoint.accessToken,i=t,n=this.headers;return Object(u.a)(n)&&Object(u.a)(n.Accept)&&(i=n.Accept+","+t),Object(u.a)(e.headers)?Object(u.a)(e.headers.Accept)?e.headers.Accept=e.headers.Accept+","+t:e.headers.Accept=i:e.headers={Accept:i},f.a.prototype._makeRequest.call(this,e)},Fg._createEndpointResource=function(e,t){x.a.defined("assetId",e),t=Object(w.a)(t,w.a.EMPTY_OBJECT);var i=Object(w.a)(t.server,Ng.defaultServer),n=Object(w.a)(t.accessToken,Ng.defaultAccessToken);i=f.a.createIfNeeded(i);var r={url:"v1/assets/"+e+"/endpoint"};return Object(u.a)(n)&&(r.queryParameters={access_token:n}),i.getDerivedResource(r)};var Bg=Fg;var zg=function(e){return e=Object(w.a)(e,w.a.EMPTY_OBJECT),new vu({url:Bg.fromAssetId(1),requestVertexNormals:Object(w.a)(e.requestVertexNormals,!1),requestWaterMask:Object(w.a)(e.requestWaterMask,!1)})};function Ug(e){this.planes=Object(w.a)(e,[])}var Vg=[new z,new z,new z];z.clone(z.UNIT_X,Vg[0]),z.clone(z.UNIT_Y,Vg[1]),z.clone(z.UNIT_Z,Vg[2]);var Hg=new z,Gg=new z,qg=new oc(new z(1,0,0),0);Ug.fromBoundingSphere=function(e,t){if(!Object(u.a)(e))throw new h.a("boundingSphere is required.");Object(u.a)(t)||(t=new Ug);var i=Vg.length,n=t.planes;n.length=2*i;for(var r=e.center,a=e.radius,o=0,s=0;s<i;++s){var c=Vg[s],l=n[o],d=n[o+1];Object(u.a)(l)||(l=n[o]=new Te),Object(u.a)(d)||(d=n[o+1]=new Te),z.multiplyByScalar(c,-a,Hg),z.add(r,Hg,Hg),l.x=c.x,l.y=c.y,l.z=c.z,l.w=-z.dot(c,Hg),z.multiplyByScalar(c,a,Hg),z.add(r,Hg,Hg),d.x=-c.x,d.y=-c.y,d.z=-c.z,d.w=-z.dot(z.negate(c,Gg),Hg),o+=2}return t},Ug.prototype.computeVisibility=function(e){if(!Object(u.a)(e))throw new h.a("boundingVolume is required.");for(var t=this.planes,i=!1,n=0,r=t.length;n<r;++n){var a=e.intersectPlane(oc.fromCartesian4(t[n],qg));if(a===ce.OUTSIDE)return ce.OUTSIDE;a===ce.INTERSECTING&&(i=!0)}return i?ce.INTERSECTING:ce.INSIDE},Ug.prototype.computeVisibilityWithPlaneMask=function(e,t){if(!Object(u.a)(e))throw new h.a("boundingVolume is required.");if(!Object(u.a)(t))throw new h.a("parentPlaneMask is required.");if(t===Ug.MASK_OUTSIDE||t===Ug.MASK_INSIDE)return t;for(var i=Ug.MASK_INSIDE,n=this.planes,r=0,a=n.length;r<a;++r){var o=r<31?1<<r:0;if(!(r<31&&0==(t&o))){var s=e.intersectPlane(oc.fromCartesian4(n[r],qg));if(s===ce.OUTSIDE)return Ug.MASK_OUTSIDE;s===ce.INTERSECTING&&(i|=o)}}return i},Ug.MASK_OUTSIDE=4294967295,Ug.MASK_INSIDE=0,Ug.MASK_INDETERMINATE=2147483647;var Wg=Ug,Yg={computePositions:function(e,t,i,n,r){var a,o=.5*e,s=-o,c=n+n,l=new Float64Array(3*(r?2*c:c)),u=0,h=0,d=r?3*c:0,f=r?3*(c+n):3*n;for(a=0;a<n;a++){var p=a/n*I.TWO_PI,m=Math.cos(p),_=Math.sin(p),g=m*i,v=_*i,b=m*t,y=_*t;l[h+d]=g,l[h+d+1]=v,l[h+d+2]=s,l[h+f]=b,l[h+f+1]=y,l[h+f+2]=o,h+=3,r&&(l[u++]=g,l[u++]=v,l[u++]=s,l[u++]=b,l[u++]=y,l[u++]=o)}return l}},Xg=Yg,Zg=new Rt,Qg=new z,Kg=new z,Jg=new z,$g=new z;function ev(e){var t=(e=Object(w.a)(e,w.a.EMPTY_OBJECT)).length,i=e.topRadius,n=e.bottomRadius,r=Object(w.a)(e.vertexFormat,Ba.DEFAULT),a=Object(w.a)(e.slices,128);if(!Object(u.a)(t))throw new h.a("options.length must be defined.");if(!Object(u.a)(i))throw new h.a("options.topRadius must be defined.");if(!Object(u.a)(n))throw new h.a("options.bottomRadius must be defined.");if(a<3)throw new h.a("options.slices must be greater than or equal to 3.");if(Object(u.a)(e.offsetAttribute)&&e.offsetAttribute===fn.TOP)throw new h.a("GeometryOffsetAttribute.TOP is not a supported options.offsetAttribute for this geometry.");this._length=t,this._topRadius=i,this._bottomRadius=n,this._vertexFormat=Ba.clone(r),this._slices=a,this._offsetAttribute=e.offsetAttribute,this._workerName="createCylinderGeometry"}ev.packedLength=Ba.packedLength+5,ev.pack=function(e,t,i){if(!Object(u.a)(e))throw new h.a("value is required");if(!Object(u.a)(t))throw new h.a("array is required");return i=Object(w.a)(i,0),Ba.pack(e._vertexFormat,t,i),i+=Ba.packedLength,t[i++]=e._length,t[i++]=e._topRadius,t[i++]=e._bottomRadius,t[i++]=e._slices,t[i]=Object(w.a)(e._offsetAttribute,-1),t};var tv,iv=new Ba,nv={vertexFormat:iv,length:void 0,topRadius:void 0,bottomRadius:void 0,slices:void 0,offsetAttribute:void 0};ev.unpack=function(e,t,i){if(!Object(u.a)(e))throw new h.a("array is required");t=Object(w.a)(t,0);var n=Ba.unpack(e,t,iv);t+=Ba.packedLength;var r=e[t++],a=e[t++],o=e[t++],s=e[t++],c=e[t];return Object(u.a)(i)?(i._vertexFormat=Ba.clone(n,i._vertexFormat),i._length=r,i._topRadius=a,i._bottomRadius=o,i._slices=s,i._offsetAttribute=-1===c?void 0:c,i):(nv.length=r,nv.topRadius=a,nv.bottomRadius=o,nv.slices=s,nv.offsetAttribute=-1===c?void 0:c,new ev(nv))},ev.createGeometry=function(e){var t=e._length,i=e._topRadius,n=e._bottomRadius,r=e._vertexFormat,a=e._slices;if(!(t<=0||i<0||n<0||0===i&&0===n)){var o,s=a+a,c=a+s,l=s+s,h=Xg.computePositions(t,i,n,a,!0),d=r.st?new Float32Array(2*l):void 0,f=r.normal?new Float32Array(3*l):void 0,p=r.tangent?new Float32Array(3*l):void 0,m=r.bitangent?new Float32Array(3*l):void 0,_=r.normal||r.tangent||r.bitangent;if(_){var g=r.tangent||r.bitangent,v=0,b=0,y=0,w=Math.atan2(n-i,t),O=Qg;O.z=Math.sin(w);var x=Math.cos(w),E=Jg,T=Kg;for(o=0;o<a;o++){var C=o/a*I.TWO_PI,S=x*Math.cos(C),A=x*Math.sin(C);_&&(O.x=S,O.y=A,g&&(E=z.normalize(z.cross(z.UNIT_Z,O,E),E)),r.normal&&(f[v++]=O.x,f[v++]=O.y,f[v++]=O.z,f[v++]=O.x,f[v++]=O.y,f[v++]=O.z),r.tangent&&(p[b++]=E.x,p[b++]=E.y,p[b++]=E.z,p[b++]=E.x,p[b++]=E.y,p[b++]=E.z),r.bitangent&&(T=z.normalize(z.cross(O,E,T),T),m[y++]=T.x,m[y++]=T.y,m[y++]=T.z,m[y++]=T.x,m[y++]=T.y,m[y++]=T.z))}for(o=0;o<a;o++)r.normal&&(f[v++]=0,f[v++]=0,f[v++]=-1),r.tangent&&(p[b++]=1,p[b++]=0,p[b++]=0),r.bitangent&&(m[y++]=0,m[y++]=-1,m[y++]=0);for(o=0;o<a;o++)r.normal&&(f[v++]=0,f[v++]=0,f[v++]=1),r.tangent&&(p[b++]=1,p[b++]=0,p[b++]=0),r.bitangent&&(m[y++]=0,m[y++]=1,m[y++]=0)}var P=12*a-12,D=Sl.createTypedArray(l,P),j=0,M=0;for(o=0;o<a-1;o++)D[j++]=M,D[j++]=M+2,D[j++]=M+3,D[j++]=M,D[j++]=M+3,D[j++]=M+1,M+=2;for(D[j++]=s-2,D[j++]=0,D[j++]=1,D[j++]=s-2,D[j++]=1,D[j++]=s-1,o=1;o<a-1;o++)D[j++]=s+o+1,D[j++]=s+o,D[j++]=s;for(o=1;o<a-1;o++)D[j++]=c,D[j++]=c+o,D[j++]=c+o+1;var R=0;if(r.st){var L=Math.max(i,n);for(o=0;o<l;o++){var N=z.fromArray(h,3*o,$g);d[R++]=(N.x+L)/(2*L),d[R++]=(N.y+L)/(2*L)}}var F=new Fa;r.position&&(F.position=new Na({componentDatatype:dn.DOUBLE,componentsPerAttribute:3,values:h})),r.normal&&(F.normal=new Na({componentDatatype:dn.FLOAT,componentsPerAttribute:3,values:f})),r.tangent&&(F.tangent=new Na({componentDatatype:dn.FLOAT,componentsPerAttribute:3,values:p})),r.bitangent&&(F.bitangent=new Na({componentDatatype:dn.FLOAT,componentsPerAttribute:3,values:m})),r.st&&(F.st=new Na({componentDatatype:dn.FLOAT,componentsPerAttribute:2,values:d})),Zg.x=.5*t,Zg.y=Math.max(n,i);var k=new St(z.ZERO,Rt.magnitude(Zg));if(Object(u.a)(e._offsetAttribute)){t=h.length;var B=new Uint8Array(t/3),U=e._offsetAttribute===fn.NONE?0:1;Qt(B,U),F.applyOffset=new Na({componentDatatype:dn.UNSIGNED_BYTE,componentsPerAttribute:1,values:B})}return new La({attributes:F,indices:D,primitiveType:yn.TRIANGLES,boundingSphere:k,offsetAttribute:e._offsetAttribute})}},ev.getUnitCylinder=function(){return Object(u.a)(tv)||(tv=ev.createGeometry(new ev({topRadius:1,bottomRadius:1,length:1,vertexFormat:Ba.POSITION_ONLY}))),tv};var rv=ev,av=new Rt;function ov(e){var t=(e=Object(w.a)(e,w.a.EMPTY_OBJECT)).length,i=e.topRadius,n=e.bottomRadius,r=Object(w.a)(e.slices,128),a=Math.max(Object(w.a)(e.numberOfVerticalLines,16),0);if(x.a.typeOf.number("options.positions",t),x.a.typeOf.number("options.topRadius",i),x.a.typeOf.number("options.bottomRadius",n),x.a.typeOf.number.greaterThanOrEquals("options.slices",r,3),Object(u.a)(e.offsetAttribute)&&e.offsetAttribute===fn.TOP)throw new h.a("GeometryOffsetAttribute.TOP is not a supported options.offsetAttribute for this geometry.");this._length=t,this._topRadius=i,this._bottomRadius=n,this._slices=r,this._numberOfVerticalLines=a,this._offsetAttribute=e.offsetAttribute,this._workerName="createCylinderOutlineGeometry"}ov.packedLength=6,ov.pack=function(e,t,i){return x.a.typeOf.object("value",e),x.a.defined("array",t),i=Object(w.a)(i,0),t[i++]=e._length,t[i++]=e._topRadius,t[i++]=e._bottomRadius,t[i++]=e._slices,t[i++]=e._numberOfVerticalLines,t[i]=Object(w.a)(e._offsetAttribute,-1),t};var sv={length:void 0,topRadius:void 0,bottomRadius:void 0,slices:void 0,numberOfVerticalLines:void 0,offsetAttribute:void 0};ov.unpack=function(e,t,i){x.a.defined("array",e),t=Object(w.a)(t,0);var n=e[t++],r=e[t++],a=e[t++],o=e[t++],s=e[t++],c=e[t];return Object(u.a)(i)?(i._length=n,i._topRadius=r,i._bottomRadius=a,i._slices=o,i._numberOfVerticalLines=s,i._offsetAttribute=-1===c?void 0:c,i):(sv.length=n,sv.topRadius=r,sv.bottomRadius=a,sv.slices=o,sv.numberOfVerticalLines=s,sv.offsetAttribute=-1===c?void 0:c,new ov(sv))},ov.createGeometry=function(e){var t=e._length,i=e._topRadius,n=e._bottomRadius,r=e._slices,a=e._numberOfVerticalLines;if(!(t<=0||i<0||n<0||0===i&&0===n)){var o,s=2*r,c=Xg.computePositions(t,i,n,r,!1),l=2*r;if(a>0){var h=Math.min(a,r);o=Math.round(r/h),l+=h}var d,f=Sl.createTypedArray(s,2*l),p=0;for(d=0;d<r-1;d++)f[p++]=d,f[p++]=d+1,f[p++]=d+r,f[p++]=d+1+r;if(f[p++]=r-1,f[p++]=0,f[p++]=r+r-1,f[p++]=r,a>0)for(d=0;d<r;d+=o)f[p++]=d,f[p++]=d+r;var m=new Fa;m.position=new Na({componentDatatype:dn.DOUBLE,componentsPerAttribute:3,values:c}),av.x=.5*t,av.y=Math.max(n,i);var _=new St(z.ZERO,Rt.magnitude(av));if(Object(u.a)(e._offsetAttribute)){t=c.length;var g=new Uint8Array(t/3),v=e._offsetAttribute===fn.NONE?0:1;Qt(g,v),m.applyOffset=new Na({componentDatatype:dn.UNSIGNED_BYTE,componentsPerAttribute:1,values:g})}return new La({attributes:m,indices:f,primitiveType:yn.LINES,boundingSphere:_,offsetAttribute:e._offsetAttribute})}};var cv=ov,lv=1953029805,uv=2917034100;function hv(e,t){if(hv.passThroughDataForTesting)return t;x.a.typeOf.object("key",e),x.a.typeOf.object("data",t);var i=e.byteLength;if(0===i||i%4!=0)throw new Ce.a("The length of key must be greater than 0 and a multiple of 4.");var n=new DataView(t),r=n.getUint32(0,!0);if(r===lv||r===uv)return t;for(var a,o=new DataView(e),s=0,c=t.byteLength,l=c-c%8,u=i,h=8;s<l;)for(a=h=(h+8)%24;s<l&&a<u;)n.setUint32(s,n.getUint32(s,!0)^o.getUint32(a,!0),!0),n.setUint32(s+4,n.getUint32(s+4,!0)^o.getUint32(a+4,!0),!0),s+=8,a+=24;if(s<c)for(a>=u&&(a=h=(h+8)%24);s<c;)n.setUint8(s,n.getUint8(s)^o.getUint8(a)),s++,a++}hv.passThroughDataForTesting=!1;var dv=hv;function fv(e){this.proxy=e}fv.prototype.getURL=function(e){var t=-1===this.proxy.indexOf("?")?"?":"";return this.proxy+t+encodeURIComponent(e)};var pv=fv,mv=n(19);function _v(e,t){e=Object(w.a)(e,0),this._near=e,t=Object(w.a)(t,Number.MAX_VALUE),this._far=t}Object(O.a)(_v.prototype,{near:{get:function(){return this._near},set:function(e){this._near=e}},far:{get:function(){return this._far},set:function(e){this._far=e}}}),_v.packedLength=2,_v.pack=function(e,t,i){if(!Object(u.a)(e))throw new h.a("value is required");if(!Object(u.a)(t))throw new h.a("array is required");return i=Object(w.a)(i,0),t[i++]=e.near,t[i]=e.far,t},_v.unpack=function(e,t,i){if(!Object(u.a)(e))throw new h.a("array is required");return t=Object(w.a)(t,0),Object(u.a)(i)||(i=new _v),i.near=e[t++],i.far=e[t],i},_v.equals=function(e,t){return e===t||Object(u.a)(e)&&Object(u.a)(t)&&e.near===t.near&&e.far===t.far},_v.clone=function(e,t){if(Object(u.a)(e))return Object(u.a)(t)||(t=new _v),t.near=e.near,t.far=e.far,t},_v.prototype.clone=function(e){return _v.clone(this,e)},_v.prototype.equals=function(e){return _v.equals(this,e)};var gv=_v;function vv(e,t){if(e=Object(w.a)(e,0),(t=Object(w.a)(t,Number.MAX_VALUE))<=e)throw new h.a("far distance must be greater than near distance.");this.value=new Float32Array([e,t])}Object(O.a)(vv.prototype,{componentDatatype:{get:function(){return dn.FLOAT}},componentsPerAttribute:{get:function(){return 2}},normalize:{get:function(){return!1}}}),vv.fromDistanceDisplayCondition=function(e){if(!Object(u.a)(e))throw new h.a("distanceDisplayCondition is required.");if(e.far<=e.near)throw new h.a("distanceDisplayCondition.far distance must be greater than distanceDisplayCondition.near distance.");return new vv(e.near,e.far)},vv.toValue=function(e,t){if(!Object(u.a)(e))throw new h.a("distanceDisplayCondition is required.");return Object(u.a)(t)?(t[0]=e.near,t[1]=e.far,t):new Float32Array([e.near,e.far])};var bv=vv;function yv(){this.head=void 0,this.tail=void 0,this._length=0}function wv(e,t,i){this.item=e,this.previous=t,this.next=i}function Ov(e,t){Object(u.a)(t.previous)&&Object(u.a)(t.next)?(t.previous.next=t.next,t.next.previous=t.previous):Object(u.a)(t.previous)?(t.previous.next=void 0,e.tail=t.previous):Object(u.a)(t.next)?(t.next.previous=void 0,e.head=t.next):(e.head=void 0,e.tail=void 0),t.next=void 0,t.previous=void 0}Object(O.a)(yv.prototype,{length:{get:function(){return this._length}}}),yv.prototype.add=function(e){var t=new wv(e,this.tail,void 0);return Object(u.a)(this.tail)?(this.tail.next=t,this.tail=t):(this.head=t,this.tail=t),++this._length,t},yv.prototype.remove=function(e){Object(u.a)(e)&&(Ov(this,e),--this._length)},yv.prototype.splice=function(e,t){if(e!==t){Ov(this,t);var i=e.next;e.next=t,this.tail===e?this.tail=t:i.previous=t,t.next=i,t.previous=e}};var xv=yv;
/**
@license
tween.js - https://github.com/sole/tween.js

Copyright (c) 2010-2012 Tween.js authors.

Easing equations Copyright (c) 2001 Robert Penner http://robertpenner.com/easing/

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.
*/void 0===Date.now&&(Date.now=function(){return(new Date).valueOf()});var Ev,Tv,Cv=Cv||(Ev=[],{REVISION:"13",getAll:function(){return Ev},removeAll:function(){Ev=[]},add:function(e){Ev.push(e)},remove:function(e){var t=Ev.indexOf(e);-1!==t&&Ev.splice(t,1)},update:function(e){if(0===Ev.length)return!1;var t=0;for(e=void 0!==e?e:"undefined"!=typeof window&&void 0!==window.performance&&void 0!==window.performance.now?window.performance.now():Date.now();t<Ev.length;)Ev[t].update(e)?t++:Ev.splice(t,1);return!0}});Cv.Tween=function(e){var t=e,i={},n={},r={},a=1e3,o=0,s=!1,c=!1,l=!1,u=0,h=null,d=Cv.Easing.Linear.None,f=Cv.Interpolation.Linear,p=[],m=null,_=!1,g=null,v=null,b=null;for(var y in e)i[y]=parseFloat(e[y],10);this.to=function(e,t){return void 0!==t&&(a=t),n=e,this},this.start=function(e){for(var a in Cv.add(this),c=!0,_=!1,h=void 0!==e?e:"undefined"!=typeof window&&void 0!==window.performance&&void 0!==window.performance.now?window.performance.now():Date.now(),h+=u,n){if(n[a]instanceof Array){if(0===n[a].length)continue;n[a]=[t[a]].concat(n[a])}i[a]=t[a],i[a]instanceof Array==!1&&(i[a]*=1),r[a]=i[a]||0}return this},this.stop=function(){return c?(Cv.remove(this),c=!1,null!==b&&b.call(t),this.stopChainedTweens(),this):this},this.stopChainedTweens=function(){for(var e=0,t=p.length;e<t;e++)p[e].stop()},this.delay=function(e){return u=e,this},this.repeat=function(e){return o=e,this},this.yoyo=function(e){return s=e,this},this.easing=function(e){return d=e,this},this.interpolation=function(e){return f=e,this},this.chain=function(){return p=arguments,this},this.onStart=function(e){return m=e,this},this.onUpdate=function(e){return g=e,this},this.onComplete=function(e){return v=e,this},this.onStop=function(e){return b=e,this},this.update=function(e){var c;if(e<h)return!0;!1===_&&(null!==m&&m.call(t),_=!0);var b=(e-h)/a,y=d(b=b>1?1:b);for(c in n){var w=i[c]||0,O=n[c];O instanceof Array?t[c]=f(O,y):("string"==typeof O&&(O=w+parseFloat(O,10)),"number"==typeof O&&(t[c]=w+(O-w)*y))}if(null!==g&&g.call(t,y),1==b){if(o>0){for(c in isFinite(o)&&o--,r){if("string"==typeof n[c]&&(r[c]=r[c]+parseFloat(n[c],10)),s){var x=r[c];r[c]=n[c],n[c]=x}i[c]=r[c]}return s&&(l=!l),h=e+u,!0}null!==v&&v.call(t);for(var E=0,T=p.length;E<T;E++)p[E].start(e);return!1}return!0}},Cv.Easing={Linear:{None:function(e){return e}},Quadratic:{In:function(e){return e*e},Out:function(e){return e*(2-e)},InOut:function(e){return(e*=2)<1?.5*e*e:-.5*(--e*(e-2)-1)}},Cubic:{In:function(e){return e*e*e},Out:function(e){return--e*e*e+1},InOut:function(e){return(e*=2)<1?.5*e*e*e:.5*((e-=2)*e*e+2)}},Quartic:{In:function(e){return e*e*e*e},Out:function(e){return 1- --e*e*e*e},InOut:function(e){return(e*=2)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)}},Quintic:{In:function(e){return e*e*e*e*e},Out:function(e){return--e*e*e*e*e+1},InOut:function(e){return(e*=2)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)}},Sinusoidal:{In:function(e){return 1-Math.cos(e*Math.PI/2)},Out:function(e){return Math.sin(e*Math.PI/2)},InOut:function(e){return.5*(1-Math.cos(Math.PI*e))}},Exponential:{In:function(e){return 0===e?0:Math.pow(1024,e-1)},Out:function(e){return 1===e?1:1-Math.pow(2,-10*e)},InOut:function(e){return 0===e?0:1===e?1:(e*=2)<1?.5*Math.pow(1024,e-1):.5*(2-Math.pow(2,-10*(e-1)))}},Circular:{In:function(e){return 1-Math.sqrt(1-e*e)},Out:function(e){return Math.sqrt(1- --e*e)},InOut:function(e){return(e*=2)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)}},Elastic:{In:function(e){var t,i=.1;return 0===e?0:1===e?1:(!i||i<1?(i=1,t=.1):t=.4*Math.asin(1/i)/(2*Math.PI),-i*Math.pow(2,10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/.4))},Out:function(e){var t,i=.1;return 0===e?0:1===e?1:(!i||i<1?(i=1,t=.1):t=.4*Math.asin(1/i)/(2*Math.PI),i*Math.pow(2,-10*e)*Math.sin((e-t)*(2*Math.PI)/.4)+1)},InOut:function(e){var t,i=.1;return 0===e?0:1===e?1:(!i||i<1?(i=1,t=.1):t=.4*Math.asin(1/i)/(2*Math.PI),(e*=2)<1?i*Math.pow(2,10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/.4)*-.5:i*Math.pow(2,-10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/.4)*.5+1)}},Back:{In:function(e){var t=1.70158;return e*e*((t+1)*e-t)},Out:function(e){var t=1.70158;return--e*e*((t+1)*e+t)+1},InOut:function(e){var t=2.5949095;return(e*=2)<1?e*e*((t+1)*e-t)*.5:.5*((e-=2)*e*((t+1)*e+t)+2)}},Bounce:{In:function(e){return 1-Cv.Easing.Bounce.Out(1-e)},Out:function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},InOut:function(e){return e<.5?.5*Cv.Easing.Bounce.In(2*e):.5*Cv.Easing.Bounce.Out(2*e-1)+.5}}},Cv.Interpolation={Linear:function(e,t){var i=e.length-1,n=i*t,r=Math.floor(n),a=Cv.Interpolation.Utils.Linear;return t<0?a(e[0],e[1],n):t>1?a(e[i],e[i-1],i-n):a(e[r],e[r+1>i?i:r+1],n-r)},Bezier:function(e,t){var i,n=0,r=e.length-1,a=Math.pow,o=Cv.Interpolation.Utils.Bernstein;for(i=0;i<=r;i++)n+=a(1-t,r-i)*a(t,i)*e[i]*o(r,i);return n},CatmullRom:function(e,t){var i=e.length-1,n=i*t,r=Math.floor(n),a=Cv.Interpolation.Utils.CatmullRom;return e[0]===e[i]?(t<0&&(r=Math.floor(n=i*(1+t))),a(e[(r-1+i)%i],e[r],e[(r+1)%i],e[(r+2)%i],n-r)):t<0?e[0]-(a(e[0],e[0],e[1],e[1],-n)-e[0]):t>1?e[i]-(a(e[i],e[i],e[i-1],e[i-1],n-i)-e[i]):a(e[r?r-1:0],e[r],e[i<r+1?i:r+1],e[i<r+2?i:r+2],n-r)},Utils:{Linear:function(e,t,i){return(t-e)*i+e},Bernstein:function(e,t){var i=Cv.Interpolation.Utils.Factorial;return i(e)/i(t)/i(e-t)},Factorial:(Tv=[1],function(e){var t,i=1;if(Tv[e])return Tv[e];for(t=e;t>1;t--)i*=t;return Tv[e]=i}),CatmullRom:function(e,t,i,n,r){var a=.5*(i-e),o=.5*(n-t),s=r*r;return(2*t-2*i+a+o)*(r*s)+(-3*t+3*i-2*a-o)*s+a*r+t}}};var Sv=Cv,Av={LINEAR_NONE:Sv.Easing.Linear.None,QUADRACTIC_IN:Sv.Easing.Quadratic.In,QUADRACTIC_OUT:Sv.Easing.Quadratic.Out,QUADRACTIC_IN_OUT:Sv.Easing.Quadratic.InOut,CUBIC_IN:Sv.Easing.Cubic.In,CUBIC_OUT:Sv.Easing.Cubic.Out,CUBIC_IN_OUT:Sv.Easing.Cubic.InOut,QUARTIC_IN:Sv.Easing.Quartic.In,QUARTIC_OUT:Sv.Easing.Quartic.Out,QUARTIC_IN_OUT:Sv.Easing.Quartic.InOut,QUINTIC_IN:Sv.Easing.Quintic.In,QUINTIC_OUT:Sv.Easing.Quintic.Out,QUINTIC_IN_OUT:Sv.Easing.Quintic.InOut,SINUSOIDAL_IN:Sv.Easing.Sinusoidal.In,SINUSOIDAL_OUT:Sv.Easing.Sinusoidal.Out,SINUSOIDAL_IN_OUT:Sv.Easing.Sinusoidal.InOut,EXPONENTIAL_IN:Sv.Easing.Exponential.In,EXPONENTIAL_OUT:Sv.Easing.Exponential.Out,EXPONENTIAL_IN_OUT:Sv.Easing.Exponential.InOut,CIRCULAR_IN:Sv.Easing.Circular.In,CIRCULAR_OUT:Sv.Easing.Circular.Out,CIRCULAR_IN_OUT:Sv.Easing.Circular.InOut,ELASTIC_IN:Sv.Easing.Elastic.In,ELASTIC_OUT:Sv.Easing.Elastic.Out,ELASTIC_IN_OUT:Sv.Easing.Elastic.InOut,BACK_IN:Sv.Easing.Back.In,BACK_OUT:Sv.Easing.Back.Out,BACK_IN_OUT:Sv.Easing.Back.InOut,BOUNCE_IN:Sv.Easing.Bounce.In,BOUNCE_OUT:Sv.Easing.Bounce.Out,BOUNCE_IN_OUT:Sv.Easing.Bounce.InOut},Pv=Object(E.a)(Av),Iv=new z,Dv=new z,jv=new z,Mv=new z,Rv=new z,Lv=new z(1,1,1),Nv=Math.cos,Fv=Math.sin;function kv(e){e=Object(w.a)(e,w.a.EMPTY_OBJECT);var t=Object(w.a)(e.radii,Lv),i=Math.round(Object(w.a)(e.stackPartitions,64)),n=Math.round(Object(w.a)(e.slicePartitions,64)),r=Object(w.a)(e.vertexFormat,Ba.DEFAULT);if(n<3)throw new h.a("options.slicePartitions cannot be less than three.");if(i<3)throw new h.a("options.stackPartitions cannot be less than three.");if(Object(u.a)(e.offsetAttribute)&&e.offsetAttribute===fn.TOP)throw new h.a("GeometryOffsetAttribute.TOP is not a supported options.offsetAttribute for this geometry.");this._radii=z.clone(t),this._stackPartitions=i,this._slicePartitions=n,this._vertexFormat=Ba.clone(r),this._offsetAttribute=e.offsetAttribute,this._workerName="createEllipsoidGeometry"}kv.packedLength=z.packedLength+Ba.packedLength+3,kv.pack=function(e,t,i){if(!Object(u.a)(e))throw new h.a("value is required");if(!Object(u.a)(t))throw new h.a("array is required");return i=Object(w.a)(i,0),z.pack(e._radii,t,i),i+=z.packedLength,Ba.pack(e._vertexFormat,t,i),i+=Ba.packedLength,t[i++]=e._stackPartitions,t[i++]=e._slicePartitions,t[i]=Object(w.a)(e._offsetAttribute,-1),t};var Bv,zv=new z,Uv=new Ba,Vv={radii:zv,vertexFormat:Uv,stackPartitions:void 0,slicePartitions:void 0,offsetAttribute:void 0};kv.unpack=function(e,t,i){if(!Object(u.a)(e))throw new h.a("array is required");t=Object(w.a)(t,0);var n=z.unpack(e,t,zv);t+=z.packedLength;var r=Ba.unpack(e,t,Uv);t+=Ba.packedLength;var a=e[t++],o=e[t++],s=e[t];return Object(u.a)(i)?(i._radii=z.clone(n,i._radii),i._vertexFormat=Ba.clone(r,i._vertexFormat),i._stackPartitions=a,i._slicePartitions=o,i._offsetAttribute=-1===s?void 0:s,i):(Vv.stackPartitions=a,Vv.slicePartitions=o,Vv.offsetAttribute=-1===s?void 0:s,new kv(Vv))},kv.createGeometry=function(e){var t=e._radii;if(!(t.x<=0||t.y<=0||t.z<=0)){var i,n,r=ae.fromCartesian3(t),a=e._vertexFormat,o=e._slicePartitions+1,s=e._stackPartitions+1,c=s*o,l=new Float64Array(3*c),h=6*(o-1)*(s-2),d=Sl.createTypedArray(c,h),f=a.normal?new Float32Array(3*c):void 0,p=a.tangent?new Float32Array(3*c):void 0,m=a.bitangent?new Float32Array(3*c):void 0,_=a.st?new Float32Array(2*c):void 0,g=new Array(o),v=new Array(o),b=0;for(i=0;i<o;i++){var y=I.TWO_PI*i/(o-1);g[i]=Nv(y),v[i]=Fv(y),l[b++]=0,l[b++]=0,l[b++]=t.z}for(i=1;i<s-1;i++){var w=Math.PI*i/(s-1),O=Fv(w),x=t.x*O,E=t.y*O,T=t.z*Nv(w);for(n=0;n<o;n++)l[b++]=g[n]*x,l[b++]=v[n]*E,l[b++]=T}for(i=0;i<o;i++)l[b++]=0,l[b++]=0,l[b++]=-t.z;var C=new Fa;a.position&&(C.position=new Na({componentDatatype:dn.DOUBLE,componentsPerAttribute:3,values:l}));var S,A,P=0,D=0,j=0,M=0;if(a.st||a.normal||a.tangent||a.bitangent){for(i=0;i<c;i++){var R=z.fromArray(l,3*i,Iv),L=r.geodeticSurfaceNormal(R,Dv);if(a.st){var N=Rt.negate(L,Rv);Rt.magnitude(N)<I.EPSILON6&&((b=3*(i+o*Math.floor(.5*s)))>l.length&&(b=3*(i-o*Math.floor(.5*s))),z.fromArray(l,b,N),r.geodeticSurfaceNormal(N,N),Rt.negate(N,N)),_[P++]=Math.atan2(N.y,N.x)/I.TWO_PI+.5,_[P++]=Math.asin(L.z)/Math.PI+.5}if(a.normal&&(f[D++]=L.x,f[D++]=L.y,f[D++]=L.z),a.tangent||a.bitangent){var F=jv;if(i<o||i>c-o-1?(z.cross(z.UNIT_X,L,F),z.normalize(F,F)):(z.cross(z.UNIT_Z,L,F),z.normalize(F,F)),a.tangent&&(p[j++]=F.x,p[j++]=F.y,p[j++]=F.z),a.bitangent){var k=z.cross(L,F,Mv);z.normalize(k,k),m[M++]=k.x,m[M++]=k.y,m[M++]=k.z}}}a.st&&(C.st=new Na({componentDatatype:dn.FLOAT,componentsPerAttribute:2,values:_})),a.normal&&(C.normal=new Na({componentDatatype:dn.FLOAT,componentsPerAttribute:3,values:f})),a.tangent&&(C.tangent=new Na({componentDatatype:dn.FLOAT,componentsPerAttribute:3,values:p})),a.bitangent&&(C.bitangent=new Na({componentDatatype:dn.FLOAT,componentsPerAttribute:3,values:m}))}if(Object(u.a)(e._offsetAttribute)){var B=l.length,U=new Uint8Array(B/3),V=e._offsetAttribute===fn.NONE?0:1;Qt(U,V),C.applyOffset=new Na({componentDatatype:dn.UNSIGNED_BYTE,componentsPerAttribute:1,values:U})}for(b=0,n=0;n<o-1;n++)d[b++]=o+n,d[b++]=o+n+1,d[b++]=n+1;for(i=1;i<s-2;i++)for(S=i*o,A=(i+1)*o,n=0;n<o-1;n++)d[b++]=A+n,d[b++]=A+n+1,d[b++]=S+n+1,d[b++]=A+n,d[b++]=S+n+1,d[b++]=S+n;for(S=(i=s-2)*o,A=(i+1)*o,n=0;n<o-1;n++)d[b++]=A+n,d[b++]=S+n+1,d[b++]=S+n;return new La({attributes:C,indices:d,primitiveType:yn.TRIANGLES,boundingSphere:St.fromEllipsoid(r),offsetAttribute:e._offsetAttribute})}},kv.getUnitEllipsoid=function(){return Object(u.a)(Bv)||(Bv=kv.createGeometry(new kv({radii:new z(1,1,1),vertexFormat:Ba.POSITION_ONLY}))),Bv};var Hv=kv,Gv=new z(1,1,1),qv=Math.cos,Wv=Math.sin;function Yv(e){e=Object(w.a)(e,w.a.EMPTY_OBJECT);var t=Object(w.a)(e.radii,Gv),i=Math.round(Object(w.a)(e.stackPartitions,10)),n=Math.round(Object(w.a)(e.slicePartitions,8)),r=Math.round(Object(w.a)(e.subdivisions,128));if(i<1)throw new h.a("options.stackPartitions cannot be less than 1");if(n<0)throw new h.a("options.slicePartitions cannot be less than 0");if(r<0)throw new h.a("options.subdivisions must be greater than or equal to zero.");if(Object(u.a)(e.offsetAttribute)&&e.offsetAttribute===fn.TOP)throw new h.a("GeometryOffsetAttribute.TOP is not a supported options.offsetAttribute for this geometry.");this._radii=z.clone(t),this._stackPartitions=i,this._slicePartitions=n,this._subdivisions=r,this._offsetAttribute=e.offsetAttribute,this._workerName="createEllipsoidOutlineGeometry"}Yv.packedLength=z.packedLength+4,Yv.pack=function(e,t,i){if(!Object(u.a)(e))throw new h.a("value is required");if(!Object(u.a)(t))throw new h.a("array is required");return i=Object(w.a)(i,0),z.pack(e._radii,t,i),i+=z.packedLength,t[i++]=e._stackPartitions,t[i++]=e._slicePartitions,t[i++]=e._subdivisions,t[i]=Object(w.a)(e._offsetAttribute,-1),t};var Xv=new z,Zv={radii:Xv,stackPartitions:void 0,slicePartitions:void 0,subdivisions:void 0,offsetAttribute:void 0};Yv.unpack=function(e,t,i){if(!Object(u.a)(e))throw new h.a("array is required");t=Object(w.a)(t,0);var n=z.unpack(e,t,Xv);t+=z.packedLength;var r=e[t++],a=e[t++],o=e[t++],s=e[t];return Object(u.a)(i)?(i._radii=z.clone(n,i._radii),i._stackPartitions=r,i._slicePartitions=a,i._subdivisions=o,i._offsetAttribute=-1===s?void 0:s,i):(Zv.stackPartitions=r,Zv.slicePartitions=a,Zv.subdivisions=o,Zv.offsetAttribute=-1===s?void 0:s,new Yv(Zv))},Yv.createGeometry=function(e){var t=e._radii;if(!(t.x<=0||t.y<=0||t.z<=0)){var i,n,r,a,o,s,c=ae.fromCartesian3(t),l=e._stackPartitions,h=e._slicePartitions,d=e._subdivisions,f=d*(l+h-1),p=f-h+2,m=new Float64Array(3*p),_=Sl.createTypedArray(p,2*f),g=0,v=new Array(d),b=new Array(d);for(i=0;i<d;i++)r=I.TWO_PI*i/d,v[i]=qv(r),b[i]=Wv(r);for(i=1;i<l;i++)for(a=Math.PI*i/l,o=qv(a),s=Wv(a),n=0;n<d;n++)m[g++]=t.x*v[n]*s,m[g++]=t.y*b[n]*s,m[g++]=t.z*o;for(v.length=h,b.length=h,i=0;i<h;i++)r=I.TWO_PI*i/h,v[i]=qv(r),b[i]=Wv(r);for(m[g++]=0,m[g++]=0,m[g++]=t.z,i=1;i<d;i++)for(a=Math.PI*i/d,o=qv(a),s=Wv(a),n=0;n<h;n++)m[g++]=t.x*v[n]*s,m[g++]=t.y*b[n]*s,m[g++]=t.z*o;for(m[g++]=0,m[g++]=0,m[g++]=-t.z,g=0,i=0;i<l-1;++i){var y=i*d;for(n=0;n<d-1;++n)_[g++]=y+n,_[g++]=y+n+1;_[g++]=y+d-1,_[g++]=y}var w=d*(l-1);for(n=1;n<h+1;++n)_[g++]=w,_[g++]=w+n;for(i=0;i<d-2;++i){var O=i*h+1+w,x=(i+1)*h+1+w;for(n=0;n<h-1;++n)_[g++]=x+n,_[g++]=O+n;_[g++]=x+h-1,_[g++]=O+h-1}var E=m.length/3-1;for(n=E-1;n>E-h-1;--n)_[g++]=E,_[g++]=n;var T=new Fa({position:new Na({componentDatatype:dn.DOUBLE,componentsPerAttribute:3,values:m})});if(Object(u.a)(e._offsetAttribute)){var C=m.length,S=new Uint8Array(C/3),A=e._offsetAttribute===fn.NONE?0:1;Qt(S,A),T.applyOffset=new Na({componentDatatype:dn.UNSIGNED_BYTE,componentsPerAttribute:1,values:S})}return new La({attributes:T,indices:_,primitiveType:yn.LINES,boundingSphere:St.fromEllipsoid(c),offsetAttribute:e._offsetAttribute})}};var Qv=Yv;function Kv(e){e=Object(w.a)(e,{}),this._tilingScheme=e.tilingScheme,Object(u.a)(this._tilingScheme)||(this._tilingScheme=new Nt({ellipsoid:Object(w.a)(e.ellipsoid,ae.WGS84)})),this._levelZeroMaximumGeometricError=vl.getEstimatedLevelZeroGeometricErrorForAHeightmap(this._tilingScheme.ellipsoid,64,this._tilingScheme.getNumberOfXTilesAtLevel(0)),this._errorEvent=new $o.a,this._readyPromise=Oi.a.resolve(!0)}Object(O.a)(Kv.prototype,{errorEvent:{get:function(){return this._errorEvent}},credit:{get:function(){}},tilingScheme:{get:function(){return this._tilingScheme}},ready:{get:function(){return!0}},readyPromise:{get:function(){return this._readyPromise}},hasWaterMask:{get:function(){return!1}},hasVertexNormals:{get:function(){return!1}}}),Kv.prototype.requestTileGeometry=function(e,t,i,n){return Oi.a.resolve(new Tl({buffer:new Uint8Array(256),width:16,height:16}))},Kv.prototype.getLevelMaximumGeometricError=function(e){return this._levelZeroMaximumGeometricError/(1<<e)},Kv.prototype.getTileDataAvailable=function(e,t,i){},Kv.prototype.loadTileDataAvailability=function(e,t,i){};var Jv=Kv;function $v(){this._removalFunctions=[]}$v.prototype.add=function(e,t,i){if(!Object(u.a)(e))throw new h.a("event is required");var n=e.addEventListener(t,i);this._removalFunctions.push(n);var r=this;return function(){n();var e=r._removalFunctions;e.splice(e.indexOf(n),1)}},$v.prototype.removeAll=function(){for(var e=this._removalFunctions,t=0,i=e.length;t<i;++t)e[t]();e.length=0};var eb=$v,tb=Object(E.a)({NONE:0,HOLD:1,EXTRAPOLATE:2});function ib(e){e=Object(w.a)(e,w.a.EMPTY_OBJECT),this.left=e.left,this._left=void 0,this.right=e.right,this._right=void 0,this.top=e.top,this._top=void 0,this.bottom=e.bottom,this._bottom=void 0,this.near=Object(w.a)(e.near,1),this._near=this.near,this.far=Object(w.a)(e.far,5e8),this._far=this.far,this._cullingVolume=new Wg,this._orthographicMatrix=new Be}function nb(e){if(!(Object(u.a)(e.right)&&Object(u.a)(e.left)&&Object(u.a)(e.top)&&Object(u.a)(e.bottom)&&Object(u.a)(e.near)&&Object(u.a)(e.far)))throw new h.a("right, left, top, bottom, near, or far parameters are not set.");if(e.top!==e._top||e.bottom!==e._bottom||e.left!==e._left||e.right!==e._right||e.near!==e._near||e.far!==e._far){if(e.left>e.right)throw new h.a("right must be greater than left.");if(e.bottom>e.top)throw new h.a("top must be greater than bottom.");if(e.near<=0||e.near>e.far)throw new h.a("near must be greater than zero and less than far.");e._left=e.left,e._right=e.right,e._top=e.top,e._bottom=e.bottom,e._near=e.near,e._far=e.far,e._orthographicMatrix=Be.computeOrthographicOffCenter(e.left,e.right,e.bottom,e.top,e.near,e.far,e._orthographicMatrix)}}Object(O.a)(ib.prototype,{projectionMatrix:{get:function(){return nb(this),this._orthographicMatrix}}});var rb=new z,ab=new z,ob=new z,sb=new z;ib.prototype.computeCullingVolume=function(e,t,i){if(!Object(u.a)(e))throw new h.a("position is required.");if(!Object(u.a)(t))throw new h.a("direction is required.");if(!Object(u.a)(i))throw new h.a("up is required.");var n=this._cullingVolume.planes,r=this.top,a=this.bottom,o=this.right,s=this.left,c=this.near,l=this.far,d=z.cross(t,i,rb);z.normalize(d,d);var f=ab;z.multiplyByScalar(t,c,f),z.add(e,f,f);var p=ob;z.multiplyByScalar(d,s,p),z.add(f,p,p);var m=n[0];return Object(u.a)(m)||(m=n[0]=new Te),m.x=d.x,m.y=d.y,m.z=d.z,m.w=-z.dot(d,p),z.multiplyByScalar(d,o,p),z.add(f,p,p),m=n[1],Object(u.a)(m)||(m=n[1]=new Te),m.x=-d.x,m.y=-d.y,m.z=-d.z,m.w=-z.dot(z.negate(d,sb),p),z.multiplyByScalar(i,a,p),z.add(f,p,p),m=n[2],Object(u.a)(m)||(m=n[2]=new Te),m.x=i.x,m.y=i.y,m.z=i.z,m.w=-z.dot(i,p),z.multiplyByScalar(i,r,p),z.add(f,p,p),m=n[3],Object(u.a)(m)||(m=n[3]=new Te),m.x=-i.x,m.y=-i.y,m.z=-i.z,m.w=-z.dot(z.negate(i,sb),p),m=n[4],Object(u.a)(m)||(m=n[4]=new Te),m.x=t.x,m.y=t.y,m.z=t.z,m.w=-z.dot(t,f),z.multiplyByScalar(t,l,p),z.add(e,p,p),m=n[5],Object(u.a)(m)||(m=n[5]=new Te),m.x=-t.x,m.y=-t.y,m.z=-t.z,m.w=-z.dot(z.negate(t,sb),p),this._cullingVolume},ib.prototype.getPixelDimensions=function(e,t,i,n){if(nb(this),!Object(u.a)(e)||!Object(u.a)(t))throw new h.a("Both drawingBufferWidth and drawingBufferHeight are required.");if(e<=0)throw new h.a("drawingBufferWidth must be greater than zero.");if(t<=0)throw new h.a("drawingBufferHeight must be greater than zero.");if(!Object(u.a)(i))throw new h.a("distance is required.");if(!Object(u.a)(n))throw new h.a("A result object is required.");var r=(this.right-this.left)/e,a=(this.top-this.bottom)/t;return n.x=r,n.y=a,n},ib.prototype.clone=function(e){return Object(u.a)(e)||(e=new ib),e.left=this.left,e.right=this.right,e.top=this.top,e.bottom=this.bottom,e.near=this.near,e.far=this.far,e._left=void 0,e._right=void 0,e._top=void 0,e._bottom=void 0,e._near=void 0,e._far=void 0,e},ib.prototype.equals=function(e){return Object(u.a)(e)&&e instanceof ib&&this.right===e.right&&this.left===e.left&&this.top===e.top&&this.bottom===e.bottom&&this.near===e.near&&this.far===e.far},ib.prototype.equalsEpsilon=function(e,t,i){return e===this||Object(u.a)(e)&&e instanceof ib&&I.equalsEpsilon(this.right,e.right,t,i)&&I.equalsEpsilon(this.left,e.left,t,i)&&I.equalsEpsilon(this.top,e.top,t,i)&&I.equalsEpsilon(this.bottom,e.bottom,t,i)&&I.equalsEpsilon(this.near,e.near,t,i)&&I.equalsEpsilon(this.far,e.far,t,i)};var cb=ib;function lb(e){e=Object(w.a)(e,w.a.EMPTY_OBJECT),this._offCenterFrustum=new cb,this.width=e.width,this._width=void 0,this.aspectRatio=e.aspectRatio,this._aspectRatio=void 0,this.near=Object(w.a)(e.near,1),this._near=this.near,this.far=Object(w.a)(e.far,5e8),this._far=this.far}function ub(e){if(!(Object(u.a)(e.width)&&Object(u.a)(e.aspectRatio)&&Object(u.a)(e.near)&&Object(u.a)(e.far)))throw new h.a("width, aspectRatio, near, or far parameters are not set.");var t=e._offCenterFrustum;if(e.width!==e._width||e.aspectRatio!==e._aspectRatio||e.near!==e._near||e.far!==e._far){if(e.aspectRatio<0)throw new h.a("aspectRatio must be positive.");if(e.near<0||e.near>e.far)throw new h.a("near must be greater than zero and less than far.");e._aspectRatio=e.aspectRatio,e._width=e.width,e._near=e.near,e._far=e.far;var i=1/e.aspectRatio;t.right=.5*e.width,t.left=-t.right,t.top=i*t.right,t.bottom=-t.top,t.near=e.near,t.far=e.far}}lb.packedLength=4,lb.pack=function(e,t,i){return x.a.typeOf.object("value",e),x.a.defined("array",t),i=Object(w.a)(i,0),t[i++]=e.width,t[i++]=e.aspectRatio,t[i++]=e.near,t[i]=e.far,t},lb.unpack=function(e,t,i){return x.a.defined("array",e),t=Object(w.a)(t,0),Object(u.a)(i)||(i=new lb),i.width=e[t++],i.aspectRatio=e[t++],i.near=e[t++],i.far=e[t],i},Object(O.a)(lb.prototype,{projectionMatrix:{get:function(){return ub(this),this._offCenterFrustum.projectionMatrix}}}),lb.prototype.computeCullingVolume=function(e,t,i){return ub(this),this._offCenterFrustum.computeCullingVolume(e,t,i)},lb.prototype.getPixelDimensions=function(e,t,i,n){return ub(this),this._offCenterFrustum.getPixelDimensions(e,t,i,n)},lb.prototype.clone=function(e){return Object(u.a)(e)||(e=new lb),e.aspectRatio=this.aspectRatio,e.width=this.width,e.near=this.near,e.far=this.far,e._aspectRatio=void 0,e._width=void 0,e._near=void 0,e._far=void 0,this._offCenterFrustum.clone(e._offCenterFrustum),e},lb.prototype.equals=function(e){return!!(Object(u.a)(e)&&e instanceof lb)&&(ub(this),ub(e),this.width===e.width&&this.aspectRatio===e.aspectRatio&&this._offCenterFrustum.equals(e._offCenterFrustum))},lb.prototype.equalsEpsilon=function(e,t,i){return!!(Object(u.a)(e)&&e instanceof lb)&&(ub(this),ub(e),I.equalsEpsilon(this.width,e.width,t,i)&&I.equalsEpsilon(this.aspectRatio,e.aspectRatio,t,i)&&this._offCenterFrustum.equalsEpsilon(e._offCenterFrustum,t,i))};var hb=lb;function db(e){e=Object(w.a)(e,w.a.EMPTY_OBJECT),this.left=e.left,this._left=void 0,this.right=e.right,this._right=void 0,this.top=e.top,this._top=void 0,this.bottom=e.bottom,this._bottom=void 0,this.near=Object(w.a)(e.near,1),this._near=this.near,this.far=Object(w.a)(e.far,5e8),this._far=this.far,this._cullingVolume=new Wg,this._perspectiveMatrix=new Be,this._infinitePerspective=new Be}function fb(e){if(!(Object(u.a)(e.right)&&Object(u.a)(e.left)&&Object(u.a)(e.top)&&Object(u.a)(e.bottom)&&Object(u.a)(e.near)&&Object(u.a)(e.far)))throw new h.a("right, left, top, bottom, near, or far parameters are not set.");var t=e.top,i=e.bottom,n=e.right,r=e.left,a=e.near,o=e.far;if(t!==e._top||i!==e._bottom||r!==e._left||n!==e._right||a!==e._near||o!==e._far){if(e.near<=0||e.near>e.far)throw new h.a("near must be greater than zero and less than far.");e._left=r,e._right=n,e._top=t,e._bottom=i,e._near=a,e._far=o,e._perspectiveMatrix=Be.computePerspectiveOffCenter(r,n,i,t,a,o,e._perspectiveMatrix),e._infinitePerspective=Be.computeInfinitePerspectiveOffCenter(r,n,i,t,a,e._infinitePerspective)}}Object(O.a)(db.prototype,{projectionMatrix:{get:function(){return fb(this),this._perspectiveMatrix}},infiniteProjectionMatrix:{get:function(){return fb(this),this._infinitePerspective}}});var pb=new z,mb=new z,_b=new z,gb=new z;db.prototype.computeCullingVolume=function(e,t,i){if(!Object(u.a)(e))throw new h.a("position is required.");if(!Object(u.a)(t))throw new h.a("direction is required.");if(!Object(u.a)(i))throw new h.a("up is required.");var n=this._cullingVolume.planes,r=this.top,a=this.bottom,o=this.right,s=this.left,c=this.near,l=this.far,d=z.cross(t,i,pb),f=mb;z.multiplyByScalar(t,c,f),z.add(e,f,f);var p=_b;z.multiplyByScalar(t,l,p),z.add(e,p,p);var m=gb;z.multiplyByScalar(d,s,m),z.add(f,m,m),z.subtract(m,e,m),z.normalize(m,m),z.cross(m,i,m),z.normalize(m,m);var _=n[0];return Object(u.a)(_)||(_=n[0]=new Te),_.x=m.x,_.y=m.y,_.z=m.z,_.w=-z.dot(m,e),z.multiplyByScalar(d,o,m),z.add(f,m,m),z.subtract(m,e,m),z.cross(i,m,m),z.normalize(m,m),_=n[1],Object(u.a)(_)||(_=n[1]=new Te),_.x=m.x,_.y=m.y,_.z=m.z,_.w=-z.dot(m,e),z.multiplyByScalar(i,a,m),z.add(f,m,m),z.subtract(m,e,m),z.cross(d,m,m),z.normalize(m,m),_=n[2],Object(u.a)(_)||(_=n[2]=new Te),_.x=m.x,_.y=m.y,_.z=m.z,_.w=-z.dot(m,e),z.multiplyByScalar(i,r,m),z.add(f,m,m),z.subtract(m,e,m),z.cross(m,d,m),z.normalize(m,m),_=n[3],Object(u.a)(_)||(_=n[3]=new Te),_.x=m.x,_.y=m.y,_.z=m.z,_.w=-z.dot(m,e),_=n[4],Object(u.a)(_)||(_=n[4]=new Te),_.x=t.x,_.y=t.y,_.z=t.z,_.w=-z.dot(t,f),z.negate(t,m),_=n[5],Object(u.a)(_)||(_=n[5]=new Te),_.x=m.x,_.y=m.y,_.z=m.z,_.w=-z.dot(m,p),this._cullingVolume},db.prototype.getPixelDimensions=function(e,t,i,n){if(fb(this),!Object(u.a)(e)||!Object(u.a)(t))throw new h.a("Both drawingBufferWidth and drawingBufferHeight are required.");if(e<=0)throw new h.a("drawingBufferWidth must be greater than zero.");if(t<=0)throw new h.a("drawingBufferHeight must be greater than zero.");if(!Object(u.a)(i))throw new h.a("distance is required.");if(!Object(u.a)(n))throw new h.a("A result object is required.");var r=1/this.near,a=this.top*r,o=2*i*a/t,s=2*i*(a=this.right*r)/e;return n.x=s,n.y=o,n},db.prototype.clone=function(e){return Object(u.a)(e)||(e=new db),e.right=this.right,e.left=this.left,e.top=this.top,e.bottom=this.bottom,e.near=this.near,e.far=this.far,e._left=void 0,e._right=void 0,e._top=void 0,e._bottom=void 0,e._near=void 0,e._far=void 0,e},db.prototype.equals=function(e){return Object(u.a)(e)&&e instanceof db&&this.right===e.right&&this.left===e.left&&this.top===e.top&&this.bottom===e.bottom&&this.near===e.near&&this.far===e.far},db.prototype.equalsEpsilon=function(e,t,i){return e===this||Object(u.a)(e)&&e instanceof db&&I.equalsEpsilon(this.right,e.right,t,i)&&I.equalsEpsilon(this.left,e.left,t,i)&&I.equalsEpsilon(this.top,e.top,t,i)&&I.equalsEpsilon(this.bottom,e.bottom,t,i)&&I.equalsEpsilon(this.near,e.near,t,i)&&I.equalsEpsilon(this.far,e.far,t,i)};var vb=db;function bb(e){e=Object(w.a)(e,w.a.EMPTY_OBJECT),this._offCenterFrustum=new vb,this.fov=e.fov,this._fov=void 0,this._fovy=void 0,this._sseDenominator=void 0,this.aspectRatio=e.aspectRatio,this._aspectRatio=void 0,this.near=Object(w.a)(e.near,1),this._near=this.near,this.far=Object(w.a)(e.far,5e8),this._far=this.far,this.xOffset=Object(w.a)(e.xOffset,0),this._xOffset=this.xOffset,this.yOffset=Object(w.a)(e.yOffset,0),this._yOffset=this.yOffset}function yb(e){if(!(Object(u.a)(e.fov)&&Object(u.a)(e.aspectRatio)&&Object(u.a)(e.near)&&Object(u.a)(e.far)))throw new h.a("fov, aspectRatio, near, or far parameters are not set.");var t=e._offCenterFrustum;if(e.fov!==e._fov||e.aspectRatio!==e._aspectRatio||e.near!==e._near||e.far!==e._far||e.xOffset!==e._xOffset||e.yOffset!==e._yOffset){if(e.fov<0||e.fov>=Math.PI)throw new h.a("fov must be in the range [0, PI).");if(e.aspectRatio<0)throw new h.a("aspectRatio must be positive.");if(e.near<0||e.near>e.far)throw new h.a("near must be greater than zero and less than far.");e._aspectRatio=e.aspectRatio,e._fov=e.fov,e._fovy=e.aspectRatio>1?e.fov:2*Math.atan(Math.tan(.5*e.fov)/e.aspectRatio),e._near=e.near,e._far=e.far,e._sseDenominator=2*Math.tan(.5*e._fovy),e._xOffset=e.xOffset,e._yOffset=e.yOffset,t.top=e.near*Math.tan(.5*e._fovy),t.bottom=-t.top,t.right=e.aspectRatio*t.top,t.left=-t.right,t.near=e.near,t.far=e.far,t.right+=e.xOffset,t.left+=e.xOffset,t.top+=e.yOffset,t.bottom+=e.yOffset}}bb.packedLength=6,bb.pack=function(e,t,i){return x.a.typeOf.object("value",e),x.a.defined("array",t),i=Object(w.a)(i,0),t[i++]=e.fov,t[i++]=e.aspectRatio,t[i++]=e.near,t[i++]=e.far,t[i++]=e.xOffset,t[i]=e.yOffset,t},bb.unpack=function(e,t,i){return x.a.defined("array",e),t=Object(w.a)(t,0),Object(u.a)(i)||(i=new bb),i.fov=e[t++],i.aspectRatio=e[t++],i.near=e[t++],i.far=e[t++],i.xOffset=e[t++],i.yOffset=e[t],i},Object(O.a)(bb.prototype,{projectionMatrix:{get:function(){return yb(this),this._offCenterFrustum.projectionMatrix}},infiniteProjectionMatrix:{get:function(){return yb(this),this._offCenterFrustum.infiniteProjectionMatrix}},fovy:{get:function(){return yb(this),this._fovy}},sseDenominator:{get:function(){return yb(this),this._sseDenominator}}}),bb.prototype.computeCullingVolume=function(e,t,i){return yb(this),this._offCenterFrustum.computeCullingVolume(e,t,i)},bb.prototype.getPixelDimensions=function(e,t,i,n){return yb(this),this._offCenterFrustum.getPixelDimensions(e,t,i,n)},bb.prototype.clone=function(e){return Object(u.a)(e)||(e=new bb),e.aspectRatio=this.aspectRatio,e.fov=this.fov,e.near=this.near,e.far=this.far,e._aspectRatio=void 0,e._fov=void 0,e._near=void 0,e._far=void 0,this._offCenterFrustum.clone(e._offCenterFrustum),e},bb.prototype.equals=function(e){return!!(Object(u.a)(e)&&e instanceof bb)&&(yb(this),yb(e),this.fov===e.fov&&this.aspectRatio===e.aspectRatio&&this._offCenterFrustum.equals(e._offCenterFrustum))},bb.prototype.equalsEpsilon=function(e,t,i){return!!(Object(u.a)(e)&&e instanceof bb)&&(yb(this),yb(e),I.equalsEpsilon(this.fov,e.fov,t,i)&&I.equalsEpsilon(this.aspectRatio,e.aspectRatio,t,i)&&this._offCenterFrustum.equalsEpsilon(e._offCenterFrustum,t,i))};var wb=bb,Ob=0,xb=1;function Eb(e){x.a.typeOf.object("options",e),x.a.typeOf.object("options.frustum",e.frustum),x.a.typeOf.object("options.origin",e.origin),x.a.typeOf.object("options.orientation",e.orientation);var t,i,n=e.frustum,r=e.orientation,a=e.origin,o=Object(w.a)(e.vertexFormat,Ba.DEFAULT),s=Object(w.a)(e._drawNearPlane,!0);n instanceof wb?(t=Ob,i=wb.packedLength):n instanceof hb&&(t=xb,i=hb.packedLength),this._frustumType=t,this._frustum=n.clone(),this._origin=z.clone(a),this._orientation=Kn.clone(r),this._drawNearPlane=s,this._vertexFormat=o,this._workerName="createFrustumGeometry",this.packedLength=2+i+z.packedLength+Kn.packedLength+Ba.packedLength}Eb.pack=function(e,t,i){x.a.typeOf.object("value",e),x.a.defined("array",t),i=Object(w.a)(i,0);var n=e._frustumType,r=e._frustum;return t[i++]=n,n===Ob?(wb.pack(r,t,i),i+=wb.packedLength):(hb.pack(r,t,i),i+=hb.packedLength),z.pack(e._origin,t,i),i+=z.packedLength,Kn.pack(e._orientation,t,i),i+=Kn.packedLength,Ba.pack(e._vertexFormat,t,i),t[i+=Ba.packedLength]=e._drawNearPlane?1:0,t};var Tb=new wb,Cb=new hb,Sb=new Kn,Ab=new z,Pb=new Ba;function Ib(e,t,i,n,r,a,o,s){for(var c=e/3*2,l=0;l<4;++l)Object(u.a)(t)&&(t[e]=a.x,t[e+1]=a.y,t[e+2]=a.z),Object(u.a)(i)&&(i[e]=o.x,i[e+1]=o.y,i[e+2]=o.z),Object(u.a)(n)&&(n[e]=s.x,n[e+1]=s.y,n[e+2]=s.z),e+=3;r[c]=0,r[c+1]=0,r[c+2]=1,r[c+3]=0,r[c+4]=1,r[c+5]=1,r[c+6]=0,r[c+7]=1}Eb.unpack=function(e,t,i){x.a.defined("array",e),t=Object(w.a)(t,0);var n,r=e[t++];r===Ob?(n=wb.unpack(e,t,Tb),t+=wb.packedLength):(n=hb.unpack(e,t,Cb),t+=hb.packedLength);var a=z.unpack(e,t,Ab);t+=z.packedLength;var o=Kn.unpack(e,t,Sb);t+=Kn.packedLength;var s=Ba.unpack(e,t,Pb),c=1===e[t+=Ba.packedLength];if(!Object(u.a)(i))return new Eb({frustum:n,origin:a,orientation:o,vertexFormat:s,_drawNearPlane:c});var l=r===i._frustumType?i._frustum:void 0;return i._frustum=n.clone(l),i._frustumType=r,i._origin=z.clone(a,i._origin),i._orientation=Kn.clone(o,i._orientation),i._vertexFormat=Ba.clone(s,i._vertexFormat),i._drawNearPlane=c,i};var Db=new be,jb=new Be,Mb=new Be,Rb=new z,Lb=new z,Nb=new z,Fb=new z,kb=new z,Bb=new z,zb=new Array(3),Ub=new Array(4);Ub[0]=new Te(-1,-1,1,1),Ub[1]=new Te(1,-1,1,1),Ub[2]=new Te(1,1,1,1),Ub[3]=new Te(-1,1,1,1);for(var Vb=new Array(4),Hb=0;Hb<4;++Hb)Vb[Hb]=new Te;Eb._computeNearFarPlanes=function(e,t,i,n,r,a,o,s){var c=be.fromQuaternion(t,Db),l=Object(w.a)(a,Rb),h=Object(w.a)(o,Lb),d=Object(w.a)(s,Nb);l=be.getColumn(c,0,l),h=be.getColumn(c,1,h),d=be.getColumn(c,2,d),z.normalize(l,l),z.normalize(h,h),z.normalize(d,d),z.negate(l,l);var f,p,m=Be.computeView(e,d,h,l,jb);if(i===Ob){var _=n.projectionMatrix,g=Be.multiply(_,m,Mb);p=Be.inverse(g,Mb)}else f=Be.inverseTransformation(m,Mb);Object(u.a)(p)?(zb[0]=n.near,zb[1]=n.far):(zb[0]=0,zb[1]=n.near,zb[2]=n.far);for(var v=0;v<2;++v)for(var b=0;b<4;++b){var y=Te.clone(Ub[b],Vb[b]);if(Object(u.a)(p)){var O=1/(y=Be.multiplyByVector(p,y,y)).w;z.multiplyByScalar(y,O,y),z.subtract(y,e,y),z.normalize(y,y);var x=z.dot(d,y);z.multiplyByScalar(y,zb[v]/x,y),z.add(y,e,y)}else{Object(u.a)(n._offCenterFrustum)&&(n=n._offCenterFrustum);var E=zb[v],T=zb[v+1];y.x=.5*(y.x*(n.right-n.left)+n.left+n.right),y.y=.5*(y.y*(n.top-n.bottom)+n.bottom+n.top),y.z=.5*(y.z*(E-T)-E-T),y.w=1,Be.multiplyByVector(f,y,y)}r[12*v+3*b]=y.x,r[12*v+3*b+1]=y.y,r[12*v+3*b+2]=y.z}},Eb.createGeometry=function(e){var t=e._frustumType,i=e._frustum,n=e._origin,r=e._orientation,a=e._drawNearPlane,o=e._vertexFormat,s=a?6:5,c=new Float64Array(72);Eb._computeNearFarPlanes(n,r,t,i,c);var l=24;c[l]=c[12],c[l+1]=c[13],c[l+2]=c[14],c[l+3]=c[0],c[l+4]=c[1],c[l+5]=c[2],c[l+6]=c[9],c[l+7]=c[10],c[l+8]=c[11],c[l+9]=c[21],c[l+10]=c[22],c[l+11]=c[23],c[l+=12]=c[15],c[l+1]=c[16],c[l+2]=c[17],c[l+3]=c[3],c[l+4]=c[4],c[l+5]=c[5],c[l+6]=c[0],c[l+7]=c[1],c[l+8]=c[2],c[l+9]=c[12],c[l+10]=c[13],c[l+11]=c[14],c[l+=12]=c[3],c[l+1]=c[4],c[l+2]=c[5],c[l+3]=c[15],c[l+4]=c[16],c[l+5]=c[17],c[l+6]=c[18],c[l+7]=c[19],c[l+8]=c[20],c[l+9]=c[6],c[l+10]=c[7],c[l+11]=c[8],c[l+=12]=c[6],c[l+1]=c[7],c[l+2]=c[8],c[l+3]=c[18],c[l+4]=c[19],c[l+5]=c[20],c[l+6]=c[21],c[l+7]=c[22],c[l+8]=c[23],c[l+9]=c[9],c[l+10]=c[10],c[l+11]=c[11],a||(c=c.subarray(12));var h=new Fa({position:new Na({componentDatatype:dn.DOUBLE,componentsPerAttribute:3,values:c})});if(Object(u.a)(o.normal)||Object(u.a)(o.tangent)||Object(u.a)(o.bitangent)||Object(u.a)(o.st)){var d=Object(u.a)(o.normal)?new Float32Array(12*s):void 0,f=Object(u.a)(o.tangent)?new Float32Array(12*s):void 0,p=Object(u.a)(o.bitangent)?new Float32Array(12*s):void 0,m=Object(u.a)(o.st)?new Float32Array(8*s):void 0,_=Rb,g=Lb,v=Nb,b=z.negate(_,Fb),y=z.negate(g,kb),w=z.negate(v,Bb);l=0,a&&(Ib(l,d,f,p,m,w,_,g),l+=12),Ib(l,d,f,p,m,v,b,g),Ib(l+=12,d,f,p,m,b,w,g),Ib(l+=12,d,f,p,m,y,w,b),Ib(l+=12,d,f,p,m,_,v,g),Ib(l+=12,d,f,p,m,g,v,b),Object(u.a)(d)&&(h.normal=new Na({componentDatatype:dn.FLOAT,componentsPerAttribute:3,values:d})),Object(u.a)(f)&&(h.tangent=new Na({componentDatatype:dn.FLOAT,componentsPerAttribute:3,values:f})),Object(u.a)(p)&&(h.bitangent=new Na({componentDatatype:dn.FLOAT,componentsPerAttribute:3,values:p})),Object(u.a)(m)&&(h.st=new Na({componentDatatype:dn.FLOAT,componentsPerAttribute:2,values:m}))}for(var O=new Uint16Array(6*s),x=0;x<s;++x){var E=6*x,T=4*x;O[E]=T,O[E+1]=T+1,O[E+2]=T+2,O[E+3]=T,O[E+4]=T+2,O[E+5]=T+3}return new La({attributes:h,indices:O,primitiveType:yn.TRIANGLES,boundingSphere:St.fromVertices(c)})};var Gb=Eb,qb=0,Wb=1;function Yb(e){x.a.typeOf.object("options",e),x.a.typeOf.object("options.frustum",e.frustum),x.a.typeOf.object("options.origin",e.origin),x.a.typeOf.object("options.orientation",e.orientation);var t,i,n=e.frustum,r=e.orientation,a=e.origin,o=Object(w.a)(e._drawNearPlane,!0);n instanceof wb?(t=qb,i=wb.packedLength):n instanceof hb&&(t=Wb,i=hb.packedLength),this._frustumType=t,this._frustum=n.clone(),this._origin=z.clone(a),this._orientation=Kn.clone(r),this._drawNearPlane=o,this._workerName="createFrustumOutlineGeometry",this.packedLength=2+i+z.packedLength+Kn.packedLength}Yb.pack=function(e,t,i){x.a.typeOf.object("value",e),x.a.defined("array",t),i=Object(w.a)(i,0);var n=e._frustumType,r=e._frustum;return t[i++]=n,n===qb?(wb.pack(r,t,i),i+=wb.packedLength):(hb.pack(r,t,i),i+=hb.packedLength),z.pack(e._origin,t,i),i+=z.packedLength,Kn.pack(e._orientation,t,i),t[i+=Kn.packedLength]=e._drawNearPlane?1:0,t};var Xb=new wb,Zb=new hb,Qb=new Kn,Kb=new z;Yb.unpack=function(e,t,i){x.a.defined("array",e),t=Object(w.a)(t,0);var n,r=e[t++];r===qb?(n=wb.unpack(e,t,Xb),t+=wb.packedLength):(n=hb.unpack(e,t,Zb),t+=hb.packedLength);var a=z.unpack(e,t,Kb);t+=z.packedLength;var o=Kn.unpack(e,t,Qb),s=1===e[t+=Kn.packedLength];if(!Object(u.a)(i))return new Yb({frustum:n,origin:a,orientation:o,_drawNearPlane:s});var c=r===i._frustumType?i._frustum:void 0;return i._frustum=n.clone(c),i._frustumType=r,i._origin=z.clone(a,i._origin),i._orientation=Kn.clone(o,i._orientation),i._drawNearPlane=s,i},Yb.createGeometry=function(e){var t=e._frustumType,i=e._frustum,n=e._origin,r=e._orientation,a=e._drawNearPlane,o=new Float64Array(24);Gb._computeNearFarPlanes(n,r,t,i,o);for(var s,c,l=new Fa({position:new Na({componentDatatype:dn.DOUBLE,componentsPerAttribute:3,values:o})}),u=a?2:1,h=new Uint16Array(8*(u+1)),d=a?0:1;d<2;++d)c=4*d,h[s=a?8*d:0]=c,h[s+1]=c+1,h[s+2]=c+1,h[s+3]=c+2,h[s+4]=c+2,h[s+5]=c+3,h[s+6]=c+3,h[s+7]=c;for(d=0;d<2;++d)c=4*d,h[s=8*(u+d)]=c,h[s+1]=c+4,h[s+2]=c+1,h[s+3]=c+5,h[s+4]=c+2,h[s+5]=c+6,h[s+6]=c+3,h[s+7]=c+7;return new La({attributes:l,indices:h,primitiveType:yn.LINES,boundingSphere:St.fromVertices(o)})};var Jb=Yb;function $b(){}$b.prototype.geocode=h.a.throwInstantiationError;var ey=$b,ty=Object(E.a)({SEARCH:0,AUTOCOMPLETE:1});var iy=function(e){if(e=Object(w.a)(e,w.a.EMPTY_OBJECT),!Object(u.a)(e.componentDatatype))throw new h.a("options.componentDatatype is required.");if(!Object(u.a)(e.componentsPerAttribute))throw new h.a("options.componentsPerAttribute is required.");if(e.componentsPerAttribute<1||e.componentsPerAttribute>4)throw new h.a("options.componentsPerAttribute must be between 1 and 4.");if(!Object(u.a)(e.value))throw new h.a("options.value is required.");this.componentDatatype=e.componentDatatype,this.componentsPerAttribute=e.componentsPerAttribute,this.normalize=Object(w.a)(e.normalize,!1),this.value=e.value},ny=n(105),ry=n(80);var ay=function(e){if(!Object(u.a)(e))throw new h.a("uri is required.");var t=new Co.a(e);t.normalize();var i=t.path,n=i.lastIndexOf("/");return-1!==n&&(i=i.substr(n+1)),i},oy={};var sy=function(e,t,i){Object(u.a)(t)||(t=e.width),Object(u.a)(i)||(i=e.height);var n=oy[t];Object(u.a)(n)||(n={},oy[t]=n);var r=n[i];if(!Object(u.a)(r)){var a=document.createElement("canvas");a.width=t,a.height=i,(r=a.getContext("2d")).globalCompositeOperation="copy",n[i]=r}return r.drawImage(e,0,0,t,i),r.getImageData(0,0,t,i).data};var cy=function(e,t){return t=Object(w.a)(t,0),is(e,t,Math.min(4,e.length))},ly=n(86);var uy=function(e,t){return 0!=(e&t)},hy=[1,2,4,8];function dy(e,t,i,n,r,a){this._bits=e,this.cnodeVersion=t,this.imageryVersion=i,this.terrainVersion=n,this.imageryProvider=r,this.terrainProvider=a,this.ancestorHasTerrain=!1,this.terrainState=void 0}dy.clone=function(e,t){return Object(u.a)(t)?(t._bits=e._bits,t.cnodeVersion=e.cnodeVersion,t.imageryVersion=e.imageryVersion,t.terrainVersion=e.terrainVersion,t.imageryProvider=e.imageryProvider,t.terrainProvider=e.terrainProvider):t=new dy(e._bits,e.cnodeVersion,e.imageryVersion,e.terrainVersion,e.imageryProvider,e.terrainProvider),t.ancestorHasTerrain=e.ancestorHasTerrain,t.terrainState=e.terrainState,t},dy.prototype.setParent=function(e){this.ancestorHasTerrain=e.ancestorHasTerrain||this.hasTerrain()},dy.prototype.hasSubtree=function(){return uy(this._bits,16)},dy.prototype.hasImagery=function(){return uy(this._bits,64)},dy.prototype.hasTerrain=function(){return uy(this._bits,128)},dy.prototype.hasChildren=function(){return uy(this._bits,15)},dy.prototype.hasChild=function(e){return uy(this._bits,hy[e])},dy.prototype.getChildBitmask=function(){return 15&this._bits};var fy=dy,py=n(84);var my=function(e){for(var t=e.length,i=new ArrayBuffer(t),n=new Uint8Array(i),r=0;r<t;++r)n[r]=e.charCodeAt(r);return i}('Eô½\vyâjE",ÍqøIFgQ\0B%Æèa,f)\bÆ4Üjb%y\nwmiÖðk¡½NuàA[ß@V\fÙ»r|3SîOlÔq°{ÀEVZ­wUe\v3*¬l5Å0sø3>mF8J´Ýð.ÝuÚDt"úa"\f3"So¯9D\v9Ù9L¹¿«\\P_"uxéqh;ÁÄð<VqH\'UfYNeu£aF}a?A\0×´4MÎF°Õ¸\'{Ü+»Mg0ÈÑö\\Pú[/Fn5/\'C.ë\n\f^¥se4ål.jC\'c#U©?q{gC}:¯ÍâTUýKÆâ/(íË\\Æ-f§;/*"N°k.Ý\r}}GºC²²+>Mª>}æÎIÆæx\fa1-¤O¥~q ì\r1èN\v\0nPh}=\b\r¦n£h$[kó#ó¶s³\r\v@ÀØQ]ú".jßI\0¹ wUÆïj¿{GLîÜÜF©­S+S4ÿYä8è1N¹XFkË-#p\x005"Ï1²&/çÃu-6,rt°#G·ÓÑ&7râ\0DÏÚ3-Þ`i#i*|ÍKQ\rT9w.)ê¦P¢joP\\>TûïP[\vEm(w7ÛJfJo åpâ¹q~\fmI-zþrÇòY0»]såÉ êxì ðB|G`°½&·q¶ÇÑ3=Ó«îcÈ+S D\\qÆÌD2O<ÊÀ)=RÓaX©}e´ÜÏ\rô=ñ\b©BÚ#\tØ¿^PIøMÀËGLO÷{+ØÅ1;µoÜl\rÑÛ?âéÚ_ÔâFaZÞUÏ¤\0¾ýÎgñJiæ HØ]~®q N®ÀV©<rçvì)IÖ]-ãÛ6©;fjÕ¶=P^R¹KÇsWxÉô.YoÐKW>\'\'Ç`Û;íSD>?mw¢\në?R¨ÆU^1I7ôÅ&-©¿\'TÚÃj å*x°Öprªh½÷_H±~ÀXL?fù>áeÀp§Ï8i¯ðVldI\'­xtOÂÞV9\0Úw\vË-û5Oõ\bQ`Á\nZGM&30xÚÀFGâ[y`In7gS\n>éìF9²ñ4\rÆSuná\fYÙÞ){II¥wy¾IV.6ç\v:»Ob{ÒM1/½8{¨O!áìFpv})"x\nÝ\\ÚÞQÏðüYRe|3ßóHÚ»*uÛ`²Ôüíì5¨ÿ(1-ÈÜF|["');function _y(e){x.a.defined("resourceOrUrl",e);var t=e;"string"==typeof t||t instanceof f.a||(x.a.typeOf.string("resourceOrUrl.url",e.url),t=e.url);var i=f.a.createIfNeeded(t);i.appendForwardSlash(),this._resource=i,this.imageryPresent=!0,this.protoImagery=void 0,this.terrainPresent=!0,this.negativeAltitudeExponentBias=32,this.negativeAltitudeThreshold=I.EPSILON12,this.providers={},this.key=void 0,this._quadPacketVersion=1,this._tileInfo={},this._subtreePromises={};var n=this;this._readyPromise=function(e){var t=e._resource.getDerivedResource({url:"dbRoot.v5",queryParameters:{output:"proto"}});if(!Object(u.a)(vy)){var i=y("ThirdParty/google-earth-dbroot-parser.js"),n=window.cesiumGoogleEarthDbRootParser;vy=Object(py.a)(i).then((function(){gy=window.cesiumGoogleEarthDbRootParser(ly.a),Object(u.a)(n)?window.cesiumGoogleEarthDbRootParser=n:delete window.cesiumGoogleEarthDbRootParser}))}return vy.then((function(){return t.fetchArrayBuffer()})).then((function(t){var i=gy.EncryptedDbRootProto.decode(new Uint8Array(t)),n=i.encryptionData,r=n.byteOffset,a=r+n.byteLength,o=e.key=n.buffer.slice(r,a);a=(r=(n=i.dbrootData).byteOffset)+n.byteLength;var s=n.buffer.slice(r,a);return by.scheduleTask({buffer:s,type:"DbRoot",key:o},[s])})).then((function(t){var i=gy.DbRootProto.decode(new Uint8Array(t.buffer));if(e.imageryPresent=Object(w.a)(i.imageryPresent,e.imageryPresent),e.protoImagery=i.protoImagery,e.terrainPresent=Object(w.a)(i.terrainPresent,e.terrainPresent),Object(u.a)(i.endSnippet)&&Object(u.a)(i.endSnippet.model)){var n=i.endSnippet.model;e.negativeAltitudeExponentBias=Object(w.a)(n.negativeAltitudeExponentBias,e.negativeAltitudeExponentBias),e.negativeAltitudeThreshold=Object(w.a)(n.compressedNegativeAltitudeThreshold,e.negativeAltitudeThreshold)}Object(u.a)(i.databaseVersion)&&(e._quadPacketVersion=Object(w.a)(i.databaseVersion.quadtreeVersion,e._quadPacketVersion));for(var r=e.providers,a=Object(w.a)(i.providerInfo,[]),o=a.length,s=0;s<o;++s){var c=a[s],l=c.copyrightString;Object(u.a)(l)&&(r[c.providerId]=new Jo(l.value))}})).otherwise((function(){console.log("Failed to retrieve "+t.url+". Using defaults."),e.key=my}))}(this).then((function(){return n.getQuadTreePacket("",n._quadPacketVersion)})).then((function(){return!0})).otherwise((function(e){var t="An error occurred while accessing "+yy(n,"",1).url+".";return Oi.a.reject(new Ce.a(t))}))}Object(O.a)(_y.prototype,{url:{get:function(){return this._resource.url}},proxy:{get:function(){return this._resource.proxy}},resource:{get:function(){return this._resource}},readyPromise:{get:function(){return this._readyPromise}}}),_y.tileXYToQuadKey=function(e,t,i){for(var n="",r=i;r>=0;--r){var a=1<<r,o=0;uy(t,a)?uy(e,a)&&(o|=1):(o|=2,uy(e,a)||(o|=1)),n+=o}return n},_y.quadKeyToTileXY=function(e){for(var t=0,i=0,n=e.length-1,r=n;r>=0;--r){var a=1<<r,o=+e[n-r];uy(o,2)?uy(o,1)||(t|=a):(i|=a,uy(o,1)&&(t|=a))}return{x:t,y:i,level:n}},_y.prototype.isValid=function(e){var t=this.getTileInformationFromQuadKey(e);if(Object(u.a)(t))return null!==t;for(var i,n=!0,r=e;r.length>1;){if(i=r.substring(r.length-1),r=r.substring(0,r.length-1),t=this.getTileInformationFromQuadKey(r),Object(u.a)(t)){t.hasSubtree()||t.hasChild(parseInt(i))||(n=!1);break}if(null===t){n=!1;break}}return n};var gy,vy,by=new pl("decodeGoogleEarthEnterprisePacket",Number.POSITIVE_INFINITY);function yy(e,t,i,n){return e._resource.getDerivedResource({url:"flatfile?q2-0"+t+"-q."+i.toString(),request:n})}_y.prototype.getQuadTreePacket=function(e,t,i){t=Object(w.a)(t,1);var n=yy(this,e=Object(w.a)(e,""),t,i).fetchArrayBuffer();if(Object(u.a)(n)){var r=this._tileInfo,a=this.key;return n.then((function(t){return by.scheduleTask({buffer:t,quadKey:e,type:"Metadata",key:a},[t]).then((function(t){var i,n=-1;if(""!==e){n=e.length+1;var a=t[e];(i=r[e])._bits|=a._bits,delete t[e]}var o=Object.keys(t);o.sort((function(e,t){return e.length-t.length}));for(var s=o.length,c=0;c<s;++c){var l=o[c];if(null!==t[l]){var u=fy.clone(t[l]),h=l.length;if(h===n)u.setParent(i);else if(h>1){var d=r[l.substring(0,l.length-1)];u.setParent(d)}r[l]=u}else r[l]=null}}))}))}},_y.prototype.populateSubtree=function(e,t,i,n){return function e(t,i,n){var r,a=t._tileInfo,o=i,s=a[o];if(Object(u.a)(s)&&(!s.hasSubtree()||s.hasChildren()))return s;for(;void 0===s&&o.length>1;)o=o.substring(0,o.length-1),s=a[o];var c=t._subtreePromises,l=c[o];if(Object(u.a)(l))return l.then((function(){return r=new Vl.a({throttle:n.throttle,throttleByServer:n.throttleByServer,type:n.type,priorityFunction:n.priorityFunction}),e(t,i,r)}));if(!Object(u.a)(s)||!s.hasSubtree())return Oi.a.reject(new Ce.a("Couldn't load metadata for tile "+i));if(l=t.getQuadTreePacket(o,s.cnodeVersion,n),!Object(u.a)(l))return;return c[o]=l,l.then((function(){return r=new Vl.a({throttle:n.throttle,throttleByServer:n.throttleByServer,type:n.type,priorityFunction:n.priorityFunction}),e(t,i,r)})).always((function(){delete c[o]}))}(this,_y.tileXYToQuadKey(e,t,i),n)},_y.prototype.getTileInformation=function(e,t,i){var n=_y.tileXYToQuadKey(e,t,i);return this._tileInfo[n]},_y.prototype.getTileInformationFromQuadKey=function(e){return this._tileInfo[e]};var wy=_y;function Oy(e){e=Object(w.a)(e,w.a.EMPTY_OBJECT),x.a.typeOf.object("options.buffer",e.buffer),x.a.typeOf.number("options.negativeAltitudeExponentBias",e.negativeAltitudeExponentBias),x.a.typeOf.number("options.negativeElevationThreshold",e.negativeElevationThreshold),this._buffer=e.buffer,this._credits=e.credits,this._negativeAltitudeExponentBias=e.negativeAltitudeExponentBias,this._negativeElevationThreshold=e.negativeElevationThreshold;var t=Object(w.a)(e.childTileMask,15),i=3&t;i|=4&t?8:0,i|=8&t?4:0,this._childTileMask=i,this._createdByUpsampling=Object(w.a)(e.createdByUpsampling,!1),this._skirtHeight=void 0,this._bufferType=this._buffer.constructor,this._mesh=void 0,this._minimumHeight=void 0,this._maximumHeight=void 0,this._vertexCountWithoutSkirts=void 0,this._skirtIndex=void 0}Object(O.a)(Oy.prototype,{credits:{get:function(){return this._credits}},waterMask:{get:function(){}}});var xy=new pl("createVerticesFromGoogleEarthEnterpriseBuffer"),Ey=new Ve,Ty=new Ve;Oy.prototype.createMesh=function(e,t,i,n,r){x.a.typeOf.object("tilingScheme",e),x.a.typeOf.number("x",t),x.a.typeOf.number("y",i),x.a.typeOf.number("level",n);var a=e.ellipsoid;e.tileXYToNativeRectangle(t,i,n,Ey),e.tileXYToRectangle(t,i,n,Ty),r=Object(w.a)(r,1);var o=a.cartographicToCartesian(Ve.center(Ty)),s=40075.16/(1<<n);this._skirtHeight=Math.min(8*s,1e3);var c=xy.scheduleTask({buffer:this._buffer,nativeRectangle:Ey,rectangle:Ty,relativeToCenter:o,ellipsoid:a,skirtHeight:this._skirtHeight,exaggeration:r,includeWebMercatorT:!0,negativeAltitudeExponentBias:this._negativeAltitudeExponentBias,negativeElevationThreshold:this._negativeElevationThreshold});if(Object(u.a)(c)){var l=this;return c.then((function(e){return l._mesh=new ml(o,new Float32Array(e.vertices),new Uint16Array(e.indices),e.minimumHeight,e.maximumHeight,e.boundingSphere3D,e.occludeePointInScaledSpace,e.numberOfAttributes,e.orientedBoundingBox,Xc.clone(e.encoding),r),l._vertexCountWithoutSkirts=e.vertexCountWithoutSkirts,l._skirtIndex=e.skirtIndex,l._minimumHeight=e.minimumHeight,l._maximumHeight=e.maximumHeight,l._buffer=void 0,l._mesh}))}},Oy.prototype.interpolateHeight=function(e,t,i){var n=I.clamp((t-e.west)/e.width,0,1),r=I.clamp((i-e.south)/e.height,0,1);return Object(u.a)(this._mesh)?function(e,t,i){for(var n=e._mesh,r=n.vertices,a=n.encoding,o=n.indices,s=0,c=o.length;s<c;s+=3){var l=o[s],u=o[s+1],h=o[s+2],d=a.decodeTextureCoordinates(r,l,Sy),f=a.decodeTextureCoordinates(r,u,Ay),p=a.decodeTextureCoordinates(r,h,Py),m=Pl.computeBarycentricCoordinates(t,i,d.x,d.y,f.x,f.y,p.x,p.y,Iy);if(m.x>=-1e-15&&m.y>=-1e-15&&m.z>=-1e-15){var _=a.decodeHeight(r,l),g=a.decodeHeight(r,u),v=a.decodeHeight(r,h);return m.x*_+m.y*g+m.z*v}}return}(this,n,r):function(e,t,i,n){var r=e._buffer,a=0,o=0,s=0;i>.5?(t>.5?(a=2,o=.5):a=3,s=.5):t>.5&&(a=1,o=.5);for(var c=new DataView(r),l=0,u=0;u<a;++u)l+=c.getUint32(l,!0),l+=jy;l+=jy,l+=2*Ly;var h=I.toRadians(180*c.getFloat64(l,!0));l+=Ly;var d=I.toRadians(180*c.getFloat64(l,!0));l+=Ly;var f=n.width/h/2,p=n.height/d/2,m=c.getInt32(l,!0);l+=My;var _=3*c.getInt32(l,!0);l+=My,l+=My;var g,v=new Array(m),b=new Array(m),y=new Array(m);for(g=0;g<m;++g)v[g]=o+c.getUint8(l++)*f,b[g]=s+c.getUint8(l++)*p,y[g]=6371010*c.getFloat32(l,!0),l+=Ry;var w=new Array(_);for(g=0;g<_;++g)w[g]=c.getUint16(l,!0),l+=Dy;for(g=0;g<_;g+=3){var O=w[g],x=w[g+1],E=w[g+2],T=v[O],C=v[x],S=v[E],A=b[O],P=b[x],D=b[E],j=Pl.computeBarycentricCoordinates(t,i,T,A,C,P,S,D,Iy);if(j.x>=-1e-15&&j.y>=-1e-15&&j.z>=-1e-15)return j.x*y[O]+j.y*y[x]+j.z*y[E]}return}(this,n,r,e)};var Cy=new pl("upsampleQuantizedTerrainMesh");Oy.prototype.upsample=function(e,t,i,n,r,a,o){if(x.a.typeOf.object("tilingScheme",e),x.a.typeOf.number("thisX",t),x.a.typeOf.number("thisY",i),x.a.typeOf.number("thisLevel",n),x.a.typeOf.number("descendantX",r),x.a.typeOf.number("descendantY",a),x.a.typeOf.number("descendantLevel",o),o-n>1)throw new h.a("Upsampling through more than one level at a time is not currently supported.");var s=this._mesh;if(Object(u.a)(this._mesh)){var c=2*t!==r,l=2*i===a,d=e.ellipsoid,f=e.tileXYToRectangle(r,a,o),p=Cy.scheduleTask({vertices:s.vertices,vertexCountWithoutSkirts:this._vertexCountWithoutSkirts,indices:s.indices,skirtIndex:this._skirtIndex,encoding:s.encoding,minimumHeight:this._minimumHeight,maximumHeight:this._maximumHeight,isEastChild:c,isNorthChild:l,childRectangle:f,ellipsoid:d,exaggeration:s.exaggeration});if(Object(u.a)(p)){var m=this;return p.then((function(e){var t=new Uint16Array(e.vertices),i=Sl.createTypedArray(t.length/3,e.indices),n=m._skirtHeight;return new Ul({quantizedVertices:t,indices:i,minimumHeight:e.minimumHeight,maximumHeight:e.maximumHeight,boundingSphere:St.clone(e.boundingSphere),orientedBoundingBox:Fc.clone(e.orientedBoundingBox),horizonOcclusionPoint:z.clone(e.horizonOcclusionPoint),westIndices:e.westIndices,southIndices:e.southIndices,eastIndices:e.eastIndices,northIndices:e.northIndices,westSkirtHeight:n,southSkirtHeight:n,eastSkirtHeight:n,northSkirtHeight:n,childTileMask:0,createdByUpsampling:!0,credits:m._credits})}))}}},Oy.prototype.isChildAvailable=function(e,t,i,n){x.a.typeOf.number("thisX",e),x.a.typeOf.number("thisY",t),x.a.typeOf.number("childX",i),x.a.typeOf.number("childY",n);var r=2;return i!==2*e&&++r,n!==2*t&&(r-=2),0!=(this._childTileMask&1<<r)},Oy.prototype.wasCreatedByUpsampling=function(){return this._createdByUpsampling};var Sy=new Rt,Ay=new Rt,Py=new Rt,Iy=new z;var Dy=Uint16Array.BYTES_PER_ELEMENT,jy=Uint32Array.BYTES_PER_ELEMENT,My=Int32Array.BYTES_PER_ELEMENT,Ry=Float32Array.BYTES_PER_ELEMENT,Ly=Float64Array.BYTES_PER_ELEMENT;var Ny=Oy,Fy=n(17),ky={UNKNOWN:0,NONE:1,SELF:2,PARENT:3},By=new Tr;function zy(){this._terrainCache={},this._lastTidy=Tr.now()}function Uy(e){if(e=Object(w.a)(e,{}),!Object(u.a)(e.url)&&!Object(u.a)(e.metadata))throw new h.a("options.url or options.metadata is required.");var t;if(Object(u.a)(e.metadata))t=e.metadata;else{var i=f.a.createIfNeeded(e.url);t=new wy(i)}this._metadata=t,this._tilingScheme=new Nt({numberOfLevelZeroTilesX:2,numberOfLevelZeroTilesY:2,rectangle:new Ve(-I.PI,-I.PI,I.PI,I.PI),ellipsoid:e.ellipsoid});var n=e.credit;"string"==typeof n&&(n=new Jo(n)),this._credit=n,this._levelZeroMaximumGeometricError=40075.16,this._terrainCache=new zy,this._terrainPromises={},this._terrainRequests={},this._errorEvent=new $o.a,this._ready=!1;var r,a=this;this._readyPromise=t.readyPromise.then((function(e){if(!t.terrainPresent){var i=new Ce.a("The server "+t.url+" doesn't have terrain");return r=uu.handleError(r,a,a._errorEvent,i.message,void 0,void 0,void 0,i),Oi.a.reject(i)}return uu.handleSuccess(r),a._ready=e,e})).otherwise((function(e){return r=uu.handleError(r,a,a._errorEvent,e.message,void 0,void 0,void 0,e),Oi.a.reject(e)}))}zy.prototype.add=function(e,t){this._terrainCache[e]={buffer:t,timestamp:Tr.now()}},zy.prototype.get=function(e){var t=this._terrainCache[e];if(Object(u.a)(t))return delete this._terrainCache[e],t.buffer},zy.prototype.tidy=function(){if(Tr.now(By),Tr.secondsDifference(By,this._lastTidy)>10){for(var e=this._terrainCache,t=Object.keys(e),i=t.length,n=0;n<i;++n){var r=t[n],a=e[r];Tr.secondsDifference(By,a.timestamp)>10&&delete e[r]}Tr.clone(By,this._lastTidy)}},Object(O.a)(Uy.prototype,{url:{get:function(){return this._metadata.url}},proxy:{get:function(){return this._metadata.proxy}},tilingScheme:{get:function(){if(!this._ready)throw new h.a("tilingScheme must not be called before the imagery provider is ready.");return this._tilingScheme}},errorEvent:{get:function(){return this._errorEvent}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise}},credit:{get:function(){return this._credit}},hasWaterMask:{get:function(){return!1}},hasVertexNormals:{get:function(){return!1}},availability:{get:function(){}}});var Vy=new pl("decodeGoogleEarthEnterprisePacket",Number.POSITIVE_INFINITY);function Hy(e,t,i){var n=t.getChildBitmask();if(t.terrainState===ky.PARENT){n=0;for(var r=0;r<4;++r){var a=i.getTileInformationFromQuadKey(e+r.toString());Object(u.a)(a)&&a.hasTerrain()&&(n|=1<<r)}}return n}Uy.prototype.requestTileGeometry=function(e,t,i,n){if(!this._ready)throw new h.a("requestTileGeometry must not be called before the terrain provider is ready.");var r=wy.tileXYToQuadKey(e,t,i),a=this._terrainCache,o=this._metadata,s=o.getTileInformationFromQuadKey(r);if(!Object(u.a)(s))return Oi.a.reject(new Ce.a("Terrain tile doesn't exist"));var c=s.terrainState;Object(u.a)(c)||(c=s.terrainState=ky.UNKNOWN);var l,d=a.get(r);if(Object(u.a)(d)){var f=o.providers[s.terrainProvider];return Oi.a.resolve(new Ny({buffer:d,childTileMask:Hy(r,s,o),credits:Object(u.a)(f)?[f]:void 0,negativeAltitudeExponentBias:o.negativeAltitudeExponentBias,negativeElevationThreshold:o.negativeAltitudeThreshold}))}if(a.tidy(),!s.ancestorHasTerrain)return Oi.a.resolve(new Tl({buffer:new Uint8Array(256),width:16,height:16}));if(c===ky.NONE)return Oi.a.reject(new Ce.a("Terrain tile doesn't exist"));var p=r,m=-1;switch(c){case ky.SELF:m=s.terrainVersion;break;case ky.PARENT:p=p.substring(0,p.length-1),m=(l=o.getTileInformationFromQuadKey(p)).terrainVersion;break;case ky.UNKNOWN:s.hasTerrain()?m=s.terrainVersion:(p=p.substring(0,p.length-1),l=o.getTileInformationFromQuadKey(p),Object(u.a)(l)&&l.hasTerrain()&&(m=l.terrainVersion))}if(m<0)return Oi.a.reject(new Ce.a("Terrain tile doesn't exist"));var _,g,v=this._terrainPromises,b=this._terrainRequests;if(Object(u.a)(v[p]))_=v[p],g=b[p];else{var y=function(e,t,i,n){return i=Object(u.a)(i)&&i>0?i:1,e._metadata.resource.getDerivedResource({url:"flatfile?f1c-0"+t+"-t."+i.toString(),request:n})}(this,p,m,g=n).fetchArrayBuffer();if(!Object(u.a)(y))return;_=y.then((function(e){return Object(u.a)(e)?Vy.scheduleTask({buffer:e,type:"Terrain",key:o.key},[e]).then((function(e){var t=o.getTileInformationFromQuadKey(p);t.terrainState=ky.SELF,a.add(p,e[0]);for(var i=t.terrainProvider,n=e.length-1,r=0;r<n;++r){var s=p+r.toString(),c=o.getTileInformationFromQuadKey(s);Object(u.a)(c)&&(a.add(s,e[r+1]),c.terrainState=ky.PARENT,0===c.terrainProvider&&(c.terrainProvider=i))}})):Oi.a.reject(new Ce.a("Failed to load terrain."))})),v[p]=_,b[p]=g,_=_.always((function(){delete v[p],delete b[p]}))}return _.then((function(){var e=a.get(r);if(Object(u.a)(e)){var t=o.providers[s.terrainProvider];return new Ny({buffer:e,childTileMask:Hy(r,s,o),credits:Object(u.a)(t)?[t]:void 0,negativeAltitudeExponentBias:o.negativeAltitudeExponentBias,negativeElevationThreshold:o.negativeAltitudeThreshold})}return Oi.a.reject(new Ce.a("Failed to load terrain."))})).otherwise((function(e){return g.state===Fy.a.CANCELLED?(n.state=g.state,Oi.a.reject(e)):(s.terrainState=ky.NONE,Oi.a.reject(e))}))},Uy.prototype.getLevelMaximumGeometricError=function(e){return this._levelZeroMaximumGeometricError/(1<<e)},Uy.prototype.getTileDataAvailable=function(e,t,i){var n=this._metadata,r=wy.tileXYToQuadKey(e,t,i),a=n.getTileInformation(e,t,i);if(null===a)return!1;if(Object(u.a)(a)){if(!a.ancestorHasTerrain)return!0;var o=a.terrainState;if(o===ky.NONE)return!1;if(!(Object(u.a)(o)&&o!==ky.UNKNOWN||(a.terrainState=ky.UNKNOWN,a.hasTerrain()))){r=r.substring(0,r.length-1);var s=n.getTileInformationFromQuadKey(r);if(!Object(u.a)(s)||!s.hasTerrain())return!1}return!0}if(n.isValid(r)){var c=new Vl.a({throttle:!0,throttleByServer:!0,type:Hl.a.TERRAIN});n.populateSubtree(e,t,i,c)}return!1},Uy.prototype.loadTileDataAvailability=function(e,t,i){};var Gy=Uy,qy=[se,Qc],Wy=qy.length,Yy=Math.cos(I.toRadians(30)),Xy=Math.cos(I.toRadians(150)),Zy=0,Qy=1e3;function Ky(e){var t=(e=Object(w.a)(e,w.a.EMPTY_OBJECT)).positions;if(!Object(u.a)(t)||t.length<2)throw new h.a("At least two positions are required.");if(Object(u.a)(e.arcType)&&e.arcType!==Zt.GEODESIC&&e.arcType!==Zt.RHUMB)throw new h.a("Valid options for arcType are ArcType.GEODESIC and ArcType.RHUMB.");this.width=Object(w.a)(e.width,1),this._positions=t,this.granularity=Object(w.a)(e.granularity,9999),this.loop=Object(w.a)(e.loop,!1),this.arcType=Object(w.a)(e.arcType,Zt.GEODESIC),this._ellipsoid=ae.WGS84,this._projectionIndex=0,this._workerName="createGroundPolylineGeometry",this._scene3DOnly=!1}Object(O.a)(Ky.prototype,{packedLength:{get:function(){return 1+3*this._positions.length+1+1+1+ae.packedLength+1+1}}}),Ky.setProjectionAndEllipsoid=function(e,t){for(var i=0,n=0;n<Wy;n++)if(t instanceof qy[n]){i=n;break}e._projectionIndex=i,e._ellipsoid=t.ellipsoid};var Jy=new z,$y=new z,ew=new z;function tw(e,t,i,n,r){var a=cw(n,e,0,Jy),o=cw(n,e,i,$y),s=cw(n,t,0,ew),c=lw(o,a,$y),l=lw(s,a,ew);return z.cross(l,c,r),z.normalize(r,r)}var iw=new K,nw=new z,rw=new z,aw=new z;function ow(e,t,i,n,r,a,o,s,c,l,u){if(0!==r){var h;a===Zt.GEODESIC?h=new bm(e,t,o):a===Zt.RHUMB&&(h=new Df(e,t,o));var d=h.surfaceDistance;if(!(d<r))for(var f=tw(e,t,n,o,aw),p=Math.ceil(d/r),m=d/p,_=m,g=p-1,v=s.length,b=0;b<g;b++){var y=h.interpolateUsingSurfaceDistance(_,iw),w=cw(o,y,i,nw),O=cw(o,y,n,rw);z.pack(f,s,v),z.pack(w,c,v),z.pack(O,l,v),u.push(y.latitude),u.push(y.longitude),v+=3,_+=m}}}var sw=new K;function cw(e,t,i,n){return K.clone(t,sw),sw.height=i,K.toCartesian(sw,e,n)}function lw(e,t,i){return z.subtract(e,t,i),z.normalize(i,i),i}Ky.pack=function(e,t,i){x.a.typeOf.object("value",e),x.a.defined("array",t);var n=Object(w.a)(i,0),r=e._positions,a=r.length;t[n++]=a;for(var o=0;o<a;++o){var s=r[o];z.pack(s,t,n),n+=3}return t[n++]=e.granularity,t[n++]=e.loop?1:0,t[n++]=e.arcType,ae.pack(e._ellipsoid,t,n),n+=ae.packedLength,t[n++]=e._projectionIndex,t[n++]=e._scene3DOnly?1:0,t},Ky.unpack=function(e,t,i){x.a.defined("array",e);for(var n=Object(w.a)(t,0),r=e[n++],a=new Array(r),o=0;o<r;o++)a[o]=z.unpack(e,n),n+=3;var s=e[n++],c=1===e[n++],l=e[n++],h=ae.unpack(e,n);n+=ae.packedLength;var d=e[n++],f=1===e[n++];if(!Object(u.a)(i)){var p=new Ky({positions:a,granularity:s,loop:c,arcType:l,ellipsoid:h});return p._projectionIndex=d,p._scene3DOnly=f,p}return i._positions=a,i.granularity=s,i.loop=c,i.arcType=l,i._ellipsoid=h,i._projectionIndex=d,i._scene3DOnly=f,i};var uw=new z,hw=new z,dw=new z,fw=new z,pw=new oc(z.UNIT_X,0),mw=new z,_w=0;function gw(e,t,i,n,r){var a=lw(i,t,mw),o=lw(e,t,uw),s=lw(n,t,hw),c=z.cross(a,o,fw);c=z.normalize(c,c);var l=oc.fromPointNormal(t,c,pw),u=oc.getPointDistance(l,n);if(I.equalsEpsilon(u,0,I.EPSILON7))return z.clone(c,r),r;r=z.add(s,o,r),r=z.normalize(r,r);var h=z.cross(a,r,dw);return z.normalize(h,h),z.cross(h,a,r),z.normalize(r,r),z.dot(s,h)<_w&&(r=z.negate(r,r)),r}var vw=oc.fromPointNormal(z.ZERO,z.UNIT_Y),bw=new z,yw=new z,ww=new z,Ow=new z,xw=new z,Ew=new z,Tw=new K,Cw=new K,Sw=new K;Ky.createGeometry=function(e){var t,i,n,r,a,o,s=!e._scene3DOnly,c=e.loop,l=e._ellipsoid,h=e.granularity,d=e.arcType,f=new qy[e._projectionIndex](l),p=Zy,m=Qy,_=e._positions,g=_.length;2===g&&(c=!1);var v,b,y,w=new Df(void 0,void 0,l),O=[_[0]];for(i=0;i<g-1;i++)n=_[i],r=_[i+1],v=tc.lineSegmentPlane(n,r,vw,Ew),!Object(u.a)(v)||z.equalsEpsilon(v,n,I.EPSILON7)||z.equalsEpsilon(v,r,I.EPSILON7)||(e.arcType===Zt.GEODESIC?O.push(z.clone(v)):e.arcType===Zt.RHUMB&&(y=l.cartesianToCartographic(v,Tw).longitude,a=l.cartesianToCartographic(n,Tw),o=l.cartesianToCartographic(r,Cw),w.setEndPoints(a,o),b=w.findIntersectionWithLongitude(y,Sw),v=l.cartographicToCartesian(b,Ew),!Object(u.a)(v)||z.equalsEpsilon(v,n,I.EPSILON7)||z.equalsEpsilon(v,r,I.EPSILON7)||O.push(z.clone(v)))),O.push(r);c&&(n=_[g-1],r=_[0],v=tc.lineSegmentPlane(n,r,vw,Ew),!Object(u.a)(v)||z.equalsEpsilon(v,n,I.EPSILON7)||z.equalsEpsilon(v,r,I.EPSILON7)||(e.arcType===Zt.GEODESIC?O.push(z.clone(v)):e.arcType===Zt.RHUMB&&(y=l.cartesianToCartographic(v,Tw).longitude,a=l.cartesianToCartographic(n,Tw),o=l.cartesianToCartographic(r,Cw),w.setEndPoints(a,o),b=w.findIntersectionWithLongitude(y,Sw),v=l.cartographicToCartesian(b,Ew),!Object(u.a)(v)||z.equalsEpsilon(v,n,I.EPSILON7)||z.equalsEpsilon(v,r,I.EPSILON7)||O.push(z.clone(v)))));var x=O.length,E=new Array(x);for(i=0;i<x;i++){var T=K.fromCartesian(O[i],l);T.height=0,E[i]=T}if(!((x=(E=$t(E,K.equalsEpsilon)).length)<2)){var C=[],S=[],A=[],P=[],D=bw,j=yw,M=ww,R=Ow,L=xw,N=E[0],F=E[1];for(D=cw(l,E[x-1],p,D),R=cw(l,F,p,R),j=cw(l,N,p,j),M=cw(l,N,m,M),L=c?gw(D,j,M,R,L):tw(N,F,m,l,L),z.pack(L,S,0),z.pack(j,A,0),z.pack(M,P,0),C.push(N.latitude),C.push(N.longitude),ow(N,F,p,m,h,d,l,S,A,P,C),i=1;i<x-1;++i){D=z.clone(j,D),j=z.clone(R,j);var k=E[i];cw(l,k,m,M),cw(l,E[i+1],p,R),gw(D,j,M,R,L),t=S.length,z.pack(L,S,t),z.pack(j,A,t),z.pack(M,P,t),C.push(k.latitude),C.push(k.longitude),ow(E[i],E[i+1],p,m,h,d,l,S,A,P,C)}var B=E[x-1],U=E[x-2];if(j=cw(l,B,p,j),M=cw(l,B,m,M),c){var V=E[0];L=gw(D=cw(l,U,p,D),j,M,R=cw(l,V,p,R),L)}else L=tw(U,B,m,l,L);if(t=S.length,z.pack(L,S,t),z.pack(j,A,t),z.pack(M,P,t),C.push(B.latitude),C.push(B.longitude),c){for(ow(B,N,p,m,h,d,l,S,A,P,C),t=S.length,i=0;i<3;++i)S[t+i]=S[i],A[t+i]=A[i],P[t+i]=P[i];C.push(N.latitude),C.push(N.longitude)}return function(e,t,i,n,r,a,o){var s,c,l,u,h,d,f=t._ellipsoid,p=i.length/3-1,m=8*p,_=4*m,g=36*p,v=m>65535?new Uint32Array(g):new Uint16Array(g),b=new Float64Array(3*m),y=new Float32Array(_),w=new Float32Array(_),O=new Float32Array(_),x=new Float32Array(_),E=new Float32Array(_);o&&(l=new Float32Array(_),u=new Float32Array(_),h=new Float32Array(_),d=new Float32Array(2*m));var T=a.length/2,C=0,S=Vw;S.height=0;var A=Hw;A.height=0;var P=Gw,D=qw;if(o)for(c=0,s=1;s<T;s++)S.latitude=a[c],S.longitude=a[c+1],A.latitude=a[c+2],A.longitude=a[c+3],P=t.project(S,P),D=t.project(A,D),C+=z.distance(P,D),c+=2;var j=n.length/3;D=z.unpack(n,0,D);var M,R=0;for(c=3,s=1;s<j;s++)P=z.clone(D,P),D=z.unpack(n,c,D),R+=z.distance(P,D),c+=3;c=3;var L=0,N=0,F=0,k=0,B=!1,U=z.unpack(i,0,Yw),V=z.unpack(n,0,qw),H=z.unpack(r,0,Zw);if(e){var G=z.unpack(i,i.length-6,Ww);Dw(H,G,U,V)&&(H=z.negate(H,H))}var q=0,W=0,Y=0;for(s=0;s<p;s++){var X,Z,Q,K,J=z.clone(U,Ww),$=z.clone(V,Gw),ee=z.clone(H,Xw);if(B&&(ee=z.negate(ee,ee)),U=z.unpack(i,c,Yw),V=z.unpack(n,c,qw),H=z.unpack(r,c,Zw),B=Dw(H,J,U,V),S.latitude=a[L],S.longitude=a[L+1],A.latitude=a[L+2],A.longitude=a[L+3],o){var te=Uw(S,A);X=t.project(S,iO);var ie=lw(Z=t.project(A,nO),X,pO);ie.y=Math.abs(ie.y),Q=rO,K=aO,0===te||z.dot(ie,z.UNIT_Y)>Yy?(Q=Lw(t,S,ee,X,rO),K=Lw(t,A,H,Z,aO)):1===te?(K=Lw(t,A,H,Z,aO),Q.x=0,Q.y=I.sign(S.longitude-Math.abs(A.longitude)),Q.z=0):(Q=Lw(t,S,ee,X,rO),K.x=0,K.y=I.sign(S.longitude-A.longitude),K.z=0)}var ne=z.distance($,V),re=Fu.fromCartesian(J,dO),ae=z.subtract(U,J,oO),oe=z.normalize(ae,lO),se=z.subtract($,J,sO);se=z.normalize(se,se);var ce=z.cross(oe,se,lO);ce=z.normalize(ce,ce);var le=z.cross(se,ee,uO);le=z.normalize(le,le);var ue=z.subtract(V,U,cO);ue=z.normalize(ue,ue);var he=z.cross(H,ue,hO);he=z.normalize(he,he);var de,fe,pe,me=ne/R,_e=q/R,ge=0,ve=0,be=0;if(o){ge=z.distance(X,Z),de=Fu.fromCartesian(X,fO),fe=z.subtract(Z,X,pO);var ye=(pe=z.normalize(fe,mO)).x;pe.x=pe.y,pe.y=-ye,ve=ge/C,be=W/C}for(M=0;M<8;M++){var we=k+4*M,Oe=N+2*M,xe=we+3,Ee=M<4?1:-1,Te=2===M||3===M||6===M||7===M?1:-1;z.pack(re.high,y,we),y[xe]=ae.x,z.pack(re.low,w,we),w[xe]=ae.y,z.pack(le,O,we),O[xe]=ae.z,z.pack(he,x,we),x[xe]=me*Ee,z.pack(ce,E,we);var Ce=_e*Te;0===Ce&&Te<0&&(Ce=Number.POSITIVE_INFINITY),E[xe]=Ce,o&&(l[we]=de.high.x,l[we+1]=de.high.y,l[we+2]=de.low.x,l[we+3]=de.low.y,h[we]=-Q.y,h[we+1]=Q.x,h[we+2]=K.y,h[we+3]=-K.x,u[we]=fe.x,u[we+1]=fe.y,u[we+2]=pe.x,u[we+3]=pe.y,d[Oe]=ve*Ee,0===(Ce=be*Te)&&Te<0&&(Ce=Number.POSITIVE_INFINITY),d[Oe+1]=Ce)}var Se=eO,Ae=tO,Pe=Jw,Ie=$w,De=Ve.fromCartographicArray(Qw,Kw),je=Xt.getMinimumMaximumHeights(De,f),Me=je.minimumTerrainHeight,Re=je.maximumTerrainHeight;Y+=Me,Y+=Re,kw(J,$,Me,Re,Se,Pe),kw(U,V,Me,Re,Ae,Ie);var Le=z.multiplyByScalar(ce,I.EPSILON5,_O);z.add(Se,Le,Se),z.add(Ae,Le,Ae),z.add(Pe,Le,Pe),z.add(Ie,Le,Ie),zw(Se,Ae),zw(Pe,Ie),z.pack(Se,b,F),z.pack(Ae,b,F+3),z.pack(Ie,b,F+6),z.pack(Pe,b,F+9),Le=z.multiplyByScalar(ce,-2*I.EPSILON5,_O),z.add(Se,Le,Se),z.add(Ae,Le,Ae),z.add(Pe,Le,Pe),z.add(Ie,Le,Ie),zw(Se,Ae),zw(Pe,Ie),z.pack(Se,b,F+12),z.pack(Ae,b,F+15),z.pack(Ie,b,F+18),z.pack(Pe,b,F+21),L+=2,c+=3,N+=16,F+=24,k+=32,q+=ne,W+=ge}c=0;var Ne=0;for(s=0;s<p;s++){for(M=0;M<bO;M++)v[c+M]=vO[M]+Ne;Ne+=8,c+=bO}var Fe=gO;St.fromVertices(i,z.ZERO,3,Fe[0]),St.fromVertices(n,z.ZERO,3,Fe[1]);var ke=St.fromBoundingSpheres(Fe);ke.radius+=Y/(2*p);var Be={position:new Na({componentDatatype:dn.DOUBLE,componentsPerAttribute:3,normalize:!1,values:b}),startHiAndForwardOffsetX:yO(y),startLoAndForwardOffsetY:yO(w),startNormalAndForwardOffsetZ:yO(O),endNormalAndTextureCoordinateNormalizationX:yO(x),rightNormalAndTextureCoordinateNormalizationY:yO(E)};o&&(Be.startHiLo2D=yO(l),Be.offsetAndRight2D=yO(u),Be.startEndNormals2D=yO(h),Be.texcoordNormalization2D=new Na({componentDatatype:dn.FLOAT,componentsPerAttribute:2,normalize:!1,values:d}));return new La({attributes:Be,indices:v,boundingSphere:ke})}(c,f,A,P,S,C,s)}};var Aw=new z,Pw=new be,Iw=new Kn;function Dw(e,t,i,n){var r=lw(i,t,Aw),a=z.dot(r,e);if(a>Yy||a<Xy){var o=lw(n,i,mw),s=a<Xy?I.PI_OVER_TWO:-I.PI_OVER_TWO,c=Kn.fromAxisAngle(o,s,Iw),l=be.fromQuaternion(c,Pw);return be.multiplyByVector(l,e,e),!0}return!1}var jw=new K,Mw=new z,Rw=new z;function Lw(e,t,i,n,r){var a=K.toCartesian(t,e._ellipsoid,Mw),o=z.add(a,i,Rw),s=!1,c=e._ellipsoid,l=c.cartesianToCartographic(o,jw);Math.abs(t.longitude-l.longitude)>I.PI_OVER_TWO&&(s=!0,o=z.subtract(a,i,Rw),l=c.cartesianToCartographic(o,jw)),l.height=0;var u=e.project(l,r);return(r=z.subtract(u,n,r)).z=0,r=z.normalize(r,r),s&&z.negate(r,r),r}var Nw=new z,Fw=new z;function kw(e,t,i,n,r,a){var o=z.subtract(t,e,Nw);z.normalize(o,o);var s=i-Zy,c=z.multiplyByScalar(o,s,Fw);z.add(e,c,r);var l=n-Qy;c=z.multiplyByScalar(o,l,Fw),z.add(t,c,a)}var Bw=new z;function zw(e,t){var i=oc.getPointDistance(vw,e),n=oc.getPointDistance(vw,t),r=Bw;I.equalsEpsilon(i,0,I.EPSILON2)?(r=lw(t,e,r),z.multiplyByScalar(r,I.EPSILON2,r),z.add(e,r,e)):I.equalsEpsilon(n,0,I.EPSILON2)&&(r=lw(e,t,r),z.multiplyByScalar(r,I.EPSILON2,r),z.add(t,r,t))}function Uw(e,t){var i=Math.abs(e.longitude),n=Math.abs(t.longitude);if(I.equalsEpsilon(i,I.PI,I.EPSILON11)){var r=I.sign(t.longitude);return e.longitude=r*(i-I.EPSILON11),1}if(I.equalsEpsilon(n,I.PI,I.EPSILON11)){var a=I.sign(e.longitude);return t.longitude=a*(n-I.EPSILON11),2}return 0}var Vw=new K,Hw=new K,Gw=new z,qw=new z,Ww=new z,Yw=new z,Xw=new z,Zw=new z,Qw=[Vw,Hw],Kw=new Ve,Jw=new z,$w=new z,eO=new z,tO=new z,iO=new z,nO=new z,rO=new z,aO=new z,oO=new z,sO=new z,cO=new z,lO=new z,uO=new z,hO=new z,dO=new Fu,fO=new Fu,pO=new z,mO=new z,_O=new z,gO=[new St,new St],vO=[0,2,1,0,3,2,0,7,3,0,4,7,0,5,4,0,1,5,5,7,4,5,6,7,5,2,6,5,1,2,3,6,2,3,7,6],bO=vO.length;function yO(e){return new Na({componentDatatype:dn.FLOAT,componentsPerAttribute:4,normalize:!1,values:e})}Ky._projectNormal=Lw;var wO=Ky;function OO(e,t,i){this.heading=Object(w.a)(e,0),this.pitch=Object(w.a)(t,0),this.range=Object(w.a)(i,0)}OO.clone=function(e,t){if(Object(u.a)(e))return Object(u.a)(t)||(t=new OO),t.heading=e.heading,t.pitch=e.pitch,t.range=e.range,t};var xO=OO,EO=n(122),TO=I.factorial;function CO(e,t,i,n,r,a){var o,s,c,l=0;if(n>0){for(s=0;s<r;s++){for(o=!1,c=0;c<a.length&&!o;c++)s===a[c]&&(o=!0);o||(a.push(s),l+=CO(e,t,i,n-1,r,a),a.splice(a.length-1,1))}return l}for(l=1,s=0;s<r;s++){for(o=!1,c=0;c<a.length&&!o;c++)s===a[c]&&(o=!0);o||(l*=e-i[t[s]])}return l}var SO={type:"Hermite",getRequiredDataPoints:function(e,t){if(t=Object(w.a)(t,0),!Object(u.a)(e))throw new h.a("degree is required.");if(e<0)throw new h.a("degree must be 0 or greater.");if(t<0)throw new h.a("inputOrder must be 0 or greater.");return Math.max(Math.floor((e+1)/(t+1)),2)},interpolateOrderZero:function(e,t,i,n,r){var a,o,s,c,l;Object(u.a)(r)||(r=new Array(n));var h=t.length,d=new Array(n);for(a=0;a<n;a++){r[a]=0;var f=new Array(h);for(d[a]=f,o=0;o<h;o++)f[o]=[]}var p=h,m=new Array(p);for(a=0;a<p;a++)m[a]=a;var _=h-1;for(c=0;c<n;c++){for(o=0;o<p;o++)l=m[o]*n+c,d[c][0].push(i[l]);for(a=1;a<p;a++){var g=!1;for(o=0;o<p-a;o++){var v,b=t[m[o]],y=t[m[o+a]];y-b<=0?(v=i[l=m[o]*n+n*a+c],d[c][a].push(v/TO(a))):(v=d[c][a-1][o+1]-d[c][a-1][o],d[c][a].push(v/(y-b))),g=g||0!==v}g||(_=a-1)}}for(s=0,0;s<=0;s++)for(a=s;a<=_;a++){var w=CO(e,m,t,s,a,[]);for(c=0;c<n;c++){var O=d[c][a][0];r[c+s*n]+=O*w}}return r}},AO=[];SO.interpolate=function(e,t,i,n,r,a,o){var s=n*(a+1);Object(u.a)(o)||(o=new Array(s));for(var c=0;c<s;c++)o[c]=0;var l,h=t.length,d=new Array(h*(r+1));for(l=0;l<h;l++)for(var f=0;f<r+1;f++)d[l*(r+1)+f]=l;for(var p=d.length,m=AO,_=function(e,t,i,n,r,a){for(var o,s,c=-1,l=t.length,u=l*(l+1)/2,h=0;h<r;h++){var d=Math.floor(h*u);for(o=0;o<l;o++)s=t[o]*r*(a+1)+h,e[d+o]=n[s];for(var f=1;f<l;f++){var p=0,m=Math.floor(f*(1-f)/2)+l*f,_=!1;for(o=0;o<l-f;o++){var g,v,b=i[t[o]],y=i[t[o+f]];if(y-b<=0)s=t[o]*r*(a+1)+r*f+h,g=n[s],v=g/I.factorial(f),e[d+m+p]=v,p++;else{var w=Math.floor((f-1)*(2-f)/2)+l*(f-1);g=e[d+w+o+1]-e[d+w+o],v=g/(y-b),e[d+m+p]=v,p++}_=_||0!==g}_&&(c=Math.max(c,f))}}return c}(m,d,t,i,n,r),g=[],v=p*(p+1)/2,b=Math.min(_,a),y=0;y<=b;y++)for(l=y;l<=_;l++){g.length=0;for(var w=CO(e,d,t,y,l,g),O=Math.floor(l*(1-l)/2)+p*l,x=0;x<n;x++){var E=m[Math.floor(x*v)+O];o[x+y*n]+=E*w}}return o};var PO=SO;var IO=function(e,t,i,n){this.rightAscension=e,this.declination=t,this.rotation=i,this.rotationRate=n},DO={},jO=26.4057084,MO=13.064993,RO=1.7484877,LO=new Tr;DO.ComputeMoon=function(e,t){Object(u.a)(e)||(e=Tr.now()),LO=Tr.addSeconds(e,32.184,LO);var i=Tr.totalDays(LO)-2451545,n=i/nr.DAYS_PER_JULIAN_CENTURY,r=(125.045+-.0529921*i)*I.RADIANS_PER_DEGREE,a=(250.089+-.1059842*i)*I.RADIANS_PER_DEGREE,o=(260.008+13.0120009*i)*I.RADIANS_PER_DEGREE,s=(176.625+13.3407154*i)*I.RADIANS_PER_DEGREE,c=(357.529+.9856003*i)*I.RADIANS_PER_DEGREE,l=(311.589+jO*i)*I.RADIANS_PER_DEGREE,h=(134.963+MO*i)*I.RADIANS_PER_DEGREE,d=(276.617+.3287146*i)*I.RADIANS_PER_DEGREE,f=(34.226+RO*i)*I.RADIANS_PER_DEGREE,p=(15.134+-.1589763*i)*I.RADIANS_PER_DEGREE,m=(119.743+.0036096*i)*I.RADIANS_PER_DEGREE,_=(239.961+.1643573*i)*I.RADIANS_PER_DEGREE,g=(25.053+12.9590088*i)*I.RADIANS_PER_DEGREE,v=Math.sin(r),b=Math.sin(a),y=Math.sin(o),w=Math.sin(s),O=Math.sin(c),x=Math.sin(l),E=Math.sin(h),T=Math.sin(d),C=Math.sin(f),S=Math.sin(p),A=Math.sin(m),P=Math.sin(_),D=Math.sin(g),j=Math.cos(r),M=Math.cos(a),R=Math.cos(o),L=Math.cos(s),N=Math.cos(c),F=Math.cos(l),k=Math.cos(h),B=Math.cos(d),z=Math.cos(f),U=Math.cos(p),V=Math.cos(m),H=Math.cos(_),G=Math.cos(g),q=(269.9949+.0031*n-3.8787*v-.1204*b+.07*y-.0172*w+.0072*x-.0052*S+.0043*D)*I.RADIANS_PER_DEGREE,W=(66.5392+.013*n+1.5419*j+.0239*M-.0278*R+.0068*L-.0029*F+9e-4*k+8e-4*U-9e-4*G)*I.RADIANS_PER_DEGREE,Y=(38.3213+13.17635815*i-14e-13*i*i+3.561*v+.1208*b-.0642*y+.0158*w+.0252*O-.0066*x-.0047*E-.0046*T+.0028*C+.0052*S+.004*A+.0019*P-.0044*D)*I.RADIANS_PER_DEGREE,X=(13.17635815-2*i*14e-13+3.561*j*-.0529921+.1208*M*-.1059842-.0642*R*13.0120009+.0158*L*13.3407154+.0252*N*.9856003-.0066*F*jO-.0047*k*MO-.0046*B*.3287146+.0028*z*RO+.0052*U*-.1589763+.004*V*.0036096+.0019*H*.1643573-.0044*G*12.9590088)/86400*I.RADIANS_PER_DEGREE;return Object(u.a)(t)||(t=new IO),t.rightAscension=q,t.declination=W,t.rotation=Y,t.rotationRate=X,t};var NO=DO;function FO(e){Object(u.a)(e)&&"function"==typeof e||(e=NO.ComputeMoon),this._computeFunction=e}var kO=new z,BO=new z,zO=new z;var UO=new be,VO=new Kn;FO.prototype.evaluate=function(e,t){Object(u.a)(e)||(e=Tr.now());var i=this._computeFunction(e),n=function(e,t,i){var n=kO;n.x=Math.cos(e+I.PI_OVER_TWO),n.y=Math.sin(e+I.PI_OVER_TWO),n.z=0;var r=Math.cos(t),a=zO;a.x=r*Math.cos(e),a.y=r*Math.sin(e),a.z=Math.sin(t);var o=z.cross(a,n,BO);return Object(u.a)(i)||(i=new be),i[0]=n.x,i[1]=o.x,i[2]=a.x,i[3]=n.y,i[4]=o.y,i[5]=a.y,i[6]=n.z,i[7]=o.z,i[8]=a.z,i}(i.rightAscension,i.declination,t),r=I.zeroToTwoPi(i.rotation),a=Kn.fromAxisAngle(z.UNIT_Z,r,VO),o=be.fromQuaternion(Kn.conjugate(a,a),UO);return be.multiply(o,n,n)};var HO=FO,GO={type:void 0};GO.getRequiredDataPoints=h.a.throwInstantiationError,GO.interpolateOrderZero=h.a.throwInstantiationError,GO.interpolate=h.a.throwInstantiationError;var qO=GO;function WO(e){x.a.defined("url",e),this._url=f.a.createIfNeeded(e),this._url.appendForwardSlash()}Object(O.a)(WO.prototype,{url:{get:function(){return this._url}}}),WO.prototype.geocode=function(e,t){return x.a.typeOf.string("query",e),this._url.getDerivedResource({url:t===ty.AUTOCOMPLETE?"autocomplete":"search",queryParameters:{text:e}}).fetchJson().then((function(e){return e.features.map((function(e){var t,i=e.bbox;if(Object(u.a)(i))t=Ve.fromDegrees(i[0],i[1],i[2],i[3]);else{var n=e.geometry.coordinates[0],r=e.geometry.coordinates[1];t=z.fromDegrees(n,r)}return{displayName:e.properties.label,destination:t}}))}))};var YO=WO;function XO(e){e=Object(w.a)(e,w.a.EMPTY_OBJECT),x.a.typeOf.object("options.scene",e.scene);var t=Object(w.a)(e.accessToken,Ng.defaultAccessToken),i=f.a.createIfNeeded(Object(w.a)(e.server,Ng.defaultServer));i.appendForwardSlash();var n=Ng.getDefaultTokenCredit(t);Object(u.a)(n)&&e.scene.frameState.creditDisplay.addDefaultCredit(Jo.clone(n));var r=i.getDerivedResource({url:"v1/geocode"});Object(u.a)(t)&&r.appendQueryParameters({access_token:t}),this._accessToken=t,this._server=i,this._pelias=new YO(r)}XO.prototype.geocode=function(e,t){return this._pelias.geocode(e,t)};var ZO=XO,QO=n(81),KO=n(83);function JO(e){e=Object(w.a)(e,w.a.EMPTY_OBJECT),this.start=Object(u.a)(e.start)?Tr.clone(e.start):new Tr,this.stop=Object(u.a)(e.stop)?Tr.clone(e.stop):new Tr,this.data=e.data,this.isStartIncluded=Object(w.a)(e.isStartIncluded,!0),this.isStopIncluded=Object(w.a)(e.isStopIncluded,!0)}Object(O.a)(JO.prototype,{isEmpty:{get:function(){var e=Tr.compare(this.stop,this.start);return e<0||0===e&&(!this.isStartIncluded||!this.isStopIncluded)}}});var $O={start:void 0,stop:void 0,isStartIncluded:void 0,isStopIncluded:void 0,data:void 0};JO.fromIso8601=function(e,t){x.a.typeOf.object("options",e),x.a.typeOf.string("options.iso8601",e.iso8601);var i=e.iso8601.split("/");if(2!==i.length)throw new h.a("options.iso8601 is an invalid ISO 8601 interval.");var n=Tr.fromIso8601(i[0]),r=Tr.fromIso8601(i[1]),a=Object(w.a)(e.isStartIncluded,!0),o=Object(w.a)(e.isStopIncluded,!0),s=e.data;return Object(u.a)(t)?(t.start=n,t.stop=r,t.isStartIncluded=a,t.isStopIncluded=o,t.data=s,t):($O.start=n,$O.stop=r,$O.isStartIncluded=a,$O.isStopIncluded=o,$O.data=s,new JO($O))},JO.toIso8601=function(e,t){return x.a.typeOf.object("timeInterval",e),Tr.toIso8601(e.start,t)+"/"+Tr.toIso8601(e.stop,t)},JO.clone=function(e,t){if(Object(u.a)(e))return Object(u.a)(t)?(t.start=e.start,t.stop=e.stop,t.isStartIncluded=e.isStartIncluded,t.isStopIncluded=e.isStopIncluded,t.data=e.data,t):new JO(e)},JO.equals=function(e,t,i){return e===t||Object(u.a)(e)&&Object(u.a)(t)&&(e.isEmpty&&t.isEmpty||e.isStartIncluded===t.isStartIncluded&&e.isStopIncluded===t.isStopIncluded&&Tr.equals(e.start,t.start)&&Tr.equals(e.stop,t.stop)&&(e.data===t.data||Object(u.a)(i)&&i(e.data,t.data)))},JO.equalsEpsilon=function(e,t,i,n){return x.a.typeOf.number("epsilon",i),e===t||Object(u.a)(e)&&Object(u.a)(t)&&(e.isEmpty&&t.isEmpty||e.isStartIncluded===t.isStartIncluded&&e.isStopIncluded===t.isStopIncluded&&Tr.equalsEpsilon(e.start,t.start,i)&&Tr.equalsEpsilon(e.stop,t.stop,i)&&(e.data===t.data||Object(u.a)(n)&&n(e.data,t.data)))},JO.intersect=function(e,t,i,n){if(x.a.typeOf.object("left",e),x.a.typeOf.object("result",i),!Object(u.a)(t))return JO.clone(JO.EMPTY,i);var r=e.start,a=e.stop,o=t.start,s=t.stop,c=Tr.greaterThanOrEquals(o,r)&&Tr.greaterThanOrEquals(a,o),l=!c&&Tr.lessThanOrEquals(o,r)&&Tr.lessThanOrEquals(r,s);if(!c&&!l)return JO.clone(JO.EMPTY,i);var h=e.isStartIncluded,d=e.isStopIncluded,f=t.isStartIncluded,p=t.isStopIncluded,m=Tr.lessThan(a,s);return i.start=c?o:r,i.isStartIncluded=h&&f||!Tr.equals(o,r)&&(c&&f||l&&h),i.stop=m?a:s,i.isStopIncluded=m?d:d&&p||!Tr.equals(s,a)&&p,i.data=Object(u.a)(n)?n(e.data,t.data):e.data,i},JO.contains=function(e,t){if(x.a.typeOf.object("timeInterval",e),x.a.typeOf.object("julianDate",t),e.isEmpty)return!1;var i=Tr.compare(e.start,t);if(0===i)return e.isStartIncluded;var n=Tr.compare(t,e.stop);return 0===n?e.isStopIncluded:i<0&&n<0},JO.prototype.clone=function(e){return JO.clone(this,e)},JO.prototype.equals=function(e,t){return JO.equals(this,e,t)},JO.prototype.equalsEpsilon=function(e,t,i){return JO.equalsEpsilon(this,e,t,i)},JO.prototype.toString=function(){return JO.toIso8601(this)},JO.EMPTY=Object(E.a)(new JO({start:new Tr,stop:new Tr,isStartIncluded:!1,isStopIncluded:!1}));var ex=JO,tx=Object(E.a)(Tr.fromIso8601("0000-01-01T00:00:00Z")),ix=Object(E.a)(Tr.fromIso8601("9999-12-31T24:00:00Z")),nx={MINIMUM_VALUE:tx,MAXIMUM_VALUE:ix,MAXIMUM_INTERVAL:Object(E.a)(new ex({start:tx,stop:ix}))},rx=Object(E.a)({SHIFT:0,CTRL:1,ALT:2}),ax={type:"Lagrange",getRequiredDataPoints:function(e){return Math.max(e+1,2)},interpolateOrderZero:function(e,t,i,n,r){var a,o;Object(u.a)(r)||(r=new Array(n));var s=t.length;for(a=0;a<n;a++)r[a]=0;for(a=0;a<s;a++){var c=1;for(o=0;o<s;o++)if(o!==a){var l=t[a]-t[o];c*=(e-t[o])/l}for(o=0;o<n;o++)r[o]+=c*i[a*n+o]}return r}},ox=ax,sx={type:"Linear",getRequiredDataPoints:function(e){return 2},interpolateOrderZero:function(e,t,i,n,r){if(2!==t.length)throw new h.a("The xTable provided to the linear interpolator must have exactly two elements.");if(n<=0)throw new h.a("There must be at least 1 dependent variable for each independent variable.");var a,o,s;Object(u.a)(r)||(r=new Array(n));var c=t[0],l=t[1];if(c===l)throw new h.a("Divide by zero error: xTable[0] and xTable[1] are equal");for(a=0;a<n;a++)o=i[a],s=i[a+n],r[a]=((s-o)*e+l*o-c*s)/(l-c);return r}},cx=sx,lx=new pl("transcodeCRNToDXT",Number.POSITIVE_INFINITY);var ux=function(e){if(!Object(u.a)(e))throw new h.a("resourceOrUrlOrBuffer is required.");var t;if(t=e instanceof ArrayBuffer||ArrayBuffer.isView(e)?Oi.a.resolve(e):f.a.createIfNeeded(e).fetchArrayBuffer(),Object(u.a)(t))return t.then((function(e){if(Object(u.a)(e)){var t=[];return e instanceof ArrayBuffer?t.push(e):0===e.byteOffset&&e.byteLength===e.buffer.byteLength?t.push(e.buffer):(e=e.slice(0,e.length),t.push(e.buffer)),lx.scheduleTask(e,t)}})).then((function(e){return mf.clone(e)}))};var hx=function(e,t,i){x.a.typeOf.object("uint8Array",e),x.a.typeOf.string("format",t);var n=new Blob([e],{type:t}),r=window.URL.createObjectURL(n);return new f.a({url:r,request:i}).fetchImage().then((function(e){return window.URL.revokeObjectURL(r),e}),(function(e){return window.URL.revokeObjectURL(r),Oi.a.reject(e)}))},dx={_taaEnabled:!1,_jitterOffset:[0,0],_currentFrameTaaEnabled:!1,_historicalInvalid:!1,_ultimatePerformance:!0,_ambientLight:new z(.2,.2,.2),_lightScaleFactor:1,_gradualRenderMode:!1,_vignetteMode:!1,_isWebgl2:!1,_multipleSamples:4,_isBIMMode:!0,_ellipsoidType:ae.WGS84};Object(O.a)(dx,{taaEnabled:{get:function(){return dx._taaEnabled},set:function(e){dx._taaEnabled=e,e&&(dx.historicalInvalid=e)}},jitterOffset:{get:function(){return dx._jitterOffset},set:function(e){dx._jitterOffset=e}},historicalInvalid:{get:function(){return dx._historicalInvalid},set:function(e){dx._historicalInvalid=e}},currentFrameTaaEnabled:{get:function(){return dx._currentFrameTaaEnabled},set:function(e){dx._currentFrameTaaEnabled=e}},ultimatePerformance:{get:function(){return dx._ultimatePerformance},set:function(e){dx._ultimatePerformance=e}},ambientLight:{get:function(){return dx._ambientLight},set:function(e){if(!Object(u.a)(e))throw new h.a("ambientLight must be defined");if(!(e instanceof z))throw new h.a("ambientLight must be an instance of Cartesian3");dx._ambientLight=e}},lightScaleFactor:{get:function(){return dx._lightScaleFactor},set:function(e){if(!Object(u.a)(e||e<0))throw new h.a("lightScaleFactor must be greater than or equal to 0.0.");dx._lightScaleFactor=e}},gradualRenderMode:{get:function(){return dx._gradualRenderMode},set:function(e){dx._gradualRenderMode=e}},vignetteMode:{get:function(){return dx._vignetteMode},set:function(e){dx._vignetteMode=e}},isWebgl2:{get:function(){return dx._isWebgl2},set:function(e){dx._isWebgl2=e}},multipleSamples:{get:function(){return dx._multipleSamples},set:function(e){dx._multipleSamples=e}},isBIMMode:{get:function(){return dx._isBIMMode},set:function(e){dx._isBIMMode=e}},ellipsoidType:{get:function(){return dx._ellipsoidType},set:function(e){dx._ellipsoidType=e}}});var fx=dx,px={_UNSIGNED_BYTE:un.UNSIGNED_BYTE,_UNSIGNED_SHORT:un.UNSIGNED_SHORT,_UNSIGNED_INT:un.UNSIGNED_INT,_FLOAT:un.FLOAT,_HALF_FLOAT:un.HALF_FLOAT_OES,_UNSIGNED_INT_24_8:un.UNSIGNED_INT_24_8,_UNSIGNED_SHORT_4_4_4_4:un.UNSIGNED_SHORT_4_4_4_4,_UNSIGNED_SHORT_5_5_5_1:un.UNSIGNED_SHORT_5_5_5_1,_UNSIGNED_SHORT_5_6_5:un.UNSIGNED_SHORT_5_6_5};Object(O.a)(px,{UNSIGNED_BYTE:{get:function(){return px._UNSIGNED_BYTE}},UNSIGNED_SHORT:{get:function(){return px._UNSIGNED_SHORT}},UNSIGNED_INT:{get:function(){return px._UNSIGNED_INT}},FLOAT:{get:function(){return px._FLOAT}},HALF_FLOAT:{get:function(){return fx.isWebgl2?un.HALF_FLOAT:px._HALF_FLOAT}},UNSIGNED_INT_24_8:{get:function(){return px._UNSIGNED_INT_24_8}},UNSIGNED_SHORT_4_4_4_4:{get:function(){return px._UNSIGNED_SHORT_4_4_4_4}},UNSIGNED_SHORT_5_5_5_1:{get:function(){return px._UNSIGNED_SHORT_5_5_5_1}},UNSIGNED_SHORT_5_6_5:{get:function(){return px._UNSIGNED_SHORT_5_6_5}}}),px.isPacked=function(e){return e===px.UNSIGNED_INT_24_8||e===px.UNSIGNED_SHORT_4_4_4_4||e===px.UNSIGNED_SHORT_5_5_5_1||e===px.UNSIGNED_SHORT_5_6_5},px.sizeInBytes=function(e){switch(e){case px.UNSIGNED_BYTE:return 1;case px.UNSIGNED_SHORT:case px.UNSIGNED_SHORT_4_4_4_4:case px.UNSIGNED_SHORT_5_5_5_1:case px.UNSIGNED_SHORT_5_6_5:case px.HALF_FLOAT:return 2;case px.UNSIGNED_INT:case px.FLOAT:case px.UNSIGNED_INT_24_8:return 4}},px.validate=function(e){return e===px.UNSIGNED_BYTE||e===px.UNSIGNED_SHORT||e===px.UNSIGNED_INT||e===px.FLOAT||e===px.HALF_FLOAT||e===px.UNSIGNED_INT_24_8||e===px.UNSIGNED_SHORT_4_4_4_4||e===px.UNSIGNED_SHORT_5_5_5_1||e===px.UNSIGNED_SHORT_5_6_5};var mx=Object(E.a)(px),_x={DEPTH_COMPONENT:un.DEPTH_COMPONENT,DEPTH_STENCIL:un.DEPTH_STENCIL,ALPHA:un.ALPHA,RGB:un.RGB,RGBA:un.RGBA,LUMINANCE:un.LUMINANCE,LUMINANCE_ALPHA:un.LUMINANCE_ALPHA,RGB_DXT1:un.COMPRESSED_RGB_S3TC_DXT1_EXT,RGBA_DXT1:un.COMPRESSED_RGBA_S3TC_DXT1_EXT,RGBA_DXT3:un.COMPRESSED_RGBA_S3TC_DXT3_EXT,RGBA_DXT5:un.COMPRESSED_RGBA_S3TC_DXT5_EXT,RGB_PVRTC_4BPPV1:un.COMPRESSED_RGB_PVRTC_4BPPV1_IMG,RGB_PVRTC_2BPPV1:un.COMPRESSED_RGB_PVRTC_2BPPV1_IMG,RGBA_PVRTC_4BPPV1:un.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG,RGBA_PVRTC_2BPPV1:un.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG,RGB_ETC1:un.COMPRESSED_RGB_ETC1_WEBGL,componentsLength:function(e){switch(e){case _x.RGB:return 3;case _x.RGBA:return 4;case _x.LUMINANCE_ALPHA:return 2;case _x.ALPHA:case _x.LUMINANCE:default:return 1}},validate:function(e){return e===_x.DEPTH_COMPONENT||e===_x.DEPTH_STENCIL||e===_x.ALPHA||e===_x.RGB||e===_x.RGBA||e===_x.LUMINANCE||e===_x.LUMINANCE_ALPHA||e===_x.RGB_DXT1||e===_x.RGBA_DXT1||e===_x.RGBA_DXT3||e===_x.RGBA_DXT5||e===_x.RGB_PVRTC_4BPPV1||e===_x.RGB_PVRTC_2BPPV1||e===_x.RGBA_PVRTC_4BPPV1||e===_x.RGBA_PVRTC_2BPPV1||e===_x.RGB_ETC1},isColorFormat:function(e){return e===_x.ALPHA||e===_x.RGB||e===_x.RGBA||e===_x.LUMINANCE||e===_x.LUMINANCE_ALPHA},isDepthFormat:function(e){return e===_x.DEPTH_COMPONENT||e===_x.DEPTH_STENCIL},isCompressedFormat:function(e){return e===_x.RGB_DXT1||e===_x.RGBA_DXT1||e===_x.RGBA_DXT3||e===_x.RGBA_DXT5||e===_x.RGB_PVRTC_4BPPV1||e===_x.RGB_PVRTC_2BPPV1||e===_x.RGBA_PVRTC_4BPPV1||e===_x.RGBA_PVRTC_2BPPV1||e===_x.RGB_ETC1},isDXTFormat:function(e){return e===_x.RGB_DXT1||e===_x.RGBA_DXT1||e===_x.RGBA_DXT3||e===_x.RGBA_DXT5},isPVRTCFormat:function(e){return e===_x.RGB_PVRTC_4BPPV1||e===_x.RGB_PVRTC_2BPPV1||e===_x.RGBA_PVRTC_4BPPV1||e===_x.RGBA_PVRTC_2BPPV1},isETC1Format:function(e){return e===_x.RGB_ETC1},compressedTextureSizeInBytes:function(e,t,i){switch(e){case _x.RGB_DXT1:case _x.RGBA_DXT1:case _x.RGB_ETC1:return Math.floor((t+3)/4)*Math.floor((i+3)/4)*8;case _x.RGBA_DXT3:case _x.RGBA_DXT5:return Math.floor((t+3)/4)*Math.floor((i+3)/4)*16;case _x.RGB_PVRTC_4BPPV1:case _x.RGBA_PVRTC_4BPPV1:return Math.floor((Math.max(t,8)*Math.max(i,8)*4+7)/8);case _x.RGB_PVRTC_2BPPV1:case _x.RGBA_PVRTC_2BPPV1:return Math.floor((Math.max(t,16)*Math.max(i,8)*2+7)/8);default:return 0}},textureSizeInBytes:function(e,t,i,n){var r=_x.componentsLength(e);return mx.isPacked(t)&&(r=1),r*mx.sizeInBytes(t)*i*n},createTypedArray:function(e,t,i,n){var r=mx.sizeInBytes(t);return new(r===Uint8Array.BYTES_PER_ELEMENT?Uint8Array:r===Uint16Array.BYTES_PER_ELEMENT?Uint16Array:r===Float32Array.BYTES_PER_ELEMENT&&t===mx.FLOAT?Float32Array:Uint32Array)(_x.componentsLength(e)*i*n)},flipY:function(e,t,i,n,r){if(1===r)return e;for(var a=_x.createTypedArray(t,i,n,r),o=_x.componentsLength(t),s=n*o,c=0;c<r;++c)for(var l=c*r*o,u=(r-c-1)*r*o,h=0;h<s;++h)a[u+h]=e[l+h];return a}},gx=Object(E.a)(_x);var vx=[171,75,84,88,32,49,49,187,13,10,26,10],bx=67305985,yx=["positiveX","negativeX","positiveY","negativeY","positiveZ","negativeZ"],wx=4;var Ox=function(e){var t;if(x.a.defined("resourceOrUrlOrBuffer",e),t=e instanceof ArrayBuffer||ArrayBuffer.isView(e)?Oi.a.resolve(e):f.a.createIfNeeded(e).fetchArrayBuffer(),Object(u.a)(t))return t.then((function(e){if(Object(u.a)(e))return function(e){var t,i,n,r=new Uint8Array(e),a=!0;for(t=0;t<vx.length;++t)if(vx[t]!==r[t]){a=!1;break}if(!a)throw new Ce.a("Invalid KTX file.");Object(u.a)(e.buffer)?(i=new DataView(e.buffer),n=e.byteOffset):(i=new DataView(e),n=0);n+=12;var o=i.getUint32(n,!0);if(n+=wx,o!==bx)throw new Ce.a("File is the wrong endianness.");var s=i.getUint32(n,!0);n+=wx;var c=i.getUint32(n,!0);n+=wx;var l=i.getUint32(n,!0);n+=wx;var h=i.getUint32(n,!0);n+=wx;var d=i.getUint32(n,!0);n+=wx;var f=i.getUint32(n,!0);n+=wx;var p=i.getUint32(n,!0);n+=wx;var m=i.getUint32(n,!0);n+=wx;var _=i.getUint32(n,!0);n+=wx;var g=i.getUint32(n,!0);n+=wx;var v=i.getUint32(n,!0);n+=wx;var b=i.getUint32(n,!0);n+=wx,n+=b;var y,w=i.getUint32(n,!0);n+=wx,y=Object(u.a)(e.buffer)?new Uint8Array(e.buffer,n,w):new Uint8Array(e,n,w);h===un.RGB8?h=gx.RGB:h===un.RGBA8&&(h=gx.RGBA);if(!gx.validate(h))throw new Ce.a("glInternalFormat is not a valid format.");if(gx.isCompressedFormat(h)){if(0!==s)throw new Ce.a("glType must be zero when the texture is compressed.");if(1!==c)throw new Ce.a("The type size for compressed textures must be 1.");if(0!==l)throw new Ce.a("glFormat must be zero when the texture is compressed.")}else{if(s!==un.UNSIGNED_BYTE)throw new Ce.a("Only unsigned byte buffers are supported.");if(d!==l)throw new Ce.a("The base internal format must be the same as the format for uncompressed textures.")}if(0!==m)throw new Ce.a("3D textures are unsupported.");if(0!==_)throw new Ce.a("Texture arrays are unsupported.");var O=y.byteOffset,x=new Array(v);for(t=0;t<v;++t){for(var E=x[t]={},T=0;T<g;++T){var C=f>>t,S=p>>t,A=gx.isCompressedFormat(h)?gx.compressedTextureSizeInBytes(h,C,S):gx.textureSizeInBytes(h,s,C,S),P=new Uint8Array(y.buffer,O,A);E[yx[T]]=new mf(h,C,S,P),O+=A}O+=3-(O+3)%4+4}var I=x;if(1===g)for(t=0;t<v;++t)I[t]=I[t][yx[0]];1===v&&(I=I[0]);return I}(e)}))};function xx(e){e=Object(w.a)(e,0),this._array=new Array(e),this._length=e}Object(O.a)(xx.prototype,{length:{get:function(){return this._length},set:function(e){this._length=e,e>this._array.length&&(this._array.length=e)}},values:{get:function(){return this._array}}}),xx.prototype.get=function(e){return x.a.typeOf.number.lessThan("index",e,this._array.length),this._array[e]},xx.prototype.set=function(e,t){x.a.typeOf.number("index",e),e>=this.length&&(this.length=e+1),this._array[e]=t},xx.prototype.peek=function(){return this._array[this._length-1]},xx.prototype.push=function(e){var t=this.length++;this._array[t]=e},xx.prototype.pop=function(){return this._array[--this.length]},xx.prototype.reserve=function(e){x.a.typeOf.number.greaterThanOrEquals("length",e,0),e>this._array.length&&(this._array.length=e)},xx.prototype.resize=function(e){x.a.typeOf.number.greaterThanOrEquals("length",e,0),this.length=e},xx.prototype.trim=function(e){e=Object(w.a)(e,this.length),this._array.length=e};var Ex,Tx=xx,Cx={defaultAccessToken:void 0},Sx=!1,Ax="<b>This application is using Cesium's default Mapbox access token.  Please create a new access token for the application as soon as possible and prior to deployment by visiting <a href=https://www.mapbox.com/account/apps/>https://www.mapbox.com/account/apps/</a>, and provide your token to Cesium by setting the Cesium.MapboxApi.defaultAccessToken property before constructing the CesiumWidget or any other object that uses the Mapbox API.</b>";Cx.getAccessToken=function(e){return Object(u.a)(e)?e:Object(u.a)(Cx.defaultAccessToken)?Cx.defaultAccessToken:(Sx||(console.log(Ax),Sx=!0),"pk.eyJ1IjoiYW5hbHl0aWNhbGdyYXBoaWNzIiwiYSI6ImNpd204Zm4wejAwNzYyeW5uNjYyZmFwdWEifQ.7i-VIZZWX8pd1bTfxIVj9g")},Cx.getErrorCredit=function(e){if(!Object(u.a)(e)&&!Object(u.a)(Cx.defaultAccessToken))return Object(u.a)(Ex)||(Ex=new Jo(Ax,!0)),Ex};var Px=Cx;function Ix(){h.a.throwInstantiationError()}Object(O.a)(Ix.prototype,{ellipsoid:{get:h.a.throwInstantiationError}}),Ix.prototype.project=h.a.throwInstantiationError,Ix.prototype.unproject=h.a.throwInstantiationError;var Dx=Ix,jx=[],Mx=[];function Rx(e,t,i,n,r){if(!(n>=r)){var a=Math.floor(.5*(n+r));Rx(e,t,i,n,a),Rx(e,t,i,a+1,r),function(e,t,i,n,r,a){var o,s,c=r-n+1,l=a-r,u=jx,h=Mx;for(o=0;o<c;++o)u[o]=e[n+o];for(s=0;s<l;++s)h[s]=e[r+s+1];o=0,s=0;for(var d=n;d<=a;++d){var f=u[o],p=h[s];o<c&&(s>=l||t(f,p,i)<=0)?(e[d]=f,++o):s<l&&(e[d]=p,++s)}}(e,t,i,n,a,r)}}var Lx=function(e,t,i){if(!Object(u.a)(e))throw new h.a("array is required.");if(!Object(u.a)(t))throw new h.a("comparator is required.");var n=e.length,r=Math.ceil(.5*n);jx.length=r,Mx.length=r,Rx(e,t,i,0,n-1),jx.length=0,Mx.length=0};function Nx(e,t,i,n){this.near=Object(w.a)(e,0),this.nearValue=Object(w.a)(t,0),this.far=Object(w.a)(i,1),this.farValue=Object(w.a)(n,0)}Nx.clone=function(e,t){if(Object(u.a)(e))return Object(u.a)(t)?(t.near=e.near,t.nearValue=e.nearValue,t.far=e.far,t.farValue=e.farValue,t):new Nx(e.near,e.nearValue,e.far,e.farValue)},Nx.packedLength=4,Nx.pack=function(e,t,i){if(!Object(u.a)(e))throw new h.a("value is required");if(!Object(u.a)(t))throw new h.a("array is required");return i=Object(w.a)(i,0),t[i++]=e.near,t[i++]=e.nearValue,t[i++]=e.far,t[i]=e.farValue,t},Nx.unpack=function(e,t,i){if(!Object(u.a)(e))throw new h.a("array is required");return t=Object(w.a)(t,0),Object(u.a)(i)||(i=new Nx),i.near=e[t++],i.nearValue=e[t++],i.far=e[t++],i.farValue=e[t],i},Nx.equals=function(e,t){return e===t||Object(u.a)(e)&&Object(u.a)(t)&&e.near===t.near&&e.nearValue===t.nearValue&&e.far===t.far&&e.farValue===t.farValue},Nx.prototype.clone=function(e){return Nx.clone(this,e)},Nx.prototype.equals=function(e){return Nx.equals(this,e)};var Fx=Nx,kx=n(85),Bx=Object(E.a)({NONE:-1,PARTIAL:0,FULL:1});function zx(e,t){if(!Object(u.a)(e))throw new h.a("occluderBoundingSphere is required.");if(!Object(u.a)(t))throw new h.a("camera position is required.");this._occluderPosition=z.clone(e.center),this._occluderRadius=e.radius,this._horizonDistance=0,this._horizonPlaneNormal=void 0,this._horizonPlanePosition=void 0,this._cameraPosition=void 0,this.cameraPosition=t}var Ux=new z;Object(O.a)(zx.prototype,{position:{get:function(){return this._occluderPosition}},radius:{get:function(){return this._occluderRadius}},cameraPosition:{set:function(e){if(!Object(u.a)(e))throw new h.a("cameraPosition is required.");e=z.clone(e,this._cameraPosition);var t,i,n,r=z.subtract(this._occluderPosition,e,Ux),a=z.magnitudeSquared(r),o=this._occluderRadius*this._occluderRadius;if(a>o){t=Math.sqrt(a-o),a=1/Math.sqrt(a),i=z.multiplyByScalar(r,a,Ux);var s=t*t*a;n=z.add(e,z.multiplyByScalar(i,s,Ux),Ux)}else t=Number.MAX_VALUE;this._horizonDistance=t,this._horizonPlaneNormal=i,this._horizonPlanePosition=n,this._cameraPosition=e}}}),zx.fromBoundingSphere=function(e,t,i){if(!Object(u.a)(e))throw new h.a("occluderBoundingSphere is required.");if(!Object(u.a)(t))throw new h.a("camera position is required.");return Object(u.a)(i)?(z.clone(e.center,i._occluderPosition),i._occluderRadius=e.radius,i.cameraPosition=t,i):new zx(e,t)};var Vx=new z;zx.prototype.isPointVisible=function(e){if(this._horizonDistance!==Number.MAX_VALUE){var t=z.subtract(e,this._occluderPosition,Vx),i=this._occluderRadius;if((i=z.magnitudeSquared(t)-i*i)>0)return i=Math.sqrt(i)+this._horizonDistance,t=z.subtract(e,this._cameraPosition,t),i*i>z.magnitudeSquared(t)}return!1};var Hx=new z;zx.prototype.isBoundingSphereVisible=function(e){var t=z.clone(e.center,Hx),i=e.radius;if(this._horizonDistance!==Number.MAX_VALUE){var n=z.subtract(t,this._occluderPosition,Vx),r=this._occluderRadius-i;if(r=z.magnitudeSquared(n)-r*r,i<this._occluderRadius)return r>0&&(r=Math.sqrt(r)+this._horizonDistance,n=z.subtract(t,this._cameraPosition,n),r*r+i*i>z.magnitudeSquared(n));if(r>0){n=z.subtract(t,this._cameraPosition,n);var a=z.magnitudeSquared(n),o=this._occluderRadius*this._occluderRadius,s=i*i;return(this._horizonDistance*this._horizonDistance+o)*s>a*o||(r=Math.sqrt(r)+this._horizonDistance)*r+s>a}return!0}return!1};var Gx=new z;zx.prototype.computeVisibility=function(e){if(!Object(u.a)(e))throw new h.a("occludeeBS is required.");var t=z.clone(e.center),i=e.radius;if(i>this._occluderRadius)return Bx.FULL;if(this._horizonDistance!==Number.MAX_VALUE){var n=z.subtract(t,this._occluderPosition,Gx),r=this._occluderRadius-i,a=z.magnitudeSquared(n);if((r=a-r*r)>0){r=Math.sqrt(r)+this._horizonDistance,n=z.subtract(t,this._cameraPosition,n);var o=z.magnitudeSquared(n);return r*r+i*i<o?Bx.NONE:(r=a-(r=this._occluderRadius+i)*r)>0?o<(r=Math.sqrt(r)+this._horizonDistance)*r+i*i?Bx.FULL:Bx.PARTIAL:(n=z.subtract(t,this._horizonPlanePosition,n),z.dot(n,this._horizonPlaneNormal)>-i?Bx.PARTIAL:Bx.FULL)}}return Bx.NONE};var qx=new z;zx.computeOccludeePoint=function(e,t,i){if(!Object(u.a)(e))throw new h.a("occluderBoundingSphere is required.");if(!Object(u.a)(i))throw new h.a("positions is required.");if(0===i.length)throw new h.a("positions must contain at least one element");var n=z.clone(t),r=z.clone(e.center),a=e.radius,o=i.length;if(z.equals(r,t))throw new h.a("occludeePosition must be different than occluderBoundingSphere.center");var s=z.normalize(z.subtract(n,r,qx),qx),c=-z.dot(s,r),l=zx._anyRotationVector(r,s,c),d=zx._horizonToPlaneNormalDotProduct(e,s,c,l,i[0]);if(d){for(var f,p=1;p<o;++p){if(!(f=zx._horizonToPlaneNormalDotProduct(e,s,c,l,i[p])))return;f<d&&(d=f)}if(!(d<.0017453283658983088)){var m=a/d;return z.add(r,z.multiplyByScalar(s,m,qx),qx)}}};var Wx=[];zx.computeOccludeePointFromRectangle=function(e,t){if(!Object(u.a)(e))throw new h.a("rectangle is required.");t=Object(w.a)(t,ae.WGS84);var i=Ve.subsample(e,t,0,Wx),n=St.fromPoints(i),r=z.ZERO;if(!z.equals(r,n.center))return zx.computeOccludeePoint(new St(r,t.minimumRadius),n.center,i)};var Yx=new z;zx._anyRotationVector=function(e,t,i){var n=z.abs(t,Yx),r=n.x>n.y?0:1;(0===r&&n.z>n.x||1===r&&n.z>n.y)&&(r=2);var a,o=new z;0===r?(n.x=e.x,n.y=e.y+1,n.z=e.z+1,a=z.UNIT_X):1===r?(n.x=e.x+1,n.y=e.y,n.z=e.z+1,a=z.UNIT_Y):(n.x=e.x+1,n.y=e.y+1,n.z=e.z,a=z.UNIT_Z);var s=(z.dot(t,n)+i)/-z.dot(t,a);return z.normalize(z.subtract(z.add(n,z.multiplyByScalar(a,s,o),n),e,n),n)};var Xx=new z;zx._rotationVector=function(e,t,i,n,r){var a=z.subtract(n,e,Xx);if(a=z.normalize(a,a),z.dot(t,a)<.9999999847691291){var o=z.cross(t,a,a);if(z.magnitude(o)>I.EPSILON13)return z.normalize(o,new z)}return r};var Zx=new z,Qx=new z,Kx=new z,Jx=new z;zx._horizonToPlaneNormalDotProduct=function(e,t,i,n,r){var a=z.clone(r,Zx),o=z.clone(e.center,Qx),s=e.radius,c=z.subtract(o,a,Kx),l=z.magnitudeSquared(c),u=s*s;if(l<u)return!1;var h=l-u,d=Math.sqrt(h),f=d*(1/Math.sqrt(l))*d;c=z.normalize(c,c);var p=z.add(a,z.multiplyByScalar(c,f,Jx),Jx),m=Math.sqrt(h-f*f),_=this._rotationVector(o,t,i,a,n),g=z.fromElements(_.x*_.x*c.x+(_.x*_.y-_.z)*c.y+(_.x*_.z+_.y)*c.z,(_.x*_.y+_.z)*c.x+_.y*_.y*c.y+(_.y*_.z-_.x)*c.z,(_.x*_.z-_.y)*c.x+(_.y*_.z+_.x)*c.y+_.z*_.z*c.z,Zx);g=z.normalize(g,g);var v=z.multiplyByScalar(g,m,Zx);_=z.normalize(z.subtract(z.add(p,v,Kx),o,Kx),Kx);var b=z.dot(t,_);_=z.normalize(z.subtract(z.subtract(p,v,_),o,_),_);var y=z.dot(t,_);return b<y?b:y};var $x=zx;function eE(e,t,i){e=Object(w.a)(e,0),t=Object(w.a)(t,0),i=Object(w.a)(i,0),this.value=new Float32Array([e,t,i])}Object(O.a)(eE.prototype,{componentDatatype:{get:function(){return dn.FLOAT}},componentsPerAttribute:{get:function(){return 3}},normalize:{get:function(){return!1}}}),eE.fromCartesian3=function(e){return x.a.defined("offset",e),new eE(e.x,e.y,e.z)},eE.toValue=function(e,t){return x.a.defined("offset",e),Object(u.a)(t)||(t=new Float32Array([e.x,e.y,e.z])),t[0]=e.x,t[1]=e.y,t[2]=e.z,t};var tE=eE,iE=n(12);function nE(e,t,i){x.a.defined("url",e),x.a.defined("apiKey",t),Object(u.a)(i)&&x.a.typeOf.object("params",i),(e=f.a.createIfNeeded(e)).appendForwardSlash(),e.setQueryParameters({key:t}),this._url=e,this._params=Object(w.a)(i,{})}Object(O.a)(nE.prototype,{url:{get:function(){return this._url}},params:{get:function(){return this._params}}}),nE.prototype.geocode=function(e){return x.a.typeOf.string("query",e),this._url.getDerivedResource({url:"json",queryParameters:Object(ff.a)(this._params,{q:e})}).fetchJson().then((function(e){return e.results.map((function(e){var t,i=e.bounds;if(Object(u.a)(i))t=Ve.fromDegrees(i.southwest.lng,i.southwest.lat,i.northeast.lng,i.northeast.lat);else{var n=e.geometry.lat,r=e.geometry.lng;t=z.fromDegrees(n,r)}return{displayName:e.formatted,destination:t}}))}))};var rE,aE=nE,oE={packedLength:void 0,pack:h.a.throwInstantiationError,unpack:h.a.throwInstantiationError},sE={packedInterpolationLength:void 0,convertPackedArrayForInterpolation:h.a.throwInstantiationError,unpackInterpolationResult:h.a.throwInstantiationError},cE=n(121),lE=function(e,t){return document.defaultView.getComputedStyle(e,null).getPropertyValue(t)},uE=function(e,t,i,n){var r=e.measureText(t),a=lE(e.canvas,"font-family"),o=lE(e.canvas,"font-size").replace("px",""),s=lE(e.canvas,"font-style"),c=lE(e.canvas,"font-weight"),l=!/\S/.test(t);r.fontsize=o;var u=document.createElement("div");u.style.position="absolute",u.style.opacity=0,u.style.font=s+" "+c+" "+o+"px "+a,u.innerHTML=t+"<br/>"+t,document.body.appendChild(u),r.leading=1.2*o;var h=lE(u,"height");if((h=h.replace("px",""))>=2*o&&(r.leading=h/2|0),document.body.removeChild(u),l)r.ascent=0,r.descent=0,r.bounds={minx:0,maxx:r.width,miny:0,maxy:0},r.height=0;else{var d=document.createElement("canvas");d.width=r.width+100,d.height=3*o,d.style.opacity=1,d.style.fontFamily=a,d.style.fontSize=o,d.style.fontStyle=s,d.style.fontWeight=c;var f=d.getContext("2d");f.font=s+" "+c+" "+o+"px "+a;var p=d.width,m=d.height,_=m/2;f.fillStyle="white",f.fillRect(-1,-1,p+2,m+2),i&&(f.strokeStyle="black",f.lineWidth=e.lineWidth,f.strokeText(t,50,_)),n&&(f.fillStyle="black",f.fillText(t,50,_));for(var g=f.getImageData(0,0,p,m).data,v=0,b=4*p,y=g.length;++v<y&&255===g[v];);var w=v/b|0;for(v=y-1;--v>0&&255===g[v];);var O=v/b|0;for(v=0;v<y&&255===g[v];)(v+=b)>=y&&(v=v-y+4);var x=v%b/4|0,E=1;for(v=y-3;v>=0&&255===g[v];)(v-=b)<0&&(v=y-3-4*E++);var T=v%b/4+1|0;r.ascent=_-w,r.descent=O-_,r.bounds={minx:x-50,maxx:T-50,miny:0,maxy:O-w},r.height=O-w+1}return r};var hE=function(e,t){if(!Object(u.a)(e))throw new h.a("text is required.");if(""!==e){t=Object(w.a)(t,w.a.EMPTY_OBJECT);var i=Object(w.a)(t.font,"10px sans-serif"),n=Object(w.a)(t.stroke,!1),r=Object(w.a)(t.fill,!0),a=Object(w.a)(t.strokeWidth,1),o=Object(w.a)(t.backgroundColor,uf.TRANSPARENT),s=Object(w.a)(t.padding,0),c=2*s,l=document.createElement("canvas");l.width=1,l.height=1,l.style.font=i;var d=l.getContext("2d");Object(u.a)(rE)||(Object(u.a)(d.imageSmoothingEnabled)?rE="imageSmoothingEnabled":Object(u.a)(d.mozImageSmoothingEnabled)?rE="mozImageSmoothingEnabled":Object(u.a)(d.webkitImageSmoothingEnabled)?rE="webkitImageSmoothingEnabled":Object(u.a)(d.msImageSmoothingEnabled)&&(rE="msImageSmoothingEnabled")),d.font=i,d.lineJoin="round",d.lineWidth=a,d[rE]=!1,d.textBaseline=Object(w.a)(t.textBaseline,"bottom"),l.style.visibility="hidden",document.body.appendChild(l);var f=uE(d,e,n,r);l.dimensions=f,document.body.removeChild(l),l.style.visibility="";var p=-f.bounds.minx,m=Math.ceil(f.width)+p+c,_=f.height+c,g=_-(_-f.ascent+c)+c;if(l.width=m,l.height=_,d.font=i,d.lineJoin="round",d.lineWidth=a,d[rE]=!1,o!==uf.TRANSPARENT&&(d.fillStyle=o.toCssColorString(),d.fillRect(0,0,l.width,l.height)),n){var v=Object(w.a)(t.strokeColor,uf.BLACK);d.strokeStyle=v.toCssColorString(),d.strokeText(e,p+s,g)}if(r){var b=Object(w.a)(t.fillColor,uf.WHITE);d.fillStyle=b.toCssColorString(),d.fillText(e,p+s,g)}return l}};function dE(){this._cache={}}dE.prototype.fromColor=function(e,t){if(!Object(u.a)(e))throw new h.a("color is required");if(!Object(u.a)(t))throw new h.a("size is required");return _E(void 0,void 0,e,t,this._cache)},dE.prototype.fromUrl=function(e,t,i){if(!Object(u.a)(e))throw new h.a("url is required");if(!Object(u.a)(t))throw new h.a("color is required");if(!Object(u.a)(i))throw new h.a("size is required");return _E(e,void 0,t,i,this._cache)},dE.prototype.fromMakiIconId=function(e,t,i){if(!Object(u.a)(e))throw new h.a("id is required");if(!Object(u.a)(t))throw new h.a("color is required");if(!Object(u.a)(i))throw new h.a("size is required");return _E(y("Assets/Textures/maki/"+encodeURIComponent(e)+".png"),void 0,t,i,this._cache)},dE.prototype.fromText=function(e,t,i){if(!Object(u.a)(e))throw new h.a("text is required");if(!Object(u.a)(t))throw new h.a("color is required");if(!Object(u.a)(i))throw new h.a("size is required");return _E(void 0,e,t,i,this._cache)};var fE=new uf;function pE(e,t,i){var n=i/2.5,r=n,a=n;t.width>t.height?a=n*(t.height/t.width):t.width<t.height&&(r=n*(t.width/t.height));var o=Math.round((i-r)/2),s=Math.round(7/24*i-a/2);e.globalCompositeOperation="destination-out",e.drawImage(t,o-1,s,r,a),e.drawImage(t,o,s-1,r,a),e.drawImage(t,o+1,s,r,a),e.drawImage(t,o,s+1,r,a),e.globalCompositeOperation="destination-over",e.fillStyle=uf.BLACK.toCssColorString(),e.fillRect(o-1,s-1,r+2,a+2),e.globalCompositeOperation="destination-out",e.drawImage(t,o,s,r,a),e.globalCompositeOperation="destination-over",e.fillStyle=uf.WHITE.toCssColorString(),e.fillRect(o-1,s-2,r+2,a+2)}var mE=new Array(4);function _E(e,t,i,n,r){mE[0]=e,mE[1]=t,mE[2]=i,mE[3]=n;var a=JSON.stringify(mE),o=r[a];if(Object(u.a)(o))return o;var s=document.createElement("canvas");s.width=n,s.height=n;var c=s.getContext("2d");if(function(e,t,i){e.save(),e.scale(i/24,i/24),e.fillStyle=t.toCssColorString(),e.strokeStyle=t.brighten(.6,fE).toCssColorString(),e.lineWidth=.846,e.beginPath(),e.moveTo(6.72,.422),e.lineTo(17.28,.422),e.bezierCurveTo(18.553,.422,19.577,1.758,19.577,3.415),e.lineTo(19.577,10.973),e.bezierCurveTo(19.577,12.63,18.553,13.966,17.282,13.966),e.lineTo(14.386,14.008),e.lineTo(11.826,23.578),e.lineTo(9.614,14.008),e.lineTo(6.719,13.965),e.bezierCurveTo(5.446,13.983,4.422,12.629,4.422,10.972),e.lineTo(4.422,3.416),e.bezierCurveTo(4.423,1.76,5.447,.423,6.718,.423),e.closePath(),e.fill(),e.stroke(),e.restore()}(c,i,n),Object(u.a)(e)){var l=f.a.createIfNeeded(e).fetchImage().then((function(e){return pE(c,e,n),r[a]=s,s}));return r[a]=l,l}if(Object(u.a)(t)){var h=hE(t,{font:"bold "+n+"px sans-serif"});pE(c,h,n)}return r[a]=s,s}var gE=dE;function vE(e){e=Object(w.a)(e,w.a.EMPTY_OBJECT);var t=Object(w.a)(e.vertexFormat,Ba.DEFAULT);this._vertexFormat=t,this._workerName="createPlaneGeometry"}vE.packedLength=Ba.packedLength,vE.pack=function(e,t,i){return x.a.typeOf.object("value",e),x.a.defined("array",t),i=Object(w.a)(i,0),Ba.pack(e._vertexFormat,t,i),t};var bE=new Ba,yE={vertexFormat:bE};vE.unpack=function(e,t,i){x.a.defined("array",e),t=Object(w.a)(t,0);var n=Ba.unpack(e,t,bE);return Object(u.a)(i)?(i._vertexFormat=Ba.clone(n,i._vertexFormat),i):new vE(yE)};var wE=new z(-.5,-.5,0),OE=new z(.5,.5,0);vE.createGeometry=function(e){var t,i,n=e._vertexFormat,r=new Fa;if(n.position){if((i=new Float64Array(12))[0]=wE.x,i[1]=wE.y,i[2]=0,i[3]=OE.x,i[4]=wE.y,i[5]=0,i[6]=OE.x,i[7]=OE.y,i[8]=0,i[9]=wE.x,i[10]=OE.y,i[11]=0,r.position=new Na({componentDatatype:dn.DOUBLE,componentsPerAttribute:3,values:i}),n.normal){var a=new Float32Array(12);a[0]=0,a[1]=0,a[2]=1,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=1,a[9]=0,a[10]=0,a[11]=1,r.normal=new Na({componentDatatype:dn.FLOAT,componentsPerAttribute:3,values:a})}if(n.st){var o=new Float32Array(8);o[0]=0,o[1]=0,o[2]=1,o[3]=0,o[4]=1,o[5]=1,o[6]=0,o[7]=1,r.st=new Na({componentDatatype:dn.FLOAT,componentsPerAttribute:2,values:o})}if(n.tangent){var s=new Float32Array(12);s[0]=1,s[1]=0,s[2]=0,s[3]=1,s[4]=0,s[5]=0,s[6]=1,s[7]=0,s[8]=0,s[9]=1,s[10]=0,s[11]=0,r.tangent=new Na({componentDatatype:dn.FLOAT,componentsPerAttribute:3,values:s})}if(n.bitangent){var c=new Float32Array(12);c[0]=0,c[1]=1,c[2]=0,c[3]=0,c[4]=1,c[5]=0,c[6]=0,c[7]=1,c[8]=0,c[9]=0,c[10]=1,c[11]=0,r.bitangent=new Na({componentDatatype:dn.FLOAT,componentsPerAttribute:3,values:c})}(t=new Uint16Array(6))[0]=0,t[1]=1,t[2]=2,t[3]=0,t[4]=2,t[5]=3}return new La({attributes:r,indices:t,primitiveType:yn.TRIANGLES,boundingSphere:new St(z.ZERO,Math.sqrt(2))})};var xE=vE;function EE(){this._workerName="createPlaneOutlineGeometry"}EE.packedLength=0,EE.pack=function(e,t){return x.a.defined("value",e),x.a.defined("array",t),t},EE.unpack=function(e,t,i){return x.a.defined("array",e),Object(u.a)(i)?i:new EE};var TE=new z(-.5,-.5,0),CE=new z(.5,.5,0);EE.createGeometry=function(){var e=new Fa,t=new Uint16Array(8),i=new Float64Array(12);return i[0]=TE.x,i[1]=TE.y,i[2]=TE.z,i[3]=CE.x,i[4]=TE.y,i[5]=TE.z,i[6]=CE.x,i[7]=CE.y,i[8]=TE.z,i[9]=TE.x,i[10]=CE.y,i[11]=TE.z,e.position=new Na({componentDatatype:dn.DOUBLE,componentsPerAttribute:3,values:i}),t[0]=0,t[1]=1,t[2]=1,t[3]=2,t[4]=2,t[5]=3,t[6]=3,t[7]=0,new La({attributes:e,indices:t,primitiveType:yn.LINES,boundingSphere:new St(z.ZERO,Math.sqrt(2))})};var SE=EE,AE=new z;var PE=function(e,t,i,n){return Ki(e,t,i,n,AE),AE.x>0&&AE.y>0&&AE.z>0},IE=new K,DE=new K;function jE(e,t,i,n){var r=n.cartesianToCartographic(e,IE).height,a=n.cartesianToCartographic(t,DE);a.height=r,n.cartographicToCartesian(a,t);var o=n.cartesianToCartographic(i,DE);o.height=r-100,n.cartographicToCartesian(o,i)}var ME=new ln,RE=new z,LE=new z,NE=new z,FE=new z,kE=new z,BE=new z,zE=new z,UE=new z,VE=new z,HE=new Rt,GE=new Rt,qE=new z,WE=new Kn,YE=new be,XE=new be;function ZE(e){var t=e.vertexFormat,i=e.geometry,n=e.shadowVolume,r=i.attributes.position.values,a=r.length,o=e.wall,s=e.top||o,c=e.bottom||o;if(t.st||t.normal||t.tangent||t.bitangent||n){var l=e.boundingRectangle,h=e.tangentPlane,d=e.ellipsoid,f=e.stRotation,p=e.perPositionHeight,m=HE;m.x=l.x,m.y=l.y;var _,g=t.st?new Float32Array(a/3*2):void 0;t.normal&&(_=p&&s&&!o?i.attributes.normal.values:new Float32Array(a));var v=t.tangent?new Float32Array(a):void 0,b=t.bitangent?new Float32Array(a):void 0,y=n?new Float32Array(a):void 0,w=0,O=0,x=LE,E=NE,T=FE,C=!0,S=YE,A=XE;if(0!==f){var P=Kn.fromAxisAngle(h._plane.normal,f,WE);S=be.fromQuaternion(P,S),P=Kn.fromAxisAngle(h._plane.normal,-f,WE),A=be.fromQuaternion(P,A)}else S=be.clone(be.IDENTITY,S),A=be.clone(be.IDENTITY,A);var D=0,j=0;s&&c&&(D=a/2,j=a/3,a/=2);for(var M=0;M<a;M+=3){var R=z.fromArray(r,M,qE);if(t.st){var L=be.multiplyByVector(S,R,RE);L=d.scaleToGeodeticSurface(L,L);var N=h.projectPointOntoPlane(L,GE);Rt.subtract(N,m,N);var F=I.clamp(N.x/l.width,0,1),k=I.clamp(N.y/l.height,0,1);c&&(g[w+j]=F,g[w+1+j]=k),s&&(g[w]=F,g[w+1]=k),w+=2}if(t.normal||t.tangent||t.bitangent||n){var B=O+1,U=O+2;if(o){if(M+3<a){var V=z.fromArray(r,M+3,kE);if(C){var H=z.fromArray(r,M+a,BE);p&&jE(R,V,H,d),z.subtract(V,R,V),z.subtract(H,R,H),x=z.normalize(z.cross(H,V,x),x),C=!1}z.equalsEpsilon(V,R,I.EPSILON10)&&(C=!0)}(t.tangent||t.bitangent)&&(T=d.geodeticSurfaceNormal(R,T),t.tangent&&(E=z.normalize(z.cross(T,x,E),E)))}else x=d.geodeticSurfaceNormal(R,x),(t.tangent||t.bitangent)&&(p&&(zE=z.fromArray(_,O,zE),UE=z.cross(z.UNIT_Z,zE,UE),UE=z.normalize(be.multiplyByVector(A,UE,UE),UE),t.bitangent&&(VE=z.normalize(z.cross(zE,UE,VE),VE))),E=z.cross(z.UNIT_Z,x,E),E=z.normalize(be.multiplyByVector(A,E,E),E),t.bitangent&&(T=z.normalize(z.cross(x,E,T),T)));t.normal&&(e.wall?(_[O+D]=x.x,_[B+D]=x.y,_[U+D]=x.z):c&&(_[O+D]=-x.x,_[B+D]=-x.y,_[U+D]=-x.z),(s&&!p||o)&&(_[O]=x.x,_[B]=x.y,_[U]=x.z)),n&&(o&&(x=d.geodeticSurfaceNormal(R,x)),y[O+D]=-x.x,y[B+D]=-x.y,y[U+D]=-x.z),t.tangent&&(e.wall?(v[O+D]=E.x,v[B+D]=E.y,v[U+D]=E.z):c&&(v[O+D]=-E.x,v[B+D]=-E.y,v[U+D]=-E.z),s&&(p?(v[O]=UE.x,v[B]=UE.y,v[U]=UE.z):(v[O]=E.x,v[B]=E.y,v[U]=E.z))),t.bitangent&&(c&&(b[O+D]=T.x,b[B+D]=T.y,b[U+D]=T.z),s&&(p?(b[O]=VE.x,b[B]=VE.y,b[U]=VE.z):(b[O]=T.x,b[B]=T.y,b[U]=T.z))),O+=3}}t.st&&(i.attributes.st=new Na({componentDatatype:dn.FLOAT,componentsPerAttribute:2,values:g})),t.normal&&(i.attributes.normal=new Na({componentDatatype:dn.FLOAT,componentsPerAttribute:3,values:_})),t.tangent&&(i.attributes.tangent=new Na({componentDatatype:dn.FLOAT,componentsPerAttribute:3,values:v})),t.bitangent&&(i.attributes.bitangent=new Na({componentDatatype:dn.FLOAT,componentsPerAttribute:3,values:b})),n&&(i.attributes.extrudeDirection=new Na({componentDatatype:dn.FLOAT,componentsPerAttribute:3,values:y}))}if(e.extrude&&Object(u.a)(e.offsetAttribute)){var G=r.length/3,q=new Uint8Array(G);if(e.offsetAttribute===fn.TOP)s&&c||o?q=Qt(q,1,0,G/2):s&&(q=Qt(q,1));else{var W=e.offsetAttribute===fn.NONE?0:1;q=Qt(q,W)}i.attributes.applyOffset=new Na({componentDatatype:dn.UNSIGNED_BYTE,componentsPerAttribute:1,values:q})}return i}var QE=new K,KE=new K,JE={west:0,east:0},$E=new bm;function eT(e,t,i,n,r){if(r=Object(w.a)(r,new Ve),!Object(u.a)(e)||e.length<3)return r.west=0,r.north=0,r.south=0,r.east=0,r;if(i===Zt.RHUMB)return Ve.fromCartesianArray(e,t,r);$E.ellipsoid.equals(t)||($E=new bm(void 0,void 0,t)),r.west=Number.POSITIVE_INFINITY,r.east=Number.NEGATIVE_INFINITY,r.south=Number.POSITIVE_INFINITY,r.north=Number.NEGATIVE_INFINITY,JE.west=Number.POSITIVE_INFINITY,JE.east=Number.NEGATIVE_INFINITY;for(var a,o=1/I.chordLength(n,t.maximumRadius),s=e.length,c=t.cartesianToCartographic(e[0],KE),l=QE,h=1;h<s;h++)a=l,l=c,c=t.cartesianToCartographic(e[h],a),$E.setEndPoints(l,c),iT($E,o,r,JE);return a=l,l=c,c=t.cartesianToCartographic(e[0],a),$E.setEndPoints(l,c),iT($E,o,r,JE),r.east-r.west>JE.west-JE.east&&(r.east=JE.east,r.west=JE.west),r}var tT=new K;function iT(e,t,i,n){for(var r=e.surfaceDistance,a=Math.ceil(r*t),o=a>0?r/(a-1):Number.POSITIVE_INFINITY,s=0,c=0;c<a;c++){var l=e.interpolateUsingSurfaceDistance(s,tT);s+=o;var u=l.longitude,h=l.latitude;i.west=Math.min(i.west,u),i.east=Math.max(i.east,u),i.south=Math.min(i.south,h),i.north=Math.max(i.north,h),n.west=u>0?Math.min(u,n.west):n.west,n.east=u<0?Math.max(u,n.east):n.east}}var nT=[];function rT(e,t,i,n,r,a,o,s,c){var l,u={walls:[]};if(a||o){var h,d,f=Vp.createGeometryFromPositions(e,t,i,r,s,c),p=f.attributes.position.values,m=f.indices;if(a&&o){var _=p.concat(p);h=_.length/3,(d=Sl.createTypedArray(h,2*m.length)).set(m);var g=m.length,v=h/2;for(l=0;l<g;l+=3){var b=d[l]+v,y=d[l+1]+v,w=d[l+2]+v;d[l+g]=w,d[l+1+g]=y,d[l+2+g]=b}if(f.attributes.position.values=_,r&&s.normal){var O=f.attributes.normal.values;f.attributes.normal.values=new Float32Array(_.length),f.attributes.normal.values.set(O)}f.indices=d}else if(o){for(h=p.length/3,d=Sl.createTypedArray(h,m.length),l=0;l<m.length;l+=3)d[l]=m[l+2],d[l+1]=m[l+1],d[l+2]=m[l];f.indices=d}u.topAndBottom=new Mu({geometry:f})}var x=n.outerRing,E=fc.fromPoints(x,e),T=E.projectPointsOntoPlane(x,nT),C=wp.computeWindingOrder2D(T);C===op.CLOCKWISE&&(x=x.slice().reverse());var S=Vp.computeWallGeometry(x,e,i,r,c);u.walls.push(new Mu({geometry:S}));var A=n.holes;for(l=0;l<A.length;l++){var P=A[l];T=(E=fc.fromPoints(P,e)).projectPointsOntoPlane(P,nT),(C=wp.computeWindingOrder2D(T))===op.COUNTER_CLOCKWISE&&(P=P.slice().reverse()),S=Vp.computeWallGeometry(P,e,i,r,c),u.walls.push(new Mu({geometry:S}))}return u}function aT(e){if(x.a.typeOf.object("options",e),x.a.typeOf.object("options.polygonHierarchy",e.polygonHierarchy),Object(u.a)(e.perPositionHeight)&&e.perPositionHeight&&Object(u.a)(e.height))throw new h.a("Cannot use both options.perPositionHeight and options.height");if(Object(u.a)(e.arcType)&&e.arcType!==Zt.GEODESIC&&e.arcType!==Zt.RHUMB)throw new h.a("Invalid arcType. Valid options are ArcType.GEODESIC and ArcType.RHUMB.");var t=e.polygonHierarchy,i=Object(w.a)(e.vertexFormat,Ba.DEFAULT),n=Object(w.a)(e.ellipsoid,ae.WGS84),r=Object(w.a)(e.granularity,I.RADIANS_PER_DEGREE),a=Object(w.a)(e.stRotation,0),o=Object(w.a)(e.perPositionHeight,!1),s=o&&Object(u.a)(e.extrudedHeight),c=Object(w.a)(e.height,0),l=Object(w.a)(e.extrudedHeight,c);if(!s){var d=Math.max(c,l);l=Math.min(c,l),c=d}this._vertexFormat=Ba.clone(i),this._ellipsoid=ae.clone(n),this._granularity=r,this._stRotation=a,this._height=c,this._extrudedHeight=l,this._closeTop=Object(w.a)(e.closeTop,!0),this._closeBottom=Object(w.a)(e.closeBottom,!0),this._polygonHierarchy=t,this._perPositionHeight=o,this._perPositionHeightExtrude=s,this._shadowVolume=Object(w.a)(e.shadowVolume,!1),this._workerName="createPolygonGeometry",this._offsetAttribute=e.offsetAttribute,this._arcType=Object(w.a)(e.arcType,Zt.GEODESIC),this._rectangle=void 0,this._textureCoordinateRotationPoints=void 0,this.packedLength=Vp.computeHierarchyPackedLength(t)+ae.packedLength+Ba.packedLength+12}aT.fromPositions=function(e){return e=Object(w.a)(e,w.a.EMPTY_OBJECT),x.a.defined("options.positions",e.positions),new aT({polygonHierarchy:{positions:e.positions},height:e.height,extrudedHeight:e.extrudedHeight,vertexFormat:e.vertexFormat,stRotation:e.stRotation,ellipsoid:e.ellipsoid,granularity:e.granularity,perPositionHeight:e.perPositionHeight,closeTop:e.closeTop,closeBottom:e.closeBottom,offsetAttribute:e.offsetAttribute,arcType:e.arcType})},aT.pack=function(e,t,i){return x.a.typeOf.object("value",e),x.a.defined("array",t),i=Object(w.a)(i,0),i=Vp.packPolygonHierarchy(e._polygonHierarchy,t,i),ae.pack(e._ellipsoid,t,i),i+=ae.packedLength,Ba.pack(e._vertexFormat,t,i),i+=Ba.packedLength,t[i++]=e._height,t[i++]=e._extrudedHeight,t[i++]=e._granularity,t[i++]=e._stRotation,t[i++]=e._perPositionHeightExtrude?1:0,t[i++]=e._perPositionHeight?1:0,t[i++]=e._closeTop?1:0,t[i++]=e._closeBottom?1:0,t[i++]=e._shadowVolume?1:0,t[i++]=Object(w.a)(e._offsetAttribute,-1),t[i++]=e._arcType,t[i]=e.packedLength,t};var oT=ae.clone(ae.UNIT_SPHERE),sT=new Ba,cT={polygonHierarchy:{}};aT.unpack=function(e,t,i){x.a.defined("array",e),t=Object(w.a)(t,0);var n=Vp.unpackPolygonHierarchy(e,t);t=n.startingIndex,delete n.startingIndex;var r=ae.unpack(e,t,oT);t+=ae.packedLength;var a=Ba.unpack(e,t,sT);t+=Ba.packedLength;var o=e[t++],s=e[t++],c=e[t++],l=e[t++],h=1===e[t++],d=1===e[t++],f=1===e[t++],p=1===e[t++],m=1===e[t++],_=e[t++],g=e[t++],v=e[t];return Object(u.a)(i)||(i=new aT(cT)),i._polygonHierarchy=n,i._ellipsoid=ae.clone(r,i._ellipsoid),i._vertexFormat=Ba.clone(a,i._vertexFormat),i._height=o,i._extrudedHeight=s,i._granularity=c,i._stRotation=l,i._perPositionHeightExtrude=h,i._perPositionHeight=d,i._closeTop=f,i._closeBottom=p,i._shadowVolume=m,i._offsetAttribute=-1===_?void 0:_,i._arcType=g,i.packedLength=v,i},aT.computeRectangle=function(e,t){x.a.typeOf.object("options",e),x.a.typeOf.object("options.polygonHierarchy",e.polygonHierarchy);var i=Object(w.a)(e.granularity,I.RADIANS_PER_DEGREE),n=Object(w.a)(e.arcType,Zt.GEODESIC);if(n!==Zt.GEODESIC&&n!==Zt.RHUMB)throw new h.a("Invalid arcType. Valid options are ArcType.GEODESIC and ArcType.RHUMB.");var r=e.polygonHierarchy,a=Object(w.a)(e.ellipsoid,ae.WGS84);return eT(r.positions,a,n,i,t)},aT.createGeometry=function(e){var t=e._vertexFormat,i=e._ellipsoid,n=e._granularity,r=e._stRotation,a=e._polygonHierarchy,o=e._perPositionHeight,s=e._closeTop,c=e._closeBottom,l=e._arcType,h=a.positions;if(!(h.length<3)){var d=fc.fromPoints(h,i),f=Vp.polygonsFromHierarchy(a,d.projectPointsOntoPlane.bind(d),!o,i),p=f.hierarchy,m=f.polygons;if(0!==p.length){h=p[0].outerRing;var _,g=Vp.computeBoundingRectangle(d.plane.normal,d.projectPointOntoPlane.bind(d),h,r,ME),v=[],b=e._height,y=e._extrudedHeight,w={perPositionHeight:o,vertexFormat:t,geometry:void 0,tangentPlane:d,boundingRectangle:g,ellipsoid:i,stRotation:r,bottom:!1,top:!0,wall:!1,extrude:!1,arcType:l};if(e._perPositionHeightExtrude||!I.equalsEpsilon(b,y,0,I.EPSILON2))for(w.extrude=!0,w.top=s,w.bottom=c,w.shadowVolume=e._shadowVolume,w.offsetAttribute=e._offsetAttribute,_=0;_<m.length;_++){var O,x=rT(i,m[_],n,p[_],o,s,c,t,l);s&&c?(O=x.topAndBottom,w.geometry=Vp.scaleToGeodeticHeightExtruded(O.geometry,b,y,i,o)):s?((O=x.topAndBottom).geometry.attributes.position.values=wp.scaleToGeodeticHeight(O.geometry.attributes.position.values,b,i,!o),w.geometry=O.geometry):c&&((O=x.topAndBottom).geometry.attributes.position.values=wp.scaleToGeodeticHeight(O.geometry.attributes.position.values,y,i,!0),w.geometry=O.geometry),(s||c)&&(w.wall=!1,O.geometry=ZE(w),v.push(O));var E=x.walls;w.wall=!0;for(var T=0;T<E.length;T++){var C=E[T];w.geometry=Vp.scaleToGeodeticHeightExtruded(C.geometry,b,y,i,o),C.geometry=ZE(w),v.push(C)}}else for(_=0;_<m.length;_++){var S=new Mu({geometry:Vp.createGeometryFromPositions(i,m[_],n,o,t,l)});if(S.geometry.attributes.position.values=wp.scaleToGeodeticHeight(S.geometry.attributes.position.values,b,i,!o),w.geometry=S.geometry,S.geometry=ZE(w),Object(u.a)(e._offsetAttribute)){var A=S.geometry.attributes.position.values.length,P=new Uint8Array(A/3),D=e._offsetAttribute===fn.NONE?0:1;Qt(P,D),S.geometry.attributes.applyOffset=new Na({componentDatatype:dn.UNSIGNED_BYTE,componentsPerAttribute:1,values:P})}v.push(S)}var j=id.combineInstances(v)[0];j.attributes.position.values=new Float64Array(j.attributes.position.values),j.indices=Sl.createTypedArray(j.attributes.position.values.length/3,j.indices);var M=j.attributes,R=St.fromVertices(M.position.values);return t.position||delete M.position,new La({attributes:M,indices:j.indices,primitiveType:j.primitiveType,boundingSphere:R,offsetAttribute:e._offsetAttribute})}}},aT.createShadowVolume=function(e,t,i){var n=e._granularity,r=e._ellipsoid,a=t(n,r),o=i(n,r);return new aT({polygonHierarchy:e._polygonHierarchy,ellipsoid:r,stRotation:e._stRotation,granularity:n,perPositionHeight:!1,extrudedHeight:a,height:o,vertexFormat:Ba.POSITION_ONLY,shadowVolume:!0,arcType:e._arcType})},Object(O.a)(aT.prototype,{rectangle:{get:function(){if(!Object(u.a)(this._rectangle)){var e=this._polygonHierarchy.positions;this._rectangle=eT(e,this._ellipsoid,this._arcType,this._granularity)}return this._rectangle}},textureCoordinateRotationPoints:{get:function(){return Object(u.a)(this._textureCoordinateRotationPoints)||(this._textureCoordinateRotationPoints=function(e){var t=-e._stRotation;if(0===t)return[0,0,0,1,1,0];var i=e._ellipsoid,n=e._polygonHierarchy.positions,r=e.rectangle;return La._textureCoordinateRotationPoints(n,t,i,r)}(this)),this._textureCoordinateRotationPoints}}});var lT=aT;var uT=function(e,t){this.positions=Object(u.a)(e)?e:[],this.holes=Object(u.a)(t)?t:[]},hT=[],dT=[];function fT(e,t,i,n,r){var a,o,s=fc.fromPoints(t,e).projectPointsOntoPlane(t,hT);wp.computeWindingOrder2D(s)===op.CLOCKWISE&&(s.reverse(),t=t.slice().reverse());var c=t.length,l=0;if(n)for(a=new Float64Array(2*c*3),o=0;o<c;o++){var u=t[o],h=t[(o+1)%c];a[l++]=u.x,a[l++]=u.y,a[l++]=u.z,a[l++]=h.x,a[l++]=h.y,a[l++]=h.z}else{var d=0;if(r===Zt.GEODESIC)for(o=0;o<c;o++)d+=Vp.subdivideLineCount(t[o],t[(o+1)%c],i);else if(r===Zt.RHUMB)for(o=0;o<c;o++)d+=Vp.subdivideRhumbLineCount(e,t[o],t[(o+1)%c],i);for(a=new Float64Array(3*d),o=0;o<c;o++){var f;r===Zt.GEODESIC?f=Vp.subdivideLine(t[o],t[(o+1)%c],i,dT):r===Zt.RHUMB&&(f=Vp.subdivideRhumbLine(e,t[o],t[(o+1)%c],i,dT));for(var p=f.length,m=0;m<p;++m)a[l++]=f[m]}}var _=2*(c=a.length/3),g=Sl.createTypedArray(c,_);for(l=0,o=0;o<c-1;o++)g[l++]=o,g[l++]=o+1;return g[l++]=c-1,g[l++]=0,new Mu({geometry:new La({attributes:new Fa({position:new Na({componentDatatype:dn.DOUBLE,componentsPerAttribute:3,values:a})}),indices:g,primitiveType:yn.LINES})})}function pT(e,t,i,n,r){var a,o,s=fc.fromPoints(t,e).projectPointsOntoPlane(t,hT);wp.computeWindingOrder2D(s)===op.CLOCKWISE&&(s.reverse(),t=t.slice().reverse());var c=t.length,l=new Array(c),u=0;if(n)for(a=new Float64Array(2*c*3*2),o=0;o<c;++o){l[o]=u/3;var h=t[o],d=t[(o+1)%c];a[u++]=h.x,a[u++]=h.y,a[u++]=h.z,a[u++]=d.x,a[u++]=d.y,a[u++]=d.z}else{var f=0;if(r===Zt.GEODESIC)for(o=0;o<c;o++)f+=Vp.subdivideLineCount(t[o],t[(o+1)%c],i);else if(r===Zt.RHUMB)for(o=0;o<c;o++)f+=Vp.subdivideRhumbLineCount(e,t[o],t[(o+1)%c],i);for(a=new Float64Array(3*f*2),o=0;o<c;++o){var p;l[o]=u/3,r===Zt.GEODESIC?p=Vp.subdivideLine(t[o],t[(o+1)%c],i,dT):r===Zt.RHUMB&&(p=Vp.subdivideRhumbLine(e,t[o],t[(o+1)%c],i,dT));for(var m=p.length,_=0;_<m;++_)a[u++]=p[_]}}c=a.length/6;var g=l.length,v=2*(2*c+g),b=Sl.createTypedArray(c,v);for(u=0,o=0;o<c;++o)b[u++]=o,b[u++]=(o+1)%c,b[u++]=o+c,b[u++]=(o+1)%c+c;for(o=0;o<g;o++){var y=l[o];b[u++]=y,b[u++]=y+c}return new Mu({geometry:new La({attributes:new Fa({position:new Na({componentDatatype:dn.DOUBLE,componentsPerAttribute:3,values:a})}),indices:b,primitiveType:yn.LINES})})}function mT(e){if(x.a.typeOf.object("options",e),x.a.typeOf.object("options.polygonHierarchy",e.polygonHierarchy),e.perPositionHeight&&Object(u.a)(e.height))throw new h.a("Cannot use both options.perPositionHeight and options.height");if(Object(u.a)(e.arcType)&&e.arcType!==Zt.GEODESIC&&e.arcType!==Zt.RHUMB)throw new h.a("Invalid arcType. Valid options are ArcType.GEODESIC and ArcType.RHUMB.");var t=e.polygonHierarchy,i=Object(w.a)(e.ellipsoid,ae.WGS84),n=Object(w.a)(e.granularity,I.RADIANS_PER_DEGREE),r=Object(w.a)(e.perPositionHeight,!1),a=r&&Object(u.a)(e.extrudedHeight),o=Object(w.a)(e.arcType,Zt.GEODESIC),s=Object(w.a)(e.height,0),c=Object(w.a)(e.extrudedHeight,s);if(!a){var l=Math.max(s,c);c=Math.min(s,c),s=l}this._ellipsoid=ae.clone(i),this._granularity=n,this._height=s,this._extrudedHeight=c,this._arcType=o,this._polygonHierarchy=t,this._perPositionHeight=r,this._perPositionHeightExtrude=a,this._offsetAttribute=e.offsetAttribute,this._workerName="createPolygonOutlineGeometry",this.packedLength=Vp.computeHierarchyPackedLength(t)+ae.packedLength+8}mT.pack=function(e,t,i){return x.a.typeOf.object("value",e),x.a.defined("array",t),i=Object(w.a)(i,0),i=Vp.packPolygonHierarchy(e._polygonHierarchy,t,i),ae.pack(e._ellipsoid,t,i),i+=ae.packedLength,t[i++]=e._height,t[i++]=e._extrudedHeight,t[i++]=e._granularity,t[i++]=e._perPositionHeightExtrude?1:0,t[i++]=e._perPositionHeight?1:0,t[i++]=e._arcType,t[i++]=Object(w.a)(e._offsetAttribute,-1),t[i]=e.packedLength,t};var _T=ae.clone(ae.UNIT_SPHERE),gT={polygonHierarchy:{}};mT.unpack=function(e,t,i){x.a.defined("array",e),t=Object(w.a)(t,0);var n=Vp.unpackPolygonHierarchy(e,t);t=n.startingIndex,delete n.startingIndex;var r=ae.unpack(e,t,_T);t+=ae.packedLength;var a=e[t++],o=e[t++],s=e[t++],c=1===e[t++],l=1===e[t++],h=e[t++],d=e[t++],f=e[t];return Object(u.a)(i)||(i=new mT(gT)),i._polygonHierarchy=n,i._ellipsoid=ae.clone(r,i._ellipsoid),i._height=a,i._extrudedHeight=o,i._granularity=s,i._perPositionHeight=l,i._perPositionHeightExtrude=c,i._arcType=h,i._offsetAttribute=-1===d?void 0:d,i.packedLength=f,i},mT.fromPositions=function(e){return e=Object(w.a)(e,w.a.EMPTY_OBJECT),x.a.defined("options.positions",e.positions),new mT({polygonHierarchy:{positions:e.positions},height:e.height,extrudedHeight:e.extrudedHeight,ellipsoid:e.ellipsoid,granularity:e.granularity,perPositionHeight:e.perPositionHeight,arcType:e.arcType,offsetAttribute:e.offsetAttribute})},mT.createGeometry=function(e){var t=e._ellipsoid,i=e._granularity,n=e._polygonHierarchy,r=e._perPositionHeight,a=e._arcType,o=Vp.polygonOutlinesFromHierarchy(n,!r,t);if(0!==o.length){var s,c,l,h=[],d=I.chordLength(i,t.maximumRadius),f=e._height,p=e._extrudedHeight;if(e._perPositionHeightExtrude||!I.equalsEpsilon(f,p,0,I.EPSILON2))for(l=0;l<o.length;l++){if((s=pT(t,o[l],d,r,a)).geometry=Vp.scaleToGeodeticHeightExtruded(s.geometry,f,p,t,r),Object(u.a)(e._offsetAttribute)){var m=s.geometry.attributes.position.values.length/3,_=new Uint8Array(m);e._offsetAttribute===fn.TOP?_=Qt(_,1,0,m/2):(c=e._offsetAttribute===fn.NONE?0:1,_=Qt(_,c)),s.geometry.attributes.applyOffset=new Na({componentDatatype:dn.UNSIGNED_BYTE,componentsPerAttribute:1,values:_})}h.push(s)}else for(l=0;l<o.length;l++){if((s=fT(t,o[l],d,r,a)).geometry.attributes.position.values=wp.scaleToGeodeticHeight(s.geometry.attributes.position.values,f,t,!r),Object(u.a)(e._offsetAttribute)){var g=s.geometry.attributes.position.values.length,v=new Uint8Array(g/3);c=e._offsetAttribute===fn.NONE?0:1,Qt(v,c),s.geometry.attributes.applyOffset=new Na({componentDatatype:dn.UNSIGNED_BYTE,componentsPerAttribute:1,values:v})}h.push(s)}var b=id.combineInstances(h)[0],y=St.fromVertices(b.attributes.position.values);return new La({attributes:b.attributes,indices:b.indices,primitiveType:b.primitiveType,boundingSphere:y,offsetAttribute:e._offsetAttribute})}};var vT=mT,bT=[];function yT(e,t,i,n,r){var a,o=bT;o.length=r;var s=i.red,c=i.green,l=i.blue,u=i.alpha,h=n.red,d=n.green,f=n.blue,p=n.alpha;if(uf.equals(i,n)){for(a=0;a<r;a++)o[a]=uf.clone(i);return o}var m=(h-s)/r,_=(d-c)/r,g=(f-l)/r,v=(p-u)/r;for(a=0;a<r;a++)o[a]=new uf(s+a*m,c+a*_,l+a*g,u+a*v);return o}function wT(e){var t=(e=Object(w.a)(e,w.a.EMPTY_OBJECT)).positions,i=e.colors,n=Object(w.a)(e.width,1),r=Object(w.a)(e.colorsPerVertex,!1);if(!Object(u.a)(t)||t.length<2)throw new h.a("At least two positions are required.");if("number"!=typeof n)throw new h.a("width must be a number");if(Object(u.a)(i)&&(r&&i.length<t.length||!r&&i.length<t.length-1))throw new h.a("colors has an invalid length.");this._positions=t,this._colors=i,this._width=n,this._colorsPerVertex=r,this._vertexFormat=Ba.clone(Object(w.a)(e.vertexFormat,Ba.DEFAULT)),this._followSurface=Object(w.a)(e.followSurface,!0),Object(u.a)(e.followSurface)&&(Object(mv.a)("PolylineGeometry.followSurface","PolylineGeometry.followSurface is deprecated and will be removed in Cesium 1.55. Use PolylineGeometry.arcType instead."),e.arcType=e.followSurface?Zt.GEODESIC:Zt.NONE),this._arcType=Object(w.a)(e.arcType,Zt.GEODESIC),this._followSurface=this._arcType!==Zt.NONE,this._granularity=Object(w.a)(e.granularity,I.RADIANS_PER_DEGREE),this._ellipsoid=ae.clone(Object(w.a)(e.ellipsoid,ae.WGS84)),this._workerName="createPolylineGeometry";var a=1+t.length*z.packedLength;a+=Object(u.a)(i)?1+i.length*uf.packedLength:1,this.packedLength=a+ae.packedLength+Ba.packedLength+4}wT.pack=function(e,t,i){if(!Object(u.a)(e))throw new h.a("value is required");if(!Object(u.a)(t))throw new h.a("array is required");var n;i=Object(w.a)(i,0);var r=e._positions,a=r.length;for(t[i++]=a,n=0;n<a;++n,i+=z.packedLength)z.pack(r[n],t,i);var o=e._colors;for(a=Object(u.a)(o)?o.length:0,t[i++]=a,n=0;n<a;++n,i+=uf.packedLength)uf.pack(o[n],t,i);return ae.pack(e._ellipsoid,t,i),i+=ae.packedLength,Ba.pack(e._vertexFormat,t,i),i+=Ba.packedLength,t[i++]=e._width,t[i++]=e._colorsPerVertex?1:0,t[i++]=e._arcType,t[i]=e._granularity,t};var OT=ae.clone(ae.UNIT_SPHERE),xT=new Ba,ET={positions:void 0,colors:void 0,ellipsoid:OT,vertexFormat:xT,width:void 0,colorsPerVertex:void 0,arcType:void 0,granularity:void 0};wT.unpack=function(e,t,i){if(!Object(u.a)(e))throw new h.a("array is required");var n;t=Object(w.a)(t,0);var r=e[t++],a=new Array(r);for(n=0;n<r;++n,t+=z.packedLength)a[n]=z.unpack(e,t);var o=(r=e[t++])>0?new Array(r):void 0;for(n=0;n<r;++n,t+=uf.packedLength)o[n]=uf.unpack(e,t);var s=ae.unpack(e,t,OT);t+=ae.packedLength;var c=Ba.unpack(e,t,xT);t+=Ba.packedLength;var l=e[t++],d=1===e[t++],f=e[t++],p=e[t];return Object(u.a)(i)?(i._positions=a,i._colors=o,i._ellipsoid=ae.clone(s,i._ellipsoid),i._vertexFormat=Ba.clone(c,i._vertexFormat),i._width=l,i._colorsPerVertex=d,i._arcType=f,i._granularity=p,i):(ET.positions=a,ET.colors=o,ET.width=l,ET.colorsPerVertex=d,ET.arcType=f,ET.granularity=p,new wT(ET))};var TT=new z,CT=new z,ST=new z,AT=new z;wT.createGeometry=function(e){var t,i,n,r=e._width,a=e._vertexFormat,o=e._colors,s=e._colorsPerVertex,c=e._arcType,l=e._granularity,h=e._ellipsoid,d=$t(e._positions,z.equalsEpsilon),f=d.length;if(!(f<2||r<=0)){if(c===Zt.GEODESIC||c===Zt.RHUMB){var p,m;c===Zt.GEODESIC?(p=I.chordLength(l,h.maximumRadius),m=Gm.numberOfPoints):(p=l,m=Gm.numberOfPointsRhumbLine);var _=Gm.extractHeights(d,h);if(Object(u.a)(o)){var g=1;for(t=0;t<f-1;++t)g+=m(d[t],d[t+1],p);var v=new Array(g),b=0;for(t=0;t<f-1;++t){var y=d[t],w=d[t+1],O=o[t],x=m(y,w,p);if(s&&t<g){var E=yT(0,0,O,o[t+1],x),T=E.length;for(i=0;i<T;++i)v[b++]=E[i]}else for(i=0;i<x;++i)v[b++]=uf.clone(O)}v[b]=uf.clone(o[o.length-1]),o=v,bT.length=0}d=c===Zt.GEODESIC?Gm.generateCartesianArc({positions:d,minDistance:p,ellipsoid:h,height:_}):Gm.generateCartesianRhumbArc({positions:d,granularity:p,ellipsoid:h,height:_})}var C,S=4*(f=d.length)-4,A=new Float64Array(3*S),P=new Float64Array(3*S),D=new Float64Array(3*S),j=new Float32Array(2*S),M=a.st?new Float32Array(2*S):void 0,R=Object(u.a)(o)?new Uint8Array(4*S):void 0,L=0,N=0,F=0,k=0;for(i=0;i<f;++i){var B,U;0===i?(C=TT,z.subtract(d[0],d[1],C),z.add(d[0],C,C)):C=d[i-1],z.clone(C,ST),z.clone(d[i],CT),i===f-1?(C=TT,z.subtract(d[f-1],d[f-2],C),z.add(d[f-1],C,C)):C=d[i+1],z.clone(C,AT),Object(u.a)(R)&&(B=0===i||s?o[i]:o[i-1],i!==f-1&&(U=o[i]));var V=i===f-1?2:4;for(n=0===i?2:0;n<V;++n){z.pack(CT,A,L),z.pack(ST,P,L),z.pack(AT,D,L),L+=3;var H=n-2<0?-1:1;if(j[N++]=n%2*2-1,j[N++]=H*r,a.st&&(M[F++]=i/(f-1),M[F++]=Math.max(j[N-2],0)),Object(u.a)(R)){var G=n<2?B:U;R[k++]=uf.floatToByte(G.red),R[k++]=uf.floatToByte(G.green),R[k++]=uf.floatToByte(G.blue),R[k++]=uf.floatToByte(G.alpha)}}}var q=new Fa;q.position=new Na({componentDatatype:dn.DOUBLE,componentsPerAttribute:3,values:A}),q.prevPosition=new Na({componentDatatype:dn.DOUBLE,componentsPerAttribute:3,values:P}),q.nextPosition=new Na({componentDatatype:dn.DOUBLE,componentsPerAttribute:3,values:D}),q.expandAndWidth=new Na({componentDatatype:dn.FLOAT,componentsPerAttribute:2,values:j}),a.st&&(q.st=new Na({componentDatatype:dn.FLOAT,componentsPerAttribute:2,values:M})),Object(u.a)(R)&&(q.color=new Na({componentDatatype:dn.UNSIGNED_BYTE,componentsPerAttribute:4,values:R,normalize:!0}));var W=Sl.createTypedArray(S,6*f-6),Y=0,X=0,Z=f-1;for(i=0;i<Z;++i)W[X++]=Y,W[X++]=Y+2,W[X++]=Y+1,W[X++]=Y+1,W[X++]=Y+2,W[X++]=Y+3,Y+=4;return new La({attributes:q,indices:W,primitiveType:yn.TRIANGLES,boundingSphere:St.fromPoints(d),geometryType:pn.POLYLINES})}};var PT=wT;function IT(e){var t=(e=Object(w.a)(e,w.a.EMPTY_OBJECT)).polylinePositions,i=e.shapePositions;if(!Object(u.a)(t))throw new h.a("options.polylinePositions is required.");if(!Object(u.a)(i))throw new h.a("options.shapePositions is required.");this._positions=t,this._shape=i,this._ellipsoid=ae.clone(Object(w.a)(e.ellipsoid,ae.WGS84)),this._cornerType=Object(w.a)(e.cornerType,fm.ROUNDED),this._vertexFormat=Ba.clone(Object(w.a)(e.vertexFormat,Ba.DEFAULT)),this._granularity=Object(w.a)(e.granularity,I.RADIANS_PER_DEGREE),this._workerName="createPolylineVolumeGeometry";var n=1+t.length*z.packedLength;n+=1+i.length*Rt.packedLength,this.packedLength=n+ae.packedLength+Ba.packedLength+2}IT.pack=function(e,t,i){if(!Object(u.a)(e))throw new h.a("value is required");if(!Object(u.a)(t))throw new h.a("array is required");var n;i=Object(w.a)(i,0);var r=e._positions,a=r.length;for(t[i++]=a,n=0;n<a;++n,i+=z.packedLength)z.pack(r[n],t,i);var o=e._shape;for(a=o.length,t[i++]=a,n=0;n<a;++n,i+=Rt.packedLength)Rt.pack(o[n],t,i);return ae.pack(e._ellipsoid,t,i),i+=ae.packedLength,Ba.pack(e._vertexFormat,t,i),i+=Ba.packedLength,t[i++]=e._cornerType,t[i]=e._granularity,t};var DT=ae.clone(ae.UNIT_SPHERE),jT=new Ba,MT={polylinePositions:void 0,shapePositions:void 0,ellipsoid:DT,vertexFormat:jT,cornerType:void 0,granularity:void 0};IT.unpack=function(e,t,i){if(!Object(u.a)(e))throw new h.a("array is required");var n;t=Object(w.a)(t,0);var r=e[t++],a=new Array(r);for(n=0;n<r;++n,t+=z.packedLength)a[n]=z.unpack(e,t);r=e[t++];var o=new Array(r);for(n=0;n<r;++n,t+=Rt.packedLength)o[n]=Rt.unpack(e,t);var s=ae.unpack(e,t,DT);t+=ae.packedLength;var c=Ba.unpack(e,t,jT);t+=Ba.packedLength;var l=e[t++],d=e[t];return Object(u.a)(i)?(i._positions=a,i._shape=o,i._ellipsoid=ae.clone(s,i._ellipsoid),i._vertexFormat=Ba.clone(c,i._vertexFormat),i._cornerType=l,i._granularity=d,i):(MT.polylinePositions=a,MT.shapePositions=o,MT.cornerType=l,MT.granularity=d,new IT(MT))};var RT=new ln;IT.createGeometry=function(e){var t=e._positions,i=$t(t,z.equalsEpsilon),n=e._shape;if(n=C_.removeDuplicatesFromShape(n),!(i.length<2||n.length<3)){wp.computeWindingOrder2D(n)===op.CLOCKWISE&&n.reverse();var r=ln.fromPoints(n,RT);return function(e,t,i,n){var r=new Fa;n.position&&(r.position=new Na({componentDatatype:dn.DOUBLE,componentsPerAttribute:3,values:e}));var a,o,s,c,l,u,h=t.length,d=e.length/3,f=(d-2*h)/(2*h),p=wp.triangulate(t),m=(f-1)*h*6+2*p.length,_=Sl.createTypedArray(d,m),g=2*h,v=0;for(a=0;a<f-1;a++){for(o=0;o<h-1;o++)u=(s=2*o+a*h*2)+g,l=(c=s+1)+g,_[v++]=c,_[v++]=s,_[v++]=l,_[v++]=l,_[v++]=s,_[v++]=u;l=(c=(s=2*h-2+a*h*2)+1)+g,u=s+g,_[v++]=c,_[v++]=s,_[v++]=l,_[v++]=l,_[v++]=s,_[v++]=u}if(n.st||n.tangent||n.bitangent){var b,y,w=new Float32Array(2*d),O=1/(f-1),x=1/i.height,E=i.height/2,T=0;for(a=0;a<f;a++){for(b=a*O,y=x*(t[0].y+E),w[T++]=b,w[T++]=y,o=1;o<h;o++)y=x*(t[o].y+E),w[T++]=b,w[T++]=y,w[T++]=b,w[T++]=y;y=x*(t[0].y+E),w[T++]=b,w[T++]=y}for(o=0;o<h;o++)b=0,y=x*(t[o].y+E),w[T++]=b,w[T++]=y;for(o=0;o<h;o++)b=(f-1)*O,y=x*(t[o].y+E),w[T++]=b,w[T++]=y;r.st=new Na({componentDatatype:dn.FLOAT,componentsPerAttribute:2,values:new Float32Array(w)})}var C=d-2*h;for(a=0;a<p.length;a+=3){var S=p[a]+C,A=p[a+1]+C,P=p[a+2]+C;_[v++]=S,_[v++]=A,_[v++]=P,_[v++]=P+h,_[v++]=A+h,_[v++]=S+h}var I=new La({attributes:r,indices:_,boundingSphere:St.fromVertices(e),primitiveType:yn.TRIANGLES});if(n.normal&&(I=id.computeNormal(I)),n.tangent||n.bitangent){try{I=id.computeTangentAndBitangent(I)}catch(e){Object(iE.a)("polyline-volume-tangent-bitangent","Unable to compute tangents and bitangents for polyline volume geometry")}n.tangent||(I.attributes.tangent=void 0),n.bitangent||(I.attributes.bitangent=void 0),n.st||(I.attributes.st=void 0)}return I}(C_.computePositions(i,n,r,e,!0),n,r,e._vertexFormat)}};var LT=IT;function NT(e){var t=(e=Object(w.a)(e,w.a.EMPTY_OBJECT)).polylinePositions,i=e.shapePositions;if(!Object(u.a)(t))throw new h.a("options.polylinePositions is required.");if(!Object(u.a)(i))throw new h.a("options.shapePositions is required.");this._positions=t,this._shape=i,this._ellipsoid=ae.clone(Object(w.a)(e.ellipsoid,ae.WGS84)),this._cornerType=Object(w.a)(e.cornerType,fm.ROUNDED),this._granularity=Object(w.a)(e.granularity,I.RADIANS_PER_DEGREE),this._workerName="createPolylineVolumeOutlineGeometry";var n=1+t.length*z.packedLength;n+=1+i.length*Rt.packedLength,this.packedLength=n+ae.packedLength+2}NT.pack=function(e,t,i){if(!Object(u.a)(e))throw new h.a("value is required");if(!Object(u.a)(t))throw new h.a("array is required");var n;i=Object(w.a)(i,0);var r=e._positions,a=r.length;for(t[i++]=a,n=0;n<a;++n,i+=z.packedLength)z.pack(r[n],t,i);var o=e._shape;for(a=o.length,t[i++]=a,n=0;n<a;++n,i+=Rt.packedLength)Rt.pack(o[n],t,i);return ae.pack(e._ellipsoid,t,i),i+=ae.packedLength,t[i++]=e._cornerType,t[i]=e._granularity,t};var FT=ae.clone(ae.UNIT_SPHERE),kT={polylinePositions:void 0,shapePositions:void 0,ellipsoid:FT,height:void 0,cornerType:void 0,granularity:void 0};NT.unpack=function(e,t,i){if(!Object(u.a)(e))throw new h.a("array is required");var n;t=Object(w.a)(t,0);var r=e[t++],a=new Array(r);for(n=0;n<r;++n,t+=z.packedLength)a[n]=z.unpack(e,t);r=e[t++];var o=new Array(r);for(n=0;n<r;++n,t+=Rt.packedLength)o[n]=Rt.unpack(e,t);var s=ae.unpack(e,t,FT);t+=ae.packedLength;var c=e[t++],l=e[t];return Object(u.a)(i)?(i._positions=a,i._shape=o,i._ellipsoid=ae.clone(s,i._ellipsoid),i._cornerType=c,i._granularity=l,i):(kT.polylinePositions=a,kT.shapePositions=o,kT.cornerType=c,kT.granularity=l,new NT(kT))};var BT=new ln;NT.createGeometry=function(e){var t=e._positions,i=$t(t,z.equalsEpsilon),n=e._shape;if(n=C_.removeDuplicatesFromShape(n),!(i.length<2||n.length<3)){wp.computeWindingOrder2D(n)===op.CLOCKWISE&&n.reverse();var r=ln.fromPoints(n,BT);return function(e,t){var i=new Fa;i.position=new Na({componentDatatype:dn.DOUBLE,componentsPerAttribute:3,values:e});var n,r,a=t.length,o=i.position.values.length/3,s=e.length/3/a,c=Sl.createTypedArray(o,2*a*(s+1)),l=0,u=(n=0)*a;for(r=0;r<a-1;r++)c[l++]=r+u,c[l++]=r+u+1;for(c[l++]=a-1+u,c[l++]=u,u=(n=s-1)*a,r=0;r<a-1;r++)c[l++]=r+u,c[l++]=r+u+1;for(c[l++]=a-1+u,c[l++]=u,n=0;n<s-1;n++){var h=a*n,d=h+a;for(r=0;r<a;r++)c[l++]=r+h,c[l++]=r+d}return new La({attributes:i,indices:Sl.createTypedArray(o,c),boundingSphere:St.fromVertices(e),primitiveType:yn.LINES})}(C_.computePositions(i,n,r,e,!1),n)}};var zT=NT;function UT(e){var t=(e=Object(w.a)(e,w.a.EMPTY_OBJECT)).points,i=e.times;if(!Object(u.a)(t)||!Object(u.a)(i))throw new h.a("points and times are required.");if(t.length<2)throw new h.a("points.length must be greater than or equal to 2.");if(i.length!==t.length)throw new h.a("times.length must be equal to points.length.");this._times=i,this._points=t,this._evaluateFunction=function(e){var t=e.points,i=e.times;return function(n,r){Object(u.a)(r)||(r=new Kn);var a=e._lastTimeIndex=e.findTimeInterval(n,e._lastTimeIndex),o=(n-i[a])/(i[a+1]-i[a]),s=t[a],c=t[a+1];return Kn.fastSlerp(s,c,o,r)}}(this),this._lastTimeIndex=0}Object(O.a)(UT.prototype,{times:{get:function(){return this._times}},points:{get:function(){return this._points}}}),UT.prototype.findTimeInterval=ao.prototype.findTimeInterval,UT.prototype.wrapTime=ao.prototype.wrapTime,UT.prototype.clampTime=ao.prototype.clampTime,UT.prototype.evaluate=function(e,t){return this._evaluateFunction(e,t)};var VT=UT,HT=n(43);function GT(e,t,i){var n=e[t];e[t]=e[i],e[i]=n}function qT(e,t){return e<t?-1:e>t?1:0}var WT=function(e,t,i,n,r){!function e(t,i,n,r,a){for(;r>n;){if(r-n>600){var o=r-n+1,s=i-n+1,c=Math.log(o),l=.5*Math.exp(2*c/3),u=.5*Math.sqrt(c*l*(o-l)/o)*(s-o/2<0?-1:1),h=Math.max(n,Math.floor(i-s*l/o+u)),d=Math.min(r,Math.floor(i+(o-s)*l/o+u));e(t,i,h,d,a)}var f=t[i],p=n,m=r;for(GT(t,n,i),a(t[r],f)>0&&GT(t,n,r);p<m;){for(GT(t,p,m),p++,m--;a(t[p],f)<0;)p++;for(;a(t[m],f)>0;)m--}0===a(t[n],f)?GT(t,n,m):(m++,GT(t,m,r)),m<=i&&(n=m+1),i<=m&&(r=m-1)}}(e,t,i||0,n||e.length-1,r||qT)};function YT(e,t){if(!(this instanceof YT))return new YT(e,t);this._maxEntries=Math.max(4,e||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),t&&this._initFormat(t),this.clear()}function XT(e,t,i){if(!i)return t.indexOf(e);for(var n=0;n<t.length;n++)if(i(e,t[n]))return n;return-1}function ZT(e,t){QT(e,0,e.children.length,t,e)}function QT(e,t,i,n,r){r||(r=oC(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(var a,o=t;o<i;o++)a=e.children[o],KT(r,e.leaf?n(a):a);return r}function KT(e,t){return e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY),e}function JT(e,t){return e.minX-t.minX}function $T(e,t){return e.minY-t.minY}function eC(e){return(e.maxX-e.minX)*(e.maxY-e.minY)}function tC(e){return e.maxX-e.minX+(e.maxY-e.minY)}function iC(e,t){return(Math.max(t.maxX,e.maxX)-Math.min(t.minX,e.minX))*(Math.max(t.maxY,e.maxY)-Math.min(t.minY,e.minY))}function nC(e,t){var i=Math.max(e.minX,t.minX),n=Math.max(e.minY,t.minY),r=Math.min(e.maxX,t.maxX),a=Math.min(e.maxY,t.maxY);return Math.max(0,r-i)*Math.max(0,a-n)}function rC(e,t){return e.minX<=t.minX&&e.minY<=t.minY&&t.maxX<=e.maxX&&t.maxY<=e.maxY}function aC(e,t){return t.minX<=e.maxX&&t.minY<=e.maxY&&t.maxX>=e.minX&&t.maxY>=e.minY}function oC(e){return{children:e,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function sC(e,t,i,n,r){for(var a,o=[t,i];o.length;)(i=o.pop())-(t=o.pop())<=n||(a=t+Math.ceil((i-t)/n/2)*n,WT(e,a,t,i,r),o.push(t,a,a,i))}YT.prototype={all:function(){return this._all(this.data,[])},search:function(e){var t=this.data,i=[],n=this.toBBox;if(!aC(e,t))return i;for(var r,a,o,s,c=[];t;){for(r=0,a=t.children.length;r<a;r++)o=t.children[r],aC(e,s=t.leaf?n(o):o)&&(t.leaf?i.push(o):rC(e,s)?this._all(o,i):c.push(o));t=c.pop()}return i},collides:function(e){var t=this.data,i=this.toBBox;if(!aC(e,t))return!1;for(var n,r,a,o,s=[];t;){for(n=0,r=t.children.length;n<r;n++)if(a=t.children[n],aC(e,o=t.leaf?i(a):a)){if(t.leaf||rC(e,o))return!0;s.push(a)}t=s.pop()}return!1},load:function(e){if(!e||!e.length)return this;if(e.length<this._minEntries){for(var t=0,i=e.length;t<i;t++)this.insert(e[t]);return this}var n=this._build(e.slice(),0,e.length-1,0);if(this.data.children.length)if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){var r=this.data;this.data=n,n=r}this._insert(n,this.data.height-n.height-1,!0)}else this.data=n;return this},insert:function(e){return e&&this._insert(e,this.data.height-1),this},clear:function(){return this.data=oC([]),this},remove:function(e,t){if(!e)return this;for(var i,n,r,a,o=this.data,s=this.toBBox(e),c=[],l=[];o||c.length;){if(o||(o=c.pop(),n=c[c.length-1],i=l.pop(),a=!0),o.leaf&&-1!==(r=XT(e,o.children,t)))return o.children.splice(r,1),c.push(o),this._condense(c),this;a||o.leaf||!rC(o,s)?n?(i++,o=n.children[i],a=!1):o=null:(c.push(o),l.push(i),i=0,n=o,o=o.children[0])}return this},toBBox:function(e){return e},compareMinX:JT,compareMinY:$T,toJSON:function(){return this.data},fromJSON:function(e){return this.data=e,this},_all:function(e,t){for(var i=[];e;)e.leaf?t.push.apply(t,e.children):i.push.apply(i,e.children),e=i.pop();return t},_build:function(e,t,i,n){var r,a=i-t+1,o=this._maxEntries;if(a<=o)return ZT(r=oC(e.slice(t,i+1)),this.toBBox),r;n||(n=Math.ceil(Math.log(a)/Math.log(o)),o=Math.ceil(a/Math.pow(o,n-1))),(r=oC([])).leaf=!1,r.height=n;var s,c,l,u,h=Math.ceil(a/o),d=h*Math.ceil(Math.sqrt(o));for(sC(e,t,i,d,this.compareMinX),s=t;s<=i;s+=d)for(sC(e,s,l=Math.min(s+d-1,i),h,this.compareMinY),c=s;c<=l;c+=h)u=Math.min(c+h-1,l),r.children.push(this._build(e,c,u,n-1));return ZT(r,this.toBBox),r},_chooseSubtree:function(e,t,i,n){for(var r,a,o,s,c,l,u,h;n.push(t),!t.leaf&&n.length-1!==i;){for(u=h=1/0,r=0,a=t.children.length;r<a;r++)c=eC(o=t.children[r]),(l=iC(e,o)-c)<h?(h=l,u=c<u?c:u,s=o):l===h&&c<u&&(u=c,s=o);t=s||t.children[0]}return t},_insert:function(e,t,i){var n=this.toBBox,r=i?e:n(e),a=[],o=this._chooseSubtree(r,this.data,t,a);for(o.children.push(e),KT(o,r);t>=0&&a[t].children.length>this._maxEntries;)this._split(a,t),t--;this._adjustParentBBoxes(r,a,t)},_split:function(e,t){var i=e[t],n=i.children.length,r=this._minEntries;this._chooseSplitAxis(i,r,n);var a=this._chooseSplitIndex(i,r,n),o=oC(i.children.splice(a,i.children.length-a));o.height=i.height,o.leaf=i.leaf,ZT(i,this.toBBox),ZT(o,this.toBBox),t?e[t-1].children.push(o):this._splitRoot(i,o)},_splitRoot:function(e,t){this.data=oC([e,t]),this.data.height=e.height+1,this.data.leaf=!1,ZT(this.data,this.toBBox)},_chooseSplitIndex:function(e,t,i){var n,r,a,o,s,c,l,u;for(c=l=1/0,n=t;n<=i-t;n++)o=nC(r=QT(e,0,n,this.toBBox),a=QT(e,n,i,this.toBBox)),s=eC(r)+eC(a),o<c?(c=o,u=n,l=s<l?s:l):o===c&&s<l&&(l=s,u=n);return u},_chooseSplitAxis:function(e,t,i){var n=e.leaf?this.compareMinX:JT,r=e.leaf?this.compareMinY:$T;this._allDistMargin(e,t,i,n)<this._allDistMargin(e,t,i,r)&&e.children.sort(n)},_allDistMargin:function(e,t,i,n){e.children.sort(n);var r,a,o=this.toBBox,s=QT(e,0,t,o),c=QT(e,i-t,i,o),l=tC(s)+tC(c);for(r=t;r<i-t;r++)a=e.children[r],KT(s,e.leaf?o(a):a),l+=tC(s);for(r=i-t-1;r>=t;r--)a=e.children[r],KT(c,e.leaf?o(a):a),l+=tC(c);return l},_adjustParentBBoxes:function(e,t,i){for(var n=i;n>=0;n--)KT(t[n],e)},_condense:function(e){for(var t,i=e.length-1;i>=0;i--)0===e[i].children.length?i>0?(t=e[i-1].children).splice(t.indexOf(e[i]),1):this.clear():ZT(e[i],this.toBBox)},_initFormat:function(e){var t=["return a"," - b",";"];this.compareMinX=new Function("a","b",t.join(e[0])),this.compareMinY=new Function("a","b",t.join(e[1])),this.toBBox=new Function("a","return {minX: a"+e[0]+", minY: a"+e[1]+", maxX: a"+e[2]+", maxY: a"+e[3]+"};")}};var cC=YT;function lC(){this._tree=cC()}function uC(){this.minX=0,this.minY=0,this.maxX=0,this.maxY=0,this.id=""}function hC(e,t){return e.id===t.id}uC.fromRectangleAndId=function(e,t,i){return i.minX=t.west,i.minY=t.south,i.maxX=t.east,i.maxY=t.north,i.id=e,i},lC.prototype.insert=function(e,t){x.a.typeOf.string("id",e),x.a.typeOf.object("rectangle",t);var i=uC.fromRectangleAndId(e,t,new uC);this._tree.insert(i)};var dC=new uC;lC.prototype.remove=function(e,t){x.a.typeOf.string("id",e),x.a.typeOf.object("rectangle",t);var i=uC.fromRectangleAndId(e,t,dC);this._tree.remove(i,hC)};var fC=new uC;lC.prototype.collides=function(e){x.a.typeOf.object("rectangle",e);var t=uC.fromRectangleAndId("",e,fC);return this._tree.collides(t)};var pC=lC,mC=Math.cos,_C=Math.sin,gC=Math.sqrt,vC={computePosition:function(e,t,i,n,r,a,o){var s=t.radiiSquared,c=e.nwCorner,l=e.boundingRectangle,h=c.latitude-e.granYCos*n+r*e.granXSin,d=mC(h),f=_C(h),p=s.z*f,m=c.longitude+n*e.granYSin+r*e.granXCos,_=d*mC(m),g=d*_C(m),v=s.x*_,b=s.y*g,y=gC(v*_+b*g+p*f);if(a.x=v/y,a.y=b/y,a.z=p/y,i){var w=e.stNwCorner;Object(u.a)(w)?(h=w.latitude-e.stGranYCos*n+r*e.stGranXSin,m=w.longitude+n*e.stGranYSin+r*e.stGranXCos,o.x=(m-e.stWest)*e.lonScalar,o.y=(h-e.stSouth)*e.latScalar):(o.x=(m-l.west)*e.lonScalar,o.y=(h-l.south)*e.latScalar)}}},bC=new vn,yC=new z,wC=new K,OC=new z,xC=new se;function EC(e,t,i,n,r,a,o){var s=Math.cos(t),c=n*s,l=i*s,u=Math.sin(t),h=n*u,d=i*u;yC=xC.project(e,yC),yC=z.subtract(yC,OC,yC);var f=vn.fromRotation(t,bC);yC=vn.multiplyByVector(f,yC,yC),yC=z.add(yC,OC,yC),a-=1,o-=1;var p=(e=xC.unproject(yC,e)).latitude,m=p+a*d,_=p-c*o,g=p-c*o+a*d,v=Math.max(p,m,_,g),b=Math.min(p,m,_,g),y=e.longitude,w=y+a*l,O=y+o*h,x=y+o*h+a*l;return{north:v,south:b,east:Math.max(y,w,O,x),west:Math.min(y,w,O,x),granYCos:c,granYSin:h,granXCos:l,granXSin:d,nwCorner:e}}vC.computeOptions=function(e,t,i,n,r,a,o){var s,c,l,u,d,f=e.east,p=e.west,m=e.north,_=e.south,g=!1,v=!1;m===I.PI_OVER_TWO&&(g=!0),_===-I.PI_OVER_TWO&&(v=!0);var b=m-_;l=(d=p>f?I.TWO_PI-p+f:f-p)/((s=Math.ceil(d/t)+1)-1),u=b/((c=Math.ceil(b/t)+1)-1);var y=Ve.northwest(e,a),w=Ve.center(e,wC);0===i&&0===n||(w.longitude<y.longitude&&(w.longitude+=I.TWO_PI),OC=xC.project(w,OC));var O=u,x=l,E=Ve.clone(e,r),T={granYCos:O,granYSin:0,granXCos:x,granXSin:0,nwCorner:y,boundingRectangle:E,width:s,height:c,northCap:g,southCap:v};if(0!==i){var C=EC(y,i,l,u,0,s,c);if(m=C.north,_=C.south,f=C.east,p=C.west,m<-I.PI_OVER_TWO||m>I.PI_OVER_TWO||_<-I.PI_OVER_TWO||_>I.PI_OVER_TWO)throw new h.a("Rotated rectangle is invalid.  It crosses over either the north or south pole.");T.granYCos=C.granYCos,T.granYSin=C.granYSin,T.granXCos=C.granXCos,T.granXSin=C.granXSin,E.north=m,E.south=_,E.east=f,E.west=p}if(0!==n){i-=n;var S=Ve.northwest(E,o),A=EC(S,i,l,u,0,s,c);T.stGranYCos=A.granYCos,T.stGranXCos=A.granXCos,T.stGranYSin=A.granYSin,T.stGranXSin=A.granXSin,T.stNwCorner=S,T.stWest=A.west,T.stSouth=A.south}return T};var TC=vC,CC=new z,SC=new z,AC=new z,PC=new z,IC=new Ve,DC=new Rt,jC=new St,MC=new St;function RC(e,t){var i=new La({attributes:new Fa,primitiveType:yn.TRIANGLES});return i.attributes.position=new Na({componentDatatype:dn.DOUBLE,componentsPerAttribute:3,values:t.positions}),e.normal&&(i.attributes.normal=new Na({componentDatatype:dn.FLOAT,componentsPerAttribute:3,values:t.normals})),e.tangent&&(i.attributes.tangent=new Na({componentDatatype:dn.FLOAT,componentsPerAttribute:3,values:t.tangents})),e.bitangent&&(i.attributes.bitangent=new Na({componentDatatype:dn.FLOAT,componentsPerAttribute:3,values:t.bitangents})),i}var LC=new z,NC=new z;function FC(e,t){var i=e._vertexFormat,n=e._ellipsoid,r=t.height,a=t.width,o=t.northCap,s=t.southCap,c=0,l=r,u=r,h=0;o&&(c=1,u-=1,h+=1),s&&(l-=1,u-=1,h+=1),h+=a*u;for(var d=i.position?new Float64Array(3*h):void 0,f=i.st?new Float32Array(2*h):void 0,p=0,m=0,_=CC,g=DC,v=Number.MAX_VALUE,b=Number.MAX_VALUE,y=-Number.MAX_VALUE,w=-Number.MAX_VALUE,O=c;O<l;++O)for(var x=0;x<a;++x)TC.computePosition(t,n,i.st,O,x,_,g),d[p++]=_.x,d[p++]=_.y,d[p++]=_.z,i.st&&(f[m++]=g.x,f[m++]=g.y,v=Math.min(v,g.x),b=Math.min(b,g.y),y=Math.max(y,g.x),w=Math.max(w,g.y));if(o&&(TC.computePosition(t,n,i.st,0,0,_,g),d[p++]=_.x,d[p++]=_.y,d[p++]=_.z,i.st&&(f[m++]=g.x,f[m++]=g.y,v=g.x,b=g.y,y=g.x,w=g.y)),s&&(TC.computePosition(t,n,i.st,r-1,0,_,g),d[p++]=_.x,d[p++]=_.y,d[p]=_.z,i.st&&(f[m++]=g.x,f[m]=g.y,v=Math.min(v,g.x),b=Math.min(b,g.y),y=Math.max(y,g.x),w=Math.max(w,g.y))),i.st&&(v<0||b<0||y>1||w>1))for(var E=0;E<f.length;E+=2)f[E]=(f[E]-v)/(y-v),f[E+1]=(f[E+1]-b)/(w-b);var T=function(e,t,i,n){var r=e.length,a=t.normal?new Float32Array(r):void 0,o=t.tangent?new Float32Array(r):void 0,s=t.bitangent?new Float32Array(r):void 0,c=0,l=PC,u=AC,h=SC;if(t.normal||t.tangent||t.bitangent)for(var d=0;d<r;d+=3){var f=z.fromArray(e,d,CC),p=c+1,m=c+2;h=i.geodeticSurfaceNormal(f,h),(t.tangent||t.bitangent)&&(z.cross(z.UNIT_Z,h,u),be.multiplyByVector(n,u,u),z.normalize(u,u),t.bitangent&&z.normalize(z.cross(h,u,l),l)),t.normal&&(a[c]=h.x,a[p]=h.y,a[m]=h.z),t.tangent&&(o[c]=u.x,o[p]=u.y,o[m]=u.z),t.bitangent&&(s[c]=l.x,s[p]=l.y,s[m]=l.z),c+=3}return RC(t,{positions:e,normals:a,tangents:o,bitangents:s})}(d,i,n,t.tangentRotationMatrix),C=6*(a-1)*(u-1);o&&(C+=3*(a-1)),s&&(C+=3*(a-1));var S,A=Sl.createTypedArray(h,C),P=0,I=0;for(S=0;S<u-1;++S){for(var D=0;D<a-1;++D){var j=P,M=j+a,R=M+1,L=j+1;A[I++]=j,A[I++]=M,A[I++]=L,A[I++]=L,A[I++]=M,A[I++]=R,++P}++P}if(o||s){var N,F,k=h-1,B=h-1;if(o&&s&&(k=h-2),P=0,o)for(S=0;S<a-1;S++)F=(N=P)+1,A[I++]=k,A[I++]=N,A[I++]=F,++P;if(s)for(P=(u-1)*a,S=0;S<a-1;S++)F=(N=P)+1,A[I++]=N,A[I++]=B,A[I++]=F,++P}return T.indices=A,i.st&&(T.attributes.st=new Na({componentDatatype:dn.FLOAT,componentsPerAttribute:2,values:f})),T}function kC(e,t,i,n,r){return e[t++]=n[i],e[t++]=n[i+1],e[t++]=n[i+2],e[t++]=r[i],e[t++]=r[i+1],e[t]=r[i+2],e}function BC(e,t,i,n){return e[t++]=n[i],e[t++]=n[i+1],e[t++]=n[i],e[t]=n[i+1],e}var zC=new Ba;function UC(e,t){var i,n=e._shadowVolume,r=e._offsetAttribute,a=e._vertexFormat,o=e._extrudedHeight,s=e._surfaceHeight,c=e._ellipsoid,l=t.height,h=t.width;if(n){var d=Ba.clone(a,zC);d.normal=!0,e._vertexFormat=d}var f=FC(e,t);n&&(e._vertexFormat=a);var p=wp.scaleToGeodeticHeight(f.attributes.position.values,s,c,!1),m=(p=new Float64Array(p)).length,_=2*m,g=new Float64Array(_);g.set(p);var v=wp.scaleToGeodeticHeight(f.attributes.position.values,o,c);g.set(v,m),f.attributes.position.values=g;var b,y,w,O=a.normal?new Float32Array(_):void 0,x=a.tangent?new Float32Array(_):void 0,E=a.bitangent?new Float32Array(_):void 0,T=a.st?new Float32Array(_/3*2):void 0;if(a.normal){for(y=f.attributes.normal.values,O.set(y),i=0;i<m;i++)y[i]=-y[i];O.set(y,m),f.attributes.normal.values=O}if(n){y=f.attributes.normal.values,a.normal||(f.attributes.normal=void 0);var C=new Float32Array(_);for(i=0;i<m;i++)y[i]=-y[i];C.set(y,m),f.attributes.extrudeDirection=new Na({componentDatatype:dn.FLOAT,componentsPerAttribute:3,values:C})}var S=Object(u.a)(r);if(S){var A=m/3*2,P=new Uint8Array(A);r===fn.TOP?P=Qt(P,1,0,A/2):(w=r===fn.NONE?0:1,P=Qt(P,w)),f.attributes.applyOffset=new Na({componentDatatype:dn.UNSIGNED_BYTE,componentsPerAttribute:1,values:P})}if(a.tangent){var D=f.attributes.tangent.values;for(x.set(D),i=0;i<m;i++)D[i]=-D[i];x.set(D,m),f.attributes.tangent.values=x}if(a.bitangent){var j=f.attributes.bitangent.values;E.set(j),E.set(j,m),f.attributes.bitangent.values=E}a.st&&(b=f.attributes.st.values,T.set(b),T.set(b,m/3*2),f.attributes.st.values=T);var M=f.indices,R=M.length,L=m/3,N=Sl.createTypedArray(_/3,2*R);for(N.set(M),i=0;i<R;i+=3)N[i+R]=M[i+2]+L,N[i+1+R]=M[i+1]+L,N[i+2+R]=M[i]+L;f.indices=N;var F=t.northCap,k=t.southCap,B=l,U=2,V=0,H=4,G=4;F&&(U-=1,B-=1,V+=1,H-=2,G-=1),k&&(U-=1,B-=1,V+=1,H-=2,G-=1);var q=2*((V+=U*h+2*B-H)+G),W=new Float64Array(3*q),Y=n?new Float32Array(3*q):void 0,X=S?new Uint8Array(q):void 0,Z=a.st?new Float32Array(2*q):void 0,Q=r===fn.TOP;S&&!Q&&(w=r===fn.ALL?1:0,X=Qt(X,w));var K,J=0,$=0,ee=0,te=0,ie=h*B;for(i=0;i<ie;i+=h)W=kC(W,J,K=3*i,p,v),J+=6,a.st&&(Z=BC(Z,$,2*i,b),$+=4),n&&(ee+=3,Y[ee++]=y[K],Y[ee++]=y[K+1],Y[ee++]=y[K+2]),Q&&(X[te++]=1,te+=1);if(k){var ne=F?ie+1:ie;for(K=3*ne,i=0;i<2;i++)W=kC(W,J,K,p,v),J+=6,a.st&&(Z=BC(Z,$,2*ne,b),$+=4),n&&(ee+=3,Y[ee++]=y[K],Y[ee++]=y[K+1],Y[ee++]=y[K+2]),Q&&(X[te++]=1,te+=1)}else for(i=ie-h;i<ie;i++)W=kC(W,J,K=3*i,p,v),J+=6,a.st&&(Z=BC(Z,$,2*i,b),$+=4),n&&(ee+=3,Y[ee++]=y[K],Y[ee++]=y[K+1],Y[ee++]=y[K+2]),Q&&(X[te++]=1,te+=1);for(i=ie-1;i>0;i-=h)W=kC(W,J,K=3*i,p,v),J+=6,a.st&&(Z=BC(Z,$,2*i,b),$+=4),n&&(ee+=3,Y[ee++]=y[K],Y[ee++]=y[K+1],Y[ee++]=y[K+2]),Q&&(X[te++]=1,te+=1);if(F){var re=ie;for(K=3*re,i=0;i<2;i++)W=kC(W,J,K,p,v),J+=6,a.st&&(Z=BC(Z,$,2*re,b),$+=4),n&&(ee+=3,Y[ee++]=y[K],Y[ee++]=y[K+1],Y[ee++]=y[K+2]),Q&&(X[te++]=1,te+=1)}else for(i=h-1;i>=0;i--)W=kC(W,J,K=3*i,p,v),J+=6,a.st&&(Z=BC(Z,$,2*i,b),$+=4),n&&(ee+=3,Y[ee++]=y[K],Y[ee++]=y[K+1],Y[ee++]=y[K+2]),Q&&(X[te++]=1,te+=1);var ae=function(e,t,i){var n=e.length,r=t.normal?new Float32Array(n):void 0,a=t.tangent?new Float32Array(n):void 0,o=t.bitangent?new Float32Array(n):void 0,s=0,c=0,l=0,u=!0,h=PC,d=AC,f=SC;if(t.normal||t.tangent||t.bitangent)for(var p=0;p<n;p+=6){var m=z.fromArray(e,p,CC),_=z.fromArray(e,(p+6)%n,LC);if(u){var g=z.fromArray(e,(p+3)%n,NC);z.subtract(_,m,_),z.subtract(g,m,g),f=z.normalize(z.cross(g,_,f),f),u=!1}z.equalsEpsilon(_,m,I.EPSILON10)&&(u=!0),(t.tangent||t.bitangent)&&(h=i.geodeticSurfaceNormal(m,h),t.tangent&&(d=z.normalize(z.cross(h,f,d),d))),t.normal&&(r[s++]=f.x,r[s++]=f.y,r[s++]=f.z,r[s++]=f.x,r[s++]=f.y,r[s++]=f.z),t.tangent&&(a[c++]=d.x,a[c++]=d.y,a[c++]=d.z,a[c++]=d.x,a[c++]=d.y,a[c++]=d.z),t.bitangent&&(o[l++]=h.x,o[l++]=h.y,o[l++]=h.z,o[l++]=h.x,o[l++]=h.y,o[l++]=h.z)}return RC(t,{positions:e,normals:r,tangents:a,bitangents:o})}(W,a,c);a.st&&(ae.attributes.st=new Na({componentDatatype:dn.FLOAT,componentsPerAttribute:2,values:Z})),n&&(ae.attributes.extrudeDirection=new Na({componentDatatype:dn.FLOAT,componentsPerAttribute:3,values:Y})),S&&(ae.attributes.applyOffset=new Na({componentDatatype:dn.UNSIGNED_BYTE,componentsPerAttribute:1,values:X}));var oe,se,ce,le,ue=Sl.createTypedArray(q,6*V);m=W.length/3;var he=0;for(i=0;i<m-1;i+=2){le=((oe=i)+2)%m;var de=z.fromArray(W,3*oe,LC),fe=z.fromArray(W,3*le,NC);z.equalsEpsilon(de,fe,I.EPSILON10)||(ce=((se=(oe+1)%m)+2)%m,ue[he++]=oe,ue[he++]=se,ue[he++]=le,ue[he++]=le,ue[he++]=se,ue[he++]=ce)}return ae.indices=ue,(ae=id.combineInstances([new Mu({geometry:f}),new Mu({geometry:ae})]))[0]}var VC=[new z,new z,new z,new z],HC=new K,GC=new K;function qC(e,t,i,n,r){if(0===i)return Ve.clone(e,r);var a=TC.computeOptions(e,t,i,0,IC,HC),o=a.height,s=a.width,c=VC;return TC.computePosition(a,n,!1,0,0,c[0]),TC.computePosition(a,n,!1,0,s-1,c[1]),TC.computePosition(a,n,!1,o-1,0,c[2]),TC.computePosition(a,n,!1,o-1,s-1,c[3]),Ve.fromCartesianArray(c,n,r)}function WC(e){var t=(e=Object(w.a)(e,w.a.EMPTY_OBJECT)).rectangle;if(x.a.typeOf.object("rectangle",t),Ve.validate(t),t.north<t.south)throw new h.a("options.rectangle.north must be greater than or equal to options.rectangle.south");var i=Object(w.a)(e.height,0),n=Object(w.a)(e.extrudedHeight,i);this._rectangle=Ve.clone(t),this._granularity=Object(w.a)(e.granularity,I.RADIANS_PER_DEGREE),this._ellipsoid=ae.clone(Object(w.a)(e.ellipsoid,ae.WGS84)),this._surfaceHeight=Math.max(i,n),this._rotation=Object(w.a)(e.rotation,0),this._stRotation=Object(w.a)(e.stRotation,0),this._vertexFormat=Ba.clone(Object(w.a)(e.vertexFormat,Ba.DEFAULT)),this._extrudedHeight=Math.min(i,n),this._shadowVolume=Object(w.a)(e.shadowVolume,!1),this._workerName="createRectangleGeometry",this._offsetAttribute=e.offsetAttribute,this._rotatedRectangle=void 0,this._textureCoordinateRotationPoints=void 0}WC.packedLength=Ve.packedLength+ae.packedLength+Ba.packedLength+7,WC.pack=function(e,t,i){return x.a.typeOf.object("value",e),x.a.defined("array",t),i=Object(w.a)(i,0),Ve.pack(e._rectangle,t,i),i+=Ve.packedLength,ae.pack(e._ellipsoid,t,i),i+=ae.packedLength,Ba.pack(e._vertexFormat,t,i),i+=Ba.packedLength,t[i++]=e._granularity,t[i++]=e._surfaceHeight,t[i++]=e._rotation,t[i++]=e._stRotation,t[i++]=e._extrudedHeight,t[i++]=e._shadowVolume?1:0,t[i]=Object(w.a)(e._offsetAttribute,-1),t};var YC=new Ve,XC=ae.clone(ae.UNIT_SPHERE),ZC={rectangle:YC,ellipsoid:XC,vertexFormat:zC,granularity:void 0,height:void 0,rotation:void 0,stRotation:void 0,extrudedHeight:void 0,shadowVolume:void 0,offsetAttribute:void 0};WC.unpack=function(e,t,i){x.a.defined("array",e),t=Object(w.a)(t,0);var n=Ve.unpack(e,t,YC);t+=Ve.packedLength;var r=ae.unpack(e,t,XC);t+=ae.packedLength;var a=Ba.unpack(e,t,zC);t+=Ba.packedLength;var o=e[t++],s=e[t++],c=e[t++],l=e[t++],h=e[t++],d=1===e[t++],f=e[t];return Object(u.a)(i)?(i._rectangle=Ve.clone(n,i._rectangle),i._ellipsoid=ae.clone(r,i._ellipsoid),i._vertexFormat=Ba.clone(a,i._vertexFormat),i._granularity=o,i._surfaceHeight=s,i._rotation=c,i._stRotation=l,i._extrudedHeight=h,i._shadowVolume=d,i._offsetAttribute=-1===f?void 0:f,i):(ZC.granularity=o,ZC.height=s,ZC.rotation=c,ZC.stRotation=l,ZC.extrudedHeight=h,ZC.shadowVolume=d,ZC.offsetAttribute=-1===f?void 0:f,new WC(ZC))},WC.computeRectangle=function(e,t){var i=(e=Object(w.a)(e,w.a.EMPTY_OBJECT)).rectangle;if(x.a.typeOf.object("rectangle",i),Ve.validate(i),i.north<i.south)throw new h.a("options.rectangle.north must be greater than or equal to options.rectangle.south");var n=Object(w.a)(e.granularity,I.RADIANS_PER_DEGREE),r=Object(w.a)(e.ellipsoid,ae.WGS84);return qC(i,n,Object(w.a)(e.rotation,0),r,t)};var QC=new be,KC=new Kn,JC=new K;WC.createGeometry=function(e){if(!I.equalsEpsilon(e._rectangle.north,e._rectangle.south,I.EPSILON10)&&!I.equalsEpsilon(e._rectangle.east,e._rectangle.west,I.EPSILON10)){var t=e._rectangle,i=e._ellipsoid,n=e._rotation,r=e._stRotation,a=e._vertexFormat,o=TC.computeOptions(t,e._granularity,n,r,IC,HC,GC),s=QC;if(0!==r||0!==n){var c=Ve.center(t,JC),l=i.geodeticSurfaceNormalCartographic(c,LC);Kn.fromAxisAngle(l,-r,KC),be.fromQuaternion(KC,s)}else be.clone(be.IDENTITY,s);var h,d,f=e._surfaceHeight,p=e._extrudedHeight,m=!I.equalsEpsilon(f,p,0,I.EPSILON2);if(o.lonScalar=1/e._rectangle.width,o.latScalar=1/e._rectangle.height,o.tangentRotationMatrix=s,t=e._rectangle,m){h=UC(e,o);var _=St.fromRectangle3D(t,i,f,MC),g=St.fromRectangle3D(t,i,p,jC);d=St.union(_,g)}else{if((h=FC(e,o)).attributes.position.values=wp.scaleToGeodeticHeight(h.attributes.position.values,f,i,!1),Object(u.a)(e._offsetAttribute)){var v=h.attributes.position.values.length,b=new Uint8Array(v/3),y=e._offsetAttribute===fn.NONE?0:1;Qt(b,y),h.attributes.applyOffset=new Na({componentDatatype:dn.UNSIGNED_BYTE,componentsPerAttribute:1,values:b})}d=St.fromRectangle3D(t,i,f)}return a.position||delete h.attributes.position,new La({attributes:h.attributes,indices:h.indices,primitiveType:h.primitiveType,boundingSphere:d,offsetAttribute:e._offsetAttribute})}},WC.createShadowVolume=function(e,t,i){var n=e._granularity,r=e._ellipsoid,a=t(n,r),o=i(n,r);return new WC({rectangle:e._rectangle,rotation:e._rotation,ellipsoid:r,stRotation:e._stRotation,granularity:n,extrudedHeight:o,height:a,vertexFormat:Ba.POSITION_ONLY,shadowVolume:!0})};var $C=new Ve,eS=[new Rt,new Rt,new Rt],tS=new vn,iS=new K;Object(O.a)(WC.prototype,{rectangle:{get:function(){return Object(u.a)(this._rotatedRectangle)||(this._rotatedRectangle=qC(this._rectangle,this._granularity,this._rotation,this._ellipsoid)),this._rotatedRectangle}},textureCoordinateRotationPoints:{get:function(){return Object(u.a)(this._textureCoordinateRotationPoints)||(this._textureCoordinateRotationPoints=function(e){if(0===e._stRotation)return[0,0,0,1,1,0];var t=Ve.clone(e._rectangle,$C),i=e._granularity,n=e._ellipsoid,r=qC(t,i,e._rotation-e._stRotation,n,$C),a=eS;a[0].x=r.west,a[0].y=r.south,a[1].x=r.west,a[1].y=r.north,a[2].x=r.east,a[2].y=r.south;for(var o=e.rectangle,s=vn.fromRotation(e._stRotation,tS),c=Ve.center(o,iS),l=0;l<3;++l){var u=a[l];u.x-=c.longitude,u.y-=c.latitude,vn.multiplyByVector(s,u,u),u.x+=c.longitude,u.y+=c.latitude,u.x=(u.x-o.west)/o.width,u.y=(u.y-o.south)/o.height}var h=a[0],d=a[1],f=a[2],p=new Array(6);return Rt.pack(h,p),Rt.pack(d,p,2),Rt.pack(f,p,4),p}(this)),this._textureCoordinateRotationPoints}}});var nS=WC,rS=new St,aS=new St,oS=new z,sS=new Ve;function cS(e,t){var i=e._ellipsoid,n=t.height,r=t.width,a=t.northCap,o=t.southCap,s=n,c=2,l=0,u=4;a&&(c-=1,s-=1,l+=1,u-=2),o&&(c-=1,s-=1,l+=1,u-=2),l+=c*r+2*s-u;var h,d=new Float64Array(3*l),f=0,p=0,m=oS;if(a)TC.computePosition(t,i,!1,p,0,m),d[f++]=m.x,d[f++]=m.y,d[f++]=m.z;else for(h=0;h<r;h++)TC.computePosition(t,i,!1,p,h,m),d[f++]=m.x,d[f++]=m.y,d[f++]=m.z;for(h=r-1,p=1;p<n;p++)TC.computePosition(t,i,!1,p,h,m),d[f++]=m.x,d[f++]=m.y,d[f++]=m.z;if(p=n-1,!o)for(h=r-2;h>=0;h--)TC.computePosition(t,i,!1,p,h,m),d[f++]=m.x,d[f++]=m.y,d[f++]=m.z;for(h=0,p=n-2;p>0;p--)TC.computePosition(t,i,!1,p,h,m),d[f++]=m.x,d[f++]=m.y,d[f++]=m.z;for(var _=d.length/3*2,g=Sl.createTypedArray(d.length/3,_),v=0,b=0;b<d.length/3-1;b++)g[v++]=b,g[v++]=b+1;g[v++]=d.length/3-1,g[v++]=0;var y=new La({attributes:new Fa,primitiveType:yn.LINES});return y.attributes.position=new Na({componentDatatype:dn.DOUBLE,componentsPerAttribute:3,values:d}),y.indices=g,y}function lS(e){var t=(e=Object(w.a)(e,w.a.EMPTY_OBJECT)).rectangle,i=Object(w.a)(e.granularity,I.RADIANS_PER_DEGREE),n=Object(w.a)(e.ellipsoid,ae.WGS84),r=Object(w.a)(e.rotation,0);if(!Object(u.a)(t))throw new h.a("rectangle is required.");if(Ve.validate(t),t.north<t.south)throw new h.a("options.rectangle.north must be greater than options.rectangle.south");var a=Object(w.a)(e.height,0),o=Object(w.a)(e.extrudedHeight,a);this._rectangle=Ve.clone(t),this._granularity=i,this._ellipsoid=n,this._surfaceHeight=Math.max(a,o),this._rotation=r,this._extrudedHeight=Math.min(a,o),this._offsetAttribute=e.offsetAttribute,this._workerName="createRectangleOutlineGeometry"}lS.packedLength=Ve.packedLength+ae.packedLength+5,lS.pack=function(e,t,i){if(!Object(u.a)(e))throw new h.a("value is required");if(!Object(u.a)(t))throw new h.a("array is required");return i=Object(w.a)(i,0),Ve.pack(e._rectangle,t,i),i+=Ve.packedLength,ae.pack(e._ellipsoid,t,i),i+=ae.packedLength,t[i++]=e._granularity,t[i++]=e._surfaceHeight,t[i++]=e._rotation,t[i++]=e._extrudedHeight,t[i]=Object(w.a)(e._offsetAttribute,-1),t};var uS=new Ve,hS=ae.clone(ae.UNIT_SPHERE),dS={rectangle:uS,ellipsoid:hS,granularity:void 0,height:void 0,rotation:void 0,extrudedHeight:void 0,offsetAttribute:void 0};lS.unpack=function(e,t,i){if(!Object(u.a)(e))throw new h.a("array is required");t=Object(w.a)(t,0);var n=Ve.unpack(e,t,uS);t+=Ve.packedLength;var r=ae.unpack(e,t,hS);t+=ae.packedLength;var a=e[t++],o=e[t++],s=e[t++],c=e[t++],l=e[t];return Object(u.a)(i)?(i._rectangle=Ve.clone(n,i._rectangle),i._ellipsoid=ae.clone(r,i._ellipsoid),i._surfaceHeight=o,i._rotation=s,i._extrudedHeight=c,i._offsetAttribute=-1===l?void 0:l,i):(dS.granularity=a,dS.height=o,dS.rotation=s,dS.extrudedHeight=c,dS.offsetAttribute=-1===l?void 0:l,new lS(dS))};var fS=new K;lS.createGeometry=function(e){var t,i,n=e._rectangle,r=e._ellipsoid,a=TC.computeOptions(n,e._granularity,e._rotation,0,sS,fS);if(!I.equalsEpsilon(n.north,n.south,I.EPSILON10)&&!I.equalsEpsilon(n.east,n.west,I.EPSILON10)){var o,s=e._surfaceHeight,c=e._extrudedHeight;if(!I.equalsEpsilon(s,c,0,I.EPSILON2)){if(t=function(e,t){var i=e._surfaceHeight,n=e._extrudedHeight,r=e._ellipsoid,a=n,o=i,s=cS(e,t),c=t.height,l=t.width,u=wp.scaleToGeodeticHeight(s.attributes.position.values,o,r,!1),h=u.length,d=new Float64Array(2*h);d.set(u);var f=wp.scaleToGeodeticHeight(s.attributes.position.values,a,r);d.set(f,h),s.attributes.position.values=d;var p=t.northCap,m=t.southCap,_=4;p&&(_-=1),m&&(_-=1);var g=2*(d.length/3+_),v=Sl.createTypedArray(d.length/3,g);h=d.length/6;for(var b,y=0,w=0;w<h-1;w++)v[y++]=w,v[y++]=w+1,v[y++]=w+h,v[y++]=w+h+1;if(v[y++]=h-1,v[y++]=0,v[y++]=h+h-1,v[y++]=h,v[y++]=0,v[y++]=h,p)b=c-1;else{var O=l-1;v[y++]=O,v[y++]=O+h,b=l+c-2}if(v[y++]=b,v[y++]=b+h,!m){var x=l+b-1;v[y++]=x,v[y]=x+h}return s.indices=v,s}(e,a),Object(u.a)(e._offsetAttribute)){var l=t.attributes.position.values.length/3,h=new Uint8Array(l);e._offsetAttribute===fn.TOP?h=Qt(h,1,0,l/2):(o=e._offsetAttribute===fn.NONE?0:1,h=Qt(h,o)),t.attributes.applyOffset=new Na({componentDatatype:dn.UNSIGNED_BYTE,componentsPerAttribute:1,values:h})}var d=St.fromRectangle3D(n,r,s,aS),f=St.fromRectangle3D(n,r,c,rS);i=St.union(d,f)}else{if((t=cS(e,a)).attributes.position.values=wp.scaleToGeodeticHeight(t.attributes.position.values,s,r,!1),Object(u.a)(e._offsetAttribute)){var p=t.attributes.position.values.length,m=new Uint8Array(p/3);o=e._offsetAttribute===fn.NONE?0:1,Qt(m,o),t.attributes.applyOffset=new Na({componentDatatype:dn.UNSIGNED_BYTE,componentsPerAttribute:1,values:m})}i=St.fromRectangle3D(n,r,s)}return new La({attributes:t.attributes,indices:t.indices,primitiveType:yn.LINES,boundingSphere:i,offsetAttribute:e._offsetAttribute})}};var pS=lS,mS=Object(E.a)({FIXED:0,INERTIAL:1}),_S=window.requestAnimationFrame;!function(){if(!Object(u.a)(_S))for(var e=["webkit","moz","ms","o"],t=0,i=e.length;t<i&&!Object(u.a)(_S);)_S=window[e[t]+"RequestAnimationFrame"],++t;if(!Object(u.a)(_S)){var n=0;_S=function(e){var t=Qd(),i=Math.max(1e3/60-(t-n),0);return n=t+i,setTimeout((function(){e(n)}),i)}}}();var gS=function(e){return _S(e)},vS=n(66),bS=n(47);function yS(e){var t=e.positions,i=e.tilingScheme.tileXYToRectangle(e.x,e.y,e.level);return function(e){for(var n=0;n<t.length;++n){var r=t[n];r.height=e.interpolateHeight(i,r.longitude,r.latitude)}}}function wS(e){var t=e.positions;return function(){for(var e=0;e<t.length;++e){t[e].height=void 0}}}var OS=function(e,t,i){return x.a.typeOf.object("terrainProvider",e),x.a.typeOf.number("level",t),x.a.defined("positions",i),e.readyPromise.then((function(){return function(e,t,i){var n,r=e.tilingScheme,a=[],o={};for(n=0;n<i.length;++n){var s=r.positionToTileXY(i[n],t),c=s.toString();if(!o.hasOwnProperty(c)){var l={x:s.x,y:s.y,level:t,tilingScheme:r,terrainProvider:e,positions:[]};o[c]=l,a.push(l)}o[c].positions.push(i[n])}var u=[];for(n=0;n<a.length;++n){var h=a[n],d=h.terrainProvider.requestTileGeometry(h.x,h.y,h.level).then(yS(h)).otherwise(wS(h));u.push(d)}return Oi.a.all(u,(function(){return i}))}(e,t,i)}))},xS=new Rt;var ES=function e(t,i){if(!Object(u.a)(t))throw new h.a("terrainProvider is required.");if(!Object(u.a)(i))throw new h.a("positions is required.");return t.readyPromise.then((function(){var n=[],r=[],a=t.availability;if(!Object(u.a)(a))throw new h.a("sampleTerrainMostDetailed requires a terrain provider that has tile availability.");for(var o=[],s=0;s<i.length;++s){var c=i[s],l=a.computeMaximumLevelAtPosition(c);if(r[s]=l,0===l){t.tilingScheme.positionToTileXY(c,1,xS);var d=t.loadTileDataAvailability(xS.x,xS.y,1);Object(u.a)(d)&&o.push(d)}var f=n[l];Object(u.a)(f)||(n[l]=f=[]),f.push(c)}return Oi.a.all(o).then((function(){return Oi.a.all(n.map((function(e,i){if(Object(u.a)(e))return OS(t,i,e)})))})).then((function(){for(var n=[],o=0;o<i.length;++o){var s=i[o];a.computeMaximumLevelAtPosition(s)!==r[o]&&n.push(s)}if(n.length>0)return e(t,n)})).then((function(){return i}))}))},TS=Object(E.a)({LEFT_DOWN:0,LEFT_UP:1,LEFT_CLICK:2,LEFT_DOUBLE_CLICK:3,RIGHT_DOWN:5,RIGHT_UP:6,RIGHT_CLICK:7,MIDDLE_DOWN:10,MIDDLE_UP:11,MIDDLE_CLICK:12,MOUSE_MOVE:15,WHEEL:16,PINCH_START:17,PINCH_END:18,PINCH_MOVE:19});function CS(e,t,i){var n=e._element;if(n===document)return i.x=t.clientX,i.y=t.clientY,i;var r=n.getBoundingClientRect();return i.x=t.clientX-r.left,i.y=t.clientY-r.top,i}function SS(e,t){var i=e;return Object(u.a)(t)&&(i+="+"+t),i}function AS(e){return e.shiftKey?rx.SHIFT:e.ctrlKey?rx.CTRL:e.altKey?rx.ALT:void 0}var PS={LEFT:0,MIDDLE:1,RIGHT:2};function IS(e,t,i,n){function r(t){n(e,t)}i.addEventListener(t,r,!1),e._removalFunctions.push((function(){i.removeEventListener(t,r,!1)}))}var DS={position:new Rt};function jS(e){e._lastSeenTouchEvent=Qd()}function MS(e){return Qd()-e._lastSeenTouchEvent>rA.mouseEmulationIgnoreMilliseconds}function RS(e,t){if(MS(e)){var i,n=t.button;if(e._buttonDown[n]=!0,n===PS.LEFT)i=TS.LEFT_DOWN;else if(n===PS.MIDDLE)i=TS.MIDDLE_DOWN;else{if(n!==PS.RIGHT)return;i=TS.RIGHT_DOWN}var r=CS(e,t,e._primaryPosition);Rt.clone(r,e._primaryStartPosition),Rt.clone(r,e._primaryPreviousPosition);var a=AS(t),o=e.getInputAction(i,a);Object(u.a)(o)&&(Rt.clone(r,DS.position),o(DS),t.preventDefault())}}var LS={position:new Rt},NS={position:new Rt};function FS(e,t,i,n){var r=AS(n),a=e.getInputAction(t,r),o=e.getInputAction(i,r);if(Object(u.a)(a)||Object(u.a)(o)){var s=CS(e,n,e._primaryPosition);if(Object(u.a)(a)&&(Rt.clone(s,LS.position),a(LS)),Object(u.a)(o)){var c=e._primaryStartPosition,l=c.x-s.x,h=c.y-s.y;Math.sqrt(l*l+h*h)<e._clickPixelTolerance&&(Rt.clone(s,NS.position),o(NS))}}}function kS(e,t){if(MS(e)){var i=t.button;i!==PS.LEFT&&i!==PS.MIDDLE&&i!==PS.RIGHT||(e._buttonDown[PS.LEFT]&&(FS(e,TS.LEFT_UP,TS.LEFT_CLICK,t),e._buttonDown[PS.LEFT]=!1),e._buttonDown[PS.MIDDLE]&&(FS(e,TS.MIDDLE_UP,TS.MIDDLE_CLICK,t),e._buttonDown[PS.MIDDLE]=!1),e._buttonDown[PS.RIGHT]&&(FS(e,TS.RIGHT_UP,TS.RIGHT_CLICK,t),e._buttonDown[PS.RIGHT]=!1))}}var BS={startPosition:new Rt,endPosition:new Rt};function zS(e,t){if(MS(e)){var i=AS(t),n=CS(e,t,e._primaryPosition),r=e._primaryPreviousPosition,a=e.getInputAction(TS.MOUSE_MOVE,i);Object(u.a)(a)&&(Rt.clone(r,BS.startPosition),Rt.clone(n,BS.endPosition),a(BS)),Rt.clone(n,r),(e._buttonDown[PS.LEFT]||e._buttonDown[PS.MIDDLE]||e._buttonDown[PS.RIGHT])&&t.preventDefault()}}var US={position:new Rt};function VS(e,t){var i;if(t.button===PS.LEFT){i=TS.LEFT_DOUBLE_CLICK;var n=AS(t),r=e.getInputAction(i,n);Object(u.a)(r)&&(CS(e,t,US.position),r(US))}}function HS(e,t){var i;if(Object(u.a)(t.deltaY)){var n=t.deltaMode;i=n===t.DOM_DELTA_PIXEL?-t.deltaY:n===t.DOM_DELTA_LINE?40*-t.deltaY:120*-t.deltaY}else i=t.detail>0?-120*t.detail:t.wheelDelta;if(Object(u.a)(i)){var r=AS(t),a=e.getInputAction(TS.WHEEL,r);Object(u.a)(a)&&(a(i),t.preventDefault())}}function GS(e,t){jS(e);var i,n,r,a=t.changedTouches,o=a.length,s=e._positions;for(i=0;i<o;++i)r=(n=a[i]).identifier,s.set(r,CS(e,n,new Rt));QS(e,t);var c=e._previousPositions;for(i=0;i<o;++i)r=(n=a[i]).identifier,c.set(r,Rt.clone(s.get(r)))}function qS(e,t){jS(e);var i,n,r=t.changedTouches,a=r.length,o=e._positions;for(i=0;i<a;++i)n=r[i].identifier,o.remove(n);QS(e,t);var s=e._previousPositions;for(i=0;i<a;++i)n=r[i].identifier,s.remove(n)}var WS={position:new Rt},YS={position1:new Rt,position2:new Rt},XS={position:new Rt},ZS={position:new Rt};function QS(e,t){var i,n,r=AS(t),a=e._positions,o=e._previousPositions,s=a.length,c=e._isPinching;if(1!==s&&e._buttonDown[PS.LEFT]&&(e._buttonDown[PS.LEFT]=!1,i=e.getInputAction(TS.LEFT_UP,r),Object(u.a)(i)&&(Rt.clone(e._primaryPosition,XS.position),i(XS)),0===s&&(n=e.getInputAction(TS.LEFT_CLICK,r),Object(u.a)(n)))){var l=e._primaryStartPosition,h=o.values[0],d=l.x-h.x,f=l.y-h.y;Math.sqrt(d*d+f*f)<e._clickPixelTolerance&&(Rt.clone(e._primaryPosition,ZS.position),n(ZS))}if(0===s&&c&&(e._isPinching=!1,i=e.getInputAction(TS.PINCH_END,r),Object(u.a)(i)&&i()),1===s&&!c){var p=a.values[0];Rt.clone(p,e._primaryPosition),Rt.clone(p,e._primaryStartPosition),Rt.clone(p,e._primaryPreviousPosition),e._buttonDown[PS.LEFT]=!0,i=e.getInputAction(TS.LEFT_DOWN,r),Object(u.a)(i)&&(Rt.clone(p,WS.position),i(WS)),t.preventDefault()}2!==s||c||(e._isPinching=!0,i=e.getInputAction(TS.PINCH_START,r),Object(u.a)(i)&&(Rt.clone(a.values[0],YS.position1),Rt.clone(a.values[1],YS.position2),i(YS),t.preventDefault()))}function KS(e,t){jS(e);var i,n,r,a=t.changedTouches,o=a.length,s=e._positions;for(i=0;i<o;++i){r=(n=a[i]).identifier;var c=s.get(r);Object(u.a)(c)&&CS(e,n,c)}eA(e,t);var l=e._previousPositions;for(i=0;i<o;++i)r=(n=a[i]).identifier,Rt.clone(s.get(r),l.get(r))}var JS={startPosition:new Rt,endPosition:new Rt},$S={distance:{startPosition:new Rt,endPosition:new Rt},angleAndHeight:{startPosition:new Rt,endPosition:new Rt}};function eA(e,t){var i,n=AS(t),r=e._positions,a=e._previousPositions,o=r.length;if(1===o&&e._buttonDown[PS.LEFT]){var s=r.values[0];Rt.clone(s,e._primaryPosition);var c=e._primaryPreviousPosition;i=e.getInputAction(TS.MOUSE_MOVE,n),Object(u.a)(i)&&(Rt.clone(c,JS.startPosition),Rt.clone(s,JS.endPosition),i(JS)),Rt.clone(s,c),t.preventDefault()}else if(2===o&&e._isPinching&&(i=e.getInputAction(TS.PINCH_MOVE,n),Object(u.a)(i))){var l=r.values[0],h=r.values[1],d=a.values[0],f=a.values[1],p=h.x-l.x,m=h.y-l.y,_=.25*Math.sqrt(p*p+m*m),g=f.x-d.x,v=f.y-d.y,b=.25*Math.sqrt(g*g+v*v),y=.125*(h.y+l.y),w=.125*(f.y+d.y),O=Math.atan2(m,p),x=Math.atan2(v,g);Rt.fromElements(0,b,$S.distance.startPosition),Rt.fromElements(0,_,$S.distance.endPosition),Rt.fromElements(x,w,$S.angleAndHeight.startPosition),Rt.fromElements(O,y,$S.angleAndHeight.endPosition),i($S)}}function tA(e,t){if(t.target.setPointerCapture(t.pointerId),"touch"===t.pointerType){var i=e._positions,n=t.pointerId;i.set(n,CS(e,t,new Rt)),QS(e,t),e._previousPositions.set(n,Rt.clone(i.get(n)))}else RS(e,t)}function iA(e,t){if("touch"===t.pointerType){var i=e._positions,n=t.pointerId;i.remove(n),QS(e,t),e._previousPositions.remove(n)}else kS(e,t)}function nA(e,t){if("touch"===t.pointerType){var i=e._positions,n=t.pointerId,r=i.get(n);if(!Object(u.a)(r))return;CS(e,t,r),eA(e,t);var a=e._previousPositions;Rt.clone(i.get(n),a.get(n))}else zS(e,t)}function rA(e){this._inputEvents={},this._buttonDown={LEFT:!1,MIDDLE:!1,RIGHT:!1},this._isPinching=!1,this._lastSeenTouchEvent=-rA.mouseEmulationIgnoreMilliseconds,this._primaryStartPosition=new Rt,this._primaryPosition=new Rt,this._primaryPreviousPosition=new Rt,this._positions=new Fi,this._previousPositions=new Fi,this._removalFunctions=[],this._clickPixelTolerance=5,this._element=Object(w.a)(e,document),function(e){var t=e._element,i=Object(u.a)(t.disableRootEvents)?t:document;Ri.supportsPointerEvents()?(IS(e,"pointerdown",t,tA),IS(e,"pointerup",t,iA),IS(e,"pointermove",t,nA),IS(e,"pointercancel",t,iA)):(IS(e,"mousedown",t,RS),IS(e,"mouseup",i,kS),IS(e,"mousemove",i,zS),IS(e,"touchstart",t,GS),IS(e,"touchend",i,qS),IS(e,"touchmove",i,KS),IS(e,"touchcancel",i,qS)),IS(e,"dblclick",t,VS),IS(e,"onwheel"in t?"wheel":void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll",t,HS)}(this)}rA.prototype.setInputAction=function(e,t,i){if(!Object(u.a)(e))throw new h.a("action is required.");if(!Object(u.a)(t))throw new h.a("type is required.");var n=SS(t,i);this._inputEvents[n]=e},rA.prototype.getInputAction=function(e,t){if(!Object(u.a)(e))throw new h.a("type is required.");var i=SS(e,t);return this._inputEvents[i]},rA.prototype.removeInputAction=function(e,t){if(!Object(u.a)(e))throw new h.a("type is required.");var i=SS(e,t);delete this._inputEvents[i]},rA.prototype.isDestroyed=function(){return!1},rA.prototype.destroy=function(){return function(e){for(var t=e._removalFunctions,i=0;i<t.length;++i)t[i]()}(this),rl(this)},rA.mouseEmulationIgnoreMilliseconds=800;var aA=rA;function oA(e){e=Object(w.a)(e,!0),this.value=oA.toValue(e)}Object(O.a)(oA.prototype,{componentDatatype:{get:function(){return dn.UNSIGNED_BYTE}},componentsPerAttribute:{get:function(){return 1}},normalize:{get:function(){return!1}}}),oA.toValue=function(e,t){if(!Object(u.a)(e))throw new h.a("show is required.");return Object(u.a)(t)?(t[0]=e,t):new Uint8Array([e])};var sA=oA,cA={};var lA=32.184,uA=2451545;function hA(e,t){t=Tr.addSeconds(e,lA,t);var i,n=Tr.totalDays(t)-uA;return t=Tr.addSeconds(t,(i=6.239996+.0172019696544*n,.001657*Math.sin(i+.01671*Math.sin(i))),t)}var dA=new Tr(2451545,0,rr.TAI),fA=1e3,pA=I.RADIANS_PER_DEGREE,mA=I.RADIANS_PER_ARCSECOND,_A=new be;function gA(e,t,i,n,r,a,o){if(i<0&&(i=-i,r+=I.PI),i<0||i>I.PI)throw new h.a("The inclination is out of range. Inclination must be greater than or equal to zero and less than or equal to Pi radians.");var s=e*(1-t),c=n-r,l=r,d=function(e,t){if(t<0||t>=1)throw new h.a("eccentricity out of range.");return function(e,t){if(t<0||t>=1)throw new h.a("eccentricity out of range.");var i=Math.floor(e/I.TWO_PI);e-=i*I.TWO_PI;var n=Math.cos(e)-t,r=Math.sin(e)*Math.sqrt(1-t*t),a=Math.atan2(r,n);a=I.zeroToTwoPi(a),e<0&&(a-=I.TWO_PI);return a+=i*I.TWO_PI}(function(e,t){if(t<0||t>=1)throw new h.a("eccentricity out of range.");var i,n=Math.floor(e/I.TWO_PI),r=(e-=n*I.TWO_PI)+t*Math.sin(e)/(1-Math.sin(e+t)+Math.sin(e)),a=Number.MAX_VALUE;for(i=0;i<vA&&Math.abs(a-r)>bA;++i){var o=(a=r)-t*Math.sin(a)-e,s=1-t*Math.cos(a);r=a-o/s}if(i>=vA)throw new h.a("Kepler equation did not converge");return a=r+n*I.TWO_PI}(e,t),t)}(a-n,t);if("Hyperbolic"===function(e,t){if(e<0)throw new h.a("eccentricity cannot be negative.");if(e<=t)return"Circular";if(e<1-t)return"Elliptical";if(e<=1+t)return"Parabolic";return"Hyperbolic"}(t,0)&&Math.abs(I.negativePiToPi(d))>=Math.acos(-1/t))throw new h.a("The true anomaly of the hyperbolic orbit lies outside of the bounds of the hyperbola.");!function(e,t,i,n){if(t<0||t>I.PI)throw new h.a("inclination out of range");var r=Math.cos(e),a=Math.sin(e),o=Math.cos(t),s=Math.sin(t),c=Math.cos(i),l=Math.sin(i);Object(u.a)(n)?(n[0]=c*r-l*a*o,n[1]=l*r+c*a*o,n[2]=a*s,n[3]=-c*a-l*r*o,n[4]=-l*a+c*r*o,n[5]=r*s,n[6]=l*s,n[7]=-c*s,n[8]=o):n=new be(c*r-l*a*o,-c*a-l*r*o,l*s,l*r+c*a*o,-l*a+c*r*o,-c*s,a*s,r*s,o)}(c,i,l,_A);var f=s*(1+t),p=Math.cos(d),m=Math.sin(d),_=1+t*p;if(_<=I.Epsilon10)throw new h.a("elements cannot be converted to cartesian");var g=f/_;return Object(u.a)(o)?(o.x=g*p,o.y=g*m,o.z=0):o=new z(g*p,g*m,0),be.multiplyByVector(_A,o,o)}var vA=50,bA=I.EPSILON8;var yA=149598022260.7121,wA=100.46645683*pA,OA=1295977422.83429*mA,xA=16002,EA=21863,TA=32004,CA=10931,SA=14529,AA=16368,PA=15318,IA=32794,DA=64e-7*14959787e4,jA=-2273887.624,MA=927506.794,RA=14959787e4*-8e-7,LA=32e-7*14959787e4,NA=-613351.267,FA=284235.953,kA=-164557.657,BA=-2243968.05,zA=-688150.202,UA=1017265.516,VA=807828.498,HA=14e-7*14959787e4,GA=359034.888,qA=14959787e4*-28e-7,WA=329115.314,YA=10,XA=16002,ZA=21863,QA=10931,KA=1473,JA=32004,$A=4387,eP=73,tP=-325e-7,iP=-322e-7,nP=1e-7*-79,rP=232*1e-7,aP=1e-7*-52,oP=97e-7,sP=55e-7,cP=-41e-7,lP=-105e-7,uP=-137e-7,hP=258e-7,dP=35e-7,fP=1e-7*-116,pP=-88e-7,mP=-112e-7,_P=-8e-6,gP=new Tr(0,0,rr.TAI);function vP(e,t){hA(e,gP);var i=(gP.dayNumber-dA.dayNumber+(gP.secondsOfDay-dA.secondsOfDay)/nr.SECONDS_PER_DAY)/nr.DAYS_PER_JULIAN_CENTURY,n=i*i,r=n*i,a=r*i,o=383397.7725+.004*i,s=.055545526-16e-9*i,c=5.15668983*pA,l=-8e-5*i+.02966*n-42e-6*r-13e-8*a,u=83.35324312*pA,h=14643420.2669*i-38.2702*n-.045047*r+21301e-8*a,d=125.04455501*pA,f=-6967919.3631*i+6.3602*n+.007625*r-3586e-8*a,p=218.31664563*pA,m=1732559343.4847*i-6.391*n+.006588*r-3169e-8*a,_=297.85019547*pA+mA*(1602961601.209*i-6.3706*n+.006593*r-3169e-8*a),g=134.96340251*pA+mA*(1717915923.2178*i+31.8792*n+.051635*r-2447e-7*a),v=357.52910918*pA+mA*(129596581.0481*i-.5532*n+136e-6*r-1149e-8*a),b=310.17137918*pA-mA*(6967051.436*i+6.2068*n+.007618*r-3219e-8*a),y=2*_,w=4*_,O=6*_,x=2*g,E=3*g,T=4*g,C=2*(93.27209062*pA+mA*(1739527262.8478*i-12.7512*n-.001037*r+417e-8*a));o+=3400.4*Math.cos(y)-635.6*Math.cos(y-g)-235.6*Math.cos(g)+218.1*Math.cos(y-v)+181*Math.cos(y+g),s+=.014216*Math.cos(y-g)+.008551*Math.cos(y-x)-.001383*Math.cos(g)+.001356*Math.cos(y+g)-.001147*Math.cos(w-E)-914e-6*Math.cos(w-x)+869e-6*Math.cos(y-v-g)-627e-6*Math.cos(y)-394e-6*Math.cos(w-T)+282e-6*Math.cos(y-v-x)-279e-6*Math.cos(_-g)-236e-6*Math.cos(x)+231e-6*Math.cos(w)+229e-6*Math.cos(O-T)-201e-6*Math.cos(x-C),l+=486.26*Math.cos(y-C)-40.13*Math.cos(y)+37.51*Math.cos(C)+25.73*Math.cos(x-C)+19.97*Math.cos(y-v-C),h+=-55609*Math.sin(y-g)-34711*Math.sin(y-x)-9792*Math.sin(g)+9385*Math.sin(w-E)+7505*Math.sin(w-x)+5318*Math.sin(y+g)+3484*Math.sin(w-T)-3417*Math.sin(y-v-g)-2530*Math.sin(O-T)-2376*Math.sin(y)-2075*Math.sin(y-E)-1883*Math.sin(x)-1736*Math.sin(O-5*g)+1626*Math.sin(v)-1370*Math.sin(O-E),f+=-5392*Math.sin(y-C)-540*Math.sin(v)-441*Math.sin(y)+423*Math.sin(C)-288*Math.sin(x-C),m+=-3332.9*Math.sin(y)+1197.4*Math.sin(y-g)-662.5*Math.sin(v)+396.3*Math.sin(g)-218*Math.sin(y-v);var S=2*b,A=3*b;l+=46.997*Math.cos(b)*i-.614*Math.cos(y-C+b)*i+.614*Math.cos(y-C-b)*i-.0297*Math.cos(S)*n-.0335*Math.cos(b)*n+.0012*Math.cos(y-C+S)*n-16e-5*Math.cos(b)*r+4e-5*Math.cos(A)*r+4e-5*Math.cos(S)*r;var P=2.116*Math.sin(b)*i-.111*Math.sin(y-C-b)*i-.0015*Math.sin(b)*n;return h+=P,m+=P,f+=-520.77*Math.sin(b)*i+13.66*Math.sin(y-C+b)*i+1.12*Math.sin(y-b)*i-1.06*Math.sin(C-b)*i+.66*Math.sin(S)*n+.371*Math.sin(b)*n-.035*Math.sin(y-C+S)*n-.015*Math.sin(y-C+b)*n+.0014*Math.sin(b)*r-.0011*Math.sin(A)*r-9e-4*Math.sin(S)*r,gA(o*=fA,s,c+l*mA,u+h*mA,d+f*mA,p+m*mA,t)}var bP=-.01215058143522694;var yP=new be(1.0000000000000002,5619723173785822e-31,4690511510146299e-34,-5154129427414611e-31,.9174820620691819,-.39777715593191376,-223970096136568e-30,.39777715593191376,.9174820620691819),wP=new z;cA.computeSunPositionInEarthInertialFrame=function(e,t){return Object(u.a)(e)||(e=Tr.now()),Object(u.a)(t)||(t=new z),wP=function(e,t){hA(e,gP);var i=(gP.dayNumber-dA.dayNumber+(gP.secondsOfDay-dA.secondsOfDay)/nr.SECONDS_PER_DAY)/(10*nr.DAYS_PER_JULIAN_CENTURY),n=.3595362*i,r=yA+DA*Math.cos(xA*n)+BA*Math.sin(xA*n)+jA*Math.cos(EA*n)+zA*Math.sin(EA*n)+MA*Math.cos(TA*n)+UA*Math.sin(TA*n)+RA*Math.cos(CA*n)+VA*Math.sin(CA*n)+LA*Math.cos(SA*n)+HA*Math.sin(SA*n)+NA*Math.cos(AA*n)+GA*Math.sin(AA*n)+FA*Math.cos(PA*n)+qA*Math.sin(PA*n)+kA*Math.cos(IA*n)+WA*Math.sin(IA*n),a=wA+OA*i+tP*Math.cos(YA*n)+lP*Math.sin(YA*n)+iP*Math.cos(XA*n)+uP*Math.sin(XA*n)+nP*Math.cos(ZA*n)+hP*Math.sin(ZA*n)+rP*Math.cos(QA*n)+dP*Math.sin(QA*n)+aP*Math.cos(KA*n)+fP*Math.sin(KA*n)+oP*Math.cos(JA*n)+pP*Math.sin(JA*n)+sP*Math.cos($A*n)+mP*Math.sin($A*n)+cP*Math.cos(eP*n)+_P*Math.sin(eP*n);return gA(r,.0167086342-.0004203654*i,469.97289*mA*i,102.93734808*pA+11612.3529*mA*i,174.87317577*pA-8679.27034*mA*i,a,t)}(e,wP),t=z.negate(wP,t),function(e,t){t=vP(e,t),z.multiplyByScalar(t,bP,t)}(e,wP),z.subtract(t,wP,t),be.multiplyByVector(yP,t,t),t},cA.computeMoonPositionInEarthInertialFrame=function(e,t){return Object(u.a)(e)||(e=Tr.now()),t=vP(e,t),be.multiplyByVector(yP,t,t),t};var OP=cA;function xP(e,t,i,n,r,a,o){var s,c=Gm.numberOfPoints(e,t,r),l=i.red,u=i.green,h=i.blue,d=i.alpha,f=n.red,p=n.green,m=n.blue,_=n.alpha;if(uf.equals(i,n)){for(s=0;s<c;s++)a[o++]=uf.floatToByte(l),a[o++]=uf.floatToByte(u),a[o++]=uf.floatToByte(h),a[o++]=uf.floatToByte(d);return o}var g=(f-l)/c,v=(p-u)/c,b=(m-h)/c,y=(_-d)/c,w=o;for(s=0;s<c;s++)a[w++]=uf.floatToByte(l+s*g),a[w++]=uf.floatToByte(u+s*v),a[w++]=uf.floatToByte(h+s*b),a[w++]=uf.floatToByte(d+s*y);return w}function EP(e){var t=(e=Object(w.a)(e,w.a.EMPTY_OBJECT)).positions,i=e.colors,n=Object(w.a)(e.colorsPerVertex,!1);if(!Object(u.a)(t)||t.length<2)throw new h.a("At least two positions are required.");if(Object(u.a)(i)&&(n&&i.length<t.length||!n&&i.length<t.length-1))throw new h.a("colors has an invalid length.");this._positions=t,this._colors=i,this._colorsPerVertex=n,this._followSurface=Object(w.a)(e.followSurface,!0),Object(u.a)(e.followSurface)&&(Object(mv.a)("PolylineGeometry.followSurface","PolylineGeometry.followSurface is deprecated and will be removed in Cesium 1.55. Use PolylineGeometry.arcType instead."),e.arcType=e.followSurface?Zt.GEODESIC:Zt.NONE),this._arcType=Object(w.a)(e.arcType,Zt.GEODESIC),this._followSurface=this._arcType===Zt.NONE,this._granularity=Object(w.a)(e.granularity,I.RADIANS_PER_DEGREE),this._ellipsoid=Object(w.a)(e.ellipsoid,ae.WGS84),this._workerName="createSimplePolylineGeometry";var r=1+t.length*z.packedLength;r+=Object(u.a)(i)?1+i.length*uf.packedLength:1,this.packedLength=r+ae.packedLength+3}EP.pack=function(e,t,i){if(!Object(u.a)(e))throw new h.a("value is required");if(!Object(u.a)(t))throw new h.a("array is required");var n;i=Object(w.a)(i,0);var r=e._positions,a=r.length;for(t[i++]=a,n=0;n<a;++n,i+=z.packedLength)z.pack(r[n],t,i);var o=e._colors;for(a=Object(u.a)(o)?o.length:0,t[i++]=a,n=0;n<a;++n,i+=uf.packedLength)uf.pack(o[n],t,i);return ae.pack(e._ellipsoid,t,i),i+=ae.packedLength,t[i++]=e._colorsPerVertex?1:0,t[i++]=e._arcType,t[i]=e._granularity,t},EP.unpack=function(e,t,i){if(!Object(u.a)(e))throw new h.a("array is required");var n;t=Object(w.a)(t,0);var r=e[t++],a=new Array(r);for(n=0;n<r;++n,t+=z.packedLength)a[n]=z.unpack(e,t);var o=(r=e[t++])>0?new Array(r):void 0;for(n=0;n<r;++n,t+=uf.packedLength)o[n]=uf.unpack(e,t);var s=ae.unpack(e,t);t+=ae.packedLength;var c=1===e[t++],l=e[t++],d=e[t];return Object(u.a)(i)?(i._positions=a,i._colors=o,i._ellipsoid=s,i._colorsPerVertex=c,i._arcType=l,i._granularity=d,i):new EP({positions:a,colors:o,ellipsoid:s,colorsPerVertex:c,arcType:l,granularity:d})};var TP=new Array(2),CP=new Array(2),SP={positions:TP,height:CP,ellipsoid:void 0,minDistance:void 0,granularity:void 0};EP.createGeometry=function(e){var t,i,n,r,a,o=e._positions,s=e._colors,c=e._colorsPerVertex,l=e._arcType,h=e._granularity,d=e._ellipsoid,f=I.chordLength(h,d.maximumRadius),p=Object(u.a)(s)&&!c,m=o.length,_=0;if(l===Zt.GEODESIC||l===Zt.RHUMB){var g,v,b;l===Zt.GEODESIC?(g=I.chordLength(h,d.maximumRadius),v=Gm.numberOfPoints,b=Gm.generateArc):(g=h,v=Gm.numberOfPointsRhumbLine,b=Gm.generateRhumbArc);var y=Gm.extractHeights(o,d),w=SP;if(l===Zt.GEODESIC?w.minDistance=f:w.granularity=h,w.ellipsoid=d,p){var O=0;for(t=0;t<m-1;t++)O+=v(o[t],o[t+1],g)+1;i=new Float64Array(3*O),r=new Uint8Array(4*O),w.positions=TP,w.height=CP;var x=0;for(t=0;t<m-1;++t){TP[0]=o[t],TP[1]=o[t+1],CP[0]=y[t],CP[1]=y[t+1];var E=b(w);if(Object(u.a)(s)){var T=E.length/3;a=s[t];for(var C=0;C<T;++C)r[x++]=uf.floatToByte(a.red),r[x++]=uf.floatToByte(a.green),r[x++]=uf.floatToByte(a.blue),r[x++]=uf.floatToByte(a.alpha)}i.set(E,_),_+=E.length}}else if(w.positions=o,w.height=y,i=new Float64Array(b(w)),Object(u.a)(s)){for(r=new Uint8Array(i.length/3*4),t=0;t<m-1;++t){_=xP(o[t],o[t+1],s[t],s[t+1],f,r,_)}var S=s[m-1];r[_++]=uf.floatToByte(S.red),r[_++]=uf.floatToByte(S.green),r[_++]=uf.floatToByte(S.blue),r[_++]=uf.floatToByte(S.alpha)}}else{n=p?2*m-2:m,i=new Float64Array(3*n),r=Object(u.a)(s)?new Uint8Array(4*n):void 0;var A=0,P=0;for(t=0;t<m;++t){var D=o[t];if(p&&t>0&&(z.pack(D,i,A),A+=3,a=s[t-1],r[P++]=uf.floatToByte(a.red),r[P++]=uf.floatToByte(a.green),r[P++]=uf.floatToByte(a.blue),r[P++]=uf.floatToByte(a.alpha)),p&&t===m-1)break;z.pack(D,i,A),A+=3,Object(u.a)(s)&&(a=s[t],r[P++]=uf.floatToByte(a.red),r[P++]=uf.floatToByte(a.green),r[P++]=uf.floatToByte(a.blue),r[P++]=uf.floatToByte(a.alpha))}}var j=new Fa;j.position=new Na({componentDatatype:dn.DOUBLE,componentsPerAttribute:3,values:i}),Object(u.a)(s)&&(j.color=new Na({componentDatatype:dn.UNSIGNED_BYTE,componentsPerAttribute:4,values:r,normalize:!0}));var M=2*((n=i.length/3)-1),R=Sl.createTypedArray(n,M),L=0;for(t=0;t<n-1;++t)R[L++]=t,R[L++]=t+1;return new La({attributes:j,indices:R,primitiveType:yn.LINES,boundingSphere:St.fromPoints(o)})};var AP=EP;function PP(e){var t=Object(w.a)(e.radius,1),i={radii:new z(t,t,t),stackPartitions:e.stackPartitions,slicePartitions:e.slicePartitions,vertexFormat:e.vertexFormat};this._ellipsoidGeometry=new Hv(i),this._workerName="createSphereGeometry"}PP.packedLength=Hv.packedLength,PP.pack=function(e,t,i){return x.a.typeOf.object("value",e),Hv.pack(e._ellipsoidGeometry,t,i)};var IP=new Hv,DP={radius:void 0,radii:new z,vertexFormat:new Ba,stackPartitions:void 0,slicePartitions:void 0};PP.unpack=function(e,t,i){var n=Hv.unpack(e,t,IP);return DP.vertexFormat=Ba.clone(n._vertexFormat,DP.vertexFormat),DP.stackPartitions=n._stackPartitions,DP.slicePartitions=n._slicePartitions,Object(u.a)(i)?(z.clone(n._radii,DP.radii),i._ellipsoidGeometry=new Hv(DP),i):(DP.radius=n._radii.x,new PP(DP))},PP.createGeometry=function(e){return Hv.createGeometry(e._ellipsoidGeometry)};var jP=PP;function MP(e){var t=Object(w.a)(e.radius,1),i={radii:new z(t,t,t),stackPartitions:e.stackPartitions,slicePartitions:e.slicePartitions,subdivisions:e.subdivisions};this._ellipsoidGeometry=new Qv(i),this._workerName="createSphereOutlineGeometry"}MP.packedLength=Qv.packedLength,MP.pack=function(e,t,i){return x.a.typeOf.object("value",e),Qv.pack(e._ellipsoidGeometry,t,i)};var RP=new Qv,LP={radius:void 0,radii:new z,stackPartitions:void 0,slicePartitions:void 0,subdivisions:void 0};MP.unpack=function(e,t,i){var n=Qv.unpack(e,t,RP);return LP.stackPartitions=n._stackPartitions,LP.slicePartitions=n._slicePartitions,LP.subdivisions=n._subdivisions,Object(u.a)(i)?(z.clone(n._radii,LP.radii),i._ellipsoidGeometry=new Qv(LP),i):(LP.radius=n._radii.x,new MP(LP))},MP.createGeometry=function(e){return Qv.createGeometry(e._ellipsoidGeometry)};var NP=MP;function FP(e,t,i){this.clock=Object(w.a)(e,0),this.cone=Object(w.a)(t,0),this.magnitude=Object(w.a)(i,1)}FP.fromCartesian3=function(e,t){x.a.typeOf.object("cartesian3",e);var i=e.x,n=e.y,r=e.z,a=i*i+n*n;return Object(u.a)(t)||(t=new FP),t.clock=Math.atan2(n,i),t.cone=Math.atan2(Math.sqrt(a),r),t.magnitude=Math.sqrt(a+r*r),t},FP.clone=function(e,t){if(Object(u.a)(e))return Object(u.a)(t)?(t.clock=e.clock,t.cone=e.cone,t.magnitude=e.magnitude,t):new FP(e.clock,e.cone,e.magnitude)},FP.normalize=function(e,t){return x.a.typeOf.object("spherical",e),Object(u.a)(t)?(t.clock=e.clock,t.cone=e.cone,t.magnitude=1,t):new FP(e.clock,e.cone,1)},FP.equals=function(e,t){return e===t||Object(u.a)(e)&&Object(u.a)(t)&&e.clock===t.clock&&e.cone===t.cone&&e.magnitude===t.magnitude},FP.equalsEpsilon=function(e,t,i){return i=Object(w.a)(i,0),e===t||Object(u.a)(e)&&Object(u.a)(t)&&Math.abs(e.clock-t.clock)<=i&&Math.abs(e.cone-t.cone)<=i&&Math.abs(e.magnitude-t.magnitude)<=i},FP.prototype.equals=function(e){return FP.equals(this,e)},FP.prototype.clone=function(e){return FP.clone(this,e)},FP.prototype.equalsEpsilon=function(e,t){return FP.equalsEpsilon(this,e,t)},FP.prototype.toString=function(){return"("+this.clock+", "+this.cone+", "+this.magnitude+")"};var kP=FP;var BP=function(e,t){if(!Object(u.a)(e))throw new h.a("array is required.");if(!Object(u.a)(t)||t<1)throw new h.a("numberOfArrays must be greater than 0.");for(var i=[],n=e.length,r=0;r<n;){var a=Math.ceil((n-r)/t--);i.push(e.slice(r,r+a)),r+=a}return i};function zP(){h.a.throwInstantiationError()}Object(O.a)(zP.prototype,{credits:{get:h.a.throwInstantiationError},waterMask:{get:h.a.throwInstantiationError}}),zP.prototype.interpolateHeight=h.a.throwInstantiationError,zP.prototype.isChildAvailable=h.a.throwInstantiationError,zP.prototype.createMesh=h.a.throwInstantiationError,zP.prototype.upsample=h.a.throwInstantiationError,zP.prototype.wasCreatedByUpsampling=h.a.throwInstantiationError;var UP=zP;function VP(e){throw new h.a("This type should not be instantiated directly.  Instead, use WebMercatorTilingScheme or GeographicTilingScheme.")}Object(O.a)(VP.prototype,{ellipsoid:{get:h.a.throwInstantiationError},rectangle:{get:h.a.throwInstantiationError},projection:{get:h.a.throwInstantiationError}}),VP.prototype.getNumberOfXTilesAtLevel=h.a.throwInstantiationError,VP.prototype.getNumberOfYTilesAtLevel=h.a.throwInstantiationError,VP.prototype.rectangleToNativeRectangle=h.a.throwInstantiationError,VP.prototype.tileXYToNativeRectangle=h.a.throwInstantiationError,VP.prototype.tileXYToRectangle=h.a.throwInstantiationError,VP.prototype.positionToTileXY=h.a.throwInstantiationError;var HP=VP;function GP(e,t){return Tr.compare(e.start,t.start)}function qP(e){if(this._intervals=[],this._changedEvent=new $o.a,Object(u.a)(e))for(var t=e.length,i=0;i<t;i++)this.addInterval(e[i])}Object(O.a)(qP.prototype,{changedEvent:{get:function(){return this._changedEvent}},start:{get:function(){var e=this._intervals;return 0===e.length?void 0:e[0].start}},isStartIncluded:{get:function(){var e=this._intervals;return 0!==e.length&&e[0].isStartIncluded}},stop:{get:function(){var e=this._intervals,t=e.length;return 0===t?void 0:e[t-1].stop}},isStopIncluded:{get:function(){var e=this._intervals,t=e.length;return 0!==t&&e[t-1].isStopIncluded}},length:{get:function(){return this._intervals.length}},isEmpty:{get:function(){return 0===this._intervals.length}}}),qP.prototype.equals=function(e,t){if(this===e)return!0;if(!(e instanceof qP))return!1;var i=this._intervals,n=e._intervals,r=i.length;if(r!==n.length)return!1;for(var a=0;a<r;a++)if(!ex.equals(i[a],n[a],t))return!1;return!0},qP.prototype.get=function(e){if(!Object(u.a)(e))throw new h.a("index is required.");return this._intervals[e]},qP.prototype.removeAll=function(){this._intervals.length>0&&(this._intervals.length=0,this._changedEvent.raiseEvent(this))},qP.prototype.findIntervalContainingDate=function(e){var t=this.indexOf(e);return t>=0?this._intervals[t]:void 0},qP.prototype.findDataForIntervalContainingDate=function(e){var t=this.indexOf(e);return t>=0?this._intervals[t].data:void 0},qP.prototype.contains=function(e){return this.indexOf(e)>=0};var WP=new ex;qP.prototype.indexOf=function(e){if(!Object(u.a)(e))throw new h.a("date is required");var t=this._intervals;WP.start=e,WP.stop=e;var i=Ji(t,WP,GP);return i>=0?t[i].isStartIncluded?i:i>0&&t[i-1].stop.equals(e)&&t[i-1].isStopIncluded?i-1:~i:(i=~i)>0&&i-1<t.length&&ex.contains(t[i-1],e)?i-1:~i},qP.prototype.findInterval=function(e){for(var t=(e=Object(w.a)(e,w.a.EMPTY_OBJECT)).start,i=e.stop,n=e.isStartIncluded,r=e.isStopIncluded,a=this._intervals,o=0,s=a.length;o<s;o++){var c=a[o];if((!Object(u.a)(t)||c.start.equals(t))&&(!Object(u.a)(i)||c.stop.equals(i))&&(!Object(u.a)(n)||c.isStartIncluded===n)&&(!Object(u.a)(r)||c.isStopIncluded===r))return a[o]}},qP.prototype.addInterval=function(e,t){if(!Object(u.a)(e))throw new h.a("interval is required");if(!e.isEmpty){var i=this._intervals;if(0===i.length||Tr.greaterThan(e.start,i[i.length-1].stop))return i.push(e),void this._changedEvent.raiseEvent(this);var n,r=Ji(i,e,GP);for(r<0?r=~r:r>0&&e.isStartIncluded&&i[r-1].isStartIncluded&&i[r-1].start.equals(e.start)?--r:r<i.length&&!e.isStartIncluded&&i[r].isStartIncluded&&i[r].start.equals(e.start)&&++r,r>0&&((n=Tr.compare(i[r-1].stop,e.start))>0||0===n&&(i[r-1].isStopIncluded||e.isStartIncluded))&&((Object(u.a)(t)?t(i[r-1].data,e.data):i[r-1].data===e.data)?(e=Tr.greaterThan(e.stop,i[r-1].stop)?new ex({start:i[r-1].start,stop:e.stop,isStartIncluded:i[r-1].isStartIncluded,isStopIncluded:e.isStopIncluded,data:e.data}):new ex({start:i[r-1].start,stop:i[r-1].stop,isStartIncluded:i[r-1].isStartIncluded,isStopIncluded:i[r-1].isStopIncluded||e.stop.equals(i[r-1].stop)&&e.isStopIncluded,data:e.data}),i.splice(r-1,1),--r):(((n=Tr.compare(i[r-1].stop,e.stop))>0||0===n&&i[r-1].isStopIncluded&&!e.isStopIncluded)&&i.splice(r,0,new ex({start:e.stop,stop:i[r-1].stop,isStartIncluded:!e.isStopIncluded,isStopIncluded:i[r-1].isStopIncluded,data:i[r-1].data})),i[r-1]=new ex({start:i[r-1].start,stop:e.start,isStartIncluded:i[r-1].isStartIncluded,isStopIncluded:!e.isStartIncluded,data:i[r-1].data})));r<i.length&&((n=Tr.compare(e.stop,i[r].start))>0||0===n&&(e.isStopIncluded||i[r].isStartIncluded));)if(Object(u.a)(t)?t(i[r].data,e.data):i[r].data===e.data)e=new ex({start:e.start,stop:Tr.greaterThan(i[r].stop,e.stop)?i[r].stop:e.stop,isStartIncluded:e.isStartIncluded,isStopIncluded:Tr.greaterThan(i[r].stop,e.stop)?i[r].isStopIncluded:e.isStopIncluded,data:e.data}),i.splice(r,1);else{if(i[r]=new ex({start:e.stop,stop:i[r].stop,isStartIncluded:!e.isStopIncluded,isStopIncluded:i[r].isStopIncluded,data:i[r].data}),!i[r].isEmpty)break;i.splice(r,1)}i.splice(r,0,e),this._changedEvent.raiseEvent(this)}},qP.prototype.removeInterval=function(e){if(!Object(u.a)(e))throw new h.a("interval is required");if(e.isEmpty)return!1;var t=this._intervals,i=Ji(t,e,GP);i<0&&(i=~i);var n=!1;for(i>0&&(Tr.greaterThan(t[i-1].stop,e.start)||t[i-1].stop.equals(e.start)&&t[i-1].isStopIncluded&&e.isStartIncluded)&&(n=!0,(Tr.greaterThan(t[i-1].stop,e.stop)||t[i-1].isStopIncluded&&!e.isStopIncluded&&t[i-1].stop.equals(e.stop))&&t.splice(i,0,new ex({start:e.stop,stop:t[i-1].stop,isStartIncluded:!e.isStopIncluded,isStopIncluded:t[i-1].isStopIncluded,data:t[i-1].data})),t[i-1]=new ex({start:t[i-1].start,stop:e.start,isStartIncluded:t[i-1].isStartIncluded,isStopIncluded:!e.isStartIncluded,data:t[i-1].data})),i<t.length&&!e.isStartIncluded&&t[i].isStartIncluded&&e.start.equals(t[i].start)&&(n=!0,t.splice(i,0,new ex({start:t[i].start,stop:t[i].start,isStartIncluded:!0,isStopIncluded:!0,data:t[i].data})),++i);i<t.length&&Tr.greaterThan(e.stop,t[i].stop);)n=!0,t.splice(i,1);return i<t.length&&e.stop.equals(t[i].stop)&&(n=!0,!e.isStopIncluded&&t[i].isStopIncluded?i+1<t.length&&t[i+1].start.equals(e.stop)&&t[i].data===t[i+1].data?(t.splice(i,1),t[i]=new ex({start:t[i].start,stop:t[i].stop,isStartIncluded:!0,isStopIncluded:t[i].isStopIncluded,data:t[i].data})):t[i]=new ex({start:e.stop,stop:e.stop,isStartIncluded:!0,isStopIncluded:!0,data:t[i].data}):t.splice(i,1)),i<t.length&&(Tr.greaterThan(e.stop,t[i].start)||e.stop.equals(t[i].start)&&e.isStopIncluded&&t[i].isStartIncluded)&&(n=!0,t[i]=new ex({start:e.stop,stop:t[i].stop,isStartIncluded:!e.isStopIncluded,isStopIncluded:t[i].isStopIncluded,data:t[i].data})),n&&this._changedEvent.raiseEvent(this),n},qP.prototype.intersect=function(e,t,i){if(!Object(u.a)(e))throw new h.a("other is required.");for(var n=new qP,r=0,a=0,o=this._intervals,s=e._intervals;r<o.length&&a<s.length;){var c=o[r],l=s[a];if(Tr.lessThan(c.stop,l.start))++r;else if(Tr.lessThan(l.stop,c.start))++a;else{if(Object(u.a)(i)||Object(u.a)(t)&&t(c.data,l.data)||!Object(u.a)(t)&&l.data===c.data){var d=ex.intersect(c,l,new ex,i);d.isEmpty||n.addInterval(d,t)}Tr.lessThan(c.stop,l.stop)||c.stop.equals(l.stop)&&!c.isStopIncluded&&l.isStopIncluded?++r:++a}}return n},qP.fromJulianDateArray=function(e,t){if(!Object(u.a)(e))throw new h.a("options is required.");if(!Object(u.a)(e.julianDates))throw new h.a("options.iso8601Array is required.");Object(u.a)(t)||(t=new qP);var i,n=e.julianDates,r=n.length,a=e.dataCallback,o=Object(w.a)(e.isStartIncluded,!0),s=Object(w.a)(e.isStopIncluded,!0),c=Object(w.a)(e.leadingInterval,!1),l=Object(w.a)(e.trailingInterval,!1),d=0;c&&(++d,(i=new ex({start:nx.MINIMUM_VALUE,stop:n[0],isStartIncluded:!0,isStopIncluded:!o})).data=Object(u.a)(a)?a(i,t.length):t.length,t.addInterval(i));for(var f=0;f<r-1;++f){var p=n[f],m=n[f+1];(i=new ex({start:p,stop:m,isStartIncluded:t.length!==d||o,isStopIncluded:f===r-2&&s})).data=Object(u.a)(a)?a(i,t.length):t.length,t.addInterval(i),p=m}return l&&((i=new ex({start:n[r-1],stop:nx.MAXIMUM_VALUE,isStartIncluded:!s,isStopIncluded:!0})).data=Object(u.a)(a)?a(i,t.length):t.length,t.addInterval(i)),t};var YP=new er,XP=[0,31,28,31,30,31,30,31,31,30,31,30,31];function ZP(e,t,i){Object(u.a)(i)||(i=new Tr),Tr.toGregorianDate(e,YP);var n=YP.millisecond+t.millisecond,r=YP.second+t.second,a=YP.minute+t.minute,o=YP.hour+t.hour,s=YP.day+t.day,c=YP.month+t.month,l=YP.year+t.year;for(n>=1e3&&(r+=Math.floor(n/1e3),n%=1e3),r>=60&&(a+=Math.floor(r/60),r%=60),a>=60&&(o+=Math.floor(a/60),a%=60),o>=24&&(s+=Math.floor(o/24),o%=24),XP[2]=tr(l)?29:28;s>XP[c]||c>=13;)s>XP[c]&&(s-=XP[c],++c),c>=13&&(--c,l+=Math.floor(c/12),c%=12,++c),XP[2]=tr(l)?29:28;return YP.millisecond=n,YP.second=r,YP.minute=a,YP.hour=o,YP.day=s,YP.month=c,YP.year=l,Tr.fromGregorianDate(YP,i)}var QP=new Tr,KP=/P(?:([\d.,]+)Y)?(?:([\d.,]+)M)?(?:([\d.,]+)W)?(?:([\d.,]+)D)?(?:T(?:([\d.,]+)H)?(?:([\d.,]+)M)?(?:([\d.,]+)S)?)?/;function JP(e,t){if(!Object(u.a)(e)||0===e.length)return!1;if(t.year=0,t.month=0,t.day=0,t.hour=0,t.minute=0,t.second=0,t.millisecond=0,"P"===e[0]){var i=e.match(KP);if(!Object(u.a)(i))return!1;if(Object(u.a)(i[1])&&(t.year=Number(i[1].replace(",","."))),Object(u.a)(i[2])&&(t.month=Number(i[2].replace(",","."))),Object(u.a)(i[3])&&(t.day=7*Number(i[3].replace(",","."))),Object(u.a)(i[4])&&(t.day+=Number(i[4].replace(",","."))),Object(u.a)(i[5])&&(t.hour=Number(i[5].replace(",","."))),Object(u.a)(i[6])&&(t.minute=Number(i[6].replace(",","."))),Object(u.a)(i[7])){var n=Number(i[7].replace(",","."));t.second=Math.floor(n),t.millisecond=n%1*1e3}}else"Z"!==e[e.length-1]&&(e+="Z"),Tr.toGregorianDate(Tr.fromIso8601(e,QP),t);return t.year||t.month||t.day||t.hour||t.minute||t.second||t.millisecond}var $P=new er;qP.fromIso8601=function(e,t){if(!Object(u.a)(e))throw new h.a("options is required.");if(!Object(u.a)(e.iso8601))throw new h.a("options.iso8601 is required.");var i=e.iso8601.split("/"),n=Tr.fromIso8601(i[0]),r=Tr.fromIso8601(i[1]),a=[];if(JP(i[2],$P)){var o=Tr.clone(n);for(a.push(o);Tr.compare(o,r)<0;){o=ZP(o,$P),Tr.compare(r,o)<=0&&Tr.clone(r,o),a.push(o)}}else a.push(n,r);return qP.fromJulianDateArray({julianDates:a,isStartIncluded:e.isStartIncluded,isStopIncluded:e.isStopIncluded,leadingInterval:e.leadingInterval,trailingInterval:e.trailingInterval,dataCallback:e.dataCallback},t)},qP.fromIso8601DateArray=function(e,t){if(!Object(u.a)(e))throw new h.a("options is required.");if(!Object(u.a)(e.iso8601Dates))throw new h.a("options.iso8601Dates is required.");return qP.fromJulianDateArray({julianDates:e.iso8601Dates.map((function(e){return Tr.fromIso8601(e)})),isStartIncluded:e.isStartIncluded,isStopIncluded:e.isStopIncluded,leadingInterval:e.leadingInterval,trailingInterval:e.trailingInterval,dataCallback:e.dataCallback},t)},qP.fromIso8601DurationArray=function(e,t){if(!Object(u.a)(e))throw new h.a("options is required.");if(!Object(u.a)(e.epoch))throw new h.a("options.epoch is required.");if(!Object(u.a)(e.iso8601Durations))throw new h.a("options.iso8601Durations is required.");for(var i,n,r=e.epoch,a=e.iso8601Durations,o=Object(w.a)(e.relativeToPrevious,!1),s=[],c=a.length,l=0;l<c;++l)(JP(a[l],$P)||0===l)&&(i=o&&Object(u.a)(n)?ZP(n,$P):ZP(r,$P),s.push(i),n=i);return qP.fromJulianDateArray({julianDates:s,isStartIncluded:e.isStartIncluded,isStopIncluded:e.isStopIncluded,leadingInterval:e.leadingInterval,trailingInterval:e.trailingInterval,dataCallback:e.dataCallback},t)};var eI=qP,tI=new z(1,1,1),iI=z.ZERO,nI=Kn.IDENTITY,rI=function(e,t,i){this.translation=z.clone(Object(w.a)(e,iI)),this.rotation=Kn.clone(Object(w.a)(t,nI)),this.scale=z.clone(Object(w.a)(i,tI))};rI.prototype.equals=function(e){return this===e||Object(u.a)(e)&&z.equals(this.translation,e.translation)&&Kn.equals(this.rotation,e.rotation)&&z.equals(this.scale,e.scale)};var aI=rI,oI=n(106);function sI(e){e=Object(w.a)(e,w.a.EMPTY_OBJECT),this._clock=void 0,this._element=void 0,this._clockSubscription=void 0,this._seekFunction=void 0,this._lastPlaybackRate=void 0,this.clock=e.clock,this.element=e.element,this.epoch=Object(w.a)(e.epoch,nx.MINIMUM_VALUE),this.tolerance=Object(w.a)(e.tolerance,1),this._seeking=!1,this._seekFunction=void 0,this._firstTickAfterSeek=!1}Object(O.a)(sI.prototype,{clock:{get:function(){return this._clock},set:function(e){var t=this._clock;t!==e&&(Object(u.a)(t)&&(this._clockSubscription(),this._clockSubscription=void 0),Object(u.a)(e)&&(this._clockSubscription=e.onTick.addEventListener(sI.prototype._onTick,this)),this._clock=e)}},element:{get:function(){return this._element},set:function(e){var t,i=this._element;i!==e&&(Object(u.a)(i)&&i.removeEventListener("seeked",this._seekFunction,!1),Object(u.a)(e)&&(this._seeking=!1,this._seekFunction=(t=this,function(){t._seeking=!1,t._firstTickAfterSeek=!0}),e.addEventListener("seeked",this._seekFunction,!1)),this._element=e,this._seeking=!1,this._firstTickAfterSeek=!1)}}}),sI.prototype.destroy=function(){return this.element=void 0,this.clock=void 0,rl(this)},sI.prototype.isDestroyed=function(){return!1},sI.prototype._trySetPlaybackRate=function(e){if(this._lastPlaybackRate!==e.multiplier){var t=this._element;try{t.playbackRate=e.multiplier}catch(e){t.playbackRate=0}this._lastPlaybackRate=e.multiplier}},sI.prototype._onTick=function(e){var t=this._element;if(Object(u.a)(t)&&!(t.readyState<2)){var i=t.paused,n=e.shouldAnimate;if(n===i&&(n?t.play():t.pause()),this._seeking||this._firstTickAfterSeek)this._firstTickAfterSeek=!1;else{this._trySetPlaybackRate(e);var r,a=e.currentTime,o=Object(w.a)(this.epoch,nx.MINIMUM_VALUE),s=Tr.secondsDifference(a,o),c=t.duration,l=t.currentTime;t.loop?((s%=c)<0&&(s=c-s),r=s):r=s>c?c:s<0?0:s;var h=n?Object(w.a)(this.tolerance,1):.001;Math.abs(r-l)>h&&(this._seeking=!0,t.currentTime=r)}}};var cI=sI;function lI(e,t){this.rectangle=e,this.maxLevel=t}function uI(e){if(e=Object(w.a)(e,w.a.EMPTY_OBJECT),!Object(u.a)(e.url))throw new h.a("options.url is required.");var t=f.a.createIfNeeded(e.url);this._resource=t,this._errorEvent=new $o.a,this._ready=!1,this._readyPromise=Oi.a.defer(),this._terrainDataStructure={heightScale:.001,heightOffset:-1e3,elementsPerHeight:3,stride:4,elementMultiplier:256,isBigEndian:!0,lowestEncodedHeight:0,highestEncodedHeight:16777215};var i=e.credit;"string"==typeof i&&(i=new Jo(i)),this._credit=i,this._tilingScheme=void 0,this._rectangles=[];var n,r=this,a=Object(w.a)(e.ellipsoid,ae.WGS84);function o(e){var t=e.getElementsByTagName("SRS")[0].textContent;if("EPSG:4326"===t){r._tilingScheme=new Nt({ellipsoid:a});var i=e.getElementsByTagName("TileFormat")[0];r._heightmapWidth=parseInt(i.getAttribute("width"),10),r._heightmapHeight=parseInt(i.getAttribute("height"),10),r._levelZeroMaximumGeometricError=vl.getEstimatedLevelZeroGeometricErrorForAHeightmap(a,Math.min(r._heightmapWidth,r._heightmapHeight),r._tilingScheme.getNumberOfXTilesAtLevel(0));for(var n=e.getElementsByTagName("DataExtent"),o=0;o<n.length;++o){var c=n[o],l=I.toRadians(parseFloat(c.getAttribute("minx"))),u=I.toRadians(parseFloat(c.getAttribute("miny"))),h=I.toRadians(parseFloat(c.getAttribute("maxx"))),d=I.toRadians(parseFloat(c.getAttribute("maxy"))),f=parseInt(c.getAttribute("maxlevel"),10);r._rectangles.push(new lI(new Ve(l,u,h,d),f))}r._ready=!0,r._readyPromise.resolve(!0)}else s("SRS "+t+" is not supported.")}function s(e){var t=Object(w.a)(e,"An error occurred while accessing "+r._resource.url+".");n=uu.handleError(n,r,r._errorEvent,t,void 0,void 0,void 0,c)}function c(){Object(Oi.a)(r._resource.fetchXML(),o,s)}c()}Object(O.a)(uI.prototype,{errorEvent:{get:function(){return this._errorEvent}},credit:{get:function(){return this._credit}},tilingScheme:{get:function(){if(!this.ready)throw new h.a("requestTileGeometry must not be called before ready returns true.");return this._tilingScheme}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise.promise}},hasWaterMask:{get:function(){return!1}},hasVertexNormals:{get:function(){return!1}}}),uI.prototype.requestTileGeometry=function(e,t,i,n){if(!this.ready)throw new h.a("requestTileGeometry must not be called before ready returns true.");var r=this._tilingScheme.getNumberOfYTilesAtLevel(i),a=this._resource.getDerivedResource({url:i+"/"+e+"/"+(r-t-1)+".tif",queryParameters:{cesium:!0},request:n}).fetchImage();if(Object(u.a)(a)){var o=this;return Object(Oi.a)(a).then((function(n){return new Tl({buffer:sy(n),width:o._heightmapWidth,height:o._heightmapHeight,childTileMask:dI(o,e,t,i),structure:o._terrainDataStructure})}))}},uI.prototype.getLevelMaximumGeometricError=function(e){if(!this.ready)throw new h.a("requestTileGeometry must not be called before ready returns true.");return this._levelZeroMaximumGeometricError/(1<<e)};var hI=new Ve;function dI(e,t,i,n){for(var r=e._tilingScheme,a=e._rectangles,o=r.tileXYToRectangle(t,i,n),s=0,c=0;c<a.length&&15!==s;++c){var l=a[c];if(!(l.maxLevel<=n)){var h=l.rectangle,d=Ve.intersection(h,o,hI);Object(u.a)(d)&&(fI(r,h,2*t,2*i,n+1)&&(s|=4),fI(r,h,2*t+1,2*i,n+1)&&(s|=8),fI(r,h,2*t,2*i+1,n+1)&&(s|=1),fI(r,h,2*t+1,2*i+1,n+1)&&(s|=2))}}return s}function fI(e,t,i,n,r){var a=e.tileXYToRectangle(i,n,r);return Object(u.a)(Ve.intersection(a,t,hI))}uI.prototype.getTileDataAvailable=function(e,t,i){},uI.prototype.loadTileDataAvailability=function(e,t,i){};var pI=uI,mI={};function _I(e,t){return I.equalsEpsilon(e.latitude,t.latitude,I.EPSILON14)&&I.equalsEpsilon(e.longitude,t.longitude,I.EPSILON14)}var gI=new K,vI=new K;var bI=new Array(2),yI=new Array(2),wI={positions:void 0,height:void 0,granularity:void 0,ellipsoid:void 0};mI.computePositions=function(e,t,i,n,r,a){var o=function(e,t,i,n){var r=t.length;if(!(r<2)){var a=Object(u.a)(n),o=Object(u.a)(i),s=!0,c=new Array(r),l=new Array(r),h=new Array(r),d=t[0];c[0]=d;var f=e.cartesianToCartographic(d,gI);o&&(f.height=i[0]),s=s&&f.height<=0,l[0]=f.height,h[0]=a?n[0]:0;for(var p=1,m=1;m<r;++m){var _=t[m],g=e.cartesianToCartographic(_,vI);o&&(g.height=i[m]),s=s&&g.height<=0,_I(f,g)?f.height<g.height&&(l[p-1]=g.height):(c[p]=_,l[p]=g.height,h[p]=a?n[m]:0,K.clone(g,f),++p)}if(!(s||p<2))return c.length=p,l.length=p,h.length=p,{positions:c,topHeights:l,bottomHeights:h}}}(e,t,i,n);if(Object(u.a)(o)){if(t=o.positions,i=o.topHeights,n=o.bottomHeights,t.length>=3){var s=fc.fromPoints(t,e).projectPointsOntoPlane(t);wp.computeWindingOrder2D(s)===op.CLOCKWISE&&(t.reverse(),i.reverse(),n.reverse())}var c,l,h=t.length,d=h-2,f=I.chordLength(r,e.maximumRadius),p=wI;if(p.minDistance=f,p.ellipsoid=e,a){var m,_=0;for(m=0;m<h-1;m++)_+=Gm.numberOfPoints(t[m],t[m+1],f)+1;c=new Float64Array(3*_),l=new Float64Array(3*_);var g=bI,v=yI;p.positions=g,p.height=v;var b=0;for(m=0;m<h-1;m++){g[0]=t[m],g[1]=t[m+1],v[0]=i[m],v[1]=i[m+1];var y=Gm.generateArc(p);c.set(y,b),v[0]=n[m],v[1]=n[m+1],l.set(Gm.generateArc(p),b),b+=y.length}}else p.positions=t,p.height=i,c=new Float64Array(Gm.generateArc(p)),p.height=n,l=new Float64Array(Gm.generateArc(p));return{bottomPositions:l,topPositions:c,numCorners:d}}};var OI=mI,xI=new z,EI=new z,TI=new z,CI=new z,SI=new z,AI=new z,PI=new z,II=new z;function DI(e){var t=(e=Object(w.a)(e,w.a.EMPTY_OBJECT)).positions,i=e.maximumHeights,n=e.minimumHeights;if(!Object(u.a)(t))throw new h.a("options.positions is required.");if(Object(u.a)(i)&&i.length!==t.length)throw new h.a("options.positions and options.maximumHeights must have the same length.");if(Object(u.a)(n)&&n.length!==t.length)throw new h.a("options.positions and options.minimumHeights must have the same length.");var r=Object(w.a)(e.vertexFormat,Ba.DEFAULT),a=Object(w.a)(e.granularity,I.RADIANS_PER_DEGREE),o=Object(w.a)(e.ellipsoid,ae.WGS84);this._positions=t,this._minimumHeights=n,this._maximumHeights=i,this._vertexFormat=Ba.clone(r),this._granularity=a,this._ellipsoid=ae.clone(o),this._workerName="createWallGeometry";var s=1+t.length*z.packedLength+2;Object(u.a)(n)&&(s+=n.length),Object(u.a)(i)&&(s+=i.length),this.packedLength=s+ae.packedLength+Ba.packedLength+1}DI.pack=function(e,t,i){if(!Object(u.a)(e))throw new h.a("value is required");if(!Object(u.a)(t))throw new h.a("array is required");var n;i=Object(w.a)(i,0);var r=e._positions,a=r.length;for(t[i++]=a,n=0;n<a;++n,i+=z.packedLength)z.pack(r[n],t,i);var o=e._minimumHeights;if(a=Object(u.a)(o)?o.length:0,t[i++]=a,Object(u.a)(o))for(n=0;n<a;++n)t[i++]=o[n];var s=e._maximumHeights;if(a=Object(u.a)(s)?s.length:0,t[i++]=a,Object(u.a)(s))for(n=0;n<a;++n)t[i++]=s[n];return ae.pack(e._ellipsoid,t,i),i+=ae.packedLength,Ba.pack(e._vertexFormat,t,i),t[i+=Ba.packedLength]=e._granularity,t};var jI=ae.clone(ae.UNIT_SPHERE),MI=new Ba,RI={positions:void 0,minimumHeights:void 0,maximumHeights:void 0,ellipsoid:jI,vertexFormat:MI,granularity:void 0};DI.unpack=function(e,t,i){if(!Object(u.a)(e))throw new h.a("array is required");var n;t=Object(w.a)(t,0);var r,a,o=e[t++],s=new Array(o);for(n=0;n<o;++n,t+=z.packedLength)s[n]=z.unpack(e,t);if((o=e[t++])>0)for(r=new Array(o),n=0;n<o;++n)r[n]=e[t++];if((o=e[t++])>0)for(a=new Array(o),n=0;n<o;++n)a[n]=e[t++];var c=ae.unpack(e,t,jI);t+=ae.packedLength;var l=Ba.unpack(e,t,MI),d=e[t+=Ba.packedLength];return Object(u.a)(i)?(i._positions=s,i._minimumHeights=r,i._maximumHeights=a,i._ellipsoid=ae.clone(c,i._ellipsoid),i._vertexFormat=Ba.clone(l,i._vertexFormat),i._granularity=d,i):(RI.positions=s,RI.minimumHeights=r,RI.maximumHeights=a,RI.granularity=d,new DI(RI))},DI.fromConstantHeights=function(e){var t,i,n=(e=Object(w.a)(e,w.a.EMPTY_OBJECT)).positions;if(!Object(u.a)(n))throw new h.a("options.positions is required.");var r=e.minimumHeight,a=e.maximumHeight,o=Object(u.a)(r),s=Object(u.a)(a);if(o||s){var c=n.length;t=o?new Array(c):void 0,i=s?new Array(c):void 0;for(var l=0;l<c;++l)o&&(t[l]=r),s&&(i[l]=a)}return new DI({positions:n,maximumHeights:i,minimumHeights:t,ellipsoid:e.ellipsoid,vertexFormat:e.vertexFormat})},DI.createGeometry=function(e){var t=e._positions,i=e._minimumHeights,n=e._maximumHeights,r=e._vertexFormat,a=e._granularity,o=e._ellipsoid,s=OI.computePositions(o,t,n,i,a,!0);if(Object(u.a)(s)){var c,l=s.bottomPositions,h=s.topPositions,d=s.numCorners,f=h.length,p=2*f,m=r.position?new Float64Array(p):void 0,_=r.normal?new Float32Array(p):void 0,g=r.tangent?new Float32Array(p):void 0,v=r.bitangent?new Float32Array(p):void 0,b=r.st?new Float32Array(p/3*2):void 0,y=0,w=0,O=0,x=0,E=0,T=II,C=PI,S=AI,A=!0,P=0,D=1/((f/=3)-t.length+1);for(c=0;c<f;++c){var j=3*c,M=z.fromArray(h,j,xI),R=z.fromArray(l,j,EI);if(r.position&&(m[y++]=R.x,m[y++]=R.y,m[y++]=R.z,m[y++]=M.x,m[y++]=M.y,m[y++]=M.z),r.st&&(b[E++]=P,b[E++]=0,b[E++]=P,b[E++]=1),r.normal||r.tangent||r.bitangent){var L,N=z.clone(z.ZERO,SI),F=o.scaleToGeodeticSurface(z.fromArray(h,j,EI),EI);if(c+1<f&&(L=o.scaleToGeodeticSurface(z.fromArray(h,j+3,TI),TI),N=z.fromArray(h,j+3,SI)),A){var k=z.subtract(N,M,CI),B=z.subtract(F,M,xI);T=z.normalize(z.cross(B,k,T),T),A=!1}z.equalsEpsilon(L,F,I.EPSILON10)?A=!0:(P+=D,r.tangent&&(C=z.normalize(z.subtract(L,F,C),C)),r.bitangent&&(S=z.normalize(z.cross(T,C,S),S))),r.normal&&(_[w++]=T.x,_[w++]=T.y,_[w++]=T.z,_[w++]=T.x,_[w++]=T.y,_[w++]=T.z),r.tangent&&(g[x++]=C.x,g[x++]=C.y,g[x++]=C.z,g[x++]=C.x,g[x++]=C.y,g[x++]=C.z),r.bitangent&&(v[O++]=S.x,v[O++]=S.y,v[O++]=S.z,v[O++]=S.x,v[O++]=S.y,v[O++]=S.z)}}var U=new Fa;r.position&&(U.position=new Na({componentDatatype:dn.DOUBLE,componentsPerAttribute:3,values:m})),r.normal&&(U.normal=new Na({componentDatatype:dn.FLOAT,componentsPerAttribute:3,values:_})),r.tangent&&(U.tangent=new Na({componentDatatype:dn.FLOAT,componentsPerAttribute:3,values:g})),r.bitangent&&(U.bitangent=new Na({componentDatatype:dn.FLOAT,componentsPerAttribute:3,values:v})),r.st&&(U.st=new Na({componentDatatype:dn.FLOAT,componentsPerAttribute:2,values:b}));var V=p/3;p-=6*(d+1);var H=Sl.createTypedArray(V,p),G=0;for(c=0;c<V-2;c+=2){var q=c,W=c+2,Y=z.fromArray(m,3*q,xI),X=z.fromArray(m,3*W,EI);if(!z.equalsEpsilon(Y,X,I.EPSILON10)){var Z=c+1,Q=c+3;H[G++]=Z,H[G++]=q,H[G++]=Q,H[G++]=Q,H[G++]=q,H[G++]=W}}return new La({attributes:U,indices:H,primitiveType:yn.TRIANGLES,boundingSphere:new St.fromVertices(m)})}};var LI=DI,NI=new z,FI=new z;function kI(e){var t=(e=Object(w.a)(e,w.a.EMPTY_OBJECT)).positions,i=e.maximumHeights,n=e.minimumHeights;if(!Object(u.a)(t))throw new h.a("options.positions is required.");if(Object(u.a)(i)&&i.length!==t.length)throw new h.a("options.positions and options.maximumHeights must have the same length.");if(Object(u.a)(n)&&n.length!==t.length)throw new h.a("options.positions and options.minimumHeights must have the same length.");var r=Object(w.a)(e.granularity,I.RADIANS_PER_DEGREE),a=Object(w.a)(e.ellipsoid,ae.WGS84);this._positions=t,this._minimumHeights=n,this._maximumHeights=i,this._granularity=r,this._ellipsoid=ae.clone(a),this._workerName="createWallOutlineGeometry";var o=1+t.length*z.packedLength+2;Object(u.a)(n)&&(o+=n.length),Object(u.a)(i)&&(o+=i.length),this.packedLength=o+ae.packedLength+1}kI.pack=function(e,t,i){if(!Object(u.a)(e))throw new h.a("value is required");if(!Object(u.a)(t))throw new h.a("array is required");var n;i=Object(w.a)(i,0);var r=e._positions,a=r.length;for(t[i++]=a,n=0;n<a;++n,i+=z.packedLength)z.pack(r[n],t,i);var o=e._minimumHeights;if(a=Object(u.a)(o)?o.length:0,t[i++]=a,Object(u.a)(o))for(n=0;n<a;++n)t[i++]=o[n];var s=e._maximumHeights;if(a=Object(u.a)(s)?s.length:0,t[i++]=a,Object(u.a)(s))for(n=0;n<a;++n)t[i++]=s[n];return ae.pack(e._ellipsoid,t,i),t[i+=ae.packedLength]=e._granularity,t};var BI=ae.clone(ae.UNIT_SPHERE),zI={positions:void 0,minimumHeights:void 0,maximumHeights:void 0,ellipsoid:BI,granularity:void 0};kI.unpack=function(e,t,i){if(!Object(u.a)(e))throw new h.a("array is required");var n;t=Object(w.a)(t,0);var r,a,o=e[t++],s=new Array(o);for(n=0;n<o;++n,t+=z.packedLength)s[n]=z.unpack(e,t);if((o=e[t++])>0)for(r=new Array(o),n=0;n<o;++n)r[n]=e[t++];if((o=e[t++])>0)for(a=new Array(o),n=0;n<o;++n)a[n]=e[t++];var c=ae.unpack(e,t,BI),l=e[t+=ae.packedLength];return Object(u.a)(i)?(i._positions=s,i._minimumHeights=r,i._maximumHeights=a,i._ellipsoid=ae.clone(c,i._ellipsoid),i._granularity=l,i):(zI.positions=s,zI.minimumHeights=r,zI.maximumHeights=a,zI.granularity=l,new kI(zI))},kI.fromConstantHeights=function(e){var t,i,n=(e=Object(w.a)(e,w.a.EMPTY_OBJECT)).positions;if(!Object(u.a)(n))throw new h.a("options.positions is required.");var r=e.minimumHeight,a=e.maximumHeight,o=Object(u.a)(r),s=Object(u.a)(a);if(o||s){var c=n.length;t=o?new Array(c):void 0,i=s?new Array(c):void 0;for(var l=0;l<c;++l)o&&(t[l]=r),s&&(i[l]=a)}return new kI({positions:n,maximumHeights:i,minimumHeights:t,ellipsoid:e.ellipsoid})},kI.createGeometry=function(e){var t=e._positions,i=e._minimumHeights,n=e._maximumHeights,r=e._granularity,a=e._ellipsoid,o=OI.computePositions(a,t,n,i,r,!1);if(Object(u.a)(o)){var s,c=o.bottomPositions,l=o.topPositions,h=l.length,d=2*h,f=new Float64Array(d),p=0;for(h/=3,s=0;s<h;++s){var m=3*s,_=z.fromArray(l,m,NI),g=z.fromArray(c,m,FI);f[p++]=g.x,f[p++]=g.y,f[p++]=g.z,f[p++]=_.x,f[p++]=_.y,f[p++]=_.z}var v=new Fa({position:new Na({componentDatatype:dn.DOUBLE,componentsPerAttribute:3,values:f})}),b=d/3;d=2*b-4+b;var y=Sl.createTypedArray(b,d),w=0;for(s=0;s<b-2;s+=2){var O=s,x=s+2,E=z.fromArray(f,3*O,NI),T=z.fromArray(f,3*x,FI);if(!z.equalsEpsilon(E,T,I.EPSILON10)){var C=s+1,S=s+3;y[w++]=C,y[w++]=O,y[w++]=C,y[w++]=S,y[w++]=O,y[w++]=x}}return y[w++]=b-2,y[w++]=b-1,new La({attributes:v,indices:y,primitiveType:yn.LINES,boundingSphere:new St.fromVertices(f)})}};var UI=kI;var VI=function(e){switch(e){case un.FLOAT:return"float";case un.FLOAT_VEC2:return"vec2";case un.FLOAT_VEC3:return"vec3";case un.FLOAT_VEC4:return"vec4";case un.FLOAT_MAT2:return"mat2";case un.FLOAT_MAT3:return"mat3";case un.FLOAT_MAT4:return"mat4";case un.SAMPLER_2D:return"sampler2D";case un.BOOL:return"bool"}};function HI(e){if(e=Object(w.a)(e,{}),this._ellipsoid=Object(w.a)(e.ellipsoid,ae.WGS84),this._numberOfLevelZeroTilesX=Object(w.a)(e.numberOfLevelZeroTilesX,1),this._numberOfLevelZeroTilesY=Object(w.a)(e.numberOfLevelZeroTilesY,1),this._projection=new Qc(this._ellipsoid),Object(u.a)(e.rectangleSouthwestInMeters)&&Object(u.a)(e.rectangleNortheastInMeters))this._rectangleSouthwestInMeters=e.rectangleSouthwestInMeters,this._rectangleNortheastInMeters=e.rectangleNortheastInMeters;else{var t=this._ellipsoid.maximumRadius*Math.PI;this._rectangleSouthwestInMeters=new Rt(-t,-t),this._rectangleNortheastInMeters=new Rt(t,t)}var i=this._projection.unproject(this._rectangleSouthwestInMeters),n=this._projection.unproject(this._rectangleNortheastInMeters);this._rectangle=new Ve(i.longitude,i.latitude,n.longitude,n.latitude)}Object(O.a)(HI.prototype,{ellipsoid:{get:function(){return this._ellipsoid}},rectangle:{get:function(){return this._rectangle}},projection:{get:function(){return this._projection}}}),HI.prototype.getNumberOfXTilesAtLevel=function(e){return this._numberOfLevelZeroTilesX<<e},HI.prototype.getNumberOfYTilesAtLevel=function(e){return this._numberOfLevelZeroTilesY<<e},HI.prototype.rectangleToNativeRectangle=function(e,t){var i=this._projection,n=i.project(Ve.southwest(e)),r=i.project(Ve.northeast(e));return Object(u.a)(t)?(t.west=n.x,t.south=n.y,t.east=r.x,t.north=r.y,t):new Ve(n.x,n.y,r.x,r.y)},HI.prototype.tileXYToNativeRectangle=function(e,t,i,n){var r=this.getNumberOfXTilesAtLevel(i),a=this.getNumberOfYTilesAtLevel(i),o=(this._rectangleNortheastInMeters.x-this._rectangleSouthwestInMeters.x)/r,s=this._rectangleSouthwestInMeters.x+e*o,c=this._rectangleSouthwestInMeters.x+(e+1)*o,l=(this._rectangleNortheastInMeters.y-this._rectangleSouthwestInMeters.y)/a,h=this._rectangleNortheastInMeters.y-t*l,d=this._rectangleNortheastInMeters.y-(t+1)*l;return Object(u.a)(n)?(n.west=s,n.south=d,n.east=c,n.north=h,n):new Ve(s,d,c,h)},HI.prototype.tileXYToRectangle=function(e,t,i,n){var r=this.tileXYToNativeRectangle(e,t,i,n),a=this._projection,o=a.unproject(new Rt(r.west,r.south)),s=a.unproject(new Rt(r.east,r.north));return r.west=o.longitude,r.south=o.latitude,r.east=s.longitude,r.north=s.latitude,r},HI.prototype.positionToTileXY=function(e,t,i){var n=this._rectangle;if(Ve.contains(n,e)){var r=this.getNumberOfXTilesAtLevel(t),a=this.getNumberOfYTilesAtLevel(t),o=(this._rectangleNortheastInMeters.x-this._rectangleSouthwestInMeters.x)/r,s=(this._rectangleNortheastInMeters.y-this._rectangleSouthwestInMeters.y)/a,c=this._projection.project(e),l=(c.x-this._rectangleSouthwestInMeters.x)/o|0;l>=r&&(l=r-1);var h=(this._rectangleNortheastInMeters.y-c.y)/s|0;return h>=a&&(h=a-1),Object(u.a)(i)?(i.x=l,i.y=h,i):new Rt(l,h)}};var GI=HI;function qI(e){var t=(e=Object(w.a)(e,w.a.EMPTY_OBJECT)).weights,i=e.times;if(x.a.defined("weights",t),x.a.defined("times",i),x.a.typeOf.number.greaterThanOrEquals("weights.length",t.length,3),t.length%i.length!=0)throw new h.a("times.length must be a factor of weights.length.");this._times=i,this._weights=t,this._count=t.length/i.length,this._lastTimeIndex=0}Object(O.a)(qI.prototype,{times:{get:function(){return this._times}},weights:{get:function(){return this._weights}}}),qI.prototype.findTimeInterval=ao.prototype.findTimeInterval,qI.prototype.wrapTime=ao.prototype.wrapTime,qI.prototype.clampTime=ao.prototype.clampTime,qI.prototype.evaluate=function(e,t){var i=this.weights,n=this.times,r=this._lastTimeIndex=this.findTimeInterval(e,this._lastTimeIndex),a=(e-n[r])/(n[r+1]-n[r]);Object(u.a)(t)||(t=new Array(this._count));for(var o=0;o<this._count;o++){var s=r*this._count+o;t[o]=i[s]*(1-a)+i[s+this._count]*a}return t};var WI=qI;var YI=function(e,t,i){if("function"!=typeof t)throw new h.a("oldFunction is required to be a function.");if("function"!=typeof i)throw new h.a("oldFunction is required to be a function.");return function(){i.apply(e,arguments),t.apply(e,arguments)}};function XI(e){this._value=void 0,this._hasClone=!1,this._hasEquals=!1,this._definitionChanged=new $o.a,this.setValue(e)}Object(O.a)(XI.prototype,{isConstant:{value:!0},definitionChanged:{get:function(){return this._definitionChanged}}}),XI.prototype.getValue=function(e,t){return this._hasClone?this._value.clone(t):this._value},XI.prototype.setValue=function(e){var t=this._value;if(t!==e){var i=Object(u.a)(e),n=i&&"function"==typeof e.clone,r=i&&"function"==typeof e.equals;(!r||!e.equals(t))&&(this._hasClone=n,this._hasEquals=r,this._value=n?e.clone(this._value):e,this._definitionChanged.raiseEvent(this))}},XI.prototype.equals=function(e){return this===e||e instanceof XI&&(!this._hasEquals&&this._value===e._value||this._hasEquals&&this._value.equals(e._value))},XI.prototype.valueOf=function(){return this._value},XI.prototype.toString=function(){return String(this._value)};var ZI=XI;function QI(e){return new ZI(e)}var KI=function(e,t,i){return function(e,t,i,n,r){return{configurable:n,get:function(){return this[t]},set:function(n){var a=this[t],o=this[i];Object(u.a)(o)&&(o(),this[i]=void 0),!(void 0!==n)||Object(u.a)(n)&&Object(u.a)(n.getValue)||!Object(u.a)(r)||(n=r(n)),a!==n&&(this[t]=n,this._definitionChanged.raiseEvent(this,e,n,a)),Object(u.a)(n)&&Object(u.a)(n.definitionChanged)&&(this[i]=n.definitionChanged.addEventListener((function(){this._definitionChanged.raiseEvent(this,e,n,n)}),this))}}}(e,"_"+e.toString(),"_"+e.toString()+"Subscription",Object(w.a)(t,!1),Object(w.a)(i,QI))};function JI(e){this._image=void 0,this._imageSubscription=void 0,this._imageSubRegion=void 0,this._imageSubRegionSubscription=void 0,this._width=void 0,this._widthSubscription=void 0,this._height=void 0,this._heightSubscription=void 0,this._scale=void 0,this._scaleSubscription=void 0,this._rotation=void 0,this._rotationSubscription=void 0,this._alignedAxis=void 0,this._alignedAxisSubscription=void 0,this._horizontalOrigin=void 0,this._horizontalOriginSubscription=void 0,this._verticalOrigin=void 0,this._verticalOriginSubscription=void 0,this._color=void 0,this._colorSubscription=void 0,this._eyeOffset=void 0,this._eyeOffsetSubscription=void 0,this._heightReference=void 0,this._heightReferenceSubscription=void 0,this._pixelOffset=void 0,this._pixelOffsetSubscription=void 0,this._show=void 0,this._showSubscription=void 0,this._scaleByDistance=void 0,this._scaleByDistanceSubscription=void 0,this._translucencyByDistance=void 0,this._translucencyByDistanceSubscription=void 0,this._pixelOffsetScaleByDistance=void 0,this._pixelOffsetScaleByDistanceSubscription=void 0,this._sizeInMeters=void 0,this._sizeInMetersSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this._disableDepthTestDistance=void 0,this._disableDepthTestDistanceSubscription=void 0,this._definitionChanged=new $o.a,this.merge(Object(w.a)(e,w.a.EMPTY_OBJECT))}Object(O.a)(JI.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},image:KI("image"),imageSubRegion:KI("imageSubRegion"),scale:KI("scale"),rotation:KI("rotation"),alignedAxis:KI("alignedAxis"),horizontalOrigin:KI("horizontalOrigin"),verticalOrigin:KI("verticalOrigin"),color:KI("color"),eyeOffset:KI("eyeOffset"),heightReference:KI("heightReference"),pixelOffset:KI("pixelOffset"),show:KI("show"),width:KI("width"),height:KI("height"),scaleByDistance:KI("scaleByDistance"),translucencyByDistance:KI("translucencyByDistance"),pixelOffsetScaleByDistance:KI("pixelOffsetScaleByDistance"),sizeInMeters:KI("sizeInMeters"),distanceDisplayCondition:KI("distanceDisplayCondition"),disableDepthTestDistance:KI("disableDepthTestDistance")}),JI.prototype.clone=function(e){return Object(u.a)(e)?(e.color=this._color,e.eyeOffset=this._eyeOffset,e.heightReference=this._heightReference,e.horizontalOrigin=this._horizontalOrigin,e.image=this._image,e.imageSubRegion=this._imageSubRegion,e.pixelOffset=this._pixelOffset,e.scale=this._scale,e.rotation=this._rotation,e.alignedAxis=this._alignedAxis,e.show=this._show,e.verticalOrigin=this._verticalOrigin,e.width=this._width,e.height=this._height,e.scaleByDistance=this._scaleByDistance,e.translucencyByDistance=this._translucencyByDistance,e.pixelOffsetScaleByDistance=this._pixelOffsetScaleByDistance,e.sizeInMeters=this._sizeInMeters,e.distanceDisplayCondition=this._distanceDisplayCondition,e.disableDepthTestDistance=this._disableDepthTestDistance,e):new JI(this)},JI.prototype.merge=function(e){if(!Object(u.a)(e))throw new h.a("source is required.");this.color=Object(w.a)(this._color,e.color),this.eyeOffset=Object(w.a)(this._eyeOffset,e.eyeOffset),this.heightReference=Object(w.a)(this._heightReference,e.heightReference),this.horizontalOrigin=Object(w.a)(this._horizontalOrigin,e.horizontalOrigin),this.image=Object(w.a)(this._image,e.image),this.imageSubRegion=Object(w.a)(this._imageSubRegion,e.imageSubRegion),this.pixelOffset=Object(w.a)(this._pixelOffset,e.pixelOffset),this.scale=Object(w.a)(this._scale,e.scale),this.rotation=Object(w.a)(this._rotation,e.rotation),this.alignedAxis=Object(w.a)(this._alignedAxis,e.alignedAxis),this.show=Object(w.a)(this._show,e.show),this.verticalOrigin=Object(w.a)(this._verticalOrigin,e.verticalOrigin),this.width=Object(w.a)(this._width,e.width),this.height=Object(w.a)(this._height,e.height),this.scaleByDistance=Object(w.a)(this._scaleByDistance,e.scaleByDistance),this.translucencyByDistance=Object(w.a)(this._translucencyByDistance,e.translucencyByDistance),this.pixelOffsetScaleByDistance=Object(w.a)(this._pixelOffsetScaleByDistance,e.pixelOffsetScaleByDistance),this.sizeInMeters=Object(w.a)(this._sizeInMeters,e.sizeInMeters),this.distanceDisplayCondition=Object(w.a)(this._distanceDisplayCondition,e.distanceDisplayCondition),this.disableDepthTestDistance=Object(w.a)(this._disableDepthTestDistance,e.disableDepthTestDistance)};var $I=JI,eD=Object(E.a)({NONE:0,CLAMP_TO_GROUND:1,RELATIVE_TO_GROUND:2}),tD=Object(E.a)({CENTER:0,LEFT:1,RIGHT:-1}),iD=Object(E.a)({CENTER:0,BOTTOM:1,BASELINE:2,TOP:-1}),nD=Object(E.a)({DONE:0,PENDING:1,FAILED:2});function rD(){h.a.throwInstantiationError()}Object(O.a)(rD.prototype,{isConstant:{get:h.a.throwInstantiationError},definitionChanged:{get:h.a.throwInstantiationError}}),rD.prototype.getValue=h.a.throwInstantiationError,rD.prototype.equals=h.a.throwInstantiationError,rD.equals=function(e,t){return e===t||Object(u.a)(e)&&e.equals(t)},rD.arrayEquals=function(e,t){if(e===t)return!0;if(!Object(u.a)(e)||!Object(u.a)(t)||e.length!==t.length)return!1;for(var i=e.length,n=0;n<i;n++)if(!rD.equals(e[n],t[n]))return!1;return!0},rD.isConstant=function(e){return!Object(u.a)(e)||e.isConstant},rD.getValueOrUndefined=function(e,t,i){return Object(u.a)(e)?e.getValue(t,i):void 0},rD.getValueOrDefault=function(e,t,i,n){return Object(u.a)(e)?Object(w.a)(e.getValue(t,n),i):i},rD.getValueOrClonedDefault=function(e,t,i,n){var r;return Object(u.a)(e)&&(r=e.getValue(t,n)),Object(u.a)(r)||(r=i.clone(r)),r};var aD=rD,oD=uf.WHITE,sD=z.ZERO,cD=eD.NONE,lD=Rt.ZERO,uD=z.ZERO,hD=tD.CENTER,dD=iD.CENTER,fD=new z,pD=new uf,mD=new z,_D=new Rt,gD=new Fx,vD=new Fx,bD=new Fx,yD=new ln,wD=new gv;function OD(e){this.entity=e,this.billboard=void 0,this.textureValue=void 0}function xD(e,t){if(!Object(u.a)(e))throw new h.a("entityCluster is required.");if(!Object(u.a)(t))throw new h.a("entityCollection is required.");t.collectionChanged.addEventListener(xD.prototype._onCollectionChanged,this),this._cluster=e,this._entityCollection=t,this._items=new Fi,this._onCollectionChanged(t,t.values,[],[])}function ED(e,t,i){Object(u.a)(e)&&(e.billboard=void 0,i.removeBillboard(t))}xD.prototype.update=function(e){if(!Object(u.a)(e))throw new h.a("time is required.");for(var t=this._items.values,i=this._cluster,n=0,r=t.length;n<r;n++){var a,o,s=t[n],c=s.entity,l=c._billboard,d=s.billboard,f=c.isShowing&&c.isAvailable(e)&&aD.getValueOrDefault(l._show,e,!0);if(f&&(o=aD.getValueOrUndefined(c._position,e,fD),a=aD.getValueOrUndefined(l._image,e),f=Object(u.a)(o)&&Object(u.a)(a)),f){aD.isConstant(c._position)||(i._clusterDirty=!0),Object(u.a)(d)||((d=i.getBillboard(c)).id=c,d.image=void 0,s.billboard=d),d.show=f,Object(u.a)(d.image)&&s.textureValue===a||(d.image=a,s.textureValue=a),d.position=o,d.color=aD.getValueOrDefault(l._color,e,oD,pD),d.eyeOffset=aD.getValueOrDefault(l._eyeOffset,e,sD,mD),d.heightReference=aD.getValueOrDefault(l._heightReference,e,cD),d.pixelOffset=aD.getValueOrDefault(l._pixelOffset,e,lD,_D),d.scale=aD.getValueOrDefault(l._scale,e,1),d.rotation=aD.getValueOrDefault(l._rotation,e,0),d.alignedAxis=aD.getValueOrDefault(l._alignedAxis,e,uD),d.horizontalOrigin=aD.getValueOrDefault(l._horizontalOrigin,e,hD),d.verticalOrigin=aD.getValueOrDefault(l._verticalOrigin,e,dD),d.width=aD.getValueOrUndefined(l._width,e),d.height=aD.getValueOrUndefined(l._height,e),d.scaleByDistance=aD.getValueOrUndefined(l._scaleByDistance,e,gD),d.translucencyByDistance=aD.getValueOrUndefined(l._translucencyByDistance,e,vD),d.pixelOffsetScaleByDistance=aD.getValueOrUndefined(l._pixelOffsetScaleByDistance,e,bD),d.sizeInMeters=aD.getValueOrDefault(l._sizeInMeters,e,!1),d.distanceDisplayCondition=aD.getValueOrUndefined(l._distanceDisplayCondition,e,wD),d.disableDepthTestDistance=aD.getValueOrUndefined(l._disableDepthTestDistance,e);var p=aD.getValueOrUndefined(l._imageSubRegion,e,yD);Object(u.a)(p)&&d.setImageSubRegion(d._imageId,p)}else ED(s,c,i)}return!0},xD.prototype.getBoundingSphere=function(e,t){if(!Object(u.a)(e))throw new h.a("entity is required.");if(!Object(u.a)(t))throw new h.a("result is required.");var i=this._items.get(e.id);if(!Object(u.a)(i)||!Object(u.a)(i.billboard))return nD.FAILED;var n=i.billboard;if(n.heightReference===eD.NONE)t.center=z.clone(n.position,t.center);else{if(!Object(u.a)(n._clampedPosition))return nD.PENDING;t.center=z.clone(n._clampedPosition,t.center)}return t.radius=0,nD.DONE},xD.prototype.isDestroyed=function(){return!1},xD.prototype.destroy=function(){this._entityCollection.collectionChanged.removeEventListener(xD.prototype._onCollectionChanged,this);for(var e=this._entityCollection.values,t=0;t<e.length;t++)this._cluster.removeBillboard(e[t]);return rl(this)},xD.prototype._onCollectionChanged=function(e,t,i,n){var r,a,o=this._items,s=this._cluster;for(r=t.length-1;r>-1;r--)a=t[r],Object(u.a)(a._billboard)&&Object(u.a)(a._position)&&o.set(a.id,new OD(a));for(r=n.length-1;r>-1;r--)a=n[r],Object(u.a)(a._billboard)&&Object(u.a)(a._position)?o.contains(a.id)||o.set(a.id,new OD(a)):(ED(o.get(a.id),a,s),o.remove(a.id));for(r=i.length-1;r>-1;r--)a=i[r],ED(o.get(a.id),a,s),o.remove(a.id)};var TD=xD,CD="varying vec3 v_positionEC;\nvarying vec3 v_normalEC;\nvarying vec3 v_tangentEC;\nvarying vec3 v_bitangentEC;\nvarying vec2 v_st;\nvoid main()\n{\nvec3 positionToEyeEC = -v_positionEC;\nmat3 tangentToEyeMatrix = czm_tangentToEyeSpaceMatrix(v_normalEC, v_tangentEC, v_bitangentEC);\nvec3 normalEC = normalize(v_normalEC);\n#ifdef FACE_FORWARD\nnormalEC = faceforward(normalEC, vec3(0.0, 0.0, 1.0), -normalEC);\n#endif\nczm_materialInput materialInput;\nmaterialInput.normalEC = normalEC;\nmaterialInput.tangentToEyeMatrix = tangentToEyeMatrix;\nmaterialInput.positionToEyeEC = positionToEyeEC;\nmaterialInput.st = v_st;\nczm_material material = czm_getMaterial(materialInput);\n#ifdef FLAT\ngl_FragColor = vec4(material.diffuse + material.emission, material.alpha);\n#else\ngl_FragColor = czm_phong(normalize(positionToEyeEC), material);\n#endif\n}\n",SD="attribute vec3 position3DHigh;\nattribute vec3 position3DLow;\nattribute vec3 normal;\nattribute vec3 tangent;\nattribute vec3 bitangent;\nattribute vec2 st;\nattribute float batchId;\nvarying vec3 v_positionEC;\nvarying vec3 v_normalEC;\nvarying vec3 v_tangentEC;\nvarying vec3 v_bitangentEC;\nvarying vec2 v_st;\nvoid main()\n{\nvec4 p = czm_computePosition();\nv_positionEC = (czm_modelViewRelativeToEye * p).xyz;\nv_normalEC = czm_normal * normal;\nv_tangentEC = czm_normal * tangent;\nv_bitangentEC = czm_normal * bitangent;\nv_st = st;\ngl_Position = czm_modelViewProjectionRelativeToEye * p;\n}\n",AD="varying vec3 v_positionEC;\nvarying vec3 v_normalEC;\nvoid main()\n{\nvec3 positionToEyeEC = -v_positionEC;\nvec3 normalEC = normalize(v_normalEC);\n#ifdef FACE_FORWARD\nnormalEC = faceforward(normalEC, vec3(0.0, 0.0, 1.0), -normalEC);\n#endif\nczm_materialInput materialInput;\nmaterialInput.normalEC = normalEC;\nmaterialInput.positionToEyeEC = positionToEyeEC;\nczm_material material = czm_getMaterial(materialInput);\n#ifdef FLAT\ngl_FragColor = vec4(material.diffuse + material.emission, material.alpha);\n#else\ngl_FragColor = czm_phong(normalize(positionToEyeEC), material);\n#endif\n}\n",PD="attribute vec3 position3DHigh;\nattribute vec3 position3DLow;\nattribute vec3 normal;\nattribute float batchId;\nvarying vec3 v_positionEC;\nvarying vec3 v_normalEC;\nvoid main()\n{\nvec4 p = czm_computePosition();\nv_positionEC = (czm_modelViewRelativeToEye * p).xyz;\nv_normalEC = czm_normal * normal;\ngl_Position = czm_modelViewProjectionRelativeToEye * p;\n}\n",ID="varying vec3 v_positionEC;\nvarying vec3 v_normalEC;\nvarying vec2 v_st;\nvoid main()\n{\nvec3 positionToEyeEC = -v_positionEC;\nvec3 normalEC = normalize(v_normalEC);\n#ifdef FACE_FORWARD\nnormalEC = faceforward(normalEC, vec3(0.0, 0.0, 1.0), -normalEC);\n#endif\nczm_materialInput materialInput;\nmaterialInput.normalEC = normalEC;\nmaterialInput.positionToEyeEC = positionToEyeEC;\nmaterialInput.st = v_st;\nczm_material material = czm_getMaterial(materialInput);\n#ifdef FLAT\ngl_FragColor = vec4(material.diffuse + material.emission, material.alpha);\n#else\ngl_FragColor = czm_phong(normalize(positionToEyeEC), material);\n#endif\n}\n",DD="attribute vec3 position3DHigh;\nattribute vec3 position3DLow;\nattribute vec3 normal;\nattribute vec2 st;\nattribute float batchId;\nvarying vec3 v_positionEC;\nvarying vec3 v_normalEC;\nvarying vec2 v_st;\nvoid main()\n{\nvec4 p = czm_computePosition();\nv_positionEC = (czm_modelViewRelativeToEye * p).xyz;\nv_normalEC = czm_normal * normal;\nv_st = st;\ngl_Position = czm_modelViewProjectionRelativeToEye * p;\n}\n",jD={ADD:un.FUNC_ADD,SUBTRACT:un.FUNC_SUBTRACT,REVERSE_SUBTRACT:un.FUNC_REVERSE_SUBTRACT,MIN:un.MIN,MAX:un.MAX},MD=Object(E.a)(jD),RD={ZERO:un.ZERO,ONE:un.ONE,SOURCE_COLOR:un.SRC_COLOR,ONE_MINUS_SOURCE_COLOR:un.ONE_MINUS_SRC_COLOR,DESTINATION_COLOR:un.DST_COLOR,ONE_MINUS_DESTINATION_COLOR:un.ONE_MINUS_DST_COLOR,SOURCE_ALPHA:un.SRC_ALPHA,ONE_MINUS_SOURCE_ALPHA:un.ONE_MINUS_SRC_ALPHA,DESTINATION_ALPHA:un.DST_ALPHA,ONE_MINUS_DESTINATION_ALPHA:un.ONE_MINUS_DST_ALPHA,CONSTANT_COLOR:un.CONSTANT_COLOR,ONE_MINUS_CONSTANT_COLOR:un.ONE_MINUS_CONSTANT_ALPHA,CONSTANT_ALPHA:un.CONSTANT_ALPHA,ONE_MINUS_CONSTANT_ALPHA:un.ONE_MINUS_CONSTANT_ALPHA,SOURCE_ALPHA_SATURATE:un.SRC_ALPHA_SATURATE},LD=Object(E.a)(RD),ND={DISABLED:Object(E.a)({enabled:!1}),ALPHA_BLEND:Object(E.a)({enabled:!0,equationRgb:MD.ADD,equationAlpha:MD.ADD,functionSourceRgb:LD.SOURCE_ALPHA,functionSourceAlpha:LD.SOURCE_ALPHA,functionDestinationRgb:LD.ONE_MINUS_SOURCE_ALPHA,functionDestinationAlpha:LD.ONE_MINUS_SOURCE_ALPHA}),PRE_MULTIPLIED_ALPHA_BLEND:Object(E.a)({enabled:!0,equationRgb:MD.ADD,equationAlpha:MD.ADD,functionSourceRgb:LD.ONE,functionSourceAlpha:LD.ONE,functionDestinationRgb:LD.ONE_MINUS_SOURCE_ALPHA,functionDestinationAlpha:LD.ONE_MINUS_SOURCE_ALPHA}),ADDITIVE_BLEND:Object(E.a)({enabled:!0,equationRgb:MD.ADD,equationAlpha:MD.ADD,functionSourceRgb:LD.SOURCE_ALPHA,functionSourceAlpha:LD.SOURCE_ALPHA,functionDestinationRgb:LD.ONE,functionDestinationAlpha:LD.ONE})},FD=Object(E.a)(ND),kD={FRONT:un.FRONT,BACK:un.BACK,FRONT_AND_BACK:un.FRONT_AND_BACK},BD=Object(E.a)(kD);function zD(e){e=Object(w.a)(e,w.a.EMPTY_OBJECT),this.material=e.material,this.translucent=Object(w.a)(e.translucent,!0),this._vertexShaderSource=e.vertexShaderSource,this._fragmentShaderSource=e.fragmentShaderSource,this._renderState=e.renderState,this._closed=Object(w.a)(e.closed,!1)}Object(O.a)(zD.prototype,{vertexShaderSource:{get:function(){return this._vertexShaderSource}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},renderState:{get:function(){return this._renderState}},closed:{get:function(){return this._closed}}}),zD.prototype.getFragmentShaderSource=function(){var e=[];return this.flat&&e.push("#define FLAT"),this.faceForward&&e.push("#define FACE_FORWARD"),Object(u.a)(this.material)&&e.push(this.material.shaderSource),e.push(this.fragmentShaderSource),e.join("\n")},zD.prototype.isTranslucent=function(){return Object(u.a)(this.material)&&this.material.isTranslucent()||!Object(u.a)(this.material)&&this.translucent},zD.prototype.getRenderState=function(){var e=this.isTranslucent(),t=Object(nf.a)(this.renderState,!1);return e?(t.depthMask=!1,t.blending=FD.ALPHA_BLEND):t.depthMask=!0,t},zD.getDefaultRenderState=function(e,t,i){var n={depthTest:{enabled:!0}};return e&&(n.depthMask=!1,n.blending=FD.ALPHA_BLEND),t&&(n.cull={enabled:!0,face:BD.BACK}),Object(u.a)(i)&&(n=Object(ff.a)(i,n,!0)),n};var UD=zD,VD={_maximumCombinedTextureImageUnits:0,_maximumCubeMapSize:0,_maximumFragmentUniformVectors:0,_maximumTextureImageUnits:0,_maximumRenderbufferSize:0,_maximumTextureSize:0,_maximumVaryingVectors:0,_maximumVertexAttributes:0,_maximumVertexTextureImageUnits:0,_maximumVertexUniformVectors:0,_minimumAliasedLineWidth:0,_maximumAliasedLineWidth:0,_minimumAliasedPointSize:0,_maximumAliasedPointSize:0,_maximumViewportWidth:0,_maximumViewportHeight:0,_maximumTextureFilterAnisotropy:0,_maximumDrawBuffers:0,_maximumColorAttachments:0,_highpFloatSupported:!1,_highpIntSupported:!1};Object(O.a)(VD,{maximumCombinedTextureImageUnits:{get:function(){return VD._maximumCombinedTextureImageUnits}},maximumCubeMapSize:{get:function(){return VD._maximumCubeMapSize}},maximumFragmentUniformVectors:{get:function(){return VD._maximumFragmentUniformVectors}},maximumTextureImageUnits:{get:function(){return VD._maximumTextureImageUnits}},maximumRenderbufferSize:{get:function(){return VD._maximumRenderbufferSize}},maximumTextureSize:{get:function(){return VD._maximumTextureSize}},maximumVaryingVectors:{get:function(){return VD._maximumVaryingVectors}},maximumVertexAttributes:{get:function(){return VD._maximumVertexAttributes}},maximumVertexTextureImageUnits:{get:function(){return VD._maximumVertexTextureImageUnits}},maximumVertexUniformVectors:{get:function(){return VD._maximumVertexUniformVectors}},minimumAliasedLineWidth:{get:function(){return VD._minimumAliasedLineWidth}},maximumAliasedLineWidth:{get:function(){return VD._maximumAliasedLineWidth}},minimumAliasedPointSize:{get:function(){return VD._minimumAliasedPointSize}},maximumAliasedPointSize:{get:function(){return VD._maximumAliasedPointSize}},maximumViewportWidth:{get:function(){return VD._maximumViewportWidth}},maximumViewportHeight:{get:function(){return VD._maximumViewportHeight}},maximumTextureFilterAnisotropy:{get:function(){return VD._maximumTextureFilterAnisotropy}},maximumDrawBuffers:{get:function(){return VD._maximumDrawBuffers}},maximumColorAttachments:{get:function(){return VD._maximumColorAttachments}},highpFloatSupported:{get:function(){return VD._highpFloatSupported}},highpIntSupported:{get:function(){return VD._highpIntSupported}}});var HD=VD;function GD(e,t,i,n,r,a,o,s,c,l){this._gl=e,this._texture=t,this._textureTarget=i,this._targetFace=n,this._pixelFormat=r,this._pixelDatatype=a,this._size=o,this._preMultiplyAlpha=s,this._flipY=c,this._initialized=l}Object(O.a)(GD.prototype,{pixelFormat:{get:function(){return this._pixelFormat}},pixelDatatype:{get:function(){return this._pixelDatatype}},_target:{get:function(){return this._targetFace}}}),GD.prototype.copyFrom=function(e,t,i){if(t=Object(w.a)(t,0),i=Object(w.a)(i,0),x.a.defined("source",e),x.a.typeOf.number.greaterThanOrEquals("xOffset",t,0),x.a.typeOf.number.greaterThanOrEquals("yOffset",i,0),t+e.width>this._size)throw new h.a("xOffset + source.width must be less than or equal to width.");if(i+e.height>this._size)throw new h.a("yOffset + source.height must be less than or equal to height.");var n=this._gl,r=this._textureTarget,a=this._targetFace;n.activeTexture(n.TEXTURE0),n.bindTexture(r,this._texture);var o=e.width,s=e.height,c=e.arrayBufferView,l=this._size,d=this._pixelFormat,f=this._pixelDatatype,p=this._preMultiplyAlpha,m=this._flipY,_=!1;if(!this._initialized){if(0===t&&0===i&&o===l&&s===l)Object(u.a)(c)?(n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,!1),m&&(c=gx.flipY(c,d,f,l,l)),n.texImage2D(a,0,d,l,l,0,d,f,c)):(n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,p),n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,m),n.texImage2D(a,0,d,d,f,e)),_=!0;else{n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,!1);var g=gx.createTypedArray(d,f,l,l);n.texImage2D(a,0,d,l,l,0,d,f,g)}this._initialized=!0}_||(c?(n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,!1),m&&(c=gx.flipY(c,d,f,o,s)),n.texSubImage2D(a,0,t,i,o,s,d,f,c)):(n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,p),n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,m),n.texSubImage2D(a,0,t,i,d,f,e))),n.bindTexture(r,null)},GD.prototype.copyFromFramebuffer=function(e,t,i,n,r,a){if(e=Object(w.a)(e,0),t=Object(w.a)(t,0),i=Object(w.a)(i,0),n=Object(w.a)(n,0),r=Object(w.a)(r,this._size),a=Object(w.a)(a,this._size),x.a.typeOf.number.greaterThanOrEquals("xOffset",e,0),x.a.typeOf.number.greaterThanOrEquals("yOffset",t,0),x.a.typeOf.number.greaterThanOrEquals("framebufferXOffset",i,0),x.a.typeOf.number.greaterThanOrEquals("framebufferYOffset",n,0),e+r>this._size)throw new h.a("xOffset + source.width must be less than or equal to width.");if(t+a>this._size)throw new h.a("yOffset + source.height must be less than or equal to height.");if(this._pixelDatatype===mx.FLOAT)throw new h.a("Cannot call copyFromFramebuffer when the texture pixel data type is FLOAT.");if(this._pixelDatatype===mx.HALF_FLOAT)throw new h.a("Cannot call copyFromFramebuffer when the texture pixel data type is HALF_FLOAT.");var o=this._gl,s=this._textureTarget;o.activeTexture(o.TEXTURE0),o.bindTexture(s,this._texture),o.copyTexSubImage2D(this._targetFace,0,e,t,i,n,r,a),o.bindTexture(s,null),this._initialized=!0};var qD=GD,WD={DONT_CARE:un.DONT_CARE,FASTEST:un.FASTEST,NICEST:un.NICEST,validate:function(e){return e===WD.DONT_CARE||e===WD.FASTEST||e===WD.NICEST}},YD=Object(E.a)(WD),XD={NEAREST:un.NEAREST,LINEAR:un.LINEAR,validate:function(e){return e===XD.NEAREST||e===XD.LINEAR}},ZD=Object(E.a)(XD),QD={NEAREST:un.NEAREST,LINEAR:un.LINEAR,NEAREST_MIPMAP_NEAREST:un.NEAREST_MIPMAP_NEAREST,LINEAR_MIPMAP_NEAREST:un.LINEAR_MIPMAP_NEAREST,NEAREST_MIPMAP_LINEAR:un.NEAREST_MIPMAP_LINEAR,LINEAR_MIPMAP_LINEAR:un.LINEAR_MIPMAP_LINEAR,validate:function(e){return e===QD.NEAREST||e===QD.LINEAR||e===QD.NEAREST_MIPMAP_NEAREST||e===QD.LINEAR_MIPMAP_NEAREST||e===QD.NEAREST_MIPMAP_LINEAR||e===QD.LINEAR_MIPMAP_LINEAR}},KD=Object(E.a)(QD),JD={CLAMP_TO_EDGE:un.CLAMP_TO_EDGE,REPEAT:un.REPEAT,MIRRORED_REPEAT:un.MIRRORED_REPEAT,validate:function(e){return e===JD.CLAMP_TO_EDGE||e===JD.REPEAT||e===JD.MIRRORED_REPEAT}},$D=Object(E.a)(JD);function ej(e){e=Object(w.a)(e,w.a.EMPTY_OBJECT);var t=Object(w.a)(e.wrapS,$D.CLAMP_TO_EDGE),i=Object(w.a)(e.wrapT,$D.CLAMP_TO_EDGE),n=Object(w.a)(e.minificationFilter,KD.LINEAR),r=Object(w.a)(e.magnificationFilter,ZD.LINEAR),a=Object(u.a)(e.maximumAnisotropy)?e.maximumAnisotropy:1;if(!$D.validate(t))throw new h.a("Invalid sampler.wrapS.");if(!$D.validate(i))throw new h.a("Invalid sampler.wrapT.");if(!KD.validate(n))throw new h.a("Invalid sampler.minificationFilter.");if(!ZD.validate(r))throw new h.a("Invalid sampler.magnificationFilter.");x.a.typeOf.number.greaterThanOrEquals("maximumAnisotropy",a,1),this._wrapS=t,this._wrapT=i,this._minificationFilter=n,this._magnificationFilter=r,this._maximumAnisotropy=a}Object(O.a)(ej.prototype,{wrapS:{get:function(){return this._wrapS}},wrapT:{get:function(){return this._wrapT}},minificationFilter:{get:function(){return this._minificationFilter}},magnificationFilter:{get:function(){return this._magnificationFilter}},maximumAnisotropy:{get:function(){return this._maximumAnisotropy}}}),ej.equals=function(e,t){return e===t||Object(u.a)(e)&&Object(u.a)(t)&&e._wrapS===t._wrapS&&e._wrapT===t._wrapT&&e._minificationFilter===t._minificationFilter&&e._magnificationFilter===t._magnificationFilter&&e._maximumAnisotropy===t._maximumAnisotropy};var tj=ej;function ij(e){e=Object(w.a)(e,w.a.EMPTY_OBJECT),x.a.defined("options.context",e.context);var t,i,n=e.context,r=e.source;if(Object(u.a)(r)){var a=[r.positiveX,r.negativeX,r.positiveY,r.negativeY,r.positiveZ,r.negativeZ];if(!(a[0]&&a[1]&&a[2]&&a[3]&&a[4]&&a[5]))throw new h.a("options.source requires positiveX, negativeX, positiveY, negativeY, positiveZ, and negativeZ faces.");t=a[0].width,i=a[0].height;for(var o=1;o<6;++o)if(Number(a[o].width)!==t||Number(a[o].height)!==i)throw new h.a("Each face in options.source must have the same width and height.")}else t=e.width,i=e.height;var s=t,c=Object(w.a)(e.pixelFormat,gx.RGBA),l=Object(w.a)(e.pixelDatatype,mx.UNSIGNED_BYTE);if(!Object(u.a)(t)||!Object(u.a)(i))throw new h.a("options requires a source field to create an initialized cube map or width and height fields to create a blank cube map.");if(t!==i)throw new h.a("Width must equal height.");if(s<=0)throw new h.a("Width and height must be greater than zero.");if(s>HD.maximumCubeMapSize)throw new h.a("Width and height must be less than or equal to the maximum cube map size ("+HD.maximumCubeMapSize+").  Check maximumCubeMapSize.");if(!gx.validate(c))throw new h.a("Invalid options.pixelFormat.");if(gx.isDepthFormat(c))throw new h.a("options.pixelFormat cannot be DEPTH_COMPONENT or DEPTH_STENCIL.");if(!mx.validate(l))throw new h.a("Invalid options.pixelDatatype.");if(l===mx.FLOAT&&!n.floatingPointTexture)throw new h.a("When options.pixelDatatype is FLOAT, this WebGL implementation must support the OES_texture_float extension.");if(l===mx.HALF_FLOAT&&!n.halfFloatingPointTexture)throw new h.a("When options.pixelDatatype is HALF_FLOAT, this WebGL implementation must support the OES_texture_half_float extension.");var d=6*gx.textureSizeInBytes(c,l,s,s),f=e.preMultiplyAlpha||c===gx.RGB||c===gx.LUMINANCE,p=Object(w.a)(e.flipY,!0),m=n._gl,_=m.TEXTURE_CUBE_MAP,g=m.createTexture();function v(e,t,i,n){var r=t.arrayBufferView;Object(u.a)(r)||(r=t.bufferView),r?(m.pixelStorei(m.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),m.pixelStorei(m.UNPACK_FLIP_Y_WEBGL,!1),n&&(r=gx.flipY(r,c,l,s,s)),m.texImage2D(e,0,c,s,s,0,c,l,r)):(m.pixelStorei(m.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i),m.pixelStorei(m.UNPACK_FLIP_Y_WEBGL,n),m.texImage2D(e,0,c,c,l,t))}m.activeTexture(m.TEXTURE0),m.bindTexture(_,g),Object(u.a)(r)?(v(m.TEXTURE_CUBE_MAP_POSITIVE_X,r.positiveX,f,p),v(m.TEXTURE_CUBE_MAP_NEGATIVE_X,r.negativeX,f,p),v(m.TEXTURE_CUBE_MAP_POSITIVE_Y,r.positiveY,f,p),v(m.TEXTURE_CUBE_MAP_NEGATIVE_Y,r.negativeY,f,p),v(m.TEXTURE_CUBE_MAP_POSITIVE_Z,r.positiveZ,f,p),v(m.TEXTURE_CUBE_MAP_NEGATIVE_Z,r.negativeZ,f,p)):(m.texImage2D(m.TEXTURE_CUBE_MAP_POSITIVE_X,0,c,s,s,0,c,l,null),m.texImage2D(m.TEXTURE_CUBE_MAP_NEGATIVE_X,0,c,s,s,0,c,l,null),m.texImage2D(m.TEXTURE_CUBE_MAP_POSITIVE_Y,0,c,s,s,0,c,l,null),m.texImage2D(m.TEXTURE_CUBE_MAP_NEGATIVE_Y,0,c,s,s,0,c,l,null),m.texImage2D(m.TEXTURE_CUBE_MAP_POSITIVE_Z,0,c,s,s,0,c,l,null),m.texImage2D(m.TEXTURE_CUBE_MAP_NEGATIVE_Z,0,c,s,s,0,c,l,null)),m.bindTexture(_,null),this._context=n,this._textureFilterAnisotropic=n._textureFilterAnisotropic,this._textureTarget=_,this._texture=g,this._pixelFormat=c,this._pixelDatatype=l,this._size=s,this._hasMipmap=!1,this._sizeInBytes=d,this._preMultiplyAlpha=f,this._flipY=p,this._sampler=void 0;var b=Object(u.a)(r);this._positiveX=new qD(m,g,_,m.TEXTURE_CUBE_MAP_POSITIVE_X,c,l,s,f,p,b),this._negativeX=new qD(m,g,_,m.TEXTURE_CUBE_MAP_NEGATIVE_X,c,l,s,f,p,b),this._positiveY=new qD(m,g,_,m.TEXTURE_CUBE_MAP_POSITIVE_Y,c,l,s,f,p,b),this._negativeY=new qD(m,g,_,m.TEXTURE_CUBE_MAP_NEGATIVE_Y,c,l,s,f,p,b),this._positiveZ=new qD(m,g,_,m.TEXTURE_CUBE_MAP_POSITIVE_Z,c,l,s,f,p,b),this._negativeZ=new qD(m,g,_,m.TEXTURE_CUBE_MAP_NEGATIVE_Z,c,l,s,f,p,b),this.sampler=Object(u.a)(e.sampler)?e.sampler:new tj}Object(O.a)(ij.prototype,{positiveX:{get:function(){return this._positiveX}},negativeX:{get:function(){return this._negativeX}},positiveY:{get:function(){return this._positiveY}},negativeY:{get:function(){return this._negativeY}},positiveZ:{get:function(){return this._positiveZ}},negativeZ:{get:function(){return this._negativeZ}},sampler:{get:function(){return this._sampler},set:function(e){var t=e.minificationFilter,i=e.magnificationFilter,n=t===KD.NEAREST_MIPMAP_NEAREST||t===KD.NEAREST_MIPMAP_LINEAR||t===KD.LINEAR_MIPMAP_NEAREST||t===KD.LINEAR_MIPMAP_LINEAR,r=this._context,a=this._pixelDatatype;(a===mx.FLOAT&&!r.textureFloatLinear||a===mx.HALF_FLOAT&&!r.textureHalfFloatLinear)&&(t=n?KD.NEAREST_MIPMAP_NEAREST:KD.NEAREST,i=ZD.NEAREST);var o=r._gl,s=this._textureTarget;o.activeTexture(o.TEXTURE0),o.bindTexture(s,this._texture),o.texParameteri(s,o.TEXTURE_MIN_FILTER,t),o.texParameteri(s,o.TEXTURE_MAG_FILTER,i),o.texParameteri(s,o.TEXTURE_WRAP_S,e.wrapS),o.texParameteri(s,o.TEXTURE_WRAP_T,e.wrapT),Object(u.a)(this._textureFilterAnisotropic)&&o.texParameteri(s,this._textureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,e.maximumAnisotropy),o.bindTexture(s,null),this._sampler=e}},pixelFormat:{get:function(){return this._pixelFormat}},pixelDatatype:{get:function(){return this._pixelDatatype}},width:{get:function(){return this._size}},height:{get:function(){return this._size}},sizeInBytes:{get:function(){return this._hasMipmap?Math.floor(4*this._sizeInBytes/3):this._sizeInBytes}},preMultiplyAlpha:{get:function(){return this._preMultiplyAlpha}},flipY:{get:function(){return this._flipY}},_target:{get:function(){return this._textureTarget}}}),ij.prototype.generateMipmap=function(e){if(e=Object(w.a)(e,YD.DONT_CARE),this._size>1&&!I.isPowerOfTwo(this._size))throw new h.a("width and height must be a power of two to call generateMipmap().");if(!YD.validate(e))throw new h.a("hint is invalid.");this._hasMipmap=!0;var t=this._context._gl,i=this._textureTarget;t.hint(t.GENERATE_MIPMAP_HINT,e),t.activeTexture(t.TEXTURE0),t.bindTexture(i,this._texture),t.generateMipmap(i),t.bindTexture(i,null)},ij.prototype.isDestroyed=function(){return!1},ij.prototype.destroy=function(){return this._context._gl.deleteTexture(this._texture),this._positiveX=rl(this._positiveX),this._negativeX=rl(this._negativeX),this._positiveY=rl(this._positiveY),this._negativeY=rl(this._negativeY),this._positiveZ=rl(this._positiveZ),this._negativeZ=rl(this._negativeZ),rl(this)};var nj=ij;class rj{}function aj(e,t,i){var n=e._gl;n.framebufferTexture2D(n.FRAMEBUFFER,t,i._target,i._texture,0)}function oj(e,t,i){var n=e._gl;n.framebufferRenderbuffer(n.FRAMEBUFFER,t,n.RENDERBUFFER,i._getRenderbuffer())}function sj(e){var t=(e=Object(w.a)(e,w.a.EMPTY_OBJECT)).context;x.a.defined("options.context",t);var i=t._gl,n=HD.maximumColorAttachments;if(this._gl=i,this._framebuffer=i.createFramebuffer(),this._colorTextures=[],this._colorRenderbuffers=[],this._activeColorAttachments=[],this._depthTexture=void 0,this._depthRenderbuffer=void 0,this._stencilRenderbuffer=void 0,this._depthStencilTexture=void 0,this._depthStencilRenderbuffer=void 0,this.destroyAttachments=Object(w.a)(e.destroyAttachments,!0),Object(u.a)(e.colorTextures)&&Object(u.a)(e.colorRenderbuffers))throw new h.a("Cannot have both color texture and color renderbuffer attachments.");if(Object(u.a)(e.depthTexture)&&Object(u.a)(e.depthRenderbuffer))throw new h.a("Cannot have both a depth texture and depth renderbuffer attachment.");if(Object(u.a)(e.depthStencilTexture)&&Object(u.a)(e.depthStencilRenderbuffer))throw new h.a("Cannot have both a depth-stencil texture and depth-stencil renderbuffer attachment.");var r,a,o,s,c,l=Object(u.a)(e.depthTexture)||Object(u.a)(e.depthRenderbuffer),d=Object(u.a)(e.depthStencilTexture)||Object(u.a)(e.depthStencilRenderbuffer);if(l&&d)throw new h.a("Cannot have both a depth and depth-stencil attachment.");if(Object(u.a)(e.stencilRenderbuffer)&&d)throw new h.a("Cannot have both a stencil and depth-stencil attachment.");if(l&&Object(u.a)(e.stencilRenderbuffer))throw new h.a("Cannot have both a depth and stencil attachment.");if(this._bind(),Object(u.a)(e.colorTextures)){var f=e.colorTextures;if((s=this._colorTextures.length=this._activeColorAttachments.length=f.length)>n)throw new h.a("The number of color attachments exceeds the number supported.");for(o=0;o<s;++o){if(r=f[o],!gx.isColorFormat(r.pixelFormat))throw new h.a("The color-texture pixel-format must be a color format.");if(r.pixelDatatype===mx.FLOAT&&!t.colorBufferFloat)throw new h.a("The color texture pixel datatype is FLOAT and the WebGL implementation does not support the EXT_color_buffer_float or WEBGL_color_buffer_float extensions. See Context.colorBufferFloat.");if(r.pixelDatatype===mx.HALF_FLOAT&&!t.colorBufferHalfFloat)throw new h.a("The color texture pixel datatype is HALF_FLOAT and the WebGL implementation does not support the EXT_color_buffer_half_float extension. See Context.colorBufferHalfFloat.");aj(this,c=this._gl.COLOR_ATTACHMENT0+o,r),this._activeColorAttachments[o]=c,this._colorTextures[o]=r}}if(Object(u.a)(e.colorRenderbuffers)){var p=e.colorRenderbuffers;if((s=this._colorRenderbuffers.length=this._activeColorAttachments.length=p.length)>n)throw new h.a("The number of color attachments exceeds the number supported.");for(o=0;o<s;++o)a=p[o],oj(this,c=this._gl.COLOR_ATTACHMENT0+o,a),this._activeColorAttachments[o]=c,this._colorRenderbuffers[o]=a}if(Object(u.a)(e.depthTexture)){if((r=e.depthTexture).pixelFormat!==gx.DEPTH_COMPONENT)throw new h.a("The depth-texture pixel-format must be DEPTH_COMPONENT.");aj(this,this._gl.DEPTH_ATTACHMENT,r),this._depthTexture=r}if(Object(u.a)(e.depthRenderbuffer)&&(a=e.depthRenderbuffer,oj(this,this._gl.DEPTH_ATTACHMENT,a),this._depthRenderbuffer=a),Object(u.a)(e.stencilRenderbuffer)&&(a=e.stencilRenderbuffer,oj(this,this._gl.STENCIL_ATTACHMENT,a),this._stencilRenderbuffer=a),Object(u.a)(e.depthStencilTexture)){if((r=e.depthStencilTexture).pixelFormat!==gx.DEPTH_STENCIL)throw new h.a("The depth-stencil pixel-format must be DEPTH_STENCIL.");aj(this,this._gl.DEPTH_STENCIL_ATTACHMENT,r),this._depthStencilTexture=r}Object(u.a)(e.depthStencilRenderbuffer)&&(a=e.depthStencilRenderbuffer,oj(this,this._gl.DEPTH_STENCIL_ATTACHMENT,a),this._depthStencilRenderbuffer=a),this._unBind()}rj.textures=new Map,rj.texturesCounter=new Map,rj.getTextures=function(e){if(Object(u.a)(e))return rj.textures.get(e)},rj.setTextures=function(e,t){if(Object(u.a)(e)){var i=rj.textures.get(e);if(Object(u.a)(i)){var n=rj.texturesCounter.get(e);rj.texturesCounter.set(e,n+1)}else rj.textures.set(e,t),rj.texturesCounter.set(e,1)}},rj.destroy=function(e){var t=0;if(Object(u.a)(e)){var i=rj.textures.get(e);if(Object(u.a)(i))(t=rj.texturesCounter.get(e)-1)<=0?(rj.textures.delete(e),rj.texturesCounter.delete(e)):rj.texturesCounter.set(e,t)}return t},rj.destroyAll=function(){rj.textures.forEach((e,t)=>{rj.textures.delete(t),rj.texturesCounter.delete(t)})},Object(O.a)(sj.prototype,{status:{get:function(){this._bind();var e=this._gl.checkFramebufferStatus(this._gl.FRAMEBUFFER);return this._unBind(),e}},numberOfColorAttachments:{get:function(){return this._activeColorAttachments.length}},depthTexture:{get:function(){return this._depthTexture}},depthRenderbuffer:{get:function(){return this._depthRenderbuffer}},stencilRenderbuffer:{get:function(){return this._stencilRenderbuffer}},depthStencilTexture:{get:function(){return this._depthStencilTexture}},depthStencilRenderbuffer:{get:function(){return this._depthStencilRenderbuffer}},hasDepthAttachment:{get:function(){return!!(this.depthTexture||this.depthRenderbuffer||this.depthStencilTexture||this.depthStencilRenderbuffer)}}}),sj.prototype._bind=function(e){var t=this._gl;t.bindFramebuffer(Object(w.a)(e,t.FRAMEBUFFER),this._framebuffer)},sj.prototype._unBind=function(){var e=this._gl;e.bindFramebuffer(e.FRAMEBUFFER,null)},sj.prototype._getActiveColorAttachments=function(){return this._activeColorAttachments},sj.prototype.getColorTexture=function(e){if(!Object(u.a)(e)||e<0||e>=this._colorTextures.length)throw new h.a("index is required, must be greater than or equal to zero and must be less than the number of color attachments.");return this._colorTextures[e]},sj.prototype.getColorRenderbuffer=function(e){if(!Object(u.a)(e)||e<0||e>=this._colorRenderbuffers.length)throw new h.a("index is required, must be greater than or equal to zero and must be less than the number of color attachments.");return this._colorRenderbuffers[e]},sj.prototype.isDestroyed=function(){return!1},sj.prototype.destroy=function(){if(this.destroyAttachments){for(var e=0,t=this._colorTextures,i=t.length;e<i;++e){var n=t[e];Object(u.a)(n)&&n.destroy()}var r=this._colorRenderbuffers;for(i=r.length,e=0;e<i;++e){var a=r[e];Object(u.a)(a)&&a.destroy()}this._depthTexture=this._depthTexture&&this._depthTexture.destroy(),this._depthRenderbuffer=this._depthRenderbuffer&&this._depthRenderbuffer.destroy(),this._stencilRenderbuffer=this._stencilRenderbuffer&&this._stencilRenderbuffer.destroy(),this._depthStencilTexture=this._depthStencilTexture&&this._depthStencilTexture.destroy(),this._depthStencilRenderbuffer=this._depthStencilRenderbuffer&&this._depthStencilRenderbuffer.destroy()}return this._gl.deleteFramebuffer(this._framebuffer),rl(this)};var cj=sj;function lj(e){e=Object(w.a)(e,w.a.EMPTY_OBJECT),x.a.defined("options.context",e.context);var t=e.context,i=e.width,n=e.height,r=e.depth,a=e.source,o=e.path;Object(u.a)(a)&&(Object(u.a)(i)||(i=Object(w.a)(a.videoWidth,a.width)),Object(u.a)(n)||(n=Object(w.a)(a.videoHeight,a.height)));var s=Object(w.a)(e.pixelFormat,gx.RGBA),c=Object(w.a)(e.pixelDatatype,mx.UNSIGNED_BYTE),l=uj(t.webgl2,s,c),d=gx.isCompressedFormat(s);if(!Object(u.a)(i)||!Object(u.a)(n))throw new h.a("options requires a source field to create an initialized texture or width and height fields to create a blank texture.");if(x.a.typeOf.number.greaterThan("width",i,0),i>HD.maximumTextureSize)throw new h.a("Width must be less than or equal to the maximum texture size ("+HD.maximumTextureSize+").  Check maximumTextureSize.");if(x.a.typeOf.number.greaterThan("height",n,0),n>HD.maximumTextureSize)throw new h.a("Height must be less than or equal to the maximum texture size ("+HD.maximumTextureSize+").  Check maximumTextureSize.");if(!gx.validate(s))throw new h.a("Invalid options.pixelFormat.");if(!d&&!mx.validate(c))throw new h.a("Invalid options.pixelDatatype.");if(s===gx.DEPTH_COMPONENT&&c!==mx.UNSIGNED_SHORT&&c!==mx.UNSIGNED_INT)throw new h.a("When options.pixelFormat is DEPTH_COMPONENT, options.pixelDatatype must be UNSIGNED_SHORT or UNSIGNED_INT.");if(s===gx.DEPTH_STENCIL&&c!==mx.UNSIGNED_INT_24_8)throw new h.a("When options.pixelFormat is DEPTH_STENCIL, options.pixelDatatype must be UNSIGNED_INT_24_8.");if(c===mx.FLOAT&&!t.floatingPointTexture)throw new h.a("When options.pixelDatatype is FLOAT, this WebGL implementation must support the OES_texture_float extension.  Check context.floatingPointTexture.");if(c===mx.HALF_FLOAT&&!t.halfFloatingPointTexture)throw new h.a("When options.pixelDatatype is HALF_FLOAT, this WebGL implementation must support the OES_texture_half_float extension. Check context.halfFloatingPointTexture.");if(gx.isDepthFormat(s)){if(Object(u.a)(a))throw new h.a("When options.pixelFormat is DEPTH_COMPONENT or DEPTH_STENCIL, source cannot be provided.");if(!t.depthTexture)throw new h.a("When options.pixelFormat is DEPTH_COMPONENT or DEPTH_STENCIL, this WebGL implementation must support WEBGL_depth_texture.  Check context.depthTexture.")}if(d){if(!Object(u.a)(a)||!Object(u.a)(a.arrayBufferView))throw new h.a("When options.pixelFormat is compressed, options.source.arrayBufferView must be defined.");if(gx.isDXTFormat(l)&&!t.s3tc)throw new h.a("When options.pixelFormat is S3TC compressed, this WebGL implementation must support the WEBGL_texture_compression_s3tc extension. Check context.s3tc.");if(gx.isPVRTCFormat(l)&&!t.pvrtc)throw new h.a("When options.pixelFormat is PVRTC compressed, this WebGL implementation must support the WEBGL_texture_compression_pvrtc extension. Check context.pvrtc.");if(gx.isETC1Format(l)&&!t.etc1)throw new h.a("When options.pixelFormat is ETC1 compressed, this WebGL implementation must support the WEBGL_texture_compression_etc1 extension. Check context.etc1.");if(gx.compressedTextureSizeInBytes(l,i,n)!==a.arrayBufferView.byteLength)throw new h.a("The byte length of the array buffer is invalid for the compressed texture with the given width and height.")}var f=e.preMultiplyAlpha||s===gx.RGB||s===gx.LUMINANCE,p=Object(w.a)(e.flipY,!0),m=!0,_=t._gl,g=_.TEXTURE_2D;Object(u.a)(r)&&(g=_.TEXTURE_3D);var v,b=_.createTexture();if(_.activeTexture(_.TEXTURE0),_.bindTexture(g,b),Object(u.a)(a))if(Object(u.a)(a.arrayBufferView)){_.pixelStorei(_.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),_.pixelStorei(_.UNPACK_FLIP_Y_WEBGL,!1);var y=a.arrayBufferView;if(d)_.compressedTexImage2D(g,0,l,i,n,0,y);else if(p&&(y=gx.flipY(y,s,c,i,n)),Object(u.a)(r)){const e=1;_.pixelStorei(_.UNPACK_ALIGNMENT,e),_.texImage3D(g,0,l,i,n,r,0,s,c,y)}else _.texImage2D(g,0,l,i,n,0,s,c,y)}else Object(u.a)(a.framebuffer)?(_.pixelStorei(_.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),_.pixelStorei(_.UNPACK_FLIP_Y_WEBGL,!1),a.framebuffer!==t.defaultFramebuffer&&a.framebuffer._bind(),_.copyTexImage2D(g,0,l,a.xOffset,a.yOffset,i,n,0),a.framebuffer!==t.defaultFramebuffer&&a.framebuffer._unBind()):(_.pixelStorei(_.UNPACK_PREMULTIPLY_ALPHA_WEBGL,f),_.pixelStorei(_.UNPACK_FLIP_Y_WEBGL,p),_.texImage2D(g,0,l,s,c,a));else _.texImage2D(g,0,l,i,n,0,s,c,null),m=!1;_.bindTexture(g,null),v=d?gx.compressedTextureSizeInBytes(s,i,n):gx.textureSizeInBytes(s,c,i,n),this._id=Mg(),this._context=t,this._textureFilterAnisotropic=t._textureFilterAnisotropic,this._textureTarget=g,this._texture=b,this._pixelFormat=s,this._pixelDatatype=c,this._width=i,this._height=n,this._dimensions=new Rt(i,n),this._hasMipmap=!1,this._sizeInBytes=v,this._preMultiplyAlpha=f,this._flipY=p,this._initialized=m,this._sampler=void 0,this._path=o,this.sampler=Object(u.a)(e.sampler)?e.sampler:new tj}function uj(e,t,i){var n=t;if(e)if(t===gx.DEPTH_STENCIL?n=un.DEPTH24_STENCIL8:t===gx.DEPTH_COMPONENT&&(i===mx.UNSIGNED_SHORT?n=un.DEPTH_COMPONENT16:i===mx.UNSIGNED_INT&&(n=un.DEPTH_COMPONENT24)),i===mx.FLOAT)switch(t){case gx.RGBA:n=un.RGBA32F;break;case gx.RGB:n=un.RGB32F;break;case gx.RG:n=un.RG32F;break;case gx.R:n=un.R32F}else if(i===mx.HALF_FLOAT)switch(t){case gx.RGBA:n=un.RGBA16F;break;case gx.RGB:n=un.RGB16F;break;case gx.RG:n=un.RG16F;break;case gx.R:n=un.R16F}return n}lj.fromFramebuffer=function(e){e=Object(w.a)(e,w.a.EMPTY_OBJECT),x.a.defined("options.context",e.context);var t=e.context,i=t._gl,n=Object(w.a)(e.pixelFormat,gx.RGB),r=Object(w.a)(e.framebufferXOffset,0),a=Object(w.a)(e.framebufferYOffset,0),o=Object(w.a)(e.width,i.drawingBufferWidth),s=Object(w.a)(e.height,i.drawingBufferHeight),c=e.framebuffer;if(!gx.validate(n))throw new h.a("Invalid pixelFormat.");if(gx.isDepthFormat(n)||gx.isCompressedFormat(n))throw new h.a("pixelFormat cannot be DEPTH_COMPONENT, DEPTH_STENCIL or a compressed format.");if(x.a.defined("options.context",e.context),x.a.typeOf.number.greaterThanOrEquals("framebufferXOffset",r,0),x.a.typeOf.number.greaterThanOrEquals("framebufferYOffset",a,0),r+o>i.drawingBufferWidth)throw new h.a("framebufferXOffset + width must be less than or equal to drawingBufferWidth");if(a+s>i.drawingBufferHeight)throw new h.a("framebufferYOffset + height must be less than or equal to drawingBufferHeight.");return new lj({context:t,width:o,height:s,pixelFormat:n,source:{framebuffer:Object(u.a)(c)?c:t.defaultFramebuffer,xOffset:r,yOffset:a,width:o,height:s}})},Object(O.a)(lj.prototype,{id:{get:function(){return this._id}},sampler:{get:function(){return this._sampler},set:function(e){var t=e.minificationFilter,i=e.magnificationFilter,n=t===KD.NEAREST_MIPMAP_NEAREST||t===KD.NEAREST_MIPMAP_LINEAR||t===KD.LINEAR_MIPMAP_NEAREST||t===KD.LINEAR_MIPMAP_LINEAR,r=this._context,a=this._pixelDatatype;(a===mx.FLOAT&&!r.textureFloatLinear||a===mx.HALF_FLOAT&&!r.textureHalfFloatLinear)&&(t=n?KD.NEAREST_MIPMAP_NEAREST:KD.NEAREST,i=ZD.NEAREST);var o=r._gl,s=this._textureTarget;o.activeTexture(o.TEXTURE0),o.bindTexture(s,this._texture),o.texParameteri(s,o.TEXTURE_MIN_FILTER,t),o.texParameteri(s,o.TEXTURE_MAG_FILTER,i),o.texParameteri(s,o.TEXTURE_WRAP_S,e.wrapS),o.texParameteri(s,o.TEXTURE_WRAP_T,e.wrapT),Object(u.a)(this._textureFilterAnisotropic)&&o.texParameteri(s,this._textureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,e.maximumAnisotropy),o.bindTexture(s,null),this._sampler=e}},pixelFormat:{get:function(){return this._pixelFormat}},pixelDatatype:{get:function(){return this._pixelDatatype}},dimensions:{get:function(){return this._dimensions}},preMultiplyAlpha:{get:function(){return this._preMultiplyAlpha}},flipY:{get:function(){return this._flipY}},width:{get:function(){return this._width}},height:{get:function(){return this._height}},sizeInBytes:{get:function(){return this._hasMipmap?Math.floor(4*this._sizeInBytes/3):this._sizeInBytes}},_target:{get:function(){return this._textureTarget}}}),lj.prototype.copyFrom=function(e,t,i){if(t=Object(w.a)(t,0),i=Object(w.a)(i,0),x.a.defined("source",e),gx.isDepthFormat(this._pixelFormat))throw new h.a("Cannot call copyFrom when the texture pixel format is DEPTH_COMPONENT or DEPTH_STENCIL.");if(gx.isCompressedFormat(this._pixelFormat))throw new h.a("Cannot call copyFrom with a compressed texture pixel format.");x.a.typeOf.number.greaterThanOrEquals("xOffset",t,0),x.a.typeOf.number.greaterThanOrEquals("yOffset",i,0),x.a.typeOf.number.lessThanOrEquals("xOffset + source.width",t+e.width,this._width),x.a.typeOf.number.lessThanOrEquals("yOffset + source.height",i+e.height,this._height);var n=this._context._gl,r=this._textureTarget;n.activeTexture(n.TEXTURE0),n.bindTexture(r,this._texture);var a=e.width,o=e.height,s=e.arrayBufferView,c=this._width,l=this._height,d=this._pixelFormat,f=this._pixelDatatype,p=uj(this._context.webgl2,d,f),m=this._preMultiplyAlpha,_=this._flipY,g=!1;if(!this._initialized){if(0===t&&0===i&&a===c&&o===l)Object(u.a)(s)?(n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,!1),_&&(s=gx.flipY(s,d,f,c,l)),n.texImage2D(r,0,p,c,l,0,d,f,s)):(n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,m),n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,_),n.texImage2D(r,0,p,d,f,e)),g=!0;else{n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,!1);var v=gx.createTypedArray(d,f,c,l);n.texImage2D(r,0,p,c,l,0,d,f,v)}this._initialized=!0}g||(s?(n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,!1),_&&(s=gx.flipY(s,d,f,a,o)),n.texSubImage2D(r,0,t,i,a,o,d,f,s)):(n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,m),n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,_),n.texSubImage2D(r,0,t,i,d,f,e))),n.bindTexture(r,null)},lj.prototype.copyFromFramebuffer=function(e,t,i,n,r,a){if(e=Object(w.a)(e,0),t=Object(w.a)(t,0),i=Object(w.a)(i,0),n=Object(w.a)(n,0),r=Object(w.a)(r,this._width),a=Object(w.a)(a,this._height),gx.isDepthFormat(this._pixelFormat))throw new h.a("Cannot call copyFromFramebuffer when the texture pixel format is DEPTH_COMPONENT or DEPTH_STENCIL.");if(this._pixelDatatype===mx.FLOAT)throw new h.a("Cannot call copyFromFramebuffer when the texture pixel data type is FLOAT.");if(this._pixelDatatype===mx.HALF_FLOAT)throw new h.a("Cannot call copyFromFramebuffer when the texture pixel data type is HALF_FLOAT.");if(gx.isCompressedFormat(this._pixelFormat))throw new h.a("Cannot call copyFrom with a compressed texture pixel format.");x.a.typeOf.number.greaterThanOrEquals("xOffset",e,0),x.a.typeOf.number.greaterThanOrEquals("yOffset",t,0),x.a.typeOf.number.greaterThanOrEquals("framebufferXOffset",i,0),x.a.typeOf.number.greaterThanOrEquals("framebufferYOffset",n,0),x.a.typeOf.number.lessThanOrEquals("xOffset + width",e+r,this._width),x.a.typeOf.number.lessThanOrEquals("yOffset + height",t+a,this._height);var o=this._context._gl,s=this._textureTarget;o.activeTexture(o.TEXTURE0),o.bindTexture(s,this._texture),o.copyTexSubImage2D(s,0,e,t,i,n,r,a),o.bindTexture(s,null),this._initialized=!0},lj.prototype.generateMipmap=function(e){if(e=Object(w.a)(e,YD.DONT_CARE),gx.isDepthFormat(this._pixelFormat))throw new h.a("Cannot call generateMipmap when the texture pixel format is DEPTH_COMPONENT or DEPTH_STENCIL.");if(gx.isCompressedFormat(this._pixelFormat))throw new h.a("Cannot call generateMipmap with a compressed pixel format.");if(this._width>1&&!I.isPowerOfTwo(this._width))throw new h.a("width must be a power of two to call generateMipmap().");if(this._height>1&&!I.isPowerOfTwo(this._height))throw new h.a("height must be a power of two to call generateMipmap().");if(!YD.validate(e))throw new h.a("hint is invalid.");this._hasMipmap=!0;var t=this._context._gl,i=this._textureTarget;t.hint(t.GENERATE_MIPMAP_HINT,e),t.activeTexture(t.TEXTURE0),t.bindTexture(i,this._texture),t.generateMipmap(i),t.bindTexture(i,null)},lj.prototype.updateTexture=function(e){var t,i=this._context._gl,n=this._texture;return i.bindTexture(i.TEXTURE_2D,n),i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,this._flipY),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,e),t=i.getError(),i.bindTexture(i.TEXTURE_2D,null),t!==i.INVALID_VALUE},lj.prototype.getPixel=function(e,t,i,n){var r=new cj({context:this._context,colorTextures:[this],destroyAttachments:!1}),a=this._context.getPixel(r,e,this.height-t-1,i,n);return r.destroy(),a},lj.prototype.isDestroyed=function(){return!1},lj.prototype.destroy=function(){if(Object(u.a)(this._path)&&rj.destroy(this._path)>0)return;return this._context._gl.deleteTexture(this._texture),rl(this)};var hj=lj,dj="uniform sampler2D image;\nuniform float strength;\nuniform vec2 repeat;\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material = czm_getDefaultMaterial(materialInput);\nvec2 st = materialInput.st;\nvec2 centerPixel = fract(repeat * st);\nfloat centerBump = texture2D(image, centerPixel).channel;\nfloat imageWidth = float(imageDimensions.x);\nvec2 rightPixel = fract(repeat * (st + vec2(1.0 / imageWidth, 0.0)));\nfloat rightBump = texture2D(image, rightPixel).channel;\nfloat imageHeight = float(imageDimensions.y);\nvec2 leftPixel = fract(repeat * (st + vec2(0.0, 1.0 / imageHeight)));\nfloat topBump = texture2D(image, leftPixel).channel;\nvec3 normalTangentSpace = normalize(vec3(centerBump - rightBump, centerBump - topBump, clamp(1.0 - strength, 0.1, 1.0)));\nvec3 normalEC = materialInput.tangentToEyeMatrix * normalTangentSpace;\nmaterial.normal = normalEC;\nmaterial.diffuse = vec3(0.01);\nreturn material;\n}\n",fj="uniform vec4 lightColor;\nuniform vec4 darkColor;\nuniform vec2 repeat;\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material = czm_getDefaultMaterial(materialInput);\nvec2 st = materialInput.st;\nfloat b = mod(floor(repeat.s * st.s) + floor(repeat.t * st.t), 2.0);\nfloat scaledWidth = fract(repeat.s * st.s);\nscaledWidth = abs(scaledWidth - floor(scaledWidth + 0.5));\nfloat scaledHeight = fract(repeat.t * st.t);\nscaledHeight = abs(scaledHeight - floor(scaledHeight + 0.5));\nfloat value = min(scaledWidth, scaledHeight);\nvec4 currentColor = mix(lightColor, darkColor, b);\nvec4 color = czm_antialias(lightColor, darkColor, currentColor, value, 0.03);\ncolor = czm_gammaCorrect(color);\nmaterial.diffuse = color.rgb;\nmaterial.alpha = color.a;\nreturn material;\n}\n",pj="uniform vec4 lightColor;\nuniform vec4 darkColor;\nuniform vec2 repeat;\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material = czm_getDefaultMaterial(materialInput);\nfloat b = smoothstep(0.3, 0.32, length(fract(repeat * materialInput.st) - 0.5));\nvec4 color = mix(lightColor, darkColor, b);\ncolor = czm_gammaCorrect(color);\nmaterial.diffuse = color.rgb;\nmaterial.alpha = color.a;\nreturn material;\n}\n",mj="#ifdef GL_OES_standard_derivatives\n#extension GL_OES_standard_derivatives : enable\n#endif\nuniform vec4 color;\nuniform float spacing;\nuniform float width;\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material = czm_getDefaultMaterial(materialInput);\nfloat distanceToContour = mod(materialInput.height, spacing);\n#ifdef GL_OES_standard_derivatives\nfloat dxc = abs(dFdx(materialInput.height));\nfloat dyc = abs(dFdy(materialInput.height));\nfloat dF = max(dxc, dyc) * width;\nfloat alpha = (distanceToContour < dF) ? 1.0 : 0.0;\n#else\nfloat alpha = (distanceToContour < (czm_resolutionScale * width)) ? 1.0 : 0.0;\n#endif\nvec4 outColor = czm_gammaCorrect(vec4(color.rgb, alpha));\nmaterial.diffuse = outColor.rgb;\nmaterial.alpha = outColor.a;\nreturn material;\n}\n",_j="uniform sampler2D image;\nuniform float minimumHeight;\nuniform float maximumHeight;\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material = czm_getDefaultMaterial(materialInput);\nfloat scaledHeight = clamp((materialInput.height - minimumHeight) / (maximumHeight - minimumHeight), 0.0, 1.0);\nvec4 rampColor = texture2D(image, vec2(scaledHeight, 0.5));\nrampColor = czm_gammaCorrect(rampColor);\nmaterial.diffuse = rampColor.rgb;\nmaterial.alpha = rampColor.a;\nreturn material;\n}\n",gj="uniform vec4 fadeInColor;\nuniform vec4 fadeOutColor;\nuniform float maximumDistance;\nuniform bool repeat;\nuniform vec2 fadeDirection;\nuniform vec2 time;\nfloat getTime(float t, float coord)\n{\nfloat scalar = 1.0 / maximumDistance;\nfloat q  = distance(t, coord) * scalar;\nif (repeat)\n{\nfloat r = distance(t, coord + 1.0) * scalar;\nfloat s = distance(t, coord - 1.0) * scalar;\nq = min(min(r, s), q);\n}\nreturn clamp(q, 0.0, 1.0);\n}\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material = czm_getDefaultMaterial(materialInput);\nvec2 st = materialInput.st;\nfloat s = getTime(time.x, st.s) * fadeDirection.s;\nfloat t = getTime(time.y, st.t) * fadeDirection.t;\nfloat u = length(vec2(s, t));\nvec4 color = mix(fadeInColor, fadeOutColor, u);\ncolor = czm_gammaCorrect(color);\nmaterial.emission = color.rgb;\nmaterial.alpha = color.a;\nreturn material;\n}\n",vj="#ifdef GL_OES_standard_derivatives\n#extension GL_OES_standard_derivatives : enable\n#endif\nuniform vec4 color;\nuniform float cellAlpha;\nuniform vec2 lineCount;\nuniform vec2 lineThickness;\nuniform vec2 lineOffset;\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material = czm_getDefaultMaterial(materialInput);\nvec2 st = materialInput.st;\nfloat scaledWidth = fract(lineCount.s * st.s - lineOffset.s);\nscaledWidth = abs(scaledWidth - floor(scaledWidth + 0.5));\nfloat scaledHeight = fract(lineCount.t * st.t - lineOffset.t);\nscaledHeight = abs(scaledHeight - floor(scaledHeight + 0.5));\nfloat value;\n#ifdef GL_OES_standard_derivatives\nconst float fuzz = 1.2;\nvec2 thickness = (lineThickness * czm_resolutionScale) - 1.0;\nvec2 dx = abs(dFdx(st));\nvec2 dy = abs(dFdy(st));\nvec2 dF = vec2(max(dx.s, dy.s), max(dx.t, dy.t)) * lineCount;\nvalue = min(\nsmoothstep(dF.s * thickness.s, dF.s * (fuzz + thickness.s), scaledWidth),\nsmoothstep(dF.t * thickness.t, dF.t * (fuzz + thickness.t), scaledHeight));\n#else\nconst float fuzz = 0.05;\nvec2 range = 0.5 - (lineThickness * 0.05);\nvalue = min(\n1.0 - smoothstep(range.s, range.s + fuzz, scaledWidth),\n1.0 - smoothstep(range.t, range.t + fuzz, scaledHeight));\n#endif\nfloat dRim = 1.0 - abs(dot(materialInput.normalEC, normalize(materialInput.positionToEyeEC)));\nfloat sRim = smoothstep(0.8, 1.0, dRim);\nvalue *= (1.0 - sRim);\nvec4 halfColor;\nhalfColor.rgb = color.rgb * 0.5;\nhalfColor.a = color.a * (1.0 - ((1.0 - cellAlpha) * value));\nhalfColor = czm_gammaCorrect(halfColor);\nmaterial.diffuse = halfColor.rgb;\nmaterial.emission = halfColor.rgb;\nmaterial.alpha = halfColor.a;\nreturn material;\n}\n",bj="uniform sampler2D image;\nuniform float strength;\nuniform vec2 repeat;\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material = czm_getDefaultMaterial(materialInput);\nvec4 textureValue = texture2D(image, fract(repeat * materialInput.st));\nvec3 normalTangentSpace = textureValue.channels;\nnormalTangentSpace.xy = normalTangentSpace.xy * 2.0 - 1.0;\nnormalTangentSpace.z = clamp(1.0 - strength, 0.1, 1.0);\nnormalTangentSpace = normalize(normalTangentSpace);\nvec3 normalEC = materialInput.tangentToEyeMatrix * normalTangentSpace;\nmaterial.normal = normalEC;\nreturn material;\n}\n",yj="#ifdef GL_OES_standard_derivatives\n#extension GL_OES_standard_derivatives : enable\n#endif\nuniform vec4 color;\nvarying float v_width;\nfloat getPointOnLine(vec2 p0, vec2 p1, float x)\n{\nfloat slope = (p0.y - p1.y) / (p0.x - p1.x);\nreturn slope * (x - p0.x) + p0.y;\n}\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material = czm_getDefaultMaterial(materialInput);\nvec2 st = materialInput.st;\n#ifdef GL_OES_standard_derivatives\nfloat base = 1.0 - abs(fwidth(st.s)) * 10.0;\n#else\nfloat base = 0.99;\n#endif\nvec2 center = vec2(1.0, 0.5);\nfloat ptOnUpperLine = getPointOnLine(vec2(base, 1.0), center, st.s);\nfloat ptOnLowerLine = getPointOnLine(vec2(base, 0.0), center, st.s);\nfloat halfWidth = 0.15;\nfloat s = step(0.5 - halfWidth, st.t);\ns *= 1.0 - step(0.5 + halfWidth, st.t);\ns *= 1.0 - step(base, st.s);\nfloat t = step(base, materialInput.st.s);\nt *= 1.0 - step(ptOnUpperLine, st.t);\nt *= step(ptOnLowerLine, st.t);\nfloat dist;\nif (st.s < base)\n{\nfloat d1 = abs(st.t - (0.5 - halfWidth));\nfloat d2 = abs(st.t - (0.5 + halfWidth));\ndist = min(d1, d2);\n}\nelse\n{\nfloat d1 = czm_infinity;\nif (st.t < 0.5 - halfWidth && st.t > 0.5 + halfWidth)\n{\nd1 = abs(st.s - base);\n}\nfloat d2 = abs(st.t - ptOnUpperLine);\nfloat d3 = abs(st.t - ptOnLowerLine);\ndist = min(min(d1, d2), d3);\n}\nvec4 outsideColor = vec4(0.0);\nvec4 currentColor = mix(outsideColor, color, clamp(s + t, 0.0, 1.0));\nvec4 outColor = czm_antialias(outsideColor, color, currentColor, dist);\noutColor = czm_gammaCorrect(outColor);\nmaterial.diffuse = outColor.rgb;\nmaterial.alpha = outColor.a;\nreturn material;\n}\n",wj="uniform vec4 color;\nuniform vec4 gapColor;\nuniform float dashLength;\nuniform float dashPattern;\nvarying float v_polylineAngle;\nconst float maskLength = 16.0;\nmat2 rotate(float rad) {\nfloat c = cos(rad);\nfloat s = sin(rad);\nreturn mat2(\nc, s,\n-s, c\n);\n}\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material = czm_getDefaultMaterial(materialInput);\nvec2 pos = rotate(v_polylineAngle) * gl_FragCoord.xy;\nfloat dashPosition = fract(pos.x / dashLength);\nfloat maskIndex = floor(dashPosition * maskLength);\nfloat maskTest = floor(dashPattern / pow(2.0, maskIndex));\nvec4 fragColor = (mod(maskTest, 2.0) < 1.0) ? gapColor : color;\nif (fragColor.a < 0.005) {\ndiscard;\n}\nfragColor = czm_gammaCorrect(fragColor);\nmaterial.emission = fragColor.rgb;\nmaterial.alpha = fragColor.a;\nreturn material;\n}\n",Oj="uniform vec4 color;\nuniform vec4 oddColor;\nuniform bool animat;\nuniform bool gradual;\nuniform vec4 gapColor;\nuniform float dashLength;\nuniform float dashPattern;\nuniform float speed;\nvarying float v_polylineAngle;\nconst float maskLength = 16.0;\nmat2 rotate(float rad) {\nfloat c = cos(rad);\nfloat s = sin(rad);\nreturn mat2(\nc, s,\n-s, c\n);\n}\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material = czm_getDefaultMaterial(materialInput);\nvec2 pos = rotate(v_polylineAngle) * gl_FragCoord.xy;\nif(animat){\npos.x -= czm_frameNumber * speed;\n}\nfloat dashPosition = fract(pos.x / dashLength);\nfloat maskIndex = floor(dashPosition * maskLength);\nfloat maskTest = floor(dashPattern / pow(2.0, maskIndex));\nfloat coord = mix(materialInput.st.s, materialInput.st.t, 0.0);\nvec4 outColor = vec4(0.0);\nif(gradual){\noutColor = oddColor * coord+ (1.0 - coord) * color;\n}else{\noutColor = color;\n}\nvec4 fragColor = (mod(maskTest, 2.0) < 1.0) ? gapColor : outColor;\nif (fragColor.a < 0.005) {\ndiscard;\n}\nmaterial.emission = fragColor.rgb;\nmaterial.alpha = fragColor.a;\nreturn material;\n}\n",xj="uniform vec4 color;\nuniform float glowPower;\nvarying float v_width;\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material = czm_getDefaultMaterial(materialInput);\nvec2 st = materialInput.st;\nfloat glow = glowPower / abs(st.t - 0.5) - (glowPower / 0.5);\nvec4 fragColor;\nfragColor.rgb = max(vec3(glow - 1.0 + color.rgb), color.rgb);\nfragColor.a = clamp(0.0, 1.0, glow) * color.a;\nfragColor = czm_gammaCorrect(fragColor);\nmaterial.emission = fragColor.rgb;\nmaterial.alpha = fragColor.a;\nreturn material;\n}\n",Ej="uniform vec4 color;\nuniform vec4 outlineColor;\nuniform float outlineWidth;\nvarying float v_width;\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material = czm_getDefaultMaterial(materialInput);\nvec2 st = materialInput.st;\nfloat halfInteriorWidth =  0.5 * (v_width - outlineWidth) / v_width;\nfloat b = step(0.5 - halfInteriorWidth, st.t);\nb *= 1.0 - step(0.5 + halfInteriorWidth, st.t);\nfloat d1 = abs(st.t - (0.5 - halfInteriorWidth));\nfloat d2 = abs(st.t - (0.5 + halfInteriorWidth));\nfloat dist = min(d1, d2);\nvec4 currentColor = mix(outlineColor, color, b);\nvec4 outColor = czm_antialias(outlineColor, color, currentColor, dist);\noutColor = czm_gammaCorrect(outColor);\nmaterial.diffuse = outColor.rgb;\nmaterial.alpha = outColor.a;\nreturn material;\n}\n",Tj="uniform vec4 color;\nuniform vec4 rimColor;\nuniform float width;\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material = czm_getDefaultMaterial(materialInput);\nfloat d = 1.0 - dot(materialInput.normalEC, normalize(materialInput.positionToEyeEC));\nfloat s = smoothstep(1.0 - width, 1.0, d);\nvec4 outColor = czm_gammaCorrect(color);\nvec4 outRimColor = czm_gammaCorrect(rimColor);\nmaterial.diffuse = outColor.rgb;\nmaterial.emission = outRimColor.rgb * s;\nmaterial.alpha = mix(outColor.a, outRimColor.a, s);\nreturn material;\n}\n",Cj="uniform sampler2D image;\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material = czm_getDefaultMaterial(materialInput);\nvec4 rampColor = texture2D(image, vec2(materialInput.slope, 0.5));\nrampColor = czm_gammaCorrect(rampColor);\nmaterial.diffuse = rampColor.rgb;\nmaterial.alpha = rampColor.a;\nreturn material;\n}\n",Sj="uniform vec4 evenColor;\nuniform vec4 oddColor;\nuniform float offset;\nuniform float repeat;\nuniform bool horizontal;\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material = czm_getDefaultMaterial(materialInput);\nfloat coord = mix(materialInput.st.s, materialInput.st.t, float(horizontal));\nfloat value = fract((coord - offset) * (repeat * 0.5));\nfloat dist = min(value, min(abs(value - 0.5), 1.0 - value));\nvec4 currentColor = mix(evenColor, oddColor, step(0.5, value));\nvec4 color = czm_antialias(evenColor, oddColor, currentColor, dist);\ncolor = czm_gammaCorrect(color);\nmaterial.diffuse = color.rgb;\nmaterial.alpha = color.a;\nreturn material;\n}\n",Aj="uniform sampler2D specularMap;\nuniform sampler2D normalMap;\nuniform vec4 baseWaterColor;\nuniform vec4 blendColor;\nuniform float frequency;\nuniform float animationSpeed;\nuniform float amplitude;\nuniform float specularIntensity;\nuniform float fadeFactor;\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material = czm_getDefaultMaterial(materialInput);\nfloat time = czm_frameNumber * animationSpeed;\nfloat fade = max(1.0, (length(materialInput.positionToEyeEC) / 10000000000.0) * frequency * fadeFactor);\nfloat specularMapValue = texture2D(specularMap, materialInput.st).r;\nvec4 noise = czm_getWaterNoise(normalMap, materialInput.st * frequency, time, 0.0);\nvec3 normalTangentSpace = noise.xyz * vec3(1.0, 1.0, (1.0 / amplitude));\nnormalTangentSpace.xy /= fade;\nnormalTangentSpace = mix(vec3(0.0, 0.0, 50.0), normalTangentSpace, specularMapValue);\nnormalTangentSpace = normalize(normalTangentSpace);\nfloat tsPerturbationRatio = clamp(dot(normalTangentSpace, vec3(0.0, 0.0, 1.0)), 0.0, 1.0);\nmaterial.alpha = specularMapValue;\nmaterial.diffuse = mix(blendColor.rgb, baseWaterColor.rgb, specularMapValue);\nmaterial.diffuse += (0.1 * tsPerturbationRatio);\nmaterial.diffuse = material.diffuse;\nmaterial.normal = normalize(materialInput.tangentToEyeMatrix * normalTangentSpace);\nmaterial.specular = specularIntensity;\nmaterial.shininess = 10.0;\nreturn material;\n}\n",Pj="uniform vec4 evenColor;\nuniform vec4 oddColor;\nuniform bool horizontal;\nvarying float v_width;\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material = czm_getDefaultMaterial(materialInput);\nvec2 st = materialInput.st;\nfloat halfInteriorWidth =  0.5 * (v_width - 1.8) / v_width;\nfloat b = step(0.5 - halfInteriorWidth, st.t);\nb *= 1.0 - step(0.5 + halfInteriorWidth, st.t);\nfloat d1 = abs(st.t - (0.5 - halfInteriorWidth));\nfloat d2 = abs(st.t - (0.5 + halfInteriorWidth));\nfloat dist = min(d1, d2);\nfloat coord = mix(materialInput.st.s, materialInput.st.t, float(horizontal));\nvec4 color = oddColor *coord + (1.0-coord)*evenColor;\nfloat alpha = 0.0;\nalpha =1.0- (1.0-coord)*1.0;\nvec4 currentColor = mix(vec4(1.0,0.0,0.0,1.0), color, b);\nvec4 outColor = czm_antialias(vec4(1.0,0.0,0.0,1.0), color, currentColor, dist);\nmaterial.diffuse = outColor.rgb;\nmaterial.alpha =alpha;\nreturn material;\n}\n",Ij="uniform vec4 color;\nuniform bool m_XDirection;\nvec4 RadarPing(in vec2 uv, in vec2 center, in float innerTail,\nin float frontierBorder, in float timeResetSeconds,\nin float radarPingSpeed, in float fadeDistance)\n{\nvec2 diff = center-uv;\nfloat r = length(diff);\nfloat time = mod(czm_frameNumber, timeResetSeconds) * radarPingSpeed;\nfloat circle = 0.0;\ncircle += smoothstep(time - innerTail, time, r) * smoothstep(time + frontierBorder,time, r);\ncircle *= smoothstep(fadeDistance, 0.0, r);\nfloat alpha = 0.0;\nif(circle>0.5){\nalpha = 1.0;\n}else{\nalpha = 0.0;\n}\nreturn vec4(circle,circle,circle,alpha);\n}\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material = czm_getDefaultMaterial(materialInput);\nvec2 tc;\nif (m_XDirection) {\ntc = vec2(tc.y, tc.x);\n} else {\ntc = materialInput.st.yx;\n}\nvec2 uv = tc * 2. - 1.;\nuv = uv.xy * 2.0;\nfloat fadeDistance = 0.0;\nfloat resetTimeSec = 110.0;\nfloat radarPingSpeed = 0.01;\nvec2 greenPing = vec2(0.0, 0.0);\nvec4 col = vec4(0.0);\nif (distance(uv, vec2(0.0)) > 1.0) {\ndiscard;\n}\ncol += RadarPing(uv, greenPing,  0.1, 0.0025, resetTimeSec, radarPingSpeed, fadeDistance) * color;\nmaterial.diffuse = col.xyz;\nmaterial.alpha = col.a;\nreturn material;\n}\n",Dj="#ifdef GL_OES_standard_derivatives\n#extension GL_OES_standard_derivatives : enable\n#endif\nuniform sampler2D fluxMap;\nuniform bool reverse;\nfloat rand(float n){\nreturn fract(sin(n) * 43758.5453123);\n}\nfloat noise(float p){\nfloat fl = floor(p);\nfloat fc = fract(p);\nreturn mix(rand(fl), rand(fl + 1.0), fc);\n}\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material = czm_getDefaultMaterial(materialInput);\nvec2 st = materialInput.st;\nif(!reverse){\nst.x += czm_frameNumber * 0.005;\n}else{\nst.x -= czm_frameNumber * 0.005;\n}\nst.x -= floor(st.x);\nvec4 uvColor = texture2D(fluxMap, st);\nfloat value = 1.0;\nfloat flicker = 1.0;\nflicker = clamp(noise(czm_frameNumber * 0.2), 0.65, 1.0);\nmaterial.diffuse = uvColor.rgb;\nmaterial.emission = uvColor.rgb;\nmaterial.alpha = 0.6 * (value)*flicker;\nreturn material;\n}\n",jj="uniform vec4 color;\nuniform float speed;\nuniform bool m_XDirection;\n#define AA 1.0\nconst float tau =atan(1.)*8.;\nhighp float hash(float x) {\nreturn fract(sin(x)*43758.5453);\n}\nhighp float rand(vec2 co) {\nreturn fract(sin(mod(dot(co.xy ,vec2(12.9898,78.233)),3.14))*43758.5453);\n}\nfloat mark(int n,float ang2,vec2 uv,float mn,float mx,float y){\nfloat aa=float(AA)/y;\nang2-=tau/float(n)/2.;\nreturn smoothstep(mn,mx,distance(uv,vec2(0)))*smoothstep(aa*2.,0.,abs(fract(ang2/tau*float(n))-0.5)/float(n)*tau*distance(uv,vec2(0)));\n}\nfloat circle(float dist,vec2 uv,float y){\nfloat aa=float(AA)/y;\nreturn (smoothstep(dist-aa*2.,dist-aa,distance(uv,vec2(0)))-smoothstep(dist,dist+aa,distance(uv,vec2(0))))/10.;\n}\nfloat point(vec2 coord,vec2 uv,float ang,float y){\nfloat aa=float(AA)/y;\nreturn smoothstep(0.004+aa,0.002,distance(uv,coord))*smoothstep(tau*0.7,0.,ang)/2.;\n}\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material = czm_getDefaultMaterial(materialInput);\nvec2 tc;\nif (m_XDirection) {\ntc = vec2(tc.y, tc.x);\n} else {\ntc = materialInput.st.yx;\n}\nvec2 uv = tc * 2. - 1.;\nfloat aa=  float(AA)/czm_viewport.w;\nfloat dist=distance(uv,vec2(0));\nif(dist > 0.5){\ndiscard;\n}\nfloat sdist=smoothstep(0.5+aa,0.5,dist);\nfloat ang=czm_frameNumber*speed*tau/5.;\nfloat ang2=atan(uv.x,uv.y);\nang=mod(ang2+ang,tau);\nfloat col=smoothstep(1.,0.,ang);\ncol/=2.;\ncol+=smoothstep(tau-aa/distance(uv,vec2(0.)),tau,ang)/2.;\ncol+=sdist/10.;\ncol+=smoothstep(aa,0.,abs(uv.x))/4.;\ncol+=smoothstep(aa,0.,abs(uv.y))/4.;\ncol+=circle(0.1,uv,czm_viewport.w);\ncol+=circle(0.2,uv,czm_viewport.w);\ncol+=circle(0.3,uv,czm_viewport.w);\ncol+=circle(0.4,uv,czm_viewport.w);\nvec4 outcol =color * col;\nfloat l=cos(uv.y);\nl*=l;\nl/=3.;\nl+=0.6+rand(uv*czm_frameNumber*speed);\noutcol*=l;\nmaterial.diffuse = outcol.xyz;\nmaterial.alpha = color.a;\nreturn material;\n}\n",Mj="uniform sampler2D fluxMap;\nuniform bool direction;\nuniform float speed;\nuniform float m_Sample;\nuniform float factor;\nuniform vec4 color;\nuniform vec2 offset;\nfloat rand(float n){\nreturn fract(sin(n) * 43758.5453123);\n}\nfloat noise(float p){\nfloat fl = floor(p);\nfloat fc = fract(p);\nreturn mix(rand(fl), rand(fl + 1.0), fc);\n}\nczm_material czm_getMaterial(czm_materialInput materialInput)\n{\nczm_material material = czm_getDefaultMaterial(materialInput);\nvec2 st = materialInput.st;\nvec2 tc;\nfloat sudo = czm_frameNumber * speed;\nif (direction) {\ntc = vec2(st.x + offset.x,st.y + offset.y);\n} else {\ntc = vec2(1.0-st.x+ offset.x,st.y+ offset.y);\n}\ntc.x *= factor;\nvec2 uv = tc;\nuv.x += sudo;\nuv.x = uv.x * m_Sample - floor(uv.x * m_Sample);\nuv.x -= floor(uv.x);\nvec4 uvColor = texture2D(fluxMap,uv);\nif(uvColor.a < 0.9){\nuvColor = color;\n}\nfloat dRim = 1.0 - abs(dot(materialInput.normalEC, normalize(materialInput.positionToEyeEC)));\nfloat sRim = smoothstep(0.8, 1.0, dRim);\nfloat value = 1.0;\nvalue *= (1.0 - sRim);\nfloat flicker = 1.0;\nmaterial.diffuse =uvColor.rgb;\nmaterial.alpha = 0.6 * (value)*flicker;\nreturn material;\n}\n";function Rj(e){this.type=void 0,this.shaderSource=void 0,this.materials=void 0,this.uniforms=void 0,this._uniforms=void 0,this.translucent=void 0,this._strict=void 0,this._template=void 0,this._count=void 0,this._texturePaths={},this._loadedImages=[],this._loadedCubeMaps=[],this._textures={},this._updateFunctions=[],this._defaultTexture=void 0,function(e,t){var i;e=Object(w.a)(e,w.a.EMPTY_OBJECT),t._strict=Object(w.a)(e.strict,!1),t._count=Object(w.a)(e.count,0),t._template=Object(nf.a)(Object(w.a)(e.fabric,w.a.EMPTY_OBJECT)),t._template.uniforms=Object(nf.a)(Object(w.a)(t._template.uniforms,w.a.EMPTY_OBJECT)),t._template.materials=Object(nf.a)(Object(w.a)(t._template.materials,w.a.EMPTY_OBJECT)),t.type=Object(u.a)(t._template.type)?t._template.type:Mg(),t.shaderSource="",t.materials={},t.uniforms={},t._uniforms={},t._translucentFunctions=[];var n=Rj._materialCache.getMaterial(t.type);if(Object(u.a)(n)){var r=Object(nf.a)(n.fabric,!0);t._template=Object(ff.a)(t._template,r,!0),i=n.translucent}(function(e){var t=e._template,i=t.uniforms,n=t.materials,r=t.components;if(Object(u.a)(r)&&Object(u.a)(t.source))throw new h.a("fabric: cannot have source and components in the same template.");Lj(t,kj,Nj,!0),Lj(r,Bj,Nj,!0);var a=[];for(var o in n)n.hasOwnProperty(o)&&a.push(o);Lj(i,a,Fj,!1)})(t),Object(u.a)(n)||Rj._materialCache.addMaterial(t.type,t);(function(e){var t=e._template.components,i=e._template.source;if(Object(u.a)(i))e.shaderSource+=i+"\n";else{if(e.shaderSource+="czm_material czm_getMaterial(czm_materialInput materialInput)\n{\n",e.shaderSource+="czm_material material = czm_getDefaultMaterial(materialInput);\n",Object(u.a)(t))for(var n in t)t.hasOwnProperty(n)&&(e.shaderSource+="diffuse"===n||"emission"===n?"material."+n+" = czm_gammaCorrect("+t[n]+"); \n":"alpha"===n?"material.alpha = czm_gammaCorrect(vec4(vec3(0.0), "+t.alpha+")).a; \n":"material."+n+" = "+t[n]+";\n");e.shaderSource+="return material;\n}\n"}})(t),function(e){var t=e._template.uniforms;for(var i in t)t.hasOwnProperty(i)&&Hj(e,i)}(t),function(e){var t=e._strict,i=e._template.materials;for(var n in i)if(i.hasOwnProperty(n)){var r=new Rj({strict:t,fabric:i[n],count:e._count});e._count=r._count,e._uniforms=Object(ff.a)(e._uniforms,r._uniforms,!0),e.materials[n]=r,e._translucentFunctions=e._translucentFunctions.concat(r._translucentFunctions);var a="czm_getMaterial_"+e._count++;if(Gj(r,"czm_getMaterial",a),e.shaderSource=r.shaderSource+e.shaderSource,0===Gj(e,n,a+"(materialInput)")&&t)throw new h.a("strict: shader source does not use material '"+n+"'.")}}(t);var a=0===t._translucentFunctions.length||void 0;if(i=Object(w.a)(i,a),i=Object(w.a)(e.translucent,i),Object(u.a)(i))if("function"==typeof i){t._translucentFunctions.push((function(){return i(t)}))}else t._translucentFunctions.push(i)}(e,this),Object(O.a)(this,{type:{value:this.type,writable:!1}}),Object(u.a)(Rj._uniformList[this.type])||(Rj._uniformList[this.type]=Object.keys(this._uniforms))}function Lj(e,t,i,n){if(Object(u.a)(e))for(var r in e)if(e.hasOwnProperty(r)){var a=-1!==t.indexOf(r);(n&&!a||!n&&a)&&i(r,t)}}function Nj(e,t){for(var i="fabric: property name '"+e+"' is not valid. It should be ",n=0;n<t.length;n++){var r="'"+t[n]+"'";i+=n===t.length-1?"or "+r+".":r+", "}throw new h.a(i)}function Fj(e,t){var i="fabric: uniforms and materials cannot share the same property '"+e+"'";throw new h.a(i)}Rj._uniformList={},Rj.fromType=function(e,t){if(!Object(u.a)(Rj._materialCache.getMaterial(e)))throw new h.a("material with type '"+e+"' does not exist.");var i=new Rj({fabric:{type:e}});if(Object(u.a)(t))for(var n in t)t.hasOwnProperty(n)&&(i.uniforms[n]=t[n]);return i},Rj.prototype.isTranslucent=function(){if(Object(u.a)(this.translucent))return"function"==typeof this.translucent?this.translucent():this.translucent;for(var e=!0,t=this._translucentFunctions,i=t.length,n=0;n<i;++n){var r=t[n];if(!(e="function"==typeof r?e&&r():e&&r))break}return e},Rj.prototype.update=function(e){var t,i,n=this._loadedImages,r=n.length;for(t=0;t<r;++t){var a=n[t];i=a.id;var o,s=a.image;o=Object(u.a)(s.internalFormat)?new hj({context:e,pixelFormat:s.internalFormat,width:s.width,height:s.height,source:{arrayBufferView:s.bufferView}}):new hj({context:e,source:s}),this._textures[i]=o;var c=i+"Dimensions";if(this.uniforms.hasOwnProperty(c)){var l=this.uniforms[c];l.x=o._width,l.y=o._height}}n.length=0;var h=this._loadedCubeMaps;for(r=h.length,t=0;t<r;++t){var d=h[t];i=d.id;var f=d.images,p=new nj({context:e,source:{positiveX:f[0],negativeX:f[1],positiveY:f[2],negativeY:f[3],positiveZ:f[4],negativeZ:f[5]}});this._textures[i]=p}h.length=0;var m=this._updateFunctions;for(r=m.length,t=0;t<r;++t)m[t](this,e);var _=this.materials;for(var g in _)_.hasOwnProperty(g)&&_[g].update(e)},Rj.prototype.isDestroyed=function(){return!1},Rj.prototype.destroy=function(){var e=this._textures;for(var t in e)if(e.hasOwnProperty(t)){var i=e[t];i!==this._defaultTexture&&i.destroy()}var n=this.materials;for(var r in n)n.hasOwnProperty(r)&&n[r].destroy();return rl(this)};var kj=["type","materials","uniforms","components","source"],Bj=["diffuse","specular","shininess","normal","emission","alpha"];var zj={mat2:vn,mat3:be,mat4:Be},Uj=/\.ktx$/i,Vj=/\.crn$/i;function Hj(e,t){var i=e._strict,n=e._template.uniforms,r=n[t],a=function(e){var t=e.type;if(!Object(u.a)(t)){var i=typeof e;if("number"===i)t="float";else if("boolean"===i)t="bool";else if("string"===i||e instanceof f.a||e instanceof HTMLCanvasElement||e instanceof HTMLImageElement)t=/^([rgba]){1,4}$/i.test(e)?"channels":e===Rj.DefaultCubeMapId?"samplerCube":"sampler2D";else if("object"===i)if(Object(ym.a)(e))4!==e.length&&9!==e.length&&16!==e.length||(t="mat"+Math.sqrt(e.length));else{var n=0;for(var r in e)e.hasOwnProperty(r)&&(n+=1);n>=2&&n<=4?t="vec"+n:6===n&&(t="samplerCube")}}return t}(r);if(!Object(u.a)(a))throw new h.a("fabric: uniform '"+t+"' has invalid type.");if("channels"===a){if(0===Gj(e,t,r,!1)&&i)throw new h.a("strict: shader source does not use channels '"+t+"'.")}else{if("sampler2D"===a){var o=t+"Dimensions";(function(e,t,i){return Gj(e,t,t,i)})(e,o)>0&&(n[o]={type:"ivec3",x:1,y:1},Hj(e,o))}if(!new RegExp("uniform\\s+"+a+"\\s+"+t+"\\s*;").test(e.shaderSource)){var s="uniform "+a+" "+t+";";e.shaderSource=s+e.shaderSource}var c=t+"_"+e._count++;if(1===Gj(e,t,c)&&i)throw new h.a("strict: shader source does not use uniform '"+t+"'.");if(e.uniforms[t]=r,"sampler2D"===a)e._uniforms[c]=function(){return e._textures[t]},e._updateFunctions.push(function(e){var t;return function(i,n){var r=i.uniforms,a=r[e],o=t!==a;t=a;var s,c,l=i._textures[e];if(a instanceof HTMLVideoElement)if(a.readyState>=2){if(o&&Object(u.a)(l)&&(l!==n.defaultTexture&&l.destroy(),l=void 0),!Object(u.a)(l)||l===n.defaultTexture)return l=new hj({context:n,source:a}),void(i._textures[e]=l);l.copyFrom(a)}else Object(u.a)(l)||(i._textures[e]=n.defaultTexture);else{if(a instanceof hj&&a!==l){i._texturePaths[e]=void 0;var h=i._textures[e];return h!==i._defaultTexture&&h.destroy(),i._textures[e]=a,s=e+"Dimensions",void(r.hasOwnProperty(s)&&((c=r[s]).x=a._width,c.y=a._height))}if(Object(u.a)(l)||(i._texturePaths[e]=void 0,Object(u.a)(i._defaultTexture)||(i._defaultTexture=n.defaultTransparentTexture),l=i._textures[e]=i._defaultTexture,s=e+"Dimensions",r.hasOwnProperty(s)&&((c=r[s]).x=l._width,c.y=l._height)),a!==Rj.DefaultImageId){var d=a instanceof f.a;if(!Object(u.a)(i._texturePaths[e])||d&&a.url!==i._texturePaths[e].url||!d&&a!==i._texturePaths[e]){if("string"==typeof a||d){var p,m=d?a:f.a.createIfNeeded(a);p=Uj.test(a)?Ox(m):Vj.test(a)?ux(m):m.fetchImage(),Object(Oi.a)(p,(function(t){i._loadedImages.push({id:e,image:t})}))}else(a instanceof HTMLCanvasElement||a instanceof HTMLImageElement)&&i._loadedImages.push({id:e,image:a});i._texturePaths[e]=a}}}}}(t));else if("samplerCube"===a)e._uniforms[c]=function(){return e._textures[t]},e._updateFunctions.push(function(e){return function(t,i){var n=t.uniforms[e];if(n instanceof nj){var r=t._textures[e];return r!==t._defaultTexture&&r.destroy(),t._texturePaths[e]=void 0,void(t._textures[e]=n)}if(Object(u.a)(t._textures[e])||(t._texturePaths[e]=void 0,t._textures[e]=i.defaultCubeMap),n!==Rj.DefaultCubeMapId){var a=n.positiveX+n.negativeX+n.positiveY+n.negativeY+n.positiveZ+n.negativeZ;if(a!==t._texturePaths[e]){var o=[f.a.createIfNeeded(n.positiveX).fetchImage(),f.a.createIfNeeded(n.negativeX).fetchImage(),f.a.createIfNeeded(n.positiveY).fetchImage(),f.a.createIfNeeded(n.negativeY).fetchImage(),f.a.createIfNeeded(n.positiveZ).fetchImage(),f.a.createIfNeeded(n.negativeZ).fetchImage()];Oi.a.all(o).then((function(i){t._loadedCubeMaps.push({id:e,images:i})})),t._texturePaths[e]=a}}}}(t));else if(-1!==a.indexOf("mat")){var l=new zj[a];e._uniforms[c]=function(){return zj[a].fromColumnMajorArray(e.uniforms[t],l)}}else e._uniforms[c]=function(){return e.uniforms[t]}}}function Gj(e,t,i,n){n=Object(w.a)(n,!0);var r=0,a=new RegExp("([\\w"+(n?".":"")+"])?"+t+"([\\w])?","g");return e.shaderSource=e.shaderSource.replace(a,(function(e,t,n){return t||n?e:(r+=1,i)})),r}Rj._materialCache={_materials:{},addMaterial:function(e,t){this._materials[e]=t},getMaterial:function(e){return this._materials[e]}},Rj.DefaultImageId="czm_defaultImage",Rj.DefaultCubeMapId="czm_defaultCubeMap",Rj.ColorType="Color",Rj._materialCache.addMaterial(Rj.ColorType,{fabric:{type:Rj.ColorType,uniforms:{color:new uf(1,0,0,.5)},components:{diffuse:"color.rgb",alpha:"color.a"}},translucent:function(e){return e.uniforms.color.alpha<1}}),Rj.ImageType="Image",Rj._materialCache.addMaterial(Rj.ImageType,{fabric:{type:Rj.ImageType,uniforms:{image:Rj.DefaultImageId,repeat:new Rt(1,1),color:new uf(1,1,1,1)},components:{diffuse:"texture2D(image, fract(repeat * materialInput.st)).rgb * color.rgb",alpha:"texture2D(image, fract(repeat * materialInput.st)).a * color.a"}},translucent:function(e){return e.uniforms.color.alpha<1}}),Rj.DiffuseMapType="DiffuseMap",Rj._materialCache.addMaterial(Rj.DiffuseMapType,{fabric:{type:Rj.DiffuseMapType,uniforms:{image:Rj.DefaultImageId,channels:"rgb",repeat:new Rt(1,1)},components:{diffuse:"texture2D(image, fract(repeat * materialInput.st)).channels"}},translucent:!1}),Rj.AlphaMapType="AlphaMap",Rj._materialCache.addMaterial(Rj.AlphaMapType,{fabric:{type:Rj.AlphaMapType,uniforms:{image:Rj.DefaultImageId,channel:"a",repeat:new Rt(1,1)},components:{alpha:"texture2D(image, fract(repeat * materialInput.st)).channel"}},translucent:!0}),Rj.SpecularMapType="SpecularMap",Rj._materialCache.addMaterial(Rj.SpecularMapType,{fabric:{type:Rj.SpecularMapType,uniforms:{image:Rj.DefaultImageId,channel:"r",repeat:new Rt(1,1)},components:{specular:"texture2D(image, fract(repeat * materialInput.st)).channel"}},translucent:!1}),Rj.EmissionMapType="EmissionMap",Rj._materialCache.addMaterial(Rj.EmissionMapType,{fabric:{type:Rj.EmissionMapType,uniforms:{image:Rj.DefaultImageId,channels:"rgb",repeat:new Rt(1,1)},components:{emission:"texture2D(image, fract(repeat * materialInput.st)).channels"}},translucent:!1}),Rj.BumpMapType="BumpMap",Rj._materialCache.addMaterial(Rj.BumpMapType,{fabric:{type:Rj.BumpMapType,uniforms:{image:Rj.DefaultImageId,channel:"r",strength:.8,repeat:new Rt(1,1)},source:dj},translucent:!1}),Rj.NormalMapType="NormalMap",Rj._materialCache.addMaterial(Rj.NormalMapType,{fabric:{type:Rj.NormalMapType,uniforms:{image:Rj.DefaultImageId,channels:"rgb",strength:.8,repeat:new Rt(1,1)},source:bj},translucent:!1}),Rj.GridType="Grid",Rj._materialCache.addMaterial(Rj.GridType,{fabric:{type:Rj.GridType,uniforms:{color:new uf(0,1,0,1),cellAlpha:.1,lineCount:new Rt(8,8),lineThickness:new Rt(1,1),lineOffset:new Rt(0,0)},source:vj},translucent:function(e){var t=e.uniforms;return t.color.alpha<1||t.cellAlpha<1}}),Rj.StripeType="Stripe",Rj._materialCache.addMaterial(Rj.StripeType,{fabric:{type:Rj.StripeType,uniforms:{horizontal:!0,evenColor:new uf(1,1,1,.5),oddColor:new uf(0,0,1,.5),offset:0,repeat:5},source:Sj},translucent:function(e){var t=e.uniforms;return t.evenColor.alpha<1||t.oddColor.alpha<1}}),Rj.CheckerboardType="Checkerboard",Rj._materialCache.addMaterial(Rj.CheckerboardType,{fabric:{type:Rj.CheckerboardType,uniforms:{lightColor:new uf(1,1,1,.5),darkColor:new uf(0,0,0,.5),repeat:new Rt(5,5)},source:fj},translucent:function(e){var t=e.uniforms;return t.lightColor.alpha<1||t.darkColor.alpha<1}}),Rj.DotType="Dot",Rj._materialCache.addMaterial(Rj.DotType,{fabric:{type:Rj.DotType,uniforms:{lightColor:new uf(1,1,0,.75),darkColor:new uf(0,1,1,.75),repeat:new Rt(5,5)},source:pj},translucent:function(e){var t=e.uniforms;return t.lightColor.alpha<1||t.darkColor.alpha<1}}),Rj.WaterType="Water",Rj._materialCache.addMaterial(Rj.WaterType,{fabric:{type:Rj.WaterType,uniforms:{baseWaterColor:new uf(.2,.3,.6,1),blendColor:new uf(0,1,.699,1),specularMap:Rj.DefaultImageId,normalMap:Rj.DefaultImageId,frequency:10,animationSpeed:.01,amplitude:1,specularIntensity:.5,fadeFactor:1},source:Aj},translucent:function(e){var t=e.uniforms;return t.baseWaterColor.alpha<1||t.blendColor.alpha<1}}),Rj.RimLightingType="RimLighting",Rj._materialCache.addMaterial(Rj.RimLightingType,{fabric:{type:Rj.RimLightingType,uniforms:{color:new uf(1,0,0,.7),rimColor:new uf(1,1,1,.4),width:.3},source:Tj},translucent:function(e){var t=e.uniforms;return t.color.alpha<1||t.rimColor.alpha<1}}),Rj.FadeType="Fade",Rj._materialCache.addMaterial(Rj.FadeType,{fabric:{type:Rj.FadeType,uniforms:{fadeInColor:new uf(1,0,0,1),fadeOutColor:new uf(0,0,0,0),maximumDistance:.5,repeat:!0,fadeDirection:{x:!0,y:!0},time:new Rt(.5,.5)},source:gj},translucent:function(e){var t=e.uniforms;return t.fadeInColor.alpha<1||t.fadeOutColor.alpha<1}}),Rj.TrailMaterialType="Trail",Rj._materialCache.addMaterial(Rj.TrailMaterialType,{fabric:{type:Rj.TrailMaterialType,uniforms:{horizontal:!1,evenColor:new uf(1,1,1,.5),oddColor:new uf(0,0,1,.5)},source:Pj},translucent:!0}),Rj.DiffusionRingMaterialType="DiffusionRing",Rj._materialCache.addMaterial(Rj.DiffusionRingMaterialType,{fabric:{type:Rj.DiffusionRingMaterialType,uniforms:{color:new uf(.5921569,.8450981,.97647065,.9),m_XDirection:!1},source:Ij},translucent:!0}),Rj.RoadNetWorkMaterialType="RoadNetWork",Rj._materialCache.addMaterial(Rj.RoadNetWorkMaterialType,{fabric:{type:Rj.RoadNetWorkMaterialType,uniforms:{fluxMap:Rj.DefaultImageId,reverse:!1},source:Dj},translucent:!0}),Rj.PolylineArrowType="PolylineArrow",Rj._materialCache.addMaterial(Rj.PolylineArrowType,{fabric:{type:Rj.PolylineArrowType,uniforms:{color:new uf(1,1,1,1)},source:yj},translucent:!0}),Rj.PolylineDashType="PolylineDash",Rj._materialCache.addMaterial(Rj.PolylineDashType,{fabric:{type:Rj.PolylineDashType,uniforms:{color:new uf(1,0,1,1),gapColor:new uf(0,0,0,0),dashLength:16,dashPattern:255},source:wj},translucent:!0}),Rj.PolylineDashDynamicType="PolylineDashDynamic",Rj._materialCache.addMaterial(Rj.PolylineDashDynamicType,{fabric:{type:Rj.PolylineDashDynamicType,uniforms:{color:new uf(1,0,1,1),oddColor:new uf(0,1,0,1),animat:!0,gradual:!0,gapColor:new uf(0,0,0,0),dashLength:16,dashPattern:255,speed:.5},source:Oj},translucent:!0}),Rj.PolylineGlowType="PolylineGlow",Rj._materialCache.addMaterial(Rj.PolylineGlowType,{fabric:{type:Rj.PolylineGlowType,uniforms:{color:new uf(0,.5,1,1),glowPower:.25},source:xj},translucent:!0}),Rj.PolylineOutlineType="PolylineOutline",Rj._materialCache.addMaterial(Rj.PolylineOutlineType,{fabric:{type:Rj.PolylineOutlineType,uniforms:{color:new uf(1,1,1,1),outlineColor:new uf(1,0,0,1),outlineWidth:1},source:Ej},translucent:function(e){var t=e.uniforms;return t.color.alpha<1||t.outlineColor.alpha<1}}),Rj.ElevationContourType="ElevationContour",Rj._materialCache.addMaterial(Rj.ElevationContourType,{fabric:{type:Rj.ElevationContourType,uniforms:{spacing:100,color:new uf(1,0,0,1),width:1},source:mj},translucent:!1}),Rj.ElevationRampType="ElevationRamp",Rj._materialCache.addMaterial(Rj.ElevationRampType,{fabric:{type:Rj.ElevationRampType,uniforms:{image:Rj.DefaultImageId,minimumHeight:0,maximumHeight:1e4},source:_j},translucent:!1}),Rj.SlopeRampMaterialType="SlopeRamp",Rj._materialCache.addMaterial(Rj.SlopeRampMaterialType,{fabric:{type:Rj.SlopeRampMaterialType,uniforms:{image:Rj.DefaultImageId},source:Cj},translucent:!1}),Rj.RadarMaterialType="Radar",Rj._materialCache.addMaterial(Rj.RadarMaterialType,{fabric:{type:Rj.RadarMaterialType,uniforms:{color:new uf(0,1,.2,1),speed:.05,m_XDirection:!1},source:jj},translucent:!0}),Rj.DirectionMaterialType="Direction",Rj._materialCache.addMaterial(Rj.DirectionMaterialType,{fabric:{type:Rj.DirectionMaterialType,uniforms:{fluxMap:Rj.DefaultImageId,speed:.05,direction:!0,m_Sample:1,color:new uf(0,1,.2,1),factor:1,offset:new Rt(0,.1)},source:Mj},translucent:!1});var qj=Rj;function Wj(e){e=Object(w.a)(e,w.a.EMPTY_OBJECT);var t=Object(w.a)(e.translucent,!0),i=Object(w.a)(e.closed,!1),n=Object(w.a)(e.materialSupport,Wj.MaterialSupport.TEXTURED);this.material=Object(u.a)(e.material)?e.material:qj.fromType(qj.ColorType),this.translucent=t,this._vertexShaderSource=Object(w.a)(e.vertexShaderSource,n.vertexShaderSource),this._fragmentShaderSource=Object(w.a)(e.fragmentShaderSource,n.fragmentShaderSource),this._renderState=UD.getDefaultRenderState(t,i,e.renderState),this._closed=i,this._materialSupport=n,this._vertexFormat=n.vertexFormat,this._flat=Object(w.a)(e.flat,!1),this._faceForward=Object(w.a)(e.faceForward,!i)}Object(O.a)(Wj.prototype,{vertexShaderSource:{get:function(){return this._vertexShaderSource}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},renderState:{get:function(){return this._renderState}},closed:{get:function(){return this._closed}},materialSupport:{get:function(){return this._materialSupport}},vertexFormat:{get:function(){return this._vertexFormat}},flat:{get:function(){return this._flat}},faceForward:{get:function(){return this._faceForward}}}),Wj.prototype.getFragmentShaderSource=UD.prototype.getFragmentShaderSource,Wj.prototype.isTranslucent=UD.prototype.isTranslucent,Wj.prototype.getRenderState=UD.prototype.getRenderState,Wj.MaterialSupport={BASIC:Object(E.a)({vertexFormat:Ba.POSITION_AND_NORMAL,vertexShaderSource:PD,fragmentShaderSource:AD}),TEXTURED:Object(E.a)({vertexFormat:Ba.POSITION_NORMAL_AND_ST,vertexShaderSource:DD,fragmentShaderSource:ID}),ALL:Object(E.a)({vertexFormat:Ba.ALL,vertexShaderSource:SD,fragmentShaderSource:CD})};var Yj=Wj,Xj="varying vec3 v_positionEC;\nvarying vec3 v_normalEC;\nvarying vec4 v_color;\nvoid main()\n{\nvec3 positionToEyeEC = -v_positionEC;\nvec3 normalEC = normalize(v_normalEC);\n#ifdef FACE_FORWARD\nnormalEC = faceforward(normalEC, vec3(0.0, 0.0, 1.0), -normalEC);\n#endif\nvec4 color = czm_gammaCorrect(v_color);\nczm_materialInput materialInput;\nmaterialInput.normalEC = normalEC;\nmaterialInput.positionToEyeEC = positionToEyeEC;\nczm_material material = czm_getDefaultMaterial(materialInput);\nmaterial.diffuse = color.rgb;\nmaterial.alpha = color.a;\ngl_FragColor = czm_phong(normalize(positionToEyeEC), material);\n}\n",Zj="attribute vec3 position3DHigh;\nattribute vec3 position3DLow;\nattribute vec3 normal;\nattribute vec4 color;\nattribute float batchId;\nvarying vec3 v_positionEC;\nvarying vec3 v_normalEC;\nvarying vec4 v_color;\nvoid main()\n{\nvec4 p = czm_computePosition();\nv_positionEC = (czm_modelViewRelativeToEye * p).xyz;\nv_normalEC = czm_normal * normal;\nv_color = color;\ngl_Position = czm_modelViewProjectionRelativeToEye * p;\n}\n",Qj="varying vec4 v_color;\nvoid main()\n{\ngl_FragColor = v_color;\n}\n",Kj="attribute vec3 position3DHigh;\nattribute vec3 position3DLow;\nattribute vec4 color;\nattribute float batchId;\nvarying vec4 v_color;\nvoid main()\n{\nvec4 p = czm_computePosition();\nv_color = color;\ngl_Position = czm_modelViewProjectionRelativeToEye * p;\n}\n";function Jj(e){e=Object(w.a)(e,w.a.EMPTY_OBJECT);var t=Object(w.a)(e.translucent,!0),i=Object(w.a)(e.closed,!1),n=Object(w.a)(e.flat,!1),r=n?Kj:Zj,a=n?Qj:Xj,o=n?Jj.FLAT_VERTEX_FORMAT:Jj.VERTEX_FORMAT;this.material=void 0,this.translucent=t,this._vertexShaderSource=Object(w.a)(e.vertexShaderSource,r),this._fragmentShaderSource=Object(w.a)(e.fragmentShaderSource,a),this._renderState=UD.getDefaultRenderState(t,i,e.renderState),this._closed=i,this._vertexFormat=o,this._flat=n,this._faceForward=Object(w.a)(e.faceForward,!i)}Object(O.a)(Jj.prototype,{vertexShaderSource:{get:function(){return this._vertexShaderSource}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},renderState:{get:function(){return this._renderState}},closed:{get:function(){return this._closed}},vertexFormat:{get:function(){return this._vertexFormat}},flat:{get:function(){return this._flat}},faceForward:{get:function(){return this._faceForward}}}),Jj.VERTEX_FORMAT=Ba.POSITION_AND_NORMAL,Jj.FLAT_VERTEX_FORMAT=Ba.POSITION_ONLY,Jj.prototype.getFragmentShaderSource=UD.prototype.getFragmentShaderSource,Jj.prototype.isTranslucent=UD.prototype.isTranslucent,Jj.prototype.getRenderState=UD.prototype.getRenderState;var $j=Jj;function eM(e,t){this._callback=void 0,this._isConstant=void 0,this._definitionChanged=new $o.a,this.setCallback(e,t)}Object(O.a)(eM.prototype,{isConstant:{get:function(){return this._isConstant}},definitionChanged:{get:function(){return this._definitionChanged}}}),eM.prototype.getValue=function(e,t){return this._callback(e,t)},eM.prototype.setCallback=function(e,t){if(!Object(u.a)(e))throw new h.a("callback is required.");if(!Object(u.a)(t))throw new h.a("isConstant is required.");var i=this._callback!==e||this._isConstant!==t;this._callback=e,this._isConstant=t,i&&this._definitionChanged.raiseEvent(this)},eM.prototype.equals=function(e){return this===e||e instanceof eM&&this._callback===e._callback&&this._isConstant===e._isConstant};var tM=eM,iM=Object(E.a)({TERRAIN:0,CESIUM_3D_TILE:1,BOTH:2,NUMBER_OF_CLASSIFICATION_TYPES:3}),nM={DISABLED:0,ENABLED:1,CAST_ONLY:2,RECEIVE_ONLY:3,NUMBER_OF_SHADOW_MODES:4,castShadows:function(e){return e===nM.ENABLED||e===nM.CAST_ONLY},receiveShadows:function(e){return e===nM.ENABLED||e===nM.RECEIVE_ONLY},fromCastReceive:function(e,t){return e&&t?nM.ENABLED:e?nM.CAST_ONLY:t?nM.RECEIVE_ONLY:nM.DISABLED}},rM=Object(E.a)(nM);function aM(e){this._definitionChanged=new $o.a,this._color=void 0,this._colorSubscription=void 0,this.color=e}Object(O.a)(aM.prototype,{isConstant:{get:function(){return aD.isConstant(this._color)}},definitionChanged:{get:function(){return this._definitionChanged}},color:KI("color")}),aM.prototype.getType=function(e){return"Color"},aM.prototype.getValue=function(e,t){return Object(u.a)(t)||(t={}),t.color=aD.getValueOrClonedDefault(this._color,e,uf.WHITE,t.color),t},aM.prototype.equals=function(e){return this===e||e instanceof aM&&aD.equals(this._color,e._color)};var oM=aM;function sM(e){e=Object(w.a)(e,w.a.EMPTY_OBJECT),this._boundingVolume=e.boundingVolume,this._orientedBoundingBox=e.orientedBoundingBox,this._cull=Object(w.a)(e.cull,!0),this._occlude=Object(w.a)(e.occlude,!0),this._modelMatrix=e.modelMatrix,this._primitiveType=Object(w.a)(e.primitiveType,yn.TRIANGLES),this._vertexArray=e.vertexArray,this._count=e.count,this._offset=Object(w.a)(e.offset,0),this._instanceCount=Object(w.a)(e.instanceCount,0),this._shaderProgram=e.shaderProgram,this._uniformMap=e.uniformMap,this._renderState=e.renderState,this._framebuffer=e.framebuffer,this._pass=e.pass,this._executeInClosestFrustum=Object(w.a)(e.executeInClosestFrustum,!1),this._owner=e.owner,this._debugShowBoundingVolume=Object(w.a)(e.debugShowBoundingVolume,!1),this._debugOverlappingFrustums=0,this._castShadows=Object(w.a)(e.castShadows,!1),this._receiveShadows=Object(w.a)(e.receiveShadows,!1),this._pickId=e.pickId,this._pickOnly=Object(w.a)(e.pickOnly,!1),this.dirty=!0,this.lastDirtyTime=0,this.lastViewShedDirtyTime=0,this.derivedCommands={},this.lastFrameModel=void 0,this._pbrUniformBuffer=Object(w.a)(e.pbrUniformBuffer,void 0)}Object(O.a)(sM.prototype,{boundingVolume:{get:function(){return this._boundingVolume},set:function(e){this._boundingVolume!==e&&(this._boundingVolume=e,this.dirty=!0)}},orientedBoundingBox:{get:function(){return this._orientedBoundingBox},set:function(e){this._orientedBoundingBox!==e&&(this._orientedBoundingBox=e,this.dirty=!0)}},cull:{get:function(){return this._cull},set:function(e){this._cull!==e&&(this._cull=e,this.dirty=!0)}},occlude:{get:function(){return this._occlude},set:function(e){this._occlude!==e&&(this._occlude=e,this.dirty=!0)}},modelMatrix:{get:function(){return this._modelMatrix},set:function(e){this._modelMatrix!==e&&(this._modelMatrix=e,this.dirty=!0)}},primitiveType:{get:function(){return this._primitiveType},set:function(e){this._primitiveType!==e&&(this._primitiveType=e,this.dirty=!0)}},vertexArray:{get:function(){return this._vertexArray},set:function(e){this._vertexArray!==e&&(this._vertexArray=e,this.dirty=!0)}},count:{get:function(){return this._count},set:function(e){this._count!==e&&(this._count=e,this.dirty=!0)}},offset:{get:function(){return this._offset},set:function(e){this._offset!==e&&(this._offset=e,this.dirty=!0)}},instanceCount:{get:function(){return this._instanceCount},set:function(e){this._instanceCount!==e&&(this._instanceCount=e,this.dirty=!0)}},shaderProgram:{get:function(){return this._shaderProgram},set:function(e){this._shaderProgram!==e&&(this._shaderProgram=e,this.dirty=!0)}},castShadows:{get:function(){return this._castShadows},set:function(e){this._castShadows!==e&&(this._castShadows=e,this.dirty=!0)}},receiveShadows:{get:function(){return this._receiveShadows},set:function(e){this._receiveShadows!==e&&(this._receiveShadows=e,this.dirty=!0)}},uniformMap:{get:function(){return this._uniformMap},set:function(e){this._uniformMap!==e&&(this._uniformMap=e,this.dirty=!0)}},renderState:{get:function(){return this._renderState},set:function(e){this._renderState!==e&&(this._renderState=e,this.dirty=!0)}},framebuffer:{get:function(){return this._framebuffer},set:function(e){this._framebuffer!==e&&(this._framebuffer=e,this.dirty=!0)}},pass:{get:function(){return this._pass},set:function(e){this._pass!==e&&(this._pass=e,this.dirty=!0)}},executeInClosestFrustum:{get:function(){return this._executeInClosestFrustum},set:function(e){this._executeInClosestFrustum!==e&&(this._executeInClosestFrustum=e,this.dirty=!0)}},owner:{get:function(){return this._owner},set:function(e){this._owner!==e&&(this._owner=e,this.dirty=!0)}},debugShowBoundingVolume:{get:function(){return this._debugShowBoundingVolume},set:function(e){this._debugShowBoundingVolume!==e&&(this._debugShowBoundingVolume=e,this.dirty=!0)}},debugOverlappingFrustums:{get:function(){return this._debugOverlappingFrustums},set:function(e){this._debugOverlappingFrustums!==e&&(this._debugOverlappingFrustums=e,this.dirty=!0)}},pickId:{get:function(){return this._pickId},set:function(e){this._pickId!==e&&(this._pickId=e,this.dirty=!0)}},pickOnly:{get:function(){return this._pickOnly},set:function(e){this._pickOnly!==e&&(this._pickOnly=e,this.dirty=!0)}}}),sM.shallowClone=function(e,t){if(Object(u.a)(e))return Object(u.a)(t)||(t=new sM),t._boundingVolume=e._boundingVolume,t._orientedBoundingBox=e._orientedBoundingBox,t._cull=e._cull,t._occlude=e._occlude,t._modelMatrix=e._modelMatrix,t._primitiveType=e._primitiveType,t._vertexArray=e._vertexArray,t._count=e._count,t._offset=e._offset,t._instanceCount=e._instanceCount,t._shaderProgram=e._shaderProgram,t._uniformMap=e._uniformMap,t._renderState=e._renderState,t._framebuffer=e._framebuffer,t._pass=e._pass,t._executeInClosestFrustum=e._executeInClosestFrustum,t._owner=e._owner,t._debugShowBoundingVolume=e._debugShowBoundingVolume,t._debugOverlappingFrustums=e._debugOverlappingFrustums,t._castShadows=e._castShadows,t._receiveShadows=e._receiveShadows,t._pickId=e._pickId,t._pickOnly=e._pickOnly,t.dirty=!0,t.lastDirtyTime=0,t.lastViewShedDirtyTime=0,t._pbrUniformBuffer=e._pbrUniformBuffer,t},sM.prototype.execute=function(e,t){e.draw(this,t)};var cM=sM,lM=Object(E.a)({ENVIRONMENT:0,COMPUTE:1,GLOBE:2,TERRAIN_CLASSIFICATION:3,CESIUM_3D_TILE:4,CESIUM_3D_TILE_CLASSIFICATION:5,CESIUM_3D_TILE_CLASSIFICATION_IGNORE_SHOW:6,OPAQUE:7,TRANSLUCENT:8,OVERLAY:9,WATER:10,MODEL_PLANISH:11,NUMBER_OF_PASSES:12});var uM=function e(t){if("object"!=typeof t||null===t)return t;for(var i,n=Object.keys(t),r=0;r<n.length;r++)i=n[r],t.hasOwnProperty(i)&&"_applyFunctions"!==i&&(t[i]=e(t[i]));return Object(E.a)(t)};function hM(e){return e===un.FUNC_ADD||e===un.FUNC_SUBTRACT||e===un.FUNC_REVERSE_SUBTRACT||e===un.MIN||e===un.MAX}function dM(e){return e===un.ZERO||e===un.ONE||e===un.SRC_COLOR||e===un.ONE_MINUS_SRC_COLOR||e===un.DST_COLOR||e===un.ONE_MINUS_DST_COLOR||e===un.SRC_ALPHA||e===un.ONE_MINUS_SRC_ALPHA||e===un.DST_ALPHA||e===un.ONE_MINUS_DST_ALPHA||e===un.CONSTANT_COLOR||e===un.ONE_MINUS_CONSTANT_COLOR||e===un.CONSTANT_ALPHA||e===un.ONE_MINUS_CONSTANT_ALPHA||e===un.SRC_ALPHA_SATURATE}function fM(e){return e===un.NEVER||e===un.LESS||e===un.EQUAL||e===un.LEQUAL||e===un.GREATER||e===un.NOTEQUAL||e===un.GEQUAL||e===un.ALWAYS}function pM(e){return e===un.ZERO||e===un.KEEP||e===un.REPLACE||e===un.INCR||e===un.DECR||e===un.INVERT||e===un.INCR_WRAP||e===un.DECR_WRAP}function mM(e){var t,i,n=Object(w.a)(e,{}),r=Object(w.a)(n.cull,{}),a=Object(w.a)(n.polygonOffset,{}),o=Object(w.a)(n.scissorTest,{}),s=Object(w.a)(o.rectangle,{}),c=Object(w.a)(n.depthRange,{}),l=Object(w.a)(n.depthTest,{}),d=Object(w.a)(n.colorMask,{}),f=Object(w.a)(n.blending,{}),p=Object(w.a)(f.color,{}),m=Object(w.a)(n.stencilTest,{}),_=Object(w.a)(m.frontOperation,{}),g=Object(w.a)(m.backOperation,{}),v=Object(w.a)(n.sampleCoverage,{}),b=n.viewport;if(this.frontFace=Object(w.a)(n.frontFace,op.COUNTER_CLOCKWISE),this.cull={enabled:Object(w.a)(r.enabled,!1),face:Object(w.a)(r.face,un.BACK)},this.lineWidth=Object(w.a)(n.lineWidth,1),this.polygonOffset={enabled:Object(w.a)(a.enabled,!1),factor:Object(w.a)(a.factor,0),units:Object(w.a)(a.units,0)},this.scissorTest={enabled:Object(w.a)(o.enabled,!1),rectangle:ln.clone(s)},this.depthRange={near:Object(w.a)(c.near,0),far:Object(w.a)(c.far,1)},this.depthTest={enabled:Object(w.a)(l.enabled,!1),func:Object(w.a)(l.func,un.LESS)},this.colorMask={red:Object(w.a)(d.red,!0),green:Object(w.a)(d.green,!0),blue:Object(w.a)(d.blue,!0),alpha:Object(w.a)(d.alpha,!0)},this.depthMask=Object(w.a)(n.depthMask,!0),this.stencilMask=Object(w.a)(n.stencilMask,-1),this.blending={enabled:Object(w.a)(f.enabled,!1),color:new uf(Object(w.a)(p.red,0),Object(w.a)(p.green,0),Object(w.a)(p.blue,0),Object(w.a)(p.alpha,0)),equationRgb:Object(w.a)(f.equationRgb,un.FUNC_ADD),equationAlpha:Object(w.a)(f.equationAlpha,un.FUNC_ADD),functionSourceRgb:Object(w.a)(f.functionSourceRgb,un.ONE),functionSourceAlpha:Object(w.a)(f.functionSourceAlpha,un.ONE),functionDestinationRgb:Object(w.a)(f.functionDestinationRgb,un.ZERO),functionDestinationAlpha:Object(w.a)(f.functionDestinationAlpha,un.ZERO)},this.stencilTest={enabled:Object(w.a)(m.enabled,!1),frontFunction:Object(w.a)(m.frontFunction,un.ALWAYS),backFunction:Object(w.a)(m.backFunction,un.ALWAYS),reference:Object(w.a)(m.reference,0),mask:Object(w.a)(m.mask,-1),frontOperation:{fail:Object(w.a)(_.fail,un.KEEP),zFail:Object(w.a)(_.zFail,un.KEEP),zPass:Object(w.a)(_.zPass,un.KEEP)},backOperation:{fail:Object(w.a)(g.fail,un.KEEP),zFail:Object(w.a)(g.zFail,un.KEEP),zPass:Object(w.a)(g.zPass,un.KEEP)}},this.sampleCoverage={enabled:Object(w.a)(v.enabled,!1),value:Object(w.a)(v.value,1),invert:Object(w.a)(v.invert,!1)},this.viewport=Object(u.a)(b)?new ln(b.x,b.y,b.width,b.height):void 0,this.lineWidth<HD.minimumAliasedLineWidth||this.lineWidth>HD.maximumAliasedLineWidth)throw new h.a("renderState.lineWidth is out of range.  Check minimumAliasedLineWidth and maximumAliasedLineWidth.");if(!op.validate(this.frontFace))throw new h.a("Invalid renderState.frontFace.");if((t=this.cull.face)!==un.FRONT&&t!==un.BACK&&t!==un.FRONT_AND_BACK)throw new h.a("Invalid renderState.cull.face.");if(this.scissorTest.rectangle.width<0||this.scissorTest.rectangle.height<0)throw new h.a("renderState.scissorTest.rectangle.width and renderState.scissorTest.rectangle.height must be greater than or equal to zero.");if(this.depthRange.near>this.depthRange.far)throw new h.a("renderState.depthRange.near can not be greater than renderState.depthRange.far.");if(this.depthRange.near<0)throw new h.a("renderState.depthRange.near must be greater than or equal to zero.");if(this.depthRange.far>1)throw new h.a("renderState.depthRange.far must be less than or equal to one.");if((i=this.depthTest.func)!==un.NEVER&&i!==un.LESS&&i!==un.EQUAL&&i!==un.LEQUAL&&i!==un.GREATER&&i!==un.NOTEQUAL&&i!==un.GEQUAL&&i!==un.ALWAYS)throw new h.a("Invalid renderState.depthTest.func.");if(this.blending.color.red<0||this.blending.color.red>1||this.blending.color.green<0||this.blending.color.green>1||this.blending.color.blue<0||this.blending.color.blue>1||this.blending.color.alpha<0||this.blending.color.alpha>1)throw new h.a("renderState.blending.color components must be greater than or equal to zero and less than or equal to one.");if(!hM(this.blending.equationRgb))throw new h.a("Invalid renderState.blending.equationRgb.");if(!hM(this.blending.equationAlpha))throw new h.a("Invalid renderState.blending.equationAlpha.");if(!dM(this.blending.functionSourceRgb))throw new h.a("Invalid renderState.blending.functionSourceRgb.");if(!dM(this.blending.functionSourceAlpha))throw new h.a("Invalid renderState.blending.functionSourceAlpha.");if(!dM(this.blending.functionDestinationRgb))throw new h.a("Invalid renderState.blending.functionDestinationRgb.");if(!dM(this.blending.functionDestinationAlpha))throw new h.a("Invalid renderState.blending.functionDestinationAlpha.");if(!fM(this.stencilTest.frontFunction))throw new h.a("Invalid renderState.stencilTest.frontFunction.");if(!fM(this.stencilTest.backFunction))throw new h.a("Invalid renderState.stencilTest.backFunction.");if(!pM(this.stencilTest.frontOperation.fail))throw new h.a("Invalid renderState.stencilTest.frontOperation.fail.");if(!pM(this.stencilTest.frontOperation.zFail))throw new h.a("Invalid renderState.stencilTest.frontOperation.zFail.");if(!pM(this.stencilTest.frontOperation.zPass))throw new h.a("Invalid renderState.stencilTest.frontOperation.zPass.");if(!pM(this.stencilTest.backOperation.fail))throw new h.a("Invalid renderState.stencilTest.backOperation.fail.");if(!pM(this.stencilTest.backOperation.zFail))throw new h.a("Invalid renderState.stencilTest.backOperation.zFail.");if(!pM(this.stencilTest.backOperation.zPass))throw new h.a("Invalid renderState.stencilTest.backOperation.zPass.");if(Object(u.a)(this.viewport)){if(this.viewport.width<0)throw new h.a("renderState.viewport.width must be greater than or equal to zero.");if(this.viewport.height<0)throw new h.a("renderState.viewport.height must be greater than or equal to zero.");if(this.viewport.width>HD.maximumViewportWidth)throw new h.a("renderState.viewport.width must be less than or equal to the maximum viewport width ("+HD.maximumViewportWidth.toString()+").  Check maximumViewportWidth.");if(this.viewport.height>HD.maximumViewportHeight)throw new h.a("renderState.viewport.height must be less than or equal to the maximum viewport height ("+HD.maximumViewportHeight.toString()+").  Check maximumViewportHeight.")}this.id=0,this._applyFunctions=[]}var _M=0,gM={};function vM(e,t,i){i?e.enable(t):e.disable(t)}function bM(e,t){e.frontFace(t.frontFace)}function yM(e,t){var i=t.cull,n=i.enabled;vM(e,e.CULL_FACE,n),n&&e.cullFace(i.face)}function wM(e,t){e.lineWidth(t.lineWidth)}function OM(e,t){var i=t.polygonOffset,n=i.enabled;vM(e,e.POLYGON_OFFSET_FILL,n),n&&e.polygonOffset(i.factor,i.units)}function xM(e,t,i){var n=t.scissorTest,r=Object(u.a)(i.scissorTest)?i.scissorTest.enabled:n.enabled;if(vM(e,e.SCISSOR_TEST,r),r){var a=Object(u.a)(i.scissorTest)?i.scissorTest.rectangle:n.rectangle;e.scissor(a.x,a.y,a.width,a.height)}}function EM(e,t){var i=t.depthRange;e.depthRange(i.near,i.far)}function TM(e,t){var i=t.depthTest,n=i.enabled;vM(e,e.DEPTH_TEST,n),n&&e.depthFunc(i.func)}function CM(e,t){var i=t.colorMask;e.colorMask(i.red,i.green,i.blue,i.alpha)}function SM(e,t){e.depthMask(t.depthMask)}function AM(e,t){e.stencilMask(t.stencilMask)}function PM(e,t,i){var n=t.blending,r=Object(u.a)(i.blendingEnabled)?i.blendingEnabled:n.enabled;vM(e,e.BLEND,r),r&&(!function(e,t){e.blendColor(t.red,t.green,t.blue,t.alpha)}(e,n.color),e.blendEquationSeparate(n.equationRgb,n.equationAlpha),e.blendFuncSeparate(n.functionSourceRgb,n.functionDestinationRgb,n.functionSourceAlpha,n.functionDestinationAlpha))}function IM(e,t){var i=t.stencilTest,n=i.enabled;if(vM(e,e.STENCIL_TEST,n),n){var r=i.frontFunction,a=i.backFunction,o=i.reference,s=i.mask;e.stencilFunc(r,o,s),e.stencilFuncSeparate(e.BACK,a,o,s),e.stencilFuncSeparate(e.FRONT,r,o,s);var c=i.frontOperation,l=c.fail,u=c.zFail,h=c.zPass;e.stencilOpSeparate(e.FRONT,l,u,h);var d=i.backOperation,f=d.fail,p=d.zFail,m=d.zPass;e.stencilOpSeparate(e.BACK,f,p,m)}}function DM(e,t){var i=t.sampleCoverage,n=i.enabled;vM(e,e.SAMPLE_COVERAGE,n),n&&e.sampleCoverage(i.value,i.invert)}mM.fromCache=function(e){var t=JSON.stringify(e),i=gM[t];if(Object(u.a)(i))return++i.referenceCount,i.state;var n=new mM(e),r=JSON.stringify(n);return i=gM[r],Object(u.a)(i)||(n.id=_M++,i={referenceCount:0,state:n=uM(n)},gM[r]=i),++i.referenceCount,gM[t]={referenceCount:1,state:i.state},i.state},mM.removeFromCache=function(e){var t=new mM(e),i=JSON.stringify(t),n=gM[i],r=JSON.stringify(e),a=gM[r];Object(u.a)(a)&&(--a.referenceCount,0===a.referenceCount&&(delete gM[r],Object(u.a)(n)&&--n.referenceCount)),Object(u.a)(n)&&0===n.referenceCount&&delete gM[i]},mM.getCache=function(){return gM},mM.clearCache=function(){gM={}};var jM=new ln;function MM(e,t,i){var n=Object(w.a)(t.viewport,i.viewport);Object(u.a)(n)||((n=jM).width=i.context.drawingBufferWidth,n.height=i.context.drawingBufferHeight),i.context.uniformState.viewport=n,e.viewport(n.x,n.y,n.width,n.height)}mM.apply=function(e,t,i){bM(e,t),yM(e,t),wM(e,t),OM(e,t),EM(e,t),TM(e,t),CM(e,t),SM(e,t),AM(e,t),IM(e,t),DM(e,t),xM(e,t,i),PM(e,t,i),MM(e,t,i)},mM.partialApply=function(e,t,i,n,r,a){if(t!==i){var o=i._applyFunctions[t.id];Object(u.a)(o)||(o=function(e,t){var i=[];return e.frontFace!==t.frontFace&&i.push(bM),e.cull.enabled===t.cull.enabled&&e.cull.face===t.cull.face||i.push(yM),e.lineWidth!==t.lineWidth&&i.push(wM),e.polygonOffset.enabled===t.polygonOffset.enabled&&e.polygonOffset.factor===t.polygonOffset.factor&&e.polygonOffset.units===t.polygonOffset.units||i.push(OM),e.depthRange.near===t.depthRange.near&&e.depthRange.far===t.depthRange.far||i.push(EM),e.depthTest.enabled===t.depthTest.enabled&&e.depthTest.func===t.depthTest.func||i.push(TM),e.colorMask.red===t.colorMask.red&&e.colorMask.green===t.colorMask.green&&e.colorMask.blue===t.colorMask.blue&&e.colorMask.alpha===t.colorMask.alpha||i.push(CM),e.depthMask!==t.depthMask&&i.push(SM),e.stencilMask!==t.stencilMask&&i.push(AM),e.stencilTest.enabled===t.stencilTest.enabled&&e.stencilTest.frontFunction===t.stencilTest.frontFunction&&e.stencilTest.backFunction===t.stencilTest.backFunction&&e.stencilTest.reference===t.stencilTest.reference&&e.stencilTest.mask===t.stencilTest.mask&&e.stencilTest.frontOperation.fail===t.stencilTest.frontOperation.fail&&e.stencilTest.frontOperation.zFail===t.stencilTest.frontOperation.zFail&&e.stencilTest.backOperation.fail===t.stencilTest.backOperation.fail&&e.stencilTest.backOperation.zFail===t.stencilTest.backOperation.zFail&&e.stencilTest.backOperation.zPass===t.stencilTest.backOperation.zPass||i.push(IM),e.sampleCoverage.enabled===t.sampleCoverage.enabled&&e.sampleCoverage.value===t.sampleCoverage.value&&e.sampleCoverage.invert===t.sampleCoverage.invert||i.push(DM),i}(t,i),i._applyFunctions[t.id]=o);for(var s=o.length,c=0;c<s;++c)o[c](e,i)}((Object(u.a)(n.scissorTest)?n.scissorTest:t.scissorTest)!==(Object(u.a)(r.scissorTest)?r.scissorTest:i.scissorTest)||a)&&xM(e,i,r);var l=Object(u.a)(n.blendingEnabled)?n.blendingEnabled:t.blending.enabled,h=Object(u.a)(r.blendingEnabled)?r.blendingEnabled:i.blending.enabled;(l!==h||h&&t.blending!==i.blending)&&PM(e,i,r),t===i&&n===r&&n.context===r.context||MM(e,i,r)},mM.getState=function(e){if(!Object(u.a)(e))throw new h.a("renderState is required.");return{frontFace:e.frontFace,cull:{enabled:e.cull.enabled,face:e.cull.face},lineWidth:e.lineWidth,polygonOffset:{enabled:e.polygonOffset.enabled,factor:e.polygonOffset.factor,units:e.polygonOffset.units},scissorTest:{enabled:e.scissorTest.enabled,rectangle:ln.clone(e.scissorTest.rectangle)},depthRange:{near:e.depthRange.near,far:e.depthRange.far},depthTest:{enabled:e.depthTest.enabled,func:e.depthTest.func},colorMask:{red:e.colorMask.red,green:e.colorMask.green,blue:e.colorMask.blue,alpha:e.colorMask.alpha},depthMask:e.depthMask,stencilMask:e.stencilMask,blending:{enabled:e.blending.enabled,color:uf.clone(e.blending.color),equationRgb:e.blending.equationRgb,equationAlpha:e.blending.equationAlpha,functionSourceRgb:e.blending.functionSourceRgb,functionSourceAlpha:e.blending.functionSourceAlpha,functionDestinationRgb:e.blending.functionDestinationRgb,functionDestinationAlpha:e.blending.functionDestinationAlpha},stencilTest:{enabled:e.stencilTest.enabled,frontFunction:e.stencilTest.frontFunction,backFunction:e.stencilTest.backFunction,reference:e.stencilTest.reference,mask:e.stencilTest.mask,frontOperation:{fail:e.stencilTest.frontOperation.fail,zFail:e.stencilTest.frontOperation.zFail,zPass:e.stencilTest.frontOperation.zPass},backOperation:{fail:e.stencilTest.backOperation.fail,zFail:e.stencilTest.backOperation.zFail,zPass:e.stencilTest.backOperation.zPass}},sampleCoverage:{enabled:e.sampleCoverage.enabled,value:e.sampleCoverage.value,invert:e.sampleCoverage.invert},viewport:Object(u.a)(e.viewport)?ln.clone(e.viewport):void 0}};var RM=mM,LM=new z;function NM(e){this._size=e.size,this._datatype=e.datatype,this.getValue=e.getValue}var FM={};FM[un.FLOAT]="float",FM[un.FLOAT_VEC2]="vec2",FM[un.FLOAT_VEC3]="vec3",FM[un.FLOAT_VEC4]="vec4",FM[un.INT]="int",FM[un.INT_VEC2]="ivec2",FM[un.INT_VEC3]="ivec3",FM[un.INT_VEC4]="ivec4",FM[un.BOOL]="bool",FM[un.BOOL_VEC2]="bvec2",FM[un.BOOL_VEC3]="bvec3",FM[un.BOOL_VEC4]="bvec4",FM[un.FLOAT_MAT2]="mat2",FM[un.FLOAT_MAT3]="mat3",FM[un.FLOAT_MAT4]="mat4",FM[un.SAMPLER_2D]="sampler2D",FM[un.SAMPLER_CUBE]="samplerCube",NM.prototype.getDeclaration=function(e){var t="uniform "+FM[this._datatype]+" "+e,i=this._size;return t+=1===i?";":"["+i.toString()+"];"};var kM={czm_viewport:new NM({size:1,datatype:un.FLOAT_VEC4,getValue:function(e){return e.viewportCartesian4}}),czm_viewportOrthographic:new NM({size:1,datatype:un.FLOAT_MAT4,getValue:function(e){return e.viewportOrthographic}}),czm_viewportTransformation:new NM({size:1,datatype:un.FLOAT_MAT4,getValue:function(e){return e.viewportTransformation}}),czm_globeDepthTexture:new NM({size:1,datatype:un.SAMPLER_2D,getValue:function(e){return e.globeDepthTexture}}),czm_model:new NM({size:1,datatype:un.FLOAT_MAT4,getValue:function(e){return e.model}}),czm_inverseModel:new NM({size:1,datatype:un.FLOAT_MAT4,getValue:function(e){return e.inverseModel}}),czm_view:new NM({size:1,datatype:un.FLOAT_MAT4,getValue:function(e){return e.view}}),czm_view3D:new NM({size:1,datatype:un.FLOAT_MAT4,getValue:function(e){return e.view3D}}),czm_viewRotation:new NM({size:1,datatype:un.FLOAT_MAT3,getValue:function(e){return e.viewRotation}}),czm_modelViewRotation:new NM({size:1,datatype:un.FLOAT_MAT3,getValue:function(e){return e.modelViewRotation}}),czm_viewRotation3D:new NM({size:1,datatype:un.FLOAT_MAT3,getValue:function(e){return e.viewRotation3D}}),czm_inverseView:new NM({size:1,datatype:un.FLOAT_MAT4,getValue:function(e){return e.inverseView}}),czm_inverseView3D:new NM({size:1,datatype:un.FLOAT_MAT4,getValue:function(e){return e.inverseView3D}}),czm_inverseViewRotation:new NM({size:1,datatype:un.FLOAT_MAT3,getValue:function(e){return e.inverseViewRotation}}),czm_inverseViewRotation3D:new NM({size:1,datatype:un.FLOAT_MAT3,getValue:function(e){return e.inverseViewRotation3D}}),czm_projection:new NM({size:1,datatype:un.FLOAT_MAT4,getValue:function(e){return e.projection}}),czm_inverseProjection:new NM({size:1,datatype:un.FLOAT_MAT4,getValue:function(e){return e.inverseProjection}}),czm_infiniteProjection:new NM({size:1,datatype:un.FLOAT_MAT4,getValue:function(e){return e.infiniteProjection}}),czm_modelView:new NM({size:1,datatype:un.FLOAT_MAT4,getValue:function(e){return e.modelView}}),czm_modelView3D:new NM({size:1,datatype:un.FLOAT_MAT4,getValue:function(e){return e.modelView3D}}),czm_modelViewRelativeToEye:new NM({size:1,datatype:un.FLOAT_MAT4,getValue:function(e){return e.modelViewRelativeToEye}}),czm_inverseModelView:new NM({size:1,datatype:un.FLOAT_MAT4,getValue:function(e){return e.inverseModelView}}),czm_inverseModelView3D:new NM({size:1,datatype:un.FLOAT_MAT4,getValue:function(e){return e.inverseModelView3D}}),czm_viewProjection:new NM({size:1,datatype:un.FLOAT_MAT4,getValue:function(e){return e.viewProjection}}),czm_inverseViewProjection:new NM({size:1,datatype:un.FLOAT_MAT4,getValue:function(e){return e.inverseViewProjection}}),czm_modelViewProjection:new NM({size:1,datatype:un.FLOAT_MAT4,getValue:function(e){return e.modelViewProjection}}),czm_inverseModelViewProjection:new NM({size:1,datatype:un.FLOAT_MAT4,getValue:function(e){return e.inverseModelViewProjection}}),czm_modelViewProjectionRelativeToEye:new NM({size:1,datatype:un.FLOAT_MAT4,getValue:function(e){return e.modelViewProjectionRelativeToEye}}),czm_modelViewInfiniteProjection:new NM({size:1,datatype:un.FLOAT_MAT4,getValue:function(e){return e.modelViewInfiniteProjection}}),czm_orthographicIn3D:new NM({size:1,datatype:un.FLOAT,getValue:function(e){return e.orthographicIn3D?1:0}}),czm_normal:new NM({size:1,datatype:un.FLOAT_MAT3,getValue:function(e){return e.normal}}),czm_normal3D:new NM({size:1,datatype:un.FLOAT_MAT3,getValue:function(e){return e.normal3D}}),czm_inverseNormal:new NM({size:1,datatype:un.FLOAT_MAT3,getValue:function(e){return e.inverseNormal}}),czm_inverseNormal3D:new NM({size:1,datatype:un.FLOAT_MAT3,getValue:function(e){return e.inverseNormal3D}}),czm_eyeHeight2D:new NM({size:1,datatype:un.FLOAT_VEC2,getValue:function(e){return e.eyeHeight2D}}),czm_entireFrustum:new NM({size:1,datatype:un.FLOAT_VEC2,getValue:function(e){return e.entireFrustum}}),czm_currentFrustum:new NM({size:1,datatype:un.FLOAT_VEC2,getValue:function(e){return e.currentFrustum}}),czm_frustumPlanes:new NM({size:1,datatype:un.FLOAT_VEC4,getValue:function(e){return e.frustumPlanes}}),czm_log2FarDistance:new NM({size:1,datatype:un.FLOAT,getValue:function(e){return e.log2FarDistance}}),czm_log2FarPlusOne:new NM({size:1,datatype:un.FLOAT,getValue:function(e){return e.log2FarPlusOne}}),czm_log2NearDistance:new NM({size:1,datatype:un.FLOAT,getValue:function(e){return e.log2NearDistance}}),czm_sunPositionWC:new NM({size:1,datatype:un.FLOAT_VEC3,getValue:function(e){return e.sunPositionWC}}),czm_sunPositionColumbusView:new NM({size:1,datatype:un.FLOAT_VEC3,getValue:function(e){return e.sunPositionColumbusView}}),czm_sunDirectionEC:new NM({size:1,datatype:un.FLOAT_VEC3,getValue:function(e){return e.sunDirectionEC}}),czm_sunDirectionWC:new NM({size:1,datatype:un.FLOAT_VEC3,getValue:function(e){return e.sunDirectionWC}}),czm_moonDirectionEC:new NM({size:1,datatype:un.FLOAT_VEC3,getValue:function(e){return e.moonDirectionEC}}),czm_encodedCameraPositionMCHigh:new NM({size:1,datatype:un.FLOAT_VEC3,getValue:function(e){return e.encodedCameraPositionMCHigh}}),czm_encodedCameraPositionMCLow:new NM({size:1,datatype:un.FLOAT_VEC3,getValue:function(e){return e.encodedCameraPositionMCLow}}),czm_viewerPositionWC:new NM({size:1,datatype:un.FLOAT_VEC3,getValue:function(e){return Be.getTranslation(e.inverseView,LM)}}),czm_cameraPicth:new NM({size:1,datatype:un.FLOAT,getValue:function(e){return e.cameraPitch}}),czm_planNumber:new NM({size:1,datatype:un.FLOAT,getValue:function(e){return e.cameraPitch<-1.4?0:e.frameState.planNumber}}),czm_frameNumber:new NM({size:1,datatype:un.FLOAT,getValue:function(e){return e.frameState.frameNumber}}),czm_morphTime:new NM({size:1,datatype:un.FLOAT,getValue:function(e){return e.frameState.morphTime}}),czm_sceneMode:new NM({size:1,datatype:un.FLOAT,getValue:function(e){return e.frameState.mode}}),czm_pass:new NM({size:1,datatype:un.FLOAT,getValue:function(e){return e.pass}}),czm_backgroundColor:new NM({size:1,datatype:un.FLOAT_VEC4,getValue:function(e){return e.backgroundColor}}),czm_brdfLut:new NM({size:1,datatype:un.SAMPLER_2D,getValue:function(e){return e.brdfLut}}),czm_environmentMap:new NM({size:1,datatype:un.SAMPLER_CUBE,getValue:function(e){return e.environmentMap}}),czm_specularEnvironmentMaps:new NM({size:1,datatype:un.SAMPLER_2D,getValue:function(e){return e.specularEnvironmentMaps}}),czm_specularEnvironmentMapSize:new NM({size:1,datatype:un.FLOAT_VEC2,getValue:function(e){return e.specularEnvironmentMapsDimensions}}),czm_specularEnvironmentMapsMaximumLOD:new NM({size:1,datatype:un.FLOAT,getValue:function(e){return e.specularEnvironmentMapsMaximumLOD}}),czm_sphericalHarmonicCoefficients:new NM({size:9,datatype:un.FLOAT_VEC3,getValue:function(e){return e.sphericalHarmonicCoefficients}}),czm_temeToPseudoFixed:new NM({size:1,datatype:un.FLOAT_MAT3,getValue:function(e){return e.temeToPseudoFixedMatrix}}),czm_resolutionScale:new NM({size:1,datatype:un.FLOAT,getValue:function(e){return e.resolutionScale}}),czm_fogDensity:new NM({size:1,datatype:un.FLOAT,getValue:function(e){return e.fogDensity}}),czm_imagerySplitPosition:new NM({size:1,datatype:un.FLOAT,getValue:function(e){return e.imagerySplitPosition}}),czm_geometricToleranceOverMeter:new NM({size:1,datatype:un.FLOAT,getValue:function(e){return e.geometricToleranceOverMeter}}),czm_minimumDisableDepthTestDistance:new NM({size:1,datatype:un.FLOAT,getValue:function(e){return e.minimumDisableDepthTestDistance}}),czm_invertClassificationColor:new NM({size:1,datatype:un.FLOAT_VEC4,getValue:function(e){return e.invertClassificationColor}}),czm_gamma:new NM({size:1,datatype:un.FLOAT,getValue:function(e){return e.gamma}}),czm_sunColor:new NM({size:1,datatype:un.FLOAT_VEC3,getValue:function(e){return e.sunColor}}),czm_ambientLight:new NM({size:1,datatype:un.FLOAT_VEC3,getValue:function(e){return e.ambientLight}}),czm_lightScaleFactor:new NM({size:1,datatype:un.FLOAT,getValue:function(e){return e.lightScaleFactor}}),czm_gltfRotation:new NM({size:1,datatype:un.FLOAT_MAT3,getValue:function(e){return e.gltfRotation}}),czm_inverseGltfRotation:new NM({size:1,datatype:un.FLOAT_MAT3,getValue:function(e){return e.inverseGltfRotation}}),czm_inverseSkyBoxModelViewRotation:new NM({size:1,datatype:un.FLOAT_MAT3,getValue:function(e){return e.inverseSkyBoxModelViewRotation}})};function BM(e,t,i,n){this.name=i,this.value=void 0,this._value=0,this._gl=e,this._location=n}function zM(e,t,i,n){this.name=i,this.value=void 0,this._value=new Rt,this._gl=e,this._location=n}function UM(e,t,i,n){this.name=i,this.value=void 0,this._value=void 0,this._gl=e,this._location=n}function VM(e,t,i,n){this.name=i,this.value=void 0,this._value=void 0,this._gl=e,this._location=n}function HM(e,t,i,n){this.name=i,this.value=void 0,this._gl=e,this._location=n,this.textureUnitIndex=void 0}function GM(e,t,i,n){this.name=i,this.value=void 0,this._value=0,this._gl=e,this._location=n}function qM(e,t,i,n){this.name=i,this.value=void 0,this._value=new Rt,this._gl=e,this._location=n}function WM(e,t,i,n){this.name=i,this.value=void 0,this._value=new z,this._gl=e,this._location=n}function YM(e,t,i,n){this.name=i,this.value=void 0,this._value=new Te,this._gl=e,this._location=n}BM.prototype.set=function(){this.value!==this._value&&(this._value=this.value,this._gl.uniform1f(this._location,this.value))},zM.prototype.set=function(){var e=this.value;Rt.equals(e,this._value)||(Rt.clone(e,this._value),this._gl.uniform2f(this._location,e.x,e.y))},UM.prototype.set=function(){var e=this.value;if(Object(u.a)(e.red))uf.equals(e,this._value)||(this._value=uf.clone(e,this._value),this._gl.uniform3f(this._location,e.red,e.green,e.blue));else{if(!Object(u.a)(e.x))throw new h.a('Invalid vec3 value for uniform "'+this.name+'".');z.equals(e,this._value)||(this._value=z.clone(e,this._value),this._gl.uniform3f(this._location,e.x,e.y,e.z))}},VM.prototype.set=function(){var e=this.value;if(Object(u.a)(e.red))uf.equals(e,this._value)||(this._value=uf.clone(e,this._value),this._gl.uniform4f(this._location,e.red,e.green,e.blue,e.alpha));else{if(!Object(u.a)(e.x))throw new h.a('Invalid vec4 value for uniform "'+this.name+'".');Te.equals(e,this._value)||(this._value=Te.clone(e,this._value),this._gl.uniform4f(this._location,e.x,e.y,e.z,e.w))}},HM.prototype.set=function(){var e=this._gl;e.activeTexture(e.TEXTURE0+this.textureUnitIndex);var t=this.value;e.bindTexture(t._target,t._texture)},HM.prototype._setSampler=function(e){return this.textureUnitIndex=e,this._gl.uniform1i(this._location,e),e+1},GM.prototype.set=function(){this.value!==this._value&&(this._value=this.value,this._gl.uniform1i(this._location,this.value))},qM.prototype.set=function(){var e=this.value;Rt.equals(e,this._value)||(Rt.clone(e,this._value),this._gl.uniform2i(this._location,e.x,e.y))},WM.prototype.set=function(){var e=this.value;z.equals(e,this._value)||(z.clone(e,this._value),this._gl.uniform3i(this._location,e.x,e.y,e.z))},YM.prototype.set=function(){var e=this.value;Te.equals(e,this._value)||(Te.clone(e,this._value),this._gl.uniform4i(this._location,e.x,e.y,e.z,e.w))};var XM=new Float32Array(4);function ZM(e,t,i,n){this.name=i,this.value=void 0,this._value=new vn,this._gl=e,this._location=n}ZM.prototype.set=function(){if(!vn.equalsArray(this.value,this._value,0)){vn.clone(this.value,this._value);var e=vn.toArray(this.value,XM);this._gl.uniformMatrix2fv(this._location,!1,e)}};var QM=new Float32Array(9);function KM(e,t,i,n){this.name=i,this.value=void 0,this._value=new be,this._gl=e,this._location=n}KM.prototype.set=function(){if(!be.equalsArray(this.value,this._value,0)){be.clone(this.value,this._value);var e=be.toArray(this.value,QM);this._gl.uniformMatrix3fv(this._location,!1,e)}};var JM=new Float32Array(16);function $M(e,t,i,n){this.name=i,this.value=void 0,this._value=new Be,this._gl=e,this._location=n}$M.prototype.set=function(){if(!Be.equalsArray(this.value,this._value,0)){Be.clone(this.value,this._value);var e=Be.toArray(this.value,JM);this._gl.uniformMatrix4fv(this._location,!1,e)}};var eR=function(e,t,i,n){switch(t.type){case e.FLOAT:return new BM(e,t,i,n);case e.FLOAT_VEC2:return new zM(e,t,i,n);case e.FLOAT_VEC3:return new UM(e,t,i,n);case e.FLOAT_VEC4:return new VM(e,t,i,n);case e.SAMPLER_2D:case e.SAMPLER_3D:case e.SAMPLER_CUBE:return new HM(e,t,i,n);case e.INT:case e.BOOL:return new GM(e,t,i,n);case e.INT_VEC2:case e.BOOL_VEC2:return new qM(e,t,i,n);case e.INT_VEC3:case e.BOOL_VEC3:return new WM(e,t,i,n);case e.INT_VEC4:case e.BOOL_VEC4:return new YM(e,t,i,n);case e.FLOAT_MAT2:return new ZM(e,t,i,n);case e.FLOAT_MAT3:return new KM(e,t,i,n);case e.FLOAT_MAT4:return new $M(e,t,i,n);default:throw new Ce.a("Unrecognized uniform type: "+t.type+' for uniform "'+i+'".')}};function tR(e,t,i,n){var r=n.length;this.name=i,this.value=new Array(r),this._value=new Float32Array(r),this._gl=e,this._location=n[0]}function iR(e,t,i,n){var r=n.length;this.name=i,this.value=new Array(r),this._value=new Float32Array(2*r),this._gl=e,this._location=n[0]}function nR(e,t,i,n){var r=n.length;this.name=i,this.value=new Array(r),this._value=new Float32Array(3*r),this._gl=e,this._location=n[0]}function rR(e,t,i,n){var r=n.length;this.name=i,this.value=new Array(r),this._value=new Float32Array(4*r),this._gl=e,this._location=n[0]}function aR(e,t,i,n){var r=n.length;this.name=i,this.value=new Array(r),this._value=new Float32Array(r),this._gl=e,this._locations=n,this.textureUnitIndex=void 0}function oR(e,t,i,n){var r=n.length;this.name=i,this.value=new Array(r),this._value=new Int32Array(r),this._gl=e,this._location=n[0]}function sR(e,t,i,n){var r=n.length;this.name=i,this.value=new Array(r),this._value=new Int32Array(2*r),this._gl=e,this._location=n[0]}function cR(e,t,i,n){var r=n.length;this.name=i,this.value=new Array(r),this._value=new Int32Array(3*r),this._gl=e,this._location=n[0]}function lR(e,t,i,n){var r=n.length;this.name=i,this.value=new Array(r),this._value=new Int32Array(4*r),this._gl=e,this._location=n[0]}function uR(e,t,i,n){var r=n.length;this.name=i,this.value=new Array(r),this._value=new Float32Array(4*r),this._gl=e,this._location=n[0]}function hR(e,t,i,n){var r=n.length;this.name=i,this.value=new Array(r),this._value=new Float32Array(9*r),this._gl=e,this._location=n[0]}function dR(e,t,i,n){var r=n.length;this.name=i,this.value=new Array(r),this._value=new Float32Array(16*r),this._gl=e,this._location=n[0]}tR.prototype.set=function(){for(var e=this.value,t=e.length,i=this._value,n=!1,r=0;r<t;++r){var a=e[r];a!==i[r]&&(i[r]=a,n=!0)}n&&this._gl.uniform1fv(this._location,i)},iR.prototype.set=function(){for(var e=this.value,t=e.length,i=this._value,n=!1,r=0,a=0;a<t;++a){var o=e[a];Rt.equalsArray(o,i,r)||(Rt.pack(o,i,r),n=!0),r+=2}n&&this._gl.uniform2fv(this._location,i)},nR.prototype.set=function(){for(var e=this.value,t=e.length,i=this._value,n=!1,r=0,a=0;a<t;++a){var o=e[a];if(Object(u.a)(o.red))o.red===i[r]&&o.green===i[r+1]&&o.blue===i[r+2]||(i[r]=o.red,i[r+1]=o.green,i[r+2]=o.blue,n=!0);else{if(!Object(u.a)(o.x))throw new h.a("Invalid vec3 value.");z.equalsArray(o,i,r)||(z.pack(o,i,r),n=!0)}r+=3}n&&this._gl.uniform3fv(this._location,i)},rR.prototype.set=function(){for(var e=this.value,t=e.length,i=this._value,n=!1,r=0,a=0;a<t;++a){var o=e[a];if(Object(u.a)(o.red))uf.equalsArray(o,i,r)||(uf.pack(o,i,r),n=!0);else{if(!Object(u.a)(o.x))throw new h.a("Invalid vec4 value.");Te.equalsArray(o,i,r)||(Te.pack(o,i,r),n=!0)}r+=4}n&&this._gl.uniform4fv(this._location,i)},aR.prototype.set=function(){for(var e=this._gl,t=e.TEXTURE0+this.textureUnitIndex,i=this.value,n=i.length,r=0;r<n;++r){var a=i[r];e.activeTexture(t+r),e.bindTexture(a._target,a._texture)}},aR.prototype._setSampler=function(e){this.textureUnitIndex=e;for(var t=this._locations,i=t.length,n=0;n<i;++n){var r=e+n;this._gl.uniform1i(t[n],r)}return e+i},oR.prototype.set=function(){for(var e=this.value,t=e.length,i=this._value,n=!1,r=0;r<t;++r){var a=e[r];a!==i[r]&&(i[r]=a,n=!0)}n&&this._gl.uniform1iv(this._location,i)},sR.prototype.set=function(){for(var e=this.value,t=e.length,i=this._value,n=!1,r=0,a=0;a<t;++a){var o=e[a];Rt.equalsArray(o,i,r)||(Rt.pack(o,i,r),n=!0),r+=2}n&&this._gl.uniform2iv(this._location,i)},cR.prototype.set=function(){for(var e=this.value,t=e.length,i=this._value,n=!1,r=0,a=0;a<t;++a){var o=e[a];z.equalsArray(o,i,r)||(z.pack(o,i,r),n=!0),r+=3}n&&this._gl.uniform3iv(this._location,i)},lR.prototype.set=function(){for(var e=this.value,t=e.length,i=this._value,n=!1,r=0,a=0;a<t;++a){var o=e[a];Te.equalsArray(o,i,r)||(Te.pack(o,i,r),n=!0),r+=4}n&&this._gl.uniform4iv(this._location,i)},uR.prototype.set=function(){for(var e=this.value,t=e.length,i=this._value,n=!1,r=0,a=0;a<t;++a){var o=e[a];vn.equalsArray(o,i,r)||(vn.pack(o,i,r),n=!0),r+=4}n&&this._gl.uniformMatrix2fv(this._location,!1,i)},hR.prototype.set=function(){for(var e=this.value,t=e.length,i=this._value,n=!1,r=0,a=0;a<t;++a){var o=e[a];be.equalsArray(o,i,r)||(be.pack(o,i,r),n=!0),r+=9}n&&this._gl.uniformMatrix3fv(this._location,!1,i)},dR.prototype.set=function(){for(var e=this.value,t=e.length,i=this._value,n=!1,r=0,a=0;a<t;++a){var o=e[a];Be.equalsArray(o,i,r)||(Be.pack(o,i,r),n=!0),r+=16}n&&this._gl.uniformMatrix4fv(this._location,!1,i)};var fR=function(e,t,i,n){switch(t.type){case e.FLOAT:return new tR(e,t,i,n);case e.FLOAT_VEC2:return new iR(e,t,i,n);case e.FLOAT_VEC3:return new nR(e,t,i,n);case e.FLOAT_VEC4:return new rR(e,t,i,n);case e.SAMPLER_2D:case e.SAMPLER_CUBE:return new aR(e,t,i,n);case e.INT:case e.BOOL:return new oR(e,t,i,n);case e.INT_VEC2:case e.BOOL_VEC2:return new sR(e,t,i,n);case e.INT_VEC3:case e.BOOL_VEC3:return new cR(e,t,i,n);case e.INT_VEC4:case e.BOOL_VEC4:return new lR(e,t,i,n);case e.FLOAT_MAT2:return new uR(e,t,i,n);case e.FLOAT_MAT3:return new hR(e,t,i,n);case e.FLOAT_MAT4:return new dR(e,t,i,n);default:throw new Ce.a("Unrecognized uniform type: "+t.type+' for uniform "'+i+'".')}},pR=0;function mR(e){var t=function(e,t){var i={};if(!HD.highpFloatSupported||!HD.highpIntSupported){var n,r,a,o,s=_R(e),c=_R(t),l=s.length,u=c.length;for(n=0;n<l;n++)for(r=0;r<u;r++)if(s[n]===c[r]){a=s[n],o="czm_mediump_"+a;var h=new RegExp(a+"\\b","g");t=t.replace(h,o),i[o]=a}}return{fragmentShaderText:t,duplicateUniformNames:i}}(e.vertexShaderText,e.fragmentShaderText);this._gl=e.gl,this._logShaderCompilation=e.logShaderCompilation,this._debugShaders=e.debugShaders,this._attributeLocations=e.attributeLocations,this._program=void 0,this._numberOfVertexAttributes=void 0,this._vertexAttributes=void 0,this._uniformsByName=void 0,this._uniforms=void 0,this._automaticUniforms=void 0,this._manualUniforms=void 0,this._duplicateUniformNames=t.duplicateUniformNames,this._cachedShader=void 0,this.maximumTextureUnitIndex=void 0,this._vertexShaderSource=e.vertexShaderSource,this._vertexShaderText=e.vertexShaderText,this._fragmentShaderSource=e.fragmentShaderSource,this._fragmentShaderText=t.fragmentShaderText,this.id=pR++}function _R(e){var t=[],i=e.match(/uniform.*?(?![^{]*})(?=[=\[;])/g);if(Object(u.a)(i))for(var n=i.length,r=0;r<n;r++){var a=i[r].trim(),o=a.slice(a.lastIndexOf(" ")+1);t.push(o)}return t}mR.fromCache=function(e){return e=Object(w.a)(e,w.a.EMPTY_OBJECT),x.a.defined("options.context",e.context),e.context.shaderCache.getShaderProgram(e)},mR.replaceCache=function(e){return e=Object(w.a)(e,w.a.EMPTY_OBJECT),x.a.defined("options.context",e.context),e.context.shaderCache.replaceShaderProgram(e)},Object(O.a)(mR.prototype,{vertexShaderSource:{get:function(){return this._vertexShaderSource}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},vertexAttributes:{get:function(){return vR(this),this._vertexAttributes}},numberOfVertexAttributes:{get:function(){return vR(this),this._numberOfVertexAttributes}},allUniforms:{get:function(){return vR(this),this._uniformsByName}}});var gR="[Cesium WebGL] ";function vR(e){if(!Object(u.a)(e._program)){var t=e._gl,i=function(e,t){var i=t._vertexShaderText,n=t._fragmentShaderText,r=e.createShader(e.VERTEX_SHADER);e.shaderSource(r,i),e.compileShader(r);var a=e.createShader(e.FRAGMENT_SHADER);e.shaderSource(a,n),e.compileShader(a);var o=e.createProgram();e.attachShader(o,r),e.attachShader(o,a),e.deleteShader(r),e.deleteShader(a);var s,c=t._attributeLocations;if(Object(u.a)(c))for(var l in c)c.hasOwnProperty(l)&&e.bindAttribLocation(o,c[l],l);if(e.linkProgram(o),!e.getProgramParameter(o,e.LINK_STATUS)){var h=t._debugShaders;if(!e.getShaderParameter(a,e.COMPILE_STATUS)){if(s=e.getShaderInfoLog(a),console.error(gR+"Fragment shader compile log: "+s),Object(u.a)(h)){var d=h.getTranslatedShaderSource(a);""!==d?console.error(gR+"Translated fragment shader source:\n"+d):console.error(gR+"Fragment shader translation failed.")}throw e.deleteProgram(o),new Ce.a("Fragment shader failed to compile.  Compile log: "+s)}if(!e.getShaderParameter(r,e.COMPILE_STATUS)){if(s=e.getShaderInfoLog(r),console.error(gR+"Vertex shader compile log: "+s),Object(u.a)(h)){var f=h.getTranslatedShaderSource(r);""!==f?console.error(gR+"Translated vertex shader source:\n"+f):console.error(gR+"Vertex shader translation failed.")}throw e.deleteProgram(o),new Ce.a("Vertex shader failed to compile.  Compile log: "+s)}throw s=e.getProgramInfoLog(o),console.error(gR+"Shader program link log: "+s),Object(u.a)(h)&&(console.error(gR+"Translated vertex shader source:\n"+h.getTranslatedShaderSource(r)),console.error(gR+"Translated fragment shader source:\n"+h.getTranslatedShaderSource(a))),e.deleteProgram(o),new Ce.a("Program failed to link.  Link log: "+s)}var p=t._logShaderCompilation;return p&&(s=e.getShaderInfoLog(r),Object(u.a)(s)&&s.length>0&&console.log(gR+"Vertex shader compile log: "+s)),p&&(s=e.getShaderInfoLog(a),Object(u.a)(s)&&s.length>0&&console.log(gR+"Fragment shader compile log: "+s)),p&&(s=e.getProgramInfoLog(o),Object(u.a)(s)&&s.length>0&&console.log(gR+"Shader program link log: "+s)),o}(t,e,e._debugShaders),n=t.getProgramParameter(i,t.ACTIVE_ATTRIBUTES),r=function(e,t){for(var i={},n=[],r=[],a=[],o=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),s=0;s<o;++s){var c=e.getActiveUniform(t,s),l=-1!==c.name.indexOf("[0]",c.name.length-"[0]".length)?c.name.slice(0,c.name.length-3):c.name;if(0!==l.indexOf("gl_"))if(c.name.indexOf("ubo_")>=0){var h=c.name.split(".")[0];a.indexOf(h)<0&&a.push(h)}else if(c.name.indexOf("[")<0){var d=e.getUniformLocation(t,l);if(null!==d){var f=eR(e,c,l,d);i[l]=f,n.push(f),f._setSampler&&r.push(f)}}else{var p,m,_,g,v=l.indexOf("[");if(v>=0){if(p=i[l.slice(0,v)],!Object(u.a)(p))continue;(m=p._locations).length<=1&&(_=p.value,null!==(g=e.getUniformLocation(t,l))&&(m.push(g),_.push(e.getUniform(t,g))))}else{m=[];for(var b=0;b<c.size;++b)null!==(g=e.getUniformLocation(t,l+"["+b+"]"))&&m.push(g);p=fR(e,c,l,m),i[l]=p,n.push(p),p._setSampler&&r.push(p)}}}return{uniformsByName:i,uniforms:n,samplerUniforms:r,uniformBlocks:a}}(t,i),a=function(e,t){var i=[],n=[];for(var r in t)if(t.hasOwnProperty(r)){var a=t[r],o=r,s=e._duplicateUniformNames[o];Object(u.a)(s)&&(a.name=s,o=s);var c=kM[o];Object(u.a)(c)?i.push({uniform:a,automaticUniform:c}):n.push(a)}return{automaticUniforms:i,manualUniforms:n}}(e,r.uniformsByName);!function(e,t,i){for(var n=0;n<i.length;++n){var r=i[n],a=e.getUniformBlockIndex(t,r);e.uniformBlockBinding(t,a,n)}}(t,i,r.uniformBlocks),e._program=i,e._numberOfVertexAttributes=n,e._vertexAttributes=function(e,t,i){for(var n={},r=0;r<i;++r){var a=e.getActiveAttrib(t,r),o=e.getAttribLocation(t,a.name);n[a.name]={name:a.name,type:a.type,index:o}}return n}(t,i,n),e._uniformsByName=r.uniformsByName,e._uniforms=r.uniforms,e._automaticUniforms=a.automaticUniforms,e._manualUniforms=a.manualUniforms,e.maximumTextureUnitIndex=function(e,t,i){e.useProgram(t);for(var n=0,r=i.length,a=0;a<r;++a)n=i[a]._setSampler(n);return e.useProgram(null),n}(t,i,r.samplerUniforms)}}mR.prototype._bind=function(){vR(this),this._gl.useProgram(this._program)},mR.prototype._setUniforms=function(e,t,i){var n,r;if(Object(u.a)(e)){var a=this._manualUniforms;for(n=a.length,r=0;r<n;++r){var o=a[r];o.value=e[o.name]()}}var s=this._automaticUniforms;for(n=s.length,r=0;r<n;++r){var c=s[r];c.uniform.value=c.automaticUniform.getValue(t)}var l=this._uniforms;for(n=l.length,r=0;r<n;++r)l[r].set();if(i){var d=this._gl,f=this._program;if(d.validateProgram(f),!d.getProgramParameter(f,d.VALIDATE_STATUS))throw new h.a("Program validation failed.  Program info log: "+d.getProgramInfoLog(f))}},mR.prototype.isDestroyed=function(){return!1},mR.prototype.destroy=function(){this._cachedShader.cache.releaseShaderProgram(this)},mR.prototype.finalDestroy=function(){return this._gl.deleteProgram(this._program),rl(this)};var bR=mR;function yR(e,t,i){for(var n=new RegExp("(^|[^\\w])("+e+")($|[^\\w])","g"),r=i.length,a=0;a<r;++a){var o=i[a];i[a]=o.replace(n,"$1"+t+"$3")}}function wR(e,t){-1===t.indexOf(e)&&t.push(e)}var OR=function(e,t){var i,n,r=/#define OUTPUT_DECLARATION/,a=e.split("\n"),o=-1;for(i=0;i<a.length;++i)if(n=a[i],r.test(n)){o=i;break}if(-1===o)throw new h.a("Could not find a #define OUTPUT_DECLARATION!");var s=[];for(i=0;i<10;i++){var c="gl_FragData\\["+i+"\\]",l="czm_out"+i;new RegExp(c,"g").test(e)&&(wR(l,s),yR(c,l,a),a.splice(o,0,"layout(location = "+i+") out vec4 "+l+";"),o+=1)}var d=function(e,t){for(var i={},n=e.length,r=[],a=0;a<t.length;++a){var o=t[a],s=/(#ifdef|#if)/g.test(o),c=/#else/g.test(o),l=/#endif/g.test(o);if(s)r.push(o);else if(c){var h=r[r.length-1].replace("ifdef","ifndef");/if/g.test(h)&&(h=h.replace(/(#if\s+)(\S*)([^]*)/,"$1!($2)$3")),r.pop(),r.push(h)}else if(l)r.pop();else if(!/layout/g.test(o))for(var d=0;d<n;++d){var f=e[d];-1!==o.indexOf(f)&&(Object(u.a)(i[f])?i[f]=i[f].filter((function(e){return r.indexOf(e)>=0})):i[f]=r.slice())}}return i}(s,a),f={};for(i=0;i<a.length;i++)for(var p in n=a[i],d){if(d.hasOwnProperty(p))new RegExp("(layout)[^]+(out)[^]+("+p+")[^]+","g").test(n)&&(f[n]=p)}for(var m in f)if(f.hasOwnProperty(m)){var _,g=f[m],v=a.indexOf(m),b=d[g],y=b.length;for(_=0;_<y;_++)a.splice(v,0,b[_]);for(v+=y+1,_=y-1;_>=0;_--)a.splice(v,0,"#endif //"+b[_])}return function(e){for(var t="",i=e.length,n=0;n<i;++n)t+=e[n]+"\n";return t}(a)},xR="const float czm_degreesPerRadian = 57.29577951308232;\n",ER="const czm_depthRangeStruct czm_depthRange = czm_depthRangeStruct(0.0, 1.0);\n",TR="const float czm_epsilon1 = 0.1;\n",CR="const float czm_epsilon2 = 0.01;\n",SR="const float czm_epsilon3 = 0.001;\n",AR="const float czm_epsilon4 = 0.0001;\n",PR="const float czm_epsilon5 = 0.00001;\n",IR="const float czm_epsilon6 = 0.000001;\n",DR="const float czm_epsilon7 = 0.0000001;\n",jR="const float czm_infinity = 5906376272000.0;\n",MR="const float czm_oneOverPi = 0.3183098861837907;\n",RR="const float czm_oneOverTwoPi = 0.15915494309189535;\n",LR="const float czm_passCesium3DTile = 4.0;\n",NR="const float czm_passCesium3DTileClassification = 5.0;\n",FR="const float czm_passCesium3DTileClassificationIgnoreShow = 6.0;\n",kR="const float czm_passClassification = 7.0;\n",BR="const float czm_passCompute = 1.0;\n",zR="const float czm_passEnvironment = 0.0;\n",UR="const float czm_passGlobe = 2.0;\n",VR="const float czm_passOpaque = 7.0;\n",HR="const float czm_passOverlay = 9.0;\n",GR="const float czm_passTerrainClassification = 3.0;\n",qR="const float czm_passTranslucent = 8.0;\n",WR="const float czm_pi = 3.141592653589793;\n",YR="const float czm_piOverFour = 0.7853981633974483;\n",XR="const float czm_piOverSix = 0.5235987755982988;\n",ZR="const float czm_piOverThree = 1.0471975511965976;\n",QR="const float czm_piOverTwo = 1.5707963267948966;\n",KR="const float czm_radiansPerDegree = 0.017453292519943295;\n",JR="const float czm_sceneMode2D = 2.0;\n",$R="const float czm_sceneMode3D = 3.0;\n",eL="const float czm_sceneModeColumbusView = 1.0;\n",tL="const float czm_sceneModeMorphing = 0.0;\n",iL="const float czm_solarRadius = 695500000.0;\n",nL="const float czm_threePiOver2 = 4.71238898038469;\n",rL="const float czm_twoPi = 6.283185307179586;\n",aL="const float czm_webMercatorMaxLatitude = 1.4844222297453324;\n",oL="struct czm_combineMaterial\n{\nvec4 pbrBaseColor;\nfloat pbrMetallic;\nfloat pbrRoughness;\nfloat pbrIZbufferPriority;\nfloat pbrPrepareData;\n};\n",sL="struct czm_depthRangeStruct\n{\nfloat near;\nfloat far;\n};\n",cL="struct czm_ellipsoid\n{\nvec3 center;\nvec3 radii;\nvec3 inverseRadii;\nvec3 inverseRadiiSquared;\n};\n",lL="struct czm_material\n{\nvec3 diffuse;\nfloat specular;\nfloat shininess;\nvec3 normal;\nvec3 emission;\nfloat alpha;\n};\n",uL="struct czm_materialInput\n{\nfloat s;\nvec2 st;\nvec3 str;\nvec3 normalEC;\nmat3 tangentToEyeMatrix;\nvec3 positionToEyeEC;\nfloat height;\nfloat slope;\n};\n",hL="struct czm_ray\n{\nvec3 origin;\nvec3 direction;\n};\n",dL="struct czm_raySegment\n{\nfloat start;\nfloat stop;\n};\nconst czm_raySegment czm_emptyRaySegment = czm_raySegment(-czm_infinity, -czm_infinity);\nconst czm_raySegment czm_fullRaySegment = czm_raySegment(0.0, czm_infinity);\n",fL="struct czm_shadowParameters\n{\n#ifdef USE_CUBE_MAP_SHADOW\nvec3 texCoords;\n#else\nvec2 texCoords;\n#endif\nfloat depthBias;\nfloat depth;\nfloat nDotL;\nvec2 texelStepSize;\nfloat normalShadingSmooth;\nfloat darkness;\n};\n",pL="float czm_alphaWeight(float a)\n{\nfloat z = (gl_FragCoord.z - czm_viewportTransformation[3][2]) / czm_viewportTransformation[2][2];\nreturn pow(a + 0.01, 4.0) + max(1e-2, min(3.0 * 1e3, 0.003 / (1e-5 + pow(abs(z) / 200.0, 4.0))));\n}\n",mL="vec4 czm_antialias(vec4 color1, vec4 color2, vec4 currentColor, float dist, float fuzzFactor)\n{\nfloat val1 = clamp(dist / fuzzFactor, 0.0, 1.0);\nfloat val2 = clamp((dist - 0.5) / fuzzFactor, 0.0, 1.0);\nval1 = val1 * (1.0 - val2);\nval1 = val1 * val1 * (3.0 - (2.0 * val1));\nval1 = pow(val1, 0.5);\nvec4 midColor = (color1 + color2) * 0.5;\nreturn mix(midColor, currentColor, val1);\n}\nvec4 czm_antialias(vec4 color1, vec4 color2, vec4 currentColor, float dist)\n{\nreturn czm_antialias(color1, color2, currentColor, dist, 0.1);\n}\n",_L="vec2 czm_approximateSphericalCoordinates(vec3 normal) {\nfloat latitudeApproximation = czm_fastApproximateAtan(sqrt(normal.x * normal.x + normal.y * normal.y), normal.z);\nfloat longitudeApproximation = czm_fastApproximateAtan(normal.x, normal.y);\nreturn vec2(latitudeApproximation, longitudeApproximation);\n}\n",gL="float czm_branchFreeTernary(bool comparison, float a, float b) {\nfloat useA = float(comparison);\nreturn a * useA + b * (1.0 - useA);\n}\nvec2 czm_branchFreeTernary(bool comparison, vec2 a, vec2 b) {\nfloat useA = float(comparison);\nreturn a * useA + b * (1.0 - useA);\n}\nvec3 czm_branchFreeTernary(bool comparison, vec3 a, vec3 b) {\nfloat useA = float(comparison);\nreturn a * useA + b * (1.0 - useA);\n}\nvec4 czm_branchFreeTernary(bool comparison, vec4 a, vec4 b) {\nfloat useA = float(comparison);\nreturn a * useA + b * (1.0 - useA);\n}\n",vL="vec4 czm_cascadeColor(vec4 weights)\n{\nreturn vec4(1.0, 0.0, 0.0, 1.0) * weights.x +\nvec4(0.0, 1.0, 0.0, 1.0) * weights.y +\nvec4(0.0, 0.0, 1.0, 1.0) * weights.z +\nvec4(1.0, 0.0, 1.0, 1.0) * weights.w;\n}\n",bL="uniform vec4 shadowMap_cascadeDistances;\nfloat czm_cascadeDistance(vec4 weights)\n{\nreturn dot(shadowMap_cascadeDistances, weights);\n}\n",yL="uniform mat4 shadowMap_cascadeMatrices[4];\nmat4 czm_cascadeMatrix(vec4 weights)\n{\nreturn shadowMap_cascadeMatrices[0] * weights.x +\nshadowMap_cascadeMatrices[1] * weights.y +\nshadowMap_cascadeMatrices[2] * weights.z +\nshadowMap_cascadeMatrices[3] * weights.w;\n}\n",wL="uniform vec4 shadowMap_cascadeSplits[2];\nvec4 czm_cascadeWeights(float depthEye)\n{\nvec4 near = step(shadowMap_cascadeSplits[0], vec4(depthEye));\nvec4 far = step(depthEye, shadowMap_cascadeSplits[1]);\nreturn near * far;\n}\n",OL="vec4 czm_columbusViewMorph(vec4 position2D, vec4 position3D, float time)\n{\nvec3 p = mix(position2D.xyz, position3D.xyz, time);\nreturn vec4(p, 1.0);\n}\n",xL="vec4 czm_computePosition();\n",EL="vec2 cordic(float angle)\n{\nvec2 vector = vec2(6.0725293500888267e-1, 0.0);\nfloat sense = (angle < 0.0) ? -1.0 : 1.0;\nmat2 rotation = mat2(1.0, sense, -sense, 1.0);\nvector = rotation * vector;\nangle -= sense * 7.8539816339744828e-1;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfloat factor = sense * 5.0e-1;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 4.6364760900080609e-1;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 2.5e-1;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 2.4497866312686414e-1;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 1.25e-1;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 1.2435499454676144e-1;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 6.25e-2;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 6.2418809995957350e-2;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 3.125e-2;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 3.1239833430268277e-2;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 1.5625e-2;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 1.5623728620476831e-2;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 7.8125e-3;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 7.8123410601011111e-3;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 3.90625e-3;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 3.9062301319669718e-3;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 1.953125e-3;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 1.9531225164788188e-3;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 9.765625e-4;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 9.7656218955931946e-4;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 4.8828125e-4;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 4.8828121119489829e-4;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 2.44140625e-4;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 2.4414062014936177e-4;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 1.220703125e-4;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 1.2207031189367021e-4;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 6.103515625e-5;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 6.1035156174208773e-5;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 3.0517578125e-5;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 3.0517578115526096e-5;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 1.52587890625e-5;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 1.5258789061315762e-5;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 7.62939453125e-6;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 7.6293945311019700e-6;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 3.814697265625e-6;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 3.8146972656064961e-6;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 1.9073486328125e-6;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 1.9073486328101870e-6;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 9.5367431640625e-7;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 9.5367431640596084e-7;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 4.76837158203125e-7;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 4.7683715820308884e-7;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 2.384185791015625e-7;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nangle -= sense * 2.3841857910155797e-7;\nsense = (angle < 0.0) ? -1.0 : 1.0;\nfactor = sense * 1.1920928955078125e-7;\nrotation[0][1] = factor;\nrotation[1][0] = -factor;\nvector = rotation * vector;\nreturn vector;\n}\nvec2 czm_cosineAndSine(float angle)\n{\nif (angle < -czm_piOverTwo || angle > czm_piOverTwo)\n{\nif (angle < 0.0)\n{\nreturn -cordic(angle + czm_pi);\n}\nelse\n{\nreturn -cordic(angle - czm_pi);\n}\n}\nelse\n{\nreturn cordic(angle);\n}\n}\n",TL="vec2 czm_decompressTextureCoordinates(float encoded)\n{\nfloat temp = encoded / 4096.0;\nfloat xZeroTo4095 = floor(temp);\nfloat stx = xZeroTo4095 / 4095.0;\nfloat sty = (encoded - xZeroTo4095 * 4096.0) / 4095.0;\nreturn vec2(stx, sty);\n}\n",CL="#ifndef LOG_DEPTH\nvarying float v_WindowZ;\n#endif\nvec4 czm_depthClampFarPlane(vec4 coords)\n{\n#ifndef LOG_DEPTH\nv_WindowZ = (0.5 * (coords.z / coords.w) + 0.5) * coords.w;\ncoords.z = min(coords.z, coords.w);\n#endif\nreturn coords;\n}\n",SL="mat3 czm_eastNorthUpToEyeCoordinates(vec3 positionMC, vec3 normalEC)\n{\nvec3 tangentMC = normalize(vec3(-positionMC.y, positionMC.x, 0.0));\nvec3 tangentEC = normalize(czm_normal3D * tangentMC);\nvec3 bitangentEC = normalize(cross(normalEC, tangentEC));\nreturn mat3(\ntangentEC.x,   tangentEC.y,   tangentEC.z,\nbitangentEC.x, bitangentEC.y, bitangentEC.z,\nnormalEC.x,    normalEC.y,    normalEC.z);\n}\n",AL="bool czm_ellipsoidContainsPoint(czm_ellipsoid ellipsoid, vec3 point)\n{\nvec3 scaled = ellipsoid.inverseRadii * (czm_inverseModelView * vec4(point, 1.0)).xyz;\nreturn (dot(scaled, scaled) <= 1.0);\n}\n",PL="czm_ellipsoid czm_ellipsoidNew(vec3 center, vec3 radii)\n{\nvec3 inverseRadii = vec3(1.0 / radii.x, 1.0 / radii.y, 1.0 / radii.z);\nvec3 inverseRadiiSquared = inverseRadii * inverseRadii;\nczm_ellipsoid temp = czm_ellipsoid(center, radii, inverseRadii, inverseRadiiSquared);\nreturn temp;\n}\n",IL="vec2 czm_ellipsoidWgs84TextureCoordinates(vec3 normal)\n{\nreturn vec2(atan(normal.y, normal.x) * czm_oneOverTwoPi + 0.5, asin(normal.z) * czm_oneOverPi + 0.5);\n}\n",DL="bool czm_equalsEpsilon(vec4 left, vec4 right, float epsilon) {\nreturn all(lessThanEqual(abs(left - right), vec4(epsilon)));\n}\nbool czm_equalsEpsilon(vec3 left, vec3 right, float epsilon) {\nreturn all(lessThanEqual(abs(left - right), vec3(epsilon)));\n}\nbool czm_equalsEpsilon(vec2 left, vec2 right, float epsilon) {\nreturn all(lessThanEqual(abs(left - right), vec2(epsilon)));\n}\nbool czm_equalsEpsilon(float left, float right, float epsilon) {\nreturn (abs(left - right) <= epsilon);\n}\n",jL="vec4 czm_eyeOffset(vec4 positionEC, vec3 eyeOffset)\n{\nvec4 p = positionEC;\nvec4 zEyeOffset = normalize(p) * eyeOffset.z;\np.xy += eyeOffset.xy + zEyeOffset.xy;\np.z += zEyeOffset.z;\nreturn p;\n}\n",ML="vec4 czm_eyeToWindowCoordinates(vec4 positionEC)\n{\nvec4 q = czm_projection * positionEC;\nq.xyz /= q.w;\nq.xyz = (czm_viewportTransformation * vec4(q.xyz, 1.0)).xyz;\nreturn q;\n}\n",RL="float czm_fastApproximateAtan(float x) {\nreturn x * (-0.1784 * x - 0.0663 * x * x + 1.0301);\n}\nfloat czm_fastApproximateAtan(float x, float y) {\nfloat t = abs(x);\nfloat opposite = abs(y);\nfloat adjacent = max(t, opposite);\nopposite = min(t, opposite);\nt = czm_fastApproximateAtan(opposite / adjacent);\nt = czm_branchFreeTernary(abs(y) > abs(x), czm_piOverTwo - t, t);\nt = czm_branchFreeTernary(x < 0.0, czm_pi - t, t);\nt = czm_branchFreeTernary(y < 0.0, -t, t);\nreturn t;\n}\n",LL="vec3 czm_fog(float distanceToCamera, vec3 color, vec3 fogColor)\n{\nfloat scalar = distanceToCamera * czm_fogDensity;\nfloat fog = 1.0 - exp(-(scalar * scalar));\nreturn mix(color, fogColor, fog);\n}\nvec3 czm_fog(float distanceToCamera, vec3 color, vec3 fogColor, float fogModifierConstant)\n{\nfloat scalar = distanceToCamera * czm_fogDensity;\nfloat fog = 1.0 - exp(-((fogModifierConstant * scalar + fogModifierConstant) * (scalar * (1.0 + fogModifierConstant))));\nreturn mix(color, fogColor, fog);\n}\n",NL="vec3 czm_gammaCorrect(vec3 color) {\n#ifdef HDR\ncolor = pow(color, vec3(czm_gamma));\n#endif\nreturn color;\n}\nvec4 czm_gammaCorrect(vec4 color) {\n#ifdef HDR\ncolor.rgb = pow(color.rgb, vec3(czm_gamma));\n#endif\nreturn color;\n}\n",FL="vec3 czm_geodeticSurfaceNormal(vec3 positionOnEllipsoid, vec3 ellipsoidCenter, vec3 oneOverEllipsoidRadiiSquared)\n{\nreturn normalize((positionOnEllipsoid - ellipsoidCenter) * oneOverEllipsoidRadiiSquared);\n}\n",kL="czm_material czm_getDefaultMaterial(czm_materialInput materialInput)\n{\nczm_material material;\nmaterial.diffuse = vec3(0.0);\nmaterial.specular = 0.0;\nmaterial.shininess = 1.0;\nmaterial.normal = materialInput.normalEC;\nmaterial.emission = vec3(0.0);\nmaterial.alpha = 1.0;\nreturn material;\n}\n",BL="float czm_getLambertDiffuse(vec3 lightDirectionEC, vec3 normalEC)\n{\nreturn max(dot(lightDirectionEC, normalEC), 0.0);\n}\n",zL="float czm_getSpecular(vec3 lightDirectionEC, vec3 toEyeEC, vec3 normalEC, float shininess)\n{\nvec3 toReflectedLight = reflect(-lightDirectionEC, normalEC);\nfloat specular = max(dot(toReflectedLight, toEyeEC), 0.0);\nreturn pow(specular, max(shininess, czm_epsilon2));\n}\n",UL="vec4 czm_getWaterNoise(sampler2D normalMap, vec2 uv, float time, float angleInRadians)\n{\nfloat cosAngle = cos(angleInRadians);\nfloat sinAngle = sin(angleInRadians);\nvec2 s0 = vec2(1.0/17.0, 0.0);\nvec2 s1 = vec2(-1.0/29.0, 0.0);\nvec2 s2 = vec2(1.0/101.0, 1.0/59.0);\nvec2 s3 = vec2(-1.0/109.0, -1.0/57.0);\ns0 = vec2((cosAngle * s0.x) - (sinAngle * s0.y), (sinAngle * s0.x) + (cosAngle * s0.y));\ns1 = vec2((cosAngle * s1.x) - (sinAngle * s1.y), (sinAngle * s1.x) + (cosAngle * s1.y));\ns2 = vec2((cosAngle * s2.x) - (sinAngle * s2.y), (sinAngle * s2.x) + (cosAngle * s2.y));\ns3 = vec2((cosAngle * s3.x) - (sinAngle * s3.y), (sinAngle * s3.x) + (cosAngle * s3.y));\nvec2 uv0 = (uv/103.0) + (time * s0);\nvec2 uv1 = uv/107.0 + (time * s1) + vec2(0.23);\nvec2 uv2 = uv/vec2(897.0, 983.0) + (time * s2) + vec2(0.51);\nvec2 uv3 = uv/vec2(991.0, 877.0) + (time * s3) + vec2(0.71);\nuv0 = fract(uv0);\nuv1 = fract(uv1);\nuv2 = fract(uv2);\nuv3 = fract(uv3);\nvec4 noise = (texture2D(normalMap, uv0)) +\n(texture2D(normalMap, uv1)) +\n(texture2D(normalMap, uv2)) +\n(texture2D(normalMap, uv3));\nreturn ((noise / 4.0) - 0.5) * 2.0;\n}\n",VL="czm_ellipsoid czm_getWgs84EllipsoidEC()\n{\nvec3 radii = luban_ellipsoidType;\nvec3 inverseRadii = vec3(1.0 / radii.x, 1.0 / radii.y, 1.0 / radii.z);\nvec3 inverseRadiiSquared = inverseRadii * inverseRadii;\nczm_ellipsoid temp = czm_ellipsoid(czm_view[3].xyz, radii, inverseRadii, inverseRadiiSquared);\nreturn temp;\n}\n",HL="const vec4 K_HSB2RGB = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\nvec3 czm_HSBToRGB(vec3 hsb)\n{\nvec3 p = abs(fract(hsb.xxx + K_HSB2RGB.xyz) * 6.0 - K_HSB2RGB.www);\nreturn hsb.z * mix(K_HSB2RGB.xxx, clamp(p - K_HSB2RGB.xxx, 0.0, 1.0), hsb.y);\n}\n",GL="vec3 hueToRGB(float hue)\n{\nfloat r = abs(hue * 6.0 - 3.0) - 1.0;\nfloat g = 2.0 - abs(hue * 6.0 - 2.0);\nfloat b = 2.0 - abs(hue * 6.0 - 4.0);\nreturn clamp(vec3(r, g, b), 0.0, 1.0);\n}\nvec3 czm_HSLToRGB(vec3 hsl)\n{\nvec3 rgb = hueToRGB(hsl.x);\nfloat c = (1.0 - abs(2.0 * hsl.z - 1.0)) * hsl.y;\nreturn (rgb - 0.5) * c + hsl.z;\n}\n",qL="vec3 czm_hue(vec3 rgb, float adjustment)\n{\nconst mat3 toYIQ = mat3(0.299,     0.587,     0.114,\n0.595716, -0.274453, -0.321263,\n0.211456, -0.522591,  0.311135);\nconst mat3 toRGB = mat3(1.0,  0.9563,  0.6210,\n1.0, -0.2721, -0.6474,\n1.0, -1.107,   1.7046);\nvec3 yiq = toYIQ * rgb;\nfloat hue = atan(yiq.z, yiq.y) + adjustment;\nfloat chroma = sqrt(yiq.z * yiq.z + yiq.y * yiq.y);\nvec3 color = vec3(yiq.x, chroma * cos(hue), chroma * sin(hue));\nreturn toRGB * color;\n}\n",WL="vec3 czm_inverseGamma(vec3 color) {\nreturn pow(color, vec3(1.0 / czm_gamma));\n}\n",YL="bool czm_isEmpty(czm_raySegment interval)\n{\nreturn (interval.stop < 0.0);\n}\n",XL="bool czm_isFull(czm_raySegment interval)\n{\nreturn (interval.start == 0.0 && interval.stop == czm_infinity);\n}\n",ZL="float czm_latitudeToWebMercatorFraction(float latitude, float southMercatorY, float oneOverMercatorHeight)\n{\nfloat sinLatitude = sin(latitude);\nfloat mercatorY = 0.5 * log((1.0 + sinLatitude) / (1.0 - sinLatitude));\nreturn (mercatorY - southMercatorY) * oneOverMercatorHeight;\n}\n",QL="float czm_lineDistance(vec2 point1, vec2 point2, vec2 point) {\nreturn abs((point2.y - point1.y) * point.x - (point2.x - point1.x) * point.y + point2.x * point1.y - point2.y * point1.x) / distance(point2, point1);\n}\n",KL="float czm_luminance(vec3 rgb)\n{\nconst vec3 W = vec3(0.2125, 0.7154, 0.0721);\nreturn dot(rgb, W);\n}\n",JL="float czm_metersPerPixel(vec4 positionEC)\n{\nfloat width = czm_viewport.z;\nfloat height = czm_viewport.w;\nfloat pixelWidth;\nfloat pixelHeight;\nfloat top = czm_frustumPlanes.x;\nfloat bottom = czm_frustumPlanes.y;\nfloat left = czm_frustumPlanes.z;\nfloat right = czm_frustumPlanes.w;\nif (czm_sceneMode == czm_sceneMode2D || czm_orthographicIn3D == 1.0)\n{\nfloat frustumWidth = right - left;\nfloat frustumHeight = top - bottom;\npixelWidth = frustumWidth / width;\npixelHeight = frustumHeight / height;\n}\nelse\n{\nfloat distanceToPixel = -positionEC.z;\nfloat inverseNear = 1.0 / czm_currentFrustum.x;\nfloat tanTheta = top * inverseNear;\npixelHeight = 2.0 * distanceToPixel * tanTheta / height;\ntanTheta = right * inverseNear;\npixelWidth = 2.0 * distanceToPixel * tanTheta / width;\n}\nreturn max(pixelWidth, pixelHeight);\n}\n",$L="vec4 czm_modelToWindowCoordinates(vec4 position)\n{\nvec4 q = czm_modelViewProjection * position;\nq.xyz /= q.w;\nq.xyz = (czm_viewportTransformation * vec4(q.xyz, 1.0)).xyz;\nreturn q;\n}\n",eN="vec3 czm_multiplyWithColorBalance(vec3 left, vec3 right)\n{\nconst vec3 W = vec3(0.2125, 0.7154, 0.0721);\nvec3 target = left * right;\nfloat leftLuminance = dot(left, W);\nfloat rightLuminance = dot(right, W);\nfloat targetLuminance = dot(target, W);\nreturn ((leftLuminance + rightLuminance) / (2.0 * targetLuminance)) * target;\n}\n",tN="float czm_nearFarScalar(vec4 nearFarScalar, float cameraDistSq)\n{\nfloat valueAtMin = nearFarScalar.y;\nfloat valueAtMax = nearFarScalar.w;\nfloat nearDistanceSq = nearFarScalar.x * nearFarScalar.x;\nfloat farDistanceSq = nearFarScalar.z * nearFarScalar.z;\nfloat t = (cameraDistSq - nearDistanceSq) / (farDistanceSq - nearDistanceSq);\nt = pow(clamp(t, 0.0, 1.0), 0.2);\nreturn mix(valueAtMin, valueAtMax, t);\n}\n",iN="vec3 czm_octDecode(vec2 encoded, float range)\n{\nif (encoded.x == 0.0 && encoded.y == 0.0) {\nreturn vec3(0.0, 0.0, 0.0);\n}\nencoded = encoded / range * 2.0 - 1.0;\nvec3 v = vec3(encoded.x, encoded.y, 1.0 - abs(encoded.x) - abs(encoded.y));\nif (v.z < 0.0)\n{\nv.xy = (1.0 - abs(v.yx)) * czm_signNotZero(v.xy);\n}\nreturn normalize(v);\n}\nvec3 czm_octDecode(vec2 encoded)\n{\nreturn czm_octDecode(encoded, 255.0);\n}\nvec3 czm_octDecode(float encoded)\n{\nfloat temp = encoded / 256.0;\nfloat x = floor(temp);\nfloat y = (temp - x) * 256.0;\nreturn czm_octDecode(vec2(x, y));\n}\nvoid czm_octDecode(vec2 encoded, out vec3 vector1, out vec3 vector2, out vec3 vector3)\n{\nfloat temp = encoded.x / 65536.0;\nfloat x = floor(temp);\nfloat encodedFloat1 = (temp - x) * 65536.0;\ntemp = encoded.y / 65536.0;\nfloat y = floor(temp);\nfloat encodedFloat2 = (temp - y) * 65536.0;\nvector1 = czm_octDecode(encodedFloat1);\nvector2 = czm_octDecode(encodedFloat2);\nvector3 = czm_octDecode(vec2(x, y));\n}\n",nN="vec4 czm_packDepth(float depth)\n{\nvec4 enc = vec4(1.0, 255.0, 65025.0, 16581375.0) * depth;\nenc = fract(enc);\nenc -= enc.yzww * vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0, 0.0);\nreturn enc;\n}\n",rN="float czm_private_getLambertDiffuseOfMaterial(vec3 lightDirectionEC, czm_material material)\n{\nreturn czm_getLambertDiffuse(lightDirectionEC, material.normal);\n}\nfloat czm_private_getSpecularOfMaterial(vec3 lightDirectionEC, vec3 toEyeEC, czm_material material)\n{\nreturn czm_getSpecular(lightDirectionEC, toEyeEC, material.normal, material.shininess);\n}\nvec4 czm_phong(vec3 toEye, czm_material material)\n{\nfloat diffuse = czm_private_getLambertDiffuseOfMaterial(vec3(0.0, 0.0, 1.0), material);\nif (czm_sceneMode == czm_sceneMode3D) {\ndiffuse += czm_private_getLambertDiffuseOfMaterial(vec3(0.0, 1.0, 0.0), material);\n}\nfloat specular = czm_private_getSpecularOfMaterial(czm_sunDirectionEC, toEye, material) + czm_private_getSpecularOfMaterial(czm_moonDirectionEC, toEye, material);\nvec3 materialDiffuse = material.diffuse * 0.5;\nvec3 ambient = materialDiffuse;\nvec3 color = ambient + material.emission;\ncolor += materialDiffuse * diffuse;\ncolor += material.specular * specular;\n#ifdef HDR\nfloat sunDiffuse = czm_private_getLambertDiffuseOfMaterial(czm_sunDirectionEC, material);\ncolor += materialDiffuse * sunDiffuse * czm_sunColor;\n#endif\nreturn vec4(color, material.alpha);\n}\nvec4 czm_private_phong(vec3 toEye, czm_material material)\n{\nfloat diffuse = czm_private_getLambertDiffuseOfMaterial(czm_sunDirectionEC, material);\nfloat specular = czm_private_getSpecularOfMaterial(czm_sunDirectionEC, toEye, material);\nvec3 ambient = vec3(0.0);\nvec3 color = ambient + material.emission;\ncolor += material.diffuse * diffuse;\ncolor += material.specular * specular;\nreturn vec4(color, material.alpha);\n}\n",aN="float czm_planeDistance(vec4 plane, vec3 point) {\nreturn (dot(plane.xyz, point) + plane.w);\n}\nfloat czm_planeDistance(vec3 planeNormal, float planeDistance, vec3 point) {\nreturn (dot(planeNormal, point) + planeDistance);\n}\n",oN="vec3 czm_pointAlongRay(czm_ray ray, float time)\n{\nreturn ray.origin + (time * ray.direction);\n}\n",sN="czm_raySegment czm_rayEllipsoidIntersectionInterval(czm_ray ray, czm_ellipsoid ellipsoid)\n{\nvec3 q = ellipsoid.inverseRadii * (czm_inverseModelView * vec4(ray.origin, 1.0)).xyz;\nvec3 w = ellipsoid.inverseRadii * (czm_inverseModelView * vec4(ray.direction, 0.0)).xyz;\nq = q - ellipsoid.inverseRadii * (czm_inverseModelView * vec4(ellipsoid.center, 1.0)).xyz;\nfloat q2 = dot(q, q);\nfloat qw = dot(q, w);\nif (q2 > 1.0)\n{\nif (qw >= 0.0)\n{\nreturn czm_emptyRaySegment;\n}\nelse\n{\nfloat qw2 = qw * qw;\nfloat difference = q2 - 1.0;\nfloat w2 = dot(w, w);\nfloat product = w2 * difference;\nif (qw2 < product)\n{\nreturn czm_emptyRaySegment;\n}\nelse if (qw2 > product)\n{\nfloat discriminant = qw * qw - product;\nfloat temp = -qw + sqrt(discriminant);\nfloat root0 = temp / w2;\nfloat root1 = difference / temp;\nif (root0 < root1)\n{\nczm_raySegment i = czm_raySegment(root0, root1);\nreturn i;\n}\nelse\n{\nczm_raySegment i = czm_raySegment(root1, root0);\nreturn i;\n}\n}\nelse\n{\nfloat root = sqrt(difference / w2);\nczm_raySegment i = czm_raySegment(root, root);\nreturn i;\n}\n}\n}\nelse if (q2 < 1.0)\n{\nfloat difference = q2 - 1.0;\nfloat w2 = dot(w, w);\nfloat product = w2 * difference;\nfloat discriminant = qw * qw - product;\nfloat temp = -qw + sqrt(discriminant);\nczm_raySegment i = czm_raySegment(0.0, temp / w2);\nreturn i;\n}\nelse\n{\nif (qw < 0.0)\n{\nfloat w2 = dot(w, w);\nczm_raySegment i = czm_raySegment(0.0, -qw / w2);\nreturn i;\n}\nelse\n{\nreturn czm_emptyRaySegment;\n}\n}\n}\n",cN="float czm_readDepth(sampler2D depthTexture, vec2 texCoords)\n{\nreturn czm_reverseLogDepth(texture2D(depthTexture, texCoords).r);\n}\n",lN="float czm_reverseLogDepth(float logZ)\n{\n#ifdef LOG_DEPTH\nfloat near = czm_currentFrustum.x;\nfloat far = czm_currentFrustum.y;\nlogZ = pow(2.0, logZ * czm_log2FarPlusOne) - 1.0;\nlogZ = far * (1.0 - near / logZ) / (far - near);\n#endif\nreturn logZ;\n}\n",uN="const vec4 K_RGB2HSB = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\nvec3 czm_RGBToHSB(vec3 rgb)\n{\nvec4 p = mix(vec4(rgb.bg, K_RGB2HSB.wz), vec4(rgb.gb, K_RGB2HSB.xy), step(rgb.b, rgb.g));\nvec4 q = mix(vec4(p.xyw, rgb.r), vec4(rgb.r, p.yzx), step(p.x, rgb.r));\nfloat d = q.x - min(q.w, q.y);\nreturn vec3(abs(q.z + (q.w - q.y) / (6.0 * d + czm_epsilon7)), d / (q.x + czm_epsilon7), q.x);\n}\n",hN="vec3 RGBtoHCV(vec3 rgb)\n{\nvec4 p = (rgb.g < rgb.b) ? vec4(rgb.bg, -1.0, 2.0 / 3.0) : vec4(rgb.gb, 0.0, -1.0 / 3.0);\nvec4 q = (rgb.r < p.x) ? vec4(p.xyw, rgb.r) : vec4(rgb.r, p.yzx);\nfloat c = q.x - min(q.w, q.y);\nfloat h = abs((q.w - q.y) / (6.0 * c + czm_epsilon7) + q.z);\nreturn vec3(h, c, q.x);\n}\nvec3 czm_RGBToHSL(vec3 rgb)\n{\nvec3 hcv = RGBtoHCV(rgb);\nfloat l = hcv.z - hcv.y * 0.5;\nfloat s = hcv.y / (1.0 - abs(l * 2.0 - 1.0) + czm_epsilon7);\nreturn vec3(hcv.x, s, l);\n}\n",dN="vec3 czm_RGBToXYZ(vec3 rgb)\n{\nconst mat3 RGB2XYZ = mat3(0.4124, 0.2126, 0.0193,\n0.3576, 0.7152, 0.1192,\n0.1805, 0.0722, 0.9505);\nvec3 xyz = RGB2XYZ * rgb;\nvec3 Yxy;\nYxy.r = xyz.g;\nfloat temp = dot(vec3(1.0), xyz);\nYxy.gb = xyz.rg / temp;\nreturn Yxy;\n}\n",fN="vec3 czm_sampleOctahedralProjectionWithFiltering(sampler2D projectedMap, vec2 textureSize, vec3 direction, float lod)\n{\ndirection /= dot(vec3(1.0), abs(direction));\nvec2 rev = abs(direction.zx) - vec2(1.0);\nvec2 neg = vec2(direction.x < 0.0 ? rev.x : -rev.x,\ndirection.z < 0.0 ? rev.y : -rev.y);\nvec2 uv = direction.y < 0.0 ? neg : direction.xz;\nvec2 coord = 0.5 * uv + vec2(0.5);\nvec2 pixel = 1.0 / textureSize;\nif (lod > 0.0)\n{\nfloat scale = 1.0 / pow(2.0, lod);\nfloat offset = ((textureSize.y + 1.0) / textureSize.x);\ncoord.x *= offset;\ncoord *= scale;\ncoord.x += offset + pixel.x;\ncoord.y += (1.0 - (1.0 / pow(2.0, lod - 1.0))) + pixel.y * (lod - 1.0) * 2.0;\n}\nelse\n{\ncoord.x *= (textureSize.y / textureSize.x);\n}\n#ifndef OES_texture_float_linear\nvec3 color1 = texture2D(projectedMap, coord + vec2(0.0, pixel.y)).rgb;\nvec3 color2 = texture2D(projectedMap, coord + vec2(pixel.x, 0.0)).rgb;\nvec3 color3 = texture2D(projectedMap, coord + pixel).rgb;\nvec3 color4 = texture2D(projectedMap, coord).rgb;\nvec2 texturePosition = coord * textureSize;\nfloat fu = fract(texturePosition.x);\nfloat fv = fract(texturePosition.y);\nvec3 average1 = mix(color4, color2, fu);\nvec3 average2 = mix(color1, color3, fu);\nvec3 color = mix(average1, average2, fv);\n#else\nvec3 color = texture2D(projectedMap, coord).rgb;\n#endif\nreturn color;\n}\nvec3 czm_sampleOctahedralProjection(sampler2D projectedMap, vec2 textureSize, vec3 direction, float lod, float maxLod) {\nfloat currentLod = floor(lod + 0.5);\nfloat nextLod = min(currentLod + 1.0, maxLod);\nvec3 colorCurrentLod = czm_sampleOctahedralProjectionWithFiltering(projectedMap, textureSize, direction, currentLod);\nvec3 colorNextLod = czm_sampleOctahedralProjectionWithFiltering(projectedMap, textureSize, direction, nextLod);\nreturn mix(colorNextLod, colorCurrentLod, nextLod - lod);\n}\n",pN="vec3 czm_saturation(vec3 rgb, float adjustment)\n{\nconst vec3 W = vec3(0.2125, 0.7154, 0.0721);\nvec3 intensity = vec3(dot(rgb, W));\nreturn mix(intensity, rgb, adjustment);\n}\n",mN="float czm_sampleShadowMap(samplerCube shadowMap, vec3 d)\n{\nreturn czm_unpackDepth(textureCube(shadowMap, d));\n}\nfloat czm_sampleShadowMap(sampler2D shadowMap, vec2 uv)\n{\n#ifdef USE_SHADOW_DEPTH_TEXTURE\nreturn texture2D(shadowMap, uv).r;\n#else\nreturn czm_unpackDepth(texture2D(shadowMap, uv));\n#endif\n}\nfloat czm_shadowDepthCompare(samplerCube shadowMap, vec3 uv, float depth)\n{\nreturn step(depth, czm_sampleShadowMap(shadowMap, uv));\n}\nfloat czm_shadowDepthCompare(sampler2D shadowMap, vec2 uv, float depth)\n{\nreturn step(depth, czm_sampleShadowMap(shadowMap, uv));\n}\n",_N="float czm_private_shadowVisibility(float visibility, float nDotL, float normalShadingSmooth, float darkness)\n{\n#ifdef USE_NORMAL_SHADING\n#ifdef USE_NORMAL_SHADING_SMOOTH\nfloat strength = clamp(nDotL / normalShadingSmooth, 0.0, 1.0);\n#else\nfloat strength = step(0.0, nDotL);\n#endif\nvisibility *= strength;\n#endif\nvisibility = max(visibility, darkness);\nreturn visibility;\n}\n#ifdef USE_CUBE_MAP_SHADOW\nfloat czm_shadowVisibility(samplerCube shadowMap, czm_shadowParameters shadowParameters)\n{\nfloat depthBias = shadowParameters.depthBias;\nfloat depth = shadowParameters.depth;\nfloat nDotL = shadowParameters.nDotL;\nfloat normalShadingSmooth = shadowParameters.normalShadingSmooth;\nfloat darkness = shadowParameters.darkness;\nvec3 uvw = shadowParameters.texCoords;\ndepth -= depthBias;\nfloat visibility = czm_shadowDepthCompare(shadowMap, uvw, depth);\nreturn czm_private_shadowVisibility(visibility, nDotL, normalShadingSmooth, darkness);\n}\n#else\nfloat czm_shadowVisibility(sampler2D shadowMap, czm_shadowParameters shadowParameters)\n{\nfloat depthBias = shadowParameters.depthBias;\nfloat depth = shadowParameters.depth;\nfloat nDotL = shadowParameters.nDotL;\nfloat normalShadingSmooth = shadowParameters.normalShadingSmooth;\nfloat darkness = shadowParameters.darkness;\nvec2 uv = shadowParameters.texCoords;\ndepth -= depthBias;\n#ifdef USE_SOFT_SHADOWS\nvec2 texelStepSize = shadowParameters.texelStepSize;\nfloat radius = 1.0;\nfloat dx0 = -texelStepSize.x * radius;\nfloat dy0 = -texelStepSize.y * radius;\nfloat dx1 = texelStepSize.x * radius;\nfloat dy1 = texelStepSize.y * radius;\nfloat visibility = (\nczm_shadowDepthCompare(shadowMap, uv, depth) +\nczm_shadowDepthCompare(shadowMap, uv + vec2(dx0, dy0), depth) +\nczm_shadowDepthCompare(shadowMap, uv + vec2(0.0, dy0), depth) +\nczm_shadowDepthCompare(shadowMap, uv + vec2(dx1, dy0), depth) +\nczm_shadowDepthCompare(shadowMap, uv + vec2(dx0, 0.0), depth) +\nczm_shadowDepthCompare(shadowMap, uv + vec2(dx1, 0.0), depth) +\nczm_shadowDepthCompare(shadowMap, uv + vec2(dx0, dy1), depth) +\nczm_shadowDepthCompare(shadowMap, uv + vec2(0.0, dy1), depth) +\nczm_shadowDepthCompare(shadowMap, uv + vec2(dx1, dy1), depth)\n) * (1.0 / 9.0);\n#else\nfloat visibility = czm_shadowDepthCompare(shadowMap, uv, depth);\n#endif\nreturn czm_private_shadowVisibility(visibility, nDotL, normalShadingSmooth, darkness);\n}\n#endif\n",gN="float czm_signNotZero(float value)\n{\nreturn value >= 0.0 ? 1.0 : -1.0;\n}\nvec2 czm_signNotZero(vec2 value)\n{\nreturn vec2(czm_signNotZero(value.x), czm_signNotZero(value.y));\n}\nvec3 czm_signNotZero(vec3 value)\n{\nreturn vec3(czm_signNotZero(value.x), czm_signNotZero(value.y), czm_signNotZero(value.z));\n}\nvec4 czm_signNotZero(vec4 value)\n{\nreturn vec4(czm_signNotZero(value.x), czm_signNotZero(value.y), czm_signNotZero(value.z), czm_signNotZero(value.w));\n}\n",vN="vec3 czm_sphericalHarmonics(vec3 normal, vec3 coefficients[9])\n{\nconst float c1 = 0.429043;\nconst float c2 = 0.511664;\nconst float c3 = 0.743125;\nconst float c4 = 0.886227;\nconst float c5 = 0.247708;\nvec3 L00 = coefficients[0];\nvec3 L1_1 = coefficients[1];\nvec3 L10 = coefficients[2];\nvec3 L11 = coefficients[3];\nvec3 L2_2 = coefficients[4];\nvec3 L2_1 = coefficients[5];\nvec3 L20 = coefficients[6];\nvec3 L21 = coefficients[7];\nvec3 L22 = coefficients[8];\nfloat x = normal.x;\nfloat y = normal.y;\nfloat z = normal.z;\nreturn c1 * L22 * (x * x - y * y) + c3 * L20 * z * z + c4 * L00 - c5 * L20 +\n2.0 * c1 * (L2_2 * x * y + L21 * x * z + L2_1 * y * z) +\n2.0 * c2 * (L11 * x + L1_1 * y + L10 * z);\n}\n",bN="mat3 czm_tangentToEyeSpaceMatrix(vec3 normalEC, vec3 tangentEC, vec3 bitangentEC)\n{\nvec3 normal = normalize(normalEC);\nvec3 tangent = normalize(tangentEC);\nvec3 bitangent = normalize(bitangentEC);\nreturn mat3(tangent.x  , tangent.y  , tangent.z,\nbitangent.x, bitangent.y, bitangent.z,\nnormal.x   , normal.y   , normal.z);\n}\n",yN="vec4 czm_transformPlane(vec4 clippingPlane, mat4 transform) {\nvec3 transformedDirection = normalize((transform * vec4(clippingPlane.xyz, 0.0)).xyz);\nvec3 transformedPosition = (transform * vec4(clippingPlane.xyz * -clippingPlane.w, 1.0)).xyz;\nvec4 transformedPlane;\ntransformedPlane.xyz = transformedDirection;\ntransformedPlane.w = -dot(transformedDirection, transformedPosition);\nreturn transformedPlane;\n}\n",wN="vec4 czm_translateRelativeToEye(vec3 high, vec3 low)\n{\nvec3 highDifference = high - czm_encodedCameraPositionMCHigh;\nvec3 lowDifference = low - czm_encodedCameraPositionMCLow;\nreturn vec4(highDifference + lowDifference, 1.0);\n}\n",ON="vec4 czm_translucentPhong(vec3 toEye, czm_material material)\n{\nfloat diffuse = czm_getLambertDiffuse(vec3(0.0, 0.0, 1.0), material.normal);\nif (czm_sceneMode == czm_sceneMode3D) {\ndiffuse += czm_getLambertDiffuse(vec3(0.0, 1.0, 0.0), material.normal);\n}\ndiffuse = clamp(diffuse, 0.0, 1.0);\nfloat specular = czm_getSpecular(czm_sunDirectionEC, toEye, material.normal, material.shininess);\nspecular += czm_getSpecular(czm_moonDirectionEC, toEye, material.normal, material.shininess);\nvec3 materialDiffuse = material.diffuse * 0.5;\nvec3 ambient = materialDiffuse;\nvec3 color = ambient + material.emission;\ncolor += materialDiffuse * diffuse;\ncolor += material.specular * specular;\nreturn vec4(color, material.alpha);\n}\n",xN="mat2 czm_transpose(mat2 matrix)\n{\nreturn mat2(\nmatrix[0][0], matrix[1][0],\nmatrix[0][1], matrix[1][1]);\n}\nmat3 czm_transpose(mat3 matrix)\n{\nreturn mat3(\nmatrix[0][0], matrix[1][0], matrix[2][0],\nmatrix[0][1], matrix[1][1], matrix[2][1],\nmatrix[0][2], matrix[1][2], matrix[2][2]);\n}\nmat4 czm_transpose(mat4 matrix)\n{\nreturn mat4(\nmatrix[0][0], matrix[1][0], matrix[2][0], matrix[3][0],\nmatrix[0][1], matrix[1][1], matrix[2][1], matrix[3][1],\nmatrix[0][2], matrix[1][2], matrix[2][2], matrix[3][2],\nmatrix[0][3], matrix[1][3], matrix[2][3], matrix[3][3]);\n}\n",EN="float czm_unpackDepth(vec4 packedDepth)\n{\nreturn dot(packedDepth, vec4(1.0, 1.0 / 255.0, 1.0 / 65025.0, 1.0 / 16581375.0));\n}\n",TN="#define SHIFT_RIGHT_8 0.00390625 //1.0 / 256.0\n#define SHIFT_RIGHT_16 0.00001525878 //1.0 / 65536.0\n#define SHIFT_RIGHT_24 5.960464477539063e-8//1.0 / 16777216.0\n#define BIAS 38.0\nfloat czm_unpackFloat(vec4 packedFloat)\n{\npackedFloat *= 255.0;\nfloat temp = packedFloat.w / 2.0;\nfloat exponent = floor(temp);\nfloat sign = (temp - exponent) * 2.0;\nexponent = exponent - float(BIAS);\nsign = sign * 2.0 - 1.0;\nsign = -sign;\nfloat unpacked = sign * packedFloat.x * float(SHIFT_RIGHT_8);\nunpacked += sign * packedFloat.y * float(SHIFT_RIGHT_16);\nunpacked += sign * packedFloat.z * float(SHIFT_RIGHT_24);\nreturn unpacked * pow(10.0, exponent);\n}\n",CN="#define ENABLE_GL_POSITION_LOG_DEPTH_AT_HEIGHT\n#ifdef LOG_DEPTH\nvarying float v_logZ;\n#ifdef SHADOW_MAP\nvarying vec3 v_logPositionEC;\n#endif\n#endif\nvoid czm_updatePositionDepth() {\n#if defined(LOG_DEPTH) && !defined(DISABLE_GL_POSITION_LOG_DEPTH)\nvec3 logPositionEC = (czm_inverseProjection * gl_Position).xyz;\n#ifdef SHADOW_MAP\nv_logPositionEC = logPositionEC;\n#endif\n#ifdef ENABLE_GL_POSITION_LOG_DEPTH_AT_HEIGHT\nif (length(logPositionEC) < 2.0e6)\n{\nreturn;\n}\n#endif\ngl_Position.z = log2(max(1e-6, 1.0 + gl_Position.w)) * czm_log2FarDistance - 1.0;\ngl_Position.z *= gl_Position.w;\n#endif\n}\nvoid czm_vertexLogDepth()\n{\n#ifdef LOG_DEPTH\nv_logZ = 1.0 + gl_Position.w;\nczm_updatePositionDepth();\n#endif\n}\nvoid czm_vertexLogDepth(vec4 clipCoords)\n{\n#ifdef LOG_DEPTH\nv_logZ = 1.0 + clipCoords.w;\nczm_updatePositionDepth();\n#endif\n}\n",SN="vec4 czm_windowToEyeCoordinates(vec4 fragmentCoordinate)\n{\nfloat x = 2.0 * (fragmentCoordinate.x - czm_viewport.x) / czm_viewport.z - 1.0;\nfloat y = 2.0 * (fragmentCoordinate.y - czm_viewport.y) / czm_viewport.w - 1.0;\nfloat z = (fragmentCoordinate.z - czm_viewportTransformation[3][2]) / czm_viewportTransformation[2][2];\nvec4 q = vec4(x, y, z, 1.0);\nq /= fragmentCoordinate.w;\nif (!(czm_inverseProjection == mat4(0.0)))\n{\nq = czm_inverseProjection * q;\n}\nelse\n{\nfloat top = czm_frustumPlanes.x;\nfloat bottom = czm_frustumPlanes.y;\nfloat left = czm_frustumPlanes.z;\nfloat right = czm_frustumPlanes.w;\nfloat near = czm_currentFrustum.x;\nfloat far = czm_currentFrustum.y;\nq.x = (q.x * (right - left) + left + right) * 0.5;\nq.y = (q.y * (top - bottom) + bottom + top) * 0.5;\nq.z = (q.z * (near - far) - near - far) * 0.5;\nq.w = 1.0;\n}\nreturn q;\n}\nvec4 czm_windowToEyeCoordinates(vec2 fragmentCoordinateXY, float depthOrLogDepth)\n{\n#ifdef LOG_DEPTH\nfloat near = czm_currentFrustum.x;\nfloat far = czm_currentFrustum.y;\nfloat unscaledDepth = pow(2.0, depthOrLogDepth * czm_log2FarPlusOne) - 1.0;\nvec4 windowCoord = vec4(fragmentCoordinateXY, far * (1.0 - near / unscaledDepth) / (far - near), 1.0);\nvec4 eyeCoordinate = czm_windowToEyeCoordinates(windowCoord);\neyeCoordinate.w = 1.0 / unscaledDepth;\n#else\nvec4 windowCoord = vec4(fragmentCoordinateXY, depthOrLogDepth, 1.0);\nvec4 eyeCoordinate = czm_windowToEyeCoordinates(windowCoord);\n#endif\nreturn eyeCoordinate;\n}\n",AN="#ifndef LOG_DEPTH\nvarying float v_WindowZ;\n#endif\nvoid czm_writeDepthClampedToFarPlane()\n{\n#if defined(GL_EXT_frag_depth) && !defined(LOG_DEPTH)\ngl_FragDepthEXT = min(v_WindowZ * gl_FragCoord.w, 1.0);\n#endif\n}\n",PN="#ifdef LOG_DEPTH\nvarying float v_logZ;\n#endif\nvoid czm_writeLogDepth(float logZ)\n{\n#if defined(GL_EXT_frag_depth) && defined(LOG_DEPTH) && !defined(DISABLE_LOG_DEPTH_FRAGMENT_WRITE)\nfloat halfLogFarDistance = czm_log2FarDistance * 0.5;\nfloat depth = log2(logZ);\nif (depth < czm_log2NearDistance) {\ndiscard;\n}\ngl_FragDepthEXT = depth * halfLogFarDistance;\n#endif\n}\nvoid czm_writeLogDepth() {\n#ifdef LOG_DEPTH\nczm_writeLogDepth(v_logZ);\n#endif\n}\n",IN="vec3 czm_XYZToRGB(vec3 Yxy)\n{\nconst mat3 XYZ2RGB = mat3( 3.2405, -0.9693,  0.0556,\n-1.5371,  1.8760, -0.2040,\n-0.4985,  0.0416,  1.0572);\nvec3 xyz;\nxyz.r = Yxy.r * Yxy.g / Yxy.b;\nxyz.g = Yxy.r;\nxyz.b = Yxy.r * (1.0 - Yxy.g - Yxy.b) / Yxy.b;\nreturn XYZ2RGB * xyz;\n}\n",DN={czm_degreesPerRadian:xR,czm_depthRange:ER,czm_epsilon1:TR,czm_epsilon2:CR,czm_epsilon3:SR,czm_epsilon4:AR,czm_epsilon5:PR,czm_epsilon6:IR,czm_epsilon7:DR,czm_infinity:jR,czm_oneOverPi:MR,czm_oneOverTwoPi:RR,czm_passCesium3DTile:LR,czm_passCesium3DTileClassification:NR,czm_passCesium3DTileClassificationIgnoreShow:FR,czm_passClassification:kR,czm_passCompute:BR,czm_passEnvironment:zR,czm_passGlobe:UR,czm_passOpaque:VR,czm_passOverlay:HR,czm_passTerrainClassification:GR,czm_passTranslucent:qR,czm_pi:WR,czm_piOverFour:YR,czm_piOverSix:XR,czm_piOverThree:ZR,czm_piOverTwo:QR,czm_radiansPerDegree:KR,czm_sceneMode2D:JR,czm_sceneMode3D:$R,czm_sceneModeColumbusView:eL,czm_sceneModeMorphing:tL,czm_solarRadius:iL,czm_threePiOver2:nL,czm_twoPi:rL,czm_webMercatorMaxLatitude:aL,czm_combineMaterial:oL,czm_depthRangeStruct:sL,czm_ellipsoid:cL,czm_material:lL,czm_materialInput:uL,czm_ray:hL,czm_raySegment:dL,czm_shadowParameters:fL,czm_alphaWeight:pL,czm_antialias:mL,czm_approximateSphericalCoordinates:_L,czm_branchFreeTernary:gL,czm_cascadeColor:vL,czm_cascadeDistance:bL,czm_cascadeMatrix:yL,czm_cascadeWeights:wL,czm_columbusViewMorph:OL,czm_computePosition:xL,czm_cosineAndSine:EL,czm_decompressTextureCoordinates:TL,czm_depthClampFarPlane:CL,czm_eastNorthUpToEyeCoordinates:SL,czm_ellipsoidContainsPoint:AL,czm_ellipsoidNew:PL,czm_ellipsoidWgs84TextureCoordinates:IL,czm_equalsEpsilon:DL,czm_eyeOffset:jL,czm_eyeToWindowCoordinates:ML,czm_fastApproximateAtan:RL,czm_fog:LL,czm_gammaCorrect:NL,czm_geodeticSurfaceNormal:FL,czm_getDefaultMaterial:kL,czm_getLambertDiffuse:BL,czm_getSpecular:zL,czm_getWaterNoise:UL,czm_getWgs84EllipsoidEC:VL,czm_HSBToRGB:HL,czm_HSLToRGB:GL,czm_hue:qL,czm_inverseGamma:WL,czm_isEmpty:YL,czm_isFull:XL,czm_latitudeToWebMercatorFraction:ZL,czm_lineDistance:QL,czm_luminance:KL,czm_metersPerPixel:JL,czm_modelToWindowCoordinates:$L,czm_multiplyWithColorBalance:eN,czm_nearFarScalar:tN,czm_octDecode:iN,czm_packDepth:nN,czm_phong:rN,czm_planeDistance:aN,czm_pointAlongRay:oN,czm_rayEllipsoidIntersectionInterval:sN,czm_readDepth:cN,czm_reverseLogDepth:lN,czm_RGBToHSB:uN,czm_RGBToHSL:hN,czm_RGBToXYZ:dN,czm_sampleOctahedralProjection:fN,czm_saturation:pN,czm_shadowDepthCompare:mN,czm_shadowVisibility:_N,czm_signNotZero:gN,czm_sphericalHarmonics:vN,czm_tangentToEyeSpaceMatrix:bN,czm_transformPlane:yN,czm_translateRelativeToEye:wN,czm_translucentPhong:ON,czm_transpose:xN,czm_unpackDepth:EN,czm_unpackFloat:TN,czm_vertexLogDepth:CN,czm_windowToEyeCoordinates:SN,czm_writeDepthClampedToFarPlane:AN,czm_writeLogDepth:PN,czm_XYZToRGB:IN};function jN(e,t,i){for(var n,r=0;r<i.length;++r)i[r].name===e&&(n=i[r]);return Object(u.a)(n)||(n={name:e,glslSource:t=t.replace(/\/\/.*/g,"").replace(/\/\*\*[\s\S]*?\*\//gm,(function(e){for(var t=e.match(/\n/gm).length,i="",n=0;n<t;++n)i+="\n";return i})),dependsOn:[],requiredBy:[],evaluated:!1},i.push(n)),n}function MN(e){var t=[],i=jN("main",e,t);!function e(t,i){if(!t.evaluated){t.evaluated=!0;var n=t.glslSource.match(/\bczm_[a-zA-Z0-9_]*/g);Object(u.a)(n)&&null!==n&&(n=n.filter((function(e,t){return n.indexOf(e)===t}))).forEach((function(n){if(n!==t.name&&LN._czmBuiltinsAndUniforms.hasOwnProperty(n)){var r=jN(n,LN._czmBuiltinsAndUniforms[n],i);t.dependsOn.push(r),r.requiredBy.push(t),e(r,i)}}))}}(i,t),function(e){for(var t=[],i=[];e.length>0;){var n=e.pop();i.push(n),0===n.requiredBy.length&&t.push(n)}for(;t.length>0;){var r=t.shift();e.push(r);for(var a=0;a<r.dependsOn.length;++a){var o=r.dependsOn[a],s=o.requiredBy.indexOf(r);o.requiredBy.splice(s,1),0===o.requiredBy.length&&t.push(o)}}for(var c=[],l=0;l<i.length;++l)0!==i[l].requiredBy.length&&c.push(i[l]);if(0!==c.length){for(var u="A circular dependency was found in the following built-in functions/structs/constants: \n",d=0;d<c.length;++d)u=u+c[d].name+"\n";throw new h.a(u)}}(t);for(var n="",r=t.length-1;r>=0;--r)n=n+t[r].glslSource+"\n";return n.replace(i.glslSource,"")}function RN(e,t,i){var n,r,a="",o=e.sources;if(Object(u.a)(o))for(n=0,r=o.length;n<r;++n)a+="\n#line 0\n"+o[n];var s=[];a=(a=a.replace(/#extension.*\n/gm,(function(e){return s.push(e),"\n"}))).replace(/precision\s(lowp|mediump|highp)\s(float|int);/,"");var c=e.pickColorQualifier;Object(u.a)(c)&&(a=LN.createPickFragmentShaderSource(a,c));var l="";i.webgl2&&(l="#version 300 es\n");var h=s.length;for(n=0;n<h;n++)l+=s[n];t&&(l+="#ifdef GL_FRAGMENT_PRECISION_HIGH\n    precision highp float;\n#else\n    precision mediump float;\n#endif\n\n");var d=e.defines,f=!1;if(Object(u.a)(d))for(n=0,r=d.length;n<r;++n){var p=d[n];0!==p.length&&(l+="#define "+p+"\n",p.indexOf("luban_ellipsoidType")>-1&&(f=!0))}if(!f){var m=fx.ellipsoidType.radii;l+="#define luban_ellipsoidType vec3("+(m.x.toFixed(6)+","+m.y.toFixed(6)+","+m.z.toFixed(6))+")\n"}var _=!1;if(i.webgl2)if(t){_=new RegExp("gl_FragData\\[0\\]","g").test(a);var g=/#version 300 es/g.test(a);l+=[_?"#define OUTPUT_DECLARATION":"",_||g?"":"layout(location = 0) out vec4 czm_fragColor;",_||g?"":"#define gl_FragColor czm_fragColor","#define varying in","#define texture2D texture","#define texture3D texture","#define textureCube texture","#define gl_FragDepthEXT gl_FragDepth"].join("\n")+"\n"}else l+=["#define attribute in","#define varying out","#define texture2D texture","#define texture3D texture","#define textureCube texture"].join("\n")+"\n";if(i.textureFloatLinear&&(l+="#define OES_texture_float_linear\n\n"),e.includeBuiltIns&&(l+=MN(a)),l+="\n#line 0\n",l+=a,i.webgl2){l=(l=l.replace(/#extension.+(GL_OES_standard_derivatives|GL_EXT_frag_depth|GL_EXT_draw_buffers).+(enable|require)/g,"")).replace(/GL_OES_standard_derivatives|GL_EXT_frag_depth/g,"GL_ES"),_&&(l=OR(l,t,!0))}return l}function LN(e){var t=(e=Object(w.a)(e,w.a.EMPTY_OBJECT)).pickColorQualifier;if(Object(u.a)(t)&&"uniform"!==t&&"varying"!==t)throw new h.a("options.pickColorQualifier must be 'uniform' or 'varying'.");this.defines=Object(u.a)(e.defines)?e.defines.slice(0):[],this.sources=Object(u.a)(e.sources)?e.sources.slice(0):[],this.pickColorQualifier=t,this.includeBuiltIns=Object(w.a)(e.includeBuiltIns,!0)}for(var NN in LN.prototype.clone=function(){return new LN({sources:this.sources,defines:this.defines,pickColorQualifier:this.pickColorQualifier,includeBuiltIns:this.includeBuiltIns})},LN.replaceMain=function(e,t){return t="void "+t+"()",e.replace(/void\s+main\s*\(\s*(?:void)?\s*\)/g,t)},LN.prototype.createCombinedVertexShader=function(e){return RN(this,!1,e)},LN.prototype.createCombinedFragmentShader=function(e){return RN(this,!0,e)},LN._czmBuiltinsAndUniforms={},DN)DN.hasOwnProperty(NN)&&(LN._czmBuiltinsAndUniforms[NN]=DN[NN]);for(var FN in kM)if(kM.hasOwnProperty(FN)){var kN=kM[FN];"function"==typeof kN.getDeclaration&&(LN._czmBuiltinsAndUniforms[FN]=kN.getDeclaration(FN))}LN.createPickVertexShaderSource=function(e){return LN.replaceMain(e,"czm_old_main")+"\nattribute vec4 pickColor; \nvarying vec4 czm_pickColor; \nvoid main() \n{ \n    czm_old_main(); \n    czm_pickColor = pickColor; \n}"},LN.createPickFragmentShaderSource=function(e,t){return LN.replaceMain(e,"czm_old_main")+"\n"+(t+" vec4 czm_pickColor; \nvoid main() \n{ \n    czm_old_main(); \n    if (gl_FragColor.a == 0.0) { \n       discard; \n    } \n    gl_FragColor = czm_pickColor; \n}")},LN.findVarying=function(e,t){for(var i=e.sources,n=t.length,r=0;r<n;++r)for(var a=t[r],o=i.length,s=0;s<o;++s)if(-1!==i[s].indexOf(a))return a};var BN=["v_normalEC","v_normal"];LN.findNormalVarying=function(e){return LN.findVarying(e,BN)};var zN=["v_positionEC"];LN.findPositionVarying=function(e){return LN.findVarying(e,zN)};var UN=LN,VN="#ifdef GL_EXT_frag_depth\n#extension GL_EXT_frag_depth : enable\n#endif\n#ifdef VECTOR_TILE\nuniform vec4 u_highlightColor;\n#endif\nvoid main(void)\n{\n#ifdef VECTOR_TILE\ngl_FragColor = czm_gammaCorrect(u_highlightColor);\n#else\ngl_FragColor = vec4(1.0);\n#endif\nczm_writeDepthClampedToFarPlane();\n}\n",HN="attribute vec3 position3DHigh;\nattribute vec3 position3DLow;\nattribute float batchId;\n#ifdef EXTRUDED_GEOMETRY\nattribute vec3 extrudeDirection;\nuniform float u_globeMinimumAltitude;\n#endif // EXTRUDED_GEOMETRY\n#ifdef PER_INSTANCE_COLOR\nvarying vec4 v_color;\n#endif // PER_INSTANCE_COLOR\n#ifdef TEXTURE_COORDINATES\n#ifdef SPHERICAL\nvarying vec4 v_sphericalExtents;\n#else // SPHERICAL\nvarying vec2 v_inversePlaneExtents;\nvarying vec4 v_westPlane;\nvarying vec4 v_southPlane;\n#endif // SPHERICAL\nvarying vec3 v_uvMinAndSphericalLongitudeRotation;\nvarying vec3 v_uMaxAndInverseDistance;\nvarying vec3 v_vMaxAndInverseDistance;\n#endif // TEXTURE_COORDINATES\nvoid main()\n{\nvec4 position = czm_computePosition();\n#ifdef EXTRUDED_GEOMETRY\nfloat delta = min(u_globeMinimumAltitude, czm_geometricToleranceOverMeter * length(position.xyz));\ndelta *= czm_sceneMode == czm_sceneMode3D ? 1.0 : 0.0;\nposition = position + vec4(extrudeDirection * delta, 0.0);\n#endif\n#ifdef TEXTURE_COORDINATES\n#ifdef SPHERICAL\nv_sphericalExtents = czm_batchTable_sphericalExtents(batchId);\nv_uvMinAndSphericalLongitudeRotation.z = czm_batchTable_longitudeRotation(batchId);\n#else // SPHERICAL\n#ifdef COLUMBUS_VIEW_2D\nvec4 planes2D_high = czm_batchTable_planes2D_HIGH(batchId);\nvec4 planes2D_low = czm_batchTable_planes2D_LOW(batchId);\nvec2 idlSplitNewPlaneHiLow = vec2(EAST_MOST_X_HIGH - (WEST_MOST_X_HIGH - planes2D_high.w), EAST_MOST_X_LOW - (WEST_MOST_X_LOW - planes2D_low.w));\nbool idlSplit = planes2D_high.x > planes2D_high.w && position3DLow.y > 0.0;\nplanes2D_high.w = czm_branchFreeTernary(idlSplit, idlSplitNewPlaneHiLow.x, planes2D_high.w);\nplanes2D_low.w = czm_branchFreeTernary(idlSplit, idlSplitNewPlaneHiLow.y, planes2D_low.w);\nidlSplit = planes2D_high.x > planes2D_high.w && position3DLow.y < 0.0;\nidlSplitNewPlaneHiLow = vec2(WEST_MOST_X_HIGH - (EAST_MOST_X_HIGH - planes2D_high.x), WEST_MOST_X_LOW - (EAST_MOST_X_LOW - planes2D_low.x));\nplanes2D_high.x = czm_branchFreeTernary(idlSplit, idlSplitNewPlaneHiLow.x, planes2D_high.x);\nplanes2D_low.x = czm_branchFreeTernary(idlSplit, idlSplitNewPlaneHiLow.y, planes2D_low.x);\nvec3 southWestCorner = (czm_modelViewRelativeToEye * czm_translateRelativeToEye(vec3(0.0, planes2D_high.xy), vec3(0.0, planes2D_low.xy))).xyz;\nvec3 northWestCorner = (czm_modelViewRelativeToEye * czm_translateRelativeToEye(vec3(0.0, planes2D_high.x, planes2D_high.z), vec3(0.0, planes2D_low.x, planes2D_low.z))).xyz;\nvec3 southEastCorner = (czm_modelViewRelativeToEye * czm_translateRelativeToEye(vec3(0.0, planes2D_high.w, planes2D_high.y), vec3(0.0, planes2D_low.w, planes2D_low.y))).xyz;\n#else // COLUMBUS_VIEW_2D\nvec3 southWestCorner = (czm_modelViewRelativeToEye * czm_translateRelativeToEye(czm_batchTable_southWest_HIGH(batchId), czm_batchTable_southWest_LOW(batchId))).xyz;\nvec3 northWestCorner = czm_normal * czm_batchTable_northward(batchId) + southWestCorner;\nvec3 southEastCorner = czm_normal * czm_batchTable_eastward(batchId) + southWestCorner;\n#endif // COLUMBUS_VIEW_2D\nvec3 eastWard = southEastCorner - southWestCorner;\nfloat eastExtent = length(eastWard);\neastWard /= eastExtent;\nvec3 northWard = northWestCorner - southWestCorner;\nfloat northExtent = length(northWard);\nnorthWard /= northExtent;\nv_westPlane = vec4(eastWard, -dot(eastWard, southWestCorner));\nv_southPlane = vec4(northWard, -dot(northWard, southWestCorner));\nv_inversePlaneExtents = vec2(1.0 / eastExtent, 1.0 / northExtent);\n#endif // SPHERICAL\nvec4 uvMinAndExtents = czm_batchTable_uvMinAndExtents(batchId);\nvec4 uMaxVmax = czm_batchTable_uMaxVmax(batchId);\nv_uMaxAndInverseDistance = vec3(uMaxVmax.xy, uvMinAndExtents.z);\nv_vMaxAndInverseDistance = vec3(uMaxVmax.zw, uvMinAndExtents.w);\nv_uvMinAndSphericalLongitudeRotation.xy = uvMinAndExtents.xy;\n#endif // TEXTURE_COORDINATES\n#ifdef PER_INSTANCE_COLOR\nv_color = czm_batchTable_color(batchId);\n#endif\ngl_Position = czm_depthClampFarPlane(czm_modelViewProjectionRelativeToEye * position);\n}\n",GN={NEVER:un.NEVER,LESS:un.LESS,EQUAL:un.EQUAL,LESS_OR_EQUAL:un.LEQUAL,GREATER:un.GREATER,NOT_EQUAL:un.NOTEQUAL,GREATER_OR_EQUAL:un.GEQUAL,ALWAYS:un.ALWAYS},qN=Object(E.a)(GN),WN={STREAM_DRAW:un.STREAM_DRAW,STATIC_DRAW:un.STATIC_DRAW,DYNAMIC_DRAW:un.DYNAMIC_DRAW,validate:function(e){return e===WN.STREAM_DRAW||e===WN.STATIC_DRAW||e===WN.DYNAMIC_DRAW}},YN=Object(E.a)(WN);function XN(e){if(e=Object(w.a)(e,w.a.EMPTY_OBJECT),x.a.defined("options.context",e.context),!Object(u.a)(e.typedArray)&&!Object(u.a)(e.sizeInBytes))throw new h.a("Either options.sizeInBytes or options.typedArray is required.");if(Object(u.a)(e.typedArray)&&Object(u.a)(e.sizeInBytes))throw new h.a("Cannot pass in both options.sizeInBytes and options.typedArray.");if(Object(u.a)(e.typedArray)&&(x.a.typeOf.object("options.typedArray",e.typedArray),x.a.typeOf.number("options.typedArray.byteLength",e.typedArray.byteLength)),!YN.validate(e.usage))throw new h.a("usage is invalid.");var t=e.context._gl,i=e.bufferTarget,n=e.typedArray,r=e.sizeInBytes,a=e.usage,o=Object(u.a)(n);o&&(r=n.byteLength),x.a.typeOf.number.greaterThan("sizeInBytes",r,0);var s=t.createBuffer();t.bindBuffer(i,s),t.bufferData(i,o?n:r,a),t.bindBuffer(i,null),this._gl=t,this._webgl2=e.context._webgl2,this._bufferTarget=i,this._sizeInBytes=r,this._usage=a,this._buffer=s,this.vertexArrayDestroyable=!0}XN.createVertexBuffer=function(e){return x.a.defined("options.context",e.context),new XN({context:e.context,bufferTarget:un.ARRAY_BUFFER,typedArray:e.typedArray,sizeInBytes:e.sizeInBytes,usage:e.usage})},XN.createIndexBuffer=function(e){if(x.a.defined("options.context",e.context),!Sl.validate(e.indexDatatype))throw new h.a("Invalid indexDatatype.");if(e.indexDatatype===Sl.UNSIGNED_INT&&!e.context.elementIndexUint)throw new h.a("IndexDatatype.UNSIGNED_INT requires OES_element_index_uint, which is not supported on this system.  Check context.elementIndexUint.");var t=e.context,i=e.indexDatatype,n=Sl.getSizeInBytes(i),r=new XN({context:t,bufferTarget:un.ELEMENT_ARRAY_BUFFER,typedArray:e.typedArray,sizeInBytes:e.sizeInBytes,usage:e.usage}),a=r.sizeInBytes/n;return Object(O.a)(r,{indexDatatype:{get:function(){return i}},bytesPerIndex:{get:function(){return n}},numberOfIndices:{get:function(){return a}}}),r},Object(O.a)(XN.prototype,{sizeInBytes:{get:function(){return this._sizeInBytes}},usage:{get:function(){return this._usage}}}),XN.prototype._getBuffer=function(){return this._buffer},XN.prototype.copyFromArrayView=function(e,t){t=Object(w.a)(t,0),x.a.defined("arrayView",e),x.a.typeOf.number.lessThanOrEquals("offsetInBytes + arrayView.byteLength",t+e.byteLength,this._sizeInBytes);var i=this._gl,n=this._bufferTarget;i.bindBuffer(n,this._buffer),i.bufferSubData(n,t,e),i.bindBuffer(n,null)},XN.prototype.updateFromArrayView=function(e){x.a.defined("arrayView",e);var t=this._gl,i=this._bufferTarget;t.bindBuffer(i,this._buffer),t.bufferData(i,e,this._usage),t.bindBuffer(i,null)},XN.prototype.copyFromBuffer=function(e,t,i,n){if(!this._webgl2)throw new h.a("A WebGL 2 context is required.");if(!Object(u.a)(e))throw new h.a("readBuffer must be defined.");if(!Object(u.a)(n)||n<=0)throw new h.a("sizeInBytes must be defined and be greater than zero.");if(!Object(u.a)(t)||t<0||t+n>e._sizeInBytes)throw new h.a("readOffset must be greater than or equal to zero and readOffset + sizeInBytes must be less than of equal to readBuffer.sizeInBytes.");if(!Object(u.a)(i)||i<0||i+n>this._sizeInBytes)throw new h.a("writeOffset must be greater than or equal to zero and writeOffset + sizeInBytes must be less than of equal to this.sizeInBytes.");if(this._buffer===e._buffer&&(i>=t&&i<t+n||t>i&&t<i+n))throw new h.a("When readBuffer is equal to this, the ranges [readOffset + sizeInBytes) and [writeOffset, writeOffset + sizeInBytes) must not overlap.");if(this._bufferTarget===un.ELEMENT_ARRAY_BUFFER&&e._bufferTarget!==un.ELEMENT_ARRAY_BUFFER||this._bufferTarget!==un.ELEMENT_ARRAY_BUFFER&&e._bufferTarget===un.ELEMENT_ARRAY_BUFFER)throw new h.a("Can not copy an index buffer into another buffer type.");var r=un.COPY_READ_BUFFER,a=un.COPY_WRITE_BUFFER,o=this._gl;o.bindBuffer(a,this._buffer),o.bindBuffer(r,e._buffer),o.copyBufferSubData(r,a,t,i,n),o.bindBuffer(a,null),o.bindBuffer(r,null)},XN.prototype.getBufferData=function(e,t,i,n){if(t=Object(w.a)(t,0),i=Object(w.a)(i,0),!this._webgl2)throw new h.a("A WebGL 2 context is required.");if(!Object(u.a)(e))throw new h.a("arrayView is required.");var r,a,o=e.byteLength;if(Object(u.a)(n)?(r=n,Object(u.a)(o)?a=1:(o=e.length,a=e.BYTES_PER_ELEMENT)):Object(u.a)(o)?(r=o-i,a=1):(r=(o=e.length)-i,a=e.BYTES_PER_ELEMENT),i<0||i>o)throw new h.a("destinationOffset must be greater than zero and less than the arrayView length.");if(i+r>o)throw new h.a("destinationOffset + length must be less than or equal to the arrayViewLength.");if(t<0||t>this._sizeInBytes)throw new h.a("sourceOffset must be greater than zero and less than the buffers size.");if(t+r*a>this._sizeInBytes)throw new h.a("sourceOffset + length must be less than the buffers size.");var s=this._gl,c=un.COPY_READ_BUFFER;s.bindBuffer(c,this._buffer),s.getBufferSubData(c,t,e,i,n),s.bindBuffer(c,null)},XN.prototype.isDestroyed=function(){return!1},XN.prototype.destroy=function(){return this._gl.deleteBuffer(this._buffer),rl(this)};var ZN=XN;function QN(e,t,i,n){var r=Object(u.a)(t.vertexBuffer),a=Object(u.a)(t.value),o=t.value?t.value.length:t.componentsPerAttribute;if(!r&&!a)throw new h.a("attribute must have a vertexBuffer or a value.");if(r&&a)throw new h.a("attribute cannot have both a vertexBuffer and a value.  It must have either a vertexBuffer property defining per-vertex data or a value property defining data for all vertices.");if(1!==o&&2!==o&&3!==o&&4!==o){if(a)throw new h.a("attribute.value.length must be in the range [1, 4].");throw new h.a("attribute.componentsPerAttribute must be in the range [1, 4].")}if(Object(u.a)(t.componentDatatype)&&!dn.validate(t.componentDatatype))throw new h.a("attribute must have a valid componentDatatype or not specify it.");if(Object(u.a)(t.strideInBytes)&&t.strideInBytes>255)throw new h.a("attribute must have a strideInBytes less than or equal to 255 or not specify it.");if(Object(u.a)(t.instanceDivisor)&&t.instanceDivisor>0&&!n.instancedArrays)throw new h.a("instanced arrays is not supported");if(Object(u.a)(t.instanceDivisor)&&t.instanceDivisor<0)throw new h.a("attribute must have an instanceDivisor greater than or equal to zero");if(Object(u.a)(t.instanceDivisor)&&a)throw new h.a("attribute cannot have have an instanceDivisor if it is not backed by a buffer");if(Object(u.a)(t.instanceDivisor)&&t.instanceDivisor>0&&0===t.index)throw new h.a("attribute zero cannot have an instanceDivisor greater than 0");var s={index:Object(w.a)(t.index,i),enabled:Object(w.a)(t.enabled,!0),vertexBuffer:t.vertexBuffer,value:a?t.value.slice(0):void 0,componentsPerAttribute:o,componentDatatype:Object(w.a)(t.componentDatatype,dn.FLOAT),normalize:Object(w.a)(t.normalize,!1),offsetInBytes:Object(w.a)(t.offsetInBytes,0),strideInBytes:Object(w.a)(t.strideInBytes,0),instanceDivisor:Object(w.a)(t.instanceDivisor,0)};if(r)s.vertexAttrib=function(e){var t=this.index;e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer._getBuffer()),e.vertexAttribPointer(t,this.componentsPerAttribute,this.componentDatatype,this.normalize,this.strideInBytes,this.offsetInBytes),e.enableVertexAttribArray(t),this.instanceDivisor>0&&(n.glVertexAttribDivisor(t,this.instanceDivisor),n._vertexAttribDivisors[t]=this.instanceDivisor,n._previousDrawInstanced=!0)},s.disableVertexAttribArray=function(e){e.disableVertexAttribArray(this.index),this.instanceDivisor>0&&n.glVertexAttribDivisor(i,0)};else{switch(s.componentsPerAttribute){case 1:s.vertexAttrib=function(e){e.vertexAttrib1fv(this.index,this.value)};break;case 2:s.vertexAttrib=function(e){e.vertexAttrib2fv(this.index,this.value)};break;case 3:s.vertexAttrib=function(e){e.vertexAttrib3fv(this.index,this.value)};break;case 4:s.vertexAttrib=function(e){e.vertexAttrib4fv(this.index,this.value)}}s.disableVertexAttribArray=function(e){}}e.push(s)}function KN(e,t,i){for(var n=0;n<t.length;++n){var r=t[n];r.enabled&&r.vertexAttrib(e)}Object(u.a)(i)&&e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,i._getBuffer())}function JN(e){e=Object(w.a)(e,w.a.EMPTY_OBJECT),x.a.defined("options.context",e.context),x.a.defined("options.attributes",e.attributes);var t,i=e.context,n=i._gl,r=e.attributes,a=e.indexBuffer,o=[],s=1,c=!1,l=!1,d=r.length;for(t=0;t<d;++t)QN(o,r[t],t,i);for(d=o.length,t=0;t<d;++t){var f=o[t];if(Object(u.a)(f.vertexBuffer)&&0===f.instanceDivisor){var p=f.strideInBytes||f.componentsPerAttribute*dn.getSizeInBytes(f.componentDatatype);s=f.vertexBuffer.sizeInBytes/p;break}}for(t=0;t<d;++t)o[t].instanceDivisor>0&&(c=!0),Object(u.a)(o[t].value)&&(l=!0);var m,_={};for(t=0;t<d;++t){var g=o[t].index;if(_[g])throw new h.a("Index "+g+" is used by more than one attribute.");_[g]=!0}i.vertexArrayObject&&(m=i.glCreateVertexArray(),i.glBindVertexArray(m),KN(n,o,a),i.glBindVertexArray(null)),this._numberOfVertices=s,this._hasInstancedAttributes=c,this._hasConstantAttributes=l,this._context=i,this._gl=n,this._vao=m,this._attributes=o,this._indexBuffer=a}function $N(e){return e.values.length/e.componentsPerAttribute}function eF(e){return dn.getSizeInBytes(e.componentDatatype)*e.componentsPerAttribute}JN.fromGeometry=function(e){e=Object(w.a)(e,w.a.EMPTY_OBJECT),x.a.defined("options.context",e.context);var t,i,n,r,a=e.context,o=Object(w.a)(e.geometry,w.a.EMPTY_OBJECT),s=Object(w.a)(e.bufferUsage,YN.DYNAMIC_DRAW),c=Object(w.a)(e.attributeLocations,w.a.EMPTY_OBJECT),l=Object(w.a)(e.interleave,!1),h=e.vertexArrayAttributes,d=Object(u.a)(h)?h:[],f=o.attributes;if(l){var p=function(e){var t,i,n,r,a=[];for(i in e)e.hasOwnProperty(i)&&Object(u.a)(e[i])&&Object(u.a)(e[i].values)&&(a.push(i),e[i].componentDatatype===dn.DOUBLE&&(e[i].componentDatatype=dn.FLOAT,e[i].values=dn.createTypedArray(dn.FLOAT,e[i].values)));var o=a.length;if(o>0)for(r=$N(e[a[0]]),t=1;t<o;++t){var s=$N(e[a[t]]);if(s!==r)throw new Ce.a("Each attribute list must have the same number of vertices.  Attribute "+a[t]+" has a different number of vertices ("+s.toString()+") than attribute "+a[0]+" ("+r.toString()+").")}a.sort((function(t,i){return dn.getSizeInBytes(e[i].componentDatatype)-dn.getSizeInBytes(e[t].componentDatatype)}));var c=0,l={};for(t=0;t<o;++t)i=a[t],n=e[i],l[i]=c,c+=eF(n);if(c>0){var h=dn.getSizeInBytes(e[a[0]].componentDatatype),d=c%h;0!==d&&(c+=h-d);var f=new ArrayBuffer(r*c),p={};for(t=0;t<o;++t){i=a[t];var m=dn.getSizeInBytes(e[i].componentDatatype);p[i]={pointer:dn.createTypedArray(e[i].componentDatatype,f),index:l[i]/m,strideInComponentType:c/m}}for(t=0;t<r;++t)for(var _=0;_<o;++_){i=a[_];for(var g=(n=e[i]).values,v=p[i],b=v.pointer,y=n.componentsPerAttribute,w=0;w<y;++w)b[v.index+w]=g[t*y+w];v.index+=v.strideInComponentType}return{buffer:f,offsetsInBytes:l,vertexSizeInBytes:c}}}(f);if(Object(u.a)(p)){n=ZN.createVertexBuffer({context:a,typedArray:p.buffer,usage:s});var m=p.offsetsInBytes,_=p.vertexSizeInBytes;for(t in f)f.hasOwnProperty(t)&&Object(u.a)(f[t])&&(i=f[t],Object(u.a)(i.values)?d.push({index:c[t],vertexBuffer:n,componentDatatype:i.componentDatatype,componentsPerAttribute:i.componentsPerAttribute,normalize:i.normalize,offsetInBytes:m[t],strideInBytes:_}):d.push({index:c[t],value:i.value,componentDatatype:i.componentDatatype,normalize:i.normalize}))}}else for(t in f)if(f.hasOwnProperty(t)&&Object(u.a)(f[t])){var g=(i=f[t]).componentDatatype;g===dn.DOUBLE&&(g=dn.FLOAT),n=void 0,Object(u.a)(i.values)&&(n=ZN.createVertexBuffer({context:a,typedArray:dn.createTypedArray(g,i.values),usage:s})),d.push({index:c[t],vertexBuffer:n,value:i.value,componentDatatype:g,componentsPerAttribute:i.componentsPerAttribute,normalize:i.normalize})}var v=o.indices;return Object(u.a)(v)&&(r=La.computeNumberOfVertices(o)>=I.SIXTY_FOUR_KILOBYTES&&a.elementIndexUint?ZN.createIndexBuffer({context:a,typedArray:new Uint32Array(v),usage:s,indexDatatype:Sl.UNSIGNED_INT}):ZN.createIndexBuffer({context:a,typedArray:new Uint16Array(v),usage:s,indexDatatype:Sl.UNSIGNED_SHORT})),new JN({context:a,attributes:d,indexBuffer:r})},Object(O.a)(JN.prototype,{numberOfAttributes:{get:function(){return this._attributes.length}},numberOfVertices:{get:function(){return this._numberOfVertices}},indexBuffer:{get:function(){return this._indexBuffer}}}),JN.prototype.getAttribute=function(e){return x.a.defined("index",e),this._attributes[e]},JN.prototype._bind=function(){Object(u.a)(this._vao)?(this._context.glBindVertexArray(this._vao),this._context.instancedArrays&&function(e){var t=e._context,i=e._hasInstancedAttributes;if(i||t._previousDrawInstanced){t._previousDrawInstanced=i;var n,r=t._vertexAttribDivisors,a=e._attributes,o=HD.maximumVertexAttributes;if(i){var s=a.length;for(n=0;n<s;++n){var c=a[n];if(c.enabled){var l=c.instanceDivisor,u=c.index;l!==r[u]&&(t.glVertexAttribDivisor(u,l),r[u]=l)}}}else for(n=0;n<o;++n)r[n]>0&&(t.glVertexAttribDivisor(n,0),r[n]=0)}}(this),this._hasConstantAttributes&&function(e,t){for(var i=e._attributes,n=i.length,r=0;r<n;++r){var a=i[r];a.enabled&&Object(u.a)(a.value)&&a.vertexAttrib(t)}}(this,this._gl)):KN(this._gl,this._attributes,this._indexBuffer)},JN.prototype._unBind=function(){if(Object(u.a)(this._vao))this._context.glBindVertexArray(null);else{for(var e=this._attributes,t=this._gl,i=0;i<e.length;++i){var n=e[i];n.enabled&&n.disableVertexAttribArray(t)}this._indexBuffer&&t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)}},JN.prototype.isDestroyed=function(){return!1},JN.prototype.destroy=function(){for(var e=this._attributes,t=0;t<e.length;++t){var i=e[t].vertexBuffer;Object(u.a)(i)&&!i.isDestroyed()&&i.vertexArrayDestroyable&&i.destroy()}var n=this._indexBuffer;return Object(u.a)(n)&&!n.isDestroyed()&&n.vertexArrayDestroyable&&n.destroy(),Object(u.a)(this._vao)&&this._context.glDeleteVertexArray(this._vao),rl(this)};var tF=JN;function iF(e,t,i){if(!Object(u.a)(e))throw new h.a("context is required");if(!Object(u.a)(t))throw new h.a("attributes is required");if(!Object(u.a)(i))throw new h.a("numberOfInstances is required");if(this._attributes=t,this._numberOfInstances=i,0!==t.length){var n=function(e){for(var t=!1,i=e.length,n=0;n<i;++n)if(e[n].componentDatatype!==dn.UNSIGNED_BYTE){t=!0;break}return t?mx.FLOAT:mx.UNSIGNED_BYTE}(t),r=e.floatingPointTexture,a=n===mx.FLOAT&&!r,o=function(e,t){for(var i=new Array(e.length),n=0,r=e.length,a=0;a<r;++a){var o=e[a].componentDatatype;i[a]=n,o!==dn.UNSIGNED_BYTE&&t?n+=4:++n}return i}(t,a),s=function(e,t,i){var n=e.length,r=e[n-1];if(t[n-1].componentDatatype!==dn.UNSIGNED_BYTE&&i)return r+4;return r+1}(o,t,a),c=Math.floor(HD.maximumTextureSize/s),l=Math.min(i,c),d=s*l,f=Math.ceil(i/l),p=1/d,m=.5*p,_=1/f,g=.5*_;this._textureDimensions=new Rt(d,f),this._textureStep=new Te(p,m,_,g),this._pixelDatatype=a?mx.UNSIGNED_BYTE:n,this._packFloats=a,this._offsets=o,this._stride=s,this._texture=void 0;var v=4*d*f;this._batchValues=n!==mx.FLOAT||a?new Uint8Array(v):new Float32Array(v),this._batchValuesDirty=!1}}function nF(e,t){var i=e[t].componentsPerAttribute;return 2===i?Rt:3===i?z:4===i?Te:Number}Object(O.a)(iF.prototype,{attributes:{get:function(){return this._attributes}},numberOfInstances:{get:function(){return this._numberOfInstances}}});var rF=new Te;var aF=new Te;iF.prototype.getBatchedAttribute=function(e,t,i){if(e<0||e>=this._numberOfInstances)throw new h.a("instanceIndex is out of range.");if(t<0||t>=this._attributes.length)throw new h.a("attributeIndex is out of range");var n,r=this._attributes,a=this._offsets[t],o=4*this._stride*e+4*a;n=this._packFloats&&r[t].componentDatatype!==mx.UNSIGNED_BYTE?function(e,t,i){var n=Te.unpack(e,t,rF),r=Te.unpackFloat(n);n=Te.unpack(e,t+4,rF);var a=Te.unpackFloat(n);n=Te.unpack(e,t+8,rF);var o=Te.unpackFloat(n);n=Te.unpack(e,t+12,rF);var s=Te.unpackFloat(n);return Te.fromElements(r,a,o,s,i)}(this._batchValues,o,aF):Te.unpack(this._batchValues,o,aF);var s=nF(r,t);return Object(u.a)(s.fromCartesian4)?s.fromCartesian4(n,i):Object(u.a)(s.clone)?s.clone(n,i):n.x};var oF=[void 0,void 0,new Rt,new z,new Te],sF=new Te;function cF(e,t){var i=e._textureDimensions;e._texture=new hj({context:t,pixelFormat:gx.RGBA,pixelDatatype:e._pixelDatatype,width:i.x,height:i.y,sampler:new tj({minificationFilter:KD.NEAREST,magnificationFilter:ZD.NEAREST}),flipY:!1})}function lF(e){var t=e._textureDimensions;e._texture.copyFrom({width:t.x,height:t.y,arrayBufferView:e._batchValues})}function uF(e,t){var i=e._attributes[t],n=i.componentsPerAttribute,r=i.functionName,a=function(e){return 1===e?"float":"vec"+e}(n),o=function(e){return 1===e?".x":2===e?".xy":3===e?".xyz":""}(n),s=a+" "+r+"(float batchId) \n{ \n    vec2 st = computeSt(batchId); \n    st.x += batchTextureStep.x * float("+e._offsets[t]+"); \n";return e._packFloats&&i.componentDatatype!==mx.UNSIGNED_BYTE?s+="vec4 textureValue; \ntextureValue.x = czm_unpackFloat(texture2D(batchTexture, st)); \ntextureValue.y = czm_unpackFloat(texture2D(batchTexture, st + vec2(batchTextureStep.x, 0.0))); \ntextureValue.z = czm_unpackFloat(texture2D(batchTexture, st + vec2(batchTextureStep.x * 2.0, 0.0))); \ntextureValue.w = czm_unpackFloat(texture2D(batchTexture, st + vec2(batchTextureStep.x * 3.0, 0.0))); \n":s+="    vec4 textureValue = texture2D(batchTexture, st); \n",s+="    "+a+" value = textureValue"+o+"; \n",e._pixelDatatype!==mx.UNSIGNED_BYTE||i.componentDatatype!==dn.UNSIGNED_BYTE||i.normalize?e._pixelDatatype===mx.FLOAT&&i.componentDatatype===dn.UNSIGNED_BYTE&&i.normalize&&(s+="value /= 255.0; \n"):s+="value *= 255.0; \n",s+="    return value; \n} \n"}iF.prototype.setBatchedAttribute=function(e,t,i){if(e<0||e>=this._numberOfInstances)throw new h.a("instanceIndex is out of range.");if(t<0||t>=this._attributes.length)throw new h.a("attributeIndex is out of range");if(!Object(u.a)(i))throw new h.a("value is required.");var n=this._attributes,r=oF[n[t].componentsPerAttribute],a=this.getBatchedAttribute(e,t,r),o=nF(this._attributes,t);if(!(Object(u.a)(o.equals)?o.equals(a,i):a===i)){var s=sF;s.x=Object(u.a)(i.x)?i.x:i,s.y=Object(u.a)(i.y)?i.y:0,s.z=Object(u.a)(i.z)?i.z:0,s.w=Object(u.a)(i.w)?i.w:0;var c=this._offsets[t],l=4*this._stride*e+4*c;this._packFloats&&n[t].componentDatatype!==mx.UNSIGNED_BYTE?function(e,t,i){var n=Te.packFloat(e.x,rF);Te.pack(n,t,i),n=Te.packFloat(e.y,n),Te.pack(n,t,i+4),n=Te.packFloat(e.z,n),Te.pack(n,t,i+8),n=Te.packFloat(e.w,n),Te.pack(n,t,i+12)}(s,this._batchValues,l):Te.pack(s,this._batchValues,l),this._batchValuesDirty=!0}},iF.prototype.update=function(e){Object(u.a)(this._texture)&&!this._batchValuesDirty||0===this._attributes.length||(this._batchValuesDirty=!1,Object(u.a)(this._texture)||cF(this,e.context),lF(this))},iF.prototype.updateContext=function(e){Object(u.a)(this._texture)&&!this._batchValuesDirty||0===this._attributes.length||(this._batchValuesDirty=!1,Object(u.a)(this._texture)||cF(this,e),lF(this))},iF.prototype.getUniformMapCallback=function(){var e=this;return function(t){if(0===e._attributes.length)return t;var i={batchTexture:function(){return e._texture},batchTextureDimensions:function(){return e._textureDimensions},batchTextureStep:function(){return e._textureStep}};return Object(ff.a)(t,i)}},iF.prototype.getVertexShaderCallback=function(){var e=this._attributes;if(0===e.length)return function(e){return e};var t,i,n="uniform sampler2D batchTexture; \n";n+=(i=(t=this)._stride,(1===t._textureDimensions.y?"uniform vec4 batchTextureStep; \nvec2 computeSt(float batchId) \n{ \n    float stepX = batchTextureStep.x; \n    float centerX = batchTextureStep.y; \n    float numberOfAttributes = float("+i+"); \n    return vec2(centerX + (batchId * numberOfAttributes * stepX), 0.5); \n} \n":"uniform vec4 batchTextureStep; \nuniform vec2 batchTextureDimensions; \nvec2 computeSt(float batchId) \n{ \n    float stepX = batchTextureStep.x; \n    float centerX = batchTextureStep.y; \n    float stepY = batchTextureStep.z; \n    float centerY = batchTextureStep.w; \n    float numberOfAttributes = float("+i+"); \n    float xId = mod(batchId * numberOfAttributes, batchTextureDimensions.x); \n    float yId = floor(batchId * numberOfAttributes / batchTextureDimensions.x); \n    return vec2(centerX + (xId * stepX), centerY + (yId * stepY)); \n} \n")+"\n");for(var r=e.length,a=0;a<r;++a)n+=uF(this,a);return function(e){var t=e.indexOf("void main"),i=e.substring(0,t),r=e.substring(t);return i+"\n"+n+"\n"+r}},iF.prototype.isDestroyed=function(){return!1},iF.prototype.destroy=function(){return this._texture=this._texture&&this._texture.destroy(),rl(this)};var hF=iF;function dF(e,t){var i=e.attributes,n=i.position,r=n.values.length/n.componentsPerAttribute;i.batchId=new Na({componentDatatype:dn.FLOAT,componentsPerAttribute:1,values:new Float32Array(r)});for(var a=i.batchId.values,o=0;o<r;++o)a[o]=t}function fF(e){var t,i,n,r=e.instances,a=e.projection,o=e.elementIndexUintSupported,s=e.scene3DOnly,c=e.vertexCacheOptimize,l=e.compressVertices,d=e.modelMatrix,f=r.length;for(t=0;t<f;++t)if(Object(u.a)(r[t].geometry)){n=r[t].geometry.primitiveType;break}for(t=1;t<f;++t)if(Object(u.a)(r[t].geometry)&&r[t].geometry.primitiveType!==n)throw new h.a("All instance geometries must have the same primitiveType.");if(function(e,t,i){var n,r=!i,a=e.length;if(!r&&a>1){var o=e[0].modelMatrix;for(n=1;n<a;++n)if(!Be.equals(o,e[n].modelMatrix)){r=!0;break}}if(r)for(n=0;n<a;++n)Object(u.a)(e[n].geometry)&&id.transformToWorldCoordinates(e[n]);else Be.multiplyTransformation(t,e[0].modelMatrix,t)}(r,d,s),!s)for(t=0;t<f;++t)Object(u.a)(r[t].geometry)&&id.splitLongitude(r[t]);if(function(e){for(var t=e.length,i=0;i<t;++i){var n=e[i];Object(u.a)(n.geometry)?dF(n.geometry,i):Object(u.a)(n.westHemisphereGeometry)&&Object(u.a)(n.eastHemisphereGeometry)&&(dF(n.westHemisphereGeometry,i),dF(n.eastHemisphereGeometry,i))}}(r),c)for(t=0;t<f;++t){var p=r[t];Object(u.a)(p.geometry)?(id.reorderForPostVertexCache(p.geometry),id.reorderForPreVertexCache(p.geometry)):Object(u.a)(p.westHemisphereGeometry)&&Object(u.a)(p.eastHemisphereGeometry)&&(id.reorderForPostVertexCache(p.westHemisphereGeometry),id.reorderForPreVertexCache(p.westHemisphereGeometry),id.reorderForPostVertexCache(p.eastHemisphereGeometry),id.reorderForPreVertexCache(p.eastHemisphereGeometry))}var m=id.combineInstances(r);for(f=m.length,t=0;t<f;++t){var _,g=(i=m[t]).attributes;if(s)for(_ in g)g.hasOwnProperty(_)&&g[_].componentDatatype===dn.DOUBLE&&id.encodeAttribute(i,_,_+"3DHigh",_+"3DLow");else for(_ in g)if(g.hasOwnProperty(_)&&g[_].componentDatatype===dn.DOUBLE){var v=_+"3D",b=_+"2D";id.projectTo2D(i,_,v,b,a),Object(u.a)(i.boundingSphere)&&"position"===_&&(i.boundingSphereCV=St.fromVertices(i.attributes.position2D.values)),id.encodeAttribute(i,v,v+"High",v+"Low"),id.encodeAttribute(i,b,b+"High",b+"Low")}l&&id.compressVertices(i)}if(!o){var y=[];for(f=m.length,t=0;t<f;++t)i=m[t],y=y.concat(id.fitToUnsignedShortIndices(i));m=y}return m}function pF(e,t,i,n){var r,a,o,s=n.length-1;if(s>=0){var c=n[s];r=c.offset+c.count,a=i[o=c.index].indices.length}else r=0,a=i[o=0].indices.length;for(var l=e.length,h=0;h<l;++h){var d=e[h][t];if(Object(u.a)(d)){var f=d.indices.length;r+f>a&&(r=0,a=i[++o].indices.length),n.push({index:o,offset:r,count:f}),r+=f}}}var mF={};function _F(e,t){var i=e.attributes;for(var n in i)if(i.hasOwnProperty(n)){var r=i[n];Object(u.a)(r)&&Object(u.a)(r.values)&&t.push(r.values.buffer)}Object(u.a)(e.indices)&&t.push(e.indices.buffer)}function gF(e,t){var i=e.length,n=new Float64Array(1+19*i),r=0;n[r++]=i;for(var a=0;a<i;a++){var o=e[a];if(Be.pack(o.modelMatrix,n,r),r+=Be.packedLength,Object(u.a)(o.attributes)&&Object(u.a)(o.attributes.offset)){var s=o.attributes.offset.value;n[r]=s[0],n[r+1]=s[1],n[r+2]=s[2]}r+=3}return t.push(n.buffer),n}function vF(e){var t=e.length,i=1+(St.packedLength+1)*t,n=new Float32Array(i),r=0;n[r++]=t;for(var a=0;a<t;++a){var o=e[a];Object(u.a)(o)?(n[r++]=1,St.pack(e[a],n,r)):n[r++]=0,r+=St.packedLength}return n}function bF(e){for(var t=new Array(e[0]),i=0,n=1;n<e.length;)1===e[n++]&&(t[i]=St.unpack(e,n)),++i,n+=St.packedLength;return t}mF.combineGeometry=function(e){var t,i,n,r,a=e.instances,o=a.length,s=!1;o>0&&((t=fF(e)).length>0&&(i=id.createAttributeLocations(t[0]),e.createPickOffsets&&(n=function(e,t){var i=[];return pF(e,"geometry",t,i),pF(e,"westHemisphereGeometry",t,i),pF(e,"eastHemisphereGeometry",t,i),i}(a,t))),Object(u.a)(a[0].attributes)&&Object(u.a)(a[0].attributes.offset)&&(r=new Array(o),s=!0));for(var c=new Array(o),l=new Array(o),h=0;h<o;++h){var d=a[h],f=d.geometry;Object(u.a)(f)&&(c[h]=f.boundingSphere,l[h]=f.boundingSphereCV,s&&(r[h]=d.geometry.offsetAttribute));var p=d.eastHemisphereGeometry,m=d.westHemisphereGeometry;Object(u.a)(p)&&Object(u.a)(m)&&(Object(u.a)(p.boundingSphere)&&Object(u.a)(m.boundingSphere)&&(c[h]=St.union(p.boundingSphere,m.boundingSphere)),Object(u.a)(p.boundingSphereCV)&&Object(u.a)(m.boundingSphereCV)&&(l[h]=St.union(p.boundingSphereCV,m.boundingSphereCV)))}return{geometries:t,modelMatrix:e.modelMatrix,attributeLocations:i,pickOffsets:n,offsetInstanceExtend:r,boundingSpheres:c,boundingSpheresCV:l}},mF.packCreateGeometryResults=function(e,t){var i=new Float64Array(function(e){for(var t=1,i=e.length,n=0;n<i;n++){var r=e[n];if(++t,Object(u.a)(r)){var a=r.attributes;for(var o in t+=7+2*St.packedLength+(Object(u.a)(r.indices)?r.indices.length:0),a){if(a.hasOwnProperty(o)&&Object(u.a)(a[o]))t+=5+a[o].values.length}}}return t}(e)),n=[],r={},a=e.length,o=0;i[o++]=a;for(var s=0;s<a;s++){var c=e[s],l=Object(u.a)(c);if(i[o++]=l?1:0,l){i[o++]=c.primitiveType,i[o++]=c.geometryType,i[o++]=Object(w.a)(c.offsetAttribute,-1);var h=Object(u.a)(c.boundingSphere)?1:0;i[o++]=h,h&&St.pack(c.boundingSphere,i,o),o+=St.packedLength;var d=Object(u.a)(c.boundingSphereCV)?1:0;i[o++]=d,d&&St.pack(c.boundingSphereCV,i,o),o+=St.packedLength;var f=c.attributes,p=[];for(var m in f)f.hasOwnProperty(m)&&Object(u.a)(f[m])&&(p.push(m),Object(u.a)(r[m])||(r[m]=n.length,n.push(m)));i[o++]=p.length;for(var _=0;_<p.length;_++){var g=p[_],v=f[g];i[o++]=r[g],i[o++]=v.componentDatatype,i[o++]=v.componentsPerAttribute,i[o++]=v.normalize?1:0,i[o++]=v.values.length,i.set(v.values,o),o+=v.values.length}var b=Object(u.a)(c.indices)?c.indices.length:0;i[o++]=b,b>0&&(i.set(c.indices,o),o+=b)}}return t.push(i.buffer),{stringTable:n,packedData:i}},mF.unpackCreateGeometryResults=function(e){for(var t,i=e.stringTable,n=e.packedData,r=new Array(n[0]),a=0,o=1;o<n.length;){if(1===n[o++]){var s,c,l,u,h,d=n[o++],f=n[o++],p=n[o++];-1===p&&(p=void 0),1===n[o++]&&(s=St.unpack(n,o)),o+=St.packedLength,1===n[o++]&&(c=St.unpack(n,o)),o+=St.packedLength;var m,_=new Fa,g=n[o++];for(t=0;t<g;t++){var v=i[n[o++]],b=n[o++];h=n[o++];var y=0!==n[o++];l=n[o++],u=dn.createTypedArray(b,l);for(var w=0;w<l;w++)u[w]=n[o++];_[v]=new Na({componentDatatype:b,componentsPerAttribute:h,normalize:y,values:u})}if((l=n[o++])>0){var O=u.length/h;for(m=Sl.createTypedArray(O,l),t=0;t<l;t++)m[t]=n[o++]}r[a++]=new La({primitiveType:d,geometryType:f,boundingSphere:s,boundingSphereCV:c,indices:m,attributes:_,offsetAttribute:p})}else r[a++]=void 0}return r},mF.packCombineGeometryParameters=function(e,t){for(var i=e.createGeometryResults,n=i.length,r=0;r<n;r++)t.push(i[r].packedData.buffer);return{createGeometryResults:e.createGeometryResults,packedInstances:gF(e.instances,t),ellipsoid:e.ellipsoid,isGeographic:e.projection instanceof se,elementIndexUintSupported:e.elementIndexUintSupported,scene3DOnly:e.scene3DOnly,vertexCacheOptimize:e.vertexCacheOptimize,compressVertices:e.compressVertices,modelMatrix:e.modelMatrix,createPickOffsets:e.createPickOffsets}},mF.unpackCombineGeometryParameters=function(e){for(var t=function(e){for(var t=e,i=new Array(t[0]),n=0,r=1;r<t.length;){var a,o=Be.unpack(t,r);r+=Be.packedLength,Object(u.a)(t[r])&&(a={offset:new tE(t[r],t[r+1],t[r+2])}),r+=3,i[n++]={modelMatrix:o,attributes:a}}return i}(e.packedInstances),i=e.createGeometryResults,n=i.length,r=0,a=0;a<n;a++)for(var o=mF.unpackCreateGeometryResults(i[a]),s=o.length,c=0;c<s;c++){var l=o[c];t[r].geometry=l,++r}var h=ae.clone(e.ellipsoid);return{instances:t,ellipsoid:h,projection:e.isGeographic?new se(h):new Qc(h),elementIndexUintSupported:e.elementIndexUintSupported,scene3DOnly:e.scene3DOnly,vertexCacheOptimize:e.vertexCacheOptimize,compressVertices:e.compressVertices,modelMatrix:Be.clone(e.modelMatrix),createPickOffsets:e.createPickOffsets}},mF.packCombineGeometryResults=function(e,t){Object(u.a)(e.geometries)&&function(e,t){for(var i=e.length,n=0;n<i;++n)_F(e[n],t)}(e.geometries,t);var i=vF(e.boundingSpheres),n=vF(e.boundingSpheresCV);return t.push(i.buffer,n.buffer),{geometries:e.geometries,attributeLocations:e.attributeLocations,modelMatrix:e.modelMatrix,pickOffsets:e.pickOffsets,offsetInstanceExtend:e.offsetInstanceExtend,boundingSpheres:i,boundingSpheresCV:n}},mF.unpackCombineGeometryResults=function(e){return{geometries:e.geometries,attributeLocations:e.attributeLocations,modelMatrix:e.modelMatrix,pickOffsets:e.pickOffsets,offsetInstanceExtend:e.offsetInstanceExtend,boundingSpheres:bF(e.boundingSpheres),boundingSpheresCV:bF(e.boundingSpheresCV)}};var yF=mF,wF=Object(E.a)({READY:0,CREATING:1,CREATED:2,COMBINING:3,COMBINED:4,COMPLETE:5,FAILED:6}),OF={MORPHING:0,COLUMBUS_VIEW:1,SCENE2D:2,SCENE3D:3,getMorphTime:function(e){return e===OF.SCENE3D?1:e!==OF.MORPHING?0:void 0}},xF=Object(E.a)(OF);function EF(e){if(e=Object(w.a)(e,w.a.EMPTY_OBJECT),this.geometryInstances=e.geometryInstances,this.appearance=e.appearance,this._appearance=void 0,this._material=void 0,this.depthFailAppearance=e.depthFailAppearance,this._depthFailAppearance=void 0,this._depthFailMaterial=void 0,this.modelMatrix=Be.clone(Object(w.a)(e.modelMatrix,Be.IDENTITY)),this._modelMatrix=new Be,this.show=Object(w.a)(e.show,!0),this._vertexCacheOptimize=Object(w.a)(e.vertexCacheOptimize,!1),this._interleave=Object(w.a)(e.interleave,!1),this._releaseGeometryInstances=Object(w.a)(e.releaseGeometryInstances,!0),this._allowPicking=Object(w.a)(e.allowPicking,!0),this._asynchronous=Object(w.a)(e.asynchronous,!0),this._compressVertices=Object(w.a)(e.compressVertices,!0),this.cull=Object(w.a)(e.cull,!0),this.debugShowBoundingVolume=Object(w.a)(e.debugShowBoundingVolume,!1),this.rtcCenter=e.rtcCenter,Object(u.a)(this.rtcCenter)&&(!Object(u.a)(this.geometryInstances)||Object(ym.a)(this.geometryInstances)&&1!==this.geometryInstances))throw new h.a("Relative-to-center rendering only supports one geometry instance.");this.shadows=Object(w.a)(e.shadows,rM.DISABLED),this._translucent=void 0,this._state=wF.READY,this._geometries=[],this._error=void 0,this._numberOfInstances=0,this._boundingSpheres=[],this._boundingSphereWC=[],this._boundingSphereCV=[],this._boundingSphere2D=[],this._boundingSphereMorph=[],this._perInstanceAttributeCache=[],this._instanceIds=[],this._lastPerInstanceAttributeIndex=0,this._va=[],this._attributeLocations=void 0,this._primitiveType=void 0,this._frontFaceRS=void 0,this._backFaceRS=void 0,this._sp=void 0,this._depthFailAppearance=void 0,this._spDepthFail=void 0,this._frontFaceDepthFailRS=void 0,this._backFaceDepthFailRS=void 0,this._pickIds=[],this._colorCommands=[],this._pickCommands=[],this._readOnlyInstanceAttributes=e._readOnlyInstanceAttributes,this._createBoundingVolumeFunction=e._createBoundingVolumeFunction,this._createRenderStatesFunction=e._createRenderStatesFunction,this._createShaderProgramFunction=e._createShaderProgramFunction,this._createCommandsFunction=e._createCommandsFunction,this._updateAndQueueCommandsFunction=e._updateAndQueueCommandsFunction,this._createPickOffsets=e._createPickOffsets,this._pickOffsets=void 0,this._createGeometryResults=void 0,this._ready=!1,this._readyPromise=Oi.a.defer(),this._batchTable=void 0,this._batchTableAttributeIndices=void 0,this._offsetInstanceExtend=void 0,this._batchTableOffsetAttribute2DIndex=void 0,this._batchTableOffsetsUpdated=!1,this._instanceBoundingSpheres=void 0,this._instanceBoundingSpheresCV=void 0,this._tempBoundingSpheres=void 0,this._recomputeBoundingSpheres=!1,this._batchTableBoundingSpheresUpdated=!1,this._batchTableBoundingSphereAttributeIndices=void 0}Object(O.a)(EF.prototype,{vertexCacheOptimize:{get:function(){return this._vertexCacheOptimize}},interleave:{get:function(){return this._interleave}},releaseGeometryInstances:{get:function(){return this._releaseGeometryInstances}},allowPicking:{get:function(){return this._allowPicking}},asynchronous:{get:function(){return this._asynchronous}},compressVertices:{get:function(){return this._compressVertices}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise.promise}}});var TF=new Rt,CF=new z,SF=new Te;function AF(e){var t=e.length;return 1===t?e[0]:2===t?Rt.unpack(e,0,TF):3===t?z.unpack(e,0,CF):4===t?Te.unpack(e,0,SF):void 0}function PF(e,t){var i=e.geometryInstances,n=Object(ym.a)(i)?i:[i],r=n.length;if(0!==r){var a,o,s,c,l=function(e){var t,i=e.length,n=[],r=e[0].attributes;for(t in r)if(r.hasOwnProperty(t)&&Object(u.a)(r[t])){for(var a=r[t],o=!0,s=1;s<i;++s){var c=e[s].attributes[t];if(!Object(u.a)(c)||a.componentDatatype!==c.componentDatatype||a.componentsPerAttribute!==c.componentsPerAttribute||a.normalize!==c.normalize){o=!1;break}}o&&n.push(t)}return n}(n),h=l.length,d=[],f={},p={},m=n[0].attributes;for(o=0;o<h;++o)c=m[s=l[o]],f[s]=o,d.push({functionName:"czm_batchTable_"+s,componentDatatype:c.componentDatatype,componentsPerAttribute:c.componentsPerAttribute,normalize:c.normalize});-1!==l.indexOf("distanceDisplayCondition")&&(d.push({functionName:"czm_batchTable_boundingSphereCenter3DHigh",componentDatatype:dn.FLOAT,componentsPerAttribute:3},{functionName:"czm_batchTable_boundingSphereCenter3DLow",componentDatatype:dn.FLOAT,componentsPerAttribute:3},{functionName:"czm_batchTable_boundingSphereCenter2DHigh",componentDatatype:dn.FLOAT,componentsPerAttribute:3},{functionName:"czm_batchTable_boundingSphereCenter2DLow",componentDatatype:dn.FLOAT,componentsPerAttribute:3},{functionName:"czm_batchTable_boundingSphereRadius",componentDatatype:dn.FLOAT,componentsPerAttribute:1}),p.center3DHigh=d.length-5,p.center3DLow=d.length-4,p.center2DHigh=d.length-3,p.center2DLow=d.length-2,p.radius=d.length-1),-1!==l.indexOf("offset")&&(d.push({functionName:"czm_batchTable_offset2D",componentDatatype:dn.FLOAT,componentsPerAttribute:3}),a=d.length-1),d.push({functionName:"czm_batchTable_pickColor",componentDatatype:dn.UNSIGNED_BYTE,componentsPerAttribute:4,normalize:!0});var _=d.length,g=new hF(t,d,r);for(o=0;o<r;++o){var v=n[o];m=v.attributes;for(var b=0;b<h;++b){var y=AF((c=m[s=l[b]]).value),O=f[s];g.setBatchedAttribute(o,O,y)}var x={primitive:Object(w.a)(v.pickPrimitive,e)};Object(u.a)(v.id)&&(x.id=v.id);var E=t.createPickId(x);e._pickIds.push(E);var T=E.color,C=SF;C.x=uf.floatToByte(T.red),C.y=uf.floatToByte(T.green),C.z=uf.floatToByte(T.blue),C.w=uf.floatToByte(T.alpha),g.setBatchedAttribute(o,_-1,C)}e._batchTable=g,e._batchTableAttributeIndices=f,e._batchTableBoundingSphereAttributeIndices=p,e._batchTableOffsetAttribute2DIndex=a}}function IF(e){var t,i,n,r=e.attributes,a=new Fa;for(var o in r)r.hasOwnProperty(o)&&Object(u.a)(r[o])&&(a[o]=(t=r[o],i=void 0,i=Object(ym.a)(t.values)?t.values.slice(0):new t.values.constructor(t.values),new Na({componentDatatype:t.componentDatatype,componentsPerAttribute:t.componentsPerAttribute,normalize:t.normalize,values:i})));if(Object(u.a)(e.indices)){var s=e.indices;n=Object(ym.a)(s)?s.slice(0):new s.constructor(s)}return new La({attributes:a,indices:n,primitiveType:e.primitiveType,boundingSphere:St.clone(e.boundingSphere)})}function DF(e,t){return{geometry:t,attributes:e.attributes,modelMatrix:Be.clone(e.modelMatrix),pickPrimitive:e.pickPrimitive,id:e.id}}var jF=/attribute\s+vec(?:3|4)\s+(.*)3DHigh;/g;function MF(e){return UN.replaceMain(e,"czm_non_pick_main")+"\nvarying vec4 v_pickColor; \nvoid main() \n{ \n    czm_non_pick_main(); \n    v_pickColor = czm_batchTable_pickColor(batchId); \n}"}function RF(e){return"varying vec4 v_pickColor;\n"+e}function LF(e,t){if(!e.compressVertices)return t;var i=-1!==t.search(/attribute\s+vec3\s+normal;/g),n=-1!==t.search(/attribute\s+vec2\s+st;/g);if(!i&&!n)return t;var r=-1!==t.search(/attribute\s+vec3\s+tangent;/g),a=-1!==t.search(/attribute\s+vec3\s+bitangent;/g),o=n&&i?2:1,s="compressedAttributes",c="attribute "+((o+=r||a?1:0)>1?"vec"+o:"float")+" "+s+";",l="",u="";n&&(l+="vec2 st;\n",u+="    st = czm_decompressTextureCoordinates("+(o>1?s+".x":s)+");\n");i&&r&&a?(l+="vec3 normal;\nvec3 tangent;\nvec3 bitangent;\n",u+="    czm_octDecode("+s+"."+(n?"yz":"xy")+", normal, tangent, bitangent);\n"):(i&&(l+="vec3 normal;\n",u+="    normal = czm_octDecode("+s+(o>1?"."+(n?"y":"x"):"")+");\n"),r&&(l+="vec3 tangent;\n",u+="    tangent = czm_octDecode("+s+"."+(n&&i?"z":"y")+");\n"),a&&(l+="vec3 bitangent;\n",u+="    bitangent = czm_octDecode("+s+"."+(n&&i?"z":"y")+");\n"));var h=t;return h=(h=(h=(h=h.replace(/attribute\s+vec3\s+normal;/g,"")).replace(/attribute\s+vec2\s+st;/g,"")).replace(/attribute\s+vec3\s+tangent;/g,"")).replace(/attribute\s+vec3\s+bitangent;/g,""),[c,l,h=UN.replaceMain(h,"czm_non_compressed_main"),"void main() \n{ \n"+u+"    czm_non_compressed_main(); \n}"].join("\n")}function NF(e,t){var i=e.vertexAttributes;for(var n in i)if(i.hasOwnProperty(n)&&!Object(u.a)(t[n]))throw new h.a("Appearance/Geometry mismatch.  The appearance requires vertex shader attribute input '"+n+"', which was not computed as part of the Geometry.  Use the appearance's vertexFormat property when constructing the geometry.")}function FF(e,t){return function(){return e[t]}}EF._modifyShaderPosition=function(e,t,i){for(var n,r="",a="",o="";null!==(n=jF.exec(t));){var s=n[1],c="vec4 czm_compute"+s[0].toUpperCase()+s.substr(1)+"()";"vec4 czm_computePosition()"!==c&&(r+=c+";\n"),Object(u.a)(e.rtcCenter)?(r+="uniform mat4 u_modifiedModelView;\n",a+="attribute vec4 position;\n",o+=c+"\n{\n    return u_modifiedModelView * position;\n}\n\n",t=(t=(t=(t=t.replace(/attribute\s+vec(?:3|4)\s+position3DHigh;/g,"")).replace(/attribute\s+vec(?:3|4)\s+position3DLow;/g,"")).replace(/czm_modelViewRelativeToEye\s+\*\s+/g,"")).replace(/czm_modelViewProjectionRelativeToEye/g,"czm_projection")):i?o+=c+"\n{\n    return czm_translateRelativeToEye("+s+"3DHigh, "+s+"3DLow);\n}\n\n":(a+="attribute vec3 "+s+"2DHigh;\nattribute vec3 "+s+"2DLow;\n",o+=c+"\n{\n    vec4 p;\n    if (czm_morphTime == 1.0)\n    {\n        p = czm_translateRelativeToEye("+s+"3DHigh, "+s+"3DLow);\n    }\n    else if (czm_morphTime == 0.0)\n    {\n        p = czm_translateRelativeToEye("+s+"2DHigh.zxy, "+s+"2DLow.zxy);\n    }\n    else\n    {\n        p = czm_columbusViewMorph(\n                czm_translateRelativeToEye("+s+"2DHigh.zxy, "+s+"2DLow.zxy),\n                czm_translateRelativeToEye("+s+"3DHigh, "+s+"3DLow),\n                czm_morphTime);\n    }\n    return p;\n}\n\n")}return[r,a,t,o].join("\n")},EF._appendShowToShader=function(e,t){if(!Object(u.a)(e._batchTableAttributeIndices.show))return t;return UN.replaceMain(t,"czm_non_show_main")+"\nvoid main() \n{ \n    czm_non_show_main(); \n    gl_Position *= czm_batchTable_show(batchId); \n}"},EF._updateColorAttribute=function(e,t,i){if(!Object(u.a)(e._batchTableAttributeIndices.color)&&!Object(u.a)(e._batchTableAttributeIndices.depthFailColor))return t;if(-1===t.search(/attribute\s+vec4\s+color;/g))return t;if(i&&!Object(u.a)(e._batchTableAttributeIndices.depthFailColor))throw new h.a("A depthFailColor per-instance attribute is required when using a depth fail appearance that uses a color attribute.");var n=t;return n=n.replace(/attribute\s+vec4\s+color;/g,""),n=i?n.replace(/(\b)color(\b)/g,"$1czm_batchTable_depthFailColor(batchId)$2"):n.replace(/(\b)color(\b)/g,"$1czm_batchTable_color(batchId)$2")},EF._updatePickColorAttribute=function(e){var t=e.replace(/attribute\s+vec4\s+pickColor;/g,"");return t=t.replace(/(\b)pickColor(\b)/g,"$1czm_batchTable_pickColor(batchId)$2")},EF._appendOffsetToShader=function(e,t){if(!Object(u.a)(e._batchTableAttributeIndices.offset))return t;var i=t.replace(/attribute\s+float\s+batchId;/g,"attribute float batchId;\nattribute float applyOffset;");return"    if (czm_sceneMode == czm_sceneMode3D)\n","    {\n","        $1 = $1 + vec4(czm_batchTable_offset(batchId) * applyOffset, 0.0);","    }\n","    else\n","    {\n","        $1 = $1 + vec4(czm_batchTable_offset2D(batchId) * applyOffset, 0.0);","    }\n",i=i.replace(/vec4\s+([A-Za-z0-9_]+)\s+=\s+czm_computePosition\(\);/g,"vec4 $1 = czm_computePosition();\n    if (czm_sceneMode == czm_sceneMode3D)\n    {\n        $1 = $1 + vec4(czm_batchTable_offset(batchId) * applyOffset, 0.0);    }\n    else\n    {\n        $1 = $1 + vec4(czm_batchTable_offset2D(batchId) * applyOffset, 0.0);    }\n")},EF._appendDistanceDisplayConditionToShader=function(e,t,i){if(!Object(u.a)(e._batchTableAttributeIndices.distanceDisplayCondition))return t;var n="void main() \n{ \n    czm_non_distanceDisplayCondition_main(); \n    vec2 distanceDisplayCondition = czm_batchTable_distanceDisplayCondition(batchId);\n    vec3 boundingSphereCenter3DHigh = czm_batchTable_boundingSphereCenter3DHigh(batchId);\n    vec3 boundingSphereCenter3DLow = czm_batchTable_boundingSphereCenter3DLow(batchId);\n    float boundingSphereRadius = czm_batchTable_boundingSphereRadius(batchId);\n";return n+=i?"    vec4 centerRTE = czm_translateRelativeToEye(boundingSphereCenter3DHigh, boundingSphereCenter3DLow);\n":"    vec3 boundingSphereCenter2DHigh = czm_batchTable_boundingSphereCenter2DHigh(batchId);\n    vec3 boundingSphereCenter2DLow = czm_batchTable_boundingSphereCenter2DLow(batchId);\n    vec4 centerRTE;\n    if (czm_morphTime == 1.0)\n    {\n        centerRTE = czm_translateRelativeToEye(boundingSphereCenter3DHigh, boundingSphereCenter3DLow);\n    }\n    else if (czm_morphTime == 0.0)\n    {\n        centerRTE = czm_translateRelativeToEye(boundingSphereCenter2DHigh.zxy, boundingSphereCenter2DLow.zxy);\n    }\n    else\n    {\n        centerRTE = czm_columbusViewMorph(\n                czm_translateRelativeToEye(boundingSphereCenter2DHigh.zxy, boundingSphereCenter2DLow.zxy),\n                czm_translateRelativeToEye(boundingSphereCenter3DHigh, boundingSphereCenter3DLow),\n                czm_morphTime);\n    }\n",UN.replaceMain(t,"czm_non_distanceDisplayCondition_main")+"\n"+(n+="    float radiusSq = boundingSphereRadius * boundingSphereRadius; \n    float distanceSq; \n    if (czm_sceneMode == czm_sceneMode2D) \n    { \n        distanceSq = czm_eyeHeight2D.y - radiusSq; \n    } \n    else \n    { \n        distanceSq = dot(centerRTE.xyz, centerRTE.xyz) - radiusSq; \n    } \n    distanceSq = max(distanceSq, 0.0); \n    float nearSq = distanceDisplayCondition.x * distanceDisplayCondition.x; \n    float farSq = distanceDisplayCondition.y * distanceDisplayCondition.y; \n    float show = (distanceSq >= nearSq && distanceSq <= farSq) ? 1.0 : 0.0; \n    gl_Position *= show; \n}")};var kF,BF=Math.max(Ri.hardwareConcurrency-1,1),zF=new pl("combineGeometry",Number.POSITIVE_INFINITY);var UF=new Fu,VF=new K,HF=new z,GF=new St;var qF=new z,WF=new z;function YF(e,t){if(Object(u.a)(e._batchTableAttributeIndices.offset)&&!e._batchTableOffsetsUpdated&&!t.scene3DOnly){for(var i=e._batchTableOffsetAttribute2DIndex,n=t.mapProjection,r=n.ellipsoid,a=e._batchTable,o=e._instanceBoundingSpheres,s=o.length,c=0;c<s;++c){var l=o[c];if(Object(u.a)(l)){var h=a.getBatchedAttribute(c,e._batchTableAttributeIndices.offset);if(z.equals(h,z.ZERO))a.setBatchedAttribute(c,i,z.ZERO);else{var d=e.modelMatrix;Object(u.a)(d)&&(l=St.transform(l,d,GF));var f=l.center;f=r.scaleToGeodeticSurface(f,WF);var p=r.cartesianToCartographic(f,VF),m=n.project(p,HF),_=z.add(h,f,qF);p=r.cartesianToCartographic(_,p);var g=n.project(p,qF),v=z.subtract(g,m,qF),b=v.x;v.x=v.z,v.z=v.y,v.y=b,a.setBatchedAttribute(c,i,v)}}}e._batchTableOffsetsUpdated=!0}}function XF(e,t,i,n){var r,a=i.getRenderState();n?((r=Object(nf.a)(a,!1)).cull={enabled:!0,face:BD.BACK},e._frontFaceRS=RM.fromCache(r),r.cull.face=BD.FRONT,e._backFaceRS=RM.fromCache(r)):(e._frontFaceRS=RM.fromCache(a),e._backFaceRS=e._frontFaceRS),r=Object(nf.a)(a,!1),Object(u.a)(e._depthFailAppearance)&&(r.depthTest.enabled=!1),Object(u.a)(e._depthFailAppearance)&&(a=e._depthFailAppearance.getRenderState(),(r=Object(nf.a)(a,!1)).depthTest.func=qN.GREATER,n?(r.cull={enabled:!0,face:BD.BACK},e._frontFaceDepthFailRS=RM.fromCache(r),r.cull.face=BD.FRONT,e._backFaceDepthFailRS=RM.fromCache(r)):(e._frontFaceDepthFailRS=RM.fromCache(r),e._backFaceDepthFailRS=e._frontFaceRS))}function ZF(e,t,i){var n=t.context,r=e._attributeLocations,a=e._batchTable.getVertexShaderCallback()(i.vertexShaderSource);a=EF._appendOffsetToShader(e,a),a=EF._appendShowToShader(e,a),a=MF(a=EF._appendDistanceDisplayConditionToShader(e,a,t.scene3DOnly)),a=LF(e,a=EF._updateColorAttribute(e,a,!1)),a=EF._modifyShaderPosition(e,a,t.scene3DOnly);var o,s,c,l,h=i.getFragmentShaderSource();h=RF(h),e._sp=bR.replaceCache({context:n,shaderProgram:e._sp,vertexShaderSource:a,fragmentShaderSource:h,attributeLocations:r}),NF(e._sp,r),Object(u.a)(e._depthFailAppearance)&&(a=e._batchTable.getVertexShaderCallback()(e._depthFailAppearance.vertexShaderSource),a=EF._appendShowToShader(e,a),a=MF(a=EF._appendDistanceDisplayConditionToShader(e,a,t.scene3DOnly)),a=LF(e,a=EF._updateColorAttribute(e,a,!0)),a=EF._modifyShaderPosition(e,a,t.scene3DOnly),c=a,l=UN.replaceMain(c,"czm_non_depth_clamp_main"),a=l+="varying float v_WindowZ;\nvoid main() {\n    czm_non_depth_clamp_main();\n    vec4 position = gl_Position;\n    v_WindowZ = (0.5 * (position.z / position.w) + 0.5) * position.w;\n    position.z = min(position.z, position.w);\n    gl_Position = position;\n}\n",h=RF(h=e._depthFailAppearance.getFragmentShaderSource()),o=h,s=UN.replaceMain(o,"czm_non_depth_clamp_main"),h=s="#ifdef GL_EXT_frag_depth\n#extension GL_EXT_frag_depth : enable\n#endif\n"+(s+="varying float v_WindowZ;\nvoid main() {\n    czm_non_depth_clamp_main();\n#if defined(GL_EXT_frag_depth) && !defined(LOG_DEPTH)\n    gl_FragDepthEXT = min(v_WindowZ * gl_FragCoord.w, 1.0);\n#endif\n}\n"),e._spDepthFail=bR.replaceCache({context:n,shaderProgram:e._spDepthFail,vertexShaderSource:a,fragmentShaderSource:h,attributeLocations:r}),NF(e._spDepthFail,r))}var QF=new Be,KF=new z;function JF(e,t,i,n){var r=Object(u.a)(i)?i._uniforms:void 0,a={},o=t.uniforms;if(Object(u.a)(o))for(var s in o)if(o.hasOwnProperty(s)){if(Object(u.a)(r)&&Object(u.a)(r[s]))throw new h.a("Appearance and material have a uniform with the same name: "+s);a[s]=FF(o,s)}var c=Object(ff.a)(a,r);return c=e._batchTable.getUniformMapCallback()(c),Object(u.a)(e.rtcCenter)&&(c.u_modifiedModelView=function(){var t=n.context.uniformState.view;return Be.multiply(t,e._modelMatrix,QF),Be.multiplyByPoint(QF,e.rtcCenter,KF),Be.setTranslation(QF,KF,QF),QF}),c}function $F(e,t,i,n,r,a,o,s){var c,l=JF(e,t,i,s);Object(u.a)(e._depthFailAppearance)&&(c=JF(e,e._depthFailAppearance,e._depthFailAppearance.material,s));var h=n?lM.TRANSLUCENT:lM.OPAQUE,d=r?2:1;d*=Object(u.a)(e._depthFailAppearance)?2:1,a.length=e._va.length*d;for(var f=a.length,p=0,m=0;m<f;++m){var _;r&&(_=a[m],Object(u.a)(_)||(_=a[m]=new cM({owner:e,primitiveType:e._primitiveType})),_.vertexArray=e._va[p],_.renderState=e._backFaceRS,_.shaderProgram=e._sp,_.uniformMap=l,_.pass=h,++m),_=a[m],Object(u.a)(_)||(_=a[m]=new cM({owner:e,primitiveType:e._primitiveType})),_.vertexArray=e._va[p],_.renderState=e._frontFaceRS,_.shaderProgram=e._sp,_.uniformMap=l,_.pass=h,Object(u.a)(e._depthFailAppearance)&&(r&&(_=a[++m],Object(u.a)(_)||(_=a[m]=new cM({owner:e,primitiveType:e._primitiveType})),_.vertexArray=e._va[p],_.renderState=e._backFaceDepthFailRS,_.shaderProgram=e._spDepthFail,_.uniformMap=c,_.pass=h),_=a[++m],Object(u.a)(_)||(_=a[m]=new cM({owner:e,primitiveType:e._primitiveType})),_.vertexArray=e._va[p],_.renderState=e._frontFaceDepthFailRS,_.shaderProgram=e._spDepthFail,_.uniformMap=c,_.pass=h),++p}}function ek(e,t,i,n,r,a,o,s){if(t.mode!==xF.SCENE3D&&!Be.equals(r,Be.IDENTITY))throw new h.a("Primitive.modelMatrix is only supported in 3D mode.");var c;EF._updateBoundingVolumes(e,t,r),t.mode===xF.SCENE3D?c=e._boundingSphereWC:t.mode===xF.COLUMBUS_VIEW?c=e._boundingSphereCV:t.mode===xF.SCENE2D&&Object(u.a)(e._boundingSphere2D)?c=e._boundingSphere2D:Object(u.a)(e._boundingSphereMorph)&&(c=e._boundingSphereMorph);var l=t.commandList,d=t.passes;if(d.render||d.pick){var f=e.allowPicking,p=rM.castShadows(e.shadows),m=rM.receiveShadows(e.shadows),_=i.length,g=s?2:1;g*=Object(u.a)(e._depthFailAppearance)?2:1;for(var v=0;v<_;++v){var b=Math.floor(v/g),y=i[v];y.modelMatrix=r,y.boundingVolume=c[b],y.cull=a,y.debugShowBoundingVolume=o,y.castShadows=p,y.receiveShadows=m,y.pickId=f?"v_pickColor":void 0,l.push(y)}}}EF._updateBoundingVolumes=function(e,t,i,n){var r,a,o;if(n||!Be.equals(i,e._modelMatrix))for(Be.clone(i,e._modelMatrix),a=e._boundingSpheres.length,r=0;r<a;++r)o=e._boundingSpheres[r],Object(u.a)(o)&&(e._boundingSphereWC[r]=St.transform(o,i,e._boundingSphereWC[r]),t.scene3DOnly||(e._boundingSphere2D[r]=St.clone(e._boundingSphereCV[r],e._boundingSphere2D[r]),e._boundingSphere2D[r].center.x=0,e._boundingSphereMorph[r]=St.union(e._boundingSphereWC[r],e._boundingSphereCV[r])));var s=e.appearance.pixelSize;if(Object(u.a)(s))for(a=e._boundingSpheres.length,r=0;r<a;++r){o=e._boundingSpheres[r];var c=e._boundingSphereWC[r],l=t.camera.getPixelSize(o,t.context.drawingBufferWidth,t.context.drawingBufferHeight)*s;c.radius=o.radius+l}},EF.prototype.update=function(e){if(!(!Object(u.a)(this.geometryInstances)&&0===this._va.length||Object(u.a)(this.geometryInstances)&&Object(ym.a)(this.geometryInstances)&&0===this.geometryInstances.length||!Object(u.a)(this.appearance)||e.mode!==xF.SCENE3D&&e.scene3DOnly||!e.passes.render&&!e.passes.pick)){if(Object(u.a)(this._error))throw this._error;if(Object(u.a)(this.rtcCenter)&&!e.scene3DOnly)throw new h.a("RTC rendering is only available for 3D only scenes.");if(this._state!==wF.FAILED){var t=e.context;if(Object(u.a)(this._batchTable)||PF(this,t),this._batchTable.attributes.length>0){if(0===HD.maximumVertexTextureImageUnits)throw new Ce.a("Vertex texture fetch support is required to render primitives with per-instance attributes. The maximum number of vertex texture image units must be greater than zero.");this._batchTable.update(e)}if(this._state!==wF.COMPLETE&&this._state!==wF.COMBINED&&(this.asynchronous?function(e,t){var i,n,r,a,o=e._instanceIds;if(e._state===wF.READY){i=Object(ym.a)(e.geometryInstances)?e.geometryInstances:[e.geometryInstances];var s,c=e._numberOfInstances=i.length,l=[],d=[];for(r=0;r<c;++r){if(n=i[r].geometry,o.push(i[r].id),!Object(u.a)(n._workerName))throw new h.a("_workerName must be defined for asynchronous geometry.");d.push({moduleName:n._workerName,geometry:n})}if(!Object(u.a)(kF))for(kF=new Array(BF),r=0;r<BF;r++)kF[r]=new pl("createGeometry",Number.POSITIVE_INFINITY);for(d=BP(d,BF),r=0;r<d.length;r++){var f,p=0,m=d[r],_=m.length;for(a=0;a<_;++a)n=(s=m[a]).geometry,Object(u.a)(n.constructor.pack)&&(s.offset=p,p+=Object(w.a)(n.constructor.packedLength,n.packedLength));if(p>0){var g=new Float64Array(p);for(f=[g.buffer],a=0;a<_;++a)n=(s=m[a]).geometry,Object(u.a)(n.constructor.pack)&&(n.constructor.pack(n,g,s.offset),s.geometry=g)}l.push(kF[r].scheduleTask({subTasks:d[r]},f))}e._state=wF.CREATING,Oi.a.all(l,(function(t){e._createGeometryResults=t,e._state=wF.CREATED})).otherwise((function(i){sk(e,t,wF.FAILED,i)}))}else if(e._state===wF.CREATED){var v=[];i=Object(ym.a)(e.geometryInstances)?e.geometryInstances:[e.geometryInstances];var b=t.scene3DOnly,y=t.mapProjection,O=zF.scheduleTask(yF.packCombineGeometryParameters({createGeometryResults:e._createGeometryResults,instances:i,ellipsoid:y.ellipsoid,projection:y,elementIndexUintSupported:t.context.elementIndexUint,scene3DOnly:b,vertexCacheOptimize:e.vertexCacheOptimize,compressVertices:e.compressVertices,modelMatrix:e.modelMatrix,createPickOffsets:e._createPickOffsets},v),v);e._createGeometryResults=void 0,e._state=wF.COMBINING,Object(Oi.a)(O,(function(i){var n=yF.unpackCombineGeometryResults(i);e._geometries=n.geometries,e._attributeLocations=n.attributeLocations,e.modelMatrix=Be.clone(n.modelMatrix,e.modelMatrix),e._pickOffsets=n.pickOffsets,e._offsetInstanceExtend=n.offsetInstanceExtend,e._instanceBoundingSpheres=n.boundingSpheres,e._instanceBoundingSpheresCV=n.boundingSpheresCV,Object(u.a)(e._geometries)&&e._geometries.length>0?(e._recomputeBoundingSpheres=!0,e._state=wF.COMBINED):sk(e,t,wF.FAILED,void 0)})).otherwise((function(i){sk(e,t,wF.FAILED,i)}))}}(this,e):function(e,t){var i,n,r=Object(ym.a)(e.geometryInstances)?e.geometryInstances:[e.geometryInstances],a=e._numberOfInstances=r.length,o=new Array(a),s=e._instanceIds,c=0;for(n=0;n<a;n++){var l,h=(i=r[n]).geometry;l=Object(u.a)(h.attributes)&&Object(u.a)(h.primitiveType)?IF(h):h.constructor.createGeometry(h),o[c++]=DF(i,l),s.push(i.id)}o.length=c;var d=t.scene3DOnly,f=t.mapProjection,p=yF.combineGeometry({instances:o,ellipsoid:f.ellipsoid,projection:f,elementIndexUintSupported:t.context.elementIndexUint,scene3DOnly:d,vertexCacheOptimize:e.vertexCacheOptimize,compressVertices:e.compressVertices,modelMatrix:e.modelMatrix,createPickOffsets:e._createPickOffsets});e._geometries=p.geometries,e._attributeLocations=p.attributeLocations,e.modelMatrix=Be.clone(p.modelMatrix,e.modelMatrix),e._pickOffsets=p.pickOffsets,e._offsetInstanceExtend=p.offsetInstanceExtend,e._instanceBoundingSpheres=p.boundingSpheres,e._instanceBoundingSpheresCV=p.boundingSpheresCV,Object(u.a)(e._geometries)&&e._geometries.length>0?(e._recomputeBoundingSpheres=!0,e._state=wF.COMBINED):sk(e,t,wF.FAILED,void 0)}(this,e)),this._state===wF.COMBINED&&(function(e,t){if(Object(u.a)(e._batchTableAttributeIndices.distanceDisplayCondition)&&!e._batchTableBoundingSpheresUpdated){for(var i=e._batchTableBoundingSphereAttributeIndices,n=i.center3DHigh,r=i.center3DLow,a=i.center2DHigh,o=i.center2DLow,s=i.radius,c=t.mapProjection,l=c.ellipsoid,h=e._batchTable,d=e._instanceBoundingSpheres,f=d.length,p=0;p<f;++p){var m=d[p];if(Object(u.a)(m)){var _=e.modelMatrix;Object(u.a)(_)&&(m=St.transform(m,_,GF));var g=m.center,v=m.radius,b=Fu.fromCartesian(g,UF);if(h.setBatchedAttribute(p,n,b.high),h.setBatchedAttribute(p,r,b.low),!t.scene3DOnly){var y=l.cartesianToCartographic(g,VF),w=c.project(y,HF);b=Fu.fromCartesian(w,UF),h.setBatchedAttribute(p,a,b.high),h.setBatchedAttribute(p,o,b.low)}h.setBatchedAttribute(p,s,v)}}e._batchTableBoundingSpheresUpdated=!0}}(this,e),YF(this,e),function(e,t){for(var i=e._attributeLocations,n=e._geometries,r=t.scene3DOnly,a=t.context,o=[],s=n.length,c=0;c<s;++c){var l=n[c];if(o.push(tF.fromGeometry({context:a,geometry:l,attributeLocations:i,bufferUsage:YN.STATIC_DRAW,interleave:e._interleave})),Object(u.a)(e._createBoundingVolumeFunction))e._createBoundingVolumeFunction(t,l);else if(e._boundingSpheres.push(St.clone(l.boundingSphere)),e._boundingSphereWC.push(new St),!r){var h=l.boundingSphereCV.center,d=h.x,f=h.y,p=h.z;h.x=p,h.y=d,h.z=f,e._boundingSphereCV.push(St.clone(l.boundingSphereCV)),e._boundingSphere2D.push(new St),e._boundingSphereMorph.push(new St)}}e._va=o,e._primitiveType=n[0].primitiveType,e.releaseGeometryInstances&&(e.geometryInstances=void 0),e._geometries=void 0,sk(e,t,wF.COMPLETE,void 0)}(this,e)),this.show&&this._state===wF.COMPLETE){this._batchTableOffsetsUpdated||YF(this,e),this._recomputeBoundingSpheres&&function(e,t){var i=e._batchTableAttributeIndices.offset;if(e._recomputeBoundingSpheres&&Object(u.a)(i)){var n,r=e._offsetInstanceExtend,a=e._instanceBoundingSpheres,o=a.length,s=e._tempBoundingSpheres;if(!Object(u.a)(s)){for(s=new Array(o),n=0;n<o;n++)s[n]=new St;e._tempBoundingSpheres=s}for(n=0;n<o;++n){var c=s[n],l=e._batchTable.getBatchedAttribute(n,i,new z);nk(c=a[n].clone(c),l,r[n])}var h=[],d=[],f=[];for(n=0;n<o;++n){var p=s[n];p.center.x-p.radius>0||St.intersectPlane(p,oc.ORIGIN_ZX_PLANE)!==ce.INTERSECTING?h.push(p):(d.push(p),f.push(p))}var m=h[0],_=f[0],g=d[0];for(n=1;n<h.length;n++)m=St.union(m,h[n]);for(n=1;n<f.length;n++)_=St.union(_,f[n]);for(n=1;n<d.length;n++)g=St.union(g,d[n]);var v=[];for(Object(u.a)(m)&&v.push(m),Object(u.a)(_)&&v.push(_),Object(u.a)(g)&&v.push(g),n=0;n<v.length;n++){var b=v[n].clone(e._boundingSpheres[n]);e._boundingSpheres[n]=b,e._boundingSphereCV[n]=St.projectTo2D(b,t.mapProjection,e._boundingSphereCV[n])}EF._updateBoundingVolumes(e,t,e.modelMatrix,!0),e._recomputeBoundingSpheres=!1}else e._recomputeBoundingSpheres=!1}(this,e);var i=this.appearance,n=i.material,r=!1,a=!1;this._appearance!==i?(this._appearance=i,this._material=n,r=!0,a=!0):this._material!==n&&(this._material=n,a=!0);var o=this.depthFailAppearance,s=Object(u.a)(o)?o.material:void 0;this._depthFailAppearance!==o?(this._depthFailAppearance=o,this._depthFailMaterial=s,r=!0,a=!0):this._depthFailMaterial!==s&&(this._depthFailMaterial=s,a=!0);var c=this._appearance.isTranslucent();this._translucent!==c&&(this._translucent=c,r=!0),Object(u.a)(this._material)&&this._material.update(t);var l=i.closed&&c;if(r)Object(w.a)(this._createRenderStatesFunction,XF)(this,t,i,l);if(a)Object(w.a)(this._createShaderProgramFunction,ZF)(this,e,i);if(r||a)Object(w.a)(this._createCommandsFunction,$F)(this,i,n,c,l,this._colorCommands,this._pickCommands,e);Object(w.a)(this._updateAndQueueCommandsFunction,ek)(this,e,this._colorCommands,this._pickCommands,this.modelMatrix,this.cull,this.debugShowBoundingVolume,l)}}}};var tk=new St,ik=new St;function nk(e,t,i){if(i===fn.TOP){var n=St.clone(e,tk),r=St.clone(e,ik);r.center=z.add(r.center,t,r.center),e=St.union(n,r,e)}else i===fn.ALL&&(e.center=z.add(e.center,t,e.center));return e}function rk(e,t,i){return function(){var n=e.getBatchedAttribute(t,i),r=e.attributes[i],a=r.componentsPerAttribute,o=dn.createTypedArray(r.componentDatatype,a);return Object(u.a)(n.constructor.pack)?n.constructor.pack(n,o,0):o[0]=n,o}}function ak(e,t,i,n,r){return function(a){if(!Object(u.a)(a)||!Object(u.a)(a.length)||a.length<1||a.length>4)throw new h.a("value must be and array with length between 1 and 4.");var o=AF(a);e.setBatchedAttribute(t,i,o),"offset"===r&&(n._recomputeBoundingSpheres=!0,n._batchTableOffsetsUpdated=!1)}}var ok=new z;function sk(e,t,i,n){e._error=n,e._state=i,t.afterRender.push((function(){e._ready=e._state===wF.COMPLETE||e._state===wF.FAILED,Object(u.a)(n)?e._readyPromise.reject(n):e._readyPromise.resolve(e)}))}EF.prototype.getGeometryInstanceAttributes=function(e){if(!Object(u.a)(e))throw new h.a("id is required");if(!Object(u.a)(this._batchTable))throw new h.a("must call update before calling getGeometryInstanceAttributes");for(var t=-1,i=this._lastPerInstanceAttributeIndex,n=this._instanceIds,r=n.length,a=0;a<r;++a){var o=(i+a)%r;if(e===n[o]){t=o;break}}if(-1!==t){var s=this._perInstanceAttributeCache[t];if(Object(u.a)(s))return s;var c=this._batchTable,l=this._batchTableAttributeIndices;s={};var d={};for(var f in l)if(l.hasOwnProperty(f)){var p=l[f];d[f]={get:rk(c,t,p)};var m=!0,_=this._readOnlyInstanceAttributes;if(m&&Object(u.a)(_)){r=_.length;for(var g=0;g<r;++g)if(f===_[g]){m=!1;break}}m&&(d[f].set=ak(c,t,p,this,f))}return function(e,t,i){t.boundingSphere={get:function(){var n=e._instanceBoundingSpheres[i];if(Object(u.a)(n)){n=n.clone();var r=e.modelMatrix,a=t.offset;Object(u.a)(a)&&nk(n,z.fromArray(a.get(),0,ok),e._offsetInstanceExtend[i]),Object(u.a)(r)&&(n=St.transform(n,r))}return n}},t.boundingSphereCV={get:function(){return e._instanceBoundingSpheresCV[i]}}}(this,d,t),function(e,t,i){t.pickId={get:function(){return e._pickIds[i]}}}(this,d,t),Object(O.a)(s,d),this._lastPerInstanceAttributeIndex=t,this._perInstanceAttributeCache[t]=s,s}},EF.prototype.isDestroyed=function(){return!1},EF.prototype.destroy=function(){var e,t;this._sp=this._sp&&this._sp.destroy(),this._pickSP=this._pickSP&&this._pickSP.destroy();var i=this._va;for(e=i.length,t=0;t<e;++t)i[t].destroy();this._va=void 0;var n=this._pickIds;for(e=n.length,t=0;t<e;++t)n[t].destroy();return this._pickIds=void 0,this._batchTable=this._batchTable&&this._batchTable.destroy(),this._instanceIds=void 0,this._perInstanceAttributeCache=void 0,this._attributeLocations=void 0,rl(this)};var ck=EF,lk="#ifdef GL_EXT_frag_depth\n#extension GL_EXT_frag_depth : enable\n#endif\n#ifdef TEXTURE_COORDINATES\n#ifdef SPHERICAL\nvarying vec4 v_sphericalExtents;\n#else // SPHERICAL\nvarying vec2 v_inversePlaneExtents;\nvarying vec4 v_westPlane;\nvarying vec4 v_southPlane;\n#endif // SPHERICAL\nvarying vec3 v_uvMinAndSphericalLongitudeRotation;\nvarying vec3 v_uMaxAndInverseDistance;\nvarying vec3 v_vMaxAndInverseDistance;\n#endif // TEXTURE_COORDINATES\n#ifdef PER_INSTANCE_COLOR\nvarying vec4 v_color;\n#endif\n#ifdef NORMAL_EC\nvec3 getEyeCoordinate3FromWindowCoordinate(vec2 fragCoord, float logDepthOrDepth) {\nvec4 eyeCoordinate = czm_windowToEyeCoordinates(fragCoord, logDepthOrDepth);\nreturn eyeCoordinate.xyz / eyeCoordinate.w;\n}\nvec3 vectorFromOffset(vec4 eyeCoordinate, vec2 positiveOffset) {\nvec2 glFragCoordXY = gl_FragCoord.xy;\nfloat upOrRightLogDepth = czm_unpackDepth(texture2D(czm_globeDepthTexture, (glFragCoordXY + positiveOffset) / czm_viewport.zw));\nfloat downOrLeftLogDepth = czm_unpackDepth(texture2D(czm_globeDepthTexture, (glFragCoordXY - positiveOffset) / czm_viewport.zw));\nbvec2 upOrRightInBounds = lessThan(glFragCoordXY + positiveOffset, czm_viewport.zw);\nfloat useUpOrRight = float(upOrRightLogDepth > 0.0 && upOrRightInBounds.x && upOrRightInBounds.y);\nfloat useDownOrLeft = float(useUpOrRight == 0.0);\nvec3 upOrRightEC = getEyeCoordinate3FromWindowCoordinate(glFragCoordXY + positiveOffset, upOrRightLogDepth);\nvec3 downOrLeftEC = getEyeCoordinate3FromWindowCoordinate(glFragCoordXY - positiveOffset, downOrLeftLogDepth);\nreturn (upOrRightEC - (eyeCoordinate.xyz / eyeCoordinate.w)) * useUpOrRight + ((eyeCoordinate.xyz / eyeCoordinate.w) - downOrLeftEC) * useDownOrLeft;\n}\n#endif // NORMAL_EC\nvoid main(void)\n{\n#ifdef REQUIRES_EC\nfloat logDepthOrDepth = czm_unpackDepth(texture2D(czm_globeDepthTexture, gl_FragCoord.xy / czm_viewport.zw));\nvec4 eyeCoordinate = czm_windowToEyeCoordinates(gl_FragCoord.xy, logDepthOrDepth);\n#endif\n#ifdef REQUIRES_WC\nvec4 worldCoordinate4 = czm_inverseView * eyeCoordinate;\nvec3 worldCoordinate = worldCoordinate4.xyz / worldCoordinate4.w;\n#endif\n#ifdef TEXTURE_COORDINATES\nvec2 uv;\n#ifdef SPHERICAL\nvec2 sphericalLatLong = czm_approximateSphericalCoordinates(worldCoordinate);\nsphericalLatLong.y += v_uvMinAndSphericalLongitudeRotation.z;\nsphericalLatLong.y = czm_branchFreeTernary(sphericalLatLong.y < czm_pi, sphericalLatLong.y, sphericalLatLong.y - czm_twoPi);\nuv.x = (sphericalLatLong.y - v_sphericalExtents.y) * v_sphericalExtents.w;\nuv.y = (sphericalLatLong.x - v_sphericalExtents.x) * v_sphericalExtents.z;\n#else // SPHERICAL\nuv.x = czm_planeDistance(v_westPlane, eyeCoordinate.xyz / eyeCoordinate.w) * v_inversePlaneExtents.x;\nuv.y = czm_planeDistance(v_southPlane, eyeCoordinate.xyz / eyeCoordinate.w) * v_inversePlaneExtents.y;\n#endif // SPHERICAL\n#endif // TEXTURE_COORDINATES\n#ifdef PICK\n#ifdef CULL_FRAGMENTS\nif (0.0 <= uv.x && uv.x <= 1.0 && 0.0 <= uv.y && uv.y <= 1.0) {\ngl_FragColor.a = 1.0;\nczm_writeDepthClampedToFarPlane();\n}\n#else // CULL_FRAGMENTS\ngl_FragColor.a = 1.0;\n#endif // CULL_FRAGMENTS\n#else // PICK\n#ifdef CULL_FRAGMENTS\nif (uv.x <= 0.0 || 1.0 <= uv.x || uv.y <= 0.0 || 1.0 <= uv.y) {\ndiscard;\n}\n#endif\n#ifdef NORMAL_EC\nvec3 downUp = vectorFromOffset(eyeCoordinate, vec2(0.0, 1.0));\nvec3 leftRight = vectorFromOffset(eyeCoordinate, vec2(1.0, 0.0));\nvec3 normalEC = normalize(cross(leftRight, downUp));\n#endif\n#ifdef PER_INSTANCE_COLOR\nvec4 color = czm_gammaCorrect(v_color);\n#ifdef FLAT\ngl_FragColor = color;\n#else // FLAT\nczm_materialInput materialInput;\nmaterialInput.normalEC = normalEC;\nmaterialInput.positionToEyeEC = -eyeCoordinate.xyz;\nczm_material material = czm_getDefaultMaterial(materialInput);\nmaterial.diffuse = color.rgb;\nmaterial.alpha = color.a;\ngl_FragColor = czm_phong(normalize(-eyeCoordinate.xyz), material);\n#endif // FLAT\n#else // PER_INSTANCE_COLOR\nczm_materialInput materialInput;\n#ifdef USES_NORMAL_EC\nmaterialInput.normalEC = normalEC;\n#endif\n#ifdef USES_POSITION_TO_EYE_EC\nmaterialInput.positionToEyeEC = -eyeCoordinate.xyz;\n#endif\n#ifdef USES_TANGENT_TO_EYE\nmaterialInput.tangentToEyeMatrix = czm_eastNorthUpToEyeCoordinates(worldCoordinate, normalEC);\n#endif\n#ifdef USES_ST\nmaterialInput.st.x = czm_lineDistance(v_uvMinAndSphericalLongitudeRotation.xy, v_uMaxAndInverseDistance.xy, uv) * v_uMaxAndInverseDistance.z;\nmaterialInput.st.y = czm_lineDistance(v_uvMinAndSphericalLongitudeRotation.xy, v_vMaxAndInverseDistance.xy, uv) * v_vMaxAndInverseDistance.z;\n#endif\nczm_material material = czm_getMaterial(materialInput);\n#ifdef FLAT\ngl_FragColor = vec4(material.diffuse + material.emission, material.alpha);\n#else // FLAT\ngl_FragColor = czm_phong(normalize(-eyeCoordinate.xyz), material);\n#endif // FLAT\n#endif // PER_INSTANCE_COLOR\nczm_writeDepthClampedToFarPlane();\n#endif // PICK\n}\n",uk={eastMostYhighDefine:"",eastMostYlowDefine:"",westMostYhighDefine:"",westMostYlowDefine:""};function hk(e,t,i){x.a.typeOf.bool("extentsCulling",e),x.a.typeOf.bool("planarExtents",t),x.a.typeOf.object("appearance",i);var n=new _k;n.requiresTextureCoordinates=e,n.requiresEC=!i.flat;var r=new _k;if(r.requiresTextureCoordinates=e,i instanceof $j)n.requiresNormalEC=!i.flat;else{var a=i.material.shaderSource+"\n"+i.fragmentShaderSource;n.normalEC=-1!==a.indexOf("materialInput.normalEC")||-1!==a.indexOf("czm_getDefaultMaterial"),n.positionToEyeEC=-1!==a.indexOf("materialInput.positionToEyeEC"),n.tangentToEyeMatrix=-1!==a.indexOf("materialInput.tangentToEyeMatrix"),n.st=-1!==a.indexOf("materialInput.st")}this._colorShaderDependencies=n,this._pickShaderDependencies=r,this._appearance=i,this._extentsCulling=e,this._planarExtents=t}hk.prototype.createFragmentShader=function(e){x.a.typeOf.bool("columbusView2D",e);var t=this._appearance,i=this._colorShaderDependencies,n=[];e||this._planarExtents||n.push("SPHERICAL"),i.requiresEC&&n.push("REQUIRES_EC"),i.requiresWC&&n.push("REQUIRES_WC"),i.requiresTextureCoordinates&&n.push("TEXTURE_COORDINATES"),this._extentsCulling&&n.push("CULL_FRAGMENTS"),i.requiresNormalEC&&n.push("NORMAL_EC"),t instanceof $j&&n.push("PER_INSTANCE_COLOR"),i.normalEC&&n.push("USES_NORMAL_EC"),i.positionToEyeEC&&n.push("USES_POSITION_TO_EYE_EC"),i.tangentToEyeMatrix&&n.push("USES_TANGENT_TO_EYE"),i.st&&n.push("USES_ST"),t.flat&&n.push("FLAT");var r="";return t instanceof $j||(r=t.material.shaderSource),new UN({defines:n,sources:[r,lk]})},hk.prototype.createPickFragmentShader=function(e){x.a.typeOf.bool("columbusView2D",e);var t=this._pickShaderDependencies,i=["PICK"];return e||this._planarExtents||i.push("SPHERICAL"),t.requiresEC&&i.push("REQUIRES_EC"),t.requiresWC&&i.push("REQUIRES_WC"),t.requiresTextureCoordinates&&i.push("TEXTURE_COORDINATES"),this._extentsCulling&&i.push("CULL_FRAGMENTS"),new UN({defines:i,sources:[lk],pickColorQualifier:"varying"})},hk.prototype.createVertexShader=function(e,t,i,n){return x.a.defined("defines",e),x.a.typeOf.string("vertexShaderSource",t),x.a.typeOf.bool("columbusView2D",i),x.a.defined("mapProjection",n),mk(this._colorShaderDependencies,this._planarExtents,i,e,t,this._appearance,n)},hk.prototype.createPickVertexShader=function(e,t,i,n){return x.a.defined("defines",e),x.a.typeOf.string("vertexShaderSource",t),x.a.typeOf.bool("columbusView2D",i),x.a.defined("mapProjection",n),mk(this._pickShaderDependencies,this._planarExtents,i,e,t,void 0,n)};var dk=new z,fk=new K,pk={high:0,low:0};function mk(e,t,i,n,r,a,o){var s=n.slice();if(""===uk.eastMostYhighDefine){var c=fk;c.longitude=I.PI,c.latitude=0,c.height=0;var l=o.project(c,dk),h=Fu.encode(l.x,pk);uk.eastMostYhighDefine="EAST_MOST_X_HIGH "+h.high.toFixed((h.high+"").length+1),uk.eastMostYlowDefine="EAST_MOST_X_LOW "+h.low.toFixed((h.low+"").length+1);var d=fk;d.longitude=-I.PI,d.latitude=0,d.height=0;var f=o.project(d,dk);h=Fu.encode(f.x,pk),uk.westMostYhighDefine="WEST_MOST_X_HIGH "+h.high.toFixed((h.high+"").length+1),uk.westMostYlowDefine="WEST_MOST_X_LOW "+h.low.toFixed((h.low+"").length+1)}return i&&(s.push(uk.eastMostYhighDefine),s.push(uk.eastMostYlowDefine),s.push(uk.westMostYhighDefine),s.push(uk.westMostYlowDefine)),Object(u.a)(a)&&a instanceof $j&&s.push("PER_INSTANCE_COLOR"),e.requiresTextureCoordinates&&(s.push("TEXTURE_COORDINATES"),t||i||s.push("SPHERICAL"),i&&s.push("COLUMBUS_VIEW_2D")),new UN({defines:s,sources:[r]})}function _k(){this._requiresEC=!1,this._requiresWC=!1,this._requiresNormalEC=!1,this._requiresTextureCoordinates=!1,this._usesNormalEC=!1,this._usesPositionToEyeEC=!1,this._usesTangentToEyeMat=!1,this._usesSt=!1}function gk(e,t,i){return Math.abs((t.y-e.y)*i.x-(t.x-e.x)*i.y+t.x*e.y-t.y*e.x)/Rt.distance(t,e)}Object(O.a)(_k.prototype,{requiresEC:{get:function(){return this._requiresEC},set:function(e){this._requiresEC=e||this._requiresEC}},requiresWC:{get:function(){return this._requiresWC},set:function(e){this._requiresWC=e||this._requiresWC,this.requiresEC=this._requiresWC}},requiresNormalEC:{get:function(){return this._requiresNormalEC},set:function(e){this._requiresNormalEC=e||this._requiresNormalEC,this.requiresEC=this._requiresNormalEC}},requiresTextureCoordinates:{get:function(){return this._requiresTextureCoordinates},set:function(e){this._requiresTextureCoordinates=e||this._requiresTextureCoordinates,this.requiresWC=this._requiresTextureCoordinates}},normalEC:{set:function(e){this.requiresNormalEC=e,this._usesNormalEC=e},get:function(){return this._usesNormalEC}},tangentToEyeMatrix:{set:function(e){this.requiresWC=e,this.requiresNormalEC=e,this._usesTangentToEyeMat=e},get:function(){return this._usesTangentToEyeMat}},positionToEyeEC:{set:function(e){this.requiresEC=e,this._usesPositionToEyeEC=e},get:function(){return this._usesPositionToEyeEC}},st:{set:function(e){this.requiresTextureCoordinates=e,this._usesSt=e},get:function(){return this._usesSt}}});var vk=[new Rt,new Rt,new Rt,new Rt];function bk(e,t){var i=vk,n=Rt.unpack(t,0,i[0]),r=Rt.unpack(t,2,i[1]),a=Rt.unpack(t,4,i[2]);e.uMaxVmax=new iy({componentDatatype:dn.FLOAT,componentsPerAttribute:4,normalize:!1,value:[r.x,r.y,a.x,a.y]});var o=1/gk(n,r,a),s=1/gk(n,a,r);e.uvMinAndExtents=new iy({componentDatatype:dn.FLOAT,componentsPerAttribute:4,normalize:!1,value:[n.x,n.y,o,s]})}var yk=new K,wk=new z,Ok=new z,xk=new z,Ek={high:0,low:0};function Tk(e,t,i){var n=yk;n.height=0,n.longitude=e.west,n.latitude=e.south;var r=t.project(n,wk);n.latitude=e.north;var a=t.project(n,Ok);n.longitude=e.east,n.latitude=e.south;var o=t.project(n,xk),s=[0,0,0,0],c=[0,0,0,0],l=Fu.encode(r.x,Ek);s[0]=l.high,c[0]=l.low,l=Fu.encode(r.y,Ek),s[1]=l.high,c[1]=l.low,l=Fu.encode(a.y,Ek),s[2]=l.high,c[2]=l.low,l=Fu.encode(o.x,Ek),s[3]=l.high,c[3]=l.low,i.planes2D_HIGH=new iy({componentDatatype:dn.FLOAT,componentsPerAttribute:4,normalize:!1,value:s}),i.planes2D_LOW=new iy({componentDatatype:dn.FLOAT,componentsPerAttribute:4,normalize:!1,value:c})}var Ck=new Be,Sk=new Be,Ak=new z,Pk=new K,Ik=[new K,new K,new K,new K,new K,new K,new K,new K];var Dk=new z,jk=new z,Mk=new Fu;hk.getPlanarTextureCoordinateAttributes=function(e,t,i,n,r){x.a.typeOf.object("boundingRectangle",e),x.a.defined("textureCoordinateRotationPoints",t),x.a.typeOf.object("ellipsoid",i),x.a.typeOf.object("projection",n);var a=wk,o=Dk,s=jk;!function(e,t,i,n,r,a){var o=Ve.center(e,Pk);o.height=i;var s=K.toCartesian(o,t,Ak),c=xa.eastNorthUpToFixedFrame(s,t,Ck),l=Be.inverse(c,Sk),u=e.west,h=e.east,d=e.north,f=e.south,p=Ik;p[0].latitude=f,p[0].longitude=u,p[1].latitude=d,p[1].longitude=u,p[2].latitude=d,p[2].longitude=h,p[3].latitude=f,p[3].longitude=h;var m=.5*(u+h),_=.5*(d+f);p[4].latitude=f,p[4].longitude=m,p[5].latitude=d,p[5].longitude=m,p[6].latitude=_,p[6].longitude=u,p[7].latitude=_,p[7].longitude=h;for(var g=Number.POSITIVE_INFINITY,v=Number.NEGATIVE_INFINITY,b=Number.POSITIVE_INFINITY,y=Number.NEGATIVE_INFINITY,w=0;w<8;w++){p[w].height=i;var O=K.toCartesian(p[w],t,Ak);Be.multiplyByPoint(l,O,O),O.z=0,g=Math.min(g,O.x),v=Math.max(v,O.x),b=Math.min(b,O.y),y=Math.max(y,O.y)}var x=n;x.x=g,x.y=b,x.z=0,Be.multiplyByPoint(c,x,x);var E=r;E.x=v,E.y=b,E.z=0,Be.multiplyByPoint(c,E,E),z.subtract(E,x,r);var T=a;T.x=g,T.y=y,T.z=0,Be.multiplyByPoint(c,T,T),z.subtract(T,x,a)}(e,i,Object(w.a)(r,0),a,o,s);var c={};bk(c,t);var l=Fu.fromCartesian(a,Mk);return c.southWest_HIGH=new iy({componentDatatype:dn.FLOAT,componentsPerAttribute:3,normalize:!1,value:z.pack(l.high,[0,0,0])}),c.southWest_LOW=new iy({componentDatatype:dn.FLOAT,componentsPerAttribute:3,normalize:!1,value:z.pack(l.low,[0,0,0])}),c.eastward=new iy({componentDatatype:dn.FLOAT,componentsPerAttribute:3,normalize:!1,value:z.pack(o,[0,0,0])}),c.northward=new iy({componentDatatype:dn.FLOAT,componentsPerAttribute:3,normalize:!1,value:z.pack(s,[0,0,0])}),Tk(e,n,c),c};var Rk=new z;function Lk(e,t,i,n){var r=yk;r.latitude=e,r.longitude=t,r.height=0;var a=K.toCartesian(r,i,Rk),o=Math.sqrt(a.x*a.x+a.y*a.y),s=I.fastApproximateAtan2(o,a.z),c=I.fastApproximateAtan2(a.x,a.y);return n.x=s,n.y=c,n}var Nk=new Rt;hk.getSphericalExtentGeometryInstanceAttributes=function(e,t,i,n){x.a.typeOf.object("boundingRectangle",e),x.a.defined("textureCoordinateRotationPoints",t),x.a.typeOf.object("ellipsoid",i),x.a.typeOf.object("projection",n);var r=Lk(e.south,e.west,i,Nk),a=r.x,o=r.y,s=Lk(e.north,e.east,i,Nk),c=s.x,l=s.y,u=0;o>l&&(u=I.PI-o,o=-I.PI,l+=u),a-=I.EPSILON5,o-=I.EPSILON5,c+=I.EPSILON5;var h=1/((l+=I.EPSILON5)-o),d=1/(c-a),f={sphericalExtents:new iy({componentDatatype:dn.FLOAT,componentsPerAttribute:4,normalize:!1,value:[a,o,d,h]}),longitudeRotation:new iy({componentDatatype:dn.FLOAT,componentsPerAttribute:1,normalize:!1,value:[u]})};return bk(f,t),Tk(e,n,f),f},hk.hasAttributesForTextureCoordinatePlanes=function(e){return Object(u.a)(e.southWest_HIGH)&&Object(u.a)(e.southWest_LOW)&&Object(u.a)(e.northward)&&Object(u.a)(e.eastward)&&Object(u.a)(e.planes2D_HIGH)&&Object(u.a)(e.planes2D_LOW)&&Object(u.a)(e.uMaxVmax)&&Object(u.a)(e.uvMinAndExtents)},hk.hasAttributesForSphericalExtents=function(e){return Object(u.a)(e.sphericalExtents)&&Object(u.a)(e.longitudeRotation)&&Object(u.a)(e.planes2D_HIGH)&&Object(u.a)(e.planes2D_LOW)&&Object(u.a)(e.uMaxVmax)&&Object(u.a)(e.uvMinAndExtents)},hk.shouldUseSphericalCoordinates=function(e){return x.a.typeOf.object("rectangle",e),function(e){return Math.max(e.width,e.height)>hk.MAX_WIDTH_FOR_PLANAR_EXTENTS}(e)},hk.MAX_WIDTH_FOR_PLANAR_EXTENTS=I.toRadians(1);var Fk=hk,kk={NEVER:un.NEVER,LESS:un.LESS,EQUAL:un.EQUAL,LESS_OR_EQUAL:un.LEQUAL,GREATER:un.GREATER,NOT_EQUAL:un.NOTEQUAL,GREATER_OR_EQUAL:un.GEQUAL,ALWAYS:un.ALWAYS},Bk=Object(E.a)(kk),zk={ZERO:un.ZERO,KEEP:un.KEEP,REPLACE:un.REPLACE,INCREMENT:un.INCR,DECREMENT:un.DECR,INVERT:un.INVERT,INCREMENT_WRAP:un.INCR_WRAP,DECREMENT_WRAP:un.DECR_WRAP},Uk=Object(E.a)(zk),Vk={CESIUM_3D_TILE_MASK:128,SKIP_LOD_MASK:112,SKIP_LOD_BIT_SHIFT:4,CLASSIFICATION_MASK:15,setCesium3DTileBit:function(){return{enabled:!0,frontFunction:Bk.ALWAYS,frontOperation:{fail:Uk.KEEP,zFail:Uk.KEEP,zPass:Uk.REPLACE},backFunction:Bk.ALWAYS,backOperation:{fail:Uk.KEEP,zFail:Uk.KEEP,zPass:Uk.REPLACE},reference:Vk.CESIUM_3D_TILE_MASK,mask:Vk.CESIUM_3D_TILE_MASK}}},Hk=Object(E.a)(Vk),Gk=["color"];function qk(e){var t,i=(e=Object(w.a)(e,w.a.EMPTY_OBJECT)).geometryInstances;this.geometryInstances=i,this.show=Object(w.a)(e.show,!0),this.classificationType=Object(w.a)(e.classificationType,iM.BOTH),this.debugShowBoundingVolume=Object(w.a)(e.debugShowBoundingVolume,!1),this.debugShowShadowVolume=Object(w.a)(e.debugShowShadowVolume,!1),this._debugShowShadowVolume=!1,this._extruded=Object(w.a)(e._extruded,!1),this._uniformMap=e._uniformMap,this._sp=void 0,this._spStencil=void 0,this._spPick=void 0,this._spColor=void 0,this._spPick2D=void 0,this._spColor2D=void 0,this._rsStencilPreloadPass=void 0,this._rsStencilPreloadPass3DTiles=void 0,this._rsStencilDepthPass=void 0,this._rsStencilDepthPass3DTiles=void 0,this._rsColorPass=void 0,this._rsPickPass=void 0,this._commandsIgnoreShow=[],this._ready=!1,this._readyPromise=Oi.a.defer(),this._primitive=void 0,this._pickPrimitive=e._pickPrimitive,this._hasSphericalExtentsAttribute=!1,this._hasPlanarExtentsAttributes=!1,this._hasPerColorAttribute=!1,this.appearance=e.appearance,Object(u.a)(i)&&Object(ym.a)(i)&&i.length>1&&(t=Gk),this._createBoundingVolumeFunction=e._createBoundingVolumeFunction,this._updateAndQueueCommandsFunction=e._updateAndQueueCommandsFunction,this._usePickOffsets=!1,this._primitiveOptions={geometryInstances:void 0,appearance:void 0,vertexCacheOptimize:Object(w.a)(e.vertexCacheOptimize,!1),interleave:Object(w.a)(e.interleave,!1),releaseGeometryInstances:Object(w.a)(e.releaseGeometryInstances,!0),allowPicking:Object(w.a)(e.allowPicking,!0),asynchronous:Object(w.a)(e.asynchronous,!0),compressVertices:Object(w.a)(e.compressVertices,!0),_readOnlyInstanceAttributes:t,_createBoundingVolumeFunction:void 0,_createRenderStatesFunction:void 0,_createShaderProgramFunction:void 0,_createCommandsFunction:void 0,_updateAndQueueCommandsFunction:void 0,_createPickOffsets:!0}}function Wk(e,t){var i=t?Bk.EQUAL:Bk.ALWAYS;return{colorMask:{red:!1,green:!1,blue:!1,alpha:!1},stencilTest:{enabled:e,frontFunction:i,frontOperation:{fail:Uk.KEEP,zFail:Uk.DECREMENT_WRAP,zPass:Uk.DECREMENT_WRAP},backFunction:i,backOperation:{fail:Uk.KEEP,zFail:Uk.INCREMENT_WRAP,zPass:Uk.INCREMENT_WRAP},reference:Hk.CESIUM_3D_TILE_MASK,mask:Hk.CESIUM_3D_TILE_MASK},stencilMask:Hk.CLASSIFICATION_MASK,depthTest:{enabled:!1},depthMask:!1}}function Yk(e,t){var i=t?Bk.EQUAL:Bk.ALWAYS;return{colorMask:{red:!1,green:!1,blue:!1,alpha:!1},stencilTest:{enabled:e,frontFunction:i,frontOperation:{fail:Uk.KEEP,zFail:Uk.KEEP,zPass:Uk.INCREMENT_WRAP},backFunction:i,backOperation:{fail:Uk.KEEP,zFail:Uk.KEEP,zPass:Uk.DECREMENT_WRAP},reference:Hk.CESIUM_3D_TILE_MASK,mask:Hk.CESIUM_3D_TILE_MASK},stencilMask:Hk.CLASSIFICATION_MASK,depthTest:{enabled:!0,func:qN.LESS_OR_EQUAL},depthMask:!1}}function Xk(e){return{stencilTest:{enabled:e,frontFunction:Bk.NOT_EQUAL,frontOperation:{fail:Uk.KEEP,zFail:Uk.KEEP,zPass:Uk.DECREMENT_WRAP},backFunction:Bk.NOT_EQUAL,backOperation:{fail:Uk.KEEP,zFail:Uk.KEEP,zPass:Uk.DECREMENT_WRAP},reference:0,mask:Hk.CLASSIFICATION_MASK},stencilMask:Hk.CLASSIFICATION_MASK,depthTest:{enabled:!1},depthMask:!1,blending:FD.ALPHA_BLEND}}Object(O.a)(qk.prototype,{vertexCacheOptimize:{get:function(){return this._primitiveOptions.vertexCacheOptimize}},interleave:{get:function(){return this._primitiveOptions.interleave}},releaseGeometryInstances:{get:function(){return this._primitiveOptions.releaseGeometryInstances}},allowPicking:{get:function(){return this._primitiveOptions.allowPicking}},asynchronous:{get:function(){return this._primitiveOptions.asynchronous}},compressVertices:{get:function(){return this._primitiveOptions.compressVertices}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise.promise}},_needs2DShader:{get:function(){return this._hasPlanarExtentsAttributes||this._hasSphericalExtentsAttribute}}}),qk.isSupported=function(e){return e.context.stencilBuffer};var Zk={stencilTest:{enabled:!0,frontFunction:Bk.NOT_EQUAL,frontOperation:{fail:Uk.KEEP,zFail:Uk.KEEP,zPass:Uk.DECREMENT_WRAP},backFunction:Bk.NOT_EQUAL,backOperation:{fail:Uk.KEEP,zFail:Uk.KEEP,zPass:Uk.DECREMENT_WRAP},reference:0,mask:Hk.CLASSIFICATION_MASK},stencilMask:Hk.CLASSIFICATION_MASK,depthTest:{enabled:!1},depthMask:!1};function Qk(e,t){var i=t.context,n=e._primitive,r=HN;r=e._primitive._batchTable.getVertexShaderCallback()(r),r=ck._appendDistanceDisplayConditionToShader(n,r),r=ck._modifyShaderPosition(e,r,t.scene3DOnly),r=ck._updateColorAttribute(n,r);var a=e._hasPlanarExtentsAttributes,o=a||e._hasSphericalExtentsAttribute;e._extruded&&(r=function(e,t){if(!e.compressVertices)return t;if(-1!==t.search(/attribute\s+vec3\s+extrudeDirection;/g)){var i="attribute vec2 compressedAttributes;",n=t;return n=n.replace(/attribute\s+vec3\s+extrudeDirection;/g,""),[i,"vec3 extrudeDirection;\n",n=UN.replaceMain(n,"czm_non_compressed_main"),"void main() \n{ \n    extrudeDirection = czm_octDecode(compressedAttributes, 65535.0);\n    czm_non_compressed_main(); \n}"].join("\n")}}(n,r));var s=e._extruded?"EXTRUDED_GEOMETRY":"",c="ENABLE_GL_POSITION_LOG_DEPTH_AT_HEIGHT",l=new UN({defines:[s,c],sources:[r]}),h=new UN({sources:[VN]}),d=e._primitive._attributeLocations,f=new Fk(o,a,e.appearance);if(e._spStencil=bR.replaceCache({context:i,shaderProgram:e._spStencil,vertexShaderSource:l,fragmentShaderSource:h,attributeLocations:d}),e._primitive.allowPicking){var p=UN.createPickVertexShaderSource(r);p=ck._appendShowToShader(n,p),p=ck._updatePickColorAttribute(p);var m=f.createPickFragmentShader(!1),_=f.createPickVertexShader([s,c],p,!1,t.mapProjection);if(e._spPick=bR.replaceCache({context:i,shaderProgram:e._spPick,vertexShaderSource:_,fragmentShaderSource:m,attributeLocations:d}),o){var g=i.shaderCache.getDerivedShaderProgram(e._spPick,"2dPick");if(!Object(u.a)(g)){var v=f.createPickFragmentShader(!0),b=f.createPickVertexShader([s,c],p,!0,t.mapProjection);g=i.shaderCache.createDerivedShaderProgram(e._spPick,"2dPick",{vertexShaderSource:b,fragmentShaderSource:v,attributeLocations:d})}e._spPick2D=g}}else e._spPick=bR.fromCache({context:i,vertexShaderSource:l,fragmentShaderSource:h,attributeLocations:d});r=ck._appendShowToShader(n,r),l=new UN({defines:[s,c],sources:[r]}),e._sp=bR.replaceCache({context:i,shaderProgram:e._sp,vertexShaderSource:l,fragmentShaderSource:h,attributeLocations:d});var y=f.createFragmentShader(!1),w=f.createVertexShader([s,c],r,!1,t.mapProjection);if(e._spColor=bR.replaceCache({context:i,shaderProgram:e._spColor,vertexShaderSource:w,fragmentShaderSource:y,attributeLocations:d}),o){var O=i.shaderCache.getDerivedShaderProgram(e._spColor,"2dColor");if(!Object(u.a)(O)){var x=f.createFragmentShader(!0),E=f.createVertexShader([s,c],r,!0,t.mapProjection);O=i.shaderCache.createDerivedShaderProgram(e._spColor,"2dColor",{vertexShaderSource:E,fragmentShaderSource:x,attributeLocations:d})}e._spColor2D=O}}function Kk(e,t,i,n,r,a,o){!function(e,t){var i,n,r,a=e._primitive,o=3*a._va.length;t.length=o;var s=0,c=a._batchTable.getUniformMapCallback()(e._uniformMap),l=e._needs2DShader;for(i=0;i<o;i+=3){var h=a._va[s++];n=t[i],Object(u.a)(n)||(n=t[i]=new cM({owner:e,primitiveType:a._primitiveType})),n.vertexArray=h,n.renderState=e._rsStencilPreloadPass,n.shaderProgram=e._sp,n.uniformMap=c,n.pass=lM.TERRAIN_CLASSIFICATION,(r=cM.shallowClone(n,n.derivedCommands.tileset)).renderState=e._rsStencilPreloadPass3DTiles,r.pass=lM.CESIUM_3D_TILE_CLASSIFICATION,n.derivedCommands.tileset=r,n=t[i+1],Object(u.a)(n)||(n=t[i+1]=new cM({owner:e,primitiveType:a._primitiveType})),n.vertexArray=h,n.renderState=e._rsStencilDepthPass,n.shaderProgram=e._sp,n.uniformMap=c,n.pass=lM.TERRAIN_CLASSIFICATION,(r=cM.shallowClone(n,n.derivedCommands.tileset)).renderState=e._rsStencilDepthPass3DTiles,r.pass=lM.CESIUM_3D_TILE_CLASSIFICATION,n.derivedCommands.tileset=r,n=t[i+2],Object(u.a)(n)||(n=t[i+2]=new cM({owner:e,primitiveType:a._primitiveType})),n.vertexArray=h,n.renderState=e._rsColorPass,n.shaderProgram=e._spColor,n.pass=lM.TERRAIN_CLASSIFICATION;var d=e.appearance.material;if(Object(u.a)(d)&&(c=Object(ff.a)(c,d._uniforms)),n.uniformMap=c,(r=cM.shallowClone(n,n.derivedCommands.tileset)).pass=lM.CESIUM_3D_TILE_CLASSIFICATION,n.derivedCommands.tileset=r,l){var f=cM.shallowClone(n,n.derivedCommands.appearance2D);f.shaderProgram=e._spColor2D,n.derivedCommands.appearance2D=f,(f=cM.shallowClone(r,r.derivedCommands.appearance2D)).shaderProgram=e._spColor2D,r.derivedCommands.appearance2D=f}}var p=e._commandsIgnoreShow,m=e._spStencil,_=0;o=p.length=o/3*2;for(var g=0;g<o;g+=2){var v=p[g]=cM.shallowClone(t[_],p[g]);v.shaderProgram=m,v.pass=lM.CESIUM_3D_TILE_CLASSIFICATION_IGNORE_SHOW,(v=p[g+1]=cM.shallowClone(t[_+1],p[g+1])).shaderProgram=m,v.pass=lM.CESIUM_3D_TILE_CLASSIFICATION_IGNORE_SHOW,_+=3}}(e,a),function(e,t){var i,n,r,a,o,s=e._usePickOffsets,c=e._primitive,l=3*c._va.length,h=0;s&&(l=3*(i=c._pickOffsets).length),t.length=l;var d=0,f=c._batchTable.getUniformMapCallback()(e._uniformMap),p=e._needs2DShader;for(r=0;r<l;r+=3){var m=c._va[d++];if(s&&(n=i[h++],m=c._va[n.index]),a=t[r],Object(u.a)(a)||(a=t[r]=new cM({owner:e,primitiveType:c._primitiveType,pickOnly:!0})),a.vertexArray=m,a.renderState=e._rsStencilPreloadPass,a.shaderProgram=e._sp,a.uniformMap=f,a.pass=lM.TERRAIN_CLASSIFICATION,s&&(a.offset=n.offset,a.count=n.count),(o=cM.shallowClone(a,a.derivedCommands.tileset)).renderState=e._rsStencilPreloadPass3DTiles,o.pass=lM.CESIUM_3D_TILE_CLASSIFICATION,a.derivedCommands.tileset=o,a=t[r+1],Object(u.a)(a)||(a=t[r+1]=new cM({owner:e,primitiveType:c._primitiveType,pickOnly:!0})),a.vertexArray=m,a.renderState=e._rsStencilDepthPass,a.shaderProgram=e._sp,a.uniformMap=f,a.pass=lM.TERRAIN_CLASSIFICATION,s&&(a.offset=n.offset,a.count=n.count),(o=cM.shallowClone(a,a.derivedCommands.tileset)).renderState=e._rsStencilDepthPass3DTiles,o.pass=lM.CESIUM_3D_TILE_CLASSIFICATION,a.derivedCommands.tileset=o,a=t[r+2],Object(u.a)(a)||(a=t[r+2]=new cM({owner:e,primitiveType:c._primitiveType,pickOnly:!0})),a.vertexArray=m,a.renderState=e._rsPickPass,a.shaderProgram=e._spPick,a.uniformMap=f,a.pass=lM.TERRAIN_CLASSIFICATION,s&&(a.offset=n.offset,a.count=n.count),(o=cM.shallowClone(a,a.derivedCommands.tileset)).pass=lM.CESIUM_3D_TILE_CLASSIFICATION,a.derivedCommands.tileset=o,p){var _=cM.shallowClone(a,a.derivedCommands.pick2D);_.shaderProgram=e._spPick2D,a.derivedCommands.pick2D=_,(_=cM.shallowClone(o,o.derivedCommands.pick2D)).shaderProgram=e._spPick2D,o.derivedCommands.pick2D=_}}}(e,o)}function Jk(e,t){return Math.floor(e%t/3)}function $k(e,t,i,n,r,a){e.modelMatrix=i,e.boundingVolume=r,e.cull=n,e.debugShowBoundingVolume=a,t.commandList.push(e)}function eB(e,t,i,n,r){e.modelMatrix=i,e.boundingVolume=r,e.cull=n,t.commandList.push(e)}qk.prototype.update=function(e){if(Object(u.a)(this._primitive)||Object(u.a)(this.geometryInstances)){var t=this.appearance;Object(u.a)(t)&&Object(u.a)(t.material)&&t.material.update(e.context);var i=this,n=this._primitiveOptions;if(!Object(u.a)(this._primitive)){var r,a,o,s,c=Object(ym.a)(this.geometryInstances)?this.geometryInstances:[this.geometryInstances],l=c.length,d=!1,f=!0,p=!1,m=!1;for(l>0&&(o=c[0].attributes,p=Fk.hasAttributesForSphericalExtents(o),m=Fk.hasAttributesForTextureCoordinatePlanes(o),s=o.color),r=0;r<l;r++){var _=(a=c[r]).attributes.color;if(Object(u.a)(_))d=!0;else if(d)throw new h.a("All GeometryInstances must have color attributes to use per-instance color.");f=f&&Object(u.a)(_)&&df.equals(s,_)}if(!f&&!p&&!m)throw new h.a("All GeometryInstances must have the same color attribute except via GroundPrimitives");if(d&&!Object(u.a)(t)&&(t=new $j({flat:!0}),this.appearance=t),!d&&t instanceof $j)throw new h.a("PerInstanceColorAppearance requires color GeometryInstanceAttributes on all GeometryInstances");if(Object(u.a)(t.material)&&!p&&!m)throw new h.a("Materials on ClassificationPrimitives are not supported except via GroundPrimitives");this._usePickOffsets=!p&&!m,this._hasSphericalExtentsAttribute=p,this._hasPlanarExtentsAttributes=m,this._hasPerColorAttribute=d;var g=new Array(l);for(r=0;r<l;++r)a=c[r],g[r]=new Mu({geometry:a.geometry,attributes:a.attributes,modelMatrix:a.modelMatrix,id:a.id,pickPrimitive:Object(w.a)(this._pickPrimitive,i)});n.appearance=t,n.geometryInstances=g,Object(u.a)(this._createBoundingVolumeFunction)&&(n._createBoundingVolumeFunction=function(e,t){i._createBoundingVolumeFunction(e,t)}),n._createRenderStatesFunction=function(e,t,n,r){!function(e,t,i,n){if(!Object(u.a)(e._rsStencilPreloadPass)){var r=!e.debugShowShadowVolume;e._rsStencilPreloadPass=RM.fromCache(Wk(r,!1)),e._rsStencilPreloadPass3DTiles=RM.fromCache(Wk(r,!0)),e._rsStencilDepthPass=RM.fromCache(Yk(r,!1)),e._rsStencilDepthPass3DTiles=RM.fromCache(Yk(r,!0)),e._rsColorPass=RM.fromCache(Xk(r)),e._rsPickPass=RM.fromCache(Zk)}}(i)},n._createShaderProgramFunction=function(e,t,n){Qk(i,t)},n._createCommandsFunction=function(e,t,n,r,a,o,s){Kk(i,0,0,0,0,o,s)},Object(u.a)(this._updateAndQueueCommandsFunction)?n._updateAndQueueCommandsFunction=function(e,t,n,r,a,o,s,c){i._updateAndQueueCommandsFunction(e,t,n,r,a,o,s,c)}:n._updateAndQueueCommandsFunction=function(e,t,n,r,a,o,s,c){!function(e,t,i,n,r,a,o,s){var c,l=e._primitive;ck._updateBoundingVolumes(l,t,r),t.mode===xF.SCENE3D?c=l._boundingSphereWC:t.mode===xF.COLUMBUS_VIEW?c=l._boundingSphereCV:t.mode===xF.SCENE2D&&Object(u.a)(l._boundingSphere2D)?c=l._boundingSphere2D:Object(u.a)(l._boundingSphereMorph)&&(c=l._boundingSphereMorph);var h,d,f=e.classificationType,p=f!==iM.CESIUM_3D_TILE,m=f!==iM.TERRAIN,_=t.passes;if(_.render){var g=i.length;for(h=0;h<g;++h)d=c[Jk(h,g)],p&&$k(i[h],t,r,a,d,o),m&&$k(i[h].derivedCommands.tileset,t,r,a,d,o);if(t.invertClassification){var v=e._commandsIgnoreShow,b=v.length;for(h=0;h<b;++h)d=c[Math.floor(h/2)],$k(v[h],t,r,a,d,o)}}if(_.pick){var y=n.length,w=l._pickOffsets;for(h=0;h<y;++h){d=c[w[Jk(h,y)].index],p&&eB(n[h],t,r,a,d),m&&eB(n[h].derivedCommands.tileset,t,r,a,d)}}}(i,t,n,r,a,o,s)},this._primitive=new ck(n),this._primitive.readyPromise.then((function(e){i._ready=!0,i.releaseGeometryInstances&&(i.geometryInstances=void 0);var t=e._error;Object(u.a)(t)?i._readyPromise.reject(t):i._readyPromise.resolve(i)}))}if(this.debugShowShadowVolume&&!this._debugShowShadowVolume&&this._ready?(this._debugShowShadowVolume=!0,this._rsStencilPreloadPass=RM.fromCache(Wk(!1,!1)),this._rsStencilPreloadPass3DTiles=RM.fromCache(Wk(!1,!0)),this._rsStencilDepthPass=RM.fromCache(Yk(!1,!1)),this._rsStencilDepthPass3DTiles=RM.fromCache(Yk(!1,!0)),this._rsColorPass=RM.fromCache(Xk(!1))):!this.debugShowShadowVolume&&this._debugShowShadowVolume&&(this._debugShowShadowVolume=!1,this._rsStencilPreloadPass=RM.fromCache(Wk(!0,!1)),this._rsStencilPreloadPass3DTiles=RM.fromCache(Wk(!0,!0)),this._rsStencilDepthPass=RM.fromCache(Yk(!0,!1)),this._rsStencilDepthPass3DTiles=RM.fromCache(Yk(!0,!0)),this._rsColorPass=RM.fromCache(Xk(!0))),this._primitive.appearance!==t){if(!this._hasSphericalExtentsAttribute&&!this._hasPlanarExtentsAttributes&&Object(u.a)(t.material))throw new h.a("Materials on ClassificationPrimitives are not supported except via GroundPrimitive");if(!this._hasPerColorAttribute&&t instanceof $j)throw new h.a("PerInstanceColorAppearance requires color GeometryInstanceAttribute");this._primitive.appearance=t}this._primitive.show=this.show,this._primitive.debugShowBoundingVolume=this.debugShowBoundingVolume,this._primitive.update(e)}},qk.prototype.getGeometryInstanceAttributes=function(e){if(!Object(u.a)(this._primitive))throw new h.a("must call update before calling getGeometryInstanceAttributes");return this._primitive.getGeometryInstanceAttributes(e)},qk.prototype.isDestroyed=function(){return!1},qk.prototype.destroy=function(){return this._primitive=this._primitive&&this._primitive.destroy(),this._sp=this._sp&&this._sp.destroy(),this._spPick=this._spPick&&this._spPick.destroy(),this._spColor=this._spColor&&this._spColor.destroy(),this._spPick2D=void 0,this._spColor2D=void 0,rl(this)};var tB=qk,iB={u_globeMinimumAltitude:function(){return 55e3}};function nB(e){var t=(e=Object(w.a)(e,w.a.EMPTY_OBJECT)).appearance,i=e.geometryInstances;if(!Object(u.a)(t)&&Object(u.a)(i))for(var n=Object(ym.a)(i)?i:[i],r=n.length,a=0;a<r;a++){var o=n[a].attributes;if(Object(u.a)(o)&&Object(u.a)(o.color)){t=new $j({flat:!0});break}}this.appearance=t,this.geometryInstances=e.geometryInstances,this.show=Object(w.a)(e.show,!0),this.classificationType=Object(w.a)(e.classificationType,iM.BOTH),this.debugShowBoundingVolume=Object(w.a)(e.debugShowBoundingVolume,!1),this.debugShowShadowVolume=Object(w.a)(e.debugShowShadowVolume,!1),this._boundingVolumes=[],this._boundingVolumes2D=[],this._ready=!1,this._readyPromise=Oi.a.defer(),this._primitive=void 0,this._maxHeight=void 0,this._minHeight=void 0,this._maxTerrainHeight=Xt._defaultMaxTerrainHeight,this._minTerrainHeight=Xt._defaultMinTerrainHeight,this._boundingSpheresKeys=[],this._boundingSpheres=[],this._useFragmentCulling=!1,this._zIndex=void 0;this._classificationPrimitiveOptions={geometryInstances:void 0,appearance:void 0,vertexCacheOptimize:Object(w.a)(e.vertexCacheOptimize,!1),interleave:Object(w.a)(e.interleave,!1),releaseGeometryInstances:Object(w.a)(e.releaseGeometryInstances,!0),allowPicking:Object(w.a)(e.allowPicking,!0),asynchronous:Object(w.a)(e.asynchronous,!0),compressVertices:Object(w.a)(e.compressVertices,!0),_createBoundingVolumeFunction:void 0,_updateAndQueueCommandsFunction:void 0,_pickPrimitive:this,_extruded:!0,_uniformMap:iB}}function rB(e){return function(t,i){var n=i.maximumRadius,r=n/Math.cos(.5*t)-n;return e._maxHeight+r}}function aB(e){return function(t,i){return e._minHeight}}Object(O.a)(nB.prototype,{vertexCacheOptimize:{get:function(){return this._classificationPrimitiveOptions.vertexCacheOptimize}},interleave:{get:function(){return this._classificationPrimitiveOptions.interleave}},releaseGeometryInstances:{get:function(){return this._classificationPrimitiveOptions.releaseGeometryInstances}},allowPicking:{get:function(){return this._classificationPrimitiveOptions.allowPicking}},asynchronous:{get:function(){return this._classificationPrimitiveOptions.asynchronous}},compressVertices:{get:function(){return this._classificationPrimitiveOptions.compressVertices}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise.promise}}}),nB.isSupported=tB.isSupported;var oB=new z,sB=new z,cB=new z,lB=new K,uB=new Ve;function hB(e,t){var i=e.mapProjection.ellipsoid;if(!Object(u.a)(t.attributes)||!Object(u.a)(t.attributes.position3DHigh))return Object(u.a)(t.rectangle)?t.rectangle:void 0;for(var n=t.attributes.position3DHigh.values,r=t.attributes.position3DLow.values,a=n.length,o=Number.POSITIVE_INFINITY,s=Number.POSITIVE_INFINITY,c=Number.NEGATIVE_INFINITY,l=Number.NEGATIVE_INFINITY,h=0;h<a;h+=3){var d=z.unpack(n,h,oB),f=z.unpack(r,h,sB),p=z.add(d,f,cB),m=i.cartesianToCartographic(p,lB),_=m.latitude,g=m.longitude;o=Math.min(o,_),s=Math.min(s,g),c=Math.max(c,_),l=Math.max(l,g)}var v=uB;return v.north=c,v.south=o,v.east=l,v.west=s,v}function dB(e,t){return Math.floor(e%t/3)}function fB(e,t,i,n,r,a,o){var s=e._primitive;i.mode!==xF.SCENE3D&&t.shaderProgram===s._spColor&&s._needs2DShader&&(t=t.derivedCommands.appearance2D),t.owner=e,t.modelMatrix=n,t.boundingVolume=a,t.cull=r,t.debugShowBoundingVolume=o,i.commandList.push(t)}function pB(e,t,i,n,r,a){var o=e._primitive;i.mode!==xF.SCENE3D&&t.shaderProgram===o._spPick&&o._needs2DShader&&(t=t.derivedCommands.pick2D),t.owner=e,t.modelMatrix=n,t.boundingVolume=a,t.cull=r,i.commandList.push(t)}nB.initializeTerrainHeights=function(){return Xt.initialize()},nB.prototype.update=function(e){if(Object(u.a)(this._primitive)||Object(u.a)(this.geometryInstances))if(Xt.initialized){var t=this,i=this._classificationPrimitiveOptions;if(!Object(u.a)(this._primitive)){var n,r,a,o,s,c=e.mapProjection.ellipsoid,l=Object(ym.a)(this.geometryInstances)?this.geometryInstances:[this.geometryInstances],d=l.length,f=new Array(d);for(o=0;o<d;++o){var p=hB(e,r=(n=l[o]).geometry);Object(u.a)(s)?Object(u.a)(p)&&Ve.union(s,p,s):s=Ve.clone(p);var m=n.id;if(Object(u.a)(m)&&Object(u.a)(p)){var _=Xt.getBoundingSphere(p,c);this._boundingSpheresKeys.push(m),this._boundingSpheres.push(_)}if(a=r.constructor,!Object(u.a)(a)||!Object(u.a)(a.createShadowVolume))throw new h.a("Not all of the geometry instances have GroundPrimitive support.")}!function(e,t,i){var n=Xt.getMinimumMaximumHeights(t,i);e._minTerrainHeight=n.minimumTerrainHeight,e._maxTerrainHeight=n.maximumTerrainHeight}(this,s,c);var g=e.terrainExaggeration;this._minHeight=this._minTerrainHeight*g,this._maxHeight=this._maxTerrainHeight*g;var v=nB._supportsMaterials(e.context);if(this._useFragmentCulling=v,v){var b,y=!0;for(o=0;o<d;++o)if(s=hB(e,r=(n=l[o]).geometry),Fk.shouldUseSphericalCoordinates(s)){y=!1;break}for(o=0;o<d;++o){a=(r=(n=l[o]).geometry).constructor;var w=hB(e,r),O=r.textureCoordinateRotationPoints;b=y?Fk.getPlanarTextureCoordinateAttributes(w,O,c,e.mapProjection,this._maxHeight):Fk.getSphericalExtentGeometryInstanceAttributes(w,O,c,e.mapProjection);var x=n.attributes;for(var E in x)x.hasOwnProperty(E)&&(b[E]=x[E]);f[o]=new Mu({geometry:a.createShadowVolume(r,aB(this),rB(this)),attributes:b,id:n.id})}}else for(o=0;o<d;++o)a=(r=(n=l[o]).geometry).constructor,f[o]=new Mu({geometry:a.createShadowVolume(r,aB(this),rB(this)),attributes:n.attributes,id:n.id});i.geometryInstances=f,i.appearance=this.appearance,i._createBoundingVolumeFunction=function(e,i){!function(e,t,i){var n=t.mapProjection.ellipsoid,r=hB(t,i);if(r.width<I.PI){var a=Fc.fromRectangle(r,e._maxHeight,e._minHeight,n);e._boundingVolumes.push(a)}else{var o=i.attributes.position3DHigh.values,s=i.attributes.position3DLow.values;e._boundingVolumes.push(St.fromEncodedCartesianVertices(o,s))}if(!t.scene3DOnly){var c=t.mapProjection,l=St.fromRectangleWithHeights2D(r,c,e._maxHeight,e._minHeight);z.fromElements(l.center.z,l.center.x,l.center.y,l.center),e._boundingVolumes2D.push(l)}}(t,e,i)},i._updateAndQueueCommandsFunction=function(e,i,n,r,a,o,s,c){!function(e,t,i,n,r,a,o,s){var c;c=t.mode===xF.SCENE3D?e._boundingVolumes:e._boundingVolumes2D;var l,u,h=e.classificationType,d=h!==iM.CESIUM_3D_TILE,f=h!==iM.TERRAIN,p=t.passes,m=e._primitive;if(p.render){var _=i.length;for(l=0;l<_;++l)u=c[dB(l,_)],d&&fB(e,i[l],t,r,a,u,o),f&&fB(e,i[l].derivedCommands.tileset,t,r,a,u,o);if(t.invertClassification){var g=m._commandsIgnoreShow,v=g.length;for(l=0;l<v;++l)u=c[Math.floor(l/2)],fB(e,g[l],t,r,a,u,o)}}if(p.pick){var b,y=n.length;for(e._useFragmentCulling||(b=m._primitive._pickOffsets),l=0;l<y;++l){if(u=c[dB(l,y)],!e._useFragmentCulling)u=c[b[dB(l,y)].index];d&&pB(e,n[l],t,r,a,u),f&&pB(e,n[l].derivedCommands.tileset,t,r,a,u)}}}(t,i,n,r,a,o,s)},this._primitive=new tB(i),this._primitive.readyPromise.then((function(e){t._ready=!0,t.releaseGeometryInstances&&(t.geometryInstances=void 0);var i=e._error;Object(u.a)(i)?t._readyPromise.reject(i):t._readyPromise.resolve(t)}))}this._primitive.appearance=this.appearance,this._primitive.show=this.show,this._primitive.debugShowShadowVolume=this.debugShowShadowVolume,this._primitive.debugShowBoundingVolume=this.debugShowBoundingVolume,this._primitive.update(e)}else{if(!this.asynchronous)throw new h.a("For synchronous GroundPrimitives, you must call GroundPrimitive.initializeTerrainHeights() and wait for the returned promise to resolve.");nB.initializeTerrainHeights()}},nB.prototype.getBoundingSphere=function(e){var t=this._boundingSpheresKeys.indexOf(e);if(-1!==t)return this._boundingSpheres[t]},nB.prototype.getGeometryInstanceAttributes=function(e){if(!Object(u.a)(this._primitive))throw new h.a("must call update before calling getGeometryInstanceAttributes");return this._primitive.getGeometryInstanceAttributes(e)},nB.prototype.isDestroyed=function(){return!1},nB.prototype.destroy=function(){return this._primitive=this._primitive&&this._primitive.destroy(),rl(this)},nB._supportsMaterials=function(e){return e.depthTexture},nB.supportsMaterials=function(e){return x.a.typeOf.object("scene",e),nB._supportsMaterials(e.frameState.context)};var mB=nB,_B="attribute vec3 position3DHigh;\nattribute vec3 position3DLow;\n#ifndef COLUMBUS_VIEW_2D\nattribute vec4 startHiAndForwardOffsetX;\nattribute vec4 startLoAndForwardOffsetY;\nattribute vec4 startNormalAndForwardOffsetZ;\nattribute vec4 endNormalAndTextureCoordinateNormalizationX;\nattribute vec4 rightNormalAndTextureCoordinateNormalizationY;\n#else\nattribute vec4 startHiLo2D;\nattribute vec4 offsetAndRight2D;\nattribute vec4 startEndNormals2D;\nattribute vec2 texcoordNormalization2D;\n#endif\nattribute float batchId;\nvarying vec4 v_startPlaneNormalEcAndHalfWidth;\nvarying vec4 v_endPlaneNormalEcAndBatchId;\nvarying vec4 v_rightPlaneEC;\nvarying vec4 v_endEcAndStartEcX;\nvarying vec4 v_texcoordNormalizationAndStartEcYZ;\n#ifdef WIDTH_VARYING\nvarying float v_width;\n#endif\n#ifdef ANGLE_VARYING\nvarying float v_polylineAngle;\n#endif\n#ifdef PER_INSTANCE_COLOR\nvarying vec4 v_color;\n#endif\nvoid main()\n{\n#ifdef COLUMBUS_VIEW_2D\nvec3 ecStart = (czm_modelViewRelativeToEye * czm_translateRelativeToEye(vec3(0.0, startHiLo2D.xy), vec3(0.0, startHiLo2D.zw))).xyz;\nvec3 forwardDirectionEC = czm_normal * vec3(0.0, offsetAndRight2D.xy);\nvec3 ecEnd = forwardDirectionEC + ecStart;\nforwardDirectionEC = normalize(forwardDirectionEC);\nv_rightPlaneEC.xyz = czm_normal * vec3(0.0, offsetAndRight2D.zw);\nv_rightPlaneEC.w = -dot(v_rightPlaneEC.xyz, ecStart);\nvec4 startPlaneEC;\nstartPlaneEC.xyz =  czm_normal * vec3(0.0, startEndNormals2D.xy);\nstartPlaneEC.w = -dot(startPlaneEC.xyz, ecStart);\nvec4 endPlaneEC;\nendPlaneEC.xyz =  czm_normal * vec3(0.0, startEndNormals2D.zw);\nendPlaneEC.w = -dot(endPlaneEC.xyz, ecEnd);\nv_texcoordNormalizationAndStartEcYZ.x = abs(texcoordNormalization2D.x);\nv_texcoordNormalizationAndStartEcYZ.y = texcoordNormalization2D.y;\n#else // COLUMBUS_VIEW_2D\nvec3 ecStart = (czm_modelViewRelativeToEye * czm_translateRelativeToEye(startHiAndForwardOffsetX.xyz, startLoAndForwardOffsetY.xyz)).xyz;\nvec3 offset = czm_normal * vec3(startHiAndForwardOffsetX.w, startLoAndForwardOffsetY.w, startNormalAndForwardOffsetZ.w);\nvec3 ecEnd = ecStart + offset;\nvec3 forwardDirectionEC = normalize(offset);\nvec4 startPlaneEC;\nstartPlaneEC.xyz = czm_normal * startNormalAndForwardOffsetZ.xyz;\nstartPlaneEC.w = -dot(startPlaneEC.xyz, ecStart);\nvec4 endPlaneEC;\nendPlaneEC.xyz = czm_normal * endNormalAndTextureCoordinateNormalizationX.xyz;\nendPlaneEC.w = -dot(endPlaneEC.xyz, ecEnd);\nv_rightPlaneEC.xyz = czm_normal * rightNormalAndTextureCoordinateNormalizationY.xyz;\nv_rightPlaneEC.w = -dot(v_rightPlaneEC.xyz, ecStart);\nv_texcoordNormalizationAndStartEcYZ.x = abs(endNormalAndTextureCoordinateNormalizationX.w);\nv_texcoordNormalizationAndStartEcYZ.y = rightNormalAndTextureCoordinateNormalizationY.w;\n#endif // COLUMBUS_VIEW_2D\nv_endEcAndStartEcX.xyz = ecEnd;\nv_endEcAndStartEcX.w = ecStart.x;\nv_texcoordNormalizationAndStartEcYZ.zw = ecStart.yz;\n#ifdef PER_INSTANCE_COLOR\nv_color = czm_batchTable_color(batchId);\n#endif // PER_INSTANCE_COLOR\nvec4 positionRelativeToEye = czm_computePosition();\nvec4 positionEC = czm_modelViewRelativeToEye * positionRelativeToEye;\nfloat absStartPlaneDistance = abs(czm_planeDistance(startPlaneEC, positionEC.xyz));\nfloat absEndPlaneDistance = abs(czm_planeDistance(endPlaneEC, positionEC.xyz));\nvec3 planeDirection = czm_branchFreeTernary(absStartPlaneDistance < absEndPlaneDistance, startPlaneEC.xyz, endPlaneEC.xyz);\nvec3 upOrDown = normalize(cross(v_rightPlaneEC.xyz, planeDirection));\nvec3 normalEC = normalize(cross(planeDirection, upOrDown));\nupOrDown = cross(forwardDirectionEC, normalEC);\nupOrDown = float(czm_sceneMode == czm_sceneMode3D) * upOrDown;\nupOrDown = float(v_texcoordNormalizationAndStartEcYZ.y > 1.0 || v_texcoordNormalizationAndStartEcYZ.y < 0.0) * upOrDown;\nupOrDown = min(GLOBE_MINIMUM_ALTITUDE, czm_geometricToleranceOverMeter * length(positionRelativeToEye.xyz)) * upOrDown;\npositionEC.xyz += upOrDown;\nv_texcoordNormalizationAndStartEcYZ.y = czm_branchFreeTernary(v_texcoordNormalizationAndStartEcYZ.y > 1.0, 0.0, abs(v_texcoordNormalizationAndStartEcYZ.y));\nfloat width = czm_batchTable_width(batchId);\n#ifdef WIDTH_VARYING\nv_width = width;\n#endif\nv_startPlaneNormalEcAndHalfWidth.xyz = startPlaneEC.xyz;\nv_startPlaneNormalEcAndHalfWidth.w = width * 0.5;\nv_endPlaneNormalEcAndBatchId.xyz = endPlaneEC.xyz;\nv_endPlaneNormalEcAndBatchId.w = batchId;\nwidth = width * max(0.0, czm_metersPerPixel(positionEC));\nwidth = width / dot(normalEC, v_rightPlaneEC.xyz);\n#ifdef COLUMBUS_VIEW_2D\nnormalEC *= sign(texcoordNormalization2D.x);\n#else\nnormalEC *= sign(endNormalAndTextureCoordinateNormalizationX.w);\n#endif\npositionEC.xyz += width * normalEC;\ngl_Position = czm_depthClampFarPlane(czm_projection * positionEC);\n#ifdef ANGLE_VARYING\nvec2 approxLineDirection = normalize(vec2(forwardDirectionEC.x, -forwardDirectionEC.y));\napproxLineDirection.y = czm_branchFreeTernary(approxLineDirection.x == 0.0 && approxLineDirection.y == 0.0, -1.0, approxLineDirection.y);\nv_polylineAngle = czm_fastApproximateAtan(approxLineDirection.x, approxLineDirection.y);\n#endif\n}\n",gB="#ifdef GL_EXT_frag_depth\n#extension GL_EXT_frag_depth : enable\n#endif\nvarying vec4 v_startPlaneNormalEcAndHalfWidth;\nvarying vec4 v_endPlaneNormalEcAndBatchId;\nvarying vec4 v_rightPlaneEC;\nvarying vec4 v_endEcAndStartEcX;\nvarying vec4 v_texcoordNormalizationAndStartEcYZ;\n#ifdef PER_INSTANCE_COLOR\nvarying vec4 v_color;\n#endif\nvoid main(void)\n{\nfloat logDepthOrDepth = czm_branchFreeTernary(czm_sceneMode == czm_sceneMode2D, gl_FragCoord.z, czm_unpackDepth(texture2D(czm_globeDepthTexture, gl_FragCoord.xy / czm_viewport.zw)));\nvec3 ecStart = vec3(v_endEcAndStartEcX.w, v_texcoordNormalizationAndStartEcYZ.zw);\nif (logDepthOrDepth == 0.0) {\n#ifdef DEBUG_SHOW_VOLUME\ngl_FragColor = vec4(1.0, 0.0, 0.0, 0.5);\nreturn;\n#else // DEBUG_SHOW_VOLUME\ndiscard;\n#endif // DEBUG_SHOW_VOLUME\n}\nvec4 eyeCoordinate = czm_windowToEyeCoordinates(gl_FragCoord.xy, logDepthOrDepth);\neyeCoordinate /= eyeCoordinate.w;\nfloat halfMaxWidth = v_startPlaneNormalEcAndHalfWidth.w * czm_metersPerPixel(eyeCoordinate);\nfloat widthwiseDistance = czm_planeDistance(v_rightPlaneEC, eyeCoordinate.xyz);\nfloat distanceFromStart = czm_planeDistance(v_startPlaneNormalEcAndHalfWidth.xyz, -dot(ecStart, v_startPlaneNormalEcAndHalfWidth.xyz), eyeCoordinate.xyz);\nfloat distanceFromEnd = czm_planeDistance(v_endPlaneNormalEcAndBatchId.xyz, -dot(v_endEcAndStartEcX.xyz, v_endPlaneNormalEcAndBatchId.xyz), eyeCoordinate.xyz);\nif (abs(widthwiseDistance) > halfMaxWidth || distanceFromStart < 0.0 || distanceFromEnd < 0.0) {\n#ifdef DEBUG_SHOW_VOLUME\ngl_FragColor = vec4(1.0, 0.0, 0.0, 0.5);\nreturn;\n#else // DEBUG_SHOW_VOLUME\ndiscard;\n#endif // DEBUG_SHOW_VOLUME\n}\nvec3 alignedPlaneNormal;\nalignedPlaneNormal = cross(v_rightPlaneEC.xyz, v_startPlaneNormalEcAndHalfWidth.xyz);\nalignedPlaneNormal = normalize(cross(alignedPlaneNormal, v_rightPlaneEC.xyz));\ndistanceFromStart = czm_planeDistance(alignedPlaneNormal, -dot(alignedPlaneNormal, ecStart), eyeCoordinate.xyz);\nalignedPlaneNormal = cross(v_rightPlaneEC.xyz, v_endPlaneNormalEcAndBatchId.xyz);\nalignedPlaneNormal = normalize(cross(alignedPlaneNormal, v_rightPlaneEC.xyz));\ndistanceFromEnd = czm_planeDistance(alignedPlaneNormal, -dot(alignedPlaneNormal, v_endEcAndStartEcX.xyz), eyeCoordinate.xyz);\n#ifdef PER_INSTANCE_COLOR\ngl_FragColor = v_color;\n#else // PER_INSTANCE_COLOR\nfloat s = clamp(distanceFromStart / (distanceFromStart + distanceFromEnd), 0.0, 1.0);\ns = (s * v_texcoordNormalizationAndStartEcYZ.x) + v_texcoordNormalizationAndStartEcYZ.y;\nfloat t = (widthwiseDistance + halfMaxWidth) / (2.0 * halfMaxWidth);\nczm_materialInput materialInput;\nmaterialInput.s = s;\nmaterialInput.st = vec2(s, t);\nmaterialInput.str = vec3(s, t, 0.0);\nczm_material material = czm_getMaterial(materialInput);\ngl_FragColor = vec4(material.diffuse + material.emission, material.alpha);\n#endif // PER_INSTANCE_COLOR\nczm_writeDepthClampedToFarPlane();\n}\n",vB="attribute vec3 position3DHigh;\nattribute vec3 position3DLow;\nattribute vec4 startHiAndForwardOffsetX;\nattribute vec4 startLoAndForwardOffsetY;\nattribute vec4 startNormalAndForwardOffsetZ;\nattribute vec4 endNormalAndTextureCoordinateNormalizationX;\nattribute vec4 rightNormalAndTextureCoordinateNormalizationY;\nattribute vec4 startHiLo2D;\nattribute vec4 offsetAndRight2D;\nattribute vec4 startEndNormals2D;\nattribute vec2 texcoordNormalization2D;\nattribute float batchId;\nvarying vec3 v_forwardDirectionEC;\nvarying vec3 v_texcoordNormalizationAndHalfWidth;\nvarying float v_batchId;\n#ifdef WIDTH_VARYING\nvarying float v_width;\n#endif\n#ifdef ANGLE_VARYING\nvarying float v_polylineAngle;\n#endif\n#ifdef PER_INSTANCE_COLOR\nvarying vec4 v_color;\n#else\nvarying vec2 v_alignedPlaneDistances;\nvarying float v_texcoordT;\n#endif\nvoid main()\n{\nv_batchId = batchId;\nvec4 posRelativeToEye2D = czm_translateRelativeToEye(vec3(0.0, startHiLo2D.xy), vec3(0.0, startHiLo2D.zw));\nvec4 posRelativeToEye3D = czm_translateRelativeToEye(startHiAndForwardOffsetX.xyz, startLoAndForwardOffsetY.xyz);\nvec4 posRelativeToEye = czm_columbusViewMorph(posRelativeToEye2D, posRelativeToEye3D, czm_morphTime);\nvec3 posEc2D = (czm_modelViewRelativeToEye * posRelativeToEye2D).xyz;\nvec3 posEc3D = (czm_modelViewRelativeToEye * posRelativeToEye3D).xyz;\nvec3 startEC = (czm_modelViewRelativeToEye * posRelativeToEye).xyz;\nvec4 startPlane2D;\nvec4 startPlane3D;\nstartPlane2D.xyz = czm_normal * vec3(0.0, startEndNormals2D.xy);\nstartPlane3D.xyz = czm_normal * startNormalAndForwardOffsetZ.xyz;\nstartPlane2D.w = -dot(startPlane2D.xyz, posEc2D);\nstartPlane3D.w = -dot(startPlane3D.xyz, posEc3D);\nvec4 rightPlane2D;\nvec4 rightPlane3D;\nrightPlane2D.xyz = czm_normal * vec3(0.0, offsetAndRight2D.zw);\nrightPlane3D.xyz = czm_normal * rightNormalAndTextureCoordinateNormalizationY.xyz;\nrightPlane2D.w = -dot(rightPlane2D.xyz, posEc2D);\nrightPlane3D.w = -dot(rightPlane3D.xyz, posEc3D);\nposRelativeToEye2D = posRelativeToEye2D + vec4(0.0, offsetAndRight2D.xy, 0.0);\nposRelativeToEye3D = posRelativeToEye3D + vec4(startHiAndForwardOffsetX.w, startLoAndForwardOffsetY.w, startNormalAndForwardOffsetZ.w, 0.0);\nposRelativeToEye = czm_columbusViewMorph(posRelativeToEye2D, posRelativeToEye3D, czm_morphTime);\nposEc2D = (czm_modelViewRelativeToEye * posRelativeToEye2D).xyz;\nposEc3D = (czm_modelViewRelativeToEye * posRelativeToEye3D).xyz;\nvec3 endEC = (czm_modelViewRelativeToEye * posRelativeToEye).xyz;\nvec3 forwardEc3D = czm_normal * normalize(vec3(startHiAndForwardOffsetX.w, startLoAndForwardOffsetY.w, startNormalAndForwardOffsetZ.w));\nvec3 forwardEc2D = czm_normal * normalize(vec3(0.0, offsetAndRight2D.xy));\nvec4 endPlane2D;\nvec4 endPlane3D;\nendPlane2D.xyz = czm_normal * vec3(0.0, startEndNormals2D.zw);\nendPlane3D.xyz = czm_normal * endNormalAndTextureCoordinateNormalizationX.xyz;\nendPlane2D.w = -dot(endPlane2D.xyz, posEc2D);\nendPlane3D.w = -dot(endPlane3D.xyz, posEc3D);\nv_forwardDirectionEC = normalize(endEC - startEC);\nvec2 cleanTexcoordNormalization2D;\ncleanTexcoordNormalization2D.x = abs(texcoordNormalization2D.x);\ncleanTexcoordNormalization2D.y = czm_branchFreeTernary(texcoordNormalization2D.y > 1.0, 0.0, abs(texcoordNormalization2D.y));\nvec2 cleanTexcoordNormalization3D;\ncleanTexcoordNormalization3D.x = abs(endNormalAndTextureCoordinateNormalizationX.w);\ncleanTexcoordNormalization3D.y = rightNormalAndTextureCoordinateNormalizationY.w;\ncleanTexcoordNormalization3D.y = czm_branchFreeTernary(cleanTexcoordNormalization3D.y > 1.0, 0.0, abs(cleanTexcoordNormalization3D.y));\nv_texcoordNormalizationAndHalfWidth.xy = mix(cleanTexcoordNormalization2D, cleanTexcoordNormalization3D, czm_morphTime);\n#ifdef PER_INSTANCE_COLOR\nv_color = czm_batchTable_color(batchId);\n#else // PER_INSTANCE_COLOR\nv_alignedPlaneDistances.x = -dot(v_forwardDirectionEC, startEC);\nv_alignedPlaneDistances.y = -dot(-v_forwardDirectionEC, endEC);\n#endif // PER_INSTANCE_COLOR\n#ifdef WIDTH_VARYING\nfloat width = czm_batchTable_width(batchId);\nfloat halfWidth = width * 0.5;\nv_width = width;\nv_texcoordNormalizationAndHalfWidth.z = halfWidth;\n#else\nfloat halfWidth = 0.5 * czm_batchTable_width(batchId);\nv_texcoordNormalizationAndHalfWidth.z = halfWidth;\n#endif\nvec4 positionEc3D = czm_modelViewRelativeToEye * czm_translateRelativeToEye(position3DHigh, position3DLow);\nfloat absStartPlaneDistance = abs(czm_planeDistance(startPlane3D, positionEc3D.xyz));\nfloat absEndPlaneDistance = abs(czm_planeDistance(endPlane3D, positionEc3D.xyz));\nvec3 planeDirection = czm_branchFreeTernary(absStartPlaneDistance < absEndPlaneDistance, startPlane3D.xyz, endPlane3D.xyz);\nvec3 upOrDown = normalize(cross(rightPlane3D.xyz, planeDirection));\nvec3 normalEC = normalize(cross(planeDirection, upOrDown));\nvec3 geodeticSurfaceNormal = normalize(cross(normalEC, forwardEc3D));\ngeodeticSurfaceNormal *= float(0.0 <= rightNormalAndTextureCoordinateNormalizationY.w && rightNormalAndTextureCoordinateNormalizationY.w <= 1.0);\ngeodeticSurfaceNormal *= MAX_TERRAIN_HEIGHT;\npositionEc3D.xyz += geodeticSurfaceNormal;\nnormalEC *= sign(endNormalAndTextureCoordinateNormalizationX.w);\npositionEc3D.xyz += halfWidth * max(0.0, czm_metersPerPixel(positionEc3D)) * normalEC;\nvec4 positionEc2D = czm_modelViewRelativeToEye * czm_translateRelativeToEye(position2DHigh.zxy, position2DLow.zxy);\nabsStartPlaneDistance = abs(czm_planeDistance(startPlane2D, positionEc2D.xyz));\nabsEndPlaneDistance = abs(czm_planeDistance(endPlane2D, positionEc2D.xyz));\nplaneDirection = czm_branchFreeTernary(absStartPlaneDistance < absEndPlaneDistance, startPlane2D.xyz, endPlane2D.xyz);\nupOrDown = normalize(cross(rightPlane2D.xyz, planeDirection));\nnormalEC = normalize(cross(planeDirection, upOrDown));\ngeodeticSurfaceNormal = normalize(cross(normalEC, forwardEc2D));\ngeodeticSurfaceNormal *= float(0.0 <= texcoordNormalization2D.y && texcoordNormalization2D.y <= 1.0);\ngeodeticSurfaceNormal *= MAX_TERRAIN_HEIGHT;\npositionEc2D.xyz += geodeticSurfaceNormal;\nnormalEC *= sign(texcoordNormalization2D.x);\n#ifndef PER_INSTANCE_COLOR\nv_texcoordT = clamp(sign(texcoordNormalization2D.x), 0.0, 1.0);\n#endif\npositionEc2D.xyz += halfWidth * max(0.0, czm_metersPerPixel(positionEc2D)) * normalEC;\ngl_Position = czm_projection * mix(positionEc2D, positionEc3D, czm_morphTime);\n#ifdef ANGLE_VARYING\nvec2 approxLineDirection = normalize(vec2(v_forwardDirectionEC.x, -v_forwardDirectionEC.y));\napproxLineDirection.y = czm_branchFreeTernary(approxLineDirection.x == 0.0 && approxLineDirection.y == 0.0, -1.0, approxLineDirection.y);\nv_polylineAngle = czm_fastApproximateAtan(approxLineDirection.x, approxLineDirection.y);\n#endif\n}\n",bB="varying vec3 v_forwardDirectionEC;\nvarying vec3 v_texcoordNormalizationAndHalfWidth;\nvarying float v_batchId;\n#ifdef PER_INSTANCE_COLOR\nvarying vec4 v_color;\n#else\nvarying vec2 v_alignedPlaneDistances;\nvarying float v_texcoordT;\n#endif\nfloat rayPlaneDistanceUnsafe(vec3 origin, vec3 direction, vec3 planeNormal, float planeDistance) {\nreturn (-planeDistance - dot(planeNormal, origin)) / dot(planeNormal, direction);\n}\nvoid main(void)\n{\nvec4 eyeCoordinate = gl_FragCoord;\neyeCoordinate /= eyeCoordinate.w;\n#ifdef PER_INSTANCE_COLOR\ngl_FragColor = v_color;\n#else // PER_INSTANCE_COLOR\nfloat distanceFromStart = rayPlaneDistanceUnsafe(eyeCoordinate.xyz, -v_forwardDirectionEC, v_forwardDirectionEC.xyz, v_alignedPlaneDistances.x);\nfloat distanceFromEnd = rayPlaneDistanceUnsafe(eyeCoordinate.xyz, v_forwardDirectionEC, -v_forwardDirectionEC.xyz, v_alignedPlaneDistances.y);\ndistanceFromStart = max(0.0, distanceFromStart);\ndistanceFromEnd = max(0.0, distanceFromEnd);\nfloat s = distanceFromStart / (distanceFromStart + distanceFromEnd);\ns = (s * v_texcoordNormalizationAndHalfWidth.x) + v_texcoordNormalizationAndHalfWidth.y;\nczm_materialInput materialInput;\nmaterialInput.s = s;\nmaterialInput.st = vec2(s, v_texcoordT);\nmaterialInput.str = vec3(s, v_texcoordT, 0.0);\nczm_material material = czm_getMaterial(materialInput);\ngl_FragColor = vec4(material.diffuse + material.emission, material.alpha);\n#endif // PER_INSTANCE_COLOR\n}\n",yB="attribute vec3 position3DHigh;\nattribute vec3 position3DLow;\nattribute vec3 prevPosition3DHigh;\nattribute vec3 prevPosition3DLow;\nattribute vec3 nextPosition3DHigh;\nattribute vec3 nextPosition3DLow;\nattribute vec2 expandAndWidth;\nattribute vec4 color;\nattribute float batchId;\nvarying vec4 v_color;\nvoid main()\n{\nfloat expandDir = expandAndWidth.x;\nfloat width = abs(expandAndWidth.y) + 0.5;\nbool usePrev = expandAndWidth.y < 0.0;\nvec4 p = czm_computePosition();\nvec4 prev = czm_computePrevPosition();\nvec4 next = czm_computeNextPosition();\nv_color = color;\nfloat angle;\nvec4 positionWC = getPolylineWindowCoordinates(p, prev, next, expandDir, width, usePrev, angle);\ngl_Position = czm_viewportOrthographic * positionWC;\n#ifdef LOG_DEPTH\nczm_vertexLogDepth(czm_modelViewProjectionRelativeToEye * p);\n#endif\n}\n",wB="void clipLineSegmentToNearPlane(\nvec3 p0,\nvec3 p1,\nout vec4 positionWC,\nout bool clipped,\nout bool culledByNearPlane)\n{\nculledByNearPlane = false;\nclipped = false;\nvec3 p1ToP0 = p1 - p0;\nfloat magnitude = length(p1ToP0);\nvec3 direction = normalize(p1ToP0);\nfloat endPoint0Distance =  -(czm_currentFrustum.x + p0.z);\nfloat denominator = -direction.z;\nif (endPoint0Distance < 0.0 && abs(denominator) < czm_epsilon7)\n{\nculledByNearPlane = true;\n}\nelse if (endPoint0Distance < 0.0 && abs(denominator) > czm_epsilon7)\n{\nfloat t = (czm_currentFrustum.x + p0.z) / denominator;\nif (t < 0.0 || t > magnitude)\n{\nculledByNearPlane = true;\n}\nelse\n{\np0 = p0 + t * direction;\nclipped = true;\n}\n}\npositionWC = czm_eyeToWindowCoordinates(vec4(p0, 1.0));\n}\nvec4 getPolylineWindowCoordinatesEC(vec4 positionEC, vec4 prevEC, vec4 nextEC, float expandDirection, float width, bool usePrevious, out float angle)\n{\nvec4 endPointWC, p0, p1;\nbool culledByNearPlane, clipped;\n#ifdef POLYLINE_DASH\nvec4 positionWindow = czm_eyeToWindowCoordinates(positionEC);\nvec4 previousWindow = czm_eyeToWindowCoordinates(prevEC);\nvec4 nextWindow = czm_eyeToWindowCoordinates(nextEC);\nvec2 lineDir;\nif (usePrevious) {\nlineDir = normalize(positionWindow.xy - previousWindow.xy);\n}\nelse {\nlineDir = normalize(nextWindow.xy - positionWindow.xy);\n}\nangle = atan(lineDir.x, lineDir.y) - 1.570796327;\nangle = floor(angle / czm_piOverFour + 0.5) * czm_piOverFour;\n#endif\nclipLineSegmentToNearPlane(prevEC.xyz, positionEC.xyz, p0, clipped, culledByNearPlane);\nclipLineSegmentToNearPlane(nextEC.xyz, positionEC.xyz, p1, clipped, culledByNearPlane);\nclipLineSegmentToNearPlane(positionEC.xyz, usePrevious ? prevEC.xyz : nextEC.xyz, endPointWC, clipped, culledByNearPlane);\nif (culledByNearPlane)\n{\nreturn vec4(0.0, 0.0, 0.0, 1.0);\n}\nvec2 prevWC = normalize(p0.xy - endPointWC.xy);\nvec2 nextWC = normalize(p1.xy - endPointWC.xy);\nfloat expandWidth = width * 0.5;\nvec2 direction;\n#ifdef CLIP_POLYLINE\nif (clipped)\n{\nif (prevEC.z - positionEC.z < 0.0)\n{\ndirection = vec2(prevWC.y, -prevWC.x);\n}\nelse\n{\ndirection = vec2(-prevWC.y, prevWC.x);\n}\n}\nelse\n#endif\nif (czm_equalsEpsilon(prevEC.xyz - positionEC.xyz, vec3(0.0), czm_epsilon1) || czm_equalsEpsilon(prevWC, -nextWC, czm_epsilon1))\n{\ndirection = vec2(-nextWC.y, nextWC.x);\n}\nelse if (czm_equalsEpsilon(nextEC.xyz - positionEC.xyz, vec3(0.0), czm_epsilon1))\n{\ndirection = vec2(prevWC.y, -prevWC.x);\n}\nelse\n{\nvec2 normal = vec2(-nextWC.y, nextWC.x);\ndirection = normalize((nextWC + prevWC) * 0.5);\nif (dot(direction, normal) < 0.0)\n{\ndirection = -direction;\n}\nfloat sinAngle = abs(direction.x * nextWC.y - direction.y * nextWC.x);\nexpandWidth = clamp(expandWidth / sinAngle, 0.0, width * 2.0);\n}\nvec2 offset = direction * expandDirection * expandWidth * czm_resolutionScale;\nreturn vec4(endPointWC.xy + offset, -endPointWC.z, 1.0);\n}\nvec4 getPolylineWindowCoordinates(vec4 position, vec4 previous, vec4 next, float expandDirection, float width, bool usePrevious, out float angle)\n{\nvec4 positionEC = czm_modelViewRelativeToEye * position;\nvec4 prevEC = czm_modelViewRelativeToEye * previous;\nvec4 nextEC = czm_modelViewRelativeToEye * next;\nreturn getPolylineWindowCoordinatesEC(positionEC, prevEC, nextEC, expandDirection, width, usePrevious, angle);\n}\n",OB=wB+"\n"+yB,xB=Qj;function EB(e){e=Object(w.a)(e,w.a.EMPTY_OBJECT);var t=Object(w.a)(e.translucent,!0),i=EB.VERTEX_FORMAT;this.material=void 0,this.translucent=t,this._vertexShaderSource=Object(w.a)(e.vertexShaderSource,OB),this._fragmentShaderSource=Object(w.a)(e.fragmentShaderSource,xB),this._renderState=UD.getDefaultRenderState(t,!1,e.renderState),this._closed=!1,this._vertexFormat=i}Ri.isInternetExplorer()||(OB="#define CLIP_POLYLINE \n"+OB),Object(O.a)(EB.prototype,{vertexShaderSource:{get:function(){return this._vertexShaderSource}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},renderState:{get:function(){return this._renderState}},closed:{get:function(){return this._closed}},vertexFormat:{get:function(){return this._vertexFormat}}}),EB.VERTEX_FORMAT=Ba.POSITION_ONLY,EB.prototype.getFragmentShaderSource=UD.prototype.getFragmentShaderSource,EB.prototype.isTranslucent=UD.prototype.isTranslucent,EB.prototype.getRenderState=UD.prototype.getRenderState;var TB=EB,CB="attribute vec3 position3DHigh;\nattribute vec3 position3DLow;\nattribute vec3 prevPosition3DHigh;\nattribute vec3 prevPosition3DLow;\nattribute vec3 nextPosition3DHigh;\nattribute vec3 nextPosition3DLow;\nattribute vec2 expandAndWidth;\nattribute vec2 st;\nattribute float batchId;\nvarying float v_width;\nvarying vec2 v_st;\nvarying float v_polylineAngle;\nvoid main()\n{\nfloat expandDir = expandAndWidth.x;\nfloat width = abs(expandAndWidth.y) + 0.5;\nbool usePrev = expandAndWidth.y < 0.0;\nvec4 p = czm_computePosition();\nvec4 prev = czm_computePrevPosition();\nvec4 next = czm_computeNextPosition();\nv_width = width;\nv_st = st;\nvec4 positionWC = getPolylineWindowCoordinates(p, prev, next, expandDir, width, usePrev, v_polylineAngle);\ngl_Position = czm_viewportOrthographic * positionWC;\n#ifdef LOG_DEPTH\nczm_vertexLogDepth(czm_modelViewProjectionRelativeToEye * p);\n#endif\n}\n",SB="#ifdef VECTOR_TILE\nuniform vec4 u_highlightColor;\n#endif\nvarying vec2 v_st;\nvoid main()\n{\nczm_materialInput materialInput;\nmaterialInput.s = v_st.s;\nmaterialInput.st = v_st;\nmaterialInput.str = vec3(v_st, 0.0);\nczm_material material = czm_getMaterial(materialInput);\ngl_FragColor = vec4(material.diffuse + material.emission, material.alpha);\n#ifdef VECTOR_TILE\ngl_FragColor *= u_highlightColor;\n#endif\nczm_writeLogDepth();\n}\n",AB=wB+"\n"+CB,PB=SB;function IB(e){e=Object(w.a)(e,w.a.EMPTY_OBJECT);var t=Object(w.a)(e.translucent,!0),i=IB.VERTEX_FORMAT;this.material=Object(u.a)(e.material)?e.material:qj.fromType(qj.ColorType),this.translucent=t,this._vertexShaderSource=Object(w.a)(e.vertexShaderSource,AB),this._fragmentShaderSource=Object(w.a)(e.fragmentShaderSource,PB),this._renderState=UD.getDefaultRenderState(t,!1,e.renderState),this._closed=!1,this._vertexFormat=i}Ri.isInternetExplorer()||(AB="#define CLIP_POLYLINE \n"+AB),Object(O.a)(IB.prototype,{vertexShaderSource:{get:function(){var e=this._vertexShaderSource;return-1!==this.material.shaderSource.search(/varying\s+float\s+v_polylineAngle;/g)&&(e="#define POLYLINE_DASH\n"+e),e}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},renderState:{get:function(){return this._renderState}},closed:{get:function(){return this._closed}},vertexFormat:{get:function(){return this._vertexFormat}}}),IB.VERTEX_FORMAT=Ba.POSITION_AND_ST,IB.prototype.getFragmentShaderSource=UD.prototype.getFragmentShaderSource,IB.prototype.isTranslucent=UD.prototype.isTranslucent,IB.prototype.getRenderState=UD.prototype.getRenderState;var DB=IB;function jB(e){e=Object(w.a)(e,w.a.EMPTY_OBJECT),this.geometryInstances=e.geometryInstances,this._hasPerInstanceColors=!0;var t=e.appearance;Object(u.a)(t)||(t=new DB),this.appearance=t,this.show=Object(w.a)(e.show,!0),this.classificationType=Object(w.a)(e.classificationType,iM.BOTH),this.debugShowBoundingVolume=Object(w.a)(e.debugShowBoundingVolume,!1),this._debugShowShadowVolume=Object(w.a)(e.debugShowShadowVolume,!1),this._primitiveOptions={geometryInstances:void 0,appearance:void 0,vertexCacheOptimize:!1,interleave:Object(w.a)(e.interleave,!1),releaseGeometryInstances:Object(w.a)(e.releaseGeometryInstances,!0),allowPicking:Object(w.a)(e.allowPicking,!0),asynchronous:Object(w.a)(e.asynchronous,!0),compressVertices:!1,_createShaderProgramFunction:void 0,_createCommandsFunction:void 0,_updateAndQueueCommandsFunction:void 0},this._zIndex=void 0,this._ready=!1,this._readyPromise=Oi.a.defer(),this._primitive=void 0,this._sp=void 0,this._sp2D=void 0,this._spMorph=void 0,this._renderState=MB(!1),this._renderState3DTiles=MB(!0),this._renderStateMorph=RM.fromCache({cull:{enabled:!0,face:BD.FRONT},depthTest:{enabled:!0},blending:FD.ALPHA_BLEND,depthMask:!1})}function MB(e){return RM.fromCache({cull:{enabled:!0},blending:FD.ALPHA_BLEND,depthMask:!1,stencilTest:{enabled:e,frontFunction:Bk.EQUAL,frontOperation:{fail:Uk.KEEP,zFail:Uk.KEEP,zPass:Uk.KEEP},backFunction:Bk.EQUAL,backOperation:{fail:Uk.KEEP,zFail:Uk.KEEP,zPass:Uk.KEEP},reference:Hk.CESIUM_3D_TILE_MASK,mask:Hk.CESIUM_3D_TILE_MASK}})}function RB(e,t,i,n,r,a,o){i.mode===xF.MORPHING?t=t.derivedCommands.colorMorph:i.mode!==xF.SCENE3D&&(t=t.derivedCommands.color2D),t.modelMatrix=n,t.boundingVolume=a,t.cull=r,t.debugShowBoundingVolume=o,i.commandList.push(t)}Object(O.a)(jB.prototype,{interleave:{get:function(){return this._primitiveOptions.interleave}},releaseGeometryInstances:{get:function(){return this._primitiveOptions.releaseGeometryInstances}},allowPicking:{get:function(){return this._primitiveOptions.allowPicking}},asynchronous:{get:function(){return this._primitiveOptions.asynchronous}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise.promise}},debugShowShadowVolume:{get:function(){return this._debugShowShadowVolume}}}),jB.initializeTerrainHeights=function(){return Xt.initialize()},jB.prototype.update=function(e){if(Object(u.a)(this._primitive)||Object(u.a)(this.geometryInstances))if(Xt.initialized){var t,i=this,n=this._primitiveOptions;if(!Object(u.a)(this._primitive)){var r,a=Object(ym.a)(this.geometryInstances)?this.geometryInstances:[this.geometryInstances],o=a.length,s=new Array(o);for(t=0;t<o;++t)if(r=a[t].attributes,!Object(u.a)(r)||!Object(u.a)(r.color)){this._hasPerInstanceColors=!1;break}for(t=0;t<o;++t){var c=a[t];r={};var l=c.attributes;for(var d in l)l.hasOwnProperty(d)&&(r[d]=l[d]);Object(u.a)(r.width)||(r.width=new iy({componentDatatype:dn.UNSIGNED_BYTE,componentsPerAttribute:1,value:[c.geometry.width]})),c.geometry._scene3DOnly=e.scene3DOnly,wO.setProjectionAndEllipsoid(c.geometry,e.mapProjection),s[t]=new Mu({geometry:c.geometry,attributes:r,id:c.id,pickPrimitive:i})}n.geometryInstances=s,n.appearance=this.appearance,n._createShaderProgramFunction=function(e,t,n){!function(e,t,i){var n=t.context,r=e._primitive,a=r._attributeLocations,o=r._batchTable.getVertexShaderCallback()(_B);o=ck._appendShowToShader(r,o),o=ck._appendDistanceDisplayConditionToShader(r,o),o=ck._modifyShaderPosition(e,o,t.scene3DOnly);var s=r._batchTable.getVertexShaderCallback()(vB);s=ck._appendShowToShader(r,s),s=ck._appendDistanceDisplayConditionToShader(r,s),s=ck._modifyShaderPosition(e,s,t.scene3DOnly);var c=r._batchTable.getVertexShaderCallback()(gB),l=["ENABLE_GL_POSITION_LOG_DEPTH_AT_HEIGHT","GLOBE_MINIMUM_ALTITUDE "+t.mapProjection.ellipsoid.minimumRadius.toFixed(1)],h="",d="";Object(u.a)(i.material)?(-1!==(d=Object(u.a)(i.material)?i.material.shaderSource:"").search(/varying\s+float\s+v_polylineAngle;/g)&&l.push("ANGLE_VARYING"),-1!==d.search(/varying\s+float\s+v_width;/g)&&l.push("WIDTH_VARYING")):h="PER_INSTANCE_COLOR",l.push(h);var f=e.debugShowShadowVolume?["DEBUG_SHOW_VOLUME",h]:[h],p=new UN({defines:l,sources:[o]}),m=new UN({defines:f,sources:[d,c]});e._sp=bR.replaceCache({context:n,shaderProgram:r._sp,vertexShaderSource:p,fragmentShaderSource:m,attributeLocations:a});var _=n.shaderCache.getDerivedShaderProgram(e._sp,"2dColor");if(!Object(u.a)(_)){var g=new UN({defines:l.concat(["COLUMBUS_VIEW_2D"]),sources:[o]});_=n.shaderCache.createDerivedShaderProgram(e._sp,"2dColor",{context:n,shaderProgram:e._sp2D,vertexShaderSource:g,fragmentShaderSource:m,attributeLocations:a})}e._sp2D=_;var v=n.shaderCache.getDerivedShaderProgram(e._sp,"MorphColor");if(!Object(u.a)(v)){var b=new UN({defines:l.concat(["MAX_TERRAIN_HEIGHT "+Xt._defaultMaxTerrainHeight.toFixed(1)]),sources:[s]});c=r._batchTable.getVertexShaderCallback()(bB);var y=new UN({defines:f,sources:[d,c]});v=n.shaderCache.createDerivedShaderProgram(e._sp,"MorphColor",{context:n,shaderProgram:e._spMorph,vertexShaderSource:b,fragmentShaderSource:y,attributeLocations:a})}e._spMorph=v}(i,t,n)},n._createCommandsFunction=function(e,t,n,r,a,o,s){!function(e,t,i,n,r,a){var o=e._primitive,s=o._va.length;r.length=s,a.length=s;for(var c=t instanceof TB?{}:i._uniforms,l=o._batchTable.getUniformMapCallback()(c),h=0;h<s;h++){var d=o._va[h],f=r[h];Object(u.a)(f)||(f=r[h]=new cM({owner:e,primitiveType:o._primitiveType})),f.vertexArray=d,f.renderState=e._renderState,f.shaderProgram=e._sp,f.uniformMap=l,f.pass=lM.TERRAIN_CLASSIFICATION,f.pickId="czm_batchTable_pickColor(v_endPlaneNormalEcAndBatchId.w)";var p=cM.shallowClone(f,f.derivedCommands.tileset);p.renderState=e._renderState3DTiles,p.pass=lM.CESIUM_3D_TILE_CLASSIFICATION,f.derivedCommands.tileset=p;var m=cM.shallowClone(f,f.derivedCommands.color2D);m.shaderProgram=e._sp2D,f.derivedCommands.color2D=m;var _=cM.shallowClone(p,p.derivedCommands.color2D);_.shaderProgram=e._sp2D,p.derivedCommands.color2D=_;var g=cM.shallowClone(f,f.derivedCommands.colorMorph);g.renderState=e._renderStateMorph,g.shaderProgram=e._spMorph,g.pickId="czm_batchTable_pickColor(v_batchId)",f.derivedCommands.colorMorph=g}}(i,t,n,0,o,s)},n._updateAndQueueCommandsFunction=function(e,t,n,r,a,o,s,c){!function(e,t,i,n,r,a,o){var s,c=e._primitive;ck._updateBoundingVolumes(c,t,r),t.mode===xF.SCENE3D?s=c._boundingSphereWC:t.mode===xF.COLUMBUS_VIEW?s=c._boundingSphereCV:t.mode===xF.SCENE2D&&Object(u.a)(c._boundingSphere2D)?s=c._boundingSphere2D:Object(u.a)(c._boundingSphereMorph)&&(s=c._boundingSphereMorph);var l=t.mode===xF.MORPHING,h=e.classificationType,d=h!==iM.CESIUM_3D_TILE,f=h!==iM.TERRAIN&&!l,p=t.passes;if(p.render||p.pick&&c.allowPicking)for(var m=i.length,_=0;_<m;++_){var g=s[_];d&&RB(0,i[_],t,r,a,g,o),f&&RB(0,i[_].derivedCommands.tileset,t,r,a,g,o)}}(i,t,n,0,a,o,s)},this._primitive=new ck(n),this._primitive.readyPromise.then((function(e){i._ready=!0,i.releaseGeometryInstances&&(i.geometryInstances=void 0);var t=e._error;Object(u.a)(t)?i._readyPromise.reject(t):i._readyPromise.resolve(i)}))}if(this.appearance instanceof TB&&!this._hasPerInstanceColors)throw new h.a("All GeometryInstances must have color attributes to use PolylineColorAppearance with GroundPolylinePrimitive.");this._primitive.appearance=this.appearance,this._primitive.show=this.show,this._primitive.debugShowBoundingVolume=this.debugShowBoundingVolume,this._primitive.update(e)}else{if(!this.asynchronous)throw new h.a("For synchronous GroundPolylinePrimitives, you must call GroundPolylinePrimitives.initializeTerrainHeights() and wait for the returned promise to resolve.");jB.initializeTerrainHeights()}},jB.prototype.getGeometryInstanceAttributes=function(e){if(!Object(u.a)(this._primitive))throw new h.a("must call update before calling getGeometryInstanceAttributes");return this._primitive.getGeometryInstanceAttributes(e)},jB.isSupported=function(e){return e.frameState.context.depthTexture},jB.prototype.isDestroyed=function(){return!1},jB.prototype.destroy=function(){return this._primitive=this._primitive&&this._primitive.destroy(),this._sp=this._sp&&this._sp.destroy(),this._sp2D=void 0,this._spMorph=void 0,rl(this)};var LB=jB,NB=new Rt(1,1),FB=uf.WHITE;function kB(e){e=Object(w.a)(e,w.a.EMPTY_OBJECT),this._definitionChanged=new $o.a,this._image=void 0,this._imageSubscription=void 0,this._repeat=void 0,this._repeatSubscription=void 0,this._color=void 0,this._colorSubscription=void 0,this._transparent=void 0,this._transparentSubscription=void 0,this.image=e.image,this.repeat=e.repeat,this.color=e.color,this.transparent=e.transparent}Object(O.a)(kB.prototype,{isConstant:{get:function(){return aD.isConstant(this._image)&&aD.isConstant(this._repeat)}},definitionChanged:{get:function(){return this._definitionChanged}},image:KI("image"),repeat:KI("repeat"),color:KI("color"),transparent:KI("transparent")}),kB.prototype.getType=function(e){return"Image"},kB.prototype.getValue=function(e,t){return Object(u.a)(t)||(t={}),t.image=aD.getValueOrUndefined(this._image,e),t.repeat=aD.getValueOrClonedDefault(this._repeat,e,NB,t.repeat),t.color=aD.getValueOrClonedDefault(this._color,e,FB,t.color),aD.getValueOrDefault(this._transparent,e,!1)&&(t.color.alpha=Math.min(.99,t.color.alpha)),t},kB.prototype.equals=function(e){return this===e||e instanceof kB&&aD.equals(this._image,e._image)&&aD.equals(this._color,e._color)&&aD.equals(this._transparent,e._transparent)&&aD.equals(this._repeat,e._repeat)};var BB=kB;function zB(e){if(e instanceof uf)return new oM(e);if("string"==typeof e||e instanceof f.a||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement){var t=new BB;return t.image=e,t}throw new h.a("Unable to infer material type: "+e)}var UB=function(e,t){return KI(e,t,zB)};function VB(e){this._heightReference=void 0,this._dimensions=void 0,this._dimensionsSubscription=void 0,this._show=void 0,this._showSubscription=void 0,this._fill=void 0,this._fillSubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._outline=void 0,this._outlineSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this._definitionChanged=new $o.a,this.merge(Object(w.a)(e,w.a.EMPTY_OBJECT))}Object(O.a)(VB.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},heightReference:KI("heightReference"),show:KI("show"),dimensions:KI("dimensions"),material:UB("material"),fill:KI("fill"),outline:KI("outline"),outlineColor:KI("outlineColor"),outlineWidth:KI("outlineWidth"),shadows:KI("shadows"),distanceDisplayCondition:KI("distanceDisplayCondition")}),VB.prototype.clone=function(e){return Object(u.a)(e)?(e.heightReference=this.heightReference,e.dimensions=this.dimensions,e.show=this.show,e.material=this.material,e.fill=this.fill,e.outline=this.outline,e.outlineColor=this.outlineColor,e.outlineWidth=this.outlineWidth,e.shadows=this.shadows,e.distanceDisplayCondition=this.distanceDisplayCondition,e):new VB(this)},VB.prototype.merge=function(e){if(!Object(u.a)(e))throw new h.a("source is required.");this.heightReference=Object(w.a)(this.heightReference,e.heightReference),this.dimensions=Object(w.a)(this.dimensions,e.dimensions),this.show=Object(w.a)(this.show,e.show),this.material=Object(w.a)(this.material,e.material),this.fill=Object(w.a)(this.fill,e.fill),this.outline=Object(w.a)(this.outline,e.outline),this.outlineColor=Object(w.a)(this.outlineColor,e.outlineColor),this.outlineWidth=Object(w.a)(this.outlineWidth,e.outlineWidth),this.shadows=Object(w.a)(this.shadows,e.shadows),this.distanceDisplayCondition=Object(w.a)(this.distanceDisplayCondition,e.distanceDisplayCondition)};var HB=VB;function GB(){h.a.throwInstantiationError()}Object(O.a)(GB.prototype,{isConstant:{get:h.a.throwInstantiationError},definitionChanged:{get:h.a.throwInstantiationError},referenceFrame:{get:h.a.throwInstantiationError}}),GB.prototype.getValue=h.a.throwInstantiationError,GB.prototype.getValueInReferenceFrame=h.a.throwInstantiationError,GB.prototype.equals=h.a.throwInstantiationError;var qB=new be;GB.convertToReferenceFrame=function(e,t,i,n,r){if(!Object(u.a)(t))return t;if(Object(u.a)(r)||(r=new z),i===n)return z.clone(t,r);var a=xa.computeIcrfToFixedMatrix(e,qB);return Object(u.a)(a)||(a=xa.computeTemeToPseudoFixedMatrix(e,qB)),i===mS.INERTIAL?be.multiplyByVector(a,t,r):i===mS.FIXED?be.multiplyByVector(be.transpose(a,qB),t,r):void 0};var WB=GB;function YB(e,t){this._definitionChanged=new $o.a,this._value=z.clone(e),this._referenceFrame=Object(w.a)(t,mS.FIXED)}Object(O.a)(YB.prototype,{isConstant:{get:function(){return!Object(u.a)(this._value)||this._referenceFrame===mS.FIXED}},definitionChanged:{get:function(){return this._definitionChanged}},referenceFrame:{get:function(){return this._referenceFrame}}}),YB.prototype.getValue=function(e,t){return this.getValueInReferenceFrame(e,mS.FIXED,t)},YB.prototype.setValue=function(e,t){var i=!1;z.equals(this._value,e)||(i=!0,this._value=z.clone(e)),Object(u.a)(t)&&this._referenceFrame!==t&&(i=!0,this._referenceFrame=t),i&&this._definitionChanged.raiseEvent(this)},YB.prototype.getValueInReferenceFrame=function(e,t,i){if(!Object(u.a)(e))throw new h.a("time is required.");if(!Object(u.a)(t))throw new h.a("referenceFrame is required.");return WB.convertToReferenceFrame(e,this._value,this._referenceFrame,t,i)},YB.prototype.equals=function(e){return this===e||e instanceof YB&&z.equals(this._value,e._value)&&this._referenceFrame===e._referenceFrame};var XB=YB;function ZB(e){this._show=void 0,this._showSubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._positions=void 0,this._positionsSubscription=void 0,this._height=void 0,this._heightSubscription=void 0,this._heightReference=void 0,this._heightReferenceSubscription=void 0,this._extrudedHeight=void 0,this._extrudedHeightSubscription=void 0,this._extrudedHeightReference=void 0,this._extrudedHeightReferenceSubscription=void 0,this._granularity=void 0,this._granularitySubscription=void 0,this._width=void 0,this._widthSubscription=void 0,this._cornerType=void 0,this._cornerTypeSubscription=void 0,this._fill=void 0,this._fillSubscription=void 0,this._outline=void 0,this._outlineSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this._classificationType=void 0,this._classificationTypeSubscription=void 0,this._zIndex=void 0,this._zIndexSubscription=void 0,this._definitionChanged=new $o.a,this.merge(Object(w.a)(e,w.a.EMPTY_OBJECT))}Object(O.a)(ZB.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:KI("show"),material:UB("material"),positions:KI("positions"),height:KI("height"),heightReference:KI("heightReference"),extrudedHeight:KI("extrudedHeight"),extrudedHeightReference:KI("extrudedHeightReference"),granularity:KI("granularity"),width:KI("width"),fill:KI("fill"),outline:KI("outline"),outlineColor:KI("outlineColor"),outlineWidth:KI("outlineWidth"),cornerType:KI("cornerType"),shadows:KI("shadows"),distanceDisplayCondition:KI("distanceDisplayCondition"),classificationType:KI("classificationType"),zIndex:KI("zIndex")}),ZB.prototype.clone=function(e){return Object(u.a)(e)?(e.show=this.show,e.material=this.material,e.positions=this.positions,e.height=this.height,e.heightReference=this.heightReference,e.extrudedHeight=this.extrudedHeight,e.extrudedHeightReference=this.extrudedHeightReference,e.granularity=this.granularity,e.width=this.width,e.fill=this.fill,e.outline=this.outline,e.outlineColor=this.outlineColor,e.outlineWidth=this.outlineWidth,e.cornerType=this.cornerType,e.shadows=this.shadows,e.distanceDisplayCondition=this.distanceDisplayCondition,e.classificationType=this.classificationType,e.zIndex=this.zIndex,e):new ZB(this)},ZB.prototype.merge=function(e){if(!Object(u.a)(e))throw new h.a("source is required.");this.show=Object(w.a)(this.show,e.show),this.material=Object(w.a)(this.material,e.material),this.positions=Object(w.a)(this.positions,e.positions),this.height=Object(w.a)(this.height,e.height),this.heightReference=Object(w.a)(this.heightReference,e.heightReference),this.extrudedHeight=Object(w.a)(this.extrudedHeight,e.extrudedHeight),this.extrudedHeightReference=Object(w.a)(this.extrudedHeightReference,e.extrudedHeightReference),this.granularity=Object(w.a)(this.granularity,e.granularity),this.width=Object(w.a)(this.width,e.width),this.fill=Object(w.a)(this.fill,e.fill),this.outline=Object(w.a)(this.outline,e.outline),this.outlineColor=Object(w.a)(this.outlineColor,e.outlineColor),this.outlineWidth=Object(w.a)(this.outlineWidth,e.outlineWidth),this.cornerType=Object(w.a)(this.cornerType,e.cornerType),this.shadows=Object(w.a)(this.shadows,e.shadows),this.distanceDisplayCondition=Object(w.a)(this.distanceDisplayCondition,e.distanceDisplayCondition),this.classificationType=Object(w.a)(this.classificationType,e.classificationType),this.zIndex=Object(w.a)(this.zIndex,e.zIndex)};var QB=ZB;function KB(e){return e}var JB=function(e,t){return KI(e,t,KB)};function $B(e){this._heightReference=void 0,this._length=void 0,this._lengthSubscription=void 0,this._topRadius=void 0,this._topRadiusSubscription=void 0,this._bottomRadius=void 0,this._bottomRadiusSubscription=void 0,this._numberOfVerticalLines=void 0,this._numberOfVerticalLinesSubscription=void 0,this._slices=void 0,this._slicesSubscription=void 0,this._show=void 0,this._showSubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._fill=void 0,this._fillSubscription=void 0,this._outline=void 0,this._outlineSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this._definitionChanged=new $o.a,this.merge(Object(w.a)(e,w.a.EMPTY_OBJECT))}Object(O.a)($B.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},heightReference:KI("heightReference"),length:KI("length"),topRadius:KI("topRadius"),bottomRadius:KI("bottomRadius"),numberOfVerticalLines:KI("numberOfVerticalLines"),slices:KI("slices"),show:KI("show"),material:UB("material"),fill:KI("fill"),outline:KI("outline"),outlineColor:KI("outlineColor"),outlineWidth:KI("outlineWidth"),shadows:KI("shadows"),distanceDisplayCondition:KI("distanceDisplayCondition")}),$B.prototype.clone=function(e){return Object(u.a)(e)?(e.heightReference=this.heightReference,e.bottomRadius=this.bottomRadius,e.length=this.length,e.topRadius=this.topRadius,e.show=this.show,e.material=this.material,e.numberOfVerticalLines=this.numberOfVerticalLines,e.slices=this.slices,e.fill=this.fill,e.outline=this.outline,e.outlineColor=this.outlineColor,e.outlineWidth=this.outlineWidth,e.shadows=this.shadows,e.distanceDisplayCondition=this.distanceDisplayCondition,e):new $B(this)},$B.prototype.merge=function(e){if(!Object(u.a)(e))throw new h.a("source is required.");this.heightReference=Object(w.a)(this.heightReference,e.heightReference),this.bottomRadius=Object(w.a)(this.bottomRadius,e.bottomRadius),this.length=Object(w.a)(this.length,e.length),this.topRadius=Object(w.a)(this.topRadius,e.topRadius),this.show=Object(w.a)(this.show,e.show),this.material=Object(w.a)(this.material,e.material),this.numberOfVerticalLines=Object(w.a)(this.numberOfVerticalLines,e.numberOfVerticalLines),this.slices=Object(w.a)(this.slices,e.slices),this.fill=Object(w.a)(this.fill,e.fill),this.outline=Object(w.a)(this.outline,e.outline),this.outlineColor=Object(w.a)(this.outlineColor,e.outlineColor),this.outlineWidth=Object(w.a)(this.outlineWidth,e.outlineWidth),this.shadows=Object(w.a)(this.shadows,e.shadows),this.distanceDisplayCondition=Object(w.a)(this.distanceDisplayCondition,e.distanceDisplayCondition)};var ez=$B;function tz(e){this._semiMajorAxis=void 0,this._semiMajorAxisSubscription=void 0,this._semiMinorAxis=void 0,this._semiMinorAxisSubscription=void 0,this._rotation=void 0,this._rotationSubscription=void 0,this._show=void 0,this._showSubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._height=void 0,this._heightSubscription=void 0,this._heightReference=void 0,this._heightReferenceSubscription=void 0,this._extrudedHeight=void 0,this._extrudedHeightSubscription=void 0,this._extrudedHeightReference=void 0,this._extrudedHeightReferenceSubscription=void 0,this._granularity=void 0,this._granularitySubscription=void 0,this._stRotation=void 0,this._stRotationSubscription=void 0,this._fill=void 0,this._fillSubscription=void 0,this._outline=void 0,this._outlineSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._numberOfVerticalLines=void 0,this._numberOfVerticalLinesSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this._classificationType=void 0,this._classificationTypeSubscription=void 0,this._zIndex=void 0,this._zIndexSubscription=void 0,this._definitionChanged=new $o.a,this.merge(Object(w.a)(e,w.a.EMPTY_OBJECT))}Object(O.a)(tz.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},semiMajorAxis:KI("semiMajorAxis"),semiMinorAxis:KI("semiMinorAxis"),rotation:KI("rotation"),show:KI("show"),material:UB("material"),height:KI("height"),heightReference:KI("heightReference"),extrudedHeight:KI("extrudedHeight"),extrudedHeightReference:KI("extrudedHeightReference"),granularity:KI("granularity"),stRotation:KI("stRotation"),fill:KI("fill"),outline:KI("outline"),outlineColor:KI("outlineColor"),outlineWidth:KI("outlineWidth"),numberOfVerticalLines:KI("numberOfVerticalLines"),shadows:KI("shadows"),distanceDisplayCondition:KI("distanceDisplayCondition"),classificationType:KI("classificationType"),zIndex:KI("zIndex")}),tz.prototype.clone=function(e){return Object(u.a)(e)?(e.rotation=this.rotation,e.semiMajorAxis=this.semiMajorAxis,e.semiMinorAxis=this.semiMinorAxis,e.show=this.show,e.material=this.material,e.height=this.height,e.heightReference=this.heightReference,e.extrudedHeight=this.extrudedHeight,e.extrudedHeightReference=this.extrudedHeightReference,e.granularity=this.granularity,e.stRotation=this.stRotation,e.fill=this.fill,e.outline=this.outline,e.outlineColor=this.outlineColor,e.outlineWidth=this.outlineWidth,e.numberOfVerticalLines=this.numberOfVerticalLines,e.shadows=this.shadows,e.distanceDisplayCondition=this.distanceDisplayCondition,e.classificationType=this.classificationType,e.zIndex=this.zIndex,e):new tz(this)},tz.prototype.merge=function(e){if(!Object(u.a)(e))throw new h.a("source is required.");this.rotation=Object(w.a)(this.rotation,e.rotation),this.semiMajorAxis=Object(w.a)(this.semiMajorAxis,e.semiMajorAxis),this.semiMinorAxis=Object(w.a)(this.semiMinorAxis,e.semiMinorAxis),this.show=Object(w.a)(this.show,e.show),this.material=Object(w.a)(this.material,e.material),this.height=Object(w.a)(this.height,e.height),this.heightReference=Object(w.a)(this.heightReference,e.heightReference),this.extrudedHeight=Object(w.a)(this.extrudedHeight,e.extrudedHeight),this.extrudedHeightReference=Object(w.a)(this.extrudedHeightReference,e.extrudedHeightReference),this.granularity=Object(w.a)(this.granularity,e.granularity),this.stRotation=Object(w.a)(this.stRotation,e.stRotation),this.fill=Object(w.a)(this.fill,e.fill),this.outline=Object(w.a)(this.outline,e.outline),this.outlineColor=Object(w.a)(this.outlineColor,e.outlineColor),this.outlineWidth=Object(w.a)(this.outlineWidth,e.outlineWidth),this.numberOfVerticalLines=Object(w.a)(this.numberOfVerticalLines,e.numberOfVerticalLines),this.shadows=Object(w.a)(this.shadows,e.shadows),this.distanceDisplayCondition=Object(w.a)(this.distanceDisplayCondition,e.distanceDisplayCondition),this.classificationType=Object(w.a)(this.classificationType,e.classificationType),this.zIndex=Object(w.a)(this.zIndex,e.zIndex)};var iz=tz;function nz(e){this._heightReference=void 0,this._show=void 0,this._showSubscription=void 0,this._radii=void 0,this._radiiSubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._stackPartitions=void 0,this._stackPartitionsSubscription=void 0,this._slicePartitions=void 0,this._slicePartitionsSubscription=void 0,this._subdivisions=void 0,this._subdivisionsSubscription=void 0,this._fill=void 0,this._fillSubscription=void 0,this._outline=void 0,this._outlineSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this._definitionChanged=new $o.a,this.merge(Object(w.a)(e,w.a.EMPTY_OBJECT))}Object(O.a)(nz.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},heightReference:KI("heightReference"),show:KI("show"),radii:KI("radii"),material:UB("material"),fill:KI("fill"),outline:KI("outline"),outlineColor:KI("outlineColor"),outlineWidth:KI("outlineWidth"),stackPartitions:KI("stackPartitions"),slicePartitions:KI("slicePartitions"),subdivisions:KI("subdivisions"),shadows:KI("shadows"),distanceDisplayCondition:KI("distanceDisplayCondition")}),nz.prototype.clone=function(e){return Object(u.a)(e)?(e.heightReference=this.heightReference,e.show=this.show,e.radii=this.radii,e.material=this.material,e.fill=this.fill,e.outline=this.outline,e.outlineColor=this.outlineColor,e.outlineWidth=this.outlineWidth,e.stackPartitions=this.stackPartitions,e.slicePartitions=this.slicePartitions,e.subdivisions=this.subdivisions,e.shadows=this.shadows,e.distanceDisplayCondition=this.distanceDisplayCondition,e):new nz(this)},nz.prototype.merge=function(e){if(!Object(u.a)(e))throw new h.a("source is required.");this.heightReference=Object(w.a)(this.heightReference,e.heightReference),this.show=Object(w.a)(this.show,e.show),this.radii=Object(w.a)(this.radii,e.radii),this.material=Object(w.a)(this.material,e.material),this.fill=Object(w.a)(this.fill,e.fill),this.outline=Object(w.a)(this.outline,e.outline),this.outlineColor=Object(w.a)(this.outlineColor,e.outlineColor),this.outlineWidth=Object(w.a)(this.outlineWidth,e.outlineWidth),this.stackPartitions=Object(w.a)(this.stackPartitions,e.stackPartitions),this.slicePartitions=Object(w.a)(this.slicePartitions,e.slicePartitions),this.subdivisions=Object(w.a)(this.subdivisions,e.subdivisions),this.shadows=Object(w.a)(this.shadows,e.shadows),this.distanceDisplayCondition=Object(w.a)(this.distanceDisplayCondition,e.distanceDisplayCondition)};var rz=nz;function az(e){this._text=void 0,this._textSubscription=void 0,this._font=void 0,this._fontSubscription=void 0,this._style=void 0,this._styleSubscription=void 0,this._fillColor=void 0,this._fillColorSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._horizontalOrigin=void 0,this._horizontalOriginSubscription=void 0,this._verticalOrigin=void 0,this._verticalOriginSubscription=void 0,this._eyeOffset=void 0,this._eyeOffsetSubscription=void 0,this._heightReference=void 0,this._heightReferenceSubscription=void 0,this._pixelOffset=void 0,this._pixelOffsetSubscription=void 0,this._scale=void 0,this._scaleSubscription=void 0,this._show=void 0,this._showSubscription=void 0,this._showBackground=void 0,this._showBackgroundSubscription=void 0,this._backgroundColor=void 0,this._backgroundColorSubscription=void 0,this._backgroundPadding=void 0,this._backgroundPaddingSubscription=void 0,this._translucencyByDistance=void 0,this._translucencyByDistanceSubscription=void 0,this._pixelOffsetScaleByDistance=void 0,this._pixelOffsetScaleByDistanceSubscription=void 0,this._scaleByDistance=void 0,this._scaleByDistanceSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this._disableDepthTestDistance=void 0,this._disableDepthTestDistanceSubscription=void 0,this._definitionChanged=new $o.a,this.merge(Object(w.a)(e,w.a.EMPTY_OBJECT))}Object(O.a)(az.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},text:KI("text"),font:KI("font"),style:KI("style"),fillColor:KI("fillColor"),outlineColor:KI("outlineColor"),outlineWidth:KI("outlineWidth"),horizontalOrigin:KI("horizontalOrigin"),verticalOrigin:KI("verticalOrigin"),eyeOffset:KI("eyeOffset"),heightReference:KI("heightReference"),pixelOffset:KI("pixelOffset"),scale:KI("scale"),show:KI("show"),showBackground:KI("showBackground"),backgroundColor:KI("backgroundColor"),backgroundPadding:KI("backgroundPadding"),translucencyByDistance:KI("translucencyByDistance"),pixelOffsetScaleByDistance:KI("pixelOffsetScaleByDistance"),scaleByDistance:KI("scaleByDistance"),distanceDisplayCondition:KI("distanceDisplayCondition"),disableDepthTestDistance:KI("disableDepthTestDistance")}),az.prototype.clone=function(e){return Object(u.a)(e)?(e.text=this.text,e.font=this.font,e.show=this.show,e.style=this.style,e.fillColor=this.fillColor,e.outlineColor=this.outlineColor,e.outlineWidth=this.outlineWidth,e.showBackground=this.showBackground,e.backgroundColor=this.backgroundColor,e.backgroundPadding=this.backgroundPadding,e.scale=this.scale,e.horizontalOrigin=this.horizontalOrigin,e.verticalOrigin=this.verticalOrigin,e.eyeOffset=this.eyeOffset,e.heightReference=this.heightReference,e.pixelOffset=this.pixelOffset,e.translucencyByDistance=this.translucencyByDistance,e.pixelOffsetScaleByDistance=this.pixelOffsetScaleByDistance,e.scaleByDistance=this.scaleByDistance,e.distanceDisplayCondition=this.distanceDisplayCondition,e.disableDepthTestDistance=this.disableDepthTestDistance,e):new az(this)},az.prototype.merge=function(e){if(!Object(u.a)(e))throw new h.a("source is required.");this.text=Object(w.a)(this.text,e.text),this.font=Object(w.a)(this.font,e.font),this.show=Object(w.a)(this.show,e.show),this.style=Object(w.a)(this.style,e.style),this.fillColor=Object(w.a)(this.fillColor,e.fillColor),this.outlineColor=Object(w.a)(this.outlineColor,e.outlineColor),this.outlineWidth=Object(w.a)(this.outlineWidth,e.outlineWidth),this.showBackground=Object(w.a)(this.showBackground,e.showBackground),this.backgroundColor=Object(w.a)(this.backgroundColor,e.backgroundColor),this.backgroundPadding=Object(w.a)(this.backgroundPadding,e.backgroundPadding),this.scale=Object(w.a)(this.scale,e.scale),this.horizontalOrigin=Object(w.a)(this.horizontalOrigin,e.horizontalOrigin),this.verticalOrigin=Object(w.a)(this.verticalOrigin,e.verticalOrigin),this.eyeOffset=Object(w.a)(this.eyeOffset,e.eyeOffset),this.heightReference=Object(w.a)(this.heightReference,e.heightReference),this.pixelOffset=Object(w.a)(this.pixelOffset,e.pixelOffset),this.translucencyByDistance=Object(w.a)(this.translucencyByDistance,e.translucencyByDistance),this.pixelOffsetScaleByDistance=Object(w.a)(this.pixelOffsetScaleByDistance,e.pixelOffsetScaleByDistance),this.scaleByDistance=Object(w.a)(this.scaleByDistance,e.scaleByDistance),this.distanceDisplayCondition=Object(w.a)(this.distanceDisplayCondition,e.distanceDisplayCondition),this.disableDepthTestDistance=Object(w.a)(this.disableDepthTestDistance,e.disableDepthTestDistance)};var oz=az,sz=new aI,cz=function(e){e=Object(w.a)(e,w.a.EMPTY_OBJECT),this._definitionChanged=new $o.a,this._translation=void 0,this._translationSubscription=void 0,this._rotation=void 0,this._rotationSubscription=void 0,this._scale=void 0,this._scaleSubscription=void 0,this.translation=e.translation,this.rotation=e.rotation,this.scale=e.scale};Object(O.a)(cz.prototype,{isConstant:{get:function(){return aD.isConstant(this._translation)&&aD.isConstant(this._rotation)&&aD.isConstant(this._scale)}},definitionChanged:{get:function(){return this._definitionChanged}},translation:KI("translation"),rotation:KI("rotation"),scale:KI("scale")}),cz.prototype.getValue=function(e,t){return Object(u.a)(t)||(t=new aI),t.translation=aD.getValueOrClonedDefault(this._translation,e,sz.translation,t.translation),t.rotation=aD.getValueOrClonedDefault(this._rotation,e,sz.rotation,t.rotation),t.scale=aD.getValueOrClonedDefault(this._scale,e,sz.scale,t.scale),t},cz.prototype.equals=function(e){return this===e||e instanceof cz&&aD.equals(this._translation,e._translation)&&aD.equals(this._rotation,e._rotation)&&aD.equals(this._scale,e._scale)};var lz=cz,uz=function(e,t){this._propertyNames=[],this._definitionChanged=new $o.a,Object(u.a)(e)&&this.merge(e,t)};function hz(e){return new ZI(e)}Object(O.a)(uz.prototype,{propertyNames:{get:function(){return this._propertyNames}},isConstant:{get:function(){for(var e=this._propertyNames,t=0,i=e.length;t<i;t++)if(!aD.isConstant(this[e[t]]))return!1;return!0}},definitionChanged:{get:function(){return this._definitionChanged}}}),uz.prototype.hasProperty=function(e){return-1!==this._propertyNames.indexOf(e)},uz.prototype.addProperty=function(e,t,i){var n=this._propertyNames;if(!Object(u.a)(e))throw new h.a("propertyName is required.");if(-1!==n.indexOf(e))throw new h.a(e+" is already a registered property.");n.push(e),Object.defineProperty(this,e,KI(e,!0,Object(w.a)(i,hz))),Object(u.a)(t)&&(this[e]=t),this._definitionChanged.raiseEvent(this)},uz.prototype.removeProperty=function(e){var t=this._propertyNames.indexOf(e);if(!Object(u.a)(e))throw new h.a("propertyName is required.");if(-1===t)throw new h.a(e+" is not a registered property.");this._propertyNames.splice(t,1),delete this[e],this._definitionChanged.raiseEvent(this)},uz.prototype.getValue=function(e,t){if(!Object(u.a)(e))throw new h.a("time is required.");Object(u.a)(t)||(t={});for(var i=this._propertyNames,n=0,r=i.length;n<r;n++){var a=i[n];t[a]=aD.getValueOrUndefined(this[a],e,t[a])}return t},uz.prototype.merge=function(e,t){if(!Object(u.a)(e))throw new h.a("source is required.");for(var i=this._propertyNames,n=Object(u.a)(e._propertyNames)?e._propertyNames:Object.keys(e),r=0,a=n.length;r<a;r++){var o=n[r],s=this[o],c=e[o];void 0===s&&-1===i.indexOf(o)&&this.addProperty(o,void 0,t),void 0!==c&&(void 0!==s?Object(u.a)(s)&&Object(u.a)(s.merge)&&s.merge(c):Object(u.a)(c)&&Object(u.a)(c.merge)&&Object(u.a)(c.clone)?this[o]=c.clone():this[o]=c)}},uz.prototype.equals=function(e){return this===e||e instanceof uz&&function(e,t){var i=e._propertyNames,n=t._propertyNames,r=i.length;if(r!==n.length)return!1;for(var a=0;a<r;++a){var o=i[a];if(-1===n.indexOf(o))return!1;if(!aD.equals(e[o],t[o]))return!1}return!0}(this,e)};var dz=uz;function fz(e){return new lz(e)}function pz(e){this._show=void 0,this._showSubscription=void 0,this._scale=void 0,this._scaleSubscription=void 0,this._minimumPixelSize=void 0,this._minimumPixelSizeSubscription=void 0,this._maximumScale=void 0,this._maximumScaleSubscription=void 0,this._incrementallyLoadTextures=void 0,this._incrementallyLoadTexturesSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._uri=void 0,this._uriSubscription=void 0,this._runAnimations=void 0,this._clampAnimations=void 0,this._runAnimationsSubscription=void 0,this._nodeTransformations=void 0,this._nodeTransformationsSubscription=void 0,this._heightReference=void 0,this._heightReferenceSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this._silhouetteColor=void 0,this._silhouetteColorSubscription=void 0,this._silhouetteSize=void 0,this._silhouetteSizeSubscription=void 0,this._color=void 0,this._colorSubscription=void 0,this._colorBlendMode=void 0,this._colorBlendModeSubscription=void 0,this._colorBlendAmount=void 0,this._colorBlendAmountSubscription=void 0,this._clippingPlanes=void 0,this._clippingPlanesSubscription=void 0,this._imageBasedLightingFactor=void 0,this._imageBasedLightingFactorSubscription=void 0,this._lightColor=void 0,this._lightColorSubscription=void 0,this._definitionChanged=new $o.a,this.merge(Object(w.a)(e,w.a.EMPTY_OBJECT))}Object(O.a)(pz.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:KI("show"),scale:KI("scale"),minimumPixelSize:KI("minimumPixelSize"),maximumScale:KI("maximumScale"),incrementallyLoadTextures:KI("incrementallyLoadTextures"),shadows:KI("shadows"),uri:KI("uri"),runAnimations:KI("runAnimations"),clampAnimations:KI("clampAnimations"),nodeTransformations:KI("nodeTransformations",void 0,(function(e){return new dz(e,fz)})),heightReference:KI("heightReference"),distanceDisplayCondition:KI("distanceDisplayCondition"),silhouetteColor:KI("silhouetteColor"),silhouetteSize:KI("silhouetteSize"),color:KI("color"),colorBlendMode:KI("colorBlendMode"),colorBlendAmount:KI("colorBlendAmount"),clippingPlanes:KI("clippingPlanes"),imageBasedLightingFactor:KI("imageBasedLightingFactor"),lightColor:KI("lightColor")}),pz.prototype.clone=function(e){return Object(u.a)(e)?(e.show=this.show,e.scale=this.scale,e.minimumPixelSize=this.minimumPixelSize,e.maximumScale=this.maximumScale,e.incrementallyLoadTextures=this.incrementallyLoadTextures,e.shadows=this.shadows,e.uri=this.uri,e.runAnimations=this.runAnimations,e.clampAnimations=this.clampAnimations,e.nodeTransformations=this.nodeTransformations,e.heightReference=this._heightReference,e.distanceDisplayCondition=this.distanceDisplayCondition,e.silhouetteColor=this.silhouetteColor,e.silhouetteSize=this.silhouetteSize,e.color=this.color,e.colorBlendMode=this.colorBlendMode,e.colorBlendAmount=this.colorBlendAmount,e.clippingPlanes=this.clippingPlanes,e.imageBasedLightingFactor=this.imageBasedLightingFactor,e.lightColor=this.lightColor,e):new pz(this)},pz.prototype.merge=function(e){if(!Object(u.a)(e))throw new h.a("source is required.");this.show=Object(w.a)(this.show,e.show),this.scale=Object(w.a)(this.scale,e.scale),this.minimumPixelSize=Object(w.a)(this.minimumPixelSize,e.minimumPixelSize),this.maximumScale=Object(w.a)(this.maximumScale,e.maximumScale),this.incrementallyLoadTextures=Object(w.a)(this.incrementallyLoadTextures,e.incrementallyLoadTextures),this.shadows=Object(w.a)(this.shadows,e.shadows),this.uri=Object(w.a)(this.uri,e.uri),this.runAnimations=Object(w.a)(this.runAnimations,e.runAnimations),this.clampAnimations=Object(w.a)(this.clampAnimations,e.clampAnimations),this.heightReference=Object(w.a)(this.heightReference,e.heightReference),this.distanceDisplayCondition=Object(w.a)(this.distanceDisplayCondition,e.distanceDisplayCondition),this.silhouetteColor=Object(w.a)(this.silhouetteColor,e.silhouetteColor),this.silhouetteSize=Object(w.a)(this.silhouetteSize,e.silhouetteSize),this.color=Object(w.a)(this.color,e.color),this.colorBlendMode=Object(w.a)(this.colorBlendMode,e.colorBlendMode),this.colorBlendAmount=Object(w.a)(this.colorBlendAmount,e.colorBlendAmount),this.clippingPlanes=Object(w.a)(this.clippingPlanes,e.clippingPlanes),this.imageBasedLightingFactor=Object(w.a)(this.imageBasedLightingFactor,e.imageBasedLightingFactor),this.lightColor=Object(w.a)(this.lightColor,e.lightColor);var t=e.nodeTransformations;if(Object(u.a)(t)){var i=this.nodeTransformations;Object(u.a)(i)?i.merge(t):this.nodeTransformations=new dz(t,fz)}};var mz=pz;function _z(e){this._material=void 0,this._materialSubscription=void 0,this._show=void 0,this._showSubscription=void 0,this._width=void 0,this._widthSubscription=void 0,this._resolution=void 0,this._resolutionSubscription=void 0,this._leadTime=void 0,this._leadTimeSubscription=void 0,this._trailTime=void 0,this._trailTimeSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this._definitionChanged=new $o.a,this.merge(Object(w.a)(e,w.a.EMPTY_OBJECT))}Object(O.a)(_z.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:KI("show"),material:UB("material"),width:KI("width"),resolution:KI("resolution"),leadTime:KI("leadTime"),trailTime:KI("trailTime"),distanceDisplayCondition:KI("distanceDisplayCondition")}),_z.prototype.clone=function(e){return Object(u.a)(e)?(e.material=this.material,e.width=this.width,e.resolution=this.resolution,e.show=this.show,e.leadTime=this.leadTime,e.trailTime=this.trailTime,e.distanceDisplayCondition=this.distanceDisplayCondition,e):new _z(this)},_z.prototype.merge=function(e){if(!Object(u.a)(e))throw new h.a("source is required.");this.material=Object(w.a)(this.material,e.material),this.width=Object(w.a)(this.width,e.width),this.resolution=Object(w.a)(this.resolution,e.resolution),this.show=Object(w.a)(this.show,e.show),this.leadTime=Object(w.a)(this.leadTime,e.leadTime),this.trailTime=Object(w.a)(this.trailTime,e.trailTime),this.distanceDisplayCondition=Object(w.a)(this.distanceDisplayCondition,e.distanceDisplayCondition)};var gz=_z;function vz(e){this._plane=void 0,this._planeSubscription=void 0,this._dimensions=void 0,this._dimensionsSubscription=void 0,this._show=void 0,this._showSubscription=void 0,this._fill=void 0,this._fillSubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._outline=void 0,this._outlineSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this._definitionChanged=new $o.a,this.merge(Object(w.a)(e,w.a.EMPTY_OBJECT))}Object(O.a)(vz.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:KI("show"),plane:KI("plane"),dimensions:KI("dimensions"),material:UB("material"),fill:KI("fill"),outline:KI("outline"),outlineColor:KI("outlineColor"),outlineWidth:KI("outlineWidth"),shadows:KI("shadows"),distanceDisplayCondition:KI("distanceDisplayCondition")}),vz.prototype.clone=function(e){return Object(u.a)(e)?(e.plane=this.plane,e.dimensions=this.dimensions,e.show=this.show,e.material=this.material,e.fill=this.fill,e.outline=this.outline,e.outlineColor=this.outlineColor,e.outlineWidth=this.outlineWidth,e.shadows=this.shadows,e.distanceDisplayCondition=this.distanceDisplayCondition,e):new vz(this)},vz.prototype.merge=function(e){if(!Object(u.a)(e))throw new h.a("source is required.");this.plane=Object(w.a)(this.plane,e.plane),this.dimensions=Object(w.a)(this.dimensions,e.dimensions),this.show=Object(w.a)(this.show,e.show),this.material=Object(w.a)(this.material,e.material),this.fill=Object(w.a)(this.fill,e.fill),this.outline=Object(w.a)(this.outline,e.outline),this.outlineColor=Object(w.a)(this.outlineColor,e.outlineColor),this.outlineWidth=Object(w.a)(this.outlineWidth,e.outlineWidth),this.shadows=Object(w.a)(this.shadows,e.shadows),this.distanceDisplayCondition=Object(w.a)(this.distanceDisplayCondition,e.distanceDisplayCondition)};var bz=vz;function yz(e){this._color=void 0,this._colorSubscription=void 0,this._pixelSize=void 0,this._pixelSizeSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._show=void 0,this._showSubscription=void 0,this._scaleByDistance=void 0,this._scaleByDistanceSubscription=void 0,this._translucencyByDistance=void 0,this._translucencyByDistanceSubscription=void 0,this._heightReference=void 0,this._heightReferenceSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this._disableDepthTestDistance=void 0,this._disableDepthTestDistanceSubscription=void 0,this._shake=void 0,this._shakeSubscription=void 0,this._definitionChanged=new $o.a,this.merge(Object(w.a)(e,w.a.EMPTY_OBJECT))}Object(O.a)(yz.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},color:KI("color"),pixelSize:KI("pixelSize"),outlineColor:KI("outlineColor"),outlineWidth:KI("outlineWidth"),show:KI("show"),scaleByDistance:KI("scaleByDistance"),translucencyByDistance:KI("translucencyByDistance"),heightReference:KI("heightReference"),distanceDisplayCondition:KI("distanceDisplayCondition"),disableDepthTestDistance:KI("disableDepthTestDistance"),shake:KI("shake")}),yz.prototype.clone=function(e){return Object(u.a)(e)?(e.color=this.color,e.pixelSize=this.pixelSize,e.outlineColor=this.outlineColor,e.outlineWidth=this.outlineWidth,e.show=this.show,e.scaleByDistance=this.scaleByDistance,e.translucencyByDistance=this._translucencyByDistance,e.heightReference=this.heightReference,e.distanceDisplayCondition=this.distanceDisplayCondition,e.disableDepthTestDistance=this.disableDepthTestDistance,e.shake=this.shake,e):new yz(this)},yz.prototype.merge=function(e){if(!Object(u.a)(e))throw new h.a("source is required.");this.color=Object(w.a)(this.color,e.color),this.pixelSize=Object(w.a)(this.pixelSize,e.pixelSize),this.outlineColor=Object(w.a)(this.outlineColor,e.outlineColor),this.outlineWidth=Object(w.a)(this.outlineWidth,e.outlineWidth),this.show=Object(w.a)(this.show,e.show),this.scaleByDistance=Object(w.a)(this.scaleByDistance,e.scaleByDistance),this.translucencyByDistance=Object(w.a)(this._translucencyByDistance,e.translucencyByDistance),this.heightReference=Object(w.a)(this.heightReference,e.heightReference),this.distanceDisplayCondition=Object(w.a)(this.distanceDisplayCondition,e.distanceDisplayCondition),this.disableDepthTestDistance=Object(w.a)(this.disableDepthTestDistance,e.disableDepthTestDistance),this.shake=Object(w.a)(this.shake,e.shake)};var wz=yz;function Oz(e){this._show=void 0,this._showSubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._hierarchy=void 0,this._hierarchySubscription=void 0,this._height=void 0,this._heightSubscription=void 0,this._heightReference=void 0,this._heightReferenceSubscription=void 0,this._extrudedHeight=void 0,this._extrudedHeightSubscription=void 0,this._extrudedHeightReference=void 0,this._extrudedHeightReferenceSubscription=void 0,this._granularity=void 0,this._granularitySubscription=void 0,this._stRotation=void 0,this._stRotationSubscription=void 0,this._perPositionHeight=void 0,this._perPositionHeightSubscription=void 0,this._outline=void 0,this._outlineSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._fill=void 0,this._fillSubscription=void 0,this._closeTop=void 0,this._closeTopSubscription=void 0,this._closeBottom=void 0,this._closeBottomSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this._classificationType=void 0,this._classificationTypeSubscription=void 0,this._arcType=void 0,this._arcTypeSubscription=void 0,this._zIndex=void 0,this._zIndexSubscription=void 0,this._definitionChanged=new $o.a,this.merge(Object(w.a)(e,w.a.EMPTY_OBJECT))}Object(O.a)(Oz.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:KI("show"),material:UB("material"),hierarchy:KI("hierarchy"),height:KI("height"),heightReference:KI("heightReference"),extrudedHeight:KI("extrudedHeight"),extrudedHeightReference:KI("extrudedHeightReference"),granularity:KI("granularity"),stRotation:KI("stRotation"),fill:KI("fill"),outline:KI("outline"),outlineColor:KI("outlineColor"),outlineWidth:KI("outlineWidth"),perPositionHeight:KI("perPositionHeight"),closeTop:KI("closeTop"),closeBottom:KI("closeBottom"),shadows:KI("shadows"),distanceDisplayCondition:KI("distanceDisplayCondition"),classificationType:KI("classificationType"),arcType:KI("arcType"),zIndex:KI("zIndex")}),Oz.prototype.clone=function(e){return Object(u.a)(e)?(e.show=this.show,e.material=this.material,e.hierarchy=this.hierarchy,e.height=this.height,e.heightReference=this.heightReference,e.extrudedHeight=this.extrudedHeight,e.extrudedHeightReference=this.extrudedHeightReference,e.granularity=this.granularity,e.stRotation=this.stRotation,e.fill=this.fill,e.outline=this.outline,e.outlineColor=this.outlineColor,e.outlineWidth=this.outlineWidth,e.perPositionHeight=this.perPositionHeight,e.closeTop=this.closeTop,e.closeBottom=this.closeBottom,e.shadows=this.shadows,e.distanceDisplayCondition=this.distanceDisplayCondition,e.classificationType=this.classificationType,e.arcType=this.arcType,e.zIndex=this.zIndex,e):new Oz(this)},Oz.prototype.merge=function(e){if(!Object(u.a)(e))throw new h.a("source is required.");this.show=Object(w.a)(this.show,e.show),this.material=Object(w.a)(this.material,e.material),this.hierarchy=Object(w.a)(this.hierarchy,e.hierarchy),this.height=Object(w.a)(this.height,e.height),this.heightReference=Object(w.a)(this.heightReference,e.heightReference),this.extrudedHeight=Object(w.a)(this.extrudedHeight,e.extrudedHeight),this.extrudedHeightReference=Object(w.a)(this.extrudedHeightReference,e.extrudedHeightReference),this.granularity=Object(w.a)(this.granularity,e.granularity),this.stRotation=Object(w.a)(this.stRotation,e.stRotation),this.fill=Object(w.a)(this.fill,e.fill),this.outline=Object(w.a)(this.outline,e.outline),this.outlineColor=Object(w.a)(this.outlineColor,e.outlineColor),this.outlineWidth=Object(w.a)(this.outlineWidth,e.outlineWidth),this.perPositionHeight=Object(w.a)(this.perPositionHeight,e.perPositionHeight),this.closeTop=Object(w.a)(this.closeTop,e.closeTop),this.closeBottom=Object(w.a)(this.closeBottom,e.closeBottom),this.shadows=Object(w.a)(this.shadows,e.shadows),this.distanceDisplayCondition=Object(w.a)(this.distanceDisplayCondition,e.distanceDisplayCondition),this.classificationType=Object(w.a)(this.classificationType,e.classificationType),this.arcType=Object(w.a)(this.arcType,e.arcType),this.zIndex=Object(w.a)(this.zIndex,e.zIndex)};var xz=Oz;function Ez(e){this._show=void 0,this._showSubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._depthFailMaterial=void 0,this._depthFailMaterialSubscription=void 0,this._positions=void 0,this._positionsSubscription=void 0,this._followSurface=void 0,this._followSurfaceSubscription=void 0,this._arcType=void 0,this._arcTypeSubscription=void 0,this._clampToGround=void 0,this._clampToGroundSubscription=void 0,this._granularity=void 0,this._granularitySubscription=void 0,this._widthSubscription=void 0,this._width=void 0,this._widthSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this._classificationType=void 0,this._classificationTypeSubscription=void 0,this._zIndex=void 0,this._zIndexSubscription=void 0,this._definitionChanged=new $o.a,this.merge(Object(w.a)(e,w.a.EMPTY_OBJECT))}Object(O.a)(Ez.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:KI("show"),material:UB("material"),depthFailMaterial:UB("depthFailMaterial"),positions:KI("positions"),width:KI("width"),followSurface:KI("followSurface"),arcType:KI("arcType"),clampToGround:KI("clampToGround"),granularity:KI("granularity"),shadows:KI("shadows"),distanceDisplayCondition:KI("distanceDisplayCondition"),classificationType:KI("classificationType"),zIndex:KI("zIndex")}),Ez.prototype.clone=function(e){return Object(u.a)(e)?(e.show=this.show,e.material=this.material,e.depthFailMaterial=this.depthFailMaterial,e.positions=this.positions,e.width=this.width,e.followSurface=this.followSurface,e.arcType=this.arcType,e.clampToGround=this.clampToGround,e.granularity=this.granularity,e.shadows=this.shadows,e.distanceDisplayCondition=this.distanceDisplayCondition,e.classificationType=this.classificationType,e.zIndex=this.zIndex,e):new Ez(this)},Ez.prototype.merge=function(e){if(!Object(u.a)(e))throw new h.a("source is required.");this.show=Object(w.a)(this.show,e.show),this.material=Object(w.a)(this.material,e.material),this.depthFailMaterial=Object(w.a)(this.depthFailMaterial,e.depthFailMaterial),this.positions=Object(w.a)(this.positions,e.positions),this.width=Object(w.a)(this.width,e.width),this.followSurface=Object(w.a)(this.followSurface,e.followSurface),this.arcType=Object(w.a)(this.arcType,e.arcType),this.clampToGround=Object(w.a)(this.clampToGround,e.clampToGround),this.granularity=Object(w.a)(this.granularity,e.granularity),this.shadows=Object(w.a)(this.shadows,e.shadows),this.distanceDisplayCondition=Object(w.a)(this.distanceDisplayCondition,e.distanceDisplayCondition),this.classificationType=Object(w.a)(this.classificationType,e.classificationType),this.zIndex=Object(w.a)(this.zIndex,e.zIndex)};var Tz=Ez;function Cz(e){this._show=void 0,this._showSubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._positions=void 0,this._positionsSubscription=void 0,this._shape=void 0,this._shapeSubscription=void 0,this._granularity=void 0,this._granularitySubscription=void 0,this._cornerType=void 0,this._cornerTypeSubscription=void 0,this._fill=void 0,this._fillSubscription=void 0,this._outline=void 0,this._outlineSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubsription=void 0,this._definitionChanged=new $o.a,this.merge(Object(w.a)(e,w.a.EMPTY_OBJECT))}Object(O.a)(Cz.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:KI("show"),material:UB("material"),positions:KI("positions"),shape:KI("shape"),granularity:KI("granularity"),fill:KI("fill"),outline:KI("outline"),outlineColor:KI("outlineColor"),outlineWidth:KI("outlineWidth"),cornerType:KI("cornerType"),shadows:KI("shadows"),distanceDisplayCondition:KI("distanceDisplayCondition")}),Cz.prototype.clone=function(e){return Object(u.a)(e)?(e.show=this.show,e.material=this.material,e.positions=this.positions,e.shape=this.shape,e.granularity=this.granularity,e.fill=this.fill,e.outline=this.outline,e.outlineColor=this.outlineColor,e.outlineWidth=this.outlineWidth,e.cornerType=this.cornerType,e.shadows=this.shadows,e.distanceDisplayCondition=this.distanceDisplayCondition,e):new Cz(this)},Cz.prototype.merge=function(e){if(!Object(u.a)(e))throw new h.a("source is required.");this.show=Object(w.a)(this.show,e.show),this.material=Object(w.a)(this.material,e.material),this.positions=Object(w.a)(this.positions,e.positions),this.shape=Object(w.a)(this.shape,e.shape),this.granularity=Object(w.a)(this.granularity,e.granularity),this.fill=Object(w.a)(this.fill,e.fill),this.outline=Object(w.a)(this.outline,e.outline),this.outlineColor=Object(w.a)(this.outlineColor,e.outlineColor),this.outlineWidth=Object(w.a)(this.outlineWidth,e.outlineWidth),this.cornerType=Object(w.a)(this.cornerType,e.cornerType),this.shadows=Object(w.a)(this.shadows,e.shadows),this.distanceDisplayCondition=Object(w.a)(this.distanceDisplayCondition,e.distanceDisplayCondition)};var Sz=Cz;function Az(e){this._show=void 0,this._showSubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._coordinates=void 0,this._coordinatesSubscription=void 0,this._height=void 0,this._heightSubscription=void 0,this._heightReference=void 0,this._heightReferenceSubscription=void 0,this._extrudedHeight=void 0,this._extrudedHeightSubscription=void 0,this._extrudedHeightReference=void 0,this._extrudedHeightReferenceSubscription=void 0,this._granularity=void 0,this._granularitySubscription=void 0,this._stRotation=void 0,this._stRotationSubscription=void 0,this._rotation=void 0,this._rotationSubscription=void 0,this._fill=void 0,this._fillSubscription=void 0,this._outline=void 0,this._outlineSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._distanceDisplayCondition=void 0,this._distancedisplayConditionSubscription=void 0,this._classificationType=void 0,this._classificationTypeSubscription=void 0,this._zIndex=void 0,this._zIndexSubscription=void 0,this._definitionChanged=new $o.a,this.merge(Object(w.a)(e,w.a.EMPTY_OBJECT))}Object(O.a)(Az.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:KI("show"),coordinates:KI("coordinates"),material:UB("material"),height:KI("height"),heightReference:KI("heightReference"),extrudedHeight:KI("extrudedHeight"),extrudedHeightReference:KI("extrudedHeightReference"),granularity:KI("granularity"),stRotation:KI("stRotation"),rotation:KI("rotation"),fill:KI("fill"),outline:KI("outline"),outlineColor:KI("outlineColor"),outlineWidth:KI("outlineWidth"),shadows:KI("shadows"),distanceDisplayCondition:KI("distanceDisplayCondition"),classificationType:KI("classificationType"),zIndex:KI("zIndex")}),Az.prototype.clone=function(e){return Object(u.a)(e)?(e.show=this.show,e.coordinates=this.coordinates,e.material=this.material,e.height=this.height,e.heightReference=this.heightReference,e.extrudedHeight=this.extrudedHeight,e.extrudedHeightReference=this.extrudedHeightReference,e.granularity=this.granularity,e.stRotation=this.stRotation,e.rotation=this.rotation,e.fill=this.fill,e.outline=this.outline,e.outlineColor=this.outlineColor,e.outlineWidth=this.outlineWidth,e.shadows=this.shadows,e.distanceDisplayCondition=this.distanceDisplayCondition,e.classificationType=this.classificationType,e.zIndex=this.zIndex,e):new Az(this)},Az.prototype.merge=function(e){if(!Object(u.a)(e))throw new h.a("source is required.");this.show=Object(w.a)(this.show,e.show),this.coordinates=Object(w.a)(this.coordinates,e.coordinates),this.material=Object(w.a)(this.material,e.material),this.height=Object(w.a)(this.height,e.height),this.heightReference=Object(w.a)(this.heightReference,e.heightReference),this.extrudedHeight=Object(w.a)(this.extrudedHeight,e.extrudedHeight),this.extrudedHeightReference=Object(w.a)(this.extrudedHeightReference,e.extrudedHeightReference),this.granularity=Object(w.a)(this.granularity,e.granularity),this.stRotation=Object(w.a)(this.stRotation,e.stRotation),this.rotation=Object(w.a)(this.rotation,e.rotation),this.fill=Object(w.a)(this.fill,e.fill),this.outline=Object(w.a)(this.outline,e.outline),this.outlineColor=Object(w.a)(this.outlineColor,e.outlineColor),this.outlineWidth=Object(w.a)(this.outlineWidth,e.outlineWidth),this.shadows=Object(w.a)(this.shadows,e.shadows),this.distanceDisplayCondition=Object(w.a)(this.distanceDisplayCondition,e.distanceDisplayCondition),this.classificationType=Object(w.a)(this.classificationType,e.classificationType),this.zIndex=Object(w.a)(this.zIndex,e.zIndex)};var Pz=Az;function Iz(e){this._show=void 0,this._showSubscription=void 0,this._material=void 0,this._materialSubscription=void 0,this._positions=void 0,this._positionsSubscription=void 0,this._minimumHeights=void 0,this._minimumHeightsSubscription=void 0,this._maximumHeights=void 0,this._maximumHeightsSubscription=void 0,this._granularity=void 0,this._granularitySubscription=void 0,this._fill=void 0,this._fillSubscription=void 0,this._outline=void 0,this._outlineSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this._shadows=void 0,this._shadowsSubscription=void 0,this._distanceDisplayCondition=void 0,this._distanceDisplayConditionSubscription=void 0,this._definitionChanged=new $o.a,this.merge(Object(w.a)(e,w.a.EMPTY_OBJECT))}Object(O.a)(Iz.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},show:KI("show"),material:UB("material"),positions:KI("positions"),minimumHeights:KI("minimumHeights"),maximumHeights:KI("maximumHeights"),granularity:KI("granularity"),fill:KI("fill"),outline:KI("outline"),outlineColor:KI("outlineColor"),outlineWidth:KI("outlineWidth"),shadows:KI("shadows"),distanceDisplayCondition:KI("distanceDisplayCondition")}),Iz.prototype.clone=function(e){return Object(u.a)(e)?(e.show=this.show,e.material=this.material,e.positions=this.positions,e.minimumHeights=this.minimumHeights,e.maximumHeights=this.maximumHeights,e.granularity=this.granularity,e.fill=this.fill,e.outline=this.outline,e.outlineColor=this.outlineColor,e.outlineWidth=this.outlineWidth,e.shadows=this.shadows,e.distanceDisplayCondition=this.distanceDisplayCondition,e):new Iz(this)},Iz.prototype.merge=function(e){if(!Object(u.a)(e))throw new h.a("source is required.");this.show=Object(w.a)(this.show,e.show),this.material=Object(w.a)(this.material,e.material),this.positions=Object(w.a)(this.positions,e.positions),this.minimumHeights=Object(w.a)(this.minimumHeights,e.minimumHeights),this.maximumHeights=Object(w.a)(this.maximumHeights,e.maximumHeights),this.granularity=Object(w.a)(this.granularity,e.granularity),this.fill=Object(w.a)(this.fill,e.fill),this.outline=Object(w.a)(this.outline,e.outline),this.outlineColor=Object(w.a)(this.outlineColor,e.outlineColor),this.outlineWidth=Object(w.a)(this.outlineWidth,e.outlineWidth),this.shadows=Object(w.a)(this.shadows,e.shadows),this.distanceDisplayCondition=Object(w.a)(this.distanceDisplayCondition,e.distanceDisplayCondition)};var Dz=Iz,jz=new K;function Mz(e){return new XB(e)}function Rz(e,t){return KI(e,void 0,(function(e){return e instanceof t?e:new t(e)}))}function Lz(e){var t=(e=Object(w.a)(e,w.a.EMPTY_OBJECT)).id;Object(u.a)(t)||(t=Mg()),this._availability=void 0,this._id=t,this._definitionChanged=new $o.a,this._name=e.name,this._show=Object(w.a)(e.show,!0),this._parent=void 0,this._propertyNames=["billboard","box","corridor","cylinder","description","ellipse","ellipsoid","label","model","orientation","path","plane","point","polygon","polyline","polylineVolume","position","properties","rectangle","viewFrom","wall"],this._billboard=void 0,this._billboardSubscription=void 0,this._box=void 0,this._boxSubscription=void 0,this._corridor=void 0,this._corridorSubscription=void 0,this._cylinder=void 0,this._cylinderSubscription=void 0,this._description=void 0,this._descriptionSubscription=void 0,this._ellipse=void 0,this._ellipseSubscription=void 0,this._ellipsoid=void 0,this._ellipsoidSubscription=void 0,this._label=void 0,this._labelSubscription=void 0,this._model=void 0,this._modelSubscription=void 0,this._orientation=void 0,this._orientationSubscription=void 0,this._path=void 0,this._pathSubscription=void 0,this._plane=void 0,this._planeSubscription=void 0,this._point=void 0,this._pointSubscription=void 0,this._polygon=void 0,this._polygonSubscription=void 0,this._polyline=void 0,this._polylineSubscription=void 0,this._polylineVolume=void 0,this._polylineVolumeSubscription=void 0,this._position=void 0,this._positionSubscription=void 0,this._properties=void 0,this._propertiesSubscription=void 0,this._rectangle=void 0,this._rectangleSubscription=void 0,this._viewFrom=void 0,this._viewFromSubscription=void 0,this._wall=void 0,this._wallSubscription=void 0,this._children=[],this.entityCollection=void 0,this.parent=e.parent,this.merge(e)}function Nz(e,t,i){for(var n=t.length,r=0;r<n;r++){var a=t[r],o=a._show;(!i&&o)!==(i&&o)&&Nz(a,a._children,i)}e._definitionChanged.raiseEvent(e,"isShowing",i,!i)}Object(O.a)(Lz.prototype,{availability:JB("availability"),id:{get:function(){return this._id}},definitionChanged:{get:function(){return this._definitionChanged}},name:JB("name"),show:{get:function(){return this._show},set:function(e){if(!Object(u.a)(e))throw new h.a("value is required.");if(e!==this._show){var t=this.isShowing;this._show=e;var i=this.isShowing;t!==i&&Nz(this,this._children,i),this._definitionChanged.raiseEvent(this,"show",e,!e)}}},isShowing:{get:function(){return this._show&&(!Object(u.a)(this.entityCollection)||this.entityCollection.show)&&(!Object(u.a)(this._parent)||this._parent.isShowing)}},parent:{get:function(){return this._parent},set:function(e){var t=this._parent;if(t!==e){var i=this.isShowing;if(Object(u.a)(t)){var n=t._children.indexOf(this);t._children.splice(n,1)}this._parent=e,Object(u.a)(e)&&e._children.push(this);var r=this.isShowing;i!==r&&Nz(this,this._children,r),this._definitionChanged.raiseEvent(this,"parent",e,t)}}},propertyNames:{get:function(){return this._propertyNames}},billboard:Rz("billboard",$I),box:Rz("box",HB),corridor:Rz("corridor",QB),cylinder:Rz("cylinder",ez),description:KI("description"),ellipse:Rz("ellipse",iz),ellipsoid:Rz("ellipsoid",rz),label:Rz("label",oz),model:Rz("model",mz),orientation:KI("orientation"),path:Rz("path",gz),plane:Rz("plane",bz),point:Rz("point",wz),polygon:Rz("polygon",xz),polyline:Rz("polyline",Tz),polylineVolume:Rz("polylineVolume",Sz),properties:Rz("properties",dz),position:function(e){return KI(e,void 0,Mz)}("position"),rectangle:Rz("rectangle",Pz),viewFrom:KI("viewFrom"),wall:Rz("wall",Dz)}),Lz.prototype.isAvailable=function(e){if(!Object(u.a)(e))throw new h.a("time is required.");var t=this._availability;return!Object(u.a)(t)||t.contains(e)},Lz.prototype.addProperty=function(e){var t=this._propertyNames;if(!Object(u.a)(e))throw new h.a("propertyName is required.");if(-1!==t.indexOf(e))throw new h.a(e+" is already a registered property.");if(e in this)throw new h.a(e+" is a reserved property name.");t.push(e),Object.defineProperty(this,e,JB(e,!0))},Lz.prototype.removeProperty=function(e){var t=this._propertyNames.indexOf(e);if(!Object(u.a)(e))throw new h.a("propertyName is required.");if(-1===t)throw new h.a(e+" is not a registered property.");this._propertyNames.splice(t,1),delete this[e]},Lz.prototype.merge=function(e){if(!Object(u.a)(e))throw new h.a("source is required.");this.name=Object(w.a)(this.name,e.name),this.availability=Object(w.a)(e.availability,this.availability);for(var t=this._propertyNames,i=Object(u.a)(e._propertyNames)?e._propertyNames:Object.keys(e),n=i.length,r=0;r<n;r++){var a=i[r];if("parent"!==a){var o=this[a],s=e[a];Object(u.a)(o)||-1!==t.indexOf(a)||this.addProperty(a),Object(u.a)(s)&&(Object(u.a)(o)?Object(u.a)(o.merge)&&o.merge(s):Object(u.a)(s.merge)&&Object(u.a)(s.clone)?this[a]=s.clone():this[a]=s)}}};var Fz=new be,kz=new z,Bz=new Kn;Lz.prototype.computeModelMatrix=function(e,t){x.a.typeOf.object("time",e);var i=aD.getValueOrUndefined(this._position,e,kz);if(Object(u.a)(i)){var n=aD.getValueOrUndefined(this._orientation,e,Bz);return t=Object(u.a)(n)?Be.fromRotationTranslation(be.fromQuaternion(n,Fz),i,t):xa.eastNorthUpToFixedFrame(i,void 0,t)}},Lz.prototype.computeModelMatrixForHeightReference=function(e,t,i,n,r){x.a.typeOf.object("time",e);var a=aD.getValueOrDefault(t,e,eD.NONE),o=aD.getValueOrUndefined(this._position,e,kz);if(a===eD.NONE||!Object(u.a)(o)||z.equalsEpsilon(o,z.ZERO,I.EPSILON8))return this.computeModelMatrix(e,r);var s=n.cartesianToCartographic(o,jz);a===eD.CLAMP_TO_GROUND?s.height=i:s.height+=i,o=n.cartographicToCartesian(s,o);var c=aD.getValueOrUndefined(this._orientation,e,Bz);return r=Object(u.a)(c)?Be.fromRotationTranslation(be.fromQuaternion(c,Fz),o,r):xa.eastNorthUpToFixedFrame(o,void 0,r)},Lz.supportsMaterialsforEntitiesOnTerrain=function(e){return mB.supportsMaterials(e)},Lz.supportsPolylinesOnTerrain=function(e){return LB.isSupported(e)};var zz=Lz,Uz=new oM(uf.WHITE),Vz=new ZI(!0),Hz=new ZI(!0),Gz=new ZI(!1),qz=new ZI(uf.BLACK),Wz=new ZI(rM.DISABLED),Yz=new ZI(new gv),Xz=new ZI(iM.BOTH);function Zz(e){x.a.defined("options.entity",e.entity),x.a.defined("options.scene",e.scene),x.a.defined("options.geometryOptions",e.geometryOptions),x.a.defined("options.geometryPropertyName",e.geometryPropertyName),x.a.defined("options.observedPropertyNames",e.observedPropertyNames);var t=e.entity,i=e.geometryPropertyName;this._entity=t,this._scene=e.scene,this._fillEnabled=!1,this._isClosed=!1,this._onTerrain=!1,this._dynamic=!1,this._outlineEnabled=!1,this._geometryChanged=new $o.a,this._showProperty=void 0,this._materialProperty=void 0,this._showOutlineProperty=void 0,this._outlineColorProperty=void 0,this._outlineWidth=1,this._shadowsProperty=void 0,this._distanceDisplayConditionProperty=void 0,this._classificationTypeProperty=void 0,this._options=e.geometryOptions,this._geometryPropertyName=i,this._id=i+"-"+t.id,this._observedPropertyNames=e.observedPropertyNames,this._supportsMaterialsforEntitiesOnTerrain=zz.supportsMaterialsforEntitiesOnTerrain(e.scene)}Object(O.a)(Zz.prototype,{id:{get:function(){return this._id}},entity:{get:function(){return this._entity}},fillEnabled:{get:function(){return this._fillEnabled}},hasConstantFill:{get:function(){return!this._fillEnabled||!Object(u.a)(this._entity.availability)&&aD.isConstant(this._showProperty)&&aD.isConstant(this._fillProperty)}},fillMaterialProperty:{get:function(){return this._materialProperty}},outlineEnabled:{get:function(){return this._outlineEnabled}},hasConstantOutline:{get:function(){return!this._outlineEnabled||!Object(u.a)(this._entity.availability)&&aD.isConstant(this._showProperty)&&aD.isConstant(this._showOutlineProperty)}},outlineColorProperty:{get:function(){return this._outlineColorProperty}},outlineWidth:{get:function(){return this._outlineWidth}},shadowsProperty:{get:function(){return this._shadowsProperty}},distanceDisplayConditionProperty:{get:function(){return this._distanceDisplayConditionProperty}},classificationTypeProperty:{get:function(){return this._classificationTypeProperty}},isDynamic:{get:function(){return this._dynamic}},isClosed:{get:function(){return this._isClosed}},onTerrain:{get:function(){return this._onTerrain}},geometryChanged:{get:function(){return this._geometryChanged}}}),Zz.prototype.isOutlineVisible=function(e){var t=this._entity,i=this._outlineEnabled&&t.isAvailable(e)&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e);return Object(w.a)(i,!1)},Zz.prototype.isFilled=function(e){var t=this._entity,i=this._fillEnabled&&t.isAvailable(e)&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e);return Object(w.a)(i,!1)},Zz.prototype.createFillGeometryInstance=h.a.throwInstantiationError,Zz.prototype.createOutlineGeometryInstance=h.a.throwInstantiationError,Zz.prototype.isDestroyed=function(){return!1},Zz.prototype.destroy=function(){rl(this)},Zz.prototype._isHidden=function(e,t){var i=t.show;return Object(u.a)(i)&&i.isConstant&&!i.getValue(nx.MINIMUM_VALUE)},Zz.prototype._isOnTerrain=function(e,t){return!1},Zz.prototype._getIsClosed=function(e){return!0},Zz.prototype._isDynamic=h.a.throwInstantiationError,Zz.prototype._setStaticOptions=h.a.throwInstantiationError,Zz.prototype._onEntityPropertyChanged=function(e,t,i,n){if(-1!==this._observedPropertyNames.indexOf(t)){var r=this._entity[this._geometryPropertyName];if(Object(u.a)(r)){var a=r.fill,o=!Object(u.a)(a)||!a.isConstant||a.getValue(nx.MINIMUM_VALUE),s=r.outline,c=Object(u.a)(s);if(c&&s.isConstant&&(c=s.getValue(nx.MINIMUM_VALUE)),o||c){var l=r.show;if(this._isHidden(e,r))(this._fillEnabled||this._outlineEnabled)&&(this._fillEnabled=!1,this._outlineEnabled=!1,this._geometryChanged.raiseEvent(this));else{this._materialProperty=Object(w.a)(r.material,Uz),this._fillProperty=Object(w.a)(a,Hz),this._showProperty=Object(w.a)(l,Vz),this._showOutlineProperty=Object(w.a)(r.outline,Gz),this._outlineColorProperty=c?Object(w.a)(r.outlineColor,qz):void 0,this._shadowsProperty=Object(w.a)(r.shadows,Wz),this._distanceDisplayConditionProperty=Object(w.a)(r.distanceDisplayCondition,Yz),this._classificationTypeProperty=Object(w.a)(r.classificationType,Xz),this._fillEnabled=o;var h=this._isOnTerrain(e,r)&&(this._supportsMaterialsforEntitiesOnTerrain||this._materialProperty instanceof oM);if(c&&h&&(Object(iE.a)(iE.a.geometryOutlines),c=!1),this._onTerrain=h,this._outlineEnabled=c,this._isDynamic(e,r))this._dynamic||(this._dynamic=!0,this._geometryChanged.raiseEvent(this));else{this._setStaticOptions(e,r),this._isClosed=this._getIsClosed(this._options);var d=r.outlineWidth;this._outlineWidth=Object(u.a)(d)?d.getValue(nx.MINIMUM_VALUE):1,this._dynamic=!1,this._geometryChanged.raiseEvent(this)}}}else(this._fillEnabled||this._outlineEnabled)&&(this._fillEnabled=!1,this._outlineEnabled=!1,this._geometryChanged.raiseEvent(this))}else(this._fillEnabled||this._outlineEnabled)&&(this._fillEnabled=!1,this._outlineEnabled=!1,this._geometryChanged.raiseEvent(this))}},Zz.prototype.createDynamicUpdater=function(e,t){if(x.a.defined("primitives",e),x.a.defined("groundPrimitives",t),!this._dynamic)throw new h.a("This instance does not represent dynamic geometry.");return new this.constructor.DynamicGeometryUpdater(this,e,t)};var Qz=Zz,Kz=new z,Jz=new K;function $z(e,t,i,n){x.a.defined("scene",e),x.a.defined("positionProperty",t),this._scene=e,this._heightReference=i,this._extrudedHeightReference=n,this._positionProperty=t,this._position=new z,this._cartographicPosition=new K,this._normal=new z,this._definitionChanged=new $o.a,this._terrainHeight=0,this._removeCallbackFunc=void 0,this._removeEventListener=void 0,this._removeModeListener=void 0;var r=this;if(Object(u.a)(e.globe)&&(this._removeEventListener=e.terrainProviderChanged.addEventListener((function(){r._updateClamping()})),this._removeModeListener=e.morphComplete.addEventListener((function(){r._updateClamping()}))),t.isConstant){var a=t.getValue(nx.MINIMUM_VALUE,Kz);if(!Object(u.a)(a)||z.equals(a,z.ZERO)||!Object(u.a)(e.globe))return;this._position=z.clone(a,this._position),this._updateClamping(),this._normal=e.globe.ellipsoid.geodeticSurfaceNormal(a,this._normal)}}Object(O.a)($z.prototype,{isConstant:{get:function(){return!1}},definitionChanged:{get:function(){return this._definitionChanged}}}),$z.prototype._updateClamping=function(){Object(u.a)(this._removeCallbackFunc)&&this._removeCallbackFunc();var e=this._scene,t=e.globe,i=this._position;if(Object(u.a)(t)&&!z.equals(i,z.ZERO)){var n=t.ellipsoid,r=t._surface,a=this,o=n.cartesianToCartographic(i,this._cartographicPosition),s=t.getHeight(o);Object(u.a)(s)?this._terrainHeight=s:this._terrainHeight=0,this._removeCallbackFunc=r.updateHeight(o,(function(t){if(e.mode===xF.SCENE3D){var i=n.cartesianToCartographic(t,Jz);a._terrainHeight=i.height}else a._terrainHeight=t.x;a.definitionChanged.raiseEvent()}))}else this._terrainHeight=0},$z.prototype.getValue=function(e,t){var i=aD.getValueOrDefault(this._heightReference,e,eD.NONE),n=aD.getValueOrDefault(this._extrudedHeightReference,e,eD.NONE);if(i===eD.NONE&&n!==eD.RELATIVE_TO_GROUND)return this._position=z.clone(z.ZERO,this._position),z.clone(z.ZERO,t);if(this._positionProperty.isConstant)return z.multiplyByScalar(this._normal,this._terrainHeight,t);var r=this._scene,a=this._positionProperty.getValue(e,Kz);if(!Object(u.a)(a)||z.equals(a,z.ZERO)||!Object(u.a)(r.globe))return z.clone(z.ZERO,t);if(z.equalsEpsilon(this._position,a,I.EPSILON10))return z.multiplyByScalar(this._normal,this._terrainHeight,t);this._position=z.clone(a,this._position),this._updateClamping();var o=r.globe.ellipsoid.geodeticSurfaceNormal(a,this._normal);return z.multiplyByScalar(o,this._terrainHeight,t)},$z.prototype.isDestroyed=function(){return!1},$z.prototype.destroy=function(){return Object(u.a)(this._removeEventListener)&&this._removeEventListener(),Object(u.a)(this._removeModeListener)&&this._removeModeListener(),Object(u.a)(this._removeCallbackFunc)&&this._removeCallbackFunc(),rl(this)};var eU=$z;var tU=function(e,t,i,n){if(Qz.prototype._onEntityPropertyChanged.call(this,e,t,i,n),-1!==this._observedPropertyNames.indexOf(t)){var r=this._entity[this._geometryPropertyName];if(Object(u.a)(r)){Object(u.a)(this._terrainOffsetProperty)&&(this._terrainOffsetProperty.destroy(),this._terrainOffsetProperty=void 0);var a=r.heightReference;if(Object(u.a)(a)){var o=new tM(this._computeCenter.bind(this),!this._dynamic);this._terrainOffsetProperty=new eU(this._scene,o,a)}}}};function iU(){h.a.throwInstantiationError()}Object(O.a)(iU.prototype,{isConstant:{get:h.a.throwInstantiationError},definitionChanged:{get:h.a.throwInstantiationError}}),iU.prototype.getType=h.a.throwInstantiationError,iU.prototype.getValue=h.a.throwInstantiationError,iU.prototype.equals=h.a.throwInstantiationError,iU.getValue=function(e,t,i){var n;return Object(u.a)(t)&&(n=t.getType(e),Object(u.a)(n))?(Object(u.a)(i)&&i.type===n||(i=qj.fromType(n)),t.getValue(e,i.uniforms),i):(Object(u.a)(i)&&i.type===qj.ColorType||(i=qj.fromType(qj.ColorType)),uf.clone(uf.WHITE,i.uniforms.color),i)};var nU=iU;function rU(e,t,i){x.a.defined("geometryUpdater",e),x.a.defined("primitives",t),x.a.defined("orderedGroundPrimitives",i),this._primitives=t,this._orderedGroundPrimitives=i,this._primitive=void 0,this._outlinePrimitive=void 0,this._geometryUpdater=e,this._options=e._options,this._entity=e._entity,this._material=void 0}rU.prototype._isHidden=function(e,t,i){return!e.isShowing||!e.isAvailable(i)||!aD.getValueOrDefault(t.show,i,!0)},rU.prototype._setOptions=h.a.throwInstantiationError,rU.prototype.update=function(e){x.a.defined("time",e);var t=this._geometryUpdater,i=t._onTerrain,n=this._primitives,r=this._orderedGroundPrimitives;i?r.remove(this._primitive):(n.removeAndDestroy(this._primitive),n.removeAndDestroy(this._outlinePrimitive),this._outlinePrimitive=void 0),this._primitive=void 0;var a=this._entity,o=a[this._geometryUpdater._geometryPropertyName];if(this._setOptions(a,o,e),!this._isHidden(a,o,e)){var s=this._geometryUpdater.shadowsProperty.getValue(e),c=this._options;if(!Object(u.a)(o.fill)||o.fill.getValue(e)){var l,h=t.fillMaterialProperty,d=h instanceof oM,f=t._getIsClosed(c);if(d)l=new $j({closed:f,flat:i&&!t._supportsMaterialsforEntitiesOnTerrain});else{var p=nU.getValue(e,h,this._material);this._material=p,l=new Yj({material:p,translucent:p.isTranslucent(),closed:f})}if(i)c.vertexFormat=$j.VERTEX_FORMAT,this._primitive=r.add(new mB({geometryInstances:this._geometryUpdater.createFillGeometryInstance(e),appearance:l,asynchronous:!1,shadows:s,classificationType:this._geometryUpdater.classificationTypeProperty.getValue(e)}),aD.getValueOrUndefined(this._geometryUpdater.zIndex,e));else{c.vertexFormat=l.vertexFormat;var m=this._geometryUpdater.createFillGeometryInstance(e);d&&(l.translucent=255!==m.attributes.color.value[3]),this._primitive=n.add(new ck({geometryInstances:m,appearance:l,asynchronous:!1,shadows:s}))}}if(!i&&Object(u.a)(o.outline)&&o.outline.getValue(e)){var _=this._geometryUpdater.createOutlineGeometryInstance(e),g=aD.getValueOrDefault(o.outlineWidth,e,1);this._outlinePrimitive=n.add(new ck({geometryInstances:_,appearance:new $j({flat:!0,translucent:255!==_.attributes.color.value[3],renderState:{lineWidth:t._scene.clampLineWidth(g)}}),asynchronous:!1,shadows:s}))}}},rU.prototype.getBoundingSphere=function(e){if(!Object(u.a)(e))throw new h.a("result is required.");var t,i=this._entity,n=this._primitive,r=this._outlinePrimitive;return Object(u.a)(n)&&n.show&&n.ready&&(t=n.getGeometryInstanceAttributes(i),Object(u.a)(t)&&Object(u.a)(t.boundingSphere))?(St.clone(t.boundingSphere,e),nD.DONE):Object(u.a)(r)&&r.show&&r.ready&&(t=r.getGeometryInstanceAttributes(i),Object(u.a)(t)&&Object(u.a)(t.boundingSphere))?(St.clone(t.boundingSphere,e),nD.DONE):Object(u.a)(n)&&!n.ready||Object(u.a)(r)&&!r.ready?nD.PENDING:nD.FAILED},rU.prototype.isDestroyed=function(){return!1},rU.prototype.destroy=function(){var e=this._primitives,t=this._orderedGroundPrimitives;this._geometryUpdater._onTerrain?t.remove(this._primitive):e.removeAndDestroy(this._primitive),e.removeAndDestroy(this._outlinePrimitive),rl(this)};var aU=rU,oU=z.ZERO,sU=new z,cU=new z,lU=new uf;function uU(e){this.id=e,this.vertexFormat=void 0,this.dimensions=void 0,this.offsetAttribute=void 0}function hU(e,t){Qz.call(this,{entity:e,scene:t,geometryOptions:new uU(e),geometryPropertyName:"box",observedPropertyNames:["availability","position","orientation","box"]}),this._onEntityPropertyChanged(e,"box",e.box,void 0)}function dU(e,t,i){aU.call(this,e,t,i)}Object(u.a)(Object.create)&&(hU.prototype=Object.create(Qz.prototype),hU.prototype.constructor=hU),Object(O.a)(hU.prototype,{terrainOffsetProperty:{get:function(){return this._terrainOffsetProperty}}}),hU.prototype.createFillGeometryInstance=function(e){if(x.a.defined("time",e),!this._fillEnabled)throw new h.a("This instance does not represent a filled geometry.");var t,i=this._entity,n=i.isAvailable(e),r=new sA(n&&i.isShowing&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)),a=this._distanceDisplayConditionProperty.getValue(e),o={show:r,distanceDisplayCondition:bv.fromDistanceDisplayCondition(a),color:void 0,offset:void 0};this._materialProperty instanceof oM&&(Object(u.a)(this._materialProperty.color)&&(this._materialProperty.color.isConstant||n)&&(t=this._materialProperty.color.getValue(e,lU)),Object(u.a)(t)||(t=uf.WHITE),o.color=df.fromColor(t));return Object(u.a)(this._options.offsetAttribute)&&(o.offset=tE.fromCartesian3(aD.getValueOrDefault(this._terrainOffsetProperty,e,oU,sU))),new Mu({id:i,geometry:Ya.fromDimensions(this._options),modelMatrix:i.computeModelMatrixForHeightReference(e,i.box.heightReference,.5*this._options.dimensions.z,this._scene.mapProjection.ellipsoid),attributes:o})},hU.prototype.createOutlineGeometryInstance=function(e){if(x.a.defined("time",e),!this._outlineEnabled)throw new h.a("This instance does not represent an outlined geometry.");var t=this._entity,i=t.isAvailable(e),n=aD.getValueOrDefault(this._outlineColorProperty,e,uf.BLACK,lU),r=this._distanceDisplayConditionProperty.getValue(e),a={show:new sA(i&&t.isShowing&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)),color:df.fromColor(n),distanceDisplayCondition:bv.fromDistanceDisplayCondition(r),offset:void 0};return Object(u.a)(this._options.offsetAttribute)&&(a.offset=tE.fromCartesian3(aD.getValueOrDefault(this._terrainOffsetProperty,e,oU,sU))),new Mu({id:t,geometry:$a.fromDimensions(this._options),modelMatrix:t.computeModelMatrixForHeightReference(e,t.box.heightReference,.5*this._options.dimensions.z,this._scene.mapProjection.ellipsoid),attributes:a})},hU.prototype._computeCenter=function(e,t){return aD.getValueOrUndefined(this._entity.position,e,t)},hU.prototype._isHidden=function(e,t){return!Object(u.a)(t.dimensions)||!Object(u.a)(e.position)||Qz.prototype._isHidden.call(this,e,t)},hU.prototype._isDynamic=function(e,t){return!(e.position.isConstant&&aD.isConstant(e.orientation)&&t.dimensions.isConstant&&aD.isConstant(t.outlineWidth))},hU.prototype._setStaticOptions=function(e,t){var i=aD.getValueOrDefault(t.heightReference,nx.MINIMUM_VALUE,eD.NONE),n=this._options;n.vertexFormat=this._materialProperty instanceof oM?$j.VERTEX_FORMAT:Yj.MaterialSupport.TEXTURED.vertexFormat,n.dimensions=t.dimensions.getValue(nx.MINIMUM_VALUE,n.dimensions),n.offsetAttribute=i!==eD.NONE?fn.ALL:void 0},hU.prototype._onEntityPropertyChanged=tU,hU.DynamicGeometryUpdater=dU,Object(u.a)(Object.create)&&(dU.prototype=Object.create(aU.prototype),dU.prototype.constructor=dU),dU.prototype._isHidden=function(e,t,i){var n=aD.getValueOrUndefined(e.position,i,cU),r=this._options.dimensions;return!Object(u.a)(n)||!Object(u.a)(r)||aU.prototype._isHidden.call(this,e,t,i)},dU.prototype._setOptions=function(e,t,i){var n=aD.getValueOrDefault(t.heightReference,i,eD.NONE),r=this._options;r.dimensions=aD.getValueOrUndefined(t.dimensions,i,r.dimensions),r.offsetAttribute=n!==eD.NONE?fn.ALL:void 0};var fU=hU,pU=uf.WHITE,mU=uf.BLACK,_U=new Rt(2,2);function gU(e){e=Object(w.a)(e,w.a.EMPTY_OBJECT),this._definitionChanged=new $o.a,this._evenColor=void 0,this._evenColorSubscription=void 0,this._oddColor=void 0,this._oddColorSubscription=void 0,this._repeat=void 0,this._repeatSubscription=void 0,this.evenColor=e.evenColor,this.oddColor=e.oddColor,this.repeat=e.repeat}Object(O.a)(gU.prototype,{isConstant:{get:function(){return aD.isConstant(this._evenColor)&&aD.isConstant(this._oddColor)&&aD.isConstant(this._repeat)}},definitionChanged:{get:function(){return this._definitionChanged}},evenColor:KI("evenColor"),oddColor:KI("oddColor"),repeat:KI("repeat")}),gU.prototype.getType=function(e){return"Checkerboard"},gU.prototype.getValue=function(e,t){return Object(u.a)(t)||(t={}),t.lightColor=aD.getValueOrClonedDefault(this._evenColor,e,pU,t.lightColor),t.darkColor=aD.getValueOrClonedDefault(this._oddColor,e,mU,t.darkColor),t.repeat=aD.getValueOrDefault(this._repeat,e,_U),t},gU.prototype.equals=function(e){return this===e||e instanceof gU&&aD.equals(this._evenColor,e._evenColor)&&aD.equals(this._oddColor,e._oddColor)&&aD.equals(this._repeat,e._repeat)};var vU=gU,bU={id:void 0};function yU(e){if(e._firing)e._refire=!0;else if(0===e._suspendCount){var t=e._addedEntities,i=e._removedEntities,n=e._changedEntities;if(0!==n.length||0!==t.length||0!==i.length){e._firing=!0;do{e._refire=!1;var r=t.values.slice(0),a=i.values.slice(0),o=n.values.slice(0);t.removeAll(),i.removeAll(),n.removeAll(),e._collectionChanged.raiseEvent(e,r,a,o)}while(e._refire);e._firing=!1}}}function wU(e){this._owner=e,this._entities=new Fi,this._addedEntities=new Fi,this._removedEntities=new Fi,this._changedEntities=new Fi,this._suspendCount=0,this._collectionChanged=new $o.a,this._id=Mg(),this._show=!0,this._firing=!1,this._refire=!1}wU.prototype.suspendEvents=function(){this._suspendCount++},wU.prototype.resumeEvents=function(){if(0===this._suspendCount)throw new h.a("resumeEvents can not be called before suspendEvents.");this._suspendCount--,yU(this)},wU.collectionChangedEventCallback=void 0,Object(O.a)(wU.prototype,{collectionChanged:{get:function(){return this._collectionChanged}},id:{get:function(){return this._id}},values:{get:function(){return this._entities.values}},show:{get:function(){return this._show},set:function(e){if(!Object(u.a)(e))throw new h.a("value is required.");if(e!==this._show){var t;this.suspendEvents();var i=[],n=this._entities.values,r=n.length;for(t=0;t<r;t++)i.push(n[t].isShowing);for(this._show=e,t=0;t<r;t++){var a=i[t],o=n[t];a!==o.isShowing&&o.definitionChanged.raiseEvent(o,"isShowing",o.isShowing,a)}this.resumeEvents()}}},owner:{get:function(){return this._owner}}}),wU.prototype.computeAvailability=function(){for(var e=nx.MAXIMUM_VALUE,t=nx.MINIMUM_VALUE,i=this._entities.values,n=0,r=i.length;n<r;n++){var a=i[n].availability;if(Object(u.a)(a)){var o=a.start,s=a.stop;Tr.lessThan(o,e)&&!o.equals(nx.MINIMUM_VALUE)&&(e=o),Tr.greaterThan(s,t)&&!s.equals(nx.MAXIMUM_VALUE)&&(t=s)}}return nx.MAXIMUM_VALUE.equals(e)&&(e=nx.MINIMUM_VALUE),nx.MINIMUM_VALUE.equals(t)&&(t=nx.MAXIMUM_VALUE),new ex({start:e,stop:t})},wU.prototype.add=function(e){if(!Object(u.a)(e))throw new h.a("entity is required.");e instanceof zz||(e=new zz(e));var t=e.id,i=this._entities;if(i.contains(t))throw new Ce.a("An entity with id "+t+" already exists in this collection.");return e.entityCollection=this,i.set(t,e),this._removedEntities.remove(t)||this._addedEntities.set(t,e),e.definitionChanged.addEventListener(wU.prototype._onEntityDefinitionChanged,this),yU(this),e},wU.prototype.remove=function(e){return!!Object(u.a)(e)&&this.removeById(e.id)},wU.prototype.contains=function(e){if(!Object(u.a)(e))throw new h.a("entity is required");return this._entities.get(e.id)===e},wU.prototype.removeById=function(e){if(!Object(u.a)(e))return!1;var t=this._entities.get(e);return!!this._entities.remove(e)&&(this._addedEntities.remove(e)||(this._removedEntities.set(e,t),this._changedEntities.remove(e)),this._entities.remove(e),t.definitionChanged.removeEventListener(wU.prototype._onEntityDefinitionChanged,this),yU(this),!0)},wU.prototype.removeAll=function(){for(var e=this._entities,t=e.length,i=e.values,n=this._addedEntities,r=this._removedEntities,a=0;a<t;a++){var o=i[a],s=o.id,c=n.get(s);Object(u.a)(c)||(o.definitionChanged.removeEventListener(wU.prototype._onEntityDefinitionChanged,this),r.set(s,o))}e.removeAll(),n.removeAll(),this._changedEntities.removeAll(),yU(this)},wU.prototype.getById=function(e){if(!Object(u.a)(e))throw new h.a("id is required.");return this._entities.get(e)},wU.prototype.getOrCreateEntity=function(e){if(!Object(u.a)(e))throw new h.a("id is required.");var t=this._entities.get(e);return Object(u.a)(t)||(bU.id=e,t=new zz(bU),this.add(t)),t},wU.prototype._onEntityDefinitionChanged=function(e){var t=e.id;this._addedEntities.contains(t)||this._changedEntities.set(t,e),yU(this)};var OU=wU,xU={id:void 0},EU=new Array(2);function TU(e){for(var t=e.propertyNames,i=t.length,n=0;n<i;n++)e[t[n]]=void 0}function CU(e,t,i,n){EU[0]=i,EU[1]=n.id,t[JSON.stringify(EU)]=n.definitionChanged.addEventListener(PU.prototype._onDefinitionChanged,e)}function SU(e,t,i,n){EU[0]=i,EU[1]=n.id;var r=JSON.stringify(EU);t[r](),t[r]=void 0}function AU(e){if(e._shouldRecomposite=!0,0===e._suspendCount){var t,i,n,r,a,o,s=e._collections,c=s.length,l=e._collectionsCopy,h=l.length,d=e._composite,f=new OU(e),p=e._eventHash;for(t=0;t<h;t++)for((a=l[t]).collectionChanged.removeEventListener(PU.prototype._onCollectionChanged,e),n=a.values,o=a.id,r=n.length-1;r>-1;r--)SU(0,p,o,i=n[r]);for(t=c-1;t>=0;t--)for((a=s[t]).collectionChanged.addEventListener(PU.prototype._onCollectionChanged,e),n=a.values,o=a.id,r=n.length-1;r>-1;r--){CU(e,p,o,i=n[r]);var m=f.getById(i.id);Object(u.a)(m)||(m=d.getById(i.id),Object(u.a)(m)?TU(m):(xU.id=i.id,m=new zz(xU)),f.add(m)),m.merge(i)}e._collectionsCopy=s.slice(0),d.suspendEvents(),d.removeAll();var _=f.values;for(t=0;t<_.length;t++)d.add(_[t]);d.resumeEvents()}}function PU(e,t){this._owner=t,this._composite=new OU(this),this._suspendCount=0,this._collections=Object(u.a)(e)?e.slice():[],this._collectionsCopy=[],this._id=Mg(),this._eventHash={},AU(this),this._shouldRecomposite=!1}function IU(e,t){if(!Object(u.a)(t))throw new h.a("collection is required.");var i=e.indexOf(t);if(-1===i)throw new h.a("collection is not in this composite.");return i}function DU(e,t,i){var n=e._collections;if((t=I.clamp(t,0,n.length-1))!==(i=I.clamp(i,0,n.length-1))){var r=n[t];n[t]=n[i],n[i]=r,AU(e)}}Object(O.a)(PU.prototype,{collectionChanged:{get:function(){return this._composite._collectionChanged}},id:{get:function(){return this._id}},values:{get:function(){return this._composite.values}},owner:{get:function(){return this._owner}}}),PU.prototype.addCollection=function(e,t){var i=Object(u.a)(t);if(!Object(u.a)(e))throw new h.a("collection is required.");if(i){if(t<0)throw new h.a("index must be greater than or equal to zero.");if(t>this._collections.length)throw new h.a("index must be less than or equal to the number of collections.")}i?this._collections.splice(t,0,e):(t=this._collections.length,this._collections.push(e)),AU(this)},PU.prototype.removeCollection=function(e){var t=this._collections.indexOf(e);return-1!==t&&(this._collections.splice(t,1),AU(this),!0)},PU.prototype.removeAllCollections=function(){this._collections.length=0,AU(this)},PU.prototype.containsCollection=function(e){return-1!==this._collections.indexOf(e)},PU.prototype.contains=function(e){return this._composite.contains(e)},PU.prototype.indexOfCollection=function(e){return this._collections.indexOf(e)},PU.prototype.getCollection=function(e){if(!Object(u.a)(e))throw new h.a("index is required.","index");return this._collections[e]},PU.prototype.getCollectionsLength=function(){return this._collections.length},PU.prototype.raiseCollection=function(e){var t=IU(this._collections,e);DU(this,t,t+1)},PU.prototype.lowerCollection=function(e){var t=IU(this._collections,e);DU(this,t,t-1)},PU.prototype.raiseCollectionToTop=function(e){var t=IU(this._collections,e);t!==this._collections.length-1&&(this._collections.splice(t,1),this._collections.push(e),AU(this))},PU.prototype.lowerCollectionToBottom=function(e){var t=IU(this._collections,e);0!==t&&(this._collections.splice(t,1),this._collections.splice(0,0,e),AU(this))},PU.prototype.suspendEvents=function(){this._suspendCount++,this._composite.suspendEvents()},PU.prototype.resumeEvents=function(){if(0===this._suspendCount)throw new h.a("resumeEvents can not be called before suspendEvents.");this._suspendCount--,this._shouldRecomposite&&0===this._suspendCount&&(AU(this),this._shouldRecomposite=!1),this._composite.resumeEvents()},PU.prototype.computeAvailability=function(){return this._composite.computeAvailability()},PU.prototype.getById=function(e){return this._composite.getById(e)},PU.prototype._onCollectionChanged=function(e,t,i){var n,r,a,o,s=this._collectionsCopy,c=s.length,l=this._composite;l.suspendEvents();var h=i.length,d=this._eventHash,f=e.id;for(n=0;n<h;n++){var p=i[n];SU(0,d,f,p);var m=p.id;for(r=c-1;r>=0;r--)a=s[r].getById(m),Object(u.a)(a)&&(Object(u.a)(o)||TU(o=l.getById(m)),o.merge(a));Object(u.a)(o)||l.removeById(m),o=void 0}var _=t.length;for(n=0;n<_;n++){var g=t[n];CU(this,d,f,g);var v=g.id;for(r=c-1;r>=0;r--)a=s[r].getById(v),Object(u.a)(a)&&(Object(u.a)(o)||(o=l.getById(v),Object(u.a)(o)?TU(o):(xU.id=v,o=new zz(xU),l.add(o))),o.merge(a));o=void 0}l.resumeEvents()},PU.prototype._onDefinitionChanged=function(e,t,i,n){for(var r=this._collections,a=this._composite,o=r.length,s=e.id,c=a.getById(s),l=c[t],h=!Object(u.a)(l),d=!0,f=o-1;f>=0;f--){var p=r[f].getById(e.id);if(Object(u.a)(p)){var m=p[t];if(Object(u.a)(m)){if(d){if(d=!1,!Object(u.a)(m.merge)||!Object(u.a)(m.clone)){l=m;break}l=m.clone(l)}l.merge(m)}}}h&&-1===c.propertyNames.indexOf(t)&&c.addProperty(t),c[t]=l};var jU=PU;function MU(){this._eventHelper=new eb,this._definitionChanged=new $o.a,this._intervals=new eI,this._intervals.changedEvent.addEventListener(MU.prototype._intervalsChanged,this)}Object(O.a)(MU.prototype,{isConstant:{get:function(){return this._intervals.isEmpty}},definitionChanged:{get:function(){return this._definitionChanged}},intervals:{get:function(){return this._intervals}}}),MU.prototype.getValue=function(e,t){if(!Object(u.a)(e))throw new h.a("time is required");var i=this._intervals.findDataForIntervalContainingDate(e);if(Object(u.a)(i))return i.getValue(e,t)},MU.prototype.equals=function(e){return this===e||e instanceof MU&&this._intervals.equals(e._intervals,aD.equals)},MU.prototype._intervalsChanged=function(){!function(e,t,i,n){function r(){i.raiseEvent(e)}var a=[];t.removeAll();for(var o=n.length,s=0;s<o;s++){var c=n.get(s);Object(u.a)(c.data)&&-1===a.indexOf(c.data)&&t.add(c.data.definitionChanged,r)}}(this,this._eventHelper,this._definitionChanged,this._intervals),this._definitionChanged.raiseEvent(this)};var RU=MU;function LU(){this._definitionChanged=new $o.a,this._composite=new RU,this._composite.definitionChanged.addEventListener(LU.prototype._raiseDefinitionChanged,this)}Object(O.a)(LU.prototype,{isConstant:{get:function(){return this._composite.isConstant}},definitionChanged:{get:function(){return this._definitionChanged}},intervals:{get:function(){return this._composite._intervals}}}),LU.prototype.getType=function(e){if(!Object(u.a)(e))throw new h.a("time is required");var t=this._composite._intervals.findDataForIntervalContainingDate(e);if(Object(u.a)(t))return t.getType(e)},LU.prototype.getValue=function(e,t){if(!Object(u.a)(e))throw new h.a("time is required");var i=this._composite._intervals.findDataForIntervalContainingDate(e);if(Object(u.a)(i))return i.getValue(e,t)},LU.prototype.equals=function(e){return this===e||e instanceof LU&&this._composite.equals(e._composite,aD.equals)},LU.prototype._raiseDefinitionChanged=function(){this._definitionChanged.raiseEvent(this)};var NU=LU;function FU(e){this._referenceFrame=Object(w.a)(e,mS.FIXED),this._definitionChanged=new $o.a,this._composite=new RU,this._composite.definitionChanged.addEventListener(FU.prototype._raiseDefinitionChanged,this)}Object(O.a)(FU.prototype,{isConstant:{get:function(){return this._composite.isConstant}},definitionChanged:{get:function(){return this._definitionChanged}},intervals:{get:function(){return this._composite.intervals}},referenceFrame:{get:function(){return this._referenceFrame},set:function(e){this._referenceFrame=e}}}),FU.prototype.getValue=function(e,t){return this.getValueInReferenceFrame(e,mS.FIXED,t)},FU.prototype.getValueInReferenceFrame=function(e,t,i){if(!Object(u.a)(e))throw new h.a("time is required.");if(!Object(u.a)(t))throw new h.a("referenceFrame is required.");var n=this._composite._intervals.findDataForIntervalContainingDate(e);if(Object(u.a)(n))return n.getValueInReferenceFrame(e,t,i)},FU.prototype.equals=function(e){return this===e||e instanceof FU&&this._referenceFrame===e._referenceFrame&&this._composite.equals(e._composite,aD.equals)},FU.prototype._raiseDefinitionChanged=function(){this._definitionChanged.raiseEvent(this)};var kU=FU,BU=new ZI(0);function zU(e){Qz.call(this,e),this._zIndex=0,this._terrainOffsetProperty=void 0}Object(u.a)(Object.create)&&(zU.prototype=Object.create(Qz.prototype),zU.prototype.constructor=zU),Object(O.a)(zU.prototype,{zIndex:{get:function(){return this._zIndex}},terrainOffsetProperty:{get:function(){return this._terrainOffsetProperty}}}),zU.prototype._isOnTerrain=function(e,t){return this._fillEnabled&&!Object(u.a)(t.height)&&!Object(u.a)(t.extrudedHeight)&&mB.isSupported(this._scene)},zU.prototype._getIsClosed=function(e){var t=e.height,i=e.extrudedHeight;return 0===t||Object(u.a)(i)&&i!==t},zU.prototype._computeCenter=h.a.throwInstantiationError,zU.prototype._onEntityPropertyChanged=function(e,t,i,n){if(Qz.prototype._onEntityPropertyChanged.call(this,e,t,i,n),-1!==this._observedPropertyNames.indexOf(t)){var r=this._entity[this._geometryPropertyName];if(Object(u.a)(r)){Object(u.a)(r.zIndex)&&(Object(u.a)(r.height)||Object(u.a)(r.extrudedHeight))&&Object(iE.a)(iE.a.geometryZIndex),this._zIndex=Object(w.a)(r.zIndex,BU),Object(u.a)(this._terrainOffsetProperty)&&(this._terrainOffsetProperty.destroy(),this._terrainOffsetProperty=void 0);var a=r.heightReference,o=r.extrudedHeightReference;if(Object(u.a)(a)||Object(u.a)(o)){var s=new tM(this._computeCenter.bind(this),!this._dynamic);this._terrainOffsetProperty=new eU(this._scene,s,a,o)}}}},zU.getGeometryHeight=function(e,t){if(x.a.defined("heightReference",t),Object(u.a)(e))return t!==eD.CLAMP_TO_GROUND?e:0;t!==eD.NONE&&Object(iE.a)(iE.a.geometryHeightReference)},zU.getGeometryExtrudedHeight=function(e,t){if(x.a.defined("extrudedHeightReference",t),Object(u.a)(e))return t!==eD.CLAMP_TO_GROUND?e:zU.CLAMP_TO_GROUND;t!==eD.NONE&&Object(iE.a)(iE.a.geometryExtrudedHeightReference)},zU.CLAMP_TO_GROUND="clamp",zU.computeGeometryOffsetAttribute=function(e,t,i,n){Object(u.a)(e)&&Object(u.a)(t)||(t=eD.NONE),Object(u.a)(i)&&Object(u.a)(n)||(n=eD.NONE);var r=0;return t!==eD.NONE&&r++,n===eD.RELATIVE_TO_GROUND&&r++,2===r?fn.ALL:1===r?fn.TOP:void 0};var UU=zU,VU=new uf,HU=z.ZERO,GU=new z,qU=new Ve;function WU(e){this.id=e,this.vertexFormat=void 0,this.positions=void 0,this.width=void 0,this.cornerType=void 0,this.height=void 0,this.extrudedHeight=void 0,this.granularity=void 0,this.offsetAttribute=void 0}function YU(e,t){UU.call(this,{entity:e,scene:t,geometryOptions:new WU(e),geometryPropertyName:"corridor",observedPropertyNames:["availability","corridor"]}),this._onEntityPropertyChanged(e,"corridor",e.corridor,void 0)}function XU(e,t,i){aU.call(this,e,t,i)}Object(u.a)(Object.create)&&(YU.prototype=Object.create(UU.prototype),YU.prototype.constructor=YU),YU.prototype.createFillGeometryInstance=function(e){if(x.a.defined("time",e),!this._fillEnabled)throw new h.a("This instance does not represent a filled geometry.");var t,i=this._entity,n=i.isAvailable(e),r={show:new sA(n&&i.isShowing&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)),distanceDisplayCondition:bv.fromDistanceDisplayCondition(this._distanceDisplayConditionProperty.getValue(e)),offset:void 0,color:void 0};this._materialProperty instanceof oM&&(Object(u.a)(this._materialProperty.color)&&(this._materialProperty.color.isConstant||n)&&(t=this._materialProperty.color.getValue(e,VU)),Object(u.a)(t)||(t=uf.WHITE),r.color=df.fromColor(t));return Object(u.a)(this._options.offsetAttribute)&&(r.offset=tE.fromCartesian3(aD.getValueOrDefault(this._terrainOffsetProperty,e,HU,GU))),new Mu({id:i,geometry:new xg(this._options),attributes:r})},YU.prototype.createOutlineGeometryInstance=function(e){if(x.a.defined("time",e),!this._outlineEnabled)throw new h.a("This instance does not represent an outlined geometry.");var t=this._entity,i=t.isAvailable(e),n=aD.getValueOrDefault(this._outlineColorProperty,e,uf.BLACK,VU),r={show:new sA(i&&t.isShowing&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)),color:df.fromColor(n),distanceDisplayCondition:bv.fromDistanceDisplayCondition(this._distanceDisplayConditionProperty.getValue(e)),offset:void 0};return Object(u.a)(this._options.offsetAttribute)&&(r.offset=tE.fromCartesian3(aD.getValueOrDefault(this._terrainOffsetProperty,e,HU,GU))),new Mu({id:t,geometry:new Dg(this._options),attributes:r})},YU.prototype._computeCenter=function(e,t){var i=aD.getValueOrUndefined(this._entity.corridor.positions,e);if(Object(u.a)(i)&&0!==i.length)return z.clone(i[Math.floor(i.length/2)],t)},YU.prototype._isHidden=function(e,t){return!Object(u.a)(t.positions)||!Object(u.a)(t.width)||Qz.prototype._isHidden.call(this,e,t)},YU.prototype._isDynamic=function(e,t){return!t.positions.isConstant||!aD.isConstant(t.height)||!aD.isConstant(t.extrudedHeight)||!aD.isConstant(t.granularity)||!aD.isConstant(t.width)||!aD.isConstant(t.outlineWidth)||!aD.isConstant(t.cornerType)||!aD.isConstant(t.zIndex)||this._onTerrain&&!aD.isConstant(this._materialProperty)},YU.prototype._setStaticOptions=function(e,t){var i=aD.getValueOrUndefined(t.height,nx.MINIMUM_VALUE),n=aD.getValueOrDefault(t.heightReference,nx.MINIMUM_VALUE,eD.NONE),r=aD.getValueOrUndefined(t.extrudedHeight,nx.MINIMUM_VALUE),a=aD.getValueOrDefault(t.extrudedHeightReference,nx.MINIMUM_VALUE,eD.NONE);Object(u.a)(r)&&!Object(u.a)(i)&&(i=0);var o=this._options;o.vertexFormat=this._materialProperty instanceof oM?$j.VERTEX_FORMAT:Yj.MaterialSupport.TEXTURED.vertexFormat,o.positions=t.positions.getValue(nx.MINIMUM_VALUE,o.positions),o.width=t.width.getValue(nx.MINIMUM_VALUE),o.granularity=aD.getValueOrUndefined(t.granularity,nx.MINIMUM_VALUE),o.cornerType=aD.getValueOrUndefined(t.cornerType,nx.MINIMUM_VALUE),o.offsetAttribute=UU.computeGeometryOffsetAttribute(i,n,r,a),o.height=UU.getGeometryHeight(i,n),(r=UU.getGeometryExtrudedHeight(r,a))===UU.CLAMP_TO_GROUND&&(r=Xt.getMinimumMaximumHeights(xg.computeRectangle(o,qU)).minimumTerrainHeight),o.extrudedHeight=r},YU.DynamicGeometryUpdater=XU,Object(u.a)(Object.create)&&(XU.prototype=Object.create(aU.prototype),XU.prototype.constructor=XU),XU.prototype._isHidden=function(e,t,i){var n=this._options;return!Object(u.a)(n.positions)||!Object(u.a)(n.width)||aU.prototype._isHidden.call(this,e,t,i)},XU.prototype._setOptions=function(e,t,i){var n=this._options,r=aD.getValueOrUndefined(t.height,i),a=aD.getValueOrDefault(t.heightReference,i,eD.NONE),o=aD.getValueOrUndefined(t.extrudedHeight,i),s=aD.getValueOrDefault(t.extrudedHeightReference,i,eD.NONE);Object(u.a)(o)&&!Object(u.a)(r)&&(r=0),n.positions=aD.getValueOrUndefined(t.positions,i),n.width=aD.getValueOrUndefined(t.width,i),n.granularity=aD.getValueOrUndefined(t.granularity,i),n.cornerType=aD.getValueOrUndefined(t.cornerType,i),n.offsetAttribute=UU.computeGeometryOffsetAttribute(r,a,o,s),n.height=UU.getGeometryHeight(r,a),(o=UU.getGeometryExtrudedHeight(o,s))===UU.CLAMP_TO_GROUND&&(o=Xt.getMinimumMaximumHeights(xg.computeRectangle(n,qU)).minimumTerrainHeight),n.extrudedHeight=o};var ZU=YU;function QU(){h.a.throwInstantiationError()}Object(O.a)(QU.prototype,{name:{get:h.a.throwInstantiationError},clock:{get:h.a.throwInstantiationError},entities:{get:h.a.throwInstantiationError},isLoading:{get:h.a.throwInstantiationError},changedEvent:{get:h.a.throwInstantiationError},errorEvent:{get:h.a.throwInstantiationError},loadingEvent:{get:h.a.throwInstantiationError},show:{get:h.a.throwInstantiationError},clustering:{get:h.a.throwInstantiationError}}),QU.prototype.update=h.a.throwInstantiationError,QU.setLoading=function(e,t){e._isLoading!==t&&(t?e._entityCollection.suspendEvents():e._entityCollection.resumeEvents(),e._isLoading=t,e._loading.raiseEvent(e,t))};var KU=QU,JU={},$U=new Te(0,0,0,1),eV=new Te,tV=new ln,iV=new Rt,nV=new Rt;JU.wgs84ToWindowCoordinates=function(e,t,i){return JU.wgs84WithEyeOffsetToWindowCoordinates(e,t,z.ZERO,i)};var rV=new Te,aV=new z;function oV(e,t,i,n){var r=i.viewMatrix,a=Be.multiplyByVector(r,Te.fromElements(e.x,e.y,e.z,1,rV),rV),o=z.multiplyComponents(t,z.normalize(a,aV),aV);return a.x+=t.x+o.x,a.y+=t.y+o.y,a.z+=o.z,Be.multiplyByVector(i.frustum.projectionMatrix,a,n)}var sV=new K(Math.PI,I.PI_OVER_TWO),cV=new z,lV=new z;JU.wgs84WithEyeOffsetToWindowCoordinates=function(e,t,i,n){if(!Object(u.a)(e))throw new h.a("scene is required.");if(!Object(u.a)(t))throw new h.a("position is required.");var r=e.frameState,a=JU.computeActualWgs84Position(r,t,$U);if(Object(u.a)(a)){var o=e.canvas,s=tV;s.x=0,s.y=0,s.width=o.clientWidth,s.height=o.clientHeight;var c=e.camera,l=!1;if(r.mode===xF.SCENE2D){var d=e.mapProjection,f=sV,p=d.project(f,cV),m=z.clone(c.position,lV),_=c.frustum.clone(),g=Be.computeViewportTransformation(s,0,1,new Be),v=c.frustum.projectionMatrix,b=c.positionWC.y,y=z.fromElements(I.sign(b)*p.x-b,0,-c.positionWC.x),w=xa.pointToGLWindowCoordinates(v,g,y);if(0===b||w.x<=0||w.x>=o.clientWidth)l=!0;else{if(w.x>.5*o.clientWidth){s.width=w.x,c.frustum.right=p.x-b,eV=oV(a,i,c,eV),JU.clipToGLWindowCoordinates(s,eV,iV),s.x+=w.x,c.position.x=-c.position.x;var O=c.frustum.right;c.frustum.right=-c.frustum.left,c.frustum.left=-O,eV=oV(a,i,c,eV),JU.clipToGLWindowCoordinates(s,eV,nV)}else{s.x+=w.x,s.width-=w.x,c.frustum.left=-p.x-b,eV=oV(a,i,c,eV),JU.clipToGLWindowCoordinates(s,eV,iV),s.x=s.x-s.width,c.position.x=-c.position.x;var x=c.frustum.left;c.frustum.left=-c.frustum.right,c.frustum.right=-x,eV=oV(a,i,c,eV),JU.clipToGLWindowCoordinates(s,eV,nV)}z.clone(m,c.position),c.frustum=_.clone(),((n=Rt.clone(iV,n)).x<0||n.x>o.clientWidth)&&(n.x=nV.x)}}if(r.mode!==xF.SCENE2D||l){if((eV=oV(a,i,c,eV)).z<0&&!(c.frustum instanceof hb)&&!(c.frustum instanceof cb))return;n=JU.clipToGLWindowCoordinates(s,eV,n)}return n.y=o.clientHeight-n.y,n}},JU.wgs84ToDrawingBufferCoordinates=function(e,t,i){if(i=JU.wgs84ToWindowCoordinates(e,t,i),Object(u.a)(i))return JU.transformWindowToDrawingBuffer(e,i,i)};var uV=new z,hV=new K;JU.computeActualWgs84Position=function(e,t,i){var n=e.mode;if(n===xF.SCENE3D)return z.clone(t,i);var r=e.mapProjection,a=r.ellipsoid.cartesianToCartographic(t,hV);if(Object(u.a)(a)){if(r.project(a,uV),n===xF.COLUMBUS_VIEW)return z.fromElements(uV.z,uV.x,uV.y,i);if(n===xF.SCENE2D)return z.fromElements(0,uV.x,uV.y,i);var o=e.morphTime;return z.fromElements(I.lerp(uV.z,t.x,o),I.lerp(uV.x,t.y,o),I.lerp(uV.y,t.z,o),i)}};var dV=new z,fV=new z,pV=new Be;JU.clipToGLWindowCoordinates=function(e,t,i){return z.divideByScalar(t,t.w,dV),Be.computeViewportTransformation(e,0,1,pV),Be.multiplyByPoint(pV,dV,fV),Rt.fromCartesian3(fV,i)},JU.transformWindowToDrawingBuffer=function(e,t,i){var n=e.canvas,r=e.drawingBufferWidth/n.clientWidth,a=e.drawingBufferHeight/n.clientHeight;return Rt.fromElements(t.x*r,t.y*a,i)};var mV=new Te,_V=new Te;JU.drawingBufferToWgs84Coordinates=function(e,t,i,n){var r=e.context.uniformState,a=r.currentFrustum,o=a.x,s=a.y;e.frameState.useLogDepth&&(i=s*(1-o/(i=Math.pow(2,i*I.log2(s+1))-1))/(s-o));var c,l=e._view.passState.viewport,h=Te.clone(Te.UNIT_W,mV);h.x=(t.x-l.x)/l.width*2-1,h.y=(t.y-l.y)/l.height*2-1,h.z=2*i-1,h.w=1;var d=e.camera.frustum;if(Object(u.a)(d.fovy)){var f=1/(c=Be.multiplyByVector(r.inverseViewProjection,h,_V)).w;z.multiplyByScalar(c,f,c)}else Object(u.a)(d._offCenterFrustum)&&(d=d._offCenterFrustum),(c=_V).x=.5*(h.x*(d.right-d.left)+d.left+d.right),c.y=.5*(h.y*(d.top-d.bottom)+d.bottom+d.top),c.z=.5*(h.z*(o-s)-o-s),c.w=1,c=Be.multiplyByVector(r.inverseView,c,c);return z.fromCartesian4(c,n)};var gV=JU;function vV(e,t){if(e=Object(w.a)(e,w.a.EMPTY_OBJECT),Object(u.a)(e.disableDepthTestDistance)&&e.disableDepthTestDistance<0)throw new h.a("disableDepthTestDistance must be greater than or equal to 0.0.");var i=e.translucencyByDistance,n=e.pixelOffsetScaleByDistance,r=e.scaleByDistance,a=e.distanceDisplayCondition;if(Object(u.a)(i)){if(i.far<=i.near)throw new h.a("translucencyByDistance.far must be greater than translucencyByDistance.near.");i=Fx.clone(i)}if(Object(u.a)(n)){if(n.far<=n.near)throw new h.a("pixelOffsetScaleByDistance.far must be greater than pixelOffsetScaleByDistance.near.");n=Fx.clone(n)}if(Object(u.a)(r)){if(r.far<=r.near)throw new h.a("scaleByDistance.far must be greater than scaleByDistance.near.");r=Fx.clone(r)}if(Object(u.a)(a)){if(a.far<=a.near)throw new h.a("distanceDisplayCondition.far must be greater than distanceDisplayCondition.near.");a=gv.clone(a)}this._show=Object(w.a)(e.show,!0),this._position=z.clone(Object(w.a)(e.position,z.ZERO)),this._actualPosition=z.clone(this._position),this._pixelOffset=Rt.clone(Object(w.a)(e.pixelOffset,Rt.ZERO)),this._translate=new Rt(0,0),this._eyeOffset=z.clone(Object(w.a)(e.eyeOffset,z.ZERO)),this._heightReference=Object(w.a)(e.heightReference,eD.NONE),this._verticalOrigin=Object(w.a)(e.verticalOrigin,iD.CENTER),this._horizontalOrigin=Object(w.a)(e.horizontalOrigin,tD.CENTER),this._scale=Object(w.a)(e.scale,1),this._color=uf.clone(Object(w.a)(e.color,uf.WHITE)),this._rotation=Object(w.a)(e.rotation,0),this._alignedAxis=z.clone(Object(w.a)(e.alignedAxis,z.ZERO)),this._width=e.width,this._height=e.height,this._scaleByDistance=r,this._translucencyByDistance=i,this._pixelOffsetScaleByDistance=n,this._sizeInMeters=Object(w.a)(e.sizeInMeters,!1),this._distanceDisplayCondition=a,this._disableDepthTestDistance=e.disableDepthTestDistance,this._id=e.id,this._collection=Object(w.a)(e.collection,t),this._pickId=void 0,this._pickPrimitive=Object(w.a)(e._pickPrimitive,this),this._billboardCollection=t,this._dirty=!1,this._index=-1,this._batchIndex=void 0,this._imageIndex=-1,this._imageIndexPromise=void 0,this._imageId=void 0,this._image=void 0,this._imageSubRegion=void 0,this._imageWidth=void 0,this._imageHeight=void 0,this._labelDimensions=void 0,this._labelHorizontalOrigin=void 0,this._labelTranslate=void 0;var o=e.image,s=e.imageId;Object(u.a)(o)&&(Object(u.a)(s)||(s="string"==typeof o?o:Object(u.a)(o.src)?o.src:Mg()),this._imageId=s,this._image=o),Object(u.a)(e.imageSubRegion)&&(this._imageId=s,this._imageSubRegion=e.imageSubRegion),Object(u.a)(this._billboardCollection._textureAtlas)&&this._loadImage(),this._actualClampedPosition=void 0,this._removeCallbackFunc=void 0,this._mode=xF.SCENE3D,this._clusterShow=!0,this._updateClamping()}var bV=vV.SHOW_INDEX=0,yV=vV.POSITION_INDEX=1,wV=vV.PIXEL_OFFSET_INDEX=2,OV=vV.EYE_OFFSET_INDEX=3,xV=vV.HORIZONTAL_ORIGIN_INDEX=4,EV=vV.VERTICAL_ORIGIN_INDEX=5,TV=vV.SCALE_INDEX=6,CV=vV.IMAGE_INDEX_INDEX=7,SV=vV.COLOR_INDEX=8,AV=vV.ROTATION_INDEX=9,PV=vV.ALIGNED_AXIS_INDEX=10,IV=vV.SCALE_BY_DISTANCE_INDEX=11,DV=vV.TRANSLUCENCY_BY_DISTANCE_INDEX=12,jV=vV.PIXEL_OFFSET_SCALE_BY_DISTANCE_INDEX=13,MV=vV.DISTANCE_DISPLAY_CONDITION=14,RV=vV.DISABLE_DEPTH_DISTANCE=15;function LV(e,t){var i=e._billboardCollection;Object(u.a)(i)&&(i._updateBillboard(e,t),e._dirty=!0)}vV.TEXTURE_COORDINATE_BOUNDS=16,vV.NUMBER_OF_PROPERTIES=17,Object(O.a)(vV.prototype,{show:{get:function(){return this._show},set:function(e){if(!Object(u.a)(e))throw new h.a("value is required.");this._show!==e&&(this._show=e,LV(this,bV))}},position:{get:function(){return this._position},set:function(e){if(!Object(u.a)(e))throw new h.a("value is required.");var t=this._position;z.equals(t,e)||(z.clone(e,t),z.clone(e,this._actualPosition),this._updateClamping(),LV(this,yV))}},heightReference:{get:function(){return this._heightReference},set:function(e){if(!Object(u.a)(e))throw new h.a("value is required.");e!==this._heightReference&&(this._heightReference=e,this._updateClamping(),LV(this,yV))}},pixelOffset:{get:function(){return this._pixelOffset},set:function(e){if(!Object(u.a)(e))throw new h.a("value is required.");var t=this._pixelOffset;Rt.equals(t,e)||(Rt.clone(e,t),LV(this,wV))}},scaleByDistance:{get:function(){return this._scaleByDistance},set:function(e){if(Object(u.a)(e)&&e.far<=e.near)throw new h.a("far distance must be greater than near distance.");var t=this._scaleByDistance;Fx.equals(t,e)||(this._scaleByDistance=Fx.clone(e,t),LV(this,IV))}},translucencyByDistance:{get:function(){return this._translucencyByDistance},set:function(e){if(Object(u.a)(e)&&e.far<=e.near)throw new h.a("far distance must be greater than near distance.");var t=this._translucencyByDistance;Fx.equals(t,e)||(this._translucencyByDistance=Fx.clone(e,t),LV(this,DV))}},pixelOffsetScaleByDistance:{get:function(){return this._pixelOffsetScaleByDistance},set:function(e){if(Object(u.a)(e)&&e.far<=e.near)throw new h.a("far distance must be greater than near distance.");var t=this._pixelOffsetScaleByDistance;Fx.equals(t,e)||(this._pixelOffsetScaleByDistance=Fx.clone(e,t),LV(this,jV))}},eyeOffset:{get:function(){return this._eyeOffset},set:function(e){if(!Object(u.a)(e))throw new h.a("value is required.");var t=this._eyeOffset;z.equals(t,e)||(z.clone(e,t),LV(this,OV))}},horizontalOrigin:{get:function(){return this._horizontalOrigin},set:function(e){if(!Object(u.a)(e))throw new h.a("value is required.");this._horizontalOrigin!==e&&(this._horizontalOrigin=e,LV(this,xV))}},verticalOrigin:{get:function(){return this._verticalOrigin},set:function(e){if(!Object(u.a)(e))throw new h.a("value is required.");this._verticalOrigin!==e&&(this._verticalOrigin=e,LV(this,EV))}},scale:{get:function(){return this._scale},set:function(e){if(!Object(u.a)(e))throw new h.a("value is required.");this._scale!==e&&(this._scale=e,LV(this,TV))}},color:{get:function(){return this._color},set:function(e){if(!Object(u.a)(e))throw new h.a("value is required.");var t=this._color;uf.equals(t,e)||(uf.clone(e,t),LV(this,SV))}},rotation:{get:function(){return this._rotation},set:function(e){if(!Object(u.a)(e))throw new h.a("value is required.");this._rotation!==e&&(this._rotation=e,LV(this,AV))}},alignedAxis:{get:function(){return this._alignedAxis},set:function(e){if(!Object(u.a)(e))throw new h.a("value is required.");var t=this._alignedAxis;z.equals(t,e)||(z.clone(e,t),LV(this,PV))}},width:{get:function(){return Object(w.a)(this._width,this._imageWidth)},set:function(e){this._width!==e&&(this._width=e,LV(this,CV))}},height:{get:function(){return Object(w.a)(this._height,this._imageHeight)},set:function(e){this._height!==e&&(this._height=e,LV(this,CV))}},sizeInMeters:{get:function(){return this._sizeInMeters},set:function(e){this._sizeInMeters!==e&&(this._sizeInMeters=e,LV(this,SV))}},distanceDisplayCondition:{get:function(){return this._distanceDisplayCondition},set:function(e){if(!gv.equals(e,this._distanceDisplayCondition)){if(Object(u.a)(e)&&e.far<=e.near)throw new h.a("far distance must be greater than near distance.");this._distanceDisplayCondition=gv.clone(e,this._distanceDisplayCondition),LV(this,MV)}}},disableDepthTestDistance:{get:function(){return this._disableDepthTestDistance},set:function(e){if(this._disableDepthTestDistance!==e){if(Object(u.a)(e)&&e<0)throw new h.a("disableDepthTestDistance must be greater than or equal to 0.0.");this._disableDepthTestDistance=e,LV(this,RV)}}},id:{get:function(){return this._id},set:function(e){this._id=e,Object(u.a)(this._pickId)&&(this._pickId.object.id=e)}},pickPrimitive:{get:function(){return this._pickPrimitive},set:function(e){this._pickPrimitive=e,Object(u.a)(this._pickId)&&(this._pickId.object.primitive=e)}},pickId:{get:function(){return this._pickId}},image:{get:function(){return this._imageId},set:function(e){Object(u.a)(e)?"string"==typeof e?this.setImage(e,e):e instanceof f.a?this.setImage(e.url,e):Object(u.a)(e.src)?this.setImage(e.src,e):this.setImage(Mg(),e):(this._imageIndex=-1,this._imageSubRegion=void 0,this._imageId=void 0,this._image=void 0,this._imageIndexPromise=void 0,LV(this,CV))}},ready:{get:function(){return-1!==this._imageIndex}},_clampedPosition:{get:function(){return this._actualClampedPosition},set:function(e){this._actualClampedPosition=z.clone(e,this._actualClampedPosition),LV(this,yV)}},clusterShow:{get:function(){return this._clusterShow},set:function(e){this._clusterShow!==e&&(this._clusterShow=e,LV(this,bV))}}}),vV.prototype.getPickId=function(e){return Object(u.a)(this._pickId)||(this._pickId=e.createPickId({primitive:this._pickPrimitive,collection:this._collection,id:this._id})),this._pickId},vV.prototype._updateClamping=function(){vV._updateClamping(this._billboardCollection,this)};var NV=new K,FV=new z;vV._updateClamping=function(e,t){var i=e._scene;if(Object(u.a)(i)&&Object(u.a)(i.globe)){var n=i.globe,r=n.ellipsoid,a=n._surface,o=i.frameState.mode,s=o!==t._mode;if(t._mode=o,(t._heightReference===eD.NONE||s)&&Object(u.a)(t._removeCallbackFunc)&&(t._removeCallbackFunc(),t._removeCallbackFunc=void 0,t._clampedPosition=void 0),t._heightReference!==eD.NONE&&Object(u.a)(t._position)){var c=r.cartesianToCartographic(t._position);if(Object(u.a)(c)){Object(u.a)(t._removeCallbackFunc)&&t._removeCallbackFunc(),t._removeCallbackFunc=a.updateHeight(c,d),K.clone(c,NV);var l=n.getHeight(c);Object(u.a)(l)&&(NV.height=l),r.cartographicToCartesian(NV,FV),d(FV)}else t._actualClampedPosition=void 0}}else if(t._heightReference!==eD.NONE)throw new h.a("Height reference is not supported without a scene and globe.");function d(e){if(t._heightReference===eD.RELATIVE_TO_GROUND)if(t._mode===xF.SCENE3D){var i=r.cartesianToCartographic(e,NV);i.height+=c.height,r.cartographicToCartesian(i,e)}else e.x+=c.height;t._clampedPosition=z.clone(e,t._clampedPosition)}},vV.prototype._loadImage=function(){var e,t=this._billboardCollection._textureAtlas,i=this._imageId,n=this._image,r=this._imageSubRegion;if(Object(u.a)(n)&&(e=t.addImage(i,n)),Object(u.a)(r)&&(e=t.addSubRegion(i,r)),this._imageIndexPromise=e,Object(u.a)(e)){var a=this;e.then((function(e){if(a._imageId===i&&a._image===n&&ln.equals(a._imageSubRegion,r)){var o=t.textureCoordinates[e];a._imageWidth=t.texture.width*o.width,a._imageHeight=t.texture.height*o.height,a._imageIndex=e,a._ready=!0,a._image=void 0,a._imageIndexPromise=void 0,LV(a,CV)}})).otherwise((function(e){console.error("Error loading image for billboard: "+e),a._imageIndexPromise=void 0}))}},vV.prototype.setImage=function(e,t){if(!Object(u.a)(e))throw new h.a("id is required.");if(!Object(u.a)(t))throw new h.a("image is required.");this._imageId!==e&&(this._imageIndex=-1,this._imageSubRegion=void 0,this._imageId=e,this._image=t,Object(u.a)(this._billboardCollection._textureAtlas)&&this._loadImage())},vV.prototype.setImageSubRegion=function(e,t){if(!Object(u.a)(e))throw new h.a("id is required.");if(!Object(u.a)(t))throw new h.a("subRegion is required.");this._imageId===e&&ln.equals(this._imageSubRegion,t)||(this._imageIndex=-1,this._imageId=e,this._imageSubRegion=ln.clone(t),Object(u.a)(this._billboardCollection._textureAtlas)&&this._loadImage())},vV.prototype._setTranslate=function(e){if(!Object(u.a)(e))throw new h.a("value is required.");var t=this._translate;Rt.equals(t,e)||(Rt.clone(e,t),LV(this,wV))},vV.prototype._getActualPosition=function(){return Object(u.a)(this._clampedPosition)?this._clampedPosition:this._actualPosition},vV.prototype._setActualPosition=function(e){Object(u.a)(this._clampedPosition)||z.clone(e,this._actualPosition),LV(this,yV)};var kV=new Te;vV._computeActualPosition=function(e,t,i,n){return Object(u.a)(e._clampedPosition)?(i.mode!==e._mode&&e._updateClamping(),e._clampedPosition):i.mode===xF.SCENE3D?t:(Be.multiplyByPoint(n,t,kV),gV.computeActualWgs84Position(i,kV))};var BV=new z;vV._computeScreenSpacePosition=function(e,t,i,n,r,a){var o=Be.multiplyByPoint(e,t,BV),s=gV.wgs84WithEyeOffsetToWindowCoordinates(r,o,i,a);if(Object(u.a)(s))return Rt.add(s,n,s),s};var zV=new Rt(0,0);vV.prototype.computeScreenSpacePosition=function(e,t){var i=this._billboardCollection;if(Object(u.a)(t)||(t=new Rt),!Object(u.a)(i))throw new h.a("Billboard must be in a collection.  Was it removed?");if(!Object(u.a)(e))throw new h.a("scene is required.");Rt.clone(this._pixelOffset,zV),Rt.add(zV,this._translate,zV);var n=i.modelMatrix,r=this._position;if(Object(u.a)(this._clampedPosition)&&(r=this._clampedPosition,e.mode!==xF.SCENE3D)){var a=e.mapProjection,o=a.ellipsoid,s=a.unproject(r,NV);r=o.cartographicToCartesian(s,BV),n=Be.IDENTITY}return vV._computeScreenSpacePosition(n,r,this._eyeOffset,zV,e,t)},vV.getScreenSpaceBoundingBox=function(e,t,i){var n=e.width,r=e.height,a=e.scale;n*=a,r*=a;var o=t.x;e.horizontalOrigin===tD.RIGHT?o-=n:e.horizontalOrigin===tD.CENTER&&(o-=.5*n);var s=t.y;return e.verticalOrigin===iD.BOTTOM||e.verticalOrigin===iD.BASELINE?s-=r:e.verticalOrigin===iD.CENTER&&(s-=.5*r),Object(u.a)(i)||(i=new ln),i.x=o,i.y=s,i.width=n,i.height=r,i},vV.prototype.equals=function(e){return this===e||Object(u.a)(e)&&this._id===e._id&&z.equals(this._position,e._position)&&this._imageId===e._imageId&&this._show===e._show&&this._scale===e._scale&&this._verticalOrigin===e._verticalOrigin&&this._horizontalOrigin===e._horizontalOrigin&&this._heightReference===e._heightReference&&ln.equals(this._imageSubRegion,e._imageSubRegion)&&uf.equals(this._color,e._color)&&Rt.equals(this._pixelOffset,e._pixelOffset)&&Rt.equals(this._translate,e._translate)&&z.equals(this._eyeOffset,e._eyeOffset)&&Fx.equals(this._scaleByDistance,e._scaleByDistance)&&Fx.equals(this._translucencyByDistance,e._translucencyByDistance)&&Fx.equals(this._pixelOffsetScaleByDistance,e._pixelOffsetScaleByDistance)&&gv.equals(this._distanceDisplayCondition,e._distanceDisplayCondition)&&this._disableDepthTestDistance===e._disableDepthTestDistance},vV.prototype._destroy=function(){Object(u.a)(this._customData)&&(this._billboardCollection._scene.globe._surface.removeTileCustomData(this._customData),this._customData=void 0),Object(u.a)(this._removeCallbackFunc)&&(this._removeCallbackFunc(),this._removeCallbackFunc=void 0),this.image=void 0,this._pickId=this._pickId&&this._pickId.destroy(),this._billboardCollection=void 0};var UV=vV;function VV(e,t,i,n){if(x.a.defined("context",e),!t||0===t.length)throw new h.a("At least one attribute is required.");var r=VV._verifyAttributes(t);i=Object(w.a)(i,0);for(var a,o,s=[],c={},l=r.length,d=0;d<l;++d){var f=r[d];f.vertexBuffer?s.push(f):(a=c[o=f.usage],Object(u.a)(a)||(a=c[o]=[]),a.push(f))}function p(e,t){return dn.getSizeInBytes(t.componentDatatype)-dn.getSizeInBytes(e.componentDatatype)}for(o in this._allBuffers=[],c)if(c.hasOwnProperty(o)){(a=c[o]).sort(p);var m=VV._vertexSizeInBytes(a),_={vertexSizeInBytes:m,vertexBuffer:void 0,usage:a[0].usage,needsCommit:!1,arrayBuffer:void 0,arrayViews:VV._createArrayViews(a,m)};this._allBuffers.push(_)}this._size=0,this._instanced=Object(w.a)(n,!1),this._precreated=s,this._context=e,this.writers=void 0,this.va=void 0,this.resize(i)}VV._verifyAttributes=function(e){for(var t=[],i=0;i<e.length;++i){var n=e[i],r={index:Object(w.a)(n.index,i),enabled:Object(w.a)(n.enabled,!0),componentsPerAttribute:n.componentsPerAttribute,componentDatatype:Object(w.a)(n.componentDatatype,dn.FLOAT),normalize:Object(w.a)(n.normalize,!1),vertexBuffer:n.vertexBuffer,usage:Object(w.a)(n.usage,YN.STATIC_DRAW)};if(t.push(r),1!==r.componentsPerAttribute&&2!==r.componentsPerAttribute&&3!==r.componentsPerAttribute&&4!==r.componentsPerAttribute)throw new h.a("attribute.componentsPerAttribute must be in the range [1, 4].");var a=r.componentDatatype;if(!dn.validate(a))throw new h.a("Attribute must have a valid componentDatatype or not specify it.");if(!YN.validate(r.usage))throw new h.a("Attribute must have a valid usage or not specify it.")}for(var o=new Array(t.length),s=0;s<t.length;++s){var c=t[s].index;if(o[c])throw new h.a("Index "+c+" is used by more than one attribute.");o[c]=!0}return t},VV._vertexSizeInBytes=function(e){for(var t=0,i=e.length,n=0;n<i;++n){var r=e[n];t+=r.componentsPerAttribute*dn.getSizeInBytes(r.componentDatatype)}var a=i>0?dn.getSizeInBytes(e[0].componentDatatype):0,o=a>0?t%a:0;return t+=0===o?0:a-o},VV._createArrayViews=function(e,t){for(var i=[],n=0,r=e.length,a=0;a<r;++a){var o=e[a],s=o.componentDatatype;i.push({index:o.index,enabled:o.enabled,componentsPerAttribute:o.componentsPerAttribute,componentDatatype:s,normalize:o.normalize,offsetInBytes:n,vertexSizeInComponentType:t/dn.getSizeInBytes(s),view:void 0}),n+=o.componentsPerAttribute*dn.getSizeInBytes(s)}return i},VV.prototype.resize=function(e){this._size=e;var t=this._allBuffers;this.writers=[];for(var i=0,n=t.length;i<n;++i){var r=t[i];VV._resize(r,this._size),VV._appendWriters(this.writers,r)}WV(this)},VV._resize=function(e,t){if(e.vertexSizeInBytes>0){var i=new ArrayBuffer(t*e.vertexSizeInBytes);if(Object(u.a)(e.arrayBuffer))for(var n=new Uint8Array(i),r=new Uint8Array(e.arrayBuffer),a=r.length,o=0;o<a;++o)n[o]=r[o];for(var s=e.arrayViews,c=s.length,l=0;l<c;++l){var h=s[l];h.view=dn.createArrayBufferView(h.componentDatatype,i,h.offsetInBytes)}e.arrayBuffer=i}};var HV=[function(e,t,i){return function(n,r){t[n*i]=r,e.needsCommit=!0}},function(e,t,i){return function(n,r,a){var o=n*i;t[o]=r,t[o+1]=a,e.needsCommit=!0}},function(e,t,i){return function(n,r,a,o){var s=n*i;t[s]=r,t[s+1]=a,t[s+2]=o,e.needsCommit=!0}},function(e,t,i){return function(n,r,a,o,s){var c=n*i;t[c]=r,t[c+1]=a,t[c+2]=o,t[c+3]=s,e.needsCommit=!0}}];function GV(e,t){if(t.needsCommit&&t.vertexSizeInBytes>0){t.needsCommit=!1;var i=t.vertexBuffer,n=e._size*t.vertexSizeInBytes,r=Object(u.a)(i);if(!r||i.sizeInBytes<n)return r&&i.destroy(),t.vertexBuffer=ZN.createVertexBuffer({context:e._context,typedArray:t.arrayBuffer,usage:t.usage}),t.vertexBuffer.vertexArrayDestroyable=!1,!0;t.vertexBuffer.copyFromArrayView(t.arrayBuffer)}return!1}function qV(e,t,i){if(e.needsCommit&&e.vertexSizeInBytes>0){var n=e.vertexSizeInBytes*t,r=e.vertexSizeInBytes*i;e.vertexBuffer.copyFromArrayView(new Uint8Array(e.arrayBuffer,n,r),n)}}function WV(e){var t=e.va;if(Object(u.a)(t)){for(var i=t.length,n=0;n<i;++n)t[n].va.destroy();e.va=void 0}}VV._appendWriters=function(e,t){for(var i=t.arrayViews,n=i.length,r=0;r<n;++r){var a=i[r];e[a.index]=HV[a.componentsPerAttribute-1](t,a.view,a.vertexSizeInComponentType)}},VV.prototype.commit=function(e){var t,i,n,r=!1,a=this._allBuffers;for(i=0,n=a.length;i<n;++i)r=GV(this,t=a[i])||r;if(r||!Object(u.a)(this.va)){WV(this);for(var o=this.va=[],s=Object(u.a)(e)?Math.ceil(this._size/(I.SIXTY_FOUR_KILOBYTES-1)):1,c=0;c<s;++c){var l=[];for(i=0,n=a.length;i<n;++i){var h=c*((t=a[i]).vertexSizeInBytes*(I.SIXTY_FOUR_KILOBYTES-1));VV._appendAttributes(l,t,h,this._instanced)}l=l.concat(this._precreated),o.push({va:new tF({context:this._context,attributes:l,indexBuffer:e}),indicesCount:1.5*(c!==s-1?I.SIXTY_FOUR_KILOBYTES-1:this._size%(I.SIXTY_FOUR_KILOBYTES-1))})}}},VV._appendAttributes=function(e,t,i,n){for(var r=t.arrayViews,a=r.length,o=0;o<a;++o){var s=r[o];e.push({index:s.index,enabled:s.enabled,componentsPerAttribute:s.componentsPerAttribute,componentDatatype:s.componentDatatype,normalize:s.normalize,vertexBuffer:t.vertexBuffer,offsetInBytes:i+s.offsetInBytes,strideInBytes:t.vertexSizeInBytes,instanceDivisor:n?1:0})}},VV.prototype.subCommit=function(e,t){if(e<0||e>=this._size)throw new h.a("offsetInVertices must be greater than or equal to zero and less than the vertex array size.");if(e+t>this._size)throw new h.a("offsetInVertices + lengthInVertices cannot exceed the vertex array size.");for(var i=this._allBuffers,n=0,r=i.length;n<r;++n)qV(i[n],e,t)},VV.prototype.endSubCommits=function(){for(var e=this._allBuffers,t=0,i=e.length;t<i;++t)e[t].needsCommit=!1},VV.prototype.isDestroyed=function(){return!1},VV.prototype.destroy=function(){for(var e=this._allBuffers,t=0,i=e.length;t<i;++t){var n=e[t];n.vertexBuffer=n.vertexBuffer&&n.vertexBuffer.destroy()}return WV(this),rl(this)};var YV=VV,XV="uniform sampler2D u_atlas;\nuniform bool u_isAnimated;\nuniform float u_numberOfCol;\nuniform float u_numberOfRow;\nuniform float u_speed;\nuniform float u_frameNumber;\n#ifdef VECTOR_TILE\nuniform vec4 u_highlightColor;\n#endif\nvarying vec2 v_textureCoordinates;\nvarying vec4 v_pickColor;\nvarying vec4 v_color;\n#ifdef FRAGMENT_DEPTH_CHECK\nvarying vec4 v_textureCoordinateBounds;\nvarying vec4 v_originTextureCoordinateAndTranslate;\nvarying vec4 v_compressed;\nvarying mat2 v_rotationMatrix;\nconst float SHIFT_LEFT12 = 4096.0;\nconst float SHIFT_LEFT1 = 2.0;\nconst float SHIFT_RIGHT12 = 1.0 / 4096.0;\nconst float SHIFT_RIGHT1 = 1.0 / 2.0;\nfloat getGlobeDepth(vec2 adjustedST, vec2 depthLookupST, bool applyTranslate, vec2 dimensions, vec2 imageSize)\n{\nvec2 lookupVector = imageSize * (depthLookupST - adjustedST);\nlookupVector = v_rotationMatrix * lookupVector;\nvec2 labelOffset = (dimensions - imageSize) * (depthLookupST - vec2(0.0, v_originTextureCoordinateAndTranslate.y));\nvec2 translation = v_originTextureCoordinateAndTranslate.zw;\nif (applyTranslate)\n{\ntranslation += (dimensions * v_originTextureCoordinateAndTranslate.xy * vec2(1.0, 0.0));\n}\nvec2 st = ((lookupVector - translation + labelOffset) + gl_FragCoord.xy) / czm_viewport.zw;\nfloat logDepthOrDepth = czm_unpackDepth(texture2D(czm_globeDepthTexture, st));\nif (logDepthOrDepth == 0.0)\n{\nreturn 0.0;\n}\nvec4 eyeCoordinate = czm_windowToEyeCoordinates(gl_FragCoord.xy, logDepthOrDepth);\nreturn eyeCoordinate.z / eyeCoordinate.w;\n}\n#endif\nvec2 animationUV(vec2 uv)\n{\nfloat speed = u_speed;\nfloat numberOfCol = u_numberOfCol;\nfloat numberOfRow = u_numberOfRow;\nfloat numberOfFrames = u_frameNumber;\nfloat frame = mod(floor(czm_frameNumber / 60.0 * speed),numberOfFrames);\nfloat sourceX = 1.0 / numberOfCol;\nfloat sourceY = 1.0 / numberOfRow;\nuv.x = (uv.x + mod(frame,numberOfCol)/2.0)*sourceX;\nuv.y = ((numberOfRow - floor(frame/numberOfCol))/2.0-uv.y)*sourceY;\nreturn uv;\n}\nvec2 animationUV2(vec2 uv)\n{\nfloat _Speed = u_speed;\nfloat _SizeX = u_numberOfCol;\nfloat _SizeY = u_numberOfRow;\nfloat col = floor(czm_frameNumber / 60.0 *_Speed / _SizeX);\nfloat row=floor(czm_frameNumber / 60.0 *_Speed-col*_SizeX);\nfloat sourceX = 1.0 / _SizeX;\nfloat sourceY=1.0/_SizeY;\nuv.x *= sourceX;\nuv.y *=sourceY;\nuv.x += row * sourceX;\nreturn uv;\n}\nvoid main()\n{\nvec4 color;\nif (u_isAnimated)\n{\ncolor = texture2D(u_atlas, animationUV(v_textureCoordinates)) * v_color;\n}\nelse\n{\ncolor = texture2D(u_atlas, v_textureCoordinates) * v_color;\n}\n#if !defined(OPAQUE) && !defined(TRANSLUCENT)\nif (color.a < 0.005)\n{\ndiscard;\n}\n#else\n#ifdef OPAQUE\nif (color.a < 0.995)\n{\ndiscard;\n}\n#else\nif (color.a >= 0.995)\n{\ndiscard;\n}\n#endif\n#endif\n#ifdef VECTOR_TILE\ncolor *= u_highlightColor;\n#endif\ngl_FragColor = color;\nczm_writeLogDepth();\n#ifdef FRAGMENT_DEPTH_CHECK\nfloat temp = v_compressed.y;\ntemp = temp * SHIFT_RIGHT1;\nfloat temp2 = (temp - floor(temp)) * SHIFT_LEFT1;\nbool enableDepthTest = temp2 != 0.0;\nbool applyTranslate = floor(temp) != 0.0;\nif (enableDepthTest) {\ntemp = v_compressed.z;\ntemp = temp * SHIFT_RIGHT12;\nvec2 dimensions;\ndimensions.y = (temp - floor(temp)) * SHIFT_LEFT12;\ndimensions.x = floor(temp);\ntemp = v_compressed.w;\ntemp = temp * SHIFT_RIGHT12;\nvec2 imageSize;\nimageSize.y = (temp - floor(temp)) * SHIFT_LEFT12;\nimageSize.x = floor(temp);\nvec2 adjustedST = v_textureCoordinates - v_textureCoordinateBounds.xy;\nadjustedST = adjustedST / vec2(v_textureCoordinateBounds.z - v_textureCoordinateBounds.x, v_textureCoordinateBounds.w - v_textureCoordinateBounds.y);\nfloat epsilonEyeDepth = v_compressed.x + czm_epsilon1;\nfloat globeDepth1 = getGlobeDepth(adjustedST, v_originTextureCoordinateAndTranslate.xy, applyTranslate, dimensions, imageSize);\nif (globeDepth1 != 0.0 && globeDepth1 > epsilonEyeDepth)\n{\nfloat globeDepth2 = getGlobeDepth(adjustedST, vec2(0.0, 1.0), applyTranslate, dimensions, imageSize);\nif (globeDepth2 != 0.0 && globeDepth2 > epsilonEyeDepth)\n{\nfloat globeDepth3 = getGlobeDepth(adjustedST, vec2(1.0, 1.0), applyTranslate, dimensions, imageSize);\nif (globeDepth3 != 0.0 && globeDepth3 > epsilonEyeDepth)\n{\ndiscard;\n}\n}\n}\n}\n#endif\n}\n",ZV="#ifdef INSTANCED\nattribute vec2 direction;\n#endif\nattribute vec4 positionHighAndScale;\nattribute vec4 positionLowAndRotation;\nattribute vec4 compressedAttribute0;\nattribute vec4 compressedAttribute1;\nattribute vec4 compressedAttribute2;\nattribute vec4 eyeOffset;\nattribute vec4 scaleByDistance;\nattribute vec4 pixelOffsetScaleByDistance;\nattribute vec4 compressedAttribute3;\n#if defined(VERTEX_DEPTH_CHECK) || defined(FRAGMENT_DEPTH_CHECK)\nattribute vec4 textureCoordinateBoundsOrLabelTranslate;\n#endif\n#ifdef VECTOR_TILE\nattribute float a_batchId;\n#endif\nvarying vec2 v_textureCoordinates;\n#ifdef FRAGMENT_DEPTH_CHECK\nvarying vec4 v_textureCoordinateBounds;\nvarying vec4 v_originTextureCoordinateAndTranslate;\nvarying vec4 v_compressed;\nvarying mat2 v_rotationMatrix;\n#endif\nvarying vec4 v_pickColor;\nvarying vec4 v_color;\nconst float UPPER_BOUND = 32768.0;\nconst float SHIFT_LEFT16 = 65536.0;\nconst float SHIFT_LEFT12 = 4096.0;\nconst float SHIFT_LEFT8 = 256.0;\nconst float SHIFT_LEFT7 = 128.0;\nconst float SHIFT_LEFT5 = 32.0;\nconst float SHIFT_LEFT3 = 8.0;\nconst float SHIFT_LEFT2 = 4.0;\nconst float SHIFT_LEFT1 = 2.0;\nconst float SHIFT_RIGHT12 = 1.0 / 4096.0;\nconst float SHIFT_RIGHT8 = 1.0 / 256.0;\nconst float SHIFT_RIGHT7 = 1.0 / 128.0;\nconst float SHIFT_RIGHT5 = 1.0 / 32.0;\nconst float SHIFT_RIGHT3 = 1.0 / 8.0;\nconst float SHIFT_RIGHT2 = 1.0 / 4.0;\nconst float SHIFT_RIGHT1 = 1.0 / 2.0;\nvec4 addScreenSpaceOffset(vec4 positionEC, vec2 imageSize, float scale, vec2 direction, vec2 origin, vec2 translate, vec2 pixelOffset, vec3 alignedAxis, bool validAlignedAxis, float rotation, bool sizeInMeters, out mat2 rotationMatrix, out float mpp)\n{\nvec2 halfSize = imageSize * scale * czm_resolutionScale * 0.5;\nhalfSize *= ((direction * 2.0) - 1.0);\nvec2 originTranslate = origin * abs(halfSize);\n#if defined(ROTATION) || defined(ALIGNED_AXIS)\nif (validAlignedAxis || rotation != 0.0)\n{\nfloat angle = rotation;\nif (validAlignedAxis)\n{\nvec4 projectedAlignedAxis = czm_modelViewProjection * vec4(alignedAxis, 0.0);\nangle += sign(-projectedAlignedAxis.x) * acos(sign(projectedAlignedAxis.y) * (projectedAlignedAxis.y * projectedAlignedAxis.y) /\n(projectedAlignedAxis.x * projectedAlignedAxis.x + projectedAlignedAxis.y * projectedAlignedAxis.y));\n}\nfloat cosTheta = cos(angle);\nfloat sinTheta = sin(angle);\nrotationMatrix = mat2(cosTheta, sinTheta, -sinTheta, cosTheta);\nhalfSize = rotationMatrix * halfSize;\n}\nelse\n{\nrotationMatrix = mat2(1.0, 0.0, 0.0, 1.0);\n}\n#endif\nif (sizeInMeters)\n{\npositionEC.xy += halfSize;\n}\nmpp = czm_metersPerPixel(positionEC);\nif (!sizeInMeters)\n{\noriginTranslate *= mpp;\n}\npositionEC.xy += originTranslate;\nif (!sizeInMeters)\n{\npositionEC.xy += halfSize * mpp;\n}\npositionEC.xy += translate * mpp;\npositionEC.xy += (pixelOffset * czm_resolutionScale) * mpp;\nreturn positionEC;\n}\n#ifdef VERTEX_DEPTH_CHECK\nfloat getGlobeDepth(vec4 positionEC)\n{\nvec4 posWC = czm_eyeToWindowCoordinates(positionEC);\nfloat globeDepth = czm_unpackDepth(texture2D(czm_globeDepthTexture, posWC.xy / czm_viewport.zw));\nreturn globeDepth == 0.0 ? 0.0 : calculateGlobeDepth(posWC.xy, globeDepth);\n}\nfloat calculateGlobeDepth(vec2 position,float depth)\n{\nvec4 eyeCoordinate = czm_windowToEyeCoordinates(position, globeDepth);\nreturn eyeCoordinate.z / eyeCoordinate.w;\n}\n#endif\nvoid main()\n{\nvec3 positionHigh = positionHighAndScale.xyz;\nvec3 positionLow = positionLowAndRotation.xyz;\nfloat scale = positionHighAndScale.w;\n#if defined(ROTATION) || defined(ALIGNED_AXIS)\nfloat rotation = positionLowAndRotation.w;\n#else\nfloat rotation = 0.0;\n#endif\nfloat compressed = compressedAttribute0.x;\nvec2 pixelOffset;\npixelOffset.x = floor(compressed * SHIFT_RIGHT7);\ncompressed -= pixelOffset.x * SHIFT_LEFT7;\npixelOffset.x -= UPPER_BOUND;\nvec2 origin;\norigin.x = floor(compressed * SHIFT_RIGHT5);\ncompressed -= origin.x * SHIFT_LEFT5;\norigin.y = floor(compressed * SHIFT_RIGHT3);\ncompressed -= origin.y * SHIFT_LEFT3;\n#ifdef FRAGMENT_DEPTH_CHECK\nvec2 depthOrigin = origin.xy;\n#endif\norigin -= vec2(1.0);\nfloat show = floor(compressed * SHIFT_RIGHT2);\ncompressed -= show * SHIFT_LEFT2;\n#ifdef INSTANCED\nvec2 textureCoordinatesBottomLeft = czm_decompressTextureCoordinates(compressedAttribute0.w);\nvec2 textureCoordinatesRange = czm_decompressTextureCoordinates(eyeOffset.w);\nvec2 textureCoordinates = textureCoordinatesBottomLeft + direction * textureCoordinatesRange;\n#else\nvec2 direction;\ndirection.x = floor(compressed * SHIFT_RIGHT1);\ndirection.y = compressed - direction.x * SHIFT_LEFT1;\nvec2 textureCoordinates = czm_decompressTextureCoordinates(compressedAttribute0.w);\n#endif\nfloat temp = compressedAttribute0.y  * SHIFT_RIGHT8;\npixelOffset.y = -(floor(temp) - UPPER_BOUND);\nvec2 translate;\ntranslate.y = (temp - floor(temp)) * SHIFT_LEFT16;\ntemp = compressedAttribute0.z * SHIFT_RIGHT8;\ntranslate.x = floor(temp) - UPPER_BOUND;\ntranslate.y += (temp - floor(temp)) * SHIFT_LEFT8;\ntranslate.y -= UPPER_BOUND;\ntemp = compressedAttribute1.x * SHIFT_RIGHT8;\nfloat temp2 = floor(compressedAttribute2.w * SHIFT_RIGHT2);\nvec2 imageSize = vec2(floor(temp), temp2);\n#ifdef FRAGMENT_DEPTH_CHECK\nfloat labelHorizontalOrigin = floor(compressedAttribute2.w - (temp2 * SHIFT_LEFT2));\nfloat applyTranslate = 0.0;\nif (labelHorizontalOrigin != 0.0)\n{\napplyTranslate = 1.0;\nlabelHorizontalOrigin -= 2.0;\ndepthOrigin.x = labelHorizontalOrigin + 1.0;\n}\ndepthOrigin = vec2(1.0) - (depthOrigin * 0.5);\n#endif\n#ifdef EYE_DISTANCE_TRANSLUCENCY\nvec4 translucencyByDistance;\ntranslucencyByDistance.x = compressedAttribute1.z;\ntranslucencyByDistance.z = compressedAttribute1.w;\ntranslucencyByDistance.y = ((temp - floor(temp)) * SHIFT_LEFT8) / 255.0;\ntemp = compressedAttribute1.y * SHIFT_RIGHT8;\ntranslucencyByDistance.w = ((temp - floor(temp)) * SHIFT_LEFT8) / 255.0;\n#endif\n#if defined(VERTEX_DEPTH_CHECK) || defined(FRAGMENT_DEPTH_CHECK)\ntemp = compressedAttribute3.w;\ntemp = temp * SHIFT_RIGHT12;\nvec2 dimensions;\ndimensions.y = (temp - floor(temp)) * SHIFT_LEFT12;\ndimensions.x = floor(temp);\n#endif\n#ifdef ALIGNED_AXIS\nvec3 alignedAxis = czm_octDecode(floor(compressedAttribute1.y * SHIFT_RIGHT8));\ntemp = compressedAttribute2.z * SHIFT_RIGHT5;\nbool validAlignedAxis = (temp - floor(temp)) * SHIFT_LEFT1 > 0.0;\n#else\nvec3 alignedAxis = vec3(0.0);\nbool validAlignedAxis = false;\n#endif\nvec4 pickColor;\nvec4 color;\ntemp = compressedAttribute2.y;\ntemp = temp * SHIFT_RIGHT8;\npickColor.b = (temp - floor(temp)) * SHIFT_LEFT8;\ntemp = floor(temp) * SHIFT_RIGHT8;\npickColor.g = (temp - floor(temp)) * SHIFT_LEFT8;\npickColor.r = floor(temp);\ntemp = compressedAttribute2.x;\ntemp = temp * SHIFT_RIGHT8;\ncolor.b = (temp - floor(temp)) * SHIFT_LEFT8;\ntemp = floor(temp) * SHIFT_RIGHT8;\ncolor.g = (temp - floor(temp)) * SHIFT_LEFT8;\ncolor.r = floor(temp);\ntemp = compressedAttribute2.z * SHIFT_RIGHT8;\nbool sizeInMeters = floor((temp - floor(temp)) * SHIFT_LEFT7) > 0.0;\ntemp = floor(temp) * SHIFT_RIGHT8;\npickColor.a = (temp - floor(temp)) * SHIFT_LEFT8;\npickColor /= 255.0;\ncolor.a = floor(temp);\ncolor /= 255.0;\nvec4 p = czm_translateRelativeToEye(positionHigh, positionLow);\nvec4 positionEC = czm_modelViewRelativeToEye * p;\n#if defined(FRAGMENT_DEPTH_CHECK) || defined(VERTEX_DEPTH_CHECK)\nfloat eyeDepth = positionEC.z;\n#endif\npositionEC = czm_eyeOffset(positionEC, eyeOffset.xyz);\npositionEC.xyz *= show;\n#if defined(EYE_DISTANCE_SCALING) || defined(EYE_DISTANCE_TRANSLUCENCY) || defined(EYE_DISTANCE_PIXEL_OFFSET) || defined(DISTANCE_DISPLAY_CONDITION) || defined(DISABLE_DEPTH_DISTANCE)\nfloat lengthSq;\nif (czm_sceneMode == czm_sceneMode2D)\n{\nlengthSq = czm_eyeHeight2D.y;\n}\nelse\n{\nlengthSq = dot(positionEC.xyz, positionEC.xyz);\n}\n#endif\n#ifdef EYE_DISTANCE_SCALING\nfloat distanceScale = czm_nearFarScalar(scaleByDistance, lengthSq);\nscale *= distanceScale;\ntranslate *= distanceScale;\nif (scale == 0.0)\n{\npositionEC.xyz = vec3(0.0);\n}\n#endif\nfloat translucency = 1.0;\n#ifdef EYE_DISTANCE_TRANSLUCENCY\ntranslucency = czm_nearFarScalar(translucencyByDistance, lengthSq);\nif (translucency == 0.0)\n{\npositionEC.xyz = vec3(0.0);\n}\n#endif\n#ifdef EYE_DISTANCE_PIXEL_OFFSET\nfloat pixelOffsetScale = czm_nearFarScalar(pixelOffsetScaleByDistance, lengthSq);\npixelOffset *= pixelOffsetScale;\n#endif\n#ifdef DISTANCE_DISPLAY_CONDITION\nfloat nearSq = compressedAttribute3.x;\nfloat farSq = compressedAttribute3.y;\nif (lengthSq < nearSq || lengthSq > farSq)\n{\npositionEC.xyz = vec3(0.0);\n}\n#endif\nmat2 rotationMatrix;\nfloat mpp;\n#ifdef DISABLE_DEPTH_DISTANCE\nfloat disableDepthTestDistance = compressedAttribute3.z;\n#endif\n#ifdef VERTEX_DEPTH_CHECK\nif (lengthSq < disableDepthTestDistance) {\nfloat depthsilon = 10.0;\nvec2 labelTranslate = textureCoordinateBoundsOrLabelTranslate.xy;\nvec4 pEC1 = addScreenSpaceOffset(positionEC, dimensions, scale, vec2(0.0), origin, labelTranslate, pixelOffset, alignedAxis, validAlignedAxis, rotation, sizeInMeters, rotationMatrix, mpp);\nfloat globeDepth1 = getGlobeDepth(pEC1);\nif (globeDepth1 != 0.0 && pEC1.z + depthsilon < globeDepth1)\n{\nvec4 pEC2 = addScreenSpaceOffset(positionEC, dimensions, scale, vec2(0.0, 1.0), origin, labelTranslate, pixelOffset, alignedAxis, validAlignedAxis, rotation, sizeInMeters, rotationMatrix, mpp);\nfloat globeDepth2 = getGlobeDepth(pEC2);\nif (globeDepth2 != 0.0 && pEC2.z + depthsilon < globeDepth2)\n{\nvec4 pEC3 = addScreenSpaceOffset(positionEC, dimensions, scale, vec2(1.0), origin, labelTranslate, pixelOffset, alignedAxis, validAlignedAxis, rotation, sizeInMeters, rotationMatrix, mpp);\nfloat globeDepth3 = getGlobeDepth(pEC3);\nif (globeDepth3 != 0.0 && pEC3.z + depthsilon < globeDepth3)\n{\npositionEC.xyz = vec3(0.0);\n}\n}\n}\n}\n#endif\npositionEC = addScreenSpaceOffset(positionEC, imageSize, scale, direction, origin, translate, pixelOffset, alignedAxis, validAlignedAxis, rotation, sizeInMeters, rotationMatrix, mpp);\ngl_Position = czm_projection * positionEC;\nv_textureCoordinates = textureCoordinates;\n#ifdef LOG_DEPTH\nczm_vertexLogDepth();\n#endif\n#ifdef DISABLE_DEPTH_DISTANCE\nif (disableDepthTestDistance == 0.0 && czm_minimumDisableDepthTestDistance != 0.0)\n{\ndisableDepthTestDistance = czm_minimumDisableDepthTestDistance;\n}\nif (disableDepthTestDistance != 0.0)\n{\nfloat zclip = gl_Position.z / gl_Position.w;\nbool clipped = (zclip < -1.0 || zclip > 1.0);\nif (!clipped && (disableDepthTestDistance < 0.0 || (lengthSq > 0.0 && lengthSq < disableDepthTestDistance)))\n{\ngl_Position.z = -gl_Position.w;\n#ifdef LOG_DEPTH\nczm_vertexLogDepth(vec4(czm_currentFrustum.x));\n#endif\n}\n}\n#endif\n#ifdef FRAGMENT_DEPTH_CHECK\nif (sizeInMeters) {\ntranslate /= mpp;\ndimensions /= mpp;\nimageSize /= mpp;\n}\n#if defined(ROTATION) || defined(ALIGNED_AXIS)\nv_rotationMatrix = rotationMatrix;\n#else\nv_rotationMatrix = mat2(1.0, 0.0, 0.0, 1.0);\n#endif\nfloat enableDepthCheck = 0.0;\nif (lengthSq < disableDepthTestDistance)\n{\nenableDepthCheck = 1.0;\n}\nfloat dw = floor(clamp(dimensions.x, 0.0, SHIFT_LEFT12));\nfloat dh = floor(clamp(dimensions.y, 0.0, SHIFT_LEFT12));\nfloat iw = floor(clamp(imageSize.x, 0.0, SHIFT_LEFT12));\nfloat ih = floor(clamp(imageSize.y, 0.0, SHIFT_LEFT12));\nv_compressed.x = eyeDepth;\nv_compressed.y = applyTranslate * SHIFT_LEFT1 + enableDepthCheck;\nv_compressed.z = dw * SHIFT_LEFT12 + dh;\nv_compressed.w = iw * SHIFT_LEFT12 + ih;\nv_originTextureCoordinateAndTranslate.xy = depthOrigin;\nv_originTextureCoordinateAndTranslate.zw = translate;\nv_textureCoordinateBounds = textureCoordinateBoundsOrLabelTranslate;\n#endif\nv_pickColor = pickColor;\nv_color = color;\nv_color.a *= translucency;\n}\n",QV=Object(E.a)({OPAQUE:0,TRANSLUCENT:1,OPAQUE_AND_TRANSLUCENT:2});function KV(e,t,i,n,r){this.bottomLeft=Object(w.a)(e,Rt.ZERO),this.topRight=Object(w.a)(t,Rt.ZERO),this.childNode1=i,this.childNode2=n,this.imageIndex=r}var JV=new Rt(16,16);function $V(e){e=Object(w.a)(e,w.a.EMPTY_OBJECT);var t=Object(w.a)(e.borderWidthInPixels,1),i=Object(w.a)(e.initialSize,JV);if(!Object(u.a)(e.context))throw new h.a("context is required.");if(t<0)throw new h.a("borderWidthInPixels must be greater than or equal to zero.");if(i.x<1||i.y<1)throw new h.a("initialSize must be greater than zero.");this._context=e.context,this._pixelFormat=Object(w.a)(e.pixelFormat,gx.RGBA),this._borderWidthInPixels=t,this._textureCoordinates=[],this._guid=Mg(),this._idHash={},this._initialSize=i,this._root=void 0}function eH(e,t,i){var n=function e(t,i,n){if(Object(u.a)(i)){if(!Object(u.a)(i.childNode1)&&!Object(u.a)(i.childNode2)){if(Object(u.a)(i.imageIndex))return;var r=i.topRight.x-i.bottomLeft.x,a=i.topRight.y-i.bottomLeft.y,o=r-n.width,s=a-n.height;if(o<0||s<0)return;if(0===o&&0===s)return i;if(o>s){i.childNode1=new KV(new Rt(i.bottomLeft.x,i.bottomLeft.y),new Rt(i.bottomLeft.x+n.width,i.topRight.y));var c=i.bottomLeft.x+n.width+t._borderWidthInPixels;c<i.topRight.x&&(i.childNode2=new KV(new Rt(c,i.bottomLeft.y),new Rt(i.topRight.x,i.topRight.y)))}else{i.childNode1=new KV(new Rt(i.bottomLeft.x,i.bottomLeft.y),new Rt(i.topRight.x,i.bottomLeft.y+n.height));var l=i.bottomLeft.y+n.height+t._borderWidthInPixels;l<i.topRight.y&&(i.childNode2=new KV(new Rt(i.bottomLeft.x,l),new Rt(i.topRight.x,i.topRight.y)))}return e(t,i.childNode1,n)}return e(t,i.childNode1,n)||e(t,i.childNode2,n)}}(e,e._root,t);if(Object(u.a)(n)){n.imageIndex=i;var r=e._texture.width,a=e._texture.height,o=n.topRight.x-n.bottomLeft.x,s=n.topRight.y-n.bottomLeft.y,c=n.bottomLeft.x/r,l=n.bottomLeft.y/a,h=o/r,d=s/a;e._textureCoordinates[i]=new ln(c,l,h,d),e._texture.copyFrom(t,n.bottomLeft.x,n.bottomLeft.y)}else!function(e,t){var i=e._context,n=e.numberOfImages,r=e._borderWidthInPixels;if(n>0){for(var a=e._texture.width,o=e._texture.height,s=2*(a+t.width+r),c=2*(o+t.height+r),l=a/s,h=o/c,d=new KV(new Rt(a+r,r),new Rt(s,o)),f=new KV(new Rt,new Rt(s,o),e._root,d),p=new KV(new Rt(r,o+r),new Rt(s,c)),m=new KV(new Rt,new Rt(s,c),f,p),_=0;_<e._textureCoordinates.length;_++){var g=e._textureCoordinates[_];Object(u.a)(g)&&(g.x*=l,g.y*=h,g.width*=l,g.height*=h)}var v=new hj({context:e._context,width:s,height:c,pixelFormat:e._pixelFormat}),b=new cj({context:i,colorTextures:[e._texture],destroyAttachments:!1});b._bind(),v.copyFromFramebuffer(0,0,0,0,s,c),b._unBind(),b.destroy(),e._texture=e._texture&&e._texture.destroy(),e._texture=v,e._root=m}else{var y=2*(t.width+2*r),w=2*(t.height+2*r);y<e._initialSize.x&&(y=e._initialSize.x),w<e._initialSize.y&&(w=e._initialSize.y),e._texture=e._texture&&e._texture.destroy(),e._texture=new hj({context:e._context,width:y,height:w,pixelFormat:e._pixelFormat}),e._root=new KV(new Rt(r,r),new Rt(y,w))}}(e,t),eH(e,t,i);e._guid=Mg()}Object(O.a)($V.prototype,{borderWidthInPixels:{get:function(){return this._borderWidthInPixels}},textureCoordinates:{get:function(){return this._textureCoordinates}},texture:{get:function(){return Object(u.a)(this._texture)||(this._texture=new hj({context:this._context,width:this._initialSize.x,height:this._initialSize.y,pixelFormat:this._pixelFormat})),this._texture}},numberOfImages:{get:function(){return this._textureCoordinates.length}},guid:{get:function(){return this._guid}}}),$V.prototype.addImage=function(e,t){if(!Object(u.a)(e))throw new h.a("id is required.");if(!Object(u.a)(t))throw new h.a("image is required.");var i=this._idHash[e];if(Object(u.a)(i))return i;if("function"==typeof t){if(t=t(e),!Object(u.a)(t))throw new h.a("image is required.")}else if("string"==typeof t||t instanceof f.a){t=f.a.createIfNeeded(t).fetchImage()}var n=this;return i=Object(Oi.a)(t,(function(e){if(n.isDestroyed())return-1;var t=n.numberOfImages;return eH(n,e,t),t})),this._idHash[e]=i,i},$V.prototype.addSubRegion=function(e,t){if(!Object(u.a)(e))throw new h.a("id is required.");if(!Object(u.a)(t))throw new h.a("subRegion is required.");var i=this._idHash[e];if(!Object(u.a)(i))throw new Ce.a('image with id "'+e+'" not found in the atlas.');var n=this;return Object(Oi.a)(i,(function(e){if(-1===e)return-1;var i=n._texture.width,r=n._texture.height,a=n.numberOfImages,o=n._textureCoordinates[e],s=o.x+t.x/i,c=o.y+t.y/r,l=t.width/i,u=t.height/r;return n._textureCoordinates.push(new ln(s,c,l,u)),n._guid=Mg(),a}))},$V.prototype.isDestroyed=function(){return!1},$V.prototype.destroy=function(){return this._texture=this._texture&&this._texture.destroy(),rl(this)};var tH,iH,nH=$V,rH=UV.SHOW_INDEX,aH=UV.POSITION_INDEX,oH=UV.PIXEL_OFFSET_INDEX,sH=UV.EYE_OFFSET_INDEX,cH=UV.HORIZONTAL_ORIGIN_INDEX,lH=UV.VERTICAL_ORIGIN_INDEX,uH=UV.SCALE_INDEX,hH=UV.IMAGE_INDEX_INDEX,dH=UV.COLOR_INDEX,fH=UV.ROTATION_INDEX,pH=UV.ALIGNED_AXIS_INDEX,mH=UV.SCALE_BY_DISTANCE_INDEX,_H=UV.TRANSLUCENCY_BY_DISTANCE_INDEX,gH=UV.PIXEL_OFFSET_SCALE_BY_DISTANCE_INDEX,vH=UV.DISTANCE_DISPLAY_CONDITION,bH=UV.DISABLE_DEPTH_DISTANCE,yH=UV.TEXTURE_COORDINATE_BOUNDS,wH=UV.NUMBER_OF_PROPERTIES,OH={positionHighAndScale:0,positionLowAndRotation:1,compressedAttribute0:2,compressedAttribute1:3,compressedAttribute2:4,eyeOffset:5,scaleByDistance:6,pixelOffsetScaleByDistance:7,compressedAttribute3:8,textureCoordinateBoundsOrLabelTranslate:9,a_batchId:10},xH={direction:0,positionHighAndScale:1,positionLowAndRotation:2,compressedAttribute0:3,compressedAttribute1:4,compressedAttribute2:5,eyeOffset:6,scaleByDistance:7,pixelOffsetScaleByDistance:8,compressedAttribute3:9,textureCoordinateBoundsOrLabelTranslate:10,a_batchId:11};function EH(e){e=Object(w.a)(e,w.a.EMPTY_OBJECT),this._scene=e.scene,this._batchTable=e.batchTable,this._textureAtlas=void 0,this._textureAtlasGUID=void 0,this._destroyTextureAtlas=!0,this._sp=void 0,this._spTranslucent=void 0,this._rsOpaque=void 0,this._rsTranslucent=void 0,this._vaf=void 0,this._billboards=[],this._billboardsToUpdate=[],this._billboardsToUpdateIndex=0,this._billboardsRemoved=!1,this._createVertexArray=!1,this._shaderRotation=!1,this._compiledShaderRotation=!1,this._shaderAlignedAxis=!1,this._compiledShaderAlignedAxis=!1,this._shaderScaleByDistance=!1,this._compiledShaderScaleByDistance=!1,this._shaderTranslucencyByDistance=!1,this._compiledShaderTranslucencyByDistance=!1,this._shaderPixelOffsetScaleByDistance=!1,this._compiledShaderPixelOffsetScaleByDistance=!1,this._shaderDistanceDisplayCondition=!1,this._compiledShaderDistanceDisplayCondition=!1,this._shaderDisableDepthDistance=!1,this._compiledShaderDisableDepthDistance=!1,this._shaderClampToGround=!1,this._compiledShaderClampToGround=!1,this._propertiesChanged=new Uint32Array(wH),this._maxSize=0,this._maxEyeOffset=0,this._maxScale=1,this._maxPixelOffset=0,this._allHorizontalCenter=!0,this._allVerticalCenter=!0,this._allSizedInMeters=!0,this._baseVolume=new St,this._baseVolumeWC=new St,this._baseVolume2D=new St,this._boundingVolume=new St,this._boundingVolumeDirty=!1,this._colorCommands=[],this.modelMatrix=Be.clone(Object(w.a)(e.modelMatrix,Be.IDENTITY)),this._modelMatrix=Be.clone(Be.IDENTITY),this.debugShowBoundingVolume=Object(w.a)(e.debugShowBoundingVolume,!1),this.blendOption=Object(w.a)(e.blendOption,QV.OPAQUE_AND_TRANSLUCENT),this._blendOption=void 0,this._mode=xF.SCENE3D,this._buffersUsage=[YN.STATIC_DRAW,YN.STATIC_DRAW,YN.STATIC_DRAW,YN.STATIC_DRAW,YN.STATIC_DRAW,YN.STATIC_DRAW,YN.STATIC_DRAW,YN.STATIC_DRAW,YN.STATIC_DRAW,YN.STATIC_DRAW,YN.STATIC_DRAW,YN.STATIC_DRAW,YN.STATIC_DRAW,YN.STATIC_DRAW,YN.STATIC_DRAW,YN.STATIC_DRAW],this._highlightColor=uf.clone(uf.WHITE),this._isAnimated=Object(w.a)(e.isAnimated,!1),Object(u.a)(e.animation)?(this._numberOfCol=Object(w.a)(e.animation.numberOfCol,1),this._numberOfRow=Object(w.a)(e.animation.numberOfRow,1),this._speed=Object(w.a)(e.animation.speed,1),this._frameNumber=Object(w.a)(e.animation.frameNumber,1)):(this._numberOfCol=1,this._numberOfRow=1,this._speed=1,this._frameNumber=1);var t=this;this._uniforms={u_atlas:function(){return t._textureAtlas.texture},u_highlightColor:function(){return t._highlightColor},u_isAnimated:function(){return t._isAnimated},u_numberOfCol:function(){return t._numberOfCol},u_numberOfRow:function(){return t._numberOfRow},u_speed:function(){return t._speed},u_frameNumber:function(){return t._frameNumber}};var i=this._scene;Object(u.a)(i)&&Object(u.a)(i.terrainProviderChanged)&&(this._removeCallbackFunc=i.terrainProviderChanged.addEventListener((function(){for(var e=this._billboards,t=e.length,i=0;i<t;++i)e[i]._updateClamping()}),this))}function TH(e){for(var t=e.length,i=0;i<t;++i)e[i]&&e[i]._destroy()}function CH(e){if(e._billboardsRemoved){e._billboardsRemoved=!1;for(var t=[],i=e._billboards,n=i.length,r=0,a=0;r<n;++r){var o=i[r];o&&(o._index=a++,t.push(o))}e._billboards=t}}function SH(e){var t=e.cache.billboardCollection_indexBufferBatched;if(Object(u.a)(t))return t;for(var i=new Uint16Array(98298),n=0,r=0;n<98298;n+=6,r+=4)i[n]=r,i[n+1]=r+1,i[n+2]=r+2,i[n+3]=r+0,i[n+4]=r+2,i[n+5]=r+3;return(t=ZN.createIndexBuffer({context:e,typedArray:i,usage:YN.STATIC_DRAW,indexDatatype:Sl.UNSIGNED_SHORT})).vertexArrayDestroyable=!1,e.cache.billboardCollection_indexBufferBatched=t,t}function AH(e){var t=e.cache.billboardCollection_indexBufferInstanced;return Object(u.a)(t)?t:((t=ZN.createIndexBuffer({context:e,typedArray:new Uint16Array([0,1,2,0,2,3]),usage:YN.STATIC_DRAW,indexDatatype:Sl.UNSIGNED_SHORT})).vertexArrayDestroyable=!1,e.cache.billboardCollection_indexBufferInstanced=t,t)}function PH(e){var t=e.cache.billboardCollection_vertexBufferInstanced;return Object(u.a)(t)?t:((t=ZN.createVertexBuffer({context:e,typedArray:new Float32Array([0,0,1,0,1,1,0,1]),usage:YN.STATIC_DRAW})).vertexArrayDestroyable=!1,e.cache.billboardCollection_vertexBufferInstanced=t,t)}Object(O.a)(EH.prototype,{length:{get:function(){return CH(this),this._billboards.length}},textureAtlas:{get:function(){return this._textureAtlas},set:function(e){this._textureAtlas!==e&&(this._textureAtlas=this._destroyTextureAtlas&&this._textureAtlas&&this._textureAtlas.destroy(),this._textureAtlas=e,this._createVertexArray=!0)}},destroyTextureAtlas:{get:function(){return this._destroyTextureAtlas},set:function(e){this._destroyTextureAtlas=e}}}),EH.prototype.add=function(e){var t=new UV(e,this);return t._index=this._billboards.length,this._billboards.push(t),this._createVertexArray=!0,t},EH.prototype.remove=function(e){return!!this.contains(e)&&(this._billboards[e._index]=null,this._billboardsRemoved=!0,this._createVertexArray=!0,e._destroy(),!0)},EH.prototype.removeAll=function(){TH(this._billboards),this._billboards=[],this._billboardsToUpdate=[],this._billboardsToUpdateIndex=0,this._billboardsRemoved=!1,this._createVertexArray=!0},EH.prototype._updateBillboard=function(e,t){e._dirty||(this._billboardsToUpdate[this._billboardsToUpdateIndex++]=e),++this._propertiesChanged[t]},EH.prototype.contains=function(e){return Object(u.a)(e)&&e._billboardCollection===this},EH.prototype.get=function(e){if(!Object(u.a)(e))throw new h.a("index is required.");return CH(this),this._billboards[e]},EH.prototype.computeNewBuffersUsage=function(){for(var e=this._buffersUsage,t=!1,i=this._propertiesChanged,n=0;n<wH;++n){var r=0===i[n]?YN.STATIC_DRAW:YN.STREAM_DRAW;t=t||e[n]!==r,e[n]=r}return t};var IH=new Fu;function DH(e,t,i,n,r){var a,o=n[tH.positionHighAndScale],s=n[tH.positionLowAndRotation],c=r._getActualPosition();e._mode===xF.SCENE3D&&(St.expand(e._baseVolume,c,e._baseVolume),e._boundingVolumeDirty=!0),Fu.fromCartesian(c,IH);var l=r.scale,u=r.rotation;0!==u&&(e._shaderRotation=!0),e._maxScale=Math.max(e._maxScale,l);var h=IH.high,d=IH.low;e._instanced?(o(a=r._index,h.x,h.y,h.z,l),s(a,d.x,d.y,d.z,u)):(o((a=4*r._index)+0,h.x,h.y,h.z,l),o(a+1,h.x,h.y,h.z,l),o(a+2,h.x,h.y,h.z,l),o(a+3,h.x,h.y,h.z,l),s(a+0,d.x,d.y,d.z,u),s(a+1,d.x,d.y,d.z,u),s(a+2,d.x,d.y,d.z,u),s(a+3,d.x,d.y,d.z,u))}var jH=new Rt,MH=32768,RH=65536,LH=4096,NH=256,FH=128,kH=32,BH=8,zH=4,UH=1/256,VH=0,HH=2,GH=3,qH=1;function WH(e,t,i,n,r){var a,o=n[tH.compressedAttribute0],s=r.pixelOffset,c=s.x,l=s.y,d=r._translate,f=d.x,p=d.y;e._maxPixelOffset=Math.max(e._maxPixelOffset,Math.abs(c+f),Math.abs(-l+p));var m=r.horizontalOrigin,_=r._verticalOrigin,g=r.show&&r.clusterShow;0===r.color.alpha&&(g=!1),_===iD.BASELINE&&(_=iD.BOTTOM),e._allHorizontalCenter=e._allHorizontalCenter&&m===tD.CENTER,e._allVerticalCenter=e._allVerticalCenter&&_===iD.CENTER;var v=0,b=0,y=0,w=0,O=r._imageIndex;if(-1!==O){var x=i[O];if(!Object(u.a)(x))throw new h.a("Invalid billboard image index: "+O);v=x.x,b=x.y,y=x.width,w=x.height}var E=v+y,T=b+w,C=Math.floor(I.clamp(c,-MH,MH)+MH)*FH;C+=(m+1)*kH,C+=(_+1)*BH,C+=(g?1:0)*zH;var S=Math.floor(I.clamp(l,-MH,MH)+MH)*NH,A=Math.floor(I.clamp(f,-MH,MH)+MH)*NH,P=(I.clamp(p,-MH,MH)+MH)*UH,D=Math.floor(P);S+=D,A+=Math.floor((P-D)*NH),jH.x=v,jH.y=b;var j=Gi.compressTextureCoordinates(jH);jH.x=E;var M=Gi.compressTextureCoordinates(jH);jH.y=T;var R=Gi.compressTextureCoordinates(jH);jH.x=v;var L=Gi.compressTextureCoordinates(jH);e._instanced?o(a=r._index,C,S,A,j):(o((a=4*r._index)+0,C+VH,S,A,j),o(a+1,C+HH,S,A,M),o(a+2,C+GH,S,A,R),o(a+3,C+qH,S,A,L))}function YH(e,t,i,n,r){var a,o=n[tH.compressedAttribute1],s=r.alignedAxis;z.equals(s,z.ZERO)||(e._shaderAlignedAxis=!0);var c=0,l=1,d=1,f=1,p=r.translucencyByDistance;Object(u.a)(p)&&(c=p.near,l=p.nearValue,d=p.far,f=p.farValue,1===l&&1===f||(e._shaderTranslucencyByDistance=!0));var m=0,_=r._imageIndex;if(-1!==_){var g=i[_];if(!Object(u.a)(g))throw new h.a("Invalid billboard image index: "+_);m=g.width}var v=e._textureAtlas.texture.width,b=Math.round(Object(w.a)(r.width,v*m));e._maxSize=Math.max(e._maxSize,b);var y=I.clamp(b,0,RH),O=0;Math.abs(z.magnitudeSquared(s)-1)<I.EPSILON6&&(O=Gi.octEncodeFloat(s)),l=I.clamp(l,0,1),y=y*NH+(l=1===l?255:255*l|0),f=I.clamp(f,0,1),O=O*NH+(f=1===f?255:255*f|0),e._instanced?o(a=r._index,y,O,c,d):(o((a=4*r._index)+0,y,O,c,d),o(a+1,y,O,c,d),o(a+2,y,O,c,d),o(a+3,y,O,c,d))}function XH(e,t,i,n,r){var a,o=n[tH.compressedAttribute2],s=r.color,c=Object(u.a)(e._batchTable)?uf.WHITE:r.getPickId(t).color,l=r.sizeInMeters?1:0,d=Math.abs(z.magnitudeSquared(r.alignedAxis)-1)<I.EPSILON6?1:0;e._allSizedInMeters=e._allSizedInMeters&&1===l;var f=0,p=r._imageIndex;if(-1!==p){var m=i[p];if(!Object(u.a)(m))throw new h.a("Invalid billboard image index: "+p);f=m.height}var _=e._textureAtlas.texture.dimensions,g=Math.round(Object(w.a)(r.height,_.y*f));e._maxSize=Math.max(e._maxSize,g);var v=Object(w.a)(r._labelHorizontalOrigin,-2),b=g*zH+(v+=2),y=uf.floatToByte(s.red),O=uf.floatToByte(s.green),x=uf.floatToByte(s.blue),E=y*RH+O*NH+x;y=uf.floatToByte(c.red),O=uf.floatToByte(c.green),x=uf.floatToByte(c.blue);var T=y*RH+O*NH+x,C=uf.floatToByte(s.alpha)*RH+uf.floatToByte(c.alpha)*NH;C+=2*l+d,e._instanced?o(a=r._index,E,T,C,b):(o((a=4*r._index)+0,E,T,C,b),o(a+1,E,T,C,b),o(a+2,E,T,C,b),o(a+3,E,T,C,b))}function ZH(e,t,i,n,r){var a,o=n[tH.eyeOffset],s=r.eyeOffset,c=s.z;if(r._heightReference!==eD.NONE&&(c*=1.005),e._maxEyeOffset=Math.max(e._maxEyeOffset,Math.abs(s.x),Math.abs(s.y),Math.abs(c)),e._instanced){var l=0,d=0,f=r._imageIndex;if(-1!==f){var p=i[f];if(!Object(u.a)(p))throw new h.a("Invalid billboard image index: "+f);l=p.width,d=p.height}jH.x=l,jH.y=d;var m=Gi.compressTextureCoordinates(jH);o(a=r._index,s.x,s.y,c,m)}else o((a=4*r._index)+0,s.x,s.y,c,0),o(a+1,s.x,s.y,c,0),o(a+2,s.x,s.y,c,0),o(a+3,s.x,s.y,c,0)}function QH(e,t,i,n,r){var a,o=n[tH.scaleByDistance],s=0,c=1,l=1,h=1,d=r.scaleByDistance;Object(u.a)(d)&&(s=d.near,c=d.nearValue,l=d.far,h=d.farValue,1===c&&1===h||(e._shaderScaleByDistance=!0)),e._instanced?o(a=r._index,s,c,l,h):(o((a=4*r._index)+0,s,c,l,h),o(a+1,s,c,l,h),o(a+2,s,c,l,h),o(a+3,s,c,l,h))}function KH(e,t,i,n,r){var a,o=n[tH.pixelOffsetScaleByDistance],s=0,c=1,l=1,h=1,d=r.pixelOffsetScaleByDistance;Object(u.a)(d)&&(s=d.near,c=d.nearValue,l=d.far,h=d.farValue,1===c&&1===h||(e._shaderPixelOffsetScaleByDistance=!0)),e._instanced?o(a=r._index,s,c,l,h):(o((a=4*r._index)+0,s,c,l,h),o(a+1,s,c,l,h),o(a+2,s,c,l,h),o(a+3,s,c,l,h))}function JH(e,t,i,n,r){var a,o=n[tH.compressedAttribute3],s=0,c=Number.MAX_VALUE,l=r.distanceDisplayCondition;Object(u.a)(l)&&(s=l.near,c=l.far,s*=s,c*=c,e._shaderDistanceDisplayCondition=!0);var d,f,p=r.disableDepthTestDistance,m=r.heightReference===eD.CLAMP_TO_GROUND&&e._scene.context.depthTexture;if(Object(u.a)(p)||(p=m?5e3:0),p*=p,(m||p>0)&&(e._shaderDisableDepthDistance=!0,p===Number.POSITIVE_INFINITY&&(p=-1)),Object(u.a)(r._labelDimensions))f=r._labelDimensions.x,d=r._labelDimensions.y;else{var _=0,g=0,v=r._imageIndex;if(-1!==v){var b=i[v];if(!Object(u.a)(b))throw new h.a("Invalid billboard image index: "+v);_=b.height,g=b.width}d=Math.round(Object(w.a)(r.height,e._textureAtlas.texture.dimensions.y*_));var y=e._textureAtlas.texture.width;f=Math.round(Object(w.a)(r.width,y*g))}var O=Math.floor(I.clamp(f,0,LH)),x=Math.floor(I.clamp(d,0,LH)),E=O*LH+x;e._instanced?o(a=r._index,s,c,p,E):(o((a=4*r._index)+0,s,c,p,E),o(a+1,s,c,p,E),o(a+2,s,c,p,E),o(a+3,s,c,p,E))}function $H(e,t,i,n,r){var a;r.heightReference===eD.CLAMP_TO_GROUND&&(e._shaderClampToGround=e._scene.context.depthTexture);var o=n[tH.textureCoordinateBoundsOrLabelTranslate];if(HD.maximumVertexTextureImageUnits>0){var s=0,c=0;return Object(u.a)(r._labelTranslate)&&(s=r._labelTranslate.x,c=r._labelTranslate.y),void(e._instanced?o(a=r._index,s,c,0,0):(o((a=4*r._index)+0,s,c,0,0),o(a+1,s,c,0,0),o(a+2,s,c,0,0),o(a+3,s,c,0,0)))}var l=0,d=0,f=0,p=0,m=r._imageIndex;if(-1!==m){var _=i[m];if(!Object(u.a)(_))throw new h.a("Invalid billboard image index: "+m);l=_.x,d=_.y,f=_.width,p=_.height}var g=l+f,v=d+p;e._instanced?o(a=r._index,l,d,g,v):(o((a=4*r._index)+0,l,d,g,v),o(a+1,l,d,g,v),o(a+2,l,d,g,v),o(a+3,l,d,g,v))}function eG(e,t,i,n,r){DH(e,0,0,n,r),WH(e,0,i,n,r),YH(e,0,i,n,r),XH(e,t,i,n,r),ZH(e,0,i,n,r),QH(e,0,0,n,r),KH(e,0,0,n,r),JH(e,0,i,n,r),$H(e,0,i,n,r),function(e,t,i,n,r){if(Object(u.a)(e._batchTable)){var a,o=n[tH.a_batchId],s=r._batchIndex;e._instanced?o(a=r._index,s):(o((a=4*r._index)+0,s),o(a+1,s),o(a+2,s),o(a+3,s))}}(e,0,0,n,r)}function tG(e,t,i,n,r,a){var o;n.mode===xF.SCENE3D?(o=e._baseVolume,e._boundingVolumeDirty=!0):o=e._baseVolume2D;for(var s=[],c=0;c<i;++c){var l=t[c],h=l.position,d=UV._computeActualPosition(l,h,n,r);Object(u.a)(d)&&(l._setActualPosition(d),a?s.push(d):St.expand(o,d,o))}a&&St.fromPoints(s,o)}var iG=[];EH.prototype.update=function(e){CH(this);var t=this._billboards,i=t.length,n=e.context;this._instanced=n.instancedArrays,tH=this._instanced?xH:OH,iH=this._instanced?AH:SH;var r=this._textureAtlas;if(!Object(u.a)(r)){r=this._textureAtlas=new nH({context:n});for(var a=0;a<i;++a)t[a]._loadImage()}var o=r.textureCoordinates;if(0!==o.length){!function(e,t){var i=t.mode,n=e._billboards,r=e._billboardsToUpdate,a=e._modelMatrix;e._createVertexArray||e._mode!==i||i!==xF.SCENE3D&&!Be.equals(a,e.modelMatrix)?(e._mode=i,Be.clone(e.modelMatrix,a),e._createVertexArray=!0,i!==xF.SCENE3D&&i!==xF.SCENE2D&&i!==xF.COLUMBUS_VIEW||tG(e,n,n.length,t,a,!0)):i===xF.MORPHING?tG(e,n,n.length,t,a,!0):i!==xF.SCENE2D&&i!==xF.COLUMBUS_VIEW||tG(e,r,e._billboardsToUpdateIndex,t,a,!1)}(this,e),i=(t=this._billboards).length;var s,c=this._billboardsToUpdate,l=this._billboardsToUpdateIndex,h=this._propertiesChanged,d=r.guid,f=this._createVertexArray||this._textureAtlasGUID!==d;this._textureAtlasGUID=d;var p=e.passes,m=p.pick;if(f||!m&&this.computeNewBuffersUsage()){this._createVertexArray=!1;for(var _=0;_<wH;++_)h[_]=0;if(this._vaf=this._vaf&&this._vaf.destroy(),i>0){this._vaf=function(e,t,i,n,r){var a=[{index:tH.positionHighAndScale,componentsPerAttribute:4,componentDatatype:dn.FLOAT,usage:i[aH]},{index:tH.positionLowAndRotation,componentsPerAttribute:4,componentDatatype:dn.FLOAT,usage:i[aH]},{index:tH.compressedAttribute0,componentsPerAttribute:4,componentDatatype:dn.FLOAT,usage:i[oH]},{index:tH.compressedAttribute1,componentsPerAttribute:4,componentDatatype:dn.FLOAT,usage:i[_H]},{index:tH.compressedAttribute2,componentsPerAttribute:4,componentDatatype:dn.FLOAT,usage:i[dH]},{index:tH.eyeOffset,componentsPerAttribute:4,componentDatatype:dn.FLOAT,usage:i[sH]},{index:tH.scaleByDistance,componentsPerAttribute:4,componentDatatype:dn.FLOAT,usage:i[mH]},{index:tH.pixelOffsetScaleByDistance,componentsPerAttribute:4,componentDatatype:dn.FLOAT,usage:i[gH]},{index:tH.compressedAttribute3,componentsPerAttribute:4,componentDatatype:dn.FLOAT,usage:i[vH]},{index:tH.textureCoordinateBoundsOrLabelTranslate,componentsPerAttribute:4,componentDatatype:dn.FLOAT,usage:i[yH]}];return n&&a.push({index:tH.direction,componentsPerAttribute:2,componentDatatype:dn.FLOAT,vertexBuffer:PH(e)}),Object(u.a)(r)&&a.push({index:tH.a_batchId,componentsPerAttribute:1,componentDatatyps:dn.FLOAT,bufferUsage:YN.STATIC_DRAW}),new YV(e,a,n?t:4*t,n)}(n,i,this._buffersUsage,this._instanced,this._batchTable),s=this._vaf.writers;for(var g=0;g<i;++g){var v=this._billboards[g];v._dirty=!1,eG(this,n,o,s,v)}this._vaf.commit(iH(n))}this._billboardsToUpdateIndex=0}else if(l>0){var b=iG;b.length=0,(h[aH]||h[fH]||h[uH])&&b.push(DH),(h[hH]||h[oH]||h[cH]||h[lH]||h[rH])&&(b.push(WH),this._instanced&&b.push(ZH)),(h[hH]||h[pH]||h[_H])&&(b.push(YH),b.push(XH)),(h[hH]||h[dH])&&b.push(XH),h[sH]&&b.push(ZH),h[mH]&&b.push(QH),h[gH]&&b.push(KH),(h[vH]||h[bH]||h[hH]||h[aH])&&b.push(JH),(h[hH]||h[aH])&&b.push($H);var y=b.length;if(s=this._vaf.writers,l/i>.1){for(var w=0;w<l;++w){var O=c[w];O._dirty=!1;for(var x=0;x<y;++x)b[x](this,n,o,s,O)}this._vaf.commit(iH(n))}else{for(var E=0;E<l;++E){var T=c[E];T._dirty=!1;for(var C=0;C<y;++C)b[C](this,n,o,s,T);this._instanced?this._vaf.subCommit(T._index,1):this._vaf.subCommit(4*T._index,4)}this._vaf.endSubCommits()}this._billboardsToUpdateIndex=0}if(l>1.5*i&&(c.length=i),Object(u.a)(this._vaf)&&Object(u.a)(this._vaf.va)){var S;this._boundingVolumeDirty&&(this._boundingVolumeDirty=!1,St.transform(this._baseVolume,this.modelMatrix,this._baseVolumeWC));var A=Be.IDENTITY;e.mode===xF.SCENE3D?(A=this.modelMatrix,S=St.clone(this._baseVolumeWC,this._boundingVolume)):S=St.clone(this._baseVolume2D,this._boundingVolume),function(e,t,i){var n=1;e._allSizedInMeters&&0===e._maxPixelOffset||(n=t.camera.getPixelSize(i,t.context.drawingBufferWidth,t.context.drawingBufferHeight));var r=n*e._maxScale*e._maxSize*2;e._allHorizontalCenter&&e._allVerticalCenter&&(r*=.5);var a=n*e._maxPixelOffset+e._maxEyeOffset;i.radius+=r+a}(this,e,S);var P,I,D,j,M,R=this._blendOption!==this.blendOption;if(this._blendOption=this.blendOption,R){this._blendOption===QV.OPAQUE||this._blendOption===QV.OPAQUE_AND_TRANSLUCENT?this._rsOpaque=RM.fromCache({depthTest:{enabled:!0,func:un.LESS},depthMask:!0}):this._rsOpaque=void 0;var L=this._blendOption===QV.TRANSLUCENT;this._blendOption===QV.TRANSLUCENT||this._blendOption===QV.OPAQUE_AND_TRANSLUCENT?this._rsTranslucent=RM.fromCache({depthTest:{enabled:!0,func:L?un.LEQUAL:un.LESS},depthMask:L,blending:FD.ALPHA_BLEND}):this._rsTranslucent=void 0}this._shaderDisableDepthDistance=this._shaderDisableDepthDistance||0!==e.minimumDisableDepthTestDistance;var N=HD.maximumVertexTextureImageUnits>0;if(R||this._shaderRotation!==this._compiledShaderRotation||this._shaderAlignedAxis!==this._compiledShaderAlignedAxis||this._shaderScaleByDistance!==this._compiledShaderScaleByDistance||this._shaderTranslucencyByDistance!==this._compiledShaderTranslucencyByDistance||this._shaderPixelOffsetScaleByDistance!==this._compiledShaderPixelOffsetScaleByDistance||this._shaderDistanceDisplayCondition!==this._compiledShaderDistanceDisplayCondition||this._shaderDisableDepthDistance!==this._compiledShaderDisableDepthDistance||this._shaderClampToGround!==this._compiledShaderClampToGround){P=ZV,I=XV,M=[],Object(u.a)(this._batchTable)&&(M.push("VECTOR_TILE"),P=this._batchTable.getVertexShaderCallback(!1,"a_batchId",void 0)(P),I=this._batchTable.getFragmentShaderCallback(!1,void 0)(I)),D=new UN({defines:M,sources:[P]}),this._instanced&&D.defines.push("INSTANCED"),this._shaderRotation&&D.defines.push("ROTATION"),this._shaderAlignedAxis&&D.defines.push("ALIGNED_AXIS"),this._shaderScaleByDistance&&D.defines.push("EYE_DISTANCE_SCALING"),this._shaderTranslucencyByDistance&&D.defines.push("EYE_DISTANCE_TRANSLUCENCY"),this._shaderPixelOffsetScaleByDistance&&D.defines.push("EYE_DISTANCE_PIXEL_OFFSET"),this._shaderDistanceDisplayCondition&&D.defines.push("DISTANCE_DISPLAY_CONDITION"),this._shaderDisableDepthDistance&&D.defines.push("DISABLE_DEPTH_DISTANCE"),this._shaderClampToGround&&(N?D.defines.push("VERTEX_DEPTH_CHECK"):D.defines.push("FRAGMENT_DEPTH_CHECK"));var F=Object(u.a)(this._batchTable)?"VECTOR_TILE":"";this._blendOption===QV.OPAQUE_AND_TRANSLUCENT&&(j=new UN({defines:["OPAQUE",F],sources:[I]}),this._shaderClampToGround&&(N?j.defines.push("VERTEX_DEPTH_CHECK"):j.defines.push("FRAGMENT_DEPTH_CHECK")),this._sp=bR.replaceCache({context:n,shaderProgram:this._sp,vertexShaderSource:D,fragmentShaderSource:j,attributeLocations:tH}),j=new UN({defines:["TRANSLUCENT",F],sources:[I]}),this._shaderClampToGround&&(N?j.defines.push("VERTEX_DEPTH_CHECK"):j.defines.push("FRAGMENT_DEPTH_CHECK")),this._spTranslucent=bR.replaceCache({context:n,shaderProgram:this._spTranslucent,vertexShaderSource:D,fragmentShaderSource:j,attributeLocations:tH})),this._blendOption===QV.OPAQUE&&(j=new UN({defines:[F],sources:[I]}),this._shaderClampToGround&&(N?j.defines.push("VERTEX_DEPTH_CHECK"):j.defines.push("FRAGMENT_DEPTH_CHECK")),this._sp=bR.replaceCache({context:n,shaderProgram:this._sp,vertexShaderSource:D,fragmentShaderSource:j,attributeLocations:tH})),this._blendOption===QV.TRANSLUCENT&&(j=new UN({defines:[F],sources:[I]}),this._shaderClampToGround&&(N?j.defines.push("VERTEX_DEPTH_CHECK"):j.defines.push("FRAGMENT_DEPTH_CHECK")),this._spTranslucent=bR.replaceCache({context:n,shaderProgram:this._spTranslucent,vertexShaderSource:D,fragmentShaderSource:j,attributeLocations:tH})),this._compiledShaderRotation=this._shaderRotation,this._compiledShaderAlignedAxis=this._shaderAlignedAxis,this._compiledShaderScaleByDistance=this._shaderScaleByDistance,this._compiledShaderTranslucencyByDistance=this._shaderTranslucencyByDistance,this._compiledShaderPixelOffsetScaleByDistance=this._shaderPixelOffsetScaleByDistance,this._compiledShaderDistanceDisplayCondition=this._shaderDistanceDisplayCondition,this._compiledShaderDisableDepthDistance=this._shaderDisableDepthDistance,this._compiledShaderClampToGround=this._shaderClampToGround}var k=e.commandList;if(p.render||p.pick){var B,z=this._colorCommands,U=this._blendOption===QV.OPAQUE,V=this._blendOption===QV.OPAQUE_AND_TRANSLUCENT,H=this._vaf.va,G=H.length,q=this._uniforms;Object(u.a)(this._batchTable)?(q=this._batchTable.getUniformMapCallback()(q),B=this._batchTable.getPickId()):B="v_pickColor",z.length=G;for(var W=V?2*G:G,Y=0;Y<W;++Y){var X=z[Y];Object(u.a)(X)||(X=z[Y]=new cM);var Z=U||V&&Y%2==0;X.pass=Z||!V?lM.OPAQUE:lM.TRANSLUCENT,X.owner=this;var Q=V?Math.floor(Y/2):Y;X.boundingVolume=S,X.modelMatrix=A,X.count=H[Q].indicesCount,X.shaderProgram=Z?this._sp:this._spTranslucent,X.uniformMap=q,X.vertexArray=H[Q].va,X.renderState=Z?this._rsOpaque:this._rsTranslucent,X.debugShowBoundingVolume=this.debugShowBoundingVolume,X.pickId=B,this._instanced&&(X.count=6,X.instanceCount=i),k.push(X)}}}}},EH.prototype.isDestroyed=function(){return!1},EH.prototype.destroy=function(){return Object(u.a)(this._removeCallbackFunc)&&(this._removeCallbackFunc(),this._removeCallbackFunc=void 0),this._textureAtlas=this._destroyTextureAtlas&&this._textureAtlas&&this._textureAtlas.destroy(),this._sp=this._sp&&this._sp.destroy(),this._spTranslucent=this._spTranslucent&&this._spTranslucent.destroy(),this._vaf=this._vaf&&this._vaf.destroy(),TH(this._billboards),rl(this)};var nG=EH,rG=Object(E.a)({FILL:0,OUTLINE:1,FILL_AND_OUTLINE:2}),aG=Object(E.a)({LTR:0,RTL:1,WEAK:2,BRACKETS:3});function oG(e){e._rebindAllGlyphs||e._repositionAllGlyphs||e._labelCollection._labelsToUpdate.push(e),e._rebindAllGlyphs=!0}function sG(e){e._rebindAllGlyphs||e._repositionAllGlyphs||e._labelCollection._labelsToUpdate.push(e),e._repositionAllGlyphs=!0}function cG(e,t){if(e=Object(w.a)(e,w.a.EMPTY_OBJECT),Object(u.a)(e.disableDepthTestDistance)&&e.disableDepthTestDistance<0)throw new h.a("disableDepthTestDistance must be greater than 0.0.");var i=e.translucencyByDistance,n=e.pixelOffsetScaleByDistance,r=e.scaleByDistance,a=e.distanceDisplayCondition;if(Object(u.a)(i)){if(i.far<=i.near)throw new h.a("translucencyByDistance.far must be greater than translucencyByDistance.near.");i=Fx.clone(i)}if(Object(u.a)(n)){if(n.far<=n.near)throw new h.a("pixelOffsetScaleByDistance.far must be greater than pixelOffsetScaleByDistance.near.");n=Fx.clone(n)}if(Object(u.a)(r)){if(r.far<=r.near)throw new h.a("scaleByDistance.far must be greater than scaleByDistance.near.");r=Fx.clone(r)}if(Object(u.a)(a)){if(a.far<=a.near)throw new h.a("distanceDisplayCondition.far must be greater than distanceDisplayCondition.near.");a=gv.clone(a)}this._renderedText=void 0,this._text=void 0,this._show=Object(w.a)(e.show,!0),this._font=Object(w.a)(e.font,"30px sans-serif"),this._fillColor=uf.clone(Object(w.a)(e.fillColor,uf.WHITE)),this._outlineColor=uf.clone(Object(w.a)(e.outlineColor,uf.BLACK)),this._outlineWidth=Object(w.a)(e.outlineWidth,1),this._showBackground=Object(w.a)(e.showBackground,!1),this._backgroundColor=Object(w.a)(e.backgroundColor,new uf(.165,.165,.165,.8)),this._backgroundPadding=Object(w.a)(e.backgroundPadding,new Rt(7,5)),this._style=Object(w.a)(e.style,rG.FILL),this._verticalOrigin=Object(w.a)(e.verticalOrigin,iD.BASELINE),this._horizontalOrigin=Object(w.a)(e.horizontalOrigin,tD.LEFT),this._pixelOffset=Rt.clone(Object(w.a)(e.pixelOffset,Rt.ZERO)),this._eyeOffset=z.clone(Object(w.a)(e.eyeOffset,z.ZERO)),this._position=z.clone(Object(w.a)(e.position,z.ZERO)),this._scale=Object(w.a)(e.scale,1),this._id=e.id,this._translucencyByDistance=i,this._pixelOffsetScaleByDistance=n,this._scaleByDistance=r,this._heightReference=Object(w.a)(e.heightReference,eD.NONE),this._distanceDisplayCondition=a,this._disableDepthTestDistance=e.disableDepthTestDistance,this._labelCollection=t,this._glyphs=[],this._backgroundBillboard=void 0,this._batchIndex=void 0,this._rebindAllGlyphs=!0,this._repositionAllGlyphs=!0,this._actualClampedPosition=void 0,this._removeCallbackFunc=void 0,this._mode=void 0,this._clusterShow=!0,this.text=Object(w.a)(e.text,""),this._updateClamping()}function lG(e,t){for(var i=/[a-zA-Z0-9]/,n=/[()[\]{}<>]/,r=[],a="",o=aG.LTR,s="",c=e.length,l=0;l<c;++l){var u=e.charAt(l);s=t.test(u)?aG.RTL:i.test(u)?aG.LTR:n.test(u)?aG.BRACKETS:aG.WEAK,0===l&&(o=s),o===s&&s!==aG.BRACKETS?a+=u:(""!==a&&r.push({Type:o,Word:a}),o=s,a=u)}return r.push({Type:s,Word:a}),r}function uG(e){return e.split("").reverse().join("")}function hG(e,t,i){return e.slice(0,t)+i+e.slice(t)}function dG(e){switch(e){case"(":return")";case")":return"(";case"[":return"]";case"]":return"[";case"{":return"}";case"}":return"{";case"<":return">";case">":return"<"}}Object(O.a)(cG.prototype,{show:{get:function(){return this._show},set:function(e){if(!Object(u.a)(e))throw new h.a("value is required.");if(this._show!==e){this._show=e;for(var t=this._glyphs,i=0,n=t.length;i<n;i++){var r=t[i].billboard;Object(u.a)(r)&&(r.show=e)}var a=this._backgroundBillboard;Object(u.a)(a)&&(a.show=e)}}},position:{get:function(){return this._position},set:function(e){if(!Object(u.a)(e))throw new h.a("value is required.");var t=this._position;if(!z.equals(t,e)){z.clone(e,t);for(var i=this._glyphs,n=0,r=i.length;n<r;n++){var a=i[n].billboard;Object(u.a)(a)&&(a.position=e)}var o=this._backgroundBillboard;Object(u.a)(o)&&(o.position=e),this._updateClamping()}}},heightReference:{get:function(){return this._heightReference},set:function(e){if(!Object(u.a)(e))throw new h.a("value is required.");if(e!==this._heightReference){this._heightReference=e;for(var t=this._glyphs,i=0,n=t.length;i<n;i++){var r=t[i].billboard;Object(u.a)(r)&&(r.heightReference=e)}var a=this._backgroundBillboard;Object(u.a)(a)&&(a.heightReference=e),sG(this),this._updateClamping()}}},text:{get:function(){return this._text},set:function(e){if(!Object(u.a)(e))throw new h.a("value is required.");this._text!==e&&(this._text=e,this._renderedText=cG.enableRightToLeftDetection?function(e){for(var t=e.split("\n"),i="",n=0;n<t.length;n++){for(var r=t[n],a=fG.test(r.charAt(0)),o=lG(r,fG),s=0,c="",l=0;l<o.length;++l){var u=o[l],h=u.Type===aG.BRACKETS?dG(u.Word):u.Word;a?u.Type===aG.RTL?(c=uG(u.Word)+c,s=0):u.Type===aG.LTR?(c=hG(c,s,u.Word),s+=u.Word.length):u.Type!==aG.WEAK&&u.Type!==aG.BRACKETS||(u.Type===aG.WEAK&&o[l-1].Type===aG.BRACKETS?c=uG(u.Word)+c:o[l-1].Type===aG.RTL?(c=h+c,s=0):o.length>l+1?o[l+1].Type===aG.RTL?(c=h+c,s=0):(c=hG(c,s,u.Word),s+=u.Word.length):c=hG(c,0,h)):u.Type===aG.RTL?c=hG(c,s,uG(u.Word)):u.Type===aG.LTR?(c+=u.Word,s=c.length):u.Type!==aG.WEAK&&u.Type!==aG.BRACKETS||(l>0&&o[l-1].Type===aG.RTL?o.length>l+1?o[l+1].Type===aG.RTL?c=hG(c,s,h):(c+=u.Word,s=c.length):c+=u.Word:(c+=u.Word,s=c.length))}i+=c,n<t.length-1&&(i+="\n")}return i}(e):e,oG(this))}},font:{get:function(){return this._font},set:function(e){if(!Object(u.a)(e))throw new h.a("value is required.");this._font!==e&&(this._font=e,oG(this))}},fillColor:{get:function(){return this._fillColor},set:function(e){if(!Object(u.a)(e))throw new h.a("value is required.");var t=this._fillColor;uf.equals(t,e)||(uf.clone(e,t),oG(this))}},outlineColor:{get:function(){return this._outlineColor},set:function(e){if(!Object(u.a)(e))throw new h.a("value is required.");var t=this._outlineColor;uf.equals(t,e)||(uf.clone(e,t),oG(this))}},outlineWidth:{get:function(){return this._outlineWidth},set:function(e){if(!Object(u.a)(e))throw new h.a("value is required.");this._outlineWidth!==e&&(this._outlineWidth=e,oG(this))}},showBackground:{get:function(){return this._showBackground},set:function(e){if(!Object(u.a)(e))throw new h.a("value is required.");this._showBackground!==e&&(this._showBackground=e,oG(this))}},backgroundColor:{get:function(){return this._backgroundColor},set:function(e){if(!Object(u.a)(e))throw new h.a("value is required.");var t=this._backgroundColor;if(!uf.equals(t,e)){uf.clone(e,t);var i=this._backgroundBillboard;Object(u.a)(i)&&(i.color=t)}}},backgroundPadding:{get:function(){return this._backgroundPadding},set:function(e){if(!Object(u.a)(e))throw new h.a("value is required.");var t=this._backgroundPadding;Rt.equals(t,e)||(Rt.clone(e,t),sG(this))}},style:{get:function(){return this._style},set:function(e){if(!Object(u.a)(e))throw new h.a("value is required.");this._style!==e&&(this._style=e,oG(this))}},pixelOffset:{get:function(){return this._pixelOffset},set:function(e){if(!Object(u.a)(e))throw new h.a("value is required.");var t=this._pixelOffset;if(!Rt.equals(t,e)){Rt.clone(e,t);for(var i=this._glyphs,n=0,r=i.length;n<r;n++){var a=i[n];Object(u.a)(a.billboard)&&(a.billboard.pixelOffset=e)}var o=this._backgroundBillboard;Object(u.a)(o)&&(o.pixelOffset=e)}}},translucencyByDistance:{get:function(){return this._translucencyByDistance},set:function(e){if(Object(u.a)(e)&&e.far<=e.near)throw new h.a("far distance must be greater than near distance.");var t=this._translucencyByDistance;if(!Fx.equals(t,e)){this._translucencyByDistance=Fx.clone(e,t);for(var i=this._glyphs,n=0,r=i.length;n<r;n++){var a=i[n];Object(u.a)(a.billboard)&&(a.billboard.translucencyByDistance=e)}var o=this._backgroundBillboard;Object(u.a)(o)&&(o.translucencyByDistance=e)}}},pixelOffsetScaleByDistance:{get:function(){return this._pixelOffsetScaleByDistance},set:function(e){if(Object(u.a)(e)&&e.far<=e.near)throw new h.a("far distance must be greater than near distance.");var t=this._pixelOffsetScaleByDistance;if(!Fx.equals(t,e)){this._pixelOffsetScaleByDistance=Fx.clone(e,t);for(var i=this._glyphs,n=0,r=i.length;n<r;n++){var a=i[n];Object(u.a)(a.billboard)&&(a.billboard.pixelOffsetScaleByDistance=e)}var o=this._backgroundBillboard;Object(u.a)(o)&&(o.pixelOffsetScaleByDistance=e)}}},scaleByDistance:{get:function(){return this._scaleByDistance},set:function(e){if(Object(u.a)(e)&&e.far<=e.near)throw new h.a("far distance must be greater than near distance.");var t=this._scaleByDistance;if(!Fx.equals(t,e)){this._scaleByDistance=Fx.clone(e,t);for(var i=this._glyphs,n=0,r=i.length;n<r;n++){var a=i[n];Object(u.a)(a.billboard)&&(a.billboard.scaleByDistance=e)}var o=this._backgroundBillboard;Object(u.a)(o)&&(o.scaleByDistance=e)}}},eyeOffset:{get:function(){return this._eyeOffset},set:function(e){if(!Object(u.a)(e))throw new h.a("value is required.");var t=this._eyeOffset;if(!z.equals(t,e)){z.clone(e,t);for(var i=this._glyphs,n=0,r=i.length;n<r;n++){var a=i[n];Object(u.a)(a.billboard)&&(a.billboard.eyeOffset=e)}var o=this._backgroundBillboard;Object(u.a)(o)&&(o.eyeOffset=e)}}},horizontalOrigin:{get:function(){return this._horizontalOrigin},set:function(e){if(!Object(u.a)(e))throw new h.a("value is required.");this._horizontalOrigin!==e&&(this._horizontalOrigin=e,sG(this))}},verticalOrigin:{get:function(){return this._verticalOrigin},set:function(e){if(!Object(u.a)(e))throw new h.a("value is required.");if(this._verticalOrigin!==e){this._verticalOrigin=e;for(var t=this._glyphs,i=0,n=t.length;i<n;i++){var r=t[i];Object(u.a)(r.billboard)&&(r.billboard.verticalOrigin=e)}var a=this._backgroundBillboard;Object(u.a)(a)&&(a.verticalOrigin=e),sG(this)}}},scale:{get:function(){return this._scale},set:function(e){if(!Object(u.a)(e))throw new h.a("value is required.");if(this._scale!==e){this._scale=e;for(var t=this._glyphs,i=0,n=t.length;i<n;i++){var r=t[i];Object(u.a)(r.billboard)&&(r.billboard.scale=e)}var a=this._backgroundBillboard;Object(u.a)(a)&&(a.scale=e),sG(this)}}},distanceDisplayCondition:{get:function(){return this._distanceDisplayCondition},set:function(e){if(Object(u.a)(e)&&e.far<=e.near)throw new h.a("far must be greater than near");if(!gv.equals(e,this._distanceDisplayCondition)){this._distanceDisplayCondition=gv.clone(e,this._distanceDisplayCondition);for(var t=this._glyphs,i=0,n=t.length;i<n;i++){var r=t[i];Object(u.a)(r.billboard)&&(r.billboard.distanceDisplayCondition=e)}var a=this._backgroundBillboard;Object(u.a)(a)&&(a.distanceDisplayCondition=e)}}},disableDepthTestDistance:{get:function(){return this._disableDepthTestDistance},set:function(e){if(this._disableDepthTestDistance!==e){if(Object(u.a)(e)&&e<0)throw new h.a("disableDepthTestDistance must be greater than 0.0.");this._disableDepthTestDistance=e;for(var t=this._glyphs,i=0,n=t.length;i<n;i++){var r=t[i];Object(u.a)(r.billboard)&&(r.billboard.disableDepthTestDistance=e)}var a=this._backgroundBillboard;Object(u.a)(a)&&(a.disableDepthTestDistance=e)}}},id:{get:function(){return this._id},set:function(e){if(this._id!==e){this._id=e;for(var t=this._glyphs,i=0,n=t.length;i<n;i++){var r=t[i];Object(u.a)(r.billboard)&&(r.billboard.id=e)}var a=this._backgroundBillboard;Object(u.a)(a)&&(a.id=e)}}},pickId:{get:function(){if(0!==this._glyphs.length&&Object(u.a)(this._glyphs[0].billboard))return this._glyphs[0].billboard.pickId}},_clampedPosition:{get:function(){return this._actualClampedPosition},set:function(e){this._actualClampedPosition=z.clone(e,this._actualClampedPosition);for(var t=this._glyphs,i=0,n=t.length;i<n;i++){var r=t[i];Object(u.a)(r.billboard)&&(r.billboard._clampedPosition=e)}var a=this._backgroundBillboard;Object(u.a)(a)&&(a._clampedPosition=e)}},clusterShow:{get:function(){return this._clusterShow},set:function(e){if(this._clusterShow!==e){this._clusterShow=e;for(var t=this._glyphs,i=0,n=t.length;i<n;i++){var r=t[i];Object(u.a)(r.billboard)&&(r.billboard.clusterShow=e)}var a=this._backgroundBillboard;Object(u.a)(a)&&(a.clusterShow=e)}}}}),cG.prototype._updateClamping=function(){UV._updateClamping(this._labelCollection,this)},cG.prototype.computeScreenSpacePosition=function(e,t){if(!Object(u.a)(e))throw new h.a("scene is required.");Object(u.a)(t)||(t=new Rt);var i=this._labelCollection.modelMatrix,n=Object(u.a)(this._actualClampedPosition)?this._actualClampedPosition:this._position;return UV._computeScreenSpacePosition(i,n,this._eyeOffset,this._pixelOffset,e,t)},cG.getScreenSpaceBoundingBox=function(e,t,i){var n=0,r=0,a=0,o=0,s=e.scale,c=e._labelCollection._resolutionScale,l=e._backgroundBillboard;if(Object(u.a)(l))n=t.x+l._translate.x/c,r=t.y-l._translate.y/c,a=l.width*s,o=l.height*s,e.verticalOrigin===iD.BOTTOM||e.verticalOrigin===iD.BASELINE?r-=o:e.verticalOrigin===iD.CENTER&&(r-=.5*o);else{n=Number.POSITIVE_INFINITY,r=Number.POSITIVE_INFINITY;for(var h=0,d=0,f=e._glyphs,p=f.length,m=0;m<p;++m){var _=f[m].billboard;if(Object(u.a)(_)){var g=t.x+_._translate.x/c,v=t.y-_._translate.y/c,b=_.width*s,y=_.height*s;e.verticalOrigin===iD.BOTTOM||e.verticalOrigin===iD.BASELINE?v-=y:e.verticalOrigin===iD.CENTER&&(v-=.5*y),n=Math.min(n,g),r=Math.min(r,v),h=Math.max(h,g+b),d=Math.max(d,v+y)}}a=h-n,o=d-r}return Object(u.a)(i)||(i=new ln),i.x=n,i.y=r,i.width=a,i.height=o,i},cG.prototype.equals=function(e){return this===e||Object(u.a)(e)&&this._show===e._show&&this._scale===e._scale&&this._outlineWidth===e._outlineWidth&&this._showBackground===e._showBackground&&this._style===e._style&&this._verticalOrigin===e._verticalOrigin&&this._horizontalOrigin===e._horizontalOrigin&&this._heightReference===e._heightReference&&this._renderedText===e._renderedText&&this._font===e._font&&z.equals(this._position,e._position)&&uf.equals(this._fillColor,e._fillColor)&&uf.equals(this._outlineColor,e._outlineColor)&&uf.equals(this._backgroundColor,e._backgroundColor)&&Rt.equals(this._backgroundPadding,e._backgroundPadding)&&Rt.equals(this._pixelOffset,e._pixelOffset)&&z.equals(this._eyeOffset,e._eyeOffset)&&Fx.equals(this._translucencyByDistance,e._translucencyByDistance)&&Fx.equals(this._pixelOffsetScaleByDistance,e._pixelOffsetScaleByDistance)&&Fx.equals(this._scaleByDistance,e._scaleByDistance)&&gv.equals(this._distanceDisplayCondition,e._distanceDisplayCondition)&&this._disableDepthTestDistance===e._disableDepthTestDistance&&this._id===e._id},cG.prototype.isDestroyed=function(){return!1},cG.enableRightToLeftDetection=!1;var fG=new RegExp("[א-ת؀-ۿݐ-ݿࢠ-ࣿ]");var pG=cG;function mG(){this.textureInfo=void 0,this.dimensions=void 0,this.billboard=void 0}function _G(e,t,i){this.labelCollection=e,this.index=t,this.dimensions=i}var gG=1.2,vG="ID_WHITE_PIXEL",bG=new Rt(4,4),yG=new ln(1,1,1,1);var wG={};function OG(e,t,i,n,r,a,o){return wG.font=t,wG.fillColor=i,wG.strokeColor=n,wG.strokeWidth=r,o===iD.CENTER?wG.textBaseline="middle":o===iD.TOP?wG.textBaseline="top":wG.textBaseline="bottom",wG.fill=a===rG.FILL||a===rG.FILL_AND_OUTLINE,wG.stroke=a===rG.OUTLINE||a===rG.FILL_AND_OUTLINE,hE(e,wG)}function xG(e,t){t.textureInfo=void 0,t.dimensions=void 0;var i=t.billboard;Object(u.a)(i)&&(i.show=!1,i.image=void 0,Object(u.a)(i._removeCallbackFunc)&&(i._removeCallbackFunc(),i._removeCallbackFunc=void 0),e._spareBillboards.push(i),t.billboard=void 0)}function EG(e,t,i,n){e.addImage(t,i).then((function(e){n.index=e}))}function TG(e,t){var i,n,r,a=t._renderedText,o=a.length,s=t._glyphs,c=s.length;if(o<c)for(n=o;n<c;++n)xG(e,s[n]);s.length=o;var l=t._showBackground&&a.split("\n").join("").length>0,h=t._backgroundBillboard,d=e._backgroundBillboardCollection;l?(Object(u.a)(h)||(h=d.add({collection:e,image:vG,imageSubRegion:yG}),t._backgroundBillboard=h),h.color=t._backgroundColor,h.show=t._show,h.position=t._position,h.eyeOffset=t._eyeOffset,h.pixelOffset=t._pixelOffset,h.horizontalOrigin=tD.LEFT,h.verticalOrigin=t._verticalOrigin,h.heightReference=t._heightReference,h.scale=t._scale,h.pickPrimitive=t,h.id=t._id,h.translucencyByDistance=t._translucencyByDistance,h.pixelOffsetScaleByDistance=t._pixelOffsetScaleByDistance,h.scaleByDistance=t._scaleByDistance,h.distanceDisplayCondition=t._distanceDisplayCondition,h.disableDepthTestDistance=t._disableDepthTestDistance):Object(u.a)(h)&&(d.remove(h),t._backgroundBillboard=h=void 0);var f=e._glyphTextureCache;for(r=0;r<o;++r){var p=a.charAt(r),m=t._font,_=t._fillColor,g=t._outlineColor,v=t._outlineWidth,b=t._style,y=t._verticalOrigin,w=JSON.stringify([p,m,_.toRgba(),g.toRgba(),v,+b,+y]),O=f[w];if(!Object(u.a)(O)){var x=OG(p,m,_,g,v,b,y);O=new _G(e,-1,x.dimensions),f[w]=O,x.width>0&&x.height>0&&EG(e._textureAtlas,w,x,O)}if(i=s[r],Object(u.a)(i)?-1===O.index?xG(e,i):Object(u.a)(i.textureInfo)&&(i.textureInfo=void 0):(i=new mG,s[r]=i),i.textureInfo=O,i.dimensions=O.dimensions,-1!==O.index){var E=i.billboard,T=e._spareBillboards;Object(u.a)(E)||(T.length>0?E=T.pop():((E=e._billboardCollection.add({collection:e}))._labelDimensions=new Rt,E._labelTranslate=new Rt),i.billboard=E),E.show=t._show,E.position=t._position,E.eyeOffset=t._eyeOffset,E.pixelOffset=t._pixelOffset,E.horizontalOrigin=tD.LEFT,E.verticalOrigin=t._verticalOrigin,E.heightReference=t._heightReference,E.scale=t._scale,E.pickPrimitive=t,E.id=t._id,E.image=w,E.translucencyByDistance=t._translucencyByDistance,E.pixelOffsetScaleByDistance=t._pixelOffsetScaleByDistance,E.scaleByDistance=t._scaleByDistance,E.distanceDisplayCondition=t._distanceDisplayCondition,E.disableDepthTestDistance=t._disableDepthTestDistance,E._batchIndex=t._batchIndex}}t._repositionAllGlyphs=!0}function CG(e,t,i){return t===tD.CENTER?-e/2:t===tD.RIGHT?-(e+i.x):i.x}var SG=new Rt,AG=new Rt;function PG(e,t){var i,n,r,a=e._glyphs,o=e._renderedText,s=0,c=0,l=[],h=Number.NEGATIVE_INFINITY,d=0,f=1,p=a.length,m=e._backgroundBillboard,_=Rt.clone(Object(u.a)(m)?e._backgroundPadding:Rt.ZERO,AG);for(r=0;r<p;++r)"\n"===o.charAt(r)?(l.push(s),++f,s=0):(n=(i=a[r]).dimensions,d=Math.max(d,n.height-n.descent),h=Math.max(h,n.descent),s+=n.width-n.bounds.minx,r<p-1&&(s+=a[r+1].dimensions.bounds.minx),c=Math.max(c,s));l.push(s);var g=d+h,v=e._scale,b=e._horizontalOrigin,y=e._verticalOrigin,w=0,O=l[w],x=CG(O,b,_),E=gG*g,T=E*(f-1),C=c,S=g+T;Object(u.a)(m)&&(C+=2*_.x,S+=2*_.y,m._labelHorizontalOrigin=b),SG.x=x*v*t,SG.y=0;var A=0;for(r=0;r<p;++r)if("\n"===o.charAt(r))A+=E,x=CG(O=l[++w],b,_),SG.x=x*v*t;else if(n=(i=a[r]).dimensions,y===iD.TOP?SG.y=n.height-d-_.y:y===iD.CENTER?SG.y=(T+n.height-d)/2:y===iD.BASELINE?SG.y=T:SG.y=T+h+_.y,SG.y=(SG.y-n.descent-A)*v*t,Object(u.a)(i.billboard)&&(i.billboard._setTranslate(SG),i.billboard._labelDimensions.x=C,i.billboard._labelDimensions.y=S,i.billboard._labelHorizontalOrigin=b),r<p-1){var P=a[r+1];SG.x+=(n.width-n.bounds.minx+P.dimensions.bounds.minx)*v*t}if(Object(u.a)(m)&&o.split("\n").join("").length>0&&(x=b===tD.CENTER?-c/2-_.x:b===tD.RIGHT?-(c+2*_.x):0,SG.x=x*v*t,y===iD.TOP?SG.y=g-d-h:y===iD.CENTER?SG.y=(g-d)/2-h:y===iD.BASELINE?SG.y=-_.y-h:SG.y=0,SG.y=SG.y*v*t,m.width=C,m.height=S,m._setTranslate(SG),m._labelTranslate=Rt.clone(SG,m._labelTranslate)),e.heightReference===eD.CLAMP_TO_GROUND)for(r=0;r<p;++r){var I=(i=a[r]).billboard;Object(u.a)(I)&&(I._labelTranslate=Rt.clone(SG,I._labelTranslate))}}function IG(e,t){for(var i=t._glyphs,n=0,r=i.length;n<r;++n)xG(e,i[n]);Object(u.a)(t._backgroundBillboard)&&(e._backgroundBillboardCollection.remove(t._backgroundBillboard),t._backgroundBillboard=void 0),t._labelCollection=void 0,Object(u.a)(t._removeCallbackFunc)&&t._removeCallbackFunc(),rl(t)}function DG(e){e=Object(w.a)(e,w.a.EMPTY_OBJECT),this._scene=e.scene,this._batchTable=e.batchTable,this._textureAtlas=void 0,this._backgroundTextureAtlas=void 0,this._whitePixelIndex=void 0,this._backgroundBillboardCollection=new nG({scene:this._scene}),this._backgroundBillboardCollection.destroyTextureAtlas=!1,this._billboardCollection=new nG({scene:this._scene,batchTable:this._batchTable}),this._billboardCollection.destroyTextureAtlas=!1,this._spareBillboards=[],this._glyphTextureCache={},this._labels=[],this._labelsToUpdate=[],this._totalGlyphCount=0,this._resolutionScale=void 0,this._highlightColor=uf.clone(uf.WHITE),this.modelMatrix=Be.clone(Object(w.a)(e.modelMatrix,Be.IDENTITY)),this.debugShowBoundingVolume=Object(w.a)(e.debugShowBoundingVolume,!1),this.blendOption=Object(w.a)(e.blendOption,QV.OPAQUE_AND_TRANSLUCENT)}Object(O.a)(DG.prototype,{length:{get:function(){return this._labels.length}}}),DG.prototype.add=function(e){var t=new pG(e,this);return this._labels.push(t),this._labelsToUpdate.push(t),t},DG.prototype.remove=function(e){if(Object(u.a)(e)&&e._labelCollection===this){var t=this._labels.indexOf(e);if(-1!==t)return this._labels.splice(t,1),IG(this,e),!0}return!1},DG.prototype.removeAll=function(){for(var e=this._labels,t=0,i=e.length;t<i;++t)IG(this,e[t]);e.length=0},DG.prototype.contains=function(e){return Object(u.a)(e)&&e._labelCollection===this},DG.prototype.get=function(e){if(!Object(u.a)(e))throw new h.a("index is required.");return this._labels[e]},DG.prototype.update=function(e){var t=this._billboardCollection,i=this._backgroundBillboardCollection;t.modelMatrix=this.modelMatrix,t.debugShowBoundingVolume=this.debugShowBoundingVolume,i.modelMatrix=this.modelMatrix,i.debugShowBoundingVolume=this.debugShowBoundingVolume;var n=e.context;Object(u.a)(this._textureAtlas)||(this._textureAtlas=new nH({context:n}),t.textureAtlas=this._textureAtlas),Object(u.a)(this._backgroundTextureAtlas)||(this._backgroundTextureAtlas=new nH({context:n,initialSize:bG}),i.textureAtlas=this._backgroundTextureAtlas,function(e,t){var i=document.createElement("canvas");i.width=bG.x,i.height=bG.y;var n=i.getContext("2d");n.fillStyle="#fff",n.fillRect(0,0,i.width,i.height),e.addImage(vG,i).then((function(e){t._whitePixelIndex=e}))}(this._backgroundTextureAtlas,this));var r,a=n.uniformState.resolutionScale,o=this._resolutionScale!==a;this._resolutionScale=a;for(var s=(r=o?this._labels:this._labelsToUpdate).length,c=0;c<s;++c){var l=r[c];if(!l.isDestroyed()){var h=l._glyphs.length;l._rebindAllGlyphs&&(TG(this,l),l._rebindAllGlyphs=!1),(o||l._repositionAllGlyphs)&&(PG(l,a),l._repositionAllGlyphs=!1);var d=l._glyphs.length-h;this._totalGlyphCount+=d}}var f=i.length>0?QV.TRANSLUCENT:this.blendOption;t.blendOption=f,i.blendOption=f,t._highlightColor=this._highlightColor,i._highlightColor=this._highlightColor,this._labelsToUpdate.length=0,i.update(e),t.update(e)},DG.prototype.isDestroyed=function(){return!1},DG.prototype.destroy=function(){return this.removeAll(),this._billboardCollection=this._billboardCollection.destroy(),this._textureAtlas=this._textureAtlas&&this._textureAtlas.destroy(),this._backgroundBillboardCollection=this._backgroundBillboardCollection.destroy(),this._backgroundTextureAtlas=this._backgroundTextureAtlas&&this._backgroundTextureAtlas.destroy(),rl(this)};var jG=DG;function MG(e,t){if(e=Object(w.a)(e,w.a.EMPTY_OBJECT),Object(u.a)(e.disableDepthTestDistance)&&e.disableDepthTestDistance<0)throw new h.a("disableDepthTestDistance must be greater than or equal to 0.0.");var i=e.translucencyByDistance,n=e.scaleByDistance,r=e.distanceDisplayCondition;if(Object(u.a)(i)){if(i.far<=i.near)throw new h.a("translucencyByDistance.far must be greater than translucencyByDistance.near.");i=Fx.clone(i)}if(Object(u.a)(n)){if(n.far<=n.near)throw new h.a("scaleByDistance.far must be greater than scaleByDistance.near.");n=Fx.clone(n)}if(Object(u.a)(r)){if(r.far<=r.near)throw new h.a("distanceDisplayCondition.far must be greater than distanceDisplayCondition.near.");r=gv.clone(r)}this._show=Object(w.a)(e.show,!0),this._position=z.clone(Object(w.a)(e.position,z.ZERO)),this._actualPosition=z.clone(this._position),this._color=uf.clone(Object(w.a)(e.color,uf.WHITE)),this._outlineColor=uf.clone(Object(w.a)(e.outlineColor,uf.TRANSPARENT)),this._outlineWidth=Object(w.a)(e.outlineWidth,0),this._pixelSize=Object(w.a)(e.pixelSize,10),this._scaleByDistance=n,this._translucencyByDistance=i,this._distanceDisplayCondition=r,this._disableDepthTestDistance=Object(w.a)(e.disableDepthTestDistance,0),this._id=e.id,this._collection=Object(w.a)(e.collection,t),this._shake=Object(w.a)(e.shake,!1),this._clusterShow=!0,this._pickId=void 0,this._pointPrimitiveCollection=t,this._dirty=!1,this._index=-1}var RG=MG.SHOW_INDEX=0,LG=MG.POSITION_INDEX=1,NG=MG.COLOR_INDEX=2,FG=MG.OUTLINE_COLOR_INDEX=3,kG=MG.OUTLINE_WIDTH_INDEX=4,BG=MG.PIXEL_SIZE_INDEX=5,zG=MG.SCALE_BY_DISTANCE_INDEX=6,UG=MG.TRANSLUCENCY_BY_DISTANCE_INDEX=7,VG=MG.DISTANCE_DISPLAY_CONDITION_INDEX=8,HG=MG.DISABLE_DEPTH_DISTANCE_INDEX=9;MG.NUMBER_OF_PROPERTIES=10;var GG=MG.SHAKE_INDEX=11;function qG(e,t){var i=e._pointPrimitiveCollection;Object(u.a)(i)&&(i._updatePointPrimitive(e,t),e._dirty=!0)}Object(O.a)(MG.prototype,{show:{get:function(){return this._show},set:function(e){if(!Object(u.a)(e))throw new h.a("value is required.");this._show!==e&&(this._show=e,qG(this,RG))}},position:{get:function(){return this._position},set:function(e){if(!Object(u.a)(e))throw new h.a("value is required.");var t=this._position;z.equals(t,e)||(z.clone(e,t),z.clone(e,this._actualPosition),qG(this,LG))}},scaleByDistance:{get:function(){return this._scaleByDistance},set:function(e){if(Object(u.a)(e)&&e.far<=e.near)throw new h.a("far distance must be greater than near distance.");var t=this._scaleByDistance;Fx.equals(t,e)||(this._scaleByDistance=Fx.clone(e,t),qG(this,zG))}},translucencyByDistance:{get:function(){return this._translucencyByDistance},set:function(e){if(Object(u.a)(e)&&e.far<=e.near)throw new h.a("far distance must be greater than near distance.");var t=this._translucencyByDistance;Fx.equals(t,e)||(this._translucencyByDistance=Fx.clone(e,t),qG(this,UG))}},pixelSize:{get:function(){return this._pixelSize},set:function(e){if(!Object(u.a)(e))throw new h.a("value is required.");this._pixelSize!==e&&(this._pixelSize=e,qG(this,BG))}},color:{get:function(){return this._color},set:function(e){if(!Object(u.a)(e))throw new h.a("value is required.");var t=this._color;uf.equals(t,e)||(uf.clone(e,t),qG(this,NG))}},outlineColor:{get:function(){return this._outlineColor},set:function(e){if(!Object(u.a)(e))throw new h.a("value is required.");var t=this._outlineColor;uf.equals(t,e)||(uf.clone(e,t),qG(this,FG))}},outlineWidth:{get:function(){return this._outlineWidth},set:function(e){if(!Object(u.a)(e))throw new h.a("value is required.");this._outlineWidth!==e&&(this._outlineWidth=e,qG(this,kG))}},distanceDisplayCondition:{get:function(){return this._distanceDisplayCondition},set:function(e){if(Object(u.a)(e)&&e.far<=e.near)throw new h.a("far must be greater than near");gv.equals(this._distanceDisplayCondition,e)||(this._distanceDisplayCondition=gv.clone(e,this._distanceDisplayCondition),qG(this,VG))}},disableDepthTestDistance:{get:function(){return this._disableDepthTestDistance},set:function(e){if(this._disableDepthTestDistance!==e){if(!Object(u.a)(e)||e<0)throw new h.a("disableDepthTestDistance must be greater than or equal to 0.0.");this._disableDepthTestDistance=e,qG(this,HG)}}},id:{get:function(){return this._id},set:function(e){this._id=e,Object(u.a)(this._pickId)&&(this._pickId.object.id=e)}},shake:{get:function(){return!0===this._shake?1:0},set:function(e){if(!Object(u.a)(e))throw new h.a("value is required.");this._shake=e,this._shake!==e&&(this._shake=e,qG(this,GG))}},pickId:{get:function(){return this._pickId}},clusterShow:{get:function(){return this._clusterShow},set:function(e){this._clusterShow!==e&&(this._clusterShow=e,qG(this,RG))}}}),MG.prototype.getPickId=function(e){return Object(u.a)(this._pickId)||(this._pickId=e.createPickId({primitive:this,collection:this._collection,id:this._id})),this._pickId},MG.prototype._getActualPosition=function(){return this._actualPosition},MG.prototype._setActualPosition=function(e){z.clone(e,this._actualPosition),qG(this,LG)};var WG=new Te;MG._computeActualPosition=function(e,t,i){return t.mode===xF.SCENE3D?e:(Be.multiplyByPoint(i,e,WG),gV.computeActualWgs84Position(t,WG))};var YG=new Te;MG._computeScreenSpacePosition=function(e,t,i,n){var r=Be.multiplyByVector(e,Te.fromElements(t.x,t.y,t.z,1,YG),YG);return gV.wgs84ToWindowCoordinates(i,r,n)},MG.prototype.computeScreenSpacePosition=function(e,t){var i=this._pointPrimitiveCollection;if(Object(u.a)(t)||(t=new Rt),!Object(u.a)(i))throw new h.a("PointPrimitive must be in a collection.");if(!Object(u.a)(e))throw new h.a("scene is required.");var n=i.modelMatrix,r=MG._computeScreenSpacePosition(n,this._actualPosition,e,t);if(Object(u.a)(r))return r.y=e.canvas.clientHeight-r.y,r},MG.getScreenSpaceBoundingBox=function(e,t,i){var n=e.pixelSize,r=.5*n,a=t.x-r,o=t.y-r,s=n,c=n;return Object(u.a)(i)||(i=new ln),i.x=a,i.y=o,i.width=s,i.height=c,i},MG.prototype.equals=function(e){return this===e||Object(u.a)(e)&&this._id===e._id&&z.equals(this._position,e._position)&&uf.equals(this._color,e._color)&&this._pixelSize===e._pixelSize&&this._outlineWidth===e._outlineWidth&&this._show===e._show&&uf.equals(this._outlineColor,e._outlineColor)&&Fx.equals(this._scaleByDistance,e._scaleByDistance)&&Fx.equals(this._translucencyByDistance,e._translucencyByDistance)&&gv.equals(this._distanceDisplayCondition,e._distanceDisplayCondition)&&this._disableDepthTestDistance===e._disableDepthTestDistance},MG.prototype._destroy=function(){this._pickId=this._pickId&&this._pickId.destroy(),this._pointPrimitiveCollection=void 0};var XG=MG,ZG="varying vec4 v_color;\nvarying vec4 v_outlineColor;\nvarying float v_innerPercent;\nvarying float v_pixelDistance;\nvarying vec4 v_pickColor;\nvarying float v_shake;\nvoid main()\n{\nfloat distanceToCenter = length(gl_PointCoord - vec2(0.5));\nfloat maxDistance = max(0.0, 0.5 - v_pixelDistance);\nfloat wholeAlpha = 1.0 - smoothstep(maxDistance, 0.5, distanceToCenter);\nfloat innerAlpha = 1.0 - smoothstep(maxDistance * v_innerPercent, 0.5 * v_innerPercent, distanceToCenter);\nfloat time = 1.0;\nif(v_shake == 1.0){\ntime =  (sin(czm_frameNumber * 0.5) * 0.5 + 0.5);\n}\nvec4 color = mix(v_outlineColor, v_color, innerAlpha);\ncolor.a *= wholeAlpha;\ncolor.a *= time;\n#if !defined(OPAQUE) && !defined(TRANSLUCENT)\nif (color.a < 0.005)\n{\ndiscard;\n}\n#else\n#ifdef OPAQUE\nif (color.a < 0.995)\n{\ndiscard;\n}\n#else\nif (color.a >= 0.995)\n{\ndiscard;\n}\n#endif\n#endif\ngl_FragColor = czm_gammaCorrect(color);\nczm_writeLogDepth();\n}\n",QG="uniform float u_maxTotalPointSize;\nattribute vec4 positionHighAndSize;\nattribute vec4 positionLowAndOutline;\nattribute vec4 compressedAttribute0;\nattribute vec4 compressedAttribute1;\nattribute vec4 scaleByDistance;\nattribute vec3 distanceDisplayConditionAndDisableDepth;\nattribute float shake;\nvarying vec4 v_color;\nvarying vec4 v_outlineColor;\nvarying float v_innerPercent;\nvarying float v_pixelDistance;\nvarying vec4 v_pickColor;\nvarying float v_shake;\nconst float SHIFT_LEFT8 = 256.0;\nconst float SHIFT_RIGHT8 = 1.0 / 256.0;\nvoid main()\n{\nvec3 positionHigh = positionHighAndSize.xyz;\nvec3 positionLow = positionLowAndOutline.xyz;\nfloat outlineWidthBothSides = 2.0 * positionLowAndOutline.w;\nfloat totalSize = positionHighAndSize.w + outlineWidthBothSides;\nfloat outlinePercent = outlineWidthBothSides / totalSize;\ntotalSize *= czm_resolutionScale;\ntotalSize += 3.0;\nfloat temp = compressedAttribute1.x * SHIFT_RIGHT8;\nfloat show = floor(temp);\n#ifdef EYE_DISTANCE_TRANSLUCENCY\nvec4 translucencyByDistance;\ntranslucencyByDistance.x = compressedAttribute1.z;\ntranslucencyByDistance.z = compressedAttribute1.w;\ntranslucencyByDistance.y = ((temp - floor(temp)) * SHIFT_LEFT8) / 255.0;\ntemp = compressedAttribute1.y * SHIFT_RIGHT8;\ntranslucencyByDistance.w = ((temp - floor(temp)) * SHIFT_LEFT8) / 255.0;\n#endif\nvec4 color;\nvec4 outlineColor;\nvec4 pickColor;\ntemp = compressedAttribute0.z * SHIFT_RIGHT8;\npickColor.b = (temp - floor(temp)) * SHIFT_LEFT8;\ntemp = floor(temp) * SHIFT_RIGHT8;\npickColor.g = (temp - floor(temp)) * SHIFT_LEFT8;\npickColor.r = floor(temp);\ntemp = compressedAttribute0.x * SHIFT_RIGHT8;\ncolor.b = (temp - floor(temp)) * SHIFT_LEFT8;\ntemp = floor(temp) * SHIFT_RIGHT8;\ncolor.g = (temp - floor(temp)) * SHIFT_LEFT8;\ncolor.r = floor(temp);\ntemp = compressedAttribute0.y * SHIFT_RIGHT8;\noutlineColor.b = (temp - floor(temp)) * SHIFT_LEFT8;\ntemp = floor(temp) * SHIFT_RIGHT8;\noutlineColor.g = (temp - floor(temp)) * SHIFT_LEFT8;\noutlineColor.r = floor(temp);\ntemp = compressedAttribute0.w * SHIFT_RIGHT8;\npickColor.a = (temp - floor(temp)) * SHIFT_LEFT8;\npickColor = pickColor / 255.0;\ntemp = floor(temp) * SHIFT_RIGHT8;\noutlineColor.a = (temp - floor(temp)) * SHIFT_LEFT8;\noutlineColor /= 255.0;\ncolor.a = floor(temp);\ncolor /= 255.0;\nvec4 p = czm_translateRelativeToEye(positionHigh, positionLow);\nvec4 positionEC = czm_modelViewRelativeToEye * p;\npositionEC.xyz *= show;\n#if defined(EYE_DISTANCE_SCALING) || defined(EYE_DISTANCE_TRANSLUCENCY) || defined(DISTANCE_DISPLAY_CONDITION) || defined(DISABLE_DEPTH_DISTANCE)\nfloat lengthSq;\nif (czm_sceneMode == czm_sceneMode2D)\n{\nlengthSq = czm_eyeHeight2D.y;\n}\nelse\n{\nlengthSq = dot(positionEC.xyz, positionEC.xyz);\n}\n#endif\n#ifdef EYE_DISTANCE_SCALING\ntotalSize *= czm_nearFarScalar(scaleByDistance, lengthSq);\n#endif\ntotalSize = min(totalSize, u_maxTotalPointSize);\nif (totalSize < 1.0)\n{\npositionEC.xyz = vec3(0.0);\ntotalSize = 1.0;\n}\nfloat translucency = 1.0;\n#ifdef EYE_DISTANCE_TRANSLUCENCY\ntranslucency = czm_nearFarScalar(translucencyByDistance, lengthSq);\nif (translucency < 0.004)\n{\npositionEC.xyz = vec3(0.0);\n}\n#endif\n#ifdef DISTANCE_DISPLAY_CONDITION\nfloat nearSq = distanceDisplayConditionAndDisableDepth.x;\nfloat farSq = distanceDisplayConditionAndDisableDepth.y;\nif (lengthSq < nearSq || lengthSq > farSq) {\npositionEC.xyz = vec3(0.0);\n}\n#endif\ngl_Position = czm_projection * positionEC;\nczm_vertexLogDepth();\n#ifdef DISABLE_DEPTH_DISTANCE\nfloat disableDepthTestDistance = distanceDisplayConditionAndDisableDepth.z;\nif (disableDepthTestDistance == 0.0 && czm_minimumDisableDepthTestDistance != 0.0)\n{\ndisableDepthTestDistance = czm_minimumDisableDepthTestDistance;\n}\nif (disableDepthTestDistance != 0.0)\n{\nfloat zclip = gl_Position.z / gl_Position.w;\nbool clipped = (zclip < -1.0 || zclip > 1.0);\nif (!clipped && (disableDepthTestDistance < 0.0 || (lengthSq > 0.0 && lengthSq < disableDepthTestDistance)))\n{\ngl_Position.z = -gl_Position.w;\n#ifdef LOG_DEPTH\nczm_vertexLogDepth(vec4(czm_currentFrustum.x));\n#endif\n}\n}\n#endif\nv_color = color;\nv_color.a *= translucency;\nv_outlineColor = outlineColor;\nv_outlineColor.a *= translucency;\nv_innerPercent = 1.0 - outlinePercent;\nv_pixelDistance = 2.0 / totalSize;\ngl_PointSize = totalSize;\nv_pickColor = pickColor;\nv_shake = shake;\n}\n",KG=XG.SHOW_INDEX,JG=XG.POSITION_INDEX,$G=XG.COLOR_INDEX,eq=XG.OUTLINE_COLOR_INDEX,tq=XG.OUTLINE_WIDTH_INDEX,iq=XG.PIXEL_SIZE_INDEX,nq=XG.SCALE_BY_DISTANCE_INDEX,rq=XG.TRANSLUCENCY_BY_DISTANCE_INDEX,aq=XG.DISTANCE_DISPLAY_CONDITION_INDEX,oq=XG.DISABLE_DEPTH_DISTANCE_INDEX,sq=XG.NUMBER_OF_PROPERTIES,cq=XG.SHAKE_INDEX,lq={positionHighAndSize:0,positionLowAndOutline:1,compressedAttribute0:2,compressedAttribute1:3,scaleByDistance:4,distanceDisplayConditionAndDisableDepth:5,shake:6};function uq(e){e=Object(w.a)(e,w.a.EMPTY_OBJECT),this._sp=void 0,this._spTranslucent=void 0,this._rsOpaque=void 0,this._rsTranslucent=void 0,this._vaf=void 0,this._pointPrimitives=[],this._pointPrimitivesToUpdate=[],this._pointPrimitivesToUpdateIndex=0,this._pointPrimitivesRemoved=!1,this._createVertexArray=!1,this._shaderScaleByDistance=!1,this._compiledShaderScaleByDistance=!1,this._shake=!1,this._shaderShake=!1,this._compiledShake=!1,this._shaderTranslucencyByDistance=!1,this._compiledShaderTranslucencyByDistance=!1,this._shaderDistanceDisplayCondition=!1,this._compiledShaderDistanceDisplayCondition=!1,this._shaderDisableDepthDistance=!1,this._compiledShaderDisableDepthDistance=!1,this._propertiesChanged=new Uint32Array(sq),this._maxPixelSize=1,this._baseVolume=new St,this._baseVolumeWC=new St,this._baseVolume2D=new St,this._boundingVolume=new St,this._boundingVolumeDirty=!1,this._colorCommands=[],this.modelMatrix=Be.clone(Object(w.a)(e.modelMatrix,Be.IDENTITY)),this._modelMatrix=Be.clone(Be.IDENTITY),this.debugShowBoundingVolume=Object(w.a)(e.debugShowBoundingVolume,!1),this.blendOption=Object(w.a)(e.blendOption,QV.OPAQUE_AND_TRANSLUCENT),this._blendOption=void 0,this._mode=xF.SCENE3D,this._maxTotalPointSize=1,this._buffersUsage=[YN.STATIC_DRAW,YN.STATIC_DRAW,YN.STATIC_DRAW,YN.STATIC_DRAW,YN.STATIC_DRAW,YN.STATIC_DRAW,YN.STATIC_DRAW,YN.STATIC_DRAW,YN.STATIC_DRAW,YN.STATIC_DRAW];var t=this;this._uniforms={u_maxTotalPointSize:function(){return t._maxTotalPointSize}}}function hq(e){for(var t=e.length,i=0;i<t;++i)e[i]&&e[i]._destroy()}function dq(e){if(e._pointPrimitivesRemoved){e._pointPrimitivesRemoved=!1;for(var t=[],i=e._pointPrimitives,n=i.length,r=0,a=0;r<n;++r){var o=i[r];o&&(o._index=a++,t.push(o))}e._pointPrimitives=t}}Object(O.a)(uq.prototype,{length:{get:function(){return dq(this),this._pointPrimitives.length}}}),uq.prototype.add=function(e){var t=new XG(e,this);return t._index=this._pointPrimitives.length,this._pointPrimitives.push(t),this._createVertexArray=!0,t},uq.prototype.remove=function(e){return!!this.contains(e)&&(this._pointPrimitives[e._index]=null,this._pointPrimitivesRemoved=!0,this._createVertexArray=!0,e._destroy(),!0)},uq.prototype.removeAll=function(){hq(this._pointPrimitives),this._pointPrimitives=[],this._pointPrimitivesToUpdate=[],this._pointPrimitivesToUpdateIndex=0,this._pointPrimitivesRemoved=!1,this._createVertexArray=!0},uq.prototype._updatePointPrimitive=function(e,t){e._dirty||(this._pointPrimitivesToUpdate[this._pointPrimitivesToUpdateIndex++]=e),++this._propertiesChanged[t]},uq.prototype.contains=function(e){return Object(u.a)(e)&&e._pointPrimitiveCollection===this},uq.prototype.get=function(e){if(!Object(u.a)(e))throw new h.a("index is required.");return dq(this),this._pointPrimitives[e]},uq.prototype.computeNewBuffersUsage=function(){for(var e=this._buffersUsage,t=!1,i=this._propertiesChanged,n=0;n<sq;++n){var r=0===i[n]?YN.STATIC_DRAW:YN.STREAM_DRAW;t=t||e[n]!==r,e[n]=r}return t};var fq=new Fu;function pq(e,t,i,n){var r=n._index,a=n._getActualPosition();e._mode===xF.SCENE3D&&(St.expand(e._baseVolume,a,e._baseVolume),e._boundingVolumeDirty=!0),Fu.fromCartesian(a,fq);var o=n.pixelSize,s=n.outlineWidth;e._maxPixelSize=Math.max(e._maxPixelSize,o+s);var c=i[lq.positionHighAndSize],l=fq.high;c(r,l.x,l.y,l.z,o);var u=i[lq.positionLowAndOutline],h=fq.low;u(r,h.x,h.y,h.z,s)}var mq=65536,_q=256;function gq(e,t,i,n){var r=n._index,a=n.color,o=n.getPickId(t).color,s=n.outlineColor,c=uf.floatToByte(a.red),l=uf.floatToByte(a.green),u=uf.floatToByte(a.blue),h=c*mq+l*_q+u;c=uf.floatToByte(s.red),l=uf.floatToByte(s.green),u=uf.floatToByte(s.blue);var d=c*mq+l*_q+u;c=uf.floatToByte(o.red),l=uf.floatToByte(o.green),u=uf.floatToByte(o.blue);var f=c*mq+l*_q+u,p=uf.floatToByte(a.alpha)*mq+uf.floatToByte(s.alpha)*_q+uf.floatToByte(o.alpha);(0,i[lq.compressedAttribute0])(r,h,d,f,p)}function vq(e,t,i,n){var r=n._index,a=0,o=1,s=1,c=1,l=n.translucencyByDistance;Object(u.a)(l)&&(a=l.near,o=l.nearValue,s=l.far,c=l.farValue,1===o&&1===c||(e._shaderTranslucencyByDistance=!0));var h=n.show&&n.clusterShow;0===n.color.alpha&&0===n.outlineColor.alpha&&(h=!1),o=I.clamp(o,0,1);var d=(h?1:0)*_q+(o=1===o?255:255*o|0),f=c=1===(c=I.clamp(c,0,1))?255:255*c|0;(0,i[lq.compressedAttribute1])(r,d,f,a,s)}function bq(e,t,i,n){var r=n._index,a=i[lq.scaleByDistance],o=0,s=1,c=1,l=1,h=n.scaleByDistance;Object(u.a)(h)&&(o=h.near,s=h.nearValue,c=h.far,l=h.farValue,1===s&&1===l||(e._shaderScaleByDistance=!0)),a(r,o,s,c,l)}function yq(e,t,i,n){var r,a=n._index,o=i[lq.shake];r=n.shake,Object(u.a)(r)&&(e._shake=!0,e._shaderShake=!0),o(a,r)}function wq(e,t,i,n){var r=n._index,a=i[lq.distanceDisplayConditionAndDisableDepth],o=0,s=Number.MAX_VALUE,c=n.distanceDisplayCondition;Object(u.a)(c)&&(o=c.near,s=c.far,o*=o,s*=s,e._shaderDistanceDisplayCondition=!0);var l=n.disableDepthTestDistance;(l*=l)>0&&(e._shaderDisableDepthDistance=!0,l===Number.POSITIVE_INFINITY&&(l=-1)),a(r,o,s,l)}function Oq(e,t,i,n){pq(e,0,i,n),gq(0,t,i,n),vq(e,0,i,n),bq(e,0,i,n),wq(e,0,i,n),yq(e,0,i,n)}function xq(e,t,i,n,r,a){var o;n.mode===xF.SCENE3D?(o=e._baseVolume,e._boundingVolumeDirty=!0):o=e._baseVolume2D;for(var s=[],c=0;c<i;++c){var l=t[c],h=l.position,d=XG._computeActualPosition(h,n,r);Object(u.a)(d)&&(l._setActualPosition(d),a?s.push(d):St.expand(o,d,o))}a&&St.fromPoints(s,o)}var Eq=[];uq.prototype.update=function(e){dq(this),this._maxTotalPointSize=HD.maximumAliasedPointSize,function(e,t){var i=t.mode,n=e._pointPrimitives,r=e._pointPrimitivesToUpdate,a=e._modelMatrix;e._createVertexArray||e._mode!==i||i!==xF.SCENE3D&&!Be.equals(a,e.modelMatrix)?(e._mode=i,Be.clone(e.modelMatrix,a),e._createVertexArray=!0,i!==xF.SCENE3D&&i!==xF.SCENE2D&&i!==xF.COLUMBUS_VIEW||xq(e,n,n.length,t,a,!0)):i===xF.MORPHING?xq(e,n,n.length,t,a,!0):i!==xF.SCENE2D&&i!==xF.COLUMBUS_VIEW||xq(e,r,e._pointPrimitivesToUpdateIndex,t,a,!1)}(this,e);var t,i=this._pointPrimitives.length,n=this._pointPrimitivesToUpdate,r=this._pointPrimitivesToUpdateIndex,a=this._propertiesChanged,o=this._createVertexArray,s=e.context,c=e.passes,l=c.pick;if(o||!l&&this.computeNewBuffersUsage()){this._createVertexArray=!1;for(var h=0;h<sq;++h)a[h]=0;if(this._vaf=this._vaf&&this._vaf.destroy(),i>0){this._vaf=function(e,t,i){return new YV(e,[{index:lq.positionHighAndSize,componentsPerAttribute:4,componentDatatype:dn.FLOAT,usage:i[JG]},{index:lq.positionLowAndShow,componentsPerAttribute:4,componentDatatype:dn.FLOAT,usage:i[JG]},{index:lq.compressedAttribute0,componentsPerAttribute:4,componentDatatype:dn.FLOAT,usage:i[$G]},{index:lq.compressedAttribute1,componentsPerAttribute:4,componentDatatype:dn.FLOAT,usage:i[rq]},{index:lq.scaleByDistance,componentsPerAttribute:4,componentDatatype:dn.FLOAT,usage:i[nq]},{index:lq.distanceDisplayConditionAndDisableDepth,componentsPerAttribute:3,componentDatatype:dn.FLOAT,usage:i[aq]},{index:lq.shake,componentsPerAttribute:1,componentDatatype:dn.FLOAT,usage:i[cq]}],t)}(s,i,this._buffersUsage),t=this._vaf.writers;for(var d=0;d<i;++d){var f=this._pointPrimitives[d];f._dirty=!1,Oq(this,s,t,f)}this._vaf.commit()}this._pointPrimitivesToUpdateIndex=0}else if(r>0){var p=Eq;p.length=0,(a[JG]||a[tq]||a[iq])&&p.push(pq),(a[$G]||a[eq])&&p.push(gq),(a[KG]||a[rq])&&p.push(vq),a[nq]&&p.push(bq),(a[aq]||a[oq])&&p.push(wq),a[cq]&&p.push(yq);var m=p.length;if(t=this._vaf.writers,r/i>.1){for(var _=0;_<r;++_){var g=n[_];g._dirty=!1;for(var v=0;v<m;++v)p[v](this,s,t,g)}this._vaf.commit()}else{for(var b=0;b<r;++b){var y=n[b];y._dirty=!1;for(var w=0;w<m;++w)p[w](this,s,t,y);this._vaf.subCommit(y._index,1)}this._vaf.endSubCommits()}this._pointPrimitivesToUpdateIndex=0}if(r>1.5*i&&(n.length=i),Object(u.a)(this._vaf)&&Object(u.a)(this._vaf.va)){var O;this._boundingVolumeDirty&&(this._boundingVolumeDirty=!1,St.transform(this._baseVolume,this.modelMatrix,this._baseVolumeWC));var x=Be.IDENTITY;e.mode===xF.SCENE3D?(x=this.modelMatrix,O=St.clone(this._baseVolumeWC,this._boundingVolume)):O=St.clone(this._baseVolume2D,this._boundingVolume),function(e,t,i){var n=t.camera.getPixelSize(i,t.context.drawingBufferWidth,t.context.drawingBufferHeight)*e._maxPixelSize;i.radius+=n}(this,e,O);var E,T,C,S,A,P,I=this._blendOption!==this.blendOption;this._blendOption=this.blendOption,I&&(this._blendOption===QV.OPAQUE||this._blendOption===QV.OPAQUE_AND_TRANSLUCENT?this._rsOpaque=RM.fromCache({depthTest:{enabled:!0,func:un.LEQUAL},depthMask:!0}):this._rsOpaque=void 0,this._blendOption===QV.TRANSLUCENT||this._blendOption===QV.OPAQUE_AND_TRANSLUCENT?this._rsTranslucent=RM.fromCache({depthTest:{enabled:!0,func:un.LEQUAL},depthMask:!1,blending:FD.ALPHA_BLEND}):this._rsTranslucent=void 0),this._shaderDisableDepthDistance=this._shaderDisableDepthDistance||0!==e.minimumDisableDepthTestDistance,(I||this._shaderScaleByDistance&&!this._compiledShaderScaleByDistance||this._shaderTranslucencyByDistance&&!this._compiledShaderTranslucencyByDistance||this._shaderDistanceDisplayCondition&&!this._compiledShaderDistanceDisplayCondition||this._shaderDisableDepthDistance!==this._compiledShaderDisableDepthDistance||this._shake&&!this._compiledShake)&&(E=new UN({sources:[QG]}),this._shaderScaleByDistance&&E.defines.push("EYE_DISTANCE_SCALING"),this._shaderTranslucencyByDistance&&E.defines.push("EYE_DISTANCE_TRANSLUCENCY"),this._shaderDistanceDisplayCondition&&E.defines.push("DISTANCE_DISPLAY_CONDITION"),this._shaderDisableDepthDistance&&E.defines.push("DISABLE_DEPTH_DISTANCE"),this._blendOption===QV.OPAQUE_AND_TRANSLUCENT&&(T=new UN({defines:["OPAQUE"],sources:[ZG]}),this._sp=bR.replaceCache({context:s,shaderProgram:this._sp,vertexShaderSource:E,fragmentShaderSource:T,attributeLocations:lq}),T=new UN({defines:["TRANSLUCENT"],sources:[ZG]}),this._spTranslucent=bR.replaceCache({context:s,shaderProgram:this._spTranslucent,vertexShaderSource:E,fragmentShaderSource:T,attributeLocations:lq})),this._blendOption===QV.OPAQUE&&(T=new UN({sources:[ZG]}),this._sp=bR.replaceCache({context:s,shaderProgram:this._sp,vertexShaderSource:E,fragmentShaderSource:T,attributeLocations:lq})),this._blendOption===QV.TRANSLUCENT&&(T=new UN({sources:[ZG]}),this._spTranslucent=bR.replaceCache({context:s,shaderProgram:this._spTranslucent,vertexShaderSource:E,fragmentShaderSource:T,attributeLocations:lq})),this._compiledShaderScaleByDistance=this._shaderScaleByDistance,this._compiledShaderTranslucencyByDistance=this._shaderTranslucencyByDistance,this._compiledShaderDistanceDisplayCondition=this._shaderDistanceDisplayCondition,this._compiledShaderDisableDepthDistance=this._shaderDisableDepthDistance,this._compiledShake=this._shake);var D=e.commandList;if(c.render||l){var j=this._colorCommands,M=this._blendOption===QV.OPAQUE,R=this._blendOption===QV.OPAQUE_AND_TRANSLUCENT;S=(C=this._vaf.va).length,j.length=S;var L=R?2*S:S;for(P=0;P<L;++P){var N=M||R&&P%2==0;A=j[P],Object(u.a)(A)||(A=j[P]=new cM),A.primitiveType=yn.POINTS,A.pass=N||!R?lM.OPAQUE:lM.TRANSLUCENT,A.owner=this;var F=R?Math.floor(P/2):P;A.boundingVolume=O,A.modelMatrix=x,A.shaderProgram=N?this._sp:this._spTranslucent,A.uniformMap=this._uniforms,A.vertexArray=C[F].va,A.renderState=N?this._rsOpaque:this._rsTranslucent,A.debugShowBoundingVolume=this.debugShowBoundingVolume,A.pickId="v_pickColor",D.push(A)}}}},uq.prototype.isDestroyed=function(){return!1},uq.prototype.destroy=function(){return this._sp=this._sp&&this._sp.destroy(),this._spTranslucent=this._spTranslucent&&this._spTranslucent.destroy(),this._spPick=this._spPick&&this._spPick.destroy(),this._vaf=this._vaf&&this._vaf.destroy(),hq(this._pointPrimitives),rl(this)};var Tq=uq;function Cq(e,t,i,n,r){t=t||Sq,i=i||Aq,r=r||Array,this.nodeSize=n||64,this.points=e,this.ids=new r(e.length),this.coords=new r(2*e.length);for(var a=0;a<e.length;a++)this.ids[a]=a,this.coords[2*a]=t(e[a]),this.coords[2*a+1]=i(e[a]);!function e(t,i,n,r,a,o){if(a-r<=n)return;var s=Math.floor((r+a)/2);(function e(t,i,n,r,a,o){for(;a>r;){if(a-r>600){var s=a-r+1,c=n-r+1,l=Math.log(s),u=.5*Math.exp(2*l/3),h=.5*Math.sqrt(l*u*(s-u)/s)*(c-s/2<0?-1:1),d=Math.max(r,Math.floor(n-c*u/s+h)),f=Math.min(a,Math.floor(n+(s-c)*u/s+h));e(t,i,n,d,f,o)}var p=i[2*n+o],m=r,_=a;for(Pq(t,i,r,n),i[2*a+o]>p&&Pq(t,i,r,a);m<_;){for(Pq(t,i,m,_),m++,_--;i[2*m+o]<p;)m++;for(;i[2*_+o]>p;)_--}i[2*r+o]===p?Pq(t,i,r,_):(_++,Pq(t,i,_,a)),_<=n&&(r=_+1),n<=_&&(a=_-1)}})(t,i,s,r,a,o%2),e(t,i,n,r,s-1,o+1),e(t,i,n,s+1,a,o+1)}(this.ids,this.coords,this.nodeSize,0,this.ids.length-1,0)}function Sq(e){return e[0]}function Aq(e){return e[1]}function Pq(e,t,i,n){Iq(e,i,n),Iq(t,2*i,2*n),Iq(t,2*i+1,2*n+1)}function Iq(e,t,i){var n=e[t];e[t]=e[i],e[i]=n}function Dq(e,t,i,n){var r=e-i,a=t-n;return r*r+a*a}Cq.prototype={range:function(e,t,i,n){return function(e,t,i,n,r,a,o){var s,c,l=[0,e.length-1,0],u=[];for(;l.length;){var h=l.pop(),d=l.pop(),f=l.pop();if(d-f<=o)for(var p=f;p<=d;p++)s=t[2*p],c=t[2*p+1],s>=i&&s<=r&&c>=n&&c<=a&&u.push(e[p]);else{var m=Math.floor((f+d)/2);s=t[2*m],c=t[2*m+1],s>=i&&s<=r&&c>=n&&c<=a&&u.push(e[m]);var _=(h+1)%2;(0===h?i<=s:n<=c)&&(l.push(f),l.push(m-1),l.push(_)),(0===h?r>=s:a>=c)&&(l.push(m+1),l.push(d),l.push(_))}}return u}(this.ids,this.coords,e,t,i,n,this.nodeSize)},within:function(e,t,i){return function(e,t,i,n,r,a){var o=[0,e.length-1,0],s=[],c=r*r;for(;o.length;){var l=o.pop(),u=o.pop(),h=o.pop();if(u-h<=a)for(var d=h;d<=u;d++)Dq(t[2*d],t[2*d+1],i,n)<=c&&s.push(e[d]);else{var f=Math.floor((h+u)/2),p=t[2*f],m=t[2*f+1];Dq(p,m,i,n)<=c&&s.push(e[f]);var _=(l+1)%2;(0===l?i-r<=p:n-r<=m)&&(o.push(h),o.push(f-1),o.push(_)),(0===l?i+r>=p:n+r>=m)&&(o.push(f+1),o.push(u),o.push(_))}}return s}(this.ids,this.coords,e,t,i,this.nodeSize)}};var jq=function(e,t,i,n,r){return new Cq(e,t,i,n,r)};function Mq(e){e=Object(w.a)(e,w.a.EMPTY_OBJECT),this._enabled=Object(w.a)(e.enabled,!1),this._pixelRange=Object(w.a)(e.pixelRange,80),this._minimumClusterSize=Object(w.a)(e.minimumClusterSize,2),this._clusterBillboards=Object(w.a)(e.clusterBillboards,!0),this._clusterLabels=Object(w.a)(e.clusterLabels,!0),this._clusterPoints=Object(w.a)(e.clusterPoints,!0),this._labelCollection=void 0,this._billboardCollection=void 0,this._pointCollection=void 0,this._clusterBillboardCollection=void 0,this._clusterLabelCollection=void 0,this._clusterPointCollection=void 0,this._collectionIndicesByEntity={},this._unusedLabelIndices=[],this._unusedBillboardIndices=[],this._unusedPointIndices=[],this._previousClusters=[],this._previousHeight=void 0,this._enabledDirty=!1,this._clusterDirty=!1,this._cluster=void 0,this._removeEventListener=void 0,this._clusterEvent=new $o.a}function Rq(e){return e.coord.x}function Lq(e){return e.coord.y}function Nq(e,t){e.x-=t,e.y-=t,e.width+=2*t,e.height+=2*t}var Fq=new ln;function kq(e,t,i,n,r){if(Object(u.a)(e._labelCollection)&&n._clusterLabels?r=pG.getScreenSpaceBoundingBox(e,t,r):Object(u.a)(e._billboardCollection)&&n._clusterBillboards?r=UV.getScreenSpaceBoundingBox(e,t,r):Object(u.a)(e._pointPrimitiveCollection)&&n._clusterPoints&&(r=XG.getScreenSpaceBoundingBox(e,t,r)),Nq(r,i),n._clusterLabels&&!Object(u.a)(e._labelCollection)&&Object(u.a)(e.id)&&Uq(n,e.id)&&Object(u.a)(e.id._label)){var a=n._collectionIndicesByEntity[e.id],o=n._labelCollection.get(a),s=pG.getScreenSpaceBoundingBox(o,t,Fq);Nq(s,i),r=ln.union(r,s,r)}return r}function Bq(e,t){if(e.clusterShow=!0,!Object(u.a)(e._labelCollection)&&Object(u.a)(e.id)&&Uq(t,e.id)&&Object(u.a)(e.id._label)){var i=t._collectionIndicesByEntity[e.id];t._labelCollection.get(i).clusterShow=!0}}function zq(e,t,i,n){var r={billboard:n._clusterBillboardCollection.add(),label:n._clusterLabelCollection.add(),point:n._clusterPointCollection.add()};r.billboard.show=!1,r.point.show=!1,r.label.show=!0,r.label.text=t.toLocaleString(),r.label.id=i,r.billboard.position=r.label.position=r.point.position=e,n._clusterEvent.raiseEvent(i,r)}function Uq(e,t){return Object(u.a)(e)&&Object(u.a)(e._collectionIndicesByEntity[t])&&Object(u.a)(e._collectionIndicesByEntity[t].labelIndex)}function Vq(e,t,i,n,r){if(Object(u.a)(e))for(var a=e.length,o=0;o<a;++o){var s=e.get(o);if(s.clusterShow=!1,s.show&&(r._scene.mode!==xF.SCENE3D||n.isPointVisible(s.position))){var c=r._clusterLabels&&Object(u.a)(s._labelCollection),l=r._clusterBillboards&&Object(u.a)(s.id._billboard),h=r._clusterPoints&&Object(u.a)(s.id._point);if(!c||!h&&!l){var d=s.computeScreenSpacePosition(i);Object(u.a)(d)&&t.push({index:o,collection:e,clustered:!1,coord:d})}}}}var Hq=new ln,Gq=new ln,qq=new ln;function Wq(e,t,i,n){return function(r){var a=this[e];Object(u.a)(this._collectionIndicesByEntity)||(this._collectionIndicesByEntity={});var o,s,c=this._collectionIndicesByEntity[r.id];if(Object(u.a)(c)||(c=this._collectionIndicesByEntity[r.id]={billboardIndex:void 0,labelIndex:void 0,pointIndex:void 0}),Object(u.a)(a)&&Object(u.a)(c[n]))return a.get(c[n]);Object(u.a)(a)||(a=this.animatedBillboardsOptions?this[e]=new t({scene:this._scene,isAnimated:!0,animation:this.animatedBillboardsOptions}):this[e]=new t({scene:this._scene}));var l=this[i];return l.length>0?(o=l.pop(),s=a.get(o)):(s=a.add(),o=a.length-1),c[n]=o,this._clusterDirty=!0,s}}function Yq(e,t){var i=e._collectionIndicesByEntity[t];Object(u.a)(i.billboardIndex)||Object(u.a)(i.labelIndex)||Object(u.a)(i.pointIndex)||delete e._collectionIndicesByEntity[t]}function Xq(e){if(Object(u.a)(e))for(var t=e.length,i=0;i<t;++i)e.get(i).clusterShow=!0}Mq.prototype._initialize=function(e){this._scene=e;var t,i=(t=this,function(e){if(!(Object(u.a)(e)&&e<.05)&&t.enabled){var i=t._scene,n=t._labelCollection,r=t._billboardCollection,a=t._pointCollection;if((Object(u.a)(n)||Object(u.a)(r)||Object(u.a)(a))&&(t._clusterBillboards||t._clusterLabels||t._clusterPoints)){var o=t._clusterLabelCollection,s=t._clusterBillboardCollection,c=t._clusterPointCollection;Object(u.a)(o)?o.removeAll():o=t._clusterLabelCollection=new jG({scene:i}),Object(u.a)(s)?s.removeAll():s=t._clusterBillboardCollection=new nG({scene:i}),Object(u.a)(c)?c.removeAll():c=t._clusterPointCollection=new Tq;var l,h,d,f,p,m,_,g,v,b,y,w=t._pixelRange,O=t._minimumClusterSize,x=t._previousClusters,E=[],T=t._previousHeight,C=i.camera.positionCartographic.height,S=i.mapProjection.ellipsoid,A=i.camera.positionWC,P=new fs(S,A),I=[];t._clusterLabels&&Vq(n,I,i,P,t),t._clusterBillboards&&Vq(r,I,i,P,t),t._clusterPoints&&Vq(a,I,i,P,t);var D=jq(I,Rq,Lq,64,Int32Array);if(C<T)for(d=x.length,l=0;l<d;++l){var j=x[l];if(P.isPointVisible(j.position)){var M=UV._computeScreenSpacePosition(Be.IDENTITY,j.position,z.ZERO,Rt.ZERO,i);if(Object(u.a)(M)){var R=1-C/T,L=j.width=j.width*R,N=j.height=j.height*R;L=Math.max(L,j.minimumWidth),N=Math.max(N,j.minimumHeight);var F=M.x-.5*L,k=M.y-.5*N,B=M.x+L,U=M.y+N;for(m=(p=D.range(F,k,B,U)).length,v=0,g=[],h=0;h<m;++h)(_=I[p[h]]).clustered||(++v,b=_.collection,y=_.index,g.push(b.get(y).id));if(v>=O)for(zq(j.position,v,g,t),E.push(j),h=0;h<m;++h)I[p[h]].clustered=!0}}}for(d=I.length,l=0;l<d;++l){var V=I[l];if(!V.clustered){V.clustered=!0,b=V.collection,y=V.index;var H=b.get(y);f=kq(H,V.coord,w,t,Hq);var G=ln.clone(f,Gq);m=(p=D.range(f.x,f.y,f.x+f.width,f.y+f.height)).length;var q=z.clone(H.position);for(v=1,g=[H.id],h=0;h<m;++h)if(!(_=I[p[h]]).clustered){var W=_.collection.get(_.index),Y=kq(W,_.coord,w,t,qq);z.add(W.position,q,q),ln.union(G,Y,G),++v,g.push(W.id)}if(v>=O){var X=z.multiplyByScalar(q,1/v,q);for(zq(X,v,g,t),E.push({position:X,width:G.width,height:G.height,minimumWidth:f.width,minimumHeight:f.height}),h=0;h<m;++h)I[p[h]].clustered=!0}else Bq(H,t)}}0===o.length&&(o.destroy(),t._clusterLabelCollection=void 0),0===s.length&&(s.destroy(),t._clusterBillboardCollection=void 0),0===c.length&&(c.destroy(),t._clusterPointCollection=void 0),t._previousClusters=E,t._previousHeight=C}}});this._cluster=i,this._removeEventListener=e.camera.changed.addEventListener(i)},Object(O.a)(Mq.prototype,{enabled:{get:function(){return this._enabled},set:function(e){this._enabledDirty=e!==this._enabled,this._enabled=e}},pixelRange:{get:function(){return this._pixelRange},set:function(e){this._clusterDirty=this._clusterDirty||e!==this._pixelRange,this._pixelRange=e}},minimumClusterSize:{get:function(){return this._minimumClusterSize},set:function(e){this._clusterDirty=this._clusterDirty||e!==this._minimumClusterSize,this._minimumClusterSize=e}},clusterEvent:{get:function(){return this._clusterEvent}},clusterBillboards:{get:function(){return this._clusterBillboards},set:function(e){this._clusterDirty=this._clusterDirty||e!==this._clusterBillboards,this._clusterBillboards=e}},clusterLabels:{get:function(){return this._clusterLabels},set:function(e){this._clusterDirty=this._clusterDirty||e!==this._clusterLabels,this._clusterLabels=e}},clusterPoints:{get:function(){return this._clusterPoints},set:function(e){this._clusterDirty=this._clusterDirty||e!==this._clusterPoints,this._clusterPoints=e}}}),Mq.prototype.getLabel=Wq("_labelCollection",jG,"_unusedLabelIndices","labelIndex"),Mq.prototype.removeLabel=function(e){var t=this._collectionIndicesByEntity&&this._collectionIndicesByEntity[e.id];if(Object(u.a)(this._labelCollection)&&Object(u.a)(t)&&Object(u.a)(t.labelIndex)){var i=t.labelIndex;t.labelIndex=void 0,Yq(this,e.id);var n=this._labelCollection.get(i);n.show=!1,n.text="",n.id=void 0,this._unusedLabelIndices.push(i),this._clusterDirty=!0}},Mq.prototype.getBillboard=Wq("_billboardCollection",nG,"_unusedBillboardIndices","billboardIndex"),Mq.prototype.removeBillboard=function(e){var t=this._collectionIndicesByEntity&&this._collectionIndicesByEntity[e.id];if(Object(u.a)(this._billboardCollection)&&Object(u.a)(t)&&Object(u.a)(t.billboardIndex)){var i=t.billboardIndex;t.billboardIndex=void 0,Yq(this,e.id);var n=this._billboardCollection.get(i);n.id=void 0,n.show=!1,n.image=void 0,this._unusedBillboardIndices.push(i),this._clusterDirty=!0}},Mq.prototype.getPoint=Wq("_pointCollection",Tq,"_unusedPointIndices","pointIndex"),Mq.prototype.removePoint=function(e){var t=this._collectionIndicesByEntity&&this._collectionIndicesByEntity[e.id];if(Object(u.a)(this._pointCollection)&&Object(u.a)(t)&&Object(u.a)(t.pointIndex)){var i=t.pointIndex;t.pointIndex=void 0,Yq(this,e.id);var n=this._pointCollection.get(i);n.show=!1,n.id=void 0,this._unusedPointIndices.push(i),this._clusterDirty=!0}},Mq.prototype.update=function(e){var t,i;Object(u.a)(this._labelCollection)&&this._labelCollection.length>0&&0===this._labelCollection.get(0)._glyphs.length&&(t=e.commandList,e.commandList=[],this._labelCollection.update(e),e.commandList=t),Object(u.a)(this._billboardCollection)&&this._billboardCollection.length>0&&!Object(u.a)(this._billboardCollection.get(0).width)&&(t=e.commandList,e.commandList=[],this._billboardCollection.update(e),e.commandList=t),this._enabledDirty&&(this._enabledDirty=!1,(i=this).enabled||(Object(u.a)(i._clusterLabelCollection)&&i._clusterLabelCollection.destroy(),Object(u.a)(i._clusterBillboardCollection)&&i._clusterBillboardCollection.destroy(),Object(u.a)(i._clusterPointCollection)&&i._clusterPointCollection.destroy(),i._clusterLabelCollection=void 0,i._clusterBillboardCollection=void 0,i._clusterPointCollection=void 0,Xq(i._labelCollection),Xq(i._billboardCollection),Xq(i._pointCollection)),this._clusterDirty=!0),this._clusterDirty&&(this._clusterDirty=!1,this._cluster()),Object(u.a)(this._clusterLabelCollection)&&this._clusterLabelCollection.update(e),Object(u.a)(this._clusterBillboardCollection)&&this._clusterBillboardCollection.update(e),Object(u.a)(this._clusterPointCollection)&&this._clusterPointCollection.update(e),Object(u.a)(this._labelCollection)&&this._labelCollection.update(e),Object(u.a)(this._billboardCollection)&&this._billboardCollection.update(e),Object(u.a)(this._pointCollection)&&this._pointCollection.update(e)},Mq.prototype.destroy=function(){this._labelCollection=this._labelCollection&&this._labelCollection.destroy(),this._billboardCollection=this._billboardCollection&&this._billboardCollection.destroy(),this._pointCollection=this._pointCollection&&this._pointCollection.destroy(),this._clusterLabelCollection=this._clusterLabelCollection&&this._clusterLabelCollection.destroy(),this._clusterBillboardCollection=this._clusterBillboardCollection&&this._clusterBillboardCollection.destroy(),this._clusterPointCollection=this._clusterPointCollection&&this._clusterPointCollection.destroy(),Object(u.a)(this._removeEventListener)&&(this._removeEventListener(),this._removeEventListener=void 0),this._labelCollection=void 0,this._billboardCollection=void 0,this._pointCollection=void 0,this._clusterBillboardCollection=void 0,this._clusterLabelCollection=void 0,this._clusterPointCollection=void 0,this._collectionIndicesByEntity=void 0,this._unusedLabelIndices=[],this._unusedBillboardIndices=[],this._unusedPointIndices=[],this._previousClusters=[],this._previousHeight=void 0,this._enabledDirty=!1,this._pixelRangeDirty=!1,this._minimumClusterSizeDirty=!1};var Zq=Mq;function Qq(e){this._name=e,this._clock=void 0,this._changed=new $o.a,this._error=new $o.a,this._isLoading=!1,this._loading=new $o.a,this._entityCollection=new OU(this),this._entityCluster=new Zq}Object(O.a)(Qq.prototype,{name:{get:function(){return this._name},set:function(e){this._name!==e&&(this._name=e,this._changed.raiseEvent(this))}},clock:{get:function(){return this._clock},set:function(e){this._clock!==e&&(this._clock=e,this._changed.raiseEvent(this))}},entities:{get:function(){return this._entityCollection}},isLoading:{get:function(){return this._isLoading},set:function(e){KU.setLoading(this,e)}},changedEvent:{get:function(){return this._changed}},errorEvent:{get:function(){return this._error}},loadingEvent:{get:function(){return this._loading}},show:{get:function(){return this._entityCollection.show},set:function(e){this._entityCollection.show=e}},clustering:{get:function(){return this._entityCluster},set:function(e){if(!Object(u.a)(e))throw new h.a("value must be defined.");this._entityCluster=e}}});var Kq=Qq,Jq=z.ZERO,$q=new z,eW=new z,tW=new uf;function iW(e){this.id=e,this.vertexFormat=void 0,this.length=void 0,this.topRadius=void 0,this.bottomRadius=void 0,this.slices=void 0,this.numberOfVerticalLines=void 0,this.offsetAttribute=void 0}function nW(e,t){Qz.call(this,{entity:e,scene:t,geometryOptions:new iW(e),geometryPropertyName:"cylinder",observedPropertyNames:["availability","position","orientation","cylinder"]}),this._onEntityPropertyChanged(e,"cylinder",e.cylinder,void 0)}function rW(e,t,i){aU.call(this,e,t,i)}Object(u.a)(Object.create)&&(nW.prototype=Object.create(Qz.prototype),nW.prototype.constructor=nW),Object(O.a)(nW.prototype,{terrainOffsetProperty:{get:function(){return this._terrainOffsetProperty}}}),nW.prototype.createFillGeometryInstance=function(e){if(x.a.defined("time",e),!this._fillEnabled)throw new h.a("This instance does not represent a filled geometry.");var t,i=this._entity,n=i.isAvailable(e),r=new sA(n&&i.isShowing&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)),a=this._distanceDisplayConditionProperty.getValue(e),o={show:r,distanceDisplayCondition:bv.fromDistanceDisplayCondition(a),color:void 0,offset:void 0};this._materialProperty instanceof oM&&(Object(u.a)(this._materialProperty.color)&&(this._materialProperty.color.isConstant||n)&&(t=this._materialProperty.color.getValue(e,tW)),Object(u.a)(t)||(t=uf.WHITE),o.color=df.fromColor(t));return Object(u.a)(this._options.offsetAttribute)&&(o.offset=tE.fromCartesian3(aD.getValueOrDefault(this._terrainOffsetProperty,e,Jq,$q))),new Mu({id:i,geometry:new rv(this._options),modelMatrix:i.computeModelMatrixForHeightReference(e,i.cylinder.heightReference,.5*this._options.length,this._scene.mapProjection.ellipsoid),attributes:o})},nW.prototype.createOutlineGeometryInstance=function(e){if(x.a.defined("time",e),!this._outlineEnabled)throw new h.a("This instance does not represent an outlined geometry.");var t=this._entity,i=t.isAvailable(e),n=aD.getValueOrDefault(this._outlineColorProperty,e,uf.BLACK,tW),r=this._distanceDisplayConditionProperty.getValue(e),a={show:new sA(i&&t.isShowing&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)),color:df.fromColor(n),distanceDisplayCondition:bv.fromDistanceDisplayCondition(r),offset:void 0};return Object(u.a)(this._options.offsetAttribute)&&(a.offset=tE.fromCartesian3(aD.getValueOrDefault(this._terrainOffsetProperty,e,Jq,$q))),new Mu({id:t,geometry:new cv(this._options),modelMatrix:t.computeModelMatrixForHeightReference(e,t.cylinder.heightReference,.5*this._options.length,this._scene.mapProjection.ellipsoid),attributes:a})},nW.prototype._computeCenter=function(e,t){return aD.getValueOrUndefined(this._entity.position,e,t)},nW.prototype._isHidden=function(e,t){return!Object(u.a)(e.position)||!Object(u.a)(t.length)||!Object(u.a)(t.topRadius)||!Object(u.a)(t.bottomRadius)||Qz.prototype._isHidden.call(this,e,t)},nW.prototype._isDynamic=function(e,t){return!(e.position.isConstant&&aD.isConstant(e.orientation)&&t.length.isConstant&&t.topRadius.isConstant&&t.bottomRadius.isConstant&&aD.isConstant(t.slices)&&aD.isConstant(t.outlineWidth)&&aD.isConstant(t.numberOfVerticalLines))},nW.prototype._setStaticOptions=function(e,t){var i=aD.getValueOrDefault(t.heightReference,nx.MINIMUM_VALUE,eD.NONE),n=this._options;n.vertexFormat=this._materialProperty instanceof oM?$j.VERTEX_FORMAT:Yj.MaterialSupport.TEXTURED.vertexFormat,n.length=t.length.getValue(nx.MINIMUM_VALUE),n.topRadius=t.topRadius.getValue(nx.MINIMUM_VALUE),n.bottomRadius=t.bottomRadius.getValue(nx.MINIMUM_VALUE),n.slices=aD.getValueOrUndefined(t.slices,nx.MINIMUM_VALUE),n.numberOfVerticalLines=aD.getValueOrUndefined(t.numberOfVerticalLines,nx.MINIMUM_VALUE),n.offsetAttribute=i!==eD.NONE?fn.ALL:void 0},nW.prototype._onEntityPropertyChanged=tU,nW.DynamicGeometryUpdater=rW,Object(u.a)(Object.create)&&(rW.prototype=Object.create(aU.prototype),rW.prototype.constructor=rW),rW.prototype._isHidden=function(e,t,i){var n=this._options,r=aD.getValueOrUndefined(e.position,i,eW);return!Object(u.a)(r)||!Object(u.a)(n.length)||!Object(u.a)(n.topRadius)||!Object(u.a)(n.bottomRadius)||aU.prototype._isHidden.call(this,e,t,i)},rW.prototype._setOptions=function(e,t,i){var n=aD.getValueOrDefault(t.heightReference,i,eD.NONE),r=this._options;r.length=aD.getValueOrUndefined(t.length,i),r.topRadius=aD.getValueOrUndefined(t.topRadius,i),r.bottomRadius=aD.getValueOrUndefined(t.bottomRadius,i),r.slices=aD.getValueOrUndefined(t.slices,i),r.numberOfVerticalLines=aD.getValueOrUndefined(t.numberOfVerticalLines,i),r.offsetAttribute=n!==eD.NONE?fn.ALL:void 0};var aW=nW,oW={HIGHLIGHT:0,REPLACE:1,MIX:2,getColorBlend:function(e,t){return e===oW.HIGHLIGHT?0:e===oW.REPLACE?1:e===oW.MIX?I.clamp(t,I.EPSILON4,1):void 0}},sW=Object(E.a)(oW);function cW(){this._startTime=void 0,this._stopTime=void 0,this._currentTime=void 0,this._clockRange=void 0,this._clockStep=void 0,this._multiplier=void 0,this._definitionChanged=new $o.a}Object(O.a)(cW.prototype,{definitionChanged:{get:function(){return this._definitionChanged}},startTime:JB("startTime"),stopTime:JB("stopTime"),currentTime:JB("currentTime"),clockRange:JB("clockRange"),clockStep:JB("clockStep"),multiplier:JB("multiplier")}),cW.prototype.clone=function(e){return Object(u.a)(e)||(e=new cW),e.startTime=this.startTime,e.stopTime=this.stopTime,e.currentTime=this.currentTime,e.clockRange=this.clockRange,e.clockStep=this.clockStep,e.multiplier=this.multiplier,e},cW.prototype.equals=function(e){return this===e||Object(u.a)(e)&&Tr.equals(this.startTime,e.startTime)&&Tr.equals(this.stopTime,e.stopTime)&&Tr.equals(this.currentTime,e.currentTime)&&this.clockRange===e.clockRange&&this.clockStep===e.clockStep&&this.multiplier===e.multiplier},cW.prototype.merge=function(e){if(!Object(u.a)(e))throw new h.a("source is required.");this.startTime=Object(w.a)(this.startTime,e.startTime),this.stopTime=Object(w.a)(this.stopTime,e.stopTime),this.currentTime=Object(w.a)(this.currentTime,e.currentTime),this.clockRange=Object(w.a)(this.clockRange,e.clockRange),this.clockStep=Object(w.a)(this.clockStep,e.clockStep),this.multiplier=Object(w.a)(this.multiplier,e.multiplier)},cW.prototype.getValue=function(e){return Object(u.a)(e)||(e=new tf),e.startTime=Object(w.a)(this.startTime,e.startTime),e.stopTime=Object(w.a)(this.stopTime,e.stopTime),e.currentTime=Object(w.a)(this.currentTime,e.currentTime),e.clockRange=Object(w.a)(this.clockRange,e.clockRange),e.multiplier=Object(w.a)(this.multiplier,e.multiplier),e.clockStep=Object(w.a)(this.clockStep,e.clockStep),e};var lW=cW,uW=uf.WHITE,hW=new Rt(8,8),dW=new Rt(0,0),fW=new Rt(1,1);function pW(e){e=Object(w.a)(e,w.a.EMPTY_OBJECT),this._definitionChanged=new $o.a,this._color=void 0,this._colorSubscription=void 0,this._cellAlpha=void 0,this._cellAlphaSubscription=void 0,this._lineCount=void 0,this._lineCountSubscription=void 0,this._lineThickness=void 0,this._lineThicknessSubscription=void 0,this._lineOffset=void 0,this._lineOffsetSubscription=void 0,this.color=e.color,this.cellAlpha=e.cellAlpha,this.lineCount=e.lineCount,this.lineThickness=e.lineThickness,this.lineOffset=e.lineOffset}Object(O.a)(pW.prototype,{isConstant:{get:function(){return aD.isConstant(this._color)&&aD.isConstant(this._cellAlpha)&&aD.isConstant(this._lineCount)&&aD.isConstant(this._lineThickness)&&aD.isConstant(this._lineOffset)}},definitionChanged:{get:function(){return this._definitionChanged}},color:KI("color"),cellAlpha:KI("cellAlpha"),lineCount:KI("lineCount"),lineThickness:KI("lineThickness"),lineOffset:KI("lineOffset")}),pW.prototype.getType=function(e){return"Grid"},pW.prototype.getValue=function(e,t){return Object(u.a)(t)||(t={}),t.color=aD.getValueOrClonedDefault(this._color,e,uW,t.color),t.cellAlpha=aD.getValueOrDefault(this._cellAlpha,e,.1),t.lineCount=aD.getValueOrClonedDefault(this._lineCount,e,hW,t.lineCount),t.lineThickness=aD.getValueOrClonedDefault(this._lineThickness,e,fW,t.lineThickness),t.lineOffset=aD.getValueOrClonedDefault(this._lineOffset,e,dW,t.lineOffset),t},pW.prototype.equals=function(e){return this===e||e instanceof pW&&aD.equals(this._color,e._color)&&aD.equals(this._cellAlpha,e._cellAlpha)&&aD.equals(this._lineCount,e._lineCount)&&aD.equals(this._lineThickness,e._lineThickness)&&aD.equals(this._lineOffset,e._lineOffset)};var mW=pW;function _W(e){this._definitionChanged=new $o.a,this._color=void 0,this._colorSubscription=void 0,this.color=e}Object(O.a)(_W.prototype,{isConstant:{get:function(){return aD.isConstant(this._color)}},definitionChanged:{get:function(){return this._definitionChanged}},color:KI("color")}),_W.prototype.getType=function(e){return"PolylineArrow"},_W.prototype.getValue=function(e,t){return Object(u.a)(t)||(t={}),t.color=aD.getValueOrClonedDefault(this._color,e,uf.WHITE,t.color),t},_W.prototype.equals=function(e){return this===e||e instanceof _W&&aD.equals(this._color,e._color)};var gW=_W,vW=uf.WHITE,bW=uf.TRANSPARENT;function yW(e){e=Object(w.a)(e,w.a.EMPTY_OBJECT),this._definitionChanged=new $o.a,this._color=void 0,this._colorSubscription=void 0,this._gapColor=void 0,this._gapColorSubscription=void 0,this._dashLength=void 0,this._dashLengthSubscription=void 0,this._dashPattern=void 0,this._dashPatternSubscription=void 0,this.color=e.color,this.gapColor=e.gapColor,this.dashLength=e.dashLength,this.dashPattern=e.dashPattern}Object(O.a)(yW.prototype,{isConstant:{get:function(){return aD.isConstant(this._color)&&aD.isConstant(this._gapColor)&&aD.isConstant(this._dashLength)&&aD.isConstant(this._dashPattern)}},definitionChanged:{get:function(){return this._definitionChanged}},color:KI("color"),gapColor:KI("gapColor"),dashLength:KI("dashLength"),dashPattern:KI("dashPattern")}),yW.prototype.getType=function(e){return"PolylineDash"},yW.prototype.getValue=function(e,t){return Object(u.a)(t)||(t={}),t.color=aD.getValueOrClonedDefault(this._color,e,vW,t.color),t.gapColor=aD.getValueOrClonedDefault(this._gapColor,e,bW,t.gapColor),t.dashLength=aD.getValueOrDefault(this._dashLength,e,16,t.dashLength),t.dashPattern=aD.getValueOrDefault(this._dashPattern,e,255,t.dashPattern),t},yW.prototype.equals=function(e){return this===e||e instanceof yW&&aD.equals(this._color,e._color)&&aD.equals(this._gapColor,e._gapColor)&&aD.equals(this._dashLength,e._dashLength)&&aD.equals(this._dashPattern,e._dashPattern)};var wW=yW,OW=uf.WHITE;function xW(e){e=Object(w.a)(e,w.a.EMPTY_OBJECT),this._definitionChanged=new $o.a,this._color=void 0,this._colorSubscription=void 0,this._glowPower=void 0,this._glowPowerSubscription=void 0,this.color=e.color,this.glowPower=e.glowPower}Object(O.a)(xW.prototype,{isConstant:{get:function(){return aD.isConstant(this._color)&&aD.isConstant(this._glow)}},definitionChanged:{get:function(){return this._definitionChanged}},color:KI("color"),glowPower:KI("glowPower")}),xW.prototype.getType=function(e){return"PolylineGlow"},xW.prototype.getValue=function(e,t){return Object(u.a)(t)||(t={}),t.color=aD.getValueOrClonedDefault(this._color,e,OW,t.color),t.glowPower=aD.getValueOrDefault(this._glowPower,e,.25,t.glowPower),t},xW.prototype.equals=function(e){return this===e||e instanceof xW&&aD.equals(this._color,e._color)&&aD.equals(this._glowPower,e._glowPower)};var EW=xW,TW=uf.WHITE,CW=uf.BLACK;function SW(e){e=Object(w.a)(e,w.a.EMPTY_OBJECT),this._definitionChanged=new $o.a,this._color=void 0,this._colorSubscription=void 0,this._outlineColor=void 0,this._outlineColorSubscription=void 0,this._outlineWidth=void 0,this._outlineWidthSubscription=void 0,this.color=e.color,this.outlineColor=e.outlineColor,this.outlineWidth=e.outlineWidth}Object(O.a)(SW.prototype,{isConstant:{get:function(){return aD.isConstant(this._color)&&aD.isConstant(this._outlineColor)&&aD.isConstant(this._outlineWidth)}},definitionChanged:{get:function(){return this._definitionChanged}},color:KI("color"),outlineColor:KI("outlineColor"),outlineWidth:KI("outlineWidth")}),SW.prototype.getType=function(e){return"PolylineOutline"},SW.prototype.getValue=function(e,t){return Object(u.a)(t)||(t={}),t.color=aD.getValueOrClonedDefault(this._color,e,TW,t.color),t.outlineColor=aD.getValueOrClonedDefault(this._outlineColor,e,CW,t.outlineColor),t.outlineWidth=aD.getValueOrDefault(this._outlineWidth,e,1),t},SW.prototype.equals=function(e){return this===e||e instanceof SW&&aD.equals(this._color,e._color)&&aD.equals(this._outlineColor,e._outlineColor)&&aD.equals(this._outlineWidth,e._outlineWidth)};var AW=SW,PW=new uf(.5921569,.8450981,.97647065,.2),IW=new uf(1,0,0,.8);function DW(e){e=Object(w.a)(e,w.a.EMPTY_OBJECT),this._definitionChanged=new $o.a,this._evenColor=void 0,this._oddColor=void 0,this.evenColor=e.evenColor,this.oddColor=e.oddColor}Object(O.a)(DW.prototype,{isConstant:{get:function(){return aD.isConstant(this._evenColor)&&aD.isConstant(this._oddColor)}},definitionChanged:{get:function(){return this._definitionChanged}},evenColor:KI("evenColor"),oddColor:KI("oddColor")}),DW.prototype.getType=function(e){return"Trail"},DW.prototype.getValue=function(e,t){return Object(u.a)(t)||(t={}),t.evenColor=aD.getValueOrClonedDefault(this._evenColor,e,PW,t.evenColor),t.oddColor=aD.getValueOrDefault(this._oddColor,e,IW,t.oddColor),t},DW.prototype.equals=function(e){return this===e||e instanceof DW&&aD.equals(this._evenColor,e._evenColor)&&aD.equals(this._oddColor,e._oddColor)};var jW=DW,MW=uf.WHITE,RW=uf.TRANSPARENT,LW=uf.BLUE;function NW(e){e=Object(w.a)(e,w.a.EMPTY_OBJECT),this._definitionChanged=new $o.a,this._color=void 0,this._oddColor=void 0,this._animat=void 0,this._gradual=void 0,this._colorSubscription=void 0,this._gapColor=void 0,this._gapColorSubscription=void 0,this._dashLength=void 0,this._dashLengthSubscription=void 0,this._dashPattern=void 0,this._dashPatternSubscription=void 0,this._speed=void 0,this.color=e.color,this.gapColor=e.gapColor,this.dashLength=e.dashLength,this.dashPattern=e.dashPattern,this.oddColor=e.oddColor,this.animat=e.animat,this.gradual=e.gradual,this.speed=e.speed}Object(O.a)(NW.prototype,{isConstant:{get:function(){return aD.isConstant(this._color)&&aD.isConstant(this._gapColor)&&aD.isConstant(this._dashLength)&&aD.isConstant(this._dashPattern)&&aD.isConstant(this._oddColor)&&aD.isConstant(this._animat)&&aD.isConstant(this._gradual)&&aD.isConstant(this._speed)}},definitionChanged:{get:function(){return this._definitionChanged}},color:KI("color"),gapColor:KI("gapColor"),dashLength:KI("dashLength"),dashPattern:KI("dashPattern"),oddColor:KI("oddColor"),animat:KI("animat"),gradual:KI("gradual"),speed:KI("speed")}),NW.prototype.getType=function(e){return"PolylineDashDynamic"},NW.prototype.getValue=function(e,t){return Object(u.a)(t)||(t={}),t.color=aD.getValueOrClonedDefault(this._color,e,MW,t.color),t.gapColor=aD.getValueOrClonedDefault(this._gapColor,e,RW,t.gapColor),t.dashLength=aD.getValueOrDefault(this._dashLength,e,16,t.dashLength),t.dashPattern=aD.getValueOrDefault(this._dashPattern,e,255,t.dashPattern),t.oddColor=aD.getValueOrDefault(this._oddColor,e,LW,t.oddColor),t.animat=aD.getValueOrDefault(this._animat,e,!0,t.animat),t.gradual=aD.getValueOrDefault(this._gradual,e,!0,t.gradual),t.speed=aD.getValueOrDefault(this._speed,e,.5,t.speed),t},NW.prototype.equals=function(e){return this===e||e instanceof NW&&aD.equals(this._color,e._color)&&aD.equals(this._gapColor,e._gapColor)&&aD.equals(this._dashLength,e._dashLength)&&aD.equals(this._dashPattern,e._dashPattern)&&aD.equals(this._oddColor,e._oddColor)&&aD.equals(this._animat,e._animat)&&aD.equals(this._gradual,e._gradual)&&aD.equals(this._speed,e._speed)};var FW=NW,kW=uf.WHITE;function BW(e){e=Object(w.a)(e,w.a.EMPTY_OBJECT),this._definitionChanged=new $o.a,this._color=void 0,this._colorSubscription=void 0,this.color=e.color}Object(O.a)(BW.prototype,{isConstant:{get:function(){return aD.isConstant(this._color)}},definitionChanged:{get:function(){return this._definitionChanged}},color:KI("color")}),BW.prototype.getType=function(e){return"DiffusionRing"},BW.prototype.getValue=function(e,t){return Object(u.a)(t)||(t={}),t.color=aD.getValueOrClonedDefault(this._color,e,kW,t.color),t},BW.prototype.equals=function(e){return this===e||e instanceof BW&&aD.equals(this._color,e._color)};var zW=BW;function UW(e,t){this._value=void 0,this._definitionChanged=new $o.a,this._eventHelper=new eb,this._referenceFrame=Object(w.a)(t,mS.FIXED),this.setValue(e)}Object(O.a)(UW.prototype,{isConstant:{get:function(){var e=this._value;if(!Object(u.a)(e))return!0;for(var t=e.length,i=0;i<t;i++)if(!aD.isConstant(e[i]))return!1;return!0}},definitionChanged:{get:function(){return this._definitionChanged}},referenceFrame:{get:function(){return this._referenceFrame}}}),UW.prototype.getValue=function(e,t){return this.getValueInReferenceFrame(e,mS.FIXED,t)},UW.prototype.getValueInReferenceFrame=function(e,t,i){if(!Object(u.a)(e))throw new h.a("time is required.");if(!Object(u.a)(t))throw new h.a("referenceFrame is required.");var n=this._value;if(Object(u.a)(n)){var r=n.length;Object(u.a)(i)||(i=new Array(r));for(var a=0,o=0;a<r;){var s=n[a].getValueInReferenceFrame(e,t,i[a]);Object(u.a)(s)&&(i[o]=s,o++),a++}return i.length=o,i}},UW.prototype.setValue=function(e){var t=this._eventHelper;if(t.removeAll(),Object(u.a)(e)){this._value=e.slice();for(var i=e.length,n=0;n<i;n++){var r=e[n];Object(u.a)(r)&&t.add(r.definitionChanged,UW.prototype._raiseDefinitionChanged,this)}}else this._value=void 0;this._definitionChanged.raiseEvent(this)},UW.prototype.equals=function(e){return this===e||e instanceof UW&&this._referenceFrame===e._referenceFrame&&aD.arrayEquals(this._value,e._value)},UW.prototype._raiseDefinitionChanged=function(){this._definitionChanged.raiseEvent(this)};var VW=UW;function HW(e){this._value=void 0,this._definitionChanged=new $o.a,this._eventHelper=new eb,this.setValue(e)}Object(O.a)(HW.prototype,{isConstant:{get:function(){var e=this._value;if(!Object(u.a)(e))return!0;for(var t=e.length,i=0;i<t;i++)if(!aD.isConstant(e[i]))return!1;return!0}},definitionChanged:{get:function(){return this._definitionChanged}}}),HW.prototype.getValue=function(e,t){if(!Object(u.a)(e))throw new h.a("time is required.");var i=this._value;if(Object(u.a)(i)){var n=i.length;Object(u.a)(t)||(t=new Array(n));for(var r=0,a=0;r<n;){var o=this._value[r].getValue(e,t[r]);Object(u.a)(o)&&(t[a]=o,a++),r++}return t.length=a,t}},HW.prototype.setValue=function(e){var t=this._eventHelper;if(t.removeAll(),Object(u.a)(e)){this._value=e.slice();for(var i=e.length,n=0;n<i;n++){var r=e[n];Object(u.a)(r)&&t.add(r.definitionChanged,HW.prototype._raiseDefinitionChanged,this)}}else this._value=void 0;this._definitionChanged.raiseEvent(this)},HW.prototype.equals=function(e){return this===e||e instanceof HW&&aD.arrayEquals(this._value,e._value)},HW.prototype._raiseDefinitionChanged=function(){this._definitionChanged.raiseEvent(this)};var GW=HW;function qW(e){var t=e._targetProperty;if(e._resolveProperty){var i=function(e){var t=!0;if(e._resolveEntity){var i=e._targetCollection.getById(e._targetId);if(Object(u.a)(i)?(i.definitionChanged.addEventListener(WW.prototype._onTargetEntityDefinitionChanged,e),e._targetEntity=i,e._resolveEntity=!1):(i=e._targetEntity,t=!1),!Object(u.a)(i))throw new Ce.a('target entity "'+e._targetId+'" could not be resolved.')}return t}(e),n=e._targetPropertyNames;t=e._targetEntity;for(var r=n.length,a=0;a<r&&Object(u.a)(t);a++)t=t[n[a]];if(Object(u.a)(t))e._targetProperty=t,e._resolveProperty=!i;else if(!Object(u.a)(e._targetProperty))throw new Ce.a('targetProperty "'+e._targetId+"."+n.join(".")+'" could not be resolved.')}return t}function WW(e,t,i){if(!Object(u.a)(e))throw new h.a("targetCollection is required.");if(!Object(u.a)(t)||""===t)throw new h.a("targetId is required.");if(!Object(u.a)(i)||0===i.length)throw new h.a("targetPropertyNames is required.");for(var n=0;n<i.length;n++){var r=i[n];if(!Object(u.a)(r)||""===r)throw new h.a("reference contains invalid properties.")}this._targetCollection=e,this._targetId=t,this._targetPropertyNames=i,this._targetProperty=void 0,this._targetEntity=void 0,this._definitionChanged=new $o.a,this._resolveEntity=!0,this._resolveProperty=!0,e.collectionChanged.addEventListener(WW.prototype._onCollectionChanged,this)}Object(O.a)(WW.prototype,{isConstant:{get:function(){return aD.isConstant(qW(this))}},definitionChanged:{get:function(){return this._definitionChanged}},referenceFrame:{get:function(){return qW(this).referenceFrame}},targetId:{get:function(){return this._targetId}},targetCollection:{get:function(){return this._targetCollection}},targetPropertyNames:{get:function(){return this._targetPropertyNames}},resolvedProperty:{get:function(){return qW(this)}}}),WW.fromString=function(e,t){if(!Object(u.a)(e))throw new h.a("targetCollection is required.");if(!Object(u.a)(t))throw new h.a("referenceString is required.");for(var i,n=[],r=!0,a=!1,o="",s=0;s<t.length;++s){var c=t.charAt(s);a?(o+=c,a=!1):"\\"===c?a=!0:r&&"#"===c?(i=o,r=!1,o=""):r||"."!==c?o+=c:(n.push(o),o="")}return n.push(o),new WW(e,i,n)},WW.prototype.getValue=function(e,t){return qW(this).getValue(e,t)},WW.prototype.getValueInReferenceFrame=function(e,t,i){return qW(this).getValueInReferenceFrame(e,t,i)},WW.prototype.getType=function(e){return qW(this).getType(e)},WW.prototype.equals=function(e){if(this===e)return!0;var t=this._targetPropertyNames,i=e._targetPropertyNames;if(this._targetCollection!==e._targetCollection||this._targetId!==e._targetId||t.length!==i.length)return!1;for(var n=this._targetPropertyNames.length,r=0;r<n;r++)if(t[r]!==i[r])return!1;return!0},WW.prototype._onTargetEntityDefinitionChanged=function(e,t,i,n){this._targetPropertyNames[0]===t&&(this._resolveProperty=!0,this._definitionChanged.raiseEvent(this))},WW.prototype._onCollectionChanged=function(e,t,i){var n=this._targetEntity;Object(u.a)(n)&&(-1!==i.indexOf(n)?(n.definitionChanged.removeEventListener(WW.prototype._onTargetEntityDefinitionChanged,this),this._resolveEntity=!0,this._resolveProperty=!0):this._resolveEntity&&(qW(this),this._resolveEntity||this._definitionChanged.raiseEvent(this)))};var YW=WW,XW={packedLength:1,pack:function(e,t,i){if(!Object(u.a)(e))throw new h.a("value is required");if(!Object(u.a)(t))throw new h.a("array is required");return t[i=Object(w.a)(i,0)]=e,t},unpack:function(e,t,i){if(!Object(u.a)(e))throw new h.a("array is required");return e[t=Object(w.a)(t,0)]},convertPackedArrayForInterpolation:function(e,t,i,n){if(!Object(u.a)(e))throw new h.a("packedArray is required");var r;t=Object(w.a)(t,0);for(var a=0,o=(i=Object(w.a)(i,e.length))-t+1;a<o;a++){var s=e[t+a];0===a||Math.abs(r-s)<Math.PI?n[a]=s:n[a]=s-I.TWO_PI,r=s}},unpackInterpolationResult:function(e,t,i,n,r){if(!Object(u.a)(e))throw new h.a("array is required");if(!Object(u.a)(t))throw new h.a("sourceArray is required");return(r=e[0])<0?r+I.TWO_PI:r}},ZW={packedLength:1,pack:function(e,t,i){t[i=Object(w.a)(i,0)]=e},unpack:function(e,t,i){return e[t=Object(w.a)(t,0)]}};function QW(e,t,i){var n,r=e.length,a=i.length,o=r+a;if(e.length=o,r!==t){var s=r-1;for(n=o-1;n>=t;n--)e[n]=e[s--]}for(n=0;n<a;n++)e[t++]=i[n]}function KW(e,t){return e instanceof Tr?e:"string"==typeof e?Tr.fromIso8601(e):Tr.addSeconds(t,e,new Tr)}var JW=[],$W=[];function eY(e,t,i,n,r){for(var a,o,s,c,l,h,d=0;d<n.length;){l=KW(n[d],e);var f=0,p=0;if((s=Ji(t,l,Tr.compare))<0){for(c=(s=~s)*r,o=void 0,h=t[s];d<n.length&&(l=KW(n[d],e),!(Object(u.a)(o)&&Tr.compare(o,l)>=0||Object(u.a)(h)&&Tr.compare(l,h)>=0));){for(JW[f++]=l,d+=1,a=0;a<r;a++)$W[p++]=n[d],d+=1;o=l}f>0&&($W.length=p,QW(i,c,$W),JW.length=f,QW(t,s,JW))}else{for(a=0;a<r;a++)d++,i[s*r+a]=n[d];d++}}}function tY(e,t){if(!Object(u.a)(e))throw new h.a("type is required.");var i=e;i===Number&&(i=ZW);var n,r=i.packedLength,a=Object(w.a)(i.packedInterpolationLength,r),o=0;if(Object(u.a)(t)){var s=t.length;n=new Array(s);for(var c=0;c<s;c++){var l=t[c];l===Number&&(l=ZW);var d=l.packedLength;r+=d,a+=Object(w.a)(l.packedInterpolationLength,d),n[c]=l}o=s}this._type=e,this._innerType=i,this._interpolationDegree=1,this._interpolationAlgorithm=cx,this._numberOfPoints=0,this._times=[],this._values=[],this._xTable=[],this._yTable=[],this._packedLength=r,this._packedInterpolationLength=a,this._updateTableLength=!0,this._interpolationResult=new Array(a),this._definitionChanged=new $o.a,this._derivativeTypes=t,this._innerDerivativeTypes=n,this._inputOrder=o,this._forwardExtrapolationType=tb.NONE,this._forwardExtrapolationDuration=0,this._backwardExtrapolationType=tb.NONE,this._backwardExtrapolationDuration=0}Object(O.a)(tY.prototype,{isConstant:{get:function(){return 0===this._values.length}},definitionChanged:{get:function(){return this._definitionChanged}},type:{get:function(){return this._type}},derivativeTypes:{get:function(){return this._derivativeTypes}},interpolationDegree:{get:function(){return this._interpolationDegree}},interpolationAlgorithm:{get:function(){return this._interpolationAlgorithm}},forwardExtrapolationType:{get:function(){return this._forwardExtrapolationType},set:function(e){this._forwardExtrapolationType!==e&&(this._forwardExtrapolationType=e,this._definitionChanged.raiseEvent(this))}},forwardExtrapolationDuration:{get:function(){return this._forwardExtrapolationDuration},set:function(e){this._forwardExtrapolationDuration!==e&&(this._forwardExtrapolationDuration=e,this._definitionChanged.raiseEvent(this))}},backwardExtrapolationType:{get:function(){return this._backwardExtrapolationType},set:function(e){this._backwardExtrapolationType!==e&&(this._backwardExtrapolationType=e,this._definitionChanged.raiseEvent(this))}},backwardExtrapolationDuration:{get:function(){return this._backwardExtrapolationDuration},set:function(e){this._backwardExtrapolationDuration!==e&&(this._backwardExtrapolationDuration=e,this._definitionChanged.raiseEvent(this))}}}),tY.prototype.getValue=function(e,t){if(!Object(u.a)(e))throw new h.a("time is required.");var i=this._times,n=i.length;if(0!==n){var r,a=this._innerType,o=this._values,s=Ji(i,e,Tr.compare);if(s<0){if(0===(s=~s)){var c=i[s];if(r=this._backwardExtrapolationDuration,this._backwardExtrapolationType===tb.NONE||0!==r&&Tr.secondsDifference(c,e)>r)return;if(this._backwardExtrapolationType===tb.HOLD)return a.unpack(o,0,t)}if(s>=n){var l=i[s=n-1];if(r=this._forwardExtrapolationDuration,this._forwardExtrapolationType===tb.NONE||0!==r&&Tr.secondsDifference(e,l)>r)return;if(this._forwardExtrapolationType===tb.HOLD)return s=n-1,a.unpack(o,s*a.packedLength,t)}var d=this._xTable,f=this._yTable,p=this._interpolationAlgorithm,m=this._packedInterpolationLength,_=this._inputOrder;if(this._updateTableLength){this._updateTableLength=!1;var g=Math.min(p.getRequiredDataPoints(this._interpolationDegree,_),n);g!==this._numberOfPoints&&(this._numberOfPoints=g,d.length=g,f.length=g*m)}var v=this._numberOfPoints-1;if(v<1)return;var b=0,y=n-1;if(y-b+1>=v+1){var w=s-(v/2|0)-1;w<b&&(w=b);var O=w+v;O>y&&(w=(O=y)-v)<b&&(w=b),b=w,y=O}for(var x=y-b+1,E=0;E<x;++E)d[E]=Tr.secondsDifference(i[b+E],i[y]);if(Object(u.a)(a.convertPackedArrayForInterpolation))a.convertPackedArrayForInterpolation(o,b,y,f);else for(var T=0,C=this._packedLength,S=b*C,A=(y+1)*C;S<A;)f[T]=o[S],S++,T++;var P,I=Tr.secondsDifference(e,i[y]);if(0!==_&&Object(u.a)(p.interpolate)){var D=Math.floor(m/(_+1));P=p.interpolate(I,d,f,D,_,_,this._interpolationResult)}else P=p.interpolateOrderZero(I,d,f,m,this._interpolationResult);return Object(u.a)(a.unpackInterpolationResult)?a.unpackInterpolationResult(P,o,b,y,t):a.unpack(P,0,t)}return a.unpack(o,s*this._packedLength,t)}},tY.prototype.setInterpolationOptions=function(e){if(Object(u.a)(e)){var t=!1,i=e.interpolationAlgorithm,n=e.interpolationDegree;Object(u.a)(i)&&this._interpolationAlgorithm!==i&&(this._interpolationAlgorithm=i,t=!0),Object(u.a)(n)&&this._interpolationDegree!==n&&(this._interpolationDegree=n,t=!0),t&&(this._updateTableLength=!0,this._definitionChanged.raiseEvent(this))}},tY.prototype.addSample=function(e,t,i){var n=this._innerDerivativeTypes,r=Object(u.a)(n);if(!Object(u.a)(e))throw new h.a("time is required.");if(!Object(u.a)(t))throw new h.a("value is required.");if(r&&!Object(u.a)(i))throw new h.a("derivatives is required.");var a=this._innerType,o=[];if(o.push(e),a.pack(t,o,o.length),r)for(var s=n.length,c=0;c<s;c++)n[c].pack(i[c],o,o.length);eY(void 0,this._times,this._values,o,this._packedLength),this._updateTableLength=!0,this._definitionChanged.raiseEvent(this)},tY.prototype.addSamples=function(e,t,i){var n=this._innerDerivativeTypes,r=Object(u.a)(n);if(!Object(u.a)(e))throw new h.a("times is required.");if(!Object(u.a)(t))throw new h.a("values is required.");if(e.length!==t.length)throw new h.a("times and values must be the same length.");if(r&&(!Object(u.a)(i)||i.length!==e.length))throw new h.a("times and derivativeValues must be the same length.");for(var a=this._innerType,o=e.length,s=[],c=0;c<o;c++)if(s.push(e[c]),a.pack(t[c],s,s.length),r)for(var l=i[c],d=n.length,f=0;f<d;f++)n[f].pack(l[f],s,s.length);eY(void 0,this._times,this._values,s,this._packedLength),this._updateTableLength=!0,this._definitionChanged.raiseEvent(this)},tY.prototype.addSamplesPackedArray=function(e,t){if(!Object(u.a)(e))throw new h.a("packedSamples is required.");eY(t,this._times,this._values,e,this._packedLength),this._updateTableLength=!0,this._definitionChanged.raiseEvent(this)},tY.prototype.equals=function(e){if(this===e)return!0;if(!Object(u.a)(e))return!1;if(this._type!==e._type||this._interpolationDegree!==e._interpolationDegree||this._interpolationAlgorithm!==e._interpolationAlgorithm)return!1;var t,i,n=this._derivativeTypes,r=Object(u.a)(n),a=e._derivativeTypes;if(r!==Object(u.a)(a))return!1;if(r){if((i=n.length)!==a.length)return!1;for(t=0;t<i;t++)if(n[t]!==a[t])return!1}var o=this._times,s=e._times;if((i=o.length)!==s.length)return!1;for(t=0;t<i;t++)if(!Tr.equals(o[t],s[t]))return!1;var c=this._values,l=e._values;for(t=0;t<i;t++)if(c[t]!==l[t])return!1;return!0},tY._mergeNewSamples=eY;var iY=tY;function nY(e,t){var i;if((t=Object(w.a)(t,0))>0){i=new Array(t);for(var n=0;n<t;n++)i[n]=z}this._numberOfDerivatives=t,this._property=new iY(z,i),this._definitionChanged=new $o.a,this._referenceFrame=Object(w.a)(e,mS.FIXED),this._property._definitionChanged.addEventListener((function(){this._definitionChanged.raiseEvent(this)}),this)}Object(O.a)(nY.prototype,{isConstant:{get:function(){return this._property.isConstant}},definitionChanged:{get:function(){return this._definitionChanged}},referenceFrame:{get:function(){return this._referenceFrame}},interpolationDegree:{get:function(){return this._property.interpolationDegree}},interpolationAlgorithm:{get:function(){return this._property.interpolationAlgorithm}},numberOfDerivatives:{get:function(){return this._numberOfDerivatives}},forwardExtrapolationType:{get:function(){return this._property.forwardExtrapolationType},set:function(e){this._property.forwardExtrapolationType=e}},forwardExtrapolationDuration:{get:function(){return this._property.forwardExtrapolationDuration},set:function(e){this._property.forwardExtrapolationDuration=e}},backwardExtrapolationType:{get:function(){return this._property.backwardExtrapolationType},set:function(e){this._property.backwardExtrapolationType=e}},backwardExtrapolationDuration:{get:function(){return this._property.backwardExtrapolationDuration},set:function(e){this._property.backwardExtrapolationDuration=e}}}),nY.prototype.getValue=function(e,t){return this.getValueInReferenceFrame(e,mS.FIXED,t)},nY.prototype.getValueInReferenceFrame=function(e,t,i){if(!Object(u.a)(e))throw new h.a("time is required.");if(!Object(u.a)(t))throw new h.a("referenceFrame is required.");if(i=this._property.getValue(e,i),Object(u.a)(i))return WB.convertToReferenceFrame(e,i,this._referenceFrame,t,i)},nY.prototype.setInterpolationOptions=function(e){this._property.setInterpolationOptions(e)},nY.prototype.addSample=function(e,t,i){var n=this._numberOfDerivatives;if(n>0&&(!Object(u.a)(i)||i.length!==n))throw new h.a("derivatives length must be equal to the number of derivatives.");this._property.addSample(e,t,i)},nY.prototype.addSamples=function(e,t,i){this._property.addSamples(e,t,i)},nY.prototype.addSamplesPackedArray=function(e,t){this._property.addSamplesPackedArray(e,t)},nY.prototype.equals=function(e){return this===e||e instanceof nY&&aD.equals(this._property,e._property)&&this._referenceFrame===e._referenceFrame};var rY=nY,aY=Object(E.a)({HORIZONTAL:0,VERTICAL:1}),oY=aY.HORIZONTAL,sY=uf.WHITE,cY=uf.BLACK;function lY(e){e=Object(w.a)(e,w.a.EMPTY_OBJECT),this._definitionChanged=new $o.a,this._orientation=void 0,this._orientationSubscription=void 0,this._evenColor=void 0,this._evenColorSubscription=void 0,this._oddColor=void 0,this._oddColorSubscription=void 0,this._offset=void 0,this._offsetSubscription=void 0,this._repeat=void 0,this._repeatSubscription=void 0,this.orientation=e.orientation,this.evenColor=e.evenColor,this.oddColor=e.oddColor,this.offset=e.offset,this.repeat=e.repeat}Object(O.a)(lY.prototype,{isConstant:{get:function(){return aD.isConstant(this._orientation)&&aD.isConstant(this._evenColor)&&aD.isConstant(this._oddColor)&&aD.isConstant(this._offset)&&aD.isConstant(this._repeat)}},definitionChanged:{get:function(){return this._definitionChanged}},orientation:KI("orientation"),evenColor:KI("evenColor"),oddColor:KI("oddColor"),offset:KI("offset"),repeat:KI("repeat")}),lY.prototype.getType=function(e){return"Stripe"},lY.prototype.getValue=function(e,t){return Object(u.a)(t)||(t={}),t.horizontal=aD.getValueOrDefault(this._orientation,e,oY)===aY.HORIZONTAL,t.evenColor=aD.getValueOrClonedDefault(this._evenColor,e,sY,t.evenColor),t.oddColor=aD.getValueOrClonedDefault(this._oddColor,e,cY,t.oddColor),t.offset=aD.getValueOrDefault(this._offset,e,0),t.repeat=aD.getValueOrDefault(this._repeat,e,1),t},lY.prototype.equals=function(e){return this===e||e instanceof lY&&aD.equals(this._orientation,e._orientation)&&aD.equals(this._evenColor,e._evenColor)&&aD.equals(this._oddColor,e._oddColor)&&aD.equals(this._offset,e._offset)&&aD.equals(this._repeat,e._repeat)};var uY=lY;function hY(e){this._definitionChanged=new $o.a,this._intervals=new eI,this._intervals.changedEvent.addEventListener(hY.prototype._intervalsChanged,this),this._referenceFrame=Object(w.a)(e,mS.FIXED)}Object(O.a)(hY.prototype,{isConstant:{get:function(){return this._intervals.isEmpty}},definitionChanged:{get:function(){return this._definitionChanged}},intervals:{get:function(){return this._intervals}},referenceFrame:{get:function(){return this._referenceFrame}}}),hY.prototype.getValue=function(e,t){return this.getValueInReferenceFrame(e,mS.FIXED,t)},hY.prototype.getValueInReferenceFrame=function(e,t,i){if(!Object(u.a)(e))throw new h.a("time is required.");if(!Object(u.a)(t))throw new h.a("referenceFrame is required.");var n=this._intervals.findDataForIntervalContainingDate(e);if(Object(u.a)(n))return WB.convertToReferenceFrame(e,n,this._referenceFrame,t,i)},hY.prototype.equals=function(e){return this===e||e instanceof hY&&this._intervals.equals(e._intervals,aD.equals)&&this._referenceFrame===e._referenceFrame},hY.prototype._intervalsChanged=function(){this._definitionChanged.raiseEvent(this)};var dY=hY;function fY(){this._definitionChanged=new $o.a,this._intervals=new eI,this._intervals.changedEvent.addEventListener(fY.prototype._intervalsChanged,this)}Object(O.a)(fY.prototype,{isConstant:{get:function(){return this._intervals.isEmpty}},definitionChanged:{get:function(){return this._definitionChanged}},intervals:{get:function(){return this._intervals}}}),fY.prototype.getValue=function(e,t){if(!Object(u.a)(e))throw new h.a("time is required");var i=this._intervals.findDataForIntervalContainingDate(e);return Object(u.a)(i)&&"function"==typeof i.clone?i.clone(t):i},fY.prototype.equals=function(e){return this===e||e instanceof fY&&this._intervals.equals(e._intervals,aD.equals)},fY.prototype._intervalsChanged=function(){this._definitionChanged.raiseEvent(this)};var pY=fY;function mY(e,t){this._position=void 0,this._subscription=void 0,this._definitionChanged=new $o.a,this._normalize=Object(w.a)(t,!0),this.position=e}Object(O.a)(mY.prototype,{isConstant:{get:function(){return aD.isConstant(this._position)}},definitionChanged:{get:function(){return this._definitionChanged}},position:{get:function(){return this._position},set:function(e){var t=this._position;t!==e&&(Object(u.a)(t)&&this._subscription(),this._position=e,Object(u.a)(e)&&(this._subscription=e._definitionChanged.addEventListener((function(){this._definitionChanged.raiseEvent(this)}),this)),this._definitionChanged.raiseEvent(this))}},normalize:{get:function(){return this._normalize},set:function(e){this._normalize!==e&&(this._normalize=e,this._definitionChanged.raiseEvent(this))}}});var _Y=new z,gY=new z,vY=new Tr;mY.prototype.getValue=function(e,t){return this._getValue(e,t)},mY.prototype._getValue=function(e,t,i){if(!Object(u.a)(e))throw new h.a("time is required");Object(u.a)(t)||(t=new z);var n=this._position;if(aD.isConstant(n))return this._normalize?void 0:z.clone(z.ZERO,t);var r=n.getValue(e,_Y),a=n.getValue(Tr.addSeconds(e,1/60,vY),gY);if(Object(u.a)(r)&&(Object(u.a)(a)||(a=r,r=n.getValue(Tr.addSeconds(e,-1/60,vY),gY),Object(u.a)(r)))){if(z.equals(r,a))return this._normalize?void 0:z.clone(z.ZERO,t);Object(u.a)(i)&&r.clone(i);var o=z.subtract(a,r,t);return this._normalize?z.normalize(o,t):z.divideByScalar(o,1/60,t)}},mY.prototype.equals=function(e){return this===e||e instanceof mY&&aD.equals(this._position,e._position)};var bY=mY;function yY(e,t){this._velocityVectorProperty=new bY(e,!0),this._subscription=void 0,this._ellipsoid=void 0,this._definitionChanged=new $o.a,this.ellipsoid=Object(w.a)(t,ae.WGS84);var i=this;this._velocityVectorProperty.definitionChanged.addEventListener((function(){i._definitionChanged.raiseEvent(i)}))}Object(O.a)(yY.prototype,{isConstant:{get:function(){return aD.isConstant(this._velocityVectorProperty)}},definitionChanged:{get:function(){return this._definitionChanged}},position:{get:function(){return this._velocityVectorProperty.position},set:function(e){this._velocityVectorProperty.position=e}},ellipsoid:{get:function(){return this._ellipsoid},set:function(e){this._ellipsoid!==e&&(this._ellipsoid=e,this._definitionChanged.raiseEvent(this))}}});var wY=new z,OY=new z,xY=new be;yY.prototype.getValue=function(e,t){var i=this._velocityVectorProperty._getValue(e,OY,wY);if(Object(u.a)(i))return xa.rotationMatrixFromPositionVelocity(wY,i,this._ellipsoid,xY),Kn.fromRotationMatrix(xY,t)},yY.prototype.equals=function(e){return this===e||e instanceof yY&&aD.equals(this._velocityVectorProperty,e._velocityVectorProperty)&&(this._ellipsoid===e._ellipsoid||this._ellipsoid.equals(e._ellipsoid))};var EY=yY,TY=uf.WHITE;function CY(e){e=Object(w.a)(e,w.a.EMPTY_OBJECT),this._definitionChanged=new $o.a,this._color=void 0,this._speed=void 0,this._colorSubscription=void 0,this.color=e.color,this.speed=e.speed}Object(O.a)(CY.prototype,{isConstant:{get:function(){return aD.isConstant(this._color)}},definitionChanged:{get:function(){return this._definitionChanged}},color:KI("color"),speed:KI("speed")}),CY.prototype.getType=function(e){return"Radar"},CY.prototype.getValue=function(e,t){return Object(u.a)(t)||(t={}),t.color=aD.getValueOrClonedDefault(this._color,e,TY,t.color),t.speed=aD.getValueOrClonedDefault(this._speed,e,.05,t.speed),t},CY.prototype.equals=function(e){return this===e||e instanceof CY&&aD.equals(this._color,e._color)&&aD.equals(this._speed,e._speed)};var SY,AY=CY;function PY(){}function IY(e,t){return"#"===t[0]&&(t=SY+t),YW.fromString(e,t)}function DY(e,t,i){if(Object(u.a)(i.reference))return IY(t,i.reference);if(Object(u.a)(i.velocityReference)){var n=IY(t,i.velocityReference);switch(e){case z:case PY:return new bY(n,e===PY);case Kn:return new EY(n)}}throw new Ce.a(JSON.stringify(i)+" is not valid CZML.")}PY.packedLength=z.packedLength,PY.unpack=z.unpack,PY.pack=z.pack;var jY=new z,MY=new kP,RY=new K,LY=new ex,NY=new Kn;function FY(e,t){var i=Object(w.a)(e.uri,e);return Object(u.a)(t)?t.getDerivedResource({url:i}):f.a.createIfNeeded(i)}function kY(e){var t=e.cartesian;if(Object(u.a)(t))return t;var i=e.cartesianVelocity;if(Object(u.a)(i))return i;var n=e.unitCartesian;if(Object(u.a)(n))return n;var r=e.unitSpherical;if(Object(u.a)(r))return function(e){var t=e.length;if(MY.magnitude=1,2===t)return MY.clock=e[0],MY.cone=e[1],z.fromSpherical(MY,jY),[jY.x,jY.y,jY.z];for(var i=new Array(t/3*4),n=0,r=0;n<t;n+=3,r+=4)i[r]=e[n],MY.clock=e[n+1],MY.cone=e[n+2],z.fromSpherical(MY,jY),i[r+1]=jY.x,i[r+2]=jY.y,i[r+3]=jY.z;return i}(r);var a=e.spherical;if(Object(u.a)(a))return function(e){var t=e.length;if(3===t)return MY.clock=e[0],MY.cone=e[1],MY.magnitude=e[2],z.fromSpherical(MY,jY),[jY.x,jY.y,jY.z];for(var i=new Array(t),n=0;n<t;n+=4)i[n]=e[n],MY.clock=e[n+1],MY.cone=e[n+2],MY.magnitude=e[n+3],z.fromSpherical(MY,jY),i[n+1]=jY.x,i[n+2]=jY.y,i[n+3]=jY.z;return i}(a);var o=e.cartographicRadians;if(Object(u.a)(o))return function(e){var t=e.length;if(3===t)return RY.longitude=e[0],RY.latitude=e[1],RY.height=e[2],fx.ellipsoidType.cartographicToCartesian(RY,jY),[jY.x,jY.y,jY.z];for(var i=new Array(t),n=0;n<t;n+=4)i[n]=e[n],RY.longitude=e[n+1],RY.latitude=e[n+2],RY.height=e[n+3],fx.ellipsoidType.cartographicToCartesian(RY,jY),i[n+1]=jY.x,i[n+2]=jY.y,i[n+3]=jY.z;return i}(o);var s=e.cartographicDegrees;if(Object(u.a)(s))return function(e){var t=e.length;if(3===t)return RY.longitude=I.toRadians(e[0]),RY.latitude=I.toRadians(e[1]),RY.height=e[2],fx.ellipsoidType.cartographicToCartesian(RY,jY),[jY.x,jY.y,jY.z];for(var i=new Array(t),n=0;n<t;n+=4)i[n]=e[n],RY.longitude=I.toRadians(e[n+1]),RY.latitude=I.toRadians(e[n+2]),RY.height=e[n+3],fx.ellipsoidType.cartographicToCartesian(RY,jY),i[n+1]=jY.x,i[n+2]=jY.y,i[n+3]=jY.z;return i}(s);throw new Ce.a(JSON.stringify(e)+" is not a valid CZML interval.")}function BY(e,t){z.unpack(e,t,jY),z.normalize(jY,jY),z.pack(jY,e,t)}function zY(e,t){Kn.unpack(e,t,NY),Kn.normalize(NY,NY),Kn.pack(NY,e,t)}function UY(e){return"boolean"==typeof e?Boolean:"number"==typeof e?Number:"string"==typeof e?String:e.hasOwnProperty("array")?Array:e.hasOwnProperty("boolean")?Boolean:e.hasOwnProperty("boundingRectangle")?ln:e.hasOwnProperty("cartesian2")?Rt:e.hasOwnProperty("cartesian")||e.hasOwnProperty("spherical")||e.hasOwnProperty("cartographicRadians")||e.hasOwnProperty("cartographicDegrees")?z:e.hasOwnProperty("unitCartesian")||e.hasOwnProperty("unitSpherical")?PY:e.hasOwnProperty("rgba")||e.hasOwnProperty("rgbaf")?uf:e.hasOwnProperty("colorBlendMode")?sW:e.hasOwnProperty("cornerType")?fm:e.hasOwnProperty("heightReference")?eD:e.hasOwnProperty("horizontalOrigin")?tD:e.hasOwnProperty("date")?Tr:e.hasOwnProperty("labelStyle")?rG:e.hasOwnProperty("number")?Number:e.hasOwnProperty("nearFarScalar")?Fx:e.hasOwnProperty("distanceDisplayCondition")?gv:e.hasOwnProperty("object")||e.hasOwnProperty("value")?Object:e.hasOwnProperty("unitQuaternion")?Kn:e.hasOwnProperty("shadowMode")?rM:e.hasOwnProperty("string")?String:e.hasOwnProperty("stripeOrientation")?aY:e.hasOwnProperty("wsen")||e.hasOwnProperty("wsenDegrees")?Ve:e.hasOwnProperty("uri")?Co.a:e.hasOwnProperty("verticalOrigin")?iD:Object}function VY(e,t,i){switch(e){case Array:return t.array;case Boolean:return Object(w.a)(t.boolean,t);case ln:return t.boundingRectangle;case Rt:return t.cartesian2;case z:return kY(t);case PY:return function(e){var t=kY(e);if(3===t.length)return BY(t,0),t;for(var i=1;i<t.length;i+=4)BY(t,i);return t}(t);case uf:return function(e){var t=e.rgbaf;if(Object(u.a)(t))return t;var i=e.rgba;if(Object(u.a)(i)){var n=i.length;if(n===uf.packedLength)return[uf.byteToFloat(i[0]),uf.byteToFloat(i[1]),uf.byteToFloat(i[2]),uf.byteToFloat(i[3])];t=new Array(n);for(var r=0;r<n;r+=5)t[r]=i[r],t[r+1]=uf.byteToFloat(i[r+1]),t[r+2]=uf.byteToFloat(i[r+2]),t[r+3]=uf.byteToFloat(i[r+3]),t[r+4]=uf.byteToFloat(i[r+4]);return t}}(t);case sW:return sW[Object(w.a)(t.colorBlendMode,t)];case fm:return fm[Object(w.a)(t.cornerType,t)];case eD:return eD[Object(w.a)(t.heightReference,t)];case tD:return tD[Object(w.a)(t.horizontalOrigin,t)];case Image:return FY(t,i);case Tr:return Tr.fromIso8601(Object(w.a)(t.date,t));case rG:return rG[Object(w.a)(t.labelStyle,t)];case Number:return Object(w.a)(t.number,t);case Fx:return t.nearFarScalar;case gv:return t.distanceDisplayCondition;case Object:return Object(w.a)(Object(w.a)(t.object,t.value),t);case Kn:return function(e){var t=e.unitQuaternion;if(Object(u.a)(t)){if(4===t.length)return zY(t,0),t;for(var i=1;i<t.length;i+=5)zY(t,i)}return t}(t);case XW:return Object(w.a)(t.number,t);case rM:return rM[Object(w.a)(Object(w.a)(t.shadowMode,t.shadows),t)];case String:return Object(w.a)(t.string,t);case aY:return aY[Object(w.a)(t.stripeOrientation,t)];case Ve:return function(e){var t=e.wsen;if(Object(u.a)(t))return t;var i=e.wsenDegrees;if(Object(u.a)(i)){var n=i.length;if(n===Ve.packedLength)return[I.toRadians(i[0]),I.toRadians(i[1]),I.toRadians(i[2]),I.toRadians(i[3])];t=new Array(n);for(var r=0;r<n;r+=5)t[r]=i[r],t[r+1]=I.toRadians(i[r+1]),t[r+2]=I.toRadians(i[r+2]),t[r+3]=I.toRadians(i[r+3]),t[r+4]=I.toRadians(i[r+4]);return t}}(t);case Co.a:return FY(t,i);case iD:return iD[Object(w.a)(t.verticalOrigin,t)];default:throw new Ce.a(e)}}var HY={HERMITE:PO,LAGRANGE:ox,LINEAR:cx};function GY(e,t){var i=e.interpolationAlgorithm;(Object(u.a)(i)||Object(u.a)(e.interpolationDegree))&&t.setInterpolationOptions({interpolationAlgorithm:HY[i],interpolationDegree:e.interpolationDegree});var n=e.forwardExtrapolationType;Object(u.a)(n)&&(t.forwardExtrapolationType=tb[n]);var r=e.forwardExtrapolationDuration;Object(u.a)(r)&&(t.forwardExtrapolationDuration=r);var a=e.backwardExtrapolationType;Object(u.a)(a)&&(t.backwardExtrapolationType=tb[a]);var o=e.backwardExtrapolationDuration;Object(u.a)(o)&&(t.backwardExtrapolationDuration=o)}var qY={iso8601:void 0};function WY(e,t,i,n,r,a,o){var s,c,l,h,d,f=n.interval;Object(u.a)(f)?(qY.iso8601=f,s=ex.fromIso8601(qY),Object(u.a)(r)&&(s=ex.intersect(s,r,LY))):Object(u.a)(r)&&(s=r);var p=!Object(u.a)(n.reference)&&!Object(u.a)(n.velocityReference),m=Object(u.a)(s)&&!s.equals(nx.MAXIMUM_INTERVAL);p&&(h=VY(e,n,a),c=Object(w.a)(e.packedLength,1),d=Object(w.a)(h.length,1),l=!Object(u.a)(n.array)&&"string"!=typeof h&&d>c&&e!==Object);var _="function"==typeof e.unpack&&e!==XW;if(l||m){var g,v,b=t[i],y=n.epoch;if(Object(u.a)(y)&&(g=Tr.fromIso8601(y)),l&&!m)return b instanceof iY||(b=new iY(e),t[i]=b),b.addSamplesPackedArray(h,g),void GY(n,b);if(!l&&m)return(s=s.clone()).data=p?_?e.unpack(h,0):h:DY(e,o,n),Object(u.a)(b)||(b=p?new pY:new RU,t[i]=b),void(p&&b instanceof pY?b.intervals.addInterval(s):b instanceof RU?(p&&(s.data=new ZI(s.data)),b.intervals.addInterval(s)):((v=nx.MAXIMUM_INTERVAL.clone()).data=b,b=new RU,t[i]=b,b.intervals.addInterval(v),p&&(s.data=new ZI(s.data)),b.intervals.addInterval(s)));Object(u.a)(b)||(b=new RU,t[i]=b),b instanceof RU||((v=nx.MAXIMUM_INTERVAL.clone()).data=b,b=new RU,t[i]=b,b.intervals.addInterval(v));var O=b.intervals;v=O.findInterval(s),Object(u.a)(v)&&v.data instanceof iY||((v=s.clone()).data=new iY(e),O.addInterval(v)),v.data.addSamplesPackedArray(h,g),GY(n,v.data)}else t[i]=p?new ZI(_?e.unpack(h,0):h):DY(e,o,n)}function YY(e,t,i,n,r,a,o){if(Object(u.a)(n))if(Object(ym.a)(n))for(var s=0,c=n.length;s<c;s++)WY(e,t,i,n[s],r,a,o);else WY(e,t,i,n,r,a,o)}function XY(e,t,i,n,r,a){var o,s,c,l=i.interval;Object(u.a)(l)?(qY.iso8601=l,o=ex.fromIso8601(qY),Object(u.a)(n)&&(o=ex.intersect(o,n,LY))):Object(u.a)(n)&&(o=n);var h=!1,d=Object(u.a)(i.cartesianVelocity)?1:0,f=z.packedLength*(d+1),p=!Object(u.a)(i.reference),m=Object(u.a)(o)&&!o.equals(nx.MAXIMUM_INTERVAL);if(p&&(Object(u.a)(i.referenceFrame)&&(s=mS[i.referenceFrame]),s=Object(w.a)(s,mS.FIXED),c=kY(i),h=Object(w.a)(c.length,1)>f),h||m){var _,g,v=e[t],b=i.epoch;if(Object(u.a)(b)&&(_=Tr.fromIso8601(b)),h&&!m)return v instanceof rY&&(!Object(u.a)(s)||v.referenceFrame===s)||(v=new rY(s,d),e[t]=v),v.addSamplesPackedArray(c,_),void GY(i,v);if(!h&&m)return(o=o.clone()).data=p?z.unpack(c):IY(a,i.reference),Object(u.a)(v)||(v=p?new dY(s):new kU(s),e[t]=v),void(p&&v instanceof dY&&Object(u.a)(s)&&v.referenceFrame===s?v.intervals.addInterval(o):v instanceof kU?(p&&(o.data=new XB(o.data,s)),v.intervals.addInterval(o)):((g=nx.MAXIMUM_INTERVAL.clone()).data=v,v=new kU(v.referenceFrame),e[t]=v,v.intervals.addInterval(g),p&&(o.data=new XB(o.data,s)),v.intervals.addInterval(o)));Object(u.a)(v)?v instanceof kU||((g=nx.MAXIMUM_INTERVAL.clone()).data=v,v=new kU(v.referenceFrame),e[t]=v,v.intervals.addInterval(g)):(v=new kU(s),e[t]=v);var y=v.intervals;g=y.findInterval(o),Object(u.a)(g)&&g.data instanceof rY&&(!Object(u.a)(s)||g.data.referenceFrame===s)||((g=o.clone()).data=new rY(s,d),y.addInterval(g)),g.data.addSamplesPackedArray(c,_),GY(i,g.data)}else e[t]=p?new XB(z.unpack(c),s):IY(a,i.reference)}function ZY(e,t,i,n,r,a){if(Object(u.a)(i))if(Object(ym.a)(i))for(var o=0,s=i.length;o<s;o++)XY(e,t,i[o],n,0,a);else XY(e,t,i,n,0,a)}function QY(e,t,i,n,r,a){var o,s=i.interval;Object(u.a)(s)?(qY.iso8601=s,o=ex.fromIso8601(qY),Object(u.a)(n)&&(o=ex.intersect(o,n,LY))):Object(u.a)(n)&&(o=n);var c,l,h,d=e[t];if(Object(u.a)(o)){d instanceof NU||(d=new NU,e[t]=d);var f=d.intervals;l=f.findInterval({start:o.start,stop:o.stop}),Object(u.a)(l)?c=l.data:(l=o.clone(),f.addInterval(l))}else c=d;Object(u.a)(i.solidColor)?(c instanceof oM||(c=new oM),h=i.solidColor,YY(uf,c,"color",h.color,void 0,void 0,a)):Object(u.a)(i.grid)?(c instanceof mW||(c=new mW),h=i.grid,YY(uf,c,"color",h.color,void 0,r,a),YY(Number,c,"cellAlpha",h.cellAlpha,void 0,r,a),YY(Rt,c,"lineCount",h.lineCount,void 0,r,a),YY(Rt,c,"lineThickness",h.lineThickness,void 0,r,a),YY(Rt,c,"lineOffset",h.lineOffset,void 0,r,a)):Object(u.a)(i.image)?(c instanceof BB||(c=new BB),h=i.image,YY(Image,c,"image",h.image,void 0,r,a),YY(Rt,c,"repeat",h.repeat,void 0,r,a),YY(uf,c,"color",h.color,void 0,r,a),YY(Boolean,c,"transparent",h.transparent,void 0,r,a)):Object(u.a)(i.stripe)?(c instanceof uY||(c=new uY),h=i.stripe,YY(aY,c,"orientation",h.orientation,void 0,r,a),YY(uf,c,"evenColor",h.evenColor,void 0,r,a),YY(uf,c,"oddColor",h.oddColor,void 0,r,a),YY(Number,c,"offset",h.offset,void 0,r,a),YY(Number,c,"repeat",h.repeat,void 0,r,a)):Object(u.a)(i.polylineOutline)?(c instanceof AW||(c=new AW),h=i.polylineOutline,YY(uf,c,"color",h.color,void 0,r,a),YY(uf,c,"outlineColor",h.outlineColor,void 0,r,a),YY(Number,c,"outlineWidth",h.outlineWidth,void 0,r,a)):Object(u.a)(i.polylineDynamic)?(c instanceof jW||(c=new jW),h=i.polylineDynamic,YY(uf,c,"evenColor",h.evenColor,void 0,r,a),YY(uf,c,"oddColor",h.oddColor,void 0,r,a)):Object(u.a)(i.polylineGlow)?(c instanceof EW||(c=new EW),h=i.polylineGlow,YY(uf,c,"color",h.color,void 0,r,a),YY(Number,c,"glowPower",h.glowPower,void 0,r,a)):Object(u.a)(i.polylineArrow)?(c instanceof gW||(c=new gW),h=i.polylineArrow,YY(uf,c,"color",h.color,void 0,void 0,a)):Object(u.a)(i.polylineDash)?(c instanceof wW||(c=new wW),h=i.polylineDash,YY(uf,c,"color",h.color,void 0,void 0,a),YY(uf,c,"gapColor",h.gapColor,void 0,void 0,a),YY(Number,c,"dashLength",h.dashLength,void 0,r,a),YY(Number,c,"dashPattern",h.dashPattern,void 0,r,a)):Object(u.a)(i.polylineDashDynamic)?(c instanceof FW||(c=new FW),h=i.polylineDashDynamic,YY(uf,c,"color",h.color,void 0,void 0,a),YY(uf,c,"oddColor",h.oddColor,void 0,void 0,a),YY(uf,c,"gapColor",h.gapColor,void 0,void 0,a),YY(Number,c,"dashLength",h.dashLength,void 0,r,a),YY(Number,c,"dashPattern",h.dashPattern,void 0,r,a),YY(Boolean,c,"animat",h.animat,void 0,r,a),YY(Boolean,c,"gradual",h.gradual,void 0,r,a)):Object(u.a)(i.diffusionRing)?(c instanceof zW||(c=new zW),h=i.diffusionRing,YY(uf,c,"color",h.color,void 0,void 0,a)):Object(u.a)(i.radar)&&(c instanceof AY||(c=new AY),h=i.radar,YY(uf,c,"color",h.color,void 0,void 0,a),YY(Number,c,"speed",h.speed,void 0,void 0,a)),Object(u.a)(l)?l.data=c:e[t]=c}function KY(e,t,i,n,r,a){if(Object(u.a)(i))if(Object(ym.a)(i))for(var o=0,s=i.length;o<s;o++)QY(e,t,i[o],n,r,a);else QY(e,t,i,n,r,a)}function JY(e,t,i,n){var r=i.references;if(Object(u.a)(r)){var a=r.map((function(e){return IY(n,e)})),o=i.interval;if(Object(u.a)(o)){if(o=ex.fromIso8601(o),!(e[t]instanceof kU)){o.data=new GW(a);var s=new RU;s.intervals.addInterval(o),e[t]=s}}else e[t]=new GW(a)}else YY(Array,e,t,i,void 0,void 0,n)}function $Y(e,t,i,n){if(Object(u.a)(i))if(Object(ym.a)(i))for(var r=0,a=i.length;r<a;++r)JY(e,t,i[r],n);else JY(e,t,i,n)}function eX(e,t,i,n){if(Object(u.a)(i.references)){var r=i.references.map((function(e){return IY(n,e)})),a=i.interval;if(Object(u.a)(a)){if(a=ex.fromIso8601(a),!(e[t]instanceof kU)){a.data=new VW(r);var o=new kU;o.intervals.addInterval(a),e[t]=o}}else e[t]=new VW(r)}else Object(u.a)(i.cartesian)?i.array=z.unpackArray(i.cartesian):Object(u.a)(i.cartographicRadians)?i.array=z.fromRadiansArrayHeights(i.cartographicRadians):Object(u.a)(i.cartographicDegrees)&&(i.array=z.fromDegreesArrayHeights(i.cartographicDegrees)),Object(u.a)(i.array)&&YY(Array,e,t,i,void 0,void 0,n)}function tX(e,t,i,n){if(Object(u.a)(i))if(Object(ym.a)(i))for(var r=0,a=i.length;r<a;r++)eX(e,t,i[r],n);else eX(e,t,i,n)}function iX(e,t,i,n,r){var a,o=t.interval;Object(u.a)(o)?(qY.iso8601=o,a=ex.fromIso8601(qY),Object(u.a)(i)&&(a=ex.intersect(a,i,LY))):Object(u.a)(i)&&(a=i);for(var s=e.nodeTransformations,c=Object.keys(t),l=0,h=c.length;l<h;++l){var d=c[l];if("interval"!==d){var f=t[d];if(Object(u.a)(f)){Object(u.a)(s)||(e.nodeTransformations=s=new dz),s.hasProperty(d)||s.addProperty(d);var p=s[d];Object(u.a)(p)||(s[d]=p=new lz),YY(z,p,"translation",f.translation,a,n,r),YY(Kn,p,"rotation",f.rotation,a,n,r),YY(z,p,"scale",f.scale,a,n,r)}}}}function nX(e,t,i,n,r){var a=e.id;if(Object(u.a)(a)||(a=Mg()),SY=a,!Object(u.a)(r._version)&&"document"!==a)throw new Ce.a("The first CZML packet is required to be the document object.");if(!0===e.delete)t.removeById(a);else if("document"===a)!function(e,t){var i=e.version;if(Object(u.a)(i)&&"string"==typeof i){var n=i.split(".");if(2===n.length){if("1"!==n[0])throw new Ce.a("Cesium only supports CZML version 1.");t._version=i}}if(!Object(u.a)(t._version))throw new Ce.a("CZML version information invalid.  It is expected to be a property on the document object in the <Major>.<Minor> version format.");var r=t._documentPacket;Object(u.a)(e.name)&&(r.name=e.name);var a=e.clock;if(Object(u.a)(a)){var o=r.clock;Object(u.a)(o)?(o.interval=Object(w.a)(a.interval,o.interval),o.currentTime=Object(w.a)(a.currentTime,o.currentTime),o.range=Object(w.a)(a.range,o.range),o.step=Object(w.a)(a.step,o.step),o.multiplier=Object(w.a)(a.multiplier,o.multiplier)):r.clock={interval:a.interval,currentTime:a.currentTime,range:a.range,step:a.step,multiplier:a.multiplier}}}(e,r);else{var o=t.getOrCreateEntity(a),s=e.parent;Object(u.a)(s)&&(o.parent=t.getOrCreateEntity(s));for(var c=i.length-1;c>-1;c--)i[c](o,e,t,n)}SY=void 0}function rX(e,t,i,n){if(!Object(u.a)(t))throw new h.a("czml is required.");var r=t,a=(i=Object(w.a)(i,w.a.EMPTY_OBJECT)).sourceUri;return("string"==typeof t||t instanceof f.a)&&(r=(t=f.a.createIfNeeded(t)).fetchJson(),a=Object(w.a)(a,t.clone())),a=f.a.createIfNeeded(a),KU.setLoading(e,!0),Object(Oi.a)(r,(function(t){return function(e,t,i,n){KU.setLoading(e,!0);var r=e._entityCollection;n&&(e._version=void 0,e._documentPacket=new aX,r.removeAll());oX._processCzml(t,r,i,void 0,e);var a=function(e){var t,i=e._documentPacket.clock;if(!Object(u.a)(i)){if(!Object(u.a)(e._clock)){var n=e._entityCollection.computeAvailability();if(!n.start.equals(nx.MINIMUM_VALUE)){var r=n.start,a=n.stop,o=Tr.secondsDifference(a,r),s=Math.round(o/120);return(t=new lW).startTime=Tr.clone(r),t.stopTime=Tr.clone(a),t.clockRange=Xd.LOOP_STOP,t.multiplier=s,t.currentTime=Tr.clone(r),t.clockStep=Zd.SYSTEM_CLOCK_MULTIPLIER,e._clock=t,!0}}return!1}if(Object(u.a)(e._clock)?t=e._clock.clone():((t=new lW).startTime=nx.MINIMUM_VALUE.clone(),t.stopTime=nx.MAXIMUM_VALUE.clone(),t.currentTime=nx.MINIMUM_VALUE.clone(),t.clockRange=Xd.LOOP_STOP,t.clockStep=Zd.SYSTEM_CLOCK_MULTIPLIER,t.multiplier=1),Object(u.a)(i.interval)){qY.iso8601=i.interval;var c=ex.fromIso8601(qY);t.startTime=c.start,t.stopTime=c.stop}return Object(u.a)(i.currentTime)&&(t.currentTime=Tr.fromIso8601(i.currentTime)),Object(u.a)(i.range)&&(t.clockRange=Object(w.a)(Xd[i.range],Xd.LOOP_STOP)),Object(u.a)(i.step)&&(t.clockStep=Object(w.a)(Zd[i.step],Zd.SYSTEM_CLOCK_MULTIPLIER)),Object(u.a)(i.multiplier)&&(t.multiplier=i.multiplier),!t.equals(e._clock)&&(e._clock=t.clone(e._clock),!0)}(e),o=e._documentPacket;Object(u.a)(o.name)&&e._name!==o.name?(e._name=o.name,a=!0):!Object(u.a)(e._name)&&Object(u.a)(i)&&(e._name=ay(i.getUrlComponent()),a=!0);KU.setLoading(e,!1),a&&e._changed.raiseEvent(e);return e}(e,t,a,n)})).otherwise((function(t){return KU.setLoading(e,!1),e._error.raiseEvent(e,t),console.log(t),Oi.a.reject(t)}))}function aX(){this.name=void 0,this.clock=void 0}function oX(e){this._name=e,this._changed=new $o.a,this._error=new $o.a,this._isLoading=!1,this._loading=new $o.a,this._clock=void 0,this._documentPacket=new aX,this._version=void 0,this._entityCollection=new OU(this),this._entityCluster=new Zq}oX.load=function(e,t){return(new oX).load(e,t)},Object(O.a)(oX.prototype,{name:{get:function(){return this._name}},clock:{get:function(){return this._clock}},entities:{get:function(){return this._entityCollection}},isLoading:{get:function(){return this._isLoading}},changedEvent:{get:function(){return this._changed}},errorEvent:{get:function(){return this._error}},loadingEvent:{get:function(){return this._loading}},show:{get:function(){return this._entityCollection.show},set:function(e){this._entityCollection.show=e}},clustering:{get:function(){return this._entityCluster},set:function(e){if(!Object(u.a)(e))throw new h.a("value must be defined.");this._entityCluster=e}}}),oX.updaters=[function(e,t,i,n){var r=t.billboard;if(Object(u.a)(r)){var a,o=r.interval;Object(u.a)(o)&&(qY.iso8601=o,a=ex.fromIso8601(qY));var s=e.billboard;Object(u.a)(s)||(e.billboard=s=new $I),YY(Boolean,s,"show",r.show,a,n,i),YY(Image,s,"image",r.image,a,n,i),YY(Number,s,"scale",r.scale,a,n,i),YY(Rt,s,"pixelOffset",r.pixelOffset,a,n,i),YY(z,s,"eyeOffset",r.eyeOffset,a,n,i),YY(tD,s,"horizontalOrigin",r.horizontalOrigin,a,n,i),YY(iD,s,"verticalOrigin",r.verticalOrigin,a,n,i),YY(eD,s,"heightReference",r.heightReference,a,n,i),YY(uf,s,"color",r.color,a,n,i),YY(XW,s,"rotation",r.rotation,a,n,i),function(e,t,i,n,r){Object(u.a)(t)&&YY(PY,e,"alignedAxis",t,i,n,r)}(s,r.alignedAxis,a,n,i),YY(Boolean,s,"sizeInMeters",r.sizeInMeters,a,n,i),YY(Number,s,"width",r.width,a,n,i),YY(Number,s,"height",r.height,a,n,i),YY(Fx,s,"scaleByDistance",r.scaleByDistance,a,n,i),YY(Fx,s,"translucencyByDistance",r.translucencyByDistance,a,n,i),YY(Fx,s,"pixelOffsetScaleByDistance",r.pixelOffsetScaleByDistance,a,n,i),YY(ln,s,"imageSubRegion",r.imageSubRegion,a,n,i),YY(gv,s,"distanceDisplayCondition",r.distanceDisplayCondition,a,n,i),YY(Number,s,"disableDepthTestDistance",r.disableDepthTestDistance,a,n,i)}},function(e,t,i,n){var r=t.box;if(Object(u.a)(r)){var a,o=r.interval;Object(u.a)(o)&&(qY.iso8601=o,a=ex.fromIso8601(qY));var s=e.box;Object(u.a)(s)||(e.box=s=new HB),YY(Boolean,s,"show",r.show,a,n,i),YY(z,s,"dimensions",r.dimensions,a,n,i),YY(Boolean,s,"fill",r.fill,a,n,i),KY(s,"material",r.material,a,n,i),YY(Boolean,s,"outline",r.outline,a,n,i),YY(uf,s,"outlineColor",r.outlineColor,a,n,i),YY(Number,s,"outlineWidth",r.outlineWidth,a,n,i),YY(rM,s,"shadows",r.shadows,a,n,i),YY(gv,s,"distanceDisplayCondition",r.distanceDisplayCondition,a,n,i)}},function(e,t,i,n){var r=t.corridor;if(Object(u.a)(r)){var a,o=r.interval;Object(u.a)(o)&&(qY.iso8601=o,a=ex.fromIso8601(qY));var s=e.corridor;Object(u.a)(s)||(e.corridor=s=new QB),YY(Boolean,s,"show",r.show,a,n,i),tX(s,"positions",r.positions,i),YY(Number,s,"width",r.width,a,n,i),YY(Number,s,"height",r.height,a,n,i),YY(Number,s,"extrudedHeight",r.extrudedHeight,a,n,i),YY(fm,s,"cornerType",r.cornerType,a,n,i),YY(Number,s,"granularity",r.granularity,a,n,i),YY(Boolean,s,"fill",r.fill,a,n,i),KY(s,"material",r.material,a,n,i),YY(Boolean,s,"outline",r.outline,a,n,i),YY(uf,s,"outlineColor",r.outlineColor,a,n,i),YY(Number,s,"outlineWidth",r.outlineWidth,a,n,i),YY(rM,s,"shadows",r.shadows,a,n,i),YY(gv,s,"distanceDisplayCondition",r.distanceDisplayCondition,a,n,i),YY(Number,s,"zIndex",r.zIndex,a,n,i)}},function(e,t,i,n){var r=t.cylinder;if(Object(u.a)(r)){var a,o=r.interval;Object(u.a)(o)&&(qY.iso8601=o,a=ex.fromIso8601(qY));var s=e.cylinder;Object(u.a)(s)||(e.cylinder=s=new ez),YY(Boolean,s,"show",r.show,a,n,i),YY(Number,s,"length",r.length,a,n,i),YY(Number,s,"topRadius",r.topRadius,a,n,i),YY(Number,s,"bottomRadius",r.bottomRadius,a,n,i),YY(Boolean,s,"fill",r.fill,a,n,i),KY(s,"material",r.material,a,n,i),YY(Boolean,s,"outline",r.outline,a,n,i),YY(uf,s,"outlineColor",r.outlineColor,a,n,i),YY(Number,s,"outlineWidth",r.outlineWidth,a,n,i),YY(Number,s,"numberOfVerticalLines",r.numberOfVerticalLines,a,n,i),YY(Number,s,"slices",r.slices,a,n,i),YY(rM,s,"shadows",r.shadows,a,n,i),YY(gv,s,"distanceDisplayCondition",r.distanceDisplayCondition,a,n,i)}},function(e,t,i,n){var r=t.ellipse;if(Object(u.a)(r)){var a,o=r.interval;Object(u.a)(o)&&(qY.iso8601=o,a=ex.fromIso8601(qY));var s=e.ellipse;Object(u.a)(s)||(e.ellipse=s=new iz),YY(Boolean,s,"show",r.show,a,n,i),YY(Number,s,"semiMajorAxis",r.semiMajorAxis,a,n,i),YY(Number,s,"semiMinorAxis",r.semiMinorAxis,a,n,i),YY(Number,s,"height",r.height,a,n,i),YY(Number,s,"extrudedHeight",r.extrudedHeight,a,n,i),YY(XW,s,"rotation",r.rotation,a,n,i),YY(XW,s,"stRotation",r.stRotation,a,n,i),YY(Number,s,"granularity",r.granularity,a,n,i),YY(Boolean,s,"fill",r.fill,a,n,i),KY(s,"material",r.material,a,n,i),YY(Boolean,s,"outline",r.outline,a,n,i),YY(uf,s,"outlineColor",r.outlineColor,a,n,i),YY(Number,s,"outlineWidth",r.outlineWidth,a,n,i),YY(Number,s,"numberOfVerticalLines",r.numberOfVerticalLines,a,n,i),YY(rM,s,"shadows",r.shadows,a,n,i),YY(gv,s,"distanceDisplayCondition",r.distanceDisplayCondition,a,n,i),YY(Number,s,"zIndex",r.zIndex,a,n,i)}},function(e,t,i,n){var r=t.ellipsoid;if(Object(u.a)(r)){var a,o=r.interval;Object(u.a)(o)&&(qY.iso8601=o,a=ex.fromIso8601(qY));var s=e.ellipsoid;Object(u.a)(s)||(e.ellipsoid=s=new rz),YY(Boolean,s,"show",r.show,a,n,i),YY(z,s,"radii",r.radii,a,n,i),YY(Boolean,s,"fill",r.fill,a,n,i),KY(s,"material",r.material,a,n,i),YY(Boolean,s,"outline",r.outline,a,n,i),YY(uf,s,"outlineColor",r.outlineColor,a,n,i),YY(Number,s,"outlineWidth",r.outlineWidth,a,n,i),YY(Number,s,"stackPartitions",r.stackPartitions,a,n,i),YY(Number,s,"slicePartitions",r.slicePartitions,a,n,i),YY(Number,s,"subdivisions",r.subdivisions,a,n,i),YY(rM,s,"shadows",r.shadows,a,n,i),YY(gv,s,"distanceDisplayCondition",r.distanceDisplayCondition,a,n,i)}},function(e,t,i,n){var r=t.label;if(Object(u.a)(r)){var a,o=r.interval;Object(u.a)(o)&&(qY.iso8601=o,a=ex.fromIso8601(qY));var s=e.label;Object(u.a)(s)||(e.label=s=new oz),YY(Boolean,s,"show",r.show,a,n,i),YY(String,s,"text",r.text,a,n,i),YY(String,s,"font",r.font,a,n,i),YY(rG,s,"style",r.style,a,n,i),YY(Number,s,"scale",r.scale,a,n,i),YY(Boolean,s,"showBackground",r.showBackground,a,n,i),YY(uf,s,"backgroundColor",r.backgroundColor,a,n,i),YY(Rt,s,"backgroundPadding",r.backgroundPadding,a,n,i),YY(Rt,s,"pixelOffset",r.pixelOffset,a,n,i),YY(z,s,"eyeOffset",r.eyeOffset,a,n,i),YY(tD,s,"horizontalOrigin",r.horizontalOrigin,a,n,i),YY(iD,s,"verticalOrigin",r.verticalOrigin,a,n,i),YY(eD,s,"heightReference",r.heightReference,a,n,i),YY(uf,s,"fillColor",r.fillColor,a,n,i),YY(uf,s,"outlineColor",r.outlineColor,a,n,i),YY(Number,s,"outlineWidth",r.outlineWidth,a,n,i),YY(Fx,s,"translucencyByDistance",r.translucencyByDistance,a,n,i),YY(Fx,s,"pixelOffsetScaleByDistance",r.pixelOffsetScaleByDistance,a,n,i),YY(Fx,s,"scaleByDistance",r.scaleByDistance,a,n,i),YY(gv,s,"distanceDisplayCondition",r.distanceDisplayCondition,a,n,i),YY(Number,s,"disableDepthTestDistance",r.disableDepthTestDistance,a,n,i)}},function(e,t,i,n){var r=t.model;if(Object(u.a)(r)){var a,o=r.interval;Object(u.a)(o)&&(qY.iso8601=o,a=ex.fromIso8601(qY));var s=e.model;Object(u.a)(s)||(e.model=s=new mz),YY(Boolean,s,"show",r.show,a,n,i),YY(Co.a,s,"uri",r.gltf,a,n,i),YY(Number,s,"scale",r.scale,a,n,i),YY(Number,s,"minimumPixelSize",r.minimumPixelSize,a,n,i),YY(Number,s,"maximumScale",r.maximumScale,a,n,i),YY(Boolean,s,"incrementallyLoadTextures",r.incrementallyLoadTextures,a,n,i),YY(Boolean,s,"runAnimations",r.runAnimations,a,n,i),YY(Boolean,s,"clampAnimations",r.clampAnimations,a,n,i),YY(rM,s,"shadows",r.shadows,a,n,i),YY(eD,s,"heightReference",r.heightReference,a,n,i),YY(uf,s,"silhouetteColor",r.silhouetteColor,a,n,i),YY(Number,s,"silhouetteSize",r.silhouetteSize,a,n,i),YY(uf,s,"color",r.color,a,n,i),YY(sW,s,"colorBlendMode",r.colorBlendMode,a,n,i),YY(Number,s,"colorBlendAmount",r.colorBlendAmount,a,n,i),YY(gv,s,"distanceDisplayCondition",r.distanceDisplayCondition,a,n,i);var c=r.nodeTransformations;if(Object(u.a)(c))if(Object(ym.a)(c))for(var l=0,h=c.length;l<h;l++)iX(s,c[l],a,n,i);else iX(s,c,a,n,i)}},function(e,t,i,n){e.name=Object(w.a)(t.name,e.name)},function(e,t,i,n){var r=t.description;Object(u.a)(r)&&YY(String,e,"description",r,void 0,n,i)},function(e,t,i,n){var r=t.path;if(Object(u.a)(r)){var a,o=r.interval;Object(u.a)(o)&&(qY.iso8601=o,a=ex.fromIso8601(qY));var s=e.path;Object(u.a)(s)||(e.path=s=new gz),YY(Boolean,s,"show",r.show,a,n,i),YY(Number,s,"width",r.width,a,n,i),YY(Number,s,"resolution",r.resolution,a,n,i),YY(Number,s,"leadTime",r.leadTime,a,n,i),YY(Number,s,"trailTime",r.trailTime,a,n,i),KY(s,"material",r.material,a,n,i),YY(gv,s,"distanceDisplayCondition",r.distanceDisplayCondition,a,n,i)}},function(e,t,i,n){var r=t.point;if(Object(u.a)(r)){var a,o=r.interval;Object(u.a)(o)&&(qY.iso8601=o,a=ex.fromIso8601(qY));var s=e.point;Object(u.a)(s)||(e.point=s=new wz),YY(Boolean,s,"show",r.show,a,n,i),YY(Boolean,s,"shake",r.shake,a,n,i),YY(Number,s,"pixelSize",r.pixelSize,a,n,i),YY(eD,s,"heightReference",r.heightReference,a,n,i),YY(uf,s,"color",r.color,a,n,i),YY(uf,s,"outlineColor",r.outlineColor,a,n,i),YY(Number,s,"outlineWidth",r.outlineWidth,a,n,i),YY(Fx,s,"scaleByDistance",r.scaleByDistance,a,n,i),YY(Fx,s,"translucencyByDistance",r.translucencyByDistance,a,n,i),YY(gv,s,"distanceDisplayCondition",r.distanceDisplayCondition,a,n,i),YY(Number,s,"disableDepthTestDistance",r.disableDepthTestDistance,a,n,i)}},function(e,t,i,n){var r=t.polygon;if(Object(u.a)(r)){var a,o=r.interval;Object(u.a)(o)&&(qY.iso8601=o,a=ex.fromIso8601(qY));var s=e.polygon;Object(u.a)(s)||(e.polygon=s=new xz),YY(Boolean,s,"show",r.show,a,n,i),tX(s,"hierarchy",r.positions,i),YY(Number,s,"height",r.height,a,n,i),YY(Number,s,"extrudedHeight",r.extrudedHeight,a,n,i),YY(XW,s,"stRotation",r.stRotation,a,n,i),YY(Number,s,"granularity",r.granularity,a,n,i),YY(Boolean,s,"fill",r.fill,a,n,i),KY(s,"material",r.material,a,n,i),YY(Boolean,s,"outline",r.outline,a,n,i),YY(uf,s,"outlineColor",r.outlineColor,a,n,i),YY(Number,s,"outlineWidth",r.outlineWidth,a,n,i),YY(Boolean,s,"perPositionHeight",r.perPositionHeight,a,n,i),YY(Boolean,s,"closeTop",r.closeTop,a,n,i),YY(Boolean,s,"closeBottom",r.closeBottom,a,n,i),YY(rM,s,"shadows",r.shadows,a,n,i),YY(gv,s,"distanceDisplayCondition",r.distanceDisplayCondition,a,n,i),YY(Number,s,"zIndex",r.zIndex,a,n,i)}},function(e,t,i,n){var r=t.polyline;if(Object(u.a)(r)){var a,o=r.interval;Object(u.a)(o)&&(qY.iso8601=o,a=ex.fromIso8601(qY));var s=e.polyline;Object(u.a)(s)||(e.polyline=s=new Tz),YY(Boolean,s,"show",r.show,a,n,i),tX(s,"positions",r.positions,i),YY(Number,s,"width",r.width,a,n,i),YY(Number,s,"granularity",r.granularity,a,n,i),KY(s,"material",r.material,a,n,i),KY(s,"depthFailMaterial",r.depthFailMaterial,a,n,i),YY(Boolean,s,"followSurface",r.followSurface,a,n,i),YY(Boolean,s,"clampToGround",r.clampToGround,a,n,i),YY(rM,s,"shadows",r.shadows,a,n,i),YY(gv,s,"distanceDisplayCondition",r.distanceDisplayCondition,a,n,i),YY(Number,s,"zIndex",r.zIndex,a,n,i)}},function(e,t,i,n){var r=t.properties;if(Object(u.a)(r))for(var a in Object(u.a)(e.properties)||(e.properties=new dz),r)if(r.hasOwnProperty(a)){e.properties.hasProperty(a)||e.properties.addProperty(a);var o=r[a];if(Object(ym.a)(o))for(var s=0,c=o.length;s<c;s++)WY(UY(o[s]),e.properties,a,o[s],void 0,n,i);else WY(UY(o),e.properties,a,o,void 0,n,i)}},function(e,t,i,n){var r=t.rectangle;if(Object(u.a)(r)){var a,o=r.interval;Object(u.a)(o)&&(qY.iso8601=o,a=ex.fromIso8601(qY));var s=e.rectangle;Object(u.a)(s)||(e.rectangle=s=new Pz),YY(Boolean,s,"show",r.show,a,n,i),YY(Ve,s,"coordinates",r.coordinates,a,n,i),YY(Number,s,"height",r.height,a,n,i),YY(Number,s,"extrudedHeight",r.extrudedHeight,a,n,i),YY(XW,s,"rotation",r.rotation,a,n,i),YY(XW,s,"stRotation",r.stRotation,a,n,i),YY(Number,s,"granularity",r.granularity,a,n,i),YY(Boolean,s,"fill",r.fill,a,n,i),KY(s,"material",r.material,a,n,i),YY(Boolean,s,"outline",r.outline,a,n,i),YY(uf,s,"outlineColor",r.outlineColor,a,n,i),YY(Number,s,"outlineWidth",r.outlineWidth,a,n,i),YY(rM,s,"shadows",r.shadows,a,n,i),YY(gv,s,"distanceDisplayCondition",r.distanceDisplayCondition,a,n,i),YY(Number,s,"zIndex",r.zIndex,a,n,i)}},function(e,t,i,n){var r=t.position;Object(u.a)(r)&&ZY(e,"position",r,void 0,0,i)},function(e,t,i,n){var r=t.viewFrom;Object(u.a)(r)&&YY(z,e,"viewFrom",r,void 0,n,i)},function(e,t,i,n){var r=t.wall;if(Object(u.a)(r)){var a,o=r.interval;Object(u.a)(o)&&(qY.iso8601=o,a=ex.fromIso8601(qY));var s=e.wall;Object(u.a)(s)||(e.wall=s=new Dz),YY(Boolean,s,"show",r.show,a,n,i),tX(s,"positions",r.positions,i),$Y(s,"minimumHeights",r.minimumHeights,i),$Y(s,"maximumHeights",r.maximumHeights,i),YY(Number,s,"granularity",r.granularity,a,n,i),YY(Boolean,s,"fill",r.fill,a,n,i),KY(s,"material",r.material,a,n,i),YY(Boolean,s,"outline",r.outline,a,n,i),YY(uf,s,"outlineColor",r.outlineColor,a,n,i),YY(Number,s,"outlineWidth",r.outlineWidth,a,n,i),YY(rM,s,"shadows",r.shadows,a,n,i),YY(gv,s,"distanceDisplayCondition",r.distanceDisplayCondition,a,n,i)}},function(e,t,i,n){var r=t.orientation;Object(u.a)(r)&&YY(Kn,e,"orientation",r,void 0,n,i)},function(e,t,i,n){var r,a=t.availability;if(Object(u.a)(a)){var o;if(Object(ym.a)(a))for(var s=a.length,c=0;c<s;c++)Object(u.a)(o)||(o=new eI),qY.iso8601=a[c],r=ex.fromIso8601(qY),o.addInterval(r);else qY.iso8601=a,r=ex.fromIso8601(qY),(o=new eI).addInterval(r);e.availability=o}},function(e,t,i,n){var r=t.plane;if(Object(u.a)(r)){var a,o=r.interval;Object(u.a)(o)&&(qY.iso8601=o,a=ex.fromIso8601(qY));var s=e.plane,c={plane:new oc(z.UNIT_Z,0)};Object(u.a)(s)||(e.plane=s=new bz(c)),YY(Boolean,s,"show",r.show,a,n,i),YY(Rt,s,"dimensions",r.dimensions,a,n,i),YY(Boolean,s,"fill",r.fill,a,n,i),KY(s,"material",r.material,a,n,i),YY(Boolean,s,"outline",r.outline,a,n,i),YY(uf,s,"outlineColor",r.outlineColor,a,n,i),YY(Number,s,"outlineWidth",r.outlineWidth,a,n,i),YY(rM,s,"shadows",r.shadows,a,n,i),YY(gv,s,"distanceDisplayCondition",r.distanceDisplayCondition,a,n,i)}}],oX.prototype.process=function(e,t){return rX(this,e,t,!1)},oX.prototype.load=function(e,t){return rX(this,e,t,!0)},oX.processPacketData=YY,oX.processPositionPacketData=ZY,oX.processMaterialPacketData=KY,oX._processCzml=function(e,t,i,n,r){if(n=Object(u.a)(n)?n:oX.updaters,Object(ym.a)(e))for(var a=0,o=e.length;a<o;a++)nX(e[a],t,n,i,r);else nX(e,t,n,i,r)};var sX=oX;function cX(){this._dataSources=[],this._dataSourceAdded=new $o.a,this._dataSourceRemoved=new $o.a,this._dataSourceMoved=new $o.a}function lX(e,t){if(!Object(u.a)(t))throw new h.a("dataSource is required.");var i=e.indexOf(t);if(-1===i)throw new h.a("dataSource is not in this collection.");return i}function uX(e,t,i){var n=e._dataSources,r=n.length-1;if((t=I.clamp(t,0,r))!==(i=I.clamp(i,0,r))){var a=n[t];n[t]=n[i],n[i]=a,e.dataSourceMoved.raiseEvent(a,i,t)}}Object(O.a)(cX.prototype,{length:{get:function(){return this._dataSources.length}},dataSourceAdded:{get:function(){return this._dataSourceAdded}},dataSourceRemoved:{get:function(){return this._dataSourceRemoved}},dataSourceMoved:{get:function(){return this._dataSourceMoved}}}),cX.prototype.add=function(e){if(!Object(u.a)(e))throw new h.a("dataSource is required.");var t=this,i=this._dataSources;return Object(Oi.a)(e,(function(e){return i===t._dataSources&&(t._dataSources.push(e),t._dataSourceAdded.raiseEvent(t,e)),e}))},cX.prototype.remove=function(e,t){t=Object(w.a)(t,!1);var i=this._dataSources.indexOf(e);return-1!==i&&(this._dataSources.splice(i,1),this._dataSourceRemoved.raiseEvent(this,e),t&&"function"==typeof e.destroy&&e.destroy(),!0)},cX.prototype.removeAll=function(e){e=Object(w.a)(e,!1);for(var t=this._dataSources,i=0,n=t.length;i<n;++i){var r=t[i];this._dataSourceRemoved.raiseEvent(this,r),e&&"function"==typeof r.destroy&&r.destroy()}this._dataSources=[]},cX.prototype.contains=function(e){return-1!==this.indexOf(e)},cX.prototype.indexOf=function(e){return this._dataSources.indexOf(e)},cX.prototype.get=function(e){if(!Object(u.a)(e))throw new h.a("index is required.");return this._dataSources[e]},cX.prototype.raise=function(e){var t=lX(this._dataSources,e);uX(this,t,t+1)},cX.prototype.lower=function(e){var t=lX(this._dataSources,e);uX(this,t,t-1)},cX.prototype.raiseToTop=function(e){var t=lX(this._dataSources,e);t!==this._dataSources.length-1&&(this._dataSources.splice(t,1),this._dataSources.push(e),this.dataSourceMoved.raiseEvent(e,this._dataSources.length-1,t))},cX.prototype.lowerToBottom=function(e){var t=lX(this._dataSources,e);0!==t&&(this._dataSources.splice(t,1),this._dataSources.splice(0,0,e),this.dataSourceMoved.raiseEvent(e,0,t))},cX.prototype.isDestroyed=function(){return!1},cX.prototype.destroy=function(){return this.removeAll(!0),rl(this)};var hX=cX;function dX(e){e=Object(w.a)(e,w.a.EMPTY_OBJECT),this.color=e.color,this.depth=e.depth,this.stencil=e.stencil,this.renderState=e.renderState,this.framebuffer=e.framebuffer,this.owner=e.owner,this.pass=e.pass}dX.ALL=Object(E.a)(new dX({color:new uf(0,0,0,0),depth:1,stencil:0})),dX.prototype.execute=function(e,t){e.clear(this,t)};var fX=dX,pX={X:0,Y:1,Z:2,Y_UP_TO_Z_UP:Be.fromRotationTranslation(be.fromRotationX(I.PI_OVER_TWO)),Z_UP_TO_Y_UP:Be.fromRotationTranslation(be.fromRotationX(-I.PI_OVER_TWO)),X_UP_TO_Z_UP:Be.fromRotationTranslation(be.fromRotationY(-I.PI_OVER_TWO)),Z_UP_TO_X_UP:Be.fromRotationTranslation(be.fromRotationY(I.PI_OVER_TWO)),X_UP_TO_Y_UP:Be.fromRotationTranslation(be.fromRotationZ(I.PI_OVER_TWO)),Y_UP_TO_X_UP:Be.fromRotationTranslation(be.fromRotationZ(-I.PI_OVER_TWO)),fromName:function(e){return x.a.typeOf.string("name",e),pX[e]}},mX=Object(E.a)(pX),_X=Object(E.a)({SCALAR:"SCALAR",VEC2:"VEC2",VEC3:"VEC3",VEC4:"VEC4",MAT2:"MAT2",MAT3:"MAT3",MAT4:"MAT4"}),gX=Object(E.a)({HIGHLIGHT:0,REPLACE:1,MIX:2}),vX={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},bX={SCALAR:void 0,VEC2:Rt,VEC3:z,VEC4:Te,MAT2:vn,MAT3:be,MAT4:Be};var yX=function(e){var t,i=e.componentType;t="string"==typeof i?dn.fromName(i):i;var n=vX[e.type],r=bX[e.type];return{componentsPerAttribute:n,classType:r,createArrayBufferView:function(e,i,r){return dn.createArrayBufferView(t,e,i,n*r)}}};function wX(e){e=Object(w.a)(e,w.a.EMPTY_OBJECT),this.vertexArray=e.vertexArray,this.fragmentShaderSource=e.fragmentShaderSource,this.shaderProgram=e.shaderProgram,this.uniformMap=e.uniformMap,this.outputTexture=e.outputTexture,this.preExecute=e.preExecute,this.postExecute=e.postExecute,this.persists=Object(w.a)(e.persists,!1),this.pass=lM.COMPUTE,this.owner=e.owner}wX.prototype.execute=function(e){e.execute(this)};var OX=wX,xX=uf.WHITE;function EX(e,t,i,n,r){var a;this.featuresLength=t,this._translucentFeaturesLength=0,Object(u.a)(i)&&(a=i.extensions),this._extensions=Object(w.a)(a,{});var o,s,c=function(e){var t={};if(!Object(u.a)(e))return t;for(var i in e)e.hasOwnProperty(i)&&"HIERARCHY"!==i&&"extensions"!==i&&"extras"!==i&&(t[i]=Object(nf.a)(e[i],!0));return t}(i);if(this._properties=c,this._batchTableHierarchy=function(e,t,i){if(!Object(u.a)(t))return;var n=e._extensions["3DTILES_batch_table_hierarchy"],r=t.HIERARCHY;Object(u.a)(r)&&(EX._deprecationWarning("batchTableHierarchyExtension","The batch table HIERARCHY property has been moved to an extension. Use extensions.3DTILES_batch_table_hierarchy instead."),e._extensions["3DTILES_batch_table_hierarchy"]=r,n=r);if(!Object(u.a)(n))return;return function(e,t){var i,n,r,a,o=e.instancesLength,s=e.classes,c=e.classIds,l=e.parentCounts,h=e.parentIds,d=o;Object(u.a)(c.byteOffset)&&(c.componentType=Object(w.a)(c.componentType,dn.UNSIGNED_SHORT),c.type=_X.SCALAR,r=yX(c),c=r.createArrayBufferView(t.buffer,t.byteOffset+c.byteOffset,o));if(Object(u.a)(l))for(Object(u.a)(l.byteOffset)&&(l.componentType=Object(w.a)(l.componentType,dn.UNSIGNED_SHORT),l.type=_X.SCALAR,r=yX(l),l=r.createArrayBufferView(t.buffer,t.byteOffset+l.byteOffset,o)),a=new Uint16Array(o),d=0,i=0;i<o;++i)a[i]=d,d+=l[i];Object(u.a)(h)&&Object(u.a)(h.byteOffset)&&(h.componentType=Object(w.a)(h.componentType,dn.UNSIGNED_SHORT),h.type=_X.SCALAR,r=yX(h),h=r.createArrayBufferView(t.buffer,t.byteOffset+h.byteOffset,d));var f=s.length;for(i=0;i<f;++i){var p=s[i].length,m=s[i].instances,_=SX(p,m,t);s[i].instances=Object(ff.a)(_,m)}var g=Qt(new Array(f),0),v=new Uint16Array(o);for(i=0;i<o;++i)n=c[i],v[i]=g[n],++g[n];var b={classes:s,classIds:c,classIndexes:v,parentCounts:l,parentIndexes:a,parentIds:h};return function(e){var t=TX;t.length=0;for(var i=e.classIds.length,n=0;n<i;++n)CX(e,n,t)}(b),b}(n,i)}(this,i,n),this._batchTableBinaryProperties=SX(t,c,n),this._showAlphaProperties=void 0,this._batchValues=void 0,this._batchValuesDirty=!1,this._batchTexture=void 0,this._defaultTexture=void 0,this._pickTexture=void 0,this._pickIds=[],this._content=e,this._colorChangedCallback=r,t>0){var l=Math.min(t,HD.maximumTextureSize),h=Math.ceil(t/HD.maximumTextureSize),d=1/l,f=.5*d,p=1/h,m=.5*p;o=new Rt(l,h),s=new Te(d,f,p,m)}this._textureDimensions=o,this._textureStep=s}EX._deprecationWarning=mv.a,Object(O.a)(EX.prototype,{memorySizeInBytes:{get:function(){var e=0;return Object(u.a)(this._pickTexture)&&(e+=this._pickTexture.sizeInBytes),Object(u.a)(this._batchTexture)&&(e+=this._batchTexture.sizeInBytes),e}}});var TX=[];function CX(e,t,i){var n=e.parentCounts,r=e.parentIds,a=e.parentIndexes,o=e.classIds.length;if(Object(u.a)(r)){if(t>=o)throw new h.a("Parent index "+t+" exceeds the total number of instances: "+o);if(i.indexOf(t)>-1)throw new h.a("Circular dependency detected in the batch table hierarchy.");i.push(t);for(var s=Object(u.a)(n)?n[t]:1,c=Object(u.a)(n)?a[t]:t,l=0;l<s;++l){var d=r[c+l];d!==t&&CX(e,d,i)}i.pop(t)}}function SX(e,t,i){var n;for(var r in t)if(t.hasOwnProperty(r)){var a=t[r],o=a.byteOffset;if(Object(u.a)(o)){var s=a.componentType,c=a.type;if(!Object(u.a)(s))throw new Ce.a("componentType is required.");if(!Object(u.a)(c))throw new Ce.a("type is required.");if(!Object(u.a)(i))throw new Ce.a("Property "+r+" requires a batch table binary.");var l=yX(a),h=l.componentsPerAttribute,d=l.classType,f=l.createArrayBufferView(i.buffer,i.byteOffset+o,e);Object(u.a)(n)||(n={}),n[r]={typedArray:f,componentCount:h,type:d}}}return n}function AX(e){var t=e._textureDimensions;return t.x*t.y*4}function PX(e){if(!Object(u.a)(e._batchValues)){var t=AX(e),i=new Uint8Array(t);Qt(i,255),e._batchValues=i}return e._batchValues}function IX(e){if(!Object(u.a)(e._showAlphaProperties)){var t=2*e.featuresLength,i=new Uint8Array(t);Qt(i,255),e._showAlphaProperties=i}return e._showAlphaProperties}function DX(e,t){if(!Object(u.a)(e)||e<0||e>t)throw new h.a("batchId is required and between zero and featuresLength - 1 ("+t-NaN)}EX.getBinaryProperties=function(e,t,i){return SX(e,t,i)},EX.prototype.setShow=function(e,t){if(DX(e,this.featuresLength),x.a.typeOf.bool("show",t),!t||Object(u.a)(this._showAlphaProperties)){var i=IX(this),n=2*e,r=t?255:0;if(i[n]!==r)i[n]=r,PX(this)[4*e+3]=t?i[n+1]:0,this._batchValuesDirty=!0}},EX.prototype.setAllShow=function(e){x.a.typeOf.bool("show",e);for(var t=this.featuresLength,i=0;i<t;++i)this.setShow(i,e)},EX.prototype.getShow=function(e){if(DX(e,this.featuresLength),!Object(u.a)(this._showAlphaProperties))return!0;var t=2*e;return 255===this._showAlphaProperties[t]};var jX=new Array(4);EX.prototype.setColor=function(e,t){if(DX(e,this.featuresLength),x.a.typeOf.object("color",t),!uf.equals(t,xX)||Object(u.a)(this._batchValues)){var i=t.toBytes(jX),n=i[3],r=PX(this),a=4*e,o=IX(this),s=2*e;if(r[a]!==i[0]||r[a+1]!==i[1]||r[a+2]!==i[2]||o[s+1]!==n){r[a]=i[0],r[a+1]=i[1],r[a+2]=i[2];var c=255!==o[s+1],l=0!==o[s];r[a+3]=l?n:0,o[s+1]=n;var h=255!==n;h&&!c?++this._translucentFeaturesLength:!h&&c&&--this._translucentFeaturesLength,this._batchValuesDirty=!0,Object(u.a)(this._colorChangedCallback)&&this._colorChangedCallback(e,t)}}},EX.prototype.setAllColor=function(e){x.a.typeOf.object("color",e);for(var t=this.featuresLength,i=0;i<t;++i)this.setColor(i,e)},EX.prototype.getColor=function(e,t){if(DX(e,this.featuresLength),x.a.typeOf.object("result",t),!Object(u.a)(this._batchValues))return uf.clone(xX,t);var i=this._batchValues,n=4*e,r=this._showAlphaProperties,a=2*e;return uf.fromBytes(i[n],i[n+1],i[n+2],r[a+1],t)},EX.prototype.getPickColor=function(e){return DX(e,this.featuresLength),this._pickIds[e]};var MX=new uf;function RX(e,t){var i=e.typedArray,n=e.componentCount;return 1===n?i[t]:e.type.unpack(i,t*n)}function LX(e,t,i){var n=e.typedArray,r=e.componentCount;1===r?n[t]=i:e.type.pack(i,n,t*r)}EX.prototype.applyStyle=function(e){if(!Object(u.a)(e))return this.setAllColor(xX),void this.setAllShow(!0);for(var t=this._content,i=this.featuresLength,n=0;n<i;++n){var r=t.getFeature(n),a=Object(u.a)(e.color)?e.color.evaluateColor(r,MX):xX,o=!Object(u.a)(e.show)||e.show.evaluate(r);this.setColor(n,a),this.setShow(n,o)}};var NX=[],FX=[],kX=0;function BX(e,t,i){var n=e.parentCounts,r=e.parentIds;return Object(u.a)(r)?Object(u.a)(n)?function(e,t,i){var n=e.classIds,r=e.parentCounts,a=e.parentIds,o=e.parentIndexes,s=n.length,c=NX;c.length=Math.max(c.length,s);var l=++kX,h=FX;for(h.length=0,h.push(t);h.length>0;)if(c[t=h.pop()]!==l){c[t]=l;var d=i(e,t);if(Object(u.a)(d))return d;for(var f=r[t],p=o[t],m=0;m<f;++m){var _=a[p+m];_!==t&&h.push(_)}}}(e,t,i):function(e,t,i){for(var n=!0;n;){var r=i(e,t);if(Object(u.a)(r))return r;var a=e.parentIds[t];n=a!==t,t=a}}(e,t,i):i(e,t)}function zX(e,t){return e=UN.replaceMain(e,"tile_main"),t?e+"uniform float tile_colorBlend; \nvoid tile_color(vec4 tile_featureColor) \n{ \n    tile_main(); \n    tile_featureColor = czm_gammaCorrect(tile_featureColor); \n    gl_FragColor.a *= tile_featureColor.a; \n    float highlight = ceil(tile_colorBlend); \n    gl_FragColor.rgb *= mix(tile_featureColor.rgb, vec3(1.0), highlight); \n} \n":e+"void tile_color(vec4 tile_featureColor) \n{ \n    tile_main(); \n} \n"}function UX(e,t,i){i&&(new RegExp("pbrBaseColor").test(e)&&(t="pbrBaseColor"));if(!Object(u.a)(t))return zX(e,i);var n=new RegExp("(uniform|attribute|in|varying)\\s+(vec[34]|sampler2D)\\s+"+t+";"),r=e.match(n);if(!Object(u.a)(r))return zX(e,i);var a=r[0],o=r[2];e=(e=UN.replaceMain(e,"tile_main")).replace(a,"");var s;if("vec3"===o||"vec4"===o){var c="vec3"===o?"vec4("+t+", 1.0)":t,l="vec3"===o?"tile_diffuse.xyz":"tile_diffuse";n=new RegExp(t,"g"),e=e.replace(n,l),s="    vec4 source = "+c+"; \n    tile_diffuse = tile_diffuse_final(source, tile_featureColor); \n    tile_main(); \n"}else"sampler2D"===o&&(e=function(e,t){for(var i,n="texture2D("+t,r=0,a=e.indexOf(n,r);a>-1;){for(var o=0,s=a;s<e.length;++s){var c=e.charAt(s);if("("===c)++o;else if(")"===c&&0===--o){i=s+1;break}}var l="tile_diffuse_final("+e.slice(a,i)+", tile_diffuse)";e=e.slice(0,a)+l+e.slice(i),r=a+l.length,a=e.indexOf(n,r)}return e}(e,t),s="    tile_diffuse = tile_featureColor; \n    tile_main(); \n");return e="uniform float tile_colorBlend; \nvec4 tile_diffuse = vec4(1.0); \nbool isWhite(vec3 color) \n{ \n    return all(greaterThan(color, vec3(1.0 - czm_epsilon3))); \n} \nvec4 tile_diffuse_final(vec4 sourceDiffuse, vec4 tileDiffuse) \n{ \n    vec4 blendDiffuse = mix(sourceDiffuse, tileDiffuse, tile_colorBlend); \n    vec4 diffuse = isWhite(tileDiffuse.rgb) ? sourceDiffuse : blendDiffuse; \n    return vec4(diffuse.rgb, sourceDiffuse.a); \n} \n"+a+"\n"+e+"\nvoid tile_color(vec4 tile_featureColor) \n{ \n"+s,i&&(e+="    tile_featureColor = czm_gammaCorrect(tile_featureColor); \n    gl_FragColor.a *= tile_featureColor.a; \n    float highlight = ceil(tile_colorBlend); \n    gl_FragColor.rgb *= mix(tile_featureColor.rgb, vec3(1.0), highlight); \n"),e+="} \n"}EX.prototype.isClass=function(e,t){DX(e,this.featuresLength),x.a.typeOf.string("className",t);var i=this._batchTableHierarchy;if(!Object(u.a)(i))return!1;var n=BX(i,e,(function(e,i){var n=e.classIds[i];if(e.classes[n].name===t)return!0}));return Object(u.a)(n)},EX.prototype.isExactClass=function(e,t){return x.a.typeOf.string("className",t),this.getExactClassName(e)===t},EX.prototype.getExactClassName=function(e){DX(e,this.featuresLength);var t=this._batchTableHierarchy;if(Object(u.a)(t)){var i=t.classIds[e];return t.classes[i].name}},EX.prototype.hasProperty=function(e,t){return DX(e,this.featuresLength),x.a.typeOf.string("name",t),Object(u.a)(this._properties[t])||Object(u.a)(this._batchTableHierarchy)&&function(e,t,i){var n=BX(e._batchTableHierarchy,t,(function(e,t){var n=e.classIds[t],r=e.classes[n].instances;if(Object(u.a)(r[i]))return!0}));return Object(u.a)(n)}(this,e,t)},EX.prototype.getPropertyNames=function(e,t){DX(e,this.featuresLength),(t=Object(u.a)(t)?t:[]).length=0;var i=Object.keys(this._properties);return t.push.apply(t,i),Object(u.a)(this._batchTableHierarchy)&&function(e,t,i){BX(e._batchTableHierarchy,t,(function(e,t){var n=e.classIds[t],r=e.classes[n].instances;for(var a in r)r.hasOwnProperty(a)&&-1===i.indexOf(a)&&i.push(a)}))}(this,e,t),t},EX.prototype.getProperty=function(e,t){if(DX(e,this.featuresLength),x.a.typeOf.string("name",t),Object(u.a)(this._batchTableBinaryProperties)){var i=this._batchTableBinaryProperties[t];if(Object(u.a)(i))return RX(i,e)}var n=this._properties[t];if(Object(u.a)(n))return Object(nf.a)(n[e],!0);if(Object(u.a)(this._batchTableHierarchy)){var r=function(e,t,i){return BX(e._batchTableHierarchy,t,(function(e,t){var n=e.classIds[t],r=e.classes[n],a=e.classIndexes[t],o=r.instances[i];if(Object(u.a)(o))return Object(u.a)(o.typedArray)?RX(o,a):Object(nf.a)(o[a],!0)}))}(this,e,t);if(Object(u.a)(r))return r}},EX.prototype.setProperty=function(e,t,i){var n=this.featuresLength;if(DX(e,n),x.a.typeOf.string("name",t),Object(u.a)(this._batchTableBinaryProperties)){var r=this._batchTableBinaryProperties[t];if(Object(u.a)(r))return void LX(r,e,i)}if(!Object(u.a)(this._batchTableHierarchy)||!function(e,t,i,n){var r=BX(e._batchTableHierarchy,t,(function(e,r){var a=e.classIds[r],o=e.classes[a],s=e.classIndexes[r],c=o.instances[i];if(Object(u.a)(c)){if(r!==t)throw new h.a('Inherited property "'+i+'" is read-only.');return Object(u.a)(c.typedArray)?LX(c,s,n):c[s]=Object(nf.a)(n,!0),!0}}));return Object(u.a)(r)}(this,e,t,i)){var a=this._properties[t];Object(u.a)(a)||(this._properties[t]=new Array(n),a=this._properties[t]),a[e]=Object(nf.a)(i,!0)}},EX.prototype.getVertexShaderCallback=function(e,t,i){if(0!==this.featuresLength){var n=this;return function(r){var a,o=UX(r,i,!1);return HD.maximumVertexTextureImageUnits>0?(a="",e&&(a+="uniform bool tile_translucentCommand; \n"),a+="uniform sampler2D tile_batchTexture; \nvarying vec4 tile_featureColor; \nvarying vec2 tile_featureSt; \nvoid main() \n{ \n    vec2 st = computeSt(isInstance ? instanceBatchId : "+t+"); \n    vec4 featureProperties = texture2D(tile_batchTexture, st); \n    tile_color(featureProperties); \n    float show = ceil(featureProperties.a); \n    gl_Position *= show; \n",e&&(a+="    bool isStyleTranslucent = (featureProperties.a != 1.0); \n    if (czm_pass == czm_passTranslucent) \n    { \n        if (!isStyleTranslucent && !tile_translucentCommand) \n        { \n            gl_Position *= 0.0; \n        } \n    } \n    else \n    { \n        if (isStyleTranslucent) \n        { \n            gl_Position *= 0.0; \n        } \n    } \n"),a+="    tile_featureColor = featureProperties; \n    tile_featureSt = st; \n}"):a="varying vec2 tile_featureSt; \nvoid main() \n{ \n    tile_color(vec4(1.0)); \n    tile_featureSt = computeSt("+t+"); \n}",o+"\n"+(1===n._textureDimensions.y?"uniform vec4 tile_textureStep; \nvec2 computeSt(float batchId) \n{ \n    float stepX = tile_textureStep.x; \n    float centerX = tile_textureStep.y; \n    return vec2(centerX + (batchId * stepX), 0.5); \n} \n":"uniform vec4 tile_textureStep; \nuniform vec2 tile_textureDimensions; \nvec2 computeSt(float batchId) \n{ \n    float stepX = tile_textureStep.x; \n    float centerX = tile_textureStep.y; \n    float stepY = tile_textureStep.z; \n    float centerY = tile_textureStep.w; \n    float xId = mod(batchId, tile_textureDimensions.x); \n    float yId = floor(batchId / tile_textureDimensions.x); \n    return vec2(centerX + (xId * stepX), centerY + (yId * stepY)); \n} \n")+a}}},EX.prototype.getFragmentShaderCallback=function(e,t){if(0!==this.featuresLength)return function(i){return i=UX(i,t,!0),HD.maximumVertexTextureImageUnits>0?i+="uniform sampler2D tile_pickTexture; \nvarying vec2 tile_featureSt; \nvarying vec4 tile_featureColor; \nvoid main() \n{ \n    tile_color(tile_featureColor); \n}":(e&&(i+="uniform bool tile_translucentCommand; \n"),i+="uniform sampler2D tile_pickTexture; \nuniform sampler2D tile_batchTexture; \nvarying vec2 tile_featureSt; \nvoid main() \n{ \n    vec4 featureProperties = texture2D(tile_batchTexture, tile_featureSt); \n    if (featureProperties.a == 0.0) { \n        discard; \n    } \n",e&&(i+="    bool isStyleTranslucent = (featureProperties.a != 1.0); \n    if (czm_pass == czm_passTranslucent) \n    { \n        if (!isStyleTranslucent && !tile_translucentCommand) \n        { \n            discard; \n        } \n    } \n    else \n    { \n        if (isStyleTranslucent) \n        { \n            discard; \n        } \n    } \n"),i+="    tile_color(featureProperties); \n} \n"),i}},EX.prototype.getClassificationFragmentShaderCallback=function(){if(0!==this.featuresLength)return function(e){return e=UN.replaceMain(e,"tile_main"),HD.maximumVertexTextureImageUnits>0?e+="uniform sampler2D tile_pickTexture;\nvarying vec2 tile_featureSt; \nvarying vec4 tile_featureColor; \nvoid main() \n{ \n    tile_main(); \n    gl_FragColor = tile_featureColor; \n}":e+="uniform sampler2D tile_batchTexture; \nuniform sampler2D tile_pickTexture;\nvarying vec2 tile_featureSt; \nvoid main() \n{ \n    tile_main(); \n    vec4 featureProperties = texture2D(tile_batchTexture, tile_featureSt); \n    if (featureProperties.a == 0.0) { \n        discard; \n    } \n    gl_FragColor = featureProperties; \n} \n",e}},EX.prototype.getUniformMapCallback=function(){if(0!==this.featuresLength){var e=this;return function(t){var i={tile_batchTexture:function(){return Object(w.a)(e._batchTexture,e._defaultTexture)},tile_textureDimensions:function(){return e._textureDimensions},tile_textureStep:function(){return e._textureStep},tile_colorBlend:function(){return function(e){var t=e._content.tileset,i=t.colorBlendMode,n=t.colorBlendAmount;if(i===gX.HIGHLIGHT)return 0;if(i===gX.REPLACE)return 1;if(i===gX.MIX)return I.clamp(n,I.EPSILON4,1);throw new h.a('Invalid color blend mode "'+i+'".')}(e)},tile_pickTexture:function(){return e._pickTexture}};return Object(ff.a)(t,i)}}},EX.prototype.getPickId=function(){return"texture2D(tile_pickTexture, tile_featureSt)"};var VX={ALL_OPAQUE:0,ALL_TRANSLUCENT:1,OPAQUE_AND_TRANSLUCENT:2};function HX(e){var t=cM.shallowClone(e),i=t.pass===lM.TRANSLUCENT;return t.uniformMap=Object(u.a)(t.uniformMap)?t.uniformMap:{},t.uniformMap.tile_translucentCommand=function(){return i},t}function GX(e){var t,i,n=cM.shallowClone(e);return n.pass=lM.TRANSLUCENT,n.renderState=(t=e.renderState,(i=Object(nf.a)(t,!0)).cull.enabled=!1,i.depthTest.enabled=!0,i.depthMask=!1,i.blending=FD.ALPHA_BLEND,RM.fromCache(i)),n}function qX(e){var t,i,n=cM.shallowClone(e);return n.renderState=(t=e.renderState,(i=Object(nf.a)(t,!0)).stencilTest=Hk.setCesium3DTileBit(),i.stencilMask=Hk.CESIUM_3D_TILE_MASK,RM.fromCache(i)),n}function WX(e,t){var i=cM.shallowClone(t),n=Object(nf.a)(i.renderState,!0);return n.cull.enabled=!0,n.cull.face=BD.FRONT,n.colorMask={red:!1,green:!1,blue:!1,alpha:!1},n.polygonOffset={enabled:!0,factor:5,units:5},n.stencilTest=Hk.setCesium3DTileBit(),n.stencilMask=Hk.CESIUM_3D_TILE_MASK,i.renderState=RM.fromCache(n),i.castShadows=!1,i.receiveShadows=!1,i.shaderProgram=function(e,t){var i=e.shaderCache.getDerivedShaderProgram(t,"zBackfaceLogDepth");if(!Object(u.a)(i)){var n=t.fragmentShaderSource.clone();n.defines=Object(u.a)(n.defines)?n.defines.slice(0):[],n.defines.push("DISABLE_LOG_DEPTH_FRAGMENT_WRITE"),i=e.shaderCache.createDerivedShaderProgram(t,"zBackfaceLogDepth",{vertexShaderSource:t.vertexShaderSource,fragmentShaderSource:n,attributeLocations:t._attributeLocations})}return i}(e,t.shaderProgram),i}function YX(e,t){var i=cM.shallowClone(e),n=Object(nf.a)(i.renderState,!0);return n.stencilTest.enabled=!0,n.stencilTest.mask=Hk.SKIP_LOD_MASK,n.stencilTest.reference=Hk.CESIUM_3D_TILE_MASK|t<<Hk.SKIP_LOD_BIT_SHIFT,n.stencilTest.frontFunction=Bk.GREATER_OR_EQUAL,n.stencilTest.frontOperation.zPass=Uk.REPLACE,n.stencilTest.backFunction=Bk.GREATER_OR_EQUAL,n.stencilTest.backOperation.zPass=Uk.REPLACE,n.stencilMask=Hk.CESIUM_3D_TILE_MASK|Hk.SKIP_LOD_MASK,i.renderState=RM.fromCache(n),i}function XX(e,t,i){var n=e._textureDimensions;return new hj({context:t,pixelFormat:gx.RGBA,pixelDatatype:mx.UNSIGNED_BYTE,source:{width:n.x,height:n.y,arrayBufferView:i},flipY:!1,sampler:new tj({minificationFilter:KD.NEAREST,magnificationFilter:ZD.NEAREST})})}EX.prototype.addDerivedCommands=function(e,t){for(var i,n=e.commandList,r=n.length,a=this._content._tile,o=a._finalResolution,s=a.tileset,c=s._skipLevelOfDetail&&s._hasMixedContent&&e.context.stencilBuffer,l=function(e){var t=e._translucentFeaturesLength;if(0===t)return VX.ALL_OPAQUE;if(t===e.featuresLength)return VX.ALL_TRANSLUCENT;return VX.OPAQUE_AND_TRANSLUCENT}(this),h=t;h<r;++h){var d=n[h];if(!(d instanceof OX)){var f=d.derivedCommands.tileset;Object(u.a)(f)&&!d.dirty||(f={},d.derivedCommands.tileset=f,f.originalCommand=HX(d),d.dirty=!1);var p=f.originalCommand;l!==VX.ALL_OPAQUE&&d.pass!==lM.TRANSLUCENT&&(Object(u.a)(f.translucent)||(f.translucent=GX(p))),l!==VX.ALL_TRANSLUCENT&&d.pass!==lM.TRANSLUCENT&&(Object(u.a)(f.opaque)||(f.opaque=qX(p)),c&&(o||(Object(u.a)(f.zback)||(f.zback=WX(e.context,p)),s._backfaceCommands.push(f.zback)),Object(u.a)(f.stencil)&&a._selectionDepth===(i=f.stencil,void 0,(i.renderState.stencilTest.reference&Hk.SKIP_LOD_MASK)>>>Hk.SKIP_LOD_BIT_SHIFT)||(d.renderState.depthMask?f.stencil=YX(p,a._selectionDepth):f.stencil=f.opaque)));var m=c?f.stencil:f.opaque,_=f.translucent;d.pass!==lM.TRANSLUCENT?(l===VX.ALL_OPAQUE&&(n[h]=m),l===VX.ALL_TRANSLUCENT&&(n[h]=_),l===VX.OPAQUE_AND_TRANSLUCENT&&(n[h]=m,n.push(_))):n[h]=p}}},EX.prototype.update=function(e,t){var i=t.context;this._defaultTexture=i.defaultTexture;var n,r,a=t.passes;(a.pick||a.postProcess)&&function(e,t){var i=e.featuresLength;if(!Object(u.a)(e._pickTexture)&&i>0){for(var n=e._pickIds,r=AX(e),a=new Uint8Array(r),o=e._content,s=0;s<i;++s){var c=t.createPickId(o.getFeature(s));n.push(c);var l=c.color,h=4*s;a[h]=uf.floatToByte(l.red),a[h+1]=uf.floatToByte(l.green),a[h+2]=uf.floatToByte(l.blue),a[h+3]=uf.floatToByte(l.alpha)}e._pickTexture=XX(e,t,a),o.tileset._statistics.batchTableByteLength+=e._pickTexture.sizeInBytes}}(this,i),this._batchValuesDirty&&(this._batchValuesDirty=!1,Object(u.a)(this._batchTexture)||(this._batchTexture=XX(this,i,this._batchValues),e._statistics.batchTableByteLength+=this._batchTexture.sizeInBytes),r=(n=this)._textureDimensions,n._batchTexture.copyFrom({width:r.x,height:r.y,arrayBufferView:n._batchValues}))},EX.prototype.isDestroyed=function(){return!1},EX.prototype.destroy=function(){this._batchTexture=this._batchTexture&&this._batchTexture.destroy(),this._pickTexture=this._pickTexture&&this._pickTexture.destroy();for(var e=this._pickIds,t=e.length,i=0;i<t;++i)e[i].destroy();return rl(this)};var ZX=EX;function QX(e,t){this._content=e,this._batchId=t,this._color=void 0}Object(O.a)(QX.prototype,{show:{get:function(){return this._content.batchTable.getShow(this._batchId)},set:function(e){this._content.batchTable.setShow(this._batchId,e)}},color:{get:function(){return Object(u.a)(this._color)||(this._color=new uf),this._content.batchTable.getColor(this._batchId,this._color)},set:function(e){this._content.batchTable.setColor(this._batchId,e)}},content:{get:function(){return this._content}},tileset:{get:function(){return this._content.tileset}},primitive:{get:function(){return this._content.tileset}},pickId:{get:function(){return this._content.batchTable.getPickColor(this._batchId)}}}),QX.prototype.hasProperty=function(e){return this._content.batchTable.hasProperty(this._batchId,e)},QX.prototype.getPropertyNames=function(e){return this._content.batchTable.getPropertyNames(this._batchId,e)},QX.prototype.getProperty=function(e){return this._content.batchTable.getProperty(this._batchId,e)},QX.prototype.setProperty=function(e,t){this._content.batchTable.setProperty(this._batchId,e,t),this._content.featurePropertiesDirty=!0},QX.prototype.isExactClass=function(e){return this._content.batchTable.isExactClass(this._batchId,e)},QX.prototype.isClass=function(e){return this._content.batchTable.isClass(this._batchId,e)},QX.prototype.getExactClassName=function(){return this._content.batchTable.getExactClassName(this._batchId)};var KX=QX;function JX(e,t){this.json=e,this.buffer=t,this._cachedTypedArrays={},this.featuresLength=0}function $X(e,t,i,n,r,a){var o=e._cachedTypedArrays,s=o[t];return Object(u.a)(s)||(s=dn.createArrayBufferView(i,e.buffer.buffer,e.buffer.byteOffset+a,r*n),o[t]=s),s}JX.prototype.getGlobalProperty=function(e,t,i){var n=this.json[e];if(Object(u.a)(n))return Object(u.a)(n.byteOffset)?$X(this,e,t=Object(w.a)(t,dn.UNSIGNED_INT),i=Object(w.a)(i,1),1,n.byteOffset):n},JX.prototype.getPropertyArray=function(e,t,i){var n=this.json[e];if(Object(u.a)(n))return Object(u.a)(n.byteOffset)?(Object(u.a)(n.componentType)&&(t=dn.fromName(n.componentType)),$X(this,e,t,i,this.featuresLength,n.byteOffset)):function(e,t,i,n){var r=e._cachedTypedArrays,a=r[t];return Object(u.a)(a)||(a=dn.createTypedArray(i,n),r[t]=a),a}(this,e,t,n)},JX.prototype.getProperty=function(e,t,i,n,r){var a=this.json[e];if(Object(u.a)(a)){var o=this.getPropertyArray(e,t,i);if(1===i)return o[n];for(var s=0;s<i;++s)r[s]=o[i*n+s];return r}};var eZ=JX;var tZ=function(e,t,i){if(i=Object(w.a)(i,!1)){var n=e.indexOf(t);if(n>-1)return n}return e.push(t),e.length-1};var iZ=function(e,t){return Object(u.a)(e.extensionsUsed)&&e.extensionsUsed.indexOf(t)>=0};function nZ(){}nZ.objectLegacy=function(e,t){if(Object(u.a)(e))for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var n=t(e[i],i);if(Object(u.a)(n))return n}},nZ.object=function(e,t){if(Object(u.a)(e))for(var i=e.length,n=0;n<i;n++){var r=t(e[n],n);if(Object(u.a)(r))return r}},nZ.topLevel=function(e,t,i){var n=e[t];return Object(u.a)(n)&&!Array.isArray(n)?nZ.objectLegacy(n,i):nZ.object(n,i)},nZ.accessor=function(e,t){return nZ.topLevel(e,"accessors",t)},nZ.accessorWithSemantic=function(e,t,i){var n={};return nZ.mesh(e,(function(e){return nZ.meshPrimitive(e,(function(e){var r=nZ.meshPrimitiveAttribute(e,(function(e,r){if(0===r.indexOf(t)&&!Object(u.a)(n[e])){n[e]=!0;var a=i(e);if(Object(u.a)(a))return a}}));return Object(u.a)(r)?r:nZ.meshPrimitiveTarget(e,(function(e){return nZ.meshPrimitiveTargetAttribute(e,(function(e,r){if(0===r.indexOf(t)&&!Object(u.a)(n[e])){n[e]=!0;var a=i(e);if(Object(u.a)(a))return a}}))}))}))}))},nZ.accessorContainingVertexAttributeData=function(e,t){var i={};return nZ.mesh(e,(function(e){return nZ.meshPrimitive(e,(function(e){var n=nZ.meshPrimitiveAttribute(e,(function(e){if(!Object(u.a)(i[e])){i[e]=!0;var n=t(e);if(Object(u.a)(n))return n}}));return Object(u.a)(n)?n:nZ.meshPrimitiveTarget(e,(function(e){return nZ.meshPrimitiveTargetAttribute(e,(function(e){if(!Object(u.a)(i[e])){i[e]=!0;var n=t(e);if(Object(u.a)(n))return n}}))}))}))}))},nZ.accessorContainingIndexData=function(e,t){var i={};return nZ.mesh(e,(function(e){return nZ.meshPrimitive(e,(function(e){var n=e.indices;if(Object(u.a)(n)&&!Object(u.a)(i[n])){i[n]=!0;var r=t(n);if(Object(u.a)(r))return r}}))}))},nZ.animation=function(e,t){return nZ.topLevel(e,"animations",t)},nZ.animationChannel=function(e,t){var i=e.channels;return nZ.object(i,t)},nZ.animationSampler=function(e,t){var i=e.samplers;return nZ.object(i,t)},nZ.buffer=function(e,t){return nZ.topLevel(e,"buffers",t)},nZ.bufferView=function(e,t){return nZ.topLevel(e,"bufferViews",t)},nZ.camera=function(e,t){return nZ.topLevel(e,"cameras",t)},nZ.image=function(e,t){return nZ.topLevel(e,"images",t)},nZ.compressedImage=function(e,t){if(Object(u.a)(e.extras)){var i=e.extras.compressedImage3DTiles;for(var n in i)if(Object.prototype.hasOwnProperty.call(i,n)){var r=t(i[n],n);if(Object(u.a)(r))return r}}},nZ.material=function(e,t){return nZ.topLevel(e,"materials",t)},nZ.materialValue=function(e,t){var i=e.values;for(var n in Object(u.a)(e.extensions)&&Object(u.a)(e.extensions.KHR_techniques_webgl)&&(i=e.extensions.KHR_techniques_webgl.values),i)if(Object.prototype.hasOwnProperty.call(i,n)){var r=t(i[n],n);if(Object(u.a)(r))return r}},nZ.mesh=function(e,t){return nZ.topLevel(e,"meshes",t)},nZ.meshPrimitive=function(e,t){var i=e.primitives;if(Object(u.a)(i))for(var n=i.length,r=0;r<n;r++){var a=t(i[r],r);if(Object(u.a)(a))return a}},nZ.meshPrimitiveAttribute=function(e,t){var i=e.attributes;for(var n in i)if(Object.prototype.hasOwnProperty.call(i,n)){var r=t(i[n],n);if(Object(u.a)(r))return r}},nZ.meshPrimitiveTarget=function(e,t){var i=e.targets;if(Object(u.a)(i))for(var n=i.length,r=0;r<n;++r){var a=t(i[r],r);if(Object(u.a)(a))return a}},nZ.meshPrimitiveTargetAttribute=function(e,t){for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var n=t(e[i],i);if(Object(u.a)(n))return n}},nZ.node=function(e,t){return nZ.topLevel(e,"nodes",t)},nZ.nodeInTree=function(e,t,i){var n=e.nodes;if(Object(u.a)(n))for(var r=t.length,a=0;a<r;a++){var o=t[a],s=n[o];if(Object(u.a)(s)){var c=i(s,o);if(Object(u.a)(c))return c;var l=s.children;if(Object(u.a)(l)&&(c=nZ.nodeInTree(e,l,i),Object(u.a)(c)))return c}}},nZ.nodeInScene=function(e,t,i){var n=t.nodes;if(Object(u.a)(n))return nZ.nodeInTree(e,n,i)},nZ.program=function(e,t){return iZ(e,"KHR_techniques_webgl")?nZ.object(e.extensions.KHR_techniques_webgl.programs,t):nZ.topLevel(e,"programs",t)},nZ.sampler=function(e,t){return nZ.topLevel(e,"samplers",t)},nZ.scene=function(e,t){return nZ.topLevel(e,"scenes",t)},nZ.shader=function(e,t){return iZ(e,"KHR_techniques_webgl")?nZ.object(e.extensions.KHR_techniques_webgl.shaders,t):nZ.topLevel(e,"shaders",t)},nZ.skin=function(e,t){return nZ.topLevel(e,"skins",t)},nZ.skinJoint=function(e,t){var i=e.joints;if(Object(u.a)(i))for(var n=i.length,r=0;r<n;r++){var a=t(i[r]);if(Object(u.a)(a))return a}},nZ.techniqueAttribute=function(e,t){var i=e.attributes;for(var n in i)if(Object.prototype.hasOwnProperty.call(i,n)){var r=t(i[n],n);if(Object(u.a)(r))return r}},nZ.techniqueUniform=function(e,t){var i=e.uniforms;for(var n in i)if(Object.prototype.hasOwnProperty.call(i,n)){var r=t(i[n],n);if(Object(u.a)(r))return r}},nZ.techniqueParameter=function(e,t){var i=e.parameters;for(var n in i)if(Object.prototype.hasOwnProperty.call(i,n)){var r=t(i[n],n);if(Object(u.a)(r))return r}},nZ.technique=function(e,t){return iZ(e,"KHR_techniques_webgl")?nZ.object(e.extensions.KHR_techniques_webgl.techniques,t):nZ.topLevel(e,"techniques",t)},nZ.texture=function(e,t){return nZ.topLevel(e,"textures",t)};var rZ=nZ;var aZ=function(e){switch(e){case"SCALAR":return 1;case"VEC2":return 2;case"VEC3":return 3;case"VEC4":case"MAT2":return 4;case"MAT3":return 9;case"MAT4":return 16}};var oZ=function(e,t){var i=t.bufferView;if(Object(u.a)(i)){var n=e.bufferViews[i];if(Object(u.a)(n.byteStride)&&n.byteStride>0)return n.byteStride}return dn.getSizeInBytes(t.componentType)*aZ(t.type)};function sZ(e){Object(u.a)(e)&&(e.texCoord=Object(w.a)(e.texCoord,0))}var cZ=function(e){rZ.accessor(e,(function(e){Object(u.a)(e.bufferView)&&(e.byteOffset=Object(w.a)(e.byteOffset,0))})),rZ.bufferView(e,(function(e){Object(u.a)(e.buffer)&&(e.byteOffset=Object(w.a)(e.byteOffset,0))})),rZ.mesh(e,(function(t){rZ.meshPrimitive(t,(function(t){if(t.mode=Object(w.a)(t.mode,un.TRIANGLES),!Object(u.a)(t.material)){Object(u.a)(e.materials)||(e.materials=[]);t.material=tZ(e.materials,{name:"default"})}}))})),rZ.accessorContainingVertexAttributeData(e,(function(t){var i=e.accessors[t],n=i.bufferView;if(i.normalized=Object(w.a)(i.normalized,!1),Object(u.a)(n)){var r=e.bufferViews[n];r.byteStride=oZ(e,i),r.target=un.ARRAY_BUFFER}})),rZ.accessorContainingIndexData(e,(function(t){var i=e.accessors[t].bufferView;Object(u.a)(i)&&(e.bufferViews[i].target=un.ELEMENT_ARRAY_BUFFER)})),rZ.material(e,(function(e){var t=Object(w.a)(e.extensions,w.a.EMPTY_OBJECT),i=t.KHR_materials_common;if(Object(u.a)(i)){var n=i.technique,r=Object(u.a)(i.values)?i.values:{};return i.values=r,r.ambient=Object(u.a)(r.ambient)?r.ambient:[0,0,0,1],r.emission=Object(u.a)(r.emission)?r.emission:[0,0,0,1],r.transparency=Object(w.a)(r.transparency,1),r.transparent=Object(w.a)(r.transparent,!1),r.doubleSided=Object(w.a)(r.doubleSided,!1),void("CONSTANT"!==n&&(r.diffuse=Object(u.a)(r.diffuse)?r.diffuse:[0,0,0,1],"LAMBERT"!==n&&(r.specular=Object(u.a)(r.specular)?r.specular:[0,0,0,1],r.shininess=Object(w.a)(r.shininess,0))))}e.emissiveFactor=Object(w.a)(e.emissiveFactor,[0,0,0]),e.alphaMode=Object(w.a)(e.alphaMode,"OPAQUE"),e.doubleSided=Object(w.a)(e.doubleSided,!1),"MASK"===e.alphaMode&&(e.alphaCutoff=Object(w.a)(e.alphaCutoff,.5));var a=t.KHR_techniques_webgl;Object(u.a)(a)&&rZ.materialValue(e,(function(e){Object(u.a)(e.index)&&sZ(e)})),sZ(e.emissiveTexture),sZ(e.normalTexture),sZ(e.occlusionTexture);var o=e.pbrMetallicRoughness;Object(u.a)(o)&&(o.baseColorFactor=Object(w.a)(o.baseColorFactor,[1,1,1,1]),o.metallicFactor=Object(w.a)(o.metallicFactor,1),o.roughnessFactor=Object(w.a)(o.roughnessFactor,1),sZ(o.baseColorTexture),sZ(o.metallicRoughnessTexture));var s=t.pbrSpecularGlossiness;Object(u.a)(s)&&(s.diffuseFactor=Object(w.a)(s.diffuseFactor,[1,1,1,1]),s.specularFactor=Object(w.a)(s.specularFactor,[1,1,1]),s.glossinessFactor=Object(w.a)(s.glossinessFactor,1),sZ(s.specularGlossinessTexture))})),rZ.animation(e,(function(e){rZ.animationSampler(e,(function(e){e.interpolation=Object(w.a)(e.interpolation,"LINEAR")}))}));var t=function(e){var t={};return rZ.animation(e,(function(e){rZ.animationChannel(e,(function(e){var i=e.target,n=i.node,r=i.path;"translation"!==r&&"rotation"!==r&&"scale"!==r||(t[n]=!0)}))})),t}(e);return rZ.node(e,(function(e,i){Object(u.a)(t[i])||Object(u.a)(e.translation)||Object(u.a)(e.rotation)||Object(u.a)(e.scale)?(e.translation=Object(w.a)(e.translation,[0,0,0]),e.rotation=Object(w.a)(e.rotation,[0,0,0,1]),e.scale=Object(w.a)(e.scale,[1,1,1])):e.matrix=Object(w.a)(e.matrix,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])})),rZ.sampler(e,(function(e){e.wrapS=Object(w.a)(e.wrapS,un.REPEAT),e.wrapT=Object(w.a)(e.wrapT,un.REPEAT)})),Object(u.a)(e.scenes)&&!Object(u.a)(e.scene)&&(e.scene=0),e};function lZ(e){e.extras=Object(u.a)(e.extras)?e.extras:{},e.extras._pipeline=Object(u.a)(e.extras._pipeline)?e.extras._pipeline:{}}var uZ=function(e){return rZ.shader(e,(function(e){lZ(e)})),rZ.buffer(e,(function(e){lZ(e)})),rZ.image(e,(function(e){lZ(e),rZ.compressedImage(e,(function(e){lZ(e)}))})),lZ(e),e};var hZ=function(e,t){var i=e.extensionsRequired;if(Object(u.a)(i)){var n=i.indexOf(t);n>=0&&i.splice(n,1),0===i.length&&delete e.extensionsRequired}};var dZ=function(e,t){var i=e.extensionsUsed;if(Object(u.a)(i)){var n=i.indexOf(t);n>=0&&i.splice(n,1),hZ(e,t),0===i.length&&delete e.extensionsUsed}},fZ=4;function pZ(e,t,i){for(var n=new DataView(e.buffer),r=new Array(i),a=0;a<i;++a)r[a]=n.getUint32(e.byteOffset+t+a*fZ,!0);return r}var mZ=function(e){if("glTF"!==cy(e))throw new Ce.a("File is not valid binary glTF");var t=pZ(e,0,5),i=t[1];if(1!==i&&2!==i)throw new Ce.a("Binary glTF version is not 1 or 2");return 1===i?function(e,t){var i=t[2],n=t[3];if(0!==t[4])throw new Ce.a("Binary glTF scene format is not JSON");var r=20+n,a=is(e,20,n),o=JSON.parse(a);uZ(o);var s=e.subarray(r,i),c=o.buffers;if(Object(u.a)(c)&&Object.keys(c).length>0){var l=Object(w.a)(c.binary_glTF,c.KHR_binary_glTF);Object(u.a)(l)&&(l.extras._pipeline.source=s)}return dZ(o,"KHR_binary_glTF"),o}(e,t):function(e,t){var i,n,r=t[2],a=12;for(;a<r;){var o=pZ(e,a,2),s=o[0],c=o[1];a+=8;var l=e.subarray(a,a+s);if(a+=s,1313821514===c){var h=is(l);i=JSON.parse(h),uZ(i)}else 5130562===c&&(n=l)}if(Object(u.a)(i)&&Object(u.a)(n)){var d=i.buffers;if(Object(u.a)(d)&&d.length>0)d[0].extras._pipeline.source=n}return i}(e,t)};var _Z=function(e,t){var i=e.extensionsUsed;Object(u.a)(i)||(i=[],e.extensionsUsed=i),tZ(i,t,!0)};var gZ=function(e){switch(e){case dn.BYTE:return function(e,t,i,n,r){for(var a=0;a<i;++a)r[a]=e.getInt8(t+a*n)};case dn.UNSIGNED_BYTE:return function(e,t,i,n,r){for(var a=0;a<i;++a)r[a]=e.getUint8(t+a*n)};case dn.SHORT:return function(e,t,i,n,r){for(var a=0;a<i;++a)r[a]=e.getInt16(t+a*n,!0)};case dn.UNSIGNED_SHORT:return function(e,t,i,n,r){for(var a=0;a<i;++a)r[a]=e.getUint16(t+a*n,!0)};case dn.INT:return function(e,t,i,n,r){for(var a=0;a<i;++a)r[a]=e.getInt32(t+a*n,!0)};case dn.UNSIGNED_INT:return function(e,t,i,n,r){for(var a=0;a<i;++a)r[a]=e.getUint32(t+a*n,!0)};case dn.FLOAT:return function(e,t,i,n,r){for(var a=0;a<i;++a)r[a]=e.getFloat32(t+a*n,!0)};case dn.DOUBLE:return function(e,t,i,n,r){for(var a=0;a<i;++a)r[a]=e.getFloat64(t+a*n,!0)}}};var vZ=function(e,t){var i=e.bufferViews,n=e.buffers,r=t.bufferView,a=aZ(t.type);if(!Object(u.a)(t.bufferView))return{min:Qt(new Array(a),0),max:Qt(new Array(a),0)};for(var o=Qt(new Array(a),Number.POSITIVE_INFINITY),s=Qt(new Array(a),Number.NEGATIVE_INFINITY),c=i[r],l=n[c.buffer].extras._pipeline.source,h=t.count,d=oZ(e,t),f=t.byteOffset+c.byteOffset+l.byteOffset,p=t.componentType,m=dn.getSizeInBytes(p),_=new DataView(l.buffer),g=new Array(a),v=gZ(p),b=0;b<h;b++){v(_,f,a,m,g);for(var y=0;y<a;y++){var w=g[y];o[y]=Math.min(o[y],w),s[y]=Math.max(s[y],w)}f+=d}return{min:o,max:s}},bZ=[un.FUNC_ADD,un.FUNC_ADD],yZ=[un.ONE,un.ZERO,un.ONE,un.ZERO];function wZ(e,t){var i=e.enable;return!!Object(u.a)(i)&&i.indexOf(t)>-1}var OZ=[un.ZERO,un.ONE,un.SRC_COLOR,un.ONE_MINUS_SRC_COLOR,un.SRC_ALPHA,un.ONE_MINUS_SRC_ALPHA,un.DST_ALPHA,un.ONE_MINUS_DST_ALPHA,un.DST_COLOR,un.ONE_MINUS_DST_COLOR];function xZ(e,t){if(!Object(u.a)(e))return t;for(var i=0;i<4;i++)if(-1===OZ.indexOf(e[i]))return t;return e}var EZ=function(e){var t={},i={},n=e.techniques;return Object(u.a)(n)?(rZ.technique(e,(function(e,n){var r=e.states;if(Object(u.a)(r)){var a=i[n]={};if(wZ(r,un.BLEND)){a.alphaMode="BLEND";var o=r.functions;Object(u.a)(o)&&(Object(u.a)(o.blendEquationSeparate)||Object(u.a)(o.blendFuncSeparate))&&(t[n]={blendEquation:Object(w.a)(o.blendEquationSeparate,bZ),blendFactors:xZ(o.blendFuncSeparate,yZ)})}wZ(r,un.CULL_FACE)||(a.doubleSided=!0),delete e.states}})),Object.keys(t).length>0&&(Object(u.a)(e.extensions)||(e.extensions={}),_Z(e,"KHR_blend")),rZ.material(e,(function(e){if(Object(u.a)(e.technique)){var n=i[e.technique];rZ.objectLegacy(n,(function(t,i){e[i]=t}));var r=t[e.technique];Object(u.a)(r)&&(Object(u.a)(e.extensions)||(e.extensions={}),e.extensions.KHR_blend=r)}})),e):e};var TZ=function(e,t){var i=e.extensionsRequired;Object(u.a)(i)||(i=[],e.extensionsRequired=i),tZ(i,t,!0),_Z(e,t)};var CZ=function(e){var t=e.techniques,i={},n={};if(Object(u.a)(t)){var r={programs:[],shaders:[],techniques:[]},a=e.glExtensionsUsed;delete e.glExtensionsUsed,rZ.technique(e,(function(t,o){var s,c={name:t.name,program:void 0,attributes:{},uniforms:{}};rZ.techniqueAttribute(t,(function(e,i){s=t.parameters[e],c.attributes[i]={semantic:s.semantic}})),rZ.techniqueUniform(t,(function(e,n){s=t.parameters[e],c.uniforms[n]={count:s.count,node:s.node,type:s.type,semantic:s.semantic,value:s.value},i[e]=n}));var l=e.programs[t.program],u={name:l.name,fragmentShader:void 0,vertexShader:void 0,glExtensions:a},h=e.shaders[l.fragmentShader];u.fragmentShader=tZ(r.shaders,h,!0);var d=e.shaders[l.vertexShader];u.vertexShader=tZ(r.shaders,d,!0),c.program=tZ(r.programs,u),n[o]=tZ(r.techniques,c)})),r.techniques.length>0&&(Object(u.a)(e.extensions)||(e.extensions={}),e.extensions.KHR_techniques_webgl=r,_Z(e,"KHR_techniques_webgl"),TZ(e,"KHR_techniques_webgl"))}return rZ.material(e,(function(e){if(Object(u.a)(e.technique)){var t={technique:n[e.technique]};rZ.objectLegacy(e.values,(function(e,n){Object(u.a)(t.values)||(t.values={});var r=i[n];t.values[r]=e})),Object(u.a)(e.extensions)||(e.extensions={}),e.extensions.KHR_techniques_webgl=t}delete e.technique,delete e.values})),delete e.techniques,delete e.programs,delete e.shaders,e},SZ=["mesh","node","material","accessor","bufferView","buffer"];var AZ={accessor:"accessors",buffer:"buffers",bufferView:"bufferViews",node:"nodes",material:"materials",mesh:"meshes"};function PZ(){}function IZ(){}PZ.accessor=function(e,t){e.accessors.splice(t,1),rZ.mesh(e,(function(e){rZ.meshPrimitive(e,(function(e){rZ.meshPrimitiveAttribute(e,(function(i,n){i>t&&e.attributes[n]--})),rZ.meshPrimitiveTarget(e,(function(e){rZ.meshPrimitiveTargetAttribute(e,(function(i,n){i>t&&e[n]--}))}));var i=e.indices;Object(u.a)(i)&&i>t&&e.indices--}))})),rZ.skin(e,(function(e){Object(u.a)(e.inverseBindMatrices)&&e.inverseBindMatrices>t&&e.inverseBindMatrices--})),rZ.animation(e,(function(e){rZ.animationSampler(e,(function(e){Object(u.a)(e.input)&&e.input>t&&e.input--,Object(u.a)(e.output)&&e.output>t&&e.output--}))}))},PZ.buffer=function(e,t){e.buffers.splice(t,1),rZ.bufferView(e,(function(e){Object(u.a)(e.buffer)&&e.buffer>t&&e.buffer--}))},PZ.bufferView=function(e,t){e.bufferViews.splice(t,1),rZ.accessor(e,(function(e){Object(u.a)(e.bufferView)&&e.bufferView>t&&e.bufferView--})),rZ.shader(e,(function(e){Object(u.a)(e.bufferView)&&e.bufferView>t&&e.bufferView--})),rZ.image(e,(function(e){Object(u.a)(e.bufferView)&&e.bufferView>t&&e.bufferView--,rZ.compressedImage(e,(function(e){var i=e.bufferView;Object(u.a)(i)&&i>t&&e.bufferView--}))})),iZ(e,"KHR_draco_mesh_compression")&&rZ.mesh(e,(function(e){rZ.meshPrimitive(e,(function(e){Object(u.a)(e.extensions)&&Object(u.a)(e.extensions.KHR_draco_mesh_compression)&&e.extensions.KHR_draco_mesh_compression.bufferView>t&&e.extensions.KHR_draco_mesh_compression.bufferView--}))}))},PZ.mesh=function(e,t){e.meshes.splice(t,1),rZ.node(e,(function(e){Object(u.a)(e.mesh)&&(e.mesh>t?e.mesh--:e.mesh===t&&delete e.mesh)}))},PZ.node=function(e,t){e.nodes.splice(t,1),rZ.skin(e,(function(e){Object(u.a)(e.skeleton)&&e.skeleton>t&&e.skeleton--,e.joints=e.joints.map((function(e){return e>t?e-1:e}))})),rZ.animation(e,(function(e){rZ.animationChannel(e,(function(e){Object(u.a)(e.target)&&Object(u.a)(e.target.node)&&e.target.node>t&&e.target.node--}))})),rZ.technique(e,(function(e){rZ.techniqueUniform(e,(function(e){Object(u.a)(e.node)&&e.node>t&&e.node--}))})),rZ.node(e,(function(e){Object(u.a)(e.children)&&(e.children=e.children.filter((function(e){return e!==t})).map((function(e){return e>t?e-1:e})))})),rZ.scene(e,(function(e){e.nodes=e.nodes.filter((function(e){return e!==t})).map((function(e){return e>t?e-1:e}))}))},PZ.material=function(e,t){e.materials.splice(t,1),rZ.mesh(e,(function(e){rZ.meshPrimitive(e,(function(e){Object(u.a)(e.material)&&e.material>t&&e.material--}))}))},IZ.accessor=function(e){var t={};return rZ.mesh(e,(function(e){rZ.meshPrimitive(e,(function(e){rZ.meshPrimitiveAttribute(e,(function(e){t[e]=!0})),rZ.meshPrimitiveTarget(e,(function(e){rZ.meshPrimitiveTargetAttribute(e,(function(e){t[e]=!0}))}));var i=e.indices;Object(u.a)(i)&&(t[i]=!0)}))})),rZ.skin(e,(function(e){Object(u.a)(e.inverseBindMatrices)&&(t[e.inverseBindMatrices]=!0)})),rZ.animation(e,(function(e){rZ.animationSampler(e,(function(e){Object(u.a)(e.input)&&(t[e.input]=!0),Object(u.a)(e.output)&&(t[e.output]=!0)}))})),t},IZ.buffer=function(e){var t={};return rZ.bufferView(e,(function(e){Object(u.a)(e.buffer)&&(t[e.buffer]=!0)})),t},IZ.bufferView=function(e){var t={};return rZ.accessor(e,(function(e){Object(u.a)(e.bufferView)&&(t[e.bufferView]=!0)})),rZ.shader(e,(function(e){Object(u.a)(e.bufferView)&&(t[e.bufferView]=!0)})),rZ.image(e,(function(e){Object(u.a)(e.bufferView)&&(t[e.bufferView]=!0),rZ.compressedImage(e,(function(e){Object(u.a)(e.bufferView)&&(t[e.bufferView]=!0)}))})),iZ(e,"KHR_draco_mesh_compression")&&rZ.mesh(e,(function(e){rZ.meshPrimitive(e,(function(e){Object(u.a)(e.extensions)&&Object(u.a)(e.extensions.KHR_draco_mesh_compression)&&(t[e.extensions.KHR_draco_mesh_compression.bufferView]=!0)}))})),t},IZ.mesh=function(e){var t={};return rZ.node(e,(function(i){if(Object(u.a)(i.mesh&&Object(u.a)(e.meshes))){var n=e.meshes[i.mesh];Object(u.a)(n)&&Object(u.a)(n.primitives)&&n.primitives.length>0&&(t[i.mesh]=!0)}})),t},IZ.node=function(e){var t={};return rZ.node(e,(function(i,n){(function e(t,i){return!(Object(u.a)(i.mesh)||Object(u.a)(i.camera)||Object(u.a)(i.skin)||Object(u.a)(i.weights)||Object(u.a)(i.extras)||Object(u.a)(i.extensions)&&0!==i.extensions.length)&&(!Object(u.a)(i.children)||0===i.children.filter((function(i){return!e(t,t.nodes[i])})).length)})(e,i)||(t[n]=!0)})),rZ.skin(e,(function(e){Object(u.a)(e.skeleton)&&(t[e.skeleton]=!0),rZ.skinJoint(e,(function(e){t[e]=!0}))})),rZ.animation(e,(function(e){rZ.animationChannel(e,(function(e){Object(u.a)(e.target)&&Object(u.a)(e.target.node)&&(t[e.target.node]=!0)}))})),rZ.technique(e,(function(e){rZ.techniqueUniform(e,(function(e){Object(u.a)(e.node)&&(t[e.node]=!0)}))})),t},IZ.material=function(e){var t={};return rZ.mesh(e,(function(e){rZ.meshPrimitive(e,(function(e){Object(u.a)(e.material)&&(t[e.material]=!0)}))})),t};var DZ=function(e,t){return t=Object(w.a)(t,SZ),SZ.forEach((function(i){t.indexOf(i)>-1&&function(e,t){var i=AZ[t],n=e[i];if(Object(u.a)(n))for(var r=0,a=IZ[t](e),o=n.length,s=0;s<o;++s)a[s]||(PZ[t](e,s-r),r++)}(e,i)})),e};var jZ=function(e,t){var i={byteLength:t.length,extras:{_pipeline:{source:t}}},n={buffer:tZ(e.buffers,i),byteOffset:0,byteLength:t.length};return tZ(e.bufferViews,n)};var MZ=function(e,t){var i=oZ(e,t),n=dn.getSizeInBytes(t.componentType),r=aZ(t.type),a=t.count,o=new Array(r*a);if(!Object(u.a)(t.bufferView))return Qt(o,0),o;for(var s=e.bufferViews[t.bufferView],c=e.buffers[s.buffer].extras._pipeline.source,l=t.byteOffset+s.byteOffset+c.byteOffset,h=new DataView(c.buffer),d=new Array(r),f=gZ(t.componentType),p=0;p<a;++p){f(h,l,r,n,d);for(var m=0;m<r;++m)o[p*r+m]=d[m];l+=i}return o};function RZ(e,t,i){var n=dn.createTypedArray(i,MZ(e,t)),r=new Uint8Array(n.buffer);t.bufferView=jZ(e,r),t.componentType=i,t.byteOffset=0}var LZ=function(e){var t;return rZ.accessorWithSemantic(e,"JOINTS_0",(function(i){var n=e.accessors[i];(t=n.componentType)===un.BYTE?RZ(e,n,dn.UNSIGNED_BYTE):t!==un.UNSIGNED_BYTE&&t!==un.UNSIGNED_SHORT&&RZ(e,n,dn.UNSIGNED_SHORT)})),rZ.accessorWithSemantic(e,"WEIGHTS_0",(function(i){var n=e.accessors[i];(t=n.componentType)===un.BYTE?RZ(e,n,dn.UNSIGNED_BYTE):t===un.SHORT&&RZ(e,n,dn.UNSIGNED_SHORT)})),e},NZ={.8:function(e){Object(u.a)(e.asset)||(e.asset={});var t=e.asset;if(t.version="1.0","string"==typeof t.profile){var i=t.profile.split(" ");t.profile={api:i[0],version:i[1]}}else t.profile={};Object(u.a)(e.version)&&delete e.version;FZ(e),kZ(e),BZ(e),zZ(e),UZ(e),Object(u.a)(e.allExtensions)&&(e.extensionsUsed=e.allExtensions,delete e.allExtensions);if(Object(u.a)(e.lights)){var n=Object(w.a)(e.extensions,{});e.extensions=n;var r=Object(w.a)(n.KHR_materials_common,{});n.KHR_materials_common=r,r.lights=e.lights,delete e.lights,_Z(e,"KHR_materials_common")}},"1.0":function(e){e.asset=Object(w.a)(e.asset,{}),e.asset.version="2.0",FZ(e),function(e){var t=e.animations;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var n=t[i],r=n.parameters;if(Object(u.a)(r)){var a=n.samplers;for(var o in a)if(Object.prototype.hasOwnProperty.call(a,o)){var s=a[o];s.input=r[s.input],s.output=r[s.output]}delete n.parameters}}}(e),function(e){rZ.node(e,(function(t,i){YZ(t)&&function e(t,i){rZ.scene(t,(function(e){var t=e.nodes;if(Object(u.a)(t))for(var n=t.length;n>=0;--n)if(t[n]===i)return void t.splice(n,1)})),rZ.node(t,(function(n,r){if(Object(u.a)(n.children)){var a=n.children.indexOf(i);a>-1&&(n.children.splice(a,1),YZ(n)&&e(t,r))}})),delete t.nodes[i]}(e,i)}))}(e),function(e){var t,i,n={accessors:{},animations:{},buffers:{},bufferViews:{},cameras:{},images:{},materials:{},meshes:{},nodes:{},programs:{},samplers:{},scenes:{},shaders:{},skins:{},textures:{},techniques:{}},r={},a=e.nodes;for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(i=a[o].jointName,Object(u.a)(i)&&(r[i]=o));for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)&&Object(u.a)(n[s])){var c={},l=e[s];e[s]=VZ(l,c),n[s]=c}for(i in r)Object.prototype.hasOwnProperty.call(r,i)&&(r[i]=n.nodes[r[i]]);Object(u.a)(e.scene)&&(e.scene=n.scenes[e.scene]);rZ.bufferView(e,(function(e){Object(u.a)(e.buffer)&&(e.buffer=n.buffers[e.buffer])})),rZ.accessor(e,(function(e){Object(u.a)(e.bufferView)&&(e.bufferView=n.bufferViews[e.bufferView])})),rZ.shader(e,(function(e){var t=e.extensions;if(Object(u.a)(t)){var i=t.KHR_binary_glTF;Object(u.a)(i)&&(e.bufferView=n.bufferViews[i.bufferView],delete t.KHR_binary_glTF),0===Object.keys(t).length&&delete e.extensions}})),rZ.program(e,(function(e){Object(u.a)(e.vertexShader)&&(e.vertexShader=n.shaders[e.vertexShader]),Object(u.a)(e.fragmentShader)&&(e.fragmentShader=n.shaders[e.fragmentShader])})),rZ.technique(e,(function(e){Object(u.a)(e.program)&&(e.program=n.programs[e.program]),rZ.techniqueParameter(e,(function(e){Object(u.a)(e.node)&&(e.node=n.nodes[e.node]);var t=e.value;"string"==typeof t&&(e.value={index:n.textures[t]})}))})),rZ.mesh(e,(function(e){rZ.meshPrimitive(e,(function(e){Object(u.a)(e.indices)&&(e.indices=n.accessors[e.indices]),rZ.meshPrimitiveAttribute(e,(function(t,i){e.attributes[i]=n.accessors[t]})),Object(u.a)(e.material)&&(e.material=n.materials[e.material])}))})),rZ.node(e,(function(i){var r=i.children;if(Object(u.a)(r)){var a=r.length;for(t=0;t<a;++t)r[t]=n.nodes[r[t]]}if(Object(u.a)(i.meshes)){var o=i.meshes,s=o.length;if(s>0)for(i.mesh=n.meshes[o[0]],t=1;t<s;++t){var c={mesh:n.meshes[o[t]]},l=tZ(e.nodes,c);Object(u.a)(r)||(r=[],i.children=r),r.push(l)}delete i.meshes}if(Object(u.a)(i.camera)&&(i.camera=n.cameras[i.camera]),Object(u.a)(i.skin)&&(i.skin=n.skins[i.skin]),Object(u.a)(i.skeletons)){var h=i.skeletons;if(h.length>0&&Object(u.a)(i.skin))e.skins[i.skin].skeleton=n.nodes[h[0]];delete i.skeletons}Object(u.a)(i.jointName)&&delete i.jointName})),rZ.skin(e,(function(e){Object(u.a)(e.inverseBindMatrices)&&(e.inverseBindMatrices=n.accessors[e.inverseBindMatrices]);var i=e.jointNames;if(Object(u.a)(i)){var a=[],o=i.length;for(t=0;t<o;++t)a[t]=r[i[t]];e.joints=a,delete e.jointNames}})),rZ.scene(e,(function(e){var i=e.nodes;if(Object(u.a)(i)){var r=i.length;for(t=0;t<r;++t)i[t]=n.nodes[i[t]]}})),rZ.animation(e,(function(e){var t={};e.samplers=VZ(e.samplers,t),rZ.animationSampler(e,(function(e){e.input=n.accessors[e.input],e.output=n.accessors[e.output]})),rZ.animationChannel(e,(function(e){e.sampler=t[e.sampler];var i=e.target;Object(u.a)(i)&&(i.node=n.nodes[i.id],delete i.id)}))})),rZ.material(e,(function(e){Object(u.a)(e.technique)&&(e.technique=n.techniques[e.technique]),rZ.materialValue(e,(function(t,i){"string"==typeof t&&(e.values[i]={index:n.textures[t]})}));var t=e.extensions;if(Object(u.a)(t)){var i=t.KHR_materials_common;Object(u.a)(i)&&rZ.materialValue(i,(function(e,t){"string"==typeof e&&(i.values[t]={index:n.textures[e]})}))}})),rZ.image(e,(function(e){var t=e.extensions;if(Object(u.a)(t)){var i=t.KHR_binary_glTF;Object(u.a)(i)&&(e.bufferView=n.bufferViews[i.bufferView],e.mimeType=i.mimeType,delete t.KHR_binary_glTF),0===Object.keys(t).length&&delete e.extensions}rZ.compressedImage(e,(function(e){var i=e.extensions;if(Object(u.a)(i)){var r=i.KHR_binary_glTF;Object(u.a)(r)&&(e.bufferView=n.bufferViews[r.bufferView],e.mimeType=r.mimeType,delete i.KHR_binary_glTF),0===Object.keys(t).length&&delete e.extensions}}))})),rZ.texture(e,(function(e){Object(u.a)(e.sampler)&&(e.sampler=n.samplers[e.sampler]),Object(u.a)(e.source)&&(e.source=n.images[e.source])}))}(e),function(e){rZ.animation(e,(function(e){rZ.animationSampler(e,(function(e){delete e.name}))}))}(e),function(e){var t=e.asset;delete t.profile,delete t.premultipliedAlpha}(e),function(e){var t=e.extensionsUsed;if(e.extensionsRequired=Object(w.a)(e.extensionsRequired,[]),Object(u.a)(t))for(var i=t.length,n=0;n<i;++n){var r=t[n];Object(u.a)(HZ[r])&&e.extensionsRequired.push(r)}}(e),function(e){rZ.buffer(e,(function(e){Object(u.a)(e.byteLength)||(e.byteLength=e.extras._pipeline.source.length)})),rZ.accessor(e,(function(t){var i=t.bufferView;if(Object(u.a)(i)){var n=e.bufferViews[i],r=WZ(e,t),a=t.byteOffset+t.count*r;n.byteLength=Math.max(Object(w.a)(n.byteLength,0),a)}}))}(e),function(e){var t,i,n,r=e.bufferViews,a={};rZ.accessorContainingVertexAttributeData(e,(function(t){var i=e.accessors[t];Object(u.a)(i.bufferView)&&(a[i.bufferView]=!0)}));var o={};for(var s in rZ.accessor(e,(function(e){Object(u.a)(e.bufferView)&&(o[e.bufferView]=Object(w.a)(o[e.bufferView],[]),o[e.bufferView].push(e))})),o)if(Object.prototype.hasOwnProperty.call(o,s)){n=r[s];var c=o[s];c.sort((function(e,t){return e.byteOffset-t.byteOffset}));var l=0,h=0,d=c.length;for(t=0;t<d;++t){var f=c[t],p=WZ(e,f),m=f.byteOffset,_=f.count*p;delete f.byteStride;var g=t<d-1,v=g?WZ(e,c[t+1]):void 0;if(p!==v){var b=Object(nf.a)(n,!0);a[s]&&(b.byteStride=p),b.byteOffset+=l,b.byteLength=m+_-l;var y=tZ(r,b);for(i=h;i<=t;++i)(f=c[i]).bufferView=y,f.byteOffset=f.byteOffset-l;l=g?c[t+1].byteOffset:void 0,h=t+1}}}DZ(e,["accessor","bufferView","buffer"])}(e),function(e){rZ.accessorWithSemantic(e,"POSITION",(function(t){var i=e.accessors[t];if(!Object(u.a)(i.min)||!Object(u.a)(i.max)){var n=vZ(e,i);i.min=n.min,i.max=n.max}}))}(e),function(e){rZ.animation(e,(function(t){rZ.animationSampler(t,(function(t){var i=e.accessors[t.input];if(!Object(u.a)(i.min)||!Object(u.a)(i.max)){var n=vZ(e,i);i.min=n.min,i.max=n.max}}))}))}(e),function(e){rZ.buffer(e,(function(e){delete e.type}))}(e),function(e){rZ.texture(e,(function(e){delete e.format,delete e.internalFormat,delete e.target,delete e.type}))}(e),function(e){rZ.mesh(e,(function(e){rZ.meshPrimitive(e,(function(e){rZ.meshPrimitiveAttribute(e,(function(t,i){"TEXCOORD"===i?e.attributes.TEXCOORD_0=t:"COLOR"===i&&(e.attributes.COLOR_0=t)})),delete e.attributes.TEXCOORD,delete e.attributes.COLOR}))})),rZ.technique(e,(function(e){rZ.techniqueParameter(e,(function(e){var t=e.semantic;Object(u.a)(t)&&("TEXCOORD"===t?e.semantic="TEXCOORD_0":"COLOR"===t&&(e.semantic="COLOR_0"))}))}))}(e),function(e){var t={};rZ.mesh(e,(function(e){rZ.meshPrimitive(e,(function(e){for(var i in rZ.meshPrimitiveAttribute(e,(function(e,i){if("_"!==i.charAt(0)){var n,r=i.search(/_[0-9]+/g),a=i,o="_0";r>=0&&(a=i.substring(0,r),o=i.substring(r));var s=qZ[a];Object(u.a)(s)?(n=s+o,t[i]=n):Object(u.a)(GZ[a])||(n="_"+i,t[i]=n)}})),t)if(Object.prototype.hasOwnProperty.call(t,i)){var n=t[i],r=e.attributes[i];Object(u.a)(r)&&(delete e.attributes[i],e.attributes[n]=r)}}))})),rZ.technique(e,(function(e){rZ.techniqueParameter(e,(function(e){var i=t[e.semantic];Object(u.a)(i)&&(e.semantic=i)}))}))}(e),LZ(e),function(e){rZ.camera(e,(function(e){var t=e.perspective;if(Object(u.a)(t)){var i=t.aspectRatio;Object(u.a)(i)&&0===i&&delete t.aspectRatio;var n=t.yfov;Object(u.a)(n)&&0===n&&(t.yfov=1)}}))}(e),EZ(e),CZ(e),function(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var i=e[t];Array.isArray(i)&&0===i.length&&delete e[t]}rZ.node(e,(function(e){Object(u.a)(e.children)&&0===e.children.length&&delete e.children}))}(e)},"2.0":void 0};function FZ(e){var t=e.materials;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var n=t[i],r=n.instanceTechnique;Object(u.a)(r)&&(n.technique=r.technique,n.values=r.values,delete n.instanceTechnique)}}function kZ(e){var t=e.meshes;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var n=t[i].primitives;if(Object(u.a)(n))for(var r=n.length,a=0;a<r;++a){var o=n[a],s=Object(w.a)(o.primitive,un.TRIANGLES);o.mode=Object(w.a)(o.mode,s),delete o.primitive}}}function BZ(e){var t=e.nodes,i=new z,n=new Kn;for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var a=t[r];if(Object(u.a)(a.rotation)){var o=a.rotation;z.fromArray(o,0,i),Kn.fromAxisAngle(i,o[3],n),a.rotation=[n.x,n.y,n.z,n.w]}var s=a.instanceSkin;Object(u.a)(s)&&(a.skeletons=s.skeletons,a.skin=s.skin,a.meshes=s.meshes,delete a.instanceSkin)}}function zZ(e){var t=e.animations,i=e.accessors,n=e.bufferViews,r=e.buffers,a={},o=new z,s=new Kn;for(var c in t)if(Object.prototype.hasOwnProperty.call(t,c)){var l=t[c],h=l.channels,d=l.parameters,f=l.samplers;if(Object(u.a)(h))for(var p=h.length,m=0;m<p;++m){var _=h[m];if("rotation"===_.target.path){var g=d[f[_.sampler].output];if(Object(u.a)(a[g]))continue;a[g]=!0;for(var v=i[g],b=n[v.bufferView],y=r[b.buffer].extras._pipeline.source,w=y.byteOffset+b.byteOffset+v.byteOffset,O=v.componentType,x=v.count,E=aZ(v.type),T=v.count*E,C=dn.createArrayBufferView(O,y.buffer,w,T),S=0;S<x;S++){var A=S*E;z.unpack(C,A,o);var P=C[A+3];Kn.fromAxisAngle(o,P,s),Kn.pack(s,C,A)}}}}}function UZ(e){var t=e.techniques;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var n=t[i],r=n.passes;if(Object(u.a)(r)){var a=Object(w.a)(n.pass,"defaultPass");if(Object.prototype.hasOwnProperty.call(r,a)){var o=r[a],s=o.instanceProgram;n.attributes=Object(w.a)(n.attributes,s.attributes),n.program=Object(w.a)(n.program,s.program),n.uniforms=Object(w.a)(n.uniforms,s.uniforms),n.states=Object(w.a)(n.states,o.states)}delete n.passes,delete n.pass}}}function VZ(e,t){var i=[];for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var r=e[n];t[n]=i.length,i.push(r),Object(u.a)(r.name)||(r.name=n)}return i}var HZ={CESIUM_RTC:!0,KHR_materials_common:!0,WEB3D_quantized_attributes:!0};var GZ={POSITION:!0,NORMAL:!0,TANGENT:!0},qZ={COLOR:"COLOR",JOINT:"JOINTS",JOINTS:"JOINTS",TEXCOORD:"TEXCOORD",WEIGHT:"WEIGHTS",WEIGHTS:"WEIGHTS"};function WZ(e,t){return Object(u.a)(t.byteStride)&&0!==t.byteStride?t.byteStride:oZ(e,t)}function YZ(e){return(!Object(u.a)(e.children)||0===e.children.length)&&(!Object(u.a)(e.meshes)||0===e.meshes.length)&&!Object(u.a)(e.camera)&&!Object(u.a)(e.skin)&&!Object(u.a)(e.skeletons)&&!Object(u.a)(e.jointName)&&(!Object(u.a)(e.translation)||z.fromArray(e.translation).equals(z.ZERO))&&(!Object(u.a)(e.scale)||z.fromArray(e.scale).equals(new z(1,1,1)))&&(!Object(u.a)(e.rotation)||Te.fromArray(e.rotation).equals(new Te(0,0,0,1)))&&(!Object(u.a)(e.matrix)||Be.fromColumnMajorArray(e.matrix).equals(Be.IDENTITY))&&!Object(u.a)(e.extensions)&&!Object(u.a)(e.extras)}var XZ=function(e,t){var i=(t=Object(w.a)(t,w.a.EMPTY_OBJECT)).targetVersion,n=e.version;e.asset=Object(w.a)(e.asset,{version:"1.0"}),e.asset.version=Object(w.a)(e.asset.version,"1.0"),n=Object(w.a)(n,e.asset.version).toString(),Object.prototype.hasOwnProperty.call(NZ,n)||(Object(u.a)(n)&&(n=n.substring(0,3)),Object.prototype.hasOwnProperty.call(NZ,n)||(n="1.0"));for(var r=NZ[n];Object(u.a)(r)&&n!==i;)r(e,t),n=e.asset.version,r=NZ[n];return e};function ZZ(){this.initialized=!1,this.resourcesParsed=!1,this.vertexBuffersToCreate=new xp,this.indexBuffersToCreate=new xp,this.buffers={},this.pendingBufferLoads=0,this.programsToCreate=new xp,this.shaders={},this.pendingShaderLoads=0,this.texturesToCreate=new xp,this.pendingTextureLoads=0,this.texturesToCreateFromBufferView=new xp,this.pendingBufferViewToImage=0,this.createSamplers=!0,this.createSkins=!0,this.createRuntimeAnimations=!0,this.createVertexArrays=!0,this.createRenderStates=!0,this.createUniformMaps=!0,this.createRuntimeNodes=!0,this.createdBufferViews={},this.primitivesToDecode=new xp,this.activeDecodingTasks=0,this.pendingDecodingCache=!1,this.skinnedNodesIds=[]}ZZ.prototype.getBuffer=function(e){return t=this.buffers[e.buffer],i=e.byteOffset,n=e.byteLength,t.subarray(i,i+n);var t,i,n},ZZ.prototype.finishedPendingBufferLoads=function(){return 0===this.pendingBufferLoads},ZZ.prototype.finishedBuffersCreation=function(){return 0===this.pendingBufferLoads&&0===this.vertexBuffersToCreate.length&&0===this.indexBuffersToCreate.length},ZZ.prototype.finishedProgramCreation=function(){return 0===this.pendingShaderLoads&&0===this.programsToCreate.length},ZZ.prototype.finishedTextureCreation=function(){var e=0===this.pendingTextureLoads,t=0===this.texturesToCreate.length&&0===this.texturesToCreateFromBufferView.length;return e&&t},ZZ.prototype.finishedEverythingButTextureCreation=function(){var e=0===this.pendingBufferLoads&&0===this.pendingShaderLoads,t=0===this.vertexBuffersToCreate.length&&0===this.indexBuffersToCreate.length&&0===this.programsToCreate.length&&0===this.pendingBufferViewToImage;return this.finishedDecoding()&&e&&t},ZZ.prototype.finishedDecoding=function(){return 0===this.primitivesToDecode.length&&0===this.activeDecodingTasks&&!this.pendingDecodingCache},ZZ.prototype.finished=function(){return this.finishedDecoding()&&this.finishedTextureCreation()&&this.finishedEverythingButTextureCreation()};var QZ=ZZ,KZ="uniform mat4 u_planishMVPMatrix;\nuniform sampler2D u_planishInfoTexture;\nuniform vec3 u_planeCenter;\nvoid transformPlanishModel()\n{\nvec4 planishPositon = vec4(real_position, 1.0);\nvec4 projectionCoord = u_planishMVPMatrix * planishPositon;\nvec2 planishInfoUV = projectionCoord.xy / projectionCoord.w;\nplanishInfoUV = planishInfoUV * 0.5 + 0.5;\nvec4 planishInfo = texture2D(u_planishInfoTexture, planishInfoUV);\nif(length(planishInfo) > 0.0 && planishInfo.w > 0.0)\n{\nreal_position.z = u_planeCenter.z + planishInfo.y;\n}\n}\n",JZ={updateForwardAxis:function(e){var t=e.gltf.extras.sourceVersion;(Object(u.a)(t)&&"2.0"!==t||"2.0"!==JZ.getAssetVersion(e.gltf))&&(e._gltfForwardAxis=mX.X)},getAssetVersion:function(e){return Object(u.a)(e.asset)&&Object(u.a)(e.asset.version)?e.asset.version:"1.0"},splitIncompatibleMaterials:function(e){var t=e.accessors,i=e.materials,n={};return rZ.mesh(e,(function(e){rZ.meshPrimitive(e,(function(e){var r,a,o=e.material,s=i[o],c=e.attributes.JOINTS_0;if(Object(u.a)(c)){var l=t[c];r=l.componentType,a=l.type}var h=Object(u.a)(c),d=Object(u.a)(e.attributes.COLOR_0),f=Object(u.a)(e.targets),p=Object(u.a)(e.attributes.NORMAL),m=Object(u.a)(e.attributes.TANGENT),_=Object(u.a)(e.attributes.TEXCOORD_0),g=!1;Object(u.a)(s.extras)&&Object(u.a)(s.extras.use_texture_pbrmat)&&(g=s.extras.use_texture_pbrmat);var v=n[o];if(Object(u.a)(v)){if(v.skinning.skinned!==h||v.skinning.type!==a||v.hasVertexColors!==d||v.hasMorphTargets!==f||v.hasNormals!==p||v.hasTangents!==m||v.hasCombineMaterial!==g||v.hasTexCoords!==_){var b=Object(nf.a)(s,!0);o=tZ(i,b),e.material=o,n[o]={skinning:{skinned:h,componentType:r,type:a},hasVertexColors:d,hasMorphTargets:f,hasNormals:p,hasTangents:m,hasTexCoords:_,hasCombineMaterial:g}}}else n[o]={skinning:{skinned:h,componentType:r,type:a},hasVertexColors:d,hasMorphTargets:f,hasNormals:p,hasTangents:m,hasTexCoords:_,hasCombineMaterial:g}}))})),n},getShaderVariable:function(e){return"SCALAR"===e?"float":e.toLowerCase()},ModelState:{NEEDS_LOAD:0,LOADING:1,LOADED:2,FAILED:3},getFailedLoadFunction:function(e,t,i){return function(n){e._state=JZ.ModelState.FAILED;var r="Failed to load "+t+": "+i;Object(u.a)(n)&&(r+="\n"+n.message),e._readyPromise.reject(new Ce.a(r))}},parseBuffers:function(e,t){var i=e._loadResources;rZ.buffer(e.gltf,(function(n,r){if(Object(u.a)(n.extras._pipeline.source))i.buffers[r]=n.extras._pipeline.source;else if(Object(u.a)(t)){var a=e._resource.getDerivedResource({url:n.uri});++i.pendingBufferLoads,a.fetchArrayBuffer().then(t(e,r)).otherwise(JZ.getFailedLoadFunction(e,"buffer",a.url))}}))}},$Z=new z,eQ=new z;function tQ(e,t){return rZ.techniqueAttribute(e,(function(e,i){if(e.semantic===t)return i}))}function iQ(e,t,i,n){return iZ(e,"KHR_techniques_webgl")?function(e,t){if(!(e.semantic!==i||n&&Object(u.a)(e.node)))return t}:function(e,r){var a=t.parameters[e];if(!(a.semantic!==i||n&&Object(u.a)(a.node)))return r}}JZ.computeBoundingSphere=function(e){for(var t=e.gltf,i=t.nodes,n=t.meshes,r=t.scenes[t.scene].nodes,a=r.length,o=[],s=new z(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),c=new z(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE),l=0;l<a;++l){var h=i[r[l]];for(h._transformToRoot=JZ.getTransform(h),o.push(h);o.length>0;){var d=(h=o.pop())._transformToRoot,f=h.mesh;if(Object(u.a)(f))for(var p=n[f].primitives,m=p.length,_=0;_<m;++_){var g=p[_].attributes.POSITION;if(Object(u.a)(g)){var v=JZ.getAccessorMinMax(t,g),b=z.fromArray(v.min,0,$Z),y=z.fromArray(v.max,0,eQ);Object(u.a)(s)&&Object(u.a)(c)&&(Be.multiplyByPoint(d,b,b),Be.multiplyByPoint(d,y,y),z.minimumByComponent(s,b,s),z.maximumByComponent(c,y,c))}}var w=h.children;if(Object(u.a)(w))for(var O=w.length,x=0;x<O;++x){var E=i[w[x]];E._transformToRoot=JZ.getTransform(E),Be.multiplyTransformation(d,E._transformToRoot,E._transformToRoot),o.push(E)}delete h._transformToRoot}}var T=St.fromCornerPoints(s,c);return e._forwardAxis===mX.Z&&St.transformWithoutScale(T,mX.Z_UP_TO_X_UP,T),e._upAxis===mX.Y?St.transformWithoutScale(T,mX.Y_UP_TO_Z_UP,T):e._upAxis===mX.X&&St.transformWithoutScale(T,mX.X_UP_TO_Z_UP,T),T},JZ.ensureSemanticExistence=function(e){return rZ.mesh(e,(function(t){rZ.meshPrimitive(t,(function(t){!function(e,t){var i=e.accessors,n=e.materials,r=e.extensions.KHR_techniques_webgl,a=r.techniques,o=r.programs,s=r.shaders,c=t.targets,l=t.attributes;for(var h in c)if(c.hasOwnProperty(h)){var d=c[h];for(var f in d)"extras"!==f&&(l[f+"_"+h]=d[f])}var p=a[n[t.material].extensions.KHR_techniques_webgl.technique],m=s[o[p.program].vertexShader];for(var _ in l)if(l.hasOwnProperty(_)&&!Object(u.a)(tQ(p,_))){var g=i[l[_]],v=_.toLowerCase();"_"===v.charAt(0)&&(v=v.slice(1));var b="a_"+v;p.attributes[b]={semantic:_,type:g.componentType};var y=m.extras._pipeline,w=y.source;w="attribute "+JZ.getShaderVariable(g.type)+" "+b+";\n"+w,y.source=w}}(e,t)}))})),e},JZ.createAttributeLocations=function(e,t){var i={},n=!1,r=1;if(rZ.techniqueAttribute(e,(function(e,t){/pos/i.test(t)&&!n?(i[t]=0,n=!0):i[t]=r++})),Object(u.a)(t))for(var a in t)t.hasOwnProperty(a)&&(i[a]=r++);return i},JZ.getAccessorMinMax=function(e,t){var i=e.accessors[t],n=i.extensions,r=i.min,a=i.max;if(Object(u.a)(n)){var o=n.WEB3D_quantized_attributes;Object(u.a)(o)&&(r=o.decodedMin,a=o.decodedMax)}return{min:r,max:a}},JZ.getAttributeOrUniformBySemantic=function(e,t,i,n){return rZ.technique(e,(function(r){if(!Object(u.a)(i)||r.program===i){var a=rZ.techniqueAttribute(r,iQ(e,r,t,n));return Object(u.a)(a)?a:rZ.techniqueUniform(r,iQ(e,r,t,n))}}))},JZ.getDiffuseAttributeOrUniform=function(e,t){var i=JZ.getAttributeOrUniformBySemantic(e,"COLOR_0",t);return Object(u.a)(i)||(i=JZ.getAttributeOrUniformBySemantic(e,"_3DTILESDIFFUSE",t)),i};var nQ=new z,rQ=new Kn,aQ=new z;function oQ(e,t,i){t+="(?!\\w)",t=new RegExp(t,"g");var n=e.search(t);return e.replace(t,(function(e,t){return n===t?e:i}))}function sQ(e,t){var i=e.accessors[t].extensions;if(Object(u.a)(i))return i.WEB3D_quantized_attributes}function cQ(e,t,i){var n=t.material,r=e.materials[n];if(iZ(e,"KHR_techniques_webgl")&&Object(u.a)(r.extensions)&&Object(u.a)(r.extensions.KHR_techniques_webgl)){var a=r.extensions.KHR_techniques_webgl.technique,o=e.extensions.KHR_techniques_webgl.techniques[a];return rZ.techniqueAttribute(o,(function(e,t){if(e.semantic===i)return t}))}}function lQ(e){var t={value:e,clone:function(e,t){return e},func:function(){return t.value}};return t}function uQ(e){var t={value:Rt.fromArray(e),clone:Rt.clone,func:function(){return t.value}};return t}function hQ(e){var t={value:z.fromArray(e),clone:z.clone,func:function(){return t.value}};return t}function dQ(e){var t={value:Te.fromArray(e),clone:Te.clone,func:function(){return t.value}};return t}function fQ(e){var t={value:vn.fromColumnMajorArray(e),clone:vn.clone,func:function(){return t.value}};return t}function pQ(e){var t={value:be.fromColumnMajorArray(e),clone:be.clone,func:function(){return t.value}};return t}function mQ(e){var t={value:Be.fromColumnMajorArray(e),clone:Be.clone,func:function(){return t.value}};return t}function _Q(e,t,i){this._value=void 0,this._textureId=e.index,this._textures=t,this._defaultTexture=i}JZ.getTransform=function(e,t){return Object(u.a)(e.matrix)?Be.fromColumnMajorArray(e.matrix,t):Be.fromTranslationQuaternionRotationScale(z.fromArray(e.translation,0,nQ),Kn.unpack(e.rotation,0,rQ),z.fromArray(e.scale,0,aQ),t)},JZ.getUsedExtensions=function(e){var t=e.extensionsUsed,i={};if(Object(u.a)(t))for(var n=t.length,r=0;r<n;r++){i[t[r]]=!0}return i},JZ.getRequiredExtensions=function(e){var t=e.extensionsRequired,i={};if(Object(u.a)(t))for(var n=t.length,r=0;r<n;r++){i[t[r]]=!0}return i},JZ.supportedExtensions={CESIUM_RTC:!0,KHR_blend:!0,KHR_binary_glTF:!0,KHR_draco_mesh_compression:!0,KHR_materials_common:!0,KHR_techniques_webgl:!0,KHR_materials_unlit:!0,KHR_materials_pbrSpecularGlossiness:!0,WEB3D_quantized_attributes:!0,EXT_texture_webp:!0},JZ.checkSupportedExtensions=function(e,t){for(var i in e)if(e.hasOwnProperty(i)){if(!JZ.supportedExtensions[i])throw new Ce.a("Unsupported glTF Extension: "+i);if("EXT_texture_webp"===i&&!1===t)throw new Ce.a("Loaded model requires WebP but browser does not support it.")}},JZ.checkSupportedGlExtensions=function(e,t){if(Object(u.a)(e))for(var i=e.length,n=0;n<i;n++){var r=e[n];if("OES_element_index_uint"!==r)throw new Ce.a("Unsupported WebGL Extension: "+r);if(!t.elementIndexUint)throw new Ce.a("OES_element_index_uint WebGL extension is not enabled.")}},JZ.modifyShaderForPositionAttributes=function(e,t){var i="a_position";Object(u.a)(e)&&(i=JZ.getAttributeOrUniformBySemantic(e,"POSITION")),t=oQ(t,i,"real_position");var n="void main() {\n    real_position = transformInstancePosition("+i+");\n    #ifdef MODEL_PLANISH\n       transformPlanishModel();\n    #endif\n    lunban_main();\n}\n";return n="\n"+KZ+"\n"+n,t=UN.replaceMain(t,"lunban_main"),t+=n},JZ.modifyShaderForDracoQuantizedAttributes=function(e,t,i,n){var r={};for(var a in n)if(n.hasOwnProperty(a)){var o=n[a],s=o.quantization;if(!Object(u.a)(s))continue;var c=cQ(e,t,a);"_"===a.charAt(0)&&(a=a.substring(1));var l="gltf_u_dec_"+a.toLowerCase();if(!Object(u.a)(r[l])){var h,d="gltf_decoded_"+a,f=c.replace("a_","gltf_a_dec_"),p=o.componentsPerAttribute;i=oQ(i,c,f),i=(h=s.octEncoded?"vec3":p>1?"vec"+p:"float")+" "+f+";\n"+i;var m="";if(s.octEncoded){var _=l+"_rangeConstant";i="uniform float "+_+";\n"+i,m="\nvoid main() {\n    "+f+" = czm_octDecode("+c+".xy, "+_+").zxy;\n    "+d+"();\n}\n"}else{var g=l+"_normConstant",v=l+"_min";i="uniform float "+g+";\nuniform "+h+" "+v+";\n"+i,m+="\nvoid main() {\n    "+f+" = "+v+" + "+c+" * "+g+";\n    "+d+"();\n}\n"}i=UN.replaceMain(i,d),i+=m}}return{shader:i}},JZ.modifyShaderForQuantizedAttributes=function(e,t,i){var n={},r=t.attributes;for(var a in r)if(r.hasOwnProperty(a)){var o=cQ(e,t,a),s=t.attributes[a];"_"===a.charAt(0)&&(a=a.substring(1));var c="gltf_u_dec_"+a.toLowerCase(),l=c+"_scale",h=c+"_translate";if(!Object(u.a)(n[c])&&!Object(u.a)(n[l])){var d=sQ(e,s);if(Object(u.a)(d)){var f,p=d.decodeMatrix,m="gltf_decoded_"+a,_=o.replace("a_","gltf_a_dec_"),g=Math.floor(Math.sqrt(p.length));i=(f=g>2?"vec"+(g-1):"float")+" "+_+";\n"+(i=oQ(i,o,_));var v="";5===g?(i="uniform vec4 "+h+";\n"+(i="uniform mat4 "+l+";\n"+i),v="\nvoid main() {\n    "+_+" = "+l+" * "+o+" + "+h+";\n    "+m+"();\n}\n",n[l]={mat:4},n[h]={vec:4}):(i="uniform mat"+g+" "+c+";\n"+i,v="\nvoid main() {\n    "+_+" = "+f+"("+c+" * vec"+g+"("+o+",1.0));\n    "+m+"();\n}\n",n[c]={mat:g}),i=UN.replaceMain(i,m),i+=v}}}return{shader:i,uniforms:n}},JZ.toClipCoordinatesGLSL=function(e,t){var i=JZ.getAttributeOrUniformBySemantic(e,"POSITION"),n=i.replace("a_","gltf_a_dec_");-1!==t.indexOf(n)&&(i=n);var r=JZ.getAttributeOrUniformBySemantic(e,"MODELVIEWPROJECTION",void 0,!0);if(!Object(u.a)(r)||-1===t.indexOf(r)){var a=JZ.getAttributeOrUniformBySemantic(e,"PROJECTION",void 0,!0),o=JZ.getAttributeOrUniformBySemantic(e,"MODELVIEW",void 0,!0);-1!==t.indexOf("czm_instanced_modelView ")?o="czm_instanced_modelView":Object(u.a)(o)||(o=JZ.getAttributeOrUniformBySemantic(e,"CESIUM_RTC_MODELVIEW",void 0,!0)),r=a+" * "+o}return r+" * vec4("+i+".xyz, 1.0)"},JZ.modifyFragmentShaderForLogDepth=function(e){return e=UN.replaceMain(e,"czm_depth_main"),e+="\nvoid main() \n{ \n    czm_depth_main(); \n    czm_writeLogDepth(); \n} \n"},JZ.modifyVertexShaderForLogDepth=function(e,t){return e=UN.replaceMain(e,"czm_depth_main"),e+="\nvoid main() \n{ \n    czm_depth_main(); \n    czm_vertexLogDepth("+t+"); \n} \n"},Object(O.a)(_Q.prototype,{value:{get:function(){if(!Object(u.a)(this._value)){var e=this._textures[this._textureId];if(!Object(u.a)(e))return this._defaultTexture;this._value=e}return this._value},set:function(e){this._value=e}}}),_Q.prototype.clone=function(e){return e},_Q.prototype.func=void 0;var gQ={};function vQ(e){return[e[20],e[21],e[22],e[23]]}gQ[un.FLOAT]=lQ,gQ[un.FLOAT_VEC2]=uQ,gQ[un.FLOAT_VEC3]=hQ,gQ[un.FLOAT_VEC4]=dQ,gQ[un.INT]=lQ,gQ[un.INT_VEC2]=uQ,gQ[un.INT_VEC3]=hQ,gQ[un.INT_VEC4]=dQ,gQ[un.BOOL]=lQ,gQ[un.BOOL_VEC2]=uQ,gQ[un.BOOL_VEC3]=hQ,gQ[un.BOOL_VEC4]=dQ,gQ[un.FLOAT_MAT2]=fQ,gQ[un.FLOAT_MAT3]=pQ,gQ[un.FLOAT_MAT4]=mQ,gQ[un.SAMPLER_2D]=function(e,t,i){var n=new _Q(e,t,i);return n.func=function(){return n.value},n},JZ.createUniformFunction=function(e,t,i,n){return gQ[e](t,i,n)},JZ.createUniformsForDracoQuantizedAttributes=function(e){var t={};for(var i in e)if(e.hasOwnProperty(i)){var n=e[i],r=n.quantization;if(!Object(u.a)(r))continue;"_"===i.charAt(0)&&(i=i.substring(1));var a="gltf_u_dec_"+i.toLowerCase();if(r.octEncoded){var o=a+"_rangeConstant",s=(1<<r.quantizationBits)-1;t[o]=lQ(s).func;continue}var c=a+"_normConstant",l=r.range/(1<<r.quantizationBits);t[c]=lQ(l).func;var h=a+"_min";switch(n.componentsPerAttribute){case 1:t[h]=lQ(r.minValues).func;break;case 2:t[h]=uQ(r.minValues).func;break;case 3:t[h]=hQ(r.minValues).func;break;case 4:t[h]=dQ(r.minValues).func}}return t},JZ.createUniformsForQuantizedAttributes=function(e,t,i){var n,r=e.accessors,a={},o={},s=t.attributes;for(var c in s)if(s.hasOwnProperty(c)){var l=r[s[c]],h=l.extensions;if("_"===c.charAt(0)&&(c=c.substring(1)),Object(u.a)(h)){var d=h.WEB3D_quantized_attributes;if(Object(u.a)(d)){var f=d.decodeMatrix,p="gltf_u_dec_"+c.toLowerCase();switch(l.type){case _X.SCALAR:o[p]=fQ(f).func,a[p]=!0;break;case _X.VEC2:o[p]=pQ(f).func,a[p]=!0;break;case _X.VEC3:o[p]=mQ(f).func,a[p]=!0;break;case _X.VEC4:var m=p+"_scale",_=p+"_translate";o[m]=mQ((n=f,[n[0],n[1],n[2],n[3],n[5],n[6],n[7],n[8],n[10],n[11],n[12],n[13],n[15],n[16],n[17],n[18]])).func,o[_]=dQ(vQ(f)).func,a[m]=!0,a[_]=!0}}}}for(var g in i)if(i.hasOwnProperty(g)&&!a[g]){var v=i[g];Object(u.a)(v.mat)&&(2===v.mat?o[g]=fQ(vn.IDENTITY).func:3===v.mat?o[g]=pQ(be.IDENTITY).func:4===v.mat&&(o[g]=mQ(Be.IDENTITY).func)),Object(u.a)(v.vec)&&4===v.vec&&(o[g]=dQ([0,0,0,0]).func)}return o};var bQ=new z,yQ={MODEL:function(e,t){return function(){return e.model}},VIEW:function(e,t){return function(){return e.view}},PROJECTION:function(e,t){return function(){return e.projection}},MODELVIEW:function(e,t){return function(){return e.modelView}},CESIUM_RTC_MODELVIEW:function(e,t){var i=new Be;return function(){return Object(u.a)(t._rtcCenter)?(Be.getTranslation(e.model,bQ),z.add(bQ,t._rtcCenter,bQ),Be.multiplyByPoint(e.view,bQ,bQ),Be.setTranslation(e.modelView,bQ,i)):e.modelView}},MODELVIEWPROJECTION:function(e,t){return function(){return e.modelViewProjection}},MODELINVERSE:function(e,t){return function(){return e.inverseModel}},VIEWINVERSE:function(e,t){return function(){return e.inverseView}},PROJECTIONINVERSE:function(e,t){return function(){return e.inverseProjection}},MODELVIEWINVERSE:function(e,t){return function(){return e.inverseModelView}},MODELVIEWPROJECTIONINVERSE:function(e,t){return function(){return e.inverseModelViewProjection}},MODELINVERSETRANSPOSE:function(e,t){return function(){return e.inverseTransposeModel}},MODELVIEWINVERSETRANSPOSE:function(e,t){return function(){return e.normal}},VIEWPORT:function(e,t){return function(){return e.viewportCartesian4}}};JZ.getGltfSemanticUniforms=function(){return yQ};var wQ=JZ;function OQ(e,t){var i;switch(i=Object(u.a)(t.value)?t.value:Object(u.a)(t.index)?[t.index]:t,e){case"ambient":case"diffuse":case"emission":case"specular":return 1===i.length?un.SAMPLER_2D:un.FLOAT_VEC4;case"shininess":case"transparency":return un.FLOAT;case"transparent":case"doubleSided":return un.BOOL}}var xQ=function(e,t){if(t=Object(w.a)(t,{}),Object(u.a)(e)&&iZ(e,"KHR_materials_common")){iZ(e,"KHR_techniques_webgl")||(Object(u.a)(e.extensions)||(e.extensions={}),e.extensions.KHR_techniques_webgl={programs:[],shaders:[],techniques:[]},e.extensionsUsed.push("KHR_techniques_webgl"),e.extensionsRequired.push("KHR_techniques_webgl"));var i=e.extensions.KHR_techniques_webgl;!function(e){var t=e.extensions.KHR_materials_common;if(!Object(u.a)(t)||!Object(u.a)(t.lights))return;for(var i=t.lights,n=i.length,r=0;r<n;r++){var a=i[r];if("ambient"===a.type){Object(u.a)(a.ambient)||(a.ambient={});var o=a.ambient;Object(u.a)(o.color)||(o.color=[1,1,1])}else if("directional"===a.type){Object(u.a)(a.directional)||(a.directional={});var s=a.directional;Object(u.a)(s.color)||(s.color=[1,1,1])}else if("point"===a.type){Object(u.a)(a.point)||(a.point={});var c=a.point;Object(u.a)(c.color)||(c.color=[1,1,1]),c.constantAttenuation=Object(w.a)(c.constantAttenuation,1),c.linearAttenuation=Object(w.a)(c.linearAttenuation,0),c.quadraticAttenuation=Object(w.a)(c.quadraticAttenuation,0)}else if("spot"===a.type){Object(u.a)(a.spot)||(a.spot={});var l=a.spot;Object(u.a)(l.color)||(l.color=[1,1,1]),l.constantAttenuation=Object(w.a)(l.constantAttenuation,1),l.fallOffAngle=Object(w.a)(l.fallOffAngle,3.14159265),l.fallOffExponent=Object(w.a)(l.fallOffExponent,0),l.linearAttenuation=Object(w.a)(l.linearAttenuation,0),l.quadraticAttenuation=Object(w.a)(l.quadraticAttenuation,0)}}}(e);var n=function(e){var t,i={};Object(u.a)(e.extensions)&&Object(u.a)(e.extensions.KHR_materials_common)&&(t=e.extensions.KHR_materials_common.lights);if(Object(u.a)(t)){var n=e.nodes;for(var r in n)if(n.hasOwnProperty(r)){var a=n[r];if(Object(u.a)(a.extensions)&&Object(u.a)(a.extensions.KHR_materials_common)){var o=a.extensions.KHR_materials_common.light;Object(u.a)(o)&&Object(u.a)(t[o])&&(t[o].node=r),delete a.extensions.KHR_materials_common}}var s=0;for(var c in t)if(t.hasOwnProperty(c)){var l=t[c],h=l.type;if("ambient"!==h&&!Object(u.a)(l.node)){delete t[c];continue}var d="light"+s.toString();switch(l.baseName=d,h){case"ambient":var f=l.ambient;i[d+"Color"]={type:un.FLOAT_VEC3,value:f.color};break;case"directional":var p=l.directional;i[d+"Color"]={type:un.FLOAT_VEC3,value:p.color},Object(u.a)(l.node)&&(i[d+"Transform"]={node:l.node,semantic:"MODELVIEW",type:un.FLOAT_MAT4});break;case"point":var m=l.point;i[d+"Color"]={type:un.FLOAT_VEC3,value:m.color},Object(u.a)(l.node)&&(i[d+"Transform"]={node:l.node,semantic:"MODELVIEW",type:un.FLOAT_MAT4}),i[d+"Attenuation"]={type:un.FLOAT_VEC3,value:[m.constantAttenuation,m.linearAttenuation,m.quadraticAttenuation]};break;case"spot":var _=l.spot;i[d+"Color"]={type:un.FLOAT_VEC3,value:_.color},Object(u.a)(l.node)&&(i[d+"Transform"]={node:l.node,semantic:"MODELVIEW",type:un.FLOAT_MAT4},i[d+"InverseTransform"]={node:l.node,semantic:"MODELVIEWINVERSE",type:un.FLOAT_MAT4,useInFragment:!0}),i[d+"Attenuation"]={type:un.FLOAT_VEC3,value:[_.constantAttenuation,_.linearAttenuation,_.quadraticAttenuation]},i[d+"FallOff"]={type:un.FLOAT_VEC2,value:[_.fallOffAngle,_.fallOffExponent]}}++s}}return i}(e),r=wQ.splitIncompatibleMaterials(e),a={},o=!1;return rZ.material(e,(function(s,c){if(Object(u.a)(s.extensions)&&Object(u.a)(s.extensions.KHR_materials_common)){var l=s.extensions.KHR_materials_common,h=r[c],d=function(e,t){var i="";i+="technique:"+e.technique+";";for(var n=e.values,r=Object.keys(n).sort(),a=r.length,o=0;o<a;++o){var s=r[o];n.hasOwnProperty(s)&&(i+=s+":"+OQ(s,n[s]),i+=";")}var c=Object(w.a)(e.jointCount,0);if(i+=c.toString()+";",Object(u.a)(t)){var l=t.skinning;c>0&&(i+=l.type+";"),i+=t.hasVertexColors}return i}(l,h),f=a[d];Object(u.a)(f)||(f=function(e,t,i,n,r,a){Object(u.a)(n)||(n={});a=Object(w.a)(a,!1);var o,s=t.techniques,c=t.shaders,l=t.programs,h=n.technique.toUpperCase();Object(u.a)(e.extensions)&&Object(u.a)(e.extensions.KHR_materials_common)&&(o=e.extensions.KHR_materials_common.lights);var d,f=n.values,p=Object(w.a)(n.jointCount,0),m=!1,_=!1;Object(u.a)(i)&&(d=i.skinning,m=d.skinned,_=i.hasVertexColors);var g,v="precision highp float;\n",b="precision highp float;\n",y="CONSTANT"!==h,O={u_modelViewMatrix:{semantic:iZ(e,"CESIUM_RTC")?"CESIUM_RTC_MODELVIEW":"MODELVIEW",type:un.FLOAT_MAT4},u_projectionMatrix:{semantic:"PROJECTION",type:un.FLOAT_MAT4}};y&&(O.u_normalMatrix={semantic:"MODELVIEWINVERSETRANSPOSE",type:un.FLOAT_MAT3});m&&(O.u_jointMatrix={count:p,semantic:"JOINTMATRIX",type:un.FLOAT_MAT4});var x=!1;for(var E in f)if(f.hasOwnProperty(E)&&"transparent"!==E&&"doubleSided"!==E){var T=OQ(E,f[E]);g="u_"+E.toLowerCase(),x||T!==un.SAMPLER_2D||(x=!0),O[g]={type:T}}Object(u.a)(O.u_diffuse)&&(O.u_diffuse.semantic="_3DTILESDIFFUSE");if(Object(u.a)(r))for(var C in r)r.hasOwnProperty(C)&&(O[g="u_"+C]=r[C]);for(g in O)if(O.hasOwnProperty(g)){var S=O[g],A=Object(u.a)(S.count)?"["+S.count+"]":"";S.type!==un.FLOAT_MAT3&&S.type!==un.FLOAT_MAT4||S.useInFragment?(b+="uniform "+VI(S.type)+" "+g+A+";\n",delete S.useInFragment):v+="uniform "+VI(S.type)+" "+g+A+";\n"}var P="";if(m){var I,D,j=aZ(d.type),M=!1;if(0===d.type.indexOf("MAT")&&(M=!0,j=Math.sqrt(j)),M)for(I=0;I<j;I++)for(D=0;D<j;D++)P+=0===I&&0===D?"  mat4 skinMat = ":"  skinMat += ",P+="a_weight["+I+"]["+D+"] * u_jointMatrix[int(a_joint["+I+"]["+D+"])];\n";else for(I=0;I<j;I++)P+=0===I?"  mat4 skinMat = ":"  skinMat += ",P+="a_weight["+I+"] * u_jointMatrix[int(a_joint["+I+"])];\n"}var R,L={a_position:{semantic:"POSITION"}};v+="attribute vec3 a_position;\n",v+="varying vec3 v_positionEC;\n",P+=m?"  vec4 pos = u_modelViewMatrix * skinMat * vec4(a_position,1.0);\n":"  vec4 pos = u_modelViewMatrix * vec4(a_position,1.0);\n";P+="  v_positionEC = pos.xyz;\n",P+="  gl_Position = u_projectionMatrix * pos;\n",b+="varying vec3 v_positionEC;\n",y&&(L.a_normal={semantic:"NORMAL"},v+="attribute vec3 a_normal;\n",v+="varying vec3 v_normal;\n",P+=m?"  v_normal = u_normalMatrix * mat3(skinMat) * a_normal;\n":"  v_normal = u_normalMatrix * a_normal;\n",b+="varying vec3 v_normal;\n");x&&(L.a_texcoord_0={semantic:"TEXCOORD_0"},v+="attribute vec2 a_texcoord_0;\n",v+="varying vec2 "+(R="v_texcoord_0")+";\n",P+="  "+R+" = a_texcoord_0;\n",b+="varying vec2 "+R+";\n");if(m){var N=wQ.getShaderVariable(d.type);L.a_joint={semantic:"JOINT"},L.a_weight={semantic:"WEIGHT"},v+="attribute "+N+" a_joint;\n",v+="attribute "+N+" a_weight;\n"}_&&(L.a_vertexColor={semantic:"COLOR_0"},v+="attribute vec4 a_vertexColor;\n",v+="varying vec4 v_vertexColor;\n",P+="  v_vertexColor = a_vertexColor;\n",b+="varying vec4 v_vertexColor;\n");a&&(L.a_batchId={semantic:"_BATCHID"},v+="attribute float a_batchId;\n");var F=y&&("BLINN"===h||"PHONG"===h)&&Object(u.a)(O.u_specular)&&Object(u.a)(O.u_shininess)&&O.u_shininess>0,k=!1,B=!1,z="";for(var U in o)if(o.hasOwnProperty(U)){var V=o[U],H=V.type.toLowerCase(),G=V.baseName;z+="  {\n";var q,W,Y="u_"+G+"Color";"ambient"===H?(B=!0,z+="    ambientLight += "+Y+";\n"):y&&(k=!0,q="v_"+G+"Direction",W="v_"+G+"Position","point"!==H&&(v+="varying vec3 "+q+";\n",b+="varying vec3 "+q+";\n",P+="  "+q+" = mat3(u_"+G+"Transform) * vec3(0.,0.,1.);\n","directional"===H&&(z+="    vec3 l = normalize("+q+");\n")),"directional"!==H?(v+="varying vec3 "+W+";\n",b+="varying vec3 "+W+";\n",P+="  "+W+" = u_"+G+"Transform[3].xyz;\n",z+="    vec3 VP = "+W+" - v_positionEC;\n",z+="    vec3 l = normalize(VP);\n",z+="    float range = length(VP);\n",z+="    float attenuation = 1.0 / (u_"+G+"Attenuation.x + ",z+="(u_"+G+"Attenuation.y * range) + ",z+="(u_"+G+"Attenuation.z * range * range));\n"):z+="    float attenuation = 1.0;\n","spot"===H&&(z+="    float spotDot = dot(l, normalize("+q+"));\n",z+="    if (spotDot < cos(u_"+G+"FallOff.x * 0.5))\n",z+="    {\n",z+="      attenuation = 0.0;\n",z+="    }\n",z+="    else\n",z+="    {\n",z+="        attenuation *= max(0.0, pow(spotDot, u_"+G+"FallOff.y));\n",z+="    }\n"),z+="    diffuseLight += "+Y+"* max(dot(normal,l), 0.) * attenuation;\n",F&&("BLINN"===h?(z+="    vec3 h = normalize(l + viewDir);\n",z+="    float specularIntensity = max(0., pow(max(dot(normal, h), 0.), u_shininess)) * attenuation;\n"):(z+="    vec3 reflectDir = reflect(-l, normal);\n",z+="    float specularIntensity = max(0., pow(max(dot(reflectDir, viewDir), 0.), u_shininess)) * attenuation;\n"),z+="    specularLight += "+Y+" * specularIntensity;\n")),z+="  }\n"}B||(z+="  ambientLight += vec3(0.2, 0.2, 0.2);\n");if(!k&&"CONSTANT"!==h){z+="  vec3 l = normalize(czm_sunDirectionEC);\n";z+="  diffuseLight += vec3(1.0, 1.0, 1.0) * max(dot(normal,l), 0.2);\n",F&&("BLINN"===h?(z+="  vec3 h = normalize(l + viewDir);\n",z+="  float specularIntensity = max(0., pow(max(dot(normal, h), 0.), u_shininess));\n"):(z+="  vec3 reflectDir = reflect(-l, normal);\n",z+="  float specularIntensity = max(0., pow(max(dot(reflectDir, viewDir), 0.), u_shininess));\n"),z+="  specularLight += vec3(1.0, 1.0, 1.0) * specularIntensity;\n")}v+="void main(void) {\n",v+=P,v+="}\n",b+="void main(void) {\n";var X,Z="  vec3 color = vec3(0.0, 0.0, 0.0);\n";y&&(b+="  vec3 normal = normalize(v_normal);\n",n.doubleSided&&(b+="  if (gl_FrontFacing == false)\n",b+="  {\n",b+="    normal = -normal;\n",b+="  }\n"));"CONSTANT"!==h?(Object(u.a)(O.u_diffuse)&&(O.u_diffuse.type===un.SAMPLER_2D?b+="  vec4 diffuse = texture2D(u_diffuse, "+R+");\n":b+="  vec4 diffuse = u_diffuse;\n",b+="  vec3 diffuseLight = vec3(0.0, 0.0, 0.0);\n",Z+="  color += diffuse.rgb * diffuseLight;\n"),F&&(O.u_specular.type===un.SAMPLER_2D?b+="  vec3 specular = texture2D(u_specular, "+R+").rgb;\n":b+="  vec3 specular = u_specular.rgb;\n",b+="  vec3 specularLight = vec3(0.0, 0.0, 0.0);\n",Z+="  color += specular * specularLight;\n"),X=Object(u.a)(O.u_transparency)?"  gl_FragColor = vec4(color * diffuse.a * u_transparency, diffuse.a * u_transparency);\n":"  gl_FragColor = vec4(color * diffuse.a, diffuse.a);\n"):X=Object(u.a)(O.u_transparency)?"  gl_FragColor = vec4(color * u_transparency, u_transparency);\n":"  gl_FragColor = vec4(color, 1.0);\n";_&&(Z+="  color *= v_vertexColor.rgb;\n");Object(u.a)(O.u_emission)&&(O.u_emission.type===un.SAMPLER_2D?b+="  vec3 emission = texture2D(u_emission, "+R+").rgb;\n":b+="  vec3 emission = u_emission.rgb;\n",Z+="  color += emission;\n");(Object(u.a)(O.u_ambient)||"CONSTANT"!==h)&&(Object(u.a)(O.u_ambient)?O.u_ambient.type===un.SAMPLER_2D?b+="  vec3 ambient = texture2D(u_ambient, "+R+").rgb;\n":b+="  vec3 ambient = u_ambient.rgb;\n":b+="  vec3 ambient = diffuse.rgb;\n",Z+="  color += ambient * ambientLight;\n");b+="  vec3 viewDir = -normalize(v_positionEC);\n",b+="  vec3 ambientLight = vec3(0.0, 0.0, 0.0);\n",b+=z,b+=Z,b+=X,b+="}\n";var Q=tZ(c,{type:un.VERTEX_SHADER,extras:{_pipeline:{source:v,extension:".glsl"}}}),K=tZ(c,{type:un.FRAGMENT_SHADER,extras:{_pipeline:{source:b,extension:".glsl"}}}),J=tZ(l,{fragmentShader:K,vertexShader:Q});return tZ(s,{attributes:L,program:J,uniforms:O})}(e,i,h,l,n,t.addBatchIdToGeneratedShaders),a[d]=f,o=!0);var p={},m=l.values;for(var _ in m)m.hasOwnProperty(_)&&"transparent"!==_&&"doubleSided"!==_&&(p["u_"+_.toLowerCase()]=m[_]);s.extensions.KHR_techniques_webgl={technique:f,values:p},s.alphaMode="OPAQUE",l.transparent&&(s.alphaMode="BLEND"),l.doubleSided&&(s.doubleSided=!0)}})),o?(wQ.ensureSemanticExistence(e),e):e}};function EQ(e){return Object(u.a)(e.extensions)&&Object(u.a)(e.extensions.KHR_materials_pbrSpecularGlossiness)}function TQ(e){switch(e){case"u_baseColorFactor":return un.FLOAT_VEC4;case"u_metallicFactor":case"u_roughnessFactor":return un.FLOAT;case"u_baseColorTexture":case"u_metallicRoughnessTexture":case"u_normalTexture":case"u_occlusionTexture":case"u_emissiveTexture":return un.SAMPLER_2D;case"u_emissiveFactor":return un.FLOAT_VEC3;case"u_diffuseFactor":return un.FLOAT_VEC4;case"u_specularFactor":return un.FLOAT_VEC3;case"u_glossinessFactor":return un.FLOAT;case"u_diffuseTexture":case"u_specularGlossinessTexture":return un.SAMPLER_2D;case"useGradual":case"shouldAnimate":case"planView":return un.BOOL;case"exposure":case"brightMax":case"intensity":return un.FLOAT;case"startColor":case"endColor":return un.FLOAT_VEC3;case"gradualOffset":return un.FLOAT;case"circleData":return un.FLOAT_VEC4;case"circleDataLength":case"zbufferPriority":return un.FLOAT}}var CQ=function(e,t){if(t=Object(w.a)(t,{}),iZ(e,"KHR_techniques_webgl"))return e;if(!Object(u.a)(e.materials)||0===e.materials.length)return e;Object(u.a)(e.extensions)||(e.extensions={}),Object(u.a)(e.extensionsUsed)||(e.extensionsUsed=[]),Object(u.a)(e.extensionsRequired)||(e.extensionsRequired=[]),e.extensions.KHR_techniques_webgl={programs:[],shaders:[],techniques:[]},e.extensionsUsed.push("KHR_techniques_webgl"),e.extensionsRequired.push("KHR_techniques_webgl");var i=wQ.splitIncompatibleMaterials(e);return rZ.material(e,(function(n,r){var a,o={};a=t.useScience?function(e,t,i,n,r,a){var o=e.extensions.KHR_techniques_webgl,s=o.techniques,c=o.shaders,l=o.programs,u={u_modelViewMatrix:{semantic:iZ(e,"CESIUM_RTC")?"CESIUM_RTC_MODELVIEW":"MODELVIEW",type:un.FLOAT_MAT4},u_projectionMatrix:{semantic:"PROJECTION",type:un.FLOAT_MAT4}},h="precision highp float;\nuniform mat4 u_modelViewMatrix;\nuniform mat4 u_projectionMatrix;\nattribute vec3 a_position;\nattribute vec2 a_texcoord_0;\nvarying vec2 "+"v_texcoord_0"+";\nvoid main()\n{\n    v_texcoord_0 = a_texcoord_0;\n    gl_Position = u_projectionMatrix* u_modelViewMatrix * vec4(a_position , 1.0) ;\n}\n",d=tZ(c,{type:un.VERTEX_SHADER,extras:{_pipeline:{source:h,extension:".glsl"}}}),f=tZ(c,{type:un.FRAGMENT_SHADER,extras:{_pipeline:{source:"precision highp float;\nuniform sampler2D scienceTexture;\nuniform float blink;\nuniform vec3 diffuseColor;\nvarying vec2 v_texcoord_0;\nvoid main()\n{\n    //The fragment's world space coordinates as fragment output.\n    vec4 color = texture2D(scienceTexture, v_texcoord_0); \n    vec4 finalColor; \n  if(diffuseColor != vec3(1.0,1.0,1.0)){ \n  if(blink == 1.0) { \n     vec4 oldColor = vec4(color.a)  * vec4(245.0/255.0,129.0/255.0,244.0/255.0,1.0); \n     finalColor = mix(vec4(color.a)  * vec4(diffuseColor,1.0) , oldColor, clamp(sin(czm_frameNumber * 0.04),0.0,1.0)); \n  }else { \n     finalColor = vec4(color.a)  * vec4(diffuseColor,1.0); \n   }\n }else{\n  if(blink == 1.0) { \n     vec4 oldColor = vec4(color.a)  * vec4(245.0/255.0,129.0/255.0,244.0/255.0,1.0); \n     finalColor = mix(color , oldColor, clamp(sin(czm_frameNumber * 0.04),0.0,1.0)); \n  }else { \n     finalColor = color  * vec4(diffuseColor,1.0); \n   }\n } \n    gl_FragColor = finalColor;\n}\n",extension:".glsl"}}}),p=tZ(l,{fragmentShader:f,vertexShader:d});return tZ(s,{attributes:{a_position:{semantic:"POSITION"},a_normal:{semantic:"NORMAL"},a_batchId:{semantic:"_BATCHID"},a_texcoord_0:{semantic:"TEXCOORD_0"}},program:p,uniforms:u})}(e):t.useHolo?function(e,t,i,n,r,a){var o,s,c=e.extensions.KHR_techniques_webgl,l=c.techniques,h=c.shaders,d=c.programs,f=EQ(t),p=t.pbrMetallicRoughness;if(Object(u.a)(p)&&!f)for(o in p)p.hasOwnProperty(o)&&(n[s="u_"+o]=p[o]);if(f){var m=t.extensions.KHR_materials_pbrSpecularGlossiness;for(o in m)m.hasOwnProperty(o)&&(n[s="u_"+o]=m[o])}for(var _ in t)t.hasOwnProperty(_)&&(_.indexOf("Texture")>=0||_.indexOf("Factor")>=0)&&(n[s="u_"+_]=t[_]);var g=t.extras.emission_scale;void 0===g&&(g=1);n.exposure=197e-7,n.brightMax=.52,n.intensity=g;var v={u_modelViewMatrix:{semantic:iZ(e,"CESIUM_RTC")?"CESIUM_RTC_MODELVIEW":"MODELVIEW",type:un.FLOAT_MAT4},u_projectionMatrix:{semantic:"PROJECTION",type:un.FLOAT_MAT4},u_normalMatrix:{semantic:"MODELVIEWINVERSETRANSPOSE",type:un.FLOAT_MAT3}};for(s in n)n.hasOwnProperty(s)&&(v[s]={type:TQ(s)});var b=Object(w.a)(v.u_baseColorTexture,v.u_baseColorFactor);Object(u.a)(b)&&(b.semantic="_3DTILESDIFFUSE",b.type=un.FLOAT_VEC4);var y=t.alphaMode;Object(u.a)(y)&&"MASK"===y&&(v.u_alphaCutoff={semantic:"ALPHACUTOFF",type:un.FLOAT});var O="vec4 final_color = vec4(0.0); \n";Object(u.a)(y)?"MASK"===y?(O+="    if (baseColorWithAlpha.a < u_alphaCutoff) {\n",O+="        discard;\n",O+="    }\n",O+="    final_color = vec4(color, 1.0);\n",O+="gl_FragColor = final_color;\n"):"BLEND"===y?O+=" gl_FragColor = vec4(color ,baseColorWithAlpha.a );\n":(O+="    final_color = vec4(color, 1.0);\n",O+="gl_FragColor = final_color;\n"):(O+=" final_color = vec4(color, 1.0);\n",O+=" gl_FragColor = final_color;\n");var x="#ifdef GL_OES_standard_derivatives\n#extension GL_OES_standard_derivatives : enable\n#endif\nprecision highp float;\nuniform vec4 u_baseColorFactor;\nuniform float u_metallicFactor;\nuniform float u_roughnessFactor;\nuniform vec3 u_emissiveFactor;\nuniform float intensity;\nvarying float v_fresnel;\nvarying vec3 v_positionEC;\nvarying vec3 v_vertexWC; \nvarying vec3 wNormal; \nuniform float exposure;\nuniform float brightMax;\nuniform float u_alphaCutoff;\nconst float M_PI = 3.141592653589793;\nconst vec4 color1 = vec4(0.054901965, 0.24705884, 0.61960787, 0.2);\nconst vec4 color2 = vec4(0.5921569, 0.8450981, 0.97647065, 0.3);\nvec3 lambertianDiffuse(vec3 diffuseColor) \n{\n    return diffuseColor / M_PI;\n}\n\nvec3 fresnelSchlick2(vec3 f0, vec3 f90, float VdotH) \n{\n    return f0 + (f90 - f0) * pow(clamp(1.0 - VdotH, 0.0, 1.0), 5.0);\n}\n\nvec3 fresnelSchlick(float metalness, float VdotH) \n{\n    return metalness + (vec3(1.0) - metalness) * pow(1.0 - VdotH, 5.0);\n}\n\nfloat smithVisibilityG1(float NdotV, float roughness) \n{\n    float k = (roughness + 1.0) * (roughness + 1.0) / 8.0;\n    return NdotV / (NdotV * (1.0 - k) + k);\n}\n\nfloat smithVisibilityGGX(float roughness, float NdotL, float NdotV) \n{\n    return smithVisibilityG1(NdotL, roughness) * smithVisibilityG1(NdotV, roughness);\n}\n\nfloat GGX(float roughness, float NdotH) \n{\n    float roughnessSquared = roughness * roughness;\n    float f = (NdotH * roughnessSquared - NdotH) * NdotH + 1.0;\n    return roughnessSquared / (M_PI * f * f);\n}\n\nvec3 SRGBtoLINEAR3(vec3 srgbIn) \n{\n    return pow(srgbIn, vec3(2.2));\n}\n\nvec4 SRGBtoLINEAR4(vec4 srgbIn) \n{\n    vec3 linearOut = pow(srgbIn.rgb, vec3(2.2));\n    return vec4(linearOut, srgbIn.a);\n}\n\nvec3 LINEARtoSRGB(vec3 linearIn) \n{\n    return pow(linearIn, vec3(1.0/2.2));\n}\nvec3 decode_pnghdr( const in vec4 color ) {\n// remove gamma correction\nvec4 res = color * color;\n// decoded RI\nfloat ri = pow( 2.0, res.w * 32.0 - 16.0 );\n// decoded HDR pixel\nres.xyz = res.xyz * ri;\nreturn res.xyz;\n}\nvoid main()\n{\n#ifdef GL_OES_standard_derivatives\n    vec3 t = normalize(dFdy(v_positionEC));\n    vec3 b = normalize(dFdx(v_positionEC));\n    b *= -1.0;\n    vec3 n  = cross(t,b);\n#endif\n  vec4 baseColorWithAlpha = u_baseColorFactor; \n  vec3 baseColor = baseColorWithAlpha.rgb;\n    float metalness = clamp(u_metallicFactor, 0.0, 1.0);\n    float roughness = clamp(u_roughnessFactor, 0.04, 1.0);\n   vec3 v = -normalize(v_positionEC);\n    vec3 l = normalize(czm_sunDirectionEC);\n    vec3 h = normalize(v + l);\n    vec3 r = normalize(czm_inverseViewRotation * normalize(reflect(v, n)));\n    czm_ellipsoid ellipsoid = czm_getWgs84EllipsoidEC();\n    float vertexRadius = length(v_vertexWC);\n    float horizonDotNadir = 1.0 - min(1.0, ellipsoid.radii.x / vertexRadius);\n    float reflectionDotNadir = dot(r, normalize(v_vertexWC));\n    r.x = -r.x;\n    r = -normalize(czm_temeToPseudoFixed * r);\n    r.x = -r.x;\n    float NdotL = clamp(dot(n, l), 0.001, 1.0);\n    float NdotV = abs(dot(n, v)) + 0.001;\n    float NdotH = clamp(dot(n, h), 0.0, 1.0);\n    float LdotH = clamp(dot(l, h), 0.0, 1.0);\n    float VdotH = clamp(dot(v, h), 0.0, 1.0);\n  vec3 f0 = vec3(0.04);\n   vec3 diffuseColor = baseColor * (1.0 - metalness) * (1.0-f0 );\n    vec3 specularColor = mix(f0, baseColor, metalness);\n    float alpha = roughness * roughness; \nvec3 lightColor = vec3(1.5, 1.4, 1.2); \nfloat reflectance = max(max(specularColor.r, specularColor.g), specularColor.b);\n    vec3 r90 = vec3(clamp(reflectance * 25.0, 0.0, 1.0));\n    vec3 r0 = specularColor.rgb;\n    vec3 F = fresnelSchlick2(r0, r90, VdotH);\n    float G = smithVisibilityGGX(alpha, NdotL, NdotV);\n    float D = GGX(alpha, NdotH);\n    vec3 diffuseContribution = (1.0 - F) * lambertianDiffuse(diffuseColor);\n    vec3 specularContribution = F * G * D / (4.0 * NdotL * NdotV);\n    vec3 color =  NdotL * lightColor *(diffuseContribution + specularContribution);\n    float inverseRoughness = 1.04 - roughness;\n    inverseRoughness *= inverseRoughness;\n    vec3 sceneSkyBox = textureCube(czm_environmentMap, r).rgb * inverseRoughness;\n    float atmosphereHeight = 0.05;\n    float blendRegionSize = 0.1 * ((1.0 - inverseRoughness) * 8.0 + 1.1 - horizonDotNadir);\n    float blendRegionOffset = roughness * -1.0;\n    float farAboveHorizon = clamp(horizonDotNadir - blendRegionSize * 0.5 + blendRegionOffset, 1.0e-10 - blendRegionSize, 0.99999);\n    float aroundHorizon = clamp(horizonDotNadir + blendRegionSize * 0.5, 1.0e-10 - blendRegionSize, 0.99999);\n    float farBelowHorizon = clamp(horizonDotNadir + blendRegionSize * 1.5, 1.0e-10 - blendRegionSize, 0.99999);\n    float smoothstepHeight = smoothstep(0.0, atmosphereHeight, horizonDotNadir);\n    vec3 belowHorizonColor = mix(vec3(0.1, 0.15, 0.25), vec3(0.4, 0.7, 0.9), smoothstepHeight);\n    vec3 nadirColor = belowHorizonColor * 0.5;\n    vec3 aboveHorizonColor = mix(vec3(0.9, 1.0, 1.2), belowHorizonColor, roughness * 0.5);\n    vec3 blueSkyColor = mix(vec3(0.18, 0.26, 0.48), aboveHorizonColor, reflectionDotNadir * inverseRoughness * 0.5 + 0.75);\n    vec3 zenithColor = mix(blueSkyColor, sceneSkyBox, smoothstepHeight);\n    vec3 blueSkyDiffuseColor = vec3(0.7, 0.85, 0.9);\n    float diffuseIrradianceFromEarth = (1.0 - horizonDotNadir) * (reflectionDotNadir * 0.25 + 0.75) * smoothstepHeight;\n    float diffuseIrradianceFromSky = (1.0 - smoothstepHeight) * (1.0 - (reflectionDotNadir * 0.25 + 0.25));\n    vec3 diffuseIrradiance = blueSkyDiffuseColor * clamp(diffuseIrradianceFromEarth + diffuseIrradianceFromSky, 0.0, 1.0);\n    float notDistantRough = (1.0 - horizonDotNadir * roughness * 0.8);\n    vec3 specularIrradiance = mix(zenithColor, aboveHorizonColor, smoothstep(farAboveHorizon, aroundHorizon, reflectionDotNadir) * notDistantRough);\n    specularIrradiance = mix(specularIrradiance, belowHorizonColor, smoothstep(aroundHorizon, farBelowHorizon, reflectionDotNadir) * inverseRoughness);\n    specularIrradiance = mix(specularIrradiance, nadirColor, smoothstep(farBelowHorizon, 1.0, reflectionDotNadir) * inverseRoughness);\n    vec2 brdfLut = texture2D(czm_brdfLut, vec2(NdotV, 1.0 - roughness)).rg;\n    vec3 IBLColor =  (specularIrradiance * SRGBtoLINEAR3(specularColor * brdfLut.x + brdfLut.y));\n    color += IBLColor;\n    color *= intensity;\n"+O+"}\n",E=tZ(h,{type:un.VERTEX_SHADER,extras:{_pipeline:{source:"precision highp float;\nuniform mat4 u_modelViewMatrix;\nuniform mat4 u_projectionMatrix;\nuniform mat3 u_normalMatrix;\nattribute vec3 a_position;\nattribute float a_batchId;\nattribute vec3 a_normal;\nattribute vec3 offset;\nvarying float v_fresnel;\nvarying vec3 v_positionEC;\nvarying vec3 v_vertexWC; \nvarying vec3 wNormal; \nvoid main()\n{\n   vec3 weightedPosition = a_position;\n  vec4 position = vec4(weightedPosition, 1.0);\nvec4 mCameraPos = czm_inverseModel * vec4(czm_viewerPositionWC, 1.);\nvec3 mCameraDir = normalize(position.xyz - mCameraPos.xyz);\nvec3 mNormal = normalize(a_normal); \nwNormal = (czm_model * vec4(mNormal,1.0)).xyz; \nv_fresnel = max(1.0 - abs(dot(mNormal, -mCameraDir)), 0.0);\nv_fresnel = pow(v_fresnel, 0.5);\nv_fresnel = clamp(v_fresnel, 0.2, 1.);\n  position = u_modelViewMatrix * position;\n  v_positionEC = position.xyz; \n v_vertexWC = (czm_model * position).xyz;\ngl_Position = u_projectionMatrix* u_modelViewMatrix * vec4(a_position, 1.0) ;\n}\n",extension:".glsl"}}}),T=tZ(h,{type:un.FRAGMENT_SHADER,extras:{_pipeline:{source:x,extension:".glsl"}}}),C=tZ(d,{fragmentShader:T,vertexShader:E});return tZ(l,{attributes:{a_position:{semantic:"POSITION"},a_normal:{semantic:"NORMAL"},a_batchId:{semantic:"_BATCHID"}},program:C,uniforms:v})}(e,n,0,o):function(e,t,i,n,r,a){var o,s,c=Object(w.a)(a.addBatchIdToGeneratedShaders,!1),l=e.extensions.KHR_techniques_webgl,h=l.techniques,d=l.shaders,f=l.programs,p=EQ(t),m=t.pbrMetallicRoughness;if(Object(u.a)(m)&&!p)for(s in m)m.hasOwnProperty(s)&&(n[o="u_"+s]=m[s]);if(p){var _=t.extensions.KHR_materials_pbrSpecularGlossiness;for(s in _)_.hasOwnProperty(s)&&(n[o="u_"+s]=_[s])}for(var g in t)t.hasOwnProperty(g)&&(g.indexOf("Texture")>=0||g.indexOf("Factor")>=0)&&(n[o="u_"+g]=t[g]);n.exposure=197e-7,n.brightMax=.52,n.useGradual=!1,n.startColor=[1,0,0],n.endColor=[0,1,0],n.gradualOffset=150,n.shouldAnimate=!1,n.planView=!1,n.circleDataLength=0,n.circleData=[],n.zbufferPriority=0;var v,b="precision highp float;\n",y="precision highp float;\n";Object(u.a)(e.skins)&&(v=e.skins[0]);var O,x,E=Object(u.a)(v)?v.joints:[],T=E.length,C=r[i],S=!1,A=!1,P=!1,I=!1,D=!1,j=!1,M=!1,R=!1;Object(u.a)(C)&&(O=C.skinning,S=O.skinned&&E.length>0,A=C.hasVertexColors,P=C.hasMorphTargets,I=C.hasNormals,D=C.hasTangents,j=C.hasTexCoords,R=C.hasCombineMaterial);P&&rZ.mesh(e,(function(e){rZ.meshPrimitive(e,(function(e){if(e.material===i){var t=e.targets;Object(u.a)(t)&&(x=t)}}))}));var L={u_modelViewMatrix:{semantic:iZ(e,"CESIUM_RTC")?"CESIUM_RTC_MODELVIEW":"MODELVIEW",type:un.FLOAT_MAT4},u_projectionMatrix:{semantic:"PROJECTION",type:un.FLOAT_MAT4}};Object(u.a)(t.extensions)&&Object(u.a)(t.extensions.KHR_materials_unlit)&&(M=!0,I=!1,D=!1);I&&(L.u_normalMatrix={semantic:"MODELVIEWINVERSETRANSPOSE",type:un.FLOAT_MAT3});S&&(L.u_jointMatrix={count:T,semantic:"JOINTMATRIX",type:un.FLOAT_MAT4});P&&(L.u_morphWeights={count:x.length,semantic:"MORPHWEIGHTS",type:un.FLOAT});var N=t.alphaMode;Object(u.a)(N)&&"MASK"===N&&(L.u_alphaCutoff={semantic:"ALPHACUTOFF",type:un.FLOAT});for(o in n)n.hasOwnProperty(o)&&(L[o]={type:TQ(o)});var F=Object(w.a)(L.u_baseColorTexture,L.u_baseColorFactor);Object(u.a)(F)&&(F.semantic="_3DTILESDIFFUSE");for(o in L)if(L.hasOwnProperty(o)){var k=L[o],B=Object(u.a)(k.count)?"["+k.count+"]":"";k.type!==un.FLOAT_MAT3&&k.type!==un.FLOAT_MAT4&&"u_morphWeights"!==o&&"shouldAnimate"!==o&&"planView"!==o||k.useInFragment?(y+="circleData"===o?"uniform "+VI(k.type)+" "+o+"[8];\n":"uniform "+VI(k.type)+" "+o+B+";\n",delete k.useInFragment):b+="uniform "+VI(k.type)+" "+o+B+";\n"}y+="uniform "+VI(un.BOOL)+" planView;\n";var z="";if(S){var U,V,H=aZ(O.type),G=!1;if(0===O.type.indexOf("MAT")&&(G=!0,H=Math.sqrt(H)),G)for(U=0;U<H;U++)for(V=0;V<H;V++)z+=0===U&&0===V?"    mat4 skinMatrix = ":"    skinMatrix += ",z+="a_weight["+U+"]["+V+"] * u_jointMatrix[int(a_joint["+U+"]["+V+"])];\n";else for(U=0;U<H;U++)z+=0===U?"    mat4 skinMatrix = ":"    skinMatrix += ",z+="a_weight["+U+"] * u_jointMatrix[int(a_joint["+U+"])];\n"}var q,W={a_position:{semantic:"POSITION"}};b+="attribute vec3 a_position;\n",b+="varying vec3 v_positionEC;\n",b+="varying vec3 posMC;\n",z+="    vec3 weightedPosition = a_position;\n",I&&(z+="    vec3 weightedNormal = a_normal;\n");D&&(z+="    vec4 weightedTangent = a_tangent;\n");if(P)for(var Y=0;Y<x.length;Y++){var X=x[Y];for(var Z in X)if(X.hasOwnProperty(Z)&&"extras"!==Z){var Q="a_"+Z+"_"+Y;W[Q]={semantic:Z+"_"+Y},b+="attribute vec3 "+Q+";\n","POSITION"===Z?z+="    weightedPosition += u_morphWeights["+Y+"] * "+Q+";\n":"NORMAL"===Z?z+="    weightedNormal += u_morphWeights["+Y+"] * "+Q+";\n":D&&"TANGENT"===Z&&(z+="    weightedTangent.xyz += u_morphWeights["+Y+"] * "+Q+";\n")}}z+=S?"    vec4 position = skinMatrix * vec4(weightedPosition, 1.0);\n":"    vec4 position = vec4(weightedPosition, 1.0);\n";I&&(z+="posMC = position.xyz; \n",z+=" if(planView){\n",z+=" if(czm_cameraPicth<-1.4){\n",z+="   position.z = 0.0;\n",z+=" }else {\n",z+="   float ct = position.z;\n",z+=" if(shouldAnimate){\n",z+="    ct =clamp(czm_planNumber,1.0,position.z);\n",z+="  }\n",z+="   position.z = ct;\n",z+=" }\n",z+=" }\n");z+="    vec4 positionEC = u_modelViewMatrix * position;\n",z+="    v_positionEC = positionEC.xyz;\n",z+="    gl_Position = u_projectionMatrix * positionEC;\n",I&&(W.a_normal={semantic:"NORMAL"},b+="attribute vec3 a_normal;\n",b+="varying vec3 v_normal;\n",z+=S?"    v_normal = u_normalMatrix * mat3(skinMatrix) * weightedNormal;\n":"    v_normal = u_normalMatrix * weightedNormal;\n",y+="varying vec3 v_normal;\n");D&&(W.a_tangent={semantic:"TANGENT"},b+="attribute vec4 a_tangent;\n",b+="varying vec4 v_tangent;\n",z+="    v_tangent.xyz = u_normalMatrix * weightedTangent.xyz;\n",z+="    v_tangent.w = weightedTangent.w;\n",y+="varying vec4 v_tangent;\n");j&&(W.a_texcoord_0={semantic:"TEXCOORD_0"},b+="attribute vec2 a_texcoord_0;\n",b+="varying vec2 "+(q="v_texcoord_0")+";\n",z+="    "+q+" = a_texcoord_0;\n",y+="varying vec2 "+q+";\n");if(S){var K=wQ.getShaderVariable(O.type);W.a_joint={semantic:"JOINTS_0"},W.a_weight={semantic:"WEIGHTS_0"},b+="attribute "+K+" a_joint;\n",b+="attribute "+K+" a_weight;\n"}A&&(W.a_vertexColor={semantic:"COLOR_0"},b+="attribute vec4 a_vertexColor;\n",b+="varying vec4 v_vertexColor;\n",z+="  v_vertexColor = a_vertexColor;\n",y+="varying vec4 v_vertexColor;\n");c&&(W.a_batchId={semantic:"_BATCHID"},b+="attribute float a_batchId;\n");R&&(W.a_materialId={semantic:"_MATERIALID"},b+="attribute float a_materialId;\n",b+="varying vec4 pbrBaseColor;\n",b+="varying vec4 pbrMetallicRoughness;\n",b+="uniform vec2 combineMaterialTextureDimensions;\n",b+="uniform vec4 combineMaterialTextureStep;\n",b+="uniform sampler2D combineMaterialTexture;\n",b+="void computeCombineMaterial(const float batchId)\n{\n    float realBatchId = batchId * 2.0;\n    float stepX = combineMaterialTextureStep.x;\n    float centerX = combineMaterialTextureStep.y;\n    float stepY = combineMaterialTextureStep.z;\n    float centerY = combineMaterialTextureStep.w;\n\n    vec2 baseColorUV;\n    vec2 metallicUV;\n    if(combineMaterialTextureDimensions.y == 1.0){\n        baseColorUV = vec2(centerX + (realBatchId * stepX), 0.5);\n        metallicUV = vec2(centerX + ((realBatchId + 1.0) * stepX), 0.5);\n    }\n    else\n    {\n        float colorXId = mod(realBatchId, combineMaterialTextureDimensions.x);\n        float colorYId = floor(realBatchId / combineMaterialTextureDimensions.x);\n        baseColorUV = vec2(centerX + (colorXId * stepX), centerY + (colorYId * stepY));\n\n        realBatchId += 1.0;\n        float metallicXId = mod(realBatchId, combineMaterialTextureDimensions.x);\n        float metallicYId = floor(realBatchId / combineMaterialTextureDimensions.x);\n        metallicUV = vec2(centerX + (metallicXId * stepX), centerY + (metallicYId * stepY));\n    }\n\n    pbrBaseColor = texture2D(combineMaterialTexture, baseColorUV);\n    pbrBaseColor.a = 1.0;\n    pbrMetallicRoughness = texture2D(combineMaterialTexture, metallicUV);\n}\n",z+="    computeCombineMaterial(a_materialId);\n");b+="void main(void) \n{\n",b+=z,b+="}\n",y+="varying vec3 posMC;\n",y+="varying vec3 v_positionEC;\n",R&&(y+="varying vec4 pbrBaseColor;\n",y+="varying vec4 pbrMetallicRoughness;\n");y+="const float M_PI = 3.141592653589793;\n",y+="vec3 lambertianDiffuse(vec3 diffuseColor) \n{\n    return diffuseColor / M_PI;\n}\n\n",y+="vec3 fresnelSchlick2(vec3 f0, vec3 f90, float VdotH) \n{\n    return f0 + (f90 - f0) * pow(clamp(1.0 - VdotH, 0.0, 1.0), 5.0);\n}\n\n",y+="vec3 fresnelSchlick(float metalness, float VdotH) \n{\n    return metalness + (vec3(1.0) - metalness) * pow(1.0 - VdotH, 5.0);\n}\n\n",y+="float smithVisibilityG1(float NdotV, float roughness) \n{\n    float k = (roughness + 1.0) * (roughness + 1.0) / 8.0;\n    return NdotV / (NdotV * (1.0 - k) + k);\n}\n\n",y+="float smithVisibilityGGX(float roughness, float NdotL, float NdotV) \n{\n    return smithVisibilityG1(NdotL, roughness) * smithVisibilityG1(NdotV, roughness);\n}\n\n",y+="float GGX(float roughness, float NdotH) \n{\n    float roughnessSquared = roughness * roughness;\n    float f = (NdotH * roughnessSquared - NdotH) * NdotH + 1.0;\n    return roughnessSquared / (M_PI * f * f);\n}\n\n",y+="vec3 wgs84ToCartesian(vec3 p) {\n  vec3 vn = vec3(\n    cos(p.y) * cos(p.x),\n    cos(p.y) * sin(p.x),\n    sin(p.y)\n  );\n  vn = normalize(vn);\n\n  vec3 vk = vec3(40680631590769., 40680631590769., 40408299984661.445)* vn;\n  float gamma = sqrt(dot(vn, vk));\n  vk = vk / gamma;\n  return vk ;\n}\n",y+="vec3 SRGBtoLINEAR3(vec3 srgbIn) \n{\n    return pow(srgbIn, vec3(2.2));\n}\n\n",y+="vec4 SRGBtoLINEAR4(vec4 srgbIn) \n{\n    vec3 linearOut = pow(srgbIn.rgb, vec3(2.2));\n    return vec4(linearOut, srgbIn.a);\n}\n\n",y+="vec3 LINEARtoSRGB(vec3 linearIn) \n{\n#ifndef HDR \n    return pow(linearIn, vec3(1.0/2.2));\n#else \n    return linearIn;\n#endif \n}\n\n",y+="vec3 decode_pnghdr( const in vec4 color ) {\n// remove gamma correction\nvec4 res = color * color;\n// decoded RI\nfloat ri = pow( 2.0, res.w * 32.0 - 16.0 );\n// decoded HDR pixel\nres.xyz = res.xyz * ri;\nreturn res.xyz;\n}\n",y+="vec4 calculateCircleColor(vec4 color,vec4 dimensions){\n    float circle = 0.0;\n    vec3 cColor = color.xyz; \n    float radius = color.w; \n    vec2 lonlat = dimensions.xy;\n    float width = dimensions.z;\n    vec3 centerPos = wgs84ToCartesian( vec3(lonlat,0.0)); \n    vec3 circlePos = (czm_inverseModel * vec4(centerPos,1.0)).xyz; \n    float time = mod(czm_frameNumber, radius) * 1.0; \n    float innerTail = width; \n    float frontierBorder = 1.0; \n    float r1 = length(circlePos.xy-(posMC.xy)); \n    circle += smoothstep(time -  innerTail, time, r1) * smoothstep(time + frontierBorder,time, r1);\n    circle *= smoothstep(0.0, 0.0, distance(circlePos.xy ,posMC.xy)); \n    return vec4(circle,circle,circle,circle) * vec4(cColor,1.0); \n}\n",y+="float random(vec3 scale, float seed) {\n    return fract(sin(dot(gl_FragCoord.xyz+seed, scale))*43758.5453+seed);\n}\n",y+="#ifdef USE_IBL_LIGHTING \n",y+="uniform vec2 gltf_iblFactor; \n",y+="#endif \n",y+="#ifdef USE_CUSTOM_LIGHT_COLOR \n",y+="uniform vec3 gltf_lightColor; \n",y+="#endif \n",y+="void main(void) \n{\n",I?(y+="    vec3 ng = normalize(v_normal);\n",Object(u.a)(n.u_normalTexture)?D?(y+="    vec3 t = normalize(v_tangent.xyz);\n",y+="    vec3 b = normalize(cross(ng, t) * v_tangent.w);\n",y+="    mat3 tbn = mat3(t, b, ng);\n",y+="    vec3 n = texture2D(u_normalTexture, "+q+").rgb;\n",y+="    n = normalize(tbn * (2.0 * n - 1.0));\n"):(y="#ifdef GL_OES_standard_derivatives\n#extension GL_OES_standard_derivatives : enable\n#endif\n"+y,y+="#ifdef GL_OES_standard_derivatives\n",y+="    vec3 pos_dx = dFdx(v_positionEC);\n",y+="    vec3 pos_dy = dFdy(v_positionEC);\n",y+="    vec3 tex_dx = dFdx(vec3("+q+",0.0));\n",y+="    vec3 tex_dy = dFdy(vec3("+q+",0.0));\n",y+="    vec3 t = (tex_dy.t * pos_dx - tex_dx.t * pos_dy) / (tex_dx.s * tex_dy.t - tex_dy.s * tex_dx.t);\n",y+="    t = normalize(t - ng * dot(ng, t));\n",y+="    vec3 b = normalize(cross(ng, t));\n",y+="    mat3 tbn = mat3(t, b, ng);\n",y+="    vec3 n = texture2D(u_normalTexture, "+q+").rgb;\n",y+="    n = normalize(tbn * (2.0 * n - 1.0));\n",y+="#else\n",y+="    vec3 n = ng;\n",y+="#endif\n"):y+="    vec3 n = ng;\n",t.doubleSided&&(y+="    if (!gl_FrontFacing)\n",y+="    {\n",y+="        n = -n;\n",y+="    }\n")):(y="#ifdef GL_OES_standard_derivatives\n#extension GL_OES_standard_derivatives : enable\n#endif\n"+y,y+="#ifdef GL_OES_standard_derivatives\n",y+="    vec3 pos_dx = dFdx(v_positionEC);\n",y+="    vec3 pos_dy = dFdy(v_positionEC);\n",y+="    vec3 n  = normalize(cross(pos_dx,pos_dy));\n",y+="#endif\n",t.doubleSided&&(y+="    if (!gl_FrontFacing)\n",y+="    {\n",y+="        n = -n;\n",y+="    }\n"),fx.ultimatePerformance&&(I=!0));Object(u.a)(n.u_baseColorTexture)?(y+="    vec4 baseColorWithAlpha = SRGBtoLINEAR4(texture2D(u_baseColorTexture, "+q+"));\n",Object(u.a)(n.u_baseColorFactor)&&(y+="    baseColorWithAlpha *= u_baseColorFactor;\n")):Object(u.a)(n.u_baseColorFactor)?y+="    vec4 baseColorWithAlpha = u_baseColorFactor;\n":y+=R?"    vec4 baseColorWithAlpha = pbrBaseColor;\n":"    vec4 baseColorWithAlpha = vec4(1.0);\n";A&&(y+="    baseColorWithAlpha *= v_vertexColor;\n");y+="    vec3 baseColor = baseColorWithAlpha.rgb;\n",p?(Object(u.a)(n.u_specularGlossinessTexture)?(y+="    vec4 specularGlossiness = SRGBtoLINEAR4(texture2D(u_specularGlossinessTexture, "+q+"));\n",y+="    vec3 specular = specularGlossiness.rgb;\n",y+="    float glossiness = specularGlossiness.a;\n",Object(u.a)(n.u_specularFactor)&&(y+="    specular *= u_specularFactor;\n"),Object(u.a)(n.u_glossinessFactor)&&(y+="    glossiness *= u_glossinessFactor;\n")):(Object(u.a)(n.u_specularFactor)?y+="    vec3 specular = clamp(u_specularFactor, vec3(0.0), vec3(1.0));\n":y+="    vec3 specular = vec3(1.0);\n",Object(u.a)(n.u_glossinessFactor)?y+="    float glossiness = clamp(u_glossinessFactor, 0.0, 1.0);\n":y+="    float glossiness = 1.0;\n"),Object(u.a)(n.u_diffuseTexture)?(y+="    vec4 diffuse = SRGBtoLINEAR4(texture2D(u_diffuseTexture, "+q+"));\n",Object(u.a)(n.u_diffuseFactor)&&(y+="    diffuse *= u_diffuseFactor;\n")):Object(u.a)(n.u_diffuseFactor)?y+="    vec4 diffuse = clamp(u_diffuseFactor, vec4(0.0), vec4(1.0));\n":y+="    vec4 diffuse = vec4(1.0);\n"):Object(u.a)(n.u_metallicRoughnessTexture)?(y+="    vec3 metallicRoughness = texture2D(u_metallicRoughnessTexture, "+q+").rgb;\n",y+="    float metalness = clamp(metallicRoughness.b, 0.0, 1.0);\n",y+="    float roughness = clamp(metallicRoughness.g, 0.04, 1.0);\n",Object(u.a)(n.u_metallicFactor)&&(y+="    metalness *= u_metallicFactor;\n"),Object(u.a)(n.u_roughnessFactor)&&(y+="    roughness *= u_roughnessFactor;\n")):(Object(u.a)(n.u_metallicFactor)?y+="    float metalness = clamp(u_metallicFactor, 0.0, 1.0);\n":y+=R?"    float metalness = clamp(pbrMetallicRoughness.x, 0.0, 1.0);\n":"    float metalness = 1.0;\n",Object(u.a)(n.u_roughnessFactor)?y+="    float roughness = clamp(u_roughnessFactor, 0.04, 1.0);\n":y+=R?"    float roughness = clamp(pbrMetallicRoughness.y, 0.04, 1.0);\n":"    float roughness = 1.0;\n");I?(y+="    vec3 v = -normalize(v_positionEC);\n",y+="#ifndef USE_CUSTOM_LIGHT_COLOR \n",y+="    vec3 lightColor = vec3(1.5, 1.4, 1.2);\n",y+="#else \n",y+="    vec3 lightColor = gltf_lightColor;\n",y+="#endif \n",y+="    lightColor *= czm_lightScaleFactor;\n",y+="    vec3 l = normalize(czm_sunDirectionEC);\n",y+="    vec3 h = normalize(v + l);\n",y+="    float NdotL = clamp(dot(n, l), 0.001, 1.0);\n",y+="    float NdotV = abs(dot(n, v)) + 0.001;\n",y+="    float NdotH = clamp(dot(n, h), 0.0, 1.0);\n",y+="    float LdotH = clamp(dot(l, h), 0.0, 1.0);\n",y+="    float VdotH = clamp(dot(v, h), 0.0, 1.0);\n",y+="    vec3 f0 = vec3(0.04);\n",p?(y+="    float roughness = 1.0 - glossiness;\n",y+="    vec3 diffuseColor = diffuse.rgb * (1.0 - max(max(specular.r, specular.g), specular.b));\n",y+="    vec3 specularColor = specular;\n"):(y+="    vec3 diffuseColor = baseColor * (1.0 - metalness) * (1.0 - f0);\n",y+="    vec3 specularColor = mix(f0, baseColor, metalness);\n"),y+="    float alpha = roughness * roughness;\n",y+="    float reflectance = max(max(specularColor.r, specularColor.g), specularColor.b);\n",y+="    vec3 r90 = vec3(clamp(reflectance * 25.0, 0.0, 1.0));\n",y+="    vec3 r0 = specularColor.rgb;\n",y+="    vec3 F = fresnelSchlick2(r0, r90, VdotH);\n",y+="    float G = smithVisibilityGGX(alpha, NdotL, NdotV);\n",y+="    float D = GGX(alpha, NdotH);\n",y+="    vec3 diffuseContribution = (1.0 - F) * lambertianDiffuse(diffuseColor);\n",y+="    vec3 specularContribution = F * G * D / (4.0 * NdotL * NdotV);\n",y+="    vec3 color = NdotL * lightColor * (diffuseContribution + specularContribution);\n",y+="#if defined(USE_IBL_LIGHTING) && !defined(DIFFUSE_IBL) && !defined(SPECULAR_IBL) \n",y+="    vec3 positionWC = vec3(czm_inverseView * vec4(v_positionEC, 1.0));\n",y+="    vec3 r = normalize(czm_inverseViewRotation * normalize(reflect(v, n)));\n",y+="    czm_ellipsoid ellipsoid = czm_getWgs84EllipsoidEC();\n",y+="    float vertexRadius = length(positionWC);\n",y+="    float horizonDotNadir = 1.0 - min(1.0, ellipsoid.radii.x / vertexRadius);\n",y+="    float reflectionDotNadir = dot(r, normalize(positionWC));\n",y+="    r.x = -r.x;\n",y+="    r = -normalize(czm_temeToPseudoFixed * r);\n",y+="    r.x = -r.x;\n",y+="    float inverseRoughness = 1.04 - roughness;\n",y+="    inverseRoughness *= inverseRoughness;\n",y+="    vec3 sceneSkyBox = textureCube(czm_environmentMap, r).rgb * inverseRoughness;\n",y+="    float atmosphereHeight = 0.05;\n",y+="    float blendRegionSize = 0.1 * ((1.0 - inverseRoughness) * 8.0 + 1.1 - horizonDotNadir);\n",y+="    float blendRegionOffset = roughness * -1.0;\n",y+="    float farAboveHorizon = clamp(horizonDotNadir - blendRegionSize * 0.5 + blendRegionOffset, 1.0e-10 - blendRegionSize, 0.99999);\n",y+="    float aroundHorizon = clamp(horizonDotNadir + blendRegionSize * 0.5, 1.0e-10 - blendRegionSize, 0.99999);\n",y+="    float farBelowHorizon = clamp(horizonDotNadir + blendRegionSize * 1.5, 1.0e-10 - blendRegionSize, 0.99999);\n",y+="    float smoothstepHeight = smoothstep(0.0, atmosphereHeight, horizonDotNadir);\n",y+="    vec3 belowHorizonColor = mix(vec3(0.1, 0.15, 0.25), vec3(0.4, 0.7, 0.9), smoothstepHeight);\n",y+="    vec3 nadirColor = belowHorizonColor * 0.5;\n",y+="    vec3 aboveHorizonColor = mix(vec3(0.9, 1.0, 1.2), belowHorizonColor, roughness * 0.5);\n",y+="    vec3 blueSkyColor = mix(vec3(0.18, 0.26, 0.48), aboveHorizonColor, reflectionDotNadir * inverseRoughness * 0.5 + 0.75);\n",y+="    vec3 zenithColor = mix(blueSkyColor, sceneSkyBox, smoothstepHeight);\n",y+="    vec3 blueSkyDiffuseColor = vec3(0.7, 0.85, 0.9);\n",y+="    float diffuseIrradianceFromEarth = (1.0 - horizonDotNadir) * (reflectionDotNadir * 0.25 + 0.75) * smoothstepHeight;\n",y+="    float diffuseIrradianceFromSky = (1.0 - smoothstepHeight) * (1.0 - (reflectionDotNadir * 0.25 + 0.25));\n",y+="    vec3 diffuseIrradiance = blueSkyDiffuseColor * clamp(diffuseIrradianceFromEarth + diffuseIrradianceFromSky, 0.0, 1.0);\n",y+="    float notDistantRough = (1.0 - horizonDotNadir * roughness * 0.8);\n",y+="    vec3 specularIrradiance = mix(zenithColor, aboveHorizonColor, smoothstep(farAboveHorizon, aroundHorizon, reflectionDotNadir) * notDistantRough);\n",y+="    specularIrradiance = mix(specularIrradiance, belowHorizonColor, smoothstep(aroundHorizon, farBelowHorizon, reflectionDotNadir) * inverseRoughness);\n",y+="    specularIrradiance = mix(specularIrradiance, nadirColor, smoothstep(farBelowHorizon, 1.0, reflectionDotNadir) * inverseRoughness);\n",y+="#ifdef USE_SUN_LUMINANCE \n",y+="    float LdotZenith = clamp(dot(normalize(czm_inverseViewRotation * l), normalize(positionWC * -1.0)), 0.001, 1.0);\n",y+="    float S = acos(LdotZenith);\n",y+="    float NdotZenith = clamp(dot(normalize(czm_inverseViewRotation * n), normalize(positionWC * -1.0)), 0.001, 1.0);\n",y+="    float gamma = acos(NdotL);\n",y+="    float numerator = ((0.91 + 10.0 * exp(-3.0 * gamma) + 0.45 * pow(NdotL, 2.0)) * (1.0 - exp(-0.32 / NdotZenith)));\n",y+="    float denominator = (0.91 + 10.0 * exp(-3.0 * S) + 0.45 * pow(LdotZenith,2.0)) * (1.0 - exp(-0.32));\n",y+="    float luminance = gltf_luminanceAtZenith * (numerator / denominator);\n",y+="#endif \n",y+="    vec2 brdfLut = texture2D(czm_brdfLut, vec2(NdotV, 1.0 - roughness)).rg;\n",y+="    vec3 IBLColor = (diffuseIrradiance * diffuseColor * gltf_iblFactor.x) + (specularIrradiance * SRGBtoLINEAR3(specularColor * brdfLut.x + brdfLut.y) * gltf_iblFactor.y);\n",y+="#ifdef USE_SUN_LUMINANCE \n",y+="    color += IBLColor * luminance;\n",y+="#else \n",y+="    color += IBLColor; \n",y+="#endif \n",y+="#elif defined(DIFFUSE_IBL) || defined(SPECULAR_IBL) \n",y+="    mat3 fixedToENU = mat3(gltf_clippingPlanesMatrix[0][0], gltf_clippingPlanesMatrix[1][0], gltf_clippingPlanesMatrix[2][0], \n",y+="                           gltf_clippingPlanesMatrix[0][1], gltf_clippingPlanesMatrix[1][1], gltf_clippingPlanesMatrix[2][1], \n",y+="                           gltf_clippingPlanesMatrix[0][2], gltf_clippingPlanesMatrix[1][2], gltf_clippingPlanesMatrix[2][2]); \n",fx.isBIMMode?(y+="    const mat3 yUpToZUp = mat3(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, -1.0, 0.0); \n",y+="    const mat3 rotationZ = mat3(-1.0, 0.0, 0.0, 0.0, -1.0, 0.0, 0.0, 0.0, 1.0); \n",y+="    vec3 cubeDir = normalize(rotationZ * yUpToZUp * fixedToENU * normalize(reflect(-v, n))); \n"):(y+="    const mat3 yUpToZUp = mat3(-1.0, 0.0, 0.0, 0.0, 0.0, -1.0, 0.0, 1.0, 0.0); \n",y+="    vec3 cubeDir = normalize(yUpToZUp * fixedToENU * normalize(reflect(-v, n))); \n"),y+="#ifdef DIFFUSE_IBL \n",y+="#ifdef CUSTOM_SPHERICAL_HARMONICS \n",y+="    vec3 diffuseIrradiance = czm_sphericalHarmonics(cubeDir, gltf_sphericalHarmonicCoefficients); \n",y+="#else \n",y+="    vec3 diffuseIrradiance = czm_sphericalHarmonics(cubeDir, czm_sphericalHarmonicCoefficients); \n",y+="#endif \n",y+="#else \n",y+="    vec3 diffuseIrradiance = vec3(0.0); \n",y+="#endif \n",y+="#ifdef SPECULAR_IBL \n",y+="    vec2 brdfLut = texture2D(czm_brdfLut, vec2(NdotV, roughness)).rg;\n",y+="#ifdef CUSTOM_SPECULAR_IBL \n",y+="    vec3 specularIBL = czm_sampleOctahedralProjection(gltf_specularMap, gltf_specularMapSize, cubeDir,  roughness * gltf_maxSpecularLOD, gltf_maxSpecularLOD);\n",y+="#else \n",y+="    vec3 specularIBL = czm_sampleOctahedralProjection(czm_specularEnvironmentMaps, czm_specularEnvironmentMapSize, cubeDir,  roughness * czm_specularEnvironmentMapsMaximumLOD, czm_specularEnvironmentMapsMaximumLOD);\n",y+="#endif \n",y+="    specularIBL *= F * brdfLut.x + brdfLut.y;\n",y+="#else \n",y+="    vec3 specularIBL = vec3(0.0); \n",y+="#endif \n",y+="    color += diffuseIrradiance * diffuseColor + specularColor * specularIBL;\n",y+="#endif \n"):(y+="    vec3 v = -normalize(v_positionEC);\n",y+="#ifndef USE_CUSTOM_LIGHT_COLOR \n",y+="    vec3 lightColor = vec3(1.5, 1.4, 1.2);\n",y+="#else \n",y+="    vec3 lightColor = gltf_lightColor;\n",y+="#endif \n",y+="    lightColor *= czm_lightScaleFactor;\n",y+="    vec3 l = normalize(czm_sunDirectionEC);\n",y+="    vec3 h = normalize(v + l);\n",y+="    vec3 f0 = vec3(0.04);\n",p?(y+="    float roughness = 1.0 - glossiness;\n",y+="    vec3 diffuseColor = diffuse.rgb * (1.0 - max(max(specular.r, specular.g), specular.b));\n",y+="    vec3 specularColor = specular;\n"):(y+="    vec3 diffuseColor = baseColor * (1.0 - metalness) * (1.0 - f0);\n",y+="    vec3 specularColor = mix(f0, baseColor, metalness);\n"),y+="    vec3 ambient = czm_ambientLight * lightColor * diffuseColor;\n",y+="    float diff = max(dot(n, h),0.0);\n",y+="    vec3 diffuse = lightColor * diff * diffuseColor;\n",y+="    float shininess = pow(2.0,(1.0- roughness) * 10.0);\n",y+="    vec3 halfwayDir = normalize(v + h);\n",y+="    float spec = pow(max(dot(n, halfwayDir),0.0),shininess);\n",y+="    vec3 specular = lightColor * spec * specularColor;\n",y+="    vec3 color = ambient + diffuse + specular;\n");M||(Object(u.a)(n.u_occlusionTexture)&&(y+="    color *= texture2D(u_occlusionTexture, "+q+").r;\n"),Object(u.a)(n.u_emissiveTexture)?(y+="    vec3 emissive = SRGBtoLINEAR3(texture2D(u_emissiveTexture, "+q+").rgb);\n",Object(u.a)(n.u_emissiveFactor)&&(y+="    emissive *= u_emissiveFactor;\n"),y+="    color += emissive;\n"):Object(u.a)(n.u_emissiveFactor)&&(y+="    color += u_emissiveFactor;\n"));y+="    color = LINEARtoSRGB(color);\n";y+="float eachHeight = clamp(posMC.z / gradualOffset,0.0,0.8);\nvec3 temp = mix(startColor,endColor,eachHeight); \nvec4 final_color = vec4(0.0);\n",y+=I?"vec4 mainColor = vec4(temp,1.0)  + vec4(NdotL * lightColor * (diffuseContribution + specularContribution),0.0); \n":"vec4 mainColor = vec4(temp,1.0); \n";Object(u.a)(N)?"MASK"===N?(y+="    if (baseColorWithAlpha.a < u_alphaCutoff) {\n",y+="        discard;\n",y+="    }\n",y+="    final_color = vec4(color, 1.0);\n"):y+="BLEND"===N?"    final_color = vec4(color, baseColorWithAlpha.a);\n":"    final_color = vec4(color, 1.0);\n":y+="    final_color = vec4(color, 1.0);\n";y+=" if(useGradual){ \n",y+="    gl_FragColor = mainColor; \n",y+=" }else {\n",y+="    gl_FragColor = final_color;\n",y+=" }\n",y+=" if(planView && czm_cameraPicth<-1.4){\n",y+="     gl_FragColor = vec4(mix(startColor,endColor,0.5), 1.0);\n",y+=" }\n",y+="}\n";var J=tZ(d,{type:un.VERTEX_SHADER,extras:{_pipeline:{source:b,extension:".glsl"}}}),$=tZ(d,{type:un.FRAGMENT_SHADER,extras:{_pipeline:{source:y,extension:".glsl"}}}),ee=tZ(f,{fragmentShader:$,vertexShader:J});return tZ(h,{attributes:W,program:ee,uniforms:L})}(e,n,r,o,i,t),Object(u.a)(n.extensions)||(n.extensions={}),n.extensions.KHR_techniques_webgl={values:o,technique:a}})),wQ.ensureSemanticExistence(e),e};var SQ=function(e){this.offset=e.offset,this.count=e.count,this.color=e.color,this.batchIds=e.batchIds},AQ="attribute vec3 position;\nattribute float a_batchId;\nuniform mat4 u_modifiedModelViewProjection;\nvoid main()\n{\ngl_Position = czm_depthClampFarPlane(u_modifiedModelViewProjection * vec4(position, 1.0));\n}\n",PQ={};!function(e){var t=function(e,t){var i=new Error(e+" at character "+t);throw i.index=t,i.description=e,i},i={"-":!0,"!":!0,"~":!0,"+":!0},n={"||":1,"&&":2,"|":3,"^":4,"&":5,"==":6,"!=":6,"===":6,"!==":6,"<":7,">":7,"<=":7,">=":7,"<<":8,">>":8,">>>":8,"+":9,"-":9,"*":10,"/":10,"%":10},r=function(e){var t,i=0;for(var n in e)(t=n.length)>i&&e.hasOwnProperty(n)&&(i=t);return i},a=r(i),o=r(n),s={true:!0,false:!1,null:null},c=function(e){return n[e]||0},l=function(e,t,i){return{type:"||"===e||"&&"===e?"LogicalExpression":"BinaryExpression",operator:e,left:t,right:i}},u=function(e){return e>=48&&e<=57},h=function(e){return 36===e||95===e||e>=65&&e<=90||e>=97&&e<=122||e>=128&&!n[String.fromCharCode(e)]},d=function(e){return 36===e||95===e||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||e>=128&&!n[String.fromCharCode(e)]},f=function(e){for(var r,f,p=0,m=e.charAt,_=e.charCodeAt,g=function(t){return m.call(e,t)},v=function(t){return _.call(e,t)},b=e.length,y=function(){for(var e=v(p);32===e||9===e;)e=v(++p)},w=function(){var e,i,n=x();return y(),63!==v(p)?n:(p++,(e=w())||t("Expected expression",p),y(),58===v(p)?(p++,(i=w())||t("Expected expression",p),{type:"ConditionalExpression",test:n,consequent:e,alternate:i}):void t("Expected :",p))},O=function(){y();for(var t=e.substr(p,o),i=t.length;i>0;){if(n.hasOwnProperty(t))return p+=i,t;t=t.substr(0,--i)}return!1},x=function(){var e,i,n,r,a,o,s,u;if(o=E(),!(i=O()))return o;for(a={value:i,prec:c(i)},(s=E())||t("Expected expression after "+i,p),r=[o,a,s];(i=O())&&0!==(n=c(i));){for(a={value:i,prec:n};r.length>2&&n<=r[r.length-2].prec;)s=r.pop(),i=r.pop().value,o=r.pop(),e=l(i,o,s),r.push(e);(e=E())||t("Expected expression after "+i,p),r.push(a,e)}for(e=r[u=r.length-1];u>1;)e=l(r[u-1].value,r[u-2],e),u-=2;return e},E=function(){var t,n,r;if(y(),t=v(p),u(t)||46===t)return T();if(39===t||34===t)return C();if(h(t)||40===t)return P();if(91===t)return D();for(r=(n=e.substr(p,a)).length;r>0;){if(i.hasOwnProperty(n))return p+=r,{type:"UnaryExpression",operator:n,argument:E(),prefix:!0};n=n.substr(0,--r)}return!1},T=function(){for(var e,i,n="";u(v(p));)n+=g(p++);if(46===v(p))for(n+=g(p++);u(v(p));)n+=g(p++);if("e"===(e=g(p))||"E"===e){for(n+=g(p++),"+"!==(e=g(p))&&"-"!==e||(n+=g(p++));u(v(p));)n+=g(p++);u(v(p-1))||t("Expected exponent ("+n+g(p)+")",p)}return i=v(p),h(i)?t("Variable names cannot start with a number ("+n+g(p)+")",p):46===i&&t("Unexpected period",p),{type:"Literal",value:parseFloat(n),raw:n}},C=function(){for(var e,i="",n=g(p++),r=!1;p<b;){if((e=g(p++))===n){r=!0;break}if("\\"===e)switch(e=g(p++)){case"n":i+="\n";break;case"r":i+="\r";break;case"t":i+="\t";break;case"b":i+="\b";break;case"f":i+="\f";break;case"v":i+="\v";break;default:i+="\\"+e}else i+=e}return r||t('Unclosed quote after "'+i+'"',p),{type:"Literal",value:i,raw:n+i+n}},S=function(){var i,n=v(p),r=p;for(h(n)?p++:t("Unexpected "+g(p),p);p<b&&(n=v(p),d(n));)p++;return i=e.slice(r,p),s.hasOwnProperty(i)?{type:"Literal",value:s[i],raw:i}:"this"===i?{type:"ThisExpression"}:{type:"Identifier",name:i}},A=function(e){for(var i,n,r=[],a=!1;p<b;){if(y(),(i=v(p))===e){a=!0,p++;break}44===i?p++:((n=w())&&"Compound"!==n.type||t("Expected comma",p),r.push(n))}return a||t("Expected "+String.fromCharCode(e),p),r},P=function(){var e,i;for(i=40===(e=v(p))?I():S(),y(),e=v(p);46===e||91===e||40===e;)p++,46===e?(y(),i={type:"MemberExpression",computed:!1,object:i,property:S()}):91===e?(i={type:"MemberExpression",computed:!0,object:i,property:w()},y(),93!==(e=v(p))&&t("Unclosed [",p),p++):40===e&&(i={type:"CallExpression",arguments:A(41),callee:i}),y(),e=v(p);return i},I=function(){p++;var e=w();if(y(),41===v(p))return p++,e;t("Unclosed (",p)},D=function(){return p++,{type:"ArrayExpression",elements:A(93)}},j=[];p<b;)59===(r=v(p))||44===r?p++:(f=w())?j.push(f):p<b&&t('Unexpected "'+g(p)+'"',p);return 1===j.length?j[0]:{type:"Compound",body:j}};f.version="0.3.1",f.toString=function(){return"JavaScript Expression Parser (JSEP) v"+f.version},f.addUnaryOp=function(e){return a=Math.max(e.length,a),i[e]=!0,this},f.addBinaryOp=function(e,t){return o=Math.max(e.length,o),n[e]=t,this},f.addLiteral=function(e,t){return s[e]=t,this},f.removeUnaryOp=function(e){return delete i[e],e.length===a&&(a=r(i)),this},f.removeAllUnaryOps=function(){return i={},a=0,this},f.removeBinaryOp=function(e){return delete n[e],e.length===o&&(o=r(n)),this},f.removeAllBinaryOps=function(){return n={},o=0,this},f.removeLiteral=function(e){return delete s[e],this},f.removeAllLiterals=function(){return s={},this},e.jsep=f}(PQ);var IQ=PQ.jsep,DQ=Object(E.a)({VARIABLE:0,UNARY:1,BINARY:2,TERNARY:3,CONDITIONAL:4,MEMBER:5,FUNCTION_CALL:6,ARRAY:7,REGEX:8,VARIABLE_IN_STRING:9,LITERAL_NULL:10,LITERAL_BOOLEAN:11,LITERAL_NUMBER:12,LITERAL_STRING:13,LITERAL_COLOR:14,LITERAL_VECTOR:15,LITERAL_REGEX:16,LITERAL_UNDEFINED:17,BUILTIN_VARIABLE:18});function jQ(e,t){var i;x.a.typeOf.string("expression",e),this._expression=e,e=function(e){var t=e,i="",n=t.indexOf("${");for(;n>=0;){var r,a=t.indexOf("'"),o=t.indexOf('"');if(a>=0&&a<n)r=t.indexOf("'",a+1),i+=t.substr(0,r+1),t=t.substr(r+1),n=t.indexOf("${");else if(o>=0&&o<n)r=t.indexOf('"',o+1),i+=t.substr(0,r+1),t=t.substr(r+1),n=t.indexOf("${");else{i+=t.substr(0,n);var s=t.indexOf("}");if(s<0)throw new Ce.a("Unmatched {.");i+="czm_"+t.substr(n+2,s-(n+2)),t=t.substr(s+1),n=t.indexOf("${")}}return i+=t}(function(e){return e.replace(FQ,kQ)}(e=function(e,t){if(!Object(u.a)(t))return e;for(var i in t)if(t.hasOwnProperty(i)){var n=new RegExp("\\$\\{"+i+"\\}","g"),r="("+t[i]+")";Object(u.a)(r)&&(e=e.replace(n,r))}return e}(e,t))),IQ.addBinaryOp("=~",0),IQ.addBinaryOp("!~",0);try{i=IQ(e)}catch(e){throw new Ce.a(e)}this._runtimeAst=JQ(this,i)}Object(O.a)(jQ.prototype,{expression:{get:function(){return this._expression}}});var MQ={arrayIndex:0,arrayArray:[[]],cartesian2Index:0,cartesian3Index:0,cartesian4Index:0,cartesian2Array:[new Rt],cartesian3Array:[new z],cartesian4Array:[new Te],reset:function(){this.arrayIndex=0,this.cartesian2Index=0,this.cartesian3Index=0,this.cartesian4Index=0},getArray:function(){this.arrayIndex>=this.arrayArray.length&&this.arrayArray.push([]);var e=this.arrayArray[this.arrayIndex++];return e.length=0,e},getCartesian2:function(){return this.cartesian2Index>=this.cartesian2Array.length&&this.cartesian2Array.push(new Rt),this.cartesian2Array[this.cartesian2Index++]},getCartesian3:function(){return this.cartesian3Index>=this.cartesian3Array.length&&this.cartesian3Array.push(new z),this.cartesian3Array[this.cartesian3Index++]},getCartesian4:function(){return this.cartesian4Index>=this.cartesian4Array.length&&this.cartesian4Array.push(new Te),this.cartesian4Array[this.cartesian4Index++]}};jQ.prototype.evaluate=function(e,t){MQ.reset();var i=this._runtimeAst.evaluate(e);return t instanceof uf&&i instanceof Te?uf.fromCartesian4(i,t):i instanceof Rt||i instanceof z||i instanceof Te?i.clone(t):i},jQ.prototype.evaluateColor=function(e,t){MQ.reset();var i=this._runtimeAst.evaluate(e);return uf.fromCartesian4(i,t)},jQ.prototype.getShaderFunction=function(e,t,i,n){var r=this.getShaderExpression(t,i);return r=n+" "+e+"() \n{ \n    return "+r+"; \n} \n"},jQ.prototype.getShaderExpression=function(e,t){return this._runtimeAst.getShaderExpression(e,t)};var RQ=["!","-","+"],LQ=["+","-","*","/","%","===","!==",">",">=","<","<=","&&","||","!~","=~"],NQ=/\${(.*?)}/g,FQ=/\\/g,kQ="@#%",BQ=/@#%/g,zQ=new uf,UQ={abs:GQ(Math.abs),sqrt:GQ(Math.sqrt),cos:GQ(Math.cos),sin:GQ(Math.sin),tan:GQ(Math.tan),acos:GQ(Math.acos),asin:GQ(Math.asin),atan:GQ(Math.atan),radians:GQ(I.toRadians),degrees:GQ(I.toDegrees),sign:GQ(I.sign),floor:GQ(Math.floor),ceil:GQ(Math.ceil),round:GQ(Math.round),exp:GQ(Math.exp),exp2:GQ((function(e){return Math.pow(2,e)})),log:GQ(Math.log),log2:GQ((function(e){return I.log2(e)})),fract:GQ((function(e){return e-Math.floor(e)})),length:function(e,t){if("number"==typeof t)return Math.abs(t);if(t instanceof Rt)return Rt.magnitude(t);if(t instanceof z)return z.magnitude(t);if(t instanceof Te)return Te.magnitude(t);throw new Ce.a('Function "'+e+'" requires a vector or number argument. Argument is '+t+".")},normalize:function(e,t){if("number"==typeof t)return 1;if(t instanceof Rt)return Rt.normalize(t,MQ.getCartesian2());if(t instanceof z)return z.normalize(t,MQ.getCartesian3());if(t instanceof Te)return Te.normalize(t,MQ.getCartesian4());throw new Ce.a('Function "'+e+'" requires a vector or number argument. Argument is '+t+".")}},VQ={atan2:qQ(Math.atan2,!1),pow:qQ(Math.pow,!1),min:qQ(Math.min,!0),max:qQ(Math.max,!0),distance:function(e,t,i){if("number"==typeof t&&"number"==typeof i)return Math.abs(t-i);if(t instanceof Rt&&i instanceof Rt)return Rt.distance(t,i);if(t instanceof z&&i instanceof z)return z.distance(t,i);if(t instanceof Te&&i instanceof Te)return Te.distance(t,i);throw new Ce.a('Function "'+e+'" requires vector or number arguments of matching types. Arguments are '+t+" and "+i+".")},dot:function(e,t,i){if("number"==typeof t&&"number"==typeof i)return t*i;if(t instanceof Rt&&i instanceof Rt)return Rt.dot(t,i);if(t instanceof z&&i instanceof z)return z.dot(t,i);if(t instanceof Te&&i instanceof Te)return Te.dot(t,i);throw new Ce.a('Function "'+e+'" requires vector or number arguments of matching types. Arguments are '+t+" and "+i+".")},cross:function(e,t,i){if(t instanceof z&&i instanceof z)return z.cross(t,i,MQ.getCartesian3());throw new Ce.a('Function "'+e+'" requires vec3 arguments. Arguments are '+t+" and "+i+".")}},HQ={clamp:WQ(I.clamp,!0),mix:WQ(I.lerp,!0)};function GQ(e){return function(t,i){if("number"==typeof i)return e(i);if(i instanceof Rt)return Rt.fromElements(e(i.x),e(i.y),MQ.getCartesian2());if(i instanceof z)return z.fromElements(e(i.x),e(i.y),e(i.z),MQ.getCartesian3());if(i instanceof Te)return Te.fromElements(e(i.x),e(i.y),e(i.z),e(i.w),MQ.getCartesian4());throw new Ce.a('Function "'+t+'" requires a vector or number argument. Argument is '+i+".")}}function qQ(e,t){return function(i,n,r){if(t&&"number"==typeof r){if("number"==typeof n)return e(n,r);if(n instanceof Rt)return Rt.fromElements(e(n.x,r),e(n.y,r),MQ.getCartesian2());if(n instanceof z)return z.fromElements(e(n.x,r),e(n.y,r),e(n.z,r),MQ.getCartesian3());if(n instanceof Te)return Te.fromElements(e(n.x,r),e(n.y,r),e(n.z,r),e(n.w,r),MQ.getCartesian4())}if("number"==typeof n&&"number"==typeof r)return e(n,r);if(n instanceof Rt&&r instanceof Rt)return Rt.fromElements(e(n.x,r.x),e(n.y,r.y),MQ.getCartesian2());if(n instanceof z&&r instanceof z)return z.fromElements(e(n.x,r.x),e(n.y,r.y),e(n.z,r.z),MQ.getCartesian3());if(n instanceof Te&&r instanceof Te)return Te.fromElements(e(n.x,r.x),e(n.y,r.y),e(n.z,r.z),e(n.w,r.w),MQ.getCartesian4());throw new Ce.a('Function "'+i+'" requires vector or number arguments of matching types. Arguments are '+n+" and "+r+".")}}function WQ(e,t){return function(i,n,r,a){if(t&&"number"==typeof a){if("number"==typeof n&&"number"==typeof r)return e(n,r,a);if(n instanceof Rt&&r instanceof Rt)return Rt.fromElements(e(n.x,r.x,a),e(n.y,r.y,a),MQ.getCartesian2());if(n instanceof z&&r instanceof z)return z.fromElements(e(n.x,r.x,a),e(n.y,r.y,a),e(n.z,r.z,a),MQ.getCartesian3());if(n instanceof Te&&r instanceof Te)return Te.fromElements(e(n.x,r.x,a),e(n.y,r.y,a),e(n.z,r.z,a),e(n.w,r.w,a),MQ.getCartesian4())}if("number"==typeof n&&"number"==typeof r&&"number"==typeof a)return e(n,r,a);if(n instanceof Rt&&r instanceof Rt&&a instanceof Rt)return Rt.fromElements(e(n.x,r.x,a.x),e(n.y,r.y,a.y),MQ.getCartesian2());if(n instanceof z&&r instanceof z&&a instanceof z)return z.fromElements(e(n.x,r.x,a.x),e(n.y,r.y,a.y),e(n.z,r.z,a.z),MQ.getCartesian3());if(n instanceof Te&&r instanceof Te&&a instanceof Te)return Te.fromElements(e(n.x,r.x,a.x),e(n.y,r.y,a.y),e(n.z,r.z,a.z),e(n.w,r.w,a.w),MQ.getCartesian4());throw new Ce.a('Function "'+i+'" requires vector or number arguments of matching types. Arguments are '+n+", "+r+", and "+a+".")}}function YQ(e,t,i,n,r){var a,o,s;this._type=e,this._value=t,this._left=i,this._right=n,this._test=r,this.evaluate=void 0,(a=this)._type===DQ.CONDITIONAL?a.evaluate=a._evaluateConditional:a._type===DQ.FUNCTION_CALL?"test"===a._value?a.evaluate=a._evaluateRegExpTest:"exec"===a._value?a.evaluate=a._evaluateRegExpExec:"toString"===a._value&&(a.evaluate=a._evaluateToString):a._type===DQ.UNARY?"!"===a._value?a.evaluate=a._evaluateNot:"-"===a._value?a.evaluate=a._evaluateNegative:"+"===a._value?a.evaluate=a._evaluatePositive:"isNaN"===a._value?a.evaluate=a._evaluateNaN:"isFinite"===a._value?a.evaluate=a._evaluateIsFinite:"isExactClass"===a._value?a.evaluate=a._evaluateIsExactClass:"isClass"===a._value?a.evaluate=a._evaluateIsClass:"getExactClassName"===a._value?a.evaluate=a._evaluateGetExactClassName:"Boolean"===a._value?a.evaluate=a._evaluateBooleanConversion:"Number"===a._value?a.evaluate=a._evaluateNumberConversion:"String"===a._value?a.evaluate=a._evaluateStringConversion:Object(u.a)(UQ[a._value])&&(a.evaluate=(o=a._value,s=UQ[o],function(e){var t=this._left.evaluate(e);return s(o,t)})):a._type===DQ.BINARY?"+"===a._value?a.evaluate=a._evaluatePlus:"-"===a._value?a.evaluate=a._evaluateMinus:"*"===a._value?a.evaluate=a._evaluateTimes:"/"===a._value?a.evaluate=a._evaluateDivide:"%"===a._value?a.evaluate=a._evaluateMod:"==="===a._value?a.evaluate=a._evaluateEqualsStrict:"!=="===a._value?a.evaluate=a._evaluateNotEqualsStrict:"<"===a._value?a.evaluate=a._evaluateLessThan:"<="===a._value?a.evaluate=a._evaluateLessThanOrEquals:">"===a._value?a.evaluate=a._evaluateGreaterThan:">="===a._value?a.evaluate=a._evaluateGreaterThanOrEquals:"&&"===a._value?a.evaluate=a._evaluateAnd:"||"===a._value?a.evaluate=a._evaluateOr:"=~"===a._value?a.evaluate=a._evaluateRegExpMatch:"!~"===a._value?a.evaluate=a._evaluateRegExpNotMatch:Object(u.a)(VQ[a._value])&&(a.evaluate=function(e){var t=VQ[e];return function(i){var n=this._left.evaluate(i),r=this._right.evaluate(i);return t(e,n,r)}}(a._value)):a._type===DQ.TERNARY?a.evaluate=function(e){var t=HQ[e];return function(i){var n=this._left.evaluate(i),r=this._right.evaluate(i),a=this._test.evaluate(i);return t(e,n,r,a)}}(a._value):a._type===DQ.MEMBER?"brackets"===a._value?a.evaluate=a._evaluateMemberBrackets:a.evaluate=a._evaluateMemberDot:a._type===DQ.ARRAY?a.evaluate=a._evaluateArray:a._type===DQ.VARIABLE?a.evaluate=a._evaluateVariable:a._type===DQ.VARIABLE_IN_STRING?a.evaluate=a._evaluateVariableString:a._type===DQ.LITERAL_COLOR?a.evaluate=a._evaluateLiteralColor:a._type===DQ.LITERAL_VECTOR?a.evaluate=a._evaluateLiteralVector:a._type===DQ.LITERAL_STRING?a.evaluate=a._evaluateLiteralString:a._type===DQ.REGEX?a.evaluate=a._evaluateRegExp:a._type===DQ.BUILTIN_VARIABLE?"tiles3d_tileset_time"===a._value&&(a.evaluate=$Q):a.evaluate=a._evaluateLiteral}function XQ(e){return e.replace(BQ,"\\")}function ZQ(e,t){var i,n,r,a,o=t.arguments,s=o.length;if("MemberExpression"===t.callee.type){i=t.callee.property.name;var c=t.callee.object;if("test"===i||"exec"===i){if("regExp"!==c.callee.name)throw new Ce.a(i+" is not a function.");return 0===s?"test"===i?new YQ(DQ.LITERAL_BOOLEAN,!1):new YQ(DQ.LITERAL_NULL,null):(r=JQ(e,c),a=JQ(e,o[0]),new YQ(DQ.FUNCTION_CALL,i,r,a))}if("toString"===i)return n=JQ(e,c),new YQ(DQ.FUNCTION_CALL,i,n);throw new Ce.a('Unexpected function call "'+i+'".')}if("color"===(i=t.callee.name)){if(0===s)return new YQ(DQ.LITERAL_COLOR,i);if(n=JQ(e,o[0]),Object(u.a)(o[1])){var l=JQ(e,o[1]);return new YQ(DQ.LITERAL_COLOR,i,[n,l])}return new YQ(DQ.LITERAL_COLOR,i,[n])}if("rgb"===i||"hsl"===i){if(s<3)throw new Ce.a(i+" requires three arguments.");return n=[JQ(e,o[0]),JQ(e,o[1]),JQ(e,o[2])],new YQ(DQ.LITERAL_COLOR,i,n)}if("rgba"===i||"hsla"===i){if(s<4)throw new Ce.a(i+" requires four arguments.");return n=[JQ(e,o[0]),JQ(e,o[1]),JQ(e,o[2]),JQ(e,o[3])],new YQ(DQ.LITERAL_COLOR,i,n)}if("vec2"===i||"vec3"===i||"vec4"===i){n=new Array(s);for(var h=0;h<s;++h)n[h]=JQ(e,o[h]);return new YQ(DQ.LITERAL_VECTOR,i,n)}if("isNaN"===i||"isFinite"===i)return 0===s?new YQ(DQ.LITERAL_BOOLEAN,"isNaN"===i):(n=JQ(e,o[0]),new YQ(DQ.UNARY,i,n));if("isExactClass"===i||"isClass"===i){if(s<1||s>1)throw new Ce.a(i+" requires exactly one argument.");return n=JQ(e,o[0]),new YQ(DQ.UNARY,i,n)}if("getExactClassName"===i){if(s>0)throw new Ce.a(i+" does not take any argument.");return new YQ(DQ.UNARY,i)}if(Object(u.a)(UQ[i])){if(1!==s)throw new Ce.a(i+" requires exactly one argument.");return n=JQ(e,o[0]),new YQ(DQ.UNARY,i,n)}if(Object(u.a)(VQ[i])){if(2!==s)throw new Ce.a(i+" requires exactly two arguments.");return r=JQ(e,o[0]),a=JQ(e,o[1]),new YQ(DQ.BINARY,i,r,a)}if(Object(u.a)(HQ[i])){if(3!==s)throw new Ce.a(i+" requires exactly three arguments.");r=JQ(e,o[0]),a=JQ(e,o[1]);var d=JQ(e,o[2]);return new YQ(DQ.TERNARY,i,r,a,d)}if("Boolean"===i)return 0===s?new YQ(DQ.LITERAL_BOOLEAN,!1):(n=JQ(e,o[0]),new YQ(DQ.UNARY,i,n));if("Number"===i)return 0===s?new YQ(DQ.LITERAL_NUMBER,0):(n=JQ(e,o[0]),new YQ(DQ.UNARY,i,n));if("String"===i)return 0===s?new YQ(DQ.LITERAL_STRING,""):(n=JQ(e,o[0]),new YQ(DQ.UNARY,i,n));if("regExp"===i)return function(e,t){var i=t.arguments;if(0===i.length)return new YQ(DQ.LITERAL_REGEX,new RegExp);var n,r=JQ(e,i[0]);if(i.length>1){var a=JQ(e,i[1]);if(KQ(r)&&KQ(a)){try{n=new RegExp(XQ(String(r._value)),a._value)}catch(e){throw new Ce.a(e)}return new YQ(DQ.LITERAL_REGEX,n)}return new YQ(DQ.REGEX,r,a)}if(KQ(r)){try{n=new RegExp(XQ(String(r._value)))}catch(e){throw new Ce.a(e)}return new YQ(DQ.LITERAL_REGEX,n)}return new YQ(DQ.REGEX,r)}(e,t);throw new Ce.a('Unexpected function call "'+i+'".')}function QQ(e,t){if("Math"===t.object.name)return function(e){var t=e.property.name;return"PI"===t?new YQ(DQ.LITERAL_NUMBER,Math.PI):"E"===t?new YQ(DQ.LITERAL_NUMBER,Math.E):void 0}(t);if("Number"===t.object.name)return function(e){if("POSITIVE_INFINITY"===e.property.name)return new YQ(DQ.LITERAL_NUMBER,Number.POSITIVE_INFINITY)}(t);var i,n=JQ(e,t.object);return t.computed?(i=JQ(e,t.property),new YQ(DQ.MEMBER,"brackets",n,i)):(i=new YQ(DQ.LITERAL_STRING,t.property.name),new YQ(DQ.MEMBER,"dot",n,i))}function KQ(e){return e._type>=DQ.LITERAL_NULL}function JQ(e,t){var i,n,r,a;if("Literal"===t.type)i=function(e){var t=typeof e.value;return null===e.value?new YQ(DQ.LITERAL_NULL,null):"boolean"===t?new YQ(DQ.LITERAL_BOOLEAN,e.value):"number"===t?new YQ(DQ.LITERAL_NUMBER,e.value):"string"===t?e.value.indexOf("${")>=0?new YQ(DQ.VARIABLE_IN_STRING,e.value):new YQ(DQ.LITERAL_STRING,XQ(e.value)):void 0}(t);else if("CallExpression"===t.type)i=ZQ(e,t);else if("Identifier"===t.type)i=function(e){if(function(e){return"czm_"===e.substr(0,4)}(e.name)){var t=e.name.substr(4);return"tiles3d_"===t.substr(0,8)?new YQ(DQ.BUILTIN_VARIABLE,t):new YQ(DQ.VARIABLE,t)}if("NaN"===e.name)return new YQ(DQ.LITERAL_NUMBER,NaN);if("Infinity"===e.name)return new YQ(DQ.LITERAL_NUMBER,1/0);if("undefined"===e.name)return new YQ(DQ.LITERAL_UNDEFINED,void 0);throw new Ce.a(e.name+" is not defined.")}(t);else if("UnaryExpression"===t.type){n=t.operator;var o=JQ(e,t.argument);if(!(RQ.indexOf(n)>-1))throw new Ce.a('Unexpected operator "'+n+'".');i=new YQ(DQ.UNARY,n,o)}else if("BinaryExpression"===t.type){if(n=t.operator,r=JQ(e,t.left),a=JQ(e,t.right),!(LQ.indexOf(n)>-1))throw new Ce.a('Unexpected operator "'+n+'".');i=new YQ(DQ.BINARY,n,r,a)}else if("LogicalExpression"===t.type)n=t.operator,r=JQ(e,t.left),a=JQ(e,t.right),LQ.indexOf(n)>-1&&(i=new YQ(DQ.BINARY,n,r,a));else if("ConditionalExpression"===t.type){var s=JQ(e,t.test);r=JQ(e,t.consequent),a=JQ(e,t.alternate),i=new YQ(DQ.CONDITIONAL,"?",r,a,s)}else if("MemberExpression"===t.type)i=QQ(e,t);else{if("ArrayExpression"!==t.type)throw"Compound"===t.type?new Ce.a("Provide exactly one expression."):new Ce.a("Cannot parse expression.");for(var c=[],l=0;l<t.elements.length;l++)c[l]=JQ(e,t.elements[l]);i=new YQ(DQ.ARRAY,c)}return i}function $Q(e){return Object(u.a)(e)?e.content.tileset.timeSinceLoad:0}function eK(e,t){if(Object(u.a)(e))return e.getProperty(t)}function tK(e){return"feature"===e._value}function iK(e){for(var t=e._left,i=t.length,n=0;n<i;++n)if(t[n]._type!==DQ.LITERAL_NUMBER)return;var r=t[0]._value,a=t[1]._value,o=t[2]._value,s=4===i?t[3]._value:1;return uf.fromHsl(r,a,o,s,zQ)}function nK(e){for(var t=e._left,i=t.length,n=0;n<i;++n)if(t[n]._type!==DQ.LITERAL_NUMBER)return;var r=zQ;return r.red=t[0]._value/255,r.green=t[1]._value/255,r.blue=t[2]._value/255,r.alpha=4===i?t[3]._value:1,r}function rK(e){return e%1==0?e.toFixed(1):e.toString()}function aK(e){return"vec4("+rK(e.red)+", "+rK(e.green)+", "+rK(e.blue)+", "+rK(e.alpha)+")"}function oK(e,t,i,n){for(var r=e.length,a=new Array(r),o=0;o<r;++o)a[o]=e[o].getShaderExpression(t,i,n);return a}YQ.prototype._evaluateLiteral=function(){return this._value},YQ.prototype._evaluateLiteralColor=function(e){var t=zQ,i=this._left;if("color"===this._value)Object(u.a)(i)?i.length>1?(uf.fromCssColorString(i[0].evaluate(e),t),t.alpha=i[1].evaluate(e)):uf.fromCssColorString(i[0].evaluate(e),t):uf.fromBytes(255,255,255,255,t);else if("rgb"===this._value)uf.fromBytes(i[0].evaluate(e),i[1].evaluate(e),i[2].evaluate(e),255,t);else if("rgba"===this._value){var n=255*i[3].evaluate(e);uf.fromBytes(i[0].evaluate(e),i[1].evaluate(e),i[2].evaluate(e),n,t)}else"hsl"===this._value?uf.fromHsl(i[0].evaluate(e),i[1].evaluate(e),i[2].evaluate(e),1,t):"hsla"===this._value&&uf.fromHsl(i[0].evaluate(e),i[1].evaluate(e),i[2].evaluate(e),i[3].evaluate(e),t);return Te.fromColor(t,MQ.getCartesian4())},YQ.prototype._evaluateLiteralVector=function(e){for(var t=MQ.getArray(),i=this._value,n=this._left,r=n.length,a=0;a<r;++a){var o=n[a].evaluate(e);if("number"==typeof o)t.push(o);else if(o instanceof Rt)t.push(o.x,o.y);else if(o instanceof z)t.push(o.x,o.y,o.z);else{if(!(o instanceof Te))throw new Ce.a(i+" argument must be a vector or number. Argument is "+o+".");t.push(o.x,o.y,o.z,o.w)}}var s=t.length,c=parseInt(i.charAt(3));if(0===s)throw new Ce.a("Invalid "+i+" constructor. No valid arguments.");if(s<c&&s>1)throw new Ce.a("Invalid "+i+" constructor. Not enough arguments.");if(s>c&&r>1)throw new Ce.a("Invalid "+i+" constructor. Too many arguments.");if(1===s){var l=t[0];t.push(l,l,l)}return"vec2"===i?Rt.fromArray(t,0,MQ.getCartesian2()):"vec3"===i?z.fromArray(t,0,MQ.getCartesian3()):"vec4"===i?Te.fromArray(t,0,MQ.getCartesian4()):void 0},YQ.prototype._evaluateLiteralString=function(){return this._value},YQ.prototype._evaluateVariableString=function(e){for(var t=this._value,i=NQ.exec(t);null!==i;){var n=i[0],r=eK(e,i[1]);Object(u.a)(r)||(r=""),t=t.replace(n,r),i=NQ.exec(t)}return t},YQ.prototype._evaluateVariable=function(e){return eK(e,this._value)},YQ.prototype._evaluateMemberDot=function(e){if(tK(this._left))return eK(e,this._right.evaluate(e));var t=this._left.evaluate(e);if(Object(u.a)(t)){var i=this._right.evaluate(e);if(t instanceof Rt||t instanceof z||t instanceof Te){if("r"===i)return t.x;if("g"===i)return t.y;if("b"===i)return t.z;if("a"===i)return t.w}return t[i]}},YQ.prototype._evaluateMemberBrackets=function(e){if(tK(this._left))return eK(e,this._right.evaluate(e));var t=this._left.evaluate(e);if(Object(u.a)(t)){var i=this._right.evaluate(e);if(t instanceof Rt||t instanceof z||t instanceof Te){if(0===i||"r"===i)return t.x;if(1===i||"g"===i)return t.y;if(2===i||"b"===i)return t.z;if(3===i||"a"===i)return t.w}return t[i]}},YQ.prototype._evaluateArray=function(e){for(var t=[],i=0;i<this._value.length;i++)t[i]=this._value[i].evaluate(e);return t},YQ.prototype._evaluateNot=function(e){var t=this._left.evaluate(e);if("boolean"!=typeof t)throw new Ce.a('Operator "!" requires a boolean argument. Argument is '+t+".");return!t},YQ.prototype._evaluateNegative=function(e){var t=this._left.evaluate(e);if(t instanceof Rt)return Rt.negate(t,MQ.getCartesian2());if(t instanceof z)return z.negate(t,MQ.getCartesian3());if(t instanceof Te)return Te.negate(t,MQ.getCartesian4());if("number"==typeof t)return-t;throw new Ce.a('Operator "-" requires a vector or number argument. Argument is '+t+".")},YQ.prototype._evaluatePositive=function(e){var t=this._left.evaluate(e);if(!(t instanceof Rt||t instanceof z||t instanceof Te||"number"==typeof t))throw new Ce.a('Operator "+" requires a vector or number argument. Argument is '+t+".");return t},YQ.prototype._evaluateLessThan=function(e){var t=this._left.evaluate(e),i=this._right.evaluate(e);if("number"!=typeof t||"number"!=typeof i)throw new Ce.a('Operator "<" requires number arguments. Arguments are '+t+" and "+i+".");return t<i},YQ.prototype._evaluateLessThanOrEquals=function(e){var t=this._left.evaluate(e),i=this._right.evaluate(e);if("number"!=typeof t||"number"!=typeof i)throw new Ce.a('Operator "<=" requires number arguments. Arguments are '+t+" and "+i+".");return t<=i},YQ.prototype._evaluateGreaterThan=function(e){var t=this._left.evaluate(e),i=this._right.evaluate(e);if("number"!=typeof t||"number"!=typeof i)throw new Ce.a('Operator ">" requires number arguments. Arguments are '+t+" and "+i+".");return t>i},YQ.prototype._evaluateGreaterThanOrEquals=function(e){var t=this._left.evaluate(e),i=this._right.evaluate(e);if("number"!=typeof t||"number"!=typeof i)throw new Ce.a('Operator ">=" requires number arguments. Arguments are '+t+" and "+i+".");return t>=i},YQ.prototype._evaluateOr=function(e){var t=this._left.evaluate(e);if("boolean"!=typeof t)throw new Ce.a('Operator "||" requires boolean arguments. First argument is '+t+".");if(t)return!0;var i=this._right.evaluate(e);if("boolean"!=typeof i)throw new Ce.a('Operator "||" requires boolean arguments. Second argument is '+i+".");return t||i},YQ.prototype._evaluateAnd=function(e){var t=this._left.evaluate(e);if("boolean"!=typeof t)throw new Ce.a('Operator "&&" requires boolean arguments. First argument is '+t+".");if(!t)return!1;var i=this._right.evaluate(e);if("boolean"!=typeof i)throw new Ce.a('Operator "&&" requires boolean arguments. Second argument is '+i+".");return t&&i},YQ.prototype._evaluatePlus=function(e){var t=this._left.evaluate(e),i=this._right.evaluate(e);if(i instanceof Rt&&t instanceof Rt)return Rt.add(t,i,MQ.getCartesian2());if(i instanceof z&&t instanceof z)return z.add(t,i,MQ.getCartesian3());if(i instanceof Te&&t instanceof Te)return Te.add(t,i,MQ.getCartesian4());if("string"==typeof t||"string"==typeof i)return t+i;if("number"==typeof t&&"number"==typeof i)return t+i;throw new Ce.a('Operator "+" requires vector or number arguments of matching types, or at least one string argument. Arguments are '+t+" and "+i+".")},YQ.prototype._evaluateMinus=function(e){var t=this._left.evaluate(e),i=this._right.evaluate(e);if(i instanceof Rt&&t instanceof Rt)return Rt.subtract(t,i,MQ.getCartesian2());if(i instanceof z&&t instanceof z)return z.subtract(t,i,MQ.getCartesian3());if(i instanceof Te&&t instanceof Te)return Te.subtract(t,i,MQ.getCartesian4());if("number"==typeof t&&"number"==typeof i)return t-i;throw new Ce.a('Operator "-" requires vector or number arguments of matching types. Arguments are '+t+" and "+i+".")},YQ.prototype._evaluateTimes=function(e){var t=this._left.evaluate(e),i=this._right.evaluate(e);if(i instanceof Rt&&t instanceof Rt)return Rt.multiplyComponents(t,i,MQ.getCartesian2());if(i instanceof Rt&&"number"==typeof t)return Rt.multiplyByScalar(i,t,MQ.getCartesian2());if(t instanceof Rt&&"number"==typeof i)return Rt.multiplyByScalar(t,i,MQ.getCartesian2());if(i instanceof z&&t instanceof z)return z.multiplyComponents(t,i,MQ.getCartesian3());if(i instanceof z&&"number"==typeof t)return z.multiplyByScalar(i,t,MQ.getCartesian3());if(t instanceof z&&"number"==typeof i)return z.multiplyByScalar(t,i,MQ.getCartesian3());if(i instanceof Te&&t instanceof Te)return Te.multiplyComponents(t,i,MQ.getCartesian4());if(i instanceof Te&&"number"==typeof t)return Te.multiplyByScalar(i,t,MQ.getCartesian4());if(t instanceof Te&&"number"==typeof i)return Te.multiplyByScalar(t,i,MQ.getCartesian4());if("number"==typeof t&&"number"==typeof i)return t*i;throw new Ce.a('Operator "*" requires vector or number arguments. If both arguments are vectors they must be matching types. Arguments are '+t+" and "+i+".")},YQ.prototype._evaluateDivide=function(e){var t=this._left.evaluate(e),i=this._right.evaluate(e);if(i instanceof Rt&&t instanceof Rt)return Rt.divideComponents(t,i,MQ.getCartesian2());if(t instanceof Rt&&"number"==typeof i)return Rt.divideByScalar(t,i,MQ.getCartesian2());if(i instanceof z&&t instanceof z)return z.divideComponents(t,i,MQ.getCartesian3());if(t instanceof z&&"number"==typeof i)return z.divideByScalar(t,i,MQ.getCartesian3());if(i instanceof Te&&t instanceof Te)return Te.divideComponents(t,i,MQ.getCartesian4());if(t instanceof Te&&"number"==typeof i)return Te.divideByScalar(t,i,MQ.getCartesian4());if("number"==typeof t&&"number"==typeof i)return t/i;throw new Ce.a('Operator "/" requires vector or number arguments of matching types, or a number as the second argument. Arguments are '+t+" and "+i+".")},YQ.prototype._evaluateMod=function(e){var t=this._left.evaluate(e),i=this._right.evaluate(e);if(i instanceof Rt&&t instanceof Rt)return Rt.fromElements(t.x%i.x,t.y%i.y,MQ.getCartesian2());if(i instanceof z&&t instanceof z)return z.fromElements(t.x%i.x,t.y%i.y,t.z%i.z,MQ.getCartesian3());if(i instanceof Te&&t instanceof Te)return Te.fromElements(t.x%i.x,t.y%i.y,t.z%i.z,t.w%i.w,MQ.getCartesian4());if("number"==typeof t&&"number"==typeof i)return t%i;throw new Ce.a('Operator "%" requires vector or number arguments of matching types. Arguments are '+t+" and "+i+".")},YQ.prototype._evaluateEqualsStrict=function(e){var t=this._left.evaluate(e),i=this._right.evaluate(e);return i instanceof Rt&&t instanceof Rt||i instanceof z&&t instanceof z||i instanceof Te&&t instanceof Te?t.equals(i):t===i},YQ.prototype._evaluateNotEqualsStrict=function(e){var t=this._left.evaluate(e),i=this._right.evaluate(e);return i instanceof Rt&&t instanceof Rt||i instanceof z&&t instanceof z||i instanceof Te&&t instanceof Te?!t.equals(i):t!==i},YQ.prototype._evaluateConditional=function(e){var t=this._test.evaluate(e);if("boolean"!=typeof t)throw new Ce.a("Conditional argument of conditional expression must be a boolean. Argument is "+t+".");return t?this._left.evaluate(e):this._right.evaluate(e)},YQ.prototype._evaluateNaN=function(e){return isNaN(this._left.evaluate(e))},YQ.prototype._evaluateIsFinite=function(e){return isFinite(this._left.evaluate(e))},YQ.prototype._evaluateIsExactClass=function(e){return!!Object(u.a)(e)&&e.isExactClass(this._left.evaluate(e))},YQ.prototype._evaluateIsClass=function(e){return!!Object(u.a)(e)&&e.isClass(this._left.evaluate(e))},YQ.prototype._evaluateGetExactClassName=function(e){if(Object(u.a)(e))return e.getExactClassName()},YQ.prototype._evaluateBooleanConversion=function(e){return Boolean(this._left.evaluate(e))},YQ.prototype._evaluateNumberConversion=function(e){return Number(this._left.evaluate(e))},YQ.prototype._evaluateStringConversion=function(e){return String(this._left.evaluate(e))},YQ.prototype._evaluateRegExp=function(e){var t,i=this._value.evaluate(e),n="";Object(u.a)(this._left)&&(n=this._left.evaluate(e));try{t=new RegExp(i,n)}catch(e){throw new Ce.a(e)}return t},YQ.prototype._evaluateRegExpTest=function(e){var t=this._left.evaluate(e),i=this._right.evaluate(e);if(!(t instanceof RegExp&&"string"==typeof i))throw new Ce.a("RegExp.test requires the first argument to be a RegExp and the second argument to be a string. Arguments are "+t+" and "+i+".");return t.test(i)},YQ.prototype._evaluateRegExpMatch=function(e){var t=this._left.evaluate(e),i=this._right.evaluate(e);if(t instanceof RegExp&&"string"==typeof i)return t.test(i);if(i instanceof RegExp&&"string"==typeof t)return i.test(t);throw new Ce.a('Operator "=~" requires one RegExp argument and one string argument. Arguments are '+t+" and "+i+".")},YQ.prototype._evaluateRegExpNotMatch=function(e){var t=this._left.evaluate(e),i=this._right.evaluate(e);if(t instanceof RegExp&&"string"==typeof i)return!t.test(i);if(i instanceof RegExp&&"string"==typeof t)return!i.test(t);throw new Ce.a('Operator "!~" requires one RegExp argument and one string argument. Arguments are '+t+" and "+i+".")},YQ.prototype._evaluateRegExpExec=function(e){var t=this._left.evaluate(e),i=this._right.evaluate(e);if(!(t instanceof RegExp&&"string"==typeof i))throw new Ce.a("RegExp.exec requires the first argument to be a RegExp and the second argument to be a string. Arguments are "+t+" and "+i+".");var n=t.exec(i);return Object(u.a)(n)?n[1]:null},YQ.prototype._evaluateToString=function(e){var t=this._left.evaluate(e);if(t instanceof RegExp||t instanceof Rt||t instanceof z||t instanceof Te)return String(t);throw new Ce.a('Unexpected function call "'+this._value+'".')},YQ.prototype.getShaderExpression=function(e,t,i){var n,r,a,o,s=this._type,c=this._value;switch(Object(u.a)(this._left)&&(r=Object(ym.a)(this._left)?oK(this._left,e,t,this):this._left.getShaderExpression(e,t,this)),Object(u.a)(this._right)&&(a=this._right.getShaderExpression(e,t,this)),Object(u.a)(this._test)&&(o=this._test.getShaderExpression(e,t,this)),Object(ym.a)(this._value)&&(c=oK(this._value,e,t,this)),s){case DQ.VARIABLE:return e+c;case DQ.UNARY:if("Boolean"===c)return"bool("+r+")";if("Number"===c)return"float("+r+")";if("round"===c)return"floor("+r+" + 0.5)";if(Object(u.a)(UQ[c]))return c+"("+r+")";if("isNaN"===c||"isFinite"===c||"String"===c||"isExactClass"===c||"isClass"===c||"getExactClassName"===c)throw new Ce.a('Error generating style shader: "'+c+'" is not supported.');return Object(u.a)(UQ[c])?c+"("+r+")":c+r;case DQ.BINARY:return"%"===c?"mod("+r+", "+a+")":"==="===c?"("+r+" == "+a+")":"!=="===c?"("+r+" != "+a+")":"atan2"===c?"atan("+r+", "+a+")":Object(u.a)(VQ[c])?c+"("+r+", "+a+")":"("+r+" "+c+" "+a+")";case DQ.TERNARY:if(Object(u.a)(HQ[c]))return c+"("+r+", "+a+", "+o+")";break;case DQ.CONDITIONAL:return"("+o+" ? "+r+" : "+a+")";case DQ.MEMBER:return"r"===a||"x"===a||"0.0"===a?r+"[0]":"g"===a||"y"===a||"1.0"===a?r+"[1]":"b"===a||"z"===a||"2.0"===a?r+"[2]":"a"===a||"w"===a||"3.0"===a?r+"[3]":r+"[int("+a+")]";case DQ.FUNCTION_CALL:throw new Ce.a('Error generating style shader: "'+c+'" is not supported.');case DQ.ARRAY:if(4===c.length)return"vec4("+c[0]+", "+c[1]+", "+c[2]+", "+c[3]+")";if(3===c.length)return"vec3("+c[0]+", "+c[1]+", "+c[2]+")";if(2===c.length)return"vec2("+c[0]+", "+c[1]+")";throw new Ce.a("Error generating style shader: Invalid array length. Array length should be 2, 3, or 4.");case DQ.REGEX:throw new Ce.a("Error generating style shader: Regular expressions are not supported.");case DQ.VARIABLE_IN_STRING:throw new Ce.a("Error generating style shader: Converting a variable to a string is not supported.");case DQ.LITERAL_NULL:throw new Ce.a("Error generating style shader: null is not supported.");case DQ.LITERAL_BOOLEAN:return c?"true":"false";case DQ.LITERAL_NUMBER:return rK(c);case DQ.LITERAL_STRING:if(Object(u.a)(i)&&i._type===DQ.MEMBER&&("r"===c||"g"===c||"b"===c||"a"===c||"x"===c||"y"===c||"z"===c||"w"===c))return c;if(n=uf.fromCssColorString(c,zQ),Object(u.a)(n))return function(e){return"vec3("+rK(e.red)+", "+rK(e.green)+", "+rK(e.blue)+")"}(n);throw new Ce.a("Error generating style shader: String literals are not supported.");case DQ.LITERAL_COLOR:var l=r;if("color"===c){if(!Object(u.a)(l))return"vec4(1.0)";if(l.length>1){var d=l[0],f=l[1];return"1.0"!==f&&(t.translucent=!0),"vec4("+d+", "+f+")"}return"vec4("+l[0]+", 1.0)"}if("rgb"===c)return n=nK(this),Object(u.a)(n)?aK(n):"vec4("+l[0]+" / 255.0, "+l[1]+" / 255.0, "+l[2]+" / 255.0, 1.0)";if("rgba"===c)return"1.0"!==l[3]&&(t.translucent=!0),n=nK(this),Object(u.a)(n)?aK(n):"vec4("+l[0]+" / 255.0, "+l[1]+" / 255.0, "+l[2]+" / 255.0, "+l[3]+")";if("hsl"===c)return n=iK(this),Object(u.a)(n)?aK(n):"vec4(czm_HSLToRGB(vec3("+l[0]+", "+l[1]+", "+l[2]+")), 1.0)";if("hsla"===c)return n=iK(this),Object(u.a)(n)?(1!==n.alpha&&(t.translucent=!0),aK(n)):("1.0"!==l[3]&&(t.translucent=!0),"vec4(czm_HSLToRGB(vec3("+l[0]+", "+l[1]+", "+l[2]+")), "+l[3]+")");break;case DQ.LITERAL_VECTOR:if(!Object(u.a)(r))throw new h.a("left should always be defined for type ExpressionNodeType.LITERAL_VECTOR");for(var p=r.length,m=c+"(",_=0;_<p;++_)m+=r[_],_<p-1&&(m+=", ");return m+=")";case DQ.LITERAL_REGEX:throw new Ce.a("Error generating style shader: Regular expressions are not supported.");case DQ.LITERAL_UNDEFINED:throw new Ce.a("Error generating style shader: undefined is not supported.");case DQ.BUILTIN_VARIABLE:if("tiles3d_tileset_time"===c)return"u_time"}};var sK=jQ;function cK(e){e=Object(w.a)(e,w.a.EMPTY_OBJECT),this._batchTable=e.batchTable,this._batchIds=e.batchIds,this._positions=e.positions,this._vertexBatchIds=e.vertexBatchIds,this._indices=e.indices,this._indexCounts=e.indexCounts,this._indexOffsets=e.indexOffsets,this._batchedIndices=e.batchedIndices,this._boundingVolume=e.boundingVolume,this._boundingVolumes=e.boundingVolumes,this._center=Object(w.a)(e.center,z.ZERO),this._va=void 0,this._sp=void 0,this._spStencil=void 0,this._spPick=void 0,this._uniformMap=void 0,this._vaSwap=void 0,this._rsStencilPreloadPass=void 0,this._rsStencilPreloadPass3DTiles=void 0,this._rsStencilDepthPass=void 0,this._rsStencilDepthPass3DTiles=void 0,this._rsColorPass=void 0,this._rsPickPass=void 0,this._rsWireframe=void 0,this._commands=[],this._commandsIgnoreShow=[],this._pickCommands=[],this._constantColor=uf.clone(uf.WHITE),this._highlightColor=this._constantColor,this._batchDirty=!0,this._pickCommandsDirty=!0,this._framesSinceLastRebatch=0,this._updatingAllCommands=!1,this._trianglesLength=this._indices.length/3,this._geometryByteLength=this._indices.byteLength+this._positions.byteLength+this._vertexBatchIds.byteLength,this.debugWireframe=!1,this._debugWireframe=this.debugWireframe,this._wireframeDirty=!1,this.forceRebatch=!1,this.classificationType=Object(w.a)(e.classificationType,iM.BOTH),this._vertexShaderSource=e._vertexShaderSource,this._fragmentShaderSource=e._fragmentShaderSource,this._attributeLocations=e._attributeLocations,this._uniformMap=e._uniformMap,this._pickId=e._pickId,this._modelMatrix=e._modelMatrix,this._boundingSphere=e._boundingSphere,this._batchIdLookUp={};for(var t=this._batchIds.length,i=0;i<t;++i){var n=this._batchIds[i];this._batchIdLookUp[n]=i}}Object(O.a)(cK.prototype,{trianglesLength:{get:function(){return this._trianglesLength}},geometryByteLength:{get:function(){return this._geometryByteLength}}});var lK={position:0,a_batchId:1};function uK(e){var t=e?Bk.EQUAL:Bk.ALWAYS;return{colorMask:{red:!1,green:!1,blue:!1,alpha:!1},stencilTest:{enabled:!0,frontFunction:t,frontOperation:{fail:Uk.KEEP,zFail:Uk.DECREMENT_WRAP,zPass:Uk.DECREMENT_WRAP},backFunction:t,backOperation:{fail:Uk.KEEP,zFail:Uk.INCREMENT_WRAP,zPass:Uk.INCREMENT_WRAP},reference:Hk.CESIUM_3D_TILE_MASK,mask:Hk.CESIUM_3D_TILE_MASK},stencilMask:Hk.CLASSIFICATION_MASK,depthTest:{enabled:!1},depthMask:!1}}function hK(e){var t=e?Bk.EQUAL:Bk.ALWAYS;return{colorMask:{red:!1,green:!1,blue:!1,alpha:!1},stencilTest:{enabled:!0,frontFunction:t,frontOperation:{fail:Uk.KEEP,zFail:Uk.KEEP,zPass:Uk.INCREMENT_WRAP},backFunction:t,backOperation:{fail:Uk.KEEP,zFail:Uk.KEEP,zPass:Uk.DECREMENT_WRAP},reference:Hk.CESIUM_3D_TILE_MASK,mask:Hk.CESIUM_3D_TILE_MASK},stencilMask:Hk.CLASSIFICATION_MASK,depthTest:{enabled:!0,func:qN.LESS_OR_EQUAL},depthMask:!1}}var dK={stencilTest:{enabled:!0,frontFunction:Bk.NOT_EQUAL,frontOperation:{fail:Uk.KEEP,zFail:Uk.KEEP,zPass:Uk.DECREMENT_WRAP},backFunction:Bk.NOT_EQUAL,backOperation:{fail:Uk.KEEP,zFail:Uk.KEEP,zPass:Uk.DECREMENT_WRAP},reference:0,mask:Hk.CLASSIFICATION_MASK},stencilMask:Hk.CLASSIFICATION_MASK,depthTest:{enabled:!1},depthMask:!1,blending:FD.ALPHA_BLEND},fK={stencilTest:{enabled:!0,frontFunction:Bk.NOT_EQUAL,frontOperation:{fail:Uk.KEEP,zFail:Uk.KEEP,zPass:Uk.DECREMENT_WRAP},backFunction:Bk.NOT_EQUAL,backOperation:{fail:Uk.KEEP,zFail:Uk.KEEP,zPass:Uk.DECREMENT_WRAP},reference:0,mask:Hk.CLASSIFICATION_MASK},stencilMask:Hk.CLASSIFICATION_MASK,depthTest:{enabled:!1},depthMask:!1};var pK=new Be,mK=new z;function _K(e,t,i,n,r,a,o){for(var s=e.constructor.BYTES_PER_ELEMENT,c=a.length,l=0;l<c;++l){var u=o[a[l]],h=n[u],d=r[u],f=new e.constructor(e.buffer,s*h,d);t.set(f,i),n[u]=i,i+=d}return i}function gK(e,t,i,n,r,a,o){for(var s=e.bytesPerIndex,c=a.length,l=0;l<c;++l){var u=o[a[l]],h=n[u],d=r[u];t.copyFromBuffer(e,h*s,i*s,d*s),n[u]=i,i+=d}return i}function vK(e,t){return t.color.toRgba()-e.color.toRgba()}function bK(e,t){if(!e._batchDirty)return!1;for(var i=e._batchedIndices,n=i.length,r=!1,a={},o=0;o<n;++o){var s=i[o].color.toRgba();if(Object(u.a)(a[s])){r=!0;break}a[s]=!0}return r?r&&!e.forceRebatch&&e._framesSinceLastRebatch<120?void++e._framesSinceLastRebatch:(i.sort(vK),t.webgl2?function(e,t){var i=e._indexOffsets,n=e._indexCounts,r=e._batchIdLookUp,a=t.pop(),o=[a],s=e._va.indexBuffer,c=e._vaSwap.indexBuffer,l=gK(s,c,0,i,n,a.batchIds,r);for(a.offset=0,a.count=l;t.length>0;){var u=t.pop();if(uf.equals(u.color,a.color))l=gK(s,c,l,i,n,u.batchIds,r),a.batchIds=a.batchIds.concat(u.batchIds),a.count=l-a.offset;else{var h=l;l=gK(s,c,l,i,n,u.batchIds,r),u.offset=h,u.count=l-h,o.push(u),a=u}}var d=e._va;e._va=e._vaSwap,e._vaSwap=d,e._batchedIndices=o}(e,i):function(e,t){var i=e._indices,n=e._indexOffsets,r=e._indexCounts,a=e._batchIdLookUp,o=new i.constructor(i.length),s=t.pop(),c=[s],l=_K(i,o,0,n,r,s.batchIds,a);for(s.offset=0,s.count=l;t.length>0;){var u=t.pop();if(uf.equals(u.color,s.color))l=_K(i,o,l,n,r,u.batchIds,a),s.batchIds=s.batchIds.concat(u.batchIds),s.count=l-s.offset;else{var h=l;l=_K(i,o,l,n,r,u.batchIds,a),u.offset=h,u.count=l-h,c.push(u),s=u}}e._va.indexBuffer.copyFromArrayView(o),e._indices=o,e._batchedIndices=c}(e,i),e._framesSinceLastRebatch=0,e._batchDirty=!1,e._pickCommandsDirty=!0,e._wireframeDirty=!0,!0):(e._batchDirty=!1,!1)}cK.prototype.createFeatures=function(e,t){for(var i=this._batchIds,n=i.length,r=0;r<n;++r){var a=i[r];t[a]=new KX(e,a)}},cK.prototype.applyDebugSettings=function(e,t){this._highlightColor=e?t:this._constantColor};var yK=new uf,wK=uf.WHITE,OK=/\$/;function xK(e,t,i,n){var r,a,o=e.classificationType,s=o!==iM.CESIUM_3D_TILE,c=o!==iM.TERRAIN,l=t.commandList,h=i.length;for(a=0;a<h;++a)s&&((r=i[a]).pass=lM.TERRAIN_CLASSIFICATION,l.push(r)),c&&((r=i[a].derivedCommands.tileset).pass=lM.CESIUM_3D_TILE_CLASSIFICATION,l.push(r));if(t.invertClassification&&Object(u.a)(n))for(h=n.length,a=0;a<h;++a)l.push(n[a])}cK.prototype.applyStyle=function(e,t){if(Object(u.a)(e)){var i=e.color,n=i instanceof sK&&!OK.test(i.expression);this._updatingAllCommands=n;var r,a=this._batchIds,o=a.length;for(r=0;r<o;++r){var s=t[a[r]];s.color=Object(u.a)(e.color)?e.color.evaluateColor(s,yK):wK,s.show=!Object(u.a)(e.show)||e.show.evaluate(s)}if(n){var c=this._batchedIndices;for(o=c.length,r=0;r<o;++r)c[r].color=uf.clone(uf.WHITE);this._updatingAllCommands=!1,this._batchDirty=!0}}else!function(e,t){e._updatingAllCommands=!0;var i,n=e._batchIds,r=n.length;for(i=0;i<r;++i){var a=t[n[i]];a.show=!0,a.color=uf.WHITE}var o=e._batchedIndices;for(r=o.length,i=0;i<r;++i)o[i].color=uf.clone(uf.WHITE);e._updatingAllCommands=!1,e._batchDirty=!0}(this,t)},cK.prototype.updateCommands=function(e,t){if(!this._updatingAllCommands){var i=this._batchIdLookUp,n=i[e];if(Object(u.a)(n)){var r,a=this._indexOffsets,o=this._indexCounts,s=a[n],c=o[n],l=this._batchedIndices,h=l.length;for(r=0;r<h;++r){var d=l[r].offset,f=l[r].count;if(s>=d&&s<d+f)break}l.push(new SQ({color:uf.clone(t),offset:s,count:c,batchIds:[e]}));for(var p=[],m=[],_=l[r].batchIds,g=_.length,v=0;v<g;++v){var b=_[v];if(b!==e)a[i[b]]<s?p.push(b):m.push(b)}0!==m.length&&l.push(new SQ({color:uf.clone(l[r].color),offset:s+c,count:l[r].offset+l[r].count-(s+c),batchIds:m})),0!==p.length?(l[r].count=s-l[r].offset,l[r].batchIds=p):l.splice(r,1),this._batchDirty=!0}}},cK.prototype.update=function(e){var t,i=e.context;!function(e,t){if(!Object(u.a)(e._va)){var i=ZN.createVertexBuffer({context:t,typedArray:e._positions,usage:YN.STATIC_DRAW}),n=ZN.createVertexBuffer({context:t,typedArray:e._vertexBatchIds,usage:YN.STATIC_DRAW}),r=ZN.createIndexBuffer({context:t,typedArray:e._indices,usage:YN.DYNAMIC_DRAW,indexDatatype:2===e._indices.BYTES_PER_ELEMENT?Sl.UNSIGNED_SHORT:Sl.UNSIGNED_INT}),a=[{index:0,vertexBuffer:i,componentDatatype:dn.fromTypedArray(e._positions),componentsPerAttribute:3},{index:1,vertexBuffer:n,componentDatatype:dn.fromTypedArray(e._vertexBatchIds),componentsPerAttribute:1}];e._va=new tF({context:t,attributes:a,indexBuffer:r}),t.webgl2&&(e._vaSwap=new tF({context:t,attributes:a,indexBuffer:ZN.createIndexBuffer({context:t,sizeInBytes:r.sizeInBytes,usage:YN.DYNAMIC_DRAW,indexDatatype:r.indexDatatype})})),e._batchedPositions=void 0,e._transferrableBatchIds=void 0,e._vertexBatchIds=void 0,e._verticesPromise=void 0}}(this,i),function(e,t){if(!Object(u.a)(e._sp)){var i=e._batchTable,n=Object(w.a)(e._attributeLocations,lK),r=e._pickId,a=e._vertexShaderSource,o=e._fragmentShaderSource;if(Object(u.a)(a))return e._sp=bR.fromCache({context:t,vertexShaderSource:a,fragmentShaderSource:o,attributeLocations:n}),e._spStencil=e._sp,o=(o=UN.replaceMain(o,"czm_non_pick_main"))+"void main() \n{ \n    czm_non_pick_main(); \n    gl_FragColor = "+r+"; \n} \n",void(e._spPick=bR.fromCache({context:t,vertexShaderSource:a,fragmentShaderSource:o,attributeLocations:n}));var s=i.getVertexShaderCallback(!1,"a_batchId",void 0)(AQ),c=i.getFragmentShaderCallback()(VN,!1,void 0);r=i.getPickId();var l=new UN({sources:[s]}),h=new UN({defines:["VECTOR_TILE"],sources:[c]});e._sp=bR.fromCache({context:t,vertexShaderSource:l,fragmentShaderSource:h,attributeLocations:n}),l=new UN({sources:[AQ]}),h=new UN({defines:["VECTOR_TILE"],sources:[VN]}),e._spStencil=bR.fromCache({context:t,vertexShaderSource:l,fragmentShaderSource:h,attributeLocations:n}),c=(c=UN.replaceMain(c,"czm_non_pick_main"))+"\nvoid main() \n{ \n    czm_non_pick_main(); \n    gl_FragColor = "+r+"; \n} \n";var d=new UN({sources:[s]}),f=new UN({defines:["VECTOR_TILE"],sources:[c]});e._spPick=bR.fromCache({context:t,vertexShaderSource:d,fragmentShaderSource:f,attributeLocations:n})}}(this,i),t=this,Object(u.a)(t._rsStencilPreloadPass)||(t._rsStencilPreloadPass=RM.fromCache(uK(!1)),t._rsStencilPreloadPass3DTiles=RM.fromCache(uK(!0)),t._rsStencilDepthPass=RM.fromCache(hK(!1)),t._rsStencilDepthPass3DTiles=RM.fromCache(hK(!0)),t._rsColorPass=RM.fromCache(dK),t._rsPickPass=RM.fromCache(fK)),function(e,t){if(!Object(u.a)(e._uniformMap)){var i={u_modifiedModelViewProjection:function(){var i=t.uniformState.view,n=t.uniformState.projection;return Be.clone(i,pK),Be.multiplyByPoint(pK,e._center,mK),Be.setTranslation(pK,mK,pK),Be.multiply(n,pK,pK),pK},u_highlightColor:function(){return e._highlightColor}};e._uniformMap=e._batchTable.getUniformMapCallback()(i)}}(this,i);var n=e.passes;n.render&&(function(e,t){var i=bK(e,t),n=e._commands,r=e._batchedIndices,a=r.length,o=3*a;if(!Object(u.a)(n)||i||n.length!==o){n.length=o;for(var s=e._va,c=e._sp,l=Object(w.a)(e._modelMatrix,Be.IDENTITY),h=e._uniformMap,d=e._boundingVolume,f=0;f<a;++f){var p=r[f].offset,m=r[f].count,_=n[3*f];Object(u.a)(_)||(_=n[3*f]=new cM({owner:e})),_.vertexArray=s,_.modelMatrix=l,_.offset=p,_.count=m,_.renderState=e._rsStencilPreloadPass,_.shaderProgram=c,_.uniformMap=h,_.boundingVolume=d,_.cull=!1,_.pass=lM.TERRAIN_CLASSIFICATION;var g=cM.shallowClone(_,_.derivedCommands.tileset);g.renderState=e._rsStencilPreloadPass3DTiles,g.pass=lM.CESIUM_3D_TILE_CLASSIFICATION,_.derivedCommands.tileset=g;var v=n[3*f+1];Object(u.a)(v)||(v=n[3*f+1]=new cM({owner:e})),v.vertexArray=s,v.modelMatrix=l,v.offset=p,v.count=m,v.renderState=e._rsStencilDepthPass,v.shaderProgram=c,v.uniformMap=h,v.boundingVolume=d,v.cull=!1,v.pass=lM.TERRAIN_CLASSIFICATION;var b=cM.shallowClone(v,v.derivedCommands.tileset);b.renderState=e._rsStencilDepthPass3DTiles,b.pass=lM.CESIUM_3D_TILE_CLASSIFICATION,v.derivedCommands.tileset=b;var y=n[3*f+2];Object(u.a)(y)||(y=n[3*f+2]=new cM({owner:e})),y.vertexArray=s,y.modelMatrix=l,y.offset=p,y.count=m,y.renderState=e._rsColorPass,y.shaderProgram=c,y.uniformMap=h,y.boundingVolume=d,y.cull=!1,y.pass=lM.TERRAIN_CLASSIFICATION;var O=cM.shallowClone(y,y.derivedCommands.tileset);O.pass=lM.CESIUM_3D_TILE_CLASSIFICATION,y.derivedCommands.tileset=O}e._commandsDirty=!0}}(this,i),function(e,t){if(e.classificationType!==iM.TERRAIN&&t.invertClassification&&(!Object(u.a)(e._commandsIgnoreShow)||e._commandsDirty)){for(var i=e._commands,n=e._commandsIgnoreShow,r=e._spStencil,a=i.length,o=n.length=a/3*2,s=0,c=0;c<o;c+=2){var l=n[c]=cM.shallowClone(i[s],n[c]);l.shaderProgram=r,l.pass=lM.CESIUM_3D_TILE_CLASSIFICATION_IGNORE_SHOW,(l=n[c+1]=cM.shallowClone(i[s+1],n[c+1])).shaderProgram=r,l.pass=lM.CESIUM_3D_TILE_CLASSIFICATION_IGNORE_SHOW,s+=3}e._commandsDirty=!1}}(this,e),function(e){var t=e.debugWireframe===e._debugWireframe;if(!(t=t&&!(e.debugWireframe&&e._wireframeDirty))){var i,n;Object(u.a)(e._rsWireframe)||(e._rsWireframe=RM.fromCache({})),e.debugWireframe?(i=e._rsWireframe,n=yn.LINES):(i=e._rsColorPass,n=yn.TRIANGLES);for(var r=e._commands,a=r.length,o=0;o<a;o+=3){var s=r[o+2];s.renderState=i,s.primitiveType=n}e._debugWireframe=e.debugWireframe,e._wireframeDirty=!1}}(this),this._debugWireframe?function(e,t){for(var i=e.commandList,n=t.length,r=0;r<n;r+=3){var a=t[r+2];a.pass=lM.OPAQUE,i.push(a)}}(e,this._commands):xK(this,e,this._commands,this._commandsIgnoreShow)),n.pick&&(!function(e){if(e._pickCommandsDirty){var t=e._indexOffsets.length,i=e._pickCommands;i.length=3*t;for(var n=e._va,r=e._spStencil,a=e._spPick,o=Object(w.a)(e._modelMatrix,Be.IDENTITY),s=e._uniformMap,c=0;c<t;++c){var l=e._indexOffsets[c],h=e._indexCounts[c],d=Object(u.a)(e._boundingVolumes)?e._boundingVolumes[c]:e.boundingVolume,f=i[3*c];Object(u.a)(f)||(f=i[3*c]=new cM({owner:e,pickOnly:!0})),f.vertexArray=n,f.modelMatrix=o,f.offset=l,f.count=h,f.renderState=e._rsStencilPreloadPass,f.shaderProgram=r,f.uniformMap=s,f.boundingVolume=d,f.pass=lM.TERRAIN_CLASSIFICATION;var p=cM.shallowClone(f,f.derivedCommands.tileset);p.renderState=e._rsStencilPreloadPass3DTiles,p.pass=lM.CESIUM_3D_TILE_CLASSIFICATION,f.derivedCommands.tileset=p;var m=i[3*c+1];Object(u.a)(m)||(m=i[3*c+1]=new cM({owner:e,pickOnly:!0})),m.vertexArray=n,m.modelMatrix=o,m.offset=l,m.count=h,m.renderState=e._rsStencilDepthPass,m.shaderProgram=r,m.uniformMap=s,m.boundingVolume=d,m.pass=lM.TERRAIN_CLASSIFICATION;var _=cM.shallowClone(m,m.derivedCommands.tileset);_.renderState=e._rsStencilDepthPass3DTiles,_.pass=lM.CESIUM_3D_TILE_CLASSIFICATION,m.derivedCommands.tileset=_;var g=i[3*c+2];Object(u.a)(g)||(g=i[3*c+2]=new cM({owner:e,pickOnly:!0})),g.vertexArray=n,g.modelMatrix=o,g.offset=l,g.count=h,g.renderState=e._rsPickPass,g.shaderProgram=a,g.uniformMap=s,g.boundingVolume=d,g.pass=lM.TERRAIN_CLASSIFICATION;var v=cM.shallowClone(g,g.derivedCommands.tileset);v.pass=lM.CESIUM_3D_TILE_CLASSIFICATION,g.derivedCommands.tileset=v}e._pickCommandsDirty=!1}}(this),xK(this,e,this._pickCommands))},cK.prototype.isDestroyed=function(){return!1},cK.prototype.destroy=function(){return this._va=this._va&&this._va.destroy(),this._sp=this._sp&&this._sp.destroy(),this._spPick=this._spPick&&this._spPick.destroy(),this._vaSwap=this._vaSwap&&this._vaSwap.destroy(),rl(this)};var EK=cK,TK=new z,CK=wQ.ModelState;function SK(e){var t=(e=Object(w.a)(e,w.a.EMPTY_OBJECT)).gltf;if(t instanceof ArrayBuffer&&(t=new Uint8Array(t)),!(t instanceof Uint8Array))throw new Ce.a("Only binary glTF is supported as a classifier.");t=mZ(t),XZ(t),cZ(t),xQ(t),CQ(t),rZ.buffer(t,(function(e){if(!Object(u.a)(e.extras._pipeline.source))throw new Ce.a("Buffer data must be embedded in the binary gltf.")}));var i=t.nodes,n=t.meshes,r=i[0].mesh;if(1!==i.length||!Object(u.a)(r))throw new Ce.a("Only one node is supported for classification and it must have a mesh.");if(1!==n.length)throw new Ce.a("Only one mesh is supported when using b3dm for classification.");var a=n[0].primitives;if(1!==a.length)throw new Ce.a("Only one primitive per mesh is supported when using b3dm for classification.");var o=a[0].attributes.POSITION;if(!Object(u.a)(o))throw new Ce.a("The mesh must have a position attribute.");var s=a[0].attributes._BATCHID;if(!Object(u.a)(s))throw new Ce.a("The mesh must have a batch id attribute.");this._gltf=t,this.show=Object(w.a)(e.show,!0),this.modelMatrix=Be.clone(Object(w.a)(e.modelMatrix,Be.IDENTITY)),this._modelMatrix=Be.clone(this.modelMatrix),this._ready=!1,this._readyPromise=Oi.a.defer(),this.debugShowBoundingVolume=Object(w.a)(e.debugShowBoundingVolume,!1),this._debugShowBoundingVolume=!1,this.debugWireframe=Object(w.a)(e.debugWireframe,!1),this._debugWireframe=!1,this._classificationType=e.classificationType,this._vertexShaderLoaded=e.vertexShaderLoaded,this._classificationShaderLoaded=e.classificationShaderLoaded,this._uniformMapLoaded=e.uniformMapLoaded,this._pickIdLoaded=e.pickIdLoaded,this._ignoreCommands=Object(w.a)(e.ignoreCommands,!1),this._upAxis=Object(w.a)(e.upAxis,mX.Y),this._batchTable=e.batchTable,this._computedModelMatrix=new Be,this._initialRadius=void 0,this._boundingSphere=void 0,this._scaledBoundingSphere=new St,this._state=CK.NEEDS_LOAD,this._loadResources=void 0,this._mode=void 0,this._dirty=!1,this._nodeMatrix=new Be,this._primitive=void 0,this._extensionsUsed=void 0,this._extensionsRequired=void 0,this._quantizedUniforms=void 0,this._buffers={},this._vertexArray=void 0,this._shaderProgram=void 0,this._uniformMap=void 0,this._geometryByteLength=0,this._trianglesLength=0,this._rtcCenter=void 0,this._rtcCenterEye=void 0,this._rtcCenter3D=void 0,this._rtcCenter2D=void 0}function AK(e,t){var i=t._loadResources,n=t.gltf.bufferViews[e],r=i.getBuffer(n);t._buffers[e]=r,t._geometryByteLength+=r.byteLength}function PK(e,t,i){var n=i._loadResources,r=i.gltf.bufferViews[e],a={typedArray:n.getBuffer(r),indexDatatype:t};i._buffers[e]=a,i._geometryByteLength+=a.typedArray.byteLength}function IK(e,t){return Object(u.a)(t)&&(e=t(e)),e}function DK(e){var t=e.gltf,i=wQ.getAttributeOrUniformBySemantic(t,"POSITION"),n=wQ.getAttributeOrUniformBySemantic(t,"_BATCHID"),r={};r[i]=0,r[n]=1;var a,o,s=wQ.getAttributeOrUniformBySemantic(t,"MODELVIEWPROJECTION");if(Object(u.a)(s))a="uniform mat4 "+s+";\n",o=s+" * vec4("+i+", 1.0)";else{var c=wQ.getAttributeOrUniformBySemantic(t,"PROJECTION"),l=wQ.getAttributeOrUniformBySemantic(t,"MODELVIEW");Object(u.a)(l)||(l=wQ.getAttributeOrUniformBySemantic(t,"CESIUM_RTC_MODELVIEW")),a="uniform mat4 "+l+";\nuniform mat4 "+c+";\n",o=c+" * "+l+" * vec4("+i+", 1.0)"}var h="attribute vec3 "+i+";\nattribute float "+n+";\n"+a+"void main() {\n"+("    vec4 positionInClipCoords = "+o+";\n")+"    gl_Position = czm_depthClampFarPlane(positionInClipCoords);\n}\n";e.extensionsUsed.WEB3D_quantized_attributes&&(h=function(e,t){var i=t.gltf.meshes[0].primitives[0],n=wQ.modifyShaderForQuantizedAttributes(t.gltf,i,e);return t._quantizedUniforms=n.uniforms,n.shader}(h,e));var d=IK(h,e._vertexShaderLoaded),f=IK("#ifdef GL_EXT_frag_depth\n#extension GL_EXT_frag_depth : enable\n#endif\nvoid main() \n{ \n    gl_FragColor = vec4(1.0); \n    czm_writeDepthClampedToFarPlane();\n}\n",e._classificationShaderLoaded);d=wQ.modifyVertexShaderForLogDepth(d,o),f=wQ.modifyFragmentShaderForLogDepth(f),e._shaderProgram={vertexShaderSource:d,fragmentShaderSource:f,attributeLocations:r}}Object(O.a)(SK.prototype,{gltf:{get:function(){return this._gltf}},boundingSphere:{get:function(){if(this._state!==CK.LOADED)throw new h.a("The model is not loaded.  Use ClassificationModel.readyPromise or wait for ClassificationModel.ready to be true.");var e=this.modelMatrix,t=Be.getScale(e,TK),i=this._scaledBoundingSphere;return i.center=z.multiplyComponents(this._boundingSphere.center,t,i.center),i.radius=z.maximumComponent(t)*this._initialRadius,Object(u.a)(this._rtcCenter)&&z.add(this._rtcCenter,i.center,i.center),i}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise.promise}},dirty:{get:function(){return this._dirty}},extensionsUsed:{get:function(){return Object(u.a)(this._extensionsUsed)||(this._extensionsUsed=wQ.getUsedExtensions(this.gltf)),this._extensionsUsed}},extensionsRequired:{get:function(){return Object(u.a)(this._extensionsRequired)||(this._extensionsRequired=wQ.getRequiredExtensions(this.gltf)),this._extensionsRequired}},upAxis:{get:function(){return this._upAxis}},trianglesLength:{get:function(){return this._trianglesLength}},geometryByteLength:{get:function(){return this._geometryByteLength}},texturesByteLength:{get:function(){return 0}},classificationType:{get:function(){return this._classificationType}}});var jK={PROJECTION:function(e,t){return wQ.getGltfSemanticUniforms().PROJECTION(e,t)},MODELVIEW:function(e,t){return wQ.getGltfSemanticUniforms().MODELVIEW(e,t)},CESIUM_RTC_MODELVIEW:function(e,t){return wQ.getGltfSemanticUniforms().CESIUM_RTC_MODELVIEW(e,t)},MODELVIEWPROJECTION:function(e,t){return wQ.getGltfSemanticUniforms().MODELVIEWPROJECTION(e,t)}};function MK(e){var t,i,n=e._batchTable,r=e._uniformMap,a=e._vertexArray,o=e.gltf,s=o.accessors,c=o.meshes[0].primitives[0],l=s[c.indices],h=c.attributes.POSITION,d=wQ.getAccessorMinMax(o,h),f=St.fromCornerPoints(z.fromArray(d.min),z.fromArray(d.max));Object(u.a)(l)?(i=l.count,t=l.byteOffset/Sl.getSizeInBytes(l.componentType)):(i=s[c.attributes.POSITION].count,t=0);if(e._trianglesLength+=function(e,t){switch(e.mode){case yn.TRIANGLES:return t/3;case yn.TRIANGLE_STRIP:case yn.TRIANGLE_FAN:return Math.max(t-2,0);default:return 0}}(c,i),Object(u.a)(e._uniformMapLoaded)&&(r=e._uniformMapLoaded(r)),e.extensionsUsed.WEB3D_quantized_attributes){var p=function(e,t){return wQ.createUniformsForQuantizedAttributes(e.gltf,t,e._quantizedUniforms)}(e,c);r=Object(ff.a)(r,p)}var m=a.attributes.POSITION,_=m.componentDatatype,g=m.vertexBuffer,v=g.byteOffset,b=g.byteLength/dn.getSizeInBytes(_),y=dn.createArrayBufferView(_,g.buffer,v,b);_=(m=a.attributes._BATCHID).componentDatatype,v=(g=m.vertexBuffer).byteOffset,b=g.byteLength/dn.getSizeInBytes(_);var w,O=dn.createArrayBufferView(_,g.buffer,v,b),x=a.indexBuffer.typedArray;w=a.indexBuffer.indexDatatype===Sl.UNSIGNED_SHORT?new Uint16Array(x.buffer,x.byteOffset,x.byteLength/Uint16Array.BYTES_PER_ELEMENT):new Uint32Array(x.buffer,x.byteOffset,x.byteLength/Uint32Array.BYTES_PER_ELEMENT),y=Li(y);var E,T,C,S=[],A=[],P=[],I=[],D=(O=Li(O))[(w=Li(w,t,t+i))[0]];S.push(D),P.push(0);for(var j=w.length,M=1;M<j;++M)(E=O[w[M]])!==D&&(C=M-(T=P[P.length-1]),S.push(E),A.push(C),P.push(M),I.push(new SQ({offset:T,count:C,batchIds:[D],color:uf.WHITE})),D=E);C=j-(T=P[P.length-1]),A.push(C),I.push(new SQ({offset:T,count:C,batchIds:[D],color:uf.WHITE}));var R=e._shaderProgram,L=R.vertexShaderSource,N=R.fragmentShaderSource,F=R.attributeLocations,k=Object(u.a)(e._pickIdLoaded)?e._pickIdLoaded():void 0;e._primitive=new EK({classificationType:e._classificationType,positions:y,indices:w,indexOffsets:P,indexCounts:A,batchIds:S,vertexBatchIds:O,batchedIndices:I,batchTable:n,boundingVolume:new St,_vertexShaderSource:L,_fragmentShaderSource:N,_attributeLocations:F,_uniformMap:r,_pickId:k,_modelMatrix:new Be,_boundingSphere:f}),e._buffers=void 0,e._vertexArray=void 0,e._shaderProgram=void 0,e._uniformMap=void 0}function RK(e,t){var i=t.context;wQ.checkSupportedGlExtensions(e.gltf.glExtensionsUsed,i),function(e){var t=e._loadResources;if(0===t.pendingBufferLoads){for(var i=t.vertexBuffersToCreate,n=t.indexBuffersToCreate;i.length>0;)AK(i.dequeue(),e);for(;n.length>0;){var r=n.dequeue();PK(r.id,r.componentType,e)}}}(e),DK(e),function(e){if(e._loadResources.finishedBuffersCreation()&&!Object(u.a)(e._vertexArray)){var t,i=e._buffers,n=e.gltf,r=n.accessors,a=n.meshes[0].primitives[0],o={POSITION:0,_BATCHID:1},s={};if(rZ.meshPrimitiveAttribute(a,(function(e,t){var a=o[t];if(Object(u.a)(a)){var c=r[e];s[t]={index:a,vertexBuffer:i[c.bufferView],componentsPerAttribute:aZ(c.type),componentDatatype:c.componentType,offsetInBytes:c.byteOffset,strideInBytes:oZ(n,c)}}})),Object(u.a)(a.indices)){var c=r[a.indices];t=i[c.bufferView]}e._vertexArray={attributes:s,indexBuffer:t}}}(e),function(e,t){if(!Object(u.a)(e._uniformMap)){var i={};rZ.technique(e.gltf,(function(n){rZ.techniqueUniform(n,(function(n,r){Object(u.a)(n.semantic)&&Object(u.a)(jK[n.semantic])&&(i[r]=jK[n.semantic](t.uniformState,e))}))})),e._uniformMap=i}}(e,i),function(e){if(e._loadResources.finished()&&!Object(u.a)(e._primitive)){var t=e.gltf.nodes[0];e._nodeMatrix=wQ.getTransform(t,e._nodeMatrix),MK(e)}}(e)}var LK=new Te,NK=new Be;SK.prototype.updateCommands=function(e,t){this._primitive.updateCommands(e,t)},SK.prototype.update=function(e){if(e.mode!==xF.MORPHING){var t=Ri.supportsWebPSync();if(Object(u.a)(t)){if(this._state===CK.NEEDS_LOAD&&Object(u.a)(this.gltf)&&(this._state=CK.LOADING,this._state!==CK.FAILED)){var i=this.gltf.extensions;if(Object(u.a)(i)&&Object(u.a)(i.CESIUM_RTC)){var n=z.fromArray(i.CESIUM_RTC.center);if(!z.equals(n,z.ZERO)){this._rtcCenter3D=n;var r=e.mapProjection,a=r.ellipsoid.cartesianToCartographic(this._rtcCenter3D),o=r.project(a);z.fromElements(o.z,o.x,o.y,o),this._rtcCenter2D=o,this._rtcCenterEye=new z,this._rtcCenter=this._rtcCenter3D}}this._loadResources=new QZ,wQ.parseBuffers(this)}var s=this._loadResources,c=!1;this._state===CK.LOADING&&(0===s.pendingBufferLoads&&(wQ.checkSupportedExtensions(this.extensionsRequired,t),function(e){var t=e.gltf,i=e._loadResources;rZ.buffer(t,(function(e,t){i.buffers[t]=e.extras._pipeline.source}))}(this),function(e){var t=e.gltf.bufferViews,i=e._loadResources.vertexBuffersToCreate;rZ.bufferView(e.gltf,(function(e,t){e.target===un.ARRAY_BUFFER&&i.enqueue(t)}));var n=e._loadResources.indexBuffersToCreate,r={};rZ.accessor(e.gltf,(function(e){var i=e.bufferView;t[i].target!==un.ELEMENT_ARRAY_BUFFER||Object(u.a)(r[i])||(r[i]=!0,n.enqueue({id:i,componentType:e.componentType}))}))}(this),this._boundingSphere=wQ.computeBoundingSphere(this),this._initialRadius=this._boundingSphere.radius,RK(this,e)),s.finished()&&(this._state=CK.LOADED,c=!0)),Object(u.a)(s)&&this._state===CK.LOADED&&(c||RK(this,e),s.finished()&&(this._loadResources=void 0));var l=this.show;if(l&&this._state===CK.LOADED||c){this._dirty=!1;var h=this.modelMatrix,d=e.mode!==this._mode;this._mode=e.mode;var f=!Be.equals(this._modelMatrix,h)||d;if(f||c){Be.clone(h,this._modelMatrix);var p=this._computedModelMatrix;Be.clone(h,p),this._upAxis===mX.Y?Be.multiplyTransformation(p,mX.Y_UP_TO_Z_UP,p):this._upAxis===mX.X&&Be.multiplyTransformation(p,mX.X_UP_TO_Z_UP,p)}(f||c)&&(!function(e,t,i,n){var r=e._computedModelMatrix;if(e._mode!==xF.SCENE3D&&!e._ignoreCommands){var a=Be.getColumn(r,3,LK);if(Te.equals(a,Te.UNIT_W)){var o=e.boundingSphere.center,s=xa.wgs84To2DModelMatrix(n,o,NK);r=Be.multiply(s,r,NK),Object(u.a)(e._rtcCenter)&&(Be.setTranslation(r,Te.UNIT_W,r),e._rtcCenter=e._rtcCenter2D)}else r=xa.basisTo2D(n,r,NK),e._rtcCenter=e._rtcCenter3D}var c=e._primitive;(t||i)&&(Be.multiplyTransformation(r,e._nodeMatrix,c._modelMatrix),St.transform(c._boundingSphere,c._modelMatrix,c._boundingVolume),Object(u.a)(e._rtcCenter)&&z.add(e._rtcCenter,c._boundingVolume.center,c._boundingVolume.center))}(this,f,c,e.mapProjection),this._dirty=!0)}if(c){var m=this;e.afterRender.push((function(){m._ready=!0,m._readyPromise.resolve(m)}))}else l&&!this._ignoreCommands&&(this._primitive.debugShowBoundingVolume=this.debugShowBoundingVolume,this._primitive.debugWireframe=this.debugWireframe,this._primitive.update(e))}}},SK.prototype.isDestroyed=function(){return!1},SK.prototype.destroy=function(){return this._primitive=this._primitive&&this._primitive.destroy(),rl(this)};var FK=SK;function kK(e){Object(u.a)(e.extras)&&(Object(u.a)(e.extras._pipeline)&&delete e.extras._pipeline,0===Object.keys(e.extras).length&&delete e.extras)}var BK=function(e){return rZ.shader(e,(function(e){kK(e)})),rZ.buffer(e,(function(e){kK(e)})),rZ.image(e,(function(e){kK(e),rZ.compressedImage(e,(function(e){kK(e)}))})),kK(e),e};function zK(e,t){x.a.typeOf.object("normal",e),x.a.typeOf.number("distance",t),this._distance=t,this._normal=new UK(e,this),this.onChangeCallback=void 0,this.index=-1}function UK(e,t){this._clippingPlane=t,this._cartesian3=z.clone(e)}Object(O.a)(zK.prototype,{distance:{get:function(){return this._distance},set:function(e){x.a.typeOf.number("value",e),Object(u.a)(this.onChangeCallback)&&e!==this._distance&&this.onChangeCallback(this.index),this._distance=e}},normal:{get:function(){return this._normal},set:function(e){x.a.typeOf.object("value",e),Object(u.a)(this.onChangeCallback)&&!z.equals(this._normal._cartesian3,e)&&this.onChangeCallback(this.index),z.clone(e,this._normal._cartesian3)}}}),zK.fromPlane=function(e,t){return x.a.typeOf.object("plane",e),Object(u.a)(t)?(t.normal=e.normal,t.distance=e.distance):t=new zK(e.normal,e.distance),t},zK.clone=function(e,t){return Object(u.a)(t)?(t.normal=e.normal,t.distance=e.distance,t):new zK(e.normal,e.distance)},Object(O.a)(UK.prototype,{x:{get:function(){return this._cartesian3.x},set:function(e){x.a.typeOf.number("value",e),Object(u.a)(this._clippingPlane.onChangeCallback)&&e!==this._cartesian3.x&&this._clippingPlane.onChangeCallback(this._clippingPlane.index),this._cartesian3.x=e}},y:{get:function(){return this._cartesian3.y},set:function(e){x.a.typeOf.number("value",e),Object(u.a)(this._clippingPlane.onChangeCallback)&&e!==this._cartesian3.y&&this._clippingPlane.onChangeCallback(this._clippingPlane.index),this._cartesian3.y=e}},z:{get:function(){return this._cartesian3.z},set:function(e){x.a.typeOf.number("value",e),Object(u.a)(this._clippingPlane.onChangeCallback)&&e!==this._cartesian3.z&&this._clippingPlane.onChangeCallback(this._clippingPlane.index),this._cartesian3.z=e}}});var VK=zK;function HK(e){e=Object(w.a)(e,w.a.EMPTY_OBJECT),this._planes=[],this._dirtyIndex=-1,this._multipleDirtyPlanes=!1,this._enabled=Object(w.a)(e.enabled,!0),this.modelMatrix=Be.clone(Object(w.a)(e.modelMatrix,Be.IDENTITY)),this.edgeColor=uf.clone(Object(w.a)(e.edgeColor,uf.WHITE)),this.edgeWidth=Object(w.a)(e.edgeWidth,0),this.planeAdded=new $o.a,this.planeRemoved=new $o.a,this._owner=void 0;var t=Object(w.a)(e.unionClippingRegions,!1);this._unionClippingRegions=t,this._testIntersection=t?GK:qK,this._uint8View=void 0,this._float32View=void 0,this._clippingPlanesTexture=void 0;var i=e.planes;if(Object(u.a)(i))for(var n=i.length,r=0;r<n;++r)this.add(i[r])}function GK(e){return e===ce.OUTSIDE}function qK(e){return e===ce.INSIDE}function WK(e,t){e._multipleDirtyPlanes=e._multipleDirtyPlanes||-1!==e._dirtyIndex&&e._dirtyIndex!==t,e._dirtyIndex=t}function YK(e,t){for(var i=e.length,n=0;n<i;++n)if(oc.equals(e[n],t))return n;return-1}Object(O.a)(HK.prototype,{length:{get:function(){return this._planes.length}},unionClippingRegions:{get:function(){return this._unionClippingRegions},set:function(e){this._unionClippingRegions!==e&&(this._unionClippingRegions=e,this._testIntersection=e?GK:qK)}},enabled:{get:function(){return this._enabled},set:function(e){this._enabled!==e&&(this._enabled=e)}},texture:{get:function(){return this._clippingPlanesTexture}},owner:{get:function(){return this._owner}},clippingPlanesState:{get:function(){return this._unionClippingRegions?this._planes.length:-this._planes.length}}}),HK.prototype.add=function(e){var t=this._planes.length,i=this;e.onChangeCallback=function(e){WK(i,e)},e.index=t,WK(this,t),this._planes.push(e),this.planeAdded.raiseEvent(e,t)},HK.prototype.get=function(e){return x.a.typeOf.number("index",e),this._planes[e]},HK.prototype.contains=function(e){return-1!==YK(this._planes,e)},HK.prototype.remove=function(e){var t=this._planes,i=YK(t,e);if(-1===i)return!1;e instanceof VK&&(e.onChangeCallback=void 0,e.index=-1);for(var n=t.length-1,r=i;r<n;++r){var a=t[r+1];t[r]=a,a instanceof VK&&(a.index=r)}return this._multipleDirtyPlanes=!0,t.length=n,this.planeRemoved.raiseEvent(e,i),!0},HK.prototype.removeAll=function(){for(var e=this._planes,t=e.length,i=0;i<t;++i){var n=e[i];n instanceof VK&&(n.onChangeCallback=void 0,n.index=-1),this.planeRemoved.raiseEvent(n,i)}this._multipleDirtyPlanes=!0,this._planes=[]};var XK=new Te,ZK=new Te;function QK(e,t,i){for(var n=e._uint8View,r=e._planes,a=0,o=t;o<i;++o){var s=r[o],c=Gi.octEncodeToCartesian4(s.normal,ZK);n[a]=c.x,n[a+1]=c.y,n[a+2]=c.z,n[a+3]=c.w;var l=Te.packFloat(s.distance,XK);n[a+4]=l.x,n[a+5]=l.y,n[a+6]=l.z,n[a+7]=l.w,a+=8}}function KK(e,t,i){for(var n=e._float32View,r=e._planes,a=0,o=t;o<i;++o){var s=r[o],c=s.normal;n[a]=c.x,n[a+1]=c.y,n[a+2]=c.z,n[a+3]=s.distance,a+=4}}function JK(e,t){var i=HD.maximumTextureSize;return t.x=Math.min(e,i),t.y=Math.ceil(e/t.x),t}var $K=new Rt;HK.prototype.update=function(e){var t=this._clippingPlanesTexture,i=e.context,n=HK.useFloatTexture(i),r=n?this.length:2*this.length;if(Object(u.a)(t)){var a=t.width*t.height;(a<r||r<.25*a)&&(t.destroy(),t=void 0,this._clippingPlanesTexture=void 0)}if(0!==this.length){if(!Object(u.a)(t)){var o=JK(r,$K);o.y*=2;var s=new tj({wrapS:$D.CLAMP_TO_EDGE,wrapT:$D.CLAMP_TO_EDGE,minificationFilter:KD.NEAREST,magnificationFilter:ZD.NEAREST});n?(t=new hj({context:i,width:o.x,height:o.y,pixelFormat:gx.RGBA,pixelDatatype:mx.FLOAT,sampler:s,flipY:!1}),this._float32View=new Float32Array(o.x*o.y*4)):(t=new hj({context:i,width:o.x,height:o.y,pixelFormat:gx.RGBA,pixelDatatype:mx.UNSIGNED_BYTE,sampler:s,flipY:!1}),this._uint8View=new Uint8Array(o.x*o.y*4)),this._clippingPlanesTexture=t,this._multipleDirtyPlanes=!0}var c=this._dirtyIndex;if(this._multipleDirtyPlanes||-1!==c){if(this._multipleDirtyPlanes)n?(KK(this,0,this._planes.length),t.copyFrom({width:t.width,height:t.height,arrayBufferView:this._float32View})):(QK(this,0,this._planes.length),t.copyFrom({width:t.width,height:t.height,arrayBufferView:this._uint8View}));else{var l=0,h=0;n?(h=Math.floor(c/t.width),l=Math.floor(c-h*t.width),KK(this,c,c+1),t.copyFrom({width:1,height:1,arrayBufferView:this._float32View},l,h)):(h=Math.floor(2*c/t.width),l=Math.floor(2*c-h*t.width),QK(this,c,c+1),t.copyFrom({width:2,height:1,arrayBufferView:this._uint8View},l,h))}this._multipleDirtyPlanes=!1,this._dirtyIndex=-1}}};var eJ=new Be,tJ=new oc(z.UNIT_X,0);HK.prototype.computeIntersectionWithBoundingVolume=function(e,t){var i=this._planes,n=i.length,r=this.modelMatrix;Object(u.a)(t)&&(r=Be.multiply(t,r,eJ));var a=ce.INSIDE;!this.unionClippingRegions&&n>0&&(a=ce.OUTSIDE);for(var o=0;o<n;++o){var s=i[o];oc.transform(s,r,tJ);var c=e.intersectPlane(tJ);if(c===ce.INTERSECTING)a=c;else if(this._testIntersection(c))return c}return a},HK.setOwner=function(e,t,i){if(e!==t[i]&&(t[i]=t[i]&&t[i].destroy(),Object(u.a)(e))){if(Object(u.a)(e._owner))throw new h.a("ClippingPlaneCollection should only be assigned to one object");e._owner=t,t[i]=e}},HK.useFloatTexture=function(e){return e.floatingPointTexture},HK.getTextureResolution=function(e,t,i){var n=e.texture;if(Object(u.a)(n))return i.x=n.width,i.y=n.height,i;var r=JK(HK.useFloatTexture(t)?e.length:2*e.length,i);return r.y*=2,r},HK.prototype.isDestroyed=function(){return!1},HK.prototype.destroy=function(){return this._clippingPlanesTexture=this._clippingPlanesTexture&&this._clippingPlanesTexture.destroy(),rl(this)};var iJ=HK;function nJ(e,t,i){this._workerName=e,this._maxinumWorkers=Object(w.a)(t,5),this._maximumActiveTasks=Object(w.a)(i,5),this._aryWorkers=[],this._hasCreatedWorkers=0}function rJ(e,t){return e._activeTasks-t._activeTasks}nJ.prototype.getTaskProcessor=function(){var e=Oi.a.defer(),t=this;if(t._aryWorkers.length>0){t._aryWorkers.sort(rJ);for(var i=0;i<t._aryWorkers.length;i++){var n=t._aryWorkers[i];if(!n.isBusy())return e.resolve(n),e.promise}}if(t._hasCreatedWorkers<t._maxinumWorkers){var r=new pl(t._workerName,t._maximumActiveTasks);r.initWebAssemblyModule({modulePath:"ThirdParty/Workers/draco_wasm_wrapper.js",wasmBinaryFile:"ThirdParty/draco_decoder.wasm",fallbackModulePath:"ThirdParty/Workers/draco_decoder.js"}).then((function(){t._aryWorkers.push(r)})),++t._hasCreatedWorkers}return e.reject(void 0),e.promise};var aJ=nJ;function oJ(e,t){var i=t.length/4,n=Math.min(i,HD.maximumTextureSize),r=Math.ceil(i/HD.maximumTextureSize),a=1/n,o=.5*a,s=1/r,c=.5*s;this._textureDimensions=new Rt(n,r),this._textureStep=new Te(a,o,s,c),this._texture=new hj({context:e,pixelFormat:gx.RGBA,pixelDatatype:mx.FLOAT,source:{width:n,height:r,arrayBufferView:t},flipY:!1,sampler:new tj({minificationFilter:KD.NEAREST,magnificationFilter:ZD.NEAREST})})}Object(O.a)(oJ.prototype,{texture:{get:function(){return this._texture}},textureStep:{get:function(){return this._textureStep}},textureDimensions:{get:function(){return this._textureDimensions}}}),oJ.prototype.destroy=function(){this._texture.destroy(),this._textureDimensions=void 0,this._textureStep=void 0};var sJ=oJ;class cJ{constructor(e){e=Object(w.a)(e,w.a.EMPTY_OBJECT),x.a.defined("options.context",e.context),x.a.defined("options.typedArray",e.typedArray),this._gl=e.context._gl,e.typedArray instanceof Float32Array?this._bufferData=e.typedArray:this._bufferData=new Float32Array(e.typedArray),this._buffer=void 0,this.createUniformBuffer()}createUniformBuffer(){if(this._buffer=this._gl.createBuffer(),!this._buffer)throw new Error("Unable to create uniform buffer");this.bindUniformBuffer(this._buffer),this._gl.bufferData(this._gl.UNIFORM_BUFFER,this._bufferData,this._gl.STATIC_DRAW),this._gl.bufferSubData(this._gl.UNIFORM_BUFFER,0,this._bufferData),this.bindUniformBuffer(null)}bindUniformBuffer(e){this._gl.bindBuffer(this._gl.UNIFORM_BUFFER,e)}_bind(){this._gl.bindBufferBase(this._gl.UNIFORM_BUFFER,0,this._buffer)}_unbind(){this._gl.bindBufferBase(this._gl.UNIFORM_BUFFER,0,null)}destroy(){this._gl.deleteBuffer(this._buffer),this._buffer.destroy(),this._bufferData.destroy(),rl(this)}}function lJ(){}function uJ(e,t){var i="runtime."+Object.keys(e.createdBufferViews).length,n=e.buffers,r=Object.keys(n).length;return n[r]=t,e.createdBufferViews[i]={buffer:r,byteOffset:0,byteLength:t.byteLength},i}function hJ(e,t,i){var n=t._loadResources,r=uJ(n,e);return n.vertexBuffersToCreate.enqueue(r),r}function dJ(e,t,i,n){var r=i.primitivesToDecode.peek();if(Object(u.a)(r)){var a=e.scheduleTask(r,[r.array.buffer]);if(Object(u.a)(a))return i.activeDecodingTasks++,i.primitivesToDecode.dequeue(),a.then((function(e){i.activeDecodingTasks--;var n=function(e,t,i){var n=e.typedArray,r=t._loadResources,a=uJ(r,n);return r.indexBuffersToCreate.enqueue({id:a,componentType:dn.fromTypedArray(n)}),{bufferViewId:a,numberOfIndices:e.numberOfIndices}}(e.indexArray,t),a={},o=e.attributeData;for(var s in o)if(o.hasOwnProperty(s)){var c=o[s],l=hJ(c.array,t),u=c.data;u.bufferView=l,a[s]=u}t._decodedData[r.mesh+".primitive."+r.primitive]={bufferView:n.bufferViewId,numberOfIndices:n.numberOfIndices,attributes:a}}))}}lJ._maxDecodingConcurrency=Math.max(Ri.hardwareConcurrency-1,1),lJ._decoderTaskProcessorPool=void 0,lJ._getDecoderTaskProcessor=function(){return Object(u.a)(lJ._decoderTaskProcessorPool)||(lJ._decoderTaskProcessorPool=new aJ("decodeDraco",Ri.maxDecodingWorkers,lJ._maxDecodingConcurrency)),lJ._decoderTaskProcessorPool.getTaskProcessor()},lJ.hasExtension=function(e){return Object(u.a)(e.extensionsRequired.KHR_draco_mesh_compression)||Object(u.a)(e.extensionsUsed.KHR_draco_mesh_compression)},lJ._decodedModelResourceCache=void 0,lJ.parse=function(e,t){if(lJ.hasExtension(e)){var i=e._loadResources,n=e.cacheKey;if(Object(u.a)(n)){Object(u.a)(lJ._decodedModelResourceCache)||(Object(u.a)(t.cache.modelDecodingCache)||(t.cache.modelDecodingCache={}),lJ._decodedModelResourceCache=t.cache.modelDecodingCache);var r=lJ._decodedModelResourceCache[n];if(Object(u.a)(r))return r.count++,void(i.pendingDecodingCache=!0)}var a=e._dequantizeInShader,o=e.gltf;rZ.mesh(o,(function(e,t){rZ.meshPrimitive(e,(function(e,n){if(Object(u.a)(e.extensions)){var r=e.extensions.KHR_draco_mesh_compression;if(Object(u.a)(r)){var s=o.bufferViews[r.bufferView],c=Li(o.buffers[s.buffer].extras._pipeline.source,s.byteOffset,s.byteOffset+s.byteLength);i.primitivesToDecode.enqueue({mesh:t,primitive:n,array:c,bufferView:s,compressedAttributes:r.attributes,dequantizeInShader:a})}}}))}));var s=e.pbrBuffer;if(Object(u.a)(s)){var c=o.bufferViews[s.bufferView],l=Li(o.buffers[c.buffer].extras._pipeline.source,c.byteOffset,c.byteOffset+c.byteLength),h=new Float32Array(l.buffer,l.byteOffset);e._rendererResources.combineMaterial=new sJ(t,h)}}},lJ.decodeModel=function(e,t){if(!lJ.hasExtension(e))return Oi.a.resolve();var i=e._loadResources,n=e.cacheKey;if(Object(u.a)(n)&&Object(u.a)(lJ._decodedModelResourceCache)){var r=lJ._decodedModelResourceCache[n];if(Object(u.a)(r)&&i.pendingDecodingCache)return Object(Oi.a)(r.ready,(function(){e._decodedData=r.data,i.pendingDecodingCache=!1}));lJ._decodedModelResourceCache[n]={ready:!1,count:1,data:void 0}}if(0===i.primitivesToDecode.length)return Oi.a.resolve();for(var a=[],o=!0;o;)lJ._getDecoderTaskProcessor().then((function(t){var n=dJ(t,e,i);Object(u.a)(n)&&a.push(n),0===i.primitivesToDecode.length&&(o=!1)}),(function(e){o=!1}));return Oi.a.all(a)},lJ.decodePointCloud=function(e){lJ._getDecoderTaskProcessor().then((function(t){return t.scheduleTask(e,[e.buffer.buffer])}))},lJ.cacheDataForModel=function(e){var t=e.cacheKey;if(Object(u.a)(t)&&Object(u.a)(lJ._decodedModelResourceCache)){var i=lJ._decodedModelResourceCache[t];Object(u.a)(i)&&(i.ready=!0,i.data=e._decodedData)}},lJ.destroyCachedDataForModel=function(e){var t=e.cacheKey;if(Object(u.a)(t)&&Object(u.a)(lJ._decodedModelResourceCache)){var i=lJ._decodedModelResourceCache[t];Object(u.a)(i)&&0==--i.count&&delete lJ._decodedModelResourceCache[t]}};var fJ=lJ;var pJ=function(e,t,i){return x.a.typeOf.string("samplerUniformName",e),x.a.typeOf.string("matrixUniformName",t),x.a.typeOf.string("styleUniformName",i),"    float clipDistance = clip(gl_FragCoord, "+e+", "+t+"); \n    vec4 clippingPlanesEdgeColor = vec4(1.0); \n    clippingPlanesEdgeColor.rgb = "+i+".rgb; \n    float clippingPlanesEdgeWidth = "+i+".a; \n    if (clipDistance > 0.0 && clipDistance < clippingPlanesEdgeWidth) \n    { \n        gl_FragColor = clippingPlanesEdgeColor;\n    } \n"},mJ=new Rt;var _J=function(e,t){x.a.typeOf.object("clippingPlaneCollection",e),x.a.typeOf.object("context",t);var i=e.unionClippingRegions,n=e.length,r=iJ.useFloatTexture(t),a=iJ.getTextureResolution(e,t,mJ),o=a.x,s=a.y,c=r?function(e,t){var i=1/t,n=1/e+"";-1===n.indexOf(".")&&(n+=".0");var r=i+"";-1===r.indexOf(".")&&(r+=".0");return"vec4 getClippingPlane(sampler2D packedClippingPlanes, int clippingPlaneNumber, mat4 transform)\n{\n    int pixY = clippingPlaneNumber / "+e+";\n    int pixX = clippingPlaneNumber - (pixY * "+e+");\n    float u = (float(pixX) + 0.5) * "+n+";\n    float v = (float(pixY) + 0.5) * "+r+";\n    vec4 plane = texture2D(packedClippingPlanes, vec2(u, v));\n    return czm_transformPlane(plane, transform);\n}\n"}(o,s):function(e,t){var i=1/t,n=1/e+"";-1===n.indexOf(".")&&(n+=".0");var r=i+"";-1===r.indexOf(".")&&(r+=".0");return"vec4 getClippingPlane(sampler2D packedClippingPlanes, int clippingPlaneNumber, mat4 transform)\n{\n    int clippingPlaneStartIndex = clippingPlaneNumber * 2;\n    int pixY = clippingPlaneStartIndex / "+e+";\n    int pixX = clippingPlaneStartIndex - (pixY * "+e+");\n    float u = (float(pixX) + 0.5) * "+n+";\n    float v = (float(pixY) + 0.5) * "+r+";\n    vec4 oct32 = texture2D(packedClippingPlanes, vec2(u, v)) * 255.0;\n    vec2 oct = vec2(oct32.x * 256.0 + oct32.y, oct32.z * 256.0 + oct32.w);\n    vec4 plane;\n    plane.xyz = czm_octDecode(oct, 65535.0);\n    plane.w = czm_unpackFloat(texture2D(packedClippingPlanes, vec2(u + "+n+", v)));\n    return czm_transformPlane(plane, transform);\n}\n"}(o,s);return c+="\n",c+=i?function(e){return"float clip(vec4 fragCoord, sampler2D clippingPlanes, mat4 clippingPlanesMatrix)\n{\n    vec4 position = czm_windowToEyeCoordinates(fragCoord);\n    vec3 clipNormal = vec3(0.0);\n    vec3 clipPosition = vec3(0.0);\n    float clipAmount;\n    float pixelWidth = czm_metersPerPixel(position);\n    bool breakAndDiscard = false;\n    for (int i = 0; i < "+e+"; ++i)\n    {\n        vec4 clippingPlane = getClippingPlane(clippingPlanes, i, clippingPlanesMatrix);\n        clipNormal = clippingPlane.xyz;\n        clipPosition = -clippingPlane.w * clipNormal;\n        float amount = dot(clipNormal, (position.xyz - clipPosition)) / pixelWidth;\n        clipAmount = czm_branchFreeTernary(i == 0, amount, min(amount, clipAmount));\n        if (amount <= 0.0)\n        {\n           breakAndDiscard = true;\n           break;\n        }\n    }\n    if (breakAndDiscard) {\n        discard;\n    }\n    return clipAmount;\n}\n"}(n):function(e){return"float clip(vec4 fragCoord, sampler2D clippingPlanes, mat4 clippingPlanesMatrix)\n{\n    bool clipped = true;\n    vec4 position = czm_windowToEyeCoordinates(fragCoord);\n    vec3 clipNormal = vec3(0.0);\n    vec3 clipPosition = vec3(0.0);\n    float clipAmount = 0.0;\n    float pixelWidth = czm_metersPerPixel(position);\n    for (int i = 0; i < "+e+"; ++i)\n    {\n        vec4 clippingPlane = getClippingPlane(clippingPlanes, i, clippingPlanesMatrix);\n        clipNormal = clippingPlane.xyz;\n        clipPosition = -clippingPlane.w * clipNormal;\n        float amount = dot(clipNormal, (position.xyz - clipPosition)) / pixelWidth;\n        clipAmount = max(amount, clipAmount);\n        clipped = clipped && (amount <= 0.0);\n    }\n    if (clipped)\n    {\n        discard;\n    }\n    return clipAmount;\n}\n"}(n)},gJ=Object(E.a)({TEXTURE:0,PROGRAM:1,BUFFER:2,NUMBER_OF_JOB_TYPES:3});function vJ(){}var bJ=/^data\:/i;function yJ(e,t){var i=e.gltf,n=i.buffers,r=i.bufferViews[t.bufferView],a=n[r.buffer],o=r.byteOffset+t.byteOffset,s=t.count*aZ(t.type),c=bJ.test(a.uri)?"":a.uri;return e.cacheKey+"//"+c+"/"+o+"/"+s}var wJ={};vJ.getAnimationParameterValues=function(e,t){var i=yJ(e,t),n=wJ[i];if(!Object(u.a)(n)){var r=e.gltf,a=r.buffers,o=r.bufferViews[t.bufferView],s=a[o.buffer].extras._pipeline.source,c=t.componentType,l=t.type,h=aZ(l),d=t.count,f=oZ(r,t);n=new Array(d);for(var p=Object(w.a)(t.byteOffset,0),m=o.byteOffset+p,_=0;_<d;_++){var g=dn.createArrayBufferView(c,s.buffer,s.byteOffset+m,h);"SCALAR"===l?n[_]=g[0]:"VEC3"===l?n[_]=z.fromArray(g):"VEC4"===l&&(n[_]=Kn.unpack(g)),m+=f}Object(u.a)(e.cacheKey)&&(wJ[i]=n)}return n};var OJ={};function xJ(e){this._value=e}xJ.prototype.evaluate=function(e,t){return this._value},xJ.prototype.wrapTime=function(e){return 0},xJ.prototype.clampTime=function(e){return 0},vJ.getAnimationSpline=function(e,t,i,n,r,a,o,s){var c=function(e,t,i){return e.cacheKey+"//"+t+"/"+i}(e,t,n),l=OJ[c];if(!Object(u.a)(l)){var h=a,d=s;1===h.length&&1===d.length?l=new xJ(d[0]):"LINEAR"===r.interpolation&&("translation"===o||"scale"===o?l=new so({times:h,points:d}):"rotation"===o?l=new VT({times:h,points:d}):"weights"===o&&(l=new WI({times:h,weights:d}))),Object(u.a)(e.cacheKey)&&(OJ[c]=l)}return l};var EJ={};vJ.getSkinInverseBindMatrices=function(e,t){var i=yJ(e,t),n=EJ[i];if(!Object(u.a)(n)){var r=e.gltf,a=r.buffers,o=r.bufferViews[t.bufferView],s=a[o.buffer].extras._pipeline.source,c=t.componentType,l=t.type,h=t.count,d=oZ(r,t),f=o.byteOffset+t.byteOffset,p=aZ(l);if(n=new Array(h),c===un.FLOAT&&l===_X.MAT4)for(var m=0;m<h;++m){var _=dn.createArrayBufferView(c,s.buffer,s.byteOffset+f,p);n[m]=Be.fromArray(_),f+=d}EJ[i]=n}return n};var TJ=vJ,CJ=Object(E.a)({NONE:0,REPEAT:1,MIRRORED_REPEAT:2}),SJ=Object(E.a)({STOPPED:0,ANIMATING:1});function AJ(e,t,i){this._name=i.name,this._startTime=Tr.clone(e.startTime),this._delay=Object(w.a)(e.delay,0),this._stopTime=e.stopTime,this.removeOnStop=Object(w.a)(e.removeOnStop,!1),this._multiplier=Object(w.a)(e.multiplier,1),this._reverse=Object(w.a)(e.reverse,!1),this._loop=Object(w.a)(e.loop,CJ.NONE),this.start=new $o.a,this.update=new $o.a,this.stop=new $o.a,this._state=SJ.STOPPED,this._runtimeAnimation=i,this._computedStartTime=void 0,this._duration=void 0;var n=this;this._raiseStartEvent=function(){n.start.raiseEvent(t,n)},this._updateEventTime=0,this._raiseUpdateEvent=function(){n.update.raiseEvent(t,n,n._updateEventTime)},this._raiseStopEvent=function(){n.stop.raiseEvent(t,n)}}Object(O.a)(AJ.prototype,{name:{get:function(){return this._name}},startTime:{get:function(){return this._startTime}},delay:{get:function(){return this._delay}},stopTime:{get:function(){return this._stopTime}},multiplier:{get:function(){return this._multiplier}},reverse:{get:function(){return this._reverse}},loop:{get:function(){return this._loop}}});var PJ=AJ;function IJ(e){this.animationAdded=new $o.a,this.animationRemoved=new $o.a,this._model=e,this._scheduledAnimations=[],this._previousTime=void 0}function DJ(e,t,i){var n=e._model,r=n._runtime.animations[t],a=new PJ(i,n,r);return e._scheduledAnimations.push(a),e.animationAdded.raiseEvent(n,a),a}function jJ(e,t){for(var i=e.channelEvaluators,n=i.length,r=0;r<n;++r)i[r](t)}Object(O.a)(IJ.prototype,{length:{get:function(){return this._scheduledAnimations.length}}}),IJ.prototype.add=function(e){e=Object(w.a)(e,w.a.EMPTY_OBJECT);var t,i=this._model._runtime.animations;if(!Object(u.a)(i))throw new h.a("Animations are not loaded.  Wait for Model.readyPromise to resolve.");if(!Object(u.a)(e.name)&&!Object(u.a)(e.index))throw new h.a("Either options.name or options.index must be defined.");if(Object(u.a)(e.multiplier)&&e.multiplier<=0)throw new h.a("options.multiplier must be greater than zero.");if(Object(u.a)(e.index)&&(e.index>=i.length||e.index<0))throw new h.a("options.index must be a valid animation index.");if(Object(u.a)(e.index))return DJ(this,e.index,e);for(var n=i.length,r=0;r<n;++r)if(i[r].name===e.name){t=r;break}if(!Object(u.a)(t))throw new h.a("options.name must be a valid animation name.");return DJ(this,t,e)},IJ.prototype.addAll=function(e){if(e=Object(w.a)(e,w.a.EMPTY_OBJECT),!Object(u.a)(this._model._runtime.animations))throw new h.a("Animations are not loaded.  Wait for Model.readyPromise to resolve.");if(Object(u.a)(e.multiplier)&&e.multiplier<=0)throw new h.a("options.multiplier must be greater than zero.");for(var t=[],i=this._model._runtime.animations.length,n=0;n<i;++n)t.push(DJ(this,n,e));return t},IJ.prototype.remove=function(e){if(Object(u.a)(e)){var t=this._scheduledAnimations,i=t.indexOf(e);if(-1!==i)return t.splice(i,1),this.animationRemoved.raiseEvent(this._model,e),!0}return!1},IJ.prototype.removeAll=function(){var e=this._model,t=this._scheduledAnimations,i=t.length;this._scheduledAnimations=[];for(var n=0;n<i;++n)this.animationRemoved.raiseEvent(e,t[n])},IJ.prototype.contains=function(e){return!!Object(u.a)(e)&&-1!==this._scheduledAnimations.indexOf(e)},IJ.prototype.get=function(e){if(!Object(u.a)(e))throw new h.a("index is required.");return this._scheduledAnimations[e]};var MJ=[];function RJ(e,t,i){return function(){e.animationRemoved.raiseEvent(t,i)}}IJ.prototype.update=function(e){var t=this._scheduledAnimations,i=t.length;if(0===i)return this._previousTime=void 0,!1;if(Tr.equals(e.time,this._previousTime))return!1;this._previousTime=Tr.clone(e.time,this._previousTime);for(var n=!1,r=e.time,a=this._model,o=0;o<i;++o){var s=t[o],c=s._runtimeAnimation;Object(u.a)(s._computedStartTime)||(s._computedStartTime=Tr.addSeconds(Object(w.a)(s.startTime,r),s.delay,new Tr)),Object(u.a)(s._duration)||(s._duration=c.stopTime*(1/s.multiplier));var l=s._computedStartTime,h=s._duration,d=s.stopTime,f=0!==h?Tr.secondsDifference(r,l)/h:0,p=f>=0,m=s.loop===CJ.REPEAT||s.loop===CJ.MIRRORED_REPEAT;if((p||m&&!Object(u.a)(s.startTime))&&(f<=1||m)&&(!Object(u.a)(d)||Tr.lessThanOrEquals(r,d))){if(s._state===SJ.STOPPED&&(s._state=SJ.ANIMATING,s.start.numberOfListeners>0&&e.afterRender.push(s._raiseStartEvent)),s.loop===CJ.REPEAT)f-=Math.floor(f);else if(s.loop===CJ.MIRRORED_REPEAT){var _=Math.floor(f),g=f-_;f=_%2==1?1-g:g}s.reverse&&(f=1-f);var v=f*h*s.multiplier;jJ(c,v=I.clamp(v,c.startTime,c.stopTime)),s.update.numberOfListeners>0&&(s._updateEventTime=v,e.afterRender.push(s._raiseUpdateEvent)),n=!0}else p&&s._state===SJ.ANIMATING&&(s._state=SJ.STOPPED,s.stop.numberOfListeners>0&&e.afterRender.push(s._raiseStopEvent),s.removeOnStop&&MJ.push(s))}i=MJ.length;for(var b=0;b<i;++b){var y=MJ[b];t.splice(t.indexOf(y),1),e.afterRender.push(RJ(this,a,y))}return MJ.length=0,n};var LJ=IJ;function NJ(e,t,i){this._name=t.name,this._id=i,this._uniformMap=e._uniformMaps[i],this._technique=void 0,this._program=void 0,this._values=void 0,this._use_texture_pbrmat=!1}Object(O.a)(NJ.prototype,{name:{get:function(){return this._name}},id:{get:function(){return this._id}},use_texture_pbrmat:{get:function(){return this._use_texture_pbrmat},set:function(e){this._use_texture_pbrmat=e}}}),NJ.prototype.setValue=function(e,t){if(!Object(u.a)(e))throw new h.a("name is required.");var i="u_"+e,n=this._uniformMap.values[i];if(!Object(u.a)(n))throw new h.a("name must match a parameter name in the material's technique that is targetable and not optimized out.");n.value=n.clone(t,n.value)},NJ.prototype.getValue=function(e){if(!Object(u.a)(e))throw new h.a("name is required.");var t="u_"+e,i=this._uniformMap.values[t];if(Object(u.a)(i))return i.value};var FJ=NJ;function kJ(e,t,i){for(var n=[],r=e.primitives,a=r.length,o=0;o<a;++o){var s=r[o];n[o]=t[s.material]}this._name=e.name,this._materials=n,this._id=i}Object(O.a)(kJ.prototype,{name:{get:function(){return this._name}},id:{get:function(){return this._id}},materials:{get:function(){return this._materials}}});var BJ=kJ;function zJ(e,t,i,n,r){this._model=e,this._runtimeNode=i,this._name=t.name,this._id=n,this.useMatrix=!1,this._show=!0,this._matrix=Be.clone(r)}Object(O.a)(zJ.prototype,{name:{get:function(){return this._name}},id:{get:function(){return this._id}},show:{get:function(){return this._show},set:function(e){this._show!==e&&(this._show=e,this._model._perNodeShowDirty=!0)}},matrix:{get:function(){return this._matrix},set:function(e){this._matrix=Be.clone(e,this._matrix),this.useMatrix=!0;var t=this._model;t._cesiumAnimationsDirty=!0,this._runtimeNode.dirtyNumber=t._maxDirtyNumber}}}),zJ.prototype.setMatrix=function(e){Be.clone(e,this._matrix)};var UJ=zJ,VJ="varying vec2 v_textureCoordinates;\nuniform float originalSize;\nuniform sampler2D texture0;\nuniform sampler2D texture1;\nuniform sampler2D texture2;\nuniform sampler2D texture3;\nuniform sampler2D texture4;\nuniform sampler2D texture5;\nconst float yMipLevel1 = 1.0 - (1.0 / pow(2.0, 1.0));\nconst float yMipLevel2 = 1.0 - (1.0 / pow(2.0, 2.0));\nconst float yMipLevel3 = 1.0 - (1.0 / pow(2.0, 3.0));\nconst float yMipLevel4 = 1.0 - (1.0 / pow(2.0, 4.0));\nvoid main()\n{\nvec2 uv = v_textureCoordinates;\nvec2 textureSize = vec2(originalSize * 1.5 + 2.0, originalSize);\nvec2 pixel = 1.0 / textureSize;\nfloat mipLevel = 0.0;\nif (uv.x - pixel.x > (textureSize.y / textureSize.x))\n{\nmipLevel = 1.0;\nif (uv.y - pixel.y > yMipLevel1)\n{\nmipLevel = 2.0;\nif (uv.y - pixel.y * 3.0 > yMipLevel2)\n{\nmipLevel = 3.0;\nif (uv.y - pixel.y * 5.0 > yMipLevel3)\n{\nmipLevel = 4.0;\nif (uv.y - pixel.y * 7.0 > yMipLevel4)\n{\nmipLevel = 5.0;\n}\n}\n}\n}\n}\nif (mipLevel > 0.0)\n{\nfloat scale = pow(2.0, mipLevel);\nuv.y -= (pixel.y * (mipLevel - 1.0) * 2.0);\nuv.x *= ((textureSize.x - 2.0) / textureSize.y);\nuv.x -= 1.0 + pixel.x;\nuv.y -= (1.0 - (1.0 / pow(2.0, mipLevel - 1.0)));\nuv *= scale;\n}\nelse\n{\nuv.x *= (textureSize.x / textureSize.y);\n}\nif(mipLevel == 0.0)\n{\ngl_FragColor = texture2D(texture0, uv);\n}\nelse if(mipLevel == 1.0)\n{\ngl_FragColor = texture2D(texture1, uv);\n}\nelse if(mipLevel == 2.0)\n{\ngl_FragColor = texture2D(texture2, uv);\n}\nelse if(mipLevel == 3.0)\n{\ngl_FragColor = texture2D(texture3, uv);\n}\nelse if(mipLevel == 4.0)\n{\ngl_FragColor = texture2D(texture4, uv);\n}\nelse if(mipLevel == 5.0)\n{\ngl_FragColor = texture2D(texture5, uv);\n}\nelse\n{\ngl_FragColor = vec4(0.0);\n}\n}\n",HJ="varying vec3 v_cubeMapCoordinates;\nuniform samplerCube cubeMap;\nvoid main()\n{\nvec4 rgbm = textureCube(cubeMap, v_cubeMapCoordinates);\nfloat m = rgbm.a * 16.0;\nvec3 r = rgbm.rgb * m;\ngl_FragColor = vec4(r * r, 1.0);\n}\n",GJ="attribute vec4 position;\nattribute vec3 cubeMapCoordinates;\nvarying vec3 v_cubeMapCoordinates;\nvoid main()\n{\ngl_Position = position;\nv_cubeMapCoordinates = cubeMapCoordinates;\n}\n";function qJ(e){this._url=e,this._cubeMapBuffers=void 0,this._cubeMaps=void 0,this._texture=void 0,this._mipTextures=void 0,this._va=void 0,this._sp=void 0,this._maximumMipmapLevel=void 0,this._loading=!1,this._ready=!1,this._readyPromise=Oi.a.defer()}Object(O.a)(qJ.prototype,{url:{get:function(){return this._url}},texture:{get:function(){return this._texture}},maximumMipmapLevel:{get:function(){return this._maximumMipmapLevel}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise.promise}}}),qJ.isSupported=function(e){return e.colorBufferHalfFloat&&e.halfFloatingPointTexture||e.floatingPointTexture&&e.colorBufferFloat};for(var WJ=new z(1,0,0),YJ=new z(0,0,1),XJ=new z(-1,0,0),ZJ=new z(0,0,-1),QJ=new z(0,1,0),KJ=[QJ,XJ,YJ,new z(0,-1,0),WJ,QJ,ZJ,QJ,QJ],JJ=KJ.length,$J=new Float32Array(3*JJ),e$=0,t$=0;t$<JJ;++t$,e$+=3)z.pack(KJ[t$],$J,e$);var i$=new Float32Array([-1,1,-1,0,0,1,0,0,1,0,1,1,0,-1,-1,-1,1,-1]),n$=new Uint16Array([0,1,2,2,3,1,7,6,1,3,6,1,2,5,4,3,4,2,4,8,6,3,4,6]);function r$(e){return function(){return e}}function a$(e){var t,i;e._va=e._va&&e._va.destroy(),e._sp=e._sp&&e._sp.destroy();var n=e._cubeMaps;if(Object(u.a)(n))for(i=n.length,t=0;t<i;++t)n[t].destroy();var r=e._mipTextures;if(Object(u.a)(r))for(i=r.length,t=0;t<i;++t)r[t].destroy();e._va=void 0,e._sp=void 0,e._cubeMaps=void 0,e._cubeMapBuffers=void 0,e._mipTextures=void 0}qJ.prototype.update=function(e){var t=e.context;if(qJ.isSupported(t)&&(Object(u.a)(this._texture)&&Object(u.a)(this._va)&&a$(this),!Object(u.a)(this._texture))){if(!Object(u.a)(this._texture)&&!this._loading){var i=t.textureCache.getTexture(this._url);if(Object(u.a)(i))return a$(this),this._texture=i,this._maximumMipmapLevel=this._texture.maximumMipmapLevel,this._ready=!0,void this._readyPromise.resolve()}var n=this._cubeMapBuffers;if(!Object(u.a)(n)&&!this._loading){var r=this;Ox(this._url).then((function(e){r._cubeMapBuffers=e,r._loading=!1})),this._loading=!0}if(Object(u.a)(this._cubeMapBuffers)){this._va=function(e){var t=ZN.createVertexBuffer({context:e,typedArray:i$,usage:YN.STATIC_DRAW}),i=ZN.createVertexBuffer({context:e,typedArray:$J,usage:YN.STATIC_DRAW}),n=ZN.createIndexBuffer({context:e,typedArray:n$,usage:YN.STATIC_DRAW,indexDatatype:Sl.UNSIGNED_SHORT}),r=[{index:0,vertexBuffer:t,componentsPerAttribute:2,componentDatatype:dn.FLOAT},{index:1,vertexBuffer:i,componentsPerAttribute:3,componentDatatype:dn.FLOAT}];return new tF({context:e,attributes:r,indexBuffer:n})}(t),this._sp=bR.fromCache({context:t,vertexShaderSource:GJ,fragmentShaderSource:HJ,attributeLocations:{position:0,cubeMapCoordinates:1}});var a=Math.min(n.length,6);this._maximumMipmapLevel=a-1;for(var o=this._cubeMaps=new Array(a),s=this._mipTextures=new Array(a),c=2*n[0].positiveX.width,l={originalSize:function(){return c}},h=t.halfFloatingPointTexture?mx.HALF_FLOAT:mx.FLOAT,d=gx.RGBA,f=0;f<a;++f){var p=n[f].positiveY;n[f].positiveY=n[f].negativeY,n[f].negativeY=p;var m=o[f]=new nj({context:t,source:n[f]}),_=2*o[f].width,g=s[f]=new hj({context:t,width:_,height:_,pixelDatatype:h,pixelFormat:d}),v=new OX({vertexArray:this._va,shaderProgram:this._sp,uniformMap:{cubeMap:r$(m)},outputTexture:g,persists:!0,owner:this});e.commandList.push(v),l["texture"+f]=r$(g)}this._texture=new hj({context:t,width:1.5*c+2,height:c,pixelDatatype:h,pixelFormat:d}),this._texture.maximumMipmapLevel=this._maximumMipmapLevel,t.textureCache.addTexture(this._url,this._texture);var b=new OX({fragmentShaderSource:VJ,uniformMap:l,outputTexture:this._texture,persists:!1,owner:this});e.commandList.push(b),this._ready=!0,this._readyPromise.resolve()}}},qJ.prototype.isDestroyed=function(){return!1},qJ.prototype.destroy=function(){return a$(this),this._texture=this._texture&&this._texture.destroy(),rl(this)};var o$=qJ;function s$(){}s$._edgeWasm=void 0,s$.object={},s$._edgeColor=new Te(.1,.1,.1,1),s$.edgeFrag="#ifdef GL_EXT_frag_depth\n#extension GL_EXT_frag_depth : enable\n#endif\n uniform  vec4 color;\n#ifdef ENABLE_CLIPPING_PLANES\nuniform sampler2D u_clippingPlanes;\nuniform mat4 u_clippingPlanesMatrix;\nuniform vec4 u_clippingPlanesEdgeStyle;\n#endif\n void main() \n{ \n    vec4 finalColor = color;\n#ifdef ENABLE_CLIPPING_PLANES\n    float clipDistance = clip(gl_FragCoord, u_clippingPlanes, u_clippingPlanesMatrix);\n#endif\n#ifdef ENABLE_CLIPPING_PLANES\n    vec4 clippingPlanesEdgeColor = vec4(1.0);\n    clippingPlanesEdgeColor.rgb = u_clippingPlanesEdgeStyle.rgb;\n    float clippingPlanesEdgeWidth = u_clippingPlanesEdgeStyle.a;\n\n    if (clipDistance > 0.0 && clipDistance < clippingPlanesEdgeWidth)\n    {\n        finalColor = clippingPlanesEdgeColor;\n    }\n#endif\n  gl_FragColor  = color;\n  czm_writeLogDepth();\n#if defined(GL_EXT_frag_depth)\n  gl_FragDepthEXT -= 2.5e-5;\n#endif\n} \n",s$.edgeVert="attribute vec3 aPosition;\nuniform bool isInstance;\nattribute vec4 instanceModelMatrixRow0;\nattribute vec4 instanceModelMatrixRow1;\nattribute vec4 instanceModelMatrixRow2;\nattribute vec4 instanceModelMatrixRow3;\nvec3 transformInstancePosition(vec3 position)\n{\n    vec3 transformPosition = position;\n    if(isInstance){\n        mat4 instancedModelMatirx = mat4(instanceModelMatrixRow0.x, instanceModelMatrixRow0.y, instanceModelMatrixRow0.z, instanceModelMatrixRow0.w, instanceModelMatrixRow1.x, instanceModelMatrixRow1.y, instanceModelMatrixRow1.z, instanceModelMatrixRow1.w, instanceModelMatrixRow2.x, instanceModelMatrixRow2.y, instanceModelMatrixRow2.z, instanceModelMatrixRow2.w, instanceModelMatrixRow3.x, instanceModelMatrixRow3.y, instanceModelMatrixRow3.z, instanceModelMatrixRow3.w);\n        transformPosition = (instancedModelMatirx * vec4(transformPosition, 1.0)).xyz;\n    }\n    return transformPosition;\n}uniform mat4 u_modelViewMatrix; \nuniform mat4 modelMatrix; \nvoid main(){\n  gl_Position = czm_projection *  u_modelViewMatrix * vec4( transformInstancePosition(aPosition) , 1.0 ); \n}\n",s$.parser=function(e,t,i,n,r,a,o){if(e.calcEdge){var s,c;e.gltf.accessors;if(!e._dequantizeInShader&&e.dracoModel){var l=e._loadResources;s=l.buffers[l.createdBufferViews[t.attributes.POSITION.bufferView].buffer],c=l.buffers[l.createdBufferViews[t.bufferView].buffer]}var h=s$._edgeWasm._malloc(8*s.length);s$._edgeWasm.HEAPF64.set(s,h/8);var d=s$._edgeWasm._malloc(4*c.length);s$._edgeWasm.HEAPU32.set(c,d/4);var f=s$._edgeWasm.cwrap("refuse","number",["number","number","number","number","number"])(h,s.length,d,c.length,.1),p=s$._edgeWasm.cwrap("getSize","number",["null"]),m=s$._edgeWasm.HEAPU32.subarray(f>>2,(f>>2)+p());if(s$._edgeWasm._free(h),s$._edgeWasm._free(d),0===m.length)return;!function(e,t,i,n,r,a,o){var s=i.modelMatrix,c={color:function(){return s$._edgeColor},modelMatrix:function(){return s},u_modelViewMatrix:function(){return t.uniformState.modelView},u_clippingPlanes:u$(a),u_clippingPlanesMatrix:l$(a),u_clippingPlanesEdgeStyle:function(){return new Te(0,0,0,0)}};Object(u.a)(s$.object.shaderProgram)||(s$.object.shaderProgram=bR.fromCache({context:t,vertexShaderSource:s$.edgeVert,fragmentShaderSource:s$.edgeFrag}));var l=ZN.createVertexBuffer({context:t,typedArray:e,usage:YN.STATIC_DRAW}),h=ZN.createIndexBuffer({context:t,typedArray:r,usage:YN.STATIC_DRAW,indexDatatype:Sl.UNSIGNED_INT});Object(u.a)(s$.object.rs)||(s$.object.rs=RM.fromCache({depthTest:{enabled:!0},depthMask:!0,blending:FD.DISABLED}));var d=[];d.push({index:0,enabled:!0,vertexBuffer:l,componentDatatype:dn.FLOAT,componentsPerAttribute:3,normalize:!1});var f=a._instanceTransformVertexBuffer[o];if(f){var p=dn.getSizeInBytes(dn.FLOAT);d.push({index:1,vertexBuffer:f,componentsPerAttribute:4,componentDatatype:dn.FLOAT,normalize:!1,offsetInBytes:0,strideInBytes:16*p,instanceDivisor:1}),d.push({index:2,vertexBuffer:f,componentsPerAttribute:4,componentDatatype:dn.FLOAT,normalize:!1,offsetInBytes:4*p,strideInBytes:16*p,instanceDivisor:1}),d.push({index:3,vertexBuffer:f,componentsPerAttribute:4,componentDatatype:dn.FLOAT,normalize:!1,offsetInBytes:8*p,strideInBytes:16*p,instanceDivisor:1}),d.push({index:4,vertexBuffer:f,componentsPerAttribute:4,componentDatatype:dn.FLOAT,normalize:!1,offsetInBytes:12*p,strideInBytes:16*p,instanceDivisor:1})}var m=new tF({context:t,attributes:d,indexBuffer:h});c.isInstance=function(){return Object(u.a)(f)};var _=new cM({owner:s$,cull:!0,modelMatrix:s,primitiveType:yn.LINES,boundingVolume:i.boundingVolume,vertexArray:m,shaderProgram:s$.object.shaderProgram,uniformMap:c,renderState:s$.object.rs,pass:lM.OPAQUE,instanceCount:i.instanceCount});n.edgeCommand=_}(s,n,r,a,m,e,o)}},s$.draw=function(e,t,i,n,r){var a=i.commandList;if(t.edgeCommand instanceof cM&&e.calcEdge){var o=s$.edgeVert;if(void 0!==e.clippingPlanes&&e.clippingPlanes.length>0){if(e.lastClippingPlanesLength!==e.clippingPlanes.length){e.lastClippingPlanesLength=e.clippingPlanes.length;var s="#define ENABLE_CLIPPING_PLANES \n";s+=_J(e.clippingPlanes,n),s+=this.edgeFrag,e.edgeShaderProgram=bR.fromCache({context:n,vertexShaderSource:o,fragmentShaderSource:s})}t.edgeCommand.shaderProgram=e.edgeShaderProgram}else t.edgeCommand.shaderProgram=s$.object.shaderProgram;a.push(t.edgeCommand)}};var c$=new Be;function l$(e){return function(){var t=e.clippingPlanes;if(!Object(u.a)(t)&&!Object(u.a)(e._sphericalHarmonicCoefficients)&&!Object(u.a)(e._specularEnvironmentMaps))return Be.IDENTITY;var i=Object(u.a)(t)?t.modelMatrix:Be.IDENTITY;return Be.multiply(e._clippingPlaneModelViewMatrix,i,c$)}}function u$(e){return function(){var t=e.clippingPlanes;return Object(u.a)(t)&&t.enabled?t.texture:e._defaultTexture}}var h$=s$,d$="attribute float instanceBatchId;\nattribute vec4 instanceModelMatrixRow0;\nattribute vec4 instanceModelMatrixRow1;\nattribute vec4 instanceModelMatrixRow2;\nattribute vec4 instanceModelMatrixRow3;\nuniform bool isInstance;\nvec3 real_position;\nvec3 transformInstancePosition(vec3 position)\n{\nvec3 transformPosition = position;\nif(isInstance){\nmat4 instancedModelMatirx = mat4(instanceModelMatrixRow0.x, instanceModelMatrixRow0.y, instanceModelMatrixRow0.z, instanceModelMatrixRow0.w, instanceModelMatrixRow1.x, instanceModelMatrixRow1.y, instanceModelMatrixRow1.z, instanceModelMatrixRow1.w, instanceModelMatrixRow2.x, instanceModelMatrixRow2.y, instanceModelMatrixRow2.z, instanceModelMatrixRow2.w, instanceModelMatrixRow3.x, instanceModelMatrixRow3.y, instanceModelMatrixRow3.z, instanceModelMatrixRow3.w);\ntransformPosition = (instancedModelMatirx * vec4(transformPosition, 1.0)).xyz;\n}\nreturn transformPosition;\n}\n",f$=new z,p$=wQ.ModelState;function m$(e,t){e._cachedGltf=t}function _$(e){this._gltf=e.gltf,this.ready=e.ready,this.modelsToLoad=[],this.count=0}Object(O.a)(_$.prototype,{gltf:{set:function(e){this._gltf=e},get:function(){return this._gltf}}}),_$.prototype.makeReady=function(e){this.gltf=e;for(var t=this.modelsToLoad,i=t.length,n=0;n<i;++n){var r=t[n];r.isDestroyed()||m$(r,this)}this.modelsToLoad=void 0,this.ready=!0};var g$={},v$={};function b$(e){var t,i=(e=Object(w.a)(e,w.a.EMPTY_OBJECT)).cacheKey;if(this._cacheKey=i,this._cachedGltf=void 0,this._releaseGltfJson=Object(w.a)(e.releaseGltfJson,!1),this._useScience=Object(w.a)(e.useScience,void 0),Object(u.a)(this._useScience)&&(this.scienceEnabled=this._useScience.enabled,this.scienceTexture=this._useScience.texture,this.scienceBlink=this._useScience.blink,this.scienceColor=this._useScience.scienceColor),this._useHolo=Object(w.a)(e.useHolo,void 0),this._forceMipmap=Object(w.a)(e.forceMipmap,!1),this._lazyLoadBlockSize=Object(w.a)(e.lazyLoadBlockSize,50),Object(u.a)(i)&&Object(u.a)(g$[i])&&g$[i].ready)++(t=g$[i]).count;else{var n=e.gltf;if(Object(u.a)(n)){if(n instanceof ArrayBuffer&&(n=new Uint8Array(n)),n instanceof Uint8Array){var r=mZ(n);K0(r),t=new _$({gltf:r,ready:!0})}else if(this._forceMipmap){var a=e.gltf;K0(a),t=new _$({gltf:a,ready:!0})}else t=new _$({gltf:e.gltf,ready:!0});t.count=1,Object(u.a)(i)&&(g$[i]=t)}}m$(this,t);var o=Object(w.a)(e.basePath,"");this._resource=f.a.createIfNeeded(o),this.show=Object(w.a)(e.show,!0),this.silhouetteColor=Object(w.a)(e.silhouetteColor,uf.RED),this._silhouetteColor=new uf,this._silhouetteColorPreviousAlpha=1,this._normalAttributeName=void 0,this.silhouetteSize=Object(w.a)(e.silhouetteSize,0),this.modelMatrix=Be.clone(Object(w.a)(e.modelMatrix,Be.IDENTITY)),this._modelMatrix=Be.clone(this.modelMatrix),this._clampedModelMatrix=void 0,this.scale=Object(w.a)(e.scale,1),this._scale=this.scale,this.minimumPixelSize=Object(w.a)(e.minimumPixelSize,0),this._minimumPixelSize=this.minimumPixelSize,this.maximumScale=e.maximumScale,this._maximumScale=this.maximumScale,this.id=e.id,this._id=e.id,this.heightReference=Object(w.a)(e.heightReference,eD.NONE),this._heightReference=this.heightReference,this._heightChanged=!1,this._removeUpdateHeightCallback=void 0;var s=e.scene;this._scene=s,Object(u.a)(s)&&Object(u.a)(s.terrainProviderChanged)&&(this._terrainProviderChangedCallback=s.terrainProviderChanged.addEventListener((function(){this._heightChanged=!0}),this)),this._pickObject=e.pickObject,this._allowPicking=Object(w.a)(e.allowPicking,!0),this._ready=!1,this._readyPromise=Oi.a.defer(),this.activeAnimations=new LJ(this),this.clampAnimations=Object(w.a)(e.clampAnimations,!0),this._defaultTexture=void 0,this._incrementallyLoadTextures=Object(w.a)(e.incrementallyLoadTextures,!0),this._asynchronous=Object(w.a)(e.asynchronous,!0),this.shadows=Object(w.a)(e.shadows,rM.ENABLED),this._shadows=this.shadows,this.color=Object(w.a)(e.color,uf.WHITE),this._color=new uf,this._colorPreviousAlpha=1,this.colorBlendMode=Object(w.a)(e.colorBlendMode,sW.HIGHLIGHT),this.colorBlendAmount=Object(w.a)(e.colorBlendAmount,.5),this._colorShadingEnabled=!1,this._clippingPlanes=void 0,this.clippingPlanes=e.clippingPlanes,this._clippingPlanesState=0,this.clippingPlanesOriginMatrix=void 0,this.debugShowBoundingVolume=Object(w.a)(e.debugShowBoundingVolume,!1),this._debugShowBoundingVolume=!1,this.debugWireframe=Object(w.a)(e.debugWireframe,!1),this._debugWireframe=!1,this._distanceDisplayCondition=e.distanceDisplayCondition,this._addBatchIdToGeneratedShaders=e.addBatchIdToGeneratedShaders,this._precreatedAttributes=e.precreatedAttributes,this._vertexShaderLoaded=e.vertexShaderLoaded,this._fragmentShaderLoaded=e.fragmentShaderLoaded,this._uniformMapLoaded=e.uniformMapLoaded,this._pickIdLoaded=e.pickIdLoaded,this._ignoreCommands=Object(w.a)(e.ignoreCommands,!1),this._requestType=e.requestType,this._upAxis=Object(w.a)(e.upAxis,mX.Y),this._gltfForwardAxis=mX.Z,this._forwardAxis=e.forwardAxis,this.cull=Object(w.a)(e.cull,!0),this.opaquePass=Object(w.a)(e.opaquePass,lM.OPAQUE),this._computedModelMatrix=new Be,this._clippingPlaneModelViewMatrix=Be.clone(Be.IDENTITY),this._initialRadius=void 0,this._boundingSphere=void 0,this._scaledBoundingSphere=new St,this._dictPrimitiveBoundingSpheres={},this._state=p$.NEEDS_LOAD,this._loadResources=void 0,this._mode=void 0,this._perNodeShowDirty=!1,this._cesiumAnimationsDirty=!1,this._dirty=!1,this._maxDirtyNumber=0,this._runtime={animations:void 0,rootNodes:void 0,nodes:void 0,nodesByName:void 0,skinnedNodes:void 0,meshesByName:void 0,materialsByName:void 0,materialsById:void 0},this._uniformMaps={},this._extensionsUsed=void 0,this._extensionsRequired=void 0,this._quantizedUniforms={},this._programPrimitives={},this._rendererResources={buffers:{},vertexArrays:{},programs:{},sourceShaders:{},silhouettePrograms:{},textures:{},samplers:{},renderStates:{},combineMaterial:void 0},this._cachedRendererResources=void 0,this._loadRendererResourcesFromCache=!1,this._dequantizeInShader=Object(w.a)(e.dequantizeInShader,!1),this._decodedData={},this._cachedGeometryByteLength=0,this._cachedTexturesByteLength=0,this._geometryByteLength=0,this._texturesByteLength=0,this._trianglesLength=0,this._isInstanceModel=!1,this._sourceTechniques={},this._sourcePrograms={},this._quantizedVertexShaders={},this._instanceVertexShaders={},this._nodeCommands=[],this._pickIds=[],this._rtcCenter=void 0,this._rtcCenterEye=void 0,this._rtcCenter3D=void 0,this._rtcCenter2D=void 0,this._keepPipelineExtras=e.keepPipelineExtras,this._sourceVersion=void 0,this._sourceKHRTechniquesWebGL=void 0,this._imageBasedLightingFactor=new Rt(1,1),Rt.clone(e.imageBasedLightingFactor,this._imageBasedLightingFactor),this._lightColor=z.clone(e.lightColor),this._luminanceAtZenith=void 0,this.luminanceAtZenith=Object(w.a)(e.luminanceAtZenith,.5),this._sphericalHarmonicCoefficients=e.sphericalHarmonicCoefficients,this._specularEnvironmentMaps=e.specularEnvironmentMaps,this._shouldUpdateSpecularMapAtlas=!0,this._specularEnvironmentMapAtlas=void 0,this._useDefaultSphericalHarmonics=!1,this._useDefaultSpecularMaps=!1,this._shouldRegenerateShaders=!1,this._useGradual=Object(w.a)(e.useGradual,!1);var c={startColor:new z(0,0,1),endColor:new z(1,1,1),gradualOffset:150},l=Object(w.a)(e.gradualOptions,c);this._gradualOptions=[c,l].reduce((function(e,t){return Object.keys(t).forEach((function(i){e[i]=t[i]})),e}),{}),this._shouldAnimate=Object(w.a)(e.shouldAnimate,!1),this._planView=Object(w.a)(e.planView,!1),this._diffusionRing=Object(w.a)(e.diffusionRing,void 0),this._circleData=Object(w.a)(e.circleData,[]),this.lastClippingPlanesLength=0,this.edgeShaderProgram=void 0,this.dracoModel=Object(w.a)(e.dracoModel,!1),this.calcEdge=Object(w.a)(e.calcEdge,!1),this._instanceTransformVertexBuffer={},this._circleCount=0,this._pbrBufferLoaded=e.pbrBufferLoaded}function y$(e){return e.stencilBuffer}function w$(e){return!uf.equals(e.color,uf.WHITE)||e.colorBlendMode!==sW.HIGHLIGHT}function O$(e){var t=e._clippingPlanes;return Object(u.a)(t)&&t.enabled&&0!==t.length}function x$(e,t,i){if(e._state!==p$.LOADED)throw new h.a("The model is not loaded.  Use Model.readyPromise or wait for Model.ready to be true.");if(!Object(u.a)(i))throw new h.a("name is required.");return e._runtime[t][i]}function E$(e,t){return function(i){var n=e._loadResources,r=new Uint8Array(i);--n.pendingBufferLoads,e.gltf.buffers[t].extras._pipeline.source=r}}function T$(e,t,i,n){return function(i){var r=e._loadResources;--r.pendingTextureLoads,r.texturesToCreate.enqueue({id:t,image:i,bufferView:i.bufferView,width:i.width,height:i.height,internalFormat:i.internalFormat,path:n})}}Object(O.a)(b$.prototype,{gltf:{get:function(){return Object(u.a)(this._cachedGltf)?this._cachedGltf.gltf:void 0}},releaseGltfJson:{get:function(){return this._releaseGltfJson}},cacheKey:{get:function(){return this._cacheKey}},basePath:{get:function(){return this._resource.url}},boundingSphere:{get:function(){if(this._state!==p$.LOADED)throw new h.a("The model is not loaded.  Use Model.readyPromise or wait for Model.ready to be true.");var e=this.modelMatrix;this.heightReference!==eD.NONE&&this._clampedModelMatrix&&(e=this._clampedModelMatrix);var t=Be.getScale(e,f$),i=Object(u.a)(this.maximumScale)?Math.min(this.maximumScale,this.scale):this.scale;z.multiplyByScalar(t,i,t);var n=this._scaledBoundingSphere;return n.center=z.multiplyComponents(this._boundingSphere.center,t,n.center),n.radius=z.maximumComponent(t)*this._initialRadius,Object(u.a)(this._rtcCenter)&&z.add(this._rtcCenter,n.center,n.center),n}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise.promise}},asynchronous:{get:function(){return this._asynchronous}},allowPicking:{get:function(){return this._allowPicking}},incrementallyLoadTextures:{get:function(){return this._incrementallyLoadTextures}},pendingTextureLoads:{get:function(){return Object(u.a)(this._loadResources)?this._loadResources.pendingTextureLoads:0}},dirty:{get:function(){return this._dirty}},distanceDisplayCondition:{get:function(){return this._distanceDisplayCondition},set:function(e){if(Object(u.a)(e)&&e.far<=e.near)throw new h.a("far must be greater than near");this._distanceDisplayCondition=gv.clone(e,this._distanceDisplayCondition)}},extensionsUsed:{get:function(){return Object(u.a)(this._extensionsUsed)||(this._extensionsUsed=wQ.getUsedExtensions(this.gltf)),this._extensionsUsed}},extensionsRequired:{get:function(){return Object(u.a)(this._extensionsRequired)||(this._extensionsRequired=wQ.getRequiredExtensions(this.gltf)),this._extensionsRequired}},upAxis:{get:function(){return this._upAxis}},forwardAxis:{get:function(){return Object(u.a)(this._forwardAxis)?this._forwardAxis:this._gltfForwardAxis}},trianglesLength:{get:function(){return this._trianglesLength}},isInstanceModel:{get:function(){return this._isInstanceModel}},geometryByteLength:{get:function(){return this._geometryByteLength}},texturesByteLength:{get:function(){return this._texturesByteLength}},cachedGeometryByteLength:{get:function(){return this._cachedGeometryByteLength}},cachedTexturesByteLength:{get:function(){return this._cachedTexturesByteLength}},clippingPlanes:{get:function(){return this._clippingPlanes},set:function(e){e!==this._clippingPlanes&&iJ.setOwner(e,this,"_clippingPlanes")}},pickIds:{get:function(){return this._pickIds}},imageBasedLightingFactor:{get:function(){return this._imageBasedLightingFactor},set:function(e){x.a.typeOf.object("imageBasedLightingFactor",e),x.a.typeOf.number.greaterThanOrEquals("imageBasedLightingFactor.x",e.x,0),x.a.typeOf.number.lessThanOrEquals("imageBasedLightingFactor.x",e.x,1),x.a.typeOf.number.greaterThanOrEquals("imageBasedLightingFactor.y",e.y,0),x.a.typeOf.number.lessThanOrEquals("imageBasedLightingFactor.y",e.y,1);var t=this._imageBasedLightingFactor;e===t||Rt.equals(e,t)||(this._shouldRegenerateShaders=this._shouldRegenerateShaders||this._imageBasedLightingFactor.x>0&&0===e.x||0===this._imageBasedLightingFactor.x&&e.x>0,this._shouldRegenerateShaders=this._shouldRegenerateShaders||this._imageBasedLightingFactor.y>0&&0===e.y||0===this._imageBasedLightingFactor.y&&e.y>0,Rt.clone(e,this._imageBasedLightingFactor))}},lightColor:{get:function(){return this._lightColor},set:function(e){var t=this._lightColor;e===t||z.equals(e,t)||(this._shouldRegenerateShaders=this._shouldRegenerateShaders||Object(u.a)(t)&&!Object(u.a)(e)||Object(u.a)(e)&&!Object(u.a)(t),this._lightColor=z.clone(e,t))}},luminanceAtZenith:{get:function(){return this._luminanceAtZenith},set:function(e){var t=this._luminanceAtZenith;e!==t&&(this._shouldRegenerateShaders=this._shouldRegenerateShaders||Object(u.a)(t)&&!Object(u.a)(e)||Object(u.a)(e)&&!Object(u.a)(t),this._luminanceAtZenith=e)}},sphericalHarmonicCoefficients:{get:function(){return this._sphericalHarmonicCoefficients},set:function(e){if(Object(u.a)(e)&&(!Object(ym.a)(e)||9!==e.length))throw new h.a("sphericalHarmonicCoefficients must be an array of 9 Cartesian3 values.");e!==this._sphericalHarmonicCoefficients&&(this._sphericalHarmonicCoefficients=e,this._shouldRegenerateShaders=!0)}},specularEnvironmentMaps:{get:function(){return this._specularEnvironmentMaps},set:function(e){this._shouldUpdateSpecularMapAtlas=this._shouldUpdateSpecularMapAtlas||e!==this._specularEnvironmentMaps,this._specularEnvironmentMaps=e}},useGradual:{get:function(){return this._useGradual},set:function(e){if(!Object(u.a)(e))throw new h.a("value is required");this._useGradual=e}},gradualOptions:{get:function(){return this._gradualOptions},set:function(e){if(!Object(u.a)(e))throw new h.a("value is required");this._gradualOptions=Object.assign(this._gradualOptions,e)}},planView:{get:function(){return this._planView},set:function(e){if(!Object(u.a)(e))throw new h.a("value is required");this._planView=e}},shouldAnimate:{get:function(){return this._shouldAnimate},set:function(e){if(!Object(u.a)(e))throw new h.a("value is required");this._shouldAnimate=e}},circleData:{get:function(){return this._circleData},set:function(e){if(!Object(u.a)(e))throw new h.a("value is required");this._circleData=e,this._circleCount!==this._circleData.length&&(this._shouldRegenerateShaders=!0),this._circleCount=this._circleData.length}},pbrBuffer:{get:function(){return Object(u.a)(this._pbrBufferLoaded)?this._pbrBufferLoaded():Object(u.a)(this.gltf.asset)&&Object(u.a)(this.gltf.asset.extras)&&Object(u.a)(this.gltf.asset.extras.batchInfo)&&Object(u.a)(this.gltf.asset.extras.batchInfo.pbrBuffer)?this.gltf.asset.extras.batchInfo.pbrBuffer:void 0}}}),b$.silhouetteSupported=function(e){return y$(e.context)},b$.fromGltf=function(e){if(!Object(u.a)(e)||!Object(u.a)(e.url))throw new h.a("options.url is required");var t=e.url;e=Object(nf.a)(e);var i=f.a.createIfNeeded(t),n=Object(w.a)(e.basePath,i.clone()),r=f.a.createIfNeeded(n),a=Object(w.a)(e.cacheKey,v$[Object(d.a)(i.url)+"?"+e.viewerId?e.viewerId:""]);Object(u.a)(a)||(a=Mg(),v$[Object(d.a)(i.url)]=a),Object(u.a)(e.basePath)&&!Object(u.a)(e.cacheKey)&&(a+=r.url),e.cacheKey=a,e.basePath=r;var o=new b$(e),s=g$[a];return Object(u.a)(s)?s.ready||(++s.count,s.modelsToLoad.push(o)):((s=new _$({ready:!1})).count=1,s.modelsToLoad.push(o),m$(o,s),g$[a]=s,Object(u.a)(i.headers.Accept)||(i.headers.Accept="model/gltf-binary,model/gltf+json;q=0.8,application/json;q=0.2,*/*;q=0.01"),i.fetchArrayBuffer().then((function(t){var i=new Uint8Array(t);if("glTF"===cy(i)){var n=mZ(i);s.makeReady(n)}else{var r=is(i);if(Object(u.a)(e.forceMipmap)&&e.forceMipmap){var a=JSON.parse(r);K0(a),s.makeReady(a)}else s.makeReady(JSON.parse(r))}})).otherwise(wQ.getFailedLoadFunction(o,"model",i.url))),o},b$._gltfCache=g$,b$.prototype.getNode=function(e){var t=x$(this,"nodesByName",e);return Object(u.a)(t)?t.publicNode:void 0},b$.prototype.getMesh=function(e){return x$(this,"meshesByName",e)},b$.prototype.getMaterial=function(e){return x$(this,"materialsByName",e)};var C$=/(^data:image\/ktx)|(\.ktx$)/i,S$=/(^data:image\/crn)|(\.crn$)/i;var A$=function(){this.id=void 0,this.model=void 0,this.context=void 0};function P$(e,t,i){var n=t._loadResources,r=t.gltf.bufferViews[e];Object(u.a)(r)||(r=n.createdBufferViews[e]);var a=ZN.createVertexBuffer({context:i,typedArray:n.getBuffer(r),usage:YN.STATIC_DRAW});a.vertexArrayDestroyable=!1,t._rendererResources.buffers[e]=a,t._geometryByteLength+=a.sizeInBytes}A$.prototype.set=function(e,t,i){this.id=e,this.model=t,this.context=i},A$.prototype.execute=function(){P$(this.id,this.model,this.context)};var I$=function(){this.id=void 0,this.componentType=void 0,this.model=void 0,this.context=void 0};function D$(e,t,i,n){var r=i._loadResources,a=i.gltf.bufferViews[e];Object(u.a)(a)||(a=r.createdBufferViews[e]);var o=ZN.createIndexBuffer({context:n,typedArray:r.getBuffer(a),usage:YN.STATIC_DRAW,indexDatatype:t});o.vertexArrayDestroyable=!1,i._rendererResources.buffers[e]=o,i._geometryByteLength+=o.sizeInBytes}I$.prototype.set=function(e,t,i,n){this.id=e,this.componentType=t,this.model=i,this.context=n},I$.prototype.execute=function(){D$(this.id,this.componentType,this.model,this.context)};var j$=new A$,M$=new I$;function R$(e,t){var i=e._runtime.materialsById[t.material];if(Object(u.a)(i))return i._program}function L$(e,t,i){var n,r,a,o=i._programPrimitives[t];if(!Object(u.a)(o))return e;for(r in o)if(o.hasOwnProperty(r)&&R$(i,n=o[r])===t)break;if(i._programPrimitives[t]=void 0,i.extensionsUsed.WEB3D_quantized_attributes)a=wQ.modifyShaderForQuantizedAttributes(i.gltf,n,e),i._quantizedUniforms[t]=a.uniforms;else{var s=i._decodedData[r];if(!Object(u.a)(s))return e;a=wQ.modifyShaderForDracoQuantizedAttributes(i.gltf,n,e,s.attributes)}return a.shader}function N$(e,t,i){return Object(u.a)(i)&&(e=i(e,t)),e}var F$=function(){this.programToCreate=void 0,this.model=void 0,this.context=void 0};function k$(e,t,i){var n=e.programId,r=e.techniqueId,a=t._sourcePrograms[n],o=t._rendererResources.sourceShaders,s=o[a.vertexShader],c=o[a.fragmentShader],l=t._quantizedVertexShaders,h=t._toClipCoordinatesGLSL[n];t._instanceVertexShaders;if(t.extensionsUsed.WEB3D_quantized_attributes||t._dequantizeInShader){var d=l[n];Object(u.a)(d)||(d=L$(s,n,t),l[n]=d),s=d}var f=N$(s,n,t._vertexShaderLoaded),p=N$(c,n,t._fragmentShaderLoaded);f=d$+f,Ri.isInternetExplorer()||(f=wQ.modifyVertexShaderForLogDepth(f,h),p=wQ.modifyFragmentShaderForLogDepth(p)),Object(u.a)(t._uniformMapLoaded)||(p="uniform vec4 czm_pickColor;\n"+p);var m=t._imageBasedLightingFactor.x>0||t._imageBasedLightingFactor.y>0;if(m&&(p="#define USE_IBL_LIGHTING \n\n"+p),Object(u.a)(t._lightColor)&&(p="#define USE_CUSTOM_LIGHT_COLOR \n\n"+p),("2.0"!==t._sourceVersion||t._sourceKHRTechniquesWebGL)&&(p=UN.replaceMain(p,"non_gamma_corrected_main"),p+="\nvoid main() { \n    non_gamma_corrected_main(); \n    gl_FragColor = czm_gammaCorrect(gl_FragColor); \n} \n"),o$.isSupported(i)){var _=Object(u.a)(t._sphericalHarmonicCoefficients)||t._useDefaultSphericalHarmonics,g=Object(u.a)(t._specularEnvironmentMapAtlas)&&t._specularEnvironmentMapAtlas.ready||t._useDefaultSpecularMaps;(_||g||m)&&(p="uniform mat4 gltf_clippingPlanesMatrix; \n"+p),Object(u.a)(t._sphericalHarmonicCoefficients)?p="#define DIFFUSE_IBL \n#define CUSTOM_SPHERICAL_HARMONICS \nuniform vec3 gltf_sphericalHarmonicCoefficients[9]; \n"+p:t._useDefaultSphericalHarmonics&&(p="#define DIFFUSE_IBL \n"+p),Object(u.a)(t._specularEnvironmentMapAtlas)&&t._specularEnvironmentMapAtlas.ready?p="#define SPECULAR_IBL \n#define CUSTOM_SPECULAR_IBL \nuniform sampler2D gltf_specularMap; \nuniform vec2 gltf_specularMapSize; \nuniform float gltf_maxSpecularLOD; \n"+p:t._useDefaultSpecularMaps&&(p="#define SPECULAR_IBL \n"+p)}Object(u.a)(t._luminanceAtZenith)&&(p="#define USE_SUN_LUMINANCE \nuniform float gltf_luminanceAtZenith;\n"+p),z$(n,r,p,f,t,i)}function B$(e,t,i){var n=e.programId,r=e.techniqueId,a=t._sourcePrograms[n],o=t._rendererResources.sourceShaders,s=t._quantizedVertexShaders,c=t._toClipCoordinatesGLSL[n],l=(t._instanceVertexShaders,t.clippingPlanes),h=O$(t),d=o[a.vertexShader],f=o[a.fragmentShader];(t.extensionsUsed.WEB3D_quantized_attributes||t._dequantizeInShader)&&(d=s[n]);var p=f;w$(t)&&(p=b$._modifyShaderForColor(p)),h&&(p=function(e,t,i){return e=UN.replaceMain(e,"gltf_clip_main"),e="uniform mat4 gltf_clippingPlanesMatrix; \n"+(e+=b$._getClippingFunction(t,i)+"\n"),e+="uniform sampler2D gltf_clippingPlanes; \nuniform vec4 gltf_clippingPlanesEdgeStyle; \nvoid main() \n{ \n    gltf_clip_main(); \n"+pJ("gltf_clippingPlanes","gltf_clippingPlanesMatrix","gltf_clippingPlanesEdgeStyle")+"} \n"}(p,l,i)),function(e){return e._circleData.length>0}(t)&&(p=function(e,t,i){return e=UN.replaceMain(e,"gltf_circle_main"),e+="void main() \n{ \n    gltf_circle_main();\n    vec4 circleColor = vec4(0.0);\n    for(int index = 0; index < "+t._circleData.length+"; index += 2)\n    {\n       circleColor += calculateCircleColor(circleData[index],circleData[index+1]);\n    }\n    gl_FragColor += circleColor;\n} \n"}(p,t));var m=N$(d,n,t._vertexShaderLoaded),_=N$(p,n,t._fragmentShaderLoaded);m=d$+m,Ri.isInternetExplorer()||(m=wQ.modifyVertexShaderForLogDepth(m,c),_=wQ.modifyFragmentShaderForLogDepth(_)),Object(u.a)(t._uniformMapLoaded)||(_="uniform vec4 czm_pickColor;\n"+_);var g=t._imageBasedLightingFactor.x>0||t._imageBasedLightingFactor.y>0;if(g&&(_="#define USE_IBL_LIGHTING \n\n"+_),Object(u.a)(t._lightColor)&&(_="#define USE_CUSTOM_LIGHT_COLOR \n\n"+_),("2.0"!==t._sourceVersion||t._sourceKHRTechniquesWebGL)&&(_=UN.replaceMain(_,"non_gamma_corrected_main"),_+="\nvoid main() { \n    non_gamma_corrected_main(); \n    gl_FragColor = czm_gammaCorrect(gl_FragColor); \n} \n"),o$.isSupported(i)){var v=Object(u.a)(t._sphericalHarmonicCoefficients)||t._useDefaultSphericalHarmonics,b=Object(u.a)(t._specularEnvironmentMapAtlas)&&t._specularEnvironmentMapAtlas.ready||t._useDefaultSpecularMaps;!h&&(v||b||g)&&(_="uniform mat4 gltf_clippingPlanesMatrix; \n"+_),Object(u.a)(t._sphericalHarmonicCoefficients)?_="#define DIFFUSE_IBL \n#define CUSTOM_SPHERICAL_HARMONICS \nuniform vec3 gltf_sphericalHarmonicCoefficients[9]; \n"+_:t._useDefaultSphericalHarmonics&&(_="#define DIFFUSE_IBL \n"+_),Object(u.a)(t._specularEnvironmentMapAtlas)&&t._specularEnvironmentMapAtlas.ready?_="#define SPECULAR_IBL \n#define CUSTOM_SPECULAR_IBL \nuniform sampler2D gltf_specularMap; \nuniform vec2 gltf_specularMapSize; \nuniform float gltf_maxSpecularLOD; \n"+_:t._useDefaultSpecularMaps&&(_="#define SPECULAR_IBL \n"+_)}Object(u.a)(t._luminanceAtZenith)&&(_="#define USE_SUN_LUMINANCE \nuniform float gltf_luminanceAtZenith;\n"+_),z$(n,r,_,m,t,i)}function z$(e,t,i,n,r,a){var o=r._sourceTechniques[t],s=wQ.createAttributeLocations(o,r._precreatedAttributes);n=wQ.modifyShaderForPositionAttributes(r.gltf,n),r._rendererResources.programs[e]=bR.fromCache({context:a,vertexShaderSource:n,fragmentShaderSource:i,attributeLocations:s})}F$.prototype.set=function(e,t,i){this.programToCreate=e,this.model=t,this.context=i},F$.prototype.execute=function(){k$(this.programToCreate,this.model,this.context)};var U$=new F$;function V$(e,t){return function(i){e.texturesToCreate.enqueue({id:t.id,image:i,bufferView:void 0}),--e.pendingBufferViewToImage}}var H$=function(){this.gltfTexture=void 0,this.model=void 0,this.context=void 0};function G$(e,t,i){var n=t.gltf.textures[e.id],r=t._rendererResources.samplers[n.sampler];r=Object(w.a)(r,new tj({wrapS:$D.REPEAT,wrapT:$D.REPEAT}));var a,o=e.internalFormat,s=!(Object(u.a)(o)&&gx.isCompressedFormat(o)||r.minificationFilter!==KD.NEAREST_MIPMAP_NEAREST&&r.minificationFilter!==KD.NEAREST_MIPMAP_LINEAR&&r.minificationFilter!==KD.LINEAR_MIPMAP_NEAREST&&r.minificationFilter!==KD.LINEAR_MIPMAP_LINEAR),c=s||r.wrapS===$D.REPEAT||r.wrapS===$D.MIRRORED_REPEAT||r.wrapT===$D.REPEAT||r.wrapT===$D.MIRRORED_REPEAT,l=e.image,h=e.path;if(a=rj.getTextures(h),!Object(u.a)(a))if(Object(u.a)(o))a=new hj({context:i,source:{arrayBufferView:e.bufferView},width:e.width,height:e.height,pixelFormat:o,sampler:r,path:h});else if(Object(u.a)(l)){var d=!I.isPowerOfTwo(l.width)||!I.isPowerOfTwo(l.height);if(c&&d){var f=document.createElement("canvas");f.width=I.nextPowerOfTwo(l.width),f.height=I.nextPowerOfTwo(l.height),f.getContext("2d").drawImage(l,0,0,l.width,l.height,0,0,f.width,f.height),l=f}a=new hj({context:i,source:l,pixelFormat:n.internalFormat,pixelDatatype:n.type,sampler:r,flipY:!1,path:h}),s&&a.generateMipmap()}Object(u.a)(a)&&(rj.setTextures(h,a),t._rendererResources.textures[e.id]=a,t._texturesByteLength+=a.sizeInBytes)}H$.prototype.set=function(e,t,i){this.gltfTexture=e,this.model=t,this.context=i},H$.prototype.execute=function(){G$(this.gltfTexture,this.model,this.context)};var q$=new H$;function W$(e,t){for(var i=e.length,n={},r=0;r<i;++r)for(var a=[e[r]];a.length>0;){var o=a.pop(),s=t[o];Object(u.a)(s)&&(n[o]=o);var c=s.children;if(Object(u.a)(c))for(var l=c.length,h=0;h<l;++h)a.push(c[h])}return n}function Y$(e){var t=e._loadResources;if(0===t.pendingBufferLoads&&t.createSkins){t.createSkins=!1;var i=e.gltf,n=i.accessors,r={};rZ.skin(i,(function(t,i){var a,o=n[t.inverseBindMatrices];Be.equals(t.bindShapeMatrix,Be.IDENTITY)||(a=Be.clone(t.bindShapeMatrix)),r[i]={inverseBindMatrices:TJ.getSkinInverseBindMatrices(e,o),bindShapeMatrix:a}})),function(e,t){for(var i=e.gltf,n=i.skins,r=i.nodes,a=e._runtime.nodes,o=e._loadResources.skinnedNodesIds,s=o.length,c=0;c<s;++c){var l=o[c],h=a[l],d=r[l],f=t[d.skin];h.inverseBindMatrices=f.inverseBindMatrices,h.bindShapeMatrix=f.bindShapeMatrix;var p=[],m=n[d.skin];Object(u.a)(m.skeleton)&&p.push(m.skeleton);for(var _=W$(p,r),g=n[d.skin].joints,v=g.length,b=0;b<v;++b){var y=a[_[g[b]]];h.joints.push(y)}}}(e,r)}}function X$(e,t,i,n){return function(r){Object(u.a)(n)&&(r=e.clampAnimations?n.clampTime(r):n.wrapTime(r),t[i]=n.evaluate(r,t[i]),t.dirtyNumber=e._maxDirtyNumber)}}function Z$(e,t){var i=e._loadResources;if(i.finishedBuffersCreation()&&i.finishedProgramCreation()&&i.createVertexArrays){i.createVertexArrays=!1;var n=e._rendererResources.buffers,r=e._rendererResources.vertexArrays,a=e.gltf,o=a.accessors;rZ.mesh(a,(function(i,s){rZ.meshPrimitive(i,(function(c,l){var h,d,f,p=[],m=Object(u.a)(i.extras)&&Object(u.a)(i.extras.transfInfo),_=function(e,t,i){var n,r,a=e._sourceTechniques,o={},s=e._runtime.materialsById[t.material];if(!Object(u.a)(s))return o;var c=a[s._technique];if(!Object(u.a)(c))return o;var l=c.attributes,h=e._rendererResources.programs[c.program],d=h.vertexAttributes,f=h._attributeLocations;for(n in d)if(d.hasOwnProperty(n)){var p=l[n];Object(u.a)(p)?(r=f[n],o[p.semantic]=r):i&&(o[(p=d[n]).name]=p.index)}var m=e._precreatedAttributes;if(Object(u.a)(m))for(n in m)m.hasOwnProperty(n)&&(r=f[n],o[n]=r);return o}(e,c,m),g=e._decodedData[s+".primitive."+l];rZ.meshPrimitiveAttribute(c,(function(e,t){if(h=_[t],Object(u.a)(h)){if(Object(u.a)(g)){var i=g.attributes;if(i.hasOwnProperty(t)){var r=i[t];return void p.push({index:h,vertexBuffer:n[r.bufferView],componentsPerAttribute:r.componentsPerAttribute,componentDatatype:r.componentDatatype,normalize:r.normalized,offsetInBytes:r.byteOffset,strideInBytes:r.byteStride})}}var s=o[e],c=Object(u.a)(s.normalized)&&s.normalized;p.push({index:h,vertexBuffer:n[s.bufferView],componentsPerAttribute:aZ(s.type),componentDatatype:s.componentType,normalize:c,offsetInBytes:s.byteOffset,strideInBytes:oZ(a,s)})}}));var v,b=e._precreatedAttributes;if(Object(u.a)(b))for(f in b)b.hasOwnProperty(f)&&(h=_[f],Object(u.a)(h)&&((d=b[f]).index=h,p.push(d)));if(m){var y=i.extras.transfInfo,w=y.transfbatchids,O=new Uint16Array(w),x=ZN.createVertexBuffer({context:t,typedArray:O,usage:YN.STATIC_DRAW});p.push({index:_.instanceBatchId,vertexBuffer:x,componentsPerAttribute:1,componentDatatype:dn.UNSIGNED_SHORT,normalize:!1,offsetInBytes:0,strideInBytes:0,instanceDivisor:1});var E,T=c.attributes.POSITION;if(Object(u.a)(T)){var C=wQ.getAccessorMinMax(a,T);E=z.midpoint(z.fromArray(C.min),z.fromArray(C.max),new z)}var S=y.transfs,A=ZN.createVertexBuffer({context:t,typedArray:Q$(e,S,s+".primitive."+l,E),usage:YN.STATIC_DRAW});e._instanceTransformVertexBuffer[s+".primitive."+l]=A;var P=dn.getSizeInBytes(dn.FLOAT),I={instanceModelMatrixRow0:{index:_.instanceModelMatrixRow0,vertexBuffer:A,componentsPerAttribute:4,componentDatatype:dn.FLOAT,normalize:!1,offsetInBytes:0,strideInBytes:16*P,instanceDivisor:1},instanceModelMatrixRow1:{index:_.instanceModelMatrixRow1,vertexBuffer:A,componentsPerAttribute:4,componentDatatype:dn.FLOAT,normalize:!1,offsetInBytes:4*P,strideInBytes:16*P,instanceDivisor:1},instanceModelMatrixRow2:{index:_.instanceModelMatrixRow2,vertexBuffer:A,componentsPerAttribute:4,componentDatatype:dn.FLOAT,normalize:!1,offsetInBytes:8*P,strideInBytes:16*P,instanceDivisor:1},instanceModelMatrixRow3:{index:_.instanceModelMatrixRow3,vertexBuffer:A,componentsPerAttribute:4,componentDatatype:dn.FLOAT,normalize:!1,offsetInBytes:12*P,strideInBytes:16*P,instanceDivisor:1}};p.push(I.instanceModelMatrixRow0),p.push(I.instanceModelMatrixRow1),p.push(I.instanceModelMatrixRow2),p.push(I.instanceModelMatrixRow3)}if(Object(u.a)(c.indices)){var D=o[c.indices].bufferView;Object(u.a)(g)&&(D=g.bufferView),v=n[D]}r[s+".primitive."+l]=new tF({context:t,attributes:p,indexBuffer:v})}))}))}}function Q$(e,t,i,n){for(var r=t.length,a=new Float32Array(16*r),o=new Array(r),s=0;s<r;++s){var c=t[s],l=16*s;if(a[l+0]=c[0],a[l+1]=c[1],a[l+2]=c[2],a[l+3]=c[3],a[l+4]=c[4],a[l+5]=c[5],a[l+6]=c[6],a[l+7]=c[7],a[l+8]=c[8],a[l+9]=c[9],a[l+10]=c[10],a[l+11]=c[11],a[l+12]=c[12],a[l+13]=c[13],a[l+14]=c[14],a[l+15]=c[15],n){var u=Be.unpack(c),h=new z;Be.multiplyByPoint(u,n,h),o[s]=h}}return e._dictPrimitiveBoundingSpheres[i]=St.fromPoints(o),a}function K$(e){var t=e._loadResources;t.createRenderStates&&(t.createRenderStates=!1,rZ.material(e.gltf,(function(t,i){!function(e,t,i){var n=e._rendererResources.renderStates,r=[un.FUNC_ADD,un.FUNC_ADD],a=[un.ONE,un.ONE_MINUS_SRC_ALPHA,un.ONE,un.ONE_MINUS_SRC_ALPHA];Object(u.a)(t.extensions)&&Object(u.a)(t.extensions.KHR_blend)&&(r=t.extensions.KHR_blend.blendEquation,a=t.extensions.KHR_blend.blendFactors);var o=!t.doubleSided,s="BLEND"===t.alphaMode;n[i]=RM.fromCache({cull:{enabled:o},depthTest:{enabled:!0},depthMask:!s,blending:{enabled:s,equationRgb:r[0],equationAlpha:r[1],functionSourceRgb:a[0],functionDestinationRgb:a[1],functionSourceAlpha:a[2],functionDestinationAlpha:a[3]}})}(e,t,i)})))}var J$={MODEL:function(e,t,i){return function(){return i.computedMatrix}},VIEW:function(e,t,i){return function(){return e.view}},PROJECTION:function(e,t,i){return function(){return e.projection}},MODELVIEW:function(e,t,i){var n=new Be;return function(){return Be.multiplyTransformation(e.view,i.computedMatrix,n)}},CESIUM_RTC_MODELVIEW:function(e,t,i){var n=new Be;return function(){return Be.multiplyTransformation(e.view,i.computedMatrix,n),Be.setTranslation(n,t._rtcCenterEye,n)}},MODELVIEWPROJECTION:function(e,t,i){var n=new Be;return function(){return Be.multiplyTransformation(e.view,i.computedMatrix,n),Be.multiply(e._projection,n,n)}},MODELINVERSE:function(e,t,i){var n=new Be;return function(){return Be.inverse(i.computedMatrix,n)}},VIEWINVERSE:function(e,t){return function(){return e.inverseView}},PROJECTIONINVERSE:function(e,t,i){return function(){return e.inverseProjection}},MODELVIEWINVERSE:function(e,t,i){var n=new Be,r=new Be;return function(){return Be.multiplyTransformation(e.view,i.computedMatrix,n),Be.inverse(n,r)}},MODELVIEWPROJECTIONINVERSE:function(e,t,i){var n=new Be,r=new Be;return function(){return Be.multiplyTransformation(e.view,i.computedMatrix,n),Be.multiply(e._projection,n,n),Be.inverse(n,r)}},MODELINVERSETRANSPOSE:function(e,t,i){var n=new Be,r=new be;return function(){return Be.inverse(i.computedMatrix,n),Be.getRotation(n,r),be.transpose(r,r)}},MODELVIEWINVERSETRANSPOSE:function(e,t,i){var n=new Be,r=new Be,a=new be;return function(){return Be.multiplyTransformation(e.view,i.computedMatrix,n),Be.inverse(n,r),Be.getRotation(r,a),be.transpose(a,a)}},VIEWPORT:function(e,t,i){return function(){return e.viewportCartesian4}}};function $$(e,t,i,n,r,a,o){var s,c,l={},h={};return rZ.techniqueUniform(i,(function(i,d){var f;if(Object(u.a)(n)&&Object(u.a)(n[d]))f=wQ.createUniformFunction(i.type,n[d],a,o),l[d]=f.func,h[d]=f;else if(Object(u.a)(i.node))l[d]=function(e,t,i,n){var r=t._runtime.nodes[e];return J$[i](n,t,r)}(i.node,e,i.semantic,r.uniformState);else if(Object(u.a)(i.semantic))if("JOINTMATRIX"===i.semantic)s=d;else if("MORPHWEIGHTS"===i.semantic)c=d;else if("ALPHACUTOFF"===i.semantic){var p=t.alphaMode;if(Object(u.a)(p)&&"MASK"===p){var m=Object(w.a)(t.alphaCutoff,.5);f=wQ.createUniformFunction(i.type,m,a,o),l[d]=f.func,h[d]=f}}else l[d]=wQ.getGltfSemanticUniforms()[i.semantic](r.uniformState,e);else if(Object(u.a)(i.value)){var _=wQ.createUniformFunction(i.type,i.value,a,o);l[d]=_.func,h[d]=_}})),{map:l,values:h,jointMatrixUniformName:s,morphWeightsUniformName:c}}function e0(e){return wQ.createUniformsForDracoQuantizedAttributes(e.attributes)}function t0(e,t){var i=R$(e,t),n=e._quantizedUniforms[i];return wQ.createUniformsForQuantizedAttributes(e.gltf,t,n)}function i0(e){return function(){return e}}function n0(e){return function(){return e.computedJointMatrices}}function r0(e){return function(){return e.weights}}function a0(e){return function(){return e.silhouetteColor}}function o0(e){return function(){return e.silhouetteSize}}function s0(e){return function(){return e.color}}var c0=new Be;function l0(e){return function(){var t=e.clippingPlanes;if(!Object(u.a)(t)&&!Object(u.a)(e._sphericalHarmonicCoefficients)&&!Object(u.a)(e._specularEnvironmentMaps))return Be.IDENTITY;var i=Object(u.a)(t)?t.modelMatrix:Be.IDENTITY;return Be.multiply(e._clippingPlaneModelViewMatrix,i,c0)}}function u0(e){return function(){var t=e.clippingPlanes;return Object(u.a)(t)&&t.enabled?t.texture:e._defaultTexture}}function h0(e){return function(){var t=e.clippingPlanes;if(!Object(u.a)(t))return uf.WHITE.withAlpha(0);var i=uf.clone(t.edgeColor);return i.alpha=t.edgeWidth,i}}function d0(e){return function(){return sW.getColorBlend(e.colorBlendMode,e.colorBlendAmount)}}function f0(e){return function(){return e._imageBasedLightingFactor}}function p0(e){return function(){return e._lightColor}}function m0(e){return function(){return e.luminanceAtZenith}}function _0(e){return function(){return e._sphericalHarmonicCoefficients}}function g0(e){return function(){return e._specularEnvironmentMapAtlas.texture}}function v0(e){return function(){return e._specularEnvironmentMapAtlas.texture.dimensions}}function b0(e){return function(){return e._specularEnvironmentMapAtlas.maximumMipmapLevel}}function y0(e,t){switch(e.mode){case yn.TRIANGLES:return t/3;case yn.TRIANGLE_STRIP:case yn.TRIANGLE_FAN:return Math.max(t-2,0);default:return 0}}function w0(e,t,i,n,r){var a=e._nodeCommands,o=e._pickIds,s=e.allowPicking,c=e._runtime.meshesByName,l=e._rendererResources,h=l.vertexArrays,d=l.programs,f=l.renderStates,p=e._uniformMaps,m=e.gltf,_=m.accessors,g=m.meshes,v=t.mesh,b=g[v],y=b.primitives,w=y.length,O=0;Object(u.a)(b.extras)&&(O=b.extras.transfInfo.transfbatchids.length)>0&&(e._isInstanceModel=!0);for(var x=0;x<w;++x){var E,T=v+".primitive."+x,C=y[x],S=_[C.indices],A=e._runtime.materialsById[C.material],P=A._program,I=e._decodedData[T],D=A.use_texture_pbrmat;if(O>0)E=e._dictPrimitiveBoundingSpheres[T];else{var j=C.attributes.POSITION;if(Object(u.a)(j)){var M=wQ.getAccessorMinMax(m,j);E=St.fromCornerPoints(z.fromArray(M.min),z.fromArray(M.max))}}var R,L,N=h[T];if(Object(u.a)(I))L=I.numberOfIndices,R=0;else if(Object(u.a)(S))L=S.count,R=S.byteOffset/Sl.getSizeInBytes(S.componentType);else{L=_[C.attributes.POSITION].count,R=0}var F=y0(C,L),k=O>0?F*O:F;e._trianglesLength+=k;var B=p[C.material],U=B.uniformMap;if(Object(u.a)(B.jointMatrixUniformName)){var V={};V[B.jointMatrixUniformName]=n0(i),U=Object(ff.a)(U,V)}if(Object(u.a)(B.morphWeightsUniformName)){var H={};H[B.morphWeightsUniformName]=r0(i),U=Object(ff.a)(U,H)}U=Object(ff.a)(U,{gltf_color:s0(e),gltf_colorBlend:d0(e),gltf_clippingPlanes:u0(e),gltf_clippingPlanesEdgeStyle:h0(e),gltf_clippingPlanesMatrix:l0(e),gltf_iblFactor:f0(e),gltf_lightColor:p0(e),gltf_sphericalHarmonicCoefficients:_0(e),gltf_specularMap:g0(e),gltf_specularMapSize:v0(e),gltf_maxSpecularLOD:b0(e),gltf_luminanceAtZenith:m0(e)}),Object(u.a)(e._uniformMapLoaded)&&(U=e._uniformMapLoaded(U,P,i));var G={};e.extensionsUsed.WEB3D_quantized_attributes?G=t0(e,C):e._dequantizeInShader&&Object(u.a)(I)&&(G=e0(I)),U=Object(ff.a)(U,G);var q=f[C.material],W=q.blending.enabled,Y=e._pickObject;Object(u.a)(Y)||(Y={primitive:e,id:e.id,node:i.publicNode,mesh:c[b.name]});var X,Z=rM.castShadows(e._shadows),Q=rM.receiveShadows(e._shadows);if(s&&!Object(u.a)(e._uniformMapLoaded)){X=n.createPickId(Y),o.push(X);var K={czm_pickColor:i0(X.color)};U=Object(ff.a)(U,K)}if(s&&(X=Object(u.a)(e._pickIdLoaded)&&Object(u.a)(e._uniformMapLoaded)?e._pickIdLoaded():"czm_pickColor"),e.scienceEnabled&&(U.scienceTexture=function(){return e.scienceTexture},U.blink=function(){return e.scienceBlink},U.diffuseColor=function(){return e.scienceColor},q=RM.fromCache({cull:{enabled:!0},depthMask:!0,depthTest:{enabled:!0},blending:FD.ALPHA_BLEND})),Object(u.a)(e._diffusionRing)?(U.color=function(){return e._diffusionRing.color},U.center=function(){return e._diffusionRing.center},U.enableDiffusion=function(){return e._diffusionRing.enable?1:0}):(U.color=function(){return new z(1,1,1)},U.center=function(){return new z(0,0,0)},U.enableDiffusion=function(){return 0}),U.circleDataLength=function(){return e._circleData.length},U.circleData=function(){return e._circleData},U.isInstance=function(){return O>0},D){var J=e._rendererResources.combineMaterial;U.combineMaterialTextureDimensions=function(){return J.textureDimensions},U.combineMaterialTextureStep=function(){return J.textureStep},U.combineMaterialTexture=function(){return J.texture}}var $,ee=new cM({boundingVolume:new St,cull:e.cull,modelMatrix:new Be,primitiveType:C.mode,vertexArray:N,count:L,offset:R,shaderProgram:d[P],castShadows:Z,receiveShadows:Q,uniformMap:U,renderState:q,owner:Y,pass:W?lM.TRANSLUCENT:e.opaquePass,pickId:X,instanceCount:O});r||(($=cM.shallowClone(ee)).boundingVolume=new St,$.modelMatrix=new Be);var te={show:!0,boundingSphere:E,command:ee,command2D:$,silhouetteModelCommand:void 0,silhouetteModelCommand2D:void 0,silhouetteColorCommand:void 0,silhouetteColorCommand2D:void 0,translucentCommand:void 0,translucentCommand2D:void 0,edgeCommand:[],edgePickCommand:[],sceneDepthCommand:[],programId:P,normalCommand:void 0,trianglesLength:F};i.commands.push(te),a.push(te),void 0!==I&&h$.parser(e,I,S,n,ee,te,T)}}function O0(e,t){return t.trianglesLength-e.trianglesLength}function x0(e,t){var i=t.context,n=t.scene3DOnly,r=e._quantizedVertexShaders,a=e._toClipCoordinatesGLSL={},o=e._sourceTechniques,s=e._sourcePrograms,c=e._rendererResources,l=c.sourceShaders;for(var h in e._loadRendererResourcesFromCache&&(l=c.sourceShaders=e._cachedRendererResources.sourceShaders),o)if(o.hasOwnProperty(h)){var d=o[h].program,f=s[d],p=l[f.vertexShader];if(wQ.checkSupportedGlExtensions(f.glExtensions,i),e.extensionsUsed.WEB3D_quantized_attributes||e._dequantizeInShader){var m=r[d];Object(u.a)(m)||(m=L$(p,d,e),r[d]=m),p=m}p=N$(p,d,e._vertexShaderLoaded),a[d]=wQ.toClipCoordinatesGLSL(e.gltf,p)}if(e._loadRendererResourcesFromCache){var _=e._cachedRendererResources;c.buffers=_.buffers,c.vertexArrays=_.vertexArrays,c.programs=_.programs,c.silhouettePrograms=_.silhouettePrograms,c.textures=_.textures,c.samplers=_.samplers,c.renderStates=_.renderStates,Object(u.a)(e._precreatedAttributes)&&Z$(e,i),e._cachedGeometryByteLength+=function(e){var t=0;for(var i in e)e.hasOwnProperty(i)&&(t+=e[i].sizeInBytes);return t}(_.buffers),e._cachedTexturesByteLength+=function(e){var t=0;for(var i in e)e.hasOwnProperty(i)&&(t+=e[i].sizeInBytes);return t}(_.textures)}else!function(e,t){var i=e._loadResources;if(0===i.pendingBufferLoads){var n,r=t.context,a=i.vertexBuffersToCreate,o=i.indexBuffersToCreate;if(e.asynchronous){for(;a.length>0&&(j$.set(a.peek(),e,r),t.jobScheduler.execute(j$,gJ.BUFFER));)a.dequeue();for(;o.length>0&&(n=o.peek(),M$.set(n.id,n.componentType,e,r),t.jobScheduler.execute(M$,gJ.BUFFER));)o.dequeue()}else{for(;a.length>0;)P$(a.dequeue(),e,r);for(;o.length>0;)D$((n=o.dequeue()).id,n.componentType,e,r)}}}(e,t),function(e,t){var i=e._loadResources,n=i.programsToCreate;if(0===i.pendingShaderLoads&&0===i.pendingBufferLoads){var r=t.context;if(e.asynchronous)for(;n.length>0&&(U$.set(n.peek(),e,r),t.jobScheduler.execute(U$,gJ.PROGRAM));)n.dequeue();else for(;n.length>0;)k$(n.dequeue(),e,r)}}(e,t),function(e){var t=e._loadResources;if(t.createSamplers){t.createSamplers=!1;var i=e._rendererResources.samplers;rZ.sampler(e.gltf,(function(e,t){i[t]=new tj({wrapS:e.wrapS,wrapT:e.wrapT,minificationFilter:e.minFilter,magnificationFilter:e.magFilter})}))}}(e),function(e){var t=e._loadResources;if(0===t.pendingBufferLoads)for(;t.texturesToCreateFromBufferView.length>0;){var i=t.texturesToCreateFromBufferView.dequeue(),n=e.gltf,r=n.bufferViews[i.bufferView],a=(n.textures[i.id].source,wQ.getFailedLoadFunction(e,"image","id: "+i.id+", bufferView: "+i.bufferView));if("image/ktx"===i.mimeType)Ox(t.getBuffer(r)).then(T$(e,i.id)).otherwise(a),++e._loadResources.pendingTextureLoads;else if("image/crn"===i.mimeType)ux(t.getBuffer(r)).then(T$(e,i.id)).otherwise(a),++e._loadResources.pendingTextureLoads;else{var o=V$(t,i);hx(t.getBuffer(r),i.mimeType).then(o).otherwise(a),++t.pendingBufferViewToImage}}}(e),function(e,t){var i=t.context,n=e._loadResources.texturesToCreate;if(e.asynchronous)for(;n.length>0&&(q$.set(n.peek(),e,i),t.jobScheduler.execute(q$,gJ.TEXTURE));)n.dequeue();else for(;n.length>0;)G$(n.dequeue(),e,i)}(e,t);Y$(e),function(e){var t=e._loadResources;if(t.finishedPendingBufferLoads()&&t.createRuntimeAnimations){t.createRuntimeAnimations=!1,e._runtime.animations=[];var i=e._runtime.nodes,n=e.gltf.accessors;rZ.animation(e.gltf,(function(t,r){for(var a=t.channels,o=t.samplers,s=Number.MAX_VALUE,c=-Number.MAX_VALUE,l=a.length,u=new Array(l),h=0;h<l;++h){var d=a[h],f=d.target,p=f.path,m=o[d.sampler],_=TJ.getAnimationParameterValues(e,n[m.input]),g=TJ.getAnimationParameterValues(e,n[m.output]);s=Math.min(s,_[0]),c=Math.max(c,_[_.length-1]);var v=TJ.getAnimationSpline(e,r,t,d.sampler,m,_,p,g);u[h]=X$(e,i[f.node],f.path,v)}e._runtime.animations[r]={name:t.name,startTime:s,stopTime:c,channelEvaluators:u}}))}}(e),e._loadRendererResourcesFromCache||(Z$(e,i),K$(e)),function(e,t){var i=e._loadResources;if(i.finishedProgramCreation()&&i.createUniformMaps){i.createUniformMaps=!1;var n=e.gltf,r=e._sourceTechniques,a=e._uniformMaps,o=e._rendererResources.textures,s=e._defaultTexture;rZ.material(n,(function(i,n){var c=e._runtime.materialsById[n],l=r[c._technique],u=c._values,h=$$(e,i,l,u,t,o,s),d=a[n];d.uniformMap=h.map,d.values=h.values,d.jointMatrixUniformName=h.jointMatrixUniformName,d.morphWeightsUniformName=h.morphWeightsUniformName}))}}(e,i),function(e,t,i){var n=e._loadResources;if(n.finishedEverythingButTextureCreation()&&n.createRuntimeNodes){n.createRuntimeNodes=!1;for(var r=[],a=e._runtime.nodes,o=e.gltf,s=o.nodes,c=o.skins,l=o.scenes[o.scene].nodes,h=l.length,d=[],f={},p=0;p<h;++p){d.push({parentRuntimeNode:void 0,gltfNode:s[l[p]],id:l[p]});for(var m=[];d.length>0;){var _=d.pop();f[_.id]=!0;var g=_.parentRuntimeNode,v=_.gltfNode,b=a[_.id];if(0===b.parents.length)if(Object(u.a)(v.matrix))b.matrix=Be.fromColumnMajorArray(v.matrix);else{var y=v.rotation;b.translation=z.fromArray(v.translation),b.rotation=Kn.unpack(y),b.scale=z.fromArray(v.scale)}Object(u.a)(g)?(g.children.push(b),b.parents.push(g)):r.push(b),Object(u.a)(v.mesh)&&w0(e,v,b,t,i);var w=v.children;if(Object(u.a)(w))for(var O=w.length,x=0;x<O;x++){var E=w[x];f[E]||d.push({parentRuntimeNode:b,gltfNode:s[E],id:w[x]})}var T=v.skin;if(Object(u.a)(T)&&m.push(c[T].skeleton),0===d.length)for(var C=0;C<m.length;C++){var S=m[C];f[S]||d.push({parentRuntimeNode:void 0,gltfNode:s[S],id:S})}}}e._runtime.rootNodes=r,e._runtime.nodes=a,e._nodeCommands.sort(O0)}}(e,i,n)}function E0(e,t){var i=e.publicNode,n=i.matrix;i.useMatrix&&Object(u.a)(n)?Be.clone(n,t):Object(u.a)(e.matrix)?Be.clone(e.matrix,t):(Be.fromTranslationQuaternionRotationScale(e.translation,e.rotation,e.scale,t),i.setMatrix(t))}var T0=[],C0=new Te,S0=new Be;var A0=new Be;function P0(e){var t,i,n=cM.shallowClone(e);return n.pass=lM.TRANSLUCENT,n.renderState=(t=e.renderState,(i=Object(nf.a)(t,!0)).cull.enabled=!1,i.depthTest.enabled=!0,i.depthMask=!1,i.blending=FD.ALPHA_BLEND,RM.fromCache(i)),n}function I0(e,t,i){var n=t.scene3DOnly,r=e.color.alpha;if(r>0&&r<1){var a=e._nodeCommands,o=a.length;if(!Object(u.a)(a[0].translucentCommand)||i)for(var s=0;s<o;++s){var c=a[s],l=c.command;if(c.translucentCommand=P0(l),!n){var h=c.command2D;c.translucentCommand2D=P0(h)}}}}function D0(e,t){var i=e._rendererResources.programs;for(var n in i)if(i.hasOwnProperty(n)&&i[n]===t)return n}function j0(e,t,i){var n=t.vertexShaderSource.sources[0],r=t._attributeLocations,a=e._normalAttributeName;n=UN.replaceMain(n,"gltf_silhouette_main"),n+="uniform float gltf_silhouetteSize; \nvoid main() \n{ \n    gltf_silhouette_main(); \n    vec3 n = normalize(czm_normal3D * "+a+"); \n    n.x *= czm_projection[0][0]; \n    n.y *= czm_projection[1][1]; \n    vec4 clip = gl_Position; \n    clip.xy += n.xy * clip.w * gltf_silhouetteSize / czm_viewport.z; \n    gl_Position = clip; \n}";return bR.fromCache({context:i.context,vertexShaderSource:n,fragmentShaderSource:"uniform vec4 gltf_silhouetteColor; \nvoid main() \n{ \n    gl_FragColor = gltf_silhouetteColor; \n}",attributeLocations:r})}function M0(e,t){return y$(t.context)&&e.silhouetteSize>0&&e.silhouetteColor.alpha>0&&Object(u.a)(e._normalAttributeName)}function R0(e){return e.color.alpha>0&&e.color.alpha<1}function L0(e){return 0===e.color.alpha}function N0(e,t){return Math.floor(e)!==Math.floor(t)||Math.ceil(e)!==Math.ceil(t)}var F0=0;function k0(e,t){for(var i=++F0%255,n=function(e){for(var t=e._nodeCommands,i=t.length,n=0;n<i;++n){if(t[n].command.pass===lM.TRANSLUCENT)return!0}return!1}(e)||R0(e)||e.silhouetteColor.alpha<1,r=e._rendererResources.silhouettePrograms,a=t.scene3DOnly,o=e._nodeCommands,s=o.length,c=0;c<s;++c){var l=o[c],h=l.command,d=R0(e)?l.translucentCommand:h,f=cM.shallowClone(d),p=Object(nf.a)(d.renderState);p.stencilTest={enabled:!0,frontFunction:un.ALWAYS,backFunction:un.ALWAYS,reference:i,mask:-1,frontOperation:{fail:un.KEEP,zFail:un.KEEP,zPass:un.REPLACE},backOperation:{fail:un.KEEP,zFail:un.KEEP,zPass:un.REPLACE}},L0(e)&&(p.colorMask={red:!1,green:!1,blue:!1,alpha:!1},p.depthMask=!1),p=RM.fromCache(p),f.renderState=p,l.silhouetteModelCommand=f;var m=cM.shallowClone(h);(p=Object(nf.a)(h.renderState,!0)).depthTest.enabled=!0,p.cull.enabled=!1,n&&(m.pass=lM.TRANSLUCENT,p.depthMask=!1,p.blending=FD.ALPHA_BLEND),p.stencilTest={enabled:!0,frontFunction:un.NOTEQUAL,backFunction:un.NOTEQUAL,reference:i,mask:-1,frontOperation:{fail:un.KEEP,zFail:un.KEEP,zPass:un.KEEP},backOperation:{fail:un.KEEP,zFail:un.KEEP,zPass:un.KEEP}},p=RM.fromCache(p);var _=h.shaderProgram,g=D0(e,_),v=r[g];Object(u.a)(v)||(v=j0(e,_,t),r[g]=v);var b=Object(ff.a)(h.uniformMap,{gltf_silhouetteColor:a0(e),gltf_silhouetteSize:o0(e)});if(m.renderState=p,m.shaderProgram=v,m.uniformMap=b,m.castShadows=!1,m.receiveShadows=!1,l.silhouetteColorCommand=m,!a){var y=l.command2D,w=cM.shallowClone(f);w.boundingVolume=y.boundingVolume,w.modelMatrix=y.modelMatrix,l.silhouetteModelCommand2D=w;var O=cM.shallowClone(m);w.boundingVolume=y.boundingVolume,w.modelMatrix=y.modelMatrix,l.silhouetteColorCommand2D=O}}}function B0(e,t,i){if(M0(e,t)){var n=e._nodeCommands,r=N0(e.color.alpha,e._colorPreviousAlpha)||N0(e.silhouetteColor.alpha,e._silhouetteColorPreviousAlpha)||!Object(u.a)(n[0].silhouetteModelCommand);e._colorPreviousAlpha=e.color.alpha,e._silhouetteColorPreviousAlpha=e.silhouetteColor.alpha,(r||i)&&k0(e,t)}}var z0=new St;var U0=new z,V0=new K;function H0(e,t){var i=e.scale;if(0!==e.minimumPixelSize){var n=t.context,r=Math.max(n.drawingBufferWidth,n.drawingBufferHeight),a=Object(u.a)(e._clampedModelMatrix)?e._clampedModelMatrix:e.modelMatrix;if(U0.x=a[12],U0.y=a[13],U0.z=a[14],Object(u.a)(e._rtcCenter)&&z.add(e._rtcCenter,U0,U0),e._mode!==xF.SCENE3D){var o=t.mapProjection,s=o.ellipsoid.cartesianToCartographic(U0,V0);o.project(s,U0),z.fromElements(U0.z,U0.x,U0.y,U0)}var c=e.boundingSphere.radius,l=function(e,t,i){return z0.center=e,z0.radius=t,i.camera.getPixelSize(z0,i.context.drawingBufferWidth,i.context.drawingBufferHeight)}(U0,c,t),h=1/l;Math.min(h*(2*c),r)<e.minimumPixelSize&&(i=e.minimumPixelSize*l/(2*e._initialRadius))}return Object(u.a)(e.maximumScale)?Math.min(e.maximumScale,i):i}function G0(e){Object(u.a)(e._cacheKey)&&Object(u.a)(e._cachedGltf)&&0==--e._cachedGltf.count&&delete g$[e._cacheKey],e._cachedGltf=void 0}function q0(e,t){this.buffers=void 0,this.vertexArrays=void 0,this.programs=void 0,this.sourceShaders=void 0,this.silhouettePrograms=void 0,this.textures=void 0,this.samplers=void 0,this.renderStates=void 0,this.ready=!1,this.context=e,this.cacheKey=t,this.count=0}function W0(e){for(var t in e)e.hasOwnProperty(t)&&e[t].destroy()}function Y0(e,t,i){return function(n){if(e.heightReference===eD.RELATIVE_TO_GROUND){var r=t.cartesianToCartographic(n,V0);r.height+=i.height,t.cartographicToCartesian(r,n)}var a=e._clampedModelMatrix;Be.clone(e.modelMatrix,a),a[12]=n.x,a[13]=n.y,a[14]=n.z,e._heightChanged=!0}}q0.prototype.release=function(){if(0==--this.count)return Object(u.a)(this.cacheKey)&&delete this.context.cache.modelRendererResourceCache[this.cacheKey],W0((e=this).buffers),W0(e.vertexArrays),W0(e.programs),W0(e.silhouettePrograms),W0(e.textures),rl(this);var e};var X0=new z,Z0=new K;function Q0(e,t){e.programs!==t.programs&&W0(e.programs),e.silhouettePrograms!==t.silhouettePrograms&&W0(e.silhouettePrograms)}function K0(e){if(Object(u.a)(e.samplers)?e.samplers.length>0?e.samplers[0].minFilter=9987:e.samplers.push({minFilter:9987}):e.samplers=[{minFilter:9987}],Object(u.a)(e.textures))for(var t=e.textures.length,i=0;i<t;i++){var n=e.textures[i];Object(u.a)(n.sampler)||(n.sampler=0)}}b$.prototype.update=function(e){if(e.mode!==xF.MORPHING){var t=Ri.supportsWebPSync();if(Object(u.a)(t)){var i=e.context;if(this._defaultTexture=i.defaultTexture,this._state===p$.NEEDS_LOAD&&Object(u.a)(this.gltf)){var n,r=this.cacheKey;if(Object(u.a)(r)){i.cache.modelRendererResourceCache=Object(w.a)(i.cache.modelRendererResourceCache,{});var a=i.cache.modelRendererResourceCache;if(n=a[this.cacheKey],Object(u.a)(n)){if(!n.ready)return;++n.count,this._loadRendererResourcesFromCache=!0}else(n=new q0(i,r)).count=1,a[this.cacheKey]=n;this._cachedRendererResources=n}else(n=new q0(i)).count=1,this._cachedRendererResources=n;if(this._state=p$.LOADING,this._state!==p$.FAILED){var o=this.gltf.extensions;if(Object(u.a)(o)&&Object(u.a)(o.CESIUM_RTC)){var s=z.fromArray(o.CESIUM_RTC.center);if(!z.equals(s,z.ZERO)){this._rtcCenter3D=s;var c=e.mapProjection,l=c.ellipsoid.cartesianToCartographic(this._rtcCenter3D),d=c.project(l);z.fromElements(d.z,d.x,d.y,d),this._rtcCenter2D=d,this._rtcCenterEye=new z,this._rtcCenter=this._rtcCenter3D}}uZ(this.gltf),this._loadResources=new QZ,this._loadRendererResourcesFromCache||wQ.parseBuffers(this,E$)}}var f=this._loadResources,p=this._incrementallyLoadTextures,m=!1;if(this._state===p$.LOADING){if(0===f.pendingBufferLoads){if(!f.initialized){if(e.brdfLutGenerator.update(e),wQ.checkSupportedExtensions(this.extensionsRequired,t),wQ.updateForwardAxis(this),!this._loadRendererResourcesFromCache){var _=this.gltf;_.extras.sourceVersion=wQ.getAssetVersion(_),_.extras.sourceKHRTechniquesWebGL=Object(u.a)(wQ.getUsedExtensions(_).KHR_techniques_webgl),this._sourceVersion=_.extras.sourceVersion,this._sourceKHRTechniquesWebGL=_.extras.sourceKHRTechniquesWebGL,XZ(_),cZ(_);var g={addBatchIdToGeneratedShaders:this._addBatchIdToGeneratedShaders,useScience:this.scienceEnabled,useHolo:this._useHolo,pbrBuffer:this.pbrBuffer};xQ(_,g),CQ(_,g)}this._sourceVersion=this.gltf.extras.sourceVersion,this._sourceKHRTechniquesWebGL=this.gltf.extras.sourceKHRTechniquesWebGL,this._dequantizeInShader=this._dequantizeInShader&&fJ.hasExtension(this),function(e){var t=e.gltf,i=e._loadResources;rZ.buffer(t,(function(e,t){i.buffers[t]=e.extras._pipeline.source}))}(this),function(e){var t=e.gltf;if(iZ(t,"KHR_techniques_webgl")){var i=e._sourcePrograms,n=e._sourceTechniques,r=t.extensions.KHR_techniques_webgl.programs;rZ.technique(t,(function(e,t){n[t]=Object(nf.a)(e);var a=e.program;Object(u.a)(i[a])||(i[a]=Object(nf.a)(r[a]))}))}}(this),this._loadRendererResourcesFromCache||(function(e){var t=e.gltf.bufferViews,i=e._loadResources.vertexBuffersToCreate;rZ.bufferView(e.gltf,(function(e,t){e.target===un.ARRAY_BUFFER&&i.enqueue(t)}));var n=e._loadResources.indexBuffersToCreate,r={};rZ.accessor(e.gltf,(function(e){var i=e.bufferView;Object(u.a)(i)&&(t[i].target!==un.ELEMENT_ARRAY_BUFFER||Object(u.a)(r[i])||(r[i]=!0,n.enqueue({id:i,componentType:e.componentType})))}))}(this),function(e){var t=e.gltf,i=t.buffers,n=t.bufferViews,r=e._rendererResources.sourceShaders;rZ.shader(t,(function(t,a){if(Object(u.a)(t.bufferView)){var o=t.bufferView,s=n[o],c=s.buffer,l=i[c],h=is(l.extras._pipeline.source,s.byteOffset,s.byteLength);r[a]=h}else if(Object(u.a)(t.extras._pipeline.source))r[a]=t.extras._pipeline.source;else{++e._loadResources.pendingShaderLoads;var d=e._resource.getDerivedResource({url:t.uri});d.fetchText().then(function(e,t,i){return function(n){var r=e._loadResources;r.shaders[i]={source:n,type:t,bufferView:void 0},--r.pendingShaderLoads,e._rendererResources.sourceShaders[i]=n}}(e,t.type,a)).otherwise(wQ.getFailedLoadFunction(e,"shader",d.url))}}))}(this),function(e){var t=e._sourceTechniques;for(var i in t)if(t.hasOwnProperty(i)){var n=t[i];e._loadResources.programsToCreate.enqueue({programId:n.program,techniqueId:i})}}(this),function(e,t,i){var n,r,a=e.gltf,o=a.images,s=[],c=e._lazyLoadBlockSize;if(!!(o&&o.length>c)){rZ.texture(a,(function(r,a){var c=r.source;Object(u.a)(r.extensions)&&Object(u.a)(r.extensions.EXT_texture_webp)&&i&&(c=r.extensions.EXT_texture_webp.source);var l=o[c],h=l.extras,d=l.bufferView,f=l.mimeType;if(n=l.uri,Object(u.a)(h)&&Object(u.a)(h.compressedImage3DTiles)){var p=h.compressedImage3DTiles.crunch,m=h.compressedImage3DTiles.s3tc,_=h.compressedImage3DTiles.pvrtc1,g=h.compressedImage3DTiles.etc1;t.s3tc&&Object(u.a)(p)?(f=p.mimeType,Object(u.a)(p.bufferView)?d=p.bufferView:n=p.uri):t.s3tc&&Object(u.a)(m)?(f=m.mimeType,Object(u.a)(m.bufferView)?d=m.bufferView:n=m.uri):t.pvrtc&&Object(u.a)(_)?(f=_.mimeType,Object(u.a)(_.bufferView)?d=_.bufferView:n=_.uri):t.etc1&&Object(u.a)(g)&&(f=g.mimeType,Object(u.a)(g.bufferView)?d=g.bufferView:n=g.uri)}if(Object(u.a)(d))e._loadResources.texturesToCreateFromBufferView.enqueue({id:a,image:void 0,bufferView:d,mimeType:f});else{++e._loadResources.pendingTextureLoads;var v=e._resource.getDerivedResource({url:n});s.push({resource:v,id:a,imageId:c})}}));for(var l=0;l<s.length;)r=new Promise(r?function(t,i){r.then(i=>{for(var r=[],a=i;a<i+c&&!(a>=s.length);a++){var o,l=s[a].resource;(o=C$.test(l.url)?Ox(l.url):S$.test(n)?ux(l.url):l.fetchImage()).then(T$(e,s[a].id,s[a].imageId,l.url)).otherwise(wQ.getFailedLoadFunction(e,"image",l.url)),r.push(o)}Promise.all(r).then(e=>{t(e.length+i)})})}:function(t,i){for(var r=[],a=l;a<c;a++){var o,u=s[a].resource;(o=C$.test(u.url)?Ox(u.url):S$.test(n)?ux(u.url):u.fetchImage()).then(T$(e,s[a].id,s[a].imageId,u.url)).otherwise(wQ.getFailedLoadFunction(e,"image",u.url)),r.push(o)}Promise.all(r).then(e=>{t(e.length)})}),l+=c}else rZ.texture(a,(function(r,a){var s=r.source;Object(u.a)(r.extensions)&&Object(u.a)(r.extensions.EXT_texture_webp)&&i&&(s=r.extensions.EXT_texture_webp.source);var c=o[s],l=c.extras,h=c.bufferView,d=c.mimeType;if(n=c.uri,Object(u.a)(l)&&Object(u.a)(l.compressedImage3DTiles)){var f=l.compressedImage3DTiles.crunch,p=l.compressedImage3DTiles.s3tc,m=l.compressedImage3DTiles.pvrtc1,_=l.compressedImage3DTiles.etc1;t.s3tc&&Object(u.a)(f)?(d=f.mimeType,Object(u.a)(f.bufferView)?h=f.bufferView:n=f.uri):t.s3tc&&Object(u.a)(p)?(d=p.mimeType,Object(u.a)(p.bufferView)?h=p.bufferView:n=p.uri):t.pvrtc&&Object(u.a)(m)?(d=m.mimeType,Object(u.a)(m.bufferView)?h=m.bufferView:n=m.uri):t.etc1&&Object(u.a)(_)&&(d=_.mimeType,Object(u.a)(_.bufferView)?h=_.bufferView:n=_.uri)}if(Object(u.a)(h))e._loadResources.texturesToCreateFromBufferView.enqueue({id:a,image:void 0,bufferView:h,mimeType:d});else{++e._loadResources.pendingTextureLoads;var g=e._resource.getDerivedResource({url:n});(C$.test(n)?Ox(g):S$.test(n)?ux(g):g.fetchImage()).then(T$(e,a,0,g.url)).otherwise(wQ.getFailedLoadFunction(e,"image",g.url))}}))}(this,i,t)),function(e){var t=e.gltf,i=e._sourceTechniques,n={},r={},a=e._uniformMaps;rZ.material(t,(function(t,o){a[o]={uniformMap:void 0,values:void 0,jointMatrixUniformName:void 0,morphWeightsUniformName:void 0};var s=new FJ(e,t,o);if(Object(u.a)(t.extensions)&&Object(u.a)(t.extensions.KHR_techniques_webgl)){var c=t.extensions.KHR_techniques_webgl.technique;s._technique=c,s._program=i[c].program,rZ.materialValue(t,(function(e,t){Object(u.a)(s._values)||(s._values={}),s._values[t]="zbufferPriority"===t?1e-5*Object(nf.a)(e):Object(nf.a)(e)}))}Object(u.a)(t.extras)&&Object(u.a)(t.extras.use_texture_pbrmat)&&(s.use_texture_pbrmat=t.extras.use_texture_pbrmat),n[t.name]=s,r[o]=s})),e._runtime.materialsByName=n,e._runtime.materialsById=r}(this),function(e){var t={},i=e._runtime.materialsById;rZ.mesh(e.gltf,(function(n,r){t[n.name]=new BJ(n,i,r),(Object(u.a)(e.extensionsUsed.WEB3D_quantized_attributes)||e._dequantizeInShader)&&rZ.meshPrimitive(n,(function(t,i){var n=R$(e,t),a=e._programPrimitives[n];Object(u.a)(a)||(a={},e._programPrimitives[n]=a),a[r+".primitive."+i]=t}))})),e._runtime.meshesByName=t}(this),function(e){var t={},i={},n=[],r=e._loadResources.skinnedNodesIds;rZ.node(e.gltf,(function(a,o){var s={matrix:void 0,translation:void 0,rotation:void 0,scale:void 0,computedShow:!0,transformToRoot:new Be,computedMatrix:new Be,dirtyNumber:0,commands:[],inverseBindMatrices:void 0,bindShapeMatrix:void 0,joints:[],computedJointMatrices:[],jointName:a.jointName,weights:[],children:[],parents:[],publicNode:void 0};s.publicNode=new UJ(e,a,s,o,wQ.getTransform(a)),t[o]=s,i[a.name]=s,Object(u.a)(a.skin)&&(r.push(o),n.push(s))})),e._runtime.nodes=t,e._runtime.nodesByName=i,e._runtime.skinnedNodes=n}(this),fJ.parse(this,i),f.initialized=!0}f.finishedDecoding()||fJ.decodeModel(this,i).otherwise(wQ.getFailedLoadFunction(this,"model",this.basePath)),f.finishedDecoding()&&!f.resourcesParsed&&(this._boundingSphere=wQ.computeBoundingSphere(this),this._initialRadius=this._boundingSphere.radius,fJ.cacheDataForModel(this),f.resourcesParsed=!0),f.resourcesParsed&&0===f.pendingShaderLoads&&x0(this,e)}(f.finished()||p&&f.finishedEverythingButTextureCreation())&&(this._state=p$.LOADED,m=!0)}if(Object(u.a)(f)&&this._state===p$.LOADED&&(p&&!m&&x0(this,e),f.finished())){this._keepPipelineExtras||BK(this.gltf),this._loadResources=void 0;var v=this._rendererResources,b=this._cachedRendererResources;b.buffers=v.buffers,b.vertexArrays=v.vertexArrays,b.programs=v.programs,b.sourceShaders=v.sourceShaders,b.silhouettePrograms=v.silhouettePrograms,b.textures=v.textures,b.samplers=v.samplers,b.renderStates=v.renderStates,b.ready=!0,this._normalAttributeName=wQ.getAttributeOrUniformBySemantic(this.gltf,"NORMAL"),Object(u.a)(this._precreatedAttributes)&&(b.vertexArrays={}),this.releaseGltfJson&&G0(this)}var y=o$.isSupported(i);if(this._shouldUpdateSpecularMapAtlas&&y){if(this._shouldUpdateSpecularMapAtlas=!1,this._specularEnvironmentMapAtlas=this._specularEnvironmentMapAtlas&&this._specularEnvironmentMapAtlas.destroy(),this._specularEnvironmentMapAtlas=void 0,Object(u.a)(this._specularEnvironmentMaps)){this._specularEnvironmentMapAtlas=new o$(this._specularEnvironmentMaps);var O=this;this._specularEnvironmentMapAtlas.readyPromise.then((function(){O._shouldRegenerateShaders=!0}))}this._shouldRegenerateShaders=!0}Object(u.a)(this._specularEnvironmentMapAtlas)&&this._specularEnvironmentMapAtlas.update(e);var x=!Object(u.a)(this._specularEnvironmentMapAtlas)&&Object(u.a)(e.specularEnvironmentMaps)&&!this._useDefaultSpecularMaps,E=!Object(u.a)(e.specularEnvironmentMaps)&&this._useDefaultSpecularMaps,T=!Object(u.a)(this._sphericalHarmonicCoefficients)&&Object(u.a)(e.sphericalHarmonicCoefficients)&&!this._useDefaultSphericalHarmonics,C=!Object(u.a)(e.sphericalHarmonicCoefficients)&&this._useDefaultSphericalHarmonics;this._shouldRegenerateShaders=this._shouldRegenerateShaders||x||E||T||C,this._useDefaultSpecularMaps=!Object(u.a)(this._specularEnvironmentMapAtlas)&&Object(u.a)(e.specularEnvironmentMaps),this._useDefaultSphericalHarmonics=!Object(u.a)(this._sphericalHarmonicCoefficients)&&Object(u.a)(e.sphericalHarmonicCoefficients);var S=M0(this,e),A=R0(this),P=L0(this),D=!Object(u.a)(this.distanceDisplayCondition)||function(e,t){var i,n=e.distanceDisplayCondition,r=n.near*n.near,a=n.far*n.far;if(t.mode===xF.SCENE2D){i=.5*(t.camera.frustum.right-t.camera.frustum.left),i*=i}else{var o=Be.getTranslation(e.modelMatrix,X0);if(t.mode===xF.COLUMBUS_VIEW){var s=t.mapProjection,c=s.ellipsoid.cartesianToCartographic(o,Z0);o=s.project(c,o),z.fromElements(o.z,o.x,o.y,o)}i=z.distanceSquared(o,t.camera.positionWC)}return i>=r&&i<=a}(this,e),j=this.show&&D&&0!==this.scale&&(!P||S);if(j&&this._state===p$.LOADED||m){var M=this.activeAnimations.update(e)||this._cesiumAnimationsDirty;this._cesiumAnimationsDirty=!1,this._dirty=!1;var R=this.modelMatrix,L=e.mode!==this._mode;this._mode=e.mode;var N=!Be.equals(this._modelMatrix,R)||this._scale!==this.scale||this._minimumPixelSize!==this.minimumPixelSize||0!==this.minimumPixelSize||this._maximumScale!==this.maximumScale||this._heightReference!==this.heightReference||this._heightChanged||L;if(N||m){Be.clone(R,this._modelMatrix),function(e){Object(u.a)(e._removeUpdateHeightCallback)&&(e._removeUpdateHeightCallback(),e._removeUpdateHeightCallback=void 0);var t=e._scene;if(Object(u.a)(t)&&Object(u.a)(t.globe)&&e.heightReference!==eD.NONE){var i=t.globe,n=i.ellipsoid,r=e.modelMatrix;U0.x=r[12],U0.y=r[13],U0.z=r[14];var a=n.cartesianToCartographic(U0);Object(u.a)(e._clampedModelMatrix)||(e._clampedModelMatrix=Be.clone(r,new Be));var o=i._surface;e._removeUpdateHeightCallback=o.updateHeight(a,Y0(e,n,a));var s=i.getHeight(a);if(Object(u.a)(s)){var c=Y0(e,n,a);K.clone(a,V0),V0.height=s,n.cartographicToCartesian(V0,U0),c(U0)}}else{if(e.heightReference!==eD.NONE)throw new h.a("Height reference is not supported without a scene and globe.");e._clampedModelMatrix=void 0}}(this),Object(u.a)(this._clampedModelMatrix)&&(R=this._clampedModelMatrix),this._scale=this.scale,this._minimumPixelSize=this.minimumPixelSize,this._maximumScale=this.maximumScale,this._heightReference=this.heightReference,this._heightChanged=!1;var F=H0(this,e),k=this._computedModelMatrix;Be.multiplyByUniformScale(R,F,k),this._upAxis===mX.Y?Be.multiplyTransformation(k,mX.Y_UP_TO_Z_UP,k):this._upAxis===mX.X&&Be.multiplyTransformation(k,mX.X_UP_TO_Z_UP,k),this.forwardAxis===mX.Z&&Be.multiplyTransformation(k,mX.Z_UP_TO_X_UP,k)}(M||N||m)&&(function(e,t,i,n){var r=e._maxDirtyNumber,a=e._runtime.rootNodes,o=a.length,s=T0,c=e._computedModelMatrix;if(e._mode!==xF.SCENE3D&&!e._ignoreCommands){var l=Be.getColumn(c,3,C0);if(Te.equals(l,Te.UNIT_W)){var h=e.boundingSphere.center,d=xa.wgs84To2DModelMatrix(n,h,S0);c=Be.multiply(d,c,S0),Object(u.a)(e._rtcCenter)&&(Be.setTranslation(c,Te.UNIT_W,c),e._rtcCenter=e._rtcCenter2D)}else c=xa.basisTo2D(n,c,S0),e._rtcCenter=e._rtcCenter3D}for(var f=0;f<o;++f){var p=a[f];for(E0(p,p.transformToRoot),s.push(p);s.length>0;){var m=(p=s.pop()).transformToRoot,_=p.commands;if(p.dirtyNumber===r||t||i){var g=Be.multiplyTransformation(c,m,p.computedMatrix),v=_.length;if(v>0)for(var b=0;b<v;++b){var y=_[b],w=y.command;Be.clone(g,w.modelMatrix),St.transform(y.boundingSphere,w.modelMatrix,w.boundingVolume),Object(u.a)(e._rtcCenter)&&z.add(e._rtcCenter,w.boundingVolume.center,w.boundingVolume.center),w=y.command2D,Object(u.a)(w)&&e._mode===xF.SCENE2D&&(Be.clone(g,w.modelMatrix),w.modelMatrix[13]-=2*I.sign(w.modelMatrix[13])*I.PI*n.ellipsoid.maximumRadius,St.transform(y.boundingSphere,w.modelMatrix,w.boundingVolume))}}var O=p.children;if(Object(u.a)(O))for(var x=O.length,E=0;E<x;++E){var T=O[E];T.dirtyNumber=Math.max(T.dirtyNumber,p.dirtyNumber),(T.dirtyNumber===r||i)&&(E0(T,T.transformToRoot),Be.multiplyTransformation(m,T.transformToRoot,T.transformToRoot)),s.push(T)}}}++e._maxDirtyNumber}(this,N,m,e.mapProjection),this._dirty=!0,(M||m)&&function(e){for(var t=e._runtime.skinnedNodes,i=t.length,n=0;n<i;++n){var r=t[n];A0=Be.inverseTransformation(r.transformToRoot,A0);for(var a=r.computedJointMatrices,o=r.joints,s=r.bindShapeMatrix,c=r.inverseBindMatrices,l=c.length,h=0;h<l;++h)Object(u.a)(a[h])||(a[h]=new Be),a[h]=Be.multiplyTransformation(A0,o[h].transformToRoot,a[h]),a[h]=Be.multiplyTransformation(a[h],c[h],a[h]),Object(u.a)(s)&&(a[h]=Be.multiplyTransformation(a[h],s,a[h]))}}(this)),this._perNodeShowDirty&&(this._perNodeShowDirty=!1,function(e){for(var t=e._runtime.rootNodes,i=t.length,n=T0,r=0;r<i;++r){var a=t[r];for(a.computedShow=a.publicNode.show,n.push(a);n.length>0;){for(var o=(a=n.pop()).computedShow,s=a.commands,c=s.length,l=0;l<c;++l)s[l].show=o;var h=a.children;if(Object(u.a)(h))for(var d=h.length,f=0;f<d;++f){var p=h[f];p.computedShow=o&&p.publicNode.show,n.push(p)}}}}(this)),function(e,t){var i=e.id;if(e._id!==i){e._id=i;for(var n=e._pickIds,r=n.length,a=0;a<r;++a)n[a].object.id=i}}(this),function(e){if(e._debugWireframe!==e.debugWireframe){e._debugWireframe=e.debugWireframe;for(var t=e.debugWireframe?yn.LINES:yn.TRIANGLES,i=e._nodeCommands,n=i.length,r=0;r<n;++r)i[r].command.primitiveType=t}}(this),function(e){if(e.debugShowBoundingVolume!==e._debugShowBoundingVolume){e._debugShowBoundingVolume=e.debugShowBoundingVolume;for(var t=e.debugShowBoundingVolume,i=e._nodeCommands,n=i.length,r=0;r<n;++r)i[r].command.debugShowBoundingVolume=t}}(this),function(e){if(e.shadows!==e._shadows){e._shadows=e.shadows;for(var t=rM.castShadows(e.shadows),i=rM.receiveShadows(e.shadows),n=e._nodeCommands,r=n.length,a=0;a<r;a++){var o=n[a];o.command.castShadows=t,o.command.receiveShadows=i}}}(this),function(e,t){var i=e._clippingPlanes;Object(u.a)(i)&&i.owner===e&&i.enabled&&i.update(t)}(this,e);var B=this._clippingPlanes,U=0,V=Object(u.a)(B)&&B.enabled&&B.length>0,H=Object(u.a)(this._sphericalHarmonicCoefficients)||this._useDefaultSphericalHarmonics,G=Object(u.a)(this._specularEnvironmentMapAtlas)&&this._specularEnvironmentMapAtlas.ready||this._useDefaultSpecularMaps;if(V||H||G){var q=Object(w.a)(this.clippingPlanesOriginMatrix,R);Be.multiply(i.uniformState.view3D,q,this._clippingPlaneModelViewMatrix)}V&&(U=B.clippingPlanesState);var W=this._shouldRegenerateShaders;W=W||this._clippingPlanesState!==U,this._clippingPlanesState=U;var Y=w$(this);Y!==this._colorShadingEnabled&&(this._colorShadingEnabled=Y,W=!0),W?function(e,t){var i,n=e._rendererResources,r=e._cachedRendererResources;if(Q0(n,r),O$(e)||w$(e)||e._shouldRegenerateShaders){e._shouldRegenerateShaders=!1,n.programs={},n.silhouettePrograms={};var a,o={},s=e._sourceTechniques;for(var c in s)s.hasOwnProperty(c)&&(a=s[c],i=a.program,o[i]||(o[i]=!0,B$({programId:i,techniqueId:c},e,t.context)))}else n.programs=r.programs,n.silhouettePrograms=r.silhouettePrograms;for(var l=n.programs,h=e._nodeCommands,d=h.length,f=0;f<d;++f){var p=h[f];i=p.programId;var m=l[i];p.command.shaderProgram=m,Object(u.a)(p.command2D)&&(p.command2D.shaderProgram=m)}I0(e,t,!0),B0(e,t,!0)}(this,e):(I0(this,e,!1),B0(this,e,!1)),function(e){Object(u.a)(e._runtime.materialsById[0]._uniformMap.values.useGradual)&&(e._runtime.materialsById[0]._uniformMap.values.useGradual.value=e._useGradual);Object(u.a)(e._runtime.materialsById[0]._uniformMap.values.startColor)&&(e._runtime.materialsById[0]._uniformMap.values.startColor.value=e._gradualOptions.startColor);Object(u.a)(e._runtime.materialsById[0]._uniformMap.values.endColor)&&(e._runtime.materialsById[0]._uniformMap.values.endColor.value=e._gradualOptions.endColor);Object(u.a)(e._runtime.materialsById[0]._uniformMap.values.gradualOffset)&&(e._runtime.materialsById[0]._uniformMap.values.gradualOffset.value=e._gradualOptions.gradualOffset)}(this),function(e){Object(u.a)(e._runtime.materialsById[0]._uniformMap.values.planView)&&(e._runtime.materialsById[0]._uniformMap.values.planView.value=e._planView)}(this),function(e){Object(u.a)(e._runtime.materialsById[0]._uniformMap.values.shouldAnimate)&&(e._runtime.materialsById[0]._uniformMap.values.shouldAnimate.value=e._shouldAnimate)}(this),function(e){Object(u.a)(e._runtime.materialsById[0]._uniformMap.values.circleData)&&(e._runtime.materialsById[0]._uniformMap.values.circleDataLength.value=e._circleData.length,e._runtime.materialsById[0]._uniformMap.values.circleData.value=e._circleData)}(this)}if(m){var X=this;e.afterRender.push((function(){X._ready=!0,X._readyPromise.resolve(X)}))}else if(j&&!this._ignoreCommands){var Z,Q,J,$=e.commandList,ee=e.passes,te=this._nodeCommands,ie=te.length,ne=e.mapProjection.ellipsoid.maximumRadius*I.PI;if(ee.render||ee.pick&&this.allowPicking){for(Z=0;Z<ie;++Z)if((Q=te[Z]).show){var re=A?Q.translucentCommand:Q.command;if(re=S?Q.silhouetteModelCommand:re,$.push(re),J=Q.command.boundingVolume,e.mode===xF.SCENE2D&&(J.center.y+J.radius>ne||J.center.y-J.radius<ne)){var ae=A?Q.translucentCommand2D:Q.command2D;ae=S?Q.silhouetteModelCommand2D:ae,$.push(ae)}h$.draw(this,Q,e,i,re)}if(S&&!ee.pick)for(Z=0;Z<ie;++Z)(Q=te[Z]).show&&($.push(Q.silhouetteColorCommand),J=Q.command.boundingVolume,e.mode===xF.SCENE2D&&(J.center.y+J.radius>ne||J.center.y-J.radius<ne)&&$.push(Q.silhouetteColorCommand2D))}}}}},b$.prototype.isDestroyed=function(){return!1},b$.prototype.destroy=function(){Object(u.a)(this._precreatedAttributes)&&W0(this._rendererResources.vertexArrays),Object(u.a)(this._rendererResources.combineMaterial)&&this._rendererResources.combineMaterial.destroy(),Object(u.a)(this._removeUpdateHeightCallback)&&(this._removeUpdateHeightCallback(),this._removeUpdateHeightCallback=void 0),Object(u.a)(this._terrainProviderChangedCallback)&&(this._terrainProviderChangedCallback(),this._terrainProviderChangedCallback=void 0),Object(u.a)(this._cachedRendererResources)&&Q0(this._rendererResources,this._cachedRendererResources),this._rendererResources=void 0,this._cachedRendererResources=this._cachedRendererResources&&this._cachedRendererResources.release(),fJ.destroyCachedDataForModel(this);for(var e=this._pickIds,t=e.length,i=0;i<t;++i)e[i].destroy();G0(this),this._quantizedVertexShaders=void 0,this._instanceVertexShaders=void 0,this._dictPrimitiveBoundingSpheres=void 0,this._instanceTransformVertexBuffer=void 0;var n=this._clippingPlanes;return Object(u.a)(n)&&!n.isDestroyed()&&n.owner===this&&n.destroy(),this._clippingPlanes=void 0,this._specularEnvironmentMapAtlas=this._specularEnvironmentMapAtlas&&this._specularEnvironmentMapAtlas.destroy(),rl(this)},b$._getClippingFunction=_J,b$._modifyShaderForColor=function(e){return e=UN.replaceMain(e,"gltf_blend_main"),e+="uniform vec4 gltf_color; \nuniform float gltf_colorBlend; \nvoid main() \n{ \n    gltf_blend_main(); \n    gl_FragColor.rgb = mix(gl_FragColor.rgb, gltf_color.rgb, gltf_colorBlend); \n    float highlight = ceil(gltf_colorBlend); \n    gl_FragColor.rgb *= mix(gltf_color.rgb, vec3(1.0), highlight); \n    gl_FragColor.a *= gltf_color.a; \n} \n"};var J0=b$;function $0(e,t,i,n,r){this._tileset=e,this._tile=t,this._resource=i,this._model=void 0,this._batchTable=void 0,this._features=void 0,this._batchIdAttributeName=void 0,this._diffuseAttributeOrUniformName={},this._rtcCenterTransform=void 0,this._contentModelMatrix=void 0,this.featurePropertiesDirty=!1,function(e,t,i){var n=e._tileset,r=e._tile,a=e._resource,o=Object(w.a)(i,0);i=o;var s=new Uint8Array(t),c=new DataView(t);i+=e1;var l=c.getUint32(i,!0);if(1!==l)throw new Ce.a("Only Batched 3D Model version 1 is supported.  Version "+l+" is not.");i+=e1;var h=c.getUint32(i,!0);i+=e1;var d=c.getUint32(i,!0);i+=e1;var f=c.getUint32(i,!0);i+=e1;var p=c.getUint32(i,!0);i+=e1;var m,_,g=c.getUint32(i,!0);i+=e1,p>=570425344?(i-=2*e1,m=d,p=f,g=0,d=0,f=0,$0._deprecationWarning("b3dm-legacy-header","This b3dm header is using the legacy format [batchLength] [batchTableByteLength]. The new format is [featureTableJsonByteLength] [featureTableBinaryByteLength] [batchTableJsonByteLength] [batchTableBinaryByteLength] from https://github.com/AnalyticalGraphicsInc/3d-tiles/tree/master/specification/TileFormats/Batched3DModel.")):g>=570425344&&(i-=e1,m=p,p=d,g=f,d=0,f=0,$0._deprecationWarning("b3dm-legacy-header","This b3dm header is using the legacy format [batchTableJsonByteLength] [batchTableBinaryByteLength] [batchLength]. The new format is [featureTableJsonByteLength] [featureTableBinaryByteLength] [batchTableJsonByteLength] [batchTableBinaryByteLength] from https://github.com/AnalyticalGraphicsInc/3d-tiles/tree/master/specification/TileFormats/Batched3DModel."));if(0===d)_={BATCH_LENGTH:Object(w.a)(m,0)};else{var v=is(s,i,d);_=JSON.parse(v),i+=d}var b=new Uint8Array(t,i,f);i+=f;var y,O,x,E=new eZ(_,b);if(m=E.getGlobalProperty("BATCH_LENGTH"),E.featuresLength=m,p>0){var T=is(s,i,p);y=JSON.parse(T),i+=p,g>0&&(O=new Uint8Array(t,i,g),O=new Uint8Array(O),i+=g)}Object(u.a)(n.classificationType)&&(x=function(e){return function(t,i){e._model.updateCommands(t,i)}}(e));var C=new ZX(e,m,y,O,x);e._batchTable=C;var S,A=o+h-i;if(0===A)throw new Ce.a("glTF byte length must be greater than 0.");i%4==0?S=new Uint8Array(t,i,A):($0._deprecationWarning("b3dm-glb-unaligned","The embedded glb is not aligned to a 4-byte boundary."),S=new Uint8Array(s.subarray(i,i+A)));var P={content:e,primitive:n};e._rtcCenterTransform=Be.IDENTITY;var I=E.getGlobalProperty("RTC_CENTER",dn.FLOAT,3);Object(u.a)(I)&&(e._rtcCenterTransform=Be.fromTranslation(z.fromArray(I)));e._contentModelMatrix=Be.multiply(r.computedTransform,e._rtcCenterTransform,new Be),Object(u.a)(n.classificationType)?e._model=new FK({gltf:S,cull:!1,basePath:a,requestType:Hl.a.TILES3D,modelMatrix:e._contentModelMatrix,upAxis:n._gltfUpAxis,forwardAxis:mX.X,debugWireframe:n.debugWireframe,vertexShaderLoaded:t1(e),classificationShaderLoaded:a1(e),uniformMapLoaded:C.getUniformMapCallback(),pickIdLoaded:r1(e),classificationType:n._classificationType,batchTable:C}):e._model=new J0({gltf:S,cull:!1,releaseGltfJson:!0,opaquePass:lM.CESIUM_3D_TILE,basePath:a,requestType:Hl.a.TILES3D,modelMatrix:e._contentModelMatrix,upAxis:n._gltfUpAxis,forwardAxis:mX.X,shadows:n.shadows,debugWireframe:n.debugWireframe,incrementallyLoadTextures:!1,vertexShaderLoaded:t1(e),fragmentShaderLoaded:i1(e),uniformMapLoaded:C.getUniformMapCallback(),pickIdLoaded:r1(e),addBatchIdToGeneratedShaders:m>0,pickObject:P,imageBasedLightingFactor:n.imageBasedLightingFactor,lightColor:n.lightColor,luminanceAtZenith:n.luminanceAtZenith,sphericalHarmonicCoefficients:n.sphericalHarmonicCoefficients,specularEnvironmentMaps:n.specularEnvironmentMaps,useGradual:n._useGradual,gradualOptions:n._gradualOptions,shouldAnimate:n._shouldAnimate,planView:n._planView,dracoModel:n._dracoModel,calcEdge:n._calcEdge,circleData:n.dynamicCircleCollection.circleData,pbrBufferLoaded:n1(e)})}(this,n,r)}$0._deprecationWarning=mv.a,Object(O.a)($0.prototype,{featuresLength:{get:function(){return this._batchTable.featuresLength}},pointsLength:{get:function(){return 0}},trianglesLength:{get:function(){return this._model.trianglesLength}},geometryByteLength:{get:function(){return this._model.geometryByteLength}},texturesByteLength:{get:function(){return this._model.texturesByteLength}},batchTableByteLength:{get:function(){return this._batchTable.memorySizeInBytes}},innerContents:{get:function(){}},readyPromise:{get:function(){return this._model.readyPromise}},tileset:{get:function(){return this._tileset}},tile:{get:function(){return this._tile}},url:{get:function(){return this._resource.getUrlComponent(!0)}},batchTable:{get:function(){return this._batchTable}}});var e1=Uint32Array.BYTES_PER_ELEMENT;function t1(e){return function(t,i){var n=e._batchTable,r=!Object(u.a)(e._tileset.classificationType),a=e._model.gltf;Object(u.a)(a)&&(e._batchIdAttributeName=function(e){var t=wQ.getAttributeOrUniformBySemantic(e,"_BATCHID");return Object(u.a)(t)||(t=wQ.getAttributeOrUniformBySemantic(e,"BATCHID"),Object(u.a)(t)&&$0._deprecationWarning("b3dm-legacy-batchid","The glTF in this b3dm uses the semantic `BATCHID`. Application-specific semantics should be prefixed with an underscore: `_BATCHID`.")),t}(a),e._diffuseAttributeOrUniformName[i]=wQ.getDiffuseAttributeOrUniform(a,i));var o=n.getVertexShaderCallback(r,e._batchIdAttributeName,e._diffuseAttributeOrUniformName[i]);return Object(u.a)(o)?o(t):t}}function i1(e){return function(t,i){var n=e._batchTable,r=!Object(u.a)(e._tileset.classificationType),a=e._model.gltf;Object(u.a)(a)&&(e._diffuseAttributeOrUniformName[i]=wQ.getDiffuseAttributeOrUniform(a,i));var o=n.getFragmentShaderCallback(r,e._diffuseAttributeOrUniformName[i]);return Object(u.a)(o)?o(t):t}}function n1(e){return function(){var t=e._batchTable._extensions["3DTILES_batch_table_hierarchy"];return Object(u.a)(t)?t.pbrBuffer:void 0}}function r1(e){return function(){return e._batchTable.getPickId()}}function a1(e){return function(t){var i=e._batchTable.getClassificationFragmentShaderCallback();return Object(u.a)(i)?i(t):t}}$0.prototype.hasProperty=function(e,t){return this._batchTable.hasProperty(e,t)},$0.prototype.getFeature=function(e){var t=this.featuresLength;if(!Object(u.a)(e)||e<0||e>=t)throw new h.a("batchId is required and between zero and featuresLength - 1 ("+(t-1)+").");return function(e){var t=e.featuresLength;if(!Object(u.a)(e._features)&&t>0){for(var i=new Array(t),n=0;n<t;++n)i[n]=new KX(e,n);e._features=i}}(this),this._features[e]},$0.prototype.applyDebugSettings=function(e,t){t=e?t:uf.WHITE,0===this.featuresLength?this._model.color=t:this._batchTable.setAllColor(t)};var o1=new uf;$0.prototype.applyStyle=function(e){if(0===this.featuresLength){var t=Object(u.a)(e)&&Object(u.a)(e.color),i=Object(u.a)(e)&&Object(u.a)(e.show);this._model.color=t?e.color.evaluateColor(void 0,o1):uf.WHITE,this._model.show=!i||e.show.evaluate(void 0)}else this._batchTable.applyStyle(e)},$0.prototype.update=function(e,t){var i=t.commandList.length;this._batchTable.update(e,t),this._contentModelMatrix=Be.multiply(this._tile.computedTransform,this._rtcCenterTransform,this._contentModelMatrix),this._model.modelMatrix=this._contentModelMatrix,this._model.shadows=this._tileset.shadows,this._model.imageBasedLightingFactor=this._tileset.imageBasedLightingFactor,this._model.lightColor=this._tileset.lightColor,this._model.luminanceAtZenith=this._tileset.luminanceAtZenith,this._model.sphericalHarmonicCoefficients=this._tileset.sphericalHarmonicCoefficients,this._model.specularEnvironmentMaps=this._tileset.specularEnvironmentMaps,this._model.debugWireframe=this._tileset.debugWireframe;var n=this._tileset.clippingPlanes;this._model.clippingPlanesOriginMatrix=this._tileset.clippingPlanesOriginMatrix,Object(u.a)(n)&&this._tile.clippingPlanesDirty&&(this._model._clippingPlanes=n.enabled&&this._tile._isClipped?n:void 0),Object(u.a)(n)&&Object(u.a)(this._model._clippingPlanes)&&this._model._clippingPlanes!==n&&(this._model._clippingPlanes=n);var r=e._useGradual;Object(u.a)(r)&&(this._model.useGradual=r);var a=e._shouldAnimate;Object(u.a)(a)&&(this._model.shouldAnimate=a);var o=e._planView;Object(u.a)(o)&&(this._model.planView=o);var s=e.dynamicCircleCollection.circleData;Object(u.a)(s)&&(this._model.circleData=s),this._model.update(t),i<t.commandList.length&&(t.passes.render||t.passes.pick)&&!Object(u.a)(e.classificationType)&&this._batchTable.addDerivedCommands(t,i)},$0.prototype.isDestroyed=function(){return!1},$0.prototype.destroy=function(){return this._model=this._model&&this._model.destroy(),this._batchTable=this._batchTable&&this._batchTable.destroy(),rl(this)};var s1=$0;function c1(e,t,i,n,r,a){this._tileset=e,this._tile=t,this._resource=i,this._contents=[],this._readyPromise=Oi.a.defer(),function(e,t,i,n){i=Object(w.a)(i,0);var r=new Uint8Array(t),a=new DataView(t);i+=l1;var o=a.getUint32(i,!0);if(1!==o)throw new Ce.a("Only Composite Tile version 1 is supported. Version "+o+" is not.");i+=l1,i+=l1;var s=a.getUint32(i,!0);i+=l1;for(var c=[],l=0;l<s;++l){var h=cy(r,i),d=a.getUint32(i+2*l1,!0),f=n[h];if(!Object(u.a)(f))throw new Ce.a("Unknown tile content type, "+h+", inside Composite tile");var p=f(e._tileset,e._tile,e._resource,t,i);e._contents.push(p),c.push(p.readyPromise),i+=d}Oi.a.all(c).then((function(){e._readyPromise.resolve(e)})).otherwise((function(t){e._readyPromise.reject(t)}))}(this,n,r,a)}Object(O.a)(c1.prototype,{featurePropertiesDirty:{get:function(){for(var e=this._contents,t=e.length,i=0;i<t;++i)if(e[i].featurePropertiesDirty)return!0;return!1},set:function(e){for(var t=this._contents,i=t.length,n=0;n<i;++n)t[n].featurePropertiesDirty=e}},featuresLength:{get:function(){return 0}},pointsLength:{get:function(){return 0}},trianglesLength:{get:function(){return 0}},geometryByteLength:{get:function(){return 0}},texturesByteLength:{get:function(){return 0}},batchTableByteLength:{get:function(){return 0}},innerContents:{get:function(){return this._contents}},readyPromise:{get:function(){return this._readyPromise.promise}},tileset:{get:function(){return this._tileset}},tile:{get:function(){return this._tile}},url:{get:function(){return this._resource.getUrlComponent(!0)}},batchTable:{get:function(){}}});var l1=Uint32Array.BYTES_PER_ELEMENT;c1.prototype.hasProperty=function(e,t){return!1},c1.prototype.getFeature=function(e){},c1.prototype.applyDebugSettings=function(e,t){for(var i=this._contents,n=i.length,r=0;r<n;++r)i[r].applyDebugSettings(e,t)},c1.prototype.applyStyle=function(e){for(var t=this._contents,i=t.length,n=0;n<i;++n)t[n].applyStyle(e)},c1.prototype.update=function(e,t){for(var i=this._contents,n=i.length,r=0;r<n;++r)i[r].update(e,t)},c1.prototype.isDestroyed=function(){return!1},c1.prototype.destroy=function(){for(var e=this._contents,t=e.length,i=0;i<t;++i)e[i].destroy();return rl(this)};var u1=c1;function h1(e){this._boxes=e.boxes,this._boxBatchIds=e.boxBatchIds,this._cylinders=e.cylinders,this._cylinderBatchIds=e.cylinderBatchIds,this._ellipsoids=e.ellipsoids,this._ellipsoidBatchIds=e.ellipsoidBatchIds,this._spheres=e.spheres,this._sphereBatchIds=e.sphereBatchIds,this._modelMatrix=e.modelMatrix,this._batchTable=e.batchTable,this._boundingVolume=e.boundingVolume,this._center=e.center,Object(u.a)(this._center)||(Object(u.a)(this._boundingVolume)?this._center=z.clone(this._boundingVolume.center):this._center=z.clone(z.ZERO)),this._boundingVolumes=void 0,this._batchedIndices=void 0,this._indices=void 0,this._indexOffsets=void 0,this._indexCounts=void 0,this._positions=void 0,this._vertexBatchIds=void 0,this._batchIds=void 0,this._batchTableColors=void 0,this._packedBuffer=void 0,this._ready=!1,this._readyPromise=Oi.a.defer(),this._verticesPromise=void 0,this._primitive=void 0,this.debugWireframe=!1,this.forceRebatch=!1,this.classificationType=iM.BOTH}Object(O.a)(h1.prototype,{trianglesLength:{get:function(){return Object(u.a)(this._primitive)?this._primitive.trianglesLength:0}},geometryByteLength:{get:function(){return Object(u.a)(this._primitive)?this._primitive.geometryByteLength:0}},readyPromise:{get:function(){return this._readyPromise.promise}}}),h1.packedBoxLength=Be.packedLength+z.packedLength,h1.packedCylinderLength=Be.packedLength+2,h1.packedEllipsoidLength=Be.packedLength+z.packedLength,h1.packedSphereLength=z.packedLength+1;var d1=new pl("createVectorTileGeometries"),f1=new uf;function p1(e){if(!Object(u.a)(e._primitive)){if(!Object(u.a)(e._verticesPromise)){var t=e._boxes,i=e._boxBatchIds,n=e._cylinders,r=e._cylinderBatchIds,a=e._ellipsoids,o=e._ellipsoidBatchIds,s=e._spheres,c=e._sphereBatchIds,l=e._batchTableColors,h=e._packedBuffer;if(!Object(u.a)(l)){var d=0;Object(u.a)(e._boxes)&&(t=e._boxes=Li(t),d+=(i=e._boxBatchIds=Li(i)).length),Object(u.a)(e._cylinders)&&(n=e._cylinders=Li(n),d+=(r=e._cylinderBatchIds=Li(r)).length),Object(u.a)(e._ellipsoids)&&(a=e._ellipsoids=Li(a),d+=(o=e._ellipsoidBatchIds=Li(o)).length),Object(u.a)(e._spheres)&&(s=e._sphere=Li(s),d+=(c=e._sphereBatchIds=Li(c)).length),l=e._batchTableColors=new Uint32Array(d);for(var f=e._batchTable,p=0;p<d;++p){var m=f.getColor(p,f1);l[p]=m.toRgba()}h=e._packedBuffer=function(e){var t=new Float64Array(Be.packedLength+z.packedLength),i=0;return z.pack(e._center,t,i),i+=z.packedLength,Be.pack(e._modelMatrix,t,i),t}(e)}var _=[];Object(u.a)(t)&&_.push(t.buffer,i.buffer),Object(u.a)(n)&&_.push(n.buffer,r.buffer),Object(u.a)(a)&&_.push(a.buffer,o.buffer),Object(u.a)(s)&&_.push(s.buffer,c.buffer),_.push(l.buffer,h.buffer);var g={boxes:Object(u.a)(t)?t.buffer:void 0,boxBatchIds:Object(u.a)(t)?i.buffer:void 0,cylinders:Object(u.a)(n)?n.buffer:void 0,cylinderBatchIds:Object(u.a)(n)?r.buffer:void 0,ellipsoids:Object(u.a)(a)?a.buffer:void 0,ellipsoidBatchIds:Object(u.a)(a)?o.buffer:void 0,spheres:Object(u.a)(s)?s.buffer:void 0,sphereBatchIds:Object(u.a)(s)?c.buffer:void 0,batchTableColors:l.buffer,packedBuffer:h.buffer},v=e._verticesPromise=d1.scheduleTask(g,_);if(!Object(u.a)(v))return;v.then((function(t){var i=new Float64Array(t.packedBuffer),n=function(e,t){for(var i=0,n=t[i++],r=t[i++],a=e._boundingVolumes=new Array(r),o=0;o<r;++o)a[o]=St.unpack(t,i),i+=St.packedLength;for(var s=t[i++],c=e._batchedIndices=new Array(s),l=0;l<s;++l){var u=uf.unpack(t,i);i+=uf.packedLength;for(var h=t[i++],d=t[i++],f=t[i++],p=new Array(f),m=0;m<f;++m)p[m]=t[i++];c[l]=new SQ({color:u,offset:h,count:d,batchIds:p})}return n}(e,i);e._indices=2===n?new Uint16Array(t.indices):new Uint32Array(t.indices),e._indexOffsets=new Uint32Array(t.indexOffsets),e._indexCounts=new Uint32Array(t.indexCounts),e._positions=new Float32Array(t.positions),e._vertexBatchIds=new Uint16Array(t.vertexBatchIds),e._batchIds=new Uint16Array(t.batchIds),e._ready=!0}))}e._ready&&!Object(u.a)(e._primitive)&&(e._primitive=new EK({batchTable:e._batchTable,positions:e._positions,batchIds:e._batchIds,vertexBatchIds:e._vertexBatchIds,indices:e._indices,indexOffsets:e._indexOffsets,indexCounts:e._indexCounts,batchedIndices:e._batchedIndices,boundingVolume:e._boundingVolume,boundingVolumes:e._boundingVolumes,center:e._center,pickObject:Object(w.a)(e._pickObject,e)}),e._boxes=void 0,e._boxBatchIds=void 0,e._cylinders=void 0,e._cylinderBatchIds=void 0,e._ellipsoids=void 0,e._ellipsoidBatchIds=void 0,e._spheres=void 0,e._sphereBatchIds=void 0,e._center=void 0,e._modelMatrix=void 0,e._batchTable=void 0,e._boundingVolume=void 0,e._boundingVolumes=void 0,e._batchedIndices=void 0,e._indices=void 0,e._indexOffsets=void 0,e._indexCounts=void 0,e._positions=void 0,e._vertexBatchIds=void 0,e._batchIds=void 0,e._batchTableColors=void 0,e._packedBuffer=void 0,e._verticesPromise=void 0,e._readyPromise.resolve())}}h1.prototype.createFeatures=function(e,t){this._primitive.createFeatures(e,t)},h1.prototype.applyDebugSettings=function(e,t){this._primitive.applyDebugSettings(e,t)},h1.prototype.applyStyle=function(e,t){this._primitive.applyStyle(e,t)},h1.prototype.updateCommands=function(e,t){this._primitive.updateCommands(e,t)},h1.prototype.update=function(e){p1(this),this._ready&&(this._primitive.debugWireframe=this.debugWireframe,this._primitive.forceRebatch=this.forceRebatch,this._primitive.classificationType=this.classificationType,this._primitive.update(e))},h1.prototype.isDestroyed=function(){return!1},h1.prototype.destroy=function(){return this._primitive=this._primitive&&this._primitive.destroy(),rl(this)};var m1=h1;function _1(e,t,i,n,r){this._tileset=e,this._tile=t,this._resource=i,this._geometries=void 0,this._contentReadyPromise=void 0,this._readyPromise=Oi.a.defer(),this._batchTable=void 0,this._features=void 0,this.featurePropertiesDirty=!1,function(e,t,i){i=Object(w.a)(i,0);var n=new Uint8Array(t),r=new DataView(t);i+=g1;var a=r.getUint32(i,!0);if(1!==a)throw new Ce.a("Only Geometry tile version 1 is supported.  Version "+a+" is not.");i+=g1;var o=r.getUint32(i,!0);if(i+=g1,0===o)return void e._readyPromise.resolve(e);var s=r.getUint32(i,!0);if(i+=g1,0===s)throw new Ce.a("Feature table must have a byte length greater than zero");var c=r.getUint32(i,!0);i+=g1;var l=r.getUint32(i,!0);i+=g1;var h=r.getUint32(i,!0),d=is(n,i+=g1,s),f=JSON.parse(d);i+=s;var p,m,_=new Uint8Array(t,i,c);if(i+=c,l>0){var g=is(n,i,l);p=JSON.parse(g),i+=l,h>0&&(m=new Uint8Array(t,i,h),m=new Uint8Array(m))}var v=Object(w.a)(f.BOXES_LENGTH,0),b=Object(w.a)(f.CYLINDERS_LENGTH,0),y=Object(w.a)(f.ELLIPSOIDS_LENGTH,0),O=Object(w.a)(f.SPHERES_LENGTH,0),x=v+b+y+O,E=new ZX(e,x,p,m,function(e){return function(t,i){Object(u.a)(e._geometries)&&e._geometries.updateCommands(t,i)}}(e));if(e._batchTable=E,0===x)return;var T,C=e.tile.computedTransform;Object(u.a)(f.RTC_CENTER)&&(T=z.unpack(f.RTC_CENTER),Be.multiplyByPoint(C,T,T));var S=function(e,t){var i,n,r,a,o,s=Object(w.a)(e.BOXES_LENGTH,0),c=Object(w.a)(e.CYLINDERS_LENGTH,0),l=Object(w.a)(e.ELLIPSOIDS_LENGTH,0),h=Object(w.a)(e.SPHERES_LENGTH,0);if(s>0&&Object(u.a)(e.BOX_BATCH_IDS)){var d=t.byteOffset+e.BOX_BATCH_IDS.byteOffset;i=new Uint16Array(t.buffer,d,s)}if(c>0&&Object(u.a)(e.CYLINDER_BATCH_IDS)){var f=t.byteOffset+e.CYLINDER_BATCH_IDS.byteOffset;n=new Uint16Array(t.buffer,f,c)}if(l>0&&Object(u.a)(e.ELLIPSOID_BATCH_IDS)){var p=t.byteOffset+e.ELLIPSOID_BATCH_IDS.byteOffset;r=new Uint16Array(t.buffer,p,l)}if(h>0&&Object(u.a)(e.SPHERE_BATCH_IDS)){var m=t.byteOffset+e.SPHERE_BATCH_IDS.byteOffset;a=new Uint16Array(t.buffer,m,h)}var _=Object(u.a)(i)||Object(u.a)(n)||Object(u.a)(r)||Object(u.a)(a),g=s>0&&!Object(u.a)(i)||c>0&&!Object(u.a)(n)||l>0&&!Object(u.a)(r)||h>0&&!Object(u.a)(a);if(_&&g)throw new Ce.a("If one group of batch ids is defined, then all batch ids must be defined.");if(!(Object(u.a)(i)||Object(u.a)(n)||Object(u.a)(r)||Object(u.a)(a))){var v=0;if(!Object(u.a)(i)&&s>0)for(i=new Uint16Array(s),o=0;o<s;++o)i[o]=v++;if(!Object(u.a)(n)&&c>0)for(n=new Uint16Array(c),o=0;o<c;++o)n[o]=v++;if(!Object(u.a)(r)&&l>0)for(r=new Uint16Array(l),o=0;o<l;++o)r[o]=v++;if(!Object(u.a)(a)&&h>0)for(a=new Uint16Array(h),o=0;o<h;++o)a[o]=v++}return{boxes:i,cylinders:n,ellipsoids:r,spheres:a}}(f,_);if(v>0||b>0||y>0||O>0){var A,P,I,D;if(v>0){var j=_.byteOffset+f.BOXES.byteOffset;A=new Float32Array(_.buffer,j,m1.packedBoxLength*v)}if(b>0){var M=_.byteOffset+f.CYLINDERS.byteOffset;P=new Float32Array(_.buffer,M,m1.packedCylinderLength*b)}if(y>0){var R=_.byteOffset+f.ELLIPSOIDS.byteOffset;I=new Float32Array(_.buffer,R,m1.packedEllipsoidLength*y)}if(O>0){var L=_.byteOffset+f.SPHERES.byteOffset;D=new Float32Array(_.buffer,L,m1.packedSphereLength*O)}e._geometries=new m1({boxes:A,boxBatchIds:S.boxes,cylinders:P,cylinderBatchIds:S.cylinders,ellipsoids:I,ellipsoidBatchIds:S.ellipsoids,spheres:D,sphereBatchIds:S.spheres,center:T,modelMatrix:C,batchTable:E,boundingVolume:e.tile.boundingVolume.boundingVolume})}}(this,n,r)}Object(O.a)(_1.prototype,{featuresLength:{get:function(){return Object(u.a)(this._batchTable)?this._batchTable.featuresLength:0}},pointsLength:{get:function(){return 0}},trianglesLength:{get:function(){return Object(u.a)(this._geometries)?this._geometries.trianglesLength:0}},geometryByteLength:{get:function(){return Object(u.a)(this._geometries)?this._geometries.geometryByteLength:0}},texturesByteLength:{get:function(){return 0}},batchTableByteLength:{get:function(){return Object(u.a)(this._batchTable)?this._batchTable.memorySizeInBytes:0}},innerContents:{get:function(){}},readyPromise:{get:function(){return this._readyPromise.promise}},tileset:{get:function(){return this._tileset}},tile:{get:function(){return this._tile}},url:{get:function(){return this._resource.getUrlComponent(!0)}},batchTable:{get:function(){return this._batchTable}}});var g1=Uint32Array.BYTES_PER_ELEMENT;function v1(e){var t=e.featuresLength;if(!Object(u.a)(e._features)&&t>0){var i=new Array(t);Object(u.a)(e._geometries)&&e._geometries.createFeatures(e,i),e._features=i}}_1.prototype.hasProperty=function(e,t){return this._batchTable.hasProperty(e,t)},_1.prototype.getFeature=function(e){var t=this.featuresLength;if(!Object(u.a)(e)||e<0||e>=t)throw new h.a("batchId is required and between zero and featuresLength - 1 ("+(t-1)+").");return v1(this),this._features[e]},_1.prototype.applyDebugSettings=function(e,t){Object(u.a)(this._geometries)&&this._geometries.applyDebugSettings(e,t)},_1.prototype.applyStyle=function(e){v1(this),Object(u.a)(this._geometries)&&this._geometries.applyStyle(e,this._features)},_1.prototype.update=function(e,t){if(Object(u.a)(this._geometries)&&(this._geometries.classificationType=this._tileset.classificationType,this._geometries.debugWireframe=this._tileset.debugWireframe,this._geometries.update(t)),Object(u.a)(this._batchTable)&&this._geometries._ready&&this._batchTable.update(e,t),!Object(u.a)(this._contentReadyPromise)){var i=this;this._contentReadyPromise=this._geometries.readyPromise.then((function(){i._readyPromise.resolve(i)}))}},_1.prototype.isDestroyed=function(){return!1},_1.prototype.destroy=function(){return this._geometries=this._geometries&&this._geometries.destroy(),this._batchTable=this._batchTable&&this._batchTable.destroy(),rl(this)};var b1=_1;function y1(e,t,i){this.primitive=e,this._modelMatrix=Be.clone(t),this._instanceId=i}Object(O.a)(y1.prototype,{instanceId:{get:function(){return this._instanceId}},model:{get:function(){return this.primitive._model}},modelMatrix:{get:function(){return Be.clone(this._modelMatrix)},set:function(e){Be.clone(e,this._modelMatrix),this.primitive.expandBoundingSphere(this._modelMatrix),this.primitive._dirty=!0}}});var w1=y1,O1={NEEDS_LOAD:0,LOADING:1,LOADED:2,FAILED:3};function x1(e){if(e=Object(w.a)(e,w.a.EMPTY_OBJECT),!Object(u.a)(e.gltf)&&!Object(u.a)(e.url))throw new h.a("Either options.gltf or options.url is required.");if(Object(u.a)(e.gltf)&&Object(u.a)(e.url))throw new h.a("Cannot pass in both options.gltf and options.url.");this.show=Object(w.a)(e.show,!0),this._instancingSupported=!1,this._dynamic=Object(w.a)(e.dynamic,!1),this._allowPicking=Object(w.a)(e.allowPicking,!0),this._ready=!1,this._readyPromise=Oi.a.defer(),this._state=O1.NEEDS_LOAD,this._dirty=!1,this._instancesLength=e.instances.length,this._maxInstancesLength=Object(w.a)(e.maxInstancesLength,this._instancesLength),this._pointsArray=new Array(this._maxInstancesLength),this._pickIds=new Array(this._maxInstancesLength),this._cull=Object(w.a)(e.cull,!0),this._opaquePass=Object(w.a)(e.opaquePass,lM.OPAQUE),this._instances=new Array(this._maxInstancesLength),function(e,t){for(var i=(t=Object(w.a)(t,[])).length,n=0;n<i;++n){var r=t[n],a=r.modelMatrix,o=Object(w.a)(r.batchId,n);e._instances[n]=new w1(e,a,o)}}(this,e.instances),this._batchTable=e.batchTable,this._model=void 0,this._vertexBufferTypedArray=void 0,this._vertexBuffer=void 0,this._batchIdBuffer=void 0,this._instancedUniformsByProgram=void 0,this._drawCommands=[],this._modelCommands=void 0,this._boundingSphere=function(e){for(var t=e.length,i=0;i<t;++i)e._pointsArray[i]=Be.getTranslation(e._instances[i]._modelMatrix,new z);return St.fromInstancePoints(e._pointsArray,void 0,t)}(this),this._center=z.clone(this._boundingSphere.center),this._rtcTransform=new Be,this._rtcModelView=new Be,this._mode=void 0,this.modelMatrix=Be.clone(Be.IDENTITY),this._modelMatrix=Be.clone(this.modelMatrix),this._url=f.a.createIfNeeded(e.url),this._requestType=e.requestType,this._gltf=e.gltf,this._basePath=f.a.createIfNeeded(e.basePath),this._asynchronous=e.asynchronous,this._incrementallyLoadTextures=e.incrementallyLoadTextures,this._upAxis=e.upAxis,this._forwardAxis=e.forwardAxis,this.shadows=Object(w.a)(e.shadows,rM.ENABLED),this._shadows=this.shadows,this._pickIdLoaded=e.pickIdLoaded,this.debugShowBoundingVolume=Object(w.a)(e.debugShowBoundingVolume,!1),this._debugShowBoundingVolume=!1,this.debugWireframe=Object(w.a)(e.debugWireframe,!1),this._debugWireframe=!1,this._imageBasedLightingFactor=new Rt(1,1),Rt.clone(e.imageBasedLightingFactor,this._imageBasedLightingFactor),this.lightColor=e.lightColor,this.luminanceAtZenith=e.luminanceAtZenith,this.sphericalHarmonicCoefficients=e.sphericalHarmonicCoefficients,this.specularEnvironmentMaps=e.specularEnvironmentMaps,this._instanceChanged=!1,this._originalInstanceData=void 0,this._forceMipmap=e.forceMipmap}Object(O.a)(x1.prototype,{allowPicking:{get:function(){return this._allowPicking}},length:{get:function(){return this._instancesLength}},activeAnimations:{get:function(){return this._model.activeAnimations}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise.promise}},imageBasedLightingFactor:{get:function(){return this._imageBasedLightingFactor},set:function(e){x.a.typeOf.object("imageBasedLightingFactor",e),x.a.typeOf.number.greaterThanOrEquals("imageBasedLightingFactor.x",e.x,0),x.a.typeOf.number.lessThanOrEquals("imageBasedLightingFactor.x",e.x,1),x.a.typeOf.number.greaterThanOrEquals("imageBasedLightingFactor.y",e.y,0),x.a.typeOf.number.lessThanOrEquals("imageBasedLightingFactor.y",e.y,1),Rt.clone(e,this._imageBasedLightingFactor)}}});var E1=new z,T1=new Be;function C1(e,t,i,n){return function(r,a){var o=r.semantic;if(Object(u.a)(o)&&e.indexOf(o)>-1){if(!(t.indexOf(o)>-1))throw new Ce.a('Shader program cannot be optimized for instancing. Uniform "'+a+'" in program "'+i+'" uses unsupported semantic "'+o+'"');n[a]=o}}}function S1(e,t){if(Object(u.a)(e._instancedUniformsByProgram))return e._instancedUniformsByProgram[t];var i={};e._instancedUniformsByProgram=i;var n=["MODEL","MODELVIEW","CESIUM_RTC_MODELVIEW","MODELVIEWPROJECTION","MODELINVERSE","MODELVIEWINVERSE","MODELVIEWPROJECTIONINVERSE","MODELINVERSETRANSPOSE","MODELVIEWINVERSETRANSPOSE"],r=["MODELVIEW","CESIUM_RTC_MODELVIEW","MODELVIEWPROJECTION","MODELVIEWINVERSETRANSPOSE"],a=e._model._sourceTechniques;for(var o in a)if(a.hasOwnProperty(o)){var s=a[o],c=s.program;if(!Object(u.a)(i[c])){var l={};i[c]=l,rZ.techniqueUniform(s,C1(n,r,t,l))}}return i[t]}function A1(e,t){return function(i,n,r){(i=Object(nf.a)(i)).czm_instanced_modifiedModelView=function(e,t){return function(){return Be.multiply(t.uniformState.view,e._rtcTransform,e._rtcModelView)}}(e,t),i.czm_instanced_nodeTransform=function(e){return function(){return e.computedMatrix}}(r);var a=S1(e,n);for(var o in a)a.hasOwnProperty(o)&&delete i[o];return Object(u.a)(e._batchTable)&&(i=e._batchTable.getUniformMapCallback()(i)),i}}function P1(e){var t=e._instances,i=e.length,n=e._center,r=e._vertexBufferTypedArray,a=12*i;Object(u.a)(r)&&r.length===a||(r=new Float32Array(a)),e._dynamic&&(e._vertexBufferTypedArray=r);for(var o=0;o<i;++o){var s=t[o]._modelMatrix,c=Be.clone(s,T1);c[12]-=n.x,c[13]-=n.y,c[14]-=n.z;var l=12*o;r[l+0]=c[0],r[l+1]=c[4],r[l+2]=c[8],r[l+3]=c[12],r[l+4]=c[1],r[l+5]=c[5],r[l+6]=c[9],r[l+7]=c[13],r[l+8]=c[2],r[l+9]=c[6],r[l+10]=c[10],r[l+11]=c[14]}return r}function I1(e,t){var i=e._instancingSupported,n=Object(u.a)(e._batchTable),r=e._allowPicking,a={url:e._url,requestType:e._requestType,gltf:e._gltf,basePath:e._basePath,shadows:e._shadows,cacheKey:void 0,asynchronous:e._asynchronous,allowPicking:r,incrementallyLoadTextures:e._incrementallyLoadTextures,upAxis:e._upAxis,forwardAxis:e._forwardAxis,precreatedAttributes:void 0,vertexShaderLoaded:void 0,fragmentShaderLoaded:void 0,uniformMapLoaded:void 0,pickIdLoaded:e._pickIdLoaded,ignoreCommands:!0,opaquePass:e._opaquePass,imageBasedLightingFactor:e.imageBasedLightingFactor,lightColor:e.lightColor,luminanceAtZenith:e.luminanceAtZenith,sphericalHarmonicCoefficients:e.sphericalHarmonicCoefficients,specularEnvironmentMaps:e.specularEnvironmentMaps,forceMipmap:e._forceMipmap};if(n||function(e,t){for(var i=e._instances,n=e.length,r=0;r<n;++r)e._pickIds[r]=t.createPickId(i[r])}(e,t),i){!function(e,t){var i,n=e._instances,r=e.length,a=e._dynamic,o=Object(u.a)(e._batchTable);if(o){var s=new Uint16Array(r);for(i=0;i<r;++i)s[i]=n[i]._instanceId;Object(u.a)(e._batchIdBuffer)?e._batchIdBuffer.updateFromArrayView(s):e._batchIdBuffer=ZN.createVertexBuffer({context:t,typedArray:s,usage:YN.STATIC_DRAW})}if(!o){var c=new Uint8Array(4*r);for(i=0;i<r;++i){var l=e._pickIds[i].color,h=4*i;c[h]=uf.floatToByte(l.red),c[h+1]=uf.floatToByte(l.green),c[h+2]=uf.floatToByte(l.blue),c[h+3]=uf.floatToByte(l.alpha)}Object(u.a)(e._pickIdBuffer)?e._pickIdBuffer.updateFromArrayView(c):e._pickIdBuffer=ZN.createVertexBuffer({context:t,typedArray:c,usage:YN.STATIC_DRAW})}var d=P1(e);Object(u.a)(e._vertexBuffer)?e._vertexBuffer.updateFromArrayView(d):e._vertexBuffer=ZN.createVertexBuffer({context:t,typedArray:d,usage:a?YN.STREAM_DRAW:YN.STATIC_DRAW})}(e,t);var o=dn.getSizeInBytes(dn.FLOAT),s={czm_modelMatrixRow0:{index:0,vertexBuffer:e._vertexBuffer,componentsPerAttribute:4,componentDatatype:dn.FLOAT,normalize:!1,offsetInBytes:0,strideInBytes:12*o,instanceDivisor:1},czm_modelMatrixRow1:{index:0,vertexBuffer:e._vertexBuffer,componentsPerAttribute:4,componentDatatype:dn.FLOAT,normalize:!1,offsetInBytes:4*o,strideInBytes:12*o,instanceDivisor:1},czm_modelMatrixRow2:{index:0,vertexBuffer:e._vertexBuffer,componentsPerAttribute:4,componentDatatype:dn.FLOAT,normalize:!1,offsetInBytes:8*o,strideInBytes:12*o,instanceDivisor:1}};n&&(s.a_batchId={index:0,vertexBuffer:e._batchIdBuffer,componentsPerAttribute:1,componentDatatype:dn.UNSIGNED_SHORT,normalize:!1,offsetInBytes:0,strideInBytes:0,instanceDivisor:1}),n||(s.pickColor={index:0,vertexBuffer:e._pickIdBuffer,componentsPerAttribute:4,componentDatatype:dn.UNSIGNED_BYTE,normalize:!0,offsetInBytes:0,strideInBytes:0,instanceDivisor:1}),a.precreatedAttributes=s,a.vertexShaderLoaded=function(e){return function(t,i){var n=S1(e,i),r=Object(u.a)(e._batchTable),a=UN.replaceMain(t,"czm_instancing_main"),o="",s="";for(var c in n)if(n.hasOwnProperty(c)){var l,h=n[c];"MODELVIEW"===h||"CESIUM_RTC_MODELVIEW"===h?l="czm_instanced_modelView":"MODELVIEWPROJECTION"===h?(l="czm_instanced_modelViewProjection",o+="mat4 czm_instanced_modelViewProjection;\n",s+="czm_instanced_modelViewProjection = czm_projection * czm_instanced_modelView;\n"):"MODELVIEWINVERSETRANSPOSE"===h&&(l="czm_instanced_modelViewInverseTranspose",o+="mat3 czm_instanced_modelViewInverseTranspose;\n",s+="czm_instanced_modelViewInverseTranspose = mat3(czm_instanced_modelView);\n");var d=new RegExp("uniform.*"+c+".*");a=a.replace(d,""),d=new RegExp(c+"\\b","g"),a=a.replace(d,l)}var f,p,m;r?(f="attribute float a_batchId;\n",p="",m=""):(f="",p="attribute vec4 pickColor;\nvarying vec4 v_pickColor;\n",m="    v_pickColor = pickColor;\n");var _="uniform mat4 czm_instanced_modifiedModelView;\nuniform mat4 czm_instanced_nodeTransform;\n"+o+"mat4 czm_instanced_modelView;\nattribute vec4 czm_modelMatrixRow0;\nattribute vec4 czm_modelMatrixRow1;\nattribute vec4 czm_modelMatrixRow2;\n"+f+p+a+"void main()\n{\n    mat4 czm_instanced_model = mat4(czm_modelMatrixRow0.x, czm_modelMatrixRow1.x, czm_modelMatrixRow2.x, 0.0, czm_modelMatrixRow0.y, czm_modelMatrixRow1.y, czm_modelMatrixRow2.y, 0.0, czm_modelMatrixRow0.z, czm_modelMatrixRow1.z, czm_modelMatrixRow2.z, 0.0, czm_modelMatrixRow0.w, czm_modelMatrixRow1.w, czm_modelMatrixRow2.w, 1.0);\n    czm_instanced_modelView = czm_instanced_modifiedModelView * czm_instanced_model * czm_instanced_nodeTransform;\n"+s+"    czm_instancing_main();\n"+m+"}\n";if(r){var g=e._model.gltf,v=wQ.getDiffuseAttributeOrUniform(g,i);_=e._batchTable.getVertexShaderCallback(!0,"a_batchId",v)(_)}return _}}(e),a.fragmentShaderLoaded=function(e){return function(t,i){var n=e._batchTable;if(Object(u.a)(n)){var r=e._model.gltf,a=wQ.getDiffuseAttributeOrUniform(r,i);t=n.getFragmentShaderCallback(!0,a)(t)}else t="varying vec4 v_pickColor;\n"+t;return t}}(e),a.uniformMapLoaded=A1(e,t),Object(u.a)(e._url)&&(a.cacheKey=e._url.getUrlComponent()+"#instanced")}else a.vertexShaderLoaded=function(e){return function(t,i){if(Object(u.a)(e._batchTable)){var n=e._model.gltf,r=wQ.getDiffuseAttributeOrUniform(n,i);t="uniform float a_batchId\n;"+(t=e._batchTable.getVertexShaderCallback(!0,"a_batchId",r)(t))}return t}}(e),a.fragmentShaderLoaded=function(e){return function(t,i){var n=e._batchTable;if(Object(u.a)(n)){var r=e._model.gltf,a=wQ.getDiffuseAttributeOrUniform(r,i);t=n.getFragmentShaderCallback(!0,a)(t)}else t="uniform vec4 czm_pickColor;\n"+t;return t}}(e),a.uniformMapLoaded=function(e){return function(t){return Object(u.a)(e._batchTable)&&(t=e._batchTable.getUniformMapCallback()(t)),t}}(e);Object(u.a)(e._url)?e._model=J0.fromGltf(a):e._model=new J0(a)}function D1(e){return function(){return e}}function j1(e){return function(){return e}}function M1(e){for(var t=e._modelCommands,i=t.length,n=e.length,r=e._rtcTransform,a=e._center,o=0;o<i;++o)for(var s=t[o],c=0;c<n;++c){var l=o*n+c,u=e._drawCommands[l],h=Be.clone(e._instances[c]._modelMatrix,T1);h[12]-=a.x,h[13]-=a.y,h[14]-=a.z,h=Be.multiply(r,h,T1);var d=s.modelMatrix,f=u.modelMatrix;Be.multiply(h,d,f);var p=s.boundingVolume,m=u.boundingVolume;St.transform(p,h,m)}}function R1(e){for(var t=e._nodeCommands,i=t.length,n=[],r=0;r<i;++r){var a=t[r];a.show&&n.push(a.command)}return n}function L1(e,t){e._drawCommands=[];var i=R1(e._model);t?function(e,t){for(var i=t.length,n=e.length,r=e._boundingSphere,a=e._cull,o=0;o<i;++o){var s=cM.shallowClone(t[o]);s.instanceCount=n,s.boundingVolume=r,s.cull=a,Object(u.a)(e._batchTable)?s.pickId=e._batchTable.getPickId():s.pickId="v_pickColor",e._drawCommands.push(s)}}(e,i):(!function(e,t){for(var i=e._instances,n=t.length,r=e.length,a=e._batchTable,o=Object(u.a)(a),s=e._cull,c=0;c<n;++c)for(var l=0;l<r;++l){var h=cM.shallowClone(t[c]);if(h.modelMatrix=new Be,h.boundingVolume=new St,h.cull=s,h.uniformMap=Object(nf.a)(h.uniformMap),o)h.uniformMap.a_batchId=D1(i[l]._instanceId);else{var d=e._pickIds[l];h.uniformMap.czm_pickColor=j1(d.color)}e._drawCommands.push(h)}}(e,i),M1(e))}x1.prototype.expandBoundingSphere=function(e){var t=Be.getTranslation(e,E1);St.expand(this._boundingSphere,t,this._boundingSphere)},x1.prototype.updateCollection=function(e){this._originalInstanceData=e.instances,this._instancesLength=this._originalInstanceData.length,this._instanceChanged=!0},x1.prototype.update=function(e){if(e.mode!==xF.MORPHING&&this.show&&0!==this.length){var t=e.context;if(this._state===O1.NEEDS_LOAD){this._state=O1.LOADING,this._instancingSupported=t.instancedArrays,I1(this,t);var i=this;this._model.readyPromise.otherwise((function(e){i._state=O1.FAILED,i._readyPromise.reject(e)}))}var n=this._instancingSupported,r=this._model;if(r.imageBasedLightingFactor=this.imageBasedLightingFactor,r.lightColor=this.lightColor,r.luminanceAtZenith=this.luminanceAtZenith,r.sphericalHarmonicCoefficients=this.sphericalHarmonicCoefficients,r.specularEnvironmentMaps=this.specularEnvironmentMaps,r.update(e),r.ready&&this._state===O1.LOADING){this._state=O1.LOADED,this._ready=!0;var a=r.boundingSphere.radius+z.magnitude(r.boundingSphere.center);return this._boundingSphere.radius+=a,this._modelCommands=R1(r),L1(this,n),void this._readyPromise.resolve(this)}if(this._state===O1.LOADED){if(this._instanceChanged){this._instanceChanged=!1,function(e,t,i){var n,r=(t=Object(w.a)(t,[])).length,a=Object(u.a)(e._batchTable);e._instancingSupported&&(n=a?new Uint16Array(r):new Uint8Array(4*r));for(var o=0;o<e._maxInstancesLength;++o)if(o>=r)e._instances[o]=void 0,e._pointsArray[o]=void 0;else{var s=t[o],c=s.modelMatrix,l=Object(w.a)(s.batchId,o),h=e._instances[o];h?(h._modelMatrix=Be.clone(c),h._instanceId=l):e._instances[o]=h=new w1(e,c,l);var d=e._pointsArray[o];d||(e._pointsArray[o]=d=new z),Be.getTranslation(h._modelMatrix,d);var f=e._pickIds[o];if(f?f.object=h:e._pickIds[o]=f=i.createPickId(h),e._instancingSupported)if(a)n[o]=h._instanceId;else{var p=f.color,m=4*o;n[m]=uf.floatToByte(p.red),n[m+1]=uf.floatToByte(p.green),n[m+2]=uf.floatToByte(p.blue),n[m+3]=uf.floatToByte(p.alpha)}}if(St.fromInstancePoints(e._pointsArray,e._boundingSphere,r),e._center=z.clone(e._boundingSphere.center),e._rtcTransform=new Be,e._rtcModelView=new Be,e._mode=void 0,e.modelMatrix=Be.clone(Be.IDENTITY),e._modelMatrix=Be.clone(e.modelMatrix),e._instancingSupported){a?Object(u.a)(e._batchIdBuffer)&&e._batchIdBuffer.updateFromArrayView(n):Object(u.a)(e._pickIdBuffer)&&e._pickIdBuffer.updateFromArrayView(n);var _=P1(e);Object(u.a)(e._vertexBuffer)&&e._vertexBuffer.updateFromArrayView(_)}}(this,this._originalInstanceData,t);var o=r.boundingSphere.radius+z.magnitude(r.boundingSphere.center);this._boundingSphere.radius+=o,L1(this,n)}var s,c,l=e.mode!==this._mode,h=this.modelMatrix,d=!Be.equals(this._modelMatrix,h);if(l||d){this._mode=e.mode,Be.clone(h,this._modelMatrix);var f=Be.multiplyByTranslation(this._modelMatrix,this._center,this._rtcTransform);this._mode!==xF.SCENE3D&&(f=xa.basisTo2D(e.mapProjection,f,f)),Be.getTranslation(f,this._boundingSphere.center)}n&&this._dirty&&(this._dynamic=!0,this._dirty=!1,c=P1(s=this),s._vertexBuffer.copyFromArrayView(c)),function(e){for(var t=e._nodeCommands,i=t.length,n=0;n<i;n++){if(t[n].command.dirty)return!0}return!1}(r)&&L1(this,n),!n&&(r.dirty||this._dirty||l||d)&&M1(this),function(e){if(e.shadows!==e._shadows){e._shadows=e.shadows;for(var t=rM.castShadows(e.shadows),i=rM.receiveShadows(e.shadows),n=e._drawCommands,r=n.length,a=0;a<r;++a){var o=n[a];o.castShadows=t,o.receiveShadows=i}}}(this),function(e){if(e._debugWireframe!==e.debugWireframe){e._debugWireframe=e.debugWireframe;for(var t=e.debugWireframe?yn.LINES:yn.TRIANGLES,i=e._drawCommands,n=i.length,r=0;r<n;++r)i[r].primitiveType=t}}(this),function(e){if(e.debugShowBoundingVolume!==e._debugShowBoundingVolume){e._debugShowBoundingVolume=e.debugShowBoundingVolume;for(var t=e._drawCommands,i=t.length,n=0;n<i;++n)t[n].debugShowBoundingVolume=e.debugShowBoundingVolume}}(this);var p=e.passes;if(p.render||p.pick)for(var m=e.commandList,_=this._drawCommands,g=_.length,v=0;v<g;++v)m.push(_[v])}}},x1.prototype.isDestroyed=function(){return!1},x1.prototype.destroy=function(){this._model=this._model&&this._model.destroy();var e=this._pickIds;if(Object(u.a)(e))for(var t=e.length,i=0;i<t;++i)e[i].destroy();return rl(this)};var N1=x1;function F1(e,t,i,n,r){this._tileset=e,this._tile=t,this._resource=i,this._modelInstanceCollection=void 0,this._batchTable=void 0,this._features=void 0,this.featurePropertiesDirty=!1,function(e,t,i){var n=Object(w.a)(i,0);i=n;var r=new Uint8Array(t),a=new DataView(t);i+=B1;var o=a.getUint32(i,!0);if(1!==o)throw new Ce.a("Only Instanced 3D Model version 1 is supported. Version "+o+" is not.");i+=B1;var s=a.getUint32(i,!0);i+=B1;var c=a.getUint32(i,!0);if(0===c)throw new Ce.a("featureTableJsonByteLength is zero, the feature table must be defined.");i+=B1;var l=a.getUint32(i,!0);i+=B1;var h=a.getUint32(i,!0);i+=B1;var d=a.getUint32(i,!0);i+=B1;var f=a.getUint32(i,!0);if(1!==f&&0!==f)throw new Ce.a("Only glTF format 0 (uri) or 1 (embedded) are supported. Format "+f+" is not.");var p=is(r,i+=B1,c),m=JSON.parse(p);i+=c;var _=new Uint8Array(t,i,l);i+=l;var g,v,b=new eZ(m,_),y=b.getGlobalProperty("INSTANCES_LENGTH");if(b.featuresLength=y,!Object(u.a)(y))throw new Ce.a("Feature table global property: INSTANCES_LENGTH must be defined");if(h>0){var O=is(r,i,h);g=JSON.parse(O),i+=h,d>0&&(v=new Uint8Array(t,i,d),v=new Uint8Array(v),i+=d)}e._batchTable=new ZX(e,y,g,v);var x,E=n+s-i;if(0===E)throw new Ce.a("glTF byte length is zero, i3dm must have a glTF to instance.");i%4==0?x=new Uint8Array(t,i,E):(F1._deprecationWarning("i3dm-glb-unaligned","The embedded glb is not aligned to a 4-byte boundary."),x=new Uint8Array(r.subarray(i,i+E)));var T=e._tileset,C={instances:new Array(y),batchTable:e._batchTable,cull:!1,url:void 0,requestType:Hl.a.TILES3D,gltf:void 0,basePath:void 0,incrementallyLoadTextures:!1,upAxis:T._gltfUpAxis,forwardAxis:mX.X,opaquePass:lM.CESIUM_3D_TILE,pickIdLoaded:k1(e),imageBasedLightingFactor:T.imageBasedLightingFactor,lightColor:T.lightColor,luminanceAtZenith:T.luminanceAtZenith,sphericalHarmonicCoefficients:T.sphericalHarmonicCoefficients,specularEnvironmentMaps:T.specularEnvironmentMaps};if(0===f){var S=is(x);S=S.replace(/[\s\0]+$/,""),C.url=e._resource.getDerivedResource({url:S})}else C.gltf=x,C.basePath=e._resource.clone();var A,P=b.getGlobalProperty("EAST_NORTH_UP"),I=b.getGlobalProperty("RTC_CENTER",dn.FLOAT,3);Object(u.a)(I)&&(A=z.unpack(I));for(var D=C.instances,j=new z,M=new Array(3),R=new z,L=new z,N=new z,F=new be,k=new Kn,B=new z,U=new aI,V=new Be,H=0;H<y;H++){var G=b.getProperty("POSITION",dn.FLOAT,3,H,z1);if(!Object(u.a)(G)){G=M;var q=b.getProperty("POSITION_QUANTIZED",dn.UNSIGNED_SHORT,3,H,z1);if(!Object(u.a)(q))throw new Ce.a("Either POSITION or POSITION_QUANTIZED must be defined for each instance.");var W=b.getGlobalProperty("QUANTIZED_VOLUME_OFFSET",dn.FLOAT,3);if(!Object(u.a)(W))throw new Ce.a("Global property: QUANTIZED_VOLUME_OFFSET must be defined for quantized positions.");var Y=b.getGlobalProperty("QUANTIZED_VOLUME_SCALE",dn.FLOAT,3);if(!Object(u.a)(Y))throw new Ce.a("Global property: QUANTIZED_VOLUME_SCALE must be defined for quantized positions.");for(var X=0;X<3;X++)G[X]=q[X]/65535*Y[X]+W[X]}z.unpack(G,0,j),Object(u.a)(A)&&z.add(j,A,j),U.translation=j;var Z=b.getProperty("NORMAL_UP",dn.FLOAT,3,H,z1),Q=b.getProperty("NORMAL_RIGHT",dn.FLOAT,3,H,U1),K=!1;if(Object(u.a)(Z)){if(!Object(u.a)(Q))throw new Ce.a("To define a custom orientation, both NORMAL_UP and NORMAL_RIGHT must be defined.");z.unpack(Z,0,L),z.unpack(Q,0,R),K=!0}else{var J=b.getProperty("NORMAL_UP_OCT32P",dn.UNSIGNED_SHORT,2,H,z1),$=b.getProperty("NORMAL_RIGHT_OCT32P",dn.UNSIGNED_SHORT,2,H,U1);if(Object(u.a)(J)){if(!Object(u.a)($))throw new Ce.a("To define a custom orientation with oct-encoded vectors, both NORMAL_UP_OCT32P and NORMAL_RIGHT_OCT32P must be defined.");Gi.octDecodeInRange(J[0],J[1],65535,L),Gi.octDecodeInRange($[0],$[1],65535,R),K=!0}else P?(xa.eastNorthUpToFixedFrame(j,ae.WGS84,V),Be.getRotation(V,F)):be.clone(be.IDENTITY,F)}K&&(z.cross(R,L,N),z.normalize(N,N),be.setColumn(F,0,R,F),be.setColumn(F,1,L,F),be.setColumn(F,2,N,F)),Kn.fromRotationMatrix(F,k),U.rotation=k,B=z.fromElements(1,1,1,B);var ee=b.getProperty("SCALE",dn.FLOAT,1,H);Object(u.a)(ee)&&z.multiplyByScalar(B,ee,B);var te=b.getProperty("SCALE_NON_UNIFORM",dn.FLOAT,3,H,z1);Object(u.a)(te)&&(B.x*=te[0],B.y*=te[1],B.z*=te[2]),U.scale=B;var ie=b.getProperty("BATCH_ID",dn.UNSIGNED_SHORT,1,H);Object(u.a)(ie)||(ie=H),Be.fromTranslationRotationScale(U,V);var ne=V.clone();D[H]={modelMatrix:ne,batchId:ie}}e._modelInstanceCollection=new N1(C)}(this,n,r)}function k1(e){return function(){return e._batchTable.getPickId()}}F1._deprecationWarning=mv.a,Object(O.a)(F1.prototype,{featuresLength:{get:function(){return this._batchTable.featuresLength}},pointsLength:{get:function(){return 0}},trianglesLength:{get:function(){var e=this._modelInstanceCollection._model;return Object(u.a)(e)?e.trianglesLength:0}},geometryByteLength:{get:function(){var e=this._modelInstanceCollection._model;return Object(u.a)(e)?e.geometryByteLength:0}},texturesByteLength:{get:function(){var e=this._modelInstanceCollection._model;return Object(u.a)(e)?e.texturesByteLength:0}},batchTableByteLength:{get:function(){return this._batchTable.memorySizeInBytes}},innerContents:{get:function(){}},readyPromise:{get:function(){return this._modelInstanceCollection.readyPromise}},tileset:{get:function(){return this._tileset}},tile:{get:function(){return this._tile}},url:{get:function(){return this._resource.getUrlComponent(!0)}},batchTable:{get:function(){return this._batchTable}}});var B1=Uint32Array.BYTES_PER_ELEMENT,z1=new Array(4),U1=new Array(4);F1.prototype.hasProperty=function(e,t){return this._batchTable.hasProperty(e,t)},F1.prototype.getFeature=function(e){var t=this.featuresLength;if(!Object(u.a)(e)||e<0||e>=t)throw new h.a("batchId is required and between zero and featuresLength - 1 ("+(t-1)+").");return function(e){var t=e.featuresLength;if(!Object(u.a)(e._features)&&t>0){for(var i=new Array(t),n=0;n<t;++n)i[n]=new KX(e,n);e._features=i}}(this),this._features[e]},F1.prototype.applyDebugSettings=function(e,t){t=e?t:uf.WHITE,this._batchTable.setAllColor(t)},F1.prototype.applyStyle=function(e){this._batchTable.applyStyle(e)},F1.prototype.update=function(e,t){var i=t.commandList.length;this._batchTable.update(e,t),this._modelInstanceCollection.modelMatrix=this._tile.computedTransform,this._modelInstanceCollection.shadows=this._tileset.shadows,this._modelInstanceCollection.lightColor=this._tileset.lightColor,this._modelInstanceCollection.luminanceAtZenith=this._tileset.luminanceAtZenith,this._modelInstanceCollection.sphericalHarmonicCoefficients=this._tileset.sphericalHarmonicCoefficients,this._modelInstanceCollection.specularEnvironmentMaps=this._tileset.specularEnvironmentMaps,this._modelInstanceCollection.debugWireframe=this._tileset.debugWireframe;var n=this._modelInstanceCollection._model;if(Object(u.a)(n)){var r=this._tileset.clippingPlanes;n.clippingPlanesOriginMatrix=this._tileset.clippingPlanesOriginMatrix,Object(u.a)(r)&&this._tile.clippingPlanesDirty&&(n._clippingPlanes=r.enabled&&this._tile._isClipped?r:void 0),Object(u.a)(r)&&Object(u.a)(n._clippingPlanes)&&n._clippingPlanes!==r&&(n._clippingPlanes=r)}this._modelInstanceCollection.update(t),i<t.commandList.length&&(t.passes.render||t.passes.pick)&&this._batchTable.addDerivedCommands(t,i,!1)},F1.prototype.isDestroyed=function(){return!1},F1.prototype.destroy=function(){return this._modelInstanceCollection=this._modelInstanceCollection&&this._modelInstanceCollection.destroy(),this._batchTable=this._batchTable&&this._batchTable.destroy(),rl(this)};var V1=F1,H1=Object(E.a)({ADD:0,REPLACE:1}),G1={NEEDS_DECODE:0,DECODING:1,READY:2,FAILED:3};function q1(e){x.a.typeOf.object("options",e),x.a.typeOf.object("options.arrayBuffer",e.arrayBuffer),this._parsedContent=void 0,this._drawCommand=void 0,this._isTranslucent=!1,this._styleTranslucent=!1,this._constantColor=uf.clone(uf.DARKGRAY),this._highlightColor=uf.clone(uf.WHITE),this._pointSize=1,this._rtcCenter=void 0,this._quantizedVolumeScale=void 0,this._quantizedVolumeOffset=void 0,this._styleableShaderAttributes=void 0,this._isQuantized=!1,this._isOctEncoded16P=!1,this._isRGB565=!1,this._hasColors=!1,this._hasNormals=!1,this._hasBatchIds=!1,this._decodingState=G1.READY,this._dequantizeInShader=!0,this._isQuantizedDraco=!1,this._isOctEncodedDraco=!1,this._quantizedRange=0,this._octEncodedRange=0,this.backFaceCulling=!1,this._backFaceCulling=!1,this.normalShading=!0,this._normalShading=!0,this._opaqueRenderState=void 0,this._translucentRenderState=void 0,this._mode=void 0,this._ready=!1,this._readyPromise=Oi.a.defer(),this._pointsLength=0,this._geometryByteLength=0,this._vertexShaderLoaded=e.vertexShaderLoaded,this._fragmentShaderLoaded=e.fragmentShaderLoaded,this._uniformMapLoaded=e.uniformMapLoaded,this._batchTableLoaded=e.batchTableLoaded,this._pickIdLoaded=e.pickIdLoaded,this._opaquePass=Object(w.a)(e.opaquePass,lM.OPAQUE),this._cull=Object(w.a)(e.cull,!0),this.style=void 0,this._style=void 0,this.styleDirty=!1,this.modelMatrix=Be.clone(Be.IDENTITY),this._modelMatrix=Be.clone(Be.IDENTITY),this.time=0,this.shadows=rM.ENABLED,this._boundingSphere=void 0,this.clippingPlanes=void 0,this.isClipped=!1,this.clippingPlanesDirty=!1,this.clippingPlanesOriginMatrix=void 0,this.attenuation=!1,this._attenuation=!1,this.geometricError=0,this.geometricErrorScale=1,this.maximumAttenuation=this._pointSize,function(e,t){var i=t.arrayBuffer,n=Object(w.a)(t.byteOffset,0),r=new Uint8Array(i),a=new DataView(i);n+=W1;var o=a.getUint32(n,!0);if(1!==o)throw new Ce.a("Only Point Cloud tile version 1 is supported.  Version "+o+" is not.");n+=W1,n+=W1;var s=a.getUint32(n,!0);if(0===s)throw new Ce.a("Feature table must have a byte length greater than zero");n+=W1;var c=a.getUint32(n,!0);n+=W1;var l=a.getUint32(n,!0);n+=W1;var h=a.getUint32(n,!0),d=is(r,n+=W1,s),f=JSON.parse(d);n+=s;var p,m,_=new Uint8Array(i,n,c);if(n+=c,l>0){var g=is(r,n,l);p=JSON.parse(g),n+=l,h>0&&(m=new Uint8Array(i,n,h),n+=h)}var v=new eZ(f,_),b=v.getGlobalProperty("POINTS_LENGTH");if(v.featuresLength=b,!Object(u.a)(b))throw new Ce.a("Feature table global property: POINTS_LENGTH must be defined");var y,O,x,E,T=v.getGlobalProperty("RTC_CENTER",dn.FLOAT,3);Object(u.a)(T)&&(e._rtcCenter=z.unpack(T));var C,S,A,P,I,D=!1,j=!1,M=!1,R=!1,L=!1,N=!1,F=!1,k=!1,B=Object(u.a)(f.extensions)?f.extensions["3DTILES_draco_point_compression"]:void 0,U=Object(u.a)(p)&&Object(u.a)(p.extensions)?p.extensions["3DTILES_draco_point_compression"]:void 0;Object(u.a)(U)&&(A=U.properties);if(Object(u.a)(B)){S=B.properties;var V=B.byteOffset,H=B.byteLength;if(!Object(u.a)(S)||!Object(u.a)(V)||!Object(u.a)(H))throw new Ce.a("Draco properties, byteOffset, and byteLength must be defined");C=Li(_,V,V+H),D=Object(u.a)(S.POSITION),j=Object(u.a)(S.RGB)||Object(u.a)(S.RGBA),M=Object(u.a)(S.NORMAL),R=Object(u.a)(S.BATCH_ID),N=Object(u.a)(S.RGBA),e._decodingState=G1.NEEDS_DECODE}Object(u.a)(C)&&(P={buffer:C,featureTableProperties:S,batchTableProperties:A,properties:Object(ff.a)(S,A),dequantizeInShader:e._dequantizeInShader});if(!D)if(Object(u.a)(f.POSITION))y=v.getPropertyArray("POSITION",dn.FLOAT,3),D=!0;else if(Object(u.a)(f.POSITION_QUANTIZED)){y=v.getPropertyArray("POSITION_QUANTIZED",dn.UNSIGNED_SHORT,3),L=!0,D=!0;var G=v.getGlobalProperty("QUANTIZED_VOLUME_SCALE",dn.FLOAT,3);if(!Object(u.a)(G))throw new Ce.a("Global property: QUANTIZED_VOLUME_SCALE must be defined for quantized positions.");e._quantizedVolumeScale=z.unpack(G),e._quantizedRange=65535;var q=v.getGlobalProperty("QUANTIZED_VOLUME_OFFSET",dn.FLOAT,3);if(!Object(u.a)(q))throw new Ce.a("Global property: QUANTIZED_VOLUME_OFFSET must be defined for quantized positions.");e._quantizedVolumeOffset=z.unpack(q)}j||(Object(u.a)(f.RGBA)?(O=v.getPropertyArray("RGBA",dn.UNSIGNED_BYTE,4),N=!0,j=!0):Object(u.a)(f.RGB)?(O=v.getPropertyArray("RGB",dn.UNSIGNED_BYTE,3),j=!0):Object(u.a)(f.RGB565)&&(O=v.getPropertyArray("RGB565",dn.UNSIGNED_SHORT,1),F=!0,j=!0));M||(Object(u.a)(f.NORMAL)?(x=v.getPropertyArray("NORMAL",dn.FLOAT,3),M=!0):Object(u.a)(f.NORMAL_OCT16P)&&(x=v.getPropertyArray("NORMAL_OCT16P",dn.UNSIGNED_BYTE,2),k=!0,M=!0));R||Object(u.a)(f.BATCH_ID)&&(E=v.getPropertyArray("BATCH_ID",dn.UNSIGNED_SHORT,1),R=!0);if(!D)throw new Ce.a("Either POSITION or POSITION_QUANTIZED must be defined.");if(Object(u.a)(f.CONSTANT_RGBA)){var W=v.getGlobalProperty("CONSTANT_RGBA",dn.UNSIGNED_BYTE,4);e._constantColor=uf.fromBytes(W[0],W[1],W[2],W[3],e._constantColor)}if(R){var Y=v.getGlobalProperty("BATCH_LENGTH");if(!Object(u.a)(Y))throw new Ce.a("Global property: BATCH_LENGTH must be defined when BATCH_ID is defined.");Object(u.a)(m)&&(m=new Uint8Array(m)),Object(u.a)(e._batchTableLoaded)&&e._batchTableLoaded(Y,p,m)}!R&&Object(u.a)(m)&&(I=ZX.getBinaryProperties(b,p,m));e._parsedContent={positions:y,colors:O,normals:x,batchIds:E,styleableProperties:I,draco:P},e._pointsLength=b,e._isQuantized=L,e._isOctEncoded16P=k,e._isRGB565=F,e._isTranslucent=N,e._hasColors=j,e._hasNormals=M,e._hasBatchIds=R}(this,e)}Object(O.a)(q1.prototype,{pointsLength:{get:function(){return this._pointsLength}},geometryByteLength:{get:function(){return this._geometryByteLength}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise.promise}},color:{get:function(){return uf.clone(this._highlightColor)},set:function(e){this._highlightColor=uf.clone(e,this._highlightColor)}},boundingSphere:{get:function(){if(Object(u.a)(this._drawCommand))return this._drawCommand.boundingVolume},set:function(e){this._boundingSphere=St.clone(e)}}});var W1=Uint32Array.BYTES_PER_ELEMENT;var Y1,X1=new z,Z1=new z,Q1=new z;function K1(e){for(var t=e.length/3,i=Math.min(t,20),n=function(e){if(!Object(u.a)(Y1)){I.setRandomNumberSeed(0),Y1=new Array(e);for(var t=0;t<e;++t)Y1[t]=I.nextRandomNumber()}return Y1}(20),r=Number.MAX_VALUE,a=-Number.MAX_VALUE,o=z.fromElements(r,r,r,X1),s=z.fromElements(a,a,a,Z1),c=0;c<i;++c){var l=Math.floor(n[c]*t),h=z.unpack(e,3*l,Q1);z.minimumByComponent(o,h,o),z.maximumByComponent(s,h,s)}var d=St.fromCornerPoints(o,s);return d.radius+=I.EPSILON2,d}function J1(e){var t=dn.fromTypedArray(e);return t===dn.INT||t===dn.UNSIGNED_INT||t===dn.DOUBLE?(Object(iE.a)("Cast pnts property to floats",'Point cloud property "'+name+'" will be casted to a float array because INT, UNSIGNED_INT, and DOUBLE are not valid WebGL vertex attribute types. Some precision may be lost.'),new Float32Array(e)):e}var $1=new Te,e2=new Te,t2=new uf,i2=0,n2=1,r2=2,a2=3,o2=4,s2=new Be;var c2=["POSITION","COLOR","NORMAL","POSITION_ABSOLUTE"];function l2(e,t){for(var i=/czm_tiles3d_style_(\w+)/g,n=i.exec(e);null!==n;){var r=n[1];-1===t.indexOf(r)&&t.push(r),n=i.exec(e)}}function u2(e,t){for(var i=e.numberOfAttributes,n=0;n<i;++n){var r=e.getAttribute(n);if(r.index===t)return r}}function h2(e){for(var t=c2.length,i=0;i<t;++i){var n=c2[i],r="czm_tiles3d_style_"+n,a=n.toLowerCase();e=e.replace(new RegExp(r+"(\\W)","g"),a+"$1")}return e.replace("()","(vec3 position, vec3 position_absolute, vec4 color, vec3 normal)")}function d2(e,t,i){var n,r,a,o,s,c,l=t.context,h=Object(u.a)(i),d=e._isQuantized,f=e._isQuantizedDraco,p=e._isOctEncoded16P,m=e._isOctEncodedDraco,_=e._isRGB565,g=e._isTranslucent,v=e._hasColors,b=e._hasNormals,y=e._hasBatchIds,O=e._backFaceCulling,x=e._normalShading,E=e._drawCommand.vertexArray,T=e.clippingPlanes,C=e._attenuation,S=g;if(h){var A={translucent:!1};o=i.getColorShaderFunction("getColorFromStyle","czm_tiles3d_style_",A),s=i.getShowShaderFunction("getShowFromStyle","czm_tiles3d_style_",A),c=i.getPointSizeShaderFunction("getPointSizeFromStyle","czm_tiles3d_style_",A),Object(u.a)(o)&&A.translucent&&(S=!0)}e._styleTranslucent=S;var P=Object(u.a)(o),I=Object(u.a)(s),D=Object(u.a)(c),j=e.isClipped,M=[];P&&(l2(o,M),o=h2(o)),I&&(l2(s,M),s=h2(s)),D&&(l2(c,M),c=h2(c));var R=M.indexOf("COLOR")>=0,L=M.indexOf("NORMAL")>=0,N=M.filter((function(e){return-1===c2.indexOf(e)}));if(L&&!b)throw new Ce.a("Style references the NORMAL semantic but the point cloud does not have normals");var F=e._styleableShaderAttributes;for(r in F)if(F.hasOwnProperty(r)){a=F[r];var k=N.indexOf(r)>=0;u2(E,a.location).enabled=k}var B=v&&(!P||R);v&&(u2(E,n2).enabled=B);var U=b&&(x||O||L);b&&(u2(E,r2).enabled=U);var V={a_position:i2};B&&(V.a_color=n2),U&&(V.a_normal=r2),y&&(V.a_batchId=a2);var H="",G=N.length;for(n=0;n<G;++n){if(a=F[r=N[n]],!Object(u.a)(a))throw new Ce.a('Style references a property "'+r+'" that does not exist or is not styleable.');var q=a.componentCount,W="czm_tiles3d_style_"+r;H+="attribute "+(1===q?"float":"vec"+q)+" "+W+"; \n",V[W]=a.location}!function(e,t){var i=t.context,n=e._isQuantized,r=e._isQuantizedDraco,a=e._isOctEncodedDraco,o={u_pointSizeAndTimeAndGeometricErrorAndDepthMultiplier:function(){var n=$1;if(n.x=e._attenuation?e.maximumAttenuation:e._pointSize,n.y=e.time,e._attenuation){var r,a=t.camera.frustum;r=t.mode===xF.SCENE2D||a instanceof hb?Number.POSITIVE_INFINITY:i.drawingBufferHeight/t.camera.frustum.sseDenominator,n.z=e.geometricError*e.geometricErrorScale,n.w=r}return n},u_highlightColor:function(){return e._highlightColor},u_constantColor:function(){return e._constantColor},u_clippingPlanes:function(){var t=e.clippingPlanes;return e.isClipped?t.texture:i.defaultTexture},u_clippingPlanesEdgeStyle:function(){var t=e.clippingPlanes;if(!Object(u.a)(t))return uf.TRANSPARENT;var i=uf.clone(t.edgeColor,t2);return i.alpha=t.edgeWidth,i},u_clippingPlanesMatrix:function(){var t=e.clippingPlanes;if(!Object(u.a)(t))return Be.IDENTITY;var n=Object(w.a)(e.clippingPlanesOriginMatrix,e._modelMatrix);return Be.multiply(i.uniformState.view3D,n,s2),Be.multiply(s2,t.modelMatrix,s2)}};(n||r||a)&&(o=Object(ff.a)(o,{u_quantizedVolumeScaleAndOctEncodedRange:function(){var t=e2;if(Object(u.a)(e._quantizedVolumeScale)){var i=z.clone(e._quantizedVolumeScale,t);z.divideByScalar(i,e._quantizedRange,t)}return t.w=e._octEncodedRange,t}})),Object(u.a)(e._uniformMapLoaded)&&(o=e._uniformMapLoaded(o)),e._drawCommand.uniformMap=o}(e,t);var Y="attribute vec3 a_position; \nvarying vec4 v_color; \nuniform vec4 u_pointSizeAndTimeAndGeometricErrorAndDepthMultiplier; \nuniform vec4 u_constantColor; \nuniform vec4 u_highlightColor; \n";Y+="float u_pointSize; \nfloat u_time; \n",C&&(Y+="float u_geometricError; \nfloat u_depthMultiplier; \n"),Y+=H,B&&(Y+=g?"attribute vec4 a_color; \n":_?"attribute float a_color; \nconst float SHIFT_RIGHT_11 = 1.0 / 2048.0; \nconst float SHIFT_RIGHT_5 = 1.0 / 32.0; \nconst float SHIFT_LEFT_11 = 2048.0; \nconst float SHIFT_LEFT_5 = 32.0; \nconst float NORMALIZE_6 = 1.0 / 64.0; \nconst float NORMALIZE_5 = 1.0 / 32.0; \n":"attribute vec3 a_color; \n"),U&&(Y+=p||m?"attribute vec2 a_normal; \n":"attribute vec3 a_normal; \n"),y&&(Y+="attribute float a_batchId; \n"),(d||f||m)&&(Y+="uniform vec4 u_quantizedVolumeScaleAndOctEncodedRange; \n"),P&&(Y+=o),I&&(Y+=s),D&&(Y+=c),Y+="void main() \n{ \n    u_pointSize = u_pointSizeAndTimeAndGeometricErrorAndDepthMultiplier.x; \n    u_time = u_pointSizeAndTimeAndGeometricErrorAndDepthMultiplier.y; \n",C&&(Y+="    u_geometricError = u_pointSizeAndTimeAndGeometricErrorAndDepthMultiplier.z; \n    u_depthMultiplier = u_pointSizeAndTimeAndGeometricErrorAndDepthMultiplier.w; \n"),Y+=B?g?"    vec4 color = a_color; \n":_?"    float compressed = a_color; \n    float r = floor(compressed * SHIFT_RIGHT_11); \n    compressed -= r * SHIFT_LEFT_11; \n    float g = floor(compressed * SHIFT_RIGHT_5); \n    compressed -= g * SHIFT_LEFT_5; \n    float b = compressed; \n    vec3 rgb = vec3(r * NORMALIZE_5, g * NORMALIZE_6, b * NORMALIZE_5); \n    vec4 color = vec4(rgb, 1.0); \n":"    vec4 color = vec4(a_color, 1.0); \n":"    vec4 color = u_constantColor; \n",Y+=d||f?"    vec3 position = a_position * u_quantizedVolumeScaleAndOctEncodedRange.xyz; \n":"    vec3 position = a_position; \n",Y+="    vec3 position_absolute = vec3(czm_model * vec4(position, 1.0)); \n",Y+=U?p?"    vec3 normal = czm_octDecode(a_normal); \n":m?"    vec3 normal = czm_octDecode(a_normal, u_quantizedVolumeScaleAndOctEncodedRange.w).zxy; \n":"    vec3 normal = a_normal; \n":"    vec3 normal = vec3(1.0); \n",P&&(Y+="    color = getColorFromStyle(position, position_absolute, color, normal); \n"),I&&(Y+="    float show = float(getShowFromStyle(position, position_absolute, color, normal)); \n"),Y+=D?"    gl_PointSize = getPointSizeFromStyle(position, position_absolute, color, normal); \n":C?"    vec4 positionEC = czm_modelView * vec4(position, 1.0); \n    float depth = -positionEC.z; \n    gl_PointSize = min((u_geometricError / depth) * u_depthMultiplier, u_pointSize); \n":"    gl_PointSize = u_pointSize; \n",Y+="    color = color * u_highlightColor; \n",U&&x&&(Y+="    normal = czm_normal * normal; \n    float diffuseStrength = czm_getLambertDiffuse(czm_sunDirectionEC, normal); \n    diffuseStrength = max(diffuseStrength, 0.4); \n    color.xyz *= diffuseStrength; \n"),Y+="    v_color = color; \n    gl_Position = czm_modelViewProjection * vec4(position, 1.0); \n",U&&O&&(Y+="    float visible = step(-normal.z, 0.0); \n    gl_Position *= visible; \n    gl_PointSize *= visible; \n"),I&&(Y+="    gl_Position *= show; \n    gl_PointSize *= show; \n"),Y+="} \n";var X="varying vec4 v_color; \n";j&&(X+="uniform sampler2D u_clippingPlanes; \nuniform mat4 u_clippingPlanesMatrix; \nuniform vec4 u_clippingPlanesEdgeStyle; \n",X+="\n",X+=_J(T,l),X+="\n"),X+="void main() \n{ \n    gl_FragColor = czm_gammaCorrect(v_color); \n",j&&(X+=pJ("u_clippingPlanes","u_clippingPlanesMatrix","u_clippingPlanesEdgeStyle")),X+="} \n",Object(u.a)(e._vertexShaderLoaded)&&(Y=e._vertexShaderLoaded(Y)),Object(u.a)(e._fragmentShaderLoaded)&&(X=e._fragmentShaderLoaded(X));var Z=e._drawCommand;Object(u.a)(Z.shaderProgram)&&Z.shaderProgram.destroy(),Z.shaderProgram=bR.fromCache({context:l,vertexShaderSource:Y,fragmentShaderSource:X,attributeLocations:V});try{Z.shaderProgram._bind()}catch(e){throw new Ce.a("Error generating style shader: this may be caused by a type mismatch, index out-of-bounds, or other syntax error.")}}var f2=new Te,p2=new z;q1.prototype.update=function(e){if(!function(e,t){if(e._decodingState===G1.READY)return!1;if(e._decodingState===G1.NEEDS_DECODE){var i=e._parsedContent,n=i.draco,r=fJ.decodePointCloud(n,t);Object(u.a)(r)&&(e._decodingState=G1.DECODING,r.then((function(t){e._decodingState=G1.READY;var r=Object(u.a)(t.POSITION)?t.POSITION.array:void 0,a=Object(u.a)(t.RGB)?t.RGB.array:void 0,o=Object(u.a)(t.RGBA)?t.RGBA.array:void 0,s=Object(u.a)(t.NORMAL)?t.NORMAL.array:void 0,c=Object(u.a)(t.BATCH_ID)?t.BATCH_ID.array:void 0,l=Object(u.a)(r)&&Object(u.a)(t.POSITION.data.quantization),h=Object(u.a)(s)&&Object(u.a)(t.NORMAL.data.quantization);if(l){var d=t.POSITION.data.quantization,f=d.range;e._quantizedVolumeScale=z.fromElements(f,f,f),e._quantizedVolumeOffset=z.unpack(d.minValues),e._quantizedRange=(1<<d.quantizationBits)-1,e._isQuantizedDraco=!0}h&&(e._octEncodedRange=(1<<t.NORMAL.data.quantization.quantizationBits)-1,e._isOctEncodedDraco=!0);var p=i.styleableProperties,m=n.batchTableProperties;for(var _ in m)if(m.hasOwnProperty(_)){var g=t[_];Object(u.a)(p)||(p={}),p[_]={typedArray:g.array,componentCount:g.data.componentsPerAttribute}}i.positions=Object(w.a)(r,i.positions),i.colors=Object(w.a)(Object(w.a)(o,a),i.colors),i.normals=Object(w.a)(s,i.normals),i.batchIds=Object(w.a)(c,i.batchIds),i.styleableProperties=p})).otherwise((function(t){e._decodingState=G1.FAILED,e._readyPromise.reject(t)})))}return!0}(this,e.context)){var t=!1,i=!Be.equals(this._modelMatrix,this.modelMatrix);if(this._mode!==e.mode&&(this._mode=e.mode,i=!0),Object(u.a)(this._drawCommand)||(!function(e,t){var i,n,r=t.context,a=e._parsedContent,o=e._pointsLength,s=a.positions,c=a.colors,l=a.normals,h=a.batchIds,d=a.styleableProperties,f=Object(u.a)(d),p=e._isQuantized,m=e._isQuantizedDraco,_=e._isOctEncoded16P,g=e._isOctEncodedDraco,v=e._quantizedRange,b=e._octEncodedRange,y=e._isRGB565,w=e._isTranslucent,O=e._hasColors,x=e._hasNormals,E=e._hasBatchIds,T=[],C={};if(e._styleableShaderAttributes=C,f){var S=o2;for(var A in d)if(d.hasOwnProperty(A)){var P=d[A],I=J1(P.typedArray);i=P.componentCount,n=dn.fromTypedArray(I);var D=ZN.createVertexBuffer({context:r,typedArray:I,usage:YN.STATIC_DRAW});e._geometryByteLength+=D.sizeInBytes;var j={index:S,vertexBuffer:D,componentsPerAttribute:i,componentDatatype:n,normalize:!1,offsetInBytes:0,strideInBytes:0};T.push(j),C[A]={location:S,componentCount:i},++S}}var M,R,L,N=ZN.createVertexBuffer({context:r,typedArray:s,usage:YN.STATIC_DRAW});e._geometryByteLength+=N.sizeInBytes,O&&(M=ZN.createVertexBuffer({context:r,typedArray:c,usage:YN.STATIC_DRAW}),e._geometryByteLength+=M.sizeInBytes),x&&(R=ZN.createVertexBuffer({context:r,typedArray:l,usage:YN.STATIC_DRAW}),e._geometryByteLength+=R.sizeInBytes),E&&(h=J1(h),L=ZN.createVertexBuffer({context:r,typedArray:h,usage:YN.STATIC_DRAW}),e._geometryByteLength+=L.sizeInBytes);var F=[];if(n=p?dn.UNSIGNED_SHORT:m?v<=255?dn.UNSIGNED_BYTE:dn.UNSIGNED_SHORT:dn.FLOAT,F.push({index:i2,vertexBuffer:N,componentsPerAttribute:3,componentDatatype:n,normalize:!1,offsetInBytes:0,strideInBytes:0}),e._cull&&(e._boundingSphere=p||m?St.fromCornerPoints(z.ZERO,e._quantizedVolumeScale):K1(s)),O)if(y)F.push({index:n2,vertexBuffer:M,componentsPerAttribute:1,componentDatatype:dn.UNSIGNED_SHORT,normalize:!1,offsetInBytes:0,strideInBytes:0});else{var k=w?4:3;F.push({index:n2,vertexBuffer:M,componentsPerAttribute:k,componentDatatype:dn.UNSIGNED_BYTE,normalize:!0,offsetInBytes:0,strideInBytes:0})}x&&(_?(i=2,n=dn.UNSIGNED_BYTE):g?(i=2,n=b<=255?dn.UNSIGNED_BYTE:dn.UNSIGNED_SHORT):(i=3,n=dn.FLOAT),F.push({index:r2,vertexBuffer:R,componentsPerAttribute:i,componentDatatype:n,normalize:!1,offsetInBytes:0,strideInBytes:0})),E&&F.push({index:a2,vertexBuffer:L,componentsPerAttribute:1,componentDatatype:dn.fromTypedArray(h),normalize:!1,offsetInBytes:0,strideInBytes:0}),f&&(F=F.concat(T));var B=new tF({context:r,attributes:F}),U={depthTest:{enabled:!0}};e._opaquePass===lM.CESIUM_3D_TILE&&(U.stencilTest=Hk.setCesium3DTileBit(),U.stencilMask=Hk.CESIUM_3D_TILE_MASK),e._opaqueRenderState=RM.fromCache(U),e._translucentRenderState=RM.fromCache({depthTest:{enabled:!0},depthMask:!1,blending:FD.ALPHA_BLEND}),e._drawCommand=new cM({boundingVolume:new St,cull:e._cull,modelMatrix:new Be,primitiveType:yn.POINTS,vertexArray:B,count:o,shaderProgram:void 0,uniformMap:void 0,renderState:w?e._translucentRenderState:e._opaqueRenderState,pass:w?lM.TRANSLUCENT:e._opaquePass,owner:e,castShadows:!1,receiveShadows:!1,pickId:e._pickIdLoaded()})}(this,e),i=!0,t=!0,this._ready=!0,this._readyPromise.resolve(this),this._parsedContent=void 0),i){Be.clone(this.modelMatrix,this._modelMatrix);var n=this._drawCommand.modelMatrix;if(Be.clone(this._modelMatrix,n),Object(u.a)(this._rtcCenter)&&Be.multiplyByTranslation(n,this._rtcCenter,n),Object(u.a)(this._quantizedVolumeOffset)&&Be.multiplyByTranslation(n,this._quantizedVolumeOffset,n),e.mode!==xF.SCENE3D){var r=e.mapProjection,a=Be.getColumn(n,3,f2);Te.equals(a,Te.UNIT_W)||xa.basisTo2D(r,n,n)}var o=this._drawCommand.boundingVolume;if(St.clone(this._boundingSphere,o),this._cull){var s=o.center;Be.multiplyByPoint(n,s,s);var c=Be.getScale(n,p2);o.radius*=z.maximumComponent(c)}}this.clippingPlanesDirty&&(this.clippingPlanesDirty=!1,t=!0),this._attenuation!==this.attenuation&&(this._attenuation=this.attenuation,t=!0),this.backFaceCulling!==this._backFaceCulling&&(this._backFaceCulling=this.backFaceCulling,t=!0),this.normalShading!==this._normalShading&&(this._normalShading=this.normalShading,t=!0),(this._style!==this.style||this.styleDirty)&&(this._style=this.style,this.styleDirty=!1,t=!0),t&&d2(this,e,this._style),this._drawCommand.castShadows=rM.castShadows(this.shadows),this._drawCommand.receiveShadows=rM.receiveShadows(this.shadows);var l=this._highlightColor.alpha<1||this._constantColor.alpha<1||this._styleTranslucent;this._drawCommand.renderState=l?this._translucentRenderState:this._opaqueRenderState,this._drawCommand.pass=l?lM.TRANSLUCENT:this._opaquePass;var h=e.commandList,d=e.passes;(d.render||d.pick)&&h.push(this._drawCommand)}},q1.prototype.isDestroyed=function(){return!1},q1.prototype.destroy=function(){var e=this._drawCommand;return Object(u.a)(e)&&(e.vertexArray=e.vertexArray&&e.vertexArray.destroy(),e.shaderProgram=e.shaderProgram&&e.shaderProgram.destroy()),rl(this)};var m2=q1;function _2(e,t,i,n,r){var a;this._tileset=e,this._tile=t,this._resource=i,this._pickId=void 0,this._batchTable=void 0,this._styleDirty=!1,this._features=void 0,this.featurePropertiesDirty=!1,this._pointCloud=new m2({arrayBuffer:n,byteOffset:r,cull:!1,opaquePass:lM.CESIUM_3D_TILE,vertexShaderLoaded:(a=this,function(e){return Object(u.a)(a._batchTable)?a._batchTable.getVertexShaderCallback(!1,"a_batchId",void 0)(e):e}),fragmentShaderLoaded:g2(this),uniformMapLoaded:v2(this),batchTableLoaded:b2(this),pickIdLoaded:y2(this)})}function g2(e){return function(t){return Object(u.a)(e._batchTable)?e._batchTable.getFragmentShaderCallback(!1,void 0)(t):"uniform vec4 czm_pickColor;\n"+t}}function v2(e){return function(t){return Object(u.a)(e._batchTable)?e._batchTable.getUniformMapCallback()(t):Object(ff.a)(t,{czm_pickColor:function(){return e._pickId.color}})}}function b2(e){return function(t,i,n){e._batchTable=new ZX(e,t,i,n)}}function y2(e){return function(){return Object(u.a)(e._batchTable)?e._batchTable.getPickId():"czm_pickColor"}}Object(O.a)(_2.prototype,{featuresLength:{get:function(){return Object(u.a)(this._batchTable)?this._batchTable.featuresLength:0}},pointsLength:{get:function(){return this._pointCloud.pointsLength}},trianglesLength:{get:function(){return 0}},geometryByteLength:{get:function(){return this._pointCloud.geometryByteLength}},texturesByteLength:{get:function(){return 0}},batchTableByteLength:{get:function(){return Object(u.a)(this._batchTable)?this._batchTable.memorySizeInBytes:0}},innerContents:{get:function(){}},readyPromise:{get:function(){return this._pointCloud.readyPromise}},tileset:{get:function(){return this._tileset}},tile:{get:function(){return this._tile}},url:{get:function(){return this._resource.getUrlComponent(!0)}},batchTable:{get:function(){return this._batchTable}}}),_2.prototype.hasProperty=function(e,t){return!!Object(u.a)(this._batchTable)&&this._batchTable.hasProperty(e,t)},_2.prototype.getFeature=function(e){if(Object(u.a)(this._batchTable)){var t=this.featuresLength;if(!Object(u.a)(e)||e<0||e>=t)throw new h.a("batchId is required and between zero and featuresLength - 1 ("+(t-1)+").");return function(e){var t=e.featuresLength;if(!Object(u.a)(e._features)&&t>0){for(var i=new Array(t),n=0;n<t;++n)i[n]=new KX(e,n);e._features=i}}(this),this._features[e]}},_2.prototype.applyDebugSettings=function(e,t){this._pointCloud.color=e?t:uf.WHITE},_2.prototype.applyStyle=function(e){Object(u.a)(this._batchTable)?this._batchTable.applyStyle(e):this._styleDirty=!0},_2.prototype.update=function(e,t){var i,n=this._pointCloud,r=e.pointCloudShading,a=this._tile,o=this._batchTable,s=t.mode,c=e.clippingPlanes;Object(u.a)(this._pickId)||Object(u.a)(o)||(this._pickId=t.context.createPickId({primitive:e,content:this})),Object(u.a)(o)&&o.update(e,t),i=Object(u.a)(a._contentBoundingVolume)?s===xF.SCENE3D?a._contentBoundingVolume.boundingSphere:a._contentBoundingVolume2D.boundingSphere:s===xF.SCENE3D?a._boundingVolume.boundingSphere:a._boundingVolume2D.boundingSphere;var l=this._styleDirty;this._styleDirty=!1,n.clippingPlanesOriginMatrix=e.clippingPlanesOriginMatrix,n.style=Object(u.a)(o)?void 0:e.style,n.styleDirty=l,n.modelMatrix=a.computedTransform,n.time=e.timeSinceLoad,n.shadows=e.shadows,n.boundingSphere=i,n.clippingPlanes=c,n.isClipped=Object(u.a)(c)&&c.enabled&&a._isClipped,n.clippingPlanesDirty=a.clippingPlanesDirty,n.attenuation=!!Object(u.a)(r)&&r.attenuation,n.geometricError=function(e){var t=e._tileset.pointCloudShading,i=e._tile.contentBoundingVolume.boundingSphere.volume(),n=I.cbrt(i/e.pointsLength),r=e._tile.geometricError;return 0===r&&(r=Object(u.a)(t)&&Object(u.a)(t.baseResolution)?t.baseResolution:n),r}(this),n.geometricErrorScale=Object(u.a)(r)?r.geometricErrorScale:1,Object(u.a)(r)&&Object(u.a)(r.maximumAttenuation)?n.maximumAttenuation=r.maximumAttenuation:a.refine===H1.ADD?n.maximumAttenuation=5:n.maximumAttenuation=e.maximumScreenSpaceError,n.update(t)},_2.prototype.isDestroyed=function(){return!1},_2.prototype.destroy=function(){return this._pickId=this._pickId&&this._pickId.destroy(),this._pointCloud=this._pointCloud&&this._pointCloud.destroy(),this._batchTable=this._batchTable&&this._batchTable.destroy(),rl(this)};var w2=_2;function O2(e,t,i,n,r){this._tileset=e,this._tile=t,this._resource=i,this._readyPromise=Oi.a.defer(),this.featurePropertiesDirty=!1,function(e,t,i){i=Object(w.a)(i,0);var n,r=new Uint8Array(t),a=is(r,i);try{n=JSON.parse(a)}catch(t){return void e._readyPromise.reject(new Ce.a("Invalid tile content."))}e._tileset.loadTileset(e._resource,n,e._tile),e._readyPromise.resolve(e)}(this,n,r)}Object(O.a)(O2.prototype,{featuresLength:{get:function(){return 0}},pointsLength:{get:function(){return 0}},trianglesLength:{get:function(){return 0}},geometryByteLength:{get:function(){return 0}},texturesByteLength:{get:function(){return 0}},batchTableByteLength:{get:function(){return 0}},innerContents:{get:function(){}},readyPromise:{get:function(){return this._readyPromise.promise}},tileset:{get:function(){return this._tileset}},tile:{get:function(){return this._tile}},url:{get:function(){return this._resource.getUrlComponent(!0)}},batchTable:{get:function(){}}}),O2.prototype.hasProperty=function(e,t){return!1},O2.prototype.getFeature=function(e){},O2.prototype.applyDebugSettings=function(e,t){},O2.prototype.applyStyle=function(e){},O2.prototype.update=function(e,t){},O2.prototype.isDestroyed=function(){return!1},O2.prototype.destroy=function(){return rl(this)};var x2=O2;var E2=function(e,t,i,n,r){return function(){var a=document.createElement("canvas"),o=r+2*n;a.height=a.width=o;var s=a.getContext("2d");return s.clearRect(0,0,o,o),0!==n&&(s.beginPath(),s.arc(o/2,o/2,o/2,0,2*Math.PI,!0),s.closePath(),s.fillStyle=i,s.fill(),e<1&&(s.save(),s.globalCompositeOperation="destination-out",s.beginPath(),s.arc(o/2,o/2,r/2,0,2*Math.PI,!0),s.closePath(),s.fillStyle="black",s.fill(),s.restore())),s.beginPath(),s.arc(o/2,o/2,r/2,0,2*Math.PI,!0),s.closePath(),s.fillStyle=t,s.fill(),a}};function T2(e,t,i,n,r){this._content=e,this._billboard=i,this._label=n,this._polyline=r,this._batchId=t,this._billboardImage=void 0,this._billboardColor=void 0,this._billboardOutlineColor=void 0,this._billboardOutlineWidth=void 0,this._billboardSize=void 0,this._pointSize=void 0,this._color=void 0,this._pointSize=void 0,this._pointOutlineColor=void 0,this._pointOutlineWidth=void 0,this._heightOffset=void 0,this._pickIds=new Array(3),S2(this)}var C2=new K;function S2(e){var t=e._billboard;if(Object(u.a)(e._billboardImage)&&e._billboardImage!==t.image)t.image=e._billboardImage;else if(!Object(u.a)(e._billboardImage)){var i=Object(w.a)(e._color,T2.defaultColor),n=Object(w.a)(e._pointOutlineColor,T2.defaultPointOutlineColor),r=Object(w.a)(e._pointOutlineWidth,T2.defaultPointOutlineWidth),a=Object(w.a)(e._pointSize,T2.defaultPointSize),o=e._billboardColor,s=e._billboardOutlineColor,c=e._billboardOutlineWidth,l=e._billboardSize;if(!uf.equals(i,o)||!uf.equals(n,s)||r!==c||a!==l){e._billboardColor=uf.clone(i,e._billboardColor),e._billboardOutlineColor=uf.clone(n,e._billboardOutlineColor),e._billboardOutlineWidth=r,e._billboardSize=a;var h=i.alpha,d=i.toCssColorString(),f=n.toCssColorString(),p=JSON.stringify([d,a,f,r]);t.setImage(p,E2(h,d,f,r,a))}}}Object(O.a)(T2.prototype,{show:{get:function(){return this._label.show},set:function(e){this._label.show=e,this._billboard.show=e,this._polyline.show=e}},color:{get:function(){return this._color},set:function(e){this._color=uf.clone(e,this._color),S2(this)}},pointSize:{get:function(){return this._pointSize},set:function(e){this._pointSize=e,S2(this)}},pointOutlineColor:{get:function(){return this._pointOutlineColor},set:function(e){this._pointOutlineColor=uf.clone(e,this._pointOutlineColor),S2(this)}},pointOutlineWidth:{get:function(){return this._pointOutlineWidth},set:function(e){this._pointOutlineWidth=e,S2(this)}},labelColor:{get:function(){return this._label.fillColor},set:function(e){this._label.fillColor=e,this._polyline.show=this._label.show&&e.alpha>0}},labelOutlineColor:{get:function(){return this._label.outlineColor},set:function(e){this._label.outlineColor=e}},labelOutlineWidth:{get:function(){return this._label.outlineWidth},set:function(e){this._label.outlineWidth=e}},font:{get:function(){return this._label.font},set:function(e){this._label.font=e}},labelStyle:{get:function(){return this._label.style},set:function(e){this._label.style=e}},labelText:{get:function(){return this._label.text},set:function(e){Object(u.a)(e)||(e=""),this._label.text=e}},backgroundColor:{get:function(){return this._label.backgroundColor},set:function(e){this._label.backgroundColor=e}},backgroundPadding:{get:function(){return this._label.backgroundPadding},set:function(e){this._label.backgroundPadding=e}},backgroundEnabled:{get:function(){return this._label.showBackground},set:function(e){this._label.showBackground=e}},scaleByDistance:{get:function(){return this._label.scaleByDistance},set:function(e){this._label.scaleByDistance=e,this._billboard.scaleByDistance=e}},translucencyByDistance:{get:function(){return this._label.translucencyByDistance},set:function(e){this._label.translucencyByDistance=e,this._billboard.translucencyByDistance=e}},distanceDisplayCondition:{get:function(){return this._label.distanceDisplayCondition},set:function(e){this._label.distanceDisplayCondition=e,this._polyline.distanceDisplayCondition=e,this._billboard.distanceDisplayCondition=e}},heightOffset:{get:function(){return this._heightOffset},set:function(e){var t=Object(w.a)(this._heightOffset,0),i=this._content.tileset.ellipsoid,n=i.cartesianToCartographic(this._billboard.position,C2);n.height=n.height-t+e;var r=i.cartographicToCartesian(n);this._billboard.position=r,this._label.position=this._billboard.position,this._polyline.positions=[this._polyline.positions[0],r],this._heightOffset=e}},anchorLineEnabled:{get:function(){return this._polyline.show},set:function(e){this._polyline.show=e}},anchorLineColor:{get:function(){return this._polyline.material.uniforms.color},set:function(e){this._polyline.material.uniforms.color=e}},image:{get:function(){return this._billboardImage},set:function(e){var t=this._billboardImage!==e;this._billboardImage=e,t&&S2(this)}},disableDepthTestDistance:{get:function(){return this._label.disableDepthTestDistance},set:function(e){this._label.disableDepthTestDistance=e,this._billboard.disableDepthTestDistance=e}},horizontalOrigin:{get:function(){return this._billboard.horizontalOrigin},set:function(e){this._billboard.horizontalOrigin=e}},verticalOrigin:{get:function(){return this._billboard.verticalOrigin},set:function(e){this._billboard.verticalOrigin=e}},labelHorizontalOrigin:{get:function(){return this._label.horizontalOrigin},set:function(e){this._label.horizontalOrigin=e}},labelVerticalOrigin:{get:function(){return this._label.verticalOrigin},set:function(e){this._label.verticalOrigin=e}},content:{get:function(){return this._content}},tileset:{get:function(){return this._content.tileset}},primitive:{get:function(){return this._content.tileset}},pickIds:{get:function(){var e=this._pickIds;return e[0]=this._billboard.pickId,e[1]=this._label.pickId,e[2]=this._polyline.pickId,e}}}),T2.defaultColor=uf.WHITE,T2.defaultPointOutlineColor=uf.BLACK,T2.defaultPointOutlineWidth=0,T2.defaultPointSize=8,T2.prototype.hasProperty=function(e){return this._content.batchTable.hasProperty(this._batchId,e)},T2.prototype.getPropertyNames=function(e){return this._content.batchTable.getPropertyNames(this._batchId,e)},T2.prototype.getProperty=function(e){return this._content.batchTable.getProperty(this._batchId,e)},T2.prototype.setProperty=function(e,t){this._content.batchTable.setProperty(this._batchId,e,t),this._content.featurePropertiesDirty=!0},T2.prototype.isExactClass=function(e){return this._content.batchTable.isExactClass(this._batchId,e)},T2.prototype.isClass=function(e){return this._content.batchTable.isClass(this._batchId,e)},T2.prototype.getExactClassName=function(){return this._content.batchTable.getExactClassName(this._batchId)};var A2=T2,P2="attribute vec3 position3DHigh;\nattribute vec3 position3DLow;\nattribute vec3 position2DHigh;\nattribute vec3 position2DLow;\nattribute vec3 prevPosition3DHigh;\nattribute vec3 prevPosition3DLow;\nattribute vec3 prevPosition2DHigh;\nattribute vec3 prevPosition2DLow;\nattribute vec3 nextPosition3DHigh;\nattribute vec3 nextPosition3DLow;\nattribute vec3 nextPosition2DHigh;\nattribute vec3 nextPosition2DLow;\nattribute vec4 texCoordExpandAndBatchIndex;\nvarying vec2  v_st;\nvarying float v_width;\nvarying vec4 v_pickColor;\nvarying float v_polylineAngle;\nvoid main()\n{\nfloat texCoord = texCoordExpandAndBatchIndex.x;\nfloat expandDir = texCoordExpandAndBatchIndex.y;\nbool usePrev = texCoordExpandAndBatchIndex.z < 0.0;\nfloat batchTableIndex = texCoordExpandAndBatchIndex.w;\nvec2 widthAndShow = batchTable_getWidthAndShow(batchTableIndex);\nfloat width = widthAndShow.x + 0.5;\nfloat show = widthAndShow.y;\nif (width < 1.0)\n{\nshow = 0.0;\n}\nvec4 pickColor = batchTable_getPickColor(batchTableIndex);\nvec4 p, prev, next;\nif (czm_morphTime == 1.0)\n{\np = czm_translateRelativeToEye(position3DHigh.xyz, position3DLow.xyz);\nprev = czm_translateRelativeToEye(prevPosition3DHigh.xyz, prevPosition3DLow.xyz);\nnext = czm_translateRelativeToEye(nextPosition3DHigh.xyz, nextPosition3DLow.xyz);\n}\nelse if (czm_morphTime == 0.0)\n{\np = czm_translateRelativeToEye(position2DHigh.zxy, position2DLow.zxy);\nprev = czm_translateRelativeToEye(prevPosition2DHigh.zxy, prevPosition2DLow.zxy);\nnext = czm_translateRelativeToEye(nextPosition2DHigh.zxy, nextPosition2DLow.zxy);\n}\nelse\n{\np = czm_columbusViewMorph(\nczm_translateRelativeToEye(position2DHigh.zxy, position2DLow.zxy),\nczm_translateRelativeToEye(position3DHigh.xyz, position3DLow.xyz),\nczm_morphTime);\nprev = czm_columbusViewMorph(\nczm_translateRelativeToEye(prevPosition2DHigh.zxy, prevPosition2DLow.zxy),\nczm_translateRelativeToEye(prevPosition3DHigh.xyz, prevPosition3DLow.xyz),\nczm_morphTime);\nnext = czm_columbusViewMorph(\nczm_translateRelativeToEye(nextPosition2DHigh.zxy, nextPosition2DLow.zxy),\nczm_translateRelativeToEye(nextPosition3DHigh.xyz, nextPosition3DLow.xyz),\nczm_morphTime);\n}\n#ifdef DISTANCE_DISPLAY_CONDITION\nvec3 centerHigh = batchTable_getCenterHigh(batchTableIndex);\nvec4 centerLowAndRadius = batchTable_getCenterLowAndRadius(batchTableIndex);\nvec3 centerLow = centerLowAndRadius.xyz;\nfloat radius = centerLowAndRadius.w;\nvec2 distanceDisplayCondition = batchTable_getDistanceDisplayCondition(batchTableIndex);\nfloat lengthSq;\nif (czm_sceneMode == czm_sceneMode2D)\n{\nlengthSq = czm_eyeHeight2D.y;\n}\nelse\n{\nvec4 center = czm_translateRelativeToEye(centerHigh.xyz, centerLow.xyz);\nlengthSq = max(0.0, dot(center.xyz, center.xyz) - radius * radius);\n}\nfloat nearSq = distanceDisplayCondition.x * distanceDisplayCondition.x;\nfloat farSq = distanceDisplayCondition.y * distanceDisplayCondition.y;\nif (lengthSq < nearSq || lengthSq > farSq)\n{\nshow = 0.0;\n}\n#endif\nvec4 positionWC = getPolylineWindowCoordinates(p, prev, next, expandDir, width, usePrev, v_polylineAngle);\ngl_Position = czm_viewportOrthographic * positionWC * show;\nv_st = vec2(texCoord, clamp(expandDir, 0.0, 1.0));\nv_width = width;\nv_pickColor = pickColor;\n#ifdef LOG_DEPTH\nczm_vertexLogDepth(czm_modelViewProjectionRelativeToEye * p);\n#endif\n}\n";function I2(e,t){e=Object(w.a)(e,w.a.EMPTY_OBJECT),this._show=Object(w.a)(e.show,!0),this._width=Object(w.a)(e.width,1),this._loop=Object(w.a)(e.loop,!1),this._distanceDisplayCondition=e.distanceDisplayCondition,this._material=e.material,Object(u.a)(this._material)||(this._material=qj.fromType(qj.ColorType,{color:new uf(1,1,1,1)}));var i,n=e.positions;Object(u.a)(n)||(n=[]),this._positions=n,this._actualPositions=$t(n,z.equalsEpsilon),this._loop&&this._actualPositions.length>2&&(this._actualPositions===this._positions&&(this._actualPositions=n.slice()),this._actualPositions.push(z.clone(this._actualPositions[0]))),this._length=this._actualPositions.length,this._id=e.id,Object(u.a)(t)&&(i=Be.clone(t.modelMatrix)),this._modelMatrix=i,this._segments=Gm.wrapLongitude(this._actualPositions,i),this._actualLength=void 0,this._propertiesChanged=new Uint32Array(F2),this._polylineCollection=t,this._dirty=!1,this._pickId=void 0,this._boundingVolume=St.fromPoints(this._actualPositions),this._boundingVolumeWC=St.transform(this._boundingVolume,this._modelMatrix),this._boundingVolume2D=new St}var D2=I2.POSITION_INDEX=0,j2=I2.SHOW_INDEX=1,M2=I2.WIDTH_INDEX=2,R2=I2.MATERIAL_INDEX=3,L2=I2.POSITION_SIZE_INDEX=4,N2=I2.DISTANCE_DISPLAY_CONDITION=5,F2=I2.NUMBER_OF_PROPERTIES=6;function k2(e,t){++e._propertiesChanged[t];var i=e._polylineCollection;Object(u.a)(i)&&(i._updatePolyline(e,t),e._dirty=!0)}Object(O.a)(I2.prototype,{show:{get:function(){return this._show},set:function(e){if(!Object(u.a)(e))throw new h.a("value is required.");e!==this._show&&(this._show=e,k2(this,j2))}},positions:{get:function(){return this._positions},set:function(e){if(!Object(u.a)(e))throw new h.a("value is required.");var t=$t(e,z.equalsEpsilon);this._loop&&t.length>2&&(t===e&&(t=e.slice()),t.push(z.clone(t[0]))),this._actualPositions.length===t.length&&this._actualPositions.length===this._length||k2(this,L2),this._positions=e,this._actualPositions=t,this._length=t.length,this._boundingVolume=St.fromPoints(this._actualPositions,this._boundingVolume),this._boundingVolumeWC=St.transform(this._boundingVolume,this._modelMatrix,this._boundingVolumeWC),k2(this,D2),this.update()}},material:{get:function(){return this._material},set:function(e){if(!Object(u.a)(e))throw new h.a("material is required.");this._material!==e&&(this._material=e,k2(this,R2))}},width:{get:function(){return this._width},set:function(e){if(!Object(u.a)(e))throw new h.a("value is required.");e!==this._width&&(this._width=e,k2(this,M2))}},loop:{get:function(){return this._loop},set:function(e){if(!Object(u.a)(e))throw new h.a("value is required.");if(e!==this._loop){var t=this._actualPositions;e?t.length>2&&!z.equals(t[0],t[t.length-1])&&(t.length===this._positions.length&&(this._actualPositions=t=this._positions.slice()),t.push(z.clone(t[0]))):t.length>2&&z.equals(t[0],t[t.length-1])&&(t.length-1===this._positions.length?this._actualPositions=this._positions:t.pop()),this._loop=e,k2(this,L2)}}},id:{get:function(){return this._id},set:function(e){this._id=e,Object(u.a)(this._pickId)&&(this._pickId.object.id=e)}},pickId:{get:function(){return this._pickId}},distanceDisplayCondition:{get:function(){return this._distanceDisplayCondition},set:function(e){if(Object(u.a)(e)&&e.far<=e.near)throw new h.a("far distance must be greater than near distance.");gv.equals(e,this._distanceDisplayCondition)||(this._distanceDisplayCondition=gv.clone(e,this._distanceDisplayCondition),k2(this,N2))}}}),I2.prototype.update=function(){var e=Be.IDENTITY;Object(u.a)(this._polylineCollection)&&(e=this._polylineCollection.modelMatrix);var t=this._segments.positions.length,i=this._segments.lengths,n=this._propertiesChanged[D2]>0||this._propertiesChanged[L2]>0;if(Be.equals(e,this._modelMatrix)&&!n||(this._segments=Gm.wrapLongitude(this._actualPositions,e),this._boundingVolumeWC=St.transform(this._boundingVolume,e,this._boundingVolumeWC)),this._modelMatrix=Be.clone(e,this._modelMatrix),this._segments.positions.length!==t)k2(this,L2);else for(var r=i.length,a=0;a<r;++a)if(i[a]!==this._segments.lengths[a]){k2(this,L2);break}},I2.prototype.getPickId=function(e){return Object(u.a)(this._pickId)||(this._pickId=e.createPickId({primitive:this,collection:this._polylineCollection,id:this._id})),this._pickId},I2.prototype._clean=function(){this._dirty=!1;for(var e=this._propertiesChanged,t=0;t<F2-1;++t)e[t]=0},I2.prototype._destroy=function(){this._pickId=this._pickId&&this._pickId.destroy(),this._material=this._material&&this._material.destroy(),this._polylineCollection=void 0};var B2=I2,z2=B2.SHOW_INDEX,U2=B2.WIDTH_INDEX,V2=B2.POSITION_INDEX,H2=B2.MATERIAL_INDEX,G2=B2.POSITION_SIZE_INDEX,q2=B2.DISTANCE_DISPLAY_CONDITION,W2=B2.NUMBER_OF_PROPERTIES,Y2={texCoordExpandAndBatchIndex:0,position3DHigh:1,position3DLow:2,position2DHigh:3,position2DLow:4,prevPosition3DHigh:5,prevPosition3DLow:6,prevPosition2DHigh:7,prevPosition2DLow:8,nextPosition3DHigh:9,nextPosition3DLow:10,nextPosition2DHigh:11,nextPosition2DLow:12};function X2(e){e=Object(w.a)(e,w.a.EMPTY_OBJECT),this.modelMatrix=Be.clone(Object(w.a)(e.modelMatrix,Be.IDENTITY)),this._modelMatrix=Be.clone(Be.IDENTITY),this.debugShowBoundingVolume=Object(w.a)(e.debugShowBoundingVolume,!1),this._opaqueRS=void 0,this._translucentRS=void 0,this._colorCommands=[],this._polylinesUpdated=!1,this._polylinesRemoved=!1,this._createVertexArray=!1,this._propertiesChanged=new Uint32Array(W2),this._polylines=[],this._polylineBuckets={},this._positionBufferUsage={bufferUsage:YN.STATIC_DRAW,frameCount:0},this._mode=void 0,this._polylinesToUpdate=[],this._vertexArrays=[],this._positionBuffer=void 0,this._texCoordExpandAndBatchIndexBuffer=void 0,this._batchTable=void 0,this._createBatchTable=!1,this._useHighlightColor=!1,this._highlightColor=uf.clone(uf.WHITE);var t=this;this._uniformMap={u_highlightColor:function(){return t._highlightColor}}}Object(O.a)(X2.prototype,{length:{get:function(){return a3(this),this._polylines.length}}}),X2.prototype.add=function(e){var t=new B2(e,this);return t._index=this._polylines.length,this._polylines.push(t),this._createVertexArray=!0,this._createBatchTable=!0,t},X2.prototype.remove=function(e){if(this.contains(e)){this._polylines[e._index]=void 0;var t=this._polylinesToUpdate.indexOf(e);if(-1!==t&&this._polylinesToUpdate.splice(t,1),this._polylinesRemoved=!0,this._createVertexArray=!0,this._createBatchTable=!0,Object(u.a)(e._bucket)){var i=e._bucket;i.shaderProgram=i.shaderProgram&&i.shaderProgram.destroy()}return e._destroy(),!0}return!1},X2.prototype.removeAll=function(){o3(this),c3(this),this._polylineBuckets={},this._polylinesRemoved=!1,this._polylines.length=0,this._polylinesToUpdate.length=0,this._createVertexArray=!0},X2.prototype.contains=function(e){return Object(u.a)(e)&&e._polylineCollection===this},X2.prototype.get=function(e){if(!Object(u.a)(e))throw new h.a("index is required.");return a3(this),this._polylines[e]};var Z2=new Fu,Q2=new Te,K2=new Rt;X2.prototype.update=function(e){if(a3(this),0!==this._polylines.length){!function(e,t){var i=t.mode;e._mode===i&&Be.equals(e._modelMatrix,e.modelMatrix)||(e._mode=i,e._modelMatrix=Be.clone(e.modelMatrix),e._createVertexArray=!0)}(this,e);var t,i=e.context,n=e.mapProjection,r=this._propertiesChanged;if(this._createBatchTable){if(0===HD.maximumVertexTextureImageUnits)throw new Ce.a("Vertex texture fetch support is required to render polylines. The maximum number of vertex texture image units must be greater than zero.");!function(e,t){Object(u.a)(e._batchTable)&&e._batchTable.destroy();var i=[{functionName:"batchTable_getWidthAndShow",componentDatatype:dn.UNSIGNED_BYTE,componentsPerAttribute:2},{functionName:"batchTable_getPickColor",componentDatatype:dn.UNSIGNED_BYTE,componentsPerAttribute:4,normalize:!0},{functionName:"batchTable_getCenterHigh",componentDatatype:dn.FLOAT,componentsPerAttribute:3},{functionName:"batchTable_getCenterLowAndRadius",componentDatatype:dn.FLOAT,componentsPerAttribute:4},{functionName:"batchTable_getDistanceDisplayCondition",componentDatatype:dn.FLOAT,componentsPerAttribute:2}];e._batchTable=new hF(t,i,e._polylines.length)}(this,i),this._createBatchTable=!1}if(this._createVertexArray||function(e){var t=!1,i=e._propertiesChanged,n=e._positionBufferUsage;i[V2]?n.bufferUsage!==YN.STREAM_DRAW?(t=!0,n.bufferUsage=YN.STREAM_DRAW,n.frameCount=100):n.frameCount=100:n.bufferUsage!==YN.STATIC_DRAW&&(0===n.frameCount?(t=!0,n.bufferUsage=YN.STATIC_DRAW):n.frameCount--);return t}(this))t3(this,i,n);else if(this._polylinesUpdated){var a=this._polylinesToUpdate;if(this._mode!==xF.SCENE3D)for(var o=a.length,s=0;s<o;++s)(t=a[s]).update();if(r[G2]||r[H2])t3(this,i,n);else for(var c=a.length,l=this._polylineBuckets,h=0;h<c;++h){r=(t=a[h])._propertiesChanged;var d=t._bucket,f=0;for(var p in l)if(l.hasOwnProperty(p)){if(l[p]===d){r[V2]&&d.writeUpdate(f,t,this._positionBuffer,n);break}f+=l[p].lengthOfPositions}if((r[z2]||r[U2])&&this._batchTable.setBatchedAttribute(t._index,0,new Rt(t._width,t._show)),this._batchTable.attributes.length>2){if(r[V2]||r[G2]){var m=e.mode===xF.SCENE2D?t._boundingVolume2D:t._boundingVolumeWC,_=Fu.fromCartesian(m.center,Z2),g=Te.fromElements(_.low.x,_.low.y,_.low.z,m.radius,Q2);this._batchTable.setBatchedAttribute(t._index,2,_.high),this._batchTable.setBatchedAttribute(t._index,3,g)}if(r[q2]){var v=K2;v.x=0,v.y=Number.MAX_VALUE;var b=t.distanceDisplayCondition;Object(u.a)(b)&&(v.x=b.near,v.y=b.far),this._batchTable.setBatchedAttribute(t._index,4,v)}}t._clean()}a.length=0,this._polylinesUpdated=!1}r=this._propertiesChanged;for(var y=0;y<W2;++y)r[y]=0;var w=Be.IDENTITY;e.mode===xF.SCENE3D&&(w=this.modelMatrix);var O=e.passes,x=0!==e.morphTime;if(Object(u.a)(this._opaqueRS)&&this._opaqueRS.depthTest.enabled===x||(this._opaqueRS=RM.fromCache({depthMask:x,depthTest:{enabled:x}})),Object(u.a)(this._translucentRS)&&this._translucentRS.depthTest.enabled===x||(this._translucentRS=RM.fromCache({blending:FD.ALPHA_BLEND,depthMask:!x,depthTest:{enabled:x}})),this._batchTable.update(e),O.render||O.pick)!function(e,t,i,n){for(var r=t.context,a=t.commandList,o=i.length,s=0,c=!0,l=e._vertexArrays,h=e.debugShowBoundingVolume,d=e._batchTable.getUniformMapCallback(),f=l.length,p=0;p<f;++p)for(var m=l[p],_=m.buckets,g=_.length,v=0;v<g;++v){for(var b,y,w,O,x=_[v],E=x.offset,T=x.bucket.shaderProgram,C=x.bucket.polylines,S=C.length,A=0,P=0;P<S;++P){var I=C[P],D=r3(I._material);if(D!==b){if(Object(u.a)(b)&&A>0){var j=y.isTranslucent();s>=o?(w=new cM({owner:e}),i.push(w)):w=i[s],++s,O=Object(ff.a)(d(y._uniforms),e._uniformMap),w.boundingVolume=St.clone(J2,w.boundingVolume),w.modelMatrix=n,w.shaderProgram=T,w.vertexArray=m.va,w.renderState=j?e._translucentRS:e._opaqueRS,w.pass=j?lM.TRANSLUCENT:lM.OPAQUE,w.debugShowBoundingVolume=h,w.pickId="v_pickColor",w.uniformMap=O,w.count=A,w.offset=E,E+=A,A=0,c=!0,a.push(w)}(y=I._material).update(r),b=D}for(var M,R=I._locatorBuckets,L=R.length,N=0;N<L;++N){var F=R[N];F.locator===x&&(A+=F.count)}t.mode===xF.SCENE3D?M=I._boundingVolumeWC:t.mode===xF.COLUMBUS_VIEW?M=I._boundingVolume2D:t.mode===xF.SCENE2D?Object(u.a)(I._boundingVolume2D)&&((M=St.clone(I._boundingVolume2D,$2)).center.x=0):Object(u.a)(I._boundingVolumeWC)&&Object(u.a)(I._boundingVolume2D)&&(M=St.union(I._boundingVolumeWC,I._boundingVolume2D,$2)),c?(c=!1,St.clone(M,J2)):St.union(M,J2,J2)}Object(u.a)(b)&&A>0&&(s>=o?(w=new cM({owner:e}),i.push(w)):w=i[s],++s,O=Object(ff.a)(d(y._uniforms),e._uniformMap),w.boundingVolume=St.clone(J2,w.boundingVolume),w.modelMatrix=n,w.shaderProgram=T,w.vertexArray=m.va,w.renderState=y.isTranslucent()?e._translucentRS:e._opaqueRS,w.pass=y.isTranslucent()?lM.TRANSLUCENT:lM.OPAQUE,w.debugShowBoundingVolume=h,w.pickId="v_pickColor",w.uniformMap=O,w.count=A,w.offset=E,c=!0,a.push(w)),b=void 0}i.length=s}(this,e,this._colorCommands,w)}};var J2=new St,$2=new St;X2.prototype.isDestroyed=function(){return!1},X2.prototype.destroy=function(){return s3(this),o3(this),c3(this),this._batchTable=this._batchTable&&this._batchTable.destroy(),rl(this)};var e3=[0,0,0];function t3(e,t,i){e._createVertexArray=!1,o3(e),s3(e),function(e){for(var t=e._mode,i=e._modelMatrix,n=e._polylineBuckets={},r=e._polylines,a=r.length,o=0;o<a;++o){var s=r[o];if(s._actualPositions.length>1){s.update();var c=s.material,l=n[c.type];Object(u.a)(l)||(l=n[c.type]=new u3(c,t,i)),l.addPolyline(s)}}}(e);var n,r,a=[[]],o=a[0],s=e._batchTable,c=e._useHighlightColor,l=[0],h=0,d=[[]],f=0,p=e._polylineBuckets;for(n in p)p.hasOwnProperty(n)&&((r=p[n]).updateShader(t,s,c),f+=r.lengthOfPositions);if(f>0){var m,_=e._mode,g=new Float32Array(6*f*3),v=new Float32Array(4*f),b=0,y=0,w=0;for(n in p)if(p.hasOwnProperty(n)){(r=p[n]).write(g,v,b,y,w,s,t,i),_===xF.MORPHING&&(Object(u.a)(m)||(m=new Float32Array(6*f*3)),r.writeForMorph(m,b));var O=r.lengthOfPositions;b+=6*O*3,y+=4*O,w+=4*O,h=r.updateIndices(a,l,d,h)}var x,E=e._positionBufferUsage.bufferUsage,T=YN.STATIC_DRAW;e._positionBuffer=ZN.createVertexBuffer({context:t,typedArray:g,usage:E}),Object(u.a)(m)&&(x=ZN.createVertexBuffer({context:t,typedArray:m,usage:E})),e._texCoordExpandAndBatchIndexBuffer=ZN.createVertexBuffer({context:t,typedArray:v,usage:T});for(var C=3*Float32Array.BYTES_PER_ELEMENT,S=4*Float32Array.BYTES_PER_ELEMENT,A=0,P=a.length,D=0;D<P;++D)if((o=a[D]).length>0){var j=new Uint16Array(o),M=ZN.createIndexBuffer({context:t,typedArray:j,usage:YN.STATIC_DRAW,indexDatatype:Sl.UNSIGNED_SHORT});A+=l[D];var R,L,N,F,k=6*(D*(C*I.SIXTY_FOUR_KILOBYTES)-A*C),B=C+k,z=C+B,U=C+z,V=C+U,H=C+V,G=D*(S*I.SIXTY_FOUR_KILOBYTES)-A*S,q=[{index:Y2.position3DHigh,componentsPerAttribute:3,componentDatatype:dn.FLOAT,offsetInBytes:k,strideInBytes:6*C},{index:Y2.position3DLow,componentsPerAttribute:3,componentDatatype:dn.FLOAT,offsetInBytes:B,strideInBytes:6*C},{index:Y2.position2DHigh,componentsPerAttribute:3,componentDatatype:dn.FLOAT,offsetInBytes:k,strideInBytes:6*C},{index:Y2.position2DLow,componentsPerAttribute:3,componentDatatype:dn.FLOAT,offsetInBytes:B,strideInBytes:6*C},{index:Y2.prevPosition3DHigh,componentsPerAttribute:3,componentDatatype:dn.FLOAT,offsetInBytes:z,strideInBytes:6*C},{index:Y2.prevPosition3DLow,componentsPerAttribute:3,componentDatatype:dn.FLOAT,offsetInBytes:U,strideInBytes:6*C},{index:Y2.prevPosition2DHigh,componentsPerAttribute:3,componentDatatype:dn.FLOAT,offsetInBytes:z,strideInBytes:6*C},{index:Y2.prevPosition2DLow,componentsPerAttribute:3,componentDatatype:dn.FLOAT,offsetInBytes:U,strideInBytes:6*C},{index:Y2.nextPosition3DHigh,componentsPerAttribute:3,componentDatatype:dn.FLOAT,offsetInBytes:V,strideInBytes:6*C},{index:Y2.nextPosition3DLow,componentsPerAttribute:3,componentDatatype:dn.FLOAT,offsetInBytes:H,strideInBytes:6*C},{index:Y2.nextPosition2DHigh,componentsPerAttribute:3,componentDatatype:dn.FLOAT,offsetInBytes:V,strideInBytes:6*C},{index:Y2.nextPosition2DLow,componentsPerAttribute:3,componentDatatype:dn.FLOAT,offsetInBytes:H,strideInBytes:6*C},{index:Y2.texCoordExpandAndBatchIndex,componentsPerAttribute:4,componentDatatype:dn.FLOAT,vertexBuffer:e._texCoordExpandAndBatchIndexBuffer,offsetInBytes:G}];_===xF.SCENE3D?(R=e._positionBuffer,L="vertexBuffer",N=e3,F="value"):_===xF.SCENE2D||_===xF.COLUMBUS_VIEW?(R=e3,L="value",N=e._positionBuffer,F="vertexBuffer"):(R=x,L="vertexBuffer",N=e._positionBuffer,F="vertexBuffer"),q[0][L]=R,q[1][L]=R,q[2][F]=N,q[3][F]=N,q[4][L]=R,q[5][L]=R,q[6][F]=N,q[7][F]=N,q[8][L]=R,q[9][L]=R,q[10][F]=N,q[11][F]=N;var W=new tF({context:t,attributes:q,indexBuffer:M});e._vertexArrays.push({va:W,buckets:d[D]})}}}function i3(e,t){return t instanceof hj?t.id:t}var n3=[];function r3(e){var t=qj._uniformList[e.type],i=t.length;n3.length=2*i;for(var n=0,r=0;r<i;++r){var a=t[r];n3[n]=a,n3[n+1]=e._uniforms[a](),n+=2}return e.type+":"+JSON.stringify(n3,i3)}function a3(e){if(e._polylinesRemoved){e._polylinesRemoved=!1;for(var t=[],i=e._polylines.length,n=0,r=0;n<i;++n){var a=e._polylines[n];Object(u.a)(a)&&(a._index=r++,t.push(a))}e._polylines=t}}function o3(e){for(var t=e._polylines,i=t.length,n=0;n<i;++n)if(Object(u.a)(t[n])){var r=t[n]._bucket;Object(u.a)(r)&&(r.shaderProgram=r.shaderProgram&&r.shaderProgram.destroy())}}function s3(e){for(var t=e._vertexArrays.length,i=0;i<t;++i)e._vertexArrays[i].va.destroy();e._vertexArrays.length=0}function c3(e){for(var t=e._polylines,i=t.length,n=0;n<i;++n)Object(u.a)(t[n])&&t[n]._destroy()}function l3(e,t,i){this.count=e,this.offset=t,this.bucket=i}function u3(e,t,i){this.polylines=[],this.lengthOfPositions=0,this.material=e,this.shaderProgram=void 0,this.mode=t,this.modelMatrix=i}function h3(e){return z.dot(z.UNIT_X,e._boundingVolume.center)<0||e._boundingVolume.intersectPlane(oc.ORIGIN_ZX_PLANE)===ce.INTERSECTING}X2.prototype._updatePolyline=function(e,t){this._polylinesUpdated=!0,e._dirty||this._polylinesToUpdate.push(e),++this._propertiesChanged[t]},u3.prototype.addPolyline=function(e){this.polylines.push(e),e._actualLength=this.getPolylinePositionsLength(e),this.lengthOfPositions+=e._actualLength,e._bucket=this},u3.prototype.updateShader=function(e,t,i){if(!Object(u.a)(this.shaderProgram)){var n=["DISTANCE_DISPLAY_CONDITION"];i&&n.push("VECTOR_TILE"),-1!==this.material.shaderSource.search(/varying\s+float\s+v_polylineAngle;/g)&&n.push("POLYLINE_DASH"),Ri.isInternetExplorer()||n.push("CLIP_POLYLINE");var r=new UN({defines:n,sources:["varying vec4 v_pickColor;\n",this.material.shaderSource,SB]}),a=t.getVertexShaderCallback()(P2),o=new UN({defines:n,sources:[wB,a]});this.shaderProgram=bR.fromCache({context:e,vertexShaderSource:o,fragmentShaderSource:r,attributeLocations:Y2})}},u3.prototype.getPolylinePositionsLength=function(e){var t;if(this.mode===xF.SCENE3D||!h3(e))return 4*(t=e._actualPositions.length)-4;var i=0,n=e._segments.lengths;t=n.length;for(var r=0;r<t;++r)i+=4*n[r]-4;return i};var d3=new z,f3=new z,p3=new z,m3=new z,_3=new Te,g3=new Rt;u3.prototype.write=function(e,t,i,n,r,a,o,s){for(var c=this.mode,l=s.ellipsoid.maximumRadius*I.PI,h=this.polylines,d=h.length,f=0;f<d;++f){for(var p,m=h[f],_=m.width,g=m.show&&_>0,v=m._index,b=this.getSegments(m,s),y=b.positions,w=b.lengths,O=y.length,x=m.getPickId(o).color,E=0,T=0,C=0;C<O;++C){0===C?m._loop?p=y[O-2]:(p=m3,z.subtract(y[0],y[1],p),z.add(y[0],p,p)):p=y[C-1],z.clone(p,f3),z.clone(y[C],d3),C===O-1?m._loop?p=y[1]:(p=m3,z.subtract(y[O-1],y[O-2],p),z.add(y[O-1],p,p)):p=y[C+1],z.clone(p,p3);var S=w[E];C===T+S&&(T+=S,++E);var A=C-T==0,P=C===T+w[E]-1;c===xF.SCENE2D&&(f3.z=0,d3.z=0,p3.z=0),c!==xF.SCENE2D&&c!==xF.MORPHING||(A||P)&&l-Math.abs(d3.x)<1&&((d3.x<0&&f3.x>0||d3.x>0&&f3.x<0)&&z.clone(d3,f3),(d3.x<0&&p3.x>0||d3.x>0&&p3.x<0)&&z.clone(d3,p3));for(var D=P?2:4,j=A?2:0;j<D;++j){Fu.writeElements(d3,e,i),Fu.writeElements(f3,e,i+6),Fu.writeElements(p3,e,i+12);var M=j-2<0?-1:1;t[r]=C/(O-1),t[r+1]=j%2*2-1,t[r+2]=M,t[r+3]=v,i+=18,r+=4}}var R=_3;R.x=uf.floatToByte(x.red),R.y=uf.floatToByte(x.green),R.z=uf.floatToByte(x.blue),R.w=uf.floatToByte(x.alpha);var L=g3;L.x=_,L.y=g?1:0;var N=c===xF.SCENE2D?m._boundingVolume2D:m._boundingVolumeWC,F=Fu.fromCartesian(N.center,Z2),k=F.high,B=Te.fromElements(F.low.x,F.low.y,F.low.z,N.radius,Q2),U=K2;U.x=0,U.y=Number.MAX_VALUE;var V=m.distanceDisplayCondition;Object(u.a)(V)&&(U.x=V.near,U.y=V.far),a.setBatchedAttribute(v,0,L),a.setBatchedAttribute(v,1,R),a.attributes.length>2&&(a.setBatchedAttribute(v,2,k),a.setBatchedAttribute(v,3,B),a.setBatchedAttribute(v,4,U))}};var v3=new z,b3=new z,y3=new z,w3=new z;u3.prototype.writeForMorph=function(e,t){for(var i=this.modelMatrix,n=this.polylines,r=n.length,a=0;a<r;++a)for(var o=n[a],s=o._segments.positions,c=o._segments.lengths,l=s.length,u=0,h=0,d=0;d<l;++d){var f;0===d?o._loop?f=s[l-2]:(f=w3,z.subtract(s[0],s[1],f),z.add(s[0],f,f)):f=s[d-1],f=Be.multiplyByPoint(i,f,b3);var p,m=Be.multiplyByPoint(i,s[d],v3);d===l-1?o._loop?p=s[1]:(p=w3,z.subtract(s[l-1],s[l-2],p),z.add(s[l-1],p,p)):p=s[d+1],p=Be.multiplyByPoint(i,p,y3);var _=c[u];d===h+_&&(h+=_,++u);for(var g=d-h==0,v=d===h+c[u]-1?2:4,b=g?2:0;b<v;++b)Fu.writeElements(m,e,t),Fu.writeElements(f,e,t+6),Fu.writeElements(p,e,t+12),t+=18}};var O3=new Array(1);u3.prototype.updateIndices=function(e,t,i,n){var r=i.length-1,a=new l3(0,n,this);i[r].push(a);var o=0,s=e[e.length-1],c=0;s.length>0&&(c=s[s.length-1]+1);for(var l=this.polylines,u=l.length,h=0;h<u;++h){var d,f=l[h];if(f._locatorBuckets=[],this.mode===xF.SCENE3D){d=O3;var p=f._actualPositions.length;if(!(p>0))continue;d[0]=p}else d=f._segments.lengths;var m=d.length;if(m>0){for(var _=0,g=0;g<m;++g)for(var v=d[g]-1,b=0;b<v;++b)c+4>I.SIXTY_FOUR_KILOBYTES&&(f._locatorBuckets.push({locator:a,count:_}),_=0,t.push(4),s=[],e.push(s),c=0,a.count=o,o=0,n=0,a=new l3(0,0,this),i[++r]=[a]),s.push(c,c+2,c+1),s.push(c+1,c+2,c+3),_+=6,o+=6,n+=6,c+=4;f._locatorBuckets.push({locator:a,count:_}),c+4>I.SIXTY_FOUR_KILOBYTES&&(t.push(0),s=[],e.push(s),c=0,a.count=o,n=0,o=0,a=new l3(0,0,this),i[++r]=[a])}f._clean()}return a.count=o,n},u3.prototype.getPolylineStartIndex=function(e){for(var t=this.polylines,i=0,n=t.length,r=0;r<n;++r){var a=t[r];if(a===e)break;i+=a._actualLength}return i};var x3,E3={positions:void 0,lengths:void 0},T3=new Array(1),C3=new z,S3=new K;u3.prototype.getSegments=function(e,t){var i=e._actualPositions;if(this.mode===xF.SCENE3D)return T3[0]=i.length,E3.positions=i,E3.lengths=T3,E3;h3(e)&&(i=e._segments.positions);for(var n,r=t.ellipsoid,a=[],o=this.modelMatrix,s=i.length,c=C3,l=0;l<s;++l)n=i[l],c=Be.multiplyByPoint(o,n,c),a.push(t.project(r.cartesianToCartographic(c,S3)));if(a.length>0){e._boundingVolume2D=St.fromPoints(a,e._boundingVolume2D);var u=e._boundingVolume2D.center;e._boundingVolume2D.center=new z(u.z,u.x,u.y)}return E3.positions=a,E3.lengths=e._segments.lengths,E3},u3.prototype.writeUpdate=function(e,t,i,n){var r=this.mode,a=n.ellipsoid.maximumRadius*I.PI,o=t._actualLength;if(o){e+=this.getPolylineStartIndex(t);var s=x3,c=6*o*3;!Object(u.a)(s)||s.length<c?s=x3=new Float32Array(c):s.length>c&&(s=new Float32Array(s.buffer,0,c));var l,h=this.getSegments(t,n),d=h.positions,f=h.lengths,p=0,m=0,_=0;o=d.length;for(var g=0;g<o;++g){0===g?t._loop?l=d[o-2]:(l=m3,z.subtract(d[0],d[1],l),z.add(d[0],l,l)):l=d[g-1],z.clone(l,f3),z.clone(d[g],d3),g===o-1?t._loop?l=d[1]:(l=m3,z.subtract(d[o-1],d[o-2],l),z.add(d[o-1],l,l)):l=d[g+1],z.clone(l,p3);var v=f[m];g===_+v&&(_+=v,++m);var b=g-_==0,y=g===_+f[m]-1;r===xF.SCENE2D&&(f3.z=0,d3.z=0,p3.z=0),r!==xF.SCENE2D&&r!==xF.MORPHING||(b||y)&&a-Math.abs(d3.x)<1&&((d3.x<0&&f3.x>0||d3.x>0&&f3.x<0)&&z.clone(d3,f3),(d3.x<0&&p3.x>0||d3.x>0&&p3.x<0)&&z.clone(d3,p3));for(var w=y?2:4,O=b?2:0;O<w;++O)Fu.writeElements(d3,s,p),Fu.writeElements(f3,s,p+6),Fu.writeElements(p3,s,p+12),p+=18}i.copyFromArrayView(s,18*Float32Array.BYTES_PER_ELEMENT*e)}};var A3=X2;function P3(e){this._positions=e.positions,this._batchTable=e.batchTable,this._batchIds=e.batchIds,this._rectangle=e.rectangle,this._minHeight=e.minimumHeight,this._maxHeight=e.maximumHeight,this._billboardCollection=void 0,this._labelCollection=void 0,this._polylineCollection=void 0,this._verticesPromise=void 0,this._packedBuffer=void 0,this._ready=!1,this._readyPromise=Oi.a.defer(),this._resolvedPromise=!1}Object(O.a)(P3.prototype,{pointsLength:{get:function(){return this._billboardCollection.length}},texturesByteLength:{get:function(){return this._billboardCollection.textureAtlas.texture.sizeInBytes+this._labelCollection._textureAtlas.texture.sizeInBytes}},readyPromise:{get:function(){return this._readyPromise.promise}}});var I3=new pl("createVectorTilePoints"),D3=new z;function j3(e,t){if(!Object(u.a)(e._billboardCollection)){var i;if(!Object(u.a)(e._verticesPromise)){i=e._positions;var n=e._packedBuffer;Object(u.a)(n)||(i=e._positions=Li(i),e._batchIds=Li(e._batchIds),n=e._packedBuffer=function(e,t){var i=e._rectangle,n=e._minHeight,r=e._maxHeight,a=2+Ve.packedLength+ae.packedLength,o=new Float64Array(a),s=0;return o[s++]=n,o[s++]=r,Ve.pack(i,o,s),s+=Ve.packedLength,ae.pack(t,o,s),o}(e,t));var r=[i.buffer,n.buffer],a={positions:i.buffer,packedBuffer:n.buffer},o=e._verticesPromise=I3.scheduleTask(a,r);if(!Object(u.a)(o))return;o.then((function(t){e._positions=new Float64Array(t.positions),e._ready=!0}))}if(e._ready&&!Object(u.a)(e._billboardCollection)){i=e._positions;var s=e._batchTable,c=e._batchIds,l=e._billboardCollection=new nG({batchTable:s}),h=e._labelCollection=new jG({batchTable:s}),d=e._polylineCollection=new A3;d._useHighlightColor=!0;for(var f=i.length/3,p=0;p<f;++p){var m=c[p],_=z.unpack(i,3*p,D3),g=l.add();g.position=_,g._batchIndex=m;var v=h.add();v.text=" ",v.position=_,v._batchIndex=m,d.add().positions=[z.clone(_),z.clone(_)]}e._positions=void 0,e._packedBuffer=void 0}}}P3.prototype.createFeatures=function(e,t){for(var i=this._billboardCollection,n=this._labelCollection,r=this._polylineCollection,a=this._batchIds,o=a.length,s=0;s<o;++s){var c=a[s],l=i.get(s),u=n.get(s),h=r.get(s);t[c]=new A2(e,c,l,u,h)}},P3.prototype.applyDebugSettings=function(e,t){e?(uf.clone(t,this._billboardCollection._highlightColor),uf.clone(t,this._labelCollection._highlightColor),uf.clone(t,this._polylineCollection._highlightColor)):(uf.clone(uf.WHITE,this._billboardCollection._highlightColor),uf.clone(uf.WHITE,this._labelCollection._highlightColor),uf.clone(uf.WHITE,this._polylineCollection._highlightColor))};var M3=new uf,R3=new uf,L3=new uf,N3=new uf,F3=new uf,k3=new uf,B3=new Fx,z3=new Fx,U3=new gv;P3.prototype.applyStyle=function(e,t){if(Object(u.a)(e))for(var i=this._batchIds,n=i.length,r=0;r<n;++r){var a=t[i[r]];if(Object(u.a)(e.show)&&(a.show=e.show.evaluate(a)),Object(u.a)(e.pointSize)&&(a.pointSize=e.pointSize.evaluate(a)),Object(u.a)(e.color)&&(a.color=e.color.evaluateColor(a,M3)),Object(u.a)(e.pointOutlineColor)&&(a.pointOutlineColor=e.pointOutlineColor.evaluateColor(a,R3)),Object(u.a)(e.pointOutlineWidth)&&(a.pointOutlineWidth=e.pointOutlineWidth.evaluate(a)),Object(u.a)(e.labelColor)&&(a.labelColor=e.labelColor.evaluateColor(a,L3)),Object(u.a)(e.labelOutlineColor)&&(a.labelOutlineColor=e.labelOutlineColor.evaluateColor(a,N3)),Object(u.a)(e.labelOutlineWidth)&&(a.labelOutlineWidth=e.labelOutlineWidth.evaluate(a)),Object(u.a)(e.font)&&(a.font=e.font.evaluate(a)),Object(u.a)(e.labelStyle)&&(a.labelStyle=e.labelStyle.evaluate(a)),Object(u.a)(e.labelText)?a.labelText=e.labelText.evaluate(a):a.labelText=void 0,Object(u.a)(e.backgroundColor)&&(a.backgroundColor=e.backgroundColor.evaluateColor(a,F3)),Object(u.a)(e.backgroundPadding)&&(a.backgroundPadding=e.backgroundPadding.evaluate(a)),Object(u.a)(e.backgroundEnabled)&&(a.backgroundEnabled=e.backgroundEnabled.evaluate(a)),Object(u.a)(e.scaleByDistance)){var o=e.scaleByDistance.evaluate(a);B3.near=o.x,B3.nearValue=o.y,B3.far=o.z,B3.farValue=o.w,a.scaleByDistance=B3}else a.scaleByDistance=void 0;if(Object(u.a)(e.translucencyByDistance)){var s=e.translucencyByDistance.evaluate(a);z3.near=s.x,z3.nearValue=s.y,z3.far=s.z,z3.farValue=s.w,a.translucencyByDistance=z3}else a.translucencyByDistance=void 0;if(Object(u.a)(e.distanceDisplayCondition)){var c=e.distanceDisplayCondition.evaluate(a);U3.near=c.x,U3.far=c.y,a.distanceDisplayCondition=U3}else a.distanceDisplayCondition=void 0;Object(u.a)(e.heightOffset)&&(a.heightOffset=e.heightOffset.evaluate(a)),Object(u.a)(e.anchorLineEnabled)&&(a.anchorLineEnabled=e.anchorLineEnabled.evaluate(a)),Object(u.a)(e.anchorLineColor)&&(a.anchorLineColor=e.anchorLineColor.evaluateColor(a,k3)),Object(u.a)(e.image)?a.image=e.image.evaluate(a):a.image=void 0,Object(u.a)(e.disableDepthTestDistance)&&(a.disableDepthTestDistance=e.disableDepthTestDistance.evaluate(a)),Object(u.a)(e.horizontalOrigin)&&(a.horizontalOrigin=e.horizontalOrigin.evaluate(a)),Object(u.a)(e.verticalOrigin)&&(a.verticalOrigin=e.verticalOrigin.evaluate(a)),Object(u.a)(e.labelHorizontalOrigin)&&(a.labelHorizontalOrigin=e.labelHorizontalOrigin.evaluate(a)),Object(u.a)(e.labelVerticalOrigin)&&(a.labelVerticalOrigin=e.labelVerticalOrigin.evaluate(a))}else!function(e,t){for(var i=e._batchIds,n=i.length,r=0;r<n;++r){var a=t[i[r]];a.show=!0,a.pointSize=A2.defaultPointSize,a.color=A2.defaultColor,a.pointOutlineColor=A2.defaultPointOutlineColor,a.pointOutlineWidth=A2.defaultPointOutlineWidth,a.labelColor=uf.WHITE,a.labelOutlineColor=uf.WHITE,a.labelOutlineWidth=1,a.font="30px sans-serif",a.labelStyle=rG.FILL,a.labelText=void 0,a.backgroundColor=new uf(.165,.165,.165,.8),a.backgroundPadding=new Rt(7,5),a.backgroundEnabled=!1,a.scaleByDistance=void 0,a.translucencyByDistance=void 0,a.distanceDisplayCondition=void 0,a.heightOffset=0,a.anchorLineEnabled=!1,a.anchorLineColor=uf.WHITE,a.image=void 0,a.disableDepthTestDistance=0,a.horizontalOrigin=tD.CENTER,a.verticalOrigin=iD.CENTER,a.labelHorizontalOrigin=tD.RIGHT,a.labelVerticalOrigin=iD.BASELINE}}(this,t)},P3.prototype.update=function(e){j3(this,e.mapProjection.ellipsoid),this._ready&&(this._polylineCollection.update(e),this._billboardCollection.update(e),this._labelCollection.update(e),this._resolvedPromise||(this._readyPromise.resolve(),this._resolvedPromise=!0))},P3.prototype.isDestroyed=function(){return!1},P3.prototype.destroy=function(){return this._billboardCollection=this._billboardCollection&&this._billboardCollection.destroy(),this._labelCollection=this._labelCollection&&this._labelCollection.destroy(),this._polylineCollection=this._polylineCollection&&this._polylineCollection.destroy(),rl(this)};var V3=P3;function H3(e){this._batchTable=e.batchTable,this._batchIds=e.batchIds,this._positions=e.positions,this._counts=e.counts,this._indices=e.indices,this._indexCounts=e.indexCounts,this._indexOffsets=void 0,this._batchTableColors=void 0,this._packedBuffer=void 0,this._batchedPositions=void 0,this._transferrableBatchIds=void 0,this._vertexBatchIds=void 0,this._ellipsoid=Object(w.a)(e.ellipsoid,ae.WGS84),this._minimumHeight=e.minimumHeight,this._maximumHeight=e.maximumHeight,this._polygonMinimumHeights=e.polygonMinimumHeights,this._polygonMaximumHeights=e.polygonMaximumHeights,this._center=Object(w.a)(e.center,z.ZERO),this._rectangle=e.rectangle,this._center=void 0,this._boundingVolume=e.boundingVolume,this._boundingVolumes=void 0,this._batchedIndices=void 0,this._ready=!1,this._readyPromise=Oi.a.defer(),this._verticesPromise=void 0,this._primitive=void 0,this.debugWireframe=!1,this.forceRebatch=!1,this.classificationType=iM.BOTH}Object(O.a)(H3.prototype,{trianglesLength:{get:function(){return Object(u.a)(this._primitive)?this._primitive.trianglesLength:0}},geometryByteLength:{get:function(){return Object(u.a)(this._primitive)?this._primitive.geometryByteLength:0}},readyPromise:{get:function(){return this._readyPromise.promise}}});var G3=new pl("createVectorTilePolygons"),q3=new uf;function W3(e){if(!Object(u.a)(e._primitive)){if(!Object(u.a)(e._verticesPromise)){var t=e._positions,i=e._counts,n=e._indexCounts,r=e._indices,a=e._transferrableBatchIds,o=e._batchTableColors,s=e._packedBuffer;if(!Object(u.a)(o)){t=e._positions=Li(e._positions),i=e._counts=Li(e._counts),n=e._indexCounts=Li(e._indexCounts),r=e._indices=Li(e._indices),e._center=e._ellipsoid.cartographicToCartesian(Ve.center(e._rectangle)),a=e._transferrableBatchIds=new Uint32Array(e._batchIds),o=e._batchTableColors=new Uint32Array(a.length);for(var c=e._batchTable,l=o.length,h=0;h<l;++h){var d=c.getColor(h,q3);o[h]=d.toRgba()}s=e._packedBuffer=function(e){var t=new Float64Array(3+z.packedLength+ae.packedLength+Ve.packedLength),i=0;return t[i++]=e._indices.BYTES_PER_ELEMENT,t[i++]=e._minimumHeight,t[i++]=e._maximumHeight,z.pack(e._center,t,i),i+=z.packedLength,ae.pack(e._ellipsoid,t,i),i+=ae.packedLength,Ve.pack(e._rectangle,t,i),t}(e)}var f=[t.buffer,i.buffer,n.buffer,r.buffer,a.buffer,o.buffer,s.buffer],p={packedBuffer:s.buffer,positions:t.buffer,counts:i.buffer,indexCounts:n.buffer,indices:r.buffer,batchIds:a.buffer,batchTableColors:o.buffer},m=e._polygonMinimumHeights,_=e._polygonMaximumHeights;Object(u.a)(m)&&Object(u.a)(_)&&(f.push(m.buffer,_.buffer),p.minimumHeights=m,p.maximumHeights=_);var g=e._verticesPromise=G3.scheduleTask(p,f);if(!Object(u.a)(g))return;Object(Oi.a)(g,(function(t){e._positions=void 0,e._counts=void 0,e._polygonMinimumHeights=void 0,e._polygonMaximumHeights=void 0;var i=new Float64Array(t.packedBuffer),n=i[0];!function(e,t){for(var i=1,n=t[i++],r=e._boundingVolumes=new Array(n),a=0;a<n;++a)r[a]=Fc.unpack(t,i),i+=Fc.packedLength;for(var o=t[i++],s=e._batchedIndices=new Array(o),c=0;c<o;++c){var l=uf.unpack(t,i);i+=uf.packedLength;for(var u=t[i++],h=t[i++],d=t[i++],f=new Array(d),p=0;p<d;++p)f[p]=t[i++];s[c]=new SQ({color:l,offset:u,count:h,batchIds:f})}}(e,i),e._indices=2===Sl.getSizeInBytes(n)?new Uint16Array(t.indices):new Uint32Array(t.indices),e._indexOffsets=new Uint32Array(t.indexOffsets),e._indexCounts=new Uint32Array(t.indexCounts),e._batchedPositions=new Float32Array(t.positions),e._vertexBatchIds=new Uint16Array(t.batchIds),e._ready=!0}))}e._ready&&!Object(u.a)(e._primitive)&&(e._primitive=new EK({batchTable:e._batchTable,positions:e._batchedPositions,batchIds:e._batchIds,vertexBatchIds:e._vertexBatchIds,indices:e._indices,indexOffsets:e._indexOffsets,indexCounts:e._indexCounts,batchedIndices:e._batchedIndices,boundingVolume:e._boundingVolume,boundingVolumes:e._boundingVolumes,center:e._center}),e._batchTable=void 0,e._batchIds=void 0,e._positions=void 0,e._counts=void 0,e._indices=void 0,e._indexCounts=void 0,e._indexOffsets=void 0,e._batchTableColors=void 0,e._packedBuffer=void 0,e._batchedPositions=void 0,e._transferrableBatchIds=void 0,e._vertexBatchIds=void 0,e._ellipsoid=void 0,e._minimumHeight=void 0,e._maximumHeight=void 0,e._polygonMinimumHeights=void 0,e._polygonMaximumHeights=void 0,e._center=void 0,e._rectangle=void 0,e._boundingVolume=void 0,e._boundingVolumes=void 0,e._batchedIndices=void 0,e._verticesPromise=void 0,e._readyPromise.resolve())}}H3.prototype.createFeatures=function(e,t){this._primitive.createFeatures(e,t)},H3.prototype.applyDebugSettings=function(e,t){this._primitive.applyDebugSettings(e,t)},H3.prototype.applyStyle=function(e,t){this._primitive.applyStyle(e,t)},H3.prototype.updateCommands=function(e,t){this._primitive.updateCommands(e,t)},H3.prototype.update=function(e){W3(this),this._ready&&(this._primitive.debugWireframe=this.debugWireframe,this._primitive.forceRebatch=this.forceRebatch,this._primitive.classificationType=this.classificationType,this._primitive.update(e))},H3.prototype.isDestroyed=function(){return!1},H3.prototype.destroy=function(){return this._primitive=this._primitive&&this._primitive.destroy(),rl(this)};var Y3=H3,X3="attribute vec4 currentPosition;\nattribute vec4 previousPosition;\nattribute vec4 nextPosition;\nattribute vec2 expandAndWidth;\nattribute float a_batchId;\nuniform mat4 u_modifiedModelView;\nvoid main()\n{\nfloat expandDir = expandAndWidth.x;\nfloat width = abs(expandAndWidth.y) + 0.5;\nbool usePrev = expandAndWidth.y < 0.0;\nvec4 p = u_modifiedModelView * currentPosition;\nvec4 prev = u_modifiedModelView * previousPosition;\nvec4 next = u_modifiedModelView * nextPosition;\nfloat angle;\nvec4 positionWC = getPolylineWindowCoordinatesEC(p, prev, next, expandDir, width, usePrev, angle);\ngl_Position = czm_viewportOrthographic * positionWC;\n#ifdef LOG_DEPTH\nczm_vertexLogDepth(czm_projection * p);\n#endif\n}\n";function Z3(e){this._positions=e.positions,this._widths=e.widths,this._counts=e.counts,this._batchIds=e.batchIds,this._ellipsoid=Object(w.a)(e.ellipsoid,ae.WGS84),this._minimumHeight=e.minimumHeight,this._maximumHeight=e.maximumHeight,this._center=e.center,this._rectangle=e.rectangle,this._boundingVolume=e.boundingVolume,this._batchTable=e.batchTable,this._va=void 0,this._sp=void 0,this._rs=void 0,this._uniformMap=void 0,this._command=void 0,this._transferrableBatchIds=void 0,this._packedBuffer=void 0,this._currentPositions=void 0,this._previousPositions=void 0,this._nextPositions=void 0,this._expandAndWidth=void 0,this._vertexBatchIds=void 0,this._indices=void 0,this._constantColor=uf.clone(uf.WHITE),this._highlightColor=this._constantColor,this._trianglesLength=0,this._geometryByteLength=0,this._ready=!1,this._readyPromise=Oi.a.defer(),this._verticesPromise=void 0}Object(O.a)(Z3.prototype,{trianglesLength:{get:function(){return this._trianglesLength}},geometryByteLength:{get:function(){return this._geometryByteLength}},readyPromise:{get:function(){return this._readyPromise.promise}}});var Q3=new pl("createVectorTilePolylines"),K3={previousPosition:0,currentPosition:1,nextPosition:2,expandAndWidth:3,a_batchId:4};function J3(e,t){if(!Object(u.a)(e._va)){if(!Object(u.a)(e._verticesPromise)){var i=e._positions,n=e._widths,r=e._counts,a=e._transferrableBatchIds,o=e._packedBuffer;Object(u.a)(o)||(i=e._positions=Li(i),n=e._widths=Li(n),r=e._counts=Li(r),a=e._transferrableBatchIds=Li(e._batchIds),o=e._packedBuffer=function(e){var t=e._rectangle,i=e._minimumHeight,n=e._maximumHeight,r=e._ellipsoid,a=e._center,o=2+Ve.packedLength+ae.packedLength+z.packedLength,s=new Float64Array(o),c=0;return s[c++]=i,s[c++]=n,Ve.pack(t,s,c),c+=Ve.packedLength,ae.pack(r,s,c),c+=ae.packedLength,z.pack(a,s,c),s}(e));var s=[i.buffer,n.buffer,r.buffer,a.buffer,o.buffer],c={positions:i.buffer,widths:n.buffer,counts:r.buffer,batchIds:a.buffer,packedBuffer:o.buffer},l=e._verticesPromise=Q3.scheduleTask(c,s);if(!Object(u.a)(l))return;Object(Oi.a)(l,(function(t){e._currentPositions=new Float32Array(t.currentPositions),e._previousPositions=new Float32Array(t.previousPositions),e._nextPositions=new Float32Array(t.nextPositions),e._expandAndWidth=new Float32Array(t.expandAndWidth),e._vertexBatchIds=new Uint16Array(t.batchIds);var i=t.indexDatatype;e._indices=i===Sl.UNSIGNED_SHORT?new Uint16Array(t.indices):new Uint32Array(t.indices),e._ready=!0}))}if(e._ready&&!Object(u.a)(e._va)){var h=e._currentPositions,d=e._previousPositions,f=e._nextPositions,p=e._expandAndWidth,m=e._vertexBatchIds,_=e._indices,g=d.byteLength+h.byteLength+f.byteLength;g+=p.byteLength+m.byteLength+_.byteLength,e._trianglesLength=_.length/3,e._geometryByteLength=g;var v=ZN.createVertexBuffer({context:t,typedArray:d,usage:YN.STATIC_DRAW}),b=ZN.createVertexBuffer({context:t,typedArray:h,usage:YN.STATIC_DRAW}),y=ZN.createVertexBuffer({context:t,typedArray:f,usage:YN.STATIC_DRAW}),w=ZN.createVertexBuffer({context:t,typedArray:p,usage:YN.STATIC_DRAW}),O=ZN.createVertexBuffer({context:t,typedArray:m,usage:YN.STATIC_DRAW}),x=ZN.createIndexBuffer({context:t,typedArray:_,usage:YN.STATIC_DRAW,indexDatatype:2===_.BYTES_PER_ELEMENT?Sl.UNSIGNED_SHORT:Sl.UNSIGNED_INT}),E=[{index:K3.previousPosition,vertexBuffer:v,componentDatatype:dn.FLOAT,componentsPerAttribute:3},{index:K3.currentPosition,vertexBuffer:b,componentDatatype:dn.FLOAT,componentsPerAttribute:3},{index:K3.nextPosition,vertexBuffer:y,componentDatatype:dn.FLOAT,componentsPerAttribute:3},{index:K3.expandAndWidth,vertexBuffer:w,componentDatatype:dn.FLOAT,componentsPerAttribute:2},{index:K3.a_batchId,vertexBuffer:O,componentDatatype:dn.UNSIGNED_SHORT,componentsPerAttribute:1}];e._va=new tF({context:t,attributes:E,indexBuffer:x}),e._positions=void 0,e._widths=void 0,e._counts=void 0,e._ellipsoid=void 0,e._minimumHeight=void 0,e._maximumHeight=void 0,e._rectangle=void 0,e._transferrableBatchIds=void 0,e._packedBuffer=void 0,e._currentPositions=void 0,e._previousPositions=void 0,e._nextPositions=void 0,e._expandAndWidth=void 0,e._vertexBatchIds=void 0,e._indices=void 0,e._readyPromise.resolve()}}}var $3=new Be,e4=new z;var t4="uniform vec4 u_highlightColor; \nvoid main()\n{\n    gl_FragColor = u_highlightColor;\n}\n";Z3.prototype.createFeatures=function(e,t){for(var i=this._batchIds,n=i.length,r=0;r<n;++r){var a=i[r];t[a]=new KX(e,a)}},Z3.prototype.applyDebugSettings=function(e,t){this._highlightColor=e?t:this._constantColor};var i4=new uf,n4=uf.WHITE;Z3.prototype.applyStyle=function(e,t){if(Object(u.a)(e))for(var i=this._batchIds,n=i.length,r=0;r<n;++r){var a=t[i[r]];a.color=Object(u.a)(e.color)?e.color.evaluateColor(a,i4):n4,a.show=!Object(u.a)(e.show)||e.show.evaluate(a)}else!function(e,t){for(var i=e._batchIds,n=i.length,r=0;r<n;++r){var a=t[i[r]];a.show=!0,a.color=uf.WHITE}}(this,t)},Z3.prototype.update=function(e){var t=e.context;if(J3(this,t),function(e,t){Object(u.a)(e._uniformMap)||(e._uniformMap={u_modifiedModelView:function(){var i=t.uniformState.view;return Be.clone(i,$3),Be.multiplyByPoint($3,e._center,e4),Be.setTranslation($3,e4,$3),$3},u_highlightColor:function(){return e._highlightColor}})}(this,t),function(e,t){if(!Object(u.a)(e._sp)){var i=e._batchTable,n=i.getVertexShaderCallback(!1,"a_batchId",void 0)(X3),r=i.getFragmentShaderCallback()(t4,!1,void 0),a=new UN({defines:["VECTOR_TILE",Ri.isInternetExplorer()?"":"CLIP_POLYLINE"],sources:[wB,n]}),o=new UN({defines:["VECTOR_TILE"],sources:[r]});e._sp=bR.fromCache({context:t,vertexShaderSource:a,fragmentShaderSource:o,attributeLocations:K3})}}(this,t),function(e){if(!Object(u.a)(e._rs)){e._rs=RM.fromCache({blending:FD.ALPHA_BLEND,depthMask:!1,depthTest:{enabled:!0},polygonOffset:{enabled:!0,factor:-5,units:-5}})}}(this),this._ready){var i=e.passes;(i.render||i.pick)&&function(e,t){if(!Object(u.a)(e._command)){var i=e._batchTable.getUniformMapCallback()(e._uniformMap);e._command=new cM({owner:e,vertexArray:e._va,renderState:e._rs,shaderProgram:e._sp,uniformMap:i,boundingVolume:e._boundingVolume,pass:lM.TRANSLUCENT,pickId:e._batchTable.getPickId()})}t.commandList.push(e._command)}(this,e)}},Z3.prototype.isDestroyed=function(){return!1},Z3.prototype.destroy=function(){return this._va=this._va&&this._va.destroy(),this._sp=this._sp&&this._sp.destroy(),rl(this)};var r4=Z3;function a4(e,t,i,n,r){this._tileset=e,this._tile=t,this._resource=i,this._polygons=void 0,this._polylines=void 0,this._points=void 0,this._contentReadyPromise=void 0,this._readyPromise=Oi.a.defer(),this._batchTable=void 0,this._features=void 0,this.featurePropertiesDirty=!1,function(e,t,i){i=Object(w.a)(i,0);var n=new Uint8Array(t),r=new DataView(t);i+=s4;var a=r.getUint32(i,!0);if(1!==a)throw new Ce.a("Only Vector tile version 1 is supported.  Version "+a+" is not.");i+=s4;var o=r.getUint32(i,!0);if(i+=s4,0===o)return void e._readyPromise.resolve(e);var s=r.getUint32(i,!0);if(i+=s4,0===s)throw new Ce.a("Feature table must have a byte length greater than zero");var c=r.getUint32(i,!0);i+=s4;var l=r.getUint32(i,!0);i+=s4;var h=r.getUint32(i,!0);i+=s4;var d=r.getUint32(i,!0);i+=s4;var f=r.getUint32(i,!0);i+=s4;var p=r.getUint32(i,!0);i+=s4;var m=r.getUint32(i,!0),_=is(n,i+=s4,s),g=JSON.parse(_);i+=s;var v,b,y=new Uint8Array(t,i,c);if(i+=c,l>0){var O=is(n,i,l);v=JSON.parse(O),i+=l,h>0&&(b=new Uint8Array(t,i,h),b=new Uint8Array(b),i+=h)}var x,E,T,C=Object(w.a)(g.POLYGONS_LENGTH,0),S=Object(w.a)(g.POLYLINES_LENGTH,0),A=Object(w.a)(g.POINTS_LENGTH,0),P=C+S+A,D=new ZX(e,P,v,b,function(e){return function(t,i){Object(u.a)(e._polygons)&&e._polygons.updateCommands(t,i)}}(e));if(e._batchTable=D,0===P)return;if(!Object(u.a)(g.REGION))throw new Ce.a("REGION is required in the feature table.");var j=g.REGION;x=Ve.unpack(j),E=j[4],T=j[5];var M,R=e._tile.computedTransform;Object(u.a)(g.RTC_CENTER)?(M=z.unpack(g.RTC_CENTER),Be.multiplyByPoint(R,M,M)):((M=Ve.center(x)).height=I.lerp(E,T,.5),M=ae.WGS84.cartographicToCartesian(M));var L=function(e,t){var i,n,r,a,o=Object(w.a)(e.POLYGONS_LENGTH,0),s=Object(w.a)(e.POLYLINES_LENGTH,0),c=Object(w.a)(e.POINTS_LENGTH,0);if(o>0&&Object(u.a)(e.POLYGON_BATCH_IDS)){var l=t.byteOffset+e.POLYGON_BATCH_IDS.byteOffset;i=new Uint16Array(t.buffer,l,o)}if(s>0&&Object(u.a)(e.POLYLINE_BATCH_IDS)){var h=t.byteOffset+e.POLYLINE_BATCH_IDS.byteOffset;n=new Uint16Array(t.buffer,h,s)}if(c>0&&Object(u.a)(e.POINT_BATCH_IDS)){var d=t.byteOffset+e.POINT_BATCH_IDS.byteOffset;r=new Uint16Array(t.buffer,d,c)}var f=Object(u.a)(i)||Object(u.a)(n)||Object(u.a)(r),p=o>0&&!Object(u.a)(i)||s>0&&!Object(u.a)(n)||c>0&&!Object(u.a)(r);if(f&&p)throw new Ce.a("If one group of batch ids is defined, then all batch ids must be defined.");if(!Object(u.a)(i)&&!Object(u.a)(n)&&!Object(u.a)(r)){var m=0;if(!Object(u.a)(i)&&o>0)for(i=new Uint16Array(o),a=0;a<o;++a)i[a]=m++;if(!Object(u.a)(n)&&s>0)for(n=new Uint16Array(s),a=0;a<s;++a)n[a]=m++;if(!Object(u.a)(r)&&c>0)for(r=new Uint16Array(c),a=0;a<c;++a)r[a]=m++}return{polygons:i,polylines:n,points:r}}(g,y);if(i+=i%4,C>0){var N=new Uint32Array(t,i,d/s4);i+=d;var F=new Uint16Array(t,i,f/o4);i+=f;var k,B,U=y.byteOffset+g.POLYGON_COUNT.byteOffset,V=new Uint32Array(y.buffer,U,C),H=y.byteOffset+g.POLYGON_INDEX_COUNT.byteOffset,G=new Uint32Array(y.buffer,H,C);if(Object(u.a)(g.POLYGON_MINIMUM_HEIGHTS)&&Object(u.a)(g.POLYGON_MAXIMUM_HEIGHTS)){var q=y.byteOffset+g.POLYGON_MINIMUM_HEIGHTS.byteOffset;k=new Float32Array(y.buffer,q,C);var W=y.byteOffset+g.POLYGON_MAXIMUM_HEIGHTS.byteOffset;B=new Float32Array(y.buffer,W,C)}e._polygons=new Y3({positions:F,counts:V,indexCounts:G,indices:N,minimumHeight:E,maximumHeight:T,polygonMinimumHeights:k,polygonMaximumHeights:B,center:M,rectangle:x,boundingVolume:e.tile.boundingVolume.boundingVolume,batchTable:D,batchIds:L.polygons,modelMatrix:R})}if(S>0){var Y=new Uint16Array(t,i,p/o4);i+=p;var X,Z=y.byteOffset+g.POLYLINE_COUNT.byteOffset,Q=new Uint32Array(y.buffer,Z,S);if(Object(u.a)(g.POLYLINE_WIDTHS)){var K=y.byteOffset+g.POLYLINE_WIDTHS.byteOffset;X=new Uint16Array(y.buffer,K,S)}else{X=new Uint16Array(S);for(var J=0;J<S;++J)X[J]=2}e._polylines=new r4({positions:Y,widths:X,counts:Q,batchIds:L.polylines,minimumHeight:E,maximumHeight:T,center:M,rectangle:x,boundingVolume:e.tile.boundingVolume.boundingVolume,batchTable:D})}if(A>0){var $=new Uint16Array(t,i,m/o4);e._points=new V3({positions:$,batchIds:L.points,minimumHeight:E,maximumHeight:T,rectangle:x,batchTable:D})}}(this,n,r)}Object(O.a)(a4.prototype,{featuresLength:{get:function(){return Object(u.a)(this._batchTable)?this._batchTable.featuresLength:0}},pointsLength:{get:function(){return Object(u.a)(this._points)?this._points.pointsLength:0}},trianglesLength:{get:function(){var e=0;return Object(u.a)(this._polygons)&&(e+=this._polygons.trianglesLength),Object(u.a)(this._polylines)&&(e+=this._polylines.trianglesLength),e}},geometryByteLength:{get:function(){var e=0;return Object(u.a)(this._polygons)&&(e+=this._polygons.geometryByteLength),Object(u.a)(this._polylines)&&(e+=this._polylines.geometryByteLength),e}},texturesByteLength:{get:function(){return Object(u.a)(this._points)?this._points.texturesByteLength:0}},batchTableByteLength:{get:function(){return Object(u.a)(this._batchTable)?this._batchTable.memorySizeInBytes:0}},innerContents:{get:function(){}},readyPromise:{get:function(){return this._readyPromise.promise}},tileset:{get:function(){return this._tileset}},tile:{get:function(){return this._tile}},url:{get:function(){return this._resource.getUrlComponent(!0)}},batchTable:{get:function(){return this._batchTable}}});var o4=Uint16Array.BYTES_PER_ELEMENT,s4=Uint32Array.BYTES_PER_ELEMENT;function c4(e){var t=e.featuresLength;if(!Object(u.a)(e._features)&&t>0){var i=new Array(t);Object(u.a)(e._polygons)&&e._polygons.createFeatures(e,i),Object(u.a)(e._polylines)&&e._polylines.createFeatures(e,i),Object(u.a)(e._points)&&e._points.createFeatures(e,i),e._features=i}}a4.prototype.hasProperty=function(e,t){return this._batchTable.hasProperty(e,t)},a4.prototype.getFeature=function(e){var t=this.featuresLength;if(!Object(u.a)(e)||e<0||e>=t)throw new h.a("batchId is required and between zero and featuresLength - 1 ("+(t-1)+").");return c4(this),this._features[e]},a4.prototype.applyDebugSettings=function(e,t){Object(u.a)(this._polygons)&&this._polygons.applyDebugSettings(e,t),Object(u.a)(this._polylines)&&this._polylines.applyDebugSettings(e,t),Object(u.a)(this._points)&&this._points.applyDebugSettings(e,t)},a4.prototype.applyStyle=function(e){c4(this),Object(u.a)(this._polygons)&&this._polygons.applyStyle(e,this._features),Object(u.a)(this._polylines)&&this._polylines.applyStyle(e,this._features),Object(u.a)(this._points)&&this._points.applyStyle(e,this._features)},a4.prototype.update=function(e,t){var i=!0;if(Object(u.a)(this._polygons)&&(this._polygons.classificationType=this._tileset.classificationType,this._polygons.debugWireframe=this._tileset.debugWireframe,this._polygons.update(t),i=i&&this._polygons._ready),Object(u.a)(this._polylines)&&(this._polylines.update(t),i=i&&this._polylines._ready),Object(u.a)(this._points)&&(this._points.update(t),i=i&&this._points._ready),Object(u.a)(this._batchTable)&&i&&this._batchTable.update(e,t),!Object(u.a)(this._contentReadyPromise)){var n=Object(u.a)(this._points)?this._points.readyPromise:void 0,r=Object(u.a)(this._polygons)?this._polygons.readyPromise:void 0,a=Object(u.a)(this._polylines)?this._polylines.readyPromise:void 0,o=this;this._contentReadyPromise=Oi.a.all([n,r,a]).then((function(){o._readyPromise.resolve(o)}))}},a4.prototype.isDestroyed=function(){return!1},a4.prototype.destroy=function(){return this._polygons=this._polygons&&this._polygons.destroy(),this._polylines=this._polylines&&this._polylines.destroy(),this._points=this._points&&this._points.destroy(),this._batchTable=this._batchTable&&this._batchTable.destroy(),rl(this)};var l4=a4;function u4(e,t,i,n,r){this._tileset=e,this._tile=t,this._resource=i,this._model=void 0,this._batchTable=void 0,this._features=void 0,this._batchIdAttributeName=void 0,this._diffuseAttributeOrUniformName={},this._rtcCenterTransform=void 0,this._contentModelMatrix=void 0,this.featurePropertiesDirty=!1,function(e,t,i){var n,r,a,o,s=e._tileset,c=e._tile,l=e._resource,h=new Uint8Array(t),d=is(h,i),f=JSON.parse(d),p=new eZ({BATCH_LENGTH:Object(w.a)(n,0)},void 0);Object(u.a)(s.classificationType)&&(a=function(e){return function(t,i){e._model.updateCommands(t,i)}}(e));Object(u.a)(f.asset.extras)?((r={extensions:{"3DTILES_batch_table_hierarchy":{}}}).extensions["3DTILES_batch_table_hierarchy"]=f.asset.extras.batchInfo,n=r.extensions["3DTILES_batch_table_hierarchy"].instancesLength,o=new ZX(e,n,r,void 0,a),e._batchTable=o):(o=new ZX(e,0,r,void 0,a),e._batchTable=o);var m={content:e,primitive:s};e._rtcCenterTransform=Be.IDENTITY;var _=p.getGlobalProperty("RTC_CENTER",dn.FLOAT,3);Object(u.a)(_)&&(e._rtcCenterTransform=Be.fromTranslation(z.fromArray(_)));e._contentModelMatrix=Be.multiply(c.computedTransform,e._rtcCenterTransform,new Be),Object(u.a)(s.classificationType)?e._model=new FK({gltf:f,cull:!1,basePath:l,requestType:Hl.a.TILES3D,modelMatrix:e._contentModelMatrix,upAxis:s._gltfUpAxis,forwardAxis:mX.X,debugWireframe:s.debugWireframe,vertexShaderLoaded:h4(e),classificationShaderLoaded:m4(e),uniformMapLoaded:o.getUniformMapCallback(),pickIdLoaded:p4(e),classificationType:s._classificationType,batchTable:o}):e._model=new J0({gltf:f,cull:!1,releaseGltfJson:!0,opaquePass:lM.CESIUM_3D_TILE,basePath:l,requestType:Hl.a.TILES3D,modelMatrix:e._contentModelMatrix,upAxis:s._gltfUpAxis,forwardAxis:mX.X,shadows:s.shadows,debugWireframe:s.debugWireframe,incrementallyLoadTextures:!1,vertexShaderLoaded:h4(e),fragmentShaderLoaded:d4(e),uniformMapLoaded:o.getUniformMapCallback(),pickIdLoaded:p4(e),addBatchIdToGeneratedShaders:n>0,pickObject:m,imageBasedLightingFactor:s.imageBasedLightingFactor,lightColor:s.lightColor,luminanceAtZenith:s.luminanceAtZenith,sphericalHarmonicCoefficients:s.sphericalHarmonicCoefficients,specularEnvironmentMaps:s.specularEnvironmentMaps,useGradual:s._useGradual,shouldAnimate:s._shouldAnimate,planView:s._planView,centerPos:s._centerPos,dequantizeInShader:s._dequantizeInShader,dracoModel:s._dracoModel,calcEdge:s._calcEdge,forceMipmap:s._forceMipmap,pbrBufferLoaded:f4(e)})}(this,n,r)}u4._deprecationWarning=mv.a,Object(O.a)(u4.prototype,{featuresLength:{get:function(){return this._batchTable.featuresLength}},pointsLength:{get:function(){return 0}},trianglesLength:{get:function(){return this._model.trianglesLength}},geometryByteLength:{get:function(){return this._model.geometryByteLength}},texturesByteLength:{get:function(){return this._model.texturesByteLength}},batchTableByteLength:{get:function(){return this._batchTable.memorySizeInBytes}},innerContents:{get:function(){}},readyPromise:{get:function(){return this._model.readyPromise}},tileset:{get:function(){return this._tileset}},tile:{get:function(){return this._tile}},url:{get:function(){return this._resource.getUrlComponent(!0)}},batchTable:{get:function(){return this._batchTable}}});Uint32Array.BYTES_PER_ELEMENT;function h4(e){return function(t,i){var n=e._batchTable,r=!Object(u.a)(e._tileset.classificationType),a=e._model.gltf;Object(u.a)(a)&&(e._batchIdAttributeName=function(e){var t=wQ.getAttributeOrUniformBySemantic(e,"_BATCHID");return Object(u.a)(t)||(t=wQ.getAttributeOrUniformBySemantic(e,"BATCHID"),Object(u.a)(t)&&u4._deprecationWarning("b3dm-legacy-batchid","The glTF in this b3dm uses the semantic `BATCHID`. Application-specific semantics should be prefixed with an underscore: `_BATCHID`.")),t}(a),e._diffuseAttributeOrUniformName[i]=wQ.getDiffuseAttributeOrUniform(a,i));var o=n.getVertexShaderCallback(r,e._batchIdAttributeName,e._diffuseAttributeOrUniformName[i]);return Object(u.a)(o)?o(t):t}}function d4(e){return function(t,i){var n=e._batchTable,r=!Object(u.a)(e._tileset.classificationType),a=e._model.gltf;Object(u.a)(a)&&(e._diffuseAttributeOrUniformName[i]=wQ.getDiffuseAttributeOrUniform(a,i));var o=n.getFragmentShaderCallback(r,e._diffuseAttributeOrUniformName[i]);return Object(u.a)(o)?o(t):t}}function f4(e){return function(){var t=e._batchTable._extensions["3DTILES_batch_table_hierarchy"];return Object(u.a)(t)?t.pbrBuffer:void 0}}function p4(e){return function(){return e._batchTable.getPickId()}}function m4(e){return function(t){var i=e._batchTable.getClassificationFragmentShaderCallback();return Object(u.a)(i)?i(t):t}}u4.prototype.hasProperty=function(e,t){return this._batchTable.hasProperty(e,t)},u4.prototype.getFeature=function(e){var t=this.featuresLength;if(!Object(u.a)(e)||e<0||e>=t)throw new h.a("batchId is required and between zero and featuresLength - 1 ("+(t-1)+").");return function(e){var t=e.featuresLength;if(!Object(u.a)(e._features)&&t>0){for(var i=new Array(t),n=0;n<t;++n)i[n]=new KX(e,n);e._features=i}}(this),this._features[e]},u4.prototype.applyDebugSettings=function(e,t){t=e?t:uf.WHITE,0===this.featuresLength?this._model.color=t:this._batchTable.setAllColor(t)};var _4=new uf;u4.prototype.applyStyle=function(e){if(0===this.featuresLength){var t=Object(u.a)(e)&&Object(u.a)(e.color),i=Object(u.a)(e)&&Object(u.a)(e.show);this._model.color=t?e.color.evaluateColor(void 0,_4):uf.WHITE,this._model.show=!i||e.show.evaluate(void 0)}else this._batchTable.applyStyle(e)},u4.prototype.update=function(e,t){var i=t.commandList.length;this._batchTable.update(e,t),this._contentModelMatrix=Be.multiply(this._tile.computedTransform,this._rtcCenterTransform,this._contentModelMatrix),this._model.modelMatrix=this._contentModelMatrix,this._model.shadows=this._tileset.shadows,this._model.imageBasedLightingFactor=this._tileset.imageBasedLightingFactor,this._model.lightColor=this._tileset.lightColor,this._model.luminanceAtZenith=this._tileset.luminanceAtZenith,this._model.sphericalHarmonicCoefficients=this._tileset.sphericalHarmonicCoefficients,this._model.specularEnvironmentMaps=this._tileset.specularEnvironmentMaps,this._model.debugWireframe=this._tileset.debugWireframe;var n=this._tileset.clippingPlanes;this._model.clippingPlanesOriginMatrix=this._tileset.clippingPlanesOriginMatrix,Object(u.a)(n)&&this._tile.clippingPlanesDirty&&(this._model._clippingPlanes=n.enabled&&this._tile._isClipped?n:void 0),Object(u.a)(n)&&Object(u.a)(this._model._clippingPlanes)&&this._model._clippingPlanes!==n&&(this._model._clippingPlanes=n);var r=e._useGradual;Object(u.a)(r)&&(this._model.useGradual=r);var a=e._shouldAnimate;Object(u.a)(a)&&(this._model.shouldAnimate=a);var o=e._planView;Object(u.a)(o)&&(this._model.planView=o);var s=e._centerPos;Object(u.a)(s)&&(this._model.centerPos=s),this._model.update(t),i<t.commandList.length&&(t.passes.render||t.passes.pick)&&!Object(u.a)(e.classificationType)&&this._batchTable.addDerivedCommands(t,i)},u4.prototype.isDestroyed=function(){return!1},u4.prototype.destroy=function(){return this._model=this._model&&this._model.destroy(),this._batchTable=this._batchTable&&this._batchTable.destroy(),rl(this)};var g4=u4,v4={b3dm:function(e,t,i,n,r){return new s1(e,t,i,n,r)},pnts:function(e,t,i,n,r){return new w2(e,t,i,n,r)},i3dm:function(e,t,i,n,r){return new V1(e,t,i,n,r)},cmpt:function(e,t,i,n,r){return new u1(e,t,i,n,r,v4)},json:function(e,t,i,n,r){return new x2(e,t,i,n,r)},geom:function(e,t,i,n,r){return new b1(e,t,i,n,r)},vctr:function(e,t,i,n,r){return new l4(e,t,i,n,r)},gltf:function(e,t,i,n,r){return new g4(e,t,i,n,r)}},b4=v4,y4=Object(E.a)({UNLOADED:0,LOADING:1,PROCESSING:2,READY:3,EXPIRED:4,FAILED:5}),w4=Object(E.a)({NOT_COMPUTED:-1,USE_OPTIMIZATION:1,SKIP_OPTIMIZATION:0});function O4(e,t){this._tileset=e,this._tile=t,this.featurePropertiesDirty=!1}Object(O.a)(O4.prototype,{featuresLength:{get:function(){return 0}},pointsLength:{get:function(){return 0}},trianglesLength:{get:function(){return 0}},geometryByteLength:{get:function(){return 0}},texturesByteLength:{get:function(){return 0}},batchTableByteLength:{get:function(){return 0}},innerContents:{get:function(){}},readyPromise:{get:function(){}},tileset:{get:function(){return this._tileset}},tile:{get:function(){return this._tile}},url:{get:function(){}},batchTable:{get:function(){}}}),O4.prototype.hasProperty=function(e,t){return!1},O4.prototype.getFeature=function(e){},O4.prototype.applyDebugSettings=function(e,t){},O4.prototype.applyStyle=function(e){},O4.prototype.update=function(e,t){},O4.prototype.isDestroyed=function(){return!1},O4.prototype.destroy=function(){return rl(this)};var x4=O4;function E4(e){x.a.typeOf.object("options",e),x.a.typeOf.object("options.rectangle",e.rectangle),this.rectangle=Ve.clone(e.rectangle),this.minimumHeight=Object(w.a)(e.minimumHeight,0),this.maximumHeight=Object(w.a)(e.maximumHeight,0),this.southwestCornerCartesian=new z,this.northeastCornerCartesian=new z,this.westNormal=new z,this.southNormal=new z,this.eastNormal=new z,this.northNormal=new z;var t=Object(w.a)(e.ellipsoid,ae.WGS84);!function(e,t,i){i.cartographicToCartesian(Ve.southwest(t),e.southwestCornerCartesian),i.cartographicToCartesian(Ve.northeast(t),e.northeastCornerCartesian),D4.longitude=t.west,D4.latitude=.5*(t.south+t.north),D4.height=0;var n=i.cartographicToCartesian(D4,P4),r=z.cross(n,z.UNIT_Z,T4);z.normalize(r,e.westNormal),D4.longitude=t.east;var a=i.cartographicToCartesian(D4,I4),o=z.cross(z.UNIT_Z,a,T4);z.normalize(o,e.eastNormal);var s,c=z.subtract(n,a,T4),l=z.normalize(c,A4),u=t.south;if(u>0){D4.longitude=.5*(t.west+t.east),D4.latitude=u;var h=i.cartographicToCartesian(D4,M4.origin);z.clone(l,M4.direction);var d=oc.fromPointNormal(e.southwestCornerCartesian,e.westNormal,j4);tc.rayPlane(M4,d,e.southwestCornerCartesian),s=i.geodeticSurfaceNormal(h,C4)}else s=i.geodeticSurfaceNormalCartographic(Ve.southeast(t),C4);var f=z.cross(s,c,S4);z.normalize(f,e.southNormal);var p,m=t.north;if(m<0){D4.longitude=.5*(t.west+t.east),D4.latitude=m;var _=i.cartographicToCartesian(D4,M4.origin);z.negate(l,M4.direction);var g=oc.fromPointNormal(e.northeastCornerCartesian,e.eastNormal,j4);tc.rayPlane(M4,g,e.northeastCornerCartesian),p=i.geodeticSurfaceNormal(_,C4)}else p=i.geodeticSurfaceNormalCartographic(Ve.northwest(t),C4);var v=z.cross(c,p,S4);z.normalize(v,e.northNormal)}(this,e.rectangle,t),this._orientedBoundingBox=Fc.fromRectangle(this.rectangle,this.minimumHeight,this.maximumHeight,t),this._boundingSphere=St.fromOrientedBoundingBox(this._orientedBoundingBox)}Object(O.a)(E4.prototype,{boundingVolume:{get:function(){return this._orientedBoundingBox}},boundingSphere:{get:function(){return this._boundingSphere}}});var T4=new z,C4=new z,S4=new z,A4=new z,P4=new z,I4=new z,D4=new K,j4=new oc(z.UNIT_X,0),M4=new Ts;var R4=new z,L4=new z,N4=new z(0,-1,0),F4=new z(0,0,-1),k4=new z;E4.prototype.distanceToCamera=function(e){x.a.defined("frameState",e);var t=e.camera,i=t.positionWC,n=t.positionCartographic,r=0;if(!Ve.contains(this.rectangle,n)){var a=this.southwestCornerCartesian,o=this.northeastCornerCartesian,s=this.westNormal,c=this.southNormal,l=this.eastNormal,u=this.northNormal;e.mode!==xF.SCENE3D&&((a=e.mapProjection.project(Ve.southwest(this.rectangle),R4)).z=a.y,a.y=a.x,a.x=0,(o=e.mapProjection.project(Ve.northeast(this.rectangle),L4)).z=o.y,o.y=o.x,o.x=0,s=N4,l=z.UNIT_Y,c=F4,u=z.UNIT_Z);var h=z.subtract(i,a,k4),d=z.dot(h,s),f=z.dot(h,c),p=z.subtract(i,o,k4),m=z.dot(p,l),_=z.dot(p,u);d>0?r+=d*d:m>0&&(r+=m*m),f>0?r+=f*f:_>0&&(r+=_*_)}var g=(e.mode===xF.SCENE3D?n.height:i.x)-(e.mode===xF.SCENE3D?this.maximumHeight:0);return g>0&&(r+=g*g),Math.sqrt(r)},E4.prototype.intersectPlane=function(e){return x.a.defined("plane",e),this._orientedBoundingBox.intersectPlane(e)},E4.prototype.createDebugVolume=function(e){x.a.defined("color",e);var t=new Be.clone(Be.IDENTITY),i=new pS({rectangle:this.rectangle,height:this.minimumHeight,extrudedHeight:this.maximumHeight}),n=new Mu({geometry:i,id:"outline",modelMatrix:t,attributes:{color:df.fromColor(e)}});return new ck({geometryInstances:n,appearance:new $j({translucent:!1,flat:!0}),asynchronous:!1})};var B4=E4;function z4(e,t){this._boundingSphere=new St(e,t)}Object(O.a)(z4.prototype,{center:{get:function(){return this._boundingSphere.center}},radius:{get:function(){return this._boundingSphere.radius}},boundingVolume:{get:function(){return this._boundingSphere}},boundingSphere:{get:function(){return this._boundingSphere}}}),z4.prototype.distanceToCamera=function(e){x.a.defined("frameState",e);var t=this._boundingSphere;return Math.max(0,z.distance(t.center,e.camera.positionWC)-t.radius)},z4.prototype.intersectPlane=function(e){return x.a.defined("plane",e),St.intersectPlane(this._boundingSphere,e)},z4.prototype.update=function(e,t){z.clone(e,this._boundingSphere.center),this._boundingSphere.radius=t},z4.prototype.createDebugVolume=function(e){x.a.defined("color",e);var t=new NP({radius:this.radius}),i=Be.fromTranslation(this.center,new Be.clone(Be.IDENTITY)),n=new Mu({geometry:t,id:"outline",modelMatrix:i,attributes:{color:df.fromColor(e)}});return new ck({geometryInstances:n,appearance:new $j({translucent:!1,flat:!0}),asynchronous:!1})};var U4=z4;function V4(e,t){this._orientedBoundingBox=new Fc(e,t),this._boundingSphere=St.fromOrientedBoundingBox(this._orientedBoundingBox)}Object(O.a)(V4.prototype,{boundingVolume:{get:function(){return this._orientedBoundingBox}},boundingSphere:{get:function(){return this._boundingSphere}}}),V4.prototype.distanceToCamera=function(e){return x.a.defined("frameState",e),Math.sqrt(this._orientedBoundingBox.distanceSquaredTo(e.camera.positionWC))},V4.prototype.intersectPlane=function(e){return x.a.defined("plane",e),this._orientedBoundingBox.intersectPlane(e)},V4.prototype.update=function(e,t){z.clone(e,this._orientedBoundingBox.center),be.clone(t,this._orientedBoundingBox.halfAxes),St.fromOrientedBoundingBox(this._orientedBoundingBox,this._boundingSphere)},V4.prototype.createDebugVolume=function(e){x.a.defined("color",e);var t=new $a({minimum:new z(-1,-1,-1),maximum:new z(1,1,1)}),i=Be.fromRotationTranslation(this.boundingVolume.halfAxes,this.boundingVolume.center),n=new Mu({geometry:t,id:"outline",modelMatrix:i,attributes:{color:df.fromColor(e)}});return new ck({geometryInstances:n,appearance:new $j({translucent:!1,flat:!0}),asynchronous:!1})};var H4=V4;function G4(e,t,i,n){this._tileset=e,this._header=i;var r=i.content;this.transform=Object(u.a)(i.transform)?Be.unpack(i.transform):Be.clone(Be.IDENTITY);var a,o,s,c,l,h,d,p,m=Object(u.a)(n)?n.computedTransform:e.modelMatrix,_=Be.multiply(m,this.transform,new Be),g=Object(u.a)(n)?n._initialTransform:Be.IDENTITY;if(this._initialTransform=Be.multiply(g,this.transform,new Be),this.computedTransform=_,this._boundingVolume=this.createBoundingVolume(i.boundingVolume,_),this._boundingVolume2D=void 0,Object(u.a)(r)&&Object(u.a)(r.boundingVolume)&&(a=this.createBoundingVolume(r.boundingVolume,_)),this._contentBoundingVolume=a,this._contentBoundingVolume2D=void 0,Object(u.a)(i.viewerRequestVolume)&&(o=this.createBoundingVolume(i.viewerRequestVolume,_)),this._viewerRequestVolume=o,this.geometricError=i.geometricError,Object(u.a)(this.geometricError)||(this.geometricError=Object(u.a)(n)?n.geometricError:e._geometricError,G4._deprecationWarning("geometricErrorUndefined","Required property geometricError is undefined for this tile. Using parent's geometric error instead.")),Object(u.a)(i.refine)?("replace"!==i.refine&&"add"!==i.refine||G4._deprecationWarning("lowercase-refine",'This tile uses a lowercase refine "'+i.refine+'". Instead use "'+i.refine.toUpperCase()+'".'),s="REPLACE"===i.refine.toUpperCase()?H1.REPLACE:H1.ADD):s=Object(u.a)(n)?n.refine:H1.REPLACE,this.refine=s,this.children=[],this.parent=n,t=f.a.createIfNeeded(t),Object(u.a)(r)){var v=r.uri;Object(u.a)(r.url)&&(G4._deprecationWarning("contentUrl",'This tileset JSON uses the "content.url" property which has been deprecated. Use "content.uri" instead.'),v=r.url),l=!1,h=y4.UNLOADED,d=t.getDerivedResource({url:v}),p=bS.a.getServerKey(d.getUrlComponent())}else c=new x4(e,this),l=!0,h=y4.READY;this._content=c,this._contentResource=d,this._contentState=h,this._contentReadyToProcessPromise=void 0,this._contentReadyPromise=void 0,this._expiredContent=void 0,this._serverKey=p,this.hasEmptyContent=l,this.hasTilesetContent=!1,this.cacheNode=void 0;var b,y,w=i.expire;Object(u.a)(w)&&(b=w.duration,Object(u.a)(w.date)&&(y=Tr.fromIso8601(w.date))),this.expireDuration=b,this.expireDate=y,this.lastStyleTime=0,this._optimChildrenWithinParent=w4.NOT_COMPUTED,this.clippingPlanesDirty=!1,this._distanceToCamera=0,this._centerZDepth=0,this._screenSpaceError=0,this._visibilityPlaneMask=0,this._visible=!1,this._inRequestVolume=!1,this._finalResolution=!0,this._depth=0,this._stackLength=0,this._selectionDepth=0,this._updatedVisibilityFrame=0,this._touchedFrame=0,this._visitedFrame=0,this._selectedFrame=0,this._requestedFrame=0,this._ancestorWithContent=void 0,this._ancestorWithContentAvailable=void 0,this._refines=!1,this._shouldSelect=!1,this._priority=0,this._isClipped=!0,this._clippingPlanesState=0,this._debugBoundingVolume=void 0,this._debugContentBoundingVolume=void 0,this._debugViewerRequestVolume=void 0,this._debugColor=uf.fromRandom({alpha:1}),this._debugColorizeTiles=!1,this._commandsLength=0,this._color=void 0,this._colorDirty=!1}G4._deprecationWarning=mv.a,Object(O.a)(G4.prototype,{tileset:{get:function(){return this._tileset}},content:{get:function(){return this._content}},boundingVolume:{get:function(){return this._boundingVolume}},contentBoundingVolume:{get:function(){return Object(w.a)(this._contentBoundingVolume,this._boundingVolume)}},boundingSphere:{get:function(){return this._boundingVolume.boundingSphere}},extras:{get:function(){return this._header.extras}},color:{get:function(){return Object(u.a)(this._color)||(this._color=new uf),uf.clone(this._color)},set:function(e){this._color=uf.clone(e,this._color),this._colorDirty=!0}},contentAvailable:{get:function(){return this.contentReady&&!this.hasEmptyContent&&!this.hasTilesetContent||Object(u.a)(this._expiredContent)&&!this.contentFailed}},contentReady:{get:function(){return this._contentState===y4.READY}},contentUnloaded:{get:function(){return this._contentState===y4.UNLOADED}},contentExpired:{get:function(){return this._contentState===y4.EXPIRED}},contentFailed:{get:function(){return this._contentState===y4.FAILED}},contentReadyToProcessPromise:{get:function(){if(Object(u.a)(this._contentReadyToProcessPromise))return this._contentReadyToProcessPromise.promise}},contentReadyPromise:{get:function(){if(Object(u.a)(this._contentReadyPromise))return this._contentReadyPromise.promise}},commandsLength:{get:function(){return this._commandsLength}}});var q4=new Tr;G4.prototype.getScreenSpaceError=function(e,t){var i=this._tileset,n=Object(u.a)(this.parent)?this.parent.geometricError:i._geometricError,r=t?n:this.geometricError;if(0===r)return 0;var a,o=e.camera,s=o.frustum,c=e.context,l=c.drawingBufferWidth,h=c.drawingBufferHeight;if(e.mode===xF.SCENE2D||s instanceof hb){Object(u.a)(s._offCenterFrustum)&&(s=s._offCenterFrustum),a=r/(Math.max(s.top-s.bottom,s.right-s.left)/Math.max(l,h))}else{var d=Math.max(this._distanceToCamera,I.EPSILON7);if(a=r*h/(d*o.frustum.sseDenominator),i.dynamicScreenSpaceError){var f=i._dynamicScreenSpaceErrorComputedDensity,p=i.dynamicScreenSpaceErrorFactor;a-=I.fog(d,f)*p}}return a},G4.prototype.updateVisibility=function(e){var t=this.parent,i=Object(u.a)(t)?t.computedTransform:this._tileset.modelMatrix,n=Object(u.a)(t)?t._visibilityPlaneMask:Wg.MASK_INDETERMINATE;this.updateTransform(i),this._distanceToCamera=this.distanceToTile(e),this._centerZDepth=this.distanceToTileCenter(e),this._screenSpaceError=this.getScreenSpaceError(e,!1),this._visibilityPlaneMask=this.visibility(e,n),this._visible=this._visibilityPlaneMask!==Wg.MASK_OUTSIDE,this._inRequestVolume=this.insideViewerRequestVolume(e)},G4.prototype.updateExpiration=function(){if(Object(u.a)(this.expireDate)&&this.contentReady&&!this.hasEmptyContent){var e=Tr.now(q4);Tr.lessThan(this.expireDate,e)&&(this._contentState=y4.EXPIRED,this._expiredContent=this._content)}},G4.prototype.requestContent=function(){var e=this,t=this._tileset;if(this.hasEmptyContent)return!1;var i=this._contentResource.clone(),n=this.contentExpired;n&&i.setQueryParameters({expired:this.expireDate.toString()});var r,a=new Vl.a({throttle:!0,throttleByServer:!0,type:Hl.a.TILES3D,priorityFunction:(r=this,function(){return r._priority}),serverKey:this._serverKey});i.request=a;var o=i.fetchArrayBuffer();if(!Object(u.a)(o))return!1;var s=this._contentState;this._contentState=y4.LOADING,this._contentReadyToProcessPromise=Oi.a.defer(),this._contentReadyPromise=Oi.a.defer(),n&&(this.expireDate=void 0);var c=function(e){return function(t){e._contentState=y4.FAILED,e._contentReadyPromise.reject(t),e._contentReadyToProcessPromise.reject(t)}}(this),l=i.extension;return o.then((function(i){if(!e.isDestroyed()){var n,r=new Uint8Array(i);n="gltf"==l?"gltf":cy(r);var a,o=b4[n];return t._disableSkipLevelOfDetail=t._disableSkipLevelOfDetail||"vctr"===n||"geom"===n,Object(u.a)(o)?a=o(t,e,e._contentResource,i,0):(a=b4.json(t,e,e._contentResource,i,0),e.hasTilesetContent=!0),e._content=a,e._contentState=y4.PROCESSING,e._contentReadyToProcessPromise.resolve(a),a.readyPromise.then((function(t){e.isDestroyed()?c():(!function(e){if(Object(u.a)(e.expireDuration)){var t=Tr.now(q4);Tr.addSeconds(t,e.expireDuration,t),Object(u.a)(e.expireDate)?Tr.lessThan(e.expireDate,t)&&Tr.clone(t,e.expireDate):e.expireDate=Tr.clone(t)}}(e),e._selectedFrame=0,e.lastStyleTime=0,e._contentState=y4.READY,e._contentReadyPromise.resolve(t))}))}c()})).otherwise((function(i){if(a.state===Fy.a.CANCELLED)return e._contentState=s,--t.statistics.numberOfPendingRequests,void++t.statistics.numberOfAttemptedRequests;c(i)})),!0},G4.prototype.unloadContent=function(){this.hasEmptyContent||this.hasTilesetContent||(this._content=this._content&&this._content.destroy(),this._contentState=y4.UNLOADED,this._contentReadyToProcessPromise=void 0,this._contentReadyPromise=void 0,this.lastStyleTime=0,this.clippingPlanesDirty=0===this._clippingPlanesState,this._clippingPlanesState=0,this._debugColorizeTiles=!1,this._debugBoundingVolume=this._debugBoundingVolume&&this._debugBoundingVolume.destroy(),this._debugContentBoundingVolume=this._debugContentBoundingVolume&&this._debugContentBoundingVolume.destroy(),this._debugViewerRequestVolume=this._debugViewerRequestVolume&&this._debugViewerRequestVolume.destroy())};var W4=new St;function Y4(e,t){if(t.mode!==xF.SCENE3D&&!Object(u.a)(e._boundingVolume2D)){var i=e._boundingVolume.boundingSphere,n=St.projectTo2D(i,t.mapProjection,W4);e._boundingVolume2D=new U4(n.center,n.radius)}return t.mode!==xF.SCENE3D?e._boundingVolume2D:e._boundingVolume}G4.prototype.visibility=function(e,t){var i=e.cullingVolume,n=Y4(this,e),r=this._tileset,a=r.clippingPlanes;if(Object(u.a)(a)&&a.enabled){var o=a.computeIntersectionWithBoundingVolume(n,r.clippingPlanesOriginMatrix);if(this._isClipped=o!==ce.INSIDE,o===ce.OUTSIDE)return Wg.MASK_OUTSIDE}return i.computeVisibilityWithPlaneMask(n,t)},G4.prototype.contentVisibility=function(e){if(!Object(u.a)(this._contentBoundingVolume))return ce.INSIDE;if(this._visibilityPlaneMask===Wg.MASK_INSIDE)return ce.INSIDE;var t=e.cullingVolume,i=function(e,t){if(t.mode!==xF.SCENE3D&&!Object(u.a)(e._contentBoundingVolume2D)){var i=e._contentBoundingVolume.boundingSphere,n=St.projectTo2D(i,t.mapProjection,W4);e._contentBoundingVolume2D=new U4(n.center,n.radius)}return t.mode!==xF.SCENE3D?e._contentBoundingVolume2D:e._contentBoundingVolume}(this,e),n=this._tileset,r=n.clippingPlanes;if(Object(u.a)(r)&&r.enabled){var a=r.computeIntersectionWithBoundingVolume(i,n.clippingPlanesOriginMatrix);if(this._isClipped=a!==ce.INSIDE,a===ce.OUTSIDE)return ce.OUTSIDE}return t.computeVisibility(i)},G4.prototype.distanceToTile=function(e){return Y4(this,e).distanceToCamera(e)};var X4=new z;G4.prototype.distanceToTileCenter=function(e){var t=Y4(this,e).boundingVolume,i=z.subtract(t.center,e.camera.positionWC,X4),n=z.magnitude(i);return z.divideByScalar(i,n,i),n*z.dot(e.camera.directionWC,i)},G4.prototype.insideViewerRequestVolume=function(e){var t=this._viewerRequestVolume;return!Object(u.a)(t)||0===t.distanceToCamera(e)};var Z4=new be,Q4=new z,K4=new be,J4=new z,$4=new Ve,e5=new Fc,t5=new Be;function i5(e,t,i,n){if(!Be.equalsEpsilon(t,i,I.EPSILON8))return function(e,t,i,n){var r=Ve.unpack(e,0,$4),a=e[4],o=e[5],s=Fc.fromRectangle(r,a,o,ae.WGS84,e5),c=s.center,l=s.halfAxes;t=Be.multiplyTransformation(t,Be.inverseTransformation(i,t5),t5),c=Be.multiplyByPoint(t,c,c);var h=Be.getRotation(t,Z4);return l=be.multiply(h,l,l),Object(u.a)(n)&&n instanceof H4?(n.update(c,l),n):new H4(c,l)}(e,t,i,n);if(Object(u.a)(n))return n;var r=Ve.unpack(e,0,$4);return new B4({rectangle:r,minimumHeight:e[4],maximumHeight:e[5]})}G4.prototype.createBoundingVolume=function(e,t,i){if(!Object(u.a)(e))throw new Ce.a("boundingVolume must be defined");if(Object(u.a)(e.box))return function(e,t,i){var n=z.fromElements(e[0],e[1],e[2],J4),r=be.fromArray(e,3,K4);n=Be.multiplyByPoint(t,n,n);var a=Be.getRotation(t,Z4);return r=be.multiply(a,r,r),Object(u.a)(i)?(i.update(n,r),i):new H4(n,r)}(e.box,t,i);if(Object(u.a)(e.region))return i5(e.region,t,this._initialTransform,i);if(Object(u.a)(e.sphere))return function(e,t,i){var n=z.fromElements(e[0],e[1],e[2],J4),r=e[3];n=Be.multiplyByPoint(t,n,n);var a=Be.getScale(t,Q4);return r*=z.maximumComponent(a),Object(u.a)(i)?(i.update(n,r),i):new U4(n,r)}(e.sphere,t,i);throw new Ce.a("boundingVolume must contain a sphere, region, or box")},G4.prototype.updateTransform=function(e){e=Object(w.a)(e,Be.IDENTITY);var t=Be.multiply(e,this.transform,t5);if(!Be.equals(t,this.computedTransform)){Be.clone(t,this.computedTransform);var i=this._header,n=this._header.content;this._boundingVolume=this.createBoundingVolume(i.boundingVolume,this.computedTransform,this._boundingVolume),Object(u.a)(this._contentBoundingVolume)&&(this._contentBoundingVolume=this.createBoundingVolume(n.boundingVolume,this.computedTransform,this._contentBoundingVolume)),Object(u.a)(this._viewerRequestVolume)&&(this._viewerRequestVolume=this.createBoundingVolume(i.viewerRequestVolume,this.computedTransform,this._viewerRequestVolume)),this._debugBoundingVolume=this._debugBoundingVolume&&this._debugBoundingVolume.destroy(),this._debugContentBoundingVolume=this._debugContentBoundingVolume&&this._debugContentBoundingVolume.destroy(),this._debugViewerRequestVolume=this._debugViewerRequestVolume&&this._debugViewerRequestVolume.destroy()}},G4.prototype.update=function(e,t){var i=t.commandList.length;!function(e,t){var i=t.clippingPlanes,n=0;Object(u.a)(i)&&e._isClipped&&i.enabled&&(n=i.clippingPlanesState),n!==e._clippingPlanesState&&(e._clippingPlanesState=n,e.clippingPlanesDirty=!0)}(this,e),function(e,t,i){if(i.passes.render){var n=Object(u.a)(e._header.content)&&Object(u.a)(e._header.content.boundingVolume),r=e.hasEmptyContent||e.hasTilesetContent,a=t.debugShowBoundingVolume||t.debugShowContentBoundingVolume&&!n;if(a){var o;o=e._finalResolution?r?uf.DARKGRAY:uf.WHITE:uf.YELLOW,Object(u.a)(e._debugBoundingVolume)||(e._debugBoundingVolume=e._boundingVolume.createDebugVolume(o)),e._debugBoundingVolume.update(i);var s=e._debugBoundingVolume.getGeometryInstanceAttributes("outline");s.color=df.toValue(o,s.color)}else!a&&Object(u.a)(e._debugBoundingVolume)&&(e._debugBoundingVolume=e._debugBoundingVolume.destroy());t.debugShowContentBoundingVolume&&n?(Object(u.a)(e._debugContentBoundingVolume)||(e._debugContentBoundingVolume=e._contentBoundingVolume.createDebugVolume(uf.BLUE)),e._debugContentBoundingVolume.update(i)):!t.debugShowContentBoundingVolume&&Object(u.a)(e._debugContentBoundingVolume)&&(e._debugContentBoundingVolume=e._debugContentBoundingVolume.destroy()),t.debugShowViewerRequestVolume&&Object(u.a)(e._viewerRequestVolume)?(Object(u.a)(e._debugViewerRequestVolume)||(e._debugViewerRequestVolume=e._viewerRequestVolume.createDebugVolume(uf.YELLOW)),e._debugViewerRequestVolume.update(i)):!t.debugShowViewerRequestVolume&&Object(u.a)(e._debugViewerRequestVolume)&&(e._debugViewerRequestVolume=e._debugViewerRequestVolume.destroy());var c=t.debugColorizeTiles&&!e._debugColorizeTiles,l=!t.debugColorizeTiles&&e._debugColorizeTiles;c?(e._debugColorizeTiles=!0,e.color=e._debugColor):l&&(e._debugColorizeTiles=!1,e.color=uf.WHITE),e._colorDirty&&(e._colorDirty=!1,e._content.applyDebugSettings(!0,e._color)),l&&t.makeStyleDirty()}}(this,e,t),function(e,t,i){var n=e._content,r=e._expiredContent;if(Object(u.a)(r)){if(!e.contentReady)return void r.update(t,i);e._expiredContent.destroy(),e._expiredContent=void 0}n.update(t,i)}(this,e,t),this._commandsLength=t.commandList.length-i,this.clippingPlanesDirty=!1};var n5=[];G4.prototype.process=function(e,t){var i=t.commandList;t.commandList=n5,this._content.update(e,t),n5.length=0,t.commandList=i},G4.prototype.isDestroyed=function(){return!1},G4.prototype.destroy=function(){return this._content=this._content&&this._content.destroy(),this._expiredContent=this._expiredContent&&!this._expiredContent.isDestroyed()&&this._expiredContent.destroy(),this._debugBoundingVolume=this._debugBoundingVolume&&this._debugBoundingVolume.destroy(),this._debugContentBoundingVolume=this._debugContentBoundingVolume&&this._debugContentBoundingVolume.destroy(),this._debugViewerRequestVolume=this._debugViewerRequestVolume&&this._debugViewerRequestVolume.destroy(),rl(this)};var r5=G4,a5={},o5=new z;a5.checkChildrenWithinParent=function(e){x.a.typeOf.object("tile",e);var t=e.children,i=t.length,n=e.boundingVolume;if(n instanceof H4||n instanceof B4){var r=n._orientedBoundingBox;e._optimChildrenWithinParent=w4.USE_OPTIMIZATION;for(var a=0;a<i;++a){var o=t[a].boundingVolume;if(!(o instanceof H4||o instanceof B4)){e._optimChildrenWithinParent=w4.SKIP_OPTIMIZATION;break}var s=o._orientedBoundingBox,c=z.subtract(s.center,r.center,o5),l=z.magnitude(c);if(z.divideByScalar(c,l,c),Math.abs(r.halfAxes[0]*c.x)+Math.abs(r.halfAxes[1]*c.y)+Math.abs(r.halfAxes[2]*c.z)+Math.abs(r.halfAxes[3]*c.x)+Math.abs(r.halfAxes[4]*c.y)+Math.abs(r.halfAxes[5]*c.z)+Math.abs(r.halfAxes[6]*c.x)+Math.abs(r.halfAxes[7]*c.y)+Math.abs(r.halfAxes[8]*c.z)<=Math.abs(s.halfAxes[0]*c.x)+Math.abs(s.halfAxes[1]*c.y)+Math.abs(s.halfAxes[2]*c.z)+Math.abs(s.halfAxes[3]*c.x)+Math.abs(s.halfAxes[4]*c.y)+Math.abs(s.halfAxes[5]*c.z)+Math.abs(s.halfAxes[6]*c.x)+Math.abs(s.halfAxes[7]*c.y)+Math.abs(s.halfAxes[8]*c.z)+l){e._optimChildrenWithinParent=w4.SKIP_OPTIMIZATION;break}}}return e._optimChildrenWithinParent===w4.USE_OPTIMIZATION};var s5=a5;function c5(){}var l5={stack:new Tx,stackMaximumLength:0};function u5(e){return e._visible&&e._inRequestVolume}function h5(e){return e.hasEmptyContent||e.hasTilesetContent}function d5(e,t){return 0!==t.children.length&&(t.hasTilesetContent?!t.contentExpired:(t.hasEmptyContent,!0))}function f5(e,t,i,n){for(var r=t.children,a=r.length,o=0;o<a;++o){var s=r[o];s.updateVisibility(n),u5(s)&&i.push(s)}}function p5(e,t){(function(e){return!h5(e)&&e.contentUnloaded}(t)||t.contentExpired)&&(t._priority=0,e._requestedTiles.push(t))}function m5(e,t){e._cache.touch(t)}function _5(e){++e.statistics.visited}function g5(e,t,i){t.contentAvailable&&t.contentVisibility(i)!==ce.OUTSIDE&&e._selectedTiles.push(t)}c5.selectTiles=function(e,t){e._selectedTiles.length=0,e._requestedTiles.length=0,e._hasMixedContent=!1;var i=!0,n=e.root;if(n.updateVisibility(t),!u5(n))return i;var r=l5.stack;for(r.push(e.root);r.length>0;){l5.stackMaximumLength=Math.max(l5.stackMaximumLength,r.length);var a=r.pop(),o=a.refine===H1.ADD,s=a.refine===H1.REPLACE,c=d5(e,a);c&&f5(e,a,r,t),(o||s&&!c)&&(p5(e,a),g5(e,a,t),h5(a)||a.contentAvailable||(i=!1)),_5(e),m5(e,a)}return l5.stack.trim(l5.stackMaximumLength),i};var v5=c5;function b5(){this._list=new xv,this._sentinel=this._list.add(),this._trimTiles=!1}b5.prototype.reset=function(){this._list.splice(this._list.tail,this._sentinel)},b5.prototype.touch=function(e){var t=e.cacheNode;Object(u.a)(t)&&this._list.splice(this._sentinel,t)},b5.prototype.add=function(e){Object(u.a)(e.cacheNode)||(e.cacheNode=this._list.add(e))},b5.prototype.unloadTile=function(e,t,i){var n=t.cacheNode;Object(u.a)(n)&&(this._list.remove(n),t.cacheNode=void 0,i(e,t))},b5.prototype.unloadTiles=function(e,t){var i=this._trimTiles;this._trimTiles=!1;for(var n=this._list,r=1024*e.maximumMemoryUsage*1024,a=this._sentinel,o=n.head;o!==a&&(e.totalMemoryUsageInBytes>r||i);){var s=o.item;o=o.next,this.unloadTile(e,s,t)}},b5.prototype.trim=function(){this._trimTiles=!0};var y5=b5;function w5(){this.selected=0,this.visited=0,this.numberOfCommands=0,this.numberOfAttemptedRequests=0,this.numberOfPendingRequests=0,this.numberOfTilesProcessing=0,this.numberOfTilesWithContentReady=0,this.numberOfTilesTotal=0,this.numberOfFeaturesSelected=0,this.numberOfFeaturesLoaded=0,this.numberOfPointsSelected=0,this.numberOfPointsLoaded=0,this.numberOfTrianglesSelected=0,this.numberOfTilesStyled=0,this.numberOfFeaturesStyled=0,this.numberOfTilesCulledWithChildrenUnion=0,this.geometryByteLength=0,this.texturesByteLength=0,this.batchTableByteLength=0}function O5(e,t,i,n){var r=t.innerContents,a=t.pointsLength,o=t.trianglesLength,s=t.featuresLength,c=t.geometryByteLength,l=t.texturesByteLength,h=t.batchTableByteLength;if(n?(e.numberOfFeaturesLoaded+=i?-s:s,e.numberOfPointsLoaded+=i?-a:a,e.geometryByteLength+=i?-c:c,e.texturesByteLength+=i?-l:l,e.batchTableByteLength+=i?-h:h):(e.numberOfFeaturesSelected+=i?-s:s,e.numberOfPointsSelected+=i?-a:a,e.numberOfTrianglesSelected+=i?-o:o),Object(u.a)(r))for(var d=r.length,f=0;f<d;++f)O5(e,r[f],i,n)}w5.prototype.clear=function(){this.selected=0,this.visited=0,this.numberOfCommands=0,this.numberOfAttemptedRequests=0,this.numberOfFeaturesSelected=0,this.numberOfPointsSelected=0,this.numberOfTrianglesSelected=0,this.numberOfTilesStyled=0,this.numberOfFeaturesStyled=0,this.numberOfTilesCulledWithChildrenUnion=0},w5.prototype.incrementSelectionCounts=function(e){O5(this,e,!1,!1)},w5.prototype.incrementLoadCounts=function(e){O5(this,e,!1,!0)},w5.prototype.decrementLoadCounts=function(e){O5(this,e,!0,!0)},w5.clone=function(e,t){t.selected=e.selected,t.visited=e.visited,t.numberOfCommands=e.numberOfCommands,t.selected=e.selected,t.numberOfAttemptedRequests=e.numberOfAttemptedRequests,t.numberOfPendingRequests=e.numberOfPendingRequests,t.numberOfTilesProcessing=e.numberOfTilesProcessing,t.numberOfTilesWithContentReady=e.numberOfTilesWithContentReady,t.numberOfTilesTotal=e.numberOfTilesTotal,t.numberOfFeaturesSelected=e.numberOfFeaturesSelected,t.numberOfFeaturesLoaded=e.numberOfFeaturesLoaded,t.numberOfPointsSelected=e.numberOfPointsSelected,t.numberOfPointsLoaded=e.numberOfPointsLoaded,t.numberOfTrianglesSelected=e.numberOfTrianglesSelected,t.numberOfTilesStyled=e.numberOfTilesStyled,t.numberOfFeaturesStyled=e.numberOfFeaturesStyled,t.numberOfTilesCulledWithChildrenUnion=e.numberOfTilesCulledWithChildrenUnion,t.geometryByteLength=e.geometryByteLength,t.texturesByteLength=e.texturesByteLength,t.batchTableByteLength=e.batchTableByteLength};var x5=w5;function E5(){}function T5(e){return e._visible&&e._inRequestVolume}var C5={stack:new Tx,stackMaximumLength:0},S5={stack:new Tx,stackMaximumLength:0},A5={stack:new Tx,stackMaximumLength:0},P5={stack:new Tx,stackMaximumLength:0,ancestorStack:new Tx,ancestorStackMaximumLength:0},I5=2;function D5(e){return e._skipLevelOfDetail}function j5(e,t){e._emptyTiles.push(t)}function M5(e,t,i){if(t.contentVisibility(i)!==ce.OUTSIDE){var n=t.content;n.featurePropertiesDirty?(n.featurePropertiesDirty=!1,t.lastStyleTime=0,e._selectedTilesToStyle.push(t)):t._selectedFrame<i.frameNumber-1&&e._selectedTilesToStyle.push(t),t._selectedFrame=i.frameNumber,e._selectedTiles.push(t)}}function R5(e,t,i){if(D5(e)){var n=t.contentAvailable?t:t._ancestorWithContentAvailable;Object(u.a)(n)?n._shouldSelect=!0:function(e,t,i){var n=A5.stack;for(n.push(t);n.length>0;){A5.stackMaximumLength=Math.max(A5.stackMaximumLength,n.length);for(var r=n.pop().children,a=r.length,o=0;o<a;++o){var s=r[o];T5(s)&&(s.contentAvailable?(z5(e,s,i),N5(e,s,i),M5(e,s,i)):s._depth-t._depth<I5&&n.push(s))}}}(e,t,i)}else t.contentAvailable&&M5(e,t,i)}function L5(e,t,i){++e._statistics.visited,t._visitedFrame=i.frameNumber}function N5(e,t,i){t._touchedFrame!==i.frameNumber&&(e._cache.touch(t),t._touchedFrame=i.frameNumber)}function F5(e,t,i){(V5(t)||t.contentExpired)&&(t._requestedFrame=i.frameNumber,t._priority=function(e,t){if(t.refine===H1.ADD)return t._distanceToCamera;var i=t.parent,n=Object(u.a)(i)&&(!D5(e)||0===t._screenSpaceError||i.hasTilesetContent)?i._screenSpaceError:t._screenSpaceError;return e.root._screenSpaceError-n}(e,t),e._requestedTiles.push(t))}function k5(e,t,i){t._updatedVisibilityFrame!==e._updatedVisibilityFrame&&(t.updateVisibility(i),t._updatedVisibilityFrame=e._updatedVisibilityFrame)}function B5(e,t,i){if(k5(e,t,i),T5(t)){var n=t.children.length>0;if(t.hasTilesetContent&&n){var r=t.children[0];return B5(e,r,i),void(t._visible=r._visible)}if(!function(e,t,i){var n=t.parent;return!(!Object(u.a)(n)||n.hasTilesetContent||n.refine!==H1.ADD)&&t.getScreenSpaceError(i,!0)<=e._maximumScreenSpaceError}(e,t,i)){var a=t.refine===H1.REPLACE,o=t._optimChildrenWithinParent===w4.USE_OPTIMIZATION;return a&&o&&n&&!function(e,t,i){for(var n=!1,r=t.children,a=r.length,o=0;o<a;++o){var s=r[o];k5(e,s,i),n=n||T5(s)}return n}(e,t,i)?(++e._statistics.numberOfTilesCulledWithChildrenUnion,void(t._visible=!1)):void 0}t._visible=!1}}function z5(e,t,i){B5(e,t,i),t.updateExpiration(),t._shouldSelect=!1,t._finalResolution=!0,t._ancestorWithContent=void 0,t._ancestorWithContentAvailable=void 0;var n=t.parent;if(Object(u.a)(n)){var r=!V5(n)||n._requestedFrame===i.frameNumber;t._ancestorWithContent=r?n:n._ancestorWithContent,t._ancestorWithContentAvailable=n.contentAvailable?n:n._ancestorWithContentAvailable}}function U5(e){return e.hasEmptyContent||e.hasTilesetContent}function V5(e){return!U5(e)&&e.contentUnloaded}function H5(e,t){var i=t._ancestorWithContent;return!e.immediatelyLoadDesiredLevelOfDetail&&Object(u.a)(i)&&t._screenSpaceError<i._screenSpaceError/e.skipScreenSpaceErrorFactor&&t._depth>i._depth+e.skipLevels}function G5(e,t){return 0===t._distanceToCamera&&0===e._distanceToCamera?t._centerZDepth-e._centerZDepth:t._distanceToCamera-e._distanceToCamera}function q5(e,t,i,n){var r,a=t.refine===H1.REPLACE,o=t.children,s=o.length;for(r=0;r<s;++r)z5(e,o[r],n);o.sort(G5);var c=!D5(e)&&a&&!U5(t),l=!0,u=!1;for(r=0;r<s;++r){var h,d=o[r];if(T5(d)?(i.push(d),u=!0):(c||e.loadSiblings)&&(F5(e,d,n),N5(e,d,n)),c)h=!!d._inRequestVolume&&(U5(d)?Z5(e,d,n):d.contentAvailable),l=l&&h}return u||(l=!1),l}function W5(e,t,i){return!D5(e)||!e.immediatelyLoadDesiredLevelOfDetail&&(!Object(u.a)(t._ancestorWithContent)||(0===t._screenSpaceError?t.parent._screenSpaceError>i:t._screenSpaceError>i))}function Y5(e,t){return 0!==t.children.length&&(t.hasTilesetContent?!t.contentExpired:t._screenSpaceError>e._maximumScreenSpaceError)}function X5(e,t,i,n,r){var a=C5.stack;for(a.push(t);a.length>0;){C5.stackMaximumLength=Math.max(C5.stackMaximumLength,a.length);var o=a.pop(),s=W5(e,o,i),c=o.refine===H1.ADD,l=o.refine===H1.REPLACE,h=o.parent,d=!Object(u.a)(h)||h._refines,f=!1;Y5(e,o)&&(f=q5(e,o,a,r)&&d);var p=!f&&d;U5(o)?(j5(e,o),F5(e,o,r),p&&R5(e,o,r)):c?(R5(e,o,r),F5(e,o,r)):l&&(s?(F5(e,o,r),p&&R5(e,o,r)):p?(R5(e,o,r),F5(e,o,r)):H5(e,o)&&F5(e,o,r)),L5(e,o,r),N5(e,o,r),o._refines=f}}function Z5(e,t,i){var n=!0,r=S5.stack;for(r.push(t);r.length>0;){S5.stackMaximumLength=Math.max(S5.stackMaximumLength,r.length);var a=r.pop(),o=a.children,s=o.length,c=U5(a)&&Y5(e,a);if(c||a.contentAvailable||(n=!1),z5(e,a,i),T5(a)||(F5(e,a,i),N5(e,a,i)),c)for(var l=0;l<s;++l){var u=o[l];r.push(u)}}return n}function Q5(e,t,i){var n,r=P5.stack,a=P5.ancestorStack;for(r.push(t);r.length>0||a.length>0;){if(P5.stackMaximumLength=Math.max(P5.stackMaximumLength,r.length),P5.ancestorStackMaximumLength=Math.max(P5.ancestorStackMaximumLength,a.length),a.length>0){var o=a.peek();if(o._stackLength===r.length){a.pop(),o!==n&&(o._finalResolution=!1),M5(e,o,i);continue}}var s=r.pop();if(Object(u.a)(s)){var c=s.refine===H1.ADD,l=s._shouldSelect,h=s.children,d=h.length,f=Y5(e,s);if(l)if(c)M5(e,s,i);else{if(s._selectionDepth=a.length,s._selectionDepth,n=s,!f){M5(e,s,i);continue}a.push(s),s._stackLength=r.length}if(f)for(var p=0;p<d;++p){var m=h[p];T5(m)&&r.push(m)}}}}E5.selectTiles=function(e,t){if(e._requestedTiles.length=0,!e.debugFreezeFrame){e._selectedTiles.length=0,e._selectedTilesToStyle.length=0,e._emptyTiles.length=0,e._hasMixedContent=!1;var i=e.root;if(z5(e,i,t),T5(i)&&!(i.getScreenSpaceError(t,!0)<=e._maximumScreenSpaceError))return D5(e)?e.immediatelyLoadDesiredLevelOfDetail?function(e,t,i){var n=Number.MAX_VALUE,r=e._maximumScreenSpaceError;X5(e,t,n,r,i),Q5(e,t,i)}(e,i,t):function(e,t,i){var n=Math.max(e.baseScreenSpaceError,e.maximumScreenSpaceError),r=e.maximumScreenSpaceError;X5(e,t,n,r,i),Q5(e,t,i)}(e,i,t):function(e,t,i){var n=e._maximumScreenSpaceError,r=e._maximumScreenSpaceError;X5(e,t,n,r,i)}(e,i,t),C5.stack.trim(C5.stackMaximumLength),S5.stack.trim(S5.stackMaximumLength),A5.stack.trim(A5.stackMaximumLength),P5.stack.trim(P5.stackMaximumLength),P5.ancestorStack.trim(P5.ancestorStackMaximumLength),!0}};var K5=E5;function J5(){this._style=void 0,this._styleDirty=!1,this._lastStyleTime=0}Object(O.a)(J5.prototype,{style:{get:function(){return this._style},set:function(e){this._style=e,this._styleDirty=!0}}}),J5.prototype.makeDirty=function(){this._styleDirty=!0},J5.prototype.applyStyle=function(e,t){if(e.ready&&(!Object(u.a)(this._style)||this._style.ready)){var i=this._styleDirty;t.passes.render&&(this._styleDirty=!1),i&&++this._lastStyleTime;for(var n=this._lastStyleTime,r=e._statistics,a=i?e._selectedTiles:e._selectedTilesToStyle,o=a.length,s=0;s<o;++s){var c=a[s];if(c.lastStyleTime!==n){var l=c.content;c.lastStyleTime=n,l.applyStyle(this._style),r.numberOfFeaturesStyled+=l.featuresLength,++r.numberOfTilesStyled}}}};var $5=J5,e6="#extension GL_EXT_frag_depth : enable\nuniform sampler2D u_pointCloud_colorGBuffer;\nuniform sampler2D u_pointCloud_depthGBuffer;\nuniform vec3 u_distancesAndEdlStrength;\nvarying vec2 v_textureCoordinates;\nvec2 neighborContribution(float log2Depth, vec2 padding)\n{\nfloat depthOrLogDepth = czm_unpackDepth(texture2D(u_pointCloud_depthGBuffer, v_textureCoordinates + padding));\nif (depthOrLogDepth == 0.0) {\nreturn vec2(0.0);\n}\nvec4 eyeCoordinate = czm_windowToEyeCoordinates(v_textureCoordinates + padding, depthOrLogDepth);\nreturn vec2(max(0.0, log2Depth - log2(-eyeCoordinate.z / eyeCoordinate.w)), 1.0);\n}\nvoid main()\n{\nfloat depthOrLogDepth = czm_unpackDepth(texture2D(u_pointCloud_depthGBuffer, v_textureCoordinates));\nvec4 eyeCoordinate = czm_windowToEyeCoordinates(gl_FragCoord.xy, depthOrLogDepth);\neyeCoordinate /= eyeCoordinate.w;\nfloat log2Depth = log2(-eyeCoordinate.z);\nif (depthOrLogDepth == 0.0)\n{\ndiscard;\n}\nvec4 color = texture2D(u_pointCloud_colorGBuffer, v_textureCoordinates);\nfloat distX = u_distancesAndEdlStrength.x;\nfloat distY = u_distancesAndEdlStrength.y;\nvec2 responseAndCount = vec2(0.0);\nresponseAndCount += neighborContribution(log2Depth, vec2(0, distY));\nresponseAndCount += neighborContribution(log2Depth, vec2(distX, 0));\nresponseAndCount += neighborContribution(log2Depth, vec2(0, -distY));\nresponseAndCount += neighborContribution(log2Depth, vec2(-distX, 0));\nfloat response = responseAndCount.x / responseAndCount.y;\nfloat shade = exp(-response * 300.0 * u_distancesAndEdlStrength.z);\ncolor.rgb *= shade;\ngl_FragColor = vec4(color);\n#ifdef LOG_DEPTH\nczm_writeLogDepth(1.0 + (czm_projection * vec4(eyeCoordinate.xyz, 1.0)).w);\n#else\ngl_FragDepthEXT = czm_eyeToWindowCoordinates(vec4(eyeCoordinate.xyz, 1.0)).z;\n#endif\n}\n";function t6(){this._framebuffer=void 0,this._colorGBuffer=void 0,this._depthGBuffer=void 0,this._depthTexture=void 0,this._drawCommand=void 0,this._clearCommand=void 0,this._strength=1,this._radius=1}function i6(){return new tj({wrapS:$D.CLAMP_TO_EDGE,wrapT:$D.CLAMP_TO_EDGE,minificationFilter:KD.NEAREST,magnificationFilter:ZD.NEAREST})}function n6(e){var t=e._framebuffer;Object(u.a)(t)&&(e._colorGBuffer.destroy(),e._depthGBuffer.destroy(),e._depthTexture.destroy(),t.destroy(),e._framebuffer=void 0,e._colorGBuffer=void 0,e._depthGBuffer=void 0,e._depthTexture=void 0,e._drawCommand=void 0,e._clearCommand=void 0)}var r6=new z;function a6(e,t){var i=t.drawingBufferWidth,n=t.drawingBufferHeight,r=e._colorGBuffer,a=!1,o=Object(u.a)(r)&&(r.width!==i||r.height!==n);return Object(u.a)(r)&&!o||(n6(e),function(e,t){var i=t.drawingBufferWidth,n=t.drawingBufferHeight,r=new hj({context:t,width:i,height:n,pixelFormat:gx.RGBA,pixelDatatype:mx.UNSIGNED_BYTE,sampler:i6()}),a=new hj({context:t,width:i,height:n,pixelFormat:gx.RGBA,pixelDatatype:mx.UNSIGNED_BYTE,sampler:i6()}),o=new hj({context:t,width:i,height:n,pixelFormat:gx.DEPTH_COMPONENT,pixelDatatype:mx.UNSIGNED_INT,sampler:i6()});e._framebuffer=new cj({context:t,colorTextures:[r,a],depthTexture:o,destroyAttachments:!1}),e._colorGBuffer=r,e._depthGBuffer=a,e._depthTexture=o}(e,t),function(e,t){var i=e6,n={u_pointCloud_colorGBuffer:function(){return e._colorGBuffer},u_pointCloud_depthGBuffer:function(){return e._depthGBuffer},u_distancesAndEdlStrength:function(){return r6.x=e._radius/t.drawingBufferWidth,r6.y=e._radius/t.drawingBufferHeight,r6.z=e._strength,r6}},r=RM.fromCache({blending:FD.ALPHA_BLEND,depthMask:!0,depthTest:{enabled:!0},stencilTest:Hk.setCesium3DTileBit(),stencilMask:Hk.CESIUM_3D_TILE_MASK});e._drawCommand=t.createViewportQuadCommand(i,{uniformMap:n,renderState:r,pass:lM.CESIUM_3D_TILE,owner:e}),e._clearCommand=new fX({framebuffer:e._framebuffer,color:new uf(0,0,0,0),depth:1,renderState:RM.fromCache(),pass:lM.CESIUM_3D_TILE,owner:e})}(e,t),a=!0),a}function o6(e){return e.drawBuffers&&e.fragmentDepth}function s6(e,t){var i=e.shaderCache.getDerivedShaderProgram(t,"EC");if(!Object(u.a)(i)){var n=t._attributeLocations,r=t.fragmentShaderSource.clone();r.sources=r.sources.map((function(e){return e=(e=UN.replaceMain(e,"czm_point_cloud_post_process_main")).replace(/gl_FragColor/g,"gl_FragData[0]")})),r.sources.unshift("#extension GL_EXT_draw_buffers : enable \n"),r.sources.push("void main() \n{ \n    czm_point_cloud_post_process_main(); \n    gl_FragData[1] = czm_packDepth(gl_FragCoord.z); \n}"),i=e.shaderCache.createDerivedShaderProgram(t,"EC",{vertexShaderSource:t.vertexShaderSource,fragmentShaderSource:r,attributeLocations:n})}return i}t6.isSupported=o6,t6.prototype.update=function(e,t,i){if(o6(e.context)){this._strength=i.eyeDomeLightingStrength,this._radius=i.eyeDomeLightingRadius;var n,r=a6(this,e.context),a=e.commandList,o=a.length;for(n=t;n<o;++n){var s=a[n];if(s.primitiveType===yn.POINTS&&s.pass!==lM.TRANSLUCENT){var c=s.derivedCommands.pointCloudProcessor;(!Object(u.a)(c)||s.dirty||r||c.framebuffer!==this._framebuffer)&&(c=cM.shallowClone(s),s.derivedCommands.pointCloudProcessor=c,c.framebuffer=this._framebuffer,c.shaderProgram=s6(e.context,s.shaderProgram),c.castShadows=!1,c.receiveShadows=!1),a[n]=c}}var l=this._clearCommand,h=this._drawCommand;a.push(h),a.push(l)}},t6.prototype.isDestroyed=function(){return!1},t6.prototype.destroy=function(){return n6(this),rl(this)};var c6=t6;function l6(e){var t=Object(w.a)(e,{});this.attenuation=Object(w.a)(t.attenuation,!1),this.geometricErrorScale=Object(w.a)(t.geometricErrorScale,1),this.maximumAttenuation=t.maximumAttenuation,this.baseResolution=t.baseResolution,this.eyeDomeLighting=Object(w.a)(t.eyeDomeLighting,!0),this.eyeDomeLightingStrength=Object(w.a)(t.eyeDomeLightingStrength,1),this.eyeDomeLightingRadius=Object(w.a)(t.eyeDomeLightingRadius,1)}l6.isSupported=function(e){return c6.isSupported(e.context)};var u6=l6;function h6(e){e=Object(w.a)(e,w.a.EMPTY_OBJECT),x.a.defined("options.tilesetJson",e.tilesetJson),x.a.defined("options.resource",e.resource),this._tilesetJson=e.tilesetJson,this._resource=e.resource,this._basePath=this._resource.getBaseUri(!0),this._root=void 0,this._asset=void 0,this._properties=void 0,this._geometricError=void 0,this._extensionsUsed=void 0,this._gltfUpAxis=void 0,this._cache=new y5,this._processingQueue=[],this._selectedTiles=[],this._emptyTiles=[],this._requestedTiles=[],this._selectedTilesToStyle=[],this._loadTimestamp=void 0,this._timeSinceLoad=0,this._updatedVisibilityFrame=0,this._extras=void 0,this._credits=void 0,this._cullWithChildrenBounds=Object(w.a)(e.cullWithChildrenBounds,!0),this._allTilesAdditive=!0,this._hasMixedContent=!1,this._stencilClearCommand=void 0,this._backfaceCommands=new Tx,this._maximumScreenSpaceError=Object(w.a)(e.maximumScreenSpaceError,16),this._maximumMemoryUsage=Object(w.a)(e.maximumMemoryUsage,512),this._styleEngine=new $5,this._modelMatrix=Object(u.a)(e.modelMatrix)?Be.clone(e.modelMatrix):Be.clone(Be.IDENTITY),this._statistics=new x5,this._statisticsLastRender=new x5,this._statisticsLastPick=new x5,this._statisticsLastAsync=new x5,this._tilesLoaded=!1,this._initialTilesLoaded=!1,this._tileDebugLabels=void 0,this._readyPromise=Oi.a.defer(),this._classificationType=e.classificationType,this._ellipsoid=Object(w.a)(e.ellipsoid,ae.WGS84),this._initialClippingPlanesOriginMatrix=Be.IDENTITY,this._clippingPlanesOriginMatrix=void 0,this._clippingPlanesOriginMatrixDirty=!0,this._useGradual=Object(w.a)(e.useGradual,!1),this._planView=Object(w.a)(e.planView,!1),this._shouldAnimate=Object(w.a)(e.shouldAnimate,!1),this._centerPos=Object(w.a)(e.centerPos,z.ZERO),this._forceMipmap=Object(w.a)(e.forceMipmap,!1),this._dequantizeInShader=Object(w.a)(e.dequantizeInShader,!1),this._dracoModel=Object(w.a)(e.dracoModel,!1),this._calcEdge=Object(w.a)(e.calcEdge,!1),this.dynamicScreenSpaceError=Object(w.a)(e.dynamicScreenSpaceError,!1),this.dynamicScreenSpaceErrorDensity=.00278,this.dynamicScreenSpaceErrorFactor=4,this.dynamicScreenSpaceErrorHeightFalloff=.25,this._dynamicScreenSpaceErrorComputedDensity=0,this.shadows=Object(w.a)(e.shadows,rM.ENABLED),this.show=Object(w.a)(e.show,!0),this.colorBlendMode=gX.HIGHLIGHT,this.colorBlendAmount=.5,this.pointCloudShading=new u6(e.pointCloudShading),this._pointCloudEyeDomeLighting=new c6,this.loadProgress=new $o.a,this.allTilesLoaded=new $o.a,this.initialTilesLoaded=new $o.a,this.tileLoad=new $o.a,this.tileUnload=new $o.a,this.tileFailed=new $o.a,this.tileVisible=new $o.a,this.skipLevelOfDetail=Object(w.a)(e.skipLevelOfDetail,!0),this._skipLevelOfDetail=this.skipLevelOfDetail,this._disableSkipLevelOfDetail=!1,this.baseScreenSpaceError=Object(w.a)(e.baseScreenSpaceError,1024),this.skipScreenSpaceErrorFactor=Object(w.a)(e.skipScreenSpaceErrorFactor,16),this.skipLevels=Object(w.a)(e.skipLevels,1),this.immediatelyLoadDesiredLevelOfDetail=Object(w.a)(e.immediatelyLoadDesiredLevelOfDetail,!1),this.loadSiblings=Object(w.a)(e.loadSiblings,!1),this._clippingPlanes=void 0,this.clippingPlanes=e.clippingPlanes,this._imageBasedLightingFactor=new Rt(1,1),Rt.clone(e.imageBasedLightingFactor,this._imageBasedLightingFactor),this.lightColor=e.lightColor,this.luminanceAtZenith=Object(w.a)(e.luminanceAtZenith,.5),this.sphericalHarmonicCoefficients=e.sphericalHarmonicCoefficients,this.specularEnvironmentMaps=e.specularEnvironmentMaps,this.debugFreezeFrame=Object(w.a)(e.debugFreezeFrame,!1),this.debugColorizeTiles=Object(w.a)(e.debugColorizeTiles,!1),this.debugWireframe=Object(w.a)(e.debugWireframe,!1),this.debugShowBoundingVolume=Object(w.a)(e.debugShowBoundingVolume,!1),this.debugShowContentBoundingVolume=Object(w.a)(e.debugShowContentBoundingVolume,!1),this.debugShowViewerRequestVolume=Object(w.a)(e.debugShowViewerRequestVolume,!1),this._tileDebugLabels=void 0,this.debugPickedTileLabelOnly=!1,this.debugPickedTile=void 0,this.debugPickPosition=void 0,this.debugShowGeometricError=Object(w.a)(e.debugShowGeometricError,!1),this.debugShowRenderingStatistics=Object(w.a)(e.debugShowRenderingStatistics,!1),this.debugShowMemoryUsage=Object(w.a)(e.debugShowMemoryUsage,!1),this.debugShowUrl=Object(w.a)(e.debugShowUrl,!1);var t=this._resource,i=this._tilesetJson;this._root=this.loadTileset(t,i);var n=Object(u.a)(i.asset.gltfUpAxis)?mX.fromName(i.asset.gltfUpAxis):mX.Y,r=i.asset;this._asset=r,this._properties=i.properties,this._geometricError=i.geometricError,this._extensionsUsed=i.extensionsUsed,this._gltfUpAxis=n,this._extras=i.extras;var a=r.extras;if(Object(u.a)(a)&&Object(u.a)(a.cesium)&&Object(u.a)(a.cesium.credits)){var o=a.cesium.credits,s=this._credits;Object(u.a)(s)||(s=[],this._credits=s);for(var c=0;c<o.length;c++){var l=o[c];s.push(new Jo(l.html,l.showOnScreen))}}var h=this._root.createBoundingVolume(i.root.boundingVolume,Be.IDENTITY).boundingSphere.center,d=this._ellipsoid.cartesianToCartographic(h);Object(u.a)(d)&&d.height>Xt._defaultMinTerrainHeight&&(this._initialClippingPlanesOriginMatrix=xa.eastNorthUpToFixedFrame(h)),this._clippingPlanesOriginMatrix=Be.clone(this._initialClippingPlanesOriginMatrix),this._readyPromise.resolve(this)}Object(O.a)(h6.prototype,{asset:{get:function(){if(!this.ready)throw new h.a("The tileset is not loaded.  Use Cesium3DTilesetJson.readyPromise or wait for Cesium3DTilesetJson.ready to be true.");return this._asset}},clippingPlanes:{get:function(){return this._clippingPlanes},set:function(e){iJ.setOwner(e,this,"_clippingPlanes")}},properties:{get:function(){if(!this.ready)throw new h.a("The tileset is not loaded.  Use Cesium3DTilesetJson.readyPromise or wait for Cesium3DTilesetJson.ready to be true.");return this._properties}},ready:{get:function(){return Object(u.a)(this._root)}},readyPromise:{get:function(){return this._readyPromise.promise}},tilesLoaded:{get:function(){return this._tilesLoaded}},url:{get:function(){return this._url}},basePath:{get:function(){return Object(mv.a)("Cesium3DTilesetJson.basePath","Cesium3DTilesetJson.basePath has been deprecated. All tiles are relative to the url of the tileset JSON file that contains them. Use the url property instead."),this._basePath}},style:{get:function(){return this._styleEngine.style},set:function(e){this._styleEngine.style=e}},maximumScreenSpaceError:{get:function(){return this._maximumScreenSpaceError},set:function(e){x.a.typeOf.number.greaterThanOrEquals("maximumScreenSpaceError",e,0),this._maximumScreenSpaceError=e}},maximumMemoryUsage:{get:function(){return this._maximumMemoryUsage},set:function(e){x.a.typeOf.number.greaterThanOrEquals("value",e,0),this._maximumMemoryUsage=e}},root:{get:function(){if(!this.ready)throw new h.a("The tileset is not loaded.  Use Cesium3DTilesetJson.readyPromise or wait for Cesium3DTilesetJson.ready to be true.");return this._root}},boundingSphere:{get:function(){if(!this.ready)throw new h.a("The tileset is not loaded.  Use Cesium3DTilesetJson.readyPromise or wait for Cesium3DTilesetJson.ready to be true.");return this._root.updateTransform(this._modelMatrix),this._root.boundingSphere}},modelMatrix:{get:function(){return this._modelMatrix},set:function(e){this._modelMatrix=Be.clone(e,this._modelMatrix)}},timeSinceLoad:{get:function(){return this._timeSinceLoad}},totalMemoryUsageInBytes:{get:function(){var e=this._statistics;return e.texturesByteLength+e.geometryByteLength+e.batchTableByteLength}},clippingPlanesOriginMatrix:{get:function(){return Object(u.a)(this._clippingPlanesOriginMatrix)?(this._clippingPlanesOriginMatrixDirty&&(Be.multiply(this.root.computedTransform,this._initialClippingPlanesOriginMatrix,this._clippingPlanesOriginMatrix),this._clippingPlanesOriginMatrixDirty=!1),this._clippingPlanesOriginMatrix):Be.IDENTITY}},styleEngine:{get:function(){return this._styleEngine}},statistics:{get:function(){return this._statistics}},classificationType:{get:function(){return this._classificationType}},ellipsoid:{get:function(){return this._ellipsoid}},extras:{get:function(){if(!this.ready)throw new h.a("The tileset is not loaded.  Use Cesium3DTilesetJson.readyPromise or wait for Cesium3DTilesetJson.ready to be true.");return this._extras}},imageBasedLightingFactor:{get:function(){return this._imageBasedLightingFactor},set:function(e){x.a.typeOf.object("imageBasedLightingFactor",e),x.a.typeOf.number.greaterThanOrEquals("imageBasedLightingFactor.x",e.x,0),x.a.typeOf.number.lessThanOrEquals("imageBasedLightingFactor.x",e.x,1),x.a.typeOf.number.greaterThanOrEquals("imageBasedLightingFactor.y",e.y,0),x.a.typeOf.number.lessThanOrEquals("imageBasedLightingFactor.y",e.y,1),Rt.clone(e,this._imageBasedLightingFactor)}}}),h6.loadJson=function(e){return f.a.createIfNeeded(e).fetchJson()},h6.prototype.makeStyleDirty=function(){this._styleEngine.makeDirty()},h6.prototype.loadTileset=function(e,t,i){var n=t.asset;if(!Object(u.a)(n))throw new Ce.a("Tileset must have an asset property.");if("0.0"!==n.version&&"1.0"!==n.version)throw new Ce.a("The tileset must be 3D Tiles version 0.0 or 1.0.");var r=this._statistics,a=n.tilesetVersion;Object(u.a)(a)?(this._basePath+="?v="+a,e.setQueryParameters({v:a})):delete e.queryParameters.v;var o=new r5(this,e,t.root,i);Object(u.a)(i)&&(i.children.push(o),o._depth=i._depth+1);var s=[];for(s.push(o);s.length>0;){var c=s.pop();++r.numberOfTilesTotal,this._allTilesAdditive=this._allTilesAdditive&&c.refine===H1.ADD;var l=c._header.children;if(Object(u.a)(l))for(var h=l.length,d=0;d<h;++d){var f=l[d],p=new r5(this,e,f,c);c.children.push(p),p._depth=c._depth+1,s.push(p)}this._cullWithChildrenBounds&&s5.checkChildrenWithinParent(c)}return o};var d6=new z,f6=new K,p6=new Be,m6=new z,_6=new z,g6=new z;function v6(e,t){if(!t.hasEmptyContent){var i=e._statistics,n=t.contentExpired;t.requestContent()?(n&&(t.hasTilesetContent?function(e,t){var i=t,n=S6;n.push(t);for(;n.length>0;){for(var r=(t=n.pop()).children,a=r.length,o=0;o<a;++o)n.push(r[o]);t!==i&&(P6(e,t),--e._statistics.numberOfTilesTotal)}i.children=[]}(e,t):(i.decrementLoadCounts(t.content),--i.numberOfTilesWithContentReady)),++i.numberOfPendingRequests,t.contentReadyToProcessPromise.then(function(e,t){return function(){e._processingQueue.push(t),--e._statistics.numberOfPendingRequests,++e._statistics.numberOfTilesProcessing}}(e,t)),t.contentReadyPromise.then(function(e,t){return function(){--e._statistics.numberOfTilesProcessing,t.hasTilesetContent||(e._statistics.incrementLoadCounts(t.content),++e._statistics.numberOfTilesWithContentReady,e._cache.add(t)),e.tileLoad.raiseEvent(t)}}(e,t)).otherwise(function(e,t){return function(i){e._processingQueue.indexOf(t)>=0?--e._statistics.numberOfTilesProcessing:--e._statistics.numberOfPendingRequests;var n=t._contentResource.url,r=Object(u.a)(i.message)?i.message:i.toString();e.tileFailed.numberOfListeners>0?e.tileFailed.raiseEvent({url:n,message:r}):(console.log("A 3D tile failed to load: "+n),console.log("Error: "+r))}}(e,t))):++i.numberOfAttemptedRequests}}function b6(e,t){return e._priority-t._priority}function y6(e,t){!function(e){for(var t=e._processingQueue,i=t.length,n=0,r=0;r<i;++r){var a=t[r];a._contentState===y4.PROCESSING?n>0&&(t[r-n]=a):++n}t.length-=n}(e);for(var i=e._processingQueue,n=i.length,r=0;r<n;++r)i[r].process(e,t)}var w6=new z,O6={maximumFractionDigits:3};function x6(e){var t=e/1048576;return t<1?t.toLocaleString(void 0,O6):Math.round(t).toLocaleString()}function E6(e){var t=e.boundingVolume.boundingVolume,i=t.halfAxes,n=t.radius,r=z.clone(t.center,w6);if(Object(u.a)(i))r.x+=.75*(i[0]+i[3]+i[6]),r.y+=.75*(i[1]+i[4]+i[7]),r.z+=.75*(i[2]+i[5]+i[8]);else if(Object(u.a)(n)){var a=z.normalize(t.center,w6);a=z.multiplyByScalar(a,.75*n,w6),r=z.add(a,t.center,w6)}return r}function T6(e,t,i){var n="",r=0;(t.debugShowGeometricError&&(n+="\nGeometric error: "+e.geometricError,r++),t.debugShowRenderingStatistics)&&(n+="\nCommands: "+e.commandsLength,r++,e.content.pointsLength>0&&(n+="\nPoints: "+e.content.pointsLength,r++),e.content.trianglesLength>0&&(n+="\nTriangles: "+e.content.trianglesLength,r++),n+="\nFeatures: "+e.content.featuresLength,r++);t.debugShowMemoryUsage&&(n+="\nTexture Memory: "+x6(e.content.texturesByteLength),n+="\nGeometry Memory: "+x6(e.content.geometryByteLength),r+=2),t.debugShowUrl&&(n+="\nUrl: "+e._header.content.uri,r++);var a={text:n.substring(1),position:i,font:19-r+"px sans-serif",showBackground:!0,disableDepthTestDistance:Number.POSITIVE_INFINITY};return t._tileDebugLabels.add(a)}function C6(e,t){e._styleEngine.applyStyle(e,t);var i,n,r=e._statistics,a=t.passes.render,o=t.commandList,s=o.length,c=e._selectedTiles,l=c.length,h=e._emptyTiles,d=h.length,f=e.tileVisible,p=e._skipLevelOfDetail&&e._hasMixedContent&&t.context.stencilBuffer&&l>0;e._backfaceCommands.length=0,p&&(Object(u.a)(e._stencilClearCommand)||(e._stencilClearCommand=new fX({stencil:0,pass:lM.CESIUM_3D_TILE,renderState:RM.fromCache({stencilMask:Hk.SKIP_LOD_MASK})})),o.push(e._stencilClearCommand));var m=o.length;for(i=0;i<l;++i)n=c[i],a&&f.raiseEvent(n),n.update(e,t),r.incrementSelectionCounts(n.content),++r.selected;for(i=0;i<d;++i)(n=h[i]).update(e,t);var _=o.length-m;if(e._backfaceCommands.trim(),p){var g=e._backfaceCommands.values,v=g.length;for(o.length+=v,i=_-1;i>=0;--i)o[m+v+i]=o[m+i];for(i=0;i<v;++i)o[m+i]=g[i]}_=o.length-s,r.numberOfCommands=_,a&&e.pointCloudShading.attenuation&&e.pointCloudShading.eyeDomeLighting&&_>0&&e._pointCloudEyeDomeLighting.update(t,s,e.pointCloudShading),a&&(e.debugShowGeometricError||e.debugShowRenderingStatistics||e.debugShowMemoryUsage||e.debugShowUrl?(Object(u.a)(e._tileDebugLabels)||(e._tileDebugLabels=new jG),function(e,t){var i,n,r=e._selectedTiles,a=r.length,o=e._emptyTiles,s=o.length;if(e._tileDebugLabels.removeAll(),e.debugPickedTileLabelOnly){if(Object(u.a)(e.debugPickedTile)){var c=Object(u.a)(e.debugPickPosition)?e.debugPickPosition:E6(e.debugPickedTile);T6(e.debugPickedTile,e,c).pixelOffset=new Rt(15,-15)}}else{for(i=0;i<a;++i)T6(n=r[i],e,E6(n));for(i=0;i<s;++i)(n=o[i]).hasTilesetContent&&T6(n,e,E6(n))}e._tileDebugLabels.update(t)}(e,t)):e._tileDebugLabels=e._tileDebugLabels&&e._tileDebugLabels.destroy())}var S6=[];function A6(e,t){e.tileUnload.raiseEvent(t),e._statistics.decrementLoadCounts(t.content),--e._statistics.numberOfTilesWithContentReady,t.unloadContent()}function P6(e,t){e._cache.unloadTile(e,t,A6),t.destroy()}function I6(e,t){if(t.mode===xF.MORPHING)return!1;if(!e.show||!e.ready)return!1;Object(u.a)(e._loadTimestamp)||(e._loadTimestamp=Tr.clone(t.time));var i=e._clippingPlanes;e._clippingPlanesOriginMatrixDirty=!0,Object(u.a)(i)&&i.enabled&&i.update(t),e._timeSinceLoad=Math.max(1e3*Tr.secondsDifference(t.time,e._loadTimestamp),0),e._skipLevelOfDetail=e.skipLevelOfDetail&&!Object(u.a)(e._classificationType)&&!e._disableSkipLevelOfDetail&&!e._allTilesAdditive;var n,r=t.passes,a=r.render,o=r.pick,s=r.asynchronous,c=e._statistics;if(c.clear(),e.dynamicScreenSpaceError&&function(e,t){var i,n,r,a,o,s=t.camera,c=e._root,l=c.contentBoundingVolume;if(l instanceof B4)i=z.normalize(s.positionWC,d6),n=s.directionWC,r=s.positionCartographic.height,a=l.minimumHeight,o=l.maximumHeight;else{var u=Be.inverseTransformation(c.computedTransform,p6),h=t.mapProjection.ellipsoid,d=l.boundingVolume,f=Be.multiplyByPoint(u,d.center,m6);if(z.magnitude(f)>h.minimumRadius){var p=K.fromCartesian(f,h,f6);i=z.normalize(s.positionWC,d6),n=s.directionWC,r=s.positionCartographic.height,a=0,o=2*p.height}else{var m=Be.multiplyByPoint(u,s.positionWC,_6);if(i=z.UNIT_Z,n=Be.multiplyByPointAsVector(u,s.directionWC,g6),n=z.normalize(n,n),r=m.z,l instanceof H4){var _=c._header.boundingVolume.box[11];a=f.z-_,o=f.z+_}else if(l instanceof U4){var g=d.radius;a=f.z-g,o=f.z+g}}}var v=a+(o-a)*e.dynamicScreenSpaceErrorHeightFalloff,b=o,y=I.clamp((r-v)/(b-v),0,1),w=1-Math.abs(z.dot(n,i));w*=1-y;var O=e.dynamicScreenSpaceErrorDensity;O*=w,e._dynamicScreenSpaceErrorComputedDensity=O}(e,t),a&&e._cache.reset(),++e._updatedVisibilityFrame,n=s?v5.selectTiles(e,t):K5.selectTiles(e,t),(a||s)&&function(e){var t=e._requestedTiles,i=t.length;t.sort(b6);for(var n=0;n<i;++n)v6(e,t[n])}(e),a&&y6(e,t),C6(e,t),a&&(function(e){e._cache.unloadTiles(e,A6)}(e),function(e,t){var i=e._statistics,n=e._statisticsLastRender,r=i.numberOfPendingRequests,a=i.numberOfTilesProcessing,o=n.numberOfPendingRequests,s=n.numberOfTilesProcessing,c=r!==o||a!==s;c&&t.afterRender.push((function(){e.loadProgress.raiseEvent(r,a)})),e._tilesLoaded=0===i.numberOfPendingRequests&&0===i.numberOfTilesProcessing&&0===i.numberOfAttemptedRequests,c&&e._tilesLoaded&&(t.afterRender.push((function(){e.allTilesLoaded.raiseEvent()})),e._initialTilesLoaded||(e._initialTilesLoaded=!0,t.afterRender.push((function(){e.initialTilesLoaded.raiseEvent()}))))}(e,t),0!==c.selected)){var l=e._credits;if(Object(u.a)(l))for(var h=l.length,d=0;d<h;d++)t.creditDisplay.addCredit(l[d])}var f=s?e._statisticsLastAsync:o?e._statisticsLastPick:e._statisticsLastRender;return x5.clone(c,f),n}h6.prototype.trimLoadedTiles=function(){this._cache.trim()},h6.prototype.useGradual=function(e){this._useGradual=e},h6.prototype.shouldAnimate=function(e){this._shouldAnimate=e},h6.prototype.planView=function(e){this._planView=e},h6.prototype.centerPos=function(e){this._centerPos=e},h6.prototype.calcEdge=function(e){this._calcEdge=e},h6.prototype.update=function(e){I6(this,e)},h6.prototype.updateAsync=function(e){return I6(this,e)},h6.prototype.hasExtension=function(e){return!!Object(u.a)(this._extensionsUsed)&&this._extensionsUsed.indexOf(e)>-1},h6.prototype.isDestroyed=function(){return!1},h6.prototype.destroy=function(){if(this._tileDebugLabels=this._tileDebugLabels&&this._tileDebugLabels.destroy(),this._clippingPlanes=this._clippingPlanes&&this._clippingPlanes.destroy(),Object(u.a)(this._root)){var e=S6;for(e.push(this._root);e.length>0;){var t=e.pop();t.destroy();for(var i=t.children,n=i.length,r=0;r<n;++r)e.push(i[r])}}return this._root=void 0,rl(this)};var D6=h6;function j6(e){e=Object(w.a)(e,w.a.EMPTY_OBJECT),this._primitives=[],this._guid=Mg(),this._zIndex=void 0,this.show=Object(w.a)(e.show,!0),this.destroyPrimitives=Object(w.a)(e.destroyPrimitives,!0)}function M6(e,t){if(!e.contains(t))throw new h.a("primitive is not in this collection.");return e._primitives.indexOf(t)}Object(O.a)(j6.prototype,{length:{get:function(){return this._primitives.length}}}),j6.prototype.add=function(e){if(!Object(u.a)(e))throw new h.a("primitive is required.");var t=e._external=e._external||{};return(t._composites=t._composites||{})[this._guid]={collection:this},this._primitives.push(e),e},j6.prototype.remove=function(e){if(this.contains(e)){var t=this._primitives.indexOf(e);if(-1!==t)return this._primitives.splice(t,1),delete e._external._composites[this._guid],this.destroyPrimitives&&e.destroy(),!0}return!1},j6.prototype.removeAndDestroy=function(e){var t=this.remove(e);return t&&!this.destroyPrimitives&&e.destroy(),t},j6.prototype.removeAll=function(){for(var e=this._primitives,t=e.length,i=0;i<t;++i)delete e[i]._external._composites[this._guid],this.destroyPrimitives&&e[i].destroy();this._primitives=[]},j6.prototype.contains=function(e){return!!(Object(u.a)(e)&&e._external&&e._external._composites&&e._external._composites[this._guid])},j6.prototype.raise=function(e){if(Object(u.a)(e)){var t=M6(this,e),i=this._primitives;if(t!==i.length-1){var n=i[t];i[t]=i[t+1],i[t+1]=n}}},j6.prototype.raiseToTop=function(e){if(Object(u.a)(e)){var t=M6(this,e),i=this._primitives;t!==i.length-1&&(i.splice(t,1),i.push(e))}},j6.prototype.lower=function(e){if(Object(u.a)(e)){var t=M6(this,e),i=this._primitives;if(0!==t){var n=i[t];i[t]=i[t-1],i[t-1]=n}}},j6.prototype.lowerToBottom=function(e){if(Object(u.a)(e)){var t=M6(this,e),i=this._primitives;0!==t&&(i.splice(t,1),i.unshift(e))}},j6.prototype.get=function(e){if(!Object(u.a)(e))throw new h.a("index is required.");return this._primitives[e]},j6.prototype.update=function(e){if(this.show)for(var t=this._primitives,i=0;i<t.length;++i)t[i].update(e)},j6.prototype.isDestroyed=function(){return!1},j6.prototype.destroy=function(){return this.removeAll(),rl(this)};var R6=j6;function L6(){this._length=0,this._collections={},this._collectionsArray=[],this.show=!0}Object(O.a)(L6.prototype,{length:{get:function(){return this._length}}}),L6.prototype.add=function(e,t){x.a.defined("primitive",e),Object(u.a)(t)&&x.a.typeOf.number("zIndex",t),t=Object(w.a)(t,0);var i=this._collections[t];if(!Object(u.a)(i)){(i=new R6({destroyPrimitives:!1}))._zIndex=t,this._collections[t]=i;for(var n=this._collectionsArray,r=0;r<n.length&&n[r]._zIndex<t;)r++;n.splice(r,0,i)}return i.add(e),this._length++,e._zIndex=t,e},L6.prototype.set=function(e,t){return x.a.defined("primitive",e),x.a.typeOf.number("zIndex",t),t===e._zIndex?e:(this.remove(e,!0),this.add(e,t),e)},L6.prototype.remove=function(e,t){if(this.contains(e)){var i,n=e._zIndex,r=this._collections[n];return(i=t?r.remove(e):r.removeAndDestroy(e))&&this._length--,0===r.length&&(this._collectionsArray.splice(this._collectionsArray.indexOf(r),1),this._collections[n]=void 0,r.destroy()),i}return!1},L6.prototype.removeAll=function(){for(var e=this._collectionsArray,t=0;t<e.length;t++){var i=e[t];i.destroyPrimitives=!0,i.destroy()}this._collections={},this._collectionsArray=[],this._length=0},L6.prototype.contains=function(e){if(!Object(u.a)(e))return!1;var t=this._collections[e._zIndex];return Object(u.a)(t)&&t.contains(e)},L6.prototype.update=function(e){if(this.show)for(var t=this._collectionsArray,i=0;i<t.length;i++)t[i].update(e)},L6.prototype.isDestroyed=function(){return!1},L6.prototype.destroy=function(){return this.removeAll(),rl(this)};var N6=L6;function F6(e,t){this._primitives=e,this._orderedGroundPrimitives=t,this._dynamicUpdaters=new Fi}F6.prototype.add=function(e,t){this._dynamicUpdaters.set(t.id,t.createDynamicUpdater(this._primitives,this._orderedGroundPrimitives))},F6.prototype.remove=function(e){var t=e.id,i=this._dynamicUpdaters.get(t);Object(u.a)(i)&&(this._dynamicUpdaters.remove(t),i.destroy())},F6.prototype.update=function(e){for(var t=this._dynamicUpdaters.values,i=0,n=t.length;i<n;i++)t[i].update(e);return!0},F6.prototype.removeAllPrimitives=function(){for(var e=this._dynamicUpdaters.values,t=0,i=e.length;t<i;t++)e[t].destroy();this._dynamicUpdaters.removeAll()},F6.prototype.getBoundingSphere=function(e,t){return e=this._dynamicUpdaters.get(e.id),Object(u.a)(e)&&Object(u.a)(e.getBoundingSphere)?e.getBoundingSphere(t):nD.FAILED};var k6=F6,B6=new uf,z6=z.ZERO,U6=new z,V6=new Ve;function H6(e){this.id=e,this.vertexFormat=void 0,this.center=void 0,this.semiMajorAxis=void 0,this.semiMinorAxis=void 0,this.rotation=void 0,this.height=void 0,this.extrudedHeight=void 0,this.granularity=void 0,this.stRotation=void 0,this.numberOfVerticalLines=void 0,this.offsetAttribute=void 0}function G6(e,t){UU.call(this,{entity:e,scene:t,geometryOptions:new H6(e),geometryPropertyName:"ellipse",observedPropertyNames:["availability","position","ellipse"]}),this._onEntityPropertyChanged(e,"ellipse",e.ellipse,void 0)}function q6(e,t,i){aU.call(this,e,t,i)}Object(u.a)(Object.create)&&(G6.prototype=Object.create(UU.prototype),G6.prototype.constructor=G6),G6.prototype.createFillGeometryInstance=function(e){if(x.a.defined("time",e),!this._fillEnabled)throw new h.a("This instance does not represent a filled geometry.");var t,i=this._entity,n=i.isAvailable(e),r={show:new sA(n&&i.isShowing&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)),distanceDisplayCondition:bv.fromDistanceDisplayCondition(this._distanceDisplayConditionProperty.getValue(e)),offset:void 0,color:void 0};this._materialProperty instanceof oM&&(Object(u.a)(this._materialProperty.color)&&(this._materialProperty.color.isConstant||n)&&(t=this._materialProperty.color.getValue(e,B6)),Object(u.a)(t)||(t=uf.WHITE),r.color=df.fromColor(t));return Object(u.a)(this._options.offsetAttribute)&&(r.offset=tE.fromCartesian3(aD.getValueOrDefault(this._terrainOffsetProperty,e,z6,U6))),new Mu({id:i,geometry:new Id(this._options),attributes:r})},G6.prototype.createOutlineGeometryInstance=function(e){if(x.a.defined("time",e),!this._outlineEnabled)throw new h.a("This instance does not represent an outlined geometry.");var t=this._entity,i=t.isAvailable(e),n=aD.getValueOrDefault(this._outlineColorProperty,e,uf.BLACK,B6),r=this._distanceDisplayConditionProperty.getValue(e),a={show:new sA(i&&t.isShowing&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)),color:df.fromColor(n),distanceDisplayCondition:bv.fromDistanceDisplayCondition(r),offset:void 0};return Object(u.a)(this._options.offsetAttribute)&&(a.offset=tE.fromCartesian3(aD.getValueOrDefault(this._terrainOffsetProperty,e,z6,U6))),new Mu({id:t,geometry:new Hd(this._options),attributes:a})},G6.prototype._computeCenter=function(e,t){return aD.getValueOrUndefined(this._entity.position,e,t)},G6.prototype._isHidden=function(e,t){var i=e.position;return!Object(u.a)(i)||!Object(u.a)(t.semiMajorAxis)||!Object(u.a)(t.semiMinorAxis)||Qz.prototype._isHidden.call(this,e,t)},G6.prototype._isDynamic=function(e,t){return!e.position.isConstant||!t.semiMajorAxis.isConstant||!t.semiMinorAxis.isConstant||!aD.isConstant(t.rotation)||!aD.isConstant(t.height)||!aD.isConstant(t.extrudedHeight)||!aD.isConstant(t.granularity)||!aD.isConstant(t.stRotation)||!aD.isConstant(t.outlineWidth)||!aD.isConstant(t.numberOfVerticalLines)||!aD.isConstant(t.zIndex)||this._onTerrain&&!aD.isConstant(this._materialProperty)},G6.prototype._setStaticOptions=function(e,t){var i=aD.getValueOrUndefined(t.height,nx.MINIMUM_VALUE),n=aD.getValueOrDefault(t.heightReference,nx.MINIMUM_VALUE,eD.NONE),r=aD.getValueOrUndefined(t.extrudedHeight,nx.MINIMUM_VALUE),a=aD.getValueOrDefault(t.extrudedHeightReference,nx.MINIMUM_VALUE,eD.NONE);Object(u.a)(r)&&!Object(u.a)(i)&&(i=0);var o=this._options;o.vertexFormat=this._materialProperty instanceof oM?$j.VERTEX_FORMAT:Yj.MaterialSupport.TEXTURED.vertexFormat,o.center=e.position.getValue(nx.MINIMUM_VALUE,o.center),o.semiMajorAxis=t.semiMajorAxis.getValue(nx.MINIMUM_VALUE,o.semiMajorAxis),o.semiMinorAxis=t.semiMinorAxis.getValue(nx.MINIMUM_VALUE,o.semiMinorAxis),o.rotation=aD.getValueOrUndefined(t.rotation,nx.MINIMUM_VALUE),o.granularity=aD.getValueOrUndefined(t.granularity,nx.MINIMUM_VALUE),o.stRotation=aD.getValueOrUndefined(t.stRotation,nx.MINIMUM_VALUE),o.numberOfVerticalLines=aD.getValueOrUndefined(t.numberOfVerticalLines,nx.MINIMUM_VALUE),o.offsetAttribute=UU.computeGeometryOffsetAttribute(i,n,r,a),o.height=UU.getGeometryHeight(i,n),(r=UU.getGeometryExtrudedHeight(r,a))===UU.CLAMP_TO_GROUND&&(r=Xt.getMinimumMaximumHeights(Id.computeRectangle(o,V6)).minimumTerrainHeight),o.extrudedHeight=r},G6.DynamicGeometryUpdater=q6,Object(u.a)(Object.create)&&(q6.prototype=Object.create(aU.prototype),q6.prototype.constructor=q6),q6.prototype._isHidden=function(e,t,i){var n=this._options;return!Object(u.a)(n.center)||!Object(u.a)(n.semiMajorAxis)||!Object(u.a)(n.semiMinorAxis)||aU.prototype._isHidden.call(this,e,t,i)},q6.prototype._setOptions=function(e,t,i){var n=this._options,r=aD.getValueOrUndefined(t.height,i),a=aD.getValueOrDefault(t.heightReference,i,eD.NONE),o=aD.getValueOrUndefined(t.extrudedHeight,i),s=aD.getValueOrDefault(t.extrudedHeightReference,i,eD.NONE);Object(u.a)(o)&&!Object(u.a)(r)&&(r=0),n.center=aD.getValueOrUndefined(e.position,i,n.center),n.semiMajorAxis=aD.getValueOrUndefined(t.semiMajorAxis,i),n.semiMinorAxis=aD.getValueOrUndefined(t.semiMinorAxis,i),n.rotation=aD.getValueOrUndefined(t.rotation,i),n.granularity=aD.getValueOrUndefined(t.granularity,i),n.stRotation=aD.getValueOrUndefined(t.stRotation,i),n.numberOfVerticalLines=aD.getValueOrUndefined(t.numberOfVerticalLines,i),n.offsetAttribute=UU.computeGeometryOffsetAttribute(r,a,o,s),n.height=UU.getGeometryHeight(r,a),(o=UU.getGeometryExtrudedHeight(o,s))===UU.CLAMP_TO_GROUND&&(o=Xt.getMinimumMaximumHeights(Id.computeRectangle(n,V6)).minimumTerrainHeight),n.extrudedHeight=o};var W6=G6,Y6=new oM(uf.WHITE),X6=z.ZERO,Z6=new z,Q6=new z,K6=new uf,J6=new z(1,1,1);function $6(e){this.id=e,this.vertexFormat=void 0,this.radii=void 0,this.stackPartitions=void 0,this.slicePartitions=void 0,this.subdivisions=void 0,this.offsetAttribute=void 0}function e8(e,t){Qz.call(this,{entity:e,scene:t,geometryOptions:new $6(e),geometryPropertyName:"ellipsoid",observedPropertyNames:["availability","position","orientation","ellipsoid"]}),this._onEntityPropertyChanged(e,"ellipsoid",e.ellipsoid,void 0)}function t8(e,t,i){aU.call(this,e,t,i),this._scene=e._scene,this._modelMatrix=new Be,this._attributes=void 0,this._outlineAttributes=void 0,this._lastSceneMode=void 0,this._lastShow=void 0,this._lastOutlineShow=void 0,this._lastOutlineWidth=void 0,this._lastOutlineColor=void 0,this._lastOffset=new z,this._material={}}Object(u.a)(Object.create)&&(e8.prototype=Object.create(Qz.prototype),e8.prototype.constructor=e8),Object(O.a)(e8.prototype,{terrainOffsetProperty:{get:function(){return this._terrainOffsetProperty}}}),e8.prototype.createFillGeometryInstance=function(e,t,i){x.a.defined("time",e);var n,r,a=this._entity,o=a.isAvailable(e),s=new sA(o&&a.isShowing&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)),c=this._distanceDisplayConditionProperty.getValue(e),l={show:s,distanceDisplayCondition:bv.fromDistanceDisplayCondition(c),color:void 0,offset:void 0};this._materialProperty instanceof oM&&(Object(u.a)(this._materialProperty.color)&&(this._materialProperty.color.isConstant||o)&&(r=this._materialProperty.color.getValue(e,K6)),Object(u.a)(r)||(r=uf.WHITE),n=df.fromColor(r),l.color=n);return Object(u.a)(this._options.offsetAttribute)&&(l.offset=tE.fromCartesian3(aD.getValueOrDefault(this._terrainOffsetProperty,e,X6,Z6))),new Mu({id:a,geometry:new Hv(this._options),modelMatrix:t?void 0:a.computeModelMatrixForHeightReference(e,a.ellipsoid.heightReference,.5*this._options.radii.z,this._scene.mapProjection.ellipsoid,i),attributes:l})},e8.prototype.createOutlineGeometryInstance=function(e,t,i){x.a.defined("time",e);var n=this._entity,r=n.isAvailable(e),a=aD.getValueOrDefault(this._outlineColorProperty,e,uf.BLACK,K6),o=this._distanceDisplayConditionProperty.getValue(e),s={show:new sA(r&&n.isShowing&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)),color:df.fromColor(a),distanceDisplayCondition:bv.fromDistanceDisplayCondition(o),offset:void 0};return Object(u.a)(this._options.offsetAttribute)&&(s.offset=tE.fromCartesian3(aD.getValueOrDefault(this._terrainOffsetProperty,e,X6,Z6))),new Mu({id:n,geometry:new Qv(this._options),modelMatrix:t?void 0:n.computeModelMatrixForHeightReference(e,n.ellipsoid.heightReference,.5*this._options.radii.z,this._scene.mapProjection.ellipsoid,i),attributes:s})},e8.prototype._computeCenter=function(e,t){return aD.getValueOrUndefined(this._entity.position,e,t)},e8.prototype._isHidden=function(e,t){return!Object(u.a)(e.position)||!Object(u.a)(t.radii)||Qz.prototype._isHidden.call(this,e,t)},e8.prototype._isDynamic=function(e,t){return!(e.position.isConstant&&aD.isConstant(e.orientation)&&t.radii.isConstant&&aD.isConstant(t.stackPartitions)&&aD.isConstant(t.slicePartitions)&&aD.isConstant(t.outlineWidth)&&aD.isConstant(t.subdivisions))},e8.prototype._setStaticOptions=function(e,t){var i=aD.getValueOrDefault(t.heightReference,nx.MINIMUM_VALUE,eD.NONE),n=this._options;n.vertexFormat=this._materialProperty instanceof oM?$j.VERTEX_FORMAT:Yj.MaterialSupport.TEXTURED.vertexFormat,n.radii=t.radii.getValue(nx.MINIMUM_VALUE,n.radii),n.stackPartitions=aD.getValueOrUndefined(t.stackPartitions,nx.MINIMUM_VALUE),n.slicePartitions=aD.getValueOrUndefined(t.slicePartitions,nx.MINIMUM_VALUE),n.subdivisions=aD.getValueOrUndefined(t.subdivisions,nx.MINIMUM_VALUE),n.offsetAttribute=i!==eD.NONE?fn.ALL:void 0},e8.prototype._onEntityPropertyChanged=tU,e8.DynamicGeometryUpdater=t8,Object(u.a)(Object.create)&&(t8.prototype=Object.create(aU.prototype),t8.prototype.constructor=t8),t8.prototype.update=function(e){x.a.defined("time",e);var t=this._entity,i=t.ellipsoid;if(!t.isShowing||!t.isAvailable(e)||!aD.getValueOrDefault(i.show,e,!0))return Object(u.a)(this._primitive)&&(this._primitive.show=!1),void(Object(u.a)(this._outlinePrimitive)&&(this._outlinePrimitive.show=!1));var n=aD.getValueOrUndefined(i.radii,e,Q6),r=Object(u.a)(n)?t.computeModelMatrixForHeightReference(e,i.heightReference,.5*n.z,this._scene.mapProjection.ellipsoid,this._modelMatrix):void 0;if(!Object(u.a)(r)||!Object(u.a)(n))return Object(u.a)(this._primitive)&&(this._primitive.show=!1),void(Object(u.a)(this._outlinePrimitive)&&(this._outlinePrimitive.show=!1));var a=aD.getValueOrDefault(i.fill,e,!0),o=aD.getValueOrDefault(i.outline,e,!1),s=aD.getValueOrClonedDefault(i.outlineColor,e,uf.BLACK,K6),c=nU.getValue(e,Object(w.a)(i.material,Y6),this._material),l=aD.getValueOrUndefined(i.stackPartitions,e),h=aD.getValueOrUndefined(i.slicePartitions,e),d=aD.getValueOrUndefined(i.subdivisions,e),f=aD.getValueOrDefault(i.outlineWidth,e,1),p=aD.getValueOrDefault(i.heightReference,e,eD.NONE),m=p!==eD.NONE?fn.ALL:void 0,_=this._scene.mode,g=_===xF.SCENE3D&&p===eD.NONE,v=this._options,b=this._geometryUpdater.shadowsProperty.getValue(e),y=this._geometryUpdater.distanceDisplayConditionProperty.getValue(e),O=aD.getValueOrDefault(this._geometryUpdater.terrainOffsetProperty,e,X6,Z6);if(!g||this._lastSceneMode!==_||!Object(u.a)(this._primitive)||v.stackPartitions!==l||v.slicePartitions!==h||v.subdivisions!==d||this._lastOutlineWidth!==f||v.offsetAttribute!==m){var E=this._primitives;E.removeAndDestroy(this._primitive),E.removeAndDestroy(this._outlinePrimitive),this._primitive=void 0,this._outlinePrimitive=void 0,this._lastSceneMode=_,this._lastOutlineWidth=f,v.stackPartitions=l,v.slicePartitions=h,v.subdivisions=d,v.offsetAttribute=m,v.radii=g?J6:n;var T=new Yj({material:c,translucent:c.isTranslucent(),closed:!0});v.vertexFormat=T.vertexFormat;var C=this._geometryUpdater.createFillGeometryInstance(e,g,this._modelMatrix);this._primitive=E.add(new ck({geometryInstances:C,appearance:T,asynchronous:!1,shadows:b}));var S=this._geometryUpdater.createOutlineGeometryInstance(e,g,this._modelMatrix);this._outlinePrimitive=E.add(new ck({geometryInstances:S,appearance:new $j({flat:!0,translucent:255!==S.attributes.color.value[3],renderState:{lineWidth:this._geometryUpdater._scene.clampLineWidth(f)}}),asynchronous:!1,shadows:b})),this._lastShow=a,this._lastOutlineShow=o,this._lastOutlineColor=uf.clone(s,this._lastOutlineColor),this._lastDistanceDisplayCondition=y,this._lastOffset=z.clone(O,this._lastOffset)}else if(this._primitive.ready){var A=this._primitive,P=this._outlinePrimitive;A.show=!0,P.show=!0,A.appearance.material=c;var I=this._attributes;Object(u.a)(I)||(I=A.getGeometryInstanceAttributes(t),this._attributes=I),a!==this._lastShow&&(I.show=sA.toValue(a,I.show),this._lastShow=a);var D=this._outlineAttributes;Object(u.a)(D)||(D=P.getGeometryInstanceAttributes(t),this._outlineAttributes=D),o!==this._lastOutlineShow&&(D.show=sA.toValue(o,D.show),this._lastOutlineShow=o),uf.equals(s,this._lastOutlineColor)||(D.color=df.toValue(s,D.color),uf.clone(s,this._lastOutlineColor)),gv.equals(y,this._lastDistanceDisplayCondition)||(I.distanceDisplayCondition=bv.toValue(y,I.distanceDisplayCondition),D.distanceDisplayCondition=bv.toValue(y,D.distanceDisplayCondition),gv.clone(y,this._lastDistanceDisplayCondition)),z.equals(O,this._lastOffset)||(I.offset=tE.toValue(O,I.offset),D.offset=tE.toValue(O,I.offset),z.clone(O,this._lastOffset))}g&&(n.x=Math.max(n.x,.001),n.y=Math.max(n.y,.001),n.z=Math.max(n.z,.001),r=Be.multiplyByScale(r,n,r),this._primitive.modelMatrix=r,this._outlinePrimitive.modelMatrix=r)};var i8=e8,n8=new z,r8=new uf;function a8(e){this.id=e,this.vertexFormat=void 0,this.plane=void 0,this.dimensions=void 0}function o8(e,t){Qz.call(this,{entity:e,scene:t,geometryOptions:new a8(e),geometryPropertyName:"plane",observedPropertyNames:["availability","position","orientation","plane"]}),this._onEntityPropertyChanged(e,"plane",e.plane,void 0)}function s8(e,t,i){aU.call(this,e,t,i)}Object(u.a)(Object.create)&&(o8.prototype=Object.create(Qz.prototype),o8.prototype.constructor=o8),o8.prototype.createFillGeometryInstance=function(e){if(x.a.defined("time",e),!this._fillEnabled)throw new h.a("This instance does not represent a filled geometry.");var t,i,n=this._entity,r=n.isAvailable(e),a=new sA(r&&n.isShowing&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)),o=this._distanceDisplayConditionProperty.getValue(e),s=bv.fromDistanceDisplayCondition(o);this._materialProperty instanceof oM?(Object(u.a)(this._materialProperty.color)&&(this._materialProperty.color.isConstant||r)&&(i=this._materialProperty.color.getValue(e,r8)),Object(u.a)(i)||(i=uf.WHITE),t={show:a,distanceDisplayCondition:s,color:df.fromColor(i)}):t={show:a,distanceDisplayCondition:s};var c=n.plane,l=this._options,d=n.computeModelMatrix(e),f=aD.getValueOrDefault(c.plane,e,l.plane),p=aD.getValueOrUndefined(c.dimensions,e,l.dimensions);return l.plane=f,l.dimensions=p,d=m8(f,p,d,this._scene.mapProjection.ellipsoid,d),new Mu({id:n,geometry:new xE(this._options),modelMatrix:d,attributes:t})},o8.prototype.createOutlineGeometryInstance=function(e){if(x.a.defined("time",e),!this._outlineEnabled)throw new h.a("This instance does not represent an outlined geometry.");var t=this._entity,i=t.isAvailable(e),n=aD.getValueOrDefault(this._outlineColorProperty,e,uf.BLACK,r8),r=this._distanceDisplayConditionProperty.getValue(e),a=t.plane,o=this._options,s=t.computeModelMatrix(e),c=aD.getValueOrDefault(a.plane,e,o.plane),l=aD.getValueOrUndefined(a.dimensions,e,o.dimensions);return o.plane=c,o.dimensions=l,s=m8(c,l,s,this._scene.mapProjection.ellipsoid,s),new Mu({id:t,geometry:new SE,modelMatrix:s,attributes:{show:new sA(i&&t.isShowing&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)),color:df.fromColor(n),distanceDisplayCondition:bv.fromDistanceDisplayCondition(r)}})},o8.prototype._isHidden=function(e,t){return!Object(u.a)(t.plane)||!Object(u.a)(t.dimensions)||!Object(u.a)(e.position)||Qz.prototype._isHidden.call(this,e,t)},o8.prototype._getIsClosed=function(e){return!1},o8.prototype._isDynamic=function(e,t){return!(e.position.isConstant&&aD.isConstant(e.orientation)&&t.plane.isConstant&&t.dimensions.isConstant&&aD.isConstant(t.outlineWidth))},o8.prototype._setStaticOptions=function(e,t){var i=this._materialProperty instanceof oM,n=this._options;n.vertexFormat=i?$j.VERTEX_FORMAT:Yj.MaterialSupport.TEXTURED.vertexFormat,n.plane=t.plane.getValue(nx.MINIMUM_VALUE,n.plane),n.dimensions=t.dimensions.getValue(nx.MINIMUM_VALUE,n.dimensions)},o8.DynamicGeometryUpdater=s8,Object(u.a)(Object.create)&&(s8.prototype=Object.create(aU.prototype),s8.prototype.constructor=s8),s8.prototype._isHidden=function(e,t,i){var n=this._options,r=aD.getValueOrUndefined(e.position,i,n8);return!Object(u.a)(r)||!Object(u.a)(n.plane)||!Object(u.a)(n.dimensions)||aU.prototype._isHidden.call(this,e,t,i)},s8.prototype._setOptions=function(e,t,i){var n=this._options;n.plane=aD.getValueOrDefault(t.plane,i,n.plane),n.dimensions=aD.getValueOrUndefined(t.dimensions,i,n.dimensions)};var c8=new z,l8=new z,u8=new z,h8=new z,d8=new z,f8=new Kn,p8=new be;function m8(e,t,i,n,r){var a=e.normal,o=e.distance,s=z.multiplyByScalar(a,-o,u8);s=Be.multiplyByPoint(i,s,s);var c=Be.multiplyByPointAsVector(i,a,h8);z.normalize(c,c);var l=n.geodeticSurfaceNormal(s,l8);I.equalsEpsilon(Math.abs(z.dot(l,c)),1,I.EPSILON8)&&(l=z.clone(z.UNIT_Z,l));var u=z.cross(l,c,c8);l=z.cross(c,u,l),z.normalize(u,u),z.normalize(l,l);var h=p8;be.setColumn(h,0,u,h),be.setColumn(h,1,l,h),be.setColumn(h,2,c,h);var d=Kn.fromRotationMatrix(h,f8),f=Rt.clone(t,d8);return f.z=1,Be.fromTranslationQuaternionRotationScale(s,d,f,r)}o8.createPrimitiveMatrix=m8;var _8=o8,g8=new uf,v8=z.ZERO,b8=new z,y8=new Ve,w8=[],O8=new Rt;function x8(e){this.id=e,this.vertexFormat=void 0,this.polygonHierarchy=void 0,this.perPositionHeight=void 0,this.closeTop=void 0,this.closeBottom=void 0,this.height=void 0,this.extrudedHeight=void 0,this.granularity=void 0,this.stRotation=void 0,this.offsetAttribute=void 0,this.arcType=void 0}function E8(e,t){UU.call(this,{entity:e,scene:t,geometryOptions:new x8(e),geometryPropertyName:"polygon",observedPropertyNames:["availability","polygon"]}),this._onEntityPropertyChanged(e,"polygon",e.polygon,void 0)}function T8(e,t,i){aU.call(this,e,t,i)}Object(u.a)(Object.create)&&(E8.prototype=Object.create(UU.prototype),E8.prototype.constructor=E8),E8.prototype.createFillGeometryInstance=function(e){if(x.a.defined("time",e),!this._fillEnabled)throw new h.a("This instance does not represent a filled geometry.");var t,i,n=this._entity,r=n.isAvailable(e),a=this._options,o={show:new sA(r&&n.isShowing&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)),distanceDisplayCondition:bv.fromDistanceDisplayCondition(this._distanceDisplayConditionProperty.getValue(e)),offset:void 0,color:void 0};this._materialProperty instanceof oM&&(Object(u.a)(this._materialProperty.color)&&(this._materialProperty.color.isConstant||r)&&(t=this._materialProperty.color.getValue(e,g8)),Object(u.a)(t)||(t=uf.WHITE),o.color=df.fromColor(t));return Object(u.a)(a.offsetAttribute)&&(o.offset=tE.fromCartesian3(aD.getValueOrDefault(this._terrainOffsetProperty,e,v8,b8))),i=a.perPositionHeight&&!Object(u.a)(a.extrudedHeight)?new cm(a):new lT(a),new Mu({id:n,geometry:i,attributes:o})},E8.prototype.createOutlineGeometryInstance=function(e){if(x.a.defined("time",e),!this._outlineEnabled)throw new h.a("This instance does not represent an outlined geometry.");var t,i=this._entity,n=i.isAvailable(e),r=this._options,a=aD.getValueOrDefault(this._outlineColorProperty,e,uf.BLACK,g8),o=this._distanceDisplayConditionProperty.getValue(e),s={show:new sA(n&&i.isShowing&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)),color:df.fromColor(a),distanceDisplayCondition:bv.fromDistanceDisplayCondition(o),offset:void 0};return Object(u.a)(r.offsetAttribute)&&(s.offset=tE.fromCartesian3(aD.getValueOrDefault(this._terrainOffsetProperty,e,v8,b8))),t=r.perPositionHeight&&!Object(u.a)(r.extrudedHeight)?new dm(r):new vT(r),new Mu({id:i,geometry:t,attributes:s})},E8.prototype._computeCenter=function(e,t){var i=aD.getValueOrUndefined(this._entity.polygon.hierarchy,e);if(Object(u.a)(i)&&!Object(ym.a)(i)&&(i=i.positions),0!==i.length){for(var n=this._scene.mapProjection.ellipsoid,r=fc.fromPoints(i,n),a=r.projectPointsOntoPlane(i,w8),o=a.length,s=0,c=o-1,l=new Rt,h=0;h<o;c=h++){var d=a[h],f=a[c],p=d.x*f.y-f.x*d.y,m=Rt.add(d,f,O8);m=Rt.multiplyByScalar(m,p,m),l=Rt.add(l,m,l),s+=p}var _=1/(3*s);return l=Rt.multiplyByScalar(l,_,l),r.projectPointOntoEllipsoid(l,t)}},E8.prototype._isHidden=function(e,t){return!Object(u.a)(t.hierarchy)||Qz.prototype._isHidden.call(this,e,t)},E8.prototype._isOnTerrain=function(e,t){var i=UU.prototype._isOnTerrain.call(this,e,t),n=t.perPositionHeight,r=Object(u.a)(n)&&(!n.isConstant||n.getValue(nx.MINIMUM_VALUE));return i&&!r},E8.prototype._isDynamic=function(e,t){return!t.hierarchy.isConstant||!aD.isConstant(t.height)||!aD.isConstant(t.extrudedHeight)||!aD.isConstant(t.granularity)||!aD.isConstant(t.stRotation)||!aD.isConstant(t.outlineWidth)||!aD.isConstant(t.perPositionHeight)||!aD.isConstant(t.closeTop)||!aD.isConstant(t.closeBottom)||!aD.isConstant(t.zIndex)||!aD.isConstant(t.arcType)||this._onTerrain&&!aD.isConstant(this._materialProperty)},E8.prototype._setStaticOptions=function(e,t){var i=this._materialProperty instanceof oM,n=this._options;n.vertexFormat=i?$j.VERTEX_FORMAT:Yj.MaterialSupport.TEXTURED.vertexFormat;var r=t.hierarchy.getValue(nx.MINIMUM_VALUE);Object(ym.a)(r)&&(r=new uT(r));var a,o=aD.getValueOrUndefined(t.height,nx.MINIMUM_VALUE),s=aD.getValueOrDefault(t.heightReference,nx.MINIMUM_VALUE,eD.NONE),c=aD.getValueOrUndefined(t.extrudedHeight,nx.MINIMUM_VALUE),l=aD.getValueOrDefault(t.extrudedHeightReference,nx.MINIMUM_VALUE,eD.NONE),h=aD.getValueOrDefault(t.perPositionHeight,nx.MINIMUM_VALUE,!1);o=UU.getGeometryHeight(o,s),h?(Object(u.a)(o)&&(o=void 0,Object(iE.a)("Entity polygons cannot have both height and perPositionHeight.  height will be ignored")),s!==eD.NONE&&h&&(o=void 0,Object(iE.a)("heightReference is not supported for entity polygons with perPositionHeight. heightReference will be ignored"))):(Object(u.a)(c)&&!Object(u.a)(o)&&(o=0),a=UU.computeGeometryOffsetAttribute(o,s,c,l)),n.polygonHierarchy=r,n.granularity=aD.getValueOrUndefined(t.granularity,nx.MINIMUM_VALUE),n.stRotation=aD.getValueOrUndefined(t.stRotation,nx.MINIMUM_VALUE),n.perPositionHeight=h,n.closeTop=aD.getValueOrDefault(t.closeTop,nx.MINIMUM_VALUE,!0),n.closeBottom=aD.getValueOrDefault(t.closeBottom,nx.MINIMUM_VALUE,!0),n.offsetAttribute=a,n.height=o,n.arcType=aD.getValueOrDefault(t.arcType,nx.MINIMUM_VALUE,Zt.GEODESIC),(c=UU.getGeometryExtrudedHeight(c,l))===UU.CLAMP_TO_GROUND&&(c=Xt.getMinimumMaximumHeights(lT.computeRectangle(n,y8)).minimumTerrainHeight),n.extrudedHeight=c},E8.prototype._getIsClosed=function(e){var t=e.height,i=e.extrudedHeight,n=Object(u.a)(i)&&i!==t;return!e.perPositionHeight&&(!n&&0===t||n&&e.closeTop&&e.closeBottom)},E8.DynamicGeometryUpdater=T8,Object(u.a)(Object.create)&&(T8.prototype=Object.create(aU.prototype),T8.prototype.constructor=T8),T8.prototype._isHidden=function(e,t,i){return!Object(u.a)(this._options.polygonHierarchy)||aU.prototype._isHidden.call(this,e,t,i)},T8.prototype._setOptions=function(e,t,i){var n=this._options,r=aD.getValueOrUndefined(t.hierarchy,i);Object(ym.a)(r)?n.polygonHierarchy=new uT(r):n.polygonHierarchy=r;var a,o=aD.getValueOrUndefined(t.height,i),s=aD.getValueOrDefault(t.heightReference,i,eD.NONE),c=aD.getValueOrDefault(t.extrudedHeightReference,i,eD.NONE),l=aD.getValueOrUndefined(t.extrudedHeight,i),h=aD.getValueOrUndefined(t.perPositionHeight,i);o=UU.getGeometryHeight(o,c),h?(Object(u.a)(o)&&(o=void 0,Object(iE.a)("Entity polygons cannot have both height and perPositionHeight.  height will be ignored")),s!==eD.NONE&&h&&(o=void 0,Object(iE.a)("heightReference is not supported for entity polygons with perPositionHeight. heightReference will be ignored"))):(Object(u.a)(l)&&!Object(u.a)(o)&&(o=0),a=UU.computeGeometryOffsetAttribute(o,s,l,c)),n.granularity=aD.getValueOrUndefined(t.granularity,i),n.stRotation=aD.getValueOrUndefined(t.stRotation,i),n.perPositionHeight=aD.getValueOrUndefined(t.perPositionHeight,i),n.closeTop=aD.getValueOrDefault(t.closeTop,i,!0),n.closeBottom=aD.getValueOrDefault(t.closeBottom,i,!0),n.offsetAttribute=a,n.height=o,n.arcType=aD.getValueOrDefault(t.arcType,i,Zt.GEODESIC),(l=UU.getGeometryExtrudedHeight(l,c))===UU.CLAMP_TO_GROUND&&(l=Xt.getMinimumMaximumHeights(lT.computeRectangle(n,y8)).minimumTerrainHeight),n.extrudedHeight=l};var C8=E8,S8=new uf;function A8(e){this.id=e,this.vertexFormat=void 0,this.polylinePositions=void 0,this.shapePositions=void 0,this.cornerType=void 0,this.granularity=void 0}function P8(e,t){Qz.call(this,{entity:e,scene:t,geometryOptions:new A8(e),geometryPropertyName:"polylineVolume",observedPropertyNames:["availability","polylineVolume"]}),this._onEntityPropertyChanged(e,"polylineVolume",e.polylineVolume,void 0)}function I8(e,t,i){aU.call(this,e,t,i)}Object(u.a)(Object.create)&&(P8.prototype=Object.create(Qz.prototype),P8.prototype.constructor=P8),P8.prototype.createFillGeometryInstance=function(e){if(x.a.defined("time",e),!this._fillEnabled)throw new h.a("This instance does not represent a filled geometry.");var t,i,n=this._entity,r=n.isAvailable(e),a=new sA(r&&n.isShowing&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)),o=this._distanceDisplayConditionProperty.getValue(e),s=bv.fromDistanceDisplayCondition(o);this._materialProperty instanceof oM?(Object(u.a)(this._materialProperty.color)&&(this._materialProperty.color.isConstant||r)&&(i=this._materialProperty.color.getValue(e,S8)),Object(u.a)(i)||(i=uf.WHITE),t={show:a,distanceDisplayCondition:s,color:df.fromColor(i)}):t={show:a,distanceDisplayCondition:s};return new Mu({id:n,geometry:new LT(this._options),attributes:t})},P8.prototype.createOutlineGeometryInstance=function(e){if(x.a.defined("time",e),!this._outlineEnabled)throw new h.a("This instance does not represent an outlined geometry.");var t=this._entity,i=t.isAvailable(e),n=aD.getValueOrDefault(this._outlineColorProperty,e,uf.BLACK,S8),r=this._distanceDisplayConditionProperty.getValue(e);return new Mu({id:t,geometry:new zT(this._options),attributes:{show:new sA(i&&t.isShowing&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)),color:df.fromColor(n),distanceDisplayCondition:bv.fromDistanceDisplayCondition(r)}})},P8.prototype._isHidden=function(e,t){return!Object(u.a)(t.positions)||!Object(u.a)(t.shape)||Qz.prototype._isHidden.call(this,e,t)},P8.prototype._isDynamic=function(e,t){return!(t.positions.isConstant&&t.shape.isConstant&&aD.isConstant(t.granularity)&&aD.isConstant(t.outlineWidth)&&aD.isConstant(t.cornerType))},P8.prototype._setStaticOptions=function(e,t){var i=t.granularity,n=t.cornerType,r=this._options,a=this._materialProperty instanceof oM;r.vertexFormat=a?$j.VERTEX_FORMAT:Yj.MaterialSupport.TEXTURED.vertexFormat,r.polylinePositions=t.positions.getValue(nx.MINIMUM_VALUE,r.polylinePositions),r.shapePositions=t.shape.getValue(nx.MINIMUM_VALUE,r.shape),r.granularity=Object(u.a)(i)?i.getValue(nx.MINIMUM_VALUE):void 0,r.cornerType=Object(u.a)(n)?n.getValue(nx.MINIMUM_VALUE):void 0},P8.DynamicGeometryUpdater=I8,Object(u.a)(Object.create)&&(I8.prototype=Object.create(aU.prototype),I8.prototype.constructor=I8),I8.prototype._isHidden=function(e,t,i){var n=this._options;return!Object(u.a)(n.polylinePositions)||!Object(u.a)(n.shapePositions)||aU.prototype._isHidden.call(this,e,t,i)},I8.prototype._setOptions=function(e,t,i){var n=this._options;n.polylinePositions=aD.getValueOrUndefined(t.positions,i,n.polylinePositions),n.shapePositions=aD.getValueOrUndefined(t.shape,i),n.granularity=aD.getValueOrUndefined(t.granularity,i),n.cornerType=aD.getValueOrUndefined(t.cornerType,i)};var D8=P8,j8=new uf,M8=z.ZERO,R8=new z,L8=new Ve,N8=new Ve,F8=new K;function k8(e){this.id=e,this.vertexFormat=void 0,this.rectangle=void 0,this.height=void 0,this.extrudedHeight=void 0,this.granularity=void 0,this.stRotation=void 0,this.rotation=void 0,this.offsetAttribute=void 0}function B8(e,t){UU.call(this,{entity:e,scene:t,geometryOptions:new k8(e),geometryPropertyName:"rectangle",observedPropertyNames:["availability","rectangle"]}),this._onEntityPropertyChanged(e,"rectangle",e.rectangle,void 0)}function z8(e,t,i){aU.call(this,e,t,i)}Object(u.a)(Object.create)&&(B8.prototype=Object.create(UU.prototype),B8.prototype.constructor=B8),B8.prototype.createFillGeometryInstance=function(e){if(x.a.defined("time",e),!this._fillEnabled)throw new h.a("This instance does not represent a filled geometry.");var t,i=this._entity,n=i.isAvailable(e),r={show:new sA(n&&i.isShowing&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)),distanceDisplayCondition:bv.fromDistanceDisplayCondition(this._distanceDisplayConditionProperty.getValue(e)),offset:void 0,color:void 0};this._materialProperty instanceof oM&&(Object(u.a)(this._materialProperty.color)&&(this._materialProperty.color.isConstant||n)&&(t=this._materialProperty.color.getValue(e,j8)),Object(u.a)(t)||(t=uf.WHITE),r.color=df.fromColor(t));return Object(u.a)(this._options.offsetAttribute)&&(r.offset=tE.fromCartesian3(aD.getValueOrDefault(this._terrainOffsetProperty,e,M8,R8))),new Mu({id:i,geometry:new nS(this._options),attributes:r})},B8.prototype.createOutlineGeometryInstance=function(e){if(x.a.defined("time",e),!this._outlineEnabled)throw new h.a("This instance does not represent an outlined geometry.");var t=this._entity,i=t.isAvailable(e),n=aD.getValueOrDefault(this._outlineColorProperty,e,uf.BLACK,j8),r=this._distanceDisplayConditionProperty.getValue(e),a={show:new sA(i&&t.isShowing&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)),color:df.fromColor(n),distanceDisplayCondition:bv.fromDistanceDisplayCondition(r),offset:void 0};return Object(u.a)(this._options.offsetAttribute)&&(a.offset=tE.fromCartesian3(aD.getValueOrDefault(this._terrainOffsetProperty,e,M8,R8))),new Mu({id:t,geometry:new pS(this._options),attributes:a})},B8.prototype._computeCenter=function(e,t){var i=aD.getValueOrUndefined(this._entity.rectangle.coordinates,e,N8);if(Object(u.a)(i)){var n=Ve.center(i,F8);return K.toCartesian(n,ae.WGS84,t)}},B8.prototype._isHidden=function(e,t){return!Object(u.a)(t.coordinates)||Qz.prototype._isHidden.call(this,e,t)},B8.prototype._isDynamic=function(e,t){return!t.coordinates.isConstant||!aD.isConstant(t.height)||!aD.isConstant(t.extrudedHeight)||!aD.isConstant(t.granularity)||!aD.isConstant(t.stRotation)||!aD.isConstant(t.rotation)||!aD.isConstant(t.outlineWidth)||!aD.isConstant(t.zIndex)||this._onTerrain&&!aD.isConstant(this._materialProperty)},B8.prototype._setStaticOptions=function(e,t){var i=this._materialProperty instanceof oM,n=aD.getValueOrUndefined(t.height,nx.MINIMUM_VALUE),r=aD.getValueOrDefault(t.heightReference,nx.MINIMUM_VALUE,eD.NONE),a=aD.getValueOrUndefined(t.extrudedHeight,nx.MINIMUM_VALUE),o=aD.getValueOrDefault(t.extrudedHeightReference,nx.MINIMUM_VALUE,eD.NONE);Object(u.a)(a)&&!Object(u.a)(n)&&(n=0);var s=this._options;s.vertexFormat=i?$j.VERTEX_FORMAT:Yj.MaterialSupport.TEXTURED.vertexFormat,s.rectangle=t.coordinates.getValue(nx.MINIMUM_VALUE,s.rectangle),s.granularity=aD.getValueOrUndefined(t.granularity,nx.MINIMUM_VALUE),s.stRotation=aD.getValueOrUndefined(t.stRotation,nx.MINIMUM_VALUE),s.rotation=aD.getValueOrUndefined(t.rotation,nx.MINIMUM_VALUE),s.offsetAttribute=UU.computeGeometryOffsetAttribute(n,r,a,o),s.height=UU.getGeometryHeight(n,r),(a=UU.getGeometryExtrudedHeight(a,o))===UU.CLAMP_TO_GROUND&&(a=Xt.getMinimumMaximumHeights(nS.computeRectangle(s,L8)).minimumTerrainHeight),s.extrudedHeight=a},B8.DynamicGeometryUpdater=z8,Object(u.a)(Object.create)&&(z8.prototype=Object.create(aU.prototype),z8.prototype.constructor=z8),z8.prototype._isHidden=function(e,t,i){return!Object(u.a)(this._options.rectangle)||aU.prototype._isHidden.call(this,e,t,i)},z8.prototype._setOptions=function(e,t,i){var n=this._options,r=aD.getValueOrUndefined(t.height,i),a=aD.getValueOrDefault(t.heightReference,i,eD.NONE),o=aD.getValueOrUndefined(t.extrudedHeight,i),s=aD.getValueOrDefault(t.extrudedHeightReference,i,eD.NONE);Object(u.a)(o)&&!Object(u.a)(r)&&(r=0),n.rectangle=aD.getValueOrUndefined(t.coordinates,i,n.rectangle),n.granularity=aD.getValueOrUndefined(t.granularity,i),n.stRotation=aD.getValueOrUndefined(t.stRotation,i),n.rotation=aD.getValueOrUndefined(t.rotation,i),n.offsetAttribute=UU.computeGeometryOffsetAttribute(r,a,o,s),n.height=UU.getGeometryHeight(r,a),(o=UU.getGeometryExtrudedHeight(o,s))===UU.CLAMP_TO_GROUND&&(o=Xt.getMinimumMaximumHeights(nS.computeRectangle(n,L8)).minimumTerrainHeight),n.extrudedHeight=o};var U8=B8,V8=new uf,H8=new gv,G8=new gv,q8=z.ZERO,W8=new z;function Y8(e,t,i,n,r,a,o){var s;this.translucent=t,this.appearanceType=i,this.depthFailAppearanceType=n,this.depthFailMaterialProperty=r,this.depthFailMaterial=void 0,this.closed=a,this.shadows=o,this.primitives=e,this.createPrimitive=!1,this.waitingOnCreate=!1,this.primitive=void 0,this.oldPrimitive=void 0,this.geometry=new Fi,this.updaters=new Fi,this.updatersWithAttributes=new Fi,this.attributes=new Fi,this.subscriptions=new Fi,this.showsUpdated=new Fi,this.itemsToRemove=[],this.invalidated=!1,Object(u.a)(r)&&(s=r.definitionChanged.addEventListener(Y8.prototype.onMaterialChanged,this)),this.removeMaterialSubscription=s}function X8(e,t,i,n,r){this._solidItems=[],this._translucentItems=[],this._primitives=e,this._appearanceType=t,this._depthFailAppearanceType=i,this._closed=n,this._shadows=r}function Z8(e,t){for(var i=e.length-1;i>=0;i--){var n=e[i];if(n.remove(t))return 0===n.updaters.length&&(e.splice(i,1),n.destroy()),!0}return!1}function Q8(e,t,i){for(var n=!1,r=t.length,a=0;a<r;++a){var o=t[a],s=o.itemsToRemove,c=s.length;if(c>0)for(a=0;a<c;a++){var l=s[a];o.remove(l),e.add(i,l),n=!0}}return n}function K8(e,t,i,n){var r,a=t.length;for(r=a-1;r>=0;r--){var o=t[r];if(o.invalidated){t.splice(r,1);for(var s=o.updaters.values,c=s.length,l=0;l<c;l++)e.add(i,s[l]);o.destroy()}}for(a=t.length,r=0;r<a;++r)n=t[r].update(i)&&n;return n}function J8(e,t,i){for(var n=e.length,r=0;r<n;r++){var a=e[r];if(a.contains(t))return a.getBoundingSphere(t,i)}return nD.FAILED}function $8(e){for(var t=e.length,i=0;i<t;i++)e[i].destroy();e.length=0}Y8.prototype.onMaterialChanged=function(){this.invalidated=!0},Y8.prototype.isMaterial=function(e){var t=this.depthFailMaterialProperty,i=e.depthFailMaterialProperty;return i===t||!!Object(u.a)(t)&&t.equals(i)},Y8.prototype.add=function(e,t){var i=e.id;if(this.createPrimitive=!0,this.geometry.set(i,t),this.updaters.set(i,e),e.hasConstantFill&&e.fillMaterialProperty.isConstant&&aD.isConstant(e.distanceDisplayConditionProperty)&&aD.isConstant(e.terrainOffsetProperty)){var n=this;this.subscriptions.set(i,e.entity.definitionChanged.addEventListener((function(t,i,r,a){"isShowing"===i&&n.showsUpdated.set(e.id,e)})))}else this.updatersWithAttributes.set(i,e)},Y8.prototype.remove=function(e){var t=e.id;if(this.createPrimitive=this.geometry.remove(t)||this.createPrimitive,this.updaters.remove(t)){this.updatersWithAttributes.remove(t);var i=this.subscriptions.get(t);return Object(u.a)(i)&&(i(),this.subscriptions.remove(t),this.showsUpdated.remove(t)),!0}return!1},Y8.prototype.update=function(e){var t,i=!0,n=0,r=this.primitive,a=this.primitives;if(this.createPrimitive){var o=this.geometry.values;if(o.length>0){var s;Object(u.a)(r)&&(Object(u.a)(this.oldPrimitive)?a.remove(r):this.oldPrimitive=r),Object(u.a)(this.depthFailAppearanceType)&&(Object(u.a)(this.depthFailMaterialProperty)&&(this.depthFailMaterial=nU.getValue(e,this.depthFailMaterialProperty,this.depthFailMaterial)),s=new this.depthFailAppearanceType({material:this.depthFailMaterial,translucent:this.translucent,closed:this.closed})),r=new ck({show:!1,asynchronous:!0,geometryInstances:o,appearance:new this.appearanceType({translucent:this.translucent,closed:this.closed}),depthFailAppearance:s,shadows:this.shadows}),a.add(r),i=!1}else{Object(u.a)(r)&&(a.remove(r),r=void 0);var c=this.oldPrimitive;Object(u.a)(c)&&(a.remove(c),this.oldPrimitive=void 0)}this.attributes.removeAll(),this.primitive=r,this.createPrimitive=!1,this.waitingOnCreate=!0}else if(Object(u.a)(r)&&r.ready){r.show=!0,Object(u.a)(this.oldPrimitive)&&(a.remove(this.oldPrimitive),this.oldPrimitive=void 0),!Object(u.a)(this.depthFailAppearanceType)||this.depthFailMaterialProperty instanceof oM||(this.depthFailMaterial=nU.getValue(e,this.depthFailMaterialProperty,this.depthFailMaterial),this.primitive.depthFailAppearance.material=this.depthFailMaterial);var l=this.updatersWithAttributes.values,h=l.length,d=this.waitingOnCreate;for(t=0;t<h;t++){var f=l[t],p=this.geometry.get(f.id),m=this.attributes.get(p.id.id);if(Object(u.a)(m)||(m=r.getGeometryInstanceAttributes(p.id),this.attributes.set(p.id.id,m)),!f.fillMaterialProperty.isConstant||d){var _=f.fillMaterialProperty.color,g=aD.getValueOrDefault(_,e,uf.WHITE,V8);uf.equals(m._lastColor,g)||(m._lastColor=uf.clone(g,m._lastColor),m.color=df.toValue(g,m.color),(this.translucent&&255===m.color[3]||!this.translucent&&255!==m.color[3])&&(this.itemsToRemove[n++]=f))}if(Object(u.a)(this.depthFailAppearanceType)&&f.depthFailMaterialProperty instanceof oM&&(!f.depthFailMaterialProperty.isConstant||d)){var v=f.depthFailMaterialProperty.color,b=aD.getValueOrDefault(v,e,uf.WHITE,V8);uf.equals(m._lastDepthFailColor,b)||(m._lastDepthFailColor=uf.clone(b,m._lastDepthFailColor),m.depthFailColor=df.toValue(b,m.depthFailColor))}var y=f.entity.isShowing&&(f.hasConstantFill||f.isFilled(e));y!==(1===m.show[0])&&(m.show=sA.toValue(y,m.show));var w=f.distanceDisplayConditionProperty;if(!aD.isConstant(w)){var O=aD.getValueOrDefault(w,e,G8,H8);gv.equals(O,m._lastDistanceDisplayCondition)||(m._lastDistanceDisplayCondition=gv.clone(O,m._lastDistanceDisplayCondition),m.distanceDisplayCondition=bv.toValue(O,m.distanceDisplayCondition))}var x=f.terrainOffsetProperty;if(!aD.isConstant(x)){var E=aD.getValueOrDefault(x,e,q8,W8);z.equals(E,m._lastOffset)||(m._lastOffset=z.clone(E,m._lastOffset),m.offset=tE.toValue(E,m.offset))}}this.updateShows(r),this.waitingOnCreate=!1}else Object(u.a)(r)&&!r.ready&&(i=!1);return this.itemsToRemove.length=n,i},Y8.prototype.updateShows=function(e){for(var t=this.showsUpdated.values,i=t.length,n=0;n<i;n++){var r=t[n],a=this.geometry.get(r.id),o=this.attributes.get(a.id.id);Object(u.a)(o)||(o=e.getGeometryInstanceAttributes(a.id),this.attributes.set(a.id.id,o));var s=r.entity.isShowing;s!==(1===o.show[0])&&(o.show=sA.toValue(s,o.show),a.attributes.show.value[0]=o.show[0])}this.showsUpdated.removeAll()},Y8.prototype.contains=function(e){return this.updaters.contains(e.id)},Y8.prototype.getBoundingSphere=function(e,t){var i=this.primitive;if(!i.ready)return nD.PENDING;var n=i.getGeometryInstanceAttributes(e.entity);return!Object(u.a)(n)||!Object(u.a)(n.boundingSphere)||Object(u.a)(n.show)&&0===n.show[0]?nD.FAILED:(n.boundingSphere.clone(t),nD.DONE)},Y8.prototype.destroy=function(){var e=this.primitive,t=this.primitives;Object(u.a)(e)&&t.remove(e);var i=this.oldPrimitive;Object(u.a)(i)&&t.remove(i),Object(u.a)(this.removeMaterialSubscription)&&this.removeMaterialSubscription()},X8.prototype.add=function(e,t){var i,n,r=t.createFillGeometryInstance(e);255===r.attributes.color.value[3]?(i=this._solidItems,n=!1):(i=this._translucentItems,n=!0);for(var a=i.length,o=0;o<a;o++){var s=i[o];if(s.isMaterial(t))return void s.add(t,r)}var c=new Y8(this._primitives,n,this._appearanceType,this._depthFailAppearanceType,t.depthFailMaterialProperty,this._closed,this._shadows);c.add(t,r),i.push(c)},X8.prototype.remove=function(e){Z8(this._solidItems,e)||Z8(this._translucentItems,e)},X8.prototype.update=function(e){var t=K8(this,this._solidItems,e,!0);t=K8(this,this._translucentItems,e,t)&&t;var i=Q8(this,this._solidItems,e),n=Q8(this,this._translucentItems,e);return(i||n)&&(t=K8(this,this._solidItems,e,t)&&t,t=K8(this,this._translucentItems,e,t)&&t),t},X8.prototype.getBoundingSphere=function(e,t){var i=J8(this._solidItems,e,t);return i===nD.FAILED?J8(this._translucentItems,e,t):i},X8.prototype.removeAllPrimitives=function(){$8(this._solidItems),$8(this._translucentItems)};var e7=X8,t7=new gv,i7=new gv,n7=z.ZERO,r7=new z;function a7(e,t,i,n,r,a,o){this.primitives=e,this.appearanceType=t,this.materialProperty=i,this.depthFailAppearanceType=n,this.depthFailMaterialProperty=r,this.closed=a,this.shadows=o,this.updaters=new Fi,this.createPrimitive=!0,this.primitive=void 0,this.oldPrimitive=void 0,this.geometry=new Fi,this.material=void 0,this.depthFailMaterial=void 0,this.updatersWithAttributes=new Fi,this.attributes=new Fi,this.invalidated=!1,this.removeMaterialSubscription=i.definitionChanged.addEventListener(a7.prototype.onMaterialChanged,this),this.subscriptions=new Fi,this.showsUpdated=new Fi}a7.prototype.onMaterialChanged=function(){this.invalidated=!0},a7.prototype.isMaterial=function(e){var t=this.materialProperty,i=e.fillMaterialProperty,n=this.depthFailMaterialProperty,r=e.depthFailMaterialProperty;if(i===t&&r===n)return!0;var a=Object(u.a)(t)&&t.equals(i);return a=(!Object(u.a)(n)&&!Object(u.a)(r)||Object(u.a)(n)&&n.equals(r))&&a},a7.prototype.add=function(e,t){var i=t.id;if(this.updaters.set(i,t),this.geometry.set(i,t.createFillGeometryInstance(e)),t.hasConstantFill&&t.fillMaterialProperty.isConstant&&aD.isConstant(t.distanceDisplayConditionProperty)&&aD.isConstant(t.terrainOffsetProperty)){var n=this;this.subscriptions.set(i,t.entity.definitionChanged.addEventListener((function(e,i,r,a){"isShowing"===i&&n.showsUpdated.set(t.id,t)})))}else this.updatersWithAttributes.set(i,t);this.createPrimitive=!0},a7.prototype.remove=function(e){var t=e.id;if(this.createPrimitive=this.geometry.remove(t)||this.createPrimitive,this.updaters.remove(t)){this.updatersWithAttributes.remove(t);var i=this.subscriptions.get(t);return Object(u.a)(i)&&(i(),this.subscriptions.remove(t),this.showsUpdated.remove(t)),!0}return!1};var o7=new uf;function s7(e,t,i,n,r){this._items=[],this._primitives=e,this._appearanceType=t,this._depthFailAppearanceType=i,this._closed=n,this._shadows=r}a7.prototype.update=function(e){var t,i=!0,n=this.primitive,r=this.primitives,a=this.geometry.values;if(this.createPrimitive){if(a.length>0){var o;Object(u.a)(n)&&(Object(u.a)(this.oldPrimitive)?r.remove(n):this.oldPrimitive=n),this.material=nU.getValue(e,this.materialProperty,this.material),Object(u.a)(this.depthFailMaterialProperty)&&(this.depthFailMaterial=nU.getValue(e,this.depthFailMaterialProperty,this.depthFailMaterial),o=new this.depthFailAppearanceType({material:this.depthFailMaterial,translucent:this.depthFailMaterial.isTranslucent(),closed:this.closed})),n=new ck({show:!1,asynchronous:!0,geometryInstances:a,appearance:new this.appearanceType({material:this.material,translucent:this.material.isTranslucent(),closed:this.closed}),depthFailAppearance:o,shadows:this.shadows}),r.add(n),i=!1}else{Object(u.a)(n)&&(r.remove(n),n=void 0);var s=this.oldPrimitive;Object(u.a)(s)&&(r.remove(s),this.oldPrimitive=void 0)}this.attributes.removeAll(),this.primitive=n,this.createPrimitive=!1}else if(Object(u.a)(n)&&n.ready){n.show=!0,Object(u.a)(this.oldPrimitive)&&(r.remove(this.oldPrimitive),this.oldPrimitive=void 0),this.material=nU.getValue(e,this.materialProperty,this.material),this.primitive.appearance.material=this.material,!Object(u.a)(this.depthFailAppearanceType)||this.depthFailMaterialProperty instanceof oM||(this.depthFailMaterial=nU.getValue(e,this.depthFailMaterialProperty,this.depthFailMaterial),this.primitive.depthFailAppearance.material=this.depthFailMaterial);var c=this.updatersWithAttributes.values,l=c.length;for(t=0;t<l;t++){var h=c[t],d=h.entity,f=this.geometry.get(h.id),p=this.attributes.get(f.id.id);if(Object(u.a)(p)||(p=n.getGeometryInstanceAttributes(f.id),this.attributes.set(f.id.id,p)),Object(u.a)(this.depthFailAppearanceType)&&this.depthFailMaterialProperty instanceof oM&&!h.depthFailMaterialProperty.isConstant){var m=h.depthFailMaterialProperty.color,_=aD.getValueOrDefault(m,e,uf.WHITE,o7);uf.equals(p._lastDepthFailColor,_)||(p._lastDepthFailColor=uf.clone(_,p._lastDepthFailColor),p.depthFailColor=df.toValue(_,p.depthFailColor))}var g=d.isShowing&&(h.hasConstantFill||h.isFilled(e));g!==(1===p.show[0])&&(p.show=sA.toValue(g,p.show));var v=h.distanceDisplayConditionProperty;if(!aD.isConstant(v)){var b=aD.getValueOrDefault(v,e,i7,t7);gv.equals(b,p._lastDistanceDisplayCondition)||(p._lastDistanceDisplayCondition=gv.clone(b,p._lastDistanceDisplayCondition),p.distanceDisplayCondition=bv.toValue(b,p.distanceDisplayCondition))}var y=h.terrainOffsetProperty;if(!aD.isConstant(y)){var w=aD.getValueOrDefault(y,e,n7,r7);z.equals(w,p._lastOffset)||(p._lastOffset=z.clone(w,p._lastOffset),p.offset=tE.toValue(w,p.offset))}}this.updateShows(n)}else Object(u.a)(n)&&!n.ready&&(i=!1);return i},a7.prototype.updateShows=function(e){for(var t=this.showsUpdated.values,i=t.length,n=0;n<i;n++){var r=t[n],a=r.entity,o=this.geometry.get(r.id),s=this.attributes.get(o.id.id);Object(u.a)(s)||(s=e.getGeometryInstanceAttributes(o.id),this.attributes.set(o.id.id,s));var c=a.isShowing;c!==(1===s.show[0])&&(s.show=sA.toValue(c,s.show),o.attributes.show.value[0]=s.show[0])}this.showsUpdated.removeAll()},a7.prototype.contains=function(e){return this.updaters.contains(e.id)},a7.prototype.getBoundingSphere=function(e,t){var i=this.primitive;if(!i.ready)return nD.PENDING;var n=i.getGeometryInstanceAttributes(e.entity);return!Object(u.a)(n)||!Object(u.a)(n.boundingSphere)||Object(u.a)(n.show)&&0===n.show[0]?nD.FAILED:(n.boundingSphere.clone(t),nD.DONE)},a7.prototype.destroy=function(){var e=this.primitive,t=this.primitives;Object(u.a)(e)&&t.remove(e);var i=this.oldPrimitive;Object(u.a)(i)&&t.remove(i),this.removeMaterialSubscription()},s7.prototype.add=function(e,t){for(var i=this._items,n=i.length,r=0;r<n;r++){var a=i[r];if(a.isMaterial(t))return void a.add(e,t)}var o=new a7(this._primitives,this._appearanceType,t.fillMaterialProperty,this._depthFailAppearanceType,t.depthFailMaterialProperty,this._closed,this._shadows);o.add(e,t),i.push(o)},s7.prototype.remove=function(e){for(var t=this._items,i=t.length-1;i>=0;i--){var n=t[i];if(n.remove(e)){0===n.updaters.length&&(t.splice(i,1),n.destroy());break}}},s7.prototype.update=function(e){var t,i=this._items;for(t=i.length-1;t>=0;t--){var n=i[t];if(n.invalidated){i.splice(t,1);for(var r=n.updaters.values,a=r.length,o=0;o<a;o++)this.add(e,r[o]);n.destroy()}}var s=!0;for(t=0;t<i.length;t++)s=i[t].update(e)&&s;return s},s7.prototype.getBoundingSphere=function(e,t){for(var i=this._items,n=i.length,r=0;r<n;r++){var a=i[r];if(a.contains(e))return a.getBoundingSphere(e,t)}return nD.FAILED},s7.prototype.removeAllPrimitives=function(){for(var e=this._items,t=e.length,i=0;i<t;i++)e[i].destroy();this._items.length=0};var c7=s7,l7=new uf,u7=new gv,h7=new gv;function d7(e,t,i,n,r){this.primitives=e,this.zIndex=r,this.classificationType=t,this.color=i,this.key=n,this.createPrimitive=!1,this.waitingOnCreate=!1,this.primitive=void 0,this.oldPrimitive=void 0,this.geometry=new Fi,this.updaters=new Fi,this.updatersWithAttributes=new Fi,this.attributes=new Fi,this.subscriptions=new Fi,this.showsUpdated=new Fi,this.itemsToRemove=[],this.isDirty=!1}d7.prototype.add=function(e,t){var i=e.id;if(this.createPrimitive=!0,this.geometry.set(i,t),this.updaters.set(i,e),e.hasConstantFill&&e.fillMaterialProperty.isConstant&&aD.isConstant(e.distanceDisplayConditionProperty)){var n=this;this.subscriptions.set(i,e.entity.definitionChanged.addEventListener((function(t,i,r,a){"isShowing"===i&&n.showsUpdated.set(e.id,e)})))}else this.updatersWithAttributes.set(i,e)},d7.prototype.remove=function(e){var t=e.id;if(this.createPrimitive=this.geometry.remove(t)||this.createPrimitive,this.updaters.remove(t)){this.updatersWithAttributes.remove(t);var i=this.subscriptions.get(t);return Object(u.a)(i)&&(i(),this.subscriptions.remove(t),this.showsUpdated.remove(t)),!0}return!1};var f7=new Array(4);function p7(e,t){this._batches=new Fi,this._primitives=e,this._classificationType=t}d7.prototype.update=function(e){var t,i=!0,n=0,r=this.primitive,a=this.primitives;if(this.createPrimitive){var o=this.geometry.values;if(o.length>0)Object(u.a)(r)&&(Object(u.a)(this.oldPrimitive)?a.remove(r):this.oldPrimitive=r),r=new mB({show:!1,asynchronous:!0,geometryInstances:o,classificationType:this.classificationType}),a.add(r,this.zIndex),i=!1;else{Object(u.a)(r)&&(a.remove(r),r=void 0);var s=this.oldPrimitive;Object(u.a)(s)&&(a.remove(s),this.oldPrimitive=void 0)}this.attributes.removeAll(),this.primitive=r,this.createPrimitive=!1,this.waitingOnCreate=!0}else if(Object(u.a)(r)&&r.ready){r.show=!0,Object(u.a)(this.oldPrimitive)&&(a.remove(this.oldPrimitive),this.oldPrimitive=void 0);var c=this.updatersWithAttributes.values,l=c.length,h=this.waitingOnCreate;for(t=0;t<l;t++){var d=c[t],f=this.geometry.get(d.id),p=this.attributes.get(f.id.id);if(Object(u.a)(p)||(p=r.getGeometryInstanceAttributes(f.id),this.attributes.set(f.id.id,p)),!d.fillMaterialProperty.isConstant||h){var m=d.fillMaterialProperty.color,_=aD.getValueOrDefault(m,e,uf.WHITE,l7);if(!uf.equals(p._lastColor,_)){p._lastColor=uf.clone(_,p._lastColor);var g=this.color,v=_.toBytes(f7);g[0]===v[0]&&g[1]===v[1]&&g[2]===v[2]&&g[3]===v[3]||(this.itemsToRemove[n++]=d)}}var b=d.entity.isShowing&&(d.hasConstantFill||d.isFilled(e));b!==(1===p.show[0])&&(p.show=sA.toValue(b,p.show));var y=d.distanceDisplayConditionProperty;if(!aD.isConstant(y)){var w=aD.getValueOrDefault(y,e,h7,u7);gv.equals(w,p._lastDistanceDisplayCondition)||(p._lastDistanceDisplayCondition=gv.clone(w,p._lastDistanceDisplayCondition),p.distanceDisplayCondition=bv.toValue(w,p.distanceDisplayCondition))}}this.updateShows(r),this.waitingOnCreate=!1}else Object(u.a)(r)&&!r.ready&&(i=!1);return this.itemsToRemove.length=n,i},d7.prototype.updateShows=function(e){for(var t=this.showsUpdated.values,i=t.length,n=0;n<i;n++){var r=t[n],a=this.geometry.get(r.id),o=this.attributes.get(a.id.id);Object(u.a)(o)||(o=e.getGeometryInstanceAttributes(a.id),this.attributes.set(a.id.id,o));var s=r.entity.isShowing;s!==(1===o.show[0])&&(o.show=sA.toValue(s,o.show),a.attributes.show.value[0]=o.show[0])}this.showsUpdated.removeAll()},d7.prototype.contains=function(e){return this.updaters.contains(e.id)},d7.prototype.getBoundingSphere=function(e,t){var i=this.primitive;if(!i.ready)return nD.PENDING;var n=i.getBoundingSphere(e.entity);return Object(u.a)(n)?(n.clone(t),nD.DONE):nD.FAILED},d7.prototype.removeAllPrimitives=function(){var e=this.primitives,t=this.primitive;Object(u.a)(t)&&(e.remove(t),this.primitive=void 0,this.geometry.removeAll(),this.updaters.removeAll());var i=this.oldPrimitive;Object(u.a)(i)&&(e.remove(i),this.oldPrimitive=void 0)},p7.prototype.add=function(e,t){var i,n=t.createFillGeometryInstance(e),r=this._batches,a=aD.getValueOrDefault(t.zIndex,0),o=new Uint32Array(n.attributes.color.value.buffer)[0]+":"+a;return r.contains(o)?i=r.get(o):(i=new d7(this._primitives,this._classificationType,n.attributes.color.value,o,a),r.set(o,i)),i.add(t,n),i},p7.prototype.remove=function(e){for(var t=this._batches.values,i=t.length,n=0;n<i;++n)if(t[n].remove(e))return},p7.prototype.update=function(e){var t,i,n=!0,r=this._batches,a=r.values,o=a.length;for(t=0;t<o;++t)n=a[t].update(e)&&n;for(t=0;t<o;++t)for(var s=a[t],c=s.itemsToRemove,l=c.length,u=0;u<l;u++){i=c[u],s.remove(i);var h=this.add(e,i);s.isDirty=!0,h.isDirty=!0}var d=a.slice(),f=d.length;for(t=0;t<f;++t){var p=d[t];p.isDirty&&(n=d[t].update(e)&&n,p.isDirty=!1),0===p.geometry.length&&r.remove(p.key)}return n},p7.prototype.getBoundingSphere=function(e,t){for(var i=this._batches.values,n=i.length,r=0;r<n;++r){var a=i[r];if(a.contains(e))return a.getBoundingSphere(e,t)}return nD.FAILED},p7.prototype.removeAllPrimitives=function(){for(var e=this._batches.values,t=e.length,i=0;i<t;++i)e[i].removeAllPrimitives()};var m7=p7,_7=new gv,g7=new gv;function v7(e,t,i,n,r,a){this.primitives=e,this.classificationType=t,this.appearanceType=i,this.materialProperty=n,this.updaters=new Fi,this.createPrimitive=!0,this.primitive=void 0,this.oldPrimitive=void 0,this.geometry=new Fi,this.material=void 0,this.updatersWithAttributes=new Fi,this.attributes=new Fi,this.invalidated=!1,this.removeMaterialSubscription=n.definitionChanged.addEventListener(v7.prototype.onMaterialChanged,this),this.subscriptions=new Fi,this.showsUpdated=new Fi,this.usingSphericalTextureCoordinates=r,this.zIndex=a,this.rectangleCollisionCheck=new pC}function b7(e,t,i){this._items=[],this._primitives=e,this._classificationType=t,this._appearanceType=i}v7.prototype.onMaterialChanged=function(){this.invalidated=!0},v7.prototype.overlapping=function(e){return this.rectangleCollisionCheck.collides(e)},v7.prototype.isMaterial=function(e){var t=this.materialProperty,i=e.fillMaterialProperty;return i===t||i instanceof oM&&t instanceof oM||Object(u.a)(t)&&t.equals(i)},v7.prototype.add=function(e,t,i){var n=t.id;if(this.updaters.set(n,t),this.geometry.set(n,i),this.rectangleCollisionCheck.insert(n,i.geometry.rectangle),t.hasConstantFill&&t.fillMaterialProperty.isConstant&&aD.isConstant(t.distanceDisplayConditionProperty)){var r=this;this.subscriptions.set(n,t.entity.definitionChanged.addEventListener((function(e,i,n,a){"isShowing"===i&&r.showsUpdated.set(t.id,t)})))}else this.updatersWithAttributes.set(n,t);this.createPrimitive=!0},v7.prototype.remove=function(e){var t=e.id,i=this.geometry.get(t);if(this.createPrimitive=this.geometry.remove(t)||this.createPrimitive,this.updaters.remove(t)){this.rectangleCollisionCheck.remove(t,i.geometry.rectangle),this.updatersWithAttributes.remove(t);var n=this.subscriptions.get(t);return Object(u.a)(n)&&(n(),this.subscriptions.remove(t)),!0}return!1},v7.prototype.update=function(e){var t,i=!0,n=this.primitive,r=this.primitives,a=this.geometry.values;if(this.createPrimitive){if(a.length>0)Object(u.a)(n)&&(Object(u.a)(this.oldPrimitive)?r.remove(n):this.oldPrimitive=n),this.material=nU.getValue(e,this.materialProperty,this.material),n=new mB({show:!1,asynchronous:!0,geometryInstances:a,appearance:new this.appearanceType({material:this.material}),classificationType:this.classificationType}),r.add(n,this.zIndex),i=!1;else{Object(u.a)(n)&&(r.remove(n),n=void 0);var o=this.oldPrimitive;Object(u.a)(o)&&(r.remove(o),this.oldPrimitive=void 0)}this.attributes.removeAll(),this.primitive=n,this.createPrimitive=!1}else if(Object(u.a)(n)&&n.ready){n.show=!0,Object(u.a)(this.oldPrimitive)&&(r.remove(this.oldPrimitive),this.oldPrimitive=void 0),this.material=nU.getValue(e,this.materialProperty,this.material),this.primitive.appearance.material=this.material;var s=this.updatersWithAttributes.values,c=s.length;for(t=0;t<c;t++){var l=s[t],h=l.entity,d=this.geometry.get(l.id),f=this.attributes.get(d.id.id);Object(u.a)(f)||(f=n.getGeometryInstanceAttributes(d.id),this.attributes.set(d.id.id,f));var p=h.isShowing&&(l.hasConstantFill||l.isFilled(e));p!==(1===f.show[0])&&(f.show=sA.toValue(p,f.show));var m=l.distanceDisplayConditionProperty;if(!aD.isConstant(m)){var _=aD.getValueOrDefault(m,e,g7,_7);gv.equals(_,f._lastDistanceDisplayCondition)||(f._lastDistanceDisplayCondition=gv.clone(_,f._lastDistanceDisplayCondition),f.distanceDisplayCondition=bv.toValue(_,f.distanceDisplayCondition))}}this.updateShows(n)}else Object(u.a)(n)&&!n.ready&&(i=!1);return i},v7.prototype.updateShows=function(e){for(var t=this.showsUpdated.values,i=t.length,n=0;n<i;n++){var r=t[n],a=r.entity,o=this.geometry.get(r.id),s=this.attributes.get(o.id.id);Object(u.a)(s)||(s=e.getGeometryInstanceAttributes(o.id),this.attributes.set(o.id.id,s));var c=a.isShowing;c!==(1===s.show[0])&&(s.show=sA.toValue(c,s.show),o.attributes.show.value[0]=s.show[0])}this.showsUpdated.removeAll()},v7.prototype.contains=function(e){return this.updaters.contains(e.id)},v7.prototype.getBoundingSphere=function(e,t){var i=this.primitive;if(!i.ready)return nD.PENDING;var n=i.getGeometryInstanceAttributes(e.entity);return!Object(u.a)(n)||!Object(u.a)(n.boundingSphere)||Object(u.a)(n.show)&&0===n.show[0]?nD.FAILED:(n.boundingSphere.clone(t),nD.DONE)},v7.prototype.destroy=function(){var e=this.primitive,t=this.primitives;Object(u.a)(e)&&t.remove(e);var i=this.oldPrimitive;Object(u.a)(i)&&t.remove(i),this.removeMaterialSubscription()},b7.prototype.add=function(e,t){for(var i=this._items,n=i.length,r=t.createFillGeometryInstance(e),a=Fk.shouldUseSphericalCoordinates(r.geometry.rectangle),o=aD.getValueOrDefault(t.zIndex,0),s=0;s<n;++s){var c=i[s];if(c.isMaterial(t)&&c.usingSphericalTextureCoordinates===a&&c.zIndex===o&&!c.overlapping(r.geometry.rectangle))return void c.add(e,t,r)}var l=new v7(this._primitives,this._classificationType,this._appearanceType,t.fillMaterialProperty,a,o);l.add(e,t,r),i.push(l)},b7.prototype.remove=function(e){for(var t=this._items,i=t.length-1;i>=0;i--){var n=t[i];if(n.remove(e)){0===n.updaters.length&&(t.splice(i,1),n.destroy());break}}},b7.prototype.update=function(e){var t,i=this._items;for(t=i.length-1;t>=0;t--){var n=i[t];if(n.invalidated){i.splice(t,1);for(var r=n.updaters.values,a=r.length,o=0;o<a;o++)this.add(e,r[o]);n.destroy()}}var s=!0;for(t=0;t<i.length;t++)s=i[t].update(e)&&s;return s},b7.prototype.getBoundingSphere=function(e,t){for(var i=this._items,n=i.length,r=0;r<n;r++){var a=i[r];if(a.contains(e))return a.getBoundingSphere(e,t)}return nD.FAILED},b7.prototype.removeAllPrimitives=function(){for(var e=this._items,t=e.length,i=0;i<t;i++)e[i].destroy();this._items.length=0};var y7=b7,w7=new uf,O7=new gv,x7=new gv,E7=z.ZERO,T7=new z;function C7(e,t,i,n){this.translucent=t,this.width=i,this.shadows=n,this.primitives=e,this.createPrimitive=!1,this.waitingOnCreate=!1,this.primitive=void 0,this.oldPrimitive=void 0,this.geometry=new Fi,this.updaters=new Fi,this.updatersWithAttributes=new Fi,this.attributes=new Fi,this.itemsToRemove=[],this.subscriptions=new Fi,this.showsUpdated=new Fi}function S7(e,t,i){this._primitives=e,this._scene=t,this._shadows=i,this._solidBatches=new Fi,this._translucentBatches=new Fi}C7.prototype.add=function(e,t){var i=e.id;if(this.createPrimitive=!0,this.geometry.set(i,t),this.updaters.set(i,e),e.hasConstantOutline&&e.outlineColorProperty.isConstant&&aD.isConstant(e.distanceDisplayConditionProperty)&&aD.isConstant(e.terrainOffsetProperty)){var n=this;this.subscriptions.set(i,e.entity.definitionChanged.addEventListener((function(t,i,r,a){"isShowing"===i&&n.showsUpdated.set(e.id,e)})))}else this.updatersWithAttributes.set(i,e)},C7.prototype.remove=function(e){var t=e.id;if(this.createPrimitive=this.geometry.remove(t)||this.createPrimitive,this.updaters.remove(t)){this.updatersWithAttributes.remove(t);var i=this.subscriptions.get(t);return Object(u.a)(i)&&(i(),this.subscriptions.remove(t),this.showsUpdated.remove(t)),!0}return!1},C7.prototype.update=function(e){var t,i=!0,n=0,r=this.primitive,a=this.primitives;if(this.createPrimitive){var o=this.geometry.values;if(o.length>0)Object(u.a)(r)&&(Object(u.a)(this.oldPrimitive)?a.remove(r):this.oldPrimitive=r),r=new ck({show:!1,asynchronous:!0,geometryInstances:o,appearance:new $j({flat:!0,translucent:this.translucent,renderState:{lineWidth:this.width}}),shadows:this.shadows}),a.add(r),i=!1;else{Object(u.a)(r)&&(a.remove(r),r=void 0);var s=this.oldPrimitive;Object(u.a)(s)&&(a.remove(s),this.oldPrimitive=void 0)}this.attributes.removeAll(),this.primitive=r,this.createPrimitive=!1,this.waitingOnCreate=!0}else if(Object(u.a)(r)&&r.ready){r.show=!0,Object(u.a)(this.oldPrimitive)&&(a.remove(this.oldPrimitive),this.oldPrimitive=void 0);var c=this.updatersWithAttributes.values,l=c.length,h=this.waitingOnCreate;for(t=0;t<l;t++){var d=c[t],f=this.geometry.get(d.id),p=this.attributes.get(f.id.id);if(Object(u.a)(p)||(p=r.getGeometryInstanceAttributes(f.id),this.attributes.set(f.id.id,p)),!d.outlineColorProperty.isConstant||h){var m=d.outlineColorProperty,_=aD.getValueOrDefault(m,e,uf.WHITE,w7);uf.equals(p._lastColor,_)||(p._lastColor=uf.clone(_,p._lastColor),p.color=df.toValue(_,p.color),(this.translucent&&255===p.color[3]||!this.translucent&&255!==p.color[3])&&(this.itemsToRemove[n++]=d))}var g=d.entity.isShowing&&(d.hasConstantOutline||d.isOutlineVisible(e));g!==(1===p.show[0])&&(p.show=sA.toValue(g,p.show));var v=d.distanceDisplayConditionProperty;if(!aD.isConstant(v)){var b=aD.getValueOrDefault(v,e,x7,O7);gv.equals(b,p._lastDistanceDisplayCondition)||(p._lastDistanceDisplayCondition=gv.clone(b,p._lastDistanceDisplayCondition),p.distanceDisplayCondition=bv.toValue(b,p.distanceDisplayCondition))}var y=d.terrainOffsetProperty;if(!aD.isConstant(y)){var w=aD.getValueOrDefault(y,e,E7,T7);z.equals(w,p._lastOffset)||(p._lastOffset=z.clone(w,p._lastOffset),p.offset=tE.toValue(w,p.offset))}}this.updateShows(r),this.waitingOnCreate=!1}else Object(u.a)(r)&&!r.ready&&(i=!1);return this.itemsToRemove.length=n,i},C7.prototype.updateShows=function(e){for(var t=this.showsUpdated.values,i=t.length,n=0;n<i;n++){var r=t[n],a=this.geometry.get(r.id),o=this.attributes.get(a.id.id);Object(u.a)(o)||(o=e.getGeometryInstanceAttributes(a.id),this.attributes.set(a.id.id,o));var s=r.entity.isShowing;s!==(1===o.show[0])&&(o.show=sA.toValue(s,o.show),a.attributes.show.value[0]=o.show[0])}this.showsUpdated.removeAll()},C7.prototype.contains=function(e){return this.updaters.contains(e.id)},C7.prototype.getBoundingSphere=function(e,t){var i=this.primitive;if(!i.ready)return nD.PENDING;var n=i.getGeometryInstanceAttributes(e.entity);return!Object(u.a)(n)||!Object(u.a)(n.boundingSphere)||Object(u.a)(n.show)&&0===n.show[0]?nD.FAILED:(n.boundingSphere.clone(t),nD.DONE)},C7.prototype.removeAllPrimitives=function(){var e=this.primitives,t=this.primitive;Object(u.a)(t)&&(e.remove(t),this.primitive=void 0,this.geometry.removeAll(),this.updaters.removeAll());var i=this.oldPrimitive;Object(u.a)(i)&&(e.remove(i),this.oldPrimitive=void 0)},S7.prototype.add=function(e,t){var i,n,r=t.createOutlineGeometryInstance(e),a=this._scene.clampLineWidth(t.outlineWidth);255===r.attributes.color.value[3]?(n=(i=this._solidBatches).get(a),Object(u.a)(n)||(n=new C7(this._primitives,!1,a,this._shadows),i.set(a,n)),n.add(t,r)):(n=(i=this._translucentBatches).get(a),Object(u.a)(n)||(n=new C7(this._primitives,!0,a,this._shadows),i.set(a,n)),n.add(t,r))},S7.prototype.remove=function(e){var t,i=this._solidBatches.values,n=i.length;for(t=0;t<n;t++)if(i[t].remove(e))return;var r=this._translucentBatches.values,a=r.length;for(t=0;t<a;t++)if(r[t].remove(e))return},S7.prototype.update=function(e){var t,i,n,r,a,o=this._solidBatches.values,s=o.length,c=this._translucentBatches.values,l=c.length,u=!0,h=!1;do{for(h=!1,i=0;i<s;i++){u=(r=o[i]).update(e);var d=(a=r.itemsToRemove).length;if(d>0)for(h=!0,t=0;t<d;t++)n=a[t],r.remove(n),this.add(e,n)}for(i=0;i<l;i++){u=(r=c[i]).update(e);var f=(a=r.itemsToRemove).length;if(f>0)for(h=!0,t=0;t<f;t++)n=a[t],r.remove(n),this.add(e,n)}}while(h);return u},S7.prototype.getBoundingSphere=function(e,t){var i,n=this._solidBatches.values,r=n.length;for(i=0;i<r;i++){var a=n[i];if(a.contains(e))return a.getBoundingSphere(e,t)}var o=this._translucentBatches.values,s=o.length;for(i=0;i<s;i++){var c=o[i];if(c.contains(e))return c.getBoundingSphere(e,t)}return nD.FAILED},S7.prototype.removeAllPrimitives=function(){var e,t=this._solidBatches.values,i=t.length;for(e=0;e<i;e++)t[e].removeAllPrimitives();var n=this._translucentBatches.values,r=n.length;for(e=0;e<r;e++)n[e].removeAllPrimitives()};var A7=S7,P7=new uf;function I7(e){this.id=e,this.vertexFormat=void 0,this.positions=void 0,this.minimumHeights=void 0,this.maximumHeights=void 0,this.granularity=void 0}function D7(e,t){Qz.call(this,{entity:e,scene:t,geometryOptions:new I7(e),geometryPropertyName:"wall",observedPropertyNames:["availability","wall"]}),this._onEntityPropertyChanged(e,"wall",e.wall,void 0)}function j7(e,t,i){aU.call(this,e,t,i)}Object(u.a)(Object.create)&&(D7.prototype=Object.create(Qz.prototype),D7.prototype.constructor=D7),D7.prototype.createFillGeometryInstance=function(e){if(x.a.defined("time",e),!this._fillEnabled)throw new h.a("This instance does not represent a filled geometry.");var t,i,n=this._entity,r=n.isAvailable(e),a=new sA(r&&n.isShowing&&this._showProperty.getValue(e)&&this._fillProperty.getValue(e)),o=this._distanceDisplayConditionProperty.getValue(e),s=bv.fromDistanceDisplayCondition(o);this._materialProperty instanceof oM?(Object(u.a)(this._materialProperty.color)&&(this._materialProperty.color.isConstant||r)&&(i=this._materialProperty.color.getValue(e,P7)),Object(u.a)(i)||(i=uf.WHITE),t={show:a,distanceDisplayCondition:s,color:df.fromColor(i)}):t={show:a,distanceDisplayCondition:s};return new Mu({id:n,geometry:new LI(this._options),attributes:t})},D7.prototype.createOutlineGeometryInstance=function(e){if(x.a.defined("time",e),!this._outlineEnabled)throw new h.a("This instance does not represent an outlined geometry.");var t=this._entity,i=t.isAvailable(e),n=aD.getValueOrDefault(this._outlineColorProperty,e,uf.BLACK,P7),r=this._distanceDisplayConditionProperty.getValue(e);return new Mu({id:t,geometry:new UI(this._options),attributes:{show:new sA(i&&t.isShowing&&this._showProperty.getValue(e)&&this._showOutlineProperty.getValue(e)),color:df.fromColor(n),distanceDisplayCondition:bv.fromDistanceDisplayCondition(r)}})},D7.prototype._isHidden=function(e,t){return!Object(u.a)(t.positions)||Qz.prototype._isHidden.call(this,e,t)},D7.prototype._getIsClosed=function(e){return!1},D7.prototype._isDynamic=function(e,t){return!(t.positions.isConstant&&aD.isConstant(t.minimumHeights)&&aD.isConstant(t.maximumHeights)&&aD.isConstant(t.outlineWidth)&&aD.isConstant(t.granularity))},D7.prototype._setStaticOptions=function(e,t){var i=t.minimumHeights,n=t.maximumHeights,r=t.granularity,a=this._materialProperty instanceof oM,o=this._options;o.vertexFormat=a?$j.VERTEX_FORMAT:Yj.MaterialSupport.TEXTURED.vertexFormat,o.positions=t.positions.getValue(nx.MINIMUM_VALUE,o.positions),o.minimumHeights=Object(u.a)(i)?i.getValue(nx.MINIMUM_VALUE,o.minimumHeights):void 0,o.maximumHeights=Object(u.a)(n)?n.getValue(nx.MINIMUM_VALUE,o.maximumHeights):void 0,o.granularity=Object(u.a)(r)?r.getValue(nx.MINIMUM_VALUE):void 0},D7.DynamicGeometryUpdater=j7,Object(u.a)(Object.create)&&(j7.prototype=Object.create(aU.prototype),j7.prototype.constructor=j7),j7.prototype._isHidden=function(e,t,i){return!Object(u.a)(this._options.positions)||aU.prototype._isHidden.call(this,e,t,i)},j7.prototype._setOptions=function(e,t,i){var n=this._options;n.positions=aD.getValueOrUndefined(t.positions,i,n.positions),n.minimumHeights=aD.getValueOrUndefined(t.minimumHeights,i,n.minimumHeights),n.maximumHeights=aD.getValueOrUndefined(t.maximumHeights,i,n.maximumHeights),n.granularity=aD.getValueOrUndefined(t.granularity,i)};var M7=D7,R7=[],L7=[fU,aW,ZU,W6,i8,_8,C8,D8,U8,M7];function N7(e,t){this.entity=e,this.scene=t;var i=new Array(L7.length),n=new $o.a;function r(e){n.raiseEvent(e)}for(var a=new eb,o=0;o<i.length;o++){var s=new L7[o](e,t);a.add(s.geometryChanged,r),i[o]=s}this.updaters=i,this.geometryChanged=n,this.eventHelper=a,this._removeEntitySubscription=e.definitionChanged.addEventListener(N7.prototype._onEntityPropertyChanged,this)}function F7(e,t,i,n){x.a.defined("scene",e),x.a.defined("entityCollection",t),i=Object(w.a)(i,e.primitives),n=Object(w.a)(n,e.groundPrimitives),this._scene=e,this._primitives=i,this._groundPrimitives=n,this._entityCollection=void 0,this._addedObjects=new Fi,this._removedObjects=new Fi,this._changedObjects=new Fi;var r=rM.NUMBER_OF_SHADOW_MODES;this._outlineBatches=new Array(2*r),this._closedColorBatches=new Array(2*r),this._closedMaterialBatches=new Array(2*r),this._openColorBatches=new Array(2*r),this._openMaterialBatches=new Array(2*r);var a,o=zz.supportsMaterialsforEntitiesOnTerrain(e);for(this._supportsMaterialsforEntitiesOnTerrain=o,a=0;a<r;++a)this._outlineBatches[a]=new A7(i,e,a,!1),this._outlineBatches[r+a]=new A7(i,e,a,!0),this._closedColorBatches[a]=new e7(i,$j,void 0,!0,a,!0),this._closedColorBatches[r+a]=new e7(i,$j,void 0,!0,a,!1),this._closedMaterialBatches[a]=new c7(i,Yj,void 0,!0,a,!0),this._closedMaterialBatches[r+a]=new c7(i,Yj,void 0,!0,a,!1),this._openColorBatches[a]=new e7(i,$j,void 0,!1,a,!0),this._openColorBatches[r+a]=new e7(i,$j,void 0,!1,a,!1),this._openMaterialBatches[a]=new c7(i,Yj,void 0,!1,a,!0),this._openMaterialBatches[r+a]=new c7(i,Yj,void 0,!1,a,!1);var s=iM.NUMBER_OF_CLASSIFICATION_TYPES,c=new Array(s),l=[];if(o)for(a=0;a<s;++a)l.push(new y7(n,a,Yj)),c[a]=new y7(n,a,$j);else for(a=0;a<s;++a)c[a]=new m7(n,a);this._groundColorBatches=c,this._groundMaterialBatches=l,this._dynamicBatch=new k6(i,n),this._batches=this._outlineBatches.concat(this._closedColorBatches,this._closedMaterialBatches,this._openColorBatches,this._openMaterialBatches,this._groundColorBatches,this._groundMaterialBatches,this._dynamicBatch),this._subscriptions=new Fi,this._updaterSets=new Fi,this._entityCollection=t,t.collectionChanged.addEventListener(F7.prototype._onCollectionChanged,this),this._onCollectionChanged(t,t.values,R7)}N7.prototype._onEntityPropertyChanged=function(e,t,i,n){for(var r=this.updaters,a=0;a<r.length;a++)r[a]._onEntityPropertyChanged(e,t,i,n)},N7.prototype.forEach=function(e){for(var t=this.updaters,i=0;i<t.length;i++)e(t[i])},N7.prototype.destroy=function(){this.eventHelper.removeAll();for(var e=this.updaters,t=0;t<e.length;t++)e[t].destroy();this._removeEntitySubscription(),rl(this)},F7.prototype.update=function(e){x.a.defined("time",e);var t,i,n,r,a=this._addedObjects,o=a.values,s=this._removedObjects,c=s.values,l=this._changedObjects,u=l.values,h=this;for(t=u.length-1;t>-1;t--)n=(i=u[t]).id,(r=this._updaterSets.get(n)).entity===i?r.forEach((function(t){h._removeUpdater(t),h._insertUpdaterIntoBatch(e,t)})):(c.push(i),o.push(i));for(t=c.length-1;t>-1;t--)n=(i=c[t]).id,(r=this._updaterSets.get(n)).forEach(this._removeUpdater.bind(this)),r.destroy(),this._updaterSets.remove(n),this._subscriptions.get(n)(),this._subscriptions.remove(n);for(t=o.length-1;t>-1;t--)n=(i=o[t]).id,r=new N7(i,this._scene),this._updaterSets.set(n,r),r.forEach((function(t){h._insertUpdaterIntoBatch(e,t)})),this._subscriptions.set(n,r.geometryChanged.addEventListener(F7._onGeometryChanged,this));a.removeAll(),s.removeAll(),l.removeAll();var d=!0,f=this._batches,p=f.length;for(t=0;t<p;t++)d=f[t].update(e)&&d;return d};var k7=[],B7=new St;F7.prototype.getBoundingSphere=function(e,t){x.a.defined("entity",e),x.a.defined("result",t);for(var i=k7,n=B7,r=0,a=nD.DONE,o=this._batches,s=o.length,c=e.id,l=this._updaterSets.get(c).updaters,u=0;u<l.length;u++)for(var h=l[u],d=0;d<s;d++){if((a=o[d].getBoundingSphere(h,n))===nD.PENDING)return nD.PENDING;a===nD.DONE&&(i[r]=St.clone(n,i[r]),r++)}return 0===r?nD.FAILED:(i.length=r,St.fromBoundingSpheres(i,t),nD.DONE)},F7.prototype.isDestroyed=function(){return!1},F7.prototype.destroy=function(){var e;this._entityCollection.collectionChanged.removeEventListener(F7.prototype._onCollectionChanged,this),this._addedObjects.removeAll(),this._removedObjects.removeAll();var t=this._batches,i=t.length;for(e=0;e<i;e++)t[e].removeAllPrimitives();var n=this._subscriptions.values;for(i=n.length,e=0;e<i;e++)n[e]();return this._subscriptions.removeAll(),rl(this)},F7.prototype._removeUpdater=function(e){for(var t=this._batches,i=t.length,n=0;n<i;n++)t[n].remove(e)},F7.prototype._insertUpdaterIntoBatch=function(e,t){if(t.isDynamic)this._dynamicBatch.add(e,t);else{var i;(t.outlineEnabled||t.fillEnabled)&&(i=t.shadowsProperty.getValue(e));var n=rM.NUMBER_OF_SHADOW_MODES;if(t.outlineEnabled&&(Object(u.a)(t.terrainOffsetProperty)?this._outlineBatches[n+i].add(e,t):this._outlineBatches[i].add(e,t)),t.fillEnabled)if(t.onTerrain){var r=t.classificationTypeProperty.getValue(e);t.fillMaterialProperty instanceof oM?this._groundColorBatches[r].add(e,t):this._groundMaterialBatches[r].add(e,t)}else t.isClosed?t.fillMaterialProperty instanceof oM?Object(u.a)(t.terrainOffsetProperty)?this._closedColorBatches[n+i].add(e,t):this._closedColorBatches[i].add(e,t):Object(u.a)(t.terrainOffsetProperty)?this._closedMaterialBatches[n+i].add(e,t):this._closedMaterialBatches[i].add(e,t):t.fillMaterialProperty instanceof oM?Object(u.a)(t.terrainOffsetProperty)?this._openColorBatches[n+i].add(e,t):this._openColorBatches[i].add(e,t):Object(u.a)(t.terrainOffsetProperty)?this._openMaterialBatches[n+i].add(e,t):this._openMaterialBatches[i].add(e,t)}},F7._onGeometryChanged=function(e){var t=this._removedObjects,i=this._changedObjects,n=e.entity,r=n.id;Object(u.a)(t.get(r))||Object(u.a)(i.get(r))||i.set(r,n)},F7.prototype._onCollectionChanged=function(e,t,i){var n,r,a,o=this._addedObjects,s=this._removedObjects,c=this._changedObjects;for(n=i.length-1;n>-1;n--)r=(a=i[n]).id,o.remove(r)||(s.set(r,a),c.remove(r));for(n=t.length-1;n>-1;n--)r=(a=t[n]).id,s.remove(r)?c.set(r,a):o.set(r,a)};var z7=F7,U7=rG.FILL,V7=uf.WHITE,H7=uf.BLACK,G7=new uf(.165,.165,.165,.8),q7=new Rt(7,5),W7=Rt.ZERO,Y7=z.ZERO,X7=eD.NONE,Z7=tD.CENTER,Q7=iD.CENTER,K7=new z,J7=new uf,$7=new uf,e9=new uf,t9=new Rt,i9=new z,n9=new Rt,r9=new Fx,a9=new Fx,o9=new Fx,s9=new gv;function c9(e){this.entity=e,this.label=void 0,this.index=void 0}function l9(e,t){if(!Object(u.a)(e))throw new h.a("entityCluster is required.");if(!Object(u.a)(t))throw new h.a("entityCollection is required.");t.collectionChanged.addEventListener(l9.prototype._onCollectionChanged,this),this._cluster=e,this._entityCollection=t,this._items=new Fi,this._onCollectionChanged(t,t.values,[],[])}function u9(e,t,i){Object(u.a)(e)&&(e.label=void 0,i.removeLabel(t))}l9.prototype.update=function(e){if(!Object(u.a)(e))throw new h.a("time is required.");for(var t=this._items.values,i=this._cluster,n=0,r=t.length;n<r;n++){var a,o,s=t[n],c=s.entity,l=c._label,d=s.label,f=c.isShowing&&c.isAvailable(e)&&aD.getValueOrDefault(l._show,e,!0);f&&(o=aD.getValueOrUndefined(c._position,e,K7),a=aD.getValueOrUndefined(l._text,e),f=Object(u.a)(o)&&Object(u.a)(a)),f?(aD.isConstant(c._position)||(i._clusterDirty=!0),Object(u.a)(d)||((d=i.getLabel(c)).id=c,s.label=d),d.show=!0,d.position=o,d.text=a,d.scale=aD.getValueOrDefault(l._scale,e,1),d.font=aD.getValueOrDefault(l._font,e,"30px sans-serif"),d.style=aD.getValueOrDefault(l._style,e,U7),d.fillColor=aD.getValueOrDefault(l._fillColor,e,V7,J7),d.outlineColor=aD.getValueOrDefault(l._outlineColor,e,H7,$7),d.outlineWidth=aD.getValueOrDefault(l._outlineWidth,e,1),d.showBackground=aD.getValueOrDefault(l._showBackground,e,!1),d.backgroundColor=aD.getValueOrDefault(l._backgroundColor,e,G7,e9),d.backgroundPadding=aD.getValueOrDefault(l._backgroundPadding,e,q7,t9),d.pixelOffset=aD.getValueOrDefault(l._pixelOffset,e,W7,n9),d.eyeOffset=aD.getValueOrDefault(l._eyeOffset,e,Y7,i9),d.heightReference=aD.getValueOrDefault(l._heightReference,e,X7),d.horizontalOrigin=aD.getValueOrDefault(l._horizontalOrigin,e,Z7),d.verticalOrigin=aD.getValueOrDefault(l._verticalOrigin,e,Q7),d.translucencyByDistance=aD.getValueOrUndefined(l._translucencyByDistance,e,r9),d.pixelOffsetScaleByDistance=aD.getValueOrUndefined(l._pixelOffsetScaleByDistance,e,a9),d.scaleByDistance=aD.getValueOrUndefined(l._scaleByDistance,e,o9),d.distanceDisplayCondition=aD.getValueOrUndefined(l._distanceDisplayCondition,e,s9),d.disableDepthTestDistance=aD.getValueOrUndefined(l._disableDepthTestDistance,e)):u9(s,c,i)}return!0},l9.prototype.getBoundingSphere=function(e,t){if(!Object(u.a)(e))throw new h.a("entity is required.");if(!Object(u.a)(t))throw new h.a("result is required.");var i=this._items.get(e.id);if(!Object(u.a)(i)||!Object(u.a)(i.label))return nD.FAILED;var n=i.label;return t.center=z.clone(Object(w.a)(n._clampedPosition,n.position),t.center),t.radius=0,nD.DONE},l9.prototype.isDestroyed=function(){return!1},l9.prototype.destroy=function(){this._entityCollection.collectionChanged.removeEventListener(l9.prototype._onCollectionChanged,this);for(var e=this._entityCollection.values,t=0;t<e.length;t++)this._cluster.removeLabel(e[t]);return rl(this)},l9.prototype._onCollectionChanged=function(e,t,i,n){var r,a,o=this._items,s=this._cluster;for(r=t.length-1;r>-1;r--)a=t[r],Object(u.a)(a._label)&&Object(u.a)(a._position)&&o.set(a.id,new c9(a));for(r=n.length-1;r>-1;r--)a=n[r],Object(u.a)(a._label)&&Object(u.a)(a._position)?o.contains(a.id)||o.set(a.id,new c9(a)):(u9(o.get(a.id),a,s),o.remove(a.id));for(r=i.length-1;r>-1;r--)a=i[r],u9(o.get(a.id),a,s),o.remove(a.id)};var h9=l9,d9=rM.ENABLED,f9=eD.NONE,p9=uf.RED,m9=uf.WHITE,_9=sW.HIGHLIGHT,g9=new Rt(1,1),v9=new Be,b9=new Be;function y9(e,t){if(!Object(u.a)(e))throw new h.a("scene is required.");if(!Object(u.a)(t))throw new h.a("entityCollection is required.");t.collectionChanged.addEventListener(y9.prototype._onCollectionChanged,this),this._scene=e,this._primitives=e.primitives,this._entityCollection=t,this._modelHash={},this._entitiesToVisualize=new Fi,this._onCollectionChanged(t,t.values,[],[])}function w9(e,t,i,n){var r=i[t.id];Object(u.a)(r)&&(n.removeAndDestroy(r.modelPrimitive),delete i[t.id])}function O9(e,t){var i=t[e.id];Object(u.a)(i)&&(i.nodeTransformationsScratch={})}function x9(e,t,i){e.readyPromise.otherwise((function(e){console.error(e),i[t.id].loadFail=!0}))}y9.prototype.update=function(e){if(!Object(u.a)(e))throw new h.a("time is required.");for(var t=this._entitiesToVisualize.values,i=this._modelHash,n=this._primitives,r=0,a=t.length;r<a;r++){var o,s,c=t[r],l=c._model,d=i[c.id],p=c.isShowing&&c.isAvailable(e)&&aD.getValueOrDefault(l._show,e,!0);if(p&&(s=c.computeModelMatrix(e,v9),o=f.a.createIfNeeded(aD.getValueOrUndefined(l._uri,e)),p=Object(u.a)(s)&&Object(u.a)(o)),p){var m=Object(u.a)(d)?d.modelPrimitive:void 0;if(Object(u.a)(m)&&o.url===d.url||(Object(u.a)(m)&&(n.removeAndDestroy(m),delete i[c.id]),(m=J0.fromGltf({url:o,incrementallyLoadTextures:aD.getValueOrDefault(l._incrementallyLoadTextures,e,!0),scene:this._scene})).id=c,n.add(m),d={modelPrimitive:m,url:o.url,animationsRunning:!1,nodeTransformationsScratch:{},originalNodeMatrixHash:{},loadFail:!1},i[c.id]=d,x9(m,c,i)),m.show=!0,m.scale=aD.getValueOrDefault(l._scale,e,1),m.minimumPixelSize=aD.getValueOrDefault(l._minimumPixelSize,e,0),m.maximumScale=aD.getValueOrUndefined(l._maximumScale,e),m.modelMatrix=Be.clone(s,m.modelMatrix),m.shadows=aD.getValueOrDefault(l._shadows,e,d9),m.heightReference=aD.getValueOrDefault(l._heightReference,e,f9),m.distanceDisplayCondition=aD.getValueOrUndefined(l._distanceDisplayCondition,e),m.silhouetteColor=aD.getValueOrDefault(l._silhouetteColor,e,p9,m._silhouetteColor),m.silhouetteSize=aD.getValueOrDefault(l._silhouetteSize,e,0),m.color=aD.getValueOrDefault(l._color,e,m9,m._color),m.colorBlendMode=aD.getValueOrDefault(l._colorBlendMode,e,_9),m.colorBlendAmount=aD.getValueOrDefault(l._colorBlendAmount,e,.5),m.clippingPlanes=aD.getValueOrUndefined(l._clippingPlanes,e),m.clampAnimations=aD.getValueOrDefault(l._clampAnimations,e,!0),m.imageBasedLightingFactor=aD.getValueOrDefault(l._imageBasedLightingFactor,e,g9),m.lightColor=aD.getValueOrUndefined(l._lightColor,e),m.ready){var _=aD.getValueOrDefault(l._runAnimations,e,!0);d.animationsRunning!==_&&(_?m.activeAnimations.addAll({loop:CJ.REPEAT}):m.activeAnimations.removeAll(),d.animationsRunning=_);var g=aD.getValueOrUndefined(l._nodeTransformations,e,d.nodeTransformationsScratch);if(Object(u.a)(g))for(var v=d.originalNodeMatrixHash,b=Object.keys(g),y=0,w=b.length;y<w;++y){var O=b[y],x=g[O];if(Object(u.a)(x)){var E=m.getNode(O);if(Object(u.a)(E)){var T=v[O];Object(u.a)(T)||(T=E.matrix.clone(),v[O]=T);var C=Be.fromTranslationRotationScale(x,b9);E.matrix=Be.multiply(T,C,C)}}}}}else Object(u.a)(d)&&(d.modelPrimitive.show=!1)}return!0},y9.prototype.isDestroyed=function(){return!1},y9.prototype.destroy=function(){this._entityCollection.collectionChanged.removeEventListener(y9.prototype._onCollectionChanged,this);for(var e=this._entitiesToVisualize.values,t=this._modelHash,i=this._primitives,n=e.length-1;n>-1;n--)w9(this,e[n],t,i);return rl(this)},y9.prototype.getBoundingSphere=function(e,t){if(!Object(u.a)(e))throw new h.a("entity is required.");if(!Object(u.a)(t))throw new h.a("result is required.");var i=this._modelHash[e.id];if(!Object(u.a)(i)||i.loadFail)return nD.FAILED;var n=i.modelPrimitive;if(!Object(u.a)(n)||!n.show)return nD.FAILED;if(!n.ready)return nD.PENDING;if(n.heightReference===eD.NONE)St.transform(n.boundingSphere,n.modelMatrix,t);else{if(!Object(u.a)(n._clampedModelMatrix))return nD.PENDING;St.transform(n.boundingSphere,n._clampedModelMatrix,t)}return nD.DONE},y9.prototype._onCollectionChanged=function(e,t,i,n){var r,a,o=this._entitiesToVisualize,s=this._modelHash,c=this._primitives;for(r=t.length-1;r>-1;r--)a=t[r],Object(u.a)(a._model)&&Object(u.a)(a._position)&&o.set(a.id,a);for(r=n.length-1;r>-1;r--)a=n[r],Object(u.a)(a._model)&&Object(u.a)(a._position)?(O9(a,s),o.set(a.id,a)):(w9(this,a,s,c),o.remove(a.id));for(r=i.length-1;r>-1;r--)w9(this,a=i[r],s,c),o.remove(a.id)};var E9=y9;function T9(e){this._definitionChanged=new $o.a,this._value=void 0,this._removeSubscription=void 0,this.setValue(e)}Object(O.a)(T9.prototype,{isConstant:{get:function(){return aD.isConstant(this._value)}},definitionChanged:{get:function(){return this._definitionChanged}},referenceFrame:{get:function(){return Object(u.a)(this._value)?this._value.referenceFrame:mS.FIXED}}}),T9.prototype.getValue=function(e,t){return this.getValueInReferenceFrame(e,mS.FIXED,t)},T9.prototype.setValue=function(e){this._value!==e&&(this._value=e,Object(u.a)(this._removeSubscription)&&(this._removeSubscription(),this._removeSubscription=void 0),Object(u.a)(e)&&(this._removeSubscription=e.definitionChanged.addEventListener(this._raiseDefinitionChanged,this)),this._definitionChanged.raiseEvent(this))},T9.prototype.getValueInReferenceFrame=function(e,t,i){if(!Object(u.a)(e))throw new h.a("time is required.");if(!Object(u.a)(t))throw new h.a("referenceFrame is required.");if(Object(u.a)(this._value))return i=this._value.getValueInReferenceFrame(e,t,i),Object(u.a)(i)?ae.WGS84.scaleToGeodeticSurface(i,i):void 0},T9.prototype.equals=function(e){return this===e||e instanceof T9&&this._value===e._value},T9.prototype._raiseDefinitionChanged=function(){this._definitionChanged.raiseEvent(this)};var C9=T9,S9=new ex,A9=new ex,P9=new ex;function I9(e){this.entity=e,this.polyline=void 0,this.index=void 0,this.updater=void 0}function D9(e,t,i,n,r,a,o,s){for(;e instanceof YW;)e=e.resolvedProperty;e instanceof rY?o=function(e,t,i,n,r,a,o,s,c){var l,h=s;l=e.getValueInReferenceFrame(t,a,c[h]),Object(u.a)(l)&&(c[h++]=l);for(var d,f,p,m=!Object(u.a)(r)||Tr.lessThanOrEquals(r,t)||Tr.greaterThanOrEquals(r,i),_=0,g=n.length,v=n[_],b=i,y=!1;_<g;){if(!m&&Tr.greaterThanOrEquals(v,r)&&(l=e.getValueInReferenceFrame(r,a,c[h]),Object(u.a)(l)&&(c[h++]=l),m=!0),Tr.greaterThan(v,t)&&Tr.lessThan(v,b)&&!v.equals(r)&&(l=e.getValueInReferenceFrame(v,a,c[h]),Object(u.a)(l)&&(c[h++]=l)),_<g-1){if(o>0&&!y){var w=n[_+1],O=Tr.secondsDifference(w,v);(y=O>o)&&(d=Math.ceil(O/o),f=0,p=O/Math.max(d,2),d=Math.max(d-1,1))}if(y&&f<d){v=Tr.addSeconds(v,p,new Tr),f++;continue}}y=!1,v=n[++_]}return l=e.getValueInReferenceFrame(i,a,c[h]),Object(u.a)(l)&&(c[h++]=l),h}(e,t,i,e._property._times,n,r,a,o,s):o=e instanceof kU?function(e,t,i,n,r,a,o,s){A9.start=t,A9.stop=i;for(var c=o,l=e.intervals,u=0;u<l.length;u++){var h=l.get(u);if(!ex.intersect(h,A9,S9).isEmpty){var d=h.start,f=h.stop,p=t;Tr.greaterThan(d,p)&&(p=d);var m=i;Tr.lessThan(f,m)&&(m=f),c=D9(h.data,p,m,n,r,a,c,s)}}return c}(e,t,i,n,r,a,o,s):e instanceof dY?function(e,t,i,n,r,a,o,s){P9.start=t,P9.stop=i;for(var c=o,l=e.intervals,h=0;h<l.length;h++){var d=l.get(h);if(!ex.intersect(d,P9,S9).isEmpty){var f=d.start;d.isStartIncluded||(f=d.isStopIncluded?d.stop:Tr.addSeconds(d.start,Tr.secondsDifference(d.stop,d.start)/2,new Tr));var p=e.getValueInReferenceFrame(f,r,s[c]);Object(u.a)(p)&&(s[c]=p,c++)}}return c}(e,t,i,0,r,0,o,s):e instanceof XB||e instanceof C9&&aD.isConstant(e)?function(e,t,i,n,r,a,o,s){var c=e.getValueInReferenceFrame(t,r,s[o]);return Object(u.a)(c)&&(s[o++]=c),o}(e,t,0,0,r,0,o,s):function(e,t,i,n,r,a,o,s){for(var c,l=0,h=o,d=t,f=Math.max(a,60),p=!Object(u.a)(n)||Tr.lessThanOrEquals(n,t)||Tr.greaterThanOrEquals(n,i);Tr.lessThan(d,i);)!p&&Tr.greaterThanOrEquals(d,n)&&(p=!0,c=e.getValueInReferenceFrame(n,r,s[h]),Object(u.a)(c)&&(s[h]=c,h++)),c=e.getValueInReferenceFrame(d,r,s[h]),Object(u.a)(c)&&(s[h]=c,h++),l++,d=Tr.addSeconds(t,f*l,new Tr);return c=e.getValueInReferenceFrame(i,r,s[h]),Object(u.a)(c)&&(s[h]=c,h++),h}(e,t,i,n,r,a,o,s);return o}function j9(e,t,i,n,r,a,o){Object(u.a)(o)||(o=[]);var s=D9(e,t,i,n,r,a,0,o);return o.length=s,o}var M9=new be;function R9(e,t){this._unusedIndexes=[],this._polylineCollection=new A3,this._scene=e,this._referenceFrame=t,e.primitives.add(this._polylineCollection)}function L9(e,t){if(!Object(u.a)(e))throw new h.a("scene is required.");if(!Object(u.a)(t))throw new h.a("entityCollection is required.");t.collectionChanged.addEventListener(L9.prototype._onCollectionChanged,this),this._scene=e,this._updaters={},this._entityCollection=t,this._items=new Fi,this._onCollectionChanged(t,t.values,[],[])}R9.prototype.update=function(e){if(this._referenceFrame===mS.INERTIAL){var t=xa.computeIcrfToFixedMatrix(e,M9);Object(u.a)(t)||(t=xa.computeTemeToPseudoFixedMatrix(e,M9)),Be.fromRotationTranslation(t,z.ZERO,this._polylineCollection.modelMatrix)}},R9.prototype.updateObject=function(e,t){var i,n,r=t.entity,a=r._path,o=r._position,s=a._show,c=t.polyline,l=r.isShowing&&(!Object(u.a)(s)||s.getValue(e));if(l){var h=aD.getValueOrUndefined(a._leadTime,e),d=aD.getValueOrUndefined(a._trailTime,e),f=r._availability,p=Object(u.a)(f),m=Object(u.a)(h),_=Object(u.a)(d);if(l=p||m&&_){if(_&&(i=Tr.addSeconds(e,-d,new Tr)),m&&(n=Tr.addSeconds(e,h,new Tr)),p){var g=f.start,v=f.stop;_&&!Tr.greaterThan(g,i)||(i=g),m&&!Tr.lessThan(v,n)||(n=v)}l=Tr.lessThan(i,n)}}if(l){if(!Object(u.a)(c)){var b=this._unusedIndexes;if(b.length>0){var y=b.pop();c=this._polylineCollection.get(y),t.index=y}else t.index=this._polylineCollection.length,c=this._polylineCollection.add();c.id=r,t.polyline=c}var w=aD.getValueOrDefault(a._resolution,e,60);c.show=!0,c.positions=j9(o,i,n,e,this._referenceFrame,w,c.positions.slice()),c.material=nU.getValue(e,a._material,c.material),c.width=aD.getValueOrDefault(a._width,e,1),c.distanceDisplayCondition=aD.getValueOrUndefined(a._distanceDisplayCondition,e,c.distanceDisplayCondition)}else Object(u.a)(c)&&(this._unusedIndexes.push(t.index),t.polyline=void 0,c.show=!1,t.index=void 0)},R9.prototype.removeObject=function(e){var t=e.polyline;Object(u.a)(t)&&(this._unusedIndexes.push(e.index),e.polyline=void 0,t.show=!1,t.id=void 0,e.index=void 0)},R9.prototype.destroy=function(){return this._scene.primitives.remove(this._polylineCollection),rl(this)},L9.prototype.update=function(e){if(!Object(u.a)(e))throw new h.a("time is required.");var t=this._updaters;for(var i in t)t.hasOwnProperty(i)&&t[i].update(e);for(var n=this._items.values,r=0,a=n.length;r<a;r++){var o=n[r],s=o.entity._position,c=o.updater,l=mS.FIXED;this._scene.mode===xF.SCENE3D&&(l=s.referenceFrame);var d=this._updaters[l];c===d&&Object(u.a)(d)?d.updateObject(e,o):(Object(u.a)(c)&&c.removeObject(o),Object(u.a)(d)||((d=new R9(this._scene,l)).update(e),this._updaters[l]=d),o.updater=d,Object(u.a)(d)&&d.updateObject(e,o))}return!0},L9.prototype.isDestroyed=function(){return!1},L9.prototype.destroy=function(){this._entityCollection.collectionChanged.removeEventListener(L9.prototype._onCollectionChanged,this);var e=this._updaters;for(var t in e)e.hasOwnProperty(t)&&e[t].destroy();return rl(this)},L9.prototype._onCollectionChanged=function(e,t,i,n){var r,a,o,s=this._items;for(r=t.length-1;r>-1;r--)a=t[r],Object(u.a)(a._path)&&Object(u.a)(a._position)&&s.set(a.id,new I9(a));for(r=n.length-1;r>-1;r--)a=n[r],Object(u.a)(a._path)&&Object(u.a)(a._position)?s.contains(a.id)||s.set(a.id,new I9(a)):(o=s.get(a.id),Object(u.a)(o)&&(o.updater.removeObject(o),s.remove(a.id)));for(r=i.length-1;r>-1;r--)a=i[r],o=s.get(a.id),Object(u.a)(o)&&(Object(u.a)(o.updater)&&o.updater.removeObject(o),s.remove(a.id))},L9._subSample=j9;var N9=L9,F9=uf.WHITE,k9=uf.BLACK,B9=new uf,z9=new z,U9=new uf,V9=new Fx,H9=new Fx,G9=new gv;function q9(e){this.entity=e,this.pointPrimitive=void 0,this.billboard=void 0,this.color=void 0,this.outlineColor=void 0,this.pixelSize=void 0,this.outlineWidth=void 0}function W9(e,t){if(!Object(u.a)(e))throw new h.a("entityCluster is required.");if(!Object(u.a)(t))throw new h.a("entityCollection is required.");t.collectionChanged.addEventListener(W9.prototype._onCollectionChanged,this),this._cluster=e,this._entityCollection=t,this._items=new Fi,this._onCollectionChanged(t,t.values,[],[])}function Y9(e,t,i){if(Object(u.a)(e)){var n=e.pointPrimitive;if(Object(u.a)(n))return e.pointPrimitive=void 0,void i.removePoint(t);var r=e.billboard;Object(u.a)(r)&&(e.billboard=void 0,i.removeBillboard(t))}}W9.prototype.update=function(e){if(!Object(u.a)(e))throw new h.a("time is required.");for(var t=this._items.values,i=this._cluster,n=0,r=t.length;n<r;n++){var a,o=t[n],s=o.entity,c=s._point,l=o.pointPrimitive,d=o.billboard,f=aD.getValueOrDefault(c._heightReference,e,eD.NONE),p=s.isShowing&&s.isAvailable(e)&&aD.getValueOrDefault(c._show,e,!0);if(p&&(a=aD.getValueOrUndefined(s._position,e,z9),p=Object(u.a)(a)),p){aD.isConstant(s._position)||(i._clusterDirty=!0);var m=!1;if(f===eD.NONE||Object(u.a)(d)?f!==eD.NONE||Object(u.a)(l)||(Object(u.a)(d)&&(Y9(o,s,i),d=void 0),(l=i.getPoint(s)).id=s,o.pointPrimitive=l):(Object(u.a)(l)&&(Y9(o,s,i),l=void 0),(d=i.getBillboard(s)).id=s,d.image=void 0,o.billboard=d,m=!0),Object(u.a)(l))l.show=!0,l.position=a,l.scaleByDistance=aD.getValueOrUndefined(c._scaleByDistance,e,V9),l.translucencyByDistance=aD.getValueOrUndefined(c._translucencyByDistance,e,H9),l.color=aD.getValueOrDefault(c._color,e,F9,B9),l.outlineColor=aD.getValueOrDefault(c._outlineColor,e,k9,U9),l.outlineWidth=aD.getValueOrDefault(c._outlineWidth,e,0),l.pixelSize=aD.getValueOrDefault(c._pixelSize,e,1),l.distanceDisplayCondition=aD.getValueOrUndefined(c._distanceDisplayCondition,e,G9),l.disableDepthTestDitance=aD.getValueOrDefault(c._disableDepthTestDistance,e,0),l.shake=aD.getValueOrDefault(c._shake,e,!1);else if(Object(u.a)(d)){d.show=!0,d.position=a,d.scaleByDistance=aD.getValueOrUndefined(c._scaleByDistance,e,V9),d.translucencyByDistance=aD.getValueOrUndefined(c._translucencyByDistance,e,H9),d.distanceDisplayCondition=aD.getValueOrUndefined(c._distanceDisplayCondition,e,G9),d.disableDepthTestDistance=aD.getValueOrDefault(c._disableDepthTestDistance,e,0),d.heightReference=f;var _=aD.getValueOrDefault(c._color,e,F9,B9),g=aD.getValueOrDefault(c._outlineColor,e,k9,U9),v=Math.round(aD.getValueOrDefault(c._outlineWidth,e,0)),b=Math.max(1,Math.round(aD.getValueOrDefault(c._pixelSize,e,1)));if(v>0?(d.scale=1,m=m||v!==o.outlineWidth||b!==o.pixelSize||!uf.equals(_,o.color)||!uf.equals(g,o.outlineColor)):(d.scale=b/50,b=50,m=m||v!==o.outlineWidth||!uf.equals(_,o.color)||!uf.equals(g,o.outlineColor)),m){o.color=uf.clone(_,o.color),o.outlineColor=uf.clone(g,o.outlineColor),o.pixelSize=b,o.outlineWidth=v;var y=_.alpha,w=_.toCssColorString(),O=g.toCssColorString(),x=JSON.stringify([w,b,O,v]);d.setImage(x,E2(y,w,O,v,b))}}}else Y9(o,s,i)}return!0},W9.prototype.getBoundingSphere=function(e,t){if(!Object(u.a)(e))throw new h.a("entity is required.");if(!Object(u.a)(t))throw new h.a("result is required.");var i=this._items.get(e.id);if(!Object(u.a)(i)||!Object(u.a)(i.pointPrimitive)&&!Object(u.a)(i.billboard))return nD.FAILED;if(Object(u.a)(i.pointPrimitive))t.center=z.clone(i.pointPrimitive.position,t.center);else{var n=i.billboard;if(!Object(u.a)(n._clampedPosition))return nD.PENDING;t.center=z.clone(n._clampedPosition,t.center)}return t.radius=0,nD.DONE},W9.prototype.isDestroyed=function(){return!1},W9.prototype.destroy=function(){this._entityCollection.collectionChanged.removeEventListener(W9.prototype._onCollectionChanged,this);for(var e=this._entityCollection.values,t=0;t<e.length;t++)this._cluster.removePoint(e[t]);return rl(this)},W9.prototype._onCollectionChanged=function(e,t,i,n){var r,a,o=this._items,s=this._cluster;for(r=t.length-1;r>-1;r--)a=t[r],Object(u.a)(a._point)&&Object(u.a)(a._position)&&o.set(a.id,new q9(a));for(r=n.length-1;r>-1;r--)a=n[r],Object(u.a)(a._point)&&Object(u.a)(a._position)?o.contains(a.id)||o.set(a.id,new q9(a)):(Y9(o.get(a.id),a,s),o.remove(a.id));for(r=i.length-1;r>-1;r--)a=i[r],Y9(o.get(a.id),a,s),o.remove(a.id)};var X9=W9,Z9=new ZI(0),Q9={},K9=new uf,J9=new oM(uf.WHITE),$9=new ZI(!0),eee=new ZI(rM.DISABLED),tee=new ZI(new gv),iee=new ZI(iM.BOTH);function nee(){this.vertexFormat=void 0,this.positions=void 0,this.width=void 0,this.followSurface=void 0,this.arcType=void 0,this.granularity=void 0}function ree(){this.positions=void 0,this.width=void 0,this.arcType=void 0,this.granularity=void 0}function aee(e,t){if(!Object(u.a)(e))throw new h.a("entity is required");if(!Object(u.a)(t))throw new h.a("scene is required");this._entity=e,this._scene=t,this._entitySubscription=e.definitionChanged.addEventListener(aee.prototype._onEntityPropertyChanged,this),this._fillEnabled=!1,this._dynamic=!1,this._geometryChanged=new $o.a,this._showProperty=void 0,this._materialProperty=void 0,this._shadowsProperty=void 0,this._distanceDisplayConditionProperty=void 0,this._classificationTypeProperty=void 0,this._depthFailMaterialProperty=void 0,this._geometryOptions=new nee,this._groundGeometryOptions=new ree,this._id="polyline-"+e.id,this._clampToGround=!1,this._supportsPolylinesOnTerrain=zz.supportsPolylinesOnTerrain(t),this._zIndex=0,this._onEntityPropertyChanged(e,"polyline",e.polyline,void 0)}Object(O.a)(aee.prototype,{id:{get:function(){return this._id}},entity:{get:function(){return this._entity}},fillEnabled:{get:function(){return this._fillEnabled}},hasConstantFill:{get:function(){return!this._fillEnabled||!Object(u.a)(this._entity.availability)&&aD.isConstant(this._showProperty)}},fillMaterialProperty:{get:function(){return this._materialProperty}},depthFailMaterialProperty:{get:function(){return this._depthFailMaterialProperty}},outlineEnabled:{value:!1},hasConstantOutline:{value:!0},outlineColorProperty:{value:void 0},shadowsProperty:{get:function(){return this._shadowsProperty}},distanceDisplayConditionProperty:{get:function(){return this._distanceDisplayConditionProperty}},classificationTypeProperty:{get:function(){return this._classificationTypeProperty}},isDynamic:{get:function(){return this._dynamic}},isClosed:{value:!1},geometryChanged:{get:function(){return this._geometryChanged}},arcType:{get:function(){return this._arcType}},clampToGround:{get:function(){return this._clampToGround&&this._supportsPolylinesOnTerrain}},zIndex:{get:function(){return this._zIndex}}}),aee.prototype.isOutlineVisible=function(e){return!1},aee.prototype.isFilled=function(e){var t=this._entity,i=this._fillEnabled&&t.isAvailable(e)&&this._showProperty.getValue(e);return Object(w.a)(i,!1)},aee.prototype.createFillGeometryInstance=function(e){if(!Object(u.a)(e))throw new h.a("time is required.");if(!this._fillEnabled)throw new h.a("This instance does not represent a filled geometry.");var t,i=this._entity,n=i.isAvailable(e),r=new sA(n&&i.isShowing&&this._showProperty.getValue(e)),a=this._distanceDisplayConditionProperty.getValue(e),o={show:r,distanceDisplayCondition:bv.fromDistanceDisplayCondition(a)};return this._materialProperty instanceof oM&&(Object(u.a)(this._materialProperty.color)&&(this._materialProperty.color.isConstant||n)&&(t=this._materialProperty.color.getValue(e,K9)),Object(u.a)(t)||(t=uf.WHITE),o.color=df.fromColor(t)),this.clampToGround?new Mu({id:i,geometry:new wO(this._groundGeometryOptions),attributes:o}):(Object(u.a)(this._depthFailMaterialProperty)&&this._depthFailMaterialProperty instanceof oM&&(Object(u.a)(this._depthFailMaterialProperty.color)&&(this._depthFailMaterialProperty.color.isConstant||n)&&(t=this._depthFailMaterialProperty.color.getValue(e,K9)),Object(u.a)(t)||(t=uf.WHITE),o.depthFailColor=df.fromColor(t)),new Mu({id:i,geometry:new PT(this._geometryOptions),attributes:o}))},aee.prototype.createOutlineGeometryInstance=function(e){throw new h.a("This instance does not represent an outlined geometry.")},aee.prototype.isDestroyed=function(){return!1},aee.prototype.destroy=function(){this._entitySubscription(),rl(this)},aee.prototype._onEntityPropertyChanged=function(e,t,i,n){if("availability"===t||"polyline"===t){var r=this._entity.polyline;if(Object(u.a)(r)){var a=r.positions,o=r.show;if(Object(u.a)(o)&&o.isConstant&&!o.getValue(nx.MINIMUM_VALUE)||!Object(u.a)(a))this._fillEnabled&&(this._fillEnabled=!1,this._geometryChanged.raiseEvent(this));else{var s=r.zIndex,c=Object(w.a)(r.material,J9),l=c instanceof oM;this._materialProperty=c,this._depthFailMaterialProperty=r.depthFailMaterial,this._showProperty=Object(w.a)(o,$9),this._shadowsProperty=Object(w.a)(r.shadows,eee),this._distanceDisplayConditionProperty=Object(w.a)(r.distanceDisplayCondition,tee),this._classificationTypeProperty=Object(w.a)(r.classificationType,iee),this._fillEnabled=!0,this._zIndex=Object(w.a)(s,Z9);var h=r.width,d=r.followSurface,f=r.arcType,p=r.clampToGround,m=r.granularity;if(a.isConstant&&aD.isConstant(h)&&aD.isConstant(d)&&aD.isConstant(f)&&aD.isConstant(m)&&aD.isConstant(p)&&aD.isConstant(s)){var _,g=this._geometryOptions,v=a.getValue(nx.MINIMUM_VALUE,g.positions);if(!Object(u.a)(v)||v.length<2)return void(this._fillEnabled&&(this._fillEnabled=!1,this._geometryChanged.raiseEvent(this)));_=l&&(!Object(u.a)(this._depthFailMaterialProperty)||this._depthFailMaterialProperty instanceof oM)?TB.VERTEX_FORMAT:DB.VERTEX_FORMAT,g.vertexFormat=_,g.positions=v,g.width=Object(u.a)(h)?h.getValue(nx.MINIMUM_VALUE):void 0,g.followSurface=Object(u.a)(d)?d.getValue(nx.MINIMUM_VALUE):void 0,g.arcType=Object(u.a)(f)?f.getValue(nx.MINIMUM_VALUE):void 0,g.granularity=Object(u.a)(m)?m.getValue(nx.MINIMUM_VALUE):void 0;var b=this._groundGeometryOptions;b.positions=v,b.width=g.width,b.arcType=g.arcType,b.granularity=g.granularity,this._clampToGround=!!Object(u.a)(p)&&p.getValue(nx.MINIMUM_VALUE),!this._clampToGround&&Object(u.a)(s)&&Object(iE.a)("Entity polylines must have clampToGround: true when using zIndex.  zIndex will be ignored."),this._dynamic=!1,this._geometryChanged.raiseEvent(this)}else this._dynamic||(this._dynamic=!0,this._geometryChanged.raiseEvent(this))}}else this._fillEnabled&&(this._fillEnabled=!1,this._geometryChanged.raiseEvent(this))}},aee.prototype.createDynamicUpdater=function(e,t){if(x.a.defined("primitives",e),x.a.defined("groundPrimitives",t),!this._dynamic)throw new h.a("This instance does not represent dynamic geometry.");return new see(e,t,this)};var oee={positions:void 0,granularity:void 0,height:void 0,ellipsoid:void 0};function see(e,t,i){this._line=void 0,this._primitives=e,this._groundPrimitives=t,this._groundPolylinePrimitive=void 0,this._material=void 0,this._geometryUpdater=i,this._positions=[]}function cee(e){if(Object(u.a)(e._line))return e._line;var t=e._geometryUpdater._scene.id,i=Q9[t],n=e._primitives;!Object(u.a)(i)||i.isDestroyed()?(i=new A3,Q9[t]=i,n.add(i)):n.contains(i)||n.add(i);var r=i.add();return r.id=e._geometryUpdater._entity,e._line=r,r}see.prototype.update=function(e){var t=this._geometryUpdater,i=t._entity,n=i.polyline,r=n.positions,a=aD.getValueOrUndefined(r,e,this._positions);t._clampToGround=aD.getValueOrDefault(n._clampToGround,e,!1),t._groundGeometryOptions.positions=a,t._groundGeometryOptions.width=aD.getValueOrDefault(n._width,e,1),t._groundGeometryOptions.arcType=aD.getValueOrDefault(n._arcType,e,Zt.GEODESIC),t._groundGeometryOptions.granularity=aD.getValueOrDefault(n._granularity,e,9999);var o=this._groundPrimitives;if(Object(u.a)(this._groundPolylinePrimitive)&&(o.remove(this._groundPolylinePrimitive),this._groundPolylinePrimitive=void 0),t.clampToGround){if(!i.isShowing||!i.isAvailable(e)||!aD.getValueOrDefault(n._show,e,!0))return;if(!Object(u.a)(a)||a.length<2)return;var s,c=t.fillMaterialProperty;if(c instanceof oM)s=new TB;else{var l=nU.getValue(e,c,this._material);s=new DB({material:l,translucent:l.isTranslucent()}),this._material=l}return this._groundPolylinePrimitive=o.add(new LB({geometryInstances:t.createFillGeometryInstance(e),appearance:s,classificationType:t.classificationTypeProperty.getValue(e),asynchronous:!1}),aD.getValueOrUndefined(t.zIndex,e)),void(Object(u.a)(this._line)&&(this._line.show=!1))}var h=cee(this);if(i.isShowing&&i.isAvailable(e)&&aD.getValueOrDefault(n._show,e,!0))if(!Object(u.a)(a)||a.length<2)h.show=!1;else{var d=aD.getValueOrUndefined(n._followSurface,e),f=Zt.GEODESIC;Object(u.a)(d)&&(f=d?Zt.GEODESIC:Zt.NONE),f=aD.getValueOrDefault(n._arcType,e,f);var p=t._scene.globe;f!==Zt.NONE&&Object(u.a)(p)&&(oee.ellipsoid=p.ellipsoid,oee.positions=a,oee.granularity=aD.getValueOrUndefined(n._granularity,e),oee.height=Gm.extractHeights(a,p.ellipsoid),a=Gm.generateCartesianArc(oee)),h.show=!0,h.positions=a.slice(),h.material=nU.getValue(e,t.fillMaterialProperty,h.material),h.width=aD.getValueOrDefault(n._width,e,1),h.distanceDisplayCondition=aD.getValueOrUndefined(n._distanceDisplayCondition,e,h.distanceDisplayCondition)}else h.show=!1},see.prototype.getBoundingSphere=function(e){if(x.a.defined("result",e),this._geometryUpdater.clampToGround){var t=this._groundPolylinePrimitive;if(Object(u.a)(t)&&t.show&&t.ready){var i=t.getGeometryInstanceAttributes(this._geometryUpdater._entity);if(Object(u.a)(i)&&Object(u.a)(i.boundingSphere))return St.clone(i.boundingSphere,e),nD.DONE}return Object(u.a)(t)&&!t.ready?nD.PENDING:nD.DONE}var n=cee(this);return n.show&&n.positions.length>0?(St.fromPoints(n.positions,e),nD.DONE):nD.FAILED},see.prototype.isDestroyed=function(){return!1},see.prototype.destroy=function(){var e=this._geometryUpdater._scene.id,t=Q9[e];Object(u.a)(t)&&(t.remove(this._line),0===t.length&&(this._primitives.removeAndDestroy(t),delete Q9[e])),Object(u.a)(this._groundPolylinePrimitive)&&this._groundPrimitives.remove(this._groundPolylinePrimitive),rl(this)};var lee=aee,uee=new uf,hee=new gv,dee=new gv;function fee(e,t,i,n,r){var a;a=i instanceof oM?TB:DB,this.orderedGroundPrimitives=e,this.classificationType=t,this.appearanceType=a,this.materialProperty=i,this.updaters=new Fi,this.createPrimitive=!0,this.primitive=void 0,this.oldPrimitive=void 0,this.geometry=new Fi,this.material=void 0,this.updatersWithAttributes=new Fi,this.attributes=new Fi,this.invalidated=!1,this.removeMaterialSubscription=i.definitionChanged.addEventListener(fee.prototype.onMaterialChanged,this),this.subscriptions=new Fi,this.showsUpdated=new Fi,this.zIndex=n,this._asynchronous=r}function pee(e,t,i){this._items=[],this._orderedGroundPrimitives=e,this._classificationType=t,this._asynchronous=Object(w.a)(i,!0)}fee.prototype.onMaterialChanged=function(){this.invalidated=!0},fee.prototype.isMaterial=function(e){var t=this.materialProperty,i=e.fillMaterialProperty;return i===t||i instanceof oM&&t instanceof oM||Object(u.a)(t)&&t.equals(i)},fee.prototype.add=function(e,t,i){var n=t.id;if(this.updaters.set(n,t),this.geometry.set(n,i),t.hasConstantFill&&t.fillMaterialProperty.isConstant&&aD.isConstant(t.distanceDisplayConditionProperty)){var r=this;this.subscriptions.set(n,t.entity.definitionChanged.addEventListener((function(e,i,n,a){"isShowing"===i&&r.showsUpdated.set(t.id,t)})))}else this.updatersWithAttributes.set(n,t);this.createPrimitive=!0},fee.prototype.remove=function(e){var t=e.id;if(this.createPrimitive=this.geometry.remove(t)||this.createPrimitive,this.updaters.remove(t)){this.updatersWithAttributes.remove(t);var i=this.subscriptions.get(t);return Object(u.a)(i)&&(i(),this.subscriptions.remove(t)),!0}return!1},fee.prototype.update=function(e){var t,i=!0,n=this.primitive,r=this.orderedGroundPrimitives,a=this.geometry.values;if(this.createPrimitive){if(a.length>0)Object(u.a)(n)&&(Object(u.a)(this.oldPrimitive)?r.remove(n):this.oldPrimitive=n),n=new LB({show:!1,asynchronous:this._asynchronous,geometryInstances:a,appearance:new this.appearanceType,classificationType:this.classificationType}),this.appearanceType===DB&&(this.material=nU.getValue(e,this.materialProperty,this.material),n.appearance.material=this.material),r.add(n,this.zIndex),i=!1;else{Object(u.a)(n)&&(r.remove(n),n=void 0);var o=this.oldPrimitive;Object(u.a)(o)&&(r.remove(o),this.oldPrimitive=void 0)}this.attributes.removeAll(),this.primitive=n,this.createPrimitive=!1}else if(Object(u.a)(n)&&n.ready){n.show=!0,Object(u.a)(this.oldPrimitive)&&(r.remove(this.oldPrimitive),this.oldPrimitive=void 0),this.appearanceType===DB&&(this.material=nU.getValue(e,this.materialProperty,this.material),this.primitive.appearance.material=this.material);var s=this.updatersWithAttributes.values,c=s.length;for(t=0;t<c;t++){var l=s[t],h=l.entity,d=this.geometry.get(l.id),f=this.attributes.get(d.id.id);if(Object(u.a)(f)||(f=n.getGeometryInstanceAttributes(d.id),this.attributes.set(d.id.id,f)),!l.fillMaterialProperty.isConstant){var p=l.fillMaterialProperty.color,m=aD.getValueOrDefault(p,e,uf.WHITE,uee);uf.equals(f._lastColor,m)||(f._lastColor=uf.clone(m,f._lastColor),f.color=df.toValue(m,f.color))}var _=h.isShowing&&(l.hasConstantFill||l.isFilled(e));_!==(1===f.show[0])&&(f.show=sA.toValue(_,f.show));var g=l.distanceDisplayConditionProperty;if(!aD.isConstant(g)){var v=aD.getValueOrDefault(g,e,dee,hee);gv.equals(v,f._lastDistanceDisplayCondition)||(f._lastDistanceDisplayCondition=gv.clone(v,f._lastDistanceDisplayCondition),f.distanceDisplayCondition=bv.toValue(v,f.distanceDisplayCondition))}}this.updateShows(n)}else Object(u.a)(n)&&!n.ready&&(i=!1);return i},fee.prototype.updateShows=function(e){for(var t=this.showsUpdated.values,i=t.length,n=0;n<i;n++){var r=t[n],a=r.entity,o=this.geometry.get(r.id),s=this.attributes.get(o.id.id);Object(u.a)(s)||(s=e.getGeometryInstanceAttributes(o.id),this.attributes.set(o.id.id,s));var c=a.isShowing;c!==(1===s.show[0])&&(s.show=sA.toValue(c,s.show),o.attributes.show.value[0]=s.show[0])}this.showsUpdated.removeAll()},fee.prototype.contains=function(e){return this.updaters.contains(e.id)},fee.prototype.getBoundingSphere=function(e,t){var i=this.primitive;if(!i.ready)return nD.PENDING;var n=i.getGeometryInstanceAttributes(e.entity);return!Object(u.a)(n)||!Object(u.a)(n.boundingSphere)||Object(u.a)(n.show)&&0===n.show[0]?nD.FAILED:(n.boundingSphere.clone(t),nD.DONE)},fee.prototype.destroy=function(){var e=this.primitive,t=this.orderedGroundPrimitives;Object(u.a)(e)&&t.remove(e);var i=this.oldPrimitive;Object(u.a)(i)&&t.remove(i),this.removeMaterialSubscription()},pee.prototype.add=function(e,t){for(var i=this._items,n=i.length,r=t.createFillGeometryInstance(e),a=aD.getValueOrDefault(t.zIndex,0),o=0;o<n;++o){var s=i[o];if(s.isMaterial(t)&&s.zIndex===a)return void s.add(e,t,r)}var c=new fee(this._orderedGroundPrimitives,this._classificationType,t.fillMaterialProperty,a,this._asynchronous);c.add(e,t,r),i.push(c)},pee.prototype.remove=function(e){for(var t=this._items,i=t.length-1;i>=0;i--){var n=t[i];if(n.remove(e)){0===n.updaters.length&&(t.splice(i,1),n.destroy());break}}},pee.prototype.update=function(e){var t,i=this._items;for(t=i.length-1;t>=0;t--){var n=i[t];if(n.invalidated){i.splice(t,1);for(var r=n.updaters.values,a=r.length,o=0;o<a;o++)this.add(e,r[o]);n.destroy()}}var s=!0;for(t=0;t<i.length;t++)s=i[t].update(e)&&s;return s},pee.prototype.getBoundingSphere=function(e,t){for(var i=this._items,n=i.length,r=0;r<n;r++){var a=i[r];if(a.contains(e))return a.getBoundingSphere(e,t)}return nD.FAILED},pee.prototype.removeAllPrimitives=function(){for(var e=this._items,t=e.length,i=0;i<t;i++)e[i].destroy();this._items.length=0};var mee=pee,_ee=[];function gee(e,t){for(var i=e._batches,n=i.length,r=0;r<n;r++)i[r].remove(t)}function vee(e,t,i){if(i.isDynamic)e._dynamicBatch.add(t,i);else if(i.clampToGround&&i.fillEnabled){var n=i.classificationTypeProperty.getValue(t);e._groundBatches[n].add(t,i)}else{var r;i.fillEnabled&&(r=i.shadowsProperty.getValue(t));var a,o=0;Object(u.a)(i.depthFailMaterialProperty)&&(o=i.depthFailMaterialProperty instanceof oM?1:2),Object(u.a)(r)&&(a=r+o*rM.NUMBER_OF_SHADOW_MODES),i.fillEnabled&&(i.fillMaterialProperty instanceof oM?e._colorBatches[a].add(t,i):e._materialBatches[a].add(t,i))}}function bee(e,t,i,n){var r;x.a.defined("scene",e),x.a.defined("entityCollection",t),n=Object(w.a)(n,e.groundPrimitives),i=Object(w.a)(i,e.primitives),this._scene=e,this._primitives=i,this._entityCollection=void 0,this._addedObjects=new Fi,this._removedObjects=new Fi,this._changedObjects=new Fi;var a=rM.NUMBER_OF_SHADOW_MODES;for(this._colorBatches=new Array(3*a),this._materialBatches=new Array(3*a),r=0;r<a;++r)this._colorBatches[r]=new e7(i,TB,void 0,!1,r),this._materialBatches[r]=new c7(i,DB,void 0,!1,r),this._colorBatches[r+a]=new e7(i,TB,TB,!1,r),this._materialBatches[r+a]=new c7(i,DB,TB,!1,r),this._colorBatches[r+2*a]=new e7(i,TB,DB,!1,r),this._materialBatches[r+2*a]=new c7(i,DB,DB,!1,r);this._dynamicBatch=new k6(i,n);var o=iM.NUMBER_OF_CLASSIFICATION_TYPES;for(this._groundBatches=new Array(o),r=0;r<o;++r)this._groundBatches[r]=new mee(n,r);this._batches=this._colorBatches.concat(this._materialBatches,this._dynamicBatch,this._groundBatches),this._subscriptions=new Fi,this._updaters=new Fi,this._entityCollection=t,t.collectionChanged.addEventListener(bee.prototype._onCollectionChanged,this),this._onCollectionChanged(t,t.values,_ee)}bee.prototype.update=function(e){x.a.defined("time",e);var t,i,n,r,a=this._addedObjects,o=a.values,s=this._removedObjects,c=s.values,l=this._changedObjects,u=l.values;for(t=u.length-1;t>-1;t--)n=(i=u[t]).id,(r=this._updaters.get(n)).entity===i?(gee(this,r),vee(this,e,r)):(c.push(i),o.push(i));for(t=c.length-1;t>-1;t--)n=(i=c[t]).id,gee(this,r=this._updaters.get(n)),r.destroy(),this._updaters.remove(n),this._subscriptions.get(n)(),this._subscriptions.remove(n);for(t=o.length-1;t>-1;t--)n=(i=o[t]).id,r=new lee(i,this._scene),this._updaters.set(n,r),vee(this,e,r),this._subscriptions.set(n,r.geometryChanged.addEventListener(bee._onGeometryChanged,this));a.removeAll(),s.removeAll(),l.removeAll();var h=!0,d=this._batches,f=d.length;for(t=0;t<f;t++)h=d[t].update(e)&&h;return h};var yee=[],wee=new St;bee.prototype.getBoundingSphere=function(e,t){x.a.defined("entity",e),x.a.defined("result",t);for(var i=yee,n=wee,r=0,a=nD.DONE,o=this._batches,s=o.length,c=this._updaters.get(e.id),l=0;l<s;l++){if((a=o[l].getBoundingSphere(c,n))===nD.PENDING)return nD.PENDING;a===nD.DONE&&(i[r]=St.clone(n,i[r]),r++)}return 0===r?nD.FAILED:(i.length=r,St.fromBoundingSpheres(i,t),nD.DONE)},bee.prototype.isDestroyed=function(){return!1},bee.prototype.destroy=function(){var e;this._entityCollection.collectionChanged.removeEventListener(bee.prototype._onCollectionChanged,this),this._addedObjects.removeAll(),this._removedObjects.removeAll();var t=this._batches,i=t.length;for(e=0;e<i;e++)t[e].removeAllPrimitives();var n=this._subscriptions.values;for(i=n.length,e=0;e<i;e++)n[e]();return this._subscriptions.removeAll(),rl(this)},bee._onGeometryChanged=function(e){var t=this._removedObjects,i=this._changedObjects,n=e.entity,r=n.id;Object(u.a)(t.get(r))||Object(u.a)(i.get(r))||i.set(r,n)},bee.prototype._onCollectionChanged=function(e,t,i){var n,r,a,o=this._addedObjects,s=this._removedObjects,c=this._changedObjects;for(n=i.length-1;n>-1;n--)r=(a=i[n]).id,o.remove(r)||(s.set(r,a),c.remove(r));for(n=t.length-1;n>-1;n--)r=(a=t[n]).id,s.remove(r)?c.set(r,a):o.set(r,a)};var Oee=bee;function xee(e){x.a.typeOf.object("options",e),x.a.typeOf.object("options.scene",e.scene),x.a.typeOf.object("options.dataSourceCollection",e.dataSourceCollection),mB.initializeTerrainHeights(),LB.initializeTerrainHeights();var t=e.scene,i=e.dataSourceCollection;this._eventHelper=new eb,this._eventHelper.add(i.dataSourceAdded,this._onDataSourceAdded,this),this._eventHelper.add(i.dataSourceRemoved,this._onDataSourceRemoved,this),this._eventHelper.add(i.dataSourceMoved,this._onDataSourceMoved,this),this._dataSourceCollection=i,this._scene=t,this._visualizersCallback=Object(w.a)(e.visualizersCallback,xee.defaultVisualizersCallback);var n=!1,r=new R6,a=new R6;i.length>0&&(t.primitives.add(r),t.groundPrimitives.add(a),n=!0),this._primitives=r,this._groundPrimitives=a;for(var o=0,s=i.length;o<s;o++)this._onDataSourceAdded(i,i.get(o));var c,l,u=new Kq;if(this._onDataSourceAdded(void 0,u),this._defaultDataSource=u,!n){var h=this,d=function(){t.primitives.add(r),t.groundPrimitives.add(a),c(),l(),h._removeDefaultDataSoureListener=void 0,h._removeDataSourceCollectionListener=void 0};c=u.entities.collectionChanged.addEventListener(d),l=i.dataSourceAdded.addEventListener(d)}this._removeDefaultDataSoureListener=c,this._removeDataSourceCollectionListener=l,this._ready=!1}xee.defaultVisualizersCallback=function(e,t,i){var n=i.entities;return[new TD(t,n),new z7(e,n,i._primitives,i._groundPrimitives),new h9(t,n),new E9(e,n),new X9(t,n),new N9(e,n),new Oee(e,n,i._primitives,i._groundPrimitives)]},Object(O.a)(xee.prototype,{scene:{get:function(){return this._scene}},dataSources:{get:function(){return this._dataSourceCollection}},defaultDataSource:{get:function(){return this._defaultDataSource}},ready:{get:function(){return this._ready}}}),xee.prototype.isDestroyed=function(){return!1},xee.prototype.destroy=function(){this._eventHelper.removeAll();for(var e=this._dataSourceCollection,t=0,i=e.length;t<i;++t)this._onDataSourceRemoved(this._dataSourceCollection,e.get(t));return this._onDataSourceRemoved(void 0,this._defaultDataSource),Object(u.a)(this._removeDefaultDataSoureListener)?(this._removeDefaultDataSoureListener(),this._removeDataSourceCollectionListener()):(this._scene.primitives.remove(this._primitives),this._scene.groundPrimitives.remove(this._groundPrimitives)),rl(this)},xee.prototype.update=function(e){if(x.a.defined("time",e),!Xt.initialized)return this._ready=!1,!1;var t,i,n,r,a=!0,o=this._dataSourceCollection,s=o.length;for(t=0;t<s;t++){var c=o.get(t);for(Object(u.a)(c.update)&&(a=c.update(e)&&a),r=(n=c._visualizers).length,i=0;i<r;i++)a=n[i].update(e)&&a}for(r=(n=this._defaultDataSource._visualizers).length,i=0;i<r;i++)a=n[i].update(e)&&a;return this._ready=a,a};var Eee=[],Tee=new St;xee.prototype.getBoundingSphere=function(e,t,i){if(x.a.defined("entity",e),x.a.typeOf.bool("allowPartial",t),x.a.defined("result",i),!this._ready)return nD.PENDING;var n,r,a=this._defaultDataSource;if(!a.entities.contains(e)){a=void 0;var o=this._dataSourceCollection;for(r=o.length,n=0;n<r;n++){var s=o.get(n);if(s.entities.contains(e)){a=s;break}}}if(!Object(u.a)(a))return nD.FAILED;var c=Eee,l=Tee,h=0,d=nD.DONE,f=a._visualizers,p=f.length;for(n=0;n<p;n++){var m=f[n];if(Object(u.a)(m.getBoundingSphere)){if(d=f[n].getBoundingSphere(e,l),!t&&d===nD.PENDING)return nD.PENDING;d===nD.DONE&&(c[h]=St.clone(l,c[h]),h++)}}return 0===h?nD.FAILED:(c.length=h,St.fromBoundingSpheres(c,i),nD.DONE)},xee.prototype._onDataSourceAdded=function(e,t){var i=this._scene,n=this._primitives,r=this._groundPrimitives,a=n.add(new R6),o=r.add(new N6);t._primitives=a,t._groundPrimitives=o;var s=t.clustering;s._initialize(i),a.add(s),t._visualizers=this._visualizersCallback(i,s,t)},xee.prototype._onDataSourceRemoved=function(e,t){var i=this._primitives,n=this._groundPrimitives,r=t._primitives,a=t._groundPrimitives,o=t.clustering;r.remove(o);for(var s=t._visualizers,c=s.length,l=0;l<c;l++)s[l].destroy();i.remove(r),n.remove(a),t._visualizers=void 0},xee.prototype._onDataSourceMoved=function(e,t,i){var n=this._primitives,r=this._groundPrimitives,a=e._primitives,o=e._groundPrimitives;t===i+1?(n.raise(a),r.raise(o)):t===i-1?(n.lower(a),r.lower(o)):0===t?(n.lowerToBottom(a),r.lowerToBottom(o),n.raise(a),r.raise(o)):(n.raiseToTop(a),r.raiseToTop(o))};var Cee=xee,See=uf.WHITE,Aee=new Rt(0,.1);function Pee(e){e=Object(w.a)(e,w.a.EMPTY_OBJECT),this._definitionChanged=new $o.a,this._fluxMap=void 0,this._speed=void 0,this._m_Sample=void 0,this._direction=void 0,this._color=void 0,this._offset=void 0,this._factor=void 0,this.fluxMap=e.fluxMap,this.speed=e.speed,this.m_Sample=e.m_Sample,this.direction=e.direction,this.color=e.color,this.offset=e.offset,this.factor=e.factor}Object(O.a)(Pee.prototype,{isConstant:{get:function(){return aD.isConstant(this._color)}},definitionChanged:{get:function(){return this._definitionChanged}},fluxMap:KI("fluxMap"),speed:KI("speed"),m_Sample:KI("m_Sample"),direction:KI("direction"),color:KI("color"),offset:KI("offset"),factor:KI("factor")}),Pee.prototype.getType=function(e){return"Direction"},Pee.prototype.getValue=function(e,t){return Object(u.a)(t)||(t={}),t.fluxMap=aD.getValueOrClonedDefault(this._fluxMap,e,void 0,t.fluxMap),t.speed=aD.getValueOrClonedDefault(this._speed,e,.05,t.speed),t.sample=aD.getValueOrClonedDefault(this._m_Sample,e,5,t.m_Sample),t.direction=aD.getValueOrClonedDefault(this._direction,e,!0,t.direction),t.color=aD.getValueOrClonedDefault(this._color,e,See,t.color),t.offset=aD.getValueOrClonedDefault(this._offset,e,Aee,t.offset),t.factor=aD.getValueOrClonedDefault(this._factor,e,1,t.factor),t},Pee.prototype.equals=function(e){return this===e||e instanceof Pee&&aD.equals(this._color,e._color)&&aD.equals(this._speed,e._speed)&&aD.equals(this._m_Sample,e._m_Sample)&&aD.equals(this._direction,e._direction)&&aD.equals(this._length,e._length)&&aD.equals(this._factor,e._factor)};var Iee=Pee,Dee=new be,jee=new be,Mee=new be,Ree=new Be,Lee=new z,Nee=new z,Fee=new z,kee=new z,Bee=new z,zee=new z,Uee=new Tr,Vee=1.25;function Hee(e,t,i){x.a.defined("entity",e),x.a.defined("scene",t),this.entity=e,this.scene=t,this.ellipsoid=Object(w.a)(i,ae.WGS84),this.boundingSphere=void 0,this._lastEntity=void 0,this._mode=void 0,this._lastCartesian=new z,this._defaultOffset3D=void 0,this._offset3D=new z}Object(O.a)(Hee,{defaultOffset3D:{get:function(){return this._defaultOffset3D},set:function(e){this._defaultOffset3D=z.clone(e,new z)}}}),Hee.defaultOffset3D=new z(-14e3,3500,3500);var Gee=new xO,qee=new z;Hee.prototype.update=function(e,t){x.a.defined("time",e);var i=this.scene,n=this.ellipsoid,r=i.mode;if(r!==xF.MORPHING){var a=this.entity,o=a.position;if(Object(u.a)(o)){var s=a!==this._lastEntity,c=r!==this._mode,l=i.camera,h=s||c,d=!0;if(s){var f=a.viewFrom,p=Object(u.a)(f);if(!p&&Object(u.a)(t)){Gee.pitch=-I.PI_OVER_FOUR,Gee.range=0;var m=o.getValue(e,qee);if(Object(u.a)(m)){var _=2-1/Math.max(1,z.magnitude(m)/n.maximumRadius);Gee.pitch*=_}l.viewBoundingSphere(t,Gee),this.boundingSphere=t,h=!1,d=!1}else p&&Object(u.a)(f.getValue(e,this._offset3D))||z.clone(Hee._defaultOffset3D,this._offset3D)}else c||this._mode===xF.SCENE2D||z.clone(l.position,this._offset3D);this._lastEntity=a,this._mode=r,function(e,t,i,n,r,a,o){var s=e.scene.mode,c=r.getValue(a,e._lastCartesian);if(Object(u.a)(c)){var l,h,d,f,p,m,_=!1,g=!1;if(s===xF.SCENE3D){Tr.addSeconds(a,.001,Uee);var v=r.getValue(Uee,Lee);if(Object(u.a)(v)||(Tr.addSeconds(a,-.001,Uee),v=r.getValue(Uee,Lee),g=!0),Object(u.a)(v)){var b,y=xa.computeFixedToIcrfMatrix(a,Dee),w=xa.computeFixedToIcrfMatrix(Uee,jee);Object(u.a)(y)&&Object(u.a)(w)?b=be.transpose(y,Mee):(b=xa.computeTemeToPseudoFixedMatrix(a,Mee),y=be.transpose(b,Dee),w=xa.computeTemeToPseudoFixedMatrix(Uee,jee),be.transpose(w,w));var O=be.multiplyByVector(y,c,Bee),x=be.multiplyByVector(w,v,zee);z.subtract(O,x,kee);var E=1e3*z.magnitude(kee),T=I.GRAVITATIONALPARAMETER,C=-T/(E*E-2*T/z.magnitude(O));C<0||C>Vee*o.maximumRadius?(l=Nee,z.normalize(c,l),z.negate(l,l),d=z.clone(z.UNIT_Z,Fee),h=z.cross(d,l,Lee),z.magnitude(h)>I.EPSILON7&&(z.normalize(l,l),z.normalize(h,h),d=z.cross(l,h,Fee),z.normalize(d,d),_=!0)):z.equalsEpsilon(c,v,I.EPSILON7)||(d=Nee,z.normalize(O,d),z.normalize(x,x),h=z.cross(d,x,Fee),g&&(h=z.multiplyByScalar(h,-1,h)),z.equalsEpsilon(h,z.ZERO,I.EPSILON7)||(l=z.cross(h,d,Lee),be.multiplyByVector(b,l,l),be.multiplyByVector(b,h,h),be.multiplyByVector(b,d,d),z.normalize(l,l),z.normalize(h,h),z.normalize(d,d),_=!0))}}Object(u.a)(e.boundingSphere)&&(c=e.boundingSphere.center),n&&(f=z.clone(t.position,kee),p=z.clone(t.direction,Bee),m=z.clone(t.up,zee));var S=Ree;_?(S[0]=l.x,S[1]=l.y,S[2]=l.z,S[3]=0,S[4]=h.x,S[5]=h.y,S[6]=h.z,S[7]=0,S[8]=d.x,S[9]=d.y,S[10]=d.z,S[11]=0,S[12]=c.x,S[13]=c.y,S[14]=c.z,S[15]=0):xa.eastNorthUpToFixedFrame(c,o,S),t._setTransform(S),n&&(z.clone(f,t.position),z.clone(p,t.direction),z.clone(m,t.up),z.cross(p,m,t.right))}if(i){var A=s===xF.SCENE2D||z.equals(e._offset3D,z.ZERO)?void 0:e._offset3D;t.lookAtTransform(t.transform,A)}}(this,l,h,d,o,e,n)}}};var Wee,Yee,Xee=Hee,Zee={};
/**
@license
topojson - https://github.com/topojson/topojson

Copyright (c) 2012-2016, Michael Bostock
All rights reserved.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions are met:

* Redistributions of source code must retain the above copyright notice, this
  list of conditions and the following disclaimer.

* Redistributions in binary form must reproduce the above copyright notice,
  this list of conditions and the following disclaimer in the documentation
  and/or other materials provided with the distribution.

* The name Michael Bostock may not be used to endorse or promote products
  derived from this software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
DISCLAIMED. IN NO EVENT SHALL MICHAEL BOSTOCK BE LIABLE FOR ANY DIRECT,
INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
**/Wee=Zee,Yee=function(e){var t=function(e){return e},i=function(e){if(null==e)return t;var i,n,r=e.scale[0],a=e.scale[1],o=e.translate[0],s=e.translate[1];return function(e,t){t||(i=n=0);var c=2,l=e.length,u=new Array(l);for(u[0]=(i+=e[0])*r+o,u[1]=(n+=e[1])*a+s;c<l;)u[c]=e[c],++c;return u}},n=function(e){var t,n=i(e.transform),r=1/0,a=r,o=-r,s=-r;function c(e){(e=n(e))[0]<r&&(r=e[0]),e[0]>o&&(o=e[0]),e[1]<a&&(a=e[1]),e[1]>s&&(s=e[1])}function l(e){switch(e.type){case"GeometryCollection":e.geometries.forEach(l);break;case"Point":c(e.coordinates);break;case"MultiPoint":e.coordinates.forEach(c)}}for(t in e.arcs.forEach((function(e){for(var t,i=-1,c=e.length;++i<c;)(t=n(e[i],i))[0]<r&&(r=t[0]),t[0]>o&&(o=t[0]),t[1]<a&&(a=t[1]),t[1]>s&&(s=t[1])})),e.objects)l(e.objects[t]);return[r,a,o,s]},r=function(e,t){for(var i,n=e.length,r=n-t;r<--n;)i=e[r],e[r++]=e[n],e[n]=i},a=function(e,t){return"GeometryCollection"===t.type?{type:"FeatureCollection",features:t.geometries.map((function(t){return o(e,t)}))}:o(e,t)};function o(e,t){var i=t.id,n=t.bbox,r=null==t.properties?{}:t.properties,a=s(e,t);return null==i&&null==n?{type:"Feature",properties:r,geometry:a}:null==n?{type:"Feature",id:i,properties:r,geometry:a}:{type:"Feature",id:i,bbox:n,properties:r,geometry:a}}function s(e,t){var n=i(e.transform),a=e.arcs;function o(e,t){t.length&&t.pop();for(var i=a[e<0?~e:e],o=0,s=i.length;o<s;++o)t.push(n(i[o],o));e<0&&r(t,s)}function s(e){return n(e)}function c(e){for(var t=[],i=0,n=e.length;i<n;++i)o(e[i],t);return t.length<2&&t.push(t[0]),t}function l(e){for(var t=c(e);t.length<4;)t.push(t[0]);return t}function u(e){return e.map(l)}return function e(t){var i,n=t.type;switch(n){case"GeometryCollection":return{type:n,geometries:t.geometries.map(e)};case"Point":i=s(t.coordinates);break;case"MultiPoint":i=t.coordinates.map(s);break;case"LineString":i=c(t.arcs);break;case"MultiLineString":i=t.arcs.map(c);break;case"Polygon":i=u(t.arcs);break;case"MultiPolygon":i=t.arcs.map(u);break;default:return null}return{type:n,coordinates:i}}(t)}var c=function(e,t){var i={},n={},r={},a=[],o=-1;function s(e,t){for(var n in e){var r=e[n];delete t[r.start],delete r.start,delete r.end,r.forEach((function(e){i[e<0?~e:e]=1})),a.push(r)}}return t.forEach((function(i,n){var r,a=e.arcs[i<0?~i:i];a.length<3&&!a[1][0]&&!a[1][1]&&(r=t[++o],t[o]=i,t[n]=r)})),t.forEach((function(t){var i,a,o=function(t){var i,n=e.arcs[t<0?~t:t],r=n[0];return e.transform?(i=[0,0],n.forEach((function(e){i[0]+=e[0],i[1]+=e[1]}))):i=n[n.length-1],t<0?[i,r]:[r,i]}(t),s=o[0],c=o[1];if(i=r[s])if(delete r[i.end],i.push(t),i.end=c,a=n[c]){delete n[a.start];var l=a===i?i:i.concat(a);n[l.start=i.start]=r[l.end=a.end]=l}else n[i.start]=r[i.end]=i;else if(i=n[c])if(delete n[i.start],i.unshift(t),i.start=s,a=r[s]){delete r[a.end];var u=a===i?i:a.concat(i);n[u.start=a.start]=r[u.end=i.end]=u}else n[i.start]=r[i.end]=i;else n[(i=[t]).start=s]=r[i.end=c]=i})),s(r,n),s(n,r),t.forEach((function(e){i[e<0?~e:e]||a.push([e])})),a};function l(e,t,i){var n,r,a;if(arguments.length>1)n=function(e,t,i){var n,r=[],a=[];function o(e){var t=e<0?~e:e;(a[t]||(a[t]=[])).push({i:e,g:n})}function s(e){e.forEach(o)}function c(e){e.forEach(s)}return function e(t){switch(n=t,t.type){case"GeometryCollection":t.geometries.forEach(e);break;case"LineString":s(t.arcs);break;case"MultiLineString":case"Polygon":c(t.arcs);break;case"MultiPolygon":!function(e){e.forEach(c)}(t.arcs)}}(t),a.forEach(null==i?function(e){r.push(e[0].i)}:function(e){i(e[0].g,e[e.length-1].g)&&r.push(e[0].i)}),r}(0,t,i);else for(r=0,n=new Array(a=e.arcs.length);r<a;++r)n[r]=r;return{type:"MultiLineString",arcs:c(e,n)}}function u(e,t){var i={},n=[],r=[];function a(e){e.forEach((function(t){t.forEach((function(t){(i[t=t<0?~t:t]||(i[t]=[])).push(e)}))})),n.push(e)}function o(t){return function(e){for(var t,i=-1,n=e.length,r=e[n-1],a=0;++i<n;)t=r,r=e[i],a+=t[0]*r[1]-t[1]*r[0];return Math.abs(a)}(s(e,{type:"Polygon",arcs:[t]}).coordinates[0])}return t.forEach((function e(t){switch(t.type){case"GeometryCollection":t.geometries.forEach(e);break;case"Polygon":a(t.arcs);break;case"MultiPolygon":t.arcs.forEach(a)}})),n.forEach((function(e){if(!e._){var t=[],n=[e];for(e._=1,r.push(t);e=n.pop();)t.push(e),e.forEach((function(e){e.forEach((function(e){i[e<0?~e:e].forEach((function(e){e._||(e._=1,n.push(e))}))}))}))}})),n.forEach((function(e){delete e._})),{type:"MultiPolygon",arcs:r.map((function(t){var n,r=[];if(t.forEach((function(e){e.forEach((function(e){e.forEach((function(e){i[e<0?~e:e].length<2&&r.push(e)}))}))})),(n=(r=c(e,r)).length)>1)for(var a,s,l=1,u=o(r[0]);l<n;++l)(a=o(r[l]))>u&&(s=r[0],r[0]=r[l],r[l]=s,u=a);return r}))}}var h=function(e,t){for(var i=0,n=e.length;i<n;){var r=i+n>>>1;e[r]<t?i=r+1:n=r}return i},d=function(e){if(null==e)return t;var i,n,r=e.scale[0],a=e.scale[1],o=e.translate[0],s=e.translate[1];return function(e,t){t||(i=n=0);var c=2,l=e.length,u=new Array(l),h=Math.round((e[0]-o)/r),d=Math.round((e[1]-s)/a);for(u[0]=h-i,i=h,u[1]=d-n,n=d;c<l;)u[c]=e[c],++c;return u}},f=function(e,t,i,n,r,a){3===arguments.length&&(n=a=Array,r=null);for(var o=new n(e=1<<Math.max(4,Math.ceil(Math.log(e)/Math.LN2))),s=new a(e),c=e-1,l=0;l<e;++l)o[l]=r;function u(n,a){for(var l=t(n)&c,u=o[l],h=0;u!=r;){if(i(u,n))return s[l]=a;if(++h>=e)throw new Error("full hashmap");u=o[l=l+1&c]}return o[l]=n,s[l]=a,a}function h(n,a){for(var l=t(n)&c,u=o[l],h=0;u!=r;){if(i(u,n))return s[l];if(++h>=e)throw new Error("full hashmap");u=o[l=l+1&c]}return o[l]=n,s[l]=a,a}function d(n,a){for(var l=t(n)&c,u=o[l],h=0;u!=r;){if(i(u,n))return s[l];if(++h>=e)break;u=o[l=l+1&c]}return a}function f(){for(var e=[],t=0,i=o.length;t<i;++t){var n=o[t];n!=r&&e.push(n)}return e}return{set:u,maybeSet:h,get:d,keys:f}},p=function(e,t){return e[0]===t[0]&&e[1]===t[1]},m=new ArrayBuffer(16),_=new Uint32Array(m),g=function(e){var t=_[0]^_[1];return 2147483647&(t=t<<5^t>>7^_[2]^_[3])},v=function(e){var t,i,n,r,a=e.coordinates,o=e.lines,s=e.rings,c=function(){for(var e=f(1.4*a.length,E,T,Int32Array,-1,Int32Array),t=new Int32Array(a.length),i=0,n=a.length;i<n;++i)t[i]=e.maybeSet(i,i);return t}(),l=new Int32Array(a.length),u=new Int32Array(a.length),h=new Int32Array(a.length),d=new Int8Array(a.length),m=0;for(t=0,i=a.length;t<i;++t)l[t]=u[t]=h[t]=-1;for(t=0,i=o.length;t<i;++t){var _=o[t],v=_[0],b=_[1];for(n=c[v],r=c[++v],++m,d[n]=1;++v<=b;)x(t,n,n=r,r=c[v]);++m,d[r]=1}for(t=0,i=a.length;t<i;++t)l[t]=-1;for(t=0,i=s.length;t<i;++t){var y=s[t],w=y[0]+1,O=y[1];for(x(t,c[O-1],n=c[w-1],r=c[w]);++w<=O;)x(t,n,n=r,r=c[w])}function x(e,t,i,n){if(l[i]!==e){l[i]=e;var r=u[i];if(r>=0){var a=h[i];r===t&&a===n||r===n&&a===t||(++m,d[i]=1)}else u[i]=t,h[i]=n}}function E(e){return g(a[e])}function T(e,t){return p(a[e],a[t])}l=u=h=null;var C,S=function(e,t,i,n,r){3===arguments.length&&(n=Array,r=null);for(var a=new n(e=1<<Math.max(4,Math.ceil(Math.log(e)/Math.LN2))),o=e-1,s=0;s<e;++s)a[s]=r;function c(n){for(var s=t(n)&o,c=a[s],l=0;c!=r;){if(i(c,n))return!0;if(++l>=e)throw new Error("full hashset");c=a[s=s+1&o]}return a[s]=n,!0}function l(n){for(var s=t(n)&o,c=a[s],l=0;c!=r;){if(i(c,n))return!0;if(++l>=e)break;c=a[s=s+1&o]}return!1}function u(){for(var e=[],t=0,i=a.length;t<i;++t){var n=a[t];n!=r&&e.push(n)}return e}return{add:c,has:l,values:u}}(1.4*m,g,p);for(t=0,i=a.length;t<i;++t)d[C=c[t]]&&S.add(a[C]);return S};function b(e,t,i){for(var n,r=t+(i---t>>1);t<r;++t,--i)n=e[t],e[t]=e[i],e[i]=n}var y=function(e){var t,i,n={};for(t in e)n[t]=null==(i=e[t])?{type:null}:("FeatureCollection"===i.type?w:"Feature"===i.type?O:x)(i);return n};function w(e){var t={type:"GeometryCollection",geometries:e.features.map(O)};return null!=e.bbox&&(t.bbox=e.bbox),t}function O(e){var t,i=x(e.geometry);for(t in null!=e.id&&(i.id=e.id),null!=e.bbox&&(i.bbox=e.bbox),e.properties){i.properties=e.properties;break}return i}function x(e){if(null==e)return{type:null};var t="GeometryCollection"===e.type?{type:"GeometryCollection",geometries:e.geometries.map(x)}:"Point"===e.type||"MultiPoint"===e.type?{type:e.type,coordinates:e.coordinates}:{type:e.type,arcs:e.coordinates};return null!=e.bbox&&(t.bbox=e.bbox),t}function E(e){var t,i=e[0],n=e[1];return n<i&&(t=i,i=n,n=t),i+31*n}function T(e,t){var i,n=e[0],r=e[1],a=t[0],o=t[1];return r<n&&(i=n,n=r,r=i),o<a&&(i=a,a=o,o=i),n===a&&r===o}function C(){return!0}function S(e){return e}function A(e){return null!=e.type}var P=function(e){var t,i=new Array(e.arcs.length),n=0;function r(e){switch(e.type){case"GeometryCollection":e.geometries.forEach(r);break;case"Polygon":a(e.arcs);break;case"MultiPolygon":e.arcs.forEach(a)}}function a(e){for(var t=0,r=e.length;t<r;++t,++n)for(var a=e[t],o=0,s=a.length;o<s;++o){var c=a[o];c<0&&(c=~c);var l=i[c];null==l?i[c]=n:l!==n&&(i[c]=-1)}}for(t in e.objects)r(e.objects[t]);return function(e){for(var t,n=0,r=e.length;n<r;++n)if(-1===i[(t=e[n])<0?~t:t])return!0;return!1}};function I(e){var t=e[0],i=e[1],n=e[2];return Math.abs((t[0]-n[0])*(i[1]-t[1])-(t[0]-i[0])*(n[1]-t[1]))/2}function D(e){for(var t,i=-1,n=e.length,r=e[n-1],a=0;++i<n;)t=r,r=e[i],a+=t[0]*r[1]-t[1]*r[0];return Math.abs(a)/2}var j=function(e,t,i){return t=null==t?Number.MIN_VALUE:+t,null==i&&(i=D),function(n,r){return i(a(e,{type:"Polygon",arcs:[n]}).geometry.coordinates[0],r)>=t}};function M(e,t){return e[1][2]-t[1][2]}function R(e){return[e[0],e[1],0]}function L(e,t){return t-e}var N=Math.PI,F=2*N,k=N/4,B=N/180,z=Math.abs,U=Math.atan2,V=Math.cos,H=Math.sin;function G(e,t){for(var i,n,r=0,a=e.length,o=0,s=e[t?r++:a-1],c=s[0]*B,l=s[1]*B/2+k,u=V(l),h=H(l);r<a;++r){i=c,c=(s=e[r])[0]*B,l=s[1]*B/2+k,n=u,u=V(l);var d=c-i,f=d>=0?1:-1,p=f*d,m=h*(h=H(l)),_=n*u+m*V(p),g=m*f*H(p);o+=U(g,_)}return o}e.bbox=n,e.feature=a,e.mesh=function(e){return s(e,l.apply(this,arguments))},e.meshArcs=l,e.merge=function(e){return s(e,u.apply(this,arguments))},e.mergeArcs=u,e.neighbors=function(e){var t={},i=e.map((function(){return[]}));function n(e,i){e.forEach((function(e){e<0&&(e=~e);var n=t[e];n?n.push(i):t[e]=[i]}))}function r(e,t){e.forEach((function(e){n(e,t)}))}var a={LineString:n,MultiLineString:r,Polygon:r,MultiPolygon:function(e,t){e.forEach((function(e){r(e,t)}))}};for(var o in e.forEach((function e(t,i){"GeometryCollection"===t.type?t.geometries.forEach((function(t){e(t,i)})):t.type in a&&a[t.type](t.arcs,i)})),t)for(var s=t[o],c=s.length,l=0;l<c;++l)for(var u=l+1;u<c;++u){var d,f=s[l],p=s[u];(d=i[f])[o=h(d,p)]!==p&&d.splice(o,0,p),(d=i[p])[o=h(d,f)]!==f&&d.splice(o,0,f)}return i},e.quantize=function(e,t){if(e.transform)throw new Error("already quantized");if(t&&t.scale)c=e.bbox;else{if(!((i=Math.floor(t))>=2))throw new Error("n must be ≥2");var i,r=(c=e.bbox||n(e))[0],a=c[1],o=c[2],s=c[3];t={scale:[o-r?(o-r)/(i-1):1,s-a?(s-a)/(i-1):1],translate:[r,a]}}var c,l,u=d(t),h=e.objects,f={};function p(e){return u(e)}function m(e){var t;switch(e.type){case"GeometryCollection":t={type:"GeometryCollection",geometries:e.geometries.map(m)};break;case"Point":t={type:"Point",coordinates:p(e.coordinates)};break;case"MultiPoint":t={type:"MultiPoint",coordinates:e.coordinates.map(p)};break;default:return e}return null!=e.id&&(t.id=e.id),null!=e.bbox&&(t.bbox=e.bbox),null!=e.properties&&(t.properties=e.properties),t}for(l in h)f[l]=m(h[l]);return{type:"Topology",bbox:c,transform:t,objects:f,arcs:e.arcs.map((function(e){var t,i=0,n=1,r=e.length,a=new Array(r);for(a[0]=u(e[0],0);++i<r;)((t=u(e[i],i))[0]||t[1])&&(a[n++]=t);return 1===n&&(a[n++]=[0,0]),a.length=n,a}))}},e.transform=i,e.untransform=d,e.topology=function(e,t){var i=function(e){var t=1/0,i=1/0,n=-1/0,r=-1/0;function a(e){null!=e&&o.hasOwnProperty(e.type)&&o[e.type](e)}var o={GeometryCollection:function(e){e.geometries.forEach(a)},Point:function(e){s(e.coordinates)},MultiPoint:function(e){e.coordinates.forEach(s)},LineString:function(e){c(e.arcs)},MultiLineString:function(e){e.arcs.forEach(c)},Polygon:function(e){e.arcs.forEach(c)},MultiPolygon:function(e){e.arcs.forEach(l)}};function s(e){var a=e[0],o=e[1];a<t&&(t=a),a>n&&(n=a),o<i&&(i=o),o>r&&(r=o)}function c(e){e.forEach(s)}function l(e){e.forEach(c)}for(var u in e)a(e[u]);return n>=t&&r>=i?[t,i,n,r]:void 0}(e=y(e)),n=t>0&&i&&function(e,t,i){var n=t[0],r=t[1],a=t[2],o=t[3],s=a-n?(i-1)/(a-n):1,c=o-r?(i-1)/(o-r):1;function l(e){return[Math.round((e[0]-n)*s),Math.round((e[1]-r)*c)]}function u(e,t){for(var i,a,o,l,u,h=-1,d=0,f=e.length,p=new Array(f);++h<f;)i=e[h],l=Math.round((i[0]-n)*s),u=Math.round((i[1]-r)*c),l===a&&u===o||(p[d++]=[a=l,o=u]);for(p.length=d;d<t;)d=p.push([p[0][0],p[0][1]]);return p}function h(e){return u(e,2)}function d(e){return u(e,4)}function f(e){return e.map(d)}function p(e){null!=e&&m.hasOwnProperty(e.type)&&m[e.type](e)}var m={GeometryCollection:function(e){e.geometries.forEach(p)},Point:function(e){e.coordinates=l(e.coordinates)},MultiPoint:function(e){e.coordinates=e.coordinates.map(l)},LineString:function(e){e.arcs=h(e.arcs)},MultiLineString:function(e){e.arcs=e.arcs.map(h)},Polygon:function(e){e.arcs=f(e.arcs)},MultiPolygon:function(e){e.arcs=e.arcs.map(f)}};for(var _ in e)p(e[_]);return{scale:[1/s,1/c],translate:[n,r]}}(e,i,t),r=function(e){var t,i,n,r,a=e.coordinates,o=e.lines,s=e.rings,c=o.length+s.length;for(delete e.lines,delete e.rings,n=0,r=o.length;n<r;++n)for(t=o[n];t=t.next;)++c;for(n=0,r=s.length;n<r;++n)for(i=s[n];i=i.next;)++c;var l=f(2*c*1.4,g,p),u=e.arcs=[];for(n=0,r=o.length;n<r;++n){t=o[n];do{h(t)}while(t=t.next)}for(n=0,r=s.length;n<r;++n)if((i=s[n]).next)do{h(i)}while(i=i.next);else d(i);function h(e){var t,i,n,r,o,s,c,h;if(n=l.get(t=a[e[0]]))for(c=0,h=n.length;c<h;++c)if(m(r=n[c],e))return e[0]=r[0],void(e[1]=r[1]);if(o=l.get(i=a[e[1]]))for(c=0,h=o.length;c<h;++c)if(_(s=o[c],e))return e[1]=s[0],void(e[0]=s[1]);n?n.push(e):l.set(t,[e]),o?o.push(e):l.set(i,[e]),u.push(e)}function d(e){var t,i,n,r,o;if(i=l.get(a[e[0]]))for(r=0,o=i.length;r<o;++r){if(v(n=i[r],e))return e[0]=n[0],void(e[1]=n[1]);if(b(n,e))return e[0]=n[1],void(e[1]=n[0])}if(i=l.get(t=a[e[0]+y(e)]))for(r=0,o=i.length;r<o;++r){if(v(n=i[r],e))return e[0]=n[0],void(e[1]=n[1]);if(b(n,e))return e[0]=n[1],void(e[1]=n[0])}i?i.push(e):l.set(t,[e]),u.push(e)}function m(e,t){var i=e[0],n=t[0],r=e[1];if(i-r!=n-t[1])return!1;for(;i<=r;++i,++n)if(!p(a[i],a[n]))return!1;return!0}function _(e,t){var i=e[0],n=t[0],r=e[1],o=t[1];if(i-r!=n-o)return!1;for(;i<=r;++i,--o)if(!p(a[i],a[o]))return!1;return!0}function v(e,t){var i=e[0],n=t[0],r=e[1]-i;if(r!==t[1]-n)return!1;for(var o=y(e),s=y(t),c=0;c<r;++c)if(!p(a[i+(c+o)%r],a[n+(c+s)%r]))return!1;return!0}function b(e,t){var i=e[0],n=t[0],r=e[1],o=t[1],s=r-i;if(s!==o-n)return!1;for(var c=y(e),l=s-y(t),u=0;u<s;++u)if(!p(a[i+(u+c)%s],a[o-(u+l)%s]))return!1;return!0}function y(e){for(var t=e[0],i=e[1],n=t,r=n,o=a[n];++n<i;){var s=a[n];(s[0]<o[0]||s[0]===o[0]&&s[1]<o[1])&&(r=n,o=s)}return r-t}return e}(function(e){var t,i,n,r,a,o,s,c=v(e),l=e.coordinates,u=e.lines,h=e.rings;for(i=0,n=u.length;i<n;++i)for(var d=u[i],f=d[0],p=d[1];++f<p;)c.has(l[f])&&(t={0:f,1:d[1]},d[1]=f,d=d.next=t);for(i=0,n=h.length;i<n;++i)for(var m=h[i],_=m[0],g=_,y=m[1],w=c.has(l[_]);++g<y;)c.has(l[g])&&(w?(t={0:g,1:m[1]},m[1]=g,m=m.next=t):(s=y-g,b(r=l,a=_,o=y),b(r,a,a+s),b(r,a+s,o),l[y]=l[_],w=!0,g=_));return e}(function(e){var t=-1,i=[],n=[],r=[];function a(e){e&&o.hasOwnProperty(e.type)&&o[e.type](e)}var o={GeometryCollection:function(e){e.geometries.forEach(a)},LineString:function(e){e.arcs=s(e.arcs)},MultiLineString:function(e){e.arcs=e.arcs.map(s)},Polygon:function(e){e.arcs=e.arcs.map(c)},MultiPolygon:function(e){e.arcs=e.arcs.map(l)}};function s(e){for(var n=0,a=e.length;n<a;++n)r[++t]=e[n];var o={0:t-a+1,1:t};return i.push(o),o}function c(e){for(var i=0,a=e.length;i<a;++i)r[++t]=e[i];var o={0:t-a+1,1:t};return n.push(o),o}function l(e){return e.map(c)}for(var u in e)a(e[u]);return{type:"Topology",coordinates:r,lines:i,rings:n,objects:e}}(e))),a=r.coordinates,o=f(1.4*r.arcs.length,E,T);function s(e){e&&c.hasOwnProperty(e.type)&&c[e.type](e)}e=r.objects,r.bbox=i,r.arcs=r.arcs.map((function(e,t){return o.set(e,t),a.slice(e[0],e[1]+1)})),delete r.coordinates,a=null;var c={GeometryCollection:function(e){e.geometries.forEach(s)},LineString:function(e){e.arcs=l(e.arcs)},MultiLineString:function(e){e.arcs=e.arcs.map(l)},Polygon:function(e){e.arcs=e.arcs.map(l)},MultiPolygon:function(e){e.arcs=e.arcs.map(u)}};function l(e){var t=[];do{var i=o.get(e);t.push(e[0]<e[1]?i:~i)}while(e=e.next);return t}function u(e){return e.map(l)}for(var h in e)s(e[h]);return n&&(r.transform=n,r.arcs=function(e){for(var t=-1,i=e.length;++t<i;){for(var n,r,a=e[t],o=0,s=1,c=a.length,l=a[0],u=l[0],h=l[1];++o<c;)n=(l=a[o])[0],r=l[1],n===u&&r===h||(a[s++]=[n-u,r-h],u=n,h=r);1===s&&(a[s++]=[0,0]),a.length=s}return e}(r.arcs)),r},e.filter=function(e,t){var i,n=e.objects,r={};function a(e){var t,i;switch(e.type){case"Polygon":t=(i=o(e.arcs))?{type:"Polygon",arcs:i}:{type:null};break;case"MultiPolygon":t=(i=e.arcs.map(o).filter(S)).length?{type:"MultiPolygon",arcs:i}:{type:null};break;case"GeometryCollection":t=(i=e.geometries.map(a).filter(A)).length?{type:"GeometryCollection",geometries:i}:{type:null};break;default:return e}return null!=e.id&&(t.id=e.id),null!=e.bbox&&(t.bbox=e.bbox),null!=e.properties&&(t.properties=e.properties),t}function o(e){return e.length&&(i=e[0],t(i,!1))?[e[0]].concat(e.slice(1).filter(s)):null;var i}function s(e){return t(e,!0)}for(i in null==t&&(t=C),n)r[i]=a(n[i]);return function(e){var t,i,n=e.objects,r={},a=e.arcs,o=a.length,s=-1,c=new Array(o),l=0,u=-1;function h(e){switch(e.type){case"GeometryCollection":e.geometries.forEach(h);break;case"LineString":f(e.arcs);break;case"MultiLineString":case"Polygon":e.arcs.forEach(f);break;case"MultiPolygon":e.arcs.forEach(p)}}function d(e){e<0&&(e=~e),c[e]||(c[e]=1,++l)}function f(e){e.forEach(d)}function p(e){e.forEach(f)}function m(e){var t;switch(e.type){case"GeometryCollection":t={type:"GeometryCollection",geometries:e.geometries.map(m)};break;case"LineString":t={type:"LineString",arcs:g(e.arcs)};break;case"MultiLineString":t={type:"MultiLineString",arcs:e.arcs.map(g)};break;case"Polygon":t={type:"Polygon",arcs:e.arcs.map(g)};break;case"MultiPolygon":t={type:"MultiPolygon",arcs:e.arcs.map(v)};break;default:return e}return null!=e.id&&(t.id=e.id),null!=e.bbox&&(t.bbox=e.bbox),null!=e.properties&&(t.properties=e.properties),t}function _(e){return e<0?~c[~e]:c[e]}function g(e){return e.map(_)}function v(e){return e.map(g)}for(i in n)h(n[i]);for(t=new Array(l);++s<o;)c[s]&&(c[s]=++u,t[u]=a[s]);for(i in n)r[i]=m(n[i]);return{type:"Topology",bbox:e.bbox,transform:e.transform,objects:r,arcs:t}}({type:"Topology",bbox:e.bbox,transform:e.transform,objects:r,arcs:e.arcs})},e.filterAttached=P,e.filterAttachedWeight=function(e,t,i){var n=P(e),r=j(e,t,i);return function(e,t){return n(e,t)||r(e,t)}},e.filterWeight=j,e.planarRingArea=D,e.planarTriangleArea=I,e.presimplify=function(e,t){var n=e.transform?i(e.transform):R,r=function(){var e={},t=[],i=0;function n(e,i){for(;i>0;){var n=(i+1>>1)-1,r=t[n];if(M(e,r)>=0)break;t[r._=i]=r,t[e._=i=n]=e}}function r(e,n){for(;;){var r=n+1<<1,a=r-1,o=n,s=t[o];if(a<i&&M(t[a],s)<0&&(s=t[o=a]),r<i&&M(t[r],s)<0&&(s=t[o=r]),o===n)break;t[s._=n]=s,t[e._=n=o]=e}}return e.push=function(e){return n(t[e._=i]=e,i++),i},e.pop=function(){if(!(i<=0)){var e,n=t[0];return--i>0&&(e=t[i],r(t[e._=0]=e,0)),n}},e.remove=function(e){var a,o=e._;if(t[o]===e)return o!==--i&&(M(a=t[i],e)<0?n:r)(t[a._=o]=a,o),o},e}();null==t&&(t=I);var a=e.arcs.map((function(e){var i,a,s,c=[],l=0;for(a=1,s=(e=e.map(n)).length-1;a<s;++a)(i=[e[a-1],e[a],e[a+1]])[1][2]=t(i),c.push(i),r.push(i);for(e[0][2]=e[s][2]=1/0,a=0,s=c.length;a<s;++a)(i=c[a]).previous=c[a-1],i.next=c[a+1];for(;i=r.pop();){var u=i.previous,h=i.next;i[1][2]<l?i[1][2]=l:l=i[1][2],u&&(u.next=h,u[2]=i[2],o(u)),h&&(h.previous=u,h[0]=i[0],o(h))}return e}));function o(e){r.remove(e),e[1][2]=t(e),r.push(e)}return{type:"Topology",bbox:e.bbox,objects:e.objects,arcs:a}},e.quantile=function(e,t){var i=[];return e.arcs.forEach((function(e){e.forEach((function(e){isFinite(e[2])&&i.push(e[2])}))})),i.length&&function(e,t){if(i=e.length){if((t=+t)<=0||i<2)return e[0];if(t>=1)return e[i-1];var i,n=(i-1)*t,r=Math.floor(n),a=e[r],o=e[r+1];return a+(o-a)*(n-r)}}(i.sort(L),t)},e.simplify=function(e,t){t=null==t?Number.MIN_VALUE:+t;var i=e.arcs.map((function(e){for(var i,n=-1,r=0,a=e.length,o=new Array(a);++n<a;)(i=e[n])[2]>=t&&(o[r++]=[i[0],i[1]]);return o.length=r,o}));return{type:"Topology",transform:e.transform,bbox:e.bbox,objects:e.objects,arcs:i}},e.sphericalRingArea=function(e,t){var i=G(e,!0);return t&&(i*=-1),2*(i<0?F+i:i)},e.sphericalTriangleArea=function(e){return 2*z(G(e,!1))},Object.defineProperty(e,"__esModule",{value:!0})},"object"==typeof exports&&void 0!==e?Yee(exports):Yee(Wee.topojson=Wee.topojson||{});var Qee=Zee.topojson;function Kee(e){return z.fromDegrees(e[0],e[1],e[2])}var Jee,$ee={"urn:ogc:def:crs:OGC:1.3:CRS84":Kee,"EPSG:4326":Kee,"urn:ogc:def:crs:EPSG::4326":Kee},ete={},tte={},ite=48,nte=uf.ROYALBLUE,rte=uf.YELLOW,ate=2,ote=uf.fromBytes(255,255,0,100),ste=!1,cte={small:24,medium:48,large:64},lte=["title","description","marker-size","marker-symbol","marker-color","stroke","stroke-opacity","stroke-width","fill","fill-opacity"];function ute(e,t){var i="";for(var n in e)if(e.hasOwnProperty(n)){if(n===t||-1!==lte.indexOf(n))continue;var r=e[n];Object(u.a)(r)&&(i+="object"==typeof r?"<tr><th>"+n+"</th><td>"+ute(r)+"</td></tr>":"<tr><th>"+n+"</th><td>"+r+"</td></tr>")}return i.length>0&&(i='<table class="cesium-infoBox-defaultTable"><tbody>'+i+"</tbody></table>"),i}function hte(e,t){return new tM(function(e,t,i){var n;return function(r,a){return Object(u.a)(n)||(n=e(t,i)),n}}(ute,e,t),!0)}function dte(e,t,i){var n=e.id;if(Object(u.a)(n)&&"Feature"===e.type){for(var r=2,a=n;Object(u.a)(t.getById(a));)a=n+"_"+r,r++;n=a}else n=Mg();var o=t.getOrCreateEntity(n),s=e.properties;if(Object(u.a)(s)){var c;o.properties=s;var l=s.title;if(Object(u.a)(l))o.name=l,c="title";else{var h=Number.MAX_VALUE;for(var d in s)if(s.hasOwnProperty(d)&&s[d]){var f=d.toLowerCase();if(h>1&&"title"===f){h=1,c=d;break}h>2&&"name"===f?(h=2,c=d):h>3&&/title/i.test(d)?(h=3,c=d):h>4&&/name/i.test(d)&&(h=4,c=d)}Object(u.a)(c)&&(o.name=s[c])}var p=s.description;null!==p&&(o.description=Object(u.a)(p)?new ZI(p):i(s,c))}return o}function fte(e,t){for(var i=new Array(e.length),n=0;n<e.length;n++)i[n]=t(e[n]);return i}var pte={Feature:_te,FeatureCollection:function(e,t,i,n,r){for(var a=t.features,o=0,s=a.length;o<s;o++)_te(e,a[o],void 0,n,r)},GeometryCollection:gte,LineString:Ote,MultiLineString:xte,MultiPoint:yte,MultiPolygon:Cte,Point:bte,Polygon:Tte,Topology:Ste},mte={GeometryCollection:gte,LineString:Ote,MultiLineString:xte,MultiPoint:yte,MultiPolygon:Cte,Point:bte,Polygon:Tte,Topology:Ste};function _te(e,t,i,n,r){if(null!==t.geometry){if(!Object(u.a)(t.geometry))throw new Ce.a("feature.geometry is required.");var a=t.geometry.type,o=mte[a];if(!Object(u.a)(o))throw new Ce.a("Unknown geometry type: "+a);o(e,t,t.geometry,n,r)}else dte(t,e._entityCollection,r.describe)}function gte(e,t,i,n,r){for(var a=i.geometries,o=0,s=a.length;o<s;o++){var c=a[o],l=c.type,h=mte[l];if(!Object(u.a)(h))throw new Ce.a("Unknown geometry type: "+l);h(e,t,c,n,r)}}function vte(e,t,i,n,r){var a,o=r.markerSymbol,s=r.markerColor,c=r.markerSize,l=t.properties;if(Object(u.a)(l)){var h=l["marker-color"];Object(u.a)(h)&&(s=uf.fromCssColorString(h)),c=Object(w.a)(cte[l["marker-size"]],c);var d=l["marker-symbol"];Object(u.a)(d)&&(o=d)}a=Object(u.a)(o)?1===o.length?e._pinBuilder.fromText(o.toUpperCase(),s,c):e._pinBuilder.fromMakiIconId(o,s,c):e._pinBuilder.fromColor(s,c);var f=new $I;f.verticalOrigin=new ZI(iD.BOTTOM),2===n.length&&r.clampToGround&&(f.heightReference=eD.CLAMP_TO_GROUND);var p=dte(t,e._entityCollection,r.describe);p.billboard=f,p.position=new XB(i(n));var m=Object(Oi.a)(a).then((function(e){f.image=new ZI(e)})).otherwise((function(){f.image=new ZI(e._pinBuilder.fromColor(s,c))}));e._promises.push(m)}function bte(e,t,i,n,r){vte(e,t,n,i.coordinates,r)}function yte(e,t,i,n,r){for(var a=i.coordinates,o=0;o<a.length;o++)vte(e,t,n,a[o],r)}function wte(e,t,i,n,r){var a=r.strokeMaterialProperty,o=r.strokeWidthProperty,s=t.properties;if(Object(u.a)(s)){var c,l=s["stroke-width"];Object(u.a)(l)&&(o=new ZI(l));var h=s.stroke;Object(u.a)(h)&&(c=uf.fromCssColorString(h));var d=s["stroke-opacity"];Object(u.a)(d)&&1!==d&&(Object(u.a)(c)||(c=a.color.clone()),c.alpha=d),Object(u.a)(c)&&(a=new oM(c))}var f=dte(t,e._entityCollection,r.describe),p=new Tz;f.polyline=p,p.clampToGround=r.clampToGround,p.material=a,p.width=o,p.positions=new ZI(fte(n,i)),p.arcType=Zt.RHUMB}function Ote(e,t,i,n,r){wte(e,t,n,i.coordinates,r)}function xte(e,t,i,n,r){for(var a=i.coordinates,o=0;o<a.length;o++)wte(e,t,n,a[o],r)}function Ete(e,t,i,n,r){if(0!==n.length&&0!==n[0].length){var a=r.strokeMaterialProperty.color,o=r.fillMaterialProperty,s=r.strokeWidthProperty,c=t.properties;if(Object(u.a)(c)){var l,h=c["stroke-width"];Object(u.a)(h)&&(s=new ZI(h));var d=c.stroke;Object(u.a)(d)&&(l=uf.fromCssColorString(d));var f,p=c["stroke-opacity"];Object(u.a)(p)&&1!==p&&(Object(u.a)(l)||(l=r.strokeMaterialProperty.color.clone()),l.alpha=p),Object(u.a)(l)&&(a=new ZI(l));var m=c.fill;Object(u.a)(m)&&((f=uf.fromCssColorString(m)).alpha=o.color.alpha),p=c["fill-opacity"],Object(u.a)(p)&&p!==o.color.alpha&&(Object(u.a)(f)||(f=o.color.clone()),f.alpha=p),Object(u.a)(f)&&(o=new oM(f))}var _=new xz;_.outline=new ZI(!0),_.outlineColor=a,_.outlineWidth=s,_.material=o,_.arcType=Zt.RHUMB;for(var g=[],v=1,b=n.length;v<b;v++)g.push(new uT(fte(n[v],i)));var y=n[0];_.hierarchy=new ZI(new uT(fte(y,i),g)),y[0].length>2?_.perPositionHeight=new ZI(!0):r.clampToGround||(_.height=0),dte(t,e._entityCollection,r.describe).polygon=_}}function Tte(e,t,i,n,r){Ete(e,t,n,i.coordinates,r)}function Cte(e,t,i,n,r){for(var a=i.coordinates,o=0;o<a.length;o++)Ete(e,t,n,a[o],r)}function Ste(e,t,i,n,r){for(var a in i.objects)if(i.objects.hasOwnProperty(a)){var o=Qee.feature(i,i.objects[a]);(0,pte[o.type])(e,o,o,n,r)}}function Ate(e){this._name=e,this._changed=new $o.a,this._error=new $o.a,this._isLoading=!1,this._loading=new $o.a,this._entityCollection=new OU(this),this._promises=[],this._pinBuilder=new gE,this._entityCluster=new Zq}Ate.load=function(e,t){return(new Ate).load(e,t)},Object(O.a)(Ate,{markerSize:{get:function(){return ite},set:function(e){ite=e}},markerSymbol:{get:function(){return Jee},set:function(e){Jee=e}},markerColor:{get:function(){return nte},set:function(e){nte=e}},stroke:{get:function(){return rte},set:function(e){rte=e}},strokeWidth:{get:function(){return ate},set:function(e){ate=e}},fill:{get:function(){return ote},set:function(e){ote=e}},clampToGround:{get:function(){return ste},set:function(e){ste=e}},crsNames:{get:function(){return $ee}},crsLinkHrefs:{get:function(){return ete}},crsLinkTypes:{get:function(){return tte}}}),Object(O.a)(Ate.prototype,{name:{get:function(){return this._name},set:function(e){this._name!==e&&(this._name=e,this._changed.raiseEvent(this))}},clock:{value:void 0,writable:!1},entities:{get:function(){return this._entityCollection}},isLoading:{get:function(){return this._isLoading}},changedEvent:{get:function(){return this._changed}},errorEvent:{get:function(){return this._error}},loadingEvent:{get:function(){return this._loading}},show:{get:function(){return this._entityCollection.show},set:function(e){this._entityCollection.show=e}},clustering:{get:function(){return this._entityCluster},set:function(e){if(!Object(u.a)(e))throw new h.a("value must be defined.");this._entityCluster=e}}}),Ate.prototype.load=function(e,t){if(!Object(u.a)(e))throw new h.a("data is required.");KU.setLoading(this,!0);var i=e,n=(t=Object(w.a)(t,w.a.EMPTY_OBJECT)).sourceUri;("string"==typeof e||e instanceof f.a)&&(i=(e=f.a.createIfNeeded(e)).fetchJson(),n=Object(w.a)(n,e.getUrlComponent())),t={describe:Object(w.a)(t.describe,hte),markerSize:Object(w.a)(t.markerSize,ite),markerSymbol:Object(w.a)(t.markerSymbol,Jee),markerColor:Object(w.a)(t.markerColor,nte),strokeWidthProperty:new ZI(Object(w.a)(t.strokeWidth,ate)),strokeMaterialProperty:new oM(Object(w.a)(t.stroke,rte)),fillMaterialProperty:new oM(Object(w.a)(t.fill,ote)),clampToGround:Object(w.a)(t.clampToGround,ste)};var r=this;return Object(Oi.a)(i,(function(e){return function(e,t,i,n){var r;Object(u.a)(n)&&(r=ay(n));Object(u.a)(r)&&e._name!==r&&(e._name=r,e._changed.raiseEvent(e));var a=pte[t.type];if(!Object(u.a)(a))throw new Ce.a("Unsupported GeoJSON object type: "+t.type);var o=t.crs,s=null!==o?Kee:null;if(Object(u.a)(o)){if(!Object(u.a)(o.properties))throw new Ce.a("crs.properties is undefined.");var c=o.properties;if("name"===o.type){if(s=$ee[c.name],!Object(u.a)(s))throw new Ce.a("Unknown crs name: "+c.name)}else if("link"===o.type){var l=ete[c.href];if(Object(u.a)(l)||(l=tte[c.type]),!Object(u.a)(l))throw new Ce.a("Unable to resolve crs link: "+JSON.stringify(c));s=l(c)}else{if("EPSG"!==o.type)throw new Ce.a("Unknown crs type: "+o.type);if(s=$ee["EPSG:"+c.code],!Object(u.a)(s))throw new Ce.a("Unknown crs EPSG code: "+c.code)}}return Object(Oi.a)(s,(function(n){return e._entityCollection.removeAll(),null!==n&&a(e,t,t,n,i),Oi.a.all(e._promises,(function(){return e._promises.length=0,KU.setLoading(e,!1),e}))}))}(r,e,t,n)})).otherwise((function(e){return KU.setLoading(r,!1),r._error.raiseEvent(r,e),console.log(e),Oi.a.reject(e)}))};var Pte=Ate;var Ite=function(e,t){this.position=e,this.headingPitchRoll=t},Dte={};
/*!
 * Autolinker.js
 * 3.11.0
 *
 * Copyright(c) 2019 Gregory Jacobs <greg@greg-jacobs.com>
 * MIT License
 *
 * https://github.com/gregjacobs/Autolinker.js
 */
!function(e,t){e.Autolinker=function(){function e(e,t){if(Array.prototype.indexOf)return e.indexOf(t);for(var i=0,n=e.length;i<n;i++)if(e[i]===t)return i;return-1}function t(e,t){for(var i=e.length-1;i>=0;i--)!0===t(e[i])&&e.splice(i,1)}function i(e){throw new Error("Unhandled case for value: '"+e+"'")}var n=function(){function t(e){void 0===e&&(e={}),this.tagName="",this.attrs={},this.innerHTML="",this.whitespaceRegex=/\s+/,this.tagName=e.tagName||"",this.attrs=e.attrs||{},this.innerHTML=e.innerHtml||e.innerHTML||""}return t.prototype.setTagName=function(e){return this.tagName=e,this},t.prototype.getTagName=function(){return this.tagName||""},t.prototype.setAttr=function(e,t){return this.getAttrs()[e]=t,this},t.prototype.getAttr=function(e){return this.getAttrs()[e]},t.prototype.setAttrs=function(e){return Object.assign(this.getAttrs(),e),this},t.prototype.getAttrs=function(){return this.attrs||(this.attrs={})},t.prototype.setClass=function(e){return this.setAttr("class",e)},t.prototype.addClass=function(t){for(var i,n=this.getClass(),r=this.whitespaceRegex,a=n?n.split(r):[],o=t.split(r);i=o.shift();)-1===e(a,i)&&a.push(i);return this.getAttrs().class=a.join(" "),this},t.prototype.removeClass=function(t){for(var i,n=this.getClass(),r=this.whitespaceRegex,a=n?n.split(r):[],o=t.split(r);a.length&&(i=o.shift());){var s=e(a,i);-1!==s&&a.splice(s,1)}return this.getAttrs().class=a.join(" "),this},t.prototype.getClass=function(){return this.getAttrs().class||""},t.prototype.hasClass=function(e){return-1!==(" "+this.getClass()+" ").indexOf(" "+e+" ")},t.prototype.setInnerHTML=function(e){return this.innerHTML=e,this},t.prototype.setInnerHtml=function(e){return this.setInnerHTML(e)},t.prototype.getInnerHTML=function(){return this.innerHTML||""},t.prototype.getInnerHtml=function(){return this.getInnerHTML()},t.prototype.toAnchorString=function(){var e=this.getTagName(),t=this.buildAttrsStr();return["<",e,t=t?" "+t:"",">",this.getInnerHtml(),"</",e,">"].join("")},t.prototype.buildAttrsStr=function(){if(!this.attrs)return"";var e=this.getAttrs(),t=[];for(var i in e)e.hasOwnProperty(i)&&t.push(i+'="'+e[i]+'"');return t.join(" ")},t}();var r=function(){function e(e){void 0===e&&(e={}),this.newWindow=!1,this.truncate={},this.className="",this.newWindow=e.newWindow||!1,this.truncate=e.truncate||{},this.className=e.className||""}return e.prototype.build=function(e){return new n({tagName:"a",attrs:this.createAttrs(e),innerHtml:this.processAnchorText(e.getAnchorText())})},e.prototype.createAttrs=function(e){var t={href:e.getAnchorHref()},i=this.createCssClass(e);return i&&(t.class=i),this.newWindow&&(t.target="_blank",t.rel="noopener noreferrer"),this.truncate&&this.truncate.length&&this.truncate.length<e.getAnchorText().length&&(t.title=e.getAnchorHref()),t},e.prototype.createCssClass=function(e){var t=this.className;if(t){for(var i=[t],n=e.getCssClassSuffixes(),r=0,a=n.length;r<a;r++)i.push(t+"-"+n[r]);return i.join(" ")}return""},e.prototype.processAnchorText=function(e){return e=this.doTruncate(e)},e.prototype.doTruncate=function(e){var t=this.truncate;if(!t||!t.length)return e;var i=t.length,n=t.location;return"smart"===n?function(e,t,i){var n,r;null==i?(i="&hellip;",r=3,n=8):(r=i.length,n=i.length);var a=function(e){var t="";return e.scheme&&e.host&&(t+=e.scheme+"://"),e.host&&(t+=e.host),e.path&&(t+="/"+e.path),e.query&&(t+="?"+e.query),e.fragment&&(t+="#"+e.fragment),t},o=function(e,t){var n=t/2,r=Math.ceil(n),a=-1*Math.floor(n),o="";return a<0&&(o=e.substr(a)),e.substr(0,r)+i+o};if(e.length<=t)return e;var s=t-r,c=function(e){var t={},i=e,n=i.match(/^([a-z]+):\/\//i);return n&&(t.scheme=n[1],i=i.substr(n[0].length)),(n=i.match(/^(.*?)(?=(\?|#|\/|$))/i))&&(t.host=n[1],i=i.substr(n[0].length)),(n=i.match(/^\/(.*?)(?=(\?|#|$))/i))&&(t.path=n[1],i=i.substr(n[0].length)),(n=i.match(/^\?(.*?)(?=(#|$))/i))&&(t.query=n[1],i=i.substr(n[0].length)),(n=i.match(/^#(.*?)$/i))&&(t.fragment=n[1]),t}(e);if(c.query){var l=c.query.match(/^(.*?)(?=(\?|\#))(.*?)$/i);l&&(c.query=c.query.substr(0,l[1].length),e=a(c))}if(e.length<=t)return e;if(c.host&&(c.host=c.host.replace(/^www\./,""),e=a(c)),e.length<=t)return e;var u="";if(c.host&&(u+=c.host),u.length>=s)return c.host.length==t?(c.host.substr(0,t-r)+i).substr(0,s+n):o(u,s).substr(0,s+n);var h="";if(c.path&&(h+="/"+c.path),c.query&&(h+="?"+c.query),h){if((u+h).length>=s)return(u+h).length==t?(u+h).substr(0,t):(u+o(h,s-u.length)).substr(0,s+n);u+=h}if(c.fragment){var d="#"+c.fragment;if((u+d).length>=s)return(u+d).length==t?(u+d).substr(0,t):(u+o(d,s-u.length)).substr(0,s+n);u+=d}if(c.scheme&&c.host){var f=c.scheme+"://";if((u+f).length<s)return(f+u).substr(0,t)}if(u.length<=t)return u;var p="";return s>0&&(p=u.substr(-1*Math.floor(s/2))),(u.substr(0,Math.ceil(s/2))+i+p).substr(0,s+n)}(e,i):"middle"===n?function(e,t,i){if(e.length<=t)return e;var n,r;null==i?(i="&hellip;",n=8,r=3):(n=i.length,r=i.length);var a=t-r,o="";return a>0&&(o=e.substr(-1*Math.floor(a/2))),(e.substr(0,Math.ceil(a/2))+i+o).substr(0,a+n)}(e,i):function(e,t,i){return function(e,t,i){var n;return e.length>t&&(null==i?(i="&hellip;",n=3):n=i.length,e=e.substring(0,t-n)+i),e}(e,t,i)}(e,i)},e}(),a=function(){function e(e){this.__jsduckDummyDocProp=null,this.matchedText="",this.offset=0,this.tagBuilder=e.tagBuilder,this.matchedText=e.matchedText,this.offset=e.offset}return e.prototype.getMatchedText=function(){return this.matchedText},e.prototype.setOffset=function(e){this.offset=e},e.prototype.getOffset=function(){return this.offset},e.prototype.getCssClassSuffixes=function(){return[this.getType()]},e.prototype.buildTag=function(){return this.tagBuilder.build(this)},e}(),o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)};function s(e,t){function i(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}var c=function(){return(c=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},l=function(e){function t(t){var i=e.call(this,t)||this;return i.email="",i.email=t.email,i}return s(t,e),t.prototype.getType=function(){return"email"},t.prototype.getEmail=function(){return this.email},t.prototype.getAnchorHref=function(){return"mailto:"+this.email},t.prototype.getAnchorText=function(){return this.email},t}(a),u=function(e){function t(t){var i=e.call(this,t)||this;return i.serviceName="",i.hashtag="",i.serviceName=t.serviceName,i.hashtag=t.hashtag,i}return s(t,e),t.prototype.getType=function(){return"hashtag"},t.prototype.getServiceName=function(){return this.serviceName},t.prototype.getHashtag=function(){return this.hashtag},t.prototype.getAnchorHref=function(){var e=this.serviceName,t=this.hashtag;switch(e){case"twitter":return"https://twitter.com/hashtag/"+t;case"facebook":return"https://www.facebook.com/hashtag/"+t;case"instagram":return"https://instagram.com/explore/tags/"+t;default:throw new Error("Unknown service name to point hashtag to: "+e)}},t.prototype.getAnchorText=function(){return"#"+this.hashtag},t}(a),h=function(e){function t(t){var i=e.call(this,t)||this;return i.serviceName="twitter",i.mention="",i.mention=t.mention,i.serviceName=t.serviceName,i}return s(t,e),t.prototype.getType=function(){return"mention"},t.prototype.getMention=function(){return this.mention},t.prototype.getServiceName=function(){return this.serviceName},t.prototype.getAnchorHref=function(){switch(this.serviceName){case"twitter":return"https://twitter.com/"+this.mention;case"instagram":return"https://instagram.com/"+this.mention;case"soundcloud":return"https://soundcloud.com/"+this.mention;default:throw new Error("Unknown service name to point mention to: "+this.serviceName)}},t.prototype.getAnchorText=function(){return"@"+this.mention},t.prototype.getCssClassSuffixes=function(){var t=e.prototype.getCssClassSuffixes.call(this),i=this.getServiceName();return i&&t.push(i),t},t}(a),d=function(e){function t(t){var i=e.call(this,t)||this;return i.number="",i.plusSign=!1,i.number=t.number,i.plusSign=t.plusSign,i}return s(t,e),t.prototype.getType=function(){return"phone"},t.prototype.getPhoneNumber=function(){return this.number},t.prototype.getNumber=function(){return this.getPhoneNumber()},t.prototype.getAnchorHref=function(){return"tel:"+(this.plusSign?"+":"")+this.number},t.prototype.getAnchorText=function(){return this.matchedText},t}(a),f=function(e){function t(t){var i=e.call(this,t)||this;return i.url="",i.urlMatchType="scheme",i.protocolUrlMatch=!1,i.protocolRelativeMatch=!1,i.stripPrefix={scheme:!0,www:!0},i.stripTrailingSlash=!0,i.decodePercentEncoding=!0,i.schemePrefixRegex=/^(https?:\/\/)?/i,i.wwwPrefixRegex=/^(https?:\/\/)?(www\.)?/i,i.protocolRelativeRegex=/^\/\//,i.protocolPrepended=!1,i.urlMatchType=t.urlMatchType,i.url=t.url,i.protocolUrlMatch=t.protocolUrlMatch,i.protocolRelativeMatch=t.protocolRelativeMatch,i.stripPrefix=t.stripPrefix,i.stripTrailingSlash=t.stripTrailingSlash,i.decodePercentEncoding=t.decodePercentEncoding,i}return s(t,e),t.prototype.getType=function(){return"url"},t.prototype.getUrlMatchType=function(){return this.urlMatchType},t.prototype.getUrl=function(){var e=this.url;return this.protocolRelativeMatch||this.protocolUrlMatch||this.protocolPrepended||(e=this.url="http://"+e,this.protocolPrepended=!0),e},t.prototype.getAnchorHref=function(){return this.getUrl().replace(/&amp;/g,"&")},t.prototype.getAnchorText=function(){var e=this.getMatchedText();return this.protocolRelativeMatch&&(e=this.stripProtocolRelativePrefix(e)),this.stripPrefix.scheme&&(e=this.stripSchemePrefix(e)),this.stripPrefix.www&&(e=this.stripWwwPrefix(e)),this.stripTrailingSlash&&(e=this.removeTrailingSlash(e)),this.decodePercentEncoding&&(e=this.removePercentEncoding(e)),e},t.prototype.stripSchemePrefix=function(e){return e.replace(this.schemePrefixRegex,"")},t.prototype.stripWwwPrefix=function(e){return e.replace(this.wwwPrefixRegex,"$1")},t.prototype.stripProtocolRelativePrefix=function(e){return e.replace(this.protocolRelativeRegex,"")},t.prototype.removeTrailingSlash=function(e){return"/"===e.charAt(e.length-1)&&(e=e.slice(0,-1)),e},t.prototype.removePercentEncoding=function(e){var t=e.replace(/%22/gi,"&quot;").replace(/%26/gi,"&amp;").replace(/%27/gi,"&#39;").replace(/%3C/gi,"&lt;").replace(/%3E/gi,"&gt;");try{return decodeURIComponent(t)}catch(e){return t}},t}(a),p=function(e){this.__jsduckDummyDocProp=null,this.tagBuilder=e.tagBuilder},m=/[A-Za-z]/,_=/[0-9]/,g=/\s/,v=/['"]/,b=/[\x00-\x1F\x7F]/,y=/A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC/.source,w=y+/\u00a9\u00ae\u2000-\u3300\ud83c\ud000-\udfff\ud83d\ud000-\udfff\ud83e\ud000-\udfff/.source+/\u0300-\u036F\u0483-\u0489\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u0711\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F3\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u08D4-\u08E1\u08E3-\u0903\u093A-\u093C\u093E-\u094F\u0951-\u0957\u0962\u0963\u0981-\u0983\u09BC\u09BE-\u09C4\u09C7\u09C8\u09CB-\u09CD\u09D7\u09E2\u09E3\u0A01-\u0A03\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A70\u0A71\u0A75\u0A81-\u0A83\u0ABC\u0ABE-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AE2\u0AE3\u0B01-\u0B03\u0B3C\u0B3E-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B62\u0B63\u0B82\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD7\u0C00-\u0C03\u0C3E-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C81-\u0C83\u0CBC\u0CBE-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CE2\u0CE3\u0D01-\u0D03\u0D3E-\u0D44\u0D46-\u0D48\u0D4A-\u0D4D\u0D57\u0D62\u0D63\u0D82\u0D83\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DF2\u0DF3\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EB9\u0EBB\u0EBC\u0EC8-\u0ECD\u0F18\u0F19\u0F35\u0F37\u0F39\u0F3E\u0F3F\u0F71-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102B-\u103E\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F\u109A-\u109D\u135D-\u135F\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17B4-\u17D3\u17DD\u180B-\u180D\u1885\u1886\u18A9\u1920-\u192B\u1930-\u193B\u1A17-\u1A1B\u1A55-\u1A5E\u1A60-\u1A7C\u1A7F\u1AB0-\u1ABE\u1B00-\u1B04\u1B34-\u1B44\u1B6B-\u1B73\u1B80-\u1B82\u1BA1-\u1BAD\u1BE6-\u1BF3\u1C24-\u1C37\u1CD0-\u1CD2\u1CD4-\u1CE8\u1CED\u1CF2-\u1CF4\u1CF8\u1CF9\u1DC0-\u1DF5\u1DFB-\u1DFF\u20D0-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302F\u3099\u309A\uA66F-\uA672\uA674-\uA67D\uA69E\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA823-\uA827\uA880\uA881\uA8B4-\uA8C5\uA8E0-\uA8F1\uA926-\uA92D\uA947-\uA953\uA980-\uA983\uA9B3-\uA9C0\uA9E5\uAA29-\uAA36\uAA43\uAA4C\uAA4D\uAA7B-\uAA7D\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEB-\uAAEF\uAAF5\uAAF6\uABE3-\uABEA\uABEC\uABED\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F/.source,O=/0-9\u0660-\u0669\u06F0-\u06F9\u07C0-\u07C9\u0966-\u096F\u09E6-\u09EF\u0A66-\u0A6F\u0AE6-\u0AEF\u0B66-\u0B6F\u0BE6-\u0BEF\u0C66-\u0C6F\u0CE6-\u0CEF\u0D66-\u0D6F\u0DE6-\u0DEF\u0E50-\u0E59\u0ED0-\u0ED9\u0F20-\u0F29\u1040-\u1049\u1090-\u1099\u17E0-\u17E9\u1810-\u1819\u1946-\u194F\u19D0-\u19D9\u1A80-\u1A89\u1A90-\u1A99\u1B50-\u1B59\u1BB0-\u1BB9\u1C40-\u1C49\u1C50-\u1C59\uA620-\uA629\uA8D0-\uA8D9\uA900-\uA909\uA9D0-\uA9D9\uA9F0-\uA9F9\uAA50-\uAA59\uABF0-\uABF9\uFF10-\uFF19/.source,x=w+O,E=w+O,T="(?:["+O+"]{1,3}\\.){3}["+O+"]{1,3}",C="["+E+"](?:["+E+"\\-]{0,61}["+E+"])?",S=function(e){return"(?=("+C+"))\\"+e},A=function(e){return"(?:"+S(e)+"(?:\\."+S(e+1)+"){0,126}|"+T+")"},P=new RegExp("["+E+"]"),I=/(?:xn--vermgensberatung-pwb|xn--vermgensberater-ctb|xn--clchc0ea0b2g2a9gcd|xn--w4r85el8fhu5dnra|northwesternmutual|travelersinsurance|vermögensberatung|xn--3oq18vl8pn36a|xn--5su34j936bgsg|xn--bck1b9a5dre4c|xn--mgbai9azgqp6j|xn--mgberp4a5d4ar|xn--xkc2dl3a5ee0h|vermögensberater|xn--fzys8d69uvgm|xn--mgba7c0bbn0a|xn--xkc2al3hye2a|americanexpress|kerryproperties|sandvikcoromant|xn--i1b6b1a6a2e|xn--kcrx77d1x4a|xn--lgbbat1ad8j|xn--mgba3a4f16a|xn--mgbaakc7dvf|xn--mgbc0a9azcg|xn--nqv7fs00ema|afamilycompany|americanfamily|bananarepublic|cancerresearch|cookingchannel|kerrylogistics|weatherchannel|xn--54b7fta0cc|xn--6qq986b3xl|xn--80aqecdr1a|xn--b4w605ferd|xn--fiq228c5hs|xn--h2breg3eve|xn--jlq61u9w7b|xn--mgba3a3ejt|xn--mgbaam7a8h|xn--mgbayh7gpa|xn--mgbb9fbpob|xn--mgbbh1a71e|xn--mgbca7dzdo|xn--mgbi4ecexp|xn--mgbx4cd0ab|xn--rvc1e0am3e|international|lifeinsurance|spreadbetting|travelchannel|wolterskluwer|xn--eckvdtc9d|xn--fpcrj9c3d|xn--fzc2c9e2c|xn--h2brj9c8c|xn--tiq49xqyj|xn--yfro4i67o|xn--ygbi2ammx|construction|lplfinancial|scholarships|versicherung|xn--3e0b707e|xn--45br5cyl|xn--80adxhks|xn--80asehdb|xn--8y0a063a|xn--gckr3f0f|xn--mgb9awbf|xn--mgbab2bd|xn--mgbgu82a|xn--mgbpl2fh|xn--mgbt3dhd|xn--mk1bu44c|xn--ngbc5azd|xn--ngbe9e0a|xn--ogbpf8fl|xn--qcka1pmc|accountants|barclaycard|blackfriday|blockbuster|bridgestone|calvinklein|contractors|creditunion|engineering|enterprises|foodnetwork|investments|kerryhotels|lamborghini|motorcycles|olayangroup|photography|playstation|productions|progressive|redumbrella|rightathome|williamhill|xn--11b4c3d|xn--1ck2e1b|xn--1qqw23a|xn--2scrj9c|xn--3bst00m|xn--3ds443g|xn--3hcrj9c|xn--42c2d9a|xn--45brj9c|xn--55qw42g|xn--6frz82g|xn--80ao21a|xn--9krt00a|xn--cck2b3b|xn--czr694b|xn--d1acj3b|xn--efvy88h|xn--estv75g|xn--fct429k|xn--fjq720a|xn--flw351e|xn--g2xx48c|xn--gecrj9c|xn--gk3at1e|xn--h2brj9c|xn--hxt814e|xn--imr513n|xn--j6w193g|xn--jvr189m|xn--kprw13d|xn--kpry57d|xn--kpu716f|xn--mgbbh1a|xn--mgbtx2b|xn--mix891f|xn--nyqy26a|xn--otu796d|xn--pbt977c|xn--pgbs0dh|xn--q9jyb4c|xn--rhqv96g|xn--rovu88b|xn--s9brj9c|xn--ses554g|xn--t60b56a|xn--vuq861b|xn--w4rs40l|xn--xhq521b|xn--zfr164b|சிங்கப்பூர்|accountant|apartments|associates|basketball|bnpparibas|boehringer|capitalone|consulting|creditcard|cuisinella|eurovision|extraspace|foundation|healthcare|immobilien|industries|management|mitsubishi|nationwide|newholland|nextdirect|onyourside|properties|protection|prudential|realestate|republican|restaurant|schaeffler|swiftcover|tatamotors|technology|telefonica|university|vistaprint|vlaanderen|volkswagen|xn--30rr7y|xn--3pxu8k|xn--45q11c|xn--4gbrim|xn--55qx5d|xn--5tzm5g|xn--80aswg|xn--90a3ac|xn--9dbq2a|xn--9et52u|xn--c2br7g|xn--cg4bki|xn--czrs0t|xn--czru2d|xn--fiq64b|xn--fiqs8s|xn--fiqz9s|xn--io0a7i|xn--kput3i|xn--mxtq1m|xn--o3cw4h|xn--pssy2u|xn--unup4y|xn--wgbh1c|xn--wgbl6a|xn--y9a3aq|accenture|alfaromeo|allfinanz|amsterdam|analytics|aquarelle|barcelona|bloomberg|christmas|community|directory|education|equipment|fairwinds|financial|firestone|fresenius|frontdoor|fujixerox|furniture|goldpoint|hisamitsu|homedepot|homegoods|homesense|honeywell|institute|insurance|kuokgroup|ladbrokes|lancaster|landrover|lifestyle|marketing|marshalls|melbourne|microsoft|panasonic|passagens|pramerica|richardli|scjohnson|shangrila|solutions|statebank|statefarm|stockholm|travelers|vacations|xn--90ais|xn--c1avg|xn--d1alf|xn--e1a4c|xn--fhbei|xn--j1aef|xn--j1amh|xn--l1acc|xn--ngbrx|xn--nqv7f|xn--p1acf|xn--tckwe|xn--vhquv|yodobashi|abudhabi|airforce|allstate|attorney|barclays|barefoot|bargains|baseball|boutique|bradesco|broadway|brussels|budapest|builders|business|capetown|catering|catholic|chrysler|cipriani|cityeats|cleaning|clinique|clothing|commbank|computer|delivery|deloitte|democrat|diamonds|discount|discover|download|engineer|ericsson|esurance|etisalat|everbank|exchange|feedback|fidelity|firmdale|football|frontier|goodyear|grainger|graphics|guardian|hdfcbank|helsinki|holdings|hospital|infiniti|ipiranga|istanbul|jpmorgan|lighting|lundbeck|marriott|maserati|mckinsey|memorial|merckmsd|mortgage|movistar|observer|partners|pharmacy|pictures|plumbing|property|redstone|reliance|saarland|samsclub|security|services|shopping|showtime|softbank|software|stcgroup|supplies|symantec|training|uconnect|vanguard|ventures|verisign|woodside|xn--90ae|xn--node|xn--p1ai|xn--qxam|yokohama|السعودية|abogado|academy|agakhan|alibaba|android|athleta|auction|audible|auspost|avianca|banamex|bauhaus|bentley|bestbuy|booking|brother|bugatti|capital|caravan|careers|cartier|channel|charity|chintai|citadel|clubmed|college|cologne|comcast|company|compare|contact|cooking|corsica|country|coupons|courses|cricket|cruises|dentist|digital|domains|exposed|express|farmers|fashion|ferrari|ferrero|finance|fishing|fitness|flights|florist|flowers|forsale|frogans|fujitsu|gallery|genting|godaddy|grocery|guitars|hamburg|hangout|hitachi|holiday|hosting|hoteles|hotmail|hyundai|iselect|ismaili|jewelry|juniper|kitchen|komatsu|lacaixa|lancome|lanxess|lasalle|latrobe|leclerc|liaison|limited|lincoln|markets|metlife|monster|netbank|netflix|network|neustar|okinawa|oldnavy|organic|origins|philips|pioneer|politie|realtor|recipes|rentals|reviews|rexroth|samsung|sandvik|schmidt|schwarz|science|shiksha|shriram|singles|staples|starhub|storage|support|surgery|systems|temasek|theater|theatre|tickets|tiffany|toshiba|trading|walmart|wanggou|watches|weather|website|wedding|whoswho|windows|winners|xfinity|yamaxun|youtube|zuerich|католик|اتصالات|الجزائر|العليان|پاکستان|كاثوليك|موبايلي|இந்தியா|abarth|abbott|abbvie|active|africa|agency|airbus|airtel|alipay|alsace|alstom|anquan|aramco|author|bayern|beauty|berlin|bharti|blanco|bostik|boston|broker|camera|career|caseih|casino|center|chanel|chrome|church|circle|claims|clinic|coffee|comsec|condos|coupon|credit|cruise|dating|datsun|dealer|degree|dental|design|direct|doctor|dunlop|dupont|durban|emerck|energy|estate|events|expert|family|flickr|futbol|gallup|garden|george|giving|global|google|gratis|health|hermes|hiphop|hockey|hotels|hughes|imamat|insure|intuit|jaguar|joburg|juegos|kaufen|kinder|kindle|kosher|lancia|latino|lawyer|lefrak|living|locker|london|luxury|madrid|maison|makeup|market|mattel|mobile|mobily|monash|mormon|moscow|museum|mutual|nagoya|natura|nissan|nissay|norton|nowruz|office|olayan|online|oracle|orange|otsuka|pfizer|photos|physio|piaget|pictet|quebec|racing|realty|reisen|repair|report|review|rocher|rogers|ryukyu|safety|sakura|sanofi|school|schule|search|secure|select|shouji|soccer|social|stream|studio|supply|suzuki|swatch|sydney|taipei|taobao|target|tattoo|tennis|tienda|tjmaxx|tkmaxx|toyota|travel|unicom|viajes|viking|villas|virgin|vision|voting|voyage|vuelos|walter|warman|webcam|xihuan|yachts|yandex|zappos|москва|онлайн|ابوظبي|ارامكو|الاردن|المغرب|امارات|فلسطين|مليسيا|भारतम्|இலங்கை|ファッション|actor|adult|aetna|amfam|amica|apple|archi|audio|autos|azure|baidu|beats|bible|bingo|black|boats|bosch|build|canon|cards|chase|cheap|cisco|citic|click|cloud|coach|codes|crown|cymru|dabur|dance|deals|delta|dodge|drive|dubai|earth|edeka|email|epost|epson|faith|fedex|final|forex|forum|gallo|games|gifts|gives|glade|glass|globo|gmail|green|gripe|group|gucci|guide|homes|honda|horse|house|hyatt|ikano|intel|irish|iveco|jetzt|koeln|kyoto|lamer|lease|legal|lexus|lilly|linde|lipsy|lixil|loans|locus|lotte|lotto|lupin|macys|mango|media|miami|money|mopar|movie|nadex|nexus|nikon|ninja|nokia|nowtv|omega|osaka|paris|parts|party|phone|photo|pizza|place|poker|praxi|press|prime|promo|quest|radio|rehab|reise|ricoh|rocks|rodeo|rugby|salon|sener|seven|sharp|shell|shoes|skype|sling|smart|smile|solar|space|sport|stada|store|study|style|sucks|swiss|tatar|tires|tirol|tmall|today|tokyo|tools|toray|total|tours|trade|trust|tunes|tushu|ubank|vegas|video|vodka|volvo|wales|watch|weber|weibo|works|world|xerox|yahoo|zippo|ایران|بازار|بھارت|سودان|سورية|همراه|भारोत|संगठन|বাংলা|భారత్|ഭാരതം|嘉里大酒店|aarp|able|adac|aero|aigo|akdn|ally|amex|arab|army|arpa|arte|asda|asia|audi|auto|baby|band|bank|bbva|beer|best|bike|bing|blog|blue|bofa|bond|book|buzz|cafe|call|camp|care|cars|casa|case|cash|cbre|cern|chat|citi|city|club|cool|coop|cyou|data|date|dclk|deal|dell|desi|diet|dish|docs|doha|duck|duns|dvag|erni|fage|fail|fans|farm|fast|fiat|fido|film|fire|fish|flir|food|ford|free|fund|game|gbiz|gent|ggee|gift|gmbh|gold|golf|goog|guge|guru|hair|haus|hdfc|help|here|hgtv|host|hsbc|icbc|ieee|imdb|immo|info|itau|java|jeep|jobs|jprs|kddi|kiwi|kpmg|kred|land|lego|lgbt|lidl|life|like|limo|link|live|loan|loft|love|ltda|luxe|maif|meet|meme|menu|mini|mint|mobi|moda|moto|name|navy|news|next|nico|nike|ollo|open|page|pars|pccw|pics|ping|pink|play|plus|pohl|porn|post|prod|prof|qpon|raid|read|reit|rent|rest|rich|rmit|room|rsvp|ruhr|safe|sale|sarl|save|saxo|scor|scot|seat|seek|sexy|shaw|shia|shop|show|silk|sina|site|skin|sncf|sohu|song|sony|spot|star|surf|talk|taxi|team|tech|teva|tiaa|tips|town|toys|tube|vana|visa|viva|vivo|vote|voto|wang|weir|wien|wiki|wine|work|xbox|yoga|zara|zero|zone|дети|сайт|بارت|بيتك|ڀارت|تونس|شبكة|عراق|عمان|موقع|भारत|ভারত|ভাৰত|ਭਾਰਤ|ભારત|ଭାରତ|ಭಾರತ|ලංකා|グーグル|クラウド|ポイント|大众汽车|组织机构|電訊盈科|香格里拉|aaa|abb|abc|aco|ads|aeg|afl|aig|anz|aol|app|art|aws|axa|bar|bbc|bbt|bcg|bcn|bet|bid|bio|biz|bms|bmw|bnl|bom|boo|bot|box|buy|bzh|cab|cal|cam|car|cat|cba|cbn|cbs|ceb|ceo|cfa|cfd|com|crs|csc|dad|day|dds|dev|dhl|diy|dnp|dog|dot|dtv|dvr|eat|eco|edu|esq|eus|fan|fit|fly|foo|fox|frl|ftr|fun|fyi|gal|gap|gdn|gea|gle|gmo|gmx|goo|gop|got|gov|hbo|hiv|hkt|hot|how|ibm|ice|icu|ifm|inc|ing|ink|int|ist|itv|jcb|jcp|jio|jll|jmp|jnj|jot|joy|kfh|kia|kim|kpn|krd|lat|law|lds|llc|lol|lpl|ltd|man|map|mba|med|men|mil|mit|mlb|mls|mma|moe|moi|mom|mov|msd|mtn|mtr|nab|nba|nec|net|new|nfl|ngo|nhk|now|nra|nrw|ntt|nyc|obi|off|one|ong|onl|ooo|org|ott|ovh|pay|pet|phd|pid|pin|pnc|pro|pru|pub|pwc|qvc|red|ren|ril|rio|rip|run|rwe|sap|sas|sbi|sbs|sca|scb|ses|sew|sex|sfr|ski|sky|soy|srl|srt|stc|tab|tax|tci|tdk|tel|thd|tjx|top|trv|tui|tvs|ubs|uno|uol|ups|vet|vig|vin|vip|wed|win|wme|wow|wtc|wtf|xin|xxx|xyz|you|yun|zip|бел|ком|қаз|мкд|мон|орг|рус|срб|укр|հայ|קום|عرب|قطر|كوم|مصر|कॉम|नेट|คอม|ไทย|ストア|セール|みんな|中文网|天主教|我爱你|新加坡|淡马锡|诺基亚|飞利浦|ac|ad|ae|af|ag|ai|al|am|ao|aq|ar|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|co|cr|cu|cv|cw|cx|cy|cz|de|dj|dk|dm|do|dz|ec|ee|eg|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|in|io|iq|ir|is|it|je|jm|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mg|mh|mk|ml|mm|mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|mz|na|nc|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|pa|pe|pf|pg|ph|pk|pl|pm|pn|pr|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|sk|sl|sm|sn|so|sr|st|su|sv|sx|sy|sz|tc|td|tf|tg|th|tj|tk|tl|tm|tn|to|tr|tt|tv|tw|tz|ua|ug|uk|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|ye|yt|za|zm|zw|ελ|бг|ею|рф|გე|닷넷|닷컴|삼성|한국|コム|世界|中信|中国|中國|企业|佛山|信息|健康|八卦|公司|公益|台湾|台灣|商城|商店|商标|嘉里|在线|大拿|娱乐|家電|工行|广东|微博|慈善|手机|手表|招聘|政务|政府|新闻|时尚|書籍|机构|游戏|澳門|点看|珠宝|移动|网址|网店|网站|网络|联通|谷歌|购物|通販|集团|食品|餐厅|香港)/,D=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.localPartCharRegex=new RegExp("["+E+"!#$%&'*+/=?^_`{|}~-]"),t.strictTldRegex=new RegExp("^"+I.source+"$"),t}return s(t,e),t.prototype.parseMatches=function(e){for(var t=this.tagBuilder,n=this.localPartCharRegex,r=this.strictTldRegex,a=[],o=e.length,s=new j,u={m:"a",a:"i",i:"l",l:"t",t:"o",o:":"},h=0,d=0,f=s;h<o;){var p=e.charAt(h);switch(d){case 0:m(p);break;case 1:_(e.charAt(h-1),p);break;case 2:g(p);break;case 3:v(p);break;case 4:b(p);break;case 5:y(p);break;case 6:w(p);break;case 7:O(p);break;default:i(d)}h++}return T(),a;function m(e){"m"===e?x(1):n.test(e)&&x()}function _(e,t){":"===e?n.test(t)?(d=2,f=new j(c({},f,{hasMailtoPrefix:!0}))):E():u[e]===t||(n.test(t)?d=2:"."===t?d=3:"@"===t?d=4:E())}function g(e){"."===e?d=3:"@"===e?d=4:n.test(e)||E()}function v(e){"."===e?E():"@"===e?E():n.test(e)?d=2:E()}function b(e){P.test(e)?d=5:E()}function y(e){"."===e?d=7:"-"===e?d=6:P.test(e)||T()}function w(e){"-"===e||"."===e?T():P.test(e)?d=5:T()}function O(e){"."===e||"-"===e?T():P.test(e)?(d=5,f=new j(c({},f,{hasDomainDot:!0}))):T()}function x(e){void 0===e&&(e=2),d=e,f=new j({idx:h})}function E(){d=0,f=s}function T(){if(f.hasDomainDot){var i=e.slice(f.idx,h);/[-.]$/.test(i)&&(i=i.slice(0,-1));var n=f.hasMailtoPrefix?i.slice("mailto:".length):i;(function(e){var t=(e.split(".").pop()||"").toLowerCase();return r.test(t)})(n)&&a.push(new l({tagBuilder:t,matchedText:i,offset:f.idx,email:n}))}E()}},t}(p),j=function(e){void 0===e&&(e={}),this.idx=void 0!==e.idx?e.idx:-1,this.hasMailtoPrefix=!!e.hasMailtoPrefix,this.hasDomainDot=!!e.hasDomainDot},M=function(){function e(){}return e.isValid=function(e,t){return!(t&&!this.isValidUriScheme(t)||this.urlMatchDoesNotHaveProtocolOrDot(e,t)||this.urlMatchDoesNotHaveAtLeastOneWordChar(e,t)&&!this.isValidIpAddress(e)||this.containsMultipleDots(e))},e.isValidIpAddress=function(e){var t=new RegExp(this.hasFullProtocolRegex.source+this.ipRegex.source);return null!==e.match(t)},e.containsMultipleDots=function(e){var t=e;return this.hasFullProtocolRegex.test(e)&&(t=e.split("://")[1]),t.split("/")[0].indexOf("..")>-1},e.isValidUriScheme=function(e){var t=e.match(this.uriSchemeRegex),i=t&&t[0].toLowerCase();return"javascript:"!==i&&"vbscript:"!==i},e.urlMatchDoesNotHaveProtocolOrDot=function(e,t){return!(!e||t&&this.hasFullProtocolRegex.test(t)||-1!==e.indexOf("."))},e.urlMatchDoesNotHaveAtLeastOneWordChar=function(e,t){return!(!e||!t)&&!this.hasWordCharAfterProtocolRegex.test(e)},e.hasFullProtocolRegex=/^[A-Za-z][-.+A-Za-z0-9]*:\/\//,e.uriSchemeRegex=/^[A-Za-z][-.+A-Za-z0-9]*:/,e.hasWordCharAfterProtocolRegex=new RegExp(":[^\\s]*?["+y+"]"),e.ipRegex=/[0-9][0-9]?[0-9]?\.[0-9][0-9]?[0-9]?\.[0-9][0-9]?[0-9]?\.[0-9][0-9]?[0-9]?(:[0-9]*)?\/?$/,e}(),R=function(e){function t(t){var i,n=e.call(this,t)||this;return n.stripPrefix={scheme:!0,www:!0},n.stripTrailingSlash=!0,n.decodePercentEncoding=!0,n.matcherRegex=(i=new RegExp("[/?#](?:["+E+"\\-+&@#/%=~_()|'$*\\[\\]?!:,.;✓]*["+E+"\\-+&@#/%=~_()|'$*\\[\\]✓])?"),new RegExp(["(?:","(",/(?:[A-Za-z][-.+A-Za-z0-9]{0,63}:(?![A-Za-z][-.+A-Za-z0-9]{0,63}:\/\/)(?!\d+\/?)(?:\/\/)?)/.source,A(2),")","|","(","(//)?",/(?:www\.)/.source,A(6),")","|","(","(//)?",A(10)+"\\.",I.source,"(?![-"+x+"])",")",")","(?::[0-9]+)?","(?:"+i.source+")?"].join(""),"gi")),n.wordCharRegExp=new RegExp("["+E+"]"),n.stripPrefix=t.stripPrefix,n.stripTrailingSlash=t.stripTrailingSlash,n.decodePercentEncoding=t.decodePercentEncoding,n}return s(t,e),t.prototype.parseMatches=function(e){for(var t,i=this.matcherRegex,n=this.stripPrefix,r=this.stripTrailingSlash,a=this.decodePercentEncoding,o=this.tagBuilder,s=[],c=function(){var i=t[0],c=t[1],u=t[4],h=t[5],d=t[9],p=t.index,m=h||d,_=e.charAt(p-1);if(!M.isValid(i,c))return"continue";if(p>0&&"@"===_)return"continue";if(p>0&&m&&l.wordCharRegExp.test(_))return"continue";if(/\?$/.test(i)&&(i=i.substr(0,i.length-1)),l.matchHasUnbalancedClosingParen(i))i=i.substr(0,i.length-1);else{var g=l.matchHasInvalidCharAfterTld(i,c);g>-1&&(i=i.substr(0,g))}var v=["http://","https://"].find((function(e){return!!c&&-1!==c.indexOf(e)}));if(v){var b=i.indexOf(v);i=i.substr(b),c=c.substr(b),p+=b}var y=c?"scheme":u?"www":"tld",w=!!c;s.push(new f({tagBuilder:o,matchedText:i,offset:p,urlMatchType:y,url:i,protocolUrlMatch:w,protocolRelativeMatch:!!m,stripPrefix:n,stripTrailingSlash:r,decodePercentEncoding:a}))},l=this;null!==(t=i.exec(e));)c();return s},t.prototype.matchHasUnbalancedClosingParen=function(e){var t,i=e.charAt(e.length-1);if(")"===i)t="(";else{if("]"!==i)return!1;t="["}for(var n=0,r=0,a=e.length-1;r<a;r++){var o=e.charAt(r);o===t?n++:o===i&&(n=Math.max(n-1,0))}return 0===n},t.prototype.matchHasInvalidCharAfterTld=function(e,t){if(!e)return-1;var i=0;t&&(i=e.indexOf(":"),e=e.slice(i));var n=new RegExp("^((.?//)?[-."+E+"]*[-"+E+"]\\.[-"+E+"]+)").exec(e);return null===n?-1:(i+=n[1].length,e=e.slice(n[1].length),/^[^-.A-Za-z0-9:\/?#]/.test(e)?i:-1)},t}(p),L=function(e){function t(t){var i=e.call(this,t)||this;return i.serviceName="twitter",i.matcherRegex=new RegExp("#[_"+E+"]{1,139}(?![_"+E+"])","g"),i.nonWordCharRegex=new RegExp("[^"+E+"]"),i.serviceName=t.serviceName,i}return s(t,e),t.prototype.parseMatches=function(e){for(var t,i=this.matcherRegex,n=this.nonWordCharRegex,r=this.serviceName,a=this.tagBuilder,o=[];null!==(t=i.exec(e));){var s=t.index,c=e.charAt(s-1);if(0===s||n.test(c)){var l=t[0],h=t[0].slice(1);o.push(new u({tagBuilder:a,matchedText:l,offset:s,serviceName:r,hashtag:h}))}}return o},t}(p),N=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.matcherRegex=/(?:(?:(?:(\+)?\d{1,3}[-\040.]?)?\(?\d{3}\)?[-\040.]?\d{3}[-\040.]?\d{4})|(?:(\+)(?:9[976]\d|8[987530]\d|6[987]\d|5[90]\d|42\d|3[875]\d|2[98654321]\d|9[8543210]|8[6421]|6[6543210]|5[87654321]|4[987654310]|3[9643210]|2[70]|7|1)[-\040.]?(?:\d[-\040.]?){6,12}\d+))([,;]+[0-9]+#?)*/g,t}return s(t,e),t.prototype.parseMatches=function(e){for(var t,i=this.matcherRegex,n=this.tagBuilder,r=[];null!==(t=i.exec(e));){var a=t[0],o=a.replace(/[^0-9,;#]/g,""),s=!(!t[1]&&!t[2]),c=0==t.index?"":e.substr(t.index-1,1),l=e.substr(t.index+a.length,1),u=!c.match(/\d/)&&!l.match(/\d/);this.testMatch(t[3])&&this.testMatch(a)&&u&&r.push(new d({tagBuilder:n,matchedText:a,offset:t.index,number:o,plusSign:s}))}return r},t.prototype.testMatch=function(e){return/\D/.test(e)},t}(p),F=function(e){function t(t){var i=e.call(this,t)||this;return i.serviceName="twitter",i.matcherRegexes={twitter:new RegExp("@[_"+E+"]{1,50}(?![_"+E+"])","g"),instagram:new RegExp("@[_."+E+"]{1,30}(?![_"+E+"])","g"),soundcloud:new RegExp("@[-_."+E+"]{1,50}(?![-_"+E+"])","g")},i.nonWordCharRegex=new RegExp("[^"+E+"]"),i.serviceName=t.serviceName,i}return s(t,e),t.prototype.parseMatches=function(e){var t,i=this.serviceName,n=this.matcherRegexes[this.serviceName],r=this.nonWordCharRegex,a=this.tagBuilder,o=[];if(!n)return o;for(;null!==(t=n.exec(e));){var s=t.index,c=e.charAt(s-1);if(0===s||r.test(c)){var l=t[0].replace(/\.+$/g,""),u=l.slice(1);o.push(new h({tagBuilder:a,matchedText:l,offset:s,serviceName:i,mention:u}))}}return o},t}(p);function k(e,t){for(var n,r=t.onOpenTag,a=t.onCloseTag,o=t.onText,s=t.onComment,l=t.onDoctype,u=new B,h=0,d=e.length,f=0,p=0,y=u;h<d;){var w=e.charAt(h);switch(f){case 0:O(w);break;case 1:x(w);break;case 2:T(w);break;case 3:E(w);break;case 4:C(w);break;case 5:S(w);break;case 6:A(w);break;case 7:P(w);break;case 8:I(w);break;case 9:D(w);break;case 10:j(w);break;case 11:M(w);break;case 12:R(w);break;case 13:L(w);break;case 14:N(w);break;case 15:F(w);break;case 16:k(w);break;case 17:z(w);break;case 18:U(w);break;case 19:V(w);break;case 20:H(w);break;default:i(f)}h++}function O(e){"<"===e&&q()}function x(e){"!"===e?f=13:"/"===e?(f=2,y=new B(c({},y,{isClosing:!0}))):"<"===e?q():m.test(e)?(f=3,y=new B(c({},y,{isOpening:!0}))):(f=0,y=u)}function E(e){g.test(e)?(y=new B(c({},y,{name:Y()})),f=4):"<"===e?q():"/"===e?(y=new B(c({},y,{name:Y()})),f=12):">"===e?(y=new B(c({},y,{name:Y()})),W()):m.test(e)||_.test(e)||":"===e||G()}function T(e){">"===e?G():m.test(e)?f=3:G()}function C(e){g.test(e)||("/"===e?f=12:">"===e?W():"<"===e?q():"="===e||v.test(e)||b.test(e)?G():f=5)}function S(e){g.test(e)?f=6:"/"===e?f=12:"="===e?f=7:">"===e?W():"<"===e?q():v.test(e)&&G()}function A(e){g.test(e)||("/"===e?f=12:"="===e?f=7:">"===e?W():"<"===e?q():v.test(e)?G():f=5)}function P(e){g.test(e)||('"'===e?f=8:"'"===e?f=9:/[>=`]/.test(e)?G():"<"===e?q():f=10)}function I(e){'"'===e&&(f=11)}function D(e){"'"===e&&(f=11)}function j(e){g.test(e)?f=4:">"===e?W():"<"===e&&q()}function M(e){g.test(e)?f=4:"/"===e?f=12:">"===e?W():"<"===e?q():(f=4,h--)}function R(e){">"===e?(y=new B(c({},y,{isClosing:!0})),W()):f=4}function L(t){"--"===e.substr(h,2)?(h+=2,y=new B(c({},y,{type:"comment"})),f=14):"DOCTYPE"===e.substr(h,7).toUpperCase()?(h+=7,y=new B(c({},y,{type:"doctype"})),f=20):G()}function N(e){"-"===e?f=15:">"===e?G():f=16}function F(e){"-"===e?f=18:">"===e?G():f=16}function k(e){"-"===e&&(f=17)}function z(e){f="-"===e?18:16}function U(e){">"===e?W():"!"===e?f=19:"-"===e||(f=16)}function V(e){"-"===e?f=17:">"===e?W():f=16}function H(e){">"===e?W():"<"===e&&q()}function G(){f=0,y=u}function q(){f=1,y=new B({idx:h})}function W(){var t=e.slice(p,y.idx);t&&o(t,p),"comment"===y.type?s(y.idx):"doctype"===y.type?l(y.idx):(y.isOpening&&r(y.name,y.idx),y.isClosing&&a(y.name,y.idx)),G(),p=h+1}function Y(){var t=y.idx+(y.isClosing?2:1);return e.slice(t,h).toLowerCase()}p<h&&(n=e.slice(p,h),o(n,p),p=h+1)}var B=function(e){void 0===e&&(e={}),this.idx=void 0!==e.idx?e.idx:-1,this.type=e.type||"tag",this.name=e.name||"",this.isOpening=!!e.isOpening,this.isClosing=!!e.isClosing};return function(){function e(t){void 0===t&&(t={}),this.version=e.version,this.urls={},this.email=!0,this.phone=!0,this.hashtag=!1,this.mention=!1,this.newWindow=!0,this.stripPrefix={scheme:!0,www:!0},this.stripTrailingSlash=!0,this.decodePercentEncoding=!0,this.truncate={length:0,location:"end"},this.className="",this.replaceFn=null,this.context=void 0,this.matchers=null,this.tagBuilder=null,this.urls=this.normalizeUrlsCfg(t.urls),this.email="boolean"==typeof t.email?t.email:this.email,this.phone="boolean"==typeof t.phone?t.phone:this.phone,this.hashtag=t.hashtag||this.hashtag,this.mention=t.mention||this.mention,this.newWindow="boolean"==typeof t.newWindow?t.newWindow:this.newWindow,this.stripPrefix=this.normalizeStripPrefixCfg(t.stripPrefix),this.stripTrailingSlash="boolean"==typeof t.stripTrailingSlash?t.stripTrailingSlash:this.stripTrailingSlash,this.decodePercentEncoding="boolean"==typeof t.decodePercentEncoding?t.decodePercentEncoding:this.decodePercentEncoding;var i=this.mention;if(!1!==i&&"twitter"!==i&&"instagram"!==i&&"soundcloud"!==i)throw new Error("invalid `mention` cfg - see docs");var n=this.hashtag;if(!1!==n&&"twitter"!==n&&"facebook"!==n&&"instagram"!==n)throw new Error("invalid `hashtag` cfg - see docs");this.truncate=this.normalizeTruncateCfg(t.truncate),this.className=t.className||this.className,this.replaceFn=t.replaceFn||this.replaceFn,this.context=t.context||this}return e.link=function(t,i){return new e(i).link(t)},e.parse=function(t,i){return new e(i).parse(t)},e.prototype.normalizeUrlsCfg=function(e){return null==e&&(e=!0),"boolean"==typeof e?{schemeMatches:e,wwwMatches:e,tldMatches:e}:{schemeMatches:"boolean"!=typeof e.schemeMatches||e.schemeMatches,wwwMatches:"boolean"!=typeof e.wwwMatches||e.wwwMatches,tldMatches:"boolean"!=typeof e.tldMatches||e.tldMatches}},e.prototype.normalizeStripPrefixCfg=function(e){return null==e&&(e=!0),"boolean"==typeof e?{scheme:e,www:e}:{scheme:"boolean"!=typeof e.scheme||e.scheme,www:"boolean"!=typeof e.www||e.www}},e.prototype.normalizeTruncateCfg=function(e){return"number"==typeof e?{length:e,location:"end"}:function(e,t){for(var i in t)t.hasOwnProperty(i)&&void 0===e[i]&&(e[i]=t[i]);return e}(e||{},{length:Number.POSITIVE_INFINITY,location:"end"})},e.prototype.parse=function(e){var t=this,i=["a","style","script"],n=0,r=[];return k(e,{onOpenTag:function(e){i.indexOf(e)>=0&&n++},onText:function(e,i){if(0===n){var a=function(e,t){if(!t.global)throw new Error("`splitRegex` must have the 'g' flag set");for(var i,n=[],r=0;i=t.exec(e);)n.push(e.substring(r,i.index)),n.push(i[0]),r=i.index+i[0].length;return n.push(e.substring(r)),n}(e,/(&nbsp;|&#160;|&lt;|&#60;|&gt;|&#62;|&quot;|&#34;|&#39;)/gi),o=i;a.forEach((function(e,i){if(i%2==0){var n=t.parseText(e,o);r.push.apply(r,n)}o+=e.length}))}},onCloseTag:function(e){i.indexOf(e)>=0&&(n=Math.max(n-1,0))},onComment:function(e){},onDoctype:function(e){}}),r=this.compactMatches(r),r=this.removeUnwantedMatches(r)},e.prototype.compactMatches=function(e){e.sort((function(e,t){return e.getOffset()-t.getOffset()}));for(var t=0;t<e.length-1;t++){var i=e[t],n=i.getOffset(),r=i.getMatchedText().length,a=n+r;if(t+1<e.length){if(e[t+1].getOffset()===n){var o=e[t+1].getMatchedText().length>r?t:t+1;e.splice(o,1);continue}e[t+1].getOffset()<a&&e.splice(t+1,1)}}return e},e.prototype.removeUnwantedMatches=function(e){return this.hashtag||t(e,(function(e){return"hashtag"===e.getType()})),this.email||t(e,(function(e){return"email"===e.getType()})),this.phone||t(e,(function(e){return"phone"===e.getType()})),this.mention||t(e,(function(e){return"mention"===e.getType()})),this.urls.schemeMatches||t(e,(function(e){return"url"===e.getType()&&"scheme"===e.getUrlMatchType()})),this.urls.wwwMatches||t(e,(function(e){return"url"===e.getType()&&"www"===e.getUrlMatchType()})),this.urls.tldMatches||t(e,(function(e){return"url"===e.getType()&&"tld"===e.getUrlMatchType()})),e},e.prototype.parseText=function(e,t){void 0===t&&(t=0),t=t||0;for(var i=this.getMatchers(),n=[],r=0,a=i.length;r<a;r++){for(var o=i[r].parseMatches(e),s=0,c=o.length;s<c;s++)o[s].setOffset(t+o[s].getOffset());n.push.apply(n,o)}return n},e.prototype.link=function(e){if(!e)return"";for(var t=this.parse(e),i=[],n=0,r=0,a=t.length;r<a;r++){var o=t[r];i.push(e.substring(n,o.getOffset())),i.push(this.createMatchReturnVal(o)),n=o.getOffset()+o.getMatchedText().length}return i.push(e.substring(n)),i.join("")},e.prototype.createMatchReturnVal=function(e){var t;return this.replaceFn&&(t=this.replaceFn.call(this.context,e)),"string"==typeof t?t:!1===t?e.getMatchedText():t instanceof n?t.toAnchorString():e.buildTag().toAnchorString()},e.prototype.getMatchers=function(){if(this.matchers)return this.matchers;var e=this.getTagBuilder(),t=[new L({tagBuilder:e,serviceName:this.hashtag}),new D({tagBuilder:e}),new N({tagBuilder:e}),new F({tagBuilder:e,serviceName:this.mention}),new R({tagBuilder:e,stripPrefix:this.stripPrefix,stripTrailingSlash:this.stripTrailingSlash,decodePercentEncoding:this.decodePercentEncoding})];return this.matchers=t},e.prototype.getTagBuilder=function(){var e=this.tagBuilder;return e||(e=this.tagBuilder=new r({newWindow:this.newWindow,truncate:this.truncate,className:this.className})),e},e.version="3.11.0",e.AnchorTagBuilder=r,e.HtmlTag=n,e.matcher={Email:D,Hashtag:L,Matcher:p,Mention:F,Phone:N,Url:R},e.match={Email:l,Hashtag:u,Match:a,Mention:h,Phone:d,Url:f},e}()}()}(Dte);var jte=Dte.Autolinker,Mte={};
/**
@license
 Copyright (c) 2013 Gildas Lormeau. All rights reserved.

 Redistribution and use in source and binary forms, with or without
 modification, are permitted provided that the following conditions are met:

 1. Redistributions of source code must retain the above copyright notice,
 this list of conditions and the following disclaimer.

 2. Redistributions in binary form must reproduce the above copyright
 notice, this list of conditions and the following disclaimer in
 the documentation and/or other materials provided with the distribution.

 3. The names of the authors may not be used to endorse or promote products
 derived from this software without specific prior written permission.

 THIS SOFTWARE IS PROVIDED ``AS IS'' AND ANY EXPRESSED OR IMPLIED WARRANTIES,
 INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND
 FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL JCRAFT,
 INC. OR ANY CONTRIBUTORS TO THIS SOFTWARE BE LIABLE FOR ANY DIRECT, INDIRECT,
 INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA,
 OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
 LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
 NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
 EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
**/!function(e){var t,i,n="File format is not recognized.",r="File contains encrypted entry.",a="File is using Zip64 (4gb+ file size).",o="Error while reading zip file.",s="Error while writing zip file.",c="Error while writing file data.",l="Error while reading file data.",u="File already exists.",h=524288,d="inflate.js",f="deflate.js",p="text/plain",m="message";try{t=0===new Blob([new DataView(new ArrayBuffer(0))]).size}catch(e){}function _(){var e=-1,t=this;t.append=function(i){var n,r=t.table;for(n=0;n<i.length;n++)e=e>>>8^r[255&(e^i[n])]},t.get=function(){return~e}}function g(e,t){var i,n;return i=new ArrayBuffer(e),n=new Uint8Array(i),t&&n.set(t,0),{buffer:i,array:n,view:new DataView(i)}}function v(){}function b(e){var t,i=this;i.size=0,i.init=function(n,r){var a=new Blob([e],{type:p});(t=new O(a)).init((function(){i.size=t.size,n()}),r)},i.readUint8Array=function(e,i,n,r){t.readUint8Array(e,i,n,r)}}function w(e){var t,i=this;i.size=0,i.init=function(n){for(var r=e.length;"="==e.charAt(r-1);)r--;t=e.indexOf(",")+1,i.size=Math.floor(.75*(r-t)),n()},i.readUint8Array=function(i,n,r){var a,o=g(n),s=4*Math.floor(i/3),c=4*Math.ceil((i+n)/3),l=window.atob(e.substring(s+t,c+t)),u=i-3*Math.floor(s/4);for(a=u;a<u+n;a++)o.array[a-u]=l.charCodeAt(a);r(o.array)}}function O(e){this.size=0,this.init=function(t){this.size=e.size,t()},this.readUint8Array=function(t,i,n,r){var a=new FileReader;a.onload=function(e){n(new Uint8Array(e.target.result))},a.onerror=r,a.readAsArrayBuffer(function(e,t,i){return e.slice?e.slice(t,t+i):e.webkitSlice?e.webkitSlice(t,t+i):e.mozSlice?e.mozSlice(t,t+i):e.msSlice?e.msSlice(t,t+i):void 0}(e,t,i))}}function x(){}function E(e){var i;this.init=function(e){i=new Blob([],{type:p}),e()},this.writeUint8Array=function(e,n){i=new Blob([i,t?e:e.buffer],{type:p}),n()},this.getData=function(t,n){var r=new FileReader;r.onload=function(e){t(e.target.result)},r.onerror=n,r.readAsText(i,e)}}function T(e){var t="",i="";this.init=function(i){t+="data:"+(e||"")+";base64,",i()},this.writeUint8Array=function(e,n){var r,a=i.length,o=i;for(i="",r=0;r<3*Math.floor((a+e.length)/3)-a;r++)o+=String.fromCharCode(e[r]);for(;r<e.length;r++)i+=String.fromCharCode(e[r]);o.length>2?t+=window.btoa(o):i=o,n()},this.getData=function(e){e(t+window.btoa(i))}}function C(e){var i;this.init=function(t){i=new Blob([],{type:e}),t()},this.writeUint8Array=function(n,r){i=new Blob([i,t?n:n.buffer],{type:e}),r()},this.getData=function(e){e(i)}}function S(e,t,i,n,r,a,o,s,c,l){var u,d,f=0;function p(){e.removeEventListener(m,_,!1),s(d)}function _(e){var t=e.data,n=t.data;t.onappend&&(d+=n.length,i.writeUint8Array(n,(function(){a(!1,n),g()}),l)),t.onflush&&(n?(d+=n.length,i.writeUint8Array(n,(function(){a(!1,n),p()}),l)):p()),t.progress&&o&&o(u+t.current,r)}function g(){(u=f*h)<r?t.readUint8Array(n+u,Math.min(h,r-u),(function(t){e.postMessage({append:!0,data:t}),f++,o&&o(u,r),a(!0,t)}),c):e.postMessage({flush:!0})}d=0,e.addEventListener(m,_,!1),g()}function A(e,t,i,n,r,a,o,s,c,l){var u,d=0,f=0;!function p(){var m;(u=d*h)<r?t.readUint8Array(n+u,Math.min(h,r-u),(function(t){var s=e.append(t,(function(){o&&o(n+u,r)}));f+=s.length,a(!0,t),i.writeUint8Array(s,(function(){a(!1,s),d++,setTimeout(p,1)}),l),o&&o(u,r)}),c):(m=e.flush())?(f+=m.length,i.writeUint8Array(m,(function(){a(!1,m),s(f)}),l)):s(f)}()}function P(e,t,i,n,r,a,o,s,c){var l=0,u=new _;!function d(){var f=l*h;f<n?e.readUint8Array(i+f,Math.min(h,n-f),(function(e){r&&u.append(e),o&&o(f,n,e),t.writeUint8Array(e,(function(){l++,d()}),c)}),s):a(n,u.get())}()}function I(e){var t,i,n="",r=["Ç","ü","é","â","ä","à","å","ç","ê","ë","è","ï","î","ì","Ä","Å","É","æ","Æ","ô","ö","ò","û","ù","ÿ","Ö","Ü","ø","£","Ø","×","ƒ","á","í","ó","ú","ñ","Ñ","ª","º","¿","®","¬","½","¼","¡","«","»","_","_","_","¦","¦","Á","Â","À","©","¦","¦","+","+","¢","¥","+","+","-","-","+","-","+","ã","Ã","+","+","-","-","¦","-","+","¤","ð","Ð","Ê","Ë","È","i","Í","Î","Ï","+","+","_","_","¦","Ì","_","Ó","ß","Ô","Ò","õ","Õ","µ","þ","Þ","Ú","Û","Ù","ý","Ý","¯","´","­","±","_","¾","¶","§","÷","¸","°","¨","·","¹","³","²","_"," "];for(t=0;t<e.length;t++)n+=(i=255&e.charCodeAt(t))>127?r[i-128]:String.fromCharCode(i);return n}function D(e){return decodeURIComponent(escape(e))}function j(e){var t,i="";for(t=0;t<e.length;t++)i+=String.fromCharCode(e[t]);return i}function M(e,t,i,n,o){e.version=t.view.getUint16(i,!0),e.bitFlag=t.view.getUint16(i+2,!0),e.compressionMethod=t.view.getUint16(i+4,!0),e.lastModDateRaw=t.view.getUint32(i+6,!0),e.lastModDate=function(e){var t=(4294901760&e)>>16,i=65535&e;try{return new Date(1980+((65024&t)>>9),((480&t)>>5)-1,31&t,(63488&i)>>11,(2016&i)>>5,2*(31&i),0)}catch(e){}}(e.lastModDateRaw),1!=(1&e.bitFlag)?((n||8!=(8&e.bitFlag))&&(e.crc32=t.view.getUint32(i+10,!0),e.compressedSize=t.view.getUint32(i+14,!0),e.uncompressedSize=t.view.getUint32(i+18,!0)),4294967295!==e.compressedSize&&4294967295!==e.uncompressedSize?(e.filenameLength=t.view.getUint16(i+22,!0),e.extraFieldLength=t.view.getUint16(i+24,!0)):o(a)):o(r)}function R(t,i){function r(){}return r.prototype.getData=function(r,a,o,s){var u,h=this;function f(e,t){u&&u.terminate(),u=null,e&&e(t)}function p(e,t){s&&!function(e){var t=g(4);return t.view.setUint32(0,e),h.crc32==t.view.getUint32(0)}(t)?m():r.getData((function(e){f(a,e)}))}function m(){f(i,l)}function v(){f(i,c)}t.readUint8Array(h.offset,30,(function(a){var c,l=g(a.length,a);1347093252==l.view.getUint32(0)?(M(h,l,4,!1,i),c=h.offset+30+h.filenameLength+h.extraFieldLength,r.init((function(){0===h.compressionMethod?P(t,r,c,h.compressedSize,s,p,o,m,v):u=function(t,i,n,r,a,o,s,c,l){var u,h=new _;function f(e,t){a&&!e&&h.append(t)}function p(e){o(e,h.get())}return e.zip.useWebWorkers?S(u=new Worker(e.zip.workerScriptsPath+d),t,i,n,r,f,s,p,c,l):A(new e.zip.Inflater,t,i,n,r,f,s,p,c,l),u}(t,r,c,h.compressedSize,s,p,o,m,v)}),v)):i(n)}),m)},{getEntries:function(e){t.size<22?i(n):function e(n,r){t.readUint8Array(t.size-n,n,(function(t){var i=g(t.length,t).view;1347093766!=i.getUint32(0)?e(n+1,r):r(i)}),(function(){i(o)}))}(22,(function(a){var s,c;s=a.getUint32(16,!0),c=a.getUint16(8,!0),t.readUint8Array(s,t.size-s,(function(t){var a,o,s,l,u=0,h=[],d=g(t.length,t);for(a=0;a<c;a++){if(o=new r,1347092738!=d.view.getUint32(u))return void i(n);M(o,d,u+6,!0,i),o.commentLength=d.view.getUint16(u+32,!0),o.directory=16==(16&d.view.getUint8(u+38)),o.offset=d.view.getUint32(u+42,!0),s=j(d.array.subarray(u+46,u+46+o.filenameLength)),o.filename=2048==(2048&o.bitFlag)?D(s):I(s),o.directory||"/"!=o.filename.charAt(o.filename.length-1)||(o.directory=!0),l=j(d.array.subarray(u+46+o.filenameLength+o.extraFieldLength,u+46+o.filenameLength+o.extraFieldLength+o.commentLength)),o.comment=2048==(2048&o.bitFlag)?D(l):I(l),h.push(o),u+=46+o.filenameLength+o.extraFieldLength+o.commentLength}e(h)}),(function(){i(o)}))}))},close:function(e){e&&e()}}}function L(e){return unescape(encodeURIComponent(e))}function N(e){var t,i=[];for(t=0;t<e.length;t++)i.push(e.charCodeAt(t));return i}function F(t,i,n){var r,a={},o=[],c=0;function h(e,t){r&&r.terminate(),r=null,e&&e(t)}function d(){h(i,s)}function p(){h(i,l)}return{add:function(s,l,v,b,y){var w,O,x;function E(e,i){var n=g(16);c+=e||0,n.view.setUint32(0,1347094280),void 0!==i&&(w.view.setUint32(10,i,!0),n.view.setUint32(4,i,!0)),l&&(n.view.setUint32(8,e,!0),w.view.setUint32(14,e,!0),n.view.setUint32(12,l.size,!0),w.view.setUint32(18,l.size,!0)),t.writeUint8Array(n.array,(function(){c+=16,h(v)}),d)}function T(){var h,v;(y=y||{},s=s.trim(),y.directory&&"/"!=s.charAt(s.length-1)&&(s+="/"),a.hasOwnProperty(s))?i(u):(O=N(L(s)),o.push(s),h=function(){l?n||0===y.level?P(l,t,0,l.size,!0,E,b,p,d):r=function(t,i,n,r,a,o,s){var c,l=new _;function u(e,t){e&&l.append(t)}function h(e){r(e,l.get())}return e.zip.useWebWorkers?((c=new Worker(e.zip.workerScriptsPath+f)).addEventListener(m,(function e(){c.removeEventListener(m,e,!1),S(c,t,i,0,t.size,u,a,h,o,s)}),!1),c.postMessage({init:!0,level:n})):A(new e.zip.Deflater,t,i,0,t.size,u,a,h,o,s),c}(l,t,y.level,E,b,p,d):E()},x=y.lastModDate||new Date,w=g(26),a[s]={headerArray:w.array,directory:y.directory,filename:O,offset:c,comment:N(L(y.comment||""))},w.view.setUint32(0,335546376),y.version&&w.view.setUint8(0,y.version),n||0===y.level||y.directory||w.view.setUint16(4,2048),w.view.setUint16(6,(x.getHours()<<6|x.getMinutes())<<5|x.getSeconds()/2,!0),w.view.setUint16(8,(x.getFullYear()-1980<<4|x.getMonth()+1)<<5|x.getDate(),!0),w.view.setUint16(22,O.length,!0),(v=g(30+O.length)).view.setUint32(0,1347093252),v.array.set(w.array,4),v.array.set(O,30),c+=v.array.length,t.writeUint8Array(v.array,h,d))}l?l.init(T,p):T()},close:function(e){var i,n,r,s=0,l=0;for(n=0;n<o.length;n++)s+=46+(r=a[o[n]]).filename.length+r.comment.length;for(i=g(s+22),n=0;n<o.length;n++)r=a[o[n]],i.view.setUint32(l,1347092738),i.view.setUint16(l+4,5120),i.array.set(r.headerArray,l+6),i.view.setUint16(l+32,r.comment.length,!0),r.directory&&i.view.setUint8(l+38,16),i.view.setUint32(l+42,r.offset,!0),i.array.set(r.filename,l+46),i.array.set(r.comment,l+46+r.filename.length),l+=46+r.filename.length+r.comment.length;i.view.setUint32(l,1347093766),i.view.setUint16(l+8,o.length,!0),i.view.setUint16(l+10,o.length,!0),i.view.setUint32(l+12,s,!0),i.view.setUint32(l+16,c,!0),t.writeUint8Array(i.array,(function(){h((function(){t.getData(e)}))}),d)}}}_.prototype.table=function(){var e,t,i,n=[];for(e=0;e<256;e++){for(i=e,t=0;t<8;t++)1&i?i=i>>>1^3988292384:i>>>=1;n[e]=i}return n}(),b.prototype=new v,b.prototype.constructor=b,w.prototype=new v,w.prototype.constructor=w,O.prototype=new v,O.prototype.constructor=O,x.prototype.getData=function(e){e(this.data)},E.prototype=new x,E.prototype.constructor=E,T.prototype=new x,T.prototype.constructor=T,C.prototype=new x,C.prototype.constructor=C,e.zip={Reader:v,Writer:x,BlobReader:O,Data64URIReader:w,TextReader:b,BlobWriter:C,Data64URIWriter:T,TextWriter:E,createReader:function(e,t,i){e.init((function(){t(R(e,i))}),i)},createWriter:function(e,t,i,n){e.init((function(){t(F(e,i,n))}),i)},useWebWorkers:!0},Object.defineProperties(e.zip,{workerScriptsPath:{get:function(){return void 0===i&&(i=y("ThirdParty/Workers/")),i}}})}(Mte);var Rte=Mte.zip;var Lte=function(e,t){this.position=e,this.headingPitchRange=t};function Nte(e,t){this.id=t,this.name=e,this.playlistIndex=0,this.playlist=[],this.tourStart=new $o.a,this.tourEnd=new $o.a,this.entryStart=new $o.a,this.entryEnd=new $o.a,this._activeEntries=[]}function Fte(e){for(var t=e.pop();void 0!==t;t=e.pop())t.stop()}function kte(e,t,i){var n=this.playlist[this.playlistIndex];if(n){var r=Bte.bind(this,e,t,i);if(this._activeEntries.push(n),this.entryStart.raiseEvent(n),n.blocking)n.play(r,e.scene.camera,t);else{var a=this;n.play((function(){a.entryEnd.raiseEvent(n);var e=a._activeEntries.indexOf(n);e>=0&&a._activeEntries.splice(e,1)})),r(e,t,i)}}else Object(u.a)(i)&&i(!1)}function Bte(e,t,i,n){var r=this.playlist[this.playlistIndex];if(this.entryEnd.raiseEvent(r,n),n)i(n);else{var a=this._activeEntries.indexOf(r);a>=0&&this._activeEntries.splice(a,1),this.playlistIndex++,kte.call(this,e,t,i)}}Nte.prototype.addPlaylistEntry=function(e){this.playlist.push(e)},Nte.prototype.play=function(e,t){this.tourStart.raiseEvent();var i=this;kte.call(this,e,t,(function(e){i.playlistIndex=0,e||Fte(i._activeEntries),i.tourEnd.raiseEvent(e)}))},Nte.prototype.stop=function(){Fte(this._activeEntries)};var zte=Nte;function Ute(e,t,i){this.type="KmlTourFlyTo",this.blocking=!0,this.activeCamera=null,this.activeCallback=null,this.duration=e,this.view=i,this.flyToMode=t}Ute.prototype.play=function(e,t,i){if(this.activeCamera=t,Object(u.a)(e)&&null!==e){var n=this;this.activeCallback=function(t){delete n.activeCallback,delete n.activeCamera,e(!Object(u.a)(t)&&t)}}var r=this.getCameraOptions(i);if(this.view.headingPitchRoll)t.flyTo(r);else if(this.view.headingPitchRange){var a=new St(this.view.position);t.flyToBoundingSphere(a,r)}},Ute.prototype.stop=function(){Object(u.a)(this.activeCamera)&&this.activeCamera.cancelFlight(),Object(u.a)(this.activeCallback)&&this.activeCallback(!0)},Ute.prototype.getCameraOptions=function(e){var t={duration:this.duration};return Object(u.a)(this.activeCallback)&&(t.complete=this.activeCallback),"smooth"===this.flyToMode&&(t.easingFunction=Pv.LINEAR_NONE),this.view.headingPitchRoll?(t.destination=this.view.position,t.orientation=this.view.headingPitchRoll):this.view.headingPitchRange&&(t.offset=this.view.headingPitchRange),Object(u.a)(e)&&(t=Object(ff.a)(t,e)),t};var Vte=Ute;function Hte(e){this.type="KmlTourWait",this.blocking=!0,this.duration=e,this.timeout=null}Hte.prototype.play=function(e){var t=this;this.activeCallback=e,this.timeout=setTimeout((function(){delete t.activeCallback,e(!1)}),1e3*this.duration)},Hte.prototype.stop=function(){clearTimeout(this.timeout),Object(u.a)(this.activeCallback)&&this.activeCallback(!0)};var Gte=Hte,qte={avi:"video/x-msvideo",bmp:"image/bmp",bz2:"application/x-bzip2",chm:"application/vnd.ms-htmlhelp",css:"text/css",csv:"text/csv",doc:"application/msword",dvi:"application/x-dvi",eps:"application/postscript",flv:"video/x-flv",gif:"image/gif",gz:"application/x-gzip",htm:"text/html",html:"text/html",ico:"image/vnd.microsoft.icon",jnlp:"application/x-java-jnlp-file",jpeg:"image/jpeg",jpg:"image/jpeg",m3u:"audio/x-mpegurl",m4v:"video/mp4",mathml:"application/mathml+xml",mid:"audio/midi",midi:"audio/midi",mov:"video/quicktime",mp3:"audio/mpeg",mp4:"video/mp4",mp4v:"video/mp4",mpeg:"video/mpeg",mpg:"video/mpeg",odp:"application/vnd.oasis.opendocument.presentation",ods:"application/vnd.oasis.opendocument.spreadsheet",odt:"application/vnd.oasis.opendocument.text",ogg:"application/ogg",pdf:"application/pdf",png:"image/png",pps:"application/vnd.ms-powerpoint",ppt:"application/vnd.ms-powerpoint",ps:"application/postscript",qt:"video/quicktime",rdf:"application/rdf+xml",rss:"application/rss+xml",rtf:"application/rtf",svg:"image/svg+xml",swf:"application/x-shockwave-flash",text:"text/plain",tif:"image/tiff",tiff:"image/tiff",txt:"text/plain",wav:"audio/x-wav",wma:"audio/x-ms-wma",wmv:"video/x-ms-wmv",xml:"application/xml",zip:"application/zip",detectFromFilename:function(e){var t=e.toLowerCase();return t=Object(ry.a)(t),qte[t]}},Wte=new DOMParser,Yte=new jte({stripPrefix:!1,twitter:!1,email:!1,replaceFn:function(e,t){if(!t.protocolUrlMatch)return!1}}),Xte=32,Zte=2414016,Qte=1,Kte=16093e3,Jte=.1;function $te(e){var t,i,n,r={xsi:"http://www.w3.org/2001/XMLSchema-instance"};for(var a in r)r.hasOwnProperty(a)&&(n="xmlns:"+a+"=",RegExp("[< ]"+a+":").test(e)&&-1===e.indexOf(n)&&(Object(u.a)(t)||(t=e.substr(0,e.indexOf("<kml")+4),i=e.substr(t.length)),t+=" "+n+'"'+r[a]+'"'));return Object(u.a)(t)&&(e=t+i),e}function eie(e){for(var t,i,n,r=e.indexOf("xmlns:"),a=e.indexOf(">",r);-1!==r&&r<a;)t=e.slice(r,e.indexOf('"',r)),i=r,-1!==(r=e.indexOf(t,r+1))?(n=e.indexOf('"',e.indexOf('"',r)+1),r=(e=e.slice(0,r-1)+e.slice(n+1,e.length)).indexOf("xmlns:",i-1)):r=e.indexOf("xmlns:",i+1);return e}function tie(e,t,i){var n=Object(w.a)(qte.detectFromFilename(e.filename),"application/octet-stream");e.getData(new Rte.Data64URIWriter(n),(function(n){t[e.filename]=n,i.resolve()}))}function iie(e,t,i,n){for(var r=n.keys,a=new Co.a("."),o=e.querySelectorAll(t),s=0;s<o.length;s++){var c=o[s],l=c.getAttribute(i),u=new Co.a(l).resolve(a).toString(),h=r.indexOf(u);if(-1!==h){var d=r[h];c.setAttribute(i,n[d]),"a"===t&&null===c.getAttribute("download")&&c.setAttribute("download",d)}}}function nie(e,t,i,n){for(var r=e.querySelectorAll(t),a=0;a<r.length;a++){var o=r[a],s=bie(o.getAttribute(i),n);o.setAttribute(i,s.url)}}function rie(e,t,i){var n=die(e,"id");n=Object(u.a)(n)&&0!==n.length?n:Mg(),Object(u.a)(i)&&(n=i+n);var r=t.getById(n);return Object(u.a)(r)&&(n=Mg(),Object(u.a)(i)&&(n=i+n)),r=t.add(new zz({id:n})),Object(u.a)(r.kml)||(r.addProperty("kml"),r.kml=new sne),r}function aie(e,t){return"absolute"===e||"relativeToGround"===e||"relativeToSeaFloor"===t}function oie(e,t){if(!Object(u.a)(e))return z.fromDegrees(0,0,0,t);var i=e.match(/[^\s,\n]+/g);if(!Object(u.a)(i))return z.fromDegrees(0,0,0,t);var n=parseFloat(i[0]),r=parseFloat(i[1]),a=parseFloat(i[2]);return n=isNaN(n)?0:n,r=isNaN(r)?0:r,a=isNaN(a)?0:a,z.fromDegrees(n,r,a,t)}function sie(e,t){if(Object(u.a)(e)){var i=e.textContent.match(/[^\s\n]+/g);if(Object(u.a)(i)){for(var n=i.length,r=new Array(n),a=0,o=0;o<n;o++)r[a++]=oie(i[o],t);return r}}}var cie=[null,void 0,"http://www.opengis.net/kml/2.2","http://earth.google.com/kml/2.2","http://earth.google.com/kml/2.1","http://earth.google.com/kml/2.0"],lie=["http://www.google.com/kml/ext/2.2"],uie={kml:cie,gx:lie,atom:["http://www.w3.org/2005/Atom"],kmlgx:cie.concat(lie)};function hie(e,t){if(Object(u.a)(e)){var i=e.getAttribute(t);if(null!==i){var n=parseFloat(i);return isNaN(n)?void 0:n}}}function die(e,t){if(Object(u.a)(e)){var i=e.getAttribute(t);return null!==i?i:void 0}}function fie(e,t,i){if(Object(u.a)(e))for(var n=e.childNodes,r=n.length,a=0;a<r;a++){var o=n[a];if(o.localName===t&&-1!==i.indexOf(o.namespaceURI))return o}}function pie(e,t,i){if(Object(u.a)(e)){for(var n=[],r=e.getElementsByTagNameNS("*",t),a=r.length,o=0;o<a;o++){var s=r[o];s.localName===t&&-1!==i.indexOf(s.namespaceURI)&&n.push(s)}return n}}function mie(e,t,i){if(!Object(u.a)(e))return[];for(var n=[],r=e.childNodes,a=r.length,o=0;o<a;o++){var s=r[o];s.localName===t&&-1!==i.indexOf(s.namespaceURI)&&n.push(s)}return n}function _ie(e,t,i){var n=fie(e,t,i);if(Object(u.a)(n)){var r=parseFloat(n.textContent);return isNaN(r)?void 0:r}}function gie(e,t,i){var n=fie(e,t,i);if(Object(u.a)(n))return n.textContent.trim()}function vie(e,t,i){var n=fie(e,t,i);if(Object(u.a)(n)){var r=n.textContent.trim();return"1"===r||/^true$/i.test(r)}}function bie(e,t,i){if(Object(u.a)(e)){var n;if(Object(u.a)(i)){var r=i[e];if(Object(u.a)(r))n=new f.a({url:r});else{var a=new Co.a(t.getUrlComponent());r=i[new Co.a(e).resolve(a)],Object(u.a)(r)&&(n=new f.a({url:r}))}}return Object(u.a)(n)||(n=t.getDerivedResource({url:e})),n}}var yie={maximumRed:void 0,red:void 0,maximumGreen:void 0,green:void 0,maximumBlue:void 0,blue:void 0};function wie(e,t){if(Object(u.a)(e)&&!/^\s*$/gm.test(e)){"#"===e[0]&&(e=e.substring(1));var i=parseInt(e.substring(0,2),16)/255,n=parseInt(e.substring(2,4),16)/255,r=parseInt(e.substring(4,6),16)/255,a=parseInt(e.substring(6,8),16)/255;return t?(a>0?(yie.maximumRed=a,yie.red=void 0):(yie.maximumRed=void 0,yie.red=0),r>0?(yie.maximumGreen=r,yie.green=void 0):(yie.maximumGreen=void 0,yie.green=0),n>0?(yie.maximumBlue=n,yie.blue=void 0):(yie.maximumBlue=void 0,yie.blue=0),yie.alpha=i,uf.fromRandom(yie)):new uf(a,r,n,i)}}function Oie(e,t,i){var n=gie(e,t,i);if(Object(u.a)(n))return wie(n,"random"===gie(e,"colorMode",i))}function xie(){var e=new $I;return e.width=Xte,e.height=Xte,e.scaleByDistance=new Fx(Zte,Qte,Kte,Jte),e.pixelOffsetScaleByDistance=new Fx(Zte,Qte,Kte,Jte),e}function Eie(){var e=new xz;return e.outline=!0,e.outlineColor=uf.WHITE,e}function Tie(){var e=new oz;return e.translucencyByDistance=new Fx(3e6,1,5e6,0),e.pixelOffset=new Rt(17,0),e.horizontalOrigin=tD.LEFT,e.font="16px sans-serif",e.style=rG.FILL_AND_OUTLINE,e}function Cie(e,t,i,n,r){var a=gie(e,"href",uie.kml);if(Object(u.a)(a)&&0!==a.length){if(0===a.indexOf("root://icons/palette-")){var o=a.charAt(21),s=Object(w.a)(_ie(e,"x",uie.gx),0),c=Object(w.a)(_ie(e,"y",uie.gx),0);s=Math.min(s/32,7),a="https://maps.google.com/mapfiles/kml/pal"+o+"/icon"+(8*(c=7-Math.min(c/32,7))+s)+".png"}var l=bie(a,i,n);if(r){var h=gie(e,"refreshMode",uie.kml),d=gie(e,"viewRefreshMode",uie.kml);"onInterval"===h||"onExpire"===h?Object(iE.a)("kml-refreshMode-"+h,"KML - Unsupported Icon refreshMode: "+h):"onStop"!==d&&"onRegion"!==d||Object(iE.a)("kml-refreshMode-"+d,"KML - Unsupported Icon viewRefreshMode: "+d);var f=Object(w.a)(gie(e,"viewBoundScale",uie.kml),1),p="onStop"===d?"BBOX=[bboxWest],[bboxSouth],[bboxEast],[bboxNorth]":"",m=Object(w.a)(gie(e,"viewFormat",uie.kml),p),_=gie(e,"httpQuery",uie.kml);Object(u.a)(m)&&l.setQueryParameters(Object(HT.a)(Zie(m))),Object(u.a)(_)&&l.setQueryParameters(Object(HT.a)(Zie(_)));var g=t._ellipsoid;return ene(l,t._camera,t._canvas,f,t._lastCameraView.bbox,g),l}return l}}function Sie(e,t,i,n,r){var a=_ie(t,"scale",uie.kml),o=_ie(t,"heading",uie.kml),s=Oie(t,"color",uie.kml),c=fie(t,"Icon",uie.kml),l=Cie(c,e,n,r,!1);Object(u.a)(c)&&!Object(u.a)(l)&&(l=!1);var h,d,f=_ie(c,"x",uie.gx),p=_ie(c,"y",uie.gx),m=_ie(c,"w",uie.gx),_=_ie(c,"h",uie.gx),g=fie(t,"hotSpot",uie.kml),v=hie(g,"x"),b=hie(g,"y"),y=die(g,"xunits"),O=die(g,"yunits"),x=i.billboard;Object(u.a)(x)||(x=xie(),i.billboard=x),x.image=l,x.scale=a,x.color=s,(Object(u.a)(f)||Object(u.a)(p)||Object(u.a)(m)||Object(u.a)(_))&&(x.imageSubRegion=new ln(f,p,m,_)),Object(u.a)(o)&&0!==o&&(x.rotation=I.toRadians(-o),x.alignedAxis=z.UNIT_Z),a=Object(w.a)(a,1),Object(u.a)(v)&&("pixels"===y?h=-v*a:"insetPixels"===y?h=(v-Xte)*a:"fraction"===y&&(h=-v*Xte*a),h+=.5*Xte*a),Object(u.a)(b)&&("pixels"===O?d=b*a:"insetPixels"===O?d=(-b+Xte)*a:"fraction"===O&&(d=b*Xte*a),d-=.5*Xte*a),(Object(u.a)(h)||Object(u.a)(d))&&(x.pixelOffset=new Rt(h,d))}function Aie(e,t,i,n,r){for(var a=0,o=t.childNodes.length;a<o;a++){var s=t.childNodes.item(a);if("IconStyle"===s.localName)Sie(e,s,i,n,r);else if("LabelStyle"===s.localName){var c=i.label;Object(u.a)(c)||(c=Tie(),i.label=c),c.scale=Object(w.a)(_ie(s,"scale",uie.kml),c.scale),c.fillColor=Object(w.a)(Oie(s,"color",uie.kml),c.fillColor),c.text=i.name}else if("LineStyle"===s.localName){var l=i.polyline;Object(u.a)(l)||(l=new Tz,i.polyline=l),l.width=_ie(s,"width",uie.kml),l.material=Oie(s,"color",uie.kml),Object(u.a)(Oie(s,"outerColor",uie.gx))&&Object(iE.a)("kml-gx:outerColor","KML - gx:outerColor is not supported in a LineStyle"),Object(u.a)(_ie(s,"outerWidth",uie.gx))&&Object(iE.a)("kml-gx:outerWidth","KML - gx:outerWidth is not supported in a LineStyle"),Object(u.a)(_ie(s,"physicalWidth",uie.gx))&&Object(iE.a)("kml-gx:physicalWidth","KML - gx:physicalWidth is not supported in a LineStyle"),Object(u.a)(vie(s,"labelVisibility",uie.gx))&&Object(iE.a)("kml-gx:labelVisibility","KML - gx:labelVisibility is not supported in a LineStyle")}else if("PolyStyle"===s.localName){var h=i.polygon;Object(u.a)(h)||(h=Eie(),i.polygon=h),h.material=Object(w.a)(Oie(s,"color",uie.kml),h.material),h.fill=Object(w.a)(vie(s,"fill",uie.kml),h.fill),h.outline=Object(w.a)(vie(s,"outline",uie.kml),h.outline)}else if("BalloonStyle"===s.localName){var d=Object(w.a)(wie(gie(s,"bgColor",uie.kml)),uf.WHITE),f=Object(w.a)(wie(gie(s,"textColor",uie.kml)),uf.BLACK),p=gie(s,"text",uie.kml);i.addProperty("balloonStyle"),i.balloonStyle={bgColor:d,textColor:f,text:p}}else if("ListStyle"===s.localName){var m=gie(s,"listItemType",uie.kml);"radioFolder"!==m&&"checkOffOnly"!==m||Object(iE.a)("kml-listStyle-"+m,"KML - Unsupported ListStyle with listItemType: "+m)}}}function Pie(e,t,i){return t.fetchXML().then((function(n){return Iie(e,n,i,t,!0)}))}function Iie(e,t,i,n,r,a){var o,s,c,l,h=pie(t,"Style",uie.kml);if(Object(u.a)(h)){var d=h.length;for(o=0;o<d;o++)s=die(l=h[o],"id"),Object(u.a)(s)&&(s="#"+s,r&&Object(u.a)(n)&&(s=n.getUrlComponent()+s),Object(u.a)(i.getById(s))||(c=new zz({id:s}),i.add(c),Aie(e,l,c,n,a)))}var f=pie(t,"StyleMap",uie.kml);if(Object(u.a)(f)){var p=f.length;for(o=0;o<p;o++){var m=f[o];if(s=die(m,"id"),Object(u.a)(s))for(var _=mie(m,"Pair",uie.kml),g=0;g<_.length;g++){var v=_[g],b=gie(v,"key",uie.kml);if("normal"===b){if(s="#"+s,r&&Object(u.a)(n)&&(s=n.getUrlComponent()+s),!Object(u.a)(i.getById(s))){c=i.getOrCreateEntity(s);var y=gie(v,"styleUrl",uie.kml);if(Object(u.a)(y)){"#"!==y[0]&&(y="#"+y),r&&Object(u.a)(n)&&(y=n.getUrlComponent()+y);var w=i.getById(y);Object(u.a)(w)&&c.merge(w)}else Aie(e,l=fie(v,"Style",uie.kml),c,n,a)}}else Object(iE.a)("kml-styleMap-"+b,"KML - Unsupported StyleMap key: "+b)}}}var O=[],x=t.getElementsByTagName("styleUrl"),E=x.length;for(o=0;o<E;o++){var T=x[o].textContent;if("#"!==T[0]){var C=T.split("#");if(2===C.length){var S=C[0],A=n.getDerivedResource({url:S});O.push(Pie(e,A,i))}}}return O}function Die(e,t,i){var n=new YW(e,t.id,["position"]),r=new C9(t.position);t.polyline=Object(u.a)(i.polyline)?i.polyline.clone():new Tz,t.polyline.positions=new VW([n,r])}function jie(e,t){return!Object(u.a)(e)&&!Object(u.a)(t)||"clampToGround"===e?eD.CLAMP_TO_GROUND:"relativeToGround"===e?eD.RELATIVE_TO_GROUND:"absolute"===e?eD.NONE:"clampToSeaFloor"===t?(Object(iE.a)("kml-gx:altitudeMode-clampToSeaFloor","KML - <gx:altitudeMode>:clampToSeaFloor is currently not supported, using <kml:altitudeMode>:clampToGround."),eD.CLAMP_TO_GROUND):"relativeToSeaFloor"===t?(Object(iE.a)("kml-gx:altitudeMode-relativeToSeaFloor","KML - <gx:altitudeMode>:relativeToSeaFloor is currently not supported, using <kml:altitudeMode>:relativeToGround."),eD.RELATIVE_TO_GROUND):(Object(u.a)(e)?Object(iE.a)("kml-altitudeMode-unknown","KML - Unknown <kml:altitudeMode>:"+e+", using <kml:altitudeMode>:CLAMP_TO_GROUND."):Object(iE.a)("kml-gx:altitudeMode-unknown","KML - Unknown <gx:altitudeMode>:"+t+", using <kml:altitudeMode>:CLAMP_TO_GROUND."),eD.CLAMP_TO_GROUND)}function Mie(e,t,i){return"relativeToSeaFloor"===i||"absolute"===t||"relativeToGround"===t?e:((Object(u.a)(t)&&"clampToGround"!==t||Object(u.a)(i)&&"clampToSeaFloor"!==i)&&Object(iE.a)("kml-altitudeMode-unknown","KML - Unknown altitudeMode: "+Object(w.a)(t,i)),new C9(e))}function Rie(e,t,i,n){var r=t.label;Object(u.a)(r)||(r=Object(u.a)(i.label)?i.label.clone():Tie(),t.label=r),r.text=t.name;var a=t.billboard;Object(u.a)(a)||(a=Object(u.a)(i.billboard)?i.billboard.clone():xie(),t.billboard=a),Object(u.a)(a.image)?a.image.getValue()||(a.image=void 0):a.image=e._pinBuilder.fromColor(uf.YELLOW,64);var o=1;Object(u.a)(a.scale)&&(0!==(o=a.scale.getValue())?r.pixelOffset=new Rt(16*o+1,0):(r.pixelOffset=void 0,r.horizontalOrigin=void 0)),Object(u.a)(n)&&e._clampToGround&&(a.heightReference=n,r.heightReference=n)}function Lie(e,t){var i=e.path;Object(u.a)(i)||((i=new gz).leadTime=0,e.path=i);var n=t.polyline;Object(u.a)(n)&&(i.material=n.material,i.width=n.width)}function Nie(e,t,i,n,r){var a=fie(i,"coordinates",uie.kml),o=gie(i,"altitudeMode",uie.kml),s=gie(i,"altitudeMode",uie.gx),c=vie(i,"extrude",uie.kml),l=vie(i,"tessellate",uie.kml),h=aie(o,s),d=_ie(i,"drawOrder",uie.gx),f=e._ellipsoid,p=sie(a,f),m=r.polyline;if(h&&c){var _=new Dz;n.wall=_,_.positions=p;var g=r.polygon;Object(u.a)(g)&&(_.fill=g.fill,_.material=g.material),_.outline=!0,Object(u.a)(m)?(_.outlineColor=Object(u.a)(m.material)?m.material.color:uf.WHITE,_.outlineWidth=m.width):Object(u.a)(g)&&(_.outlineColor=Object(u.a)(g.material)?g.material.color:uf.WHITE)}else if(e._clampToGround&&!h&&l){var v=new Tz;v.clampToGround=!0,n.polyline=v,v.positions=p,Object(u.a)(m)?(v.material=Object(u.a)(m.material)?m.material.color.getValue(nx.MINIMUM_VALUE):uf.WHITE,v.width=Object(w.a)(m.width,1)):(v.material=uf.WHITE,v.width=1),v.zIndex=d}else Object(u.a)(d)&&Object(iE.a)("kml-gx:drawOrder","KML - gx:drawOrder is not supported in LineStrings when clampToGround is false"),m=Object(u.a)(m)?m.clone():new Tz,n.polyline=m,m.positions=function(e,t,i,n){if(Object(u.a)(e)){if("relativeToSeaFloor"===i||"absolute"===t||"relativeToGround"===t)return e;(Object(u.a)(t)&&"clampToGround"!==t||Object(u.a)(i)&&"clampToSeaFloor"!==i)&&Object(iE.a)("kml-altitudeMode-unknown","KML - Unknown altitudeMode: "+Object(w.a)(t,i));for(var r=e.length,a=0;a<r;a++){var o=e[a];n.scaleToGeodeticSurface(o,o)}return e}}(p,o,s,f),l&&!h||(m.followSurface=!1);return!0}function Fie(e,t,i,n,r,a,o,s,c){var l=e[0],u=e[e.length-1],h=new rY;h.addSamples(e,t),i.intervals.addInterval(new ex({start:l,stop:u,isStartIncluded:c,isStopIncluded:c,data:Mie(h,o,s)})),n.addInterval(new ex({start:l,stop:u,isStartIncluded:c,isStopIncluded:c})),r.intervals.addInterval(new ex({start:l,stop:u,isStartIncluded:c,isStopIncluded:c,data:a}))}var kie={Point:function(e,t,i,n,r){var a=gie(i,"coordinates",uie.kml),o=gie(i,"altitudeMode",uie.kml),s=gie(i,"altitudeMode",uie.gx),c=vie(i,"extrude",uie.kml),l=oie(a,e._ellipsoid);return n.position=l,Rie(e,n,r,jie(o,s)),c&&aie(o,s)&&Die(t,n,r),!0},LineString:Nie,LinearRing:Nie,Polygon:function(e,t,i,n,r){var a=fie(i,"outerBoundaryIs",uie.kml),o=fie(a,"LinearRing",uie.kml),s=fie(o,"coordinates",uie.kml),c=e._ellipsoid,l=sie(s,c),h=vie(i,"extrude",uie.kml),d=aie(gie(i,"altitudeMode",uie.kml),gie(i,"altitudeMode",uie.gx)),f=Object(u.a)(r.polygon)?r.polygon.clone():Eie(),p=r.polyline;if(Object(u.a)(p)&&(f.outlineColor=Object(u.a)(p.material)?p.material.color:uf.WHITE,f.outlineWidth=p.width),n.polygon=f,d?(f.perPositionHeight=!0,f.extrudedHeight=h?0:void 0):e._clampToGround||(f.height=0),Object(u.a)(l)){for(var m=new uT(l),_=mie(i,"innerBoundaryIs",uie.kml),g=0;g<_.length;g++){o=mie(_[g],"LinearRing",uie.kml);for(var v=0;v<o.length;v++)l=sie(s=fie(o[v],"coordinates",uie.kml),c),Object(u.a)(l)&&m.holes.push(new uT(l))}f.hierarchy=m}return!0},Track:function(e,t,i,n,r){var a=gie(i,"altitudeMode",uie.kml),o=gie(i,"altitudeMode",uie.gx),s=mie(i,"coord",uie.gx),c=mie(i,"angles",uie.gx),l=mie(i,"when",uie.kml),u=vie(i,"extrude",uie.kml),h=aie(a,o),d=e._ellipsoid;c.length>0&&Object(iE.a)("kml-gx:angles","KML - gx:angles are not supported in gx:Tracks");for(var f=Math.min(s.length,l.length),p=[],m=[],_=0;_<f;_++){var g=oie(s[_].textContent,d);p.push(g),m.push(Tr.fromIso8601(l[_].textContent))}var v=new rY;return v.addSamples(m,p),n.position=v,Rie(e,n,r,jie(a,o)),Lie(n,r),n.availability=new eI,l.length>0&&n.availability.addInterval(new ex({start:m[0],stop:m[m.length-1]})),h&&u&&Die(t,n,r),!0},MultiTrack:function(e,t,i,n,r){for(var a,o,s,c=vie(i,"interpolate",uie.gx),l=mie(i,"Track",uie.gx),h=!1,d=new pY,f=new eI,p=new kU,m=e._ellipsoid,_=0,g=l.length;_<g;_++){var v=l[_],b=mie(v,"when",uie.kml),y=mie(v,"coord",uie.gx),w=gie(v,"altitudeMode",uie.kml),O=gie(v,"altitudeMode",uie.gx),x=aie(w,O),E=vie(v,"extrude",uie.kml),T=Math.min(y.length,b.length),C=[];a=[];for(var S=0;S<T;S++){var A=oie(y[S].textContent,m);C.push(A),a.push(Tr.fromIso8601(b[S].textContent))}c&&(Object(u.a)(o)&&Fie([o,a[0]],[s,C[0]],p,f,d,!1,"absolute",void 0,!1),o=a[T-1],s=C[C.length-1]),Fie(a,C,p,f,d,x&&E,w,O,!0),h=h||x&&E}return n.availability=f,n.position=p,Rie(e,n,r),Lie(n,r),h&&(Die(t,n,r),n.polyline.show=d),!0},MultiGeometry:function(e,t,i,n,r,a){for(var o=i.childNodes,s=!1,c=0,l=o.length;c<l;c++){var h=o.item(c),d=kie[h.localName];if(Object(u.a)(d)){var f=rie(h,t,a);f.parent=n,f.name=n.name,f.availability=n.availability,f.description=n.description,f.kml=n.kml,d(e,t,h,f,r)&&(s=!0)}}return s},Model:function(e,t,i,n,r){return Object(iE.a)("kml-unsupportedGeometry","KML - Unsupported geometry: "+i.localName),!1}};var Bie=document.createElement("div");function zie(e,t,i,n,r,a,o,s,c){var l=rie(i,n,c),h=l.kml,d=function(e,t,i,n,r){for(var a,o=new zz,s=-1,c=t.childNodes,l=c.length,h=0;h<l;h++){var d=c[h];"Style"!==d.localName&&"StyleMap"!==d.localName||(s=h)}if(-1!==s){var f=c[s];if("Style"===f.localName)Aie(e,f,o,n,r);else for(var p=mie(f,"Pair",uie.kml),m=0;m<p.length;m++){var _=p[m],g=gie(_,"key",uie.kml);if("normal"===g){var v=gie(_,"styleUrl",uie.kml);if(Object(u.a)(v))a=i.getById(v),Object(u.a)(a)||(a=i.getById("#"+v)),Object(u.a)(a)&&o.merge(a);else Aie(e,fie(_,"Style",uie.kml),o,n,r)}else Object(iE.a)("kml-styleMap-"+g,"KML - Unsupported StyleMap key: "+g)}}var b=gie(t,"styleUrl",uie.kml);if(Object(u.a)(b)){var y=b;if("#"!==b[0]&&-1!==b.indexOf("#")){var w=b.split("#"),O=w[0];y=n.getDerivedResource({url:O}).getUrlComponent()+"#"+w[1]}a=i.getById(y),Object(u.a)(a)||(a=i.getById("#"+y)),Object(u.a)(a)&&o.merge(a)}return o}(e,i,r,a,o),f=gie(i,"name",uie.kml);l.name=f,l.parent=t;var p=function(e){var t=fie(e,"TimeSpan",uie.kmlgx);if(Object(u.a)(t)){var i,n=fie(t,"begin",uie.kmlgx),r=Object(u.a)(n)?Tr.fromIso8601(n.textContent):void 0,a=fie(t,"end",uie.kmlgx),o=Object(u.a)(a)?Tr.fromIso8601(a.textContent):void 0;if(Object(u.a)(r)&&Object(u.a)(o)){if(Tr.lessThan(o,r)){var s=r;r=o,o=s}(i=new eI).addInterval(new ex({start:r,stop:o}))}else Object(u.a)(r)?(i=new eI).addInterval(new ex({start:r,stop:nx.MAXIMUM_VALUE})):Object(u.a)(o)&&(i=new eI).addInterval(new ex({start:nx.MINIMUM_VALUE,stop:o}));return i}}(i);Object(u.a)(p)||(p=function(e){var t=fie(e,"TimeStamp",uie.kmlgx),i=gie(t,"when",uie.kmlgx);if(Object(u.a)(t)&&Object(u.a)(i)&&0!==i.length){var n=Tr.fromIso8601(i),r=new eI;return r.addInterval(new ex({start:n,stop:nx.MAXIMUM_VALUE})),r}}(i)),l.availability=p,ane(l);var m=vie(i,"visibility",uie.kml);l.show=function e(t){return!t||t.show&&e(t.parent)}(t)&&Object(w.a)(m,!0);var _=fie(i,"author",uie.atom),g=h.author;g.name=gie(_,"name",uie.atom),g.uri=gie(_,"uri",uie.atom),g.email=gie(_,"email",uie.atom);var v=fie(i,"link",uie.atom),b=h.link;b.href=die(v,"href"),b.hreflang=die(v,"hreflang"),b.rel=die(v,"rel"),b.type=die(v,"type"),b.title=die(v,"title"),b.length=die(v,"length"),h.address=gie(i,"address",uie.kml),h.phoneNumber=gie(i,"phoneNumber",uie.kml),h.snippet=gie(i,"Snippet",uie.kml),function(e,t){var i=fie(e,"ExtendedData",uie.kml);if(Object(u.a)(i)){Object(u.a)(fie(i,"SchemaData",uie.kml))&&Object(iE.a)("kml-schemaData","KML - SchemaData is unsupported"),Object(u.a)(die(i,"xmlns:prefix"))&&Object(iE.a)("kml-extendedData","KML - ExtendedData with xmlns:prefix is unsupported");var n={},r=mie(i,"Data",uie.kml);if(Object(u.a)(r))for(var a=r.length,o=0;o<a;o++){var s=r[o],c=die(s,"name");Object(u.a)(c)&&(n[c]={displayName:gie(s,"displayName",uie.kml),value:gie(s,"value",uie.kml)})}t.kml.extendedData=n}}(i,l),function(e,t,i,n,r){var a,o,s,c,l=t.kml,h=l.extendedData,d=gie(e,"description",uie.kml),f=Object(w.a)(t.balloonStyle,i.balloonStyle),p=uf.WHITE,m=uf.BLACK,_=d;if(Object(u.a)(f)&&(p=Object(w.a)(f.bgColor,uf.WHITE),m=Object(w.a)(f.textColor,uf.BLACK),_=Object(w.a)(f.text,d)),Object(u.a)(_)){if(_=(_=(_=(_=(_=(_=_.replace("$[name]",Object(w.a)(t.name,""))).replace("$[description]",Object(w.a)(d,""))).replace("$[address]",Object(w.a)(l.address,""))).replace("$[Snippet]",Object(w.a)(l.snippet,""))).replace("$[id]",t.id)).replace("$[geDirections]",""),Object(u.a)(h)){var g=_.match(/\$\[.+?\]/g);if(null!==g)for(a=0;a<g.length;a++){var v=g[a],b=v.substr(2,v.length-3),y=/\/displayName$/.test(b);c=h[b=b.replace(/\/displayName$/,"")],Object(u.a)(c)&&(c=y?c.displayName:c.value),Object(u.a)(c)&&(_=_.replace(v,Object(w.a)(c,"")))}}}else if(Object(u.a)(h)&&(s=Object.keys(h)).length>0){for(_='<table class="cesium-infoBox-defaultTable cesium-infoBox-defaultTable-lighter"><tbody>',a=0;a<s.length;a++)c=h[o=s[a]],_+="<tr><th>"+Object(w.a)(c.displayName,o)+"</th><td>"+Object(w.a)(c.value,"")+"</td></tr>";_+="</tbody></table>"}if(Object(u.a)(_)){_=Yte.link(_),Bie.innerHTML=_;var O=Bie.querySelectorAll("a");for(a=0;a<O.length;a++)O[a].setAttribute("target","_blank");Object(u.a)(n)&&n.keys.length>1&&(iie(Bie,"a","href",n),iie(Bie,"img","src",n)),nie(Bie,"a","href",r),nie(Bie,"img","src",r);var x='<div class="cesium-infoBox-description-lighter" style="';x+="overflow:auto;",x+="word-wrap:break-word;",x+="background-color:"+p.toCssColorString()+";",x+="color:"+m.toCssColorString()+";",x+='">',x+=Bie.innerHTML+"</div>",Bie.innerHTML="",t.description=x}}(i,l,d,o,a);var y=e._ellipsoid;return Wie(i,l,y),qie(i,l,y),Object(u.a)(fie(i,"Region",uie.kml))&&Object(iE.a)("kml-region","KML - Placemark Regions are unsupported"),{entity:l,styleEntity:d}}var Uie={Document:Vie,Folder:function(e,t,i,n,r,a,o,s,c){var l=zie(e,t,i,n,r,a,o,0,c);Vie(e,l.entity,i,n,r,a,o,s,c)},Placemark:function(e,t,i,n,r,a,o,s,c){for(var l=zie(e,t,i,n,r,a,o,0,c),h=l.entity,d=l.styleEntity,f=!1,p=i.childNodes,m=0,_=p.length;m<_&&!f;m++){var g=p.item(m),v=kie[g.localName];Object(u.a)(v)&&(v(e,n,g,h,d,h.id),f=!0)}f||(h.merge(d),Rie(e,h,d))},NetworkLink:function(e,t,i,n,r,a,o,s,c){var l=zie(e,t,i,n,r,a,o,0,c).entity,h=fie(i,"Link",uie.kml);Object(u.a)(h)||(h=fie(i,"Url",uie.kml));if(Object(u.a)(h)){var d,f,p=gie(h,"href",uie.kml);if(Object(u.a)(p)){var m=p;if(p=bie(p,a,o),/^data:/.test(p.getUrlComponent()))/\.kmz/i.test(a.getUrlComponent())||(m=a.getDerivedResource({url:m}));else{m=p.clone(),d=gie(h,"viewRefreshMode",uie.kml),f=Object(w.a)(gie(h,"viewBoundScale",uie.kml),1);var _="onStop"===d?"BBOX=[bboxWest],[bboxSouth],[bboxEast],[bboxNorth]":"",g=Object(w.a)(gie(h,"viewFormat",uie.kml),_),v=gie(h,"httpQuery",uie.kml);Object(u.a)(g)&&p.setQueryParameters(Object(HT.a)(Zie(g))),Object(u.a)(v)&&p.setQueryParameters(Object(HT.a)(Zie(v)));var b=e._ellipsoid;ene(p,e._camera,e._canvas,f,e._lastCameraView.bbox,b)}var y={sourceUri:m,uriResolver:o,context:l.id},O=new OU,x=nne(e,O,p,y).then((function(t){var i=e._entityCollection,n=O.values;i.suspendEvents();for(var r=0;r<n.length;r++){var a=n[r];Object(u.a)(a.parent)||(a.parent=l,ane(a)),i.add(a)}i.resumeEvents();var o=gie(h,"refreshMode",uie.kml),s=Object(w.a)(_ie(h,"refreshInterval",uie.kml),0);if("onInterval"===o&&s>0||"onExpire"===o||"onStop"===d){var c=fie(t,"NetworkLinkControl",uie.kml),m=Object(u.a)(c),_=Tr.now(),g={id:Mg(),href:p,cookie:{},lastUpdated:_,updating:!1,entity:l,viewBoundScale:f,needsUpdate:!1,cameraUpdateTime:_},v=0;if(m&&(g.cookie=Object(HT.a)(Object(w.a)(gie(c,"cookie",uie.kml),"")),v=Object(w.a)(_ie(c,"minRefreshPeriod",uie.kml),0)),"onInterval"===o)m&&(s=Math.max(v,s)),g.refreshMode=Xie.INTERVAL,g.time=s;else if("onExpire"===o){var b;if(m&&(b=gie(c,"expires",uie.kml)),Object(u.a)(b))try{var y=Tr.fromIso8601(b),x=Tr.secondsDifference(y,_);x>0&&x<v&&Tr.addSeconds(_,v,y),g.refreshMode=Xie.EXPIRE,g.time=y}catch(e){Object(iE.a)("kml-refreshMode-onInterval-onExpire","KML - NetworkLinkControl expires is not a valid date")}else Object(iE.a)("kml-refreshMode-onExpire","KML - refreshMode of onExpire requires the NetworkLinkControl to have an expires element")}else e._camera?(g.refreshMode=Xie.STOP,g.time=Object(w.a)(_ie(h,"viewRefreshTime",uie.kml),0)):Object(iE.a)("kml-refrehMode-onStop-noCamera","A NetworkLink with viewRefreshMode=onStop requires a camera be passed in when creating the KmlDataSource");Object(u.a)(g.refreshMode)&&e._networkLinks.set(g.id,g)}else"onRegion"===d&&Object(iE.a)("kml-refrehMode-onRegion","KML - Unsupported viewRefreshMode: onRegion")})).otherwise((function(t){Object(iE.a)("An error occured during loading "+p.url),e._error.raiseEvent(e,t)}));s.push(x)}}},GroundOverlay:function(e,t,i,n,r,a,o,s,c){var l,h=zie(e,t,i,n,r,a,o,0,c).entity,d=!1,f=e._ellipsoid,p=sie(fie(i,"LatLonQuad",uie.gx),f),m=_ie(i,"drawOrder",uie.kml);if(Object(u.a)(p))(l=Eie()).hierarchy=new uT(p),l.zIndex=m,h.polygon=l,d=!0;else{(l=new Pz).zIndex=m,h.rectangle=l;var _=fie(i,"LatLonBox",uie.kml);if(Object(u.a)(_)){var g=_ie(_,"west",uie.kml),v=_ie(_,"south",uie.kml),b=_ie(_,"east",uie.kml),y=_ie(_,"north",uie.kml);Object(u.a)(g)&&(g=I.negativePiToPi(I.toRadians(g))),Object(u.a)(v)&&(v=I.clampToLatitudeRange(I.toRadians(v))),Object(u.a)(b)&&(b=I.negativePiToPi(I.toRadians(b))),Object(u.a)(y)&&(y=I.clampToLatitudeRange(I.toRadians(y))),l.coordinates=new Ve(g,v,b,y);var w=_ie(_,"rotation",uie.kml);if(Object(u.a)(w)){var O=I.toRadians(w);l.rotation=O,l.stRotation=O}}}var x=fie(i,"Icon",uie.kml),E=Cie(x,e,a,o,!0);if(Object(u.a)(E)){d&&Object(iE.a)("kml-gx:LatLonQuad","KML - gx:LatLonQuad Icon does not support texture projection.");var T=_ie(x,"x",uie.gx),C=_ie(x,"y",uie.gx),S=_ie(x,"w",uie.gx),A=_ie(x,"h",uie.gx);(Object(u.a)(T)||Object(u.a)(C)||Object(u.a)(S)||Object(u.a)(A))&&Object(iE.a)("kml-groundOverlay-xywh","KML - gx:x, gx:y, gx:w, gx:h aren't supported for GroundOverlays"),l.material=E,l.material.color=Oie(i,"color",uie.kml),l.material.transparent=!0}else l.material=Oie(i,"color",uie.kml);var P=gie(i,"altitudeMode",uie.kml);Object(u.a)(P)?"absolute"===P?(l.height=_ie(i,"altitude",uie.kml),l.zIndex=void 0):"clampToGround"!==P&&Object(iE.a)("kml-altitudeMode-unknown","KML - Unknown altitudeMode: "+P):"relativeToSeaFloor"===(P=gie(i,"altitudeMode",uie.gx))?(Object(iE.a)("kml-altitudeMode-relativeToSeaFloor","KML - altitudeMode relativeToSeaFloor is currently not supported, treating as absolute."),l.height=_ie(i,"altitude",uie.kml),l.zIndex=void 0):"clampToSeaFloor"===P?Object(iE.a)("kml-altitudeMode-clampToSeaFloor","KML - altitudeMode clampToSeaFloor is currently not supported, treating as clampToGround."):Object(u.a)(P)&&Object(iE.a)("kml-altitudeMode-unknown","KML - Unknown altitudeMode: "+P)},PhotoOverlay:Yie,ScreenOverlay:Yie,Tour:function(e,t,i,n,r,a,o,s,c){var l=gie(i,"name",uie.kml),h=die(i,"id"),d=new zte(l,h),f=fie(i,"Playlist",uie.gx);if(f)for(var p=e._ellipsoid,m=f.childNodes,_=0;_<m.length;_++){var g=m[_];if(g.localName){var v=Hie[g.localName];v?v(d,g,p):console.log("Unknown KML Tour playlist entry type "+g.localName)}}Object(u.a)(e.kmlTours)||(e.kmlTours=[]);e.kmlTours.push(d)}};function Vie(e,t,i,n,r,a,o,s,c){for(var l=Object.keys(Uie),u=l.length,h=0;h<u;h++)for(var d=l[h],f=Uie[d],p=i.childNodes,m=p.length,_=0;_<m;_++){var g=p[_];g.localName!==d||-1===uie.kml.indexOf(g.namespaceURI)&&-1===uie.gx.indexOf(g.namespaceURI)||f(e,t,g,n,r,a,o,s,c)}}var Hie={FlyTo:function(e,t,i){var n=_ie(t,"duration",uie.gx),r=gie(t,"flyToMode",uie.gx),a={kml:{}};Wie(t,a,i),qie(t,a,i);var o=a.kml.lookAt||a.kml.camera,s=new Vte(n,r,o);e.addPlaylistEntry(s)},Wait:function(e,t){var i=_ie(t,"duration",uie.gx);e.addPlaylistEntry(new Gte(i))},SoundCue:Gie,AnimatedUpdate:Gie,TourControl:Gie};function Gie(e,t){Object(iE.a)("KML Tour unsupported node "+t.localName)}function qie(e,t,i){var n=fie(e,"Camera",uie.kml);if(Object(u.a)(n)){var r=Object(w.a)(_ie(n,"longitude",uie.kml),0),a=Object(w.a)(_ie(n,"latitude",uie.kml),0),o=Object(w.a)(_ie(n,"altitude",uie.kml),0),s=Object(w.a)(_ie(n,"heading",uie.kml),0),c=Object(w.a)(_ie(n,"tilt",uie.kml),0),l=Object(w.a)(_ie(n,"roll",uie.kml),0),h=z.fromDegrees(r,a,o,i),d=Rr.fromDegrees(s,c-90,l);t.kml.camera=new Ite(h,d)}}function Wie(e,t,i){var n=fie(e,"LookAt",uie.kml);if(Object(u.a)(n)){var r=Object(w.a)(_ie(n,"longitude",uie.kml),0),a=Object(w.a)(_ie(n,"latitude",uie.kml),0),o=Object(w.a)(_ie(n,"altitude",uie.kml),0),s=_ie(n,"heading",uie.kml),c=_ie(n,"tilt",uie.kml),l=Object(w.a)(_ie(n,"range",uie.kml),0);c=I.toRadians(Object(w.a)(c,0)),s=I.toRadians(Object(w.a)(s,0));var h=new xO(s,c-I.PI_OVER_TWO,l),d=z.fromDegrees(r,a,o,i);t.kml.lookAt=new Lte(d,h)}}function Yie(e,t,i,n,r,a,o,s,c){e._unsupportedNode.raiseEvent(e,t,i,n,r,a,o),Object(iE.a)("kml-unsupportedFeature-"+i.nodeName,"KML - Unsupported feature: "+i.nodeName)}var Xie={INTERVAL:0,EXPIRE:1,STOP:2};function Zie(e){if(!Object(u.a)(e)||0===e.length)return"";var t=e[0];return"&"!==t&&"?"!==t||(e=e.substring(1)),e}var Qie=new Ve,Kie=new K,Jie=new Rt,$ie=new z;function ene(e,t,i,n,r,a){function o(e){return e<-I.PI_OVER_TWO?-I.PI_OVER_TWO:e>I.PI_OVER_TWO?I.PI_OVER_TWO:e}function s(e){return e>I.PI?e-I.TWO_PI:e<-I.PI?e+I.TWO_PI:e}var c=Object(kx.a)(e.queryParameters);if(c=c.replace(/%5B/g,"[").replace(/%5D/g,"]"),Object(u.a)(t)&&t._mode!==xF.MORPHING){var l,h;if(r=Object(w.a)(r,Qie),Object(u.a)(i)&&(Jie.x=.5*i.clientWidth,Jie.y=.5*i.clientHeight,l=t.pickEllipsoid(Jie,a,$ie)),Object(u.a)(l)?h=a.cartesianToCartographic(l,Kie):(h=Ve.center(r,Kie),l=a.cartographicToCartesian(h)),Object(u.a)(n)&&!I.equalsEpsilon(n,1,I.EPSILON9)){var d=r.width*n*.5,f=r.height*n*.5;r=new Ve(s(h.longitude-d),o(h.latitude-f),s(h.longitude+d),o(h.latitude+f))}c=(c=(c=(c=c.replace("[bboxWest]",I.toDegrees(r.west).toString())).replace("[bboxSouth]",I.toDegrees(r.south).toString())).replace("[bboxEast]",I.toDegrees(r.east).toString())).replace("[bboxNorth]",I.toDegrees(r.north).toString());var p=I.toDegrees(h.longitude).toString(),m=I.toDegrees(h.latitude).toString();c=(c=(c=(c=(c=(c=(c=(c=c.replace("[lookatLon]",p)).replace("[lookatLat]",m)).replace("[lookatTilt]",I.toDegrees(t.pitch).toString())).replace("[lookatHeading]",I.toDegrees(t.heading).toString())).replace("[lookatRange]",z.distance(t.positionWC,l))).replace("[lookatTerrainLon]",p)).replace("[lookatTerrainLat]",m)).replace("[lookatTerrainAlt]",h.height.toString()),a.cartesianToCartographic(t.positionWC,Kie),c=(c=(c=c.replace("[cameraLon]",I.toDegrees(Kie.longitude).toString())).replace("[cameraLat]",I.toDegrees(Kie.latitude).toString())).replace("[cameraAlt]",I.toDegrees(Kie.height).toString());var _=t.frustum,g=_.aspectRatio,v="",b="";if(Object(u.a)(g)){var y=I.toDegrees(_.fov);g>1?(v=y,b=y/g):(b=y,v=y*g)}c=(c=c.replace("[horizFov]",v.toString())).replace("[vertFov]",b.toString())}else c=(c=(c=(c=(c=(c=(c=(c=(c=(c=(c=(c=(c=(c=(c=(c=(c=c.replace("[bboxWest]","-180")).replace("[bboxSouth]","-90")).replace("[bboxEast]","180")).replace("[bboxNorth]","90")).replace("[lookatLon]","")).replace("[lookatLat]","")).replace("[lookatRange]","")).replace("[lookatTilt]","")).replace("[lookatHeading]","")).replace("[lookatTerrainLon]","")).replace("[lookatTerrainLat]","")).replace("[lookatTerrainAlt]","")).replace("[cameraLon]","")).replace("[cameraLat]","")).replace("[cameraAlt]","")).replace("[horizFov]","")).replace("[vertFov]","");c=(c=(c=(c=(c=(c=Object(u.a)(i)?(c=c.replace("[horizPixels]",i.clientWidth)).replace("[vertPixels]",i.clientHeight):(c=c.replace("[horizPixels]","")).replace("[vertPixels]","")).replace("[terrainEnabled]","1")).replace("[clientVersion]","1")).replace("[kmlVersion]","2.2")).replace("[clientName]","Cesium")).replace("[language]","English"),e.setQueryParameters(Object(HT.a)(c))}function tne(e,t,i,n,r,a){t.removeAll();var o=[],s=i.documentElement,c=gie("Document"===s.localName?s:fie(s,"Document",uie.kml),"name",uie.kml);Object(u.a)(c)||(c=ay(n.getUrlComponent())),Object(u.a)(e._name)||(e._name=c);var l=new OU(e);return Oi.a.all(Iie(e,i,l,n,!1,r)).then((function(){var s=i.documentElement;if("kml"===s.localName)for(var c=s.childNodes,h=0;h<c.length;h++){var d=c[h];if(Object(u.a)(Uie[d.localName])){s=d;break}}return t.suspendEvents(),function(e,t,i,n,r,a,o,s,c){var l=Uie[t.localName];Object(u.a)(l)?l(e,i,t,n,r,a,o,s,c):Yie(e,i,t,n,r,a,o)}(e,s,void 0,t,l,n,r,o,a),t.resumeEvents(),Oi.a.all(o).then((function(){return i.documentElement}))}))}function ine(e,t,i,n){var r=Oi.a.defer();return Rte.createReader(new Rte.BlobReader(i),(function(i){i.getEntries((function(a){for(var o,s,c=[],l={},h=0;h<a.length;h++){var d=a[h];if(!d.directory){var f=Oi.a.defer();c.push(f.promise),/\.kml$/i.test(d.filename)?Object(u.a)(o)&&/\//i.test(d.filename)?tie(d,l,f):(Object(u.a)(o)&&tie(o,l,s),o=d,s=f):tie(d,l,f)}}Object(u.a)(o)&&function(e,t,i){e.getData(new Rte.TextWriter,(function(e){e=eie(e=$te(e)),t.kml=Wte.parseFromString(e,"application/xml"),i.resolve()}))}(o,l,s),Oi.a.all(c).then((function(){if(i.close(),Object(u.a)(l.kml))return l.keys=Object.keys(l),tne(e,t,l.kml,n,l);r.reject(new Ce.a("KMZ file does not contain a KML document."))})).then(r.resolve).otherwise(r.reject)}))}),(function(e){r.reject(e)})),r.promise}function nne(e,t,i,n){var r=(n=Object(w.a)(n,w.a.EMPTY_OBJECT)).sourceUri,a=n.uriResolver,o=n.context,s=i;return"string"==typeof i||i instanceof f.a?(s=(i=f.a.createIfNeeded(i)).fetchBlob(),r=Object(w.a)(r,i.clone())):r=Object(w.a)(r,f.a.DEFAULT.clone()),r=f.a.createIfNeeded(r),Object(Oi.a)(s).then((function(i){return i instanceof Blob?(n=i,s=n.slice(0,Math.min(4,n.size)),c=Oi.a.defer(),l=new FileReader,l.addEventListener("load",(function(){c.resolve(1347093252===new DataView(l.result).getUint32(0,!1))})),l.addEventListener("error",(function(){c.reject(l.error)})),l.readAsArrayBuffer(s),c.promise).then((function(n){return n?ine(e,t,i,r):function(e){var t=Oi.a.defer(),i=new FileReader;return i.addEventListener("load",(function(){t.resolve(i.result)})),i.addEventListener("error",(function(){t.reject(i.error)})),i.readAsText(e),t.promise}(i).then((function(i){var n,s;i=eie(i=$te(i));try{n=Wte.parseFromString(i,"application/xml")}catch(e){s=e.toString()}if(Object(u.a)(s)||n.body||"parsererror"===n.documentElement.tagName){var c=Object(u.a)(s)?s:n.documentElement.firstChild.nodeValue;throw c||(c=n.body.innerText),new Ce.a(c)}return tne(e,t,n,r,a,o)}))})):tne(e,t,i,r,a,o);var n,s,c,l})).otherwise((function(t){return e._error.raiseEvent(e,t),console.log(t),Oi.a.reject(t)}))}function rne(e){var t=(e=Object(w.a)(e,{})).camera,i=e.canvas;if(!Object(u.a)(t))throw new h.a("options.camera is required.");if(!Object(u.a)(i))throw new h.a("options.canvas is required.");this._changed=new $o.a,this._error=new $o.a,this._loading=new $o.a,this._refresh=new $o.a,this._unsupportedNode=new $o.a,this._clock=void 0,this._entityCollection=new OU(this),this._name=void 0,this._isLoading=!1,this._pinBuilder=new gE,this._networkLinks=new Fi,this._entityCluster=new Zq,this._canvas=i,this._camera=t,this._lastCameraView={position:Object(u.a)(t)?z.clone(t.positionWC):void 0,direction:Object(u.a)(t)?z.clone(t.directionWC):void 0,up:Object(u.a)(t)?z.clone(t.upWC):void 0,bbox:Object(u.a)(t)?t.computeViewRectangle():Ve.clone(Ve.MAX_VALUE)},this._ellipsoid=Object(w.a)(e.ellipsoid,ae.WGS84)}function ane(e){var t=e.parent;if(Object(u.a)(t)){var i=t.availability;if(Object(u.a)(i)){var n=e.availability;Object(u.a)(n)?n.intersect(i):e.availability=i}}}rne.load=function(e,t){return new rne(t=Object(w.a)(t,w.a.EMPTY_OBJECT)).load(e,t)},Object(O.a)(rne.prototype,{name:{get:function(){return this._name},set:function(e){this._name!==e&&(this._name=e,this._changed.raiseEvent(this))}},clock:{get:function(){return this._clock}},entities:{get:function(){return this._entityCollection}},isLoading:{get:function(){return this._isLoading}},changedEvent:{get:function(){return this._changed}},errorEvent:{get:function(){return this._error}},loadingEvent:{get:function(){return this._loading}},refreshEvent:{get:function(){return this._refresh}},unsupportedNodeEvent:{get:function(){return this._unsupportedNode}},show:{get:function(){return this._entityCollection.show},set:function(e){this._entityCollection.show=e}},clustering:{get:function(){return this._entityCluster},set:function(e){if(!Object(u.a)(e))throw new h.a("value must be defined.");this._entityCluster=e}}}),rne.prototype.load=function(e,t){if(!Object(u.a)(e))throw new h.a("data is required.");t=Object(w.a)(t,{}),KU.setLoading(this,!0);var i=this._name;this._name=void 0,this._clampToGround=Object(w.a)(t.clampToGround,!1);var n=this;return nne(this,this._entityCollection,e,t).then((function(){var e,t,r=n._entityCollection.computeAvailability(),a=r.start,o=r.stop,s=Tr.equals(a,nx.MINIMUM_VALUE),c=Tr.equals(o,nx.MAXIMUM_VALUE);s&&c||(s&&((t=new Date).setHours(0,0,0,0),a=Tr.fromDate(t)),c&&((t=new Date).setHours(24,0,0,0),o=Tr.fromDate(t)),(e=new lW).startTime=a,e.stopTime=o,e.currentTime=Tr.clone(a),e.clockRange=Xd.LOOP_STOP,e.clockStep=Zd.SYSTEM_CLOCK_MULTIPLIER,e.multiplier=Math.round(Math.min(Math.max(Tr.secondsDifference(o,a)/60,1),31556900)));var l=!1;return e!==n._clock&&(n._clock=e,l=!0),i!==n._name&&(l=!0),l&&n._changed.raiseEvent(n),KU.setLoading(n,!1),n})).otherwise((function(e){return KU.setLoading(n,!1),n._error.raiseEvent(n,e),console.log(e),Oi.a.reject(e)}))};var one=new Fi;function sne(){this.author={name:void 0,uri:void 0,email:void 0},this.link={href:void 0,hreflang:void 0,rel:void 0,type:void 0,title:void 0,length:void 0},this.address=void 0,this.phoneNumber=void 0,this.snippet=void 0,this.extendedData=void 0}rne.prototype.update=function(e){var t=this._networkLinks;if(0===t.length)return!0;var i=Tr.now(),n=this;one.removeAll();var r=!1,a=this._lastCameraView,o=this._camera;!Object(u.a)(o)||o.positionWC.equalsEpsilon(a.position,I.EPSILON7)&&o.directionWC.equalsEpsilon(a.direction,I.EPSILON7)&&o.upWC.equalsEpsilon(a.up,I.EPSILON7)||(a.position=z.clone(o.positionWC),a.direction=z.clone(o.directionWC),a.up=z.clone(o.upWC),a.bbox=o.computeViewRectangle(),r=!0);var s=new Fi,c=!1;return t.values.forEach((function(e){var t=e.entity;if(!one.contains(t.id)){if(!e.updating){var o=!1;if(e.refreshMode===Xie.INTERVAL?Tr.secondsDifference(i,e.lastUpdated)>e.time&&(o=!0):e.refreshMode===Xie.EXPIRE?Tr.greaterThan(i,e.time)&&(o=!0):e.refreshMode===Xie.STOP&&(r&&(e.needsUpdate=!0,e.cameraUpdateTime=i),e.needsUpdate&&Tr.secondsDifference(i,e.cameraUpdateTime)>=e.time&&(o=!0)),o){!function e(t){for(var i=t._children,n=i.length,r=0;r<n;++r){var a=i[r];one.set(a.id,a),e(a)}}(t),e.updating=!0;var l=new OU,h=e.href.clone();h.setQueryParameters(e.cookie);var d=Object(w.a)(n._ellipsoid,ae.WGS84);ene(h,n._camera,n._canvas,e.viewBoundScale,a.bbox,d),nne(n,l,h,{context:t.id}).then(function(e,t,i,n,r){return function(a){if(n.contains(t.id)){var o=!1,s=fie(a,"NetworkLinkControl",uie.kml),c=0;if(Object(u.a)(s)){if(Object(u.a)(fie(s,"Update",uie.kml)))return Object(iE.a)("kml-networkLinkControl-update","KML - NetworkLinkControl updates aren't supported."),t.updating=!1,void n.remove(t.id);t.cookie=Object(HT.a)(Object(w.a)(gie(s,"cookie",uie.kml),"")),c=Object(w.a)(_ie(s,"minRefreshPeriod",uie.kml),0)}var l=Tr.now(),h=t.refreshMode;if(h===Xie.INTERVAL)Object(u.a)(s)&&(t.time=Math.max(c,t.time));else if(h===Xie.EXPIRE){var d;if(Object(u.a)(s)&&(d=gie(s,"expires",uie.kml)),Object(u.a)(d))try{var f=Tr.fromIso8601(d),p=Tr.secondsDifference(f,l);p>0&&p<c&&Tr.addSeconds(l,c,f),t.time=f}catch(e){Object(iE.a)("kml-networkLinkControl-expires","KML - NetworkLinkControl expires is not a valid date"),o=!0}else Object(iE.a)("kml-refreshMode-onExpire","KML - refreshMode of onExpire requires the NetworkLinkControl to have an expires element"),o=!0}var m=t.entity,_=e._entityCollection,g=i.values;_.suspendEvents();var v,b=_.values.slice();for(v=0;v<b.length;++v){var y=b[v];y.parent===m&&(y.parent=void 0,P(y))}for(_.resumeEvents(),_.suspendEvents(),v=0;v<g.length;v++){var O=g[v];Object(u.a)(O.parent)||(O.parent=m,ane(O)),_.add(O)}_.resumeEvents(),o?n.remove(t.id):t.lastUpdated=l;var x=_.computeAvailability(),E=x.start,T=x.stop,C=Tr.equals(E,nx.MINIMUM_VALUE),S=Tr.equals(T,nx.MAXIMUM_VALUE);if(!C||!S){var A=e._clock;A.startTime===E&&A.stopTime===T||(A.startTime=E,A.stopTime=T,e._changed.raiseEvent(e))}t.updating=!1,t.needsUpdate=!1,e._refresh.raiseEvent(e,r.getUrlComponent(!0))}function P(e){_.remove(e);for(var t=e._children,i=t.length,n=0;n<i;++n)P(t[n])}}}(n,e,l,s,h)).otherwise((function(t){var i="NetworkLink "+e.href+" refresh failed: "+t;console.log(i),n._error.raiseEvent(n,i)})),c=!0}}s.set(e.id,e)}})),c&&(this._networkLinks=s,this._changed.raiseEvent(this)),!0};var cne=rne;function lne(e){e=Object(w.a)(e,w.a.EMPTY_OBJECT),this._definitionChanged=new $o.a,this._reverse=void 0,this._fluxMap=void 0,this.reverse=Object(w.a)(e.reverse,!1),this.fluxMap=e.fluxMap}Object(O.a)(lne.prototype,{isConstant:{get:function(){return aD.isConstant(this._reverse)&&aD.isConstant(this._fluxMap)}},definitionChanged:{get:function(){return this._definitionChanged}},reverse:KI("reverse"),fluxMap:KI("fluxMap")}),lne.prototype.getType=function(e){return"RoadNetWork"},lne.prototype.getValue=function(e,t){return Object(u.a)(t)||(t={}),t.reverse=aD.getValueOrClonedDefault(this._reverse,e,!1,t.reverse),t.fluxMap=aD.getValueOrUndefined(this._fluxMap,e),t},lne.prototype.equals=function(e){return this===e||e instanceof lne&&aD.equals(this._fluxMap,e._fluxMap)&&aD.equals(this._reverse,e._reverse)};var une=lne;function hne(){h.a.throwInstantiationError()}hne.prototype.update=h.a.throwInstantiationError,hne.prototype.getBoundingSphere=h.a.throwInstantiationError,hne.prototype.isDestroyed=h.a.throwInstantiationError,hne.prototype.destroy=h.a.throwInstantiationError;var dne,fne=hne,pne="attribute vec4 position;\nattribute vec2 textureCoordinates;\nvarying vec2 v_textureCoordinates;\nvoid main()\n{\ngl_Position = position;\nv_textureCoordinates = textureCoordinates;\n}\n";function mne(e){this._context=e}var _ne=new cM({primitiveType:yn.TRIANGLES}),gne=new fX({color:new uf(0,0,0,0)});mne.prototype.execute=function(e){if(x.a.defined("computeCommand",e),Object(u.a)(e.preExecute)&&e.preExecute(e),!Object(u.a)(e.fragmentShaderSource)&&!Object(u.a)(e.shaderProgram))throw new h.a("computeCommand.fragmentShaderSource or computeCommand.shaderProgram is required.");x.a.defined("computeCommand.outputTexture",e.outputTexture);var t=e.outputTexture,i=t.width,n=t.height,r=this._context,a=Object(u.a)(e.vertexArray)?e.vertexArray:r.getViewportQuadVertexArray(),o=Object(u.a)(e.shaderProgram)?e.shaderProgram:function(e,t){return bR.fromCache({context:e,vertexShaderSource:pne,fragmentShaderSource:t,attributeLocations:{position:0,textureCoordinates:1}})}(r,e.fragmentShaderSource),s=function(e,t){return new cj({context:e,colorTextures:[t],destroyAttachments:!1})}(r,t),c=function(e,t){return Object(u.a)(dne)&&dne.viewport.width===e&&dne.viewport.height===t||(dne=RM.fromCache({viewport:new ln(0,0,e,t)})),dne}(i,n),l=e.uniformMap,d=gne;d.framebuffer=s,d.renderState=c,d.execute(r);var f=_ne;f.vertexArray=a,f.renderState=c,f.shaderProgram=o,f.uniformMap=l,f.framebuffer=s,f.execute(r),s.destroy(),e.persists||(o.destroy(),Object(u.a)(e.vertexArray)&&a.destroy()),Object(u.a)(e.postExecute)&&e.postExecute(t)},mne.prototype.isDestroyed=function(){return!1},mne.prototype.destroy=function(){return rl(this)};var vne=mne;var bne=function(e){this.context=e,this.framebuffer=void 0,this.blendingEnabled=void 0,this.scissorTest=void 0,this.viewport=void 0};function yne(e){this._context=e,this._shaders={},this._numberOfShaders=0,this._shadersToRelease={}}function wne(e,t){for(var i=t.derivedKeywords,n=i.length,r=0;r<n;++r){var a=i[r]+t.keyword;wne(e,e._shaders[a])}delete e._shaders[t.keyword],t.shaderProgram.finalDestroy()}Object(O.a)(yne.prototype,{numberOfShaders:{get:function(){return this._numberOfShaders}}}),yne.prototype.replaceShaderProgram=function(e){return Object(u.a)(e.shaderProgram)&&e.shaderProgram.destroy(),this.getShaderProgram(e)},yne.prototype.getShaderProgram=function(e){var t=e.vertexShaderSource,i=e.fragmentShaderSource,n=e.attributeLocations;"string"==typeof t&&(t=new UN({sources:[t]})),"string"==typeof i&&(i=new UN({sources:[i]}));var r,a=t.createCombinedVertexShader(this._context),o=i.createCombinedFragmentShader(this._context),s=a+o+JSON.stringify(n);if(Object(u.a)(this._shaders[s]))r=this._shaders[s],delete this._shadersToRelease[s];else{var c=this._context,l=new bR({gl:c._gl,logShaderCompilation:c.logShaderCompilation,debugShaders:c.debugShaders,vertexShaderSource:t,vertexShaderText:a,fragmentShaderSource:i,fragmentShaderText:o,attributeLocations:n});r={cache:this,shaderProgram:l,keyword:s,derivedKeywords:[],count:0},l._cachedShader=r,this._shaders[s]=r,++this._numberOfShaders}return++r.count,r.shaderProgram},yne.prototype.replaceDerivedShaderProgram=function(e,t,i){var n=e._cachedShader,r=t+n.keyword,a=this._shaders[r];if(Object(u.a)(a)){wne(this,a);var o=n.derivedKeywords.indexOf(t);o>-1&&n.derivedKeywords.splice(o,1)}return this.createDerivedShaderProgram(e,t,i)},yne.prototype.getDerivedShaderProgram=function(e,t){var i=t+e._cachedShader.keyword,n=this._shaders[i];if(Object(u.a)(n))return n.shaderProgram},yne.prototype.createDerivedShaderProgram=function(e,t,i){var n=e._cachedShader,r=t+n.keyword,a=i.vertexShaderSource,o=i.fragmentShaderSource,s=i.attributeLocations;"string"==typeof a&&(a=new UN({sources:[a]})),"string"==typeof o&&(o=new UN({sources:[o]}));var c=this._context,l=a.createCombinedVertexShader(c),u=o.createCombinedFragmentShader(c),h=new bR({gl:c._gl,logShaderCompilation:c.logShaderCompilation,debugShaders:c.debugShaders,vertexShaderSource:a,vertexShaderText:l,fragmentShaderSource:o,fragmentShaderText:u,attributeLocations:s}),d={cache:this,shaderProgram:h,keyword:r,derivedKeywords:[],count:0};return n.derivedKeywords.push(t),h._cachedShader=d,this._shaders[r]=d,h},yne.prototype.destroyReleasedShaderPrograms=function(){var e=this._shadersToRelease;for(var t in e){if(e.hasOwnProperty(t))wne(this,e[t]),--this._numberOfShaders}this._shadersToRelease={}},yne.prototype.releaseShaderProgram=function(e){if(Object(u.a)(e)){var t=e._cachedShader;t&&0==--t.count&&(this._shadersToRelease[t.keyword]=t)}},yne.prototype.isDestroyed=function(){return!1},yne.prototype.destroy=function(){var e=this._shaders;for(var t in e)e.hasOwnProperty(t)&&e[t].shaderProgram.finalDestroy();return rl(this)};var One=yne;function xne(){this._textures={},this._numberOfTextures=0,this._texturesToRelease={}}Object(O.a)(xne.prototype,{numberOfTextures:{get:function(){return this._numberOfTextures}}}),xne.prototype.getTexture=function(e){var t=this._textures[e];if(Object(u.a)(t))return delete this._texturesToRelease[e],++t.count,t.texture},xne.prototype.addTexture=function(e,t){var i={texture:t,count:1};t.finalDestroy=t.destroy;var n=this;t.destroy=function(){0==--i.count&&(n._texturesToRelease[e]=i)},this._textures[e]=i,++this._numberOfTextures},xne.prototype.destroyReleasedTextures=function(){var e=this._texturesToRelease;for(var t in e)if(e.hasOwnProperty(t)){var i=e[t];delete this._textures[t],i.texture.finalDestroy(),--this._numberOfTextures}this._texturesToRelease={}},xne.prototype.isDestroyed=function(){return!1},xne.prototype.destroy=function(){var e=this._textures;for(var t in e)e.hasOwnProperty(t)&&e[t].texture.finalDestroy();return rl(this)};var Ene=xne;function Tne(){this.globeDepthTexture=void 0,this.gamma=void 0,this._viewport=new ln,this._viewportCartesian4=new Te,this._viewportDirty=!1,this._viewportOrthographicMatrix=Be.clone(Be.IDENTITY),this._viewportTransformation=Be.clone(Be.IDENTITY),this._model=Be.clone(Be.IDENTITY),this._view=Be.clone(Be.IDENTITY),this._inverseView=Be.clone(Be.IDENTITY),this._projection=Be.clone(Be.IDENTITY),this._infiniteProjection=Be.clone(Be.IDENTITY),this._entireFrustum=new Rt,this._currentFrustum=new Rt,this._frustumPlanes=new Te,this._log2FarDistance=void 0,this._log2FarPlusOne=void 0,this._log2NearDistance=void 0,this._frameState=void 0,this._temeToPseudoFixed=be.clone(Be.IDENTITY),this._view3DDirty=!0,this._view3D=new Be,this._inverseView3DDirty=!0,this._inverseView3D=new Be,this._inverseModelDirty=!0,this._inverseModel=new Be,this._inverseTransposeModelDirty=!0,this._inverseTransposeModel=new be,this._viewRotation=new be,this._inverseViewRotation=new be,this._modelViewRotation=new be,this._modelViewRotationDirty=!1,this._viewRotation3D=new be,this._inverseViewRotation3D=new be,this._inverseProjectionDirty=!0,this._inverseProjection=new Be,this._modelViewDirty=!0,this._modelView=new Be,this._modelView3DDirty=!0,this._modelView3D=new Be,this._modelViewRelativeToEyeDirty=!0,this._modelViewRelativeToEye=new Be,this._inverseModelViewDirty=!0,this._inverseModelView=new Be,this._inverseModelView3DDirty=!0,this._inverseModelView3D=new Be,this._viewProjectionDirty=!0,this._viewProjection=new Be,this._inverseViewProjectionDirty=!0,this._inverseViewProjection=new Be,this._modelViewProjectionDirty=!0,this._modelViewProjection=new Be,this._inverseModelViewProjectionDirty=!0,this._inverseModelViewProjection=new Be,this._modelViewProjectionRelativeToEyeDirty=!0,this._modelViewProjectionRelativeToEye=new Be,this._modelViewInfiniteProjectionDirty=!0,this._modelViewInfiniteProjection=new Be,this._normalDirty=!0,this._normal=new be,this._normal3DDirty=!0,this._normal3D=new be,this._inverseNormalDirty=!0,this._inverseNormal=new be,this._inverseNormal3DDirty=!0,this._inverseNormal3D=new be,this._encodedCameraPositionMCDirty=!0,this._encodedCameraPositionMC=new Fu,this._cameraPosition=new z,this._sunPositionWC=new z,this._sunPositionColumbusView=new z,this._sunDirectionWC=new z,this._sunDirectionEC=new z,this._sunColor=new z,this._moonDirectionEC=new z,this._pass=void 0,this._mode=void 0,this._mapProjection=void 0,this._cameraDirection=new z,this._cameraRight=new z,this._cameraUp=new z,this._frustum2DWidth=0,this._eyeHeight2D=new Rt,this._resolutionScale=1,this._orthographicIn3D=!1,this._backgroundColor=new uf,this._brdfLut=void 0,this._environmentMap=void 0,this._sphericalHarmonicCoefficients=void 0,this._specularEnvironmentMaps=void 0,this._specularEnvironmentMapsDimensions=new Rt,this._specularEnvironmentMapsMaximumLOD=void 0,this._fogDensity=void 0,this._invertClassificationColor=void 0,this._imagerySplitPosition=0,this._pixelSizePerMeter=void 0,this._geometricToleranceOverMeter=void 0,this._minimumDisableDepthTestDistance=void 0,this._ambientLight=new z,this._lightScaleFactor=1,this._cameraPitch=0,this._skyBoxModelMatrix=new Be,this._inverseSkyBoxModelViewRotationDirty=!0,this._inverseSkyBoxModelViewRotation=new be,this._gltfRotation=be.fromRotationX(I.toRadians(-90)),this._inverseGltfRotation=be.inverse(this._gltfRotation,new be)}Object(O.a)(Tne.prototype,{frameState:{get:function(){return this._frameState}},viewport:{get:function(){return this._viewport},set:function(e){if(!ln.equals(e,this._viewport)){ln.clone(e,this._viewport);var t=this._viewport,i=this._viewportCartesian4;i.x=t.x,i.y=t.y,i.z=t.width,i.w=t.height,this._viewportDirty=!0}}},viewportCartesian4:{get:function(){return this._viewportCartesian4}},viewportOrthographic:{get:function(){return Pne(this),this._viewportOrthographicMatrix}},viewportTransformation:{get:function(){return Pne(this),this._viewportTransformation}},model:{get:function(){return this._model},set:function(e){Be.clone(e,this._model),this._modelView3DDirty=!0,this._inverseModelView3DDirty=!0,this._inverseModelDirty=!0,this._inverseTransposeModelDirty=!0,this._modelViewDirty=!0,this._inverseModelViewDirty=!0,this._modelViewRelativeToEyeDirty=!0,this._modelViewProjectionDirty=!0,this._inverseModelViewProjectionDirty=!0,this._modelViewProjectionRelativeToEyeDirty=!0,this._modelViewInfiniteProjectionDirty=!0,this._normalDirty=!0,this._inverseNormalDirty=!0,this._normal3DDirty=!0,this._inverseNormal3DDirty=!0,this._encodedCameraPositionMCDirty=!0,this._modelViewRotationDirty=!0}},inverseModel:{get:function(){return this._inverseModelDirty&&(this._inverseModelDirty=!1,Be.inverse(this._model,this._inverseModel)),this._inverseModel}},inverseTransposeModel:{get:function(){var e=this._inverseTransposeModel;return this._inverseTransposeModelDirty&&(this._inverseTransposeModelDirty=!1,Be.getRotation(this.inverseModel,e),be.transpose(e,e)),e}},view:{get:function(){return this._view}},view3D:{get:function(){return zne(this),this._view3D}},viewRotation:{get:function(){return zne(this),this._viewRotation}},modelViewRotation:{get:function(){var e;return(e=this)._modelViewRotationDirty&&(Be.getRotation(e.modelView,e._modelViewRotation),e._modelViewRotationDirty=!1),this._modelViewRotation}},viewRotation3D:{get:function(){return zne(this),this._viewRotation3D}},inverseView:{get:function(){return this._inverseView}},inverseView3D:{get:function(){return Une(this),this._inverseView3D}},inverseViewRotation:{get:function(){return this._inverseViewRotation}},inverseViewRotation3D:{get:function(){return Une(this),this._inverseViewRotation3D}},projection:{get:function(){return this._projection}},inverseProjection:{get:function(){var e;return(e=this)._inverseProjectionDirty&&(e._inverseProjectionDirty=!1,e._mode===xF.SCENE2D||e._mode===xF.MORPHING||e._orthographicIn3D?Be.clone(Be.ZERO,e._inverseProjection):Be.inverse(e._projection,e._inverseProjection)),this._inverseProjection}},infiniteProjection:{get:function(){return this._infiniteProjection}},modelView:{get:function(){var e;return(e=this)._modelViewDirty&&(e._modelViewDirty=!1,Be.multiplyTransformation(e._view,e._model,e._modelView)),this._modelView}},modelView3D:{get:function(){var e;return(e=this)._modelView3DDirty&&(e._modelView3DDirty=!1,Be.multiplyTransformation(e.view3D,e._model,e._modelView3D)),this._modelView3D}},modelViewRelativeToEye:{get:function(){return function(e){if(e._modelViewRelativeToEyeDirty){e._modelViewRelativeToEyeDirty=!1;var t=e.modelView,i=e._modelViewRelativeToEye;i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i[4]=t[4],i[5]=t[5],i[6]=t[6],i[7]=t[7],i[8]=t[8],i[9]=t[9],i[10]=t[10],i[11]=t[11],i[12]=0,i[13]=0,i[14]=0,i[15]=t[15]}}(this),this._modelViewRelativeToEye}},inverseModelView:{get:function(){var e;return(e=this)._inverseModelViewDirty&&(e._inverseModelViewDirty=!1,Be.inverse(e.modelView,e._inverseModelView)),this._inverseModelView}},inverseModelView3D:{get:function(){var e;return(e=this)._inverseModelView3DDirty&&(e._inverseModelView3DDirty=!1,Be.inverse(e.modelView3D,e._inverseModelView3D)),this._inverseModelView3D}},viewProjection:{get:function(){var e;return(e=this)._viewProjectionDirty&&(e._viewProjectionDirty=!1,Be.multiply(e._projection,e._view,e._viewProjection)),this._viewProjection}},inverseViewProjection:{get:function(){var e;return(e=this)._inverseViewProjectionDirty&&(e._inverseViewProjectionDirty=!1,Be.inverse(e.viewProjection,e._inverseViewProjection)),this._inverseViewProjection}},modelViewProjection:{get:function(){var e;return(e=this)._modelViewProjectionDirty&&(e._modelViewProjectionDirty=!1,Be.multiply(e._projection,e.modelView,e._modelViewProjection)),this._modelViewProjection}},inverseModelViewProjection:{get:function(){var e;return(e=this)._inverseModelViewProjectionDirty&&(e._inverseModelViewProjectionDirty=!1,Be.inverse(e.modelViewProjection,e._inverseModelViewProjection)),this._inverseModelViewProjection}},modelViewProjectionRelativeToEye:{get:function(){var e;return(e=this)._modelViewProjectionRelativeToEyeDirty&&(e._modelViewProjectionRelativeToEyeDirty=!1,Be.multiply(e._projection,e.modelViewRelativeToEye,e._modelViewProjectionRelativeToEye)),this._modelViewProjectionRelativeToEye}},modelViewInfiniteProjection:{get:function(){var e;return(e=this)._modelViewInfiniteProjectionDirty&&(e._modelViewInfiniteProjectionDirty=!1,Be.multiply(e._infiniteProjection,e.modelView,e._modelViewInfiniteProjection)),this._modelViewInfiniteProjection}},normal:{get:function(){return function(e){if(e._normalDirty){e._normalDirty=!1;var t=e._normal;Be.getRotation(e.inverseModelView,t),be.transpose(t,t)}}(this),this._normal}},normal3D:{get:function(){return function(e){if(e._normal3DDirty){e._normal3DDirty=!1;var t=e._normal3D;Be.getRotation(e.inverseModelView3D,t),be.transpose(t,t)}}(this),this._normal3D}},inverseNormal:{get:function(){var e;return(e=this)._inverseNormalDirty&&(e._inverseNormalDirty=!1,Be.getRotation(e.inverseModelView,e._inverseNormal)),this._inverseNormal}},inverseNormal3D:{get:function(){var e;return(e=this)._inverseNormal3DDirty&&(e._inverseNormal3DDirty=!1,Be.getRotation(e.inverseModelView3D,e._inverseNormal3D)),this._inverseNormal3D}},entireFrustum:{get:function(){return this._entireFrustum}},currentFrustum:{get:function(){return this._currentFrustum}},frustumPlanes:{get:function(){return this._frustumPlanes}},log2FarDistance:{get:function(){return this._log2FarDistance}},log2FarPlusOne:{get:function(){return this._log2FarPlusOne}},log2NearDistance:{get:function(){return this._log2NearDistance}},eyeHeight2D:{get:function(){return this._eyeHeight2D}},sunPositionWC:{get:function(){return this._sunPositionWC}},sunPositionColumbusView:{get:function(){return this._sunPositionColumbusView}},sunDirectionWC:{get:function(){return this._sunDirectionWC}},sunDirectionEC:{get:function(){return this._sunDirectionEC}},sunColor:{get:function(){return this._sunColor}},moonDirectionEC:{get:function(){return this._moonDirectionEC}},encodedCameraPositionMCHigh:{get:function(){return jne(this),this._encodedCameraPositionMC.high}},encodedCameraPositionMCLow:{get:function(){return jne(this),this._encodedCameraPositionMC.low}},temeToPseudoFixedMatrix:{get:function(){return this._temeToPseudoFixed}},resolutionScale:{get:function(){return this._resolutionScale}},fogDensity:{get:function(){return this._fogDensity}},geometricToleranceOverMeter:{get:function(){return this._geometricToleranceOverMeter}},pass:{get:function(){return this._pass}},backgroundColor:{get:function(){return this._backgroundColor}},brdfLut:{get:function(){return this._brdfLut}},environmentMap:{get:function(){return this._environmentMap}},sphericalHarmonicCoefficients:{get:function(){return this._sphericalHarmonicCoefficients}},specularEnvironmentMaps:{get:function(){return this._specularEnvironmentMaps}},specularEnvironmentMapsDimensions:{get:function(){return this._specularEnvironmentMapsDimensions}},specularEnvironmentMapsMaximumLOD:{get:function(){return this._specularEnvironmentMapsMaximumLOD}},imagerySplitPosition:{get:function(){return this._imagerySplitPosition}},minimumDisableDepthTestDistance:{get:function(){return this._minimumDisableDepthTestDistance}},invertClassificationColor:{get:function(){return this._invertClassificationColor}},orthographicIn3D:{get:function(){return this._orthographicIn3D}},ambientLight:{get:function(){return this._ambientLight}},lightScaleFactor:{get:function(){return this._lightScaleFactor}},cameraPitch:{get:function(){return this._cameraPitch}},gltfRotation:{get:function(){return this._gltfRotation}},inverseGltfRotation:{get:function(){return this._inverseGltfRotation}},inverseSkyBoxModelViewRotation:{get:function(){var e;return(e=this)._inverseSkyBoxModelViewRotationDirty&&(e._inverseSkyBoxModelViewRotationDirty=!1,Be.multiplyTransformation(e.view,e._skyBoxModelMatrix,Ine),Be.inverse(Ine,Ine),Be.getRotation(Ine,e._inverseSkyBoxModelViewRotation)),this._inverseSkyBoxModelViewRotation}}});var Cne=new be,Sne=new K;Tne.prototype.updateCamera=function(e){var t,i;t=this,i=e.viewMatrix,Be.clone(i,t._view),Be.getRotation(i,t._viewRotation),t._view3DDirty=!0,t._inverseView3DDirty=!0,t._modelViewDirty=!0,t._modelView3DDirty=!0,t._modelViewRelativeToEyeDirty=!0,t._inverseModelViewDirty=!0,t._inverseSkyBoxModelViewRotationDirty=!0,t._inverseModelView3DDirty=!0,t._viewProjectionDirty=!0,t._inverseViewProjectionDirty=!0,t._modelViewProjectionDirty=!0,t._modelViewProjectionRelativeToEyeDirty=!0,t._modelViewInfiniteProjectionDirty=!0,t._normalDirty=!0,t._inverseNormalDirty=!0,t._normal3DDirty=!0,t._inverseNormal3DDirty=!0,t._modelViewRotationDirty=!0,function(e,t){Be.clone(t,e._inverseView),Be.getRotation(t,e._inverseViewRotation)}(this,e.inverseViewMatrix),function(e,t){z.clone(t.positionWC,e._cameraPosition),z.clone(t.directionWC,e._cameraDirection),z.clone(t.rightWC,e._cameraRight),z.clone(t.upWC,e._cameraUp),e._encodedCameraPositionMCDirty=!0}(this,e),this._entireFrustum.x=e.frustum.near,this._entireFrustum.y=e.frustum.far,this._cameraPitch=e.pitch,this.updateFrustum(e.frustum),this._orthographicIn3D=this._mode!==xF.SCENE2D&&e.frustum instanceof hb},Tne.prototype.updateFrustum=function(e){var t,i;t=this,i=e.projectionMatrix,Be.clone(i,t._projection),t._inverseProjectionDirty=!0,t._viewProjectionDirty=!0,t._inverseViewProjectionDirty=!0,t._modelViewProjectionDirty=!0,t._modelViewProjectionRelativeToEyeDirty=!0,e instanceof wb?(this._projection[8]+=fx.jitterOffset[0],this._projection[9]+=fx.jitterOffset[1]):e instanceof hb&&(this._projection[12]+=fx.jitterOffset[0],this._projection[13]+=fx.jitterOffset[1]),Object(u.a)(e.infiniteProjectionMatrix)&&function(e,t){Be.clone(t,e._infiniteProjection),e._modelViewInfiniteProjectionDirty=!0}(this,e.infiniteProjectionMatrix),this._currentFrustum.x=e.near,this._currentFrustum.y=e.far,this._log2FarDistance=2/I.log2(e.far+1),this._log2FarPlusOne=I.log2(e.far+1),this._log2NearDistance=I.log2(e.near),Object(u.a)(e._offCenterFrustum)&&(e=e._offCenterFrustum),this._frustumPlanes.x=e.top,this._frustumPlanes.y=e.bottom,this._frustumPlanes.z=e.left,this._frustumPlanes.w=e.right},Tne.prototype.updatePass=function(e){this._pass=e};var Ane=[];function Pne(e){if(e._viewportDirty){var t=e._viewport;Be.computeOrthographicOffCenter(t.x,t.x+t.width,t.y,t.y+t.height,0,1,e._viewportOrthographicMatrix),Be.computeViewportTransformation(t,0,1,e._viewportTransformation),e._viewportDirty=!1}}Tne.prototype.update=function(e){this._mode=e.mode,this._mapProjection=e.mapProjection,this._skyBoxModelMatrix=e.skyBoxModelMatrix;var t=e.context._canvas;this._resolutionScale=t.width/t.clientWidth;var i=e.camera;this.updateCamera(i),this._ambientLight=e.ambientLight,this._lightScaleFactor=e.lightScaleFactor,e.mode===xF.SCENE2D?(this._frustum2DWidth=i.frustum.right-i.frustum.left,this._eyeHeight2D.x=.5*this._frustum2DWidth,this._eyeHeight2D.y=this._eyeHeight2D.x*this._eyeHeight2D.x):(this._frustum2DWidth=0,this._eyeHeight2D.x=0,this._eyeHeight2D.y=0),function(e,t){Object(u.a)(xa.computeIcrfToFixedMatrix(t.time,Cne))||(Cne=xa.computeTemeToPseudoFixedMatrix(t.time,Cne));var i=OP.computeSunPositionInEarthInertialFrame(t.time,e._sunPositionWC);be.multiplyByVector(Cne,i,i),z.normalize(i,e._sunDirectionWC),i=be.multiplyByVector(e.viewRotation3D,i,e._sunDirectionEC),z.normalize(i,i),i=OP.computeMoonPositionInEarthInertialFrame(t.time,e._moonDirectionEC),be.multiplyByVector(Cne,i,i),be.multiplyByVector(e.viewRotation3D,i,i),z.normalize(i,i);var n=t.mapProjection,r=n.ellipsoid.cartesianToCartographic(e._sunPositionWC,Sne);n.project(r,e._sunPositionColumbusView)}(this,e),this._sunColor=z.clone(e.sunColor,this._sunColor);var n=e.brdfLutGenerator,r=Object(u.a)(n)?n.colorTexture:void 0;this._brdfLut=r,this._environmentMap=Object(w.a)(e.environmentMap,e.context.defaultCubeMap),this._sphericalHarmonicCoefficients=Object(w.a)(e.sphericalHarmonicCoefficients,Ane),this._specularEnvironmentMaps=e.specularEnvironmentMaps,this._specularEnvironmentMapsMaximumLOD=e.specularEnvironmentMapsMaximumLOD,Object(u.a)(this._specularEnvironmentMaps)&&Rt.clone(this._specularEnvironmentMaps.dimensions,this._specularEnvironmentMapsDimensions),this._fogDensity=e.fog.density,this._invertClassificationColor=e.invertClassificationColor,this._frameState=e,this._temeToPseudoFixed=xa.computeTemeToPseudoFixedMatrix(e.time,this._temeToPseudoFixed),this._imagerySplitPosition=e.imagerySplitPosition*e.context.drawingBufferWidth;var a,o=i.frustum.fov,s=this._viewport;a=s.height>s.width?2*Math.tan(.5*o)/s.height:2*Math.tan(.5*o)/s.width,this._geometricToleranceOverMeter=a*e.maximumScreenSpaceError,uf.clone(e.backgroundColor,this._backgroundColor),this._minimumDisableDepthTestDistance=e.minimumDisableDepthTestDistance,this._minimumDisableDepthTestDistance*=this._minimumDisableDepthTestDistance,this._minimumDisableDepthTestDistance===Number.POSITIVE_INFINITY&&(this._minimumDisableDepthTestDistance=-1)};var Ine=new Be;var Dne=new z;function jne(e){e._encodedCameraPositionMCDirty&&(e._encodedCameraPositionMCDirty=!1,Be.multiplyByPoint(e.inverseModel,e._cameraPosition,Dne),Fu.fromCartesian(Dne,e._encodedCameraPositionMC))}var Mne=new z,Rne=new z,Lne=new z,Nne=new z,Fne=new K,kne=new z,Bne=new Be;function zne(e){e._view3DDirty&&(e._mode===xF.SCENE3D?Be.clone(e._view,e._view3D):function(e,t,i,n,r,a,o,s){var c=Mne;c.x=e.y,c.y=e.z,c.z=e.x;var l=Rne;l.x=i.y,l.y=i.z,l.z=i.x;var h=Lne;h.x=n.y,h.y=n.z,h.z=n.x;var d=Nne;d.x=t.y,d.y=t.z,d.z=t.x,a===xF.SCENE2D&&(c.z=.5*r);var f=o.unproject(c,Fne);f.longitude=I.clamp(f.longitude,-Math.PI,Math.PI),f.latitude=I.clamp(f.latitude,-I.PI_OVER_TWO,I.PI_OVER_TWO);var p=o.ellipsoid,m=p.cartographicToCartesian(f,kne),_=xa.eastNorthUpToFixedFrame(m,p,Bne);Be.multiplyByPointAsVector(_,l,l),Be.multiplyByPointAsVector(_,h,h),Be.multiplyByPointAsVector(_,d,d),Object(u.a)(s)||(s=new Be),s[0]=l.x,s[1]=h.x,s[2]=-d.x,s[3]=0,s[4]=l.y,s[5]=h.y,s[6]=-d.y,s[7]=0,s[8]=l.z,s[9]=h.z,s[10]=-d.z,s[11]=0,s[12]=-z.dot(l,m),s[13]=-z.dot(h,m),s[14]=z.dot(d,m),s[15]=1}(e._cameraPosition,e._cameraDirection,e._cameraRight,e._cameraUp,e._frustum2DWidth,e._mode,e._mapProjection,e._view3D),Be.getRotation(e._view3D,e._viewRotation3D),e._view3DDirty=!1)}function Une(e){e._inverseView3DDirty&&(Be.inverseTransformation(e.view3D,e._inverseView3D),Be.getRotation(e._inverseView3D,e._inverseViewRotation3D),e._inverseView3DDirty=!1)}var Vne=Tne;function Hne(e,t,i){var n=e.getError();if(n!==e.NO_ERROR)throw new Ce.a(function(e,t,i,n){for(var r=function(e,t){var i="WebGL Error:  ";switch(t){case e.INVALID_ENUM:i+="INVALID_ENUM";break;case e.INVALID_VALUE:i+="INVALID_VALUE";break;case e.INVALID_OPERATION:i+="INVALID_OPERATION";break;case e.OUT_OF_MEMORY:i+="OUT_OF_MEMORY";break;case e.CONTEXT_LOST_WEBGL:i+="CONTEXT_LOST_WEBGL lost";break;default:i+="Unknown ("+t+")"}return i}(e,n)+": "+t.name+"(",a=0;a<i.length;++a)0!==a&&(r+=", "),r+=i[a];return r+=");"}(e,t,i,n))}function Gne(e,t,i){return{get:function(){var n=e[t];return i(e,"get: "+t,n),e[t]},set:function(n){e[t]=n,i(e,"set: "+t,n)}}}function qne(e,t){for(var i=t.length,n=0;n<i;++n){var r=e.getExtension(t[n]);if(r)return r}}function Wne(e,t){if("undefined"==typeof WebGLRenderingContext)throw new Ce.a("The browser does not support WebGL.  Visit http://get.webgl.org.");x.a.defined("canvas",e),this._canvas=e,t=Object(nf.a)(t,!0),(t=Object(w.a)(t,{})).allowTextureFilterAnisotropic=Object(w.a)(t.allowTextureFilterAnisotropic,!0);var i=Object(w.a)(t.webgl,{});i.alpha=Object(w.a)(i.alpha,!1),i.stencil=Object(w.a)(i.stencil,!0);var n,r=Object(w.a)(t.requestWebgl2,!1)&&"undefined"!=typeof WebGL2RenderingContext,a=!1,o=t.getWebGLStub;if(Object(u.a)(o))n=o(e,i);else if(r&&(n=e.getContext("webgl2",i)||e.getContext("experimental-webgl2",i)||void 0,Object(u.a)(n)&&(a=!0,fx.isWebgl2=!0)),Object(u.a)(n)||(n=e.getContext("webgl",i)||e.getContext("experimental-webgl",i)||void 0),!Object(u.a)(n))throw new Ce.a("The browser supports WebGL, but initialization failed.");this._originalGLContext=n,this._gl=n,this._webgl2=a,this._id=Mg(),this.validateFramebuffer=!1,this.validateShaderProgram=!1,this.logShaderCompilation=!1,this._throwOnWebGLError=!1,this._shaderCache=new One(this),this._textureCache=new Ene;var s=n;this._stencilBits=s.getParameter(s.STENCIL_BITS),HD._maximumCombinedTextureImageUnits=s.getParameter(s.MAX_COMBINED_TEXTURE_IMAGE_UNITS),HD._maximumCubeMapSize=s.getParameter(s.MAX_CUBE_MAP_TEXTURE_SIZE),HD._maximumFragmentUniformVectors=s.getParameter(s.MAX_FRAGMENT_UNIFORM_VECTORS),HD._maximumTextureImageUnits=s.getParameter(s.MAX_TEXTURE_IMAGE_UNITS),HD._maximumRenderbufferSize=s.getParameter(s.MAX_RENDERBUFFER_SIZE),HD._maximumTextureSize=s.getParameter(s.MAX_TEXTURE_SIZE),HD._maximumVaryingVectors=s.getParameter(s.MAX_VARYING_VECTORS),HD._maximumVertexAttributes=s.getParameter(s.MAX_VERTEX_ATTRIBS),HD._maximumVertexTextureImageUnits=s.getParameter(s.MAX_VERTEX_TEXTURE_IMAGE_UNITS),HD._maximumVertexUniformVectors=s.getParameter(s.MAX_VERTEX_UNIFORM_VECTORS);var c=s.getParameter(s.ALIASED_LINE_WIDTH_RANGE);HD._minimumAliasedLineWidth=c[0],HD._maximumAliasedLineWidth=c[1];var l=s.getParameter(s.ALIASED_POINT_SIZE_RANGE);HD._minimumAliasedPointSize=l[0],HD._maximumAliasedPointSize=l[1];var h=s.getParameter(s.MAX_VIEWPORT_DIMS);HD._maximumViewportWidth=h[0],HD._maximumViewportHeight=h[1];var d=s.getShaderPrecisionFormat(s.FRAGMENT_SHADER,s.HIGH_FLOAT);HD._highpFloatSupported=0!==d.precision;var f=s.getShaderPrecisionFormat(s.FRAGMENT_SHADER,s.HIGH_INT);HD._highpIntSupported=0!==f.rangeMax,this._antialias=s.getContextAttributes().antialias,this._standardDerivatives=!!qne(s,["OES_standard_derivatives"]),this._blendMinmax=!!qne(s,["EXT_blend_minmax"]),this._elementIndexUint=!!qne(s,["OES_element_index_uint"]),this._depthTexture=!!qne(s,["WEBGL_depth_texture","WEBKIT_WEBGL_depth_texture"]),this._fragDepth=!!qne(s,["EXT_frag_depth"]),this._debugShaders=qne(s,["WEBGL_debug_shaders"]),this._textureFloat=!!qne(s,["OES_texture_float"]),this._textureHalfFloat=!!qne(s,["OES_texture_half_float"]),this._textureFloatLinear=!!qne(s,["OES_texture_float_linear"]),this._textureHalfFloatLinear=!!qne(s,["OES_texture_half_float_linear"]),this._colorBufferFloat=!!qne(s,["EXT_color_buffer_float","WEBGL_color_buffer_float"]),this._colorBufferHalfFloat=!!qne(s,["EXT_color_buffer_half_float"]),this._floatBlend=!!qne(s,["EXT_float_blend"]),this._s3tc=!!qne(s,["WEBGL_compressed_texture_s3tc","MOZ_WEBGL_compressed_texture_s3tc","WEBKIT_WEBGL_compressed_texture_s3tc"]),this._pvrtc=!!qne(s,["WEBGL_compressed_texture_pvrtc","WEBKIT_WEBGL_compressed_texture_pvrtc"]),this._etc1=!!qne(s,["WEBGL_compressed_texture_etc1"]);var p,m,_,g,v,b,y,O,E,T,C=t.allowTextureFilterAnisotropic?qne(s,["EXT_texture_filter_anisotropic","WEBKIT_EXT_texture_filter_anisotropic"]):void 0;if(this._textureFilterAnisotropic=C,HD._maximumTextureFilterAnisotropy=Object(u.a)(C)?s.getParameter(C.MAX_TEXTURE_MAX_ANISOTROPY_EXT):1,a){var S=this;p=function(){return S._gl.createVertexArray()},m=function(e){S._gl.bindVertexArray(e)},_=function(e){S._gl.deleteVertexArray(e)},g=function(e,t,i,n,r){s.drawElementsInstanced(e,t,i,n,r)},v=function(e,t,i,n){s.drawArraysInstanced(e,t,i,n)},b=function(e,t){s.vertexAttribDivisor(e,t)},y=function(e){s.drawBuffers(e)}}else O=qne(s,["OES_vertex_array_object"]),Object(u.a)(O)&&(p=function(){return O.createVertexArrayOES()},m=function(e){O.bindVertexArrayOES(e)},_=function(e){O.deleteVertexArrayOES(e)}),E=qne(s,["ANGLE_instanced_arrays"]),Object(u.a)(E)&&(g=function(e,t,i,n,r){E.drawElementsInstancedANGLE(e,t,i,n,r)},v=function(e,t,i,n){E.drawArraysInstancedANGLE(e,t,i,n)},b=function(e,t){E.vertexAttribDivisorANGLE(e,t)}),T=qne(s,["WEBGL_draw_buffers"]),Object(u.a)(T)&&(y=function(e){T.drawBuffersWEBGL(e)});this.glCreateVertexArray=p,this.glBindVertexArray=m,this.glDeleteVertexArray=_,this.glDrawElementsInstanced=g,this.glDrawArraysInstanced=v,this.glVertexAttribDivisor=b,this.glDrawBuffers=y,this._vertexArrayObject=!!O,this._instancedArrays=!!E,this._drawBuffers=!!T,HD._maximumDrawBuffers=this.drawBuffers?s.getParameter(un.MAX_DRAW_BUFFERS):1,HD._maximumColorAttachments=this.drawBuffers?s.getParameter(un.MAX_COLOR_ATTACHMENTS):1,this._clearColor=new uf(0,0,0,0),this._clearDepth=1,this._clearStencil=0;var A=new Vne,P=new bne(this),I=RM.fromCache();this._defaultPassState=P,this._defaultRenderState=I,this._defaultTexture=void 0,this._defaultCubeMap=void 0,this._us=A,this._currentRenderState=I,this._currentPassState=P,this._currentFramebuffer=void 0,this._maxFrameTextureUnitIndex=0,this._vertexAttribDivisors=[],this._previousDrawInstanced=!1;for(var D=0;D<HD._maximumVertexAttributes;D++)this._vertexAttribDivisors.push(0);this._pickObjects={},this._nextPickColor=new Uint32Array(1),this.options=t,this.cache={},RM.apply(s,I,P)}var Yne,Xne={};function Zne(e,t,i,n){var r=e._currentRenderState,a=e._currentPassState;e._currentRenderState=t,e._currentPassState=i,RM.partialApply(e._gl,r,t,a,i,n)}function Qne(e,t){if(t!==e._currentFramebuffer){e._currentFramebuffer=t;var i=Yne;if(Object(u.a)(t))t._bind(),function(e){if(e.validateFramebuffer){var t=e._gl,i=t.checkFramebufferStatus(t.FRAMEBUFFER);if(i!==t.FRAMEBUFFER_COMPLETE){var n;switch(i){case t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:n="Framebuffer is not complete.  Incomplete attachment: at least one attachment point with a renderbuffer or texture attached has its attached object no longer in existence or has an attached image with a width or height of zero, or the color attachment point has a non-color-renderable image attached, or the depth attachment point has a non-depth-renderable image attached, or the stencil attachment point has a non-stencil-renderable image attached.  Color-renderable formats include GL_RGBA4, GL_RGB5_A1, and GL_RGB565. GL_DEPTH_COMPONENT16 is the only depth-renderable format. GL_STENCIL_INDEX8 is the only stencil-renderable format.";break;case t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:n="Framebuffer is not complete.  Incomplete dimensions: not all attached images have the same width and height.";break;case t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:n="Framebuffer is not complete.  Missing attachment: no images are attached to the framebuffer.";break;case t.FRAMEBUFFER_UNSUPPORTED:n="Framebuffer is not complete.  Unsupported: the combination of internal formats of the attached images violates an implementation-dependent set of restrictions."}throw new h.a(n)}}}(e),i=t._getActiveColorAttachments();else{var n=e._gl;n.bindFramebuffer(n.FRAMEBUFFER,null)}e.drawBuffers&&e.glDrawBuffers(i)}}Object(O.a)(Wne.prototype,{id:{get:function(){return this._id}},webgl2:{get:function(){return this._webgl2}},canvas:{get:function(){return this._canvas}},shaderCache:{get:function(){return this._shaderCache}},textureCache:{get:function(){return this._textureCache}},uniformState:{get:function(){return this._us}},stencilBits:{get:function(){return this._stencilBits}},stencilBuffer:{get:function(){return this._stencilBits>=8}},antialias:{get:function(){return this._antialias}},standardDerivatives:{get:function(){return this._standardDerivatives||this._webgl2}},blendMinmax:{get:function(){return this._blendMinmax||this._webgl2}},elementIndexUint:{get:function(){return this._elementIndexUint||this._webgl2}},depthTexture:{get:function(){return this._depthTexture||this._webgl2}},floatingPointTexture:{get:function(){return this._webgl2||this._textureFloat}},halfFloatingPointTexture:{get:function(){return this._webgl2||this._textureHalfFloat}},textureFloatLinear:{get:function(){return this._textureFloatLinear}},textureHalfFloatLinear:{get:function(){return this._webgl2&&this._textureFloatLinear||!this._webgl2&&this._textureHalfFloatLinear}},textureFilterAnisotropic:{get:function(){return!!this._textureFilterAnisotropic}},s3tc:{get:function(){return this._s3tc}},pvrtc:{get:function(){return this._pvrtc}},etc1:{get:function(){return this._etc1}},vertexArrayObject:{get:function(){return this._vertexArrayObject||this._webgl2}},fragmentDepth:{get:function(){return this._fragDepth||this._webgl2}},instancedArrays:{get:function(){return this._instancedArrays||this._webgl2}},colorBufferFloat:{get:function(){return this._colorBufferFloat}},colorBufferHalfFloat:{get:function(){return this._webgl2&&this._colorBufferFloat||!this._webgl2&&this._colorBufferHalfFloat}},drawBuffers:{get:function(){return this._drawBuffers||this._webgl2}},debugShaders:{get:function(){return this._debugShaders}},throwOnWebGLError:{get:function(){return this._throwOnWebGLError},set:function(e){this._throwOnWebGLError=e,this._gl=function(e,t){if(!Object(u.a)(t))return e;function i(i){return function(){var n=i.apply(e,arguments);return t(e,i,arguments),n}}var n={};for(var r in e){var a=e[r];a instanceof Function?n[r]=i(a):Object.defineProperty(n,r,Gne(e,r,t))}return n}(this._originalGLContext,e?Hne:void 0)}},defaultTexture:{get:function(){return void 0===this._defaultTexture&&(this._defaultTexture=new hj({context:this,source:{width:1,height:1,arrayBufferView:new Uint8Array([255,255,255,255])},flipY:!1})),this._defaultTexture}},defaultTransparentTexture:{get:function(){return void 0===this._defaultTransparentTexture&&(this._defaultTransparentTexture=new hj({context:this,source:{width:1,height:1,arrayBufferView:new Uint8Array([255,255,255,0])},flipY:!1})),this._defaultTransparentTexture}},defaultCubeMap:{get:function(){if(void 0===this._defaultCubeMap){var e={width:1,height:1,arrayBufferView:new Uint8Array([255,255,255,255])};this._defaultCubeMap=new nj({context:this,source:{positiveX:e,negativeX:e,positiveY:e,negativeY:e,positiveZ:e,negativeZ:e},flipY:!1})}return this._defaultCubeMap}},drawingBufferHeight:{get:function(){return this._gl.drawingBufferHeight}},drawingBufferWidth:{get:function(){return this._gl.drawingBufferWidth}},defaultFramebuffer:{get:function(){return Xne}}}),"undefined"!=typeof WebGLRenderingContext&&(Yne=[un.BACK]);var Kne=new fX;Wne.prototype.clear=function(e,t){e=Object(w.a)(e,Kne),t=Object(w.a)(t,this._defaultPassState);var i=this._gl,n=0,r=e.color,a=e.depth,o=e.stencil;Object(u.a)(r)&&(uf.equals(this._clearColor,r)||(uf.clone(r,this._clearColor),i.clearColor(r.red,r.green,r.blue,r.alpha)),n|=i.COLOR_BUFFER_BIT),Object(u.a)(a)&&(a!==this._clearDepth&&(this._clearDepth=a,i.clearDepth(a)),n|=i.DEPTH_BUFFER_BIT),Object(u.a)(o)&&(o!==this._clearStencil&&(this._clearStencil=o,i.clearStencil(o)),n|=i.STENCIL_BUFFER_BIT),Zne(this,Object(w.a)(e.renderState,this._defaultRenderState),t,!0),Qne(this,Object(w.a)(e.framebuffer,t.framebuffer)),i.clear(n)},Wne.prototype.draw=function(e,t,i,n){x.a.defined("drawCommand",e),x.a.defined("drawCommand.shaderProgram",e._shaderProgram),t=Object(w.a)(t,this._defaultPassState);var r=Object(w.a)(e._framebuffer,t.framebuffer),a=Object(w.a)(e._renderState,this._defaultRenderState);i=Object(w.a)(i,e._shaderProgram),n=Object(w.a)(n,e._uniformMap),function(e,t,i,n,r){if(Object(u.a)(t)&&r.depthTest&&r.depthTest.enabled&&!t.hasDepthAttachment)throw new h.a("The depth test can not be enabled (drawCommand.renderState.depthTest.enabled) because the framebuffer (drawCommand.framebuffer) does not have a depth or depth-stencil renderbuffer.");Qne(e,t),Zne(e,r,i,!1),n._bind(),e._maxFrameTextureUnitIndex=Math.max(e._maxFrameTextureUnitIndex,n.maximumTextureUnitIndex)}(this,r,t,i,a),function(e,t,i,n){var r=t._primitiveType,a=t._vertexArray,o=t._offset,s=t._count,c=t.instanceCount;if(!yn.validate(r))throw new h.a("drawCommand.primitiveType is required and must be valid.");if(x.a.defined("drawCommand.vertexArray",a),x.a.typeOf.number.greaterThanOrEquals("drawCommand.offset",o,0),Object(u.a)(s)&&x.a.typeOf.number.greaterThanOrEquals("drawCommand.count",s,0),x.a.typeOf.number.greaterThanOrEquals("drawCommand.instanceCount",c,0),c>0&&!e.instancedArrays)throw new h.a("Instanced arrays extension is not supported");e._us.model=Object(w.a)(t._modelMatrix,Be.IDENTITY),i._setUniforms(n,e._us,e.validateShaderProgram),a._bind();var l=a.indexBuffer;Object(u.a)(l)?(o*=l.bytesPerIndex,s=Object(w.a)(s,l.numberOfIndices),0===c?e._gl.drawElements(r,s,l.indexDatatype,o):e.glDrawElementsInstanced(r,s,l.indexDatatype,o,c)):(s=Object(w.a)(s,a.numberOfVertices),0===c?e._gl.drawArrays(r,o,s):e.glDrawArraysInstanced(r,o,s,c)),a._unBind()}(this,e,i,n)},Wne.prototype.endFrame=function(){var e=this._gl;e.useProgram(null),this._currentFramebuffer=void 0,e.bindFramebuffer(e.FRAMEBUFFER,null);var t=Yne;this.drawBuffers&&this.glDrawBuffers(t);var i=this._maxFrameTextureUnitIndex;this._maxFrameTextureUnitIndex=0;for(var n=0;n<i;++n)e.activeTexture(e.TEXTURE0+n),e.bindTexture(e.TEXTURE_2D,null),e.bindTexture(e.TEXTURE_CUBE_MAP,null)},Wne.prototype.readPixels=function(e){var t=this._gl;e=Object(w.a)(e,w.a.EMPTY_OBJECT);var i=Math.max(Object(w.a)(e.x,0),0),n=Math.max(Object(w.a)(e.y,0),0),r=Object(w.a)(e.width,t.drawingBufferWidth),a=Object(w.a)(e.height,t.drawingBufferHeight),o=e.framebuffer;x.a.typeOf.number.greaterThan("readState.width",r,0),x.a.typeOf.number.greaterThan("readState.height",a,0);var s=mx.UNSIGNED_BYTE;Object(u.a)(o)&&o.numberOfColorAttachments>0&&(s=o.getColorTexture(0).pixelDatatype);var c=gx.createTypedArray(gx.RGBA,s,r,a);return Qne(this,o),t.readPixels(i,n,r,a,gx.RGBA,s,c),c};var Jne={position:0,textureCoordinates:1};function $ne(e,t,i){this._pickObjects=e,this.key=t,this.color=i}Wne.prototype.getViewportQuadVertexArray=function(){var e=this.cache.viewportQuad_vertexArray;if(!Object(u.a)(e)){var t=new La({attributes:{position:new Na({componentDatatype:dn.FLOAT,componentsPerAttribute:2,values:[-1,-1,1,-1,1,1,-1,1]}),textureCoordinates:new Na({componentDatatype:dn.FLOAT,componentsPerAttribute:2,values:[0,0,1,0,1,1,0,1]})},indices:new Uint16Array([0,1,2,0,2,3]),primitiveType:yn.TRIANGLES});e=tF.fromGeometry({context:this,geometry:t,attributeLocations:Jne,bufferUsage:YN.STATIC_DRAW,interleave:!0}),this.cache.viewportQuad_vertexArray=e}return e},Wne.prototype.createViewportQuadCommand=function(e,t){return t=Object(w.a)(t,w.a.EMPTY_OBJECT),new cM({vertexArray:this.getViewportQuadVertexArray(),primitiveType:yn.TRIANGLES,renderState:t.renderState,shaderProgram:bR.fromCache({context:this,vertexShaderSource:Object(w.a)(t.vertexShaderSource,pne),fragmentShaderSource:e,attributeLocations:Jne}),uniformMap:t.uniformMap,owner:t.owner,framebuffer:t.framebuffer,pass:t.pass})},Wne.prototype.getObjectByPickColor=function(e){return x.a.defined("pickColor",e),this._pickObjects[e.toRgba()]},Object(O.a)($ne.prototype,{object:{get:function(){return this._pickObjects[this.key]},set:function(e){this._pickObjects[this.key]=e}}}),$ne.prototype.destroy=function(){delete this._pickObjects[this.key]},Wne.prototype.createPickId=function(e){x.a.defined("object",e),++this._nextPickColor[0];var t=this._nextPickColor[0];if(0===t)throw new Ce.a("Out of unique Pick IDs.");return this._pickObjects[t]=e,new $ne(this._pickObjects,t,uf.fromRgba(t))},Wne.prototype.isDestroyed=function(){return!1},Wne.prototype.destroy=function(){var e=this.cache;for(var t in e)if(e.hasOwnProperty(t)){var i=e[t];Object(u.a)(i.destroy)&&i.destroy()}return this._shaderCache=this._shaderCache.destroy(),this._textureCache=this._textureCache.destroy(),this._defaultTexture=this._defaultTexture&&this._defaultTexture.destroy(),this._defaultCubeMap=this._defaultCubeMap&&this._defaultCubeMap.destroy(),rl(this)};var ere=Wne;var tre=function(e,t){if(x.a.defined("context",e),!(Object(u.a)(t)&&Object(u.a)(t.positiveX)&&Object(u.a)(t.negativeX)&&Object(u.a)(t.positiveY)&&Object(u.a)(t.negativeY)&&Object(u.a)(t.positiveZ)&&Object(u.a)(t.negativeZ)))throw new h.a("urls is required and must have positiveX, negativeX, positiveY, negativeY, positiveZ, and negativeZ properties.");var i=[f.a.createIfNeeded(t.positiveX).fetchImage(),f.a.createIfNeeded(t.negativeX).fetchImage(),f.a.createIfNeeded(t.positiveY).fetchImage(),f.a.createIfNeeded(t.negativeY).fetchImage(),f.a.createIfNeeded(t.positiveZ).fetchImage(),f.a.createIfNeeded(t.negativeZ).fetchImage()];return Oi.a.all(i,(function(t){return new nj({context:e,source:{positiveX:t[0],negativeX:t[1],positiveY:t[2],negativeY:t[3],positiveZ:t[4],negativeZ:t[5]}})}))},ire={RGBA4:un.RGBA4,RGBA8:un.RGBA8,RGB5_A1:un.RGB5_A1,RGB565:un.RGB565,DEPTH_COMPONENT16:un.DEPTH_COMPONENT16,STENCIL_INDEX8:un.STENCIL_INDEX8,DEPTH_STENCIL:un.DEPTH_STENCIL,DEPTH24_STENCIL8:un.DEPTH24_STENCIL8,RGBA16F:un.RGBA16F,RGBA32F:un.RGBA32F,validate:function(e){return e===ire.RGBA4||e===ire.RGBA8||e===ire.RGB5_A1||e===ire.RGB565||e===ire.DEPTH_COMPONENT16||e===ire.STENCIL_INDEX8||e===ire.DEPTH_STENCIL||e===ire.DEPTH24_STENCIL8||e===ire.RGBA16F||e===ire.RGBA32F}},nre=Object(E.a)(ire);function rre(e){e=Object(w.a)(e,w.a.EMPTY_OBJECT),x.a.defined("options.context",e.context);var t=e.context._gl,i=HD.maximumRenderbufferSize,n=Object(w.a)(e.format,nre.RGBA4),r=Object(u.a)(e.width)?e.width:t.drawingBufferWidth,a=Object(u.a)(e.height)?e.height:t.drawingBufferHeight,o=Object(w.a)(e.samples,1);if(!nre.validate(n))throw new h.a("Invalid format.");if(x.a.typeOf.number.greaterThan("width",r,0),r>i)throw new h.a("Width must be less than or equal to the maximum renderbuffer size ("+i+").  Check maximumRenderbufferSize.");if(x.a.typeOf.number.greaterThan("height",a,0),a>i)throw new h.a("Height must be less than or equal to the maximum renderbuffer size ("+i+").  Check maximumRenderbufferSize.");this._gl=t,this._format=n,this._width=r,this._height=a,this._renderbuffer=this._gl.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,this._renderbuffer),fx.isWebgl2&&o>1?t.renderbufferStorageMultisample(t.RENDERBUFFER,o,n,r,a):t.renderbufferStorage(t.RENDERBUFFER,n,r,a),t.bindRenderbuffer(t.RENDERBUFFER,null)}Object(O.a)(rre.prototype,{format:{get:function(){return this._format}},width:{get:function(){return this._width}},height:{get:function(){return this._height}}}),rre.prototype._getRenderbuffer=function(){return this._renderbuffer},rre.prototype.isDestroyed=function(){return!1},rre.prototype.destroy=function(){return this._gl.deleteRenderbuffer(this._renderbuffer),rl(this)};var are=rre;function ore(e){if(e=Object(w.a)(e,w.a.EMPTY_OBJECT),!Object(u.a)(e.missingImageUrl))throw new h.a("options.missingImageUrl is required.");if(!Object(u.a)(e.pixelsToCheck))throw new h.a("options.pixelsToCheck is required.");this._pixelsToCheck=e.pixelsToCheck,this._missingImagePixels=void 0,this._missingImageByteLength=void 0,this._isReady=!1;var t=f.a.createIfNeeded(e.missingImageUrl),i=this;Object(Oi.a)(t.fetchImage(!0),(function(t){Object(u.a)(t.blob)&&(i._missingImageByteLength=t.blob.size);var n=sy(t);if(e.disableCheckIfAllPixelsAreTransparent){for(var r=!0,a=t.width,o=e.pixelsToCheck,s=0,c=o.length;r&&s<c;++s){var l=o[s];n[4*l.x+l.y*a+3]>0&&(r=!1)}r&&(n=void 0)}i._missingImagePixels=n,i._isReady=!0}),(function(){i._missingImagePixels=void 0,i._isReady=!0}))}ore.prototype.isReady=function(){return this._isReady},ore.prototype.shouldDiscardImage=function(e){if(!this._isReady)throw new h.a("shouldDiscardImage must not be called before the discard policy is ready.");var t=this._pixelsToCheck,i=this._missingImagePixels;if(!Object(u.a)(i))return!1;if(Object(u.a)(e.blob)&&e.blob.size!==this._missingImageByteLength)return!1;for(var n=sy(e),r=e.width,a=0,o=t.length;a<o;++a)for(var s=t[a],c=4*s.x+s.y*r,l=0;l<4;++l){var d=c+l;if(n[d]!==i[d])return!1}return!0};var sre=ore;function cre(){this.name=void 0,this.description=void 0,this.position=void 0,this.data=void 0,this.imageryLayer=void 0}cre.prototype.configureNameFromProperties=function(e){var t,i=10;for(var n in e)if(e.hasOwnProperty(n)&&e[n]){var r=n.toLowerCase();i>1&&"name"===r?(i=1,t=n):i>2&&"title"===r?(i=2,t=n):i>3&&/name/i.test(n)?(i=3,t=n):i>4&&/title/i.test(n)&&(i=4,t=n)}Object(u.a)(t)&&(this.name=e[t])},cre.prototype.configureDescriptionFromProperties=function(e){this.description=function e(t){var i='<table class="cesium-infoBox-defaultTable">';for(var n in t)if(t.hasOwnProperty(n)){var r=t[n];Object(u.a)(r)&&(i+="object"==typeof r?"<tr><td>"+n+"</td><td>"+e(r)+"</td></tr>":"<tr><td>"+n+"</td><td>"+r+"</td></tr>")}return i+="</table>"}(e)};var lre=cre;function ure(){this.defaultAlpha=void 0,this.defaultBrightness=void 0,this.defaultContrast=void 0,this.defaultHue=void 0,this.defaultSaturation=void 0,this.defaultGamma=void 0,this.defaultMinificationFilter=void 0,this.defaultMagnificationFilter=void 0,h.a.throwInstantiationError()}Object(O.a)(ure.prototype,{ready:{get:h.a.throwInstantiationError},readyPromise:{get:h.a.throwInstantiationError},rectangle:{get:h.a.throwInstantiationError},tileWidth:{get:h.a.throwInstantiationError},tileHeight:{get:h.a.throwInstantiationError},maximumLevel:{get:h.a.throwInstantiationError},minimumLevel:{get:h.a.throwInstantiationError},tilingScheme:{get:h.a.throwInstantiationError},tileDiscardPolicy:{get:h.a.throwInstantiationError},errorEvent:{get:h.a.throwInstantiationError},credit:{get:h.a.throwInstantiationError},proxy:{get:h.a.throwInstantiationError},hasAlphaChannel:{get:h.a.throwInstantiationError}}),ure.prototype.getTileCredits=h.a.throwInstantiationError,ure.prototype.requestImage=h.a.throwInstantiationError,ure.prototype.pickFeatures=h.a.throwInstantiationError;var hre=/\.ktx$/i,dre=/\.crn$/i;ure.loadImage=function(e,t){x.a.defined("url",t);var i=f.a.createIfNeeded(t);return hre.test(i)?Ox(i):dre.test(i)?ux(i):Object(u.a)(e.tileDiscardPolicy)?i.fetchImage(!0):i.fetchImage()};var fre=ure;function pre(e){if(e=Object(w.a)(e,{}),!Object(u.a)(e.url))throw new h.a("options.url is required.");var t=f.a.createIfNeeded(e.url);t.appendForwardSlash(),Object(u.a)(e.token)&&t.setQueryParameters({token:e.token}),this._resource=t,this._tileDiscardPolicy=e.tileDiscardPolicy,this._tileWidth=Object(w.a)(e.tileWidth,256),this._tileHeight=Object(w.a)(e.tileHeight,256),this._maximumLevel=e.maximumLevel,this._tilingScheme=Object(w.a)(e.tilingScheme,new Nt({ellipsoid:e.ellipsoid})),this._useTiles=Object(w.a)(e.usePreCachedTilesIfAvailable,!0),this._rectangle=Object(w.a)(e.rectangle,this._tilingScheme.rectangle),this._layers=e.layers;var i=e.credit;"string"==typeof i&&(i=new Jo(i)),this._credit=i,this.enablePickFeatures=Object(w.a)(e.enablePickFeatures,!0),this._errorEvent=new $o.a,this._ready=!1,this._readyPromise=Oi.a.defer();var n,r=this;function a(t){var i=t.tileInfo;if(Object(u.a)(i)){if(r._tileWidth=i.rows,r._tileHeight=i.cols,102100===i.spatialReference.wkid||102113===i.spatialReference.wkid)r._tilingScheme=new GI({ellipsoid:e.ellipsoid});else{if(4326!==t.tileInfo.spatialReference.wkid){var a="Tile spatial reference WKID "+t.tileInfo.spatialReference.wkid+" is not supported.";return void(n=uu.handleError(n,r,r._errorEvent,a,void 0,void 0,void 0,s))}r._tilingScheme=new Nt({ellipsoid:e.ellipsoid})}if(r._maximumLevel=t.tileInfo.lods.length-1,Object(u.a)(t.fullExtent)){if(Object(u.a)(t.fullExtent.spatialReference)&&Object(u.a)(t.fullExtent.spatialReference.wkid))if(102100===t.fullExtent.spatialReference.wkid||102113===t.fullExtent.spatialReference.wkid){var o=new Qc,c=t.fullExtent,l=o.unproject(new z(Math.max(c.xmin,-r._tilingScheme.ellipsoid.maximumRadius*Math.PI),Math.max(c.ymin,-r._tilingScheme.ellipsoid.maximumRadius*Math.PI),0)),h=o.unproject(new z(Math.min(c.xmax,r._tilingScheme.ellipsoid.maximumRadius*Math.PI),Math.min(c.ymax,r._tilingScheme.ellipsoid.maximumRadius*Math.PI),0));r._rectangle=new Ve(l.longitude,l.latitude,h.longitude,h.latitude)}else{if(4326!==t.fullExtent.spatialReference.wkid){var d="fullExtent.spatialReference WKID "+t.fullExtent.spatialReference.wkid+" is not supported.";return void(n=uu.handleError(n,r,r._errorEvent,d,void 0,void 0,void 0,s))}r._rectangle=Ve.fromDegrees(t.fullExtent.xmin,t.fullExtent.ymin,t.fullExtent.xmax,t.fullExtent.ymax)}}else r._rectangle=r._tilingScheme.rectangle;Object(u.a)(r._tileDiscardPolicy)||(r._tileDiscardPolicy=new sre({missingImageUrl:mre(r,0,0,r._maximumLevel).url,pixelsToCheck:[new Rt(0,0),new Rt(200,20),new Rt(20,200),new Rt(80,110),new Rt(160,130)],disableCheckIfAllPixelsAreTransparent:!0})),r._useTiles=!0}else r._useTiles=!1;Object(u.a)(t.copyrightText)&&t.copyrightText.length>0&&(r._credit=new Jo(t.copyrightText)),r._ready=!0,r._readyPromise.resolve(!0),uu.handleSuccess(n)}function o(e){var t="An error occurred while accessing "+r._resource.url+".";n=uu.handleError(n,r,r._errorEvent,t,void 0,void 0,void 0,s),r._readyPromise.reject(new Ce.a(t))}function s(){var e=r._resource.getDerivedResource({queryParameters:{f:"json"}}).fetchJsonp();Object(Oi.a)(e,a,o)}this._useTiles?s():(this._ready=!0,this._readyPromise.resolve(!0))}function mre(e,t,i,n,r){var a;if(e._useTiles)a=e._resource.getDerivedResource({url:"tile/"+n+"/"+i+"/"+t,request:r});else{var o=e._tilingScheme.tileXYToNativeRectangle(t,i,n),s={bbox:o.west+","+o.south+","+o.east+","+o.north,size:e._tileWidth+","+e._tileHeight,format:"png",transparent:!0,f:"image"};e._tilingScheme.projection instanceof se?(s.bboxSR=4326,s.imageSR=4326):(s.bboxSR=3857,s.imageSR=3857),e.layers&&(s.layers="show:"+e.layers),a=e._resource.getDerivedResource({url:"export",request:r,queryParameters:s})}return a}Object(O.a)(pre.prototype,{url:{get:function(){return this._resource._url}},token:{get:function(){return this._resource.queryParameters.token}},proxy:{get:function(){return this._resource.proxy}},tileWidth:{get:function(){if(!this._ready)throw new h.a("tileWidth must not be called before the imagery provider is ready.");return this._tileWidth}},tileHeight:{get:function(){if(!this._ready)throw new h.a("tileHeight must not be called before the imagery provider is ready.");return this._tileHeight}},maximumLevel:{get:function(){if(!this._ready)throw new h.a("maximumLevel must not be called before the imagery provider is ready.");return this._maximumLevel}},minimumLevel:{get:function(){if(!this._ready)throw new h.a("minimumLevel must not be called before the imagery provider is ready.");return 0}},tilingScheme:{get:function(){if(!this._ready)throw new h.a("tilingScheme must not be called before the imagery provider is ready.");return this._tilingScheme}},rectangle:{get:function(){if(!this._ready)throw new h.a("rectangle must not be called before the imagery provider is ready.");return this._rectangle}},tileDiscardPolicy:{get:function(){if(!this._ready)throw new h.a("tileDiscardPolicy must not be called before the imagery provider is ready.");return this._tileDiscardPolicy}},errorEvent:{get:function(){return this._errorEvent}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise.promise}},credit:{get:function(){return this._credit}},usingPrecachedTiles:{get:function(){return this._useTiles}},hasAlphaChannel:{get:function(){return!0}},layers:{get:function(){return this._layers}}}),pre.prototype.getTileCredits=function(e,t,i){},pre.prototype.requestImage=function(e,t,i,n){if(!this._ready)throw new h.a("requestImage must not be called before the imagery provider is ready.");return fre.loadImage(this,mre(this,e,t,i,n))},pre.prototype.pickFeatures=function(e,t,i,n,r){if(!this._ready)throw new h.a("pickFeatures must not be called before the imagery provider is ready.");if(this.enablePickFeatures){var a,o,s,c=this._tilingScheme.tileXYToNativeRectangle(e,t,i);if(this._tilingScheme.projection instanceof se)a=I.toDegrees(n),o=I.toDegrees(r),s="4326";else{var l=this._tilingScheme.projection.project(new K(n,r,0));a=l.x,o=l.y,s="3857"}var d="visible";Object(u.a)(this._layers)&&(d+=":"+this._layers);var f={f:"json",tolerance:2,geometryType:"esriGeometryPoint",geometry:a+","+o,mapExtent:c.west+","+c.south+","+c.east+","+c.north,imageDisplay:this._tileWidth+","+this._tileHeight+",96",sr:s,layers:d};return this._resource.getDerivedResource({url:"identify",queryParameters:f}).fetchJson().then((function(e){var t=[],i=e.results;if(!Object(u.a)(i))return t;for(var n=0;n<i.length;++n){var r=i[n],a=new lre;if(a.data=r,a.name=r.value,a.properties=r.attributes,a.configureDescriptionFromProperties(r.attributes),"esriGeometryPoint"===r.geometryType&&r.geometry){var o=r.geometry.spatialReference&&r.geometry.spatialReference.wkid?r.geometry.spatialReference.wkid:4326;if(4326===o||4283===o)a.position=K.fromDegrees(r.geometry.x,r.geometry.y,r.geometry.z);else if(102100===o||900913===o||3857===o){var s=new Qc;a.position=s.unproject(new z(r.geometry.x,r.geometry.y,r.geometry.z))}}t.push(a)}return t}))}};var _re=pre;function gre(){this._uniformMap=void 0,this._command=void 0,this._colorTexture=void 0,this._depthTexture=void 0,this._ready=!1,this._name="czm_autoexposure",this._logDepthChanged=void 0,this._useLogDepth=void 0,this._framebuffers=void 0,this._previousLuminance=void 0,this._commands=void 0,this._clearCommand=void 0,this._minMaxLuminance=new Rt,this.enabled=!0,this._enabled=!0,this.minimumLuminance=.1,this.maximumLuminance=10}function vre(e){var t=e._framebuffers;if(Object(u.a)(t)){for(var i=t.length,n=0;n<i;++n)t[n].destroy();e._framebuffers=void 0,e._previousLuminance.destroy(),e._previousLuminance=void 0}}function bre(e){var t=e._commands;if(Object(u.a)(t)){for(var i=t.length,n=0;n<i;++n)t[n].shaderProgram.destroy();e._commands=void 0}}function yre(e,t){var i;if(0===t)i={colorTexture:function(){return e._colorTexture},colorTextureDimensions:function(){return e._colorTexture.dimensions}};else{var n=e._framebuffers[t-1].getColorTexture(0);i={colorTexture:function(){return n},colorTextureDimensions:function(){return n.dimensions}}}return i.minMaxLuminance=function(){return e._minMaxLuminance},i.previousLuminance=function(){return e._previousLuminance.getColorTexture(0)},i}function wre(e,t){var i="uniform sampler2D colorTexture; \nvarying vec2 v_textureCoordinates; \nfloat sampleTexture(vec2 offset) { \n";return i+=0===e?"    vec4 color = texture2D(colorTexture, v_textureCoordinates + offset); \n    return czm_luminance(color.rgb); \n":"    return texture2D(colorTexture, v_textureCoordinates + offset).r; \n",i+="}\n\n",i+="uniform vec2 colorTextureDimensions; \nuniform vec2 minMaxLuminance; \nuniform sampler2D previousLuminance; \nvoid main() { \n    float color = 0.0; \n    float xStep = 1.0 / colorTextureDimensions.x; \n    float yStep = 1.0 / colorTextureDimensions.y; \n    int count = 0; \n    for (int i = 0; i < 3; ++i) { \n        for (int j = 0; j < 3; ++j) { \n            vec2 offset; \n            offset.x = -xStep + float(i) * xStep; \n            offset.y = -yStep + float(j) * yStep; \n            if (offset.x < 0.0 || offset.x > 1.0 || offset.y < 0.0 || offset.y > 1.0) { \n                continue; \n            } \n            color += sampleTexture(offset); \n            ++count; \n        } \n    } \n    if (count > 0) { \n        color /= float(count); \n    } \n",e===t-1&&(i+="    float previous = texture2D(previousLuminance, vec2(0.5)).r; \n    color = clamp(color, minMaxLuminance.x, minMaxLuminance.y); \n    color = previous + (color - previous) / (60.0 * 1.5); \n    color = clamp(color, minMaxLuminance.x, minMaxLuminance.y); \n"),i+="    gl_FragColor = vec4(color); \n} \n"}Object(O.a)(gre.prototype,{ready:{get:function(){return this._ready}},name:{get:function(){return this._name}},outputTexture:{get:function(){var e=this._framebuffers;if(Object(u.a)(e))return e[e.length-1].getColorTexture(0)}}}),gre.prototype.clear=function(e){var t=this._framebuffers;if(Object(u.a)(t)){var i=this._clearCommand;Object(u.a)(i)||(i=this._clearCommand=new fX({color:new uf(0,0,0,0),framebuffer:void 0}));for(var n=t.length,r=0;r<n;++r)i.framebuffer=t[r],i.execute(e)}},gre.prototype.update=function(e){var t=e.drawingBufferWidth,i=e.drawingBufferHeight;t===this._width&&i===this._height||(this._width=t,this._height=i,function(e,t){vre(e);for(var i=e._width,n=e._height,r=gx.RGBA,a=t.halfFloatingPointTexture?mx.HALF_FLOAT:mx.FLOAT,o=new tj({wrapS:$D.CLAMP_TO_EDGE,wrapT:$D.CLAMP_TO_EDGE,minificationFilter:KD.NEAREST,magnificationFilter:ZD.NEAREST}),s=Math.ceil(Math.log(Math.max(i,n))/Math.log(3)),c=new Array(s),l=0;l<s;++l)i=Math.max(Math.ceil(i/3),1),n=Math.max(Math.ceil(n/3),1),c[l]=new cj({context:t,colorTextures:[new hj({context:t,width:i,height:n,pixelFormat:r,pixelDatatype:a,sampler:o})]});var u=c[s-1].getColorTexture(0);e._previousLuminance=new cj({context:t,colorTextures:[new hj({context:t,width:u.width,height:u.height,pixelFormat:r,pixelDatatype:a,sampler:o})]}),e._framebuffers=c}(this,e),function(e,t){bre(e);for(var i=e._framebuffers,n=i.length,r=new Array(n),a=0;a<n;++a)r[a]=t.createViewportQuadCommand(wre(a,n),{framebuffer:i[a],uniformMap:yre(e,a)});e._commands=r}(this,e),this._ready||(this._ready=!0)),this._minMaxLuminance.x=this.minimumLuminance,this._minMaxLuminance.y=this.maximumLuminance;var n=this._framebuffers,r=n[n.length-1];n[n.length-1]=this._previousLuminance,this._commands[this._commands.length-1].framebuffer=this._previousLuminance,this._previousLuminance=r},gre.prototype.execute=function(e,t){this._colorTexture=t;var i=this._commands;if(Object(u.a)(i))for(var n=i.length,r=0;r<n;++r)i[r].execute(e)},gre.prototype.isDestroyed=function(){return!1},gre.prototype.destroy=function(){return vre(this),bre(this),rl(this)};var Ore=gre,xre=Object(E.a)({AERIAL:"Aerial",AERIAL_WITH_LABELS:"AerialWithLabels",ROAD:"Road",CANVAS_DARK:"CanvasDark",CANVAS_LIGHT:"CanvasLight",CANVAS_GRAY:"CanvasGray",ORDNANCE_SURVEY:"OrdnanceSurvey",COLLINS_BART:"CollinsBart"});function Ere(e){if(e=Object(w.a)(e,{}),!Object(u.a)(e.url))throw new h.a("options.url is required.");this._key=en.getKey(e.key),this._resource=f.a.createIfNeeded(e.url),this._resource.appendForwardSlash(),this._tileProtocol=e.tileProtocol,this._mapStyle=Object(w.a)(e.mapStyle,xre.AERIAL),this._culture=Object(w.a)(e.culture,""),this._tileDiscardPolicy=e.tileDiscardPolicy,this._proxy=e.proxy,this._credit=new Jo('<a href="http://www.bing.com"><img src="'+Ere.logoUrl+'" title="Bing Imagery"/></a>'),this.defaultGamma=1,this._tilingScheme=new GI({numberOfLevelZeroTilesX:2,numberOfLevelZeroTilesY:2,ellipsoid:e.ellipsoid}),this._tileWidth=void 0,this._tileHeight=void 0,this._maximumLevel=void 0,this._imageUrlTemplate=void 0,this._imageUrlSubdomains=void 0,this._errorEvent=new $o.a,this._ready=!1,this._readyPromise=Oi.a.defer();var t,i=this._resource.getDerivedResource({url:"REST/v1/Imagery/Metadata/"+this._mapStyle,queryParameters:{incl:"ImageryProviders",key:this._key}}),n=this;function r(e){if(1===e.resourceSets.length){var i=e.resourceSets[0].resources[0];n._tileWidth=i.imageWidth,n._tileHeight=i.imageHeight,n._maximumLevel=i.zoomMax-1,n._imageUrlSubdomains=i.imageUrlSubdomains,n._imageUrlTemplate=i.imageUrl;var r=n._tileProtocol;if(!Object(u.a)(r)){var o=document.location.protocol;r=/^http/.test(o)?o:"http:"}n._imageUrlTemplate=n._imageUrlTemplate.replace(/^http:/,r),Object(u.a)(n._tileDiscardPolicy)||(n._tileDiscardPolicy=new sre({missingImageUrl:Cre(n,0,0,n._maximumLevel).url,pixelsToCheck:[new Rt(0,0),new Rt(120,140),new Rt(130,160),new Rt(200,50),new Rt(200,200)],disableCheckIfAllPixelsAreTransparent:!0}));var s=n._attributionList=i.imageryProviders;s||(s=n._attributionList=[]);for(var c=0,l=s.length;c<l;++c){var h=s[c];h.credit=new Jo(h.attribution);for(var d=h.coverageAreas,f=0,p=h.coverageAreas.length;f<p;++f){var m=d[f],_=m.bbox;m.bbox=new Ve(I.toRadians(_[1]),I.toRadians(_[0]),I.toRadians(_[3]),I.toRadians(_[2]))}}n._ready=!0,n._readyPromise.resolve(!0),uu.handleSuccess(t)}else a()}function a(e){var r="An error occurred while accessing "+i.url+".";t=uu.handleError(t,n,n._errorEvent,r,void 0,void 0,void 0,o),n._readyPromise.reject(new Ce.a(r))}function o(){var e=i.fetchJsonp("jsonp");Object(Oi.a)(e,r,a)}o()}Object(O.a)(Ere.prototype,{url:{get:function(){return this._resource.url}},proxy:{get:function(){return this._resource.proxy}},key:{get:function(){return this._key}},mapStyle:{get:function(){return this._mapStyle}},culture:{get:function(){return this._culture}},tileWidth:{get:function(){if(!this._ready)throw new h.a("tileWidth must not be called before the imagery provider is ready.");return this._tileWidth}},tileHeight:{get:function(){if(!this._ready)throw new h.a("tileHeight must not be called before the imagery provider is ready.");return this._tileHeight}},maximumLevel:{get:function(){if(!this._ready)throw new h.a("maximumLevel must not be called before the imagery provider is ready.");return this._maximumLevel}},minimumLevel:{get:function(){if(!this._ready)throw new h.a("minimumLevel must not be called before the imagery provider is ready.");return 0}},tilingScheme:{get:function(){if(!this._ready)throw new h.a("tilingScheme must not be called before the imagery provider is ready.");return this._tilingScheme}},rectangle:{get:function(){if(!this._ready)throw new h.a("rectangle must not be called before the imagery provider is ready.");return this._tilingScheme.rectangle}},tileDiscardPolicy:{get:function(){if(!this._ready)throw new h.a("tileDiscardPolicy must not be called before the imagery provider is ready.");return this._tileDiscardPolicy}},errorEvent:{get:function(){return this._errorEvent}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise.promise}},credit:{get:function(){return this._credit}},hasAlphaChannel:{get:function(){return!1}}});var Tre=new Ve;function Cre(e,t,i,n,r){var a=e._imageUrlTemplate,o=e._imageUrlSubdomains,s=(t+i+n)%o.length;return e._resource.getDerivedResource({url:a,request:r,templateValues:{quadkey:Ere.tileXYToQuadKey(t,i,n),subdomain:o[s],culture:e._culture}})}Ere.prototype.getTileCredits=function(e,t,i){if(!this._ready)throw new h.a("getTileCredits must not be called before the imagery provider is ready.");var n=this._tilingScheme.tileXYToRectangle(e,t,i,Tre);return function(e,t,i){++t;for(var n=[],r=0,a=e.length;r<a;++r){for(var o=e[r],s=o.coverageAreas,c=!1,l=0,h=o.coverageAreas.length;!c&&l<h;++l){var d=s[l];if(t>=d.zoomMin&&t<=d.zoomMax){var f=Ve.intersection(i,d.bbox,Sre);Object(u.a)(f)&&(c=!0)}}c&&n.push(o.credit)}return n}(this._attributionList,i,n)},Ere.prototype.requestImage=function(e,t,i,n){if(!this._ready)throw new h.a("requestImage must not be called before the imagery provider is ready.");return fre.loadImage(this,Cre(this,e,t,i,n))},Ere.prototype.pickFeatures=function(e,t,i,n,r){},Ere.tileXYToQuadKey=function(e,t,i){for(var n="",r=i;r>=0;--r){var a=1<<r,o=0;0!=(e&a)&&(o|=1),0!=(t&a)&&(o|=2),n+=o}return n},Ere.quadKeyToTileXY=function(e){for(var t=0,i=0,n=e.length-1,r=n;r>=0;--r){var a=1<<r,o=+e[n-r];0!=(1&o)&&(t|=a),0!=(2&o)&&(i|=a)}return{x:t,y:i,level:n}},Ere._logoUrl=void 0,Object(O.a)(Ere,{logoUrl:{get:function(){return Object(u.a)(Ere._logoUrl)||(Ere._logoUrl=y("Assets/Images/bing_maps_credit.png")),Ere._logoUrl},set:function(e){x.a.defined("value",e),Ere._logoUrl=e}}});var Sre=new Ve;var Are=Ere,Pre=new z(1,1,1);function Ire(e){e=Object(w.a)(e,Pre),x.a.defined("dimensions",e),x.a.typeOf.number.greaterThanOrEquals("dimensions.x",e.x,0),x.a.typeOf.number.greaterThanOrEquals("dimensions.y",e.y,0),x.a.typeOf.number.greaterThanOrEquals("dimensions.z",e.z,0),this._dimensions=z.clone(e)}Object(O.a)(Ire.prototype,{dimensions:{get:function(){return this._dimensions},set:function(e){x.a.defined("value",e),x.a.typeOf.number.greaterThanOrEquals("value.x",e.x,0),x.a.typeOf.number.greaterThanOrEquals("value.y",e.y,0),x.a.typeOf.number.greaterThanOrEquals("value.z",e.z,0),z.clone(e,this._dimensions)}}});var Dre=new z;Ire.prototype.emit=function(e){var t=this._dimensions,i=z.multiplyByScalar(t,.5,Dre),n=I.randomBetween(-i.x,i.x),r=I.randomBetween(-i.y,i.y),a=I.randomBetween(-i.z,i.z);e.position=z.fromElements(n,r,a,e.position),e.velocity=z.normalize(e.position,e.velocity)};var jre=Ire,Mre="varying vec2 v_textureCoordinates;\nconst float M_PI = 3.141592653589793;\nfloat vdcRadicalInverse(int i)\n{\nfloat r;\nfloat base = 2.0;\nfloat value = 0.0;\nfloat invBase = 1.0 / base;\nfloat invBi = invBase;\nfor (int x = 0; x < 100; x++)\n{\nif (i <= 0)\n{\nbreak;\n}\nr = mod(float(i), base);\nvalue += r * invBi;\ninvBi *= invBase;\ni = int(float(i) * invBase);\n}\nreturn value;\n}\nvec2 hammersley2D(int i, int N)\n{\nreturn vec2(float(i) / float(N), vdcRadicalInverse(i));\n}\nvec3 importanceSampleGGX(vec2 xi, float roughness, vec3 N)\n{\nfloat a = roughness * roughness;\nfloat phi = 2.0 * M_PI * xi.x;\nfloat cosTheta = sqrt((1.0 - xi.y) / (1.0 + (a * a - 1.0) * xi.y));\nfloat sinTheta = sqrt(1.0 - cosTheta * cosTheta);\nvec3 H = vec3(sinTheta * cos(phi), sinTheta * sin(phi), cosTheta);\nvec3 upVector = abs(N.z) < 0.999 ? vec3(0.0, 0.0, 1.0) : vec3(1.0, 0.0, 0.0);\nvec3 tangentX = normalize(cross(upVector, N));\nvec3 tangentY = cross(N, tangentX);\nreturn tangentX * H.x + tangentY * H.y + N * H.z;\n}\nfloat G1_Smith(float NdotV, float k)\n{\nreturn NdotV / (NdotV * (1.0 - k) + k);\n}\nfloat G_Smith(float roughness, float NdotV, float NdotL)\n{\nfloat k = roughness * roughness / 2.0;\nreturn G1_Smith(NdotV, k) * G1_Smith(NdotL, k);\n}\nvec2 integrateBrdf(float roughness, float NdotV)\n{\nvec3 V = vec3(sqrt(1.0 - NdotV * NdotV), 0.0, NdotV);\nfloat A = 0.0;\nfloat B = 0.0;\nconst int NumSamples = 1024;\nfor (int i = 0; i < NumSamples; i++)\n{\nvec2 xi = hammersley2D(i, NumSamples);\nvec3 H = importanceSampleGGX(xi, roughness, vec3(0.0, 0.0, 1.0));\nvec3 L = 2.0 * dot(V, H) * H - V;\nfloat NdotL = clamp(L.z, 0.0, 1.0);\nfloat NdotH = clamp(H.z, 0.0, 1.0);\nfloat VdotH = clamp(dot(V, H), 0.0, 1.0);\nif (NdotL > 0.0)\n{\nfloat G = G_Smith(roughness, NdotV, NdotL);\nfloat G_Vis = G * VdotH / (NdotH * NdotV);\nfloat Fc = pow(1.0 - VdotH, 5.0);\nA += (1.0 - Fc) * G_Vis;\nB += Fc * G_Vis;\n}\n}\nreturn vec2(A, B) / float(NumSamples);\n}\nvoid main()\n{\ngl_FragColor = vec4(integrateBrdf(1.0 - v_textureCoordinates.y, v_textureCoordinates.x), 0.0, 1.0);\n}\n";function Rre(){this._framebuffer=void 0,this._colorTexture=void 0,this._drawCommand=void 0}Object(O.a)(Rre.prototype,{colorTexture:{get:function(){return this._colorTexture}}}),Rre.prototype.update=function(e){if(!Object(u.a)(this._colorTexture)){var t=e.context;!function(e,t){var i=new hj({context:t,width:256,height:256,pixelFormat:gx.RGBA,pixelDatatype:mx.UNSIGNED_BYTE,sampler:new tj({wrapS:$D.CLAMP_TO_EDGE,wrapT:$D.CLAMP_TO_EDGE,minificationFilter:KD.NEAREST,magnificationFilter:ZD.NEAREST})});e._colorTexture=i;var n=new cj({context:t,colorTextures:[i],destroyAttachments:!1});e._framebuffer=n}(this,t),function(e,t){var i=e._framebuffer,n=t.createViewportQuadCommand(Mre,{framebuffer:i,renderState:RM.fromCache({viewport:new ln(0,0,256,256)})});e._drawCommand=n}(this,t),this._drawCommand.execute(t),this._framebuffer=this._framebuffer&&this._framebuffer.destroy(),this._drawCommand.shaderProgram=this._drawCommand.shaderProgram&&this._drawCommand.shaderProgram.destroy()}},Rre.prototype.isDestroyed=function(){return!1},Rre.prototype.destroy=function(){return this._colorTexture=this._colorTexture&&this._colorTexture.destroy(),rl(this)};var Lre=Rre,Nre={};var Fre=new z,kre=new z;function Bre(e,t,i,n,r){var a=r,o=Math.max(i,n);if(!Object(u.a)(a)){var s=e.position,c=t,l=e.up,h=e.right,d=e.frustum,f=z.subtract(s,c,Fre),p=z.magnitude(z.multiplyByScalar(l,z.dot(f,l),kre)),m=z.magnitude(z.multiplyByScalar(h,z.dot(f,h),kre));a=Math.min(.2*function(e,t,i){var n,r,a;if(e instanceof wb){var o=Math.tan(.5*e.fovy);return n=e.near,r=e.near*o,a=e.aspectRatio*r,Math.max(t*n/a,i*n/r)}return e instanceof vb?(n=e.near,r=e.top,a=e.right,Math.max(t*n/a,i*n/r)):Math.max(t,i)}(d,p,m),1e9)}if(o<a){var _=-Math.pow(1e6*(a-i),1/8),g=Math.pow(1e6*(a-n),1/8);return function(e){var t=e*(g-_)+_;return-Math.pow(t,8)/1e6+a}}return function(e){return I.lerp(i,n,e)}}function zre(e,t){return I.equalsEpsilon(e,I.TWO_PI,I.EPSILON11)&&(e=0),t>e+Math.PI?e+=I.TWO_PI:t<e-Math.PI&&(e-=I.TWO_PI),e}var Ure=new z;function Vre(e,t,i,n,r,a,o){var s=e.camera,c=z.clone(s.position,Ure),l=s.pitch,u=zre(s.heading,n),h=zre(s.roll,a),d=Bre(s,i,c.z,i.z,o);return function(e){var o=e.time/t;s.setView({orientation:{heading:I.lerp(u,n,o),pitch:I.lerp(l,r,o),roll:I.lerp(h,a,o)}}),Rt.lerp(c,i,o,s.position),s.position.z=d(o)}}var Hre=new K,Gre=new K;function qre(e,t,i,n,r,a,o,s,c,l){var h=e.camera,d=e.mapProjection.ellipsoid,f=K.clone(h.positionCartographic,Hre),p=h.pitch,m=zre(h.heading,n),_=zre(h.roll,a),g=d.cartesianToCartographic(i,Gre);f.longitude=I.zeroToTwoPi(f.longitude),g.longitude=I.zeroToTwoPi(g.longitude);var v=!1;if(Object(u.a)(s)){var b=I.zeroToTwoPi(s),y=Math.min(f.longitude,g.longitude),w=Math.max(f.longitude,g.longitude),O=b>=y&&b<=w;if(Object(u.a)(c)){var x=Math.abs(f.longitude-g.longitude),E=I.TWO_PI-x;(O?x:E)<(O?E:x)*c&&!O&&(v=!0)}else O||(v=!0)}v?function(e,t){e.longitude<t.longitude?e.longitude+=I.TWO_PI:t.longitude+=I.TWO_PI}(f,g):function(e,t){var i=e.longitude-t.longitude;i<-I.PI?e.longitude+=I.TWO_PI:i>I.PI&&(t.longitude+=I.TWO_PI)}(f,g);var T,C,S,A,P=Bre(h,i,f.height,g.height,o),D=function(e,t,i,n){if(Object(u.a)(n)&&i(.5)>n){var r=i(0),a=i(1),o=i(.5),s=o-r,c=o-a;return function(n){var o=i(n);if(n<=.5){var l=(o-r)/s;return I.lerp(e,-I.PI_OVER_TWO,l)}var u=(o-a)/c;return I.lerp(-I.PI_OVER_TWO,t,1-u)}}return function(i){return I.lerp(e,t,i)}}(p,r,P,l);return T=f.longitude,C=g.longitude,S=f.latitude,A=g.latitude,function(e){var i=e.time/t,r=z.fromRadians(I.lerp(T,C,i),I.lerp(S,A,i),P(i));h.setView({destination:r,orientation:{heading:I.lerp(m,n,i),pitch:D(i),roll:I.lerp(_,a,i)}})}}function Wre(e,t,i,n,r,a,o){var s=e.camera,c=z.clone(s.position,Ure),l=zre(s.heading,n),u=s.frustum.right-s.frustum.left,h=Bre(s,i,u,i.z,o);return function(e){var r=e.time/t;s.setView({orientation:{heading:I.lerp(l,n,r)}}),Rt.lerp(c,i,r,s.position);var a=h(r),o=s.frustum,u=o.top/o.right,d=.5*(a-(o.right-o.left));o.right+=d,o.left-=d,o.top=u*o.right,o.bottom=-o.top}}var Yre=new K,Xre=new z;function Zre(e,t){return{startObject:{},stopObject:{},duration:0,complete:e,cancel:t}}function Qre(e,t){return function(){"function"==typeof t&&t(),e.enableInputs=!0}}Nre.createTween=function(e,t){var i=(t=Object(w.a)(t,w.a.EMPTY_OBJECT)).destination;if(!Object(u.a)(e))throw new h.a("scene is required.");if(!Object(u.a)(i))throw new h.a("destination is required.");var n=e.mode;if(n===xF.MORPHING)return Zre();var r=Object(w.a)(t.convert,!0),a=e.mapProjection,o=a.ellipsoid,s=t.maximumHeight,c=t.flyOverLongitude,l=t.flyOverLongitudeWeight,d=t.pitchAdjustHeight,f=t.easingFunction;r&&n!==xF.SCENE3D&&(o.cartesianToCartographic(i,Yre),i=a.project(Yre,Xre));var p=e.camera,m=t.endTransform;Object(u.a)(m)&&p._setTransform(m);var _=t.duration;Object(u.a)(_)||(_=Math.ceil(z.distance(p.position,i)/1e6)+2,_=Math.min(_,3));var g=Object(w.a)(t.heading,0),v=Object(w.a)(t.pitch,-I.PI_OVER_TWO),b=Object(w.a)(t.roll,0),y=e.screenSpaceCameraController;y.enableInputs=!1;var O=Qre(y,t.complete),x=Qre(y,t.cancel),E=p.frustum,T=e.mode===xF.SCENE2D;if(T=(T=(T=(T=T&&Rt.equalsEpsilon(p.position,i,I.EPSILON6))&&I.equalsEpsilon(Math.max(E.right-E.left,E.top-E.bottom),i.z,I.EPSILON6))||e.mode!==xF.SCENE2D&&z.equalsEpsilon(i,p.position,I.EPSILON10))&&I.equalsEpsilon(I.negativePiToPi(g),I.negativePiToPi(p.heading),I.EPSILON10)&&I.equalsEpsilon(I.negativePiToPi(v),I.negativePiToPi(p.pitch),I.EPSILON10)&&I.equalsEpsilon(I.negativePiToPi(b),I.negativePiToPi(p.roll),I.EPSILON10))return Zre(O,x);var C=new Array(4);if(C[xF.SCENE2D]=Wre,C[xF.SCENE3D]=qre,C[xF.COLUMBUS_VIEW]=Vre,_<=0){return Zre((function(){C[n](e,1,i,g,v,b,s,c,l,d)({time:1}),"function"==typeof O&&O()}),x)}var S=C[n](e,_,i,g,v,b,s,c,l,d);if(!Object(u.a)(f)){var A=p.positionCartographic.height;f=A>(n===xF.SCENE3D?o.cartesianToCartographic(i).height:i.z)&&A>11500?Pv.CUBIC_OUT:Pv.QUINTIC_IN_OUT}return{duration:_,easingFunction:f,startObject:{time:0},stopObject:{time:_},update:S,complete:O,cancel:x}};var Kre=Nre,Jre=Object(E.a)({ROTATE:0,INFINITE_SCROLL:1});function $re(e){if(!Object(u.a)(e))throw new h.a("scene is required.");this._scene=e,this._transform=Be.clone(Be.IDENTITY),this._invTransform=Be.clone(Be.IDENTITY),this._actualTransform=Be.clone(Be.IDENTITY),this._actualInvTransform=Be.clone(Be.IDENTITY),this._transformChanged=!1,this.position=new z,this._position=new z,this._positionWC=new z,this._positionCartographic=new K,this.direction=new z,this._direction=new z,this._directionWC=new z,this.up=new z,this._up=new z,this._upWC=new z,this.right=new z,this._right=new z,this._rightWC=new z,this.frustum=new wb,this.frustum.aspectRatio=e.drawingBufferWidth/e.drawingBufferHeight,this.frustum.fov=I.toRadians(60),this.workingFrustums=[],this.defaultMoveAmount=1e5,this.defaultLookAmount=Math.PI/60,this.defaultRotateAmount=Math.PI/3600,this.defaultZoomAmount=1e5,this.constrainedAxis=void 0,this.maximumZoomFactor=1.5,this._moveStart=new $o.a,this._moveEnd=new $o.a,this._changed=new $o.a,this._changedPosition=void 0,this._changedDirection=void 0,this._changedFrustum=void 0,this.percentageChanged=.5,this._viewMatrix=new Be,this._invViewMatrix=new Be,eae(this),this._mode=xF.SCENE3D,this._modeChanged=!0;var t=e.mapProjection;this._projection=t,this._maxCoord=t.project(new K(Math.PI,I.PI_OVER_TWO)),this._max2Dfrustum=void 0,this._suspendTerrainAdjustment=!1,goe(this,$re.DEFAULT_VIEW_RECTANGLE,this.position,!0);var i=z.magnitude(this.position);i+=i*$re.DEFAULT_VIEW_FACTOR,z.normalize(this.position,this.position),z.multiplyByScalar(this.position,i,this.position)}function eae(e){Be.computeView(e._position,e._direction,e._up,e._right,e._viewMatrix),Be.multiply(e._viewMatrix,e._actualInvTransform,e._viewMatrix),Be.inverseTransformation(e._viewMatrix,e._invViewMatrix)}$re.TRANSFORM_2D=new Be(0,0,1,0,1,0,0,0,0,1,0,0,0,0,0,1),$re.TRANSFORM_2D_INVERSE=Be.inverseTransformation($re.TRANSFORM_2D,new Be),$re.DEFAULT_VIEW_RECTANGLE=Ve.fromDegrees(-95,-20,-70,90),$re.DEFAULT_VIEW_FACTOR=.5,$re.DEFAULT_OFFSET=new xO(0,-I.PI_OVER_FOUR,0),$re.prototype._updateCameraChanged=function(){if(0!==this._changed.numberOfListeners){var e=this.percentageChanged;if(this._mode!==xF.SCENE2D){if(!Object(u.a)(this._changedDirection))return this._changedPosition=z.clone(this.positionWC,this._changedPosition),void(this._changedDirection=z.clone(this.directionWC,this._changedDirection));var t,i=I.acosClamped(z.dot(this.directionWC,this._changedDirection));t=Object(u.a)(this.frustum.fovy)?i/(.5*this.frustum.fovy):i;var n=z.distance(this.positionWC,this._changedPosition)/this.positionCartographic.height;(t>e||n>e)&&(this._changedPosition=z.clone(this.positionWC,this._changedPosition),this._changedDirection=z.clone(this.directionWC,this._changedDirection))}else{if(!Object(u.a)(this._changedFrustum))return this._changedPosition=z.clone(this.position,this._changedPosition),void(this._changedFrustum=this.frustum.clone());var r,a=this.position,o=this._changedPosition,s=this.frustum,c=this._changedFrustum,l=a.x+s.left,h=a.x+s.right,d=o.x+c.left,f=o.x+c.right,p=a.y+s.bottom,m=a.y+s.top,_=o.y+c.bottom,g=o.y+c.top,v=Math.max(l,d),b=Math.min(h,f),y=Math.max(p,_),w=Math.min(m,g);if(v>=b||y>=m)r=1;else{var O=c;l<d&&h>f&&p<_&&m>g&&(O=s),r=1-(b-v)*(w-y)/((O.right-O.left)*(O.top-O.bottom))}r>e&&(this._changed.raiseEvent(r),this._changedPosition=z.clone(this.position,this._changedPosition),this._changedFrustum=this.frustum.clone(this._changedFrustum))}}};var tae=new Be,iae=new K;$re.prototype._adjustHeightForTerrain=function(){var e=this._scene,t=e.screenSpaceCameraController,i=t.enableCollisionDetection,n=t.minimumCollisionTerrainHeight,r=t.minimumZoomDistance;if(!this._suspendTerrainAdjustment&&i){var a=this._mode,o=e.globe;if(Object(u.a)(o)&&a!==xF.SCENE2D&&a!==xF.MORPHING){var s,c,l=o.ellipsoid,h=e.mapProjection;Be.equals(this.transform,Be.IDENTITY)||(s=Be.clone(this.transform,tae),c=z.magnitude(this.position),this._setTransform(Be.IDENTITY));var d=iae;a===xF.SCENE3D?l.cartesianToCartographic(this.position,d):h.unproject(this.position,d);var f=!1;if(d.height<n){var p=o.getHeight(d);Object(u.a)(p)&&(p+=r,d.height<p&&(d.height=p,a===xF.SCENE3D?l.cartographicToCartesian(d,this.position):h.project(d,this.position),f=!0))}Object(u.a)(s)&&(this._setTransform(s),f&&(z.normalize(this.position,this.position),z.negate(this.position,this.direction),z.multiplyByScalar(this.position,Math.max(c,r),this.position),z.normalize(this.direction,this.direction),z.cross(this.direction,this.up,this.right),z.cross(this.right,this.direction,this.up)))}}};var nae=new K,rae=new z,aae=new z,oae=new Te,sae=new Te,cae=new Te,lae=new Te,uae=new Te;var hae=new z;function dae(e){var t=e._mode,i=!1,n=0;t===xF.SCENE2D&&(i=(n=e.frustum.right-e.frustum.left)!==e._positionCartographic.height);var r=e._position,a=!z.equals(r,e.position)||i;a&&(r=z.clone(e.position,e._position));var o=e._direction,s=!z.equals(o,e.direction);s&&(z.normalize(e.direction,e.direction),o=z.clone(e.direction,e._direction));var c=e._up,l=!z.equals(c,e.up);l&&(z.normalize(e.up,e.up),c=z.clone(e.up,e._up));var u=e._right,h=!z.equals(u,e.right);h&&(z.normalize(e.right,e.right),u=z.clone(e.right,e._right));var d=e._transformChanged||e._modeChanged;e._transformChanged=!1,d&&(Be.inverseTransformation(e._transform,e._invTransform),e._mode===xF.COLUMBUS_VIEW||e._mode===xF.SCENE2D?Be.equals(Be.IDENTITY,e._transform)?Be.clone($re.TRANSFORM_2D,e._actualTransform):e._mode===xF.COLUMBUS_VIEW?function(e){xa.basisTo2D(e._projection,e._transform,e._actualTransform)}(e):function(e){var t=e._projection,i=t.ellipsoid,n=Be.getColumn(e._transform,3,oae),r=i.cartesianToCartographic(n,nae),a=t.project(r,rae),o=sae;o.x=a.z,o.y=a.x,o.z=a.y,o.w=1;var s=Te.clone(Te.UNIT_X,uae),c=Te.add(Be.getColumn(e._transform,0,aae),n,aae);i.cartesianToCartographic(c,r),t.project(r,a);var l=cae;l.x=a.z,l.y=a.x,l.z=a.y,l.w=0,z.subtract(l,o,l),l.x=0;var u=lae;if(z.magnitudeSquared(l)>I.EPSILON10)z.cross(s,l,u);else{var h=Te.add(Be.getColumn(e._transform,1,aae),n,aae);i.cartesianToCartographic(h,r),t.project(r,a),u.x=a.z,u.y=a.x,u.z=a.y,u.w=0,z.subtract(u,o,u),u.x=0,z.magnitudeSquared(u)<I.EPSILON10&&(Te.clone(Te.UNIT_Y,l),Te.clone(Te.UNIT_Z,u))}z.cross(u,s,l),z.normalize(l,l),z.cross(s,l,u),z.normalize(u,u),Be.setColumn(e._actualTransform,0,l,e._actualTransform),Be.setColumn(e._actualTransform,1,u,e._actualTransform),Be.setColumn(e._actualTransform,2,s,e._actualTransform),Be.setColumn(e._actualTransform,3,o,e._actualTransform)}(e):Be.clone(e._transform,e._actualTransform),Be.inverseTransformation(e._actualTransform,e._actualInvTransform),e._modeChanged=!1);var f=e._actualTransform;if(a||d)if(e._positionWC=Be.multiplyByPoint(f,r,e._positionWC),t===xF.SCENE3D||t===xF.MORPHING)e._positionCartographic=e._projection.ellipsoid.cartesianToCartographic(e._positionWC,e._positionCartographic);else{var p=hae;p.x=e._positionWC.y,p.y=e._positionWC.z,p.z=e._positionWC.x,t===xF.SCENE2D&&(p.z=n),e._projection.unproject(p,e._positionCartographic)}if(s||l||h){var m=z.dot(o,z.cross(c,u,hae));if(Math.abs(1-m)>I.EPSILON2){var _=1/z.magnitudeSquared(c),g=z.dot(c,o)*_,v=z.multiplyByScalar(o,g,hae);c=z.normalize(z.subtract(c,v,e._up),e._up),z.clone(c,e.up),u=z.cross(o,c,e._right),z.clone(u,e.right)}}(s||d)&&(e._directionWC=Be.multiplyByPointAsVector(f,o,e._directionWC),z.normalize(e._directionWC,e._directionWC)),(l||d)&&(e._upWC=Be.multiplyByPointAsVector(f,c,e._upWC),z.normalize(e._upWC,e._upWC)),(h||d)&&(e._rightWC=Be.multiplyByPointAsVector(f,u,e._rightWC),z.normalize(e._rightWC,e._rightWC)),(a||s||l||h||d)&&eae(e)}function fae(e,t){var i;return i=I.equalsEpsilon(Math.abs(e.z),1,I.EPSILON3)?Math.atan2(t.y,t.x)-I.PI_OVER_TWO:Math.atan2(e.y,e.x)-I.PI_OVER_TWO,I.TWO_PI-I.zeroToTwoPi(i)}function pae(e){return I.PI_OVER_TWO-I.acosClamped(e.z)}function mae(e,t,i){var n=0;return I.equalsEpsilon(Math.abs(e.z),1,I.EPSILON3)||(n=Math.atan2(-i.z,t.z),n=I.zeroToTwoPi(n+I.TWO_PI)),n}var _ae=new Be,gae=new Be;Object(O.a)($re.prototype,{transform:{get:function(){return this._transform}},inverseTransform:{get:function(){return dae(this),this._invTransform}},viewMatrix:{get:function(){return dae(this),this._viewMatrix}},inverseViewMatrix:{get:function(){return dae(this),this._invViewMatrix}},positionCartographic:{get:function(){return dae(this),this._positionCartographic}},positionWC:{get:function(){return dae(this),this._positionWC}},directionWC:{get:function(){return dae(this),this._directionWC}},upWC:{get:function(){return dae(this),this._upWC}},rightWC:{get:function(){return dae(this),this._rightWC}},heading:{get:function(){if(this._mode!==xF.MORPHING){var e=this._projection.ellipsoid,t=Be.clone(this._transform,_ae),i=xa.eastNorthUpToFixedFrame(this.positionWC,e,gae);this._setTransform(i);var n=fae(this.direction,this.up);return this._setTransform(t),n}}},pitch:{get:function(){if(this._mode!==xF.MORPHING){var e=this._projection.ellipsoid,t=Be.clone(this._transform,_ae),i=xa.eastNorthUpToFixedFrame(this.positionWC,e,gae);this._setTransform(i);var n=pae(this.direction);return this._setTransform(t),n}}},roll:{get:function(){if(this._mode!==xF.MORPHING){var e=this._projection.ellipsoid,t=Be.clone(this._transform,_ae),i=xa.eastNorthUpToFixedFrame(this.positionWC,e,gae);this._setTransform(i);var n=mae(this.direction,this.up,this.right);return this._setTransform(t),n}}},moveStart:{get:function(){return this._moveStart}},moveEnd:{get:function(){return this._moveEnd}},changed:{get:function(){return this._changed}}}),$re.prototype.update=function(e){if(!Object(u.a)(e))throw new h.a("mode is required.");if(e===xF.SCENE2D&&!(this.frustum instanceof cb))throw new h.a("An OrthographicOffCenterFrustum is required in 2D.");if(!(e!==xF.SCENE3D&&e!==xF.COLUMBUS_VIEW||this.frustum instanceof wb||this.frustum instanceof hb))throw new h.a("A PerspectiveFrustum or OrthographicFrustum is required in 3D and Columbus view");var t=!1;if(e!==this._mode&&(this._mode=e,this._modeChanged=e!==xF.MORPHING,t=this._mode===xF.SCENE2D),t){var i=this._max2Dfrustum=this.frustum.clone();if(!(i instanceof cb))throw new h.a("The camera frustum is expected to be orthographic for 2D camera control.");var n=i.top/i.right;i.right=2*this._maxCoord.x,i.left=-i.right,i.top=n*i.right,i.bottom=-i.top}this._mode===xF.SCENE2D&&kae(this,this.position);var r=this._scene.globe,a=!Object(u.a)(r)||r._surface.tileProvider.ready&&0===r._surface._tileLoadQueueHigh.length&&0===r._surface._tileLoadQueueMedium.length&&0===r._surface._tileLoadQueueLow.length&&0===r._surface._debug.tilesWaitingForChildren;this._suspendTerrainAdjustment&&(this._suspendTerrainAdjustment=!a),a&&this._adjustHeightForTerrain()};var vae=new z,bae=new z,yae=new z;$re.prototype._setTransform=function(e){var t=z.clone(this.positionWC,vae),i=z.clone(this.upWC,bae),n=z.clone(this.directionWC,yae);Be.clone(e,this._transform),this._transformChanged=!0,dae(this);var r=this._actualInvTransform;Be.multiplyByPoint(r,t,this.position),Be.multiplyByPointAsVector(r,n,this.direction),Be.multiplyByPointAsVector(r,i,this.up),z.cross(this.direction,this.up,this.right),dae(this)};var wae=new Rt,Oae=new Ts,xae=new z,Eae=new z;$re.prototype._adjustOrthographicFrustum=function(e){if(this.frustum instanceof hb&&(e||!(this._positionCartographic.height<15e4)))if(Be.equals(Be.IDENTITY,this.transform)){var t,i,n=this._scene,r=n.globe;if(Object(u.a)(r)){var a=wae;a.x=n.drawingBufferWidth/2,a.y=n.drawingBufferHeight/2;var o=this.getPickRay(a,Oae);if(t=r.pickWorldCoordinates(o,n,xae),n.pickPositionSupported&&(i=n.pickPositionWorldCoordinates(a,Eae)),Object(u.a)(t)&&Object(u.a)(i)){var s=Object(u.a)(i)?z.distance(i,this.positionWC):Number.POSITIVE_INFINITY,c=Object(u.a)(t)?z.distance(t,this.positionWC):Number.POSITIVE_INFINITY;this.frustum.width=Math.min(s,c)}else Object(u.a)(i)?this.frustum.width=z.distance(i,this.positionWC):Object(u.a)(t)&&(this.frustum.width=z.distance(t,this.positionWC))}if(!Object(u.a)(r)||!Object(u.a)(t)&&!Object(u.a)(i)){var l=Math.max(this.positionCartographic.height,0);this.frustum.width=l}}else this.frustum.width=z.magnitude(this.position)};var Tae=new z,Cae=new Be,Sae=new Be,Aae=new Kn,Pae=new be,Iae=new K;var Dae=new z,jae=new z,Mae=new z;function Rae(e,t,i,n){var r=z.clone(i.direction,Dae),a=z.clone(i.up,jae);if(e._scene.mode===xF.SCENE3D){var o=e._projection.ellipsoid,s=xa.eastNorthUpToFixedFrame(t,o,_ae),c=Be.inverseTransformation(s,gae);Be.multiplyByPointAsVector(c,r,r),Be.multiplyByPointAsVector(c,a,a)}var l=z.cross(r,a,Mae);return n.heading=fae(r,a),n.pitch=pae(r),n.roll=mae(r,a,l),n}var Lae={destination:void 0,orientation:{direction:void 0,up:void 0,heading:void 0,pitch:void 0,roll:void 0},convert:void 0,endTransform:void 0},Nae=new Rr;$re.prototype.setView=function(e){e=Object(w.a)(e,w.a.EMPTY_OBJECT);var t=Object(w.a)(e.orientation,w.a.EMPTY_OBJECT),i=this._mode;if(i!==xF.MORPHING){Object(u.a)(e.endTransform)&&this._setTransform(e.endTransform);var n=Object(w.a)(e.convert,!0),r=Object(w.a)(e.destination,z.clone(this.positionWC,Tae));Object(u.a)(r)&&Object(u.a)(r.west)&&(r=this.getRectangleCameraCoordinates(r,Tae),n=!1),Object(u.a)(t.direction)&&(t=Rae(this,r,t,Lae.orientation)),Nae.heading=Object(w.a)(t.heading,0),Nae.pitch=Object(w.a)(t.pitch,-I.PI_OVER_TWO),Nae.roll=Object(w.a)(t.roll,0),this._suspendTerrainAdjustment=!0,i===xF.SCENE3D?function(e,t,i){var n=Be.clone(e.transform,Cae),r=xa.eastNorthUpToFixedFrame(t,e._projection.ellipsoid,Sae);e._setTransform(r),z.clone(z.ZERO,e.position),i.heading=i.heading-I.PI_OVER_TWO;var a=Kn.fromHeadingPitchRoll(i,Aae),o=be.fromQuaternion(a,Pae);be.getColumn(o,0,e.direction),be.getColumn(o,2,e.up),z.cross(e.direction,e.up,e.right),e._setTransform(n),e._adjustOrthographicFrustum(!0)}(this,r,Nae):i===xF.SCENE2D?function(e,t,i,n){var r=Be.clone(e.transform,Cae);if(e._setTransform(Be.IDENTITY),!z.equals(t,e.positionWC)){if(n){var a=e._projection,o=a.ellipsoid.cartesianToCartographic(t,Iae);t=a.project(o,Tae)}Rt.clone(t,e.position);var s=.5*-t.z,c=-s,l=e.frustum;if(c>s){var u=l.top/l.right;l.right=c,l.left=s,l.top=l.right*u,l.bottom=-l.top}}if(e._scene.mapMode2D===Jre.ROTATE){i.heading=i.heading-I.PI_OVER_TWO,i.pitch=-I.PI_OVER_TWO,i.roll=0;var h=Kn.fromHeadingPitchRoll(i,Aae),d=be.fromQuaternion(h,Pae);be.getColumn(d,2,e.up),z.cross(e.direction,e.up,e.right)}e._setTransform(r)}(this,r,Nae,n):function(e,t,i,n){var r=Be.clone(e.transform,Cae);if(e._setTransform(Be.IDENTITY),!z.equals(t,e.positionWC)){if(n){var a=e._projection,o=a.ellipsoid.cartesianToCartographic(t,Iae);t=a.project(o,Tae)}z.clone(t,e.position)}i.heading=i.heading-I.PI_OVER_TWO;var s=Kn.fromHeadingPitchRoll(i,Aae),c=be.fromQuaternion(s,Pae);be.getColumn(c,0,e.direction),be.getColumn(c,2,e.up),z.cross(e.direction,e.up,e.right),e._setTransform(r),e._adjustOrthographicFrustum(!0)}(this,r,Nae,n)}};var Fae=new z;function kae(e,t){var i,n,r=e._scene.mapMode2D===Jre.ROTATE,a=e._maxCoord.x,o=e._maxCoord.y;r?i=-(n=a):(n=t.x-2*a,i=t.x+2*a),t.x>a&&(t.x=n),t.x<-a&&(t.x=i),t.y>o&&(t.y=o),t.y<-o&&(t.y=-o)}$re.prototype.flyHome=function(e){var t=this._mode;if(t===xF.MORPHING&&this._scene.completeMorph(),t===xF.SCENE2D)this.flyTo({destination:$re.DEFAULT_VIEW_RECTANGLE,duration:e,endTransform:Be.IDENTITY});else if(t===xF.SCENE3D){var i=this.getRectangleCameraCoordinates($re.DEFAULT_VIEW_RECTANGLE),n=z.magnitude(i);n+=n*$re.DEFAULT_VIEW_FACTOR,z.normalize(i,i),z.multiplyByScalar(i,n,i),this.flyTo({destination:i,duration:e,endTransform:Be.IDENTITY})}else if(t===xF.COLUMBUS_VIEW){var r=this._projection.ellipsoid.maximumRadius,a=new z(0,-1,1);a=z.multiplyByScalar(z.normalize(a,a),5*r,a),this.flyTo({destination:a,duration:e,orientation:{heading:0,pitch:-Math.acos(z.normalize(a,Fae).z),roll:0},endTransform:Be.IDENTITY,convert:!1})}},$re.prototype.worldToCameraCoordinates=function(e,t){if(!Object(u.a)(e))throw new h.a("cartesian is required.");return Object(u.a)(t)||(t=new Te),dae(this),Be.multiplyByVector(this._actualInvTransform,e,t)},$re.prototype.worldToCameraCoordinatesPoint=function(e,t){if(!Object(u.a)(e))throw new h.a("cartesian is required.");return Object(u.a)(t)||(t=new z),dae(this),Be.multiplyByPoint(this._actualInvTransform,e,t)},$re.prototype.worldToCameraCoordinatesVector=function(e,t){if(!Object(u.a)(e))throw new h.a("cartesian is required.");return Object(u.a)(t)||(t=new z),dae(this),Be.multiplyByPointAsVector(this._actualInvTransform,e,t)},$re.prototype.cameraToWorldCoordinates=function(e,t){if(!Object(u.a)(e))throw new h.a("cartesian is required.");return Object(u.a)(t)||(t=new Te),dae(this),Be.multiplyByVector(this._actualTransform,e,t)},$re.prototype.cameraToWorldCoordinatesPoint=function(e,t){if(!Object(u.a)(e))throw new h.a("cartesian is required.");return Object(u.a)(t)||(t=new z),dae(this),Be.multiplyByPoint(this._actualTransform,e,t)},$re.prototype.cameraToWorldCoordinatesVector=function(e,t){if(!Object(u.a)(e))throw new h.a("cartesian is required.");return Object(u.a)(t)||(t=new z),dae(this),Be.multiplyByPointAsVector(this._actualTransform,e,t)};var Bae=new z;$re.prototype.move=function(e,t){if(!Object(u.a)(e))throw new h.a("direction is required.");var i=this.position;z.multiplyByScalar(e,t,Bae),z.add(i,Bae,i),this._mode===xF.SCENE2D&&kae(this,i),this._adjustOrthographicFrustum(!0)},$re.prototype.moveForward=function(e){e=Object(w.a)(e,this.defaultMoveAmount),this._mode===xF.SCENE2D?Qae(this,e):this.move(this.direction,e)},$re.prototype.moveBackward=function(e){e=Object(w.a)(e,this.defaultMoveAmount),this._mode===xF.SCENE2D?Qae(this,-e):this.move(this.direction,-e)},$re.prototype.moveUp=function(e){e=Object(w.a)(e,this.defaultMoveAmount),this.move(this.up,e)},$re.prototype.moveDown=function(e){e=Object(w.a)(e,this.defaultMoveAmount),this.move(this.up,-e)},$re.prototype.moveRight=function(e){e=Object(w.a)(e,this.defaultMoveAmount),this.move(this.right,e)},$re.prototype.moveLeft=function(e){e=Object(w.a)(e,this.defaultMoveAmount),this.move(this.right,-e)},$re.prototype.lookLeft=function(e){e=Object(w.a)(e,this.defaultLookAmount),this._mode!==xF.SCENE2D&&this.look(this.up,-e)},$re.prototype.lookRight=function(e){e=Object(w.a)(e,this.defaultLookAmount),this._mode!==xF.SCENE2D&&this.look(this.up,e)},$re.prototype.lookUp=function(e){e=Object(w.a)(e,this.defaultLookAmount),this._mode!==xF.SCENE2D&&this.look(this.right,-e)},$re.prototype.lookDown=function(e){e=Object(w.a)(e,this.defaultLookAmount),this._mode!==xF.SCENE2D&&this.look(this.right,e)};var zae=new Kn,Uae=new be;$re.prototype.look=function(e,t){if(!Object(u.a)(e))throw new h.a("axis is required.");var i=Object(w.a)(t,this.defaultLookAmount),n=Kn.fromAxisAngle(e,-i,zae),r=be.fromQuaternion(n,Uae),a=this.direction,o=this.up,s=this.right;be.multiplyByVector(r,a,a),be.multiplyByVector(r,o,o),be.multiplyByVector(r,s,s)},$re.prototype.twistLeft=function(e){e=Object(w.a)(e,this.defaultLookAmount),this.look(this.direction,e)},$re.prototype.twistRight=function(e){e=Object(w.a)(e,this.defaultLookAmount),this.look(this.direction,-e)};var Vae=new Kn,Hae=new be;$re.prototype.rotate=function(e,t){if(!Object(u.a)(e))throw new h.a("axis is required.");var i=Object(w.a)(t,this.defaultRotateAmount),n=Kn.fromAxisAngle(e,-i,Vae),r=be.fromQuaternion(n,Hae);be.multiplyByVector(r,this.position,this.position),be.multiplyByVector(r,this.direction,this.direction),be.multiplyByVector(r,this.up,this.up),z.cross(this.direction,this.up,this.right),z.cross(this.right,this.direction,this.up),this._adjustOrthographicFrustum(!1)},$re.prototype.rotateDown=function(e){Xae(this,e=Object(w.a)(e,this.defaultRotateAmount))},$re.prototype.rotateUp=function(e){Xae(this,-(e=Object(w.a)(e,this.defaultRotateAmount)))};var Gae=new z,qae=new z,Wae=new z,Yae=new z;function Xae(e,t){var i=e.position;if(Object(u.a)(e.constrainedAxis)&&!z.equalsEpsilon(e.position,z.ZERO,I.EPSILON2)){var n=z.normalize(i,Gae),r=z.equalsEpsilon(n,e.constrainedAxis,I.EPSILON2),a=z.equalsEpsilon(n,z.negate(e.constrainedAxis,Yae),I.EPSILON2);if(r||a)(r&&t<0||a&&t>0)&&e.rotate(e.right,t);else{var o=z.normalize(e.constrainedAxis,qae),s=z.dot(n,o),c=I.acosClamped(s);t>0&&t>c&&(t=c-I.EPSILON4),s=z.dot(n,z.negate(o,Yae)),c=I.acosClamped(s),t<0&&-t>c&&(t=-c+I.EPSILON4);var l=z.cross(o,n,Wae);e.rotate(l,t)}}else e.rotate(e.right,t)}function Zae(e,t){Object(u.a)(e.constrainedAxis)?e.rotate(e.constrainedAxis,t):e.rotate(e.up,t)}function Qae(e,t){var i,n=e.frustum;if(!(n instanceof cb&&Object(u.a)(n.left)&&Object(u.a)(n.right)&&Object(u.a)(n.bottom)&&Object(u.a)(n.top)))throw new h.a("The camera frustum is expected to be orthographic for 2D camera control.");if(t*=.5,Math.abs(n.top)+Math.abs(n.bottom)>Math.abs(n.left)+Math.abs(n.right)){var r=n.top-t,a=n.bottom+t,o=e._maxCoord.y;e._scene.mapMode2D===Jre.ROTATE&&(o*=e.maximumZoomFactor),a>o&&(a=o,r=-o),r<=a&&(r=1,a=-1),i=n.right/n.top,n.top=r,n.bottom=a,n.right=n.top*i,n.left=-n.right}else{var s=n.right-t,c=n.left+t,l=e._maxCoord.x;e._scene.mapMode2D===Jre.ROTATE&&(l*=e.maximumZoomFactor),s>l&&(s=l,c=-l),s<=c&&(s=1,c=-1),i=n.top/n.right,n.right=s,n.left=c,n.top=n.right*i,n.bottom=-n.top}}function Kae(e,t){e.move(e.direction,t)}$re.prototype.rotateRight=function(e){Zae(this,-(e=Object(w.a)(e,this.defaultRotateAmount)))},$re.prototype.rotateLeft=function(e){Zae(this,e=Object(w.a)(e,this.defaultRotateAmount))},$re.prototype.zoomIn=function(e){e=Object(w.a)(e,this.defaultZoomAmount),this._mode===xF.SCENE2D?Qae(this,e):Kae(this,e)},$re.prototype.zoomOut=function(e){e=Object(w.a)(e,this.defaultZoomAmount),this._mode===xF.SCENE2D?Qae(this,-e):Kae(this,-e)},$re.prototype.getMagnitude=function(){return this._mode===xF.SCENE3D?z.magnitude(this.position):this._mode===xF.COLUMBUS_VIEW?Math.abs(this.position.z):this._mode===xF.SCENE2D?Math.max(this.frustum.right-this.frustum.left,this.frustum.top-this.frustum.bottom):void 0};var Jae=new Be;$re.prototype.lookAt=function(e,t){if(!Object(u.a)(e))throw new h.a("target is required");if(!Object(u.a)(t))throw new h.a("offset is required");if(this._mode===xF.MORPHING)throw new h.a("lookAt is not supported while morphing.");var i=xa.eastNorthUpToFixedFrame(e,ae.WGS84,Jae);this.lookAtTransform(i,t)};var $ae=new z,eoe=new Kn,toe=new Kn,ioe=new be;function noe(e,t,i){t=I.clamp(t,-I.PI_OVER_TWO,I.PI_OVER_TWO),e=I.zeroToTwoPi(e)-I.PI_OVER_TWO;var n=Kn.fromAxisAngle(z.UNIT_Y,-t,eoe),r=Kn.fromAxisAngle(z.UNIT_Z,-e,toe),a=Kn.multiply(r,n,r),o=be.fromQuaternion(a,ioe),s=z.clone(z.UNIT_X,$ae);return be.multiplyByVector(o,s,s),z.negate(s,s),z.multiplyByScalar(s,i,s),s}$re.prototype.lookAtTransform=function(e,t){if(!Object(u.a)(e))throw new h.a("transform is required");if(this._mode===xF.MORPHING)throw new h.a("lookAtTransform is not supported while morphing.");if(this._setTransform(e),Object(u.a)(t)){var i;if(i=Object(u.a)(t.heading)?noe(t.heading,t.pitch,t.range):t,this._mode===xF.SCENE2D){Rt.clone(Rt.ZERO,this.position),z.negate(i,this.up),this.up.z=0,z.magnitudeSquared(this.up)<I.EPSILON10&&z.clone(z.UNIT_Y,this.up),z.normalize(this.up,this.up),this._setTransform(Be.IDENTITY),z.negate(z.UNIT_Z,this.direction),z.cross(this.direction,this.up,this.right),z.normalize(this.right,this.right);var n=this.frustum,r=n.top/n.right;return n.right=.5*z.magnitude(i),n.left=-n.right,n.top=r*n.right,n.bottom=-n.top,void this._setTransform(e)}z.clone(i,this.position),z.negate(this.position,this.direction),z.normalize(this.direction,this.direction),z.cross(this.direction,z.UNIT_Z,this.right),z.magnitudeSquared(this.right)<I.EPSILON10&&z.clone(z.UNIT_X,this.right),z.normalize(this.right,this.right),z.cross(this.right,this.direction,this.up),z.normalize(this.up,this.up),this._adjustOrthographicFrustum(!0)}};var roe,aoe=new K,ooe=new K,soe=new z,coe=new z,loe=new z,uoe=new z,hoe=new z,doe=new z,foe=new z,poe=new z,moe={direction:new z,right:new z,up:new z};function _oe(e,t,i,n){return Math.abs(z.dot(t,i))/n-z.dot(e,i)}function goe(e,t,i,n){var r=e._projection.ellipsoid,a=n?e:moe,o=t.north,s=t.south,c=t.east,l=t.west;l>c&&(c+=I.TWO_PI);var h,d=.5*(l+c);if(s<-I.PI_OVER_TWO+I.RADIANS_PER_DEGREE&&o>I.PI_OVER_TWO-I.RADIANS_PER_DEGREE)h=0;else{var f=aoe;f.longitude=d,f.latitude=o,f.height=0;var p=ooe;p.longitude=d,p.latitude=s,p.height=0;var m=roe;Object(u.a)(m)&&m.ellipsoid===r||(roe=m=new bm(void 0,void 0,r)),m.setEndPoints(f,p),h=m.interpolateUsingFraction(.5,aoe).latitude}var _=aoe;_.longitude=d,_.latitude=h,_.height=0;var g=r.cartographicToCartesian(_,foe),v=aoe;v.longitude=c,v.latitude=o;var b=r.cartographicToCartesian(v,soe);v.longitude=l;var y=r.cartographicToCartesian(v,loe);v.longitude=d;var w=r.cartographicToCartesian(v,hoe);v.latitude=s;var O=r.cartographicToCartesian(v,doe);v.longitude=c;var x=r.cartographicToCartesian(v,uoe);v.longitude=l;var E=r.cartographicToCartesian(v,coe);z.subtract(y,g,y),z.subtract(x,g,x),z.subtract(b,g,b),z.subtract(E,g,E),z.subtract(w,g,w),z.subtract(O,g,O);var T=r.geodeticSurfaceNormal(g,a.direction);z.negate(T,T);var C=z.cross(T,z.UNIT_Z,a.right);z.normalize(C,C);var S,A=z.cross(C,T,a.up);if(e.frustum instanceof hb){var P,D,j=Math.max(z.distance(b,y),z.distance(x,E)),M=Math.max(z.distance(b,x),z.distance(y,E)),R=e.frustum._offCenterFrustum.right/e.frustum._offCenterFrustum.top,L=M*R;j>L?D=(P=j)/R:(D=M,P=L),S=Math.max(P,D)}else{var N=Math.tan(.5*e.frustum.fovy),F=e.frustum.aspectRatio*N;if(S=Math.max(_oe(T,A,y,N),_oe(T,A,x,N),_oe(T,A,b,N),_oe(T,A,E,N),_oe(T,A,w,N),_oe(T,A,O,N),_oe(T,C,y,F),_oe(T,C,x,F),_oe(T,C,b,F),_oe(T,C,E,F),_oe(T,C,w,F),_oe(T,C,O,F)),s<0&&o>0){var k=aoe;k.longitude=l,k.latitude=0,k.height=0;var B=r.cartographicToCartesian(k,poe);z.subtract(B,g,B),S=Math.max(S,_oe(T,A,B,N),_oe(T,C,B,F)),k.longitude=c,B=r.cartographicToCartesian(k,poe),z.subtract(B,g,B),S=Math.max(S,_oe(T,A,B,N),_oe(T,C,B,F))}}return z.add(g,z.multiplyByScalar(T,-S,poe),i)}var voe=new K,boe=new z,yoe=new z;var woe=new K,Ooe=new z,xoe=new z;$re.prototype.getRectangleCameraCoordinates=function(e,t){if(!Object(u.a)(e))throw new h.a("rectangle is required");var i=this._mode;return Object(u.a)(t)||(t=new z),i===xF.SCENE3D?goe(this,e,t):i===xF.COLUMBUS_VIEW?function(e,t,i){var n=e._projection;t.west>t.east&&(t=Ve.MAX_VALUE);var r=e._actualTransform,a=e._actualInvTransform,o=voe;o.longitude=t.east,o.latitude=t.north;var s=n.project(o,boe);Be.multiplyByPoint(r,s,s),Be.multiplyByPoint(a,s,s),o.longitude=t.west,o.latitude=t.south;var c=n.project(o,yoe);if(Be.multiplyByPoint(r,c,c),Be.multiplyByPoint(a,c,c),i.x=.5*(s.x-c.x)+c.x,i.y=.5*(s.y-c.y)+c.y,Object(u.a)(e.frustum.fovy)){var l=Math.tan(.5*e.frustum.fovy),h=e.frustum.aspectRatio*l;i.z=.5*Math.max((s.x-c.x)/h,(s.y-c.y)/l)}else{var d=s.x-c.x,f=s.y-c.y;i.z=Math.max(d,f)}return i}(this,e,t):i===xF.SCENE2D?function(e,t,i){var n=e._projection;t.west>t.east&&(t=Ve.MAX_VALUE);var r=woe;r.longitude=t.east,r.latitude=t.north;var a=n.project(r,Ooe);r.longitude=t.west,r.latitude=t.south;var o,s,c=n.project(r,xoe),l=.5*Math.abs(a.x-c.x),u=.5*Math.abs(a.y-c.y),h=e.frustum.right/e.frustum.top,d=u*h;return l>d?s=(o=l)/h:(s=u,o=d),u=Math.max(2*o,2*s),i.x=.5*(a.x-c.x)+c.x,i.y=.5*(a.y-c.y)+c.y,(r=n.unproject(i,r)).height=u,i=n.project(r,i)}(this,e,t):void 0};var Eoe=new Ts;var Toe=new Ts;var Coe=new Ts;$re.prototype.pickEllipsoid=function(e,t,i){if(!Object(u.a)(e))throw new h.a("windowPosition is required.");var n=this._scene.canvas;if(0!==n.clientWidth&&0!==n.clientHeight){if(Object(u.a)(i)||(i=new z),t=Object(w.a)(t,ae.WGS84),this._mode===xF.SCENE3D)i=function(e,t,i,n){i=Object(w.a)(i,ae.WGS84);var r=e.getPickRay(t,Eoe),a=tc.rayEllipsoid(r,i);if(a){var o=a.start>0?a.start:a.stop;return Ts.getPoint(r,o,n)}}(this,e,t,i);else if(this._mode===xF.SCENE2D)i=function(e,t,i,n){var r=e.getPickRay(t,Toe).origin;r=z.fromElements(r.y,r.z,0,r);var a=i.unproject(r);if(!(a.latitude<-I.PI_OVER_TWO||a.latitude>I.PI_OVER_TWO))return i.ellipsoid.cartographicToCartesian(a,n)}(this,e,this._projection,i);else{if(this._mode!==xF.COLUMBUS_VIEW)return;i=function(e,t,i,n){var r=e.getPickRay(t,Coe),a=-r.origin.x/r.direction.x;Ts.getPoint(r,a,n);var o=i.unproject(new z(n.y,n.z,0));if(!(o.latitude<-I.PI_OVER_TWO||o.latitude>I.PI_OVER_TWO||o.longitude<-Math.PI||o.longitude>Math.PI))return i.ellipsoid.cartographicToCartesian(o,n)}(this,e,this._projection,i)}return i}};var Soe=new z,Aoe=new z,Poe=new z;var Ioe=new z;$re.prototype.getPickRay=function(e,t){if(!Object(u.a)(e))throw new h.a("windowPosition is required.");Object(u.a)(t)||(t=new Ts);var i=this.frustum;return Object(u.a)(i.aspectRatio)&&Object(u.a)(i.fov)&&Object(u.a)(i.near)?function(e,t,i){var n=e._scene.canvas,r=n.clientWidth,a=n.clientHeight,o=Math.tan(.5*e.frustum.fovy),s=e.frustum.aspectRatio*o,c=e.frustum.near,l=2/r*t.x-1,u=2/a*(a-t.y)-1,h=e.positionWC;z.clone(h,i.origin);var d=z.multiplyByScalar(e.directionWC,c,Soe);z.add(h,d,d);var f=z.multiplyByScalar(e.rightWC,l*c*s,Aoe),p=z.multiplyByScalar(e.upWC,u*c*o,Poe),m=z.add(d,f,i.direction);return z.add(m,p,m),z.subtract(m,h,m),z.normalize(m,m),i}(this,e,t):function(e,t,i){var n=e._scene.canvas,r=n.clientWidth,a=n.clientHeight,o=e.frustum;Object(u.a)(o._offCenterFrustum)&&(o=o._offCenterFrustum);var s=2/r*t.x-1;s*=.5*(o.right-o.left);var c=2/a*(a-t.y)-1;c*=.5*(o.top-o.bottom);var l=i.origin;return z.clone(e.position,l),z.multiplyByScalar(e.right,s,Ioe),z.add(Ioe,l,l),z.multiplyByScalar(e.up,c,Ioe),z.add(Ioe,l,l),z.clone(e.directionWC,i.direction),e._mode!==xF.COLUMBUS_VIEW&&e._mode!==xF.SCENE2D||z.fromElements(i.origin.z,i.origin.x,i.origin.y,i.origin),i}(this,e,t)};var Doe=new z,joe=new z;$re.prototype.distanceToBoundingSphere=function(e){if(!Object(u.a)(e))throw new h.a("boundingSphere is required.");var t=z.subtract(this.positionWC,e.center,Doe),i=z.multiplyByScalar(this.directionWC,z.dot(t,this.directionWC),joe);return Math.max(0,z.magnitude(i)-e.radius)};var Moe=new Rt;$re.prototype.getPixelSize=function(e,t,i){if(!Object(u.a)(e))throw new h.a("boundingSphere is required.");if(!Object(u.a)(t))throw new h.a("drawingBufferWidth is required.");if(!Object(u.a)(i))throw new h.a("drawingBufferHeight is required.");var n=this.distanceToBoundingSphere(e),r=this.frustum.getPixelDimensions(t,i,n,Moe);return Math.max(r.x,r.y)};var Roe=new z,Loe=new z,Noe=new z,Foe=new z;function koe(e,t){var i=e.position,n=e.direction,r=e.worldToCameraCoordinatesVector(z.UNIT_X,Roe),a=-z.dot(r,i)/z.dot(r,n),o=z.add(i,z.multiplyByScalar(n,a,Loe),Loe);e.cameraToWorldCoordinatesPoint(o,o),i=e.cameraToWorldCoordinatesPoint(e.position,Noe);var s=Math.tan(.5*e.frustum.fovy),c=e.frustum.aspectRatio*s,l=z.magnitude(z.subtract(i,o,Foe)),u=c*l,h=s*l,d=e._maxCoord.x,f=e._maxCoord.y,p=Math.max(u-d,d),m=Math.max(h-f,f);if(i.z<-p||i.z>p||i.y<-m||i.y>m){var _=o.y<-p||o.y>p,g=o.z<-m||o.z>m;if(_||g)return function(e,t,i,n,r,a){var o=z.clone(t);return i.y>n?o.y-=i.y-n:i.y<-n&&(o.y+=-n-i.y),i.z>r?o.z-=i.z-r:i.z<-r&&(o.z+=-r-i.z),{easingFunction:Pv.EXPONENTIAL_OUT,startObject:{time:0},stopObject:{time:1},duration:a,update:function(i){var n=z.lerp(t,o,i.time,new z);e.worldToCameraCoordinatesPoint(n,e.position)}}}(e,i,o,p,m,t)}}$re.prototype.createCorrectPositionTween=function(e){if(!Object(u.a)(e))throw new h.a("duration is required.");if(this._mode===xF.COLUMBUS_VIEW)return koe(this,e)};var Boe=new z,zoe={destination:void 0,heading:void 0,pitch:void 0,roll:void 0,duration:void 0,complete:void 0,cancel:void 0,endTransform:void 0,maximumHeight:void 0,easingFunction:void 0};$re.prototype.cancelFlight=function(){Object(u.a)(this._currentFlight)&&(this._currentFlight.cancelTween(),this._currentFlight=void 0)},$re.prototype.flyTo=function(e){var t=(e=Object(w.a)(e,w.a.EMPTY_OBJECT)).destination;if(!Object(u.a)(t))throw new h.a("destination is required.");if(this._mode!==xF.MORPHING){this.cancelFlight();var i=Object(w.a)(e.orientation,w.a.EMPTY_OBJECT);if(Object(u.a)(i.direction)&&(i=Rae(this,t,i,Lae.orientation)),Object(u.a)(e.duration)&&e.duration<=0){var n=Lae;return n.destination=e.destination,n.orientation.heading=i.heading,n.orientation.pitch=i.pitch,n.orientation.roll=i.roll,n.convert=e.convert,n.endTransform=e.endTransform,this.setView(n),void("function"==typeof e.complete&&e.complete())}var r=Object(u.a)(t.west);r&&(t=this.getRectangleCameraCoordinates(t,Boe));var a,o=this;zoe.destination=t,zoe.heading=i.heading,zoe.pitch=i.pitch,zoe.roll=i.roll,zoe.duration=e.duration,zoe.complete=function(){a===o._currentFlight&&(o._currentFlight=void 0),Object(u.a)(e.complete)&&e.complete()},zoe.cancel=e.cancel,zoe.endTransform=e.endTransform,zoe.convert=!r&&e.convert,zoe.maximumHeight=e.maximumHeight,zoe.pitchAdjustHeight=e.pitchAdjustHeight,zoe.flyOverLongitude=e.flyOverLongitude,zoe.flyOverLongitudeWeight=e.flyOverLongitudeWeight,zoe.easingFunction=e.easingFunction;var s=this._scene;a=s.tweens.add(Kre.createTween(s,zoe)),this._currentFlight=a}};var Uoe=100;function Voe(e,t,i){Object(u.a)(i)||(i=xO.clone($re.DEFAULT_OFFSET));var n=e._scene.screenSpaceCameraController.minimumZoomDistance,r=e._scene.screenSpaceCameraController.maximumZoomDistance,a=i.range;if(!Object(u.a)(a)||0===a){var o=t.radius;0===o?i.range=Uoe:e.frustum instanceof hb||e._mode===xF.SCENE2D?i.range=function(e,t){var i,n,r=e.frustum;Object(u.a)(r._offCenterFrustum)&&(r=r._offCenterFrustum);var a=r.right/r.top,o=t*a;return t>o?n=(i=t)/a:(n=t,i=o),1.5*Math.max(i,n)}(e,o):i.range=function(e,t){var i=e.frustum,n=Math.tan(.5*i.fovy),r=i.aspectRatio*n;return Math.max(t/r,t/n)}(e,o),i.range=I.clamp(i.range,n,r)}return i}$re.prototype.viewBoundingSphere=function(e,t){if(!Object(u.a)(e))throw new h.a("boundingSphere is required.");if(this._mode===xF.MORPHING)throw new h.a("viewBoundingSphere is not supported while morphing.");t=Voe(this,e,t),this.lookAt(e.center,t)};var Hoe=new Be,Goe=new z,qoe=new z,Woe=new z,Yoe=new z,Xoe=new Te,Zoe=new Kn,Qoe=new be;$re.prototype.flyToBoundingSphere=function(e,t){if(!Object(u.a)(e))throw new h.a("boundingSphere is required.");t=Object(w.a)(t,w.a.EMPTY_OBJECT);var i=this._mode===xF.SCENE2D||this._mode===xF.COLUMBUS_VIEW;this._setTransform(Be.IDENTITY);var n,r=Voe(this,e,t.offset);n=i?z.multiplyByScalar(z.UNIT_Z,r.range,Goe):noe(r.heading,r.pitch,r.range);var a,o,s=xa.eastNorthUpToFixedFrame(e.center,ae.WGS84,Hoe);if(Be.multiplyByPoint(s,n,n),!i){if(a=z.subtract(e.center,n,qoe),z.normalize(a,a),o=Be.multiplyByPointAsVector(s,z.UNIT_Z,Woe),1-Math.abs(z.dot(a,o))<I.EPSILON6){var c=Kn.fromAxisAngle(a,r.heading,Zoe),l=be.fromQuaternion(c,Qoe);z.fromCartesian4(Be.getColumn(s,1,Xoe),o),be.multiplyByVector(l,o,o)}var d=z.cross(a,o,Yoe);z.cross(d,a,o),z.normalize(o,o)}this.flyTo({destination:n,orientation:{direction:a,up:o},duration:t.duration,complete:t.complete,cancel:t.cancel,endTransform:t.endTransform,maximumHeight:t.maximumHeight,easingFunction:t.easingFunction,flyOverLongitude:t.flyOverLongitude,flyOverLongitudeWeight:t.flyOverLongitudeWeight,pitchAdjustHeight:t.pitchAdjustHeight})};var Koe=new z,Joe=new z,$oe=new z,ese=new z,tse=[new z,new z,new z,new z];var ise=new Rt,nse=new z,rse=[new K,new K,new K,new K];function ase(e,t,i,n,r,a){ise.x=e,ise.y=t;var o=n.pickEllipsoid(ise,r,nse);return Object(u.a)(o)?(rse[i]=r.cartesianToCartographic(o,rse[i]),1):(rse[i]=r.cartesianToCartographic(a[i],rse[i]),0)}$re.prototype.computeViewRectangle=function(e,t){e=Object(w.a)(e,ae.WGS84);var i=this.frustum.computeCullingVolume(this.positionWC,this.directionWC,this.upWC),n=new St(z.ZERO,e.maximumRadius);if(i.computeVisibility(n)!==ce.OUTSIDE){var r=this._scene.canvas,a=r.clientWidth,o=r.clientHeight,s=0,c=function(e,t){var i,n,r=t.radii,a=e.positionWC,o=z.multiplyComponents(t.oneOverRadii,a,Koe),s=z.magnitude(o),c=z.normalize(o,Joe);z.equalsEpsilon(c,z.UNIT_Z,I.EPSILON10)?(i=new z(0,1,0),n=new z(0,0,1)):(i=z.normalize(z.cross(z.UNIT_Z,c,$oe),$oe),n=z.normalize(z.cross(c,i,ese),ese));var l=Math.sqrt(z.magnitudeSquared(o)-1),u=z.multiplyByScalar(c,1/s,Koe),h=l/s,d=z.multiplyByScalar(i,h,Joe),f=z.multiplyByScalar(n,h,$oe),p=z.add(u,f,tse[0]);z.subtract(p,d,p),z.multiplyComponents(r,p,p);var m=z.subtract(u,f,tse[1]);z.subtract(m,d,m),z.multiplyComponents(r,m,m);var _=z.subtract(u,f,tse[2]);z.add(_,d,_),z.multiplyComponents(r,_,_);var g=z.add(u,f,tse[3]);return z.add(g,d,g),z.multiplyComponents(r,g,g),tse}(this,e);if(s+=ase(0,0,0,this,e,c),s+=ase(0,o,1,this,e,c),s+=ase(a,o,2,this,e,c),(s+=ase(a,0,3,this,e,c))<2)return Ve.MAX_VALUE;t=Ve.fromCartographicArray(rse,t);for(var l=0,u=rse[3].longitude,h=0;h<4;++h){var d=rse[h].longitude,f=Math.abs(d-u);f>I.PI?l+=I.TWO_PI-f:l+=f,u=d}return I.equalsEpsilon(Math.abs(l),I.TWO_PI,I.EPSILON9)&&(t.west=-I.PI,t.east=I.PI,rse[0].latitude>=0?t.north=I.PI_OVER_TWO:t.south=-I.PI_OVER_TWO),t}},$re.prototype.switchToPerspectiveFrustum=function(){if(!(this._mode===xF.SCENE2D||this.frustum instanceof wb)){var e=this._scene;this.frustum=new wb,this.frustum.aspectRatio=e.drawingBufferWidth/e.drawingBufferHeight,this.frustum.fov=I.toRadians(60)}},$re.prototype.switchToOrthographicFrustum=function(){if(!(this._mode===xF.SCENE2D||this.frustum instanceof hb)){var e=this._scene;this.frustum=new hb,this.frustum.aspectRatio=e.drawingBufferWidth/e.drawingBufferHeight,this.frustum.width=z.magnitude(this.position);var t=this.frustum.projectionMatrix;Object(u.a)(t)&&this._adjustOrthographicFrustum(!0)}},$re.clone=function(e,t){return Object(u.a)(t)||(t=new $re(e._scene)),z.clone(e.position,t.position),z.clone(e.direction,t.direction),z.clone(e.up,t.up),z.clone(e.right,t.right),Be.clone(e._transform,t.transform),t._transformChanged=!0,t.frustum=e.frustum.clone(),t};var ose=$re,sse=Object(E.a)({LEFT_DRAG:0,RIGHT_DRAG:1,MIDDLE_DRAG:2,WHEEL:3,PINCH:4});function cse(e,t){var i=e;return Object(u.a)(t)&&(i+="+"+t),i}function lse(e,t,i){var n=cse(sse.PINCH,t),r=e._update,a=e._isDown,o=e._eventStartPosition,s=e._pressTime,c=e._releaseTime;r[n]=!0,a[n]=!1,o[n]=new Rt;var l=e._movement[n];Object(u.a)(l)||(l=e._movement[n]={}),l.distance={startPosition:new Rt,endPosition:new Rt},l.angleAndHeight={startPosition:new Rt,endPosition:new Rt},l.prevAngle=0,e._eventHandler.setInputAction((function(t){e._buttonsDown++,a[n]=!0,s[n]=new Date,Rt.lerp(t.position1,t.position2,.5,o[n])}),TS.PINCH_START,t),e._eventHandler.setInputAction((function(){e._buttonsDown=Math.max(e._buttonsDown-1,0),a[n]=!1,c[n]=new Date}),TS.PINCH_END,t),e._eventHandler.setInputAction((function(e){if(a[n]){r[n]?(c=e,u=l,Rt.clone(c.distance.startPosition,u.distance.startPosition),Rt.clone(c.distance.endPosition,u.distance.endPosition),Rt.clone(c.angleAndHeight.startPosition,u.angleAndHeight.startPosition),Rt.clone(c.angleAndHeight.endPosition,u.angleAndHeight.endPosition),r[n]=!1,l.prevAngle=l.angleAndHeight.startPosition.x):(Rt.clone(e.distance.endPosition,l.distance.endPosition),Rt.clone(e.angleAndHeight.endPosition,l.angleAndHeight.endPosition));for(var t=l.angleAndHeight.endPosition.x,o=l.prevAngle,s=2*Math.PI;t>=o+Math.PI;)t-=s;for(;t<o-Math.PI;)t+=s;l.angleAndHeight.endPosition.x=-t*i.clientWidth/12,l.angleAndHeight.startPosition.x=-o*i.clientWidth/12}var c,u}),TS.PINCH_MOVE,t)}function use(e,t){var i=cse(sse.WHEEL,t),n=e._update;n[i]=!0;var r=e._movement[i];Object(u.a)(r)||(r=e._movement[i]={}),r.startPosition=new Rt,r.endPosition=new Rt,e._eventHandler.setInputAction((function(e){var t=15*I.toRadians(e);n[i]?(Rt.clone(Rt.ZERO,r.startPosition),r.endPosition.x=0,r.endPosition.y=t,n[i]=!1):r.endPosition.y=r.endPosition.y+t}),TS.WHEEL,t)}function hse(e,t,i){var n=cse(i,t),r=e._isDown,a=e._eventStartPosition,o=e._pressTime,s=e._releaseTime;r[n]=!1,a[n]=new Rt;var c,l,h=e._lastMovement[n];Object(u.a)(h)||(h=e._lastMovement[n]={startPosition:new Rt,endPosition:new Rt,valid:!1}),i===sse.LEFT_DRAG?(c=TS.LEFT_DOWN,l=TS.LEFT_UP):i===sse.RIGHT_DRAG?(c=TS.RIGHT_DOWN,l=TS.RIGHT_UP):i===sse.MIDDLE_DRAG&&(c=TS.MIDDLE_DOWN,l=TS.MIDDLE_UP),e._eventHandler.setInputAction((function(t){e._buttonsDown++,h.valid=!1,r[n]=!0,o[n]=new Date,Rt.clone(t.position,a[n])}),c,t),e._eventHandler.setInputAction((function(){e._buttonsDown=Math.max(e._buttonsDown-1,0),r[n]=!1,s[n]=new Date}),l,t)}function dse(e,t){Rt.clone(e.startPosition,t.startPosition),Rt.clone(e.endPosition,t.endPosition)}function fse(e,t){var i=e._update,n=e._movement,r=e._lastMovement,a=e._isDown;for(var o in sse)if(sse.hasOwnProperty(o)){var s=sse[o];if(Object(u.a)(s)){var c=cse(s,t);i[c]=!0,Object(u.a)(e._lastMovement[c])||(e._lastMovement[c]={startPosition:new Rt,endPosition:new Rt,valid:!1}),Object(u.a)(e._movement[c])||(e._movement[c]={startPosition:new Rt,endPosition:new Rt})}}e._eventHandler.setInputAction((function(o){for(var s in sse)if(sse.hasOwnProperty(s)){var c=sse[s];if(Object(u.a)(c)){var l=cse(c,t);a[l]&&(i[l]?(dse(n[l],r[l]),r[l].valid=!0,dse(o,n[l]),i[l]=!1):Rt.clone(o.endPosition,n[l].endPosition))}}Rt.clone(o.endPosition,e._currentMousePosition)}),TS.MOUSE_MOVE,t)}function pse(e){if(!Object(u.a)(e))throw new h.a("canvas is required.");for(var t in this._eventHandler=new aA(e,!0),this._update={},this._movement={},this._lastMovement={},this._isDown={},this._eventStartPosition={},this._pressTime={},this._releaseTime={},this._buttonsDown=0,this._currentMousePosition=new Rt,use(this,void 0),lse(this,void 0,e),hse(this,void 0,sse.LEFT_DRAG),hse(this,void 0,sse.RIGHT_DRAG),hse(this,void 0,sse.MIDDLE_DRAG),fse(this,void 0),rx)if(rx.hasOwnProperty(t)){var i=rx[t];Object(u.a)(i)&&(use(this,i),lse(this,i,e),hse(this,i,sse.LEFT_DRAG),hse(this,i,sse.RIGHT_DRAG),hse(this,i,sse.MIDDLE_DRAG),fse(this,i))}}Object(O.a)(pse.prototype,{currentMousePosition:{get:function(){return this._currentMousePosition}},anyButtonDown:{get:function(){var e=!(this._update[cse(sse.WHEEL)]&&this._update[cse(sse.WHEEL,rx.SHIFT)]&&this._update[cse(sse.WHEEL,rx.CTRL)]&&this._update[cse(sse.WHEEL,rx.ALT)]);return this._buttonsDown>0||e}}}),pse.prototype.isMoving=function(e,t){if(!Object(u.a)(e))throw new h.a("type is required.");var i=cse(e,t);return!this._update[i]},pse.prototype.getMovement=function(e,t){if(!Object(u.a)(e))throw new h.a("type is required.");var i=cse(e,t);return this._movement[i]},pse.prototype.getLastMovement=function(e,t){if(!Object(u.a)(e))throw new h.a("type is required.");var i=cse(e,t),n=this._lastMovement[i];if(n.valid)return n},pse.prototype.isButtonDown=function(e,t){if(!Object(u.a)(e))throw new h.a("type is required.");var i=cse(e,t);return this._isDown[i]},pse.prototype.getStartMousePosition=function(e,t){if(!Object(u.a)(e))throw new h.a("type is required.");if(e===sse.WHEEL)return this._currentMousePosition;var i=cse(e,t);return this._eventStartPosition[i]},pse.prototype.getButtonPressTime=function(e,t){if(!Object(u.a)(e))throw new h.a("type is required.");var i=cse(e,t);return this._pressTime[i]},pse.prototype.getButtonReleaseTime=function(e,t){if(!Object(u.a)(e))throw new h.a("type is required.");var i=cse(e,t);return this._releaseTime[i]},pse.prototype.reset=function(){for(var e in this._update)this._update.hasOwnProperty(e)&&(this._update[e]=!0)},pse.prototype.isDestroyed=function(){return!1},pse.prototype.destroy=function(){return this._eventHandler=this._eventHandler&&this._eventHandler.destroy(),rl(this)};var mse=pse;function _se(e,t,i,n,r){this.featurePropertiesDirty=!1}Object(O.a)(_se.prototype,{featuresLength:{get:function(){h.a.throwInstantiationError()}},pointsLength:{get:function(){h.a.throwInstantiationError()}},trianglesLength:{get:function(){h.a.throwInstantiationError()}},geometryByteLength:{get:function(){h.a.throwInstantiationError()}},texturesByteLength:{get:function(){h.a.throwInstantiationError()}},batchTableByteLength:{get:function(){h.a.throwInstantiationError()}},innerContents:{get:function(){h.a.throwInstantiationError()}},readyPromise:{get:function(){h.a.throwInstantiationError()}},tileset:{get:function(){h.a.throwInstantiationError()}},tile:{get:function(){h.a.throwInstantiationError()}},url:{get:function(){h.a.throwInstantiationError()}},batchTable:{get:function(){h.a.throwInstantiationError()}}}),_se.prototype.hasProperty=function(e,t){h.a.throwInstantiationError()},_se.prototype.getFeature=function(e){h.a.throwInstantiationError()},_se.prototype.applyDebugSettings=function(e,t){h.a.throwInstantiationError()},_se.prototype.applyStyle=function(e){h.a.throwInstantiationError()},_se.prototype.update=function(e,t){h.a.throwInstantiationError()},_se.prototype.isDestroyed=function(){h.a.throwInstantiationError()},_se.prototype.destroy=function(){h.a.throwInstantiationError()};var gse=_se;function vse(e){this._collection=[],this._scene=e}Object(O.a)(vse.prototype,{length:{get:function(){return this._collection.length}},circleData:{get:function(){for(var e=[],t=0;t<this._collection.length;t++)e.push(this._collection[t].colorData,this._collection[t].circleData);return e}}}),vse.prototype.add=function(e){this._collection.length<4&&this._collection.push(e)},vse.prototype.remove=function(e){var t=this._collection.indexOf(e);-1!==t&&this._collection.splice(t,1)},vse.prototype.removeByIndex=function(e){e<this._collection.length&&this._collection.splice(e,1)},vse.prototype.removeAll=function(){this._collection=[]};var bse=vse;function yse(e){e=Object(w.a)(e,w.a.EMPTY_OBJECT),x.a.defined("options.url",e.url),this._url=void 0,this._basePath=void 0,this._root=void 0,this._asset=void 0,this._properties=void 0,this._geometricError=void 0,this._extensionsUsed=void 0,this._gltfUpAxis=void 0,this._cache=new y5,this._processingQueue=[],this._selectedTiles=[],this._emptyTiles=[],this._requestedTiles=[],this._selectedTilesToStyle=[],this._loadTimestamp=void 0,this._timeSinceLoad=0,this._updatedVisibilityFrame=0,this._extras=void 0,this._credits=void 0,this._cullWithChildrenBounds=Object(w.a)(e.cullWithChildrenBounds,!0),this._allTilesAdditive=!0,this._hasMixedContent=!1,this._stencilClearCommand=void 0,this._backfaceCommands=new Tx,this._maximumScreenSpaceError=Object(w.a)(e.maximumScreenSpaceError,16),this._maximumMemoryUsage=Object(w.a)(e.maximumMemoryUsage,512),this._styleEngine=new $5,this._modelMatrix=Object(u.a)(e.modelMatrix)?Be.clone(e.modelMatrix):Be.clone(Be.IDENTITY),this._statistics=new x5,this._statisticsLastRender=new x5,this._statisticsLastPick=new x5,this._statisticsLastAsync=new x5,this._tilesLoaded=!1,this._initialTilesLoaded=!1,this._tileDebugLabels=void 0,this._readyPromise=Oi.a.defer(),this._classificationType=e.classificationType,this._ellipsoid=Object(w.a)(e.ellipsoid,ae.WGS84),this._initialClippingPlanesOriginMatrix=Be.IDENTITY,this._clippingPlanesOriginMatrix=void 0,this._clippingPlanesOriginMatrixDirty=!0,this._useGradual=Object(w.a)(e.useGradual,!1),this._gradualOptions=e.gradualOptions,this._planView=Object(w.a)(e.planView,!1),this._shouldAnimate=Object(w.a)(e.shouldAnimate,!1),this.dynamicCircleCollection=new bse,this._forceMipmap=Object(w.a)(e.forceMipmap,!1),this._dequantizeInShader=Object(w.a)(e.dequantizeInShader,!1),this.dynamicScreenSpaceError=Object(w.a)(e.dynamicScreenSpaceError,!1),this.dynamicScreenSpaceErrorDensity=.00278,this.dynamicScreenSpaceErrorFactor=4,this.dynamicScreenSpaceErrorHeightFalloff=.25,this._dynamicScreenSpaceErrorComputedDensity=0,this.shadows=Object(w.a)(e.shadows,rM.ENABLED),this.show=Object(w.a)(e.show,!0),this.colorBlendMode=gX.HIGHLIGHT,this.colorBlendAmount=.5,this.pointCloudShading=new u6(e.pointCloudShading),this._pointCloudEyeDomeLighting=new c6,this.loadProgress=new $o.a,this.allTilesLoaded=new $o.a,this.initialTilesLoaded=new $o.a,this.tileLoad=new $o.a,this.tileUnload=new $o.a,this.tileFailed=new $o.a,this.tileVisible=new $o.a,this.skipLevelOfDetail=Object(w.a)(e.skipLevelOfDetail,!0),this._skipLevelOfDetail=this.skipLevelOfDetail,this._disableSkipLevelOfDetail=!1,this.baseScreenSpaceError=Object(w.a)(e.baseScreenSpaceError,1024),this.skipScreenSpaceErrorFactor=Object(w.a)(e.skipScreenSpaceErrorFactor,16),this.skipLevels=Object(w.a)(e.skipLevels,1),this.immediatelyLoadDesiredLevelOfDetail=Object(w.a)(e.immediatelyLoadDesiredLevelOfDetail,!1),this.loadSiblings=Object(w.a)(e.loadSiblings,!1),this._clippingPlanes=void 0,this.clippingPlanes=e.clippingPlanes,this._imageBasedLightingFactor=new Rt(1,1),Rt.clone(e.imageBasedLightingFactor,this._imageBasedLightingFactor),this.lightColor=e.lightColor,this.luminanceAtZenith=Object(w.a)(e.luminanceAtZenith,.5),this.sphericalHarmonicCoefficients=e.sphericalHarmonicCoefficients,this.specularEnvironmentMaps=e.specularEnvironmentMaps,this.debugFreezeFrame=Object(w.a)(e.debugFreezeFrame,!1),this.debugColorizeTiles=Object(w.a)(e.debugColorizeTiles,!1),this.debugWireframe=Object(w.a)(e.debugWireframe,!1),this.debugShowBoundingVolume=Object(w.a)(e.debugShowBoundingVolume,!1),this.debugShowContentBoundingVolume=Object(w.a)(e.debugShowContentBoundingVolume,!1),this.debugShowViewerRequestVolume=Object(w.a)(e.debugShowViewerRequestVolume,!1),this._tileDebugLabels=void 0,this.debugPickedTileLabelOnly=!1,this.debugPickedTile=void 0,this.debugPickPosition=void 0,this.debugShowGeometricError=Object(w.a)(e.debugShowGeometricError,!1),this.debugShowRenderingStatistics=Object(w.a)(e.debugShowRenderingStatistics,!1),this.debugShowMemoryUsage=Object(w.a)(e.debugShowMemoryUsage,!1),this.debugShowUrl=Object(w.a)(e.debugShowUrl,!1);var t,i=this;Object(Oi.a)(e.url).then((function(e){var n;return t=f.a.createIfNeeded(e),i._credits=t.credits,"json"===t.extension?n=t.getBaseUri(!0):t.isDataUri&&(n=""),i._url=t.url,i._basePath=n,yse.loadJson(t)})).then((function(e){i._root=i.loadTileset(t,e);var n=Object(u.a)(e.asset.gltfUpAxis)?mX.fromName(e.asset.gltfUpAxis):mX.Y,r=e.asset;i._asset=r,i._properties=e.properties,i._geometricError=e.geometricError,i._extensionsUsed=e.extensionsUsed,i._gltfUpAxis=n,i._extras=e.extras;var a=r.extras;if(Object(u.a)(a)&&Object(u.a)(a.cesium)&&Object(u.a)(a.cesium.credits)){var o=a.cesium.credits,s=i._credits;Object(u.a)(s)||(s=[],i._credits=s);for(var c=0;c<o.length;c++){var l=o[c];s.push(new Jo(l.html,l.showOnScreen))}}var h=i._root.createBoundingVolume(e.root.boundingVolume,Be.IDENTITY).boundingSphere.center,d=i._ellipsoid.cartesianToCartographic(h);Object(u.a)(d)&&d.height>Xt._defaultMinTerrainHeight&&(i._initialClippingPlanesOriginMatrix=xa.eastNorthUpToFixedFrame(h)),i._clippingPlanesOriginMatrix=Be.clone(i._initialClippingPlanesOriginMatrix),i._readyPromise.resolve(i)})).otherwise((function(e){i._readyPromise.reject(e)}))}Object(O.a)(yse.prototype,{asset:{get:function(){if(!this.ready)throw new h.a("The tileset is not loaded.  Use Cesium3DTileset.readyPromise or wait for Cesium3DTileset.ready to be true.");return this._asset}},clippingPlanes:{get:function(){return this._clippingPlanes},set:function(e){iJ.setOwner(e,this,"_clippingPlanes")}},properties:{get:function(){if(!this.ready)throw new h.a("The tileset is not loaded.  Use Cesium3DTileset.readyPromise or wait for Cesium3DTileset.ready to be true.");return this._properties}},ready:{get:function(){return Object(u.a)(this._root)}},readyPromise:{get:function(){return this._readyPromise.promise}},tilesLoaded:{get:function(){return this._tilesLoaded}},url:{get:function(){return this._url}},basePath:{get:function(){return Object(mv.a)("Cesium3DTileset.basePath","Cesium3DTileset.basePath has been deprecated. All tiles are relative to the url of the tileset JSON file that contains them. Use the url property instead."),this._basePath}},style:{get:function(){return this._styleEngine.style},set:function(e){this._styleEngine.style=e}},maximumScreenSpaceError:{get:function(){return this._maximumScreenSpaceError},set:function(e){x.a.typeOf.number.greaterThanOrEquals("maximumScreenSpaceError",e,0),this._maximumScreenSpaceError=e}},maximumMemoryUsage:{get:function(){return this._maximumMemoryUsage},set:function(e){x.a.typeOf.number.greaterThanOrEquals("value",e,0),this._maximumMemoryUsage=e}},root:{get:function(){if(!this.ready)throw new h.a("The tileset is not loaded.  Use Cesium3DTileset.readyPromise or wait for Cesium3DTileset.ready to be true.");return this._root}},boundingSphere:{get:function(){if(!this.ready)throw new h.a("The tileset is not loaded.  Use Cesium3DTileset.readyPromise or wait for Cesium3DTileset.ready to be true.");return this._root.updateTransform(this._modelMatrix),this._root.boundingSphere}},modelMatrix:{get:function(){return this._modelMatrix},set:function(e){this._modelMatrix=Be.clone(e,this._modelMatrix)}},timeSinceLoad:{get:function(){return this._timeSinceLoad}},totalMemoryUsageInBytes:{get:function(){var e=this._statistics;return e.texturesByteLength+e.geometryByteLength+e.batchTableByteLength}},clippingPlanesOriginMatrix:{get:function(){return Object(u.a)(this._clippingPlanesOriginMatrix)?(this._clippingPlanesOriginMatrixDirty&&(Be.multiply(this.root.computedTransform,this._initialClippingPlanesOriginMatrix,this._clippingPlanesOriginMatrix),this._clippingPlanesOriginMatrixDirty=!1),this._clippingPlanesOriginMatrix):Be.IDENTITY}},styleEngine:{get:function(){return this._styleEngine}},statistics:{get:function(){return this._statistics}},classificationType:{get:function(){return this._classificationType}},ellipsoid:{get:function(){return this._ellipsoid}},extras:{get:function(){if(!this.ready)throw new h.a("The tileset is not loaded.  Use Cesium3DTileset.readyPromise or wait for Cesium3DTileset.ready to be true.");return this._extras}},imageBasedLightingFactor:{get:function(){return this._imageBasedLightingFactor},set:function(e){x.a.typeOf.object("imageBasedLightingFactor",e),x.a.typeOf.number.greaterThanOrEquals("imageBasedLightingFactor.x",e.x,0),x.a.typeOf.number.lessThanOrEquals("imageBasedLightingFactor.x",e.x,1),x.a.typeOf.number.greaterThanOrEquals("imageBasedLightingFactor.y",e.y,0),x.a.typeOf.number.lessThanOrEquals("imageBasedLightingFactor.y",e.y,1),Rt.clone(e,this._imageBasedLightingFactor)}},useGradual:{get:function(){return this._useGradual},set:function(e){this._useGradual=e}},gradualOptions:{get:function(){return this._gradualOptions},set:function(e){this._gradualOptions=e}},shouldAnimate:{get:function(){return this._shouldAnimate},set:function(e){this._shouldAnimate=e}},planView:{get:function(){return this._planView},set:function(e){this._planView=e}}}),yse.loadJson=function(e){return f.a.createIfNeeded(e).fetchJson()},yse.prototype.makeStyleDirty=function(){this._styleEngine.makeDirty()},yse.prototype.loadTileset=function(e,t,i){var n=t.asset;if(!Object(u.a)(n))throw new Ce.a("Tileset must have an asset property.");if("0.0"!==n.version&&"1.0"!==n.version)throw new Ce.a("The tileset must be 3D Tiles version 0.0 or 1.0.");var r=this._statistics,a=n.tilesetVersion;Object(u.a)(a)?(this._basePath+="?v="+a,e.setQueryParameters({v:a})):delete e.queryParameters.v;var o=new r5(this,e,t.root,i);Object(u.a)(i)&&(i.children.push(o),o._depth=i._depth+1);var s=[];for(s.push(o);s.length>0;){var c=s.pop();++r.numberOfTilesTotal,this._allTilesAdditive=this._allTilesAdditive&&c.refine===H1.ADD;var l=c._header.children;if(Object(u.a)(l))for(var h=l.length,d=0;d<h;++d){var f=l[d],p=new r5(this,e,f,c);c.children.push(p),p._depth=c._depth+1,s.push(p)}this._cullWithChildrenBounds&&s5.checkChildrenWithinParent(c)}return o};var wse=new z,Ose=new K,xse=new Be,Ese=new z,Tse=new z,Cse=new z;function Sse(e,t){if(!t.hasEmptyContent){var i=e._statistics,n=t.contentExpired;t.requestContent()?(n&&(t.hasTilesetContent?function(e,t){var i=t,n=Nse;n.push(t);for(;n.length>0;){for(var r=(t=n.pop()).children,a=r.length,o=0;o<a;++o)n.push(r[o]);t!==i&&(kse(e,t),--e._statistics.numberOfTilesTotal)}i.children=[]}(e,t):(i.decrementLoadCounts(t.content),--i.numberOfTilesWithContentReady)),++i.numberOfPendingRequests,t.contentReadyToProcessPromise.then(function(e,t){return function(){e._processingQueue.push(t),--e._statistics.numberOfPendingRequests,++e._statistics.numberOfTilesProcessing}}(e,t)),t.contentReadyPromise.then(function(e,t){return function(){--e._statistics.numberOfTilesProcessing,t.hasTilesetContent||(e._statistics.incrementLoadCounts(t.content),++e._statistics.numberOfTilesWithContentReady,e._cache.add(t)),e.tileLoad.raiseEvent(t)}}(e,t)).otherwise(function(e,t){return function(i){e._processingQueue.indexOf(t)>=0?--e._statistics.numberOfTilesProcessing:--e._statistics.numberOfPendingRequests;var n=t._contentResource.url,r=Object(u.a)(i.message)?i.message:i.toString();e.tileFailed.numberOfListeners>0?e.tileFailed.raiseEvent({url:n,message:r}):(console.log("A 3D tile failed to load: "+n),console.log("Error: "+r))}}(e,t))):++i.numberOfAttemptedRequests}}function Ase(e,t){return e._priority-t._priority}function Pse(e,t){!function(e){for(var t=e._processingQueue,i=t.length,n=0,r=0;r<i;++r){var a=t[r];a._contentState===y4.PROCESSING?n>0&&(t[r-n]=a):++n}t.length-=n}(e);for(var i=e._processingQueue,n=i.length,r=0;r<n;++r)i[r].process(e,t)}var Ise=new z,Dse={maximumFractionDigits:3};function jse(e){var t=e/1048576;return t<1?t.toLocaleString(void 0,Dse):Math.round(t).toLocaleString()}function Mse(e){var t=e.boundingVolume.boundingVolume,i=t.halfAxes,n=t.radius,r=z.clone(t.center,Ise);if(Object(u.a)(i))r.x+=.75*(i[0]+i[3]+i[6]),r.y+=.75*(i[1]+i[4]+i[7]),r.z+=.75*(i[2]+i[5]+i[8]);else if(Object(u.a)(n)){var a=z.normalize(t.center,Ise);a=z.multiplyByScalar(a,.75*n,Ise),r=z.add(a,t.center,Ise)}return r}function Rse(e,t,i){var n="",r=0;(t.debugShowGeometricError&&(n+="\nGeometric error: "+e.geometricError,r++),t.debugShowRenderingStatistics)&&(n+="\nCommands: "+e.commandsLength,r++,e.content.pointsLength>0&&(n+="\nPoints: "+e.content.pointsLength,r++),e.content.trianglesLength>0&&(n+="\nTriangles: "+e.content.trianglesLength,r++),n+="\nFeatures: "+e.content.featuresLength,r++);t.debugShowMemoryUsage&&(n+="\nTexture Memory: "+jse(e.content.texturesByteLength),n+="\nGeometry Memory: "+jse(e.content.geometryByteLength),r+=2),t.debugShowUrl&&(n+="\nUrl: "+e._header.content.uri,r++);var a={text:n.substring(1),position:i,font:19-r+"px sans-serif",showBackground:!0,disableDepthTestDistance:Number.POSITIVE_INFINITY};return t._tileDebugLabels.add(a)}function Lse(e,t){e._styleEngine.applyStyle(e,t);var i,n,r=e._statistics,a=t.passes.render,o=t.commandList,s=o.length,c=e._selectedTiles,l=c.length,h=e._emptyTiles,d=h.length,f=e.tileVisible,p=e._skipLevelOfDetail&&e._hasMixedContent&&t.context.stencilBuffer&&l>0;e._backfaceCommands.length=0,p&&(Object(u.a)(e._stencilClearCommand)||(e._stencilClearCommand=new fX({stencil:0,pass:lM.CESIUM_3D_TILE,renderState:RM.fromCache({stencilMask:Hk.SKIP_LOD_MASK})})),o.push(e._stencilClearCommand));var m=o.length;for(i=0;i<l;++i)n=c[i],a&&f.raiseEvent(n),n.update(e,t),r.incrementSelectionCounts(n.content),++r.selected;for(i=0;i<d;++i)(n=h[i]).update(e,t);var _=o.length-m;if(e._backfaceCommands.trim(),p){var g=e._backfaceCommands.values,v=g.length;for(o.length+=v,i=_-1;i>=0;--i)o[m+v+i]=o[m+i];for(i=0;i<v;++i)o[m+i]=g[i]}_=o.length-s,r.numberOfCommands=_,a&&e.pointCloudShading.attenuation&&e.pointCloudShading.eyeDomeLighting&&_>0&&e._pointCloudEyeDomeLighting.update(t,s,e.pointCloudShading),a&&(e.debugShowGeometricError||e.debugShowRenderingStatistics||e.debugShowMemoryUsage||e.debugShowUrl?(Object(u.a)(e._tileDebugLabels)||(e._tileDebugLabels=new jG),function(e,t){var i,n,r=e._selectedTiles,a=r.length,o=e._emptyTiles,s=o.length;if(e._tileDebugLabels.removeAll(),e.debugPickedTileLabelOnly){if(Object(u.a)(e.debugPickedTile)){var c=Object(u.a)(e.debugPickPosition)?e.debugPickPosition:Mse(e.debugPickedTile);Rse(e.debugPickedTile,e,c).pixelOffset=new Rt(15,-15)}}else{for(i=0;i<a;++i)Rse(n=r[i],e,Mse(n));for(i=0;i<s;++i)(n=o[i]).hasTilesetContent&&Rse(n,e,Mse(n))}e._tileDebugLabels.update(t)}(e,t)):e._tileDebugLabels=e._tileDebugLabels&&e._tileDebugLabels.destroy())}var Nse=[];function Fse(e,t){e.tileUnload.raiseEvent(t),e._statistics.decrementLoadCounts(t.content),--e._statistics.numberOfTilesWithContentReady,t.unloadContent()}function kse(e,t){e._cache.unloadTile(e,t,Fse),t.destroy()}function Bse(e,t){if(t.mode===xF.MORPHING)return!1;if(!e.show||!e.ready)return!1;Object(u.a)(e._loadTimestamp)||(e._loadTimestamp=Tr.clone(t.time));var i=e._clippingPlanes;e._clippingPlanesOriginMatrixDirty=!0,Object(u.a)(i)&&i.enabled&&i.update(t),e._timeSinceLoad=Math.max(1e3*Tr.secondsDifference(t.time,e._loadTimestamp),0),e._skipLevelOfDetail=e.skipLevelOfDetail&&!Object(u.a)(e._classificationType)&&!e._disableSkipLevelOfDetail&&!e._allTilesAdditive;var n,r=t.passes,a=r.render,o=r.pick,s=r.asynchronous,c=e._statistics;if(c.clear(),e.dynamicScreenSpaceError&&function(e,t){var i,n,r,a,o,s=t.camera,c=e._root,l=c.contentBoundingVolume;if(l instanceof B4)i=z.normalize(s.positionWC,wse),n=s.directionWC,r=s.positionCartographic.height,a=l.minimumHeight,o=l.maximumHeight;else{var u=Be.inverseTransformation(c.computedTransform,xse),h=t.mapProjection.ellipsoid,d=l.boundingVolume,f=Be.multiplyByPoint(u,d.center,Ese);if(z.magnitude(f)>h.minimumRadius){var p=K.fromCartesian(f,h,Ose);i=z.normalize(s.positionWC,wse),n=s.directionWC,r=s.positionCartographic.height,a=0,o=2*p.height}else{var m=Be.multiplyByPoint(u,s.positionWC,Tse);if(i=z.UNIT_Z,n=Be.multiplyByPointAsVector(u,s.directionWC,Cse),n=z.normalize(n,n),r=m.z,l instanceof H4){var _=c._header.boundingVolume.box[11];a=f.z-_,o=f.z+_}else if(l instanceof U4){var g=d.radius;a=f.z-g,o=f.z+g}}}var v=a+(o-a)*e.dynamicScreenSpaceErrorHeightFalloff,b=o,y=I.clamp((r-v)/(b-v),0,1),w=1-Math.abs(z.dot(n,i));w*=1-y;var O=e.dynamicScreenSpaceErrorDensity;O*=w,e._dynamicScreenSpaceErrorComputedDensity=O}(e,t),a&&e._cache.reset(),++e._updatedVisibilityFrame,n=s?v5.selectTiles(e,t):K5.selectTiles(e,t),(a||s)&&function(e){var t=e._requestedTiles,i=t.length;t.sort(Ase);for(var n=0;n<i;++n)Sse(e,t[n])}(e),a&&Pse(e,t),Lse(e,t),a&&(function(e){e._cache.unloadTiles(e,Fse)}(e),function(e,t){var i=e._statistics,n=e._statisticsLastRender,r=i.numberOfPendingRequests,a=i.numberOfTilesProcessing,o=n.numberOfPendingRequests,s=n.numberOfTilesProcessing,c=r!==o||a!==s;c&&t.afterRender.push((function(){e.loadProgress.raiseEvent(r,a)})),e._tilesLoaded=0===i.numberOfPendingRequests&&0===i.numberOfTilesProcessing&&0===i.numberOfAttemptedRequests,c&&e._tilesLoaded&&(t.afterRender.push((function(){e.allTilesLoaded.raiseEvent()})),e._initialTilesLoaded||(e._initialTilesLoaded=!0,t.afterRender.push((function(){e.initialTilesLoaded.raiseEvent()}))))}(e,t),0!==c.selected)){var l=e._credits;if(Object(u.a)(l))for(var h=l.length,d=0;d<h;d++)t.creditDisplay.addCredit(l[d])}var f=s?e._statisticsLastAsync:o?e._statisticsLastPick:e._statisticsLastRender;return x5.clone(c,f),n}yse.prototype.trimLoadedTiles=function(){this._cache.trim()},yse.prototype.update=function(e){Bse(this,e)},yse.prototype.updateAsync=function(e){return Bse(this,e)},yse.prototype.hasExtension=function(e){return!!Object(u.a)(this._extensionsUsed)&&this._extensionsUsed.indexOf(e)>-1},yse.prototype.isDestroyed=function(){return!1},yse.prototype.destroy=function(){if(this._tileDebugLabels=this._tileDebugLabels&&this._tileDebugLabels.destroy(),this._clippingPlanes=this._clippingPlanes&&this._clippingPlanes.destroy(),Object(u.a)(this._root)){var e=Nse;for(e.push(this._root);e.length>0;){var t=e.pop();t.destroy();for(var i=t.children,n=i.length,r=0;r<n;++r)e.push(i[r])}}return this._root=void 0,rl(this)};var zse=yse;function Use(e,t){this._conditionsExpression=Object(nf.a)(e,!0),this._conditions=e.conditions,this._runtimeConditions=void 0,function(e,t){var i=[],n=e._conditions;if(!Object(u.a)(n))return;for(var r=n.length,a=0;a<r;++a){var o=n[a],s=String(o[0]),c=String(o[1]);i.push(new Vse(new sK(s,t),new sK(c,t)))}e._runtimeConditions=i}(this,t)}function Vse(e,t){this.condition=e,this.expression=t}Object(O.a)(Use.prototype,{conditionsExpression:{get:function(){return this._conditionsExpression}}}),Use.prototype.evaluate=function(e,t){var i=this._runtimeConditions;if(Object(u.a)(i))for(var n=i.length,r=0;r<n;++r){var a=i[r];if(a.condition.evaluate(e))return a.expression.evaluate(e,t)}},Use.prototype.evaluateColor=function(e,t){var i=this._runtimeConditions;if(Object(u.a)(i))for(var n=i.length,r=0;r<n;++r){var a=i[r];if(a.condition.evaluate(e))return a.expression.evaluateColor(e,t)}},Use.prototype.getShaderFunction=function(e,t,i,n){var r=this._runtimeConditions;if(Object(u.a)(r)&&0!==r.length){for(var a="",o=r.length,s=0;s<o;++s){var c=r[s];a+="    "+(0===s?"if":"else if")+" ("+c.condition.getShaderExpression(t,i)+") \n    { \n        return "+c.expression.getShaderExpression(t,i)+"; \n    } \n"}return a=n+" "+e+"() \n{ \n"+a+"    return "+n+"(1.0); \n} \n"}};var Hse=Use;function Gse(e){var t;(this._style=void 0,this._ready=!1,this._show=void 0,this._color=void 0,this._pointSize=void 0,this._pointOutlineColor=void 0,this._pointOutlineWidth=void 0,this._labelColor=void 0,this._labelOutlineColor=void 0,this._labelOutlineWidth=void 0,this._font=void 0,this._labelStyle=void 0,this._labelText=void 0,this._backgroundColor=void 0,this._backgroundPadding=void 0,this._backgroundEnabled=void 0,this._scaleByDistance=void 0,this._translucencyByDistance=void 0,this._distanceDisplayCondition=void 0,this._heightOffset=void 0,this._anchorLineEnabled=void 0,this._anchorLineColor=void 0,this._image=void 0,this._disableDepthTestDistance=void 0,this._horizontalOrigin=void 0,this._verticalOrigin=void 0,this._labelHorizontalOrigin=void 0,this._labelVerticalOrigin=void 0,this._meta=void 0,this._colorShaderFunction=void 0,this._showShaderFunction=void 0,this._pointSizeShaderFunction=void 0,this._colorShaderFunctionReady=!1,this._showShaderFunctionReady=!1,this._pointSizeShaderFunctionReady=!1,this._colorShaderTranslucent=!1,"string"==typeof e||e instanceof f.a)?t=f.a.createIfNeeded(e).fetchJson(e):t=Oi.a.resolve(e);var i=this;this._readyPromise=t.then((function(e){return function(e,t){e._style=Object(nf.a)(t,!0),t=Object(w.a)(t,w.a.EMPTY_OBJECT),e.show=t.show,e.color=t.color,e.pointSize=t.pointSize,e.pointOutlineColor=t.pointOutlineColor,e.pointOutlineWidth=t.pointOutlineWidth,e.labelColor=t.labelColor,e.labelOutlineColor=t.labelOutlineColor,e.labelOutlineWidth=t.labelOutlineWidth,e.labelStyle=t.labelStyle,e.font=t.font,e.labelText=t.labelText,e.backgroundColor=t.backgroundColor,e.backgroundPadding=t.backgroundPadding,e.backgroundEnabled=t.backgroundEnabled,e.scaleByDistance=t.scaleByDistance,e.translucencyByDistance=t.translucencyByDistance,e.distanceDisplayCondition=t.distanceDisplayCondition,e.heightOffset=t.heightOffset,e.anchorLineEnabled=t.anchorLineEnabled,e.anchorLineColor=t.anchorLineColor,e.image=t.image,e.disableDepthTestDistance=t.disableDepthTestDistance,e.horizontalOrigin=t.horizontalOrigin,e.verticalOrigin=t.verticalOrigin,e.labelHorizontalOrigin=t.labelHorizontalOrigin,e.labelVerticalOrigin=t.labelVerticalOrigin;var i={};if(Object(u.a)(t.meta)){var n=t.defines,r=Object(w.a)(t.meta,w.a.EMPTY_OBJECT);for(var a in r)r.hasOwnProperty(a)&&(i[a]=new sK(r[a],n))}e._meta=i,e._ready=!0}(i,e),i}))}function qse(e,t){var i=Object(w.a)(e._style,w.a.EMPTY_OBJECT).defines;if(Object(u.a)(t))return"boolean"==typeof t||"number"==typeof t?new sK(String(t)):"string"==typeof t?new sK(t,i):Object(u.a)(t.conditions)?new Hse(t,i):t}Object(O.a)(Gse.prototype,{style:{get:function(){if(!this._ready)throw new h.a("The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.");return this._style}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise}},show:{get:function(){if(!this._ready)throw new h.a("The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.");return this._show},set:function(e){this._show=qse(this,e),this._showShaderFunctionReady=!1}},color:{get:function(){if(!this._ready)throw new h.a("The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.");return this._color},set:function(e){this._color=qse(this,e),this._colorShaderFunctionReady=!1}},pointSize:{get:function(){if(!this._ready)throw new h.a("The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.");return this._pointSize},set:function(e){this._pointSize=qse(this,e),this._pointSizeShaderFunctionReady=!1}},pointOutlineColor:{get:function(){if(!this._ready)throw new h.a("The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.");return this._pointOutlineColor},set:function(e){this._pointOutlineColor=qse(this,e)}},pointOutlineWidth:{get:function(){if(!this._ready)throw new h.a("The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.");return this._pointOutlineWidth},set:function(e){this._pointOutlineWidth=qse(this,e)}},labelColor:{get:function(){if(!this._ready)throw new h.a("The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.");return this._labelColor},set:function(e){this._labelColor=qse(this,e)}},labelOutlineColor:{get:function(){if(!this._ready)throw new h.a("The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.");return this._labelOutlineColor},set:function(e){this._labelOutlineColor=qse(this,e)}},labelOutlineWidth:{get:function(){if(!this._ready)throw new h.a("The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.");return this._labelOutlineWidth},set:function(e){this._labelOutlineWidth=qse(this,e)}},font:{get:function(){if(!this._ready)throw new h.a("The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.");return this._font},set:function(e){this._font=qse(this,e)}},labelStyle:{get:function(){if(!this._ready)throw new h.a("The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.");return this._labelStyle},set:function(e){this._labelStyle=qse(this,e)}},labelText:{get:function(){if(!this._ready)throw new h.a("The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.");return this._labelText},set:function(e){this._labelText=qse(this,e)}},backgroundColor:{get:function(){if(!this._ready)throw new h.a("The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.");return this._backgroundColor},set:function(e){this._backgroundColor=qse(this,e)}},backgroundPadding:{get:function(){if(!this._ready)throw new h.a("The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.");return this._backgroundPadding},set:function(e){this._backgroundPadding=qse(this,e)}},backgroundEnabled:{get:function(){if(!this._ready)throw new h.a("The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.");return this._backgroundEnabled},set:function(e){this._backgroundEnabled=qse(this,e)}},scaleByDistance:{get:function(){if(!this._ready)throw new h.a("The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.");return this._scaleByDistance},set:function(e){this._scaleByDistance=qse(this,e)}},translucencyByDistance:{get:function(){if(!this._ready)throw new h.a("The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.");return this._translucencyByDistance},set:function(e){this._translucencyByDistance=qse(this,e)}},distanceDisplayCondition:{get:function(){if(!this._ready)throw new h.a("The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.");return this._distanceDisplayCondition},set:function(e){this._distanceDisplayCondition=qse(this,e)}},heightOffset:{get:function(){if(!this._ready)throw new h.a("The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.");return this._heightOffset},set:function(e){this._heightOffset=qse(this,e)}},anchorLineEnabled:{get:function(){if(!this._ready)throw new h.a("The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.");return this._anchorLineEnabled},set:function(e){this._anchorLineEnabled=qse(this,e)}},anchorLineColor:{get:function(){if(!this._ready)throw new h.a("The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.");return this._anchorLineColor},set:function(e){this._anchorLineColor=qse(this,e)}},image:{get:function(){if(!this._ready)throw new h.a("The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.");return this._image},set:function(e){this._image=qse(this,e)}},disableDepthTestDistance:{get:function(){if(!this._ready)throw new h.a("The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.");return this._disableDepthTestDistance},set:function(e){this._disableDepthTestDistance=qse(this,e)}},horizontalOrigin:{get:function(){if(!this._ready)throw new h.a("The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.");return this._horizontalOrigin},set:function(e){this._horizontalOrigin=qse(this,e)}},verticalOrigin:{get:function(){if(!this._ready)throw new h.a("The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.");return this._verticalOrigin},set:function(e){this._verticalOrigin=qse(this,e)}},labelHorizontalOrigin:{get:function(){if(!this._ready)throw new h.a("The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.");return this._labelHorizontalOrigin},set:function(e){this._labelHorizontalOrigin=qse(this,e)}},labelVerticalOrigin:{get:function(){if(!this._ready)throw new h.a("The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.");return this._labelVerticalOrigin},set:function(e){this._labelVerticalOrigin=qse(this,e)}},meta:{get:function(){if(!this._ready)throw new h.a("The style is not loaded.  Use Cesium3DTileStyle.readyPromise or wait for Cesium3DTileStyle.ready to be true.");return this._meta},set:function(e){this._meta=e}}}),Gse.prototype.getColorShaderFunction=function(e,t,i){return this._colorShaderFunctionReady?(i.translucent=this._colorShaderTranslucent,this._colorShaderFunction):(this._colorShaderFunctionReady=!0,this._colorShaderFunction=Object(u.a)(this.color)?this.color.getShaderFunction(e,t,i,"vec4"):void 0,this._colorShaderTranslucent=i.translucent,this._colorShaderFunction)},Gse.prototype.getShowShaderFunction=function(e,t,i){return this._showShaderFunctionReady?this._showShaderFunction:(this._showShaderFunctionReady=!0,this._showShaderFunction=Object(u.a)(this.show)?this.show.getShaderFunction(e,t,i,"bool"):void 0,this._showShaderFunction)},Gse.prototype.getPointSizeShaderFunction=function(e,t,i){return this._pointSizeShaderFunctionReady?this._pointSizeShaderFunction:(this._pointSizeShaderFunctionReady=!0,this._pointSizeShaderFunction=Object(u.a)(this.pointSize)?this.pointSize.getShaderFunction(e,t,i,"float"):void 0,this._pointSizeShaderFunction)};var Wse=Gse;function Yse(e){e=Object(w.a)(e,1),x.a.typeOf.number.greaterThan("radius",e,0),this._radius=Object(w.a)(e,1)}Object(O.a)(Yse.prototype,{radius:{get:function(){return this._radius},set:function(e){x.a.typeOf.number.greaterThan("value",e,0),this._radius=e}}}),Yse.prototype.emit=function(e){var t=I.randomBetween(0,I.TWO_PI),i=I.randomBetween(0,this._radius),n=i*Math.cos(t),r=i*Math.sin(t);e.position=z.fromElements(n,r,0,e.position),e.velocity=z.clone(z.UNIT_Z,e.velocity)};var Xse=Yse;function Zse(e,t){var i,n=t.terrainProvider,r=t.mapProjection,a=r.ellipsoid,o=t.camera.getRectangleCameraCoordinates(e);return i=t.mode===xF.SCENE3D?a.cartesianToCartographic(o):r.unproject(o),Object(u.a)(n)?n.readyPromise.then((function(){var r=n.availability;if(!Object(u.a)(r)||t.mode===xF.SCENE2D)return i;var a=[Ve.center(e),Ve.southeast(e),Ve.southwest(e),Ve.northeast(e),Ve.northwest(e)];return Zse._sampleTerrainMostDetailed(n,a).then((function(e){var t=e.reduce((function(e,t){return Math.max(t.height,e)}),-Number.MAX_VALUE),n=i;return n.height+=t,n}))})):Oi.a.resolve(i)}Zse._sampleTerrainMostDetailed=ES;var Qse=Zse,Kse=I.toRadians(30);function Jse(e){this._angle=Object(w.a)(e,Kse)}Object(O.a)(Jse.prototype,{angle:{get:function(){return this._angle},set:function(e){x.a.typeOf.number("value",e),this._angle=e}}}),Jse.prototype.emit=function(e){var t=Math.tan(this._angle),i=I.randomBetween(0,I.TWO_PI),n=I.randomBetween(0,t),r=n*Math.cos(i),a=n*Math.sin(i);e.velocity=z.fromElements(r,a,1,e.velocity),z.normalize(e.velocity,e.velocity),e.position=z.clone(z.ZERO,e.position)};var $se=Jse,ece=/{[^}]+}/g,tce={x:function(e,t,i,n){return hce(e,"{x}",t)},y:function(e,t,i,n){return hce(e,"{y}",i)},z:function(e,t,i,n){return hce(e,"{z}",n)},s:function(e,t,i,n){var r=(t+i+n)%e._subdomains.length;return e._subdomains[r]},reverseX:function(e,t,i,n){var r=e.tilingScheme.getNumberOfXTilesAtLevel(n)-t-1;return hce(e,"{reverseX}",r)},reverseY:function(e,t,i,n){var r=e.tilingScheme.getNumberOfYTilesAtLevel(n)-i-1;return hce(e,"{reverseY}",r)},reverseZ:function(e,t,i,n){var r=e.maximumLevel,a=Object(u.a)(r)&&n<r?r-n-1:n;return hce(e,"{reverseZ}",a)},westDegrees:function(e,t,i,n){return dce(e,t,i,n),ace.west},southDegrees:function(e,t,i,n){return dce(e,t,i,n),ace.south},eastDegrees:function(e,t,i,n){return dce(e,t,i,n),ace.east},northDegrees:function(e,t,i,n){return dce(e,t,i,n),ace.north},westProjected:function(e,t,i,n){return fce(e,t,i,n),sce.west},southProjected:function(e,t,i,n){return fce(e,t,i,n),sce.south},eastProjected:function(e,t,i,n){return fce(e,t,i,n),sce.east},northProjected:function(e,t,i,n){return fce(e,t,i,n),sce.north},width:function(e,t,i,n){return e.tileWidth},height:function(e,t,i,n){return e.tileHeight}},ice=Object(ff.a)(tce,{i:function(e,t,i,n,r,a,o){return _ce(e,t,i,n,r,a),lce.x},j:function(e,t,i,n,r,a,o){return _ce(e,t,i,n,r,a),lce.y},reverseI:function(e,t,i,n,r,a,o){return _ce(e,t,i,n,r,a),e.tileWidth-lce.x-1},reverseJ:function(e,t,i,n,r,a,o){return _ce(e,t,i,n,r,a),e.tileHeight-lce.y-1},longitudeDegrees:function(e,t,i,n,r,a,o){return I.toDegrees(r)},latitudeDegrees:function(e,t,i,n,r,a,o){return I.toDegrees(a)},longitudeProjected:function(e,t,i,n,r,a,o){return vce(e,t,i,n,r,a),mce.x},latitudeProjected:function(e,t,i,n,r,a,o){return vce(e,t,i,n,r,a),mce.y},format:function(e,t,i,n,r,a,o){return o}});function nce(e){if(!Object(u.a)(e))throw new h.a("options is required.");if(!Oi.a.isPromise(e)&&!Object(u.a)(e.url))throw new h.a("options is required.");this._errorEvent=new $o.a,this._resource=void 0,this._urlSchemeZeroPadding=void 0,this._pickFeaturesResource=void 0,this._tileWidth=void 0,this._tileHeight=void 0,this._maximumLevel=void 0,this._minimumLevel=void 0,this._tilingScheme=void 0,this._rectangle=void 0,this._tileDiscardPolicy=void 0,this._credit=void 0,this._hasAlphaChannel=void 0,this._readyPromise=void 0,this._tags=void 0,this._pickFeaturesTags=void 0,this.enablePickFeatures=!0,this.reinitialize(e)}Object(O.a)(nce.prototype,{url:{get:function(){return this._resource.url}},urlSchemeZeroPadding:{get:function(){return this._urlSchemeZeroPadding}},pickFeaturesUrl:{get:function(){return this._pickFeaturesResource.url}},proxy:{get:function(){return this._resource.proxy}},tileWidth:{get:function(){if(!this.ready)throw new h.a("tileWidth must not be called before the imagery provider is ready.");return this._tileWidth}},tileHeight:{get:function(){if(!this.ready)throw new h.a("tileHeight must not be called before the imagery provider is ready.");return this._tileHeight}},maximumLevel:{get:function(){if(!this.ready)throw new h.a("maximumLevel must not be called before the imagery provider is ready.");return this._maximumLevel}},minimumLevel:{get:function(){if(!this.ready)throw new h.a("minimumLevel must not be called before the imagery provider is ready.");return this._minimumLevel}},tilingScheme:{get:function(){if(!this.ready)throw new h.a("tilingScheme must not be called before the imagery provider is ready.");return this._tilingScheme}},rectangle:{get:function(){if(!this.ready)throw new h.a("rectangle must not be called before the imagery provider is ready.");return this._rectangle}},tileDiscardPolicy:{get:function(){if(!this.ready)throw new h.a("tileDiscardPolicy must not be called before the imagery provider is ready.");return this._tileDiscardPolicy}},errorEvent:{get:function(){return this._errorEvent}},ready:{get:function(){return Object(u.a)(this._resource)}},readyPromise:{get:function(){return this._readyPromise}},credit:{get:function(){if(!this.ready)throw new h.a("credit must not be called before the imagery provider is ready.");return this._credit}},hasAlphaChannel:{get:function(){if(!this.ready)throw new h.a("hasAlphaChannel must not be called before the imagery provider is ready.");return this._hasAlphaChannel}}}),nce.prototype.reinitialize=function(e){var t=this;t._readyPromise=Object(Oi.a)(e).then((function(e){if(!Object(u.a)(e))throw new h.a("options is required.");if(!Object(u.a)(e.url))throw new h.a("options.url is required.");var i=e.customTags,n=Object(ff.a)(tce,i),r=Object(ff.a)(ice,i),a=f.a.createIfNeeded(e.url),o=f.a.createIfNeeded(e.pickFeaturesUrl);t.enablePickFeatures=Object(w.a)(e.enablePickFeatures,t.enablePickFeatures),t._urlSchemeZeroPadding=Object(w.a)(e.urlSchemeZeroPadding,t.urlSchemeZeroPadding),t._tileDiscardPolicy=e.tileDiscardPolicy,t._getFeatureInfoFormats=e.getFeatureInfoFormats,t._subdomains=e.subdomains,Object(ym.a)(t._subdomains)?t._subdomains=t._subdomains.slice():Object(u.a)(t._subdomains)&&t._subdomains.length>0?t._subdomains=t._subdomains.split(""):t._subdomains=["a","b","c"],t._tileWidth=Object(w.a)(e.tileWidth,256),t._tileHeight=Object(w.a)(e.tileHeight,256),t._minimumLevel=Object(w.a)(e.minimumLevel,0),t._maximumLevel=e.maximumLevel,t._tilingScheme=Object(w.a)(e.tilingScheme,new GI({ellipsoid:e.ellipsoid})),t._rectangle=Object(w.a)(e.rectangle,t._tilingScheme.rectangle),t._rectangle=Ve.intersection(t._rectangle,t._tilingScheme.rectangle),t._hasAlphaChannel=Object(w.a)(e.hasAlphaChannel,!0);var s=e.credit;return"string"==typeof s&&(s=new Jo(s)),t._credit=s,t._resource=a,t._tags=n,t._pickFeaturesResource=o,t._pickFeaturesTags=r,!0}))},nce.prototype.getTileCredits=function(e,t,i){if(!this.ready)throw new h.a("getTileCredits must not be called before the imagery provider is ready.")},nce.prototype.requestImage=function(e,t,i,n){if(!this.ready)throw new h.a("requestImage must not be called before the imagery provider is ready.");return fre.loadImage(this,function(e,t,i,n,r){rce=!1,oce=!1;var a=e._resource,o=a.getUrlComponent(!0),s=e._tags,c={},l=o.match(ece);Object(u.a)(l)&&l.forEach((function(r){var a=r.substring(1,r.length-1);Object(u.a)(s[a])&&(c[a]=s[a](e,t,i,n))}));return a.getDerivedResource({request:r,templateValues:c})}(this,e,t,i,n))},nce.prototype.pickFeatures=function(e,t,i,n,r){if(!this.ready)throw new h.a("pickFeatures must not be called before the imagery provider is ready.");if(this.enablePickFeatures&&Object(u.a)(this._pickFeaturesResource)&&0!==this._getFeatureInfoFormats.length){var a=0,o=this;return function c(){if(a>=o._getFeatureInfoFormats.length)return Object(Oi.a)([]);var l=o._getFeatureInfoFormats[a],h=function(e,t,i,n,r,a,o){rce=!1,oce=!1,cce=!1,uce=!1;var s=e._pickFeaturesResource,c=s.getUrlComponent(!0),l=e._pickFeaturesTags,h={},d=c.match(ece);Object(u.a)(d)&&d.forEach((function(s){var c=s.substring(1,s.length-1);Object(u.a)(l[c])&&(h[c]=l[c](e,t,i,n,r,a,o))}));return s.getDerivedResource({templateValues:h})}(o,e,t,i,n,r,l.format);return++a,"json"===l.type?h.fetchJson().then(l.callback).otherwise(c):"xml"===l.type?h.fetchXML().then(l.callback).otherwise(c):"text"===l.type||"html"===l.type?h.fetchText().then(l.callback).otherwise(c):h.fetch({responseType:l.format}).then(s.bind(void 0,l)).otherwise(c)}()}function s(e,t){return e.callback(t)}};var rce=!1,ace=new Ve,oce=!1,sce=new Ve;var cce=!1,lce=new Rt,uce=!1;function hce(e,t,i){if(e&&e.urlSchemeZeroPadding&&e.urlSchemeZeroPadding.hasOwnProperty(t)){var n=e.urlSchemeZeroPadding[t];if("string"==typeof n){var r=n.length;r>1&&(i=i.length>=r?i:new Array(r-i.toString().length+1).join("0")+i)}}return i}function dce(e,t,i,n){rce||(e.tilingScheme.tileXYToRectangle(t,i,n,ace),ace.west=I.toDegrees(ace.west),ace.south=I.toDegrees(ace.south),ace.east=I.toDegrees(ace.east),ace.north=I.toDegrees(ace.north),rce=!0)}function fce(e,t,i,n){oce||(e.tilingScheme.tileXYToNativeRectangle(t,i,n,sce),oce=!0)}var pce=new Ve,mce=new z;function _ce(e,t,i,n,r,a,o){if(!cce){vce(e,t,i,n,r,a);var s=mce,c=e.tilingScheme.tileXYToNativeRectangle(t,i,n,pce);lce.x=e.tileWidth*(s.x-c.west)/c.width|0,lce.y=e.tileHeight*(c.north-s.y)/c.height|0,cce=!0}}var gce=new K;function vce(e,t,i,n,r,a,o){if(!uce){if(e.tilingScheme.projection instanceof se)mce.x=I.toDegrees(r),mce.y=I.toDegrees(a);else{var s=gce;s.longitude=r,s.latitude=a,e.tilingScheme.projection.project(s,mce)}uce=!0}}var bce=nce,yce=new Jo("MapQuest, Open Street Map and contributors, CC-BY-SA");var wce=function(e){e=Object(w.a)(e,{});var t=Object(w.a)(e.url,"https://a.tile.openstreetmap.org/");t=Object(l.a)(t),t+="{z}/{x}/{y}."+Object(w.a)(e.fileExtension,"png");var i=f.a.createIfNeeded(t),n=new GI({ellipsoid:e.ellipsoid}),r=Object(w.a)(e.minimumLevel,0),a=e.maximumLevel,o=Object(w.a)(e.rectangle,n.rectangle),s=n.positionToTileXY(Ve.southwest(o),r),c=n.positionToTileXY(Ve.northeast(o),r),u=(Math.abs(c.x-s.x)+1)*(Math.abs(c.y-s.y)+1);if(u>4)throw new h.a("The rectangle and minimumLevel indicate that there are "+u+" tiles at the minimum level. Imagery providers with more than four tiles at the minimum level are not supported.");var d=Object(w.a)(e.credit,yce);return"string"==typeof d&&(d=new Jo(d)),new bce({url:i,credit:d,tilingScheme:n,tileWidth:256,tileHeight:256,minimumLevel:r,maximumLevel:a,rectangle:o})};var Oce=function(e){var t=[],i=(e=Object(w.a)(e,w.a.EMPTY_OBJECT)).geometry;if(!Object(u.a)(i))throw new h.a("options.geometry is required.");Object(u.a)(i.attributes)&&Object(u.a)(i.primitiveType)||(i=i.constructor.createGeometry(i));var n=i.attributes,r=Be.clone(Object(w.a)(e.modelMatrix,Be.IDENTITY)),a=Object(w.a)(e.length,1e4);if(Object(u.a)(n.normal)&&t.push(new Mu({geometry:id.createLineSegmentsForVectors(i,"normal",a),attributes:{color:new df(1,0,0,1)},modelMatrix:r})),Object(u.a)(n.tangent)&&t.push(new Mu({geometry:id.createLineSegmentsForVectors(i,"tangent",a),attributes:{color:new df(0,1,0,1)},modelMatrix:r})),Object(u.a)(n.bitangent)&&t.push(new Mu({geometry:id.createLineSegmentsForVectors(i,"bitangent",a),attributes:{color:new df(0,0,1,1)},modelMatrix:r})),t.length>0)return new ck({asynchronous:!1,geometryInstances:t,appearance:new $j({flat:!0,translucent:!1})})};var xce=function(e){if(e=Object(w.a)(e,{}),!Object(u.a)(e.url))throw new h.a("options.url is required.");var t,i,n,r=Oi.a.defer(),a=new bce(r.promise);function o(o){for(var s,l,h,d,f=/tileformat/i,p=/tileset/i,m=/tilesets/i,_=/boundingbox/i,g=[],v=o.childNodes[0].childNodes,b=0;b<v.length;b++)if(f.test(v.item(b).nodeName))s=v.item(b);else if(m.test(v.item(b).nodeName)){h=v.item(b);for(var y=v.item(b).childNodes,O=0;O<y.length;O++)p.test(y.item(O).nodeName)&&g.push(y.item(O))}else _.test(v.item(b).nodeName)&&(l=v.item(b));if(!Object(u.a)(h)||!Object(u.a)(l))return d="Unable to find expected tilesets or bbox attributes in "+n.url+".",void((t=uu.handleError(t,a,a.errorEvent,d,void 0,void 0,void 0,c)).retry||r.reject(new Ce.a(d)));var x=Object(w.a)(e.fileExtension,s.getAttribute("extension")),E=Object(w.a)(e.tileWidth,parseInt(s.getAttribute("width"),10)),T=Object(w.a)(e.tileHeight,parseInt(s.getAttribute("height"),10)),C=Object(w.a)(e.minimumLevel,parseInt(g[0].getAttribute("order"),10)),S=Object(w.a)(e.maximumLevel,parseInt(g[g.length-1].getAttribute("order"),10)),A=h.getAttribute("profile"),P=e.tilingScheme;if(!Object(u.a)(P))if("geodetic"===A||"global-geodetic"===A)P=new Nt({ellipsoid:e.ellipsoid});else{if("mercator"!==A&&"global-mercator"!==A)return d=n.url+"specifies an unsupported profile attribute, "+A+".",void((t=uu.handleError(t,a,a.errorEvent,d,void 0,void 0,void 0,c)).retry||r.reject(new Ce.a(d)));P=new GI({ellipsoid:e.ellipsoid})}var I=Ve.clone(e.rectangle);if(!Object(u.a)(I)){var D,j,M,R;Object(w.a)(e.flipXY,!1)?(M=new Rt(parseFloat(l.getAttribute("miny")),parseFloat(l.getAttribute("minx"))),R=new Rt(parseFloat(l.getAttribute("maxy")),parseFloat(l.getAttribute("maxx")))):(M=new Rt(parseFloat(l.getAttribute("minx")),parseFloat(l.getAttribute("miny"))),R=new Rt(parseFloat(l.getAttribute("maxx")),parseFloat(l.getAttribute("maxy"))));var L="geodetic"===A||"mercator"===A;if(P.projection instanceof se||L)D=K.fromDegrees(M.x,M.y),j=K.fromDegrees(R.x,R.y);else{var N=P.projection;D=N.unproject(M),j=N.unproject(R)}I=new Ve(D.longitude,D.latitude,j.longitude,j.latitude)}I.west<P.rectangle.west&&(I.west=P.rectangle.west),I.east>P.rectangle.east&&(I.east=P.rectangle.east),I.south<P.rectangle.south&&(I.south=P.rectangle.south),I.north>P.rectangle.north&&(I.north=P.rectangle.north);var F=P.positionToTileXY(Ve.southwest(I),C),k=P.positionToTileXY(Ve.northeast(I),C);(Math.abs(k.x-F.x)+1)*(Math.abs(k.y-F.y)+1)>4&&(C=0);var B=i.getDerivedResource({url:"{z}/{x}/{reverseY}."+x});r.resolve({url:B,tilingScheme:P,rectangle:I,tileWidth:E,tileHeight:T,minimumLevel:C,maximumLevel:S,tileDiscardPolicy:e.tileDiscardPolicy,credit:e.credit})}function s(t){var n=Object(w.a)(e.fileExtension,"png"),a=Object(w.a)(e.tileWidth,256),o=Object(w.a)(e.tileHeight,256),s=Object(w.a)(e.minimumLevel,0),c=e.maximumLevel,l=Object(u.a)(e.tilingScheme)?e.tilingScheme:new GI({ellipsoid:e.ellipsoid}),h=Object(w.a)(e.rectangle,l.rectangle),d=i.getDerivedResource({url:"{z}/{x}/{reverseY}."+n});r.resolve({url:d,tilingScheme:l,rectangle:h,tileWidth:a,tileHeight:o,minimumLevel:s,maximumLevel:c,tileDiscardPolicy:e.tileDiscardPolicy,credit:e.credit})}function c(){n.fetchXML().then(o).otherwise(s)}return Object(Oi.a)(e.url).then((function(e){(i=f.a.createIfNeeded(e)).appendForwardSlash(),n=i.getDerivedResource({url:"tilemapresource.xml"}),c()})).otherwise((function(e){r.reject(e)})),a};function Ece(e){if(e=Object(w.a)(e,{}),!Object(u.a)(e.url))throw new h.a("options.url is required.");if(!Object(u.a)(e.channel))throw new h.a("options.channel is required.");var t=e.url,i=Object(w.a)(e.path,"/default_map"),n=f.a.createIfNeeded(t).getDerivedResource({url:"/"===i[0]?i.substring(1):i});n.appendForwardSlash(),this._resource=n,this._url=t,this._path=i,this._tileDiscardPolicy=e.tileDiscardPolicy,this._channel=e.channel,this._requestType="ImageryMaps",this._credit=new Jo('<a href="http://www.google.com/enterprise/mapsearth/products/earthenterprise.html"><img src="'+Ece.logoUrl+'" title="Google Imagery"/></a>'),this.defaultGamma=1.9,this._tilingScheme=void 0,this._version=void 0,this._tileWidth=256,this._tileHeight=256,this._maximumLevel=e.maximumLevel,this._errorEvent=new $o.a,this._ready=!1,this._readyPromise=Oi.a.defer();var r,a=n.getDerivedResource({url:"query",queryParameters:{request:"Json",vars:"geeServerDefs",is2d:"t"}}),o=this;function s(t){var i,n,a;try{i=JSON.parse(t)}catch(e){i=JSON.parse(t.replace(/([\[\{,])[\n\r ]*([A-Za-z0-9]+)[\n\r ]*:/g,'$1"$2":'))}for(var s=0;s<i.layers.length;s++)if(i.layers[s].id===o._channel){n=i.layers[s];break}if(!Object(u.a)(n))throw a="Could not find layer with channel (id) of "+o._channel+".",r=uu.handleError(r,o,o._errorEvent,a,void 0,void 0,void 0,l),new Ce.a(a);if(!Object(u.a)(n.version))throw a="Could not find a version in channel (id) "+o._channel+".",r=uu.handleError(r,o,o._errorEvent,a,void 0,void 0,void 0,l),new Ce.a(a);if(o._version=n.version,Object(u.a)(i.projection)&&"flat"===i.projection)o._tilingScheme=new Nt({numberOfLevelZeroTilesX:2,numberOfLevelZeroTilesY:2,rectangle:new Ve(-Math.PI,-Math.PI,Math.PI,Math.PI),ellipsoid:e.ellipsoid});else{if(Object(u.a)(i.projection)&&"mercator"!==i.projection)throw a="Unsupported projection "+i.projection+".",r=uu.handleError(r,o,o._errorEvent,a,void 0,void 0,void 0,l),new Ce.a(a);o._tilingScheme=new GI({numberOfLevelZeroTilesX:2,numberOfLevelZeroTilesY:2,ellipsoid:e.ellipsoid})}o._ready=!0,o._readyPromise.resolve(!0),uu.handleSuccess(r)}function c(e){var t="An error occurred while accessing "+a.url+".";r=uu.handleError(r,o,o._errorEvent,t,void 0,void 0,void 0,l),o._readyPromise.reject(new Ce.a(t))}function l(){var e=a.fetchText();Object(Oi.a)(e,s,c)}l()}Object(O.a)(Ece.prototype,{url:{get:function(){return this._url}},path:{get:function(){return this._path}},proxy:{get:function(){return this._resource.proxy}},channel:{get:function(){return this._channel}},tileWidth:{get:function(){if(!this._ready)throw new h.a("tileWidth must not be called before the imagery provider is ready.");return this._tileWidth}},tileHeight:{get:function(){if(!this._ready)throw new h.a("tileHeight must not be called before the imagery provider is ready.");return this._tileHeight}},maximumLevel:{get:function(){if(!this._ready)throw new h.a("maximumLevel must not be called before the imagery provider is ready.");return this._maximumLevel}},minimumLevel:{get:function(){if(!this._ready)throw new h.a("minimumLevel must not be called before the imagery provider is ready.");return 0}},tilingScheme:{get:function(){if(!this._ready)throw new h.a("tilingScheme must not be called before the imagery provider is ready.");return this._tilingScheme}},version:{get:function(){if(!this._ready)throw new h.a("version must not be called before the imagery provider is ready.");return this._version}},requestType:{get:function(){if(!this._ready)throw new h.a("requestType must not be called before the imagery provider is ready.");return this._requestType}},rectangle:{get:function(){if(!this._ready)throw new h.a("rectangle must not be called before the imagery provider is ready.");return this._tilingScheme.rectangle}},tileDiscardPolicy:{get:function(){if(!this._ready)throw new h.a("tileDiscardPolicy must not be called before the imagery provider is ready.");return this._tileDiscardPolicy}},errorEvent:{get:function(){return this._errorEvent}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise.promise}},credit:{get:function(){return this._credit}},hasAlphaChannel:{get:function(){return!0}}}),Ece.prototype.getTileCredits=function(e,t,i){},Ece.prototype.requestImage=function(e,t,i,n){if(!this._ready)throw new h.a("requestImage must not be called before the imagery provider is ready.");var r=this._resource.getDerivedResource({url:"query",request:n,queryParameters:{request:this._requestType,channel:this._channel,version:this._version,x:e,y:t,z:i+1}});return fre.loadImage(this,r)},Ece.prototype.pickFeatures=function(e,t,i,n,r){},Ece._logoUrl=void 0,Object(O.a)(Ece,{logoUrl:{get:function(){return Object(u.a)(Ece._logoUrl)||(Ece._logoUrl=y("Assets/Images/google_earth_credit.png")),Ece._logoUrl},set:function(e){x.a.defined("value",e),Ece._logoUrl=e}}});var Tce=Ece,Cce=/\/$/,Sce=new Jo('&copy; <a href="https://www.mapbox.com/about/maps/">Mapbox</a> &copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> <strong><a href="https://www.mapbox.com/map-feedback/">Improve this map</a></strong>');function Ace(e){var t=(e=Object(w.a)(e,w.a.EMPTY_OBJECT)).mapId;if(!Object(u.a)(t))throw new h.a("options.mapId is required.");var i=e.url;Object(u.a)(i)||(i="https://{s}.tiles.mapbox.com/v4/"),this._url=i;var n=f.a.createIfNeeded(i),r=Px.getAccessToken(e.accessToken);this._mapId=t,this._accessToken=r,this._accessTokenErrorCredit=Jo.clone(Px.getErrorCredit(e.accessToken));var a=Object(w.a)(e.format,"png");/\./.test(a)||(a="."+a),this._format=a;var o,s=n.getUrlComponent();Cce.test(s)||(s+="/"),s+=t+"/{z}/{x}/{y}"+this._format,n.url=s,n.setQueryParameters({access_token:r}),Object(u.a)(e.credit)?"string"==typeof(o=e.credit)&&(o=new Jo(o)):o=Sce,this._resource=n,this._imageryProvider=new bce({url:n,credit:o,ellipsoid:e.ellipsoid,minimumLevel:e.minimumLevel,maximumLevel:e.maximumLevel,rectangle:e.rectangle})}Object(O.a)(Ace.prototype,{url:{get:function(){return this._url}},ready:{get:function(){return this._imageryProvider.ready}},readyPromise:{get:function(){return this._imageryProvider.readyPromise}},rectangle:{get:function(){return this._imageryProvider.rectangle}},tileWidth:{get:function(){return this._imageryProvider.tileWidth}},tileHeight:{get:function(){return this._imageryProvider.tileHeight}},maximumLevel:{get:function(){return this._imageryProvider.maximumLevel}},minimumLevel:{get:function(){return this._imageryProvider.minimumLevel}},tilingScheme:{get:function(){return this._imageryProvider.tilingScheme}},tileDiscardPolicy:{get:function(){return this._imageryProvider.tileDiscardPolicy}},errorEvent:{get:function(){return this._imageryProvider.errorEvent}},credit:{get:function(){return this._imageryProvider.credit}},proxy:{get:function(){return this._imageryProvider.proxy}},hasAlphaChannel:{get:function(){return this._imageryProvider.hasAlphaChannel}}}),Ace.prototype.getTileCredits=function(e,t,i){if(Object(u.a)(this._accessTokenErrorCredit))return[this._accessTokenErrorCredit]},Ace.prototype.requestImage=function(e,t,i,n){return this._imageryProvider.requestImage(e,t,i,n)},Ace.prototype.pickFeatures=function(e,t,i,n,r){return this._imageryProvider.pickFeatures(e,t,i,n,r)},Ace._defaultCredit=Sce;var Pce=Ace;function Ice(e){if(e=Object(w.a)(e,{}),!Object(u.a)(e.url))throw new h.a("options.url is required.");var t=f.a.createIfNeeded(e.url),i=Object(w.a)(e.rectangle,Ve.MAX_VALUE),n=new Nt({rectangle:i,numberOfLevelZeroTilesX:1,numberOfLevelZeroTilesY:1,ellipsoid:e.ellipsoid});this._tilingScheme=n,this._resource=t,this._image=void 0,this._texture=void 0,this._tileWidth=0,this._tileHeight=0,this._errorEvent=new $o.a,this._ready=!1,this._readyPromise=Oi.a.defer();var r=e.credit;"string"==typeof r&&(r=new Jo(r)),this._credit=r;var a,o=this;function s(e){o._image=e,o._tileWidth=e.width,o._tileHeight=e.height,o._ready=!0,o._readyPromise.resolve(!0),uu.handleSuccess(o._errorEvent)}function c(e){var i="Failed to load image "+t.url+".";a=uu.handleError(a,o,o._errorEvent,i,0,0,0,l,e),o._readyPromise.reject(new Ce.a(i))}function l(){Object(Oi.a)(t.fetchImage(),s,c)}l()}Object(O.a)(Ice.prototype,{url:{get:function(){return this._resource.url}},proxy:{get:function(){return this._resource.proxy}},tileWidth:{get:function(){if(!this._ready)throw new h.a("tileWidth must not be called before the imagery provider is ready.");return this._tileWidth}},tileHeight:{get:function(){if(!this._ready)throw new h.a("tileHeight must not be called before the imagery provider is ready.");return this._tileHeight}},maximumLevel:{get:function(){if(!this._ready)throw new h.a("maximumLevel must not be called before the imagery provider is ready.");return 0}},minimumLevel:{get:function(){if(!this._ready)throw new h.a("minimumLevel must not be called before the imagery provider is ready.");return 0}},tilingScheme:{get:function(){if(!this._ready)throw new h.a("tilingScheme must not be called before the imagery provider is ready.");return this._tilingScheme}},rectangle:{get:function(){return this._tilingScheme.rectangle}},tileDiscardPolicy:{get:function(){if(!this._ready)throw new h.a("tileDiscardPolicy must not be called before the imagery provider is ready.")}},errorEvent:{get:function(){return this._errorEvent}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise.promise}},credit:{get:function(){return this._credit}},hasAlphaChannel:{get:function(){return!0}}}),Ice.prototype.getTileCredits=function(e,t,i){},Ice.prototype.requestImage=function(e,t,i,n){if(!this._ready)throw new h.a("requestImage must not be called before the imagery provider is ready.");return this._image},Ice.prototype.pickFeatures=function(e,t,i,n,r){};var Dce=Ice;function jce(e){for(var t=[],i=e.features,n=0;n<i.length;++n){var r=i[n],a=new lre;if(a.data=r,a.properties=r.properties,a.configureNameFromProperties(r.properties),a.configureDescriptionFromProperties(r.properties),Object(u.a)(r.geometry)&&"Point"===r.geometry.type){var o=r.geometry.coordinates[0],s=r.geometry.coordinates[1];a.position=K.fromDegrees(o,s)}t.push(a)}return t}var Mce="http://www.mapinfo.com/mxp",Rce="http://www.esri.com/wms",Lce="http://www.opengis.net/wfs",Nce="http://www.opengis.net/gml";function Fce(e){var t=e.documentElement;if("MultiFeatureCollection"===t.localName&&t.namespaceURI===Mce)return function(e){for(var t=[],i=e.documentElement.getElementsByTagNameNS(Mce,"Feature"),n=0;n<i.length;++n){for(var r=i[n],a={},o=r.getElementsByTagNameNS(Mce,"Val"),s=0;s<o.length;++s){var c=o[s];if(c.hasAttribute("ref")){var l=c.getAttribute("ref"),u=c.textContent.trim();a[l]=u}}var h=new lre;h.data=r,h.properties=a,h.configureNameFromProperties(a),h.configureDescriptionFromProperties(a),t.push(h)}return t}(e);if("FeatureInfoResponse"===t.localName&&t.namespaceURI===Rce)return function(e){var t,i=e.documentElement,n=[],r=i.getElementsByTagNameNS("*","FIELDS");if(r.length>0)for(var a=0;a<r.length;++a){var o=r[a];t={};for(var s=o.attributes,c=0;c<s.length;++c){var l=s[c];t[l.name]=l.value}n.push(Bce(o,t))}else for(var u=i.getElementsByTagNameNS("*","FeatureInfo"),h=0;h<u.length;++h){var d=u[h];t={};for(var f=d.childNodes,p=0;p<f.length;++p){var m=f[p];m.nodeType===Node.ELEMENT_NODE&&(t[m.localName]=m.textContent)}n.push(Bce(d,t))}return n}(e);if("FeatureCollection"===t.localName&&t.namespaceURI===Lce)return function(e){for(var t=[],i=e.documentElement.getElementsByTagNameNS(Nce,"featureMember"),n=0;n<i.length;++n){var r=i[n],a={};kce(r,a),t.push(Bce(r,a))}return t}(e);if("ServiceExceptionReport"===t.localName)throw new Ce.a((new XMLSerializer).serializeToString(t));return"msGMLOutput"===t.localName?function(e){for(var t,i=[],n=e.documentElement.childNodes,r=0;r<n.length;r++)if(n[r].nodeType===Node.ELEMENT_NODE){t=n[r];break}if(!Object(u.a)(t))throw new Ce.a("Unable to find first child of the feature info xml document");for(var a=t.childNodes,o=0;o<a.length;++o){var s=a[o];if(s.nodeType===Node.ELEMENT_NODE){var c={};kce(s,c),i.push(Bce(s,c))}}return i}(e):function(e){var t=(new XMLSerializer).serializeToString(e),i=document.createElement("div"),n=document.createElement("pre");n.textContent=t,i.appendChild(n);var r=new lre;return r.data=e,r.description=i.innerHTML,[r]}(e)}function kce(e,t){for(var i=!0,n=0;n<e.childNodes.length;++n){var r=e.childNodes[n];r.nodeType===Node.ELEMENT_NODE&&(i=!1),"Point"!==r.localName&&"LineString"!==r.localName&&"Polygon"!==r.localName&&"boundedBy"!==r.localName&&(r.hasChildNodes()&&kce(r,t)&&(t[r.localName]=r.textContent))}return i}function Bce(e,t){var i=new lre;return i.data=e,i.properties=t,i.configureNameFromProperties(t),i.configureDescriptionFromProperties(t),i}var zce=/<body>\s*<\/body>/im,Uce=/<ServiceExceptionReport([\s\S]*)<\/ServiceExceptionReport>/im,Vce=/<title>([\s\S]*)<\/title>/im;function Hce(e){if(!zce.test(e)&&!Uce.test(e)){var t,i=Vce.exec(e);i&&i.length>1&&(t=i[1]);var n=new lre;return n.name=t,n.description=e,n.data=e,[n]}}var Gce=function(e,t,i){if(!Object(u.a)(e))throw new h.a("type is required.");if(this.type=e,!Object(u.a)(t))if("json"===e)t="application/json";else if("xml"===e)t="text/xml";else if("html"===e)t="text/html";else{if("text"!==e)throw new h.a('format is required when type is not "json", "xml", "html", or "text".');t="text/plain"}if(this.format=t,!Object(u.a)(i))if("json"===e)i=jce;else if("xml"===e)i=Fce;else if("html"===e)i=Hce;else{if("text"!==e)throw new h.a('callback is required when type is not "json", "xml", "html", or "text".');i=Hce}this.callback=i};function qce(e){e=Object(w.a)(e,w.a.EMPTY_OBJECT),x.a.typeOf.object("options.clock",e.clock),x.a.typeOf.object("options.times",e.times),x.a.typeOf.func("options.requestImageFunction",e.requestImageFunction),x.a.typeOf.func("options.reloadFunction",e.reloadFunction),this._tileCache={},this._tilesRequestedForInterval=[];var t=this._clock=e.clock;this._times=e.times,this._requestImageFunction=e.requestImageFunction,this._reloadFunction=e.reloadFunction,this._currentIntervalIndex=-1,t.onTick.addEventListener(this._clockOnTick,this),this._clockOnTick(t)}function Wce(e,t,i){return e+"-"+t+"-"+i}function Yce(e){var t=e._times;if(Object(u.a)(t)){var i=e._clock,n=i.currentTime,r=i.canAnimate&&i.shouldAnimate,a=i.multiplier;if(r||0===a){var o,s=t.indexOf(n);if(!(s<0)){var c=t.get(s);return a>0?(o=Tr.secondsDifference(c.stop,n),++s):(o=Tr.secondsDifference(c.start,n),--s),o/=a,s>=0&&o<=5?t.get(s):void 0}}}}function Xce(e,t,i){var n=e._times.indexOf(i.start),r=e._tileCache,a=r[n];Object(u.a)(a)||(a=r[n]={});var o=t.key;if(Object(u.a)(a[o]))return!0;var s=function(e){var t=e.split("-");if(3===t.length)return{x:Number(t[0]),y:Number(t[1]),level:Number(t[2])}}(o),c=new Vl.a({throttle:!0,throttleByServer:!0,type:Hl.a.IMAGERY,priorityFunction:t.priorityFunction}),l=e._requestImageFunction(s.x,s.y,s.level,c,i);return!!Object(u.a)(l)&&(a[o]={promise:l,request:c},!0)}Object(O.a)(qce.prototype,{clock:{get:function(){return this._clock},set:function(e){if(!Object(u.a)(e))throw new h.a("value is required.");this._clock!==e&&(this._clock=e,this._clockOnTick(e),this._reloadFunction())}},times:{get:function(){return this._times},set:function(e){if(!Object(u.a)(e))throw new h.a("value is required.");this._times!==e&&(this._times=e,this._clockOnTick(this._clock),this._reloadFunction())}},currentInterval:{get:function(){return this._times.get(this._currentIntervalIndex)}}}),qce.prototype.getFromCache=function(e,t,i,n){var r,a=Wce(e,t,i),o=this._tileCache[this._currentIntervalIndex];if(Object(u.a)(o)&&Object(u.a)(o[a])){var s=o[a];r=s.promise.otherwise((function(e){throw n.state=s.request.state,e})),delete o[a]}return r},qce.prototype.checkApproachingInterval=function(e,t,i,n){var r=Wce(e,t,i),a=this._tilesRequestedForInterval,o=Yce(this),s={key:r,priorityFunction:n.priorityFunction};Object(u.a)(o)&&Xce(this,s,o)||a.push(s),a.length>=512&&a.splice(0,256)},qce.prototype._clockOnTick=function(e){var t=e.currentTime,i=this._times.indexOf(t),n=this._currentIntervalIndex;if(i!==n){var r=this._tileCache[n];for(var a in r)r.hasOwnProperty(a)&&r[a].request.cancel();return delete this._tileCache[n],this._tilesRequestedForInterval=[],this._currentIntervalIndex=i,void this._reloadFunction()}var o=Yce(this);if(Object(u.a)(o))for(var s=this._tilesRequestedForInterval,c=!0;c&&0!==s.length;){var l=s.pop();(c=Xce(this,l,o))||s.push(l)}};var Zce=qce;function Qce(e){if(e=Object(w.a)(e,w.a.EMPTY_OBJECT),!Object(u.a)(e.url))throw new h.a("options.url is required.");if(!Object(u.a)(e.layers))throw new h.a("options.layers is required.");if(Object(u.a)(e.times)&&!Object(u.a)(e.clock))throw new h.a("options.times was specified, so options.clock is required.");var t=f.a.createIfNeeded(e.url),i=t.clone();t.setQueryParameters(Qce.DefaultParameters,!0),i.setQueryParameters(Qce.GetFeatureInfoDefaultParameters,!0),Object(u.a)(e.parameters)&&t.setQueryParameters(Jce(e.parameters)),Object(u.a)(e.getFeatureInfoParameters)&&i.setQueryParameters(Jce(e.getFeatureInfoParameters));var n=this;this._reload=void 0,Object(u.a)(e.times)&&(this._timeDynamicImagery=new Zce({clock:e.clock,times:e.times,requestImageFunction:function(e,t,i,r,a){return Kce(n,e,t,i,r,a)},reloadFunction:function(){Object(u.a)(n._reload)&&n._reload()}}));var r={};r.layers=e.layers,r.bbox="{westProjected},{southProjected},{eastProjected},{northProjected}",r.width="{width}",r.height="{height}",parseFloat(t.queryParameters.version)>=1.3?r.crs=Object(w.a)(e.crs,e.tilingScheme&&e.tilingScheme.projection instanceof Qc?"EPSG:3857":"CRS:84"):r.srs=Object(w.a)(e.srs,e.tilingScheme&&e.tilingScheme.projection instanceof Qc?"EPSG:3857":"EPSG:4326"),t.setQueryParameters(r,!0),i.setQueryParameters(r,!0);var a={query_layers:e.layers,x:"{i}",y:"{j}",info_format:"{format}"};i.setQueryParameters(a,!0),this._resource=t,this._pickFeaturesResource=i,this._layers=e.layers,this._tileProvider=new bce({url:t,pickFeaturesUrl:i,tilingScheme:Object(w.a)(e.tilingScheme,new Nt({ellipsoid:e.ellipsoid})),rectangle:e.rectangle,tileWidth:e.tileWidth,tileHeight:e.tileHeight,minimumLevel:e.minimumLevel,maximumLevel:e.maximumLevel,subdomains:e.subdomains,tileDiscardPolicy:e.tileDiscardPolicy,credit:e.credit,getFeatureInfoFormats:Object(w.a)(e.getFeatureInfoFormats,Qce.DefaultGetFeatureInfoFormats),enablePickFeatures:e.enablePickFeatures})}function Kce(e,t,i,n,r,a){var o=Object(u.a)(a)?a.data:void 0,s=e._tileProvider;return Object(u.a)(o)&&s._resource.setQueryParameters(o),s.requestImage(t,i,n,r)}function Jce(e){var t={};for(var i in e)e.hasOwnProperty(i)&&(t[i.toLowerCase()]=e[i]);return t}Object(O.a)(Qce.prototype,{url:{get:function(){return this._resource._url}},proxy:{get:function(){return this._resource.proxy}},layers:{get:function(){return this._layers}},tileWidth:{get:function(){return this._tileProvider.tileWidth}},tileHeight:{get:function(){return this._tileProvider.tileHeight}},maximumLevel:{get:function(){return this._tileProvider.maximumLevel}},minimumLevel:{get:function(){return this._tileProvider.minimumLevel}},tilingScheme:{get:function(){return this._tileProvider.tilingScheme}},rectangle:{get:function(){return this._tileProvider.rectangle}},tileDiscardPolicy:{get:function(){return this._tileProvider.tileDiscardPolicy}},errorEvent:{get:function(){return this._tileProvider.errorEvent}},ready:{get:function(){return this._tileProvider.ready}},readyPromise:{get:function(){return this._tileProvider.readyPromise}},credit:{get:function(){return this._tileProvider.credit}},hasAlphaChannel:{get:function(){return this._tileProvider.hasAlphaChannel}},enablePickFeatures:{get:function(){return this._tileProvider.enablePickFeatures},set:function(e){this._tileProvider.enablePickFeatures=e}},clock:{get:function(){return this._timeDynamicImagery.clock},set:function(e){this._timeDynamicImagery.clock=e}},times:{get:function(){return this._timeDynamicImagery.times},set:function(e){this._timeDynamicImagery.times=e}}}),Qce.prototype.getTileCredits=function(e,t,i){return this._tileProvider.getTileCredits(e,t,i)},Qce.prototype.requestImage=function(e,t,i,n){var r,a,o=this._timeDynamicImagery;return Object(u.a)(o)&&(a=o.currentInterval,r=o.getFromCache(e,t,i,n)),Object(u.a)(r)||(r=Kce(this,e,t,i,n,a)),Object(u.a)(r)&&Object(u.a)(o)&&o.checkApproachingInterval(e,t,i,n),r},Qce.prototype.pickFeatures=function(e,t,i,n,r){var a=this._timeDynamicImagery;return function(e,t,i,n,r,a,o){var s=Object(u.a)(o)?o.data:void 0,c=e._tileProvider;return Object(u.a)(s)&&c._pickFeaturesResource.setQueryParameters(s),c.pickFeatures(t,i,n,r,a)}(this,e,t,i,n,r,Object(u.a)(a)?a.currentInterval:void 0)},Qce.DefaultParameters=Object(E.a)({service:"WMS",version:"1.1.1",request:"GetMap",styles:"",format:"image/jpeg"}),Qce.GetFeatureInfoDefaultParameters=Object(E.a)({service:"WMS",version:"1.1.1",request:"GetFeatureInfo"}),Qce.DefaultGetFeatureInfoFormats=Object(E.a)([Object(E.a)(new Gce("json","application/json")),Object(E.a)(new Gce("xml","text/xml")),Object(E.a)(new Gce("text","text/html"))]);var $ce=Qce,ele=Object(E.a)({service:"WMTS",version:"1.0.0",request:"GetTile"});function tle(e){if(e=Object(w.a)(e,w.a.EMPTY_OBJECT),!Object(u.a)(e.url))throw new h.a("options.url is required.");if(!Object(u.a)(e.layer))throw new h.a("options.layer is required.");if(!Object(u.a)(e.style))throw new h.a("options.style is required.");if(!Object(u.a)(e.tileMatrixSetID))throw new h.a("options.tileMatrixSetID is required.");if(Object(u.a)(e.times)&&!Object(u.a)(e.clock))throw new h.a("options.times was specified, so options.clock is required.");var t=f.a.createIfNeeded(e.url),i=e.style,n=e.tileMatrixSetID;if(t.url.indexOf("{")>=0){var r={style:i,Style:i,TileMatrixSet:n};t.setTemplateValues(r),this._useKvp=!1}else t.setQueryParameters(ele),this._useKvp=!0;this._resource=t,this._layer=e.layer,this._style=i,this._tileMatrixSetID=n,this._tileMatrixLabels=e.tileMatrixLabels,this._format=Object(w.a)(e.format,"image/jpeg"),this._tileDiscardPolicy=e.tileDiscardPolicy,this._tilingScheme=Object(u.a)(e.tilingScheme)?e.tilingScheme:new GI({ellipsoid:e.ellipsoid}),this._tileWidth=Object(w.a)(e.tileWidth,256),this._tileHeight=Object(w.a)(e.tileHeight,256),this._minimumLevel=Object(w.a)(e.minimumLevel,0),this._maximumLevel=e.maximumLevel,this._rectangle=Object(w.a)(e.rectangle,this._tilingScheme.rectangle),this._dimensions=e.dimensions;var a=this;this._reload=void 0,Object(u.a)(e.times)&&(this._timeDynamicImagery=new Zce({clock:e.clock,times:e.times,requestImageFunction:function(e,t,i,n,r){return ile(a,e,t,i,n,r)},reloadFunction:function(){Object(u.a)(a._reload)&&a._reload()}})),this._readyPromise=Oi.a.resolve(!0);var o=this._tilingScheme.positionToTileXY(Ve.southwest(this._rectangle),this._minimumLevel),s=this._tilingScheme.positionToTileXY(Ve.northeast(this._rectangle),this._minimumLevel),c=(Math.abs(s.x-o.x)+1)*(Math.abs(s.y-o.y)+1);if(c>4)throw new h.a("The imagery provider's rectangle and minimumLevel indicate that there are "+c+" tiles at the minimum level. Imagery providers with more than four tiles at the minimum level are not supported.");this._errorEvent=new $o.a;var l=e.credit;this._credit="string"==typeof l?new Jo(l):l,this._subdomains=e.subdomains,Object(ym.a)(this._subdomains)?this._subdomains=this._subdomains.slice():Object(u.a)(this._subdomains)&&this._subdomains.length>0?this._subdomains=this._subdomains.split(""):this._subdomains=["a","b","c"]}function ile(e,t,i,n,r,a){var o,s=e._tileMatrixLabels,c=Object(u.a)(s)?s[n]:n.toString(),l=e._subdomains,h=e._dimensions,d=Object(u.a)(a)?a.data:void 0;if(e._useKvp){var f={};f.tilematrix=c,f.layer=e._layer,f.style=e._style,f.tilerow=i,f.tilecol=t,f.tilematrixset=e._tileMatrixSetID,f.format=e._format,Object(u.a)(h)&&(f=Object(ff.a)(f,h)),Object(u.a)(d)&&(f=Object(ff.a)(f,d)),o=e._resource.getDerivedResource({queryParameters:f,request:r})}else{var p={TileMatrix:c,TileRow:i.toString(),TileCol:t.toString(),s:l[(t+i+n)%l.length]};(o=e._resource.getDerivedResource({request:r})).setTemplateValues(p),Object(u.a)(h)&&o.setTemplateValues(h),Object(u.a)(d)&&o.setTemplateValues(d)}return fre.loadImage(e,o)}Object(O.a)(tle.prototype,{url:{get:function(){return this._resource.url}},proxy:{get:function(){return this._resource.proxy}},tileWidth:{get:function(){return this._tileWidth}},tileHeight:{get:function(){return this._tileHeight}},maximumLevel:{get:function(){return this._maximumLevel}},minimumLevel:{get:function(){return this._minimumLevel}},tilingScheme:{get:function(){return this._tilingScheme}},rectangle:{get:function(){return this._rectangle}},tileDiscardPolicy:{get:function(){return this._tileDiscardPolicy}},errorEvent:{get:function(){return this._errorEvent}},format:{get:function(){return this._format}},ready:{value:!0},readyPromise:{get:function(){return this._readyPromise}},credit:{get:function(){return this._credit}},hasAlphaChannel:{get:function(){return!0}},clock:{get:function(){return this._timeDynamicImagery.clock},set:function(e){this._timeDynamicImagery.clock=e}},times:{get:function(){return this._timeDynamicImagery.times},set:function(e){this._timeDynamicImagery.times=e}},dimensions:{get:function(){return this._dimensions},set:function(e){this._dimensions!==e&&(this._dimensions=e,Object(u.a)(this._reload)&&this._reload())}}}),tle.prototype.getTileCredits=function(e,t,i){},tle.prototype.requestImage=function(e,t,i,n){var r,a,o=this._timeDynamicImagery;return Object(u.a)(o)&&(a=o.currentInterval,r=o.getFromCache(e,t,i,n)),Object(u.a)(r)||(r=ile(this,e,t,i,n,a)),Object(u.a)(r)&&Object(u.a)(o)&&o.checkApproachingInterval(e,t,i,n),r},tle.prototype.pickFeatures=function(e,t,i,n,r){};var nle=tle;function rle(e){return function(t){return new e(t)}}var ale={ARCGIS_MAPSERVER:rle(_re),BING:rle(Are),GOOGLE_EARTH:rle(Tce),MAPBOX:rle(Pce),SINGLE_TILE:rle(Dce),TMS:xce,URL_TEMPLATE:rle(bce),WMS:rle($ce),WMTS:rle(nle)};function ole(e){e=Object(w.a)(e,w.a.EMPTY_OBJECT),x.a.typeOf.number("options.assetId",e.assetId);var t=Bg._createEndpointResource(e.assetId,e);this.defaultAlpha=void 0,this.defaultBrightness=void 0,this.defaultContrast=void 0,this.defaultHue=void 0,this.defaultSaturation=void 0,this.defaultGamma=void 0,this.defaultMinificationFilter=void 0,this.defaultMagnificationFilter=void 0,this._ready=!1,this._tileCredits=void 0,this._errorEvent=new $o.a;var i=this;this._readyPromise=t.fetchJson().then((function(n){if("IMAGERY"!==n.type)return Oi.a.reject(new Ce.a("Cesium ion asset "+e.assetId+" is not an imagery asset."));var r,a=n.externalType;if(Object(u.a)(a)){var o=ale[a];if(!Object(u.a)(o))return Oi.a.reject(new Ce.a("Unrecognized Cesium ion imagery type: "+a));r=o(n.options)}else r=xce({url:new Bg(n,t)});return i._tileCredits=Bg.getCreditsFromEndpoint(n,t),r.errorEvent.addEventListener((function(e){e.provider=i,i._errorEvent.raiseEvent(e)})),i._imageryProvider=r,r.readyPromise.then((function(){return i._ready=!0,!0}))}))}Object(O.a)(ole.prototype,{ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise}},rectangle:{get:function(){if(!this._ready)throw new h.a("tileHeight must not be called before the imagery provider is ready.");return this._imageryProvider.rectangle}},tileWidth:{get:function(){if(!this._ready)throw new h.a("tileWidth must not be called before the imagery provider is ready.");return this._imageryProvider.tileWidth}},tileHeight:{get:function(){if(!this._ready)throw new h.a("tileHeight must not be called before the imagery provider is ready.");return this._imageryProvider.tileHeight}},maximumLevel:{get:function(){if(!this._ready)throw new h.a("maximumLevel must not be called before the imagery provider is ready.");return this._imageryProvider.maximumLevel}},minimumLevel:{get:function(){if(!this._ready)throw new h.a("minimumLevel must not be called before the imagery provider is ready.");return this._imageryProvider.minimumLevel}},tilingScheme:{get:function(){if(!this._ready)throw new h.a("tilingScheme must not be called before the imagery provider is ready.");return this._imageryProvider.tilingScheme}},tileDiscardPolicy:{get:function(){if(!this._ready)throw new h.a("tileDiscardPolicy must not be called before the imagery provider is ready.");return this._imageryProvider.tileDiscardPolicy}},errorEvent:{get:function(){return this._errorEvent}},credit:{get:function(){if(!this._ready)throw new h.a("credit must not be called before the imagery provider is ready.");return this._imageryProvider.credit}},hasAlphaChannel:{get:function(){if(!this._ready)throw new h.a("hasAlphaChannel must not be called before the imagery provider is ready.");return this._imageryProvider.hasAlphaChannel}}}),ole.prototype.getTileCredits=function(e,t,i){if(!this._ready)throw new h.a("getTileCredits must not be called before the imagery provider is ready.");var n=this._imageryProvider.getTileCredits(e,t,i);return Object(u.a)(n)?this._tileCredits.concat(n):this._tileCredits},ole.prototype.requestImage=function(e,t,i,n){if(!this._ready)throw new h.a("requestImage must not be called before the imagery provider is ready.");return this._imageryProvider.requestImage(e,t,i,n)},ole.prototype.pickFeatures=function(e,t,i,n,r){if(!this._ready)throw new h.a("pickFeatures must not be called before the imagery provider is ready.");return this._imageryProvider.pickFeatures(e,t,i,n,r)};var sle=ole,cle=Object(E.a)({AERIAL:2,AERIAL_WITH_LABELS:3,ROAD:4});var lle=function(e){e=Object(w.a)(e,w.a.EMPTY_OBJECT);var t=Object(w.a)(e.style,cle.AERIAL);return new sle({assetId:t})},ule=576,hle=100,dle="#ffffff",fle="#48b";var ple,mle="cesium-credit-delimiter";function _le(e){var t=document.createElement("span");return t.textContent=e,t.className=mle,t}function gle(e,t){if(Object(u.a)(t)){var i=document.createElement(t);i._creditId=e._creditId,i.appendChild(e),e=i}return e}function vle(e,t,i,n){for(var r=e.childNodes,a=-1,o=0;o<t.length;++o){var s=t[o];if(Object(u.a)(s)){if(a=o,Object(u.a)(i)&&(a*=2,o>0)){var c=a-1;if(r.length<=c)e.appendChild(_le(i));else{var l=r[c];l.className!==mle&&e.replaceChild(_le(i),l)}}var h=s.element;if(r.length<=a)e.appendChild(gle(h,n));else{var d=r[a];d._creditId!==s._id&&e.replaceChild(gle(h,n),d)}}}for(++a;a<r.length;)e.removeChild(r[a])}function ble(e,t){var i=e+" {";for(var n in t)t.hasOwnProperty(n)&&(i+=n+": "+t[n]+"; ");return i+=" }\n"}function yle(e,t,i){x.a.defined("container",e);var n=this;i=Object(w.a)(i,document.body);var r=document.createElement("div");r.className="cesium-credit-lightbox-overlay",i.appendChild(r);var a=document.createElement("div");function o(e){a.contains(e.target)||n.hideLightbox()}a.className="cesium-credit-lightbox",r.appendChild(a),r.addEventListener("click",o,!1);var s=document.createElement("div");s.className="cesium-credit-lightbox-title",s.textContent="Data provided by:",a.appendChild(s);var c=document.createElement("a");c.onclick=this.hideLightbox.bind(this),c.innerHTML="&times;",c.className="cesium-credit-lightbox-close",a.appendChild(c);var l=document.createElement("ul");a.appendChild(l);var u=document.createElement("div");u.className="cesium-credit-logoContainer",u.style.display="inline",e.appendChild(u);var h=document.createElement("div");h.className="cesium-credit-textContainer",h.style.display="inline",e.appendChild(h);var d=document.createElement("a");d.className="cesium-credit-expand-link",d.onclick=this.showLightbox.bind(this),d.textContent="Data attribution",e.appendChild(d),function(){var e="";e+=ble(".cesium-credit-lightbox-overlay",{display:"none","z-index":"1",position:"absolute",top:"0",left:"0",width:"100%",height:"100%","background-color":"rgba(80, 80, 80, 0.8)"}),e+=ble(".cesium-credit-lightbox",{"background-color":"#303336",color:dle,position:"relative","min-height":hle+"px",margin:"auto"}),e+=ble(".cesium-credit-lightbox > ul > li a, .cesium-credit-lightbox > ul > li a:visited",{color:dle}),e+=ble(".cesium-credit-lightbox > ul > li a:hover",{color:fle}),e+=ble(".cesium-credit-lightbox.cesium-credit-lightbox-expanded",{border:"1px solid #444","border-radius":"5px","max-width":"370px"}),e+=ble(".cesium-credit-lightbox.cesium-credit-lightbox-mobile",{height:"100%",width:"100%"}),e+=ble(".cesium-credit-lightbox-title",{padding:"20px 20px 0 20px"}),e+=ble(".cesium-credit-lightbox-close",{"font-size":"18pt",cursor:"pointer",position:"absolute",top:"0",right:"6px",color:dle}),e+=ble(".cesium-credit-lightbox-close:hover",{color:fle}),e+=ble(".cesium-credit-lightbox > ul",{margin:"0",padding:"12px 20px 12px 40px","font-size":"13px"}),e+=ble(".cesium-credit-lightbox > ul > li",{"padding-bottom":"6px"}),e+=ble(".cesium-credit-lightbox > ul > li *",{padding:"0",margin:"0"}),e+=ble(".cesium-credit-expand-link",{"padding-left":"5px",cursor:"pointer","text-decoration":"underline",color:dle}),e+=ble(".cesium-credit-expand-link:hover",{color:fle}),e+=ble(".cesium-credit-text",{color:dle}),e+=ble(".cesium-credit-textContainer *, .cesium-credit-logoContainer *",{display:"inline"});var t=document.head,i=document.createElement("style");i.innerHTML=e,t.insertBefore(i,t.firstChild)}();var f=Jo.clone(yle.cesiumCredit);this._delimiter=Object(w.a)(t," • "),this._screenContainer=h,this._cesiumCreditContainer=u,this._lastViewportHeight=void 0,this._lastViewportWidth=void 0,this._lightboxCredits=a,this._creditList=l,this._lightbox=r,this._hideLightbox=o,this._expandLink=d,this._expanded=!1,this._defaultCredits=[],this._cesiumCredit=f,this._previousCesiumCredit=void 0,this._currentCesiumCredit=f,this._currentFrameCredits={screenCredits:new Fi,lightboxCredits:new Fi},this._defaultCredit=void 0,this.viewport=i,this.container=e}function wle(){if(!Object(u.a)(ple)){var e=y("Assets/Images/ion-credit.png");ple=new Jo('<a href="https://cesium.com/" target="_blank"><img src="'+e+'" title="Cesium ion"/></a>',!0)}return yle._cesiumCreditInitialized||(yle._cesiumCredit=ple,yle._cesiumCreditInitialized=!0),ple}yle.prototype.addCredit=function(e){if(x.a.defined("credit",e),e._isIon)return Object(u.a)(this._defaultCredit)||(this._defaultCredit=Jo.clone(wle())),void(this._currentCesiumCredit=this._defaultCredit);e.showOnScreen?this._currentFrameCredits.screenCredits.set(e.id,e):this._currentFrameCredits.lightboxCredits.set(e.id,e)},yle.prototype.addDefaultCredit=function(e){x.a.defined("credit",e);var t=this._defaultCredits;(function(e,t){for(var i=e.length,n=0;n<i;n++){var r=e[n];if(Jo.equals(r,t))return!0}return!1})(t,e)||t.push(e)},yle.prototype.removeDefaultCredit=function(e){x.a.defined("credit",e);var t=this._defaultCredits,i=t.indexOf(e);-1!==i&&t.splice(i,1)},yle.prototype.showLightbox=function(){this._lightbox.style.display="block",this._expanded=!0},yle.prototype.hideLightbox=function(){this._lightbox.style.display="none",this._expanded=!1},yle.prototype.update=function(){var e,t,i,n;this._expanded&&(t=(e=this)._lightboxCredits,i=e.viewport.clientWidth,n=e.viewport.clientHeight,i!==e._lastViewportWidth&&(i<ule?(t.className="cesium-credit-lightbox cesium-credit-lightbox-mobile",t.style.marginTop="0"):(t.className="cesium-credit-lightbox cesium-credit-lightbox-expanded",t.style.marginTop=Math.floor(.5*(n-t.clientHeight))+"px"),e._lastViewportWidth=i),i>=ule&&n!==e._lastViewportHeight&&(t.style.marginTop=Math.floor(.5*(n-t.clientHeight))+"px",e._lastViewportHeight=n))},yle.prototype.beginFrame=function(){var e=this._currentFrameCredits,t=e.screenCredits;t.removeAll();for(var i=this._defaultCredits,n=0;n<i.length;++n){var r=i[n];t.set(r.id,r)}e.lightboxCredits.removeAll(),Jo.equals(yle.cesiumCredit,this._cesiumCredit)||(this._cesiumCredit=Jo.clone(yle.cesiumCredit)),this._currentCesiumCredit=this._cesiumCredit},yle.prototype.endFrame=function(){var e=this._currentFrameCredits.screenCredits.values;vle(this._screenContainer,e,this._delimiter,void 0);var t,i,n,r=this._currentFrameCredits.lightboxCredits.values;this._expandLink.style.display=r.length>0?"inline":"none",vle(this._creditList,r,void 0,"li"),i=(t=this)._previousCesiumCredit,n=t._currentCesiumCredit,Jo.equals(n,i)||(Object(u.a)(i)&&t._cesiumCreditContainer.removeChild(i.element),Object(u.a)(n)&&t._cesiumCreditContainer.appendChild(n.element),t._previousCesiumCredit=n)},yle.prototype.destroy=function(){return this._lightbox.removeEventListener("click",this._hideLightbox,!1),this.container.removeChild(this._cesiumCreditContainer),this.container.removeChild(this._screenContainer),this.container.removeChild(this._expandLink),this.viewport.removeChild(this._lightbox),rl(this)},yle.prototype.isDestroyed=function(){return!1},yle._cesiumCredit=void 0,yle._cesiumCreditInitialized=!1,Object(O.a)(yle,{cesiumCredit:{get:function(){return wle(),yle._cesiumCredit},set:function(e){yle._cesiumCredit=e,yle._cesiumCreditInitialized=!0}}});var Ole=yle;function xle(e){var t=(e=Object(w.a)(e,w.a.EMPTY_OBJECT)).attributeName,i=e.perInstanceAttribute;if(!Object(u.a)(t))throw new h.a("options.attributeName is required.");Object(u.a)(i)||(i=!1);var n,r=Object(w.a)(e.glslDatatype,"vec3"),a="v_"+t;if("normal"===t||"tangent"===t||"bitangent"===t)n="vec4 getColor() { return vec4(("+a+" + vec3(1.0)) * 0.5, 1.0); }\n";else switch("st"===t&&(r="vec2"),r){case"float":n="vec4 getColor() { return vec4(vec3("+a+"), 1.0); }\n";break;case"vec2":n="vec4 getColor() { return vec4("+a+", 0.0, 1.0); }\n";break;case"vec3":n="vec4 getColor() { return vec4("+a+", 1.0); }\n";break;case"vec4":n="vec4 getColor() { return "+a+"; }\n";break;default:throw new h.a("options.glslDatatype must be float, vec2, vec3, or vec4.")}var o="attribute vec3 position3DHigh;\nattribute vec3 position3DLow;\nattribute float batchId;\n"+(i?"":"attribute "+r+" "+t+";\n")+"varying "+r+" "+a+";\nvoid main()\n{\nvec4 p = czm_translateRelativeToEye(position3DHigh, position3DLow);\n"+(i?a+" = czm_batchTable_"+t+"(batchId);\n":a+" = "+t+";\n")+"gl_Position = czm_modelViewProjectionRelativeToEye * p;\n}",s="varying "+r+" "+a+";\n"+n+"\nvoid main()\n{\ngl_FragColor = getColor();\n}";this.material=void 0,this.translucent=Object(w.a)(e.translucent,!1),this._vertexShaderSource=Object(w.a)(e.vertexShaderSource,o),this._fragmentShaderSource=Object(w.a)(e.fragmentShaderSource,s),this._renderState=UD.getDefaultRenderState(!1,!1,e.renderState),this._closed=Object(w.a)(e.closed,!1),this._attributeName=t,this._glslDatatype=r}Object(O.a)(xle.prototype,{vertexShaderSource:{get:function(){return this._vertexShaderSource}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},renderState:{get:function(){return this._renderState}},closed:{get:function(){return this._closed}},attributeName:{get:function(){return this._attributeName}},glslDatatype:{get:function(){return this._glslDatatype}}}),xle.prototype.getFragmentShaderSource=UD.prototype.getFragmentShaderSource,xle.prototype.isTranslucent=UD.prototype.isTranslucent,xle.prototype.getRenderState=UD.prototype.getRenderState;var Ele=xle;function Tle(e){if(e=Object(w.a)(e,w.a.EMPTY_OBJECT),!Object(u.a)(e.camera))throw new h.a("options.camera is required.");this._camera=e.camera,this._color=Object(w.a)(e.color,uf.CYAN),this._updateOnChange=Object(w.a)(e.updateOnChange,!0),this.show=Object(w.a)(e.show,!0),this.id=e.id,this._id=void 0,this._outlinePrimitives=[],this._planesPrimitives=[]}var Cle=new z,Sle=new be,Ale=new Kn,Ple=new wb,Ile=new vb,Dle=new hb,jle=new cb,Mle=new uf,Rle=[1,1e5];Tle.prototype.update=function(e){if(this.show){var t,i,n=this._planesPrimitives,r=this._outlinePrimitives;if(this._updateOnChange){for(i=n.length,t=0;t<i;++t)r[t]=r[t]&&r[t].destroy(),n[t]=n[t]&&n[t].destroy();n.length=0,r.length=0}if(0===n.length){var a,o=this._camera,s=o.frustum;a=s instanceof wb?Ple:s instanceof vb?Ile:s instanceof hb?Dle:jle,a=s.clone(a);var c=e.frustumSplits,l=c.length-1;l<=0&&((c=Rle)[0]=this._camera.frustum.near,c[1]=this._camera.frustum.far,l=1);var u=o.positionWC,h=o.directionWC,d=o.upWC,f=o.rightWC;f=z.negate(f,Cle);var p=Sle;be.setColumn(p,0,f,p),be.setColumn(p,1,d,p),be.setColumn(p,2,h,p);var m=Kn.fromRotationMatrix(p,Ale);for(n.length=r.length=l,t=0;t<l;++t)a.near=c[t],a.far=c[t+1],n[t]=new ck({geometryInstances:new Mu({geometry:new Gb({origin:u,orientation:m,frustum:a,_drawNearPlane:0===t}),attributes:{color:df.fromColor(uf.fromAlpha(this._color,.1,Mle))},id:this.id,pickPrimitive:this}),appearance:new $j({translucent:!0,flat:!0}),asynchronous:!1}),r[t]=new ck({geometryInstances:new Mu({geometry:new Jb({origin:u,orientation:m,frustum:a,_drawNearPlane:0===t}),attributes:{color:df.fromColor(this._color)},id:this.id,pickPrimitive:this}),appearance:new $j({translucent:!1,flat:!0}),asynchronous:!1})}for(i=n.length,t=0;t<i;++t)r[t].update(e),n[t].update(e)}},Tle.prototype.isDestroyed=function(){return!1},Tle.prototype.destroy=function(){for(var e=this._planesPrimitives.length,t=0;t<e;++t)this._outlinePrimitives[t]=this._outlinePrimitives[t]&&this._outlinePrimitives[t].destroy(),this._planesPrimitives[t]=this._planesPrimitives[t]&&this._planesPrimitives[t].destroy();return rl(this)};var Lle=Tle;function Nle(e){e=Object(w.a)(e,w.a.EMPTY_OBJECT),this.length=Object(w.a)(e.length,1e7),this._length=void 0,this.width=Object(w.a)(e.width,2),this._width=void 0,this.show=Object(w.a)(e.show,!0),this.modelMatrix=Be.clone(Object(w.a)(e.modelMatrix,Be.IDENTITY)),this._modelMatrix=new Be,this.id=e.id,this._id=void 0,this._primitive=void 0}Nle.prototype.update=function(e){if(this.show){if(!Object(u.a)(this._primitive)||!Be.equals(this._modelMatrix,this.modelMatrix)||this._length!==this.length||this._width!==this.width||this._id!==this.id){this._modelMatrix=Be.clone(this.modelMatrix,this._modelMatrix),this._length=this.length,this._width=this.width,this._id=this.id,Object(u.a)(this._primitive)&&this._primitive.destroy(),0===this.modelMatrix[12]&&0===this.modelMatrix[13]&&0===this.modelMatrix[14]&&(this.modelMatrix[14]=.01);var t=new Mu({geometry:new PT({positions:[z.ZERO,z.UNIT_X],width:this.width,vertexFormat:TB.VERTEX_FORMAT,colors:[uf.RED,uf.RED],arcType:Zt.NONE}),modelMatrix:Be.multiplyByUniformScale(this.modelMatrix,this.length,new Be),id:this.id,pickPrimitive:this}),i=new Mu({geometry:new PT({positions:[z.ZERO,z.UNIT_Y],width:this.width,vertexFormat:TB.VERTEX_FORMAT,colors:[uf.GREEN,uf.GREEN],arcType:Zt.NONE}),modelMatrix:Be.multiplyByUniformScale(this.modelMatrix,this.length,new Be),id:this.id,pickPrimitive:this}),n=new Mu({geometry:new PT({positions:[z.ZERO,z.UNIT_Z],width:this.width,vertexFormat:TB.VERTEX_FORMAT,colors:[uf.BLUE,uf.BLUE],arcType:Zt.NONE}),modelMatrix:Be.multiplyByUniformScale(this.modelMatrix,this.length,new Be),id:this.id,pickPrimitive:this});this._primitive=new ck({geometryInstances:[t,i,n],appearance:new TB,asynchronous:!1})}this._primitive.update(e)}},Nle.prototype.isDestroyed=function(){return!1},Nle.prototype.destroy=function(){return this._primitive=this._primitive&&this._primitive.destroy(),rl(this)};var Fle=Nle,kle="varying vec4 positionEC;\nvoid main()\n{\nczm_ellipsoid ellipsoid = czm_getWgs84EllipsoidEC();\nvec3 direction = normalize(positionEC.xyz);\nczm_ray ray = czm_ray(vec3(0.0), direction);\nczm_raySegment intersection = czm_rayEllipsoidIntersectionInterval(ray, ellipsoid);\nif (!czm_isEmpty(intersection))\n{\ngl_FragColor = vec4(1.0, 1.0, 0.0, 1.0);\n}\nelse\n{\ndiscard;\n}\nczm_writeLogDepth();\n}\n",Ble="attribute vec4 position;\nvarying vec4 positionEC;\nvoid main()\n{\npositionEC = czm_modelView * position;\ngl_Position = czm_projection * positionEC;\nczm_vertexLogDepth();\n}\n";function zle(){this._rs=void 0,this._sp=void 0,this._va=void 0,this._command=void 0,this._mode=void 0,this._useLogDepth=!1}var Ule=Ri.supportsTypedArrays()?new Float32Array(12):[],Vle=new z,Hle=new z,Gle=new z,qle=new z;zle.prototype.update=function(e){if(this._mode=e.mode,e.mode===xF.SCENE3D){var t=e.context,i=e.mapProjection.ellipsoid,n=e.useLogDepth;if(Object(u.a)(this._command)||(this._rs=RM.fromCache({cull:{enabled:!0},depthTest:{enabled:!0},colorMask:{red:!1,green:!1,blue:!1,alpha:!1}}),this._command=new cM({renderState:this._rs,boundingVolume:new St(z.ZERO,i.maximumRadius),pass:lM.OPAQUE,owner:this})),!Object(u.a)(this._sp)||this._useLogDepth!==n){this._useLogDepth=n;var r=new UN({sources:[Ble]}),a=new UN({sources:[kle]});if(n){a.sources.push("#ifdef GL_EXT_frag_depth \n#extension GL_EXT_frag_depth : enable \n#endif \n\n"),a.defines.push("LOG_DEPTH"),r.defines.push("LOG_DEPTH"),r.defines.push("DISABLE_GL_POSITION_LOG_DEPTH")}this._sp=bR.replaceCache({shaderProgram:this._sp,context:t,vertexShaderSource:r,fragmentShaderSource:a,attributeLocations:{position:0}}),this._command.shaderProgram=this._sp}var o=function(e,t){var i=e.radii,n=t.camera.positionWC,r=z.multiplyComponents(e.oneOverRadii,n,Vle),a=z.magnitude(r),o=z.normalize(r,Hle),s=z.normalize(z.cross(z.UNIT_Z,r,Gle),Gle),c=z.normalize(z.cross(o,s,qle),qle),l=Math.sqrt(z.magnitudeSquared(r)-1),u=z.multiplyByScalar(o,1/a,Vle),h=l/a,d=z.multiplyByScalar(s,h,Hle),f=z.multiplyByScalar(c,h,Gle),p=z.add(u,f,qle);z.subtract(p,d,p),z.multiplyComponents(i,p,p),z.pack(p,Ule,0);var m=z.subtract(u,f,qle);z.subtract(m,d,m),z.multiplyComponents(i,m,m),z.pack(m,Ule,3);var _=z.add(u,f,qle);z.add(_,d,_),z.multiplyComponents(i,_,_),z.pack(_,Ule,6);var g=z.subtract(u,f,qle);return z.add(g,d,g),z.multiplyComponents(i,g,g),z.pack(g,Ule,9),Ule}(i,e);if(Object(u.a)(this._va))this._va.getAttribute(0).vertexBuffer.copyFromArrayView(o);else{var s=new La({attributes:{position:new Na({componentDatatype:dn.FLOAT,componentsPerAttribute:3,values:o})},indices:[0,1,2,2,1,3],primitiveType:yn.TRIANGLES});this._va=tF.fromGeometry({context:t,geometry:s,attributeLocations:{position:0},bufferUsage:YN.DYNAMIC_DRAW}),this._command.vertexArray=this._va}}},zle.prototype.execute=function(e,t){this._mode===xF.SCENE3D&&this._command.execute(e,t)},zle.prototype.isDestroyed=function(){return!1},zle.prototype.destroy=function(){this._sp=this._sp&&this._sp.destroy(),this._va=this._va&&this._va.destroy()};var Wle=zle;function Yle(){}var Xle=/\bgl_FragDepthEXT\b/,Zle=/\bdiscard\b/;Yle.createDepthOnlyDerivedCommand=function(e,t,i,n){var r,a;return Object(u.a)(n)||(n={}),Object(u.a)(n.depthOnlyCommand)&&(r=n.depthOnlyCommand.shaderProgram,a=n.depthOnlyCommand.renderState),n.depthOnlyCommand=cM.shallowClone(t,n.depthOnlyCommand),Object(u.a)(r)&&n.shaderProgramId===t.shaderProgram.id?(n.depthOnlyCommand.shaderProgram=r,n.depthOnlyCommand.renderState=a):(n.depthOnlyCommand.shaderProgram=function(e,t){var i=e.shaderCache.getDerivedShaderProgram(t,"depthOnly");if(!Object(u.a)(i)){var n,r=t._attributeLocations,a=t.fragmentShaderSource,o=!1,s=a.sources,c=s.length;for(n=0;n<c;++n)if(Xle.test(s[n])||Zle.test(s[n])){o=!0;break}var l=!1,h=a.defines;for(c=h.length,n=0;n<c;++n)if("LOG_DEPTH"===h[n]){l=!0;break}o||l?!o&&l&&(a=new UN({defines:["LOG_DEPTH"],sources:["#ifdef GL_EXT_frag_depth \n#extension GL_EXT_frag_depth : enable \n#endif \n\nvoid main() \n{ \n    gl_FragColor = vec4(1.0); \n    czm_writeLogDepth(); \n} \n"]})):a=new UN({sources:["void main() \n{ \n    gl_FragColor = vec4(1.0); \n} \n"]}),i=e.shaderCache.createDerivedShaderProgram(t,"depthOnly",{vertexShaderSource:t.vertexShaderSource,fragmentShaderSource:a,attributeLocations:r})}return i}(i,t.shaderProgram),n.depthOnlyCommand.renderState=function(e,t){var i=e._depthOnlyRenderStateCache,n=i[t.id];if(!Object(u.a)(n)){var r=RM.getState(t);r.depthMask=!0,r.colorMask={red:!1,green:!1,blue:!1,alpha:!1},n=RM.fromCache(r),i[t.id]=n}return n}(e,t.renderState),n.shaderProgramId=t.shaderProgram.id),n};var Qle=/\s+czm_writeLogDepth\(/,Kle=/\s+czm_vertexLogDepth\(/,Jle=/\s*#extension\s+GL_EXT_frag_depth\s*:\s*enable/;Yle.createLogDepthCommand=function(e,t,i){var n;return Object(u.a)(i)||(i={}),Object(u.a)(i.command)&&(n=i.command.shaderProgram),i.command=cM.shallowClone(e,i.command),Object(u.a)(n)&&i.shaderProgramId===e.shaderProgram.id?i.command.shaderProgram=n:(i.command.shaderProgram=function(e,t){var i=e.shaderCache.getDerivedShaderProgram(t,"logDepth");if(!Object(u.a)(i)){var n,r=t._attributeLocations,a=t.vertexShaderSource.clone(),o=t.fragmentShaderSource.clone();a.defines=Object(u.a)(a.defines)?a.defines.slice(0):[],a.defines.push("LOG_DEPTH"),o.defines=Object(u.a)(o.defines)?o.defines.slice(0):[],o.defines.push("LOG_DEPTH");var s=!1,c=a.sources,l=c.length;for(n=0;n<l;++n)if(Kle.test(c[n])){s=!0;break}if(!s){for(n=0;n<l;++n)c[n]=UN.replaceMain(c[n],"czm_log_depth_main");"\n\nvoid main() \n{ \n    czm_log_depth_main(); \n    czm_vertexLogDepth(); \n} \n",c.push("\n\nvoid main() \n{ \n    czm_log_depth_main(); \n    czm_vertexLogDepth(); \n} \n")}var h=!0;for(s=!1,l=(c=o.sources).length,n=0;n<l;++n)Qle.test(c[n])&&(s=!0),Jle.test(c[n])&&(h=!1);var d="";if(h&&(d+="#ifdef GL_EXT_frag_depth \n#extension GL_EXT_frag_depth : enable \n#endif \n\n"),!s){for(n=0;n<l;n++)c[n]=UN.replaceMain(c[n],"czm_log_depth_main");d+="\nvoid main() \n{ \n    czm_log_depth_main(); \n    czm_writeLogDepth(); \n} \n"}c.push(d),i=e.shaderCache.createDerivedShaderProgram(t,"logDepth",{vertexShaderSource:a,fragmentShaderSource:o,attributeLocations:r})}return i}(t,e.shaderProgram),i.shaderProgramId=e.shaderProgram.id),i},Yle.createPickDerivedCommand=function(e,t,i,n){var r,a;return Object(u.a)(n)||(n={}),Object(u.a)(n.pickCommand)&&(r=n.pickCommand.shaderProgram,a=n.pickCommand.renderState),n.pickCommand=cM.shallowClone(t,n.pickCommand),Object(u.a)(r)&&n.shaderProgramId===t.shaderProgram.id?(n.pickCommand.shaderProgram=r,n.pickCommand.renderState=a):(n.pickCommand.shaderProgram=function(e,t,i){var n=e.shaderCache.getDerivedShaderProgram(t,"pick");if(!Object(u.a)(n)){var r,a=t._attributeLocations,o=t.fragmentShaderSource,s=o.sources,c=s.length;if(Object(u.a)(i.color)){var l=i.color;r="vec4("+l.red+","+l.green+","+l.blue+","+l.alpha+");\n"}else r=i+"; \n";for(var h="void main() \n{ \n    czm_non_pick_main(); \n    if (gl_FragColor.a == 0.0) { \n        discard; \n    } \n    gl_FragColor = "+r+"} \n",d=new Array(c+1),f=0;f<c;++f)d[f]=UN.replaceMain(s[f],"czm_non_pick_main");d[c]=h,o=new UN({sources:d,defines:o.defines}),n=e.shaderCache.createDerivedShaderProgram(t,"pick",{vertexShaderSource:t.vertexShaderSource,fragmentShaderSource:o,attributeLocations:a})}return n}(i,t.shaderProgram,t.pickId),n.pickCommand.renderState=function(e,t){var i=e._pickRenderStateCache,n=i[t.id];if(!Object(u.a)(n)){var r=RM.getState(t);r.blending.enabled=!1,r.depthMask=!0,n=RM.fromCache(r),i[t.id]=n}return n}(e,t.renderState),n.shaderProgramId=t.shaderProgram.id),n},Yle.createHdrCommand=function(e,t,i){var n;return Object(u.a)(i)||(i={}),Object(u.a)(i.command)&&(n=i.command.shaderProgram),i.command=cM.shallowClone(e,i.command),Object(u.a)(n)&&i.shaderProgramId===e.shaderProgram.id?i.command.shaderProgram=n:(i.command.shaderProgram=function(e,t){var i=e.shaderCache.getDerivedShaderProgram(t,"HDR");if(!Object(u.a)(i)){var n=t._attributeLocations,r=t.vertexShaderSource.clone(),a=t.fragmentShaderSource.clone();r.defines=Object(u.a)(r.defines)?r.defines.slice(0):[],r.defines.push("HDR"),a.defines=Object(u.a)(a.defines)?a.defines.slice(0):[],a.defines.push("HDR"),i=e.shaderCache.createDerivedShaderProgram(t,"HDR",{vertexShaderSource:r,fragmentShaderSource:a,attributeLocations:n})}return i}(t,e.shaderProgram),i.shaderProgramId=e.shaderProgram.id),i};var $le=Yle;function eue(e){if(!Object(u.a)(e))throw new h.a("scene is required.");this._scene=e,this._lastAlpha=void 0,this._lastBeta=void 0,this._lastGamma=void 0,this._alpha=void 0,this._beta=void 0,this._gamma=void 0;var t=this;function i(e){var i=e.alpha;if(!Object(u.a)(i))return t._alpha=void 0,t._beta=void 0,void(t._gamma=void 0);t._alpha=I.toRadians(i),t._beta=I.toRadians(e.beta),t._gamma=I.toRadians(e.gamma)}window.addEventListener("deviceorientation",i,!1),this._removeListener=function(){window.removeEventListener("deviceorientation",i,!1)}}var tue=new Kn,iue=new Kn,nue=new be;eue.prototype.update=function(){if(Object(u.a)(this._alpha)){Object(u.a)(this._lastAlpha)||(this._lastAlpha=this._alpha,this._lastBeta=this._beta,this._lastGamma=this._gamma);var e=this._lastAlpha-this._alpha,t=this._lastBeta-this._beta,i=this._lastGamma-this._gamma;!function(e,t,i,n){var r=e.direction,a=e.right,o=e.up,s=Kn.fromAxisAngle(r,i,iue),c=Kn.fromAxisAngle(a,n,tue),l=Kn.multiply(c,s,c),u=Kn.fromAxisAngle(o,t,iue);Kn.multiply(u,l,l);var h=be.fromQuaternion(l,nue);be.multiplyByVector(h,a,a),be.multiplyByVector(h,o,o),be.multiplyByVector(h,r,r)}(this._scene.camera,-e,t,i),this._lastAlpha=this._alpha,this._lastBeta=this._beta,this._lastGamma=this._gamma}},eue.prototype.isDestroyed=function(){return!1},eue.prototype.destroy=function(){return this._removeListener(),rl(this)};var rue=eue,aue="#ifdef WRITE_DEPTH\n#ifdef GL_EXT_frag_depth\n#extension GL_EXT_frag_depth : enable\n#endif\n#endif\nuniform vec3 u_radii;\nuniform vec3 u_oneOverEllipsoidRadiiSquared;\nvarying vec3 v_positionEC;\nvec4 computeEllipsoidColor(czm_ray ray, float intersection, float side)\n{\nvec3 positionEC = czm_pointAlongRay(ray, intersection);\nvec3 positionMC = (czm_inverseModelView * vec4(positionEC, 1.0)).xyz;\nvec3 geodeticNormal = normalize(czm_geodeticSurfaceNormal(positionMC, vec3(0.0), u_oneOverEllipsoidRadiiSquared));\nvec3 sphericalNormal = normalize(positionMC / u_radii);\nvec3 normalMC = geodeticNormal * side;\nvec3 normalEC = normalize(czm_normal * normalMC);\nvec2 st = czm_ellipsoidWgs84TextureCoordinates(sphericalNormal);\nvec3 positionToEyeEC = -positionEC;\nczm_materialInput materialInput;\nmaterialInput.s = st.s;\nmaterialInput.st = st;\nmaterialInput.str = (positionMC + u_radii) / u_radii;\nmaterialInput.normalEC = normalEC;\nmaterialInput.tangentToEyeMatrix = czm_eastNorthUpToEyeCoordinates(positionMC, normalEC);\nmaterialInput.positionToEyeEC = positionToEyeEC;\nczm_material material = czm_getMaterial(materialInput);\n#ifdef ONLY_SUN_LIGHTING\nreturn czm_private_phong(normalize(positionToEyeEC), material);\n#else\nreturn czm_phong(normalize(positionToEyeEC), material);\n#endif\n}\nvoid main()\n{\nfloat maxRadius = max(u_radii.x, max(u_radii.y, u_radii.z)) * 1.5;\nvec3 direction = normalize(v_positionEC);\nvec3 ellipsoidCenter = czm_modelView[3].xyz;\nfloat t1 = -1.0;\nfloat t2 = -1.0;\nfloat b = -2.0 * dot(direction, ellipsoidCenter);\nfloat c = dot(ellipsoidCenter, ellipsoidCenter) - maxRadius * maxRadius;\nfloat discriminant = b * b - 4.0 * c;\nif (discriminant >= 0.0) {\nt1 = (-b - sqrt(discriminant)) * 0.5;\nt2 = (-b + sqrt(discriminant)) * 0.5;\n}\nif (t1 < 0.0 && t2 < 0.0) {\ndiscard;\n}\nfloat t = min(t1, t2);\nif (t < 0.0) {\nt = 0.0;\n}\nczm_ellipsoid ellipsoid = czm_ellipsoidNew(ellipsoidCenter, u_radii);\nczm_ray ray = czm_ray(t * direction, direction);\nczm_raySegment intersection = czm_rayEllipsoidIntersectionInterval(ray, ellipsoid);\nif (czm_isEmpty(intersection))\n{\ndiscard;\n}\nvec4 outsideFaceColor = (intersection.start != 0.0) ? computeEllipsoidColor(ray, intersection.start, 1.0) : vec4(0.0);\nvec4 insideFaceColor = (outsideFaceColor.a < 1.0) ? computeEllipsoidColor(ray, intersection.stop, -1.0) : vec4(0.0);\ngl_FragColor = mix(insideFaceColor, outsideFaceColor, outsideFaceColor.a);\ngl_FragColor.a = 1.0 - (1.0 - insideFaceColor.a) * (1.0 - outsideFaceColor.a);\n#ifdef WRITE_DEPTH\n#ifdef GL_EXT_frag_depth\nt = (intersection.start != 0.0) ? intersection.start : intersection.stop;\nvec3 positionEC = czm_pointAlongRay(ray, t);\nvec4 positionCC = czm_projection * vec4(positionEC, 1.0);\n#ifdef LOG_DEPTH\nczm_writeLogDepth(1.0 + positionCC.w);\n#else\nfloat z = positionCC.z / positionCC.w;\nfloat n = czm_depthRange.near;\nfloat f = czm_depthRange.far;\ngl_FragDepthEXT = (z * (f - n) + f + n) * 0.5;\n#endif\n#endif\n#endif\n}\n",oue="attribute vec3 position;\nuniform vec3 u_radii;\nvarying vec3 v_positionEC;\nvoid main()\n{\nvec4 p = vec4(u_radii * position, 1.0);\nv_positionEC = (czm_modelView * p).xyz;\ngl_Position = czm_modelViewProjection * p;\ngl_Position.z = clamp(gl_Position.z, czm_depthRange.near, czm_depthRange.far);\nczm_vertexLogDepth();\n}\n",sue={position:0};function cue(e){e=Object(w.a)(e,w.a.EMPTY_OBJECT),this.center=z.clone(Object(w.a)(e.center,z.ZERO)),this._center=new z,this.radii=z.clone(e.radii),this._radii=new z,this._oneOverEllipsoidRadiiSquared=new z,this._boundingSphere=new St,this.modelMatrix=Be.clone(Object(w.a)(e.modelMatrix,Be.IDENTITY)),this._modelMatrix=new Be,this._computedModelMatrix=new Be,this.show=Object(w.a)(e.show,!0),this.material=Object(w.a)(e.material,qj.fromType(qj.ColorType)),this._material=void 0,this._translucent=void 0,this.id=e.id,this._id=void 0,this.debugShowBoundingVolume=Object(w.a)(e.debugShowBoundingVolume,!1),this.onlySunLighting=Object(w.a)(e.onlySunLighting,!1),this._onlySunLighting=!1,this._depthTestEnabled=Object(w.a)(e.depthTestEnabled,!0),this._useLogDepth=!1,this._sp=void 0,this._rs=void 0,this._va=void 0,this._pickSP=void 0,this._pickId=void 0,this._colorCommand=new cM({owner:Object(w.a)(e._owner,this)}),this._pickCommand=new cM({owner:Object(w.a)(e._owner,this),pickOnly:!0});var t=this;this._uniforms={u_radii:function(){return t.radii},u_oneOverEllipsoidRadiiSquared:function(){return t._oneOverEllipsoidRadiiSquared}},this._pickUniforms={czm_pickColor:function(){return t._pickId.color}}}var lue="#ifdef GL_EXT_frag_depth \n#extension GL_EXT_frag_depth : enable \n#endif \n\n";cue.prototype.update=function(e){if(this.show&&e.mode===xF.SCENE3D&&Object(u.a)(this.center)&&Object(u.a)(this.radii)){if(!Object(u.a)(this.material))throw new h.a("this.material must be defined.");var t=e.context,i=this.material.isTranslucent(),n=this._translucent!==i;Object(u.a)(this._rs)&&!n||(this._translucent=i,this._rs=RM.fromCache({cull:{enabled:!0,face:BD.FRONT},depthTest:{enabled:this._depthTestEnabled},depthMask:!i&&t.fragmentDepth,blending:i?FD.ALPHA_BLEND:void 0})),Object(u.a)(this._va)||(this._va=function(e){var t=e.cache.ellipsoidPrimitive_vertexArray;if(Object(u.a)(t))return t;var i=Ya.createGeometry(Ya.fromDimensions({dimensions:new z(2,2,2),vertexFormat:Ba.POSITION_ONLY}));return t=tF.fromGeometry({context:e,geometry:i,attributeLocations:sue,bufferUsage:YN.STATIC_DRAW,interleave:!0}),e.cache.ellipsoidPrimitive_vertexArray=t,t}(t));var r=!1,a=this.radii;if(!z.equals(this._radii,a)){z.clone(a,this._radii);var o=this._oneOverEllipsoidRadiiSquared;o.x=1/(a.x*a.x),o.y=1/(a.y*a.y),o.z=1/(a.z*a.z),r=!0}Be.equals(this.modelMatrix,this._modelMatrix)&&z.equals(this.center,this._center)||(Be.clone(this.modelMatrix,this._modelMatrix),z.clone(this.center,this._center),Be.multiplyByTranslation(this.modelMatrix,this.center,this._computedModelMatrix),r=!0),r&&(z.clone(z.ZERO,this._boundingSphere.center),this._boundingSphere.radius=z.maximumComponent(a),St.transform(this._boundingSphere,this._computedModelMatrix,this._boundingSphere));var s=this._material!==this.material;this._material=this.material,this._material.update(t);var c=this.onlySunLighting!==this._onlySunLighting;this._onlySunLighting=this.onlySunLighting;var l=e.useLogDepth,d=this._useLogDepth!==l;this._useLogDepth=l;var f,p,m=this._colorCommand;(s||c||n||d)&&(f=new UN({sources:[oue]}),p=new UN({sources:[this.material.shaderSource,aue]}),this.onlySunLighting&&p.defines.push("ONLY_SUN_LIGHTING"),!i&&t.fragmentDepth&&p.defines.push("WRITE_DEPTH"),this._useLogDepth&&(f.defines.push("LOG_DEPTH","DISABLE_GL_POSITION_LOG_DEPTH"),p.defines.push("LOG_DEPTH"),p.sources.push(lue)),this._sp=bR.replaceCache({context:t,shaderProgram:this._sp,vertexShaderSource:f,fragmentShaderSource:p,attributeLocations:sue}),m.vertexArray=this._va,m.renderState=this._rs,m.shaderProgram=this._sp,m.uniformMap=Object(ff.a)(this._uniforms,this.material._uniforms),m.executeInClosestFrustum=i);var _=e.commandList,g=e.passes;if(g.render&&(m.boundingVolume=this._boundingSphere,m.debugShowBoundingVolume=this.debugShowBoundingVolume,m.modelMatrix=this._computedModelMatrix,m.pass=i?lM.TRANSLUCENT:lM.OPAQUE,_.push(m)),g.pick){var v=this._pickCommand;Object(u.a)(this._pickId)&&this._id===this.id||(this._id=this.id,this._pickId=this._pickId&&this._pickId.destroy(),this._pickId=t.createPickId({primitive:this,id:this.id})),(s||c||!Object(u.a)(this._pickSP)||d)&&(f=new UN({sources:[oue]}),p=new UN({sources:[this.material.shaderSource,aue],pickColorQualifier:"uniform"}),this.onlySunLighting&&p.defines.push("ONLY_SUN_LIGHTING"),!i&&t.fragmentDepth&&p.defines.push("WRITE_DEPTH"),this._useLogDepth&&(f.defines.push("LOG_DEPTH"),p.defines.push("LOG_DEPTH"),p.sources.push(lue)),this._pickSP=bR.replaceCache({context:t,shaderProgram:this._pickSP,vertexShaderSource:f,fragmentShaderSource:p,attributeLocations:sue}),v.vertexArray=this._va,v.renderState=this._rs,v.shaderProgram=this._pickSP,v.uniformMap=Object(ff.a)(Object(ff.a)(this._uniforms,this._pickUniforms),this.material._uniforms),v.executeInClosestFrustum=i),v.boundingVolume=this._boundingSphere,v.modelMatrix=this._computedModelMatrix,v.pass=i?lM.TRANSLUCENT:lM.OPAQUE,_.push(v)}}},cue.prototype.isDestroyed=function(){return!1},cue.prototype.destroy=function(){return this._sp=this._sp&&this._sp.destroy(),this._pickSP=this._pickSP&&this._pickSP.destroy(),this._pickId=this._pickId&&this._pickId.destroy(),rl(this)};var uue=cue,hue="varying vec3 v_positionMC;\nvarying vec3 v_positionEC;\nvarying vec2 v_st;\nvoid main()\n{\nczm_materialInput materialInput;\nvec3 normalEC = normalize(czm_normal3D * czm_geodeticSurfaceNormal(v_positionMC, vec3(0.0), vec3(1.0)));\n#ifdef FACE_FORWARD\nnormalEC = faceforward(normalEC, vec3(0.0, 0.0, 1.0), -normalEC);\n#endif\nmaterialInput.s = v_st.s;\nmaterialInput.st = v_st;\nmaterialInput.str = vec3(v_st, 0.0);\nmaterialInput.normalEC = normalEC;\nmaterialInput.tangentToEyeMatrix = czm_eastNorthUpToEyeCoordinates(v_positionMC, materialInput.normalEC);\nvec3 positionToEyeEC = -v_positionEC;\nmaterialInput.positionToEyeEC = positionToEyeEC;\nczm_material material = czm_getMaterial(materialInput);\n#ifdef FLAT\ngl_FragColor = vec4(material.diffuse + material.emission, material.alpha);\n#else\ngl_FragColor = czm_phong(normalize(positionToEyeEC), material);\n#endif\n}\n",due="attribute vec3 position3DHigh;\nattribute vec3 position3DLow;\nattribute vec2 st;\nattribute float batchId;\nvarying vec3 v_positionMC;\nvarying vec3 v_positionEC;\nvarying vec2 v_st;\nvoid main()\n{\nvec4 p = czm_computePosition();\nv_positionMC = position3DHigh + position3DLow;\nv_positionEC = (czm_modelViewRelativeToEye * p).xyz;\nv_st = st;\ngl_Position = czm_modelViewProjectionRelativeToEye * p;\n}\n";function fue(e){e=Object(w.a)(e,w.a.EMPTY_OBJECT);var t=Object(w.a)(e.translucent,!0),i=Object(w.a)(e.aboveGround,!1);this.material=Object(u.a)(e.material)?e.material:qj.fromType(qj.ColorType),this.translucent=Object(w.a)(e.translucent,!0),this._vertexShaderSource=Object(w.a)(e.vertexShaderSource,due),this._fragmentShaderSource=Object(w.a)(e.fragmentShaderSource,hue),this._renderState=UD.getDefaultRenderState(t,!i,e.renderState),this._closed=!1,this._flat=Object(w.a)(e.flat,!1),this._faceForward=Object(w.a)(e.faceForward,i),this._aboveGround=i}Object(O.a)(fue.prototype,{vertexShaderSource:{get:function(){return this._vertexShaderSource}},fragmentShaderSource:{get:function(){return this._fragmentShaderSource}},renderState:{get:function(){return this._renderState}},closed:{get:function(){return this._closed}},vertexFormat:{get:function(){return fue.VERTEX_FORMAT}},flat:{get:function(){return this._flat}},faceForward:{get:function(){return this._faceForward}},aboveGround:{get:function(){return this._aboveGround}}}),fue.VERTEX_FORMAT=Ba.POSITION_AND_ST,fue.prototype.getFragmentShaderSource=UD.prototype.getFragmentShaderSource,fue.prototype.isTranslucent=UD.prototype.isTranslucent,fue.prototype.getRenderState=UD.prototype.getRenderState;var pue=fue;function mue(){this.enabled=!0,this.density=2e-4,this.screenSpaceErrorFactor=2,this.minimumBrightness=.03}for(var _ue=[359.393,800.749,1275.6501,2151.1192,3141.7763,4777.5198,6281.2493,12364.307,15900.765,49889.0549,78026.8259,99260.7344,120036.3873,151011.0158,156091.1953,203849.3112,274866.9803,319916.3149,493552.0528,628733.5874],gue=[2e-5,2e-4,1e-4,7e-5,5e-5,4e-5,3e-5,19e-6,1e-5,85e-7,62e-7,58e-7,53e-7,52e-7,51e-7,42e-7,4e-6,34e-7,26e-7,22e-7],vue=0;vue<gue.length;++vue)gue[vue]*=1e6;for(var bue=gue[1],yue=gue[gue.length-1],wue=0;wue<gue.length;++wue)gue[wue]=(gue[wue]-yue)/(bue-yue);var Oue=0;var xue=new z;mue.prototype.update=function(e){if(e.fog.enabled=this.enabled){var t=e.camera,i=t.positionCartographic;if(!Object(u.a)(i)||i.height>8e5||e.mode!==xF.SCENE3D)e.fog.enabled=!1;else{var n=i.height,r=function(e){var t,i=_ue,n=i.length;if(e<i[0])return Oue=0;if(e>i[n-1])return Oue=n-2;if(e>=i[Oue]){if(Oue+1<n&&e<i[Oue+1])return Oue;if(Oue+2<n&&e<i[Oue+2])return++Oue}else if(Oue-1>=0&&e>=i[Oue-1])return--Oue;for(t=0;t<n-2&&!(e>=i[t]&&e<i[t+1]);++t);return Oue=t}(n),a=I.clamp((n-_ue[r])/(_ue[r+1]-_ue[r]),0,1),o=I.lerp(gue[r],gue[r+1],a),s=1e6*this.density;o=o*(s-s/bue*yue)*1e-6;var c=z.normalize(t.positionWC,xue);o*=1-Math.abs(z.dot(t.directionWC,c)),e.fog.density=o,e.fog.sse=this.screenSpaceErrorFactor,e.fog.minimumBrightness=this.minimumBrightness}}};var Eue=mue;function Tue(e){if(!Object(u.a)(e)||!Object(u.a)(e.scene))throw new h.a("options.scene is required.");this._scene=e.scene,this.samplingWindow=Object(w.a)(e.samplingWindow,Tue.defaultSettings.samplingWindow),this.quietPeriod=Object(w.a)(e.quietPeriod,Tue.defaultSettings.quietPeriod),this.warmupPeriod=Object(w.a)(e.warmupPeriod,Tue.defaultSettings.warmupPeriod),this.minimumFrameRateDuringWarmup=Object(w.a)(e.minimumFrameRateDuringWarmup,Tue.defaultSettings.minimumFrameRateDuringWarmup),this.minimumFrameRateAfterWarmup=Object(w.a)(e.minimumFrameRateAfterWarmup,Tue.defaultSettings.minimumFrameRateAfterWarmup),this._lowFrameRate=new $o.a,this._nominalFrameRate=new $o.a,this._frameTimes=[],this._needsQuietPeriod=!0,this._quietPeriodEndTime=0,this._warmupPeriodEndTime=0,this._frameRateIsLow=!1,this._lastFramesPerSecond=void 0,this._pauseCount=0;var t=this;this._preUpdateRemoveListener=this._scene.preUpdate.addEventListener((function(e,i){!function(e,t){if(e._pauseCount>0)return;var i=Qd();if(e._needsQuietPeriod)e._needsQuietPeriod=!1,e._frameTimes.length=0,e._quietPeriodEndTime=i+e.quietPeriod/nr.SECONDS_PER_MILLISECOND,e._warmupPeriodEndTime=e._quietPeriodEndTime+(e.warmupPeriod+e.samplingWindow)/nr.SECONDS_PER_MILLISECOND;else if(i>=e._quietPeriodEndTime){e._frameTimes.push(i);var n=i-e.samplingWindow/nr.SECONDS_PER_MILLISECOND;if(e._frameTimes.length>=2&&e._frameTimes[0]<=n){for(;e._frameTimes.length>=2&&e._frameTimes[1]<n;)e._frameTimes.shift();var r=(i-e._frameTimes[0])/(e._frameTimes.length-1);e._lastFramesPerSecond=1e3/r;var a=1e3/(i>e._warmupPeriodEndTime?e.minimumFrameRateAfterWarmup:e.minimumFrameRateDuringWarmup);r>a?e._frameRateIsLow||(e._frameRateIsLow=!0,e._needsQuietPeriod=!0,e.lowFrameRate.raiseEvent(e.scene,e._lastFramesPerSecond)):e._frameRateIsLow&&(e._frameRateIsLow=!1,e._needsQuietPeriod=!0,e.nominalFrameRate.raiseEvent(e.scene,e._lastFramesPerSecond))}}}(t)})),this._hiddenPropertyName=void 0!==document.hidden?"hidden":void 0!==document.mozHidden?"mozHidden":void 0!==document.msHidden?"msHidden":void 0!==document.webkitHidden?"webkitHidden":void 0;var i=void 0!==document.hidden?"visibilitychange":void 0!==document.mozHidden?"mozvisibilitychange":void 0!==document.msHidden?"msvisibilitychange":void 0!==document.webkitHidden?"webkitvisibilitychange":void 0;function n(){var e;e=t,document[e._hiddenPropertyName]?e.pause():e.unpause()}this._visibilityChangeRemoveListener=void 0,Object(u.a)(i)&&(document.addEventListener(i,n,!1),this._visibilityChangeRemoveListener=function(){document.removeEventListener(i,n,!1)})}Tue.defaultSettings={samplingWindow:5,quietPeriod:2,warmupPeriod:5,minimumFrameRateDuringWarmup:4,minimumFrameRateAfterWarmup:8},Tue.fromScene=function(e){if(!Object(u.a)(e))throw new h.a("scene is required.");return Object(u.a)(e._frameRateMonitor)&&!e._frameRateMonitor.isDestroyed()||(e._frameRateMonitor=new Tue({scene:e})),e._frameRateMonitor},Object(O.a)(Tue.prototype,{scene:{get:function(){return this._scene}},lowFrameRate:{get:function(){return this._lowFrameRate}},nominalFrameRate:{get:function(){return this._nominalFrameRate}},lastFramesPerSecond:{get:function(){return this._lastFramesPerSecond}}}),Tue.prototype.pause=function(){++this._pauseCount,1===this._pauseCount&&(this._frameTimes.length=0,this._lastFramesPerSecond=void 0)},Tue.prototype.unpause=function(){--this._pauseCount,this._pauseCount<=0&&(this._pauseCount=0,this._needsQuietPeriod=!0)},Tue.prototype.isDestroyed=function(){return!1},Tue.prototype.destroy=function(){return this._preUpdateRemoveListener(),Object(u.a)(this._visibilityChangeRemoveListener)&&this._visibilityChangeRemoveListener(),rl(this)};var Cue=Tue;var Sue=function(e,t,i){this.context=e,this.commandList=[],this.shadowMaps=[],this.viewSheds=[],this.brdfLutGenerator=void 0,this.environmentMap=void 0,this.sphericalHarmonicCoefficients=void 0,this.specularEnvironmentMaps=void 0,this.specularEnvironmentMapsMaximumLOD=void 0,this.mode=xF.SCENE3D,this.morphTime=xF.getMorphTime(xF.SCENE3D),this.frameNumber=0,this.time=void 0,this.jobScheduler=i,this.mapProjection=void 0,this.camera=void 0,this.cullingVolume=void 0,this.occluder=void 0,this.maximumScreenSpaceError=void 0,this.passes={render:!1,pick:!1,depth:!1,postProcess:!1,offscreen:!1,asynchronous:!1},this.creditDisplay=t,this.afterRender=[],this.scene3DOnly=!1,this.fog={enabled:!1,density:void 0,sse:void 0,minimumBrightness:void 0},this.terrainExaggeration=1,this.viewShedState={viewShedsEnabled:!0,lightViewShedEnabled:!0,viewSheds:[],lightViewShedsMaps:[],nearPlane:1,farPlane:5e3,closestObjectSize:1e3,lastDirtyTime:0,outOfView:!0},this.shadowState={shadowsEnabled:!0,lightShadowsEnabled:!0,shadowMaps:[],lightShadowMaps:[],nearPlane:1,farPlane:5e3,closestObjectSize:1e3,lastDirtyTime:0,outOfView:!0},this.imagerySplitPosition=0,this.frustumSplits=[],this.backgroundColor=void 0,this.sunColor=void 0,this.minimumDisableDepthTestDistance=void 0,this.invertClassification=!1,this.invertClassificationColor=void 0,this.ambientLight=void 0,this.lightScaleFactor=1,this.useLogDepth=!1,this.skyBoxModelMatrix=void 0};var Aue=function(e,t){this.near=Object(w.a)(e,0),this.far=Object(w.a)(t,0);for(var i=lM.NUMBER_OF_PASSES,n=new Array(i),r=new Array(i),a=0;a<i;++a)n[a]=[],r[a]=0;this.commands=n,this.indices=r},Pue="uniform vec4 u_initialColor;\n#if TEXTURE_UNITS > 0\nuniform sampler2D u_dayTextures[TEXTURE_UNITS];\nuniform vec4 u_dayTextureTranslationAndScale[TEXTURE_UNITS];\nuniform bool u_dayTextureUseWebMercatorT[TEXTURE_UNITS];\n#ifdef APPLY_ALPHA\nuniform float u_dayTextureAlpha[TEXTURE_UNITS];\n#endif\n#ifdef APPLY_SPLIT\nuniform float u_dayTextureSplit[TEXTURE_UNITS];\n#endif\n#ifdef APPLY_BRIGHTNESS\nuniform float u_dayTextureBrightness[TEXTURE_UNITS];\n#endif\n#ifdef APPLY_CONTRAST\nuniform float u_dayTextureContrast[TEXTURE_UNITS];\n#endif\n#ifdef APPLY_HUE\nuniform float u_dayTextureHue[TEXTURE_UNITS];\n#endif\n#ifdef APPLY_SATURATION\nuniform float u_dayTextureSaturation[TEXTURE_UNITS];\n#endif\n#ifdef APPLY_GAMMA\nuniform float u_dayTextureOneOverGamma[TEXTURE_UNITS];\n#endif\n#ifdef APPLY_IMAGERY_CUTOUT\nuniform vec4 u_dayTextureCutoutRectangles[TEXTURE_UNITS];\n#endif\nuniform vec4 u_dayTextureTexCoordsRectangle[TEXTURE_UNITS];\n#endif\n#ifdef SHOW_REFLECTIVE_OCEAN\nuniform sampler2D u_waterMask;\nuniform vec4 u_waterMaskTranslationAndScale;\nuniform float u_zoomedOutOceanSpecularIntensity;\n#endif\n#ifdef SHOW_OCEAN_WAVES\nuniform sampler2D u_oceanNormalMap;\n#endif\n#if defined(ENABLE_DAYNIGHT_SHADING) || defined(GROUND_ATMOSPHERE)\nuniform vec2 u_lightingFadeDistance;\n#endif\n#ifdef TILE_LIMIT_RECTANGLE\nuniform vec4 u_cartographicLimitRectangle;\n#endif\n#ifdef GROUND_ATMOSPHERE\nuniform vec2 u_nightFadeDistance;\n#endif\n#ifdef ENABLE_CLIPPING_PLANES\nuniform sampler2D u_clippingPlanes;\nuniform mat4 u_clippingPlanesMatrix;\nuniform vec4 u_clippingPlanesEdgeStyle;\n#endif\n#if defined(FOG) && (defined(ENABLE_VERTEX_LIGHTING) || defined(ENABLE_DAYNIGHT_SHADING)) || defined(GROUND_ATMOSPHERE)\nuniform float u_minimumBrightness;\n#endif\n#ifdef COLOR_CORRECT\nuniform vec3 u_hsbShift;\n#endif\nvarying vec3 v_positionMC;\nvarying vec3 v_positionEC;\nvarying vec3 v_textureCoordinates;\nvarying vec3 v_normalMC;\nvarying vec3 v_normalEC;\n#ifdef APPLY_MATERIAL\nvarying float v_height;\nvarying float v_slope;\n#endif\n#if defined(FOG) || defined(GROUND_ATMOSPHERE)\nvarying float v_distance;\nvarying vec3 v_fogRayleighColor;\nvarying vec3 v_fogMieColor;\n#endif\n#ifdef GROUND_ATMOSPHERE\nvarying vec3 v_rayleighColor;\nvarying vec3 v_mieColor;\n#endif\nvec4 sampleAndBlend(\nvec4 previousColor,\nsampler2D textureToSample,\nvec2 tileTextureCoordinates,\nvec4 textureCoordinateRectangle,\nvec4 textureCoordinateTranslationAndScale,\nfloat textureAlpha,\nfloat textureBrightness,\nfloat textureContrast,\nfloat textureHue,\nfloat textureSaturation,\nfloat textureOneOverGamma,\nfloat split)\n{\nvec2 alphaMultiplier = step(textureCoordinateRectangle.st, tileTextureCoordinates);\ntextureAlpha = textureAlpha * alphaMultiplier.x * alphaMultiplier.y;\nalphaMultiplier = step(vec2(0.0), textureCoordinateRectangle.pq - tileTextureCoordinates);\ntextureAlpha = textureAlpha * alphaMultiplier.x * alphaMultiplier.y;\nvec2 translation = textureCoordinateTranslationAndScale.xy;\nvec2 scale = textureCoordinateTranslationAndScale.zw;\nvec2 textureCoordinates = tileTextureCoordinates * scale + translation;\nvec4 value = texture2D(textureToSample, textureCoordinates);\nvec3 color = value.rgb;\nfloat alpha = value.a;\n#if !defined(APPLY_GAMMA)\nvec4 tempColor = czm_gammaCorrect(vec4(color, alpha));\ncolor = tempColor.rgb;\nalpha = tempColor.a;\n#else\ncolor = pow(color, vec3(textureOneOverGamma));\n#endif\n#ifdef APPLY_SPLIT\nfloat splitPosition = czm_imagerySplitPosition;\nif (split < 0.0 && gl_FragCoord.x > splitPosition) {\nalpha = 0.0;\n}\nelse if (split > 0.0 && gl_FragCoord.x < splitPosition) {\nalpha = 0.0;\n}\n#endif\n#ifdef APPLY_BRIGHTNESS\ncolor = mix(vec3(0.0), color, textureBrightness);\n#endif\n#ifdef APPLY_CONTRAST\ncolor = mix(vec3(0.5), color, textureContrast);\n#endif\n#ifdef APPLY_HUE\ncolor = czm_hue(color, textureHue);\n#endif\n#ifdef APPLY_SATURATION\ncolor = czm_saturation(color, textureSaturation);\n#endif\nfloat sourceAlpha = alpha * textureAlpha;\nfloat outAlpha = mix(previousColor.a, 1.0, sourceAlpha);\nvec3 outColor = mix(previousColor.rgb * previousColor.a, color, sourceAlpha) / outAlpha;\nreturn vec4(outColor, outAlpha);\n}\nvec3 colorCorrect(vec3 rgb) {\n#ifdef COLOR_CORRECT\nvec3 hsb = czm_RGBToHSB(rgb);\nhsb.x += u_hsbShift.x;\nhsb.y = clamp(hsb.y + u_hsbShift.y, 0.0, 1.0);\nhsb.z = hsb.z > czm_epsilon7 ? hsb.z + u_hsbShift.z : 0.0;\nrgb = czm_HSBToRGB(hsb);\n#endif\nreturn rgb;\n}\nvec4 computeDayColor(vec4 initialColor, vec3 textureCoordinates);\nvec4 computeWaterColor(vec3 positionEyeCoordinates, vec2 textureCoordinates, mat3 enuToEye, vec4 imageryColor, float specularMapValue, float fade);\nvoid main()\n{\n#ifdef TILE_LIMIT_RECTANGLE\nif (v_textureCoordinates.x < u_cartographicLimitRectangle.x || u_cartographicLimitRectangle.z < v_textureCoordinates.x ||\nv_textureCoordinates.y < u_cartographicLimitRectangle.y || u_cartographicLimitRectangle.w < v_textureCoordinates.y)\n{\ndiscard;\n}\n#endif\n#ifdef ENABLE_CLIPPING_PLANES\nfloat clipDistance = clip(gl_FragCoord, u_clippingPlanes, u_clippingPlanesMatrix);\n#endif\nvec4 color = computeDayColor(u_initialColor, clamp(v_textureCoordinates, 0.0, 1.0));\n#ifdef SHOW_TILE_BOUNDARIES\nif (v_textureCoordinates.x < (1.0/256.0) || v_textureCoordinates.x > (255.0/256.0) ||\nv_textureCoordinates.y < (1.0/256.0) || v_textureCoordinates.y > (255.0/256.0))\n{\ncolor = vec4(1.0, 0.0, 0.0, 1.0);\n}\n#endif\n#if defined(SHOW_REFLECTIVE_OCEAN) || defined(ENABLE_DAYNIGHT_SHADING) || defined(HDR)\nvec3 normalMC = czm_geodeticSurfaceNormal(v_positionMC, vec3(0.0), vec3(1.0));\nvec3 normalEC = czm_normal3D * normalMC;\n#endif\n#if defined(ENABLE_DAYNIGHT_SHADING) || defined(GROUND_ATMOSPHERE)\nfloat cameraDist;\nif (czm_sceneMode == czm_sceneMode2D)\n{\ncameraDist = max(czm_frustumPlanes.x - czm_frustumPlanes.y, czm_frustumPlanes.w - czm_frustumPlanes.z) * 0.5;\n}\nelse if (czm_sceneMode == czm_sceneModeColumbusView)\n{\ncameraDist = -czm_view[3].z;\n}\nelse\n{\ncameraDist = length(czm_view[3]);\n}\nfloat fadeOutDist = u_lightingFadeDistance.x;\nfloat fadeInDist = u_lightingFadeDistance.y;\nif (czm_sceneMode != czm_sceneMode3D) {\nvec3 radii = czm_getWgs84EllipsoidEC().radii;\nfloat maxRadii = max(radii.x, max(radii.y, radii.z));\nfadeOutDist -= maxRadii;\nfadeInDist -= maxRadii;\n}\nfloat fade = clamp((cameraDist - fadeOutDist) / (fadeInDist - fadeOutDist), 0.0, 1.0);\n#else\nfloat fade = 0.0;\n#endif\n#ifdef SHOW_REFLECTIVE_OCEAN\nvec2 waterMaskTranslation = u_waterMaskTranslationAndScale.xy;\nvec2 waterMaskScale = u_waterMaskTranslationAndScale.zw;\nvec2 waterMaskTextureCoordinates = v_textureCoordinates.xy * waterMaskScale + waterMaskTranslation;\nwaterMaskTextureCoordinates.y = 1.0 - waterMaskTextureCoordinates.y;\nfloat mask = texture2D(u_waterMask, waterMaskTextureCoordinates).r;\nif (mask > 0.0)\n{\nmat3 enuToEye = czm_eastNorthUpToEyeCoordinates(v_positionMC, normalEC);\nvec2 ellipsoidTextureCoordinates = czm_ellipsoidWgs84TextureCoordinates(normalMC);\nvec2 ellipsoidFlippedTextureCoordinates = czm_ellipsoidWgs84TextureCoordinates(normalMC.zyx);\nvec2 textureCoordinates = mix(ellipsoidTextureCoordinates, ellipsoidFlippedTextureCoordinates, czm_morphTime * smoothstep(0.9, 0.95, normalMC.z));\ncolor = computeWaterColor(v_positionEC, textureCoordinates, enuToEye, color, mask, fade);\n}\n#endif\n#ifdef APPLY_MATERIAL\nczm_materialInput materialInput;\nmaterialInput.st = v_textureCoordinates.st;\nmaterialInput.normalEC = normalize(v_normalEC);\nmaterialInput.slope = v_slope;\nmaterialInput.height = v_height;\nczm_material material = czm_getMaterial(materialInput);\ncolor.xyz = mix(color.xyz, material.diffuse, material.alpha);\n#endif\n#ifdef ENABLE_VERTEX_LIGHTING\nfloat diffuseIntensity = clamp(czm_getLambertDiffuse(czm_sunDirectionEC, normalize(v_normalEC)) * 0.9 + 0.3, 0.0, 1.0);\nvec4 finalColor = vec4(color.rgb * diffuseIntensity, color.a);\n#elif defined(ENABLE_DAYNIGHT_SHADING)\nfloat diffuseIntensity = clamp(czm_getLambertDiffuse(czm_sunDirectionEC, normalEC) * 5.0 + 0.3, 0.0, 1.0);\ndiffuseIntensity = mix(1.0, diffuseIntensity, fade);\nvec4 finalColor = vec4(color.rgb * diffuseIntensity, color.a);\n#else\nvec4 finalColor = color;\n#endif\n#ifdef ENABLE_CLIPPING_PLANES\nvec4 clippingPlanesEdgeColor = vec4(1.0);\nclippingPlanesEdgeColor.rgb = u_clippingPlanesEdgeStyle.rgb;\nfloat clippingPlanesEdgeWidth = u_clippingPlanesEdgeStyle.a;\nif (clipDistance < clippingPlanesEdgeWidth)\n{\nfinalColor = clippingPlanesEdgeColor;\n}\n#endif\n#if defined(FOG) || defined(GROUND_ATMOSPHERE)\nvec3 fogColor = colorCorrect(v_fogMieColor) + finalColor.rgb * colorCorrect(v_fogRayleighColor);\n#ifndef HDR\nconst float fExposure = 2.0;\nfogColor = vec3(1.0) - exp(-fExposure * fogColor);\n#endif\n#endif\n#ifdef FOG\n#if defined(ENABLE_VERTEX_LIGHTING) || defined(ENABLE_DAYNIGHT_SHADING)\nfloat darken = clamp(dot(normalize(czm_viewerPositionWC), normalize(czm_sunPositionWC)), u_minimumBrightness, 1.0);\nfogColor *= darken;\n#endif\n#ifdef HDR\nconst float modifier = 0.15;\nfinalColor = vec4(czm_fog(v_distance, finalColor.rgb, fogColor, modifier), finalColor.a);\n#else\nfinalColor = vec4(czm_fog(v_distance, finalColor.rgb, fogColor), finalColor.a);\n#endif\n#endif\n#ifdef GROUND_ATMOSPHERE\nif (czm_sceneMode != czm_sceneMode3D)\n{\ngl_FragColor = finalColor;\nreturn;\n}\n#if defined(PER_FRAGMENT_GROUND_ATMOSPHERE) && (defined(ENABLE_DAYNIGHT_SHADING) || defined(ENABLE_VERTEX_LIGHTING))\nczm_ellipsoid ellipsoid = czm_getWgs84EllipsoidEC();\nfloat mpp = czm_metersPerPixel(vec4(0.0, 0.0, -czm_currentFrustum.x, 1.0));\nvec2 xy = gl_FragCoord.xy / czm_viewport.zw * 2.0 - vec2(1.0);\nxy *= czm_viewport.zw * mpp * 0.5;\nvec3 direction = normalize(vec3(xy, -czm_currentFrustum.x));\nczm_ray ray = czm_ray(vec3(0.0), direction);\nczm_raySegment intersection = czm_rayEllipsoidIntersectionInterval(ray, ellipsoid);\nvec3 ellipsoidPosition = czm_pointAlongRay(ray, intersection.start);\nellipsoidPosition = (czm_inverseView * vec4(ellipsoidPosition, 1.0)).xyz;\nAtmosphereColor atmosColor = computeGroundAtmosphereFromSpace(ellipsoidPosition, true);\nvec3 groundAtmosphereColor = colorCorrect(atmosColor.mie) + finalColor.rgb * colorCorrect(atmosColor.rayleigh);\n#ifndef HDR\ngroundAtmosphereColor = vec3(1.0) - exp(-fExposure * groundAtmosphereColor);\n#endif\nfadeInDist = u_nightFadeDistance.x;\nfadeOutDist = u_nightFadeDistance.y;\nfloat sunlitAtmosphereIntensity = clamp((cameraDist - fadeOutDist) / (fadeInDist - fadeOutDist), 0.0, 1.0);\n#ifdef HDR\nsunlitAtmosphereIntensity = max(sunlitAtmosphereIntensity * sunlitAtmosphereIntensity, 0.03);\n#endif\ngroundAtmosphereColor = mix(groundAtmosphereColor, fogColor, sunlitAtmosphereIntensity);\n#else\nvec3 groundAtmosphereColor = fogColor;\n#endif\n#ifdef HDR\ngroundAtmosphereColor = czm_saturation(groundAtmosphereColor, 1.6);\n#endif\nfinalColor = vec4(mix(finalColor.rgb, groundAtmosphereColor, fade), finalColor.a);\n#endif\ngl_FragColor = finalColor;\n}\n#ifdef SHOW_REFLECTIVE_OCEAN\nfloat waveFade(float edge0, float edge1, float x)\n{\nfloat y = clamp((x - edge0) / (edge1 - edge0), 0.0, 1.0);\nreturn pow(1.0 - y, 5.0);\n}\nfloat linearFade(float edge0, float edge1, float x)\n{\nreturn clamp((x - edge0) / (edge1 - edge0), 0.0, 1.0);\n}\nconst float oceanFrequencyLowAltitude = 825000.0;\nconst float oceanAnimationSpeedLowAltitude = 0.004;\nconst float oceanOneOverAmplitudeLowAltitude = 1.0 / 2.0;\nconst float oceanSpecularIntensity = 0.5;\nconst float oceanFrequencyHighAltitude = 125000.0;\nconst float oceanAnimationSpeedHighAltitude = 0.008;\nconst float oceanOneOverAmplitudeHighAltitude = 1.0 / 2.0;\nvec4 computeWaterColor(vec3 positionEyeCoordinates, vec2 textureCoordinates, mat3 enuToEye, vec4 imageryColor, float maskValue, float fade)\n{\nvec3 positionToEyeEC = -positionEyeCoordinates;\nfloat positionToEyeECLength = length(positionToEyeEC);\nvec3 normalizedpositionToEyeEC = normalize(normalize(positionToEyeEC));\nfloat waveIntensity = waveFade(70000.0, 1000000.0, positionToEyeECLength);\n#ifdef SHOW_OCEAN_WAVES\nfloat time = czm_frameNumber * oceanAnimationSpeedHighAltitude;\nvec4 noise = czm_getWaterNoise(u_oceanNormalMap, textureCoordinates * oceanFrequencyHighAltitude, time, 0.0);\nvec3 normalTangentSpaceHighAltitude = vec3(noise.xy, noise.z * oceanOneOverAmplitudeHighAltitude);\ntime = czm_frameNumber * oceanAnimationSpeedLowAltitude;\nnoise = czm_getWaterNoise(u_oceanNormalMap, textureCoordinates * oceanFrequencyLowAltitude, time, 0.0);\nvec3 normalTangentSpaceLowAltitude = vec3(noise.xy, noise.z * oceanOneOverAmplitudeLowAltitude);\nfloat highAltitudeFade = linearFade(0.0, 60000.0, positionToEyeECLength);\nfloat lowAltitudeFade = 1.0 - linearFade(20000.0, 60000.0, positionToEyeECLength);\nvec3 normalTangentSpace =\n(highAltitudeFade * normalTangentSpaceHighAltitude) +\n(lowAltitudeFade * normalTangentSpaceLowAltitude);\nnormalTangentSpace = normalize(normalTangentSpace);\nnormalTangentSpace.xy *= waveIntensity;\nnormalTangentSpace = normalize(normalTangentSpace);\n#else\nvec3 normalTangentSpace = vec3(0.0, 0.0, 1.0);\n#endif\nvec3 normalEC = enuToEye * normalTangentSpace;\nconst vec3 waveHighlightColor = vec3(0.3, 0.45, 0.6);\nfloat diffuseIntensity = czm_getLambertDiffuse(czm_sunDirectionEC, normalEC) * maskValue;\nvec3 diffuseHighlight = waveHighlightColor * diffuseIntensity * (1.0 - fade);\n#ifdef SHOW_OCEAN_WAVES\nfloat tsPerturbationRatio = normalTangentSpace.z;\nvec3 nonDiffuseHighlight = mix(waveHighlightColor * 5.0 * (1.0 - tsPerturbationRatio), vec3(0.0), diffuseIntensity);\n#else\nvec3 nonDiffuseHighlight = vec3(0.0);\n#endif\nfloat specularIntensity = czm_getSpecular(czm_sunDirectionEC, normalizedpositionToEyeEC, normalEC, 10.0) + 0.25 * czm_getSpecular(czm_moonDirectionEC, normalizedpositionToEyeEC, normalEC, 10.0);\nfloat surfaceReflectance = mix(0.0, mix(u_zoomedOutOceanSpecularIntensity, oceanSpecularIntensity, waveIntensity), maskValue);\nfloat specular = specularIntensity * surfaceReflectance;\n#ifdef HDR\nspecular *= 1.4;\nfloat e = 0.2;\nfloat d = 3.3;\nfloat c = 1.7;\nvec3 color = imageryColor.rgb + (c * (vec3(e) + imageryColor.rgb * d) * (diffuseHighlight + nonDiffuseHighlight + specular));\n#else\nvec3 color = imageryColor.rgb + diffuseHighlight + nonDiffuseHighlight + specular;\n#endif\nreturn vec4(color, imageryColor.a);\n}\n#endif // #ifdef SHOW_REFLECTIVE_OCEAN\n",Iue="#ifdef QUANTIZATION_BITS12\nattribute vec4 compressed0;\nattribute float compressed1;\n#else\nattribute vec4 position3DAndHeight;\nattribute vec4 textureCoordAndEncodedNormals;\n#endif\nuniform vec3 u_center3D;\nuniform mat4 u_modifiedModelView;\nuniform mat4 u_modifiedModelViewProjection;\nuniform vec4 u_tileRectangle;\nuniform vec2 u_southAndNorthLatitude;\nuniform vec2 u_southMercatorYAndOneOverHeight;\nvarying vec3 v_positionMC;\nvarying vec3 v_positionEC;\nvarying vec3 v_textureCoordinates;\nvarying vec3 v_normalMC;\nvarying vec3 v_normalEC;\n#ifdef APPLY_MATERIAL\nvarying float v_slope;\nvarying float v_height;\n#endif\n#if defined(FOG) || defined(GROUND_ATMOSPHERE)\nvarying float v_distance;\nvarying vec3 v_fogMieColor;\nvarying vec3 v_fogRayleighColor;\n#endif\nvec4 getPosition(vec3 position, float height, vec2 textureCoordinates);\nfloat get2DYPositionFraction(vec2 textureCoordinates);\nvec4 getPosition3DMode(vec3 position, float height, vec2 textureCoordinates)\n{\nreturn u_modifiedModelViewProjection * vec4(position, 1.0);\n}\nfloat get2DMercatorYPositionFraction(vec2 textureCoordinates)\n{\nconst float maxTileWidth = 0.003068;\nfloat positionFraction = textureCoordinates.y;\nfloat southLatitude = u_southAndNorthLatitude.x;\nfloat northLatitude = u_southAndNorthLatitude.y;\nif (northLatitude - southLatitude > maxTileWidth)\n{\nfloat southMercatorY = u_southMercatorYAndOneOverHeight.x;\nfloat oneOverMercatorHeight = u_southMercatorYAndOneOverHeight.y;\nfloat currentLatitude = mix(southLatitude, northLatitude, textureCoordinates.y);\ncurrentLatitude = clamp(currentLatitude, -czm_webMercatorMaxLatitude, czm_webMercatorMaxLatitude);\npositionFraction = czm_latitudeToWebMercatorFraction(currentLatitude, southMercatorY, oneOverMercatorHeight);\n}\nreturn positionFraction;\n}\nfloat get2DGeographicYPositionFraction(vec2 textureCoordinates)\n{\nreturn textureCoordinates.y;\n}\nvec4 getPositionPlanarEarth(vec3 position, float height, vec2 textureCoordinates)\n{\nfloat yPositionFraction = get2DYPositionFraction(textureCoordinates);\nvec4 rtcPosition2D = vec4(height, mix(u_tileRectangle.st, u_tileRectangle.pq, vec2(textureCoordinates.x, yPositionFraction)), 1.0);\nreturn u_modifiedModelViewProjection * rtcPosition2D;\n}\nvec4 getPosition2DMode(vec3 position, float height, vec2 textureCoordinates)\n{\nreturn getPositionPlanarEarth(position, 0.0, textureCoordinates);\n}\nvec4 getPositionColumbusViewMode(vec3 position, float height, vec2 textureCoordinates)\n{\nreturn getPositionPlanarEarth(position, height, textureCoordinates);\n}\nvec4 getPositionMorphingMode(vec3 position, float height, vec2 textureCoordinates)\n{\nvec3 position3DWC = position + u_center3D;\nfloat yPositionFraction = get2DYPositionFraction(textureCoordinates);\nvec4 position2DWC = vec4(height, mix(u_tileRectangle.st, u_tileRectangle.pq, vec2(textureCoordinates.x, yPositionFraction)), 1.0);\nvec4 morphPosition = czm_columbusViewMorph(position2DWC, vec4(position3DWC, 1.0), czm_morphTime);\nreturn czm_modelViewProjection * morphPosition;\n}\n#ifdef QUANTIZATION_BITS12\nuniform vec2 u_minMaxHeight;\nuniform mat4 u_scaleAndBias;\n#endif\nvoid main()\n{\n#ifdef QUANTIZATION_BITS12\nvec2 xy = czm_decompressTextureCoordinates(compressed0.x);\nvec2 zh = czm_decompressTextureCoordinates(compressed0.y);\nvec3 position = vec3(xy, zh.x);\nfloat height = zh.y;\nvec2 textureCoordinates = czm_decompressTextureCoordinates(compressed0.z);\nheight = height * (u_minMaxHeight.y - u_minMaxHeight.x) + u_minMaxHeight.x;\nposition = (u_scaleAndBias * vec4(position, 1.0)).xyz;\n#if (defined(ENABLE_VERTEX_LIGHTING) || defined(GENERATE_POSITION_AND_NORMAL)) && defined(INCLUDE_WEB_MERCATOR_Y)\nfloat webMercatorT = czm_decompressTextureCoordinates(compressed0.w).x;\nfloat encodedNormal = compressed1;\n#elif defined(INCLUDE_WEB_MERCATOR_Y)\nfloat webMercatorT = czm_decompressTextureCoordinates(compressed0.w).x;\nfloat encodedNormal = 0.0;\n#elif defined(ENABLE_VERTEX_LIGHTING) || defined(GENERATE_POSITION_AND_NORMAL)\nfloat webMercatorT = textureCoordinates.y;\nfloat encodedNormal = compressed0.w;\n#else\nfloat webMercatorT = textureCoordinates.y;\nfloat encodedNormal = 0.0;\n#endif\n#else\nvec3 position = position3DAndHeight.xyz;\nfloat height = position3DAndHeight.w;\nvec2 textureCoordinates = textureCoordAndEncodedNormals.xy;\n#if (defined(ENABLE_VERTEX_LIGHTING) || defined(GENERATE_POSITION_AND_NORMAL) || defined(APPLY_MATERIAL)) && defined(INCLUDE_WEB_MERCATOR_Y)\nfloat webMercatorT = textureCoordAndEncodedNormals.z;\nfloat encodedNormal = textureCoordAndEncodedNormals.w;\n#elif defined(ENABLE_VERTEX_LIGHTING) || defined(GENERATE_POSITION_AND_NORMAL) || defined(APPLY_MATERIAL)\nfloat webMercatorT = textureCoordinates.y;\nfloat encodedNormal = textureCoordAndEncodedNormals.z;\n#elif defined(INCLUDE_WEB_MERCATOR_Y)\nfloat webMercatorT = textureCoordAndEncodedNormals.z;\nfloat encodedNormal = 0.0;\n#else\nfloat webMercatorT = textureCoordinates.y;\nfloat encodedNormal = 0.0;\n#endif\n#endif\nvec3 position3DWC = position + u_center3D;\ngl_Position = getPosition(position, height, textureCoordinates);\nv_textureCoordinates = vec3(textureCoordinates, webMercatorT);\n#if defined(ENABLE_VERTEX_LIGHTING) || defined(GENERATE_POSITION_AND_NORMAL) || defined(APPLY_MATERIAL)\nv_positionEC = (u_modifiedModelView * vec4(position, 1.0)).xyz;\nv_positionMC = position3DWC;\nvec3 normalMC = czm_octDecode(encodedNormal);\nv_normalMC = normalMC;\nv_normalEC = czm_normal3D * v_normalMC;\n#elif defined(SHOW_REFLECTIVE_OCEAN) || defined(ENABLE_DAYNIGHT_SHADING) || defined(GENERATE_POSITION) || defined(HDR)\nv_positionEC = (u_modifiedModelView * vec4(position, 1.0)).xyz;\nv_positionMC = position3DWC;\n#endif\n#if defined(FOG) || defined(GROUND_ATMOSPHERE)\nAtmosphereColor atmosFogColor = computeGroundAtmosphereFromSpace(position3DWC, false);\nv_fogMieColor = atmosFogColor.mie;\nv_fogRayleighColor = atmosFogColor.rayleigh;\nv_distance = length((czm_modelView3D * vec4(position3DWC, 1.0)).xyz);\n#endif\n#ifdef APPLY_MATERIAL\nvec3 finalNormal = normalMC;\nvec3 ellipsoidNormal = normalize(position3DWC.xyz);\nv_slope = abs(dot(ellipsoidNormal, finalNormal));\nv_height = height;\n#endif\n}\n",Due="const float fInnerRadius = 6378137.0;\nconst float fOuterRadius = 6378137.0 * 1.025;\nconst float fOuterRadius2 = fOuterRadius * fOuterRadius;\nconst float Kr = 0.0025;\nconst float Km = 0.0015;\nconst float ESun = 15.0;\nconst float fKrESun = Kr * ESun;\nconst float fKmESun = Km * ESun;\nconst float fKr4PI = Kr * 4.0 * czm_pi;\nconst float fKm4PI = Km * 4.0 * czm_pi;\nconst float fScale = 1.0 / (fOuterRadius - fInnerRadius);\nconst float fScaleDepth = 0.25;\nconst float fScaleOverScaleDepth = fScale / fScaleDepth;\nstruct AtmosphereColor\n{\nvec3 mie;\nvec3 rayleigh;\n};\nconst int nSamples = 2;\nconst float fSamples = 2.0;\nfloat scale(float fCos)\n{\nfloat x = 1.0 - fCos;\nreturn fScaleDepth * exp(-0.00287 + x*(0.459 + x*(3.83 + x*(-6.80 + x*5.25))));\n}\nAtmosphereColor computeGroundAtmosphereFromSpace(vec3 v3Pos, bool useSunLighting)\n{\nvec3 v3InvWavelength = vec3(1.0 / pow(0.650, 4.0), 1.0 / pow(0.570, 4.0), 1.0 / pow(0.475, 4.0));\nvec3 v3Ray = v3Pos - czm_viewerPositionWC;\nfloat fFar = length(v3Ray);\nv3Ray /= fFar;\nfloat fCameraHeight = length(czm_viewerPositionWC);\nfloat fCameraHeight2 = fCameraHeight * fCameraHeight;\nfloat B = 2.0 * length(czm_viewerPositionWC) * dot(normalize(czm_viewerPositionWC), v3Ray);\nfloat C = fCameraHeight2 - fOuterRadius2;\nfloat fDet = max(0.0, B*B - 4.0 * C);\nfloat fNear = 0.5 * (-B - sqrt(fDet));\nvec3 v3Start = czm_viewerPositionWC + v3Ray * fNear;\nfFar -= fNear;\nfloat fDepth = exp((fInnerRadius - fOuterRadius) / fScaleDepth);\nfloat fLightAngle = useSunLighting ? dot(czm_sunDirectionWC, v3Pos) / length(v3Pos) : 1.0;\nfloat fCameraAngle = dot(-v3Ray, v3Pos) / length(v3Pos);\nfloat fCameraScale = scale(fCameraAngle);\nfloat fLightScale = scale(fLightAngle);\nfloat fCameraOffset = fDepth*fCameraScale;\nfloat fTemp = (fLightScale + fCameraScale);\nfloat fSampleLength = fFar / fSamples;\nfloat fScaledLength = fSampleLength * fScale;\nvec3 v3SampleRay = v3Ray * fSampleLength;\nvec3 v3SamplePoint = v3Start + v3SampleRay * 0.5;\nvec3 v3FrontColor = vec3(0.0);\nvec3 v3Attenuate = vec3(0.0);\nfor(int i=0; i<nSamples; i++)\n{\nfloat fHeight = length(v3SamplePoint);\nfloat fDepth = exp(fScaleOverScaleDepth * (fInnerRadius - fHeight));\nfloat fScatter = fDepth*fTemp - fCameraOffset;\nv3Attenuate = exp(-fScatter * (v3InvWavelength * fKr4PI + fKm4PI));\nv3FrontColor += v3Attenuate * (fDepth * fScaledLength);\nv3SamplePoint += v3SampleRay;\n}\nAtmosphereColor color;\ncolor.mie = v3FrontColor * (v3InvWavelength * fKrESun + fKmESun);\ncolor.rayleigh = v3Attenuate;\nreturn color;\n}\n";function jue(e,t,i,n,r){this.numberOfDayTextures=e,this.flags=t,this.material=i,this.shaderProgram=n,this.clippingShaderState=r}function Mue(){this.baseVertexShaderSource=void 0,this.baseFragmentShaderSource=void 0,this._shadersByTexturesFlags=[],this.material=void 0}Mue.prototype.getShaderProgram=function(e){var t=e.frameState,i=e.surfaceTile,n=e.numberOfDayTextures,r=e.applyBrightness,a=e.applyContrast,o=e.applyHue,s=e.applySaturation,c=e.applyGamma,l=e.applyAlpha,h=e.applySplit,d=e.showReflectiveOcean,f=e.showOceanWaves,p=e.enableLighting,m=e.showGroundAtmosphere,_=e.perFragmentGroundAtmosphere,g=e.hasVertexNormals,v=e.useWebMercatorProjection,b=e.enableFog,y=e.enableClippingPlanes,w=e.clippingPlanes,O=e.clippedByBoundaries,x=e.hasImageryLayerCutout,E=e.colorCorrect,T=0,C="",S=i.pickTerrain.mesh.encoding;S.quantization===kc.BITS12&&(T=1,C="QUANTIZATION_BITS12");var A=0,P="";i.terrainData._createdByUpsampling&&(A=1,P="DISABLE_GL_POSITION_LOG_DEPTH");var I=0,D="";O&&(I=1,D="TILE_LIMIT_RECTANGLE");var j=0,M="";x&&(j=1,M="APPLY_IMAGERY_CUTOUT");var R=t.mode,L=R|r<<2|a<<3|o<<4|s<<5|c<<6|l<<7|d<<8|f<<9|p<<10|m<<11|_<<12|g<<13|v<<14|b<<15|T<<16|h<<17|y<<18|A<<19|I<<20|j<<21|E<<22,N=0;Object(u.a)(w)&&w.length>0&&(N=y?w.clippingPlanesState:0);var F=i.surfaceShader;if(Object(u.a)(F)&&F.numberOfDayTextures===n&&F.flags===L&&F.material===this.material&&F.clippingShaderState===N)return F.shaderProgram;var k=this._shadersByTexturesFlags[n];if(Object(u.a)(k)||(k=this._shadersByTexturesFlags[n]=[]),F=k[L],!Object(u.a)(F)||F.material!==this.material||F.clippingShaderState!==N){var B=this.baseVertexShaderSource.clone(),z=this.baseFragmentShaderSource.clone();0!==N&&z.sources.unshift(_J(w,t.context)),B.defines.push(C,P),z.defines.push("TEXTURE_UNITS "+n,D,M),r&&z.defines.push("APPLY_BRIGHTNESS"),a&&z.defines.push("APPLY_CONTRAST"),o&&z.defines.push("APPLY_HUE"),s&&z.defines.push("APPLY_SATURATION"),c&&z.defines.push("APPLY_GAMMA"),l&&z.defines.push("APPLY_ALPHA"),d&&(z.defines.push("SHOW_REFLECTIVE_OCEAN"),B.defines.push("SHOW_REFLECTIVE_OCEAN")),f&&z.defines.push("SHOW_OCEAN_WAVES"),p&&(g?(B.defines.push("ENABLE_VERTEX_LIGHTING"),z.defines.push("ENABLE_VERTEX_LIGHTING")):(B.defines.push("ENABLE_DAYNIGHT_SHADING"),z.defines.push("ENABLE_DAYNIGHT_SHADING"))),m&&(B.defines.push("GROUND_ATMOSPHERE"),z.defines.push("GROUND_ATMOSPHERE"),_&&z.defines.push("PER_FRAGMENT_GROUND_ATMOSPHERE")),B.defines.push("INCLUDE_WEB_MERCATOR_Y"),z.defines.push("INCLUDE_WEB_MERCATOR_Y"),b&&(B.defines.push("FOG"),z.defines.push("FOG")),h&&z.defines.push("APPLY_SPLIT"),y&&z.defines.push("ENABLE_CLIPPING_PLANES"),E&&z.defines.push("COLOR_CORRECT");var U="    vec4 computeDayColor(vec4 initialColor, vec3 textureCoordinates)\n    {\n        vec4 color = initialColor;\n";x&&(U+="        vec4 cutoutAndColorResult;\n        bool texelUnclipped;\n");for(var V=0;V<n;++V)U+=x?"        cutoutAndColorResult = u_dayTextureCutoutRectangles["+V+"];\n        texelUnclipped = v_textureCoordinates.x < cutoutAndColorResult.x || cutoutAndColorResult.z < v_textureCoordinates.x || v_textureCoordinates.y < cutoutAndColorResult.y || cutoutAndColorResult.w < v_textureCoordinates.y;\n        cutoutAndColorResult = sampleAndBlend(\n":"        color = sampleAndBlend(\n",U+="            color,\n            u_dayTextures["+V+"],\n            u_dayTextureUseWebMercatorT["+V+"] ? textureCoordinates.xz : textureCoordinates.xy,\n            u_dayTextureTexCoordsRectangle["+V+"],\n            u_dayTextureTranslationAndScale["+V+"],\n            "+(l?"u_dayTextureAlpha["+V+"]":"1.0")+",\n            "+(r?"u_dayTextureBrightness["+V+"]":"0.0")+",\n            "+(a?"u_dayTextureContrast["+V+"]":"0.0")+",\n            "+(o?"u_dayTextureHue["+V+"]":"0.0")+",\n            "+(s?"u_dayTextureSaturation["+V+"]":"0.0")+",\n            "+(c?"u_dayTextureOneOverGamma["+V+"]":"0.0")+",\n            "+(h?"u_dayTextureSplit["+V+"]":"0.0")+"\n        );\n",x&&(U+="        color = czm_branchFreeTernary(texelUnclipped, cutoutAndColorResult, color);\n");U+="        return color;\n    }",z.sources.push(U),B.sources.push(function(e){var t;switch(e){case xF.SCENE3D:t="vec4 getPosition(vec3 position, float height, vec2 textureCoordinates) { return getPosition3DMode(position, height, textureCoordinates); }";break;case xF.SCENE2D:case xF.COLUMBUS_VIEW:t="vec4 getPosition(vec3 position, float height, vec2 textureCoordinates) { return getPositionColumbusViewMode(position, height, textureCoordinates); }";break;case xF.MORPHING:t="vec4 getPosition(vec3 position, float height, vec2 textureCoordinates) { return getPositionMorphingMode(position, height, textureCoordinates); }"}return t}(R)),B.sources.push(function(e){return e?"float get2DYPositionFraction(vec2 textureCoordinates) { return get2DMercatorYPositionFraction(textureCoordinates); }":"float get2DYPositionFraction(vec2 textureCoordinates) { return get2DGeographicYPositionFraction(textureCoordinates); }"}(v));var H=bR.fromCache({context:t.context,vertexShaderSource:B,fragmentShaderSource:z,attributeLocations:S.getAttributeLocations()});F=k[L]=new jue(n,L,this.material,H,N)}return i.surfaceShader=F,F.shaderProgram},Mue.prototype.destroy=function(){var e,t,i=this._shadersByTexturesFlags;for(var n in i)if(i.hasOwnProperty(n)){var r=i[n];if(!Object(u.a)(r))continue;for(e in r)r.hasOwnProperty(e)&&(t=r[e],Object(u.a)(t)&&t.shaderProgram.destroy())}return rl(this)};var Rue=Mue,Lue=Object(E.a)({UNLOADED:0,TRANSITIONING:1,RECEIVED:2,TEXTURE_LOADED:3,READY:4,FAILED:5,INVALID:6,PLACEHOLDER:7}),Nue=Object(E.a)({START:0,LOADING:1,DONE:2,FAILED:3}),Fue=Object(E.a)({FAILED:0,UNLOADED:1,RECEIVING:2,RECEIVED:3,TRANSFORMING:4,TRANSFORMED:5,READY:6});function kue(e){this.state=Fue.UNLOADED,this.data=void 0,this.mesh=void 0,this.vertexArray=void 0,this.upsampleDetails=e,this.request=void 0}function Bue(e,t,i,n,r,a){var o=i.tilingScheme,s=e.data.createMesh(o,n,r,a,t.terrainExaggeration);Object(u.a)(s)&&(e.state=Fue.TRANSFORMING,Object(Oi.a)(s,(function(t){e.mesh=t,e.state=Fue.TRANSFORMED}),(function(){e.state=Fue.FAILED})))}function zue(e,t,i,n,r,a){var o=e.mesh.vertices,s=ZN.createVertexBuffer({context:t,typedArray:o,usage:YN.STATIC_DRAW}),c=e.mesh.encoding.getAttributes(s),l=e.mesh.indices.indexBuffers||{},h=l[t.id];if(!Object(u.a)(h)||h.isDestroyed()){var d=e.mesh.indices,f=2===d.BYTES_PER_ELEMENT?Sl.UNSIGNED_SHORT:Sl.UNSIGNED_INT;(h=ZN.createIndexBuffer({context:t,typedArray:d,usage:YN.STATIC_DRAW,indexDatatype:f})).vertexArrayDestroyable=!1,h.referenceCount=1,l[t.id]=h,e.mesh.indices.indexBuffers=l}else++h.referenceCount;e.vertexArray=new tF({context:t,attributes:c,indexBuffer:h}),e.state=Fue.READY}kue.prototype.freeResources=function(){if(this.state=Fue.UNLOADED,this.data=void 0,this.mesh=void 0,Object(u.a)(this.vertexArray)){var e=this.vertexArray.indexBuffer;this.vertexArray.destroy(),this.vertexArray=void 0,!e.isDestroyed()&&Object(u.a)(e.referenceCount)&&(--e.referenceCount,0===e.referenceCount&&e.destroy())}},kue.prototype.publishToTile=function(e){var t=e.data,i=this.mesh;z.clone(i.center,t.center),t.minimumHeight=i.minimumHeight,t.maximumHeight=i.maximumHeight,t.boundingSphere3D=St.clone(i.boundingSphere3D,t.boundingSphere3D),t.orientedBoundingBox=Fc.clone(i.orientedBoundingBox,t.orientedBoundingBox),t.tileBoundingRegion.minimumHeight=i.minimumHeight,t.tileBoundingRegion.maximumHeight=i.maximumHeight,e.data.occludeePointInScaledSpace=z.clone(i.occludeePointInScaledSpace,t.occludeePointInScaledSpace)},kue.prototype.processLoadStateMachine=function(e,t,i,n,r,a){this.state===Fue.UNLOADED&&function(e,t,i,n,r,a){function o(t){e.data=t,e.state=Fue.RECEIVED,e.request=void 0}function s(){if(e.request.state===Fy.a.CANCELLED)return e.data=void 0,e.state=Fue.UNLOADED,void(e.request=void 0);e.state=Fue.FAILED,e.request=void 0;var a="Failed to obtain terrain tile X: "+i+" Y: "+n+" Level: "+r+".";t._requestError=uu.handleError(t._requestError,t,t.errorEvent,a,i,n,r,c)}function c(){var c=new Vl.a({throttle:!0,throttleByServer:!0,type:Hl.a.TERRAIN,priorityFunction:a});e.request=c,e.data=t.requestTileGeometry(i,n,r,c),Object(u.a)(e.data)?(e.state=Fue.RECEIVING,Object(Oi.a)(e.data,o,s)):(e.state=Fue.UNLOADED,e.request=void 0)}c()}(this,t,i,n,r,a),this.state===Fue.RECEIVED&&Bue(this,e,t,i,n,r),this.state===Fue.TRANSFORMED&&zue(this,e.context,t,i,n,r)},kue.prototype.processUpsampleStateMachine=function(e,t,i,n,r){if(this.state===Fue.UNLOADED){var a=this.upsampleDetails;if(!Object(u.a)(a))throw new h.a("TileTerrain cannot upsample unless provided upsampleDetails.");var o=a.data,s=a.x,c=a.y,l=a.level;if(this.data=o.upsample(t.tilingScheme,s,c,l,i,n,r),!Object(u.a)(this.data))return;this.state=Fue.RECEIVING;var d=this;Object(Oi.a)(this.data,(function(e){d.data=e,d.state=Fue.RECEIVED}),(function(){d.state=Fue.FAILED}))}this.state===Fue.RECEIVED&&Bue(this,e,t,i,n,r),this.state===Fue.TRANSFORMED&&zue(this,e.context,t,i,n,r)};var Uue=kue;function Vue(){this.imagery=[],this.waterMaskTexture=void 0,this.waterMaskTranslationAndScale=new Te(0,0,1,1),this.terrainData=void 0,this.center=new z,this.vertexArray=void 0,this.minimumHeight=0,this.maximumHeight=0,this.boundingSphere3D=new St,this.boundingSphere2D=new St,this.orientedBoundingBox=void 0,this.tileBoundingRegion=void 0,this.occludeePointInScaledSpace=new z,this.loadedTerrain=void 0,this.upsampledTerrain=void 0,this.pickBoundingSphere=new St,this.pickTerrain=void 0,this.surfaceShader=void 0,this.isClipped=!0,this.clippedByBoundaries=!1}function Hue(e,t,i,n,r,a){if(e.decodePosition(n,r,a),Object(u.a)(t)&&t!==xF.SCENE3D){var o=i.ellipsoid.cartesianToCartographic(a);i.project(o,a),z.fromElements(a.z,a.x,a.y,a)}return a}Object(O.a)(Vue.prototype,{eligibleForUnloading:{get:function(){for(var e=this.loadedTerrain,t=Object(u.a)(e)&&(e.state===Fue.RECEIVING||e.state===Fue.TRANSFORMING),i=this.upsampledTerrain,n=Object(u.a)(i)&&(i.state===Fue.RECEIVING||i.state===Fue.TRANSFORMING),r=!t&&!n,a=this.imagery,o=0,s=a.length;r&&o<s;++o){var c=a[o];r=!Object(u.a)(c.loadingImagery)||c.loadingImagery.state!==Lue.TRANSITIONING}return r}}});var Gue=new z,que=new z,Wue=new z,Yue=new z;function Xue(e,t){if(Object(u.a)(t)&&t.state!==Nue.START){var i=t.data;if(Object(u.a)(i.terrainData)&&!i.terrainData.wasCreatedByUpsampling())return;Object(u.a)(i.upsampledTerrain)&&i.upsampledTerrain.freeResources(),i.upsampledTerrain=new Uue({data:e.data.terrainData,x:e.x,y:e.y,level:e.level}),t.state=Nue.LOADING}}function Zue(e,t,i){if(i.state!==Nue.START){var n=i.data;if(Object(u.a)(n.terrainData)&&!n.terrainData.wasCreatedByUpsampling())return;Object(u.a)(n.upsampledTerrain)&&n.upsampledTerrain.freeResources(),n.upsampledTerrain=new Uue({data:t.terrainData,x:e.x,y:e.y,level:e.level}),t.terrainData.isChildAvailable(e.x,e.y,i.x,i.y)&&(Object(u.a)(n.loadedTerrain)||(n.loadedTerrain=new Uue)),i.state=Nue.LOADING}}Vue.prototype.pick=function(e,t,i,n,r){var a=this.pickTerrain;if(Object(u.a)(a)){var o=a.mesh;if(Object(u.a)(o))for(var s=o.vertices,c=o.indices,l=o.encoding,h=c.length,d=0;d<h;d+=3){var f=c[d],p=c[d+1],m=c[d+2],_=Hue(l,t,i,s,f,Gue),g=Hue(l,t,i,s,p,que),v=Hue(l,t,i,s,m,Wue),b=tc.rayTriangle(e,_,g,v,n,Yue);if(Object(u.a)(b))return z.clone(b,r)}}},Vue.prototype.freeResources=function(){var e,t;Object(u.a)(this.waterMaskTexture)&&(--this.waterMaskTexture.referenceCount,0===this.waterMaskTexture.referenceCount&&this.waterMaskTexture.destroy(),this.waterMaskTexture=void 0),this.terrainData=void 0,Object(u.a)(this.loadedTerrain)&&(this.loadedTerrain.freeResources(),this.loadedTerrain=void 0),Object(u.a)(this.upsampledTerrain)&&(this.upsampledTerrain.freeResources(),this.upsampledTerrain=void 0),Object(u.a)(this.pickTerrain)&&(this.pickTerrain.freeResources(),this.pickTerrain=void 0);var i=this.imagery;for(e=0,t=i.length;e<t;++e)i[e].freeResources();this.imagery.length=0,this.freeVertexArray()},Vue.prototype.freeVertexArray=function(){var e;Object(u.a)(this.vertexArray)&&(e=this.vertexArray.indexBuffer,this.vertexArray=this.vertexArray.destroy(),!e.isDestroyed()&&Object(u.a)(e.referenceCount)&&(--e.referenceCount,0===e.referenceCount&&e.destroy())),Object(u.a)(this.wireframeVertexArray)&&(e=this.wireframeVertexArray.indexBuffer,this.wireframeVertexArray=this.wireframeVertexArray.destroy(),!e.isDestroyed()&&Object(u.a)(e.referenceCount)&&(--e.referenceCount,0===e.referenceCount&&e.destroy()))},Vue.processStateMachine=function(e,t,i,n,r){var a=e.data;Object(u.a)(a)||((a=e.data=new Vue).tileBoundingRegion=function(e){var t,i;return Object(u.a)(e.parent)&&Object(u.a)(e.parent.data)&&(t=e.parent.data.minimumHeight,i=e.parent.data.maximumHeight),new B4({rectangle:e.rectangle,ellipsoid:e.tilingScheme.ellipsoid,minimumHeight:t,maximumHeight:i})}(e)),Object(u.a)(e._priorityFunction)||(e._priorityFunction=function(e,t){return function(){return e.tileBoundingRegion.distanceToCamera(t)}}(a,t)),e.state===Nue.START&&(!function(e,t,i){var n=e.data,r=function(e){var t=e.parent;for(;Object(u.a)(t)&&Object(u.a)(t.data)&&!Object(u.a)(t.data.terrainData);)t=t.parent;if(!Object(u.a)(t)||!Object(u.a)(t.data))return;return{data:t.data.terrainData,x:t.x,y:t.y,level:t.level}}(e);Object(u.a)(r)&&(n.upsampledTerrain=new Uue(r));(function(e,t){var i=t.getTileDataAvailable(e.x,e.y,e.level);if(Object(u.a)(i))return i;var n=e.parent;if(!Object(u.a)(n))return!0;if(!Object(u.a)(n.data)||!Object(u.a)(n.data.terrainData))return!1;return n.data.terrainData.isChildAvailable(n.x,n.y,e.x,e.y)})(e,t)&&(n.loadedTerrain=new Uue);for(var a=0,o=i.length;a<o;++a){var s=i.get(a);s.show&&s._createTileImagerySkeletons(e,t)}}(e,i,n),e.state=Nue.LOADING),e.state===Nue.LOADING&&function(e,t,i,n){var r=e.data,a=r.loadedTerrain,o=r.upsampledTerrain,s=!1;Object(u.a)(a)&&(a.processLoadStateMachine(t,i,e.x,e.y,e.level,e._priorityFunction),a.state>=Fue.RECEIVED&&(r.terrainData!==a.data&&(r.terrainData=a.data,function(e,t){var i=t.waterMaskTexture;Object(u.a)(i)&&(--i.referenceCount,0===i.referenceCount&&i.destroy(),t.waterMaskTexture=void 0);var n=t.terrainData.waterMask;if(!Object(u.a)(n))return;var r,a=function(e){var t=e.cache.tile_waterMaskData;if(!Object(u.a)(t)){var i=new hj({context:e,pixelFormat:gx.LUMINANCE,pixelDatatype:mx.UNSIGNED_BYTE,source:{arrayBufferView:new Uint8Array([255]),width:1,height:1}});i.referenceCount=1;var n=new tj({wrapS:$D.CLAMP_TO_EDGE,wrapT:$D.CLAMP_TO_EDGE,minificationFilter:KD.LINEAR,magnificationFilter:ZD.LINEAR});t={allWaterTexture:i,sampler:n,destroy:function(){this.allWaterTexture.destroy()}},e.cache.tile_waterMaskData=t}return t}(e),o=n.length;if(1===o){if(0===n[0])return;r=a.allWaterTexture}else{var s=Math.sqrt(o);(r=new hj({context:e,pixelFormat:gx.LUMINANCE,pixelDatatype:mx.UNSIGNED_BYTE,source:{width:s,height:s,arrayBufferView:n},sampler:a.sampler,flipY:!1})).referenceCount=0}++r.referenceCount,t.waterMaskTexture=r,Te.fromElements(0,0,1,1,t.waterMaskTranslationAndScale)}(t.context,r),function(e){var t=e.data;Zue(e,t,e.southwestChild),Zue(e,t,e.southeastChild),Zue(e,t,e.northwestChild),Zue(e,t,e.northeastChild)}(e)),s=!0),a.state===Fue.READY?(a.publishToTile(e),Object(u.a)(e.data.vertexArray)&&n.push(e.data.vertexArray),e.data.vertexArray=a.vertexArray,a.vertexArray=void 0,r.pickTerrain=Object(w.a)(r.loadedTerrain,r.upsampledTerrain),r.loadedTerrain=void 0,r.upsampledTerrain=void 0):a.state===Fue.FAILED&&(r.loadedTerrain=void 0));!s&&Object(u.a)(o)&&(o.processUpsampleStateMachine(t,i,e.x,e.y,e.level),o.state>=Fue.RECEIVED&&r.terrainData!==o.data&&(r.terrainData=o.data,i.hasWaterMask&&function(e){var t=e.data,i=e.parent;for(;Object(u.a)(i)&&!Object(u.a)(i.data.terrainData)||i.data.terrainData.wasCreatedByUpsampling();)i=i.parent;if(!Object(u.a)(i)||!Object(u.a)(i.data.waterMaskTexture))return;t.waterMaskTexture=i.data.waterMaskTexture,++t.waterMaskTexture.referenceCount;var n=i.rectangle,r=e.rectangle,a=r.width,o=r.height,s=a/n.width,c=o/n.height;t.waterMaskTranslationAndScale.x=s*(r.west-n.west)/a,t.waterMaskTranslationAndScale.y=c*(r.south-n.south)/o,t.waterMaskTranslationAndScale.z=s,t.waterMaskTranslationAndScale.w=c}(e),function(e){Xue(e,e._southwestChild),Xue(e,e._southeastChild),Xue(e,e._northwestChild),Xue(e,e._northeastChild)}(e)),o.state===Fue.READY?(o.publishToTile(e),Object(u.a)(e.data.vertexArray)&&n.push(e.data.vertexArray),e.data.vertexArray=o.vertexArray,o.vertexArray=void 0,r.pickTerrain=r.upsampledTerrain,r.upsampledTerrain=void 0):o.state===Fue.FAILED&&(r.upsampledTerrain=void 0))}(e,t,i,r);var o,s,c=Object(u.a)(a.vertexArray),l=!Object(u.a)(a.loadedTerrain)&&!Object(u.a)(a.upsampledTerrain),h=Object(u.a)(a.terrainData)&&a.terrainData.wasCreatedByUpsampling(),d=a.imagery;for(o=0,s=d.length;o<s;++o){var f=d[o];if(Object(u.a)(f.loadingImagery)){if(f.loadingImagery.state===Lue.PLACEHOLDER){var p=f.loadingImagery.imageryLayer;if(p.imageryProvider.ready){f.freeResources(),d.splice(o,1),p._createTileImagerySkeletons(e,i,o),--o,s=d.length;continue}h=!1}var m=f.processStateMachine(e,t);l=l&&m,c=c&&(m||Object(u.a)(f.readyImagery)),h=h&&Object(u.a)(f.loadingImagery)&&(f.loadingImagery.state===Lue.FAILED||f.loadingImagery.state===Lue.INVALID)}else h=!1}if(e.upsampledFromParent=h,o===s&&(c&&(e.renderable=!0),l)){var _=e._loadedCallbacks,g={};for(var v in _)_.hasOwnProperty(v)&&(_[v](e)||(g[v]=_[v]));e._loadedCallbacks=g,e.state=Nue.DONE,e._priorityFunction=void 0}};var Que=Vue,Kue="uniform sampler2D u_texture;\nvarying vec2 v_textureCoordinates;\nvoid main()\n{\ngl_FragColor = texture2D(u_texture, v_textureCoordinates);\n}\n",Jue="attribute vec4 position;\nattribute float webMercatorT;\nuniform vec2 u_textureDimensions;\nvarying vec2 v_textureCoordinates;\nvoid main()\n{\nv_textureCoordinates = vec2(position.x, webMercatorT);\ngl_Position = czm_viewportOrthographic * (position * vec4(u_textureDimensions, 1.0, 1.0));\n}\n";function $ue(e,t,i,n,r){if(this.imageryLayer=e,this.x=t,this.y=i,this.level=n,this.request=void 0,0!==n){var a=t/2|0,o=i/2|0,s=n-1;this.parent=e.getImageryFromCache(a,o,s)}(this.state=Lue.UNLOADED,this.imageUrl=void 0,this.image=void 0,this.texture=void 0,this.textureWebMercator=void 0,this.credits=void 0,this.referenceCount=0,!Object(u.a)(r)&&e.imageryProvider.ready)&&(r=e.imageryProvider.tilingScheme.tileXYToRectangle(t,i,n));this.rectangle=r}$ue.createPlaceholder=function(e){var t=new $ue(e,0,0,0);return t.addReference(),t.state=Lue.PLACEHOLDER,t},$ue.prototype.addReference=function(){++this.referenceCount},$ue.prototype.releaseReference=function(){return--this.referenceCount,0===this.referenceCount?(this.imageryLayer.removeImageryFromCache(this),Object(u.a)(this.parent)&&this.parent.releaseReference(),Object(u.a)(this.image)&&Object(u.a)(this.image.destroy)&&this.image.destroy(),Object(u.a)(this.texture)&&this.texture.destroy(),Object(u.a)(this.textureWebMercator)&&this.texture!==this.textureWebMercator&&this.textureWebMercator.destroy(),rl(this),0):this.referenceCount},$ue.prototype.processStateMachine=function(e,t,i){this.state===Lue.UNLOADED&&(this.state=Lue.TRANSITIONING,this.imageryLayer._requestImagery(this,i)),this.state===Lue.RECEIVED&&(this.state=Lue.TRANSITIONING,this.imageryLayer._createTexture(e.context,this));var n=this.state===Lue.READY&&t&&!this.texture;(this.state===Lue.TEXTURE_LOADED||n)&&(this.state=Lue.TRANSITIONING,this.imageryLayer._reprojectTexture(e,this,t))};var ehe=$ue,the=Object(E.a)({LEFT:-1,NONE:0,RIGHT:1});function ihe(e,t,i){this.readyImagery=void 0,this.loadingImagery=e,this.textureCoordinateRectangle=t,this.textureTranslationAndScale=void 0,this.useWebMercatorT=i}ihe.prototype.freeResources=function(){Object(u.a)(this.readyImagery)&&this.readyImagery.releaseReference(),Object(u.a)(this.loadingImagery)&&this.loadingImagery.releaseReference()},ihe.prototype.processStateMachine=function(e,t){var i=this.loadingImagery,n=i.imageryLayer;if(i.processStateMachine(t,!this.useWebMercatorT,e._priorityFunction),i.state===Lue.READY)return Object(u.a)(this.readyImagery)&&this.readyImagery.releaseReference(),this.readyImagery=this.loadingImagery,this.loadingImagery=void 0,this.textureTranslationAndScale=n._calculateTextureTranslationAndScale(e,this),!0;for(var r,a=i.parent;Object(u.a)(a)&&(a.state!==Lue.READY||!this.useWebMercatorT&&!Object(u.a)(a.texture));)a.state!==Lue.FAILED&&a.state!==Lue.INVALID&&(r=r||a),a=a.parent;return this.readyImagery!==a&&(Object(u.a)(this.readyImagery)&&this.readyImagery.releaseReference(),this.readyImagery=a,Object(u.a)(a)&&(a.addReference(),this.textureTranslationAndScale=n._calculateTextureTranslationAndScale(e,this))),(i.state===Lue.FAILED||i.state===Lue.INVALID)&&(!Object(u.a)(r)||(r.processStateMachine(t,!this.useWebMercatorT,e._priorityFunction),!1))};var nhe=ihe;function rhe(e,t){this._imageryProvider=e,t=Object(w.a)(t,{}),this.alpha=Object(w.a)(t.alpha,Object(w.a)(e.defaultAlpha,1)),this.brightness=Object(w.a)(t.brightness,Object(w.a)(e.defaultBrightness,rhe.DEFAULT_BRIGHTNESS)),this.contrast=Object(w.a)(t.contrast,Object(w.a)(e.defaultContrast,rhe.DEFAULT_CONTRAST)),this.hue=Object(w.a)(t.hue,Object(w.a)(e.defaultHue,rhe.DEFAULT_HUE)),this.saturation=Object(w.a)(t.saturation,Object(w.a)(e.defaultSaturation,rhe.DEFAULT_SATURATION)),this.gamma=Object(w.a)(t.gamma,Object(w.a)(e.defaultGamma,rhe.DEFAULT_GAMMA)),this.splitDirection=Object(w.a)(t.splitDirection,Object(w.a)(e.defaultSplit,rhe.DEFAULT_SPLIT)),this.minificationFilter=Object(w.a)(t.minificationFilter,Object(w.a)(e.defaultMinificationFilter,rhe.DEFAULT_MINIFICATION_FILTER)),this.magnificationFilter=Object(w.a)(t.magnificationFilter,Object(w.a)(e.defaultMagnificationFilter,rhe.DEFAULT_MAGNIFICATION_FILTER)),this.show=Object(w.a)(t.show,!0),this._minimumTerrainLevel=t.minimumTerrainLevel,this._maximumTerrainLevel=t.maximumTerrainLevel,this._rectangle=Object(w.a)(t.rectangle,Ve.MAX_VALUE),this._maximumAnisotropy=t.maximumAnisotropy,this._imageryCache={},this._skeletonPlaceholder=new nhe(ehe.createPlaceholder(this)),this._show=!0,this._layerIndex=-1,this._isBaseLayer=!1,this._requestImageError=void 0,this._reprojectComputeCommands=[],this.cutoutRectangle=t.cutoutRectangle}Object(O.a)(rhe.prototype,{imageryProvider:{get:function(){return this._imageryProvider}},rectangle:{get:function(){return this._rectangle}}}),rhe.DEFAULT_BRIGHTNESS=1,rhe.DEFAULT_CONTRAST=1,rhe.DEFAULT_HUE=0,rhe.DEFAULT_SATURATION=1,rhe.DEFAULT_GAMMA=1,rhe.DEFAULT_SPLIT=the.NONE,rhe.DEFAULT_MINIFICATION_FILTER=KD.LINEAR,rhe.DEFAULT_MAGNIFICATION_FILTER=ZD.LINEAR,rhe.prototype.isBaseLayer=function(){return this._isBaseLayer},rhe.prototype.isDestroyed=function(){return!1},rhe.prototype.destroy=function(){return rl(this)};var ahe=new Ve,ohe=new Ve,she=new Ve,che=new Ve;function lhe(e,t,i){return e+":"+t+":"+i}function uhe(e,t,i,n){var r=e.minificationFilter,a=e.magnificationFilter;if(r===KD.LINEAR&&a===ZD.LINEAR&&!gx.isCompressedFormat(n.pixelFormat)&&I.isPowerOfTwo(n.width)&&I.isPowerOfTwo(n.height)){r=KD.LINEAR_MIPMAP_LINEAR;var o=HD.maximumTextureFilterAnisotropy,s=Math.min(o,Object(w.a)(e._maximumAnisotropy,o)),c=lhe(r,a,s),l=t.cache.imageryLayerMipmapSamplers;Object(u.a)(l)||(l={},t.cache.imageryLayerMipmapSamplers=l);var h=l[c];Object(u.a)(h)||(h=l[c]=new tj({wrapS:$D.CLAMP_TO_EDGE,wrapT:$D.CLAMP_TO_EDGE,minificationFilter:r,magnificationFilter:a,maximumAnisotropy:s})),n.generateMipmap(YD.NICEST),n.sampler=h}else{var d=lhe(r,a,0),f=t.cache.imageryLayerNonMipmapSamplers;Object(u.a)(f)||(f={},t.cache.imageryLayerNonMipmapSamplers=f);var p=f[d];Object(u.a)(p)||(p=f[d]=new tj({wrapS:$D.CLAMP_TO_EDGE,wrapT:$D.CLAMP_TO_EDGE,minificationFilter:r,magnificationFilter:a})),n.sampler=p}i.state=Lue.READY}function hhe(e,t,i){return JSON.stringify([e,t,i])}rhe.prototype.getViewableRectangle=function(){var e=this._imageryProvider,t=this._rectangle;return e.readyPromise.then((function(){return Ve.intersection(e.rectangle,t)}))},rhe.prototype._createTileImagerySkeletons=function(e,t,i){var n=e.data;if(Object(u.a)(this._minimumTerrainLevel)&&e.level<this._minimumTerrainLevel)return!1;if(Object(u.a)(this._maximumTerrainLevel)&&e.level>this._maximumTerrainLevel)return!1;var r=this._imageryProvider;if(Object(u.a)(i)||(i=n.imagery.length),!r.ready)return this._skeletonPlaceholder.loadingImagery.addReference(),n.imagery.splice(i,0,this._skeletonPlaceholder),!0;var a=r.tilingScheme.projection instanceof Qc&&e.rectangle.north<Qc.MaximumLatitude&&e.rectangle.south>-Qc.MaximumLatitude,o=Ve.intersection(r.rectangle,this._rectangle,ahe),s=Ve.intersection(e.rectangle,o,ohe);if(!Object(u.a)(s)){if(!this.isBaseLayer())return!1;var c=o,l=e.rectangle;s=ohe,l.south>=c.north?s.north=s.south=c.north:l.north<=c.south?s.north=s.south=c.south:(s.south=Math.max(l.south,c.south),s.north=Math.min(l.north,c.north)),l.west>=c.east?s.west=s.east=c.east:l.east<=c.west?s.west=s.east=c.west:(s.west=Math.max(l.west,c.west),s.east=Math.min(l.east,c.east))}var h=0;s.south>0?h=s.south:s.north<0&&(h=s.north);var d=function(e,t,i){var n=e._imageryProvider,r=n.tilingScheme,a=r.ellipsoid,o=e._imageryProvider.tilingScheme.projection instanceof se?1:Math.cos(i),s=r.rectangle,c=a.maximumRadius*s.width*o/(n.tileWidth*r.getNumberOfXTilesAtLevel(0))/t,l=Math.log(c)/Math.log(2);return 0|Math.round(l)}(this,1*t.getLevelMaximumGeometricError(e.level),h);d=Math.max(0,d);var f=r.maximumLevel;if(d>f&&(d=f),Object(u.a)(r.minimumLevel)){var p=r.minimumLevel;d<p&&(d=p)}var m=r.tilingScheme,_=m.positionToTileXY(Ve.northwest(s),d),g=m.positionToTileXY(Ve.southeast(s),d),v=e.rectangle.width/512,b=e.rectangle.height/512,y=m.tileXYToRectangle(_.x,_.y,d);Math.abs(y.south-e.rectangle.north)<b&&_.y<g.y&&++_.y,Math.abs(y.east-e.rectangle.west)<v&&_.x<g.x&&++_.x;var w=m.tileXYToRectangle(g.x,g.y,d);Math.abs(w.north-e.rectangle.south)<b&&g.y>_.y&&--g.y,Math.abs(w.west-e.rectangle.east)<v&&g.x>_.x&&--g.x;var O,x,E=Ve.clone(e.rectangle,che),T=m.tileXYToRectangle(_.x,_.y,d),C=Ve.intersection(T,o,she);a?(m.rectangleToNativeRectangle(E,E),m.rectangleToNativeRectangle(T,T),m.rectangleToNativeRectangle(C,C),m.rectangleToNativeRectangle(o,o),O=m.tileXYToNativeRectangle.bind(m),v=E.width/512,b=E.height/512):O=m.tileXYToRectangle.bind(m);var S,A=0,P=1;!this.isBaseLayer()&&Math.abs(C.west-E.west)>=v&&(A=Math.min(1,(C.west-E.west)/E.width)),!this.isBaseLayer()&&Math.abs(C.north-E.north)>=b&&(P=Math.max(0,(C.north-E.south)/E.height));for(var I=P,D=_.x;D<=g.x;D++)if(x=A,T=O(D,_.y,d),C=Ve.simpleIntersection(T,o,she),Object(u.a)(C)){A=Math.min(1,(C.east-E.west)/E.width),D===g.x&&(this.isBaseLayer()||Math.abs(C.east-E.east)<v)&&(A=1),P=I;for(var j=_.y;j<=g.y;j++)if(S=P,T=O(D,j,d),C=Ve.simpleIntersection(T,o,she),Object(u.a)(C)){P=Math.max(0,(C.south-E.south)/E.height),j===g.y&&(this.isBaseLayer()||Math.abs(C.south-E.south)<b)&&(P=0);var M=new Te(x,P,A,S),R=this.getImageryFromCache(D,j,d);n.imagery.splice(i,0,new nhe(R,M,a)),++i}}return!0},rhe.prototype._calculateTextureTranslationAndScale=function(e,t){var i=t.readyImagery.rectangle,n=e.rectangle;if(t.useWebMercatorT){var r=t.readyImagery.imageryLayer.imageryProvider.tilingScheme;i=r.rectangleToNativeRectangle(i,ahe),n=r.rectangleToNativeRectangle(n,che)}var a=n.width,o=n.height,s=a/i.width,c=o/i.height;return new Te(s*(n.west-i.west)/a,c*(n.south-i.south)/o,s,c)},rhe.prototype._requestImagery=function(e,t){var i=this._imageryProvider,n=this;function r(t){if(!Object(u.a)(t))return a();e.image=t,e.state=Lue.RECEIVED,e.request=void 0,uu.handleSuccess(n._requestImageError)}function a(t){if(e.request.state===Fy.a.CANCELLED)return e.state=Lue.UNLOADED,void(e.request=void 0);e.state=Lue.FAILED,e.request=void 0;var r="Failed to obtain image tile X: "+e.x+" Y: "+e.y+" Level: "+e.level+".";n._requestImageError=uu.handleError(n._requestImageError,i,i.errorEvent,r,e.x,e.y,e.level,o,t)}function o(){var n=new Vl.a({throttle:!0,throttleByServer:!0,type:Hl.a.IMAGERY,priorityFunction:t});e.request=n,e.state=Lue.TRANSITIONING;var o=i.requestImage(e.x,e.y,e.level,n);if(!Object(u.a)(o))return e.state=Lue.UNLOADED,void(e.request=void 0);Object(u.a)(i.getTileCredits)&&(e.credits=i.getTileCredits(e.x,e.y,e.level)),Object(Oi.a)(o,r,a)}o()},rhe.prototype._createTexture=function(e,t){var i=this._imageryProvider,n=t.image;if(Object(u.a)(i.tileDiscardPolicy)){var r=i.tileDiscardPolicy;if(Object(u.a)(r)){if(!r.isReady())return void(t.state=Lue.RECEIVED);if(r.shouldDiscardImage(n))return void(t.state=Lue.INVALID)}}if(this.minificationFilter!==KD.NEAREST&&this.minificationFilter!==KD.LINEAR)throw new h.a("ImageryLayer minification filter must be NEAREST or LINEAR");var a,o=new tj({minificationFilter:this.minificationFilter,magnificationFilter:this.magnificationFilter});a=Object(u.a)(n.internalFormat)?new hj({context:e,pixelFormat:n.internalFormat,width:n.width,height:n.height,source:{arrayBufferView:n.bufferView},sampler:o}):new hj({context:e,source:n,pixelFormat:i.hasAlphaChannel?gx.RGBA:gx.RGB,sampler:o}),i.tilingScheme.projection instanceof Qc?t.textureWebMercator=a:t.texture=a,t.image=void 0,t.state=Lue.TEXTURE_LOADED},rhe.prototype._reprojectTexture=function(e,t,i){var n=t.textureWebMercator||t.texture,r=t.rectangle,a=e.context;if((i=Object(w.a)(i,!0))&&!(this._imageryProvider.tilingScheme.projection instanceof se)&&r.width/n.width>1e-5){var o=this;t.addReference();var s=new OX({persists:!0,owner:this,preExecute:function(e){!function(e,t,i,n){var r=t.cache.imageryLayer_reproject;if(!Object(u.a)(r)){r=t.cache.imageryLayer_reproject={vertexArray:void 0,shaderProgram:void 0,sampler:void 0,destroy:function(){Object(u.a)(this.framebuffer)&&this.framebuffer.destroy(),Object(u.a)(this.vertexArray)&&this.vertexArray.destroy(),Object(u.a)(this.shaderProgram)&&this.shaderProgram.destroy()}};for(var a=new Float32Array(256),o=0,s=0;s<64;++s){var c=s/63;a[o++]=0,a[o++]=c,a[o++]=1,a[o++]=c}var l={position:0,webMercatorT:1},h=vl.getRegularGridIndices(2,64),d=ZN.createIndexBuffer({context:t,typedArray:h,usage:YN.STATIC_DRAW,indexDatatype:Sl.UNSIGNED_SHORT});r.vertexArray=new tF({context:t,attributes:[{index:l.position,vertexBuffer:ZN.createVertexBuffer({context:t,typedArray:a,usage:YN.STATIC_DRAW}),componentsPerAttribute:2},{index:l.webMercatorT,vertexBuffer:ZN.createVertexBuffer({context:t,sizeInBytes:512,usage:YN.STREAM_DRAW}),componentsPerAttribute:1}],indexBuffer:d});var f=new UN({sources:[Jue]});r.shaderProgram=bR.fromCache({context:t,vertexShaderSource:f,fragmentShaderSource:Kue,attributeLocations:l}),r.sampler=new tj({wrapS:$D.CLAMP_TO_EDGE,wrapT:$D.CLAMP_TO_EDGE,minificationFilter:KD.LINEAR,magnificationFilter:ZD.LINEAR})}i.sampler=r.sampler;var p=i.width,m=i.height;dhe.textureDimensions.x=p,dhe.textureDimensions.y=m,dhe.texture=i;var _=Math.sin(n.south),g=.5*Math.log((1+_)/(1-_));_=Math.sin(n.north);var v=1/(.5*Math.log((1+_)/(1-_))-g),b=new hj({context:t,width:p,height:m,pixelFormat:i.pixelFormat,pixelDatatype:i.pixelDatatype,preMultiplyAlpha:i.preMultiplyAlpha});I.isPowerOfTwo(p)&&I.isPowerOfTwo(m)&&b.generateMipmap(YD.NICEST);for(var y=n.south,w=n.north,O=fhe,x=0,E=0;E<64;++E){var T=E/63,C=I.lerp(y,w,T);_=Math.sin(C);var S=(.5*Math.log((1+_)/(1-_))-g)*v;O[x++]=S,O[x++]=S}r.vertexArray.getAttribute(1).vertexBuffer.copyFromArrayView(O),e.shaderProgram=r.shaderProgram,e.outputTexture=b,e.uniformMap=dhe,e.vertexArray=r.vertexArray}(e,a,n,t.rectangle)},postExecute:function(e){t.texture=e,uhe(o,a,t,e),t.releaseReference()}});this._reprojectComputeCommands.push(s)}else i&&(t.texture=n),uhe(this,a,t,n)},rhe.prototype.queueReprojectionCommands=function(e){for(var t=this._reprojectComputeCommands,i=t.length,n=0;n<i;++n)e.commandList.push(t[n]);t.length=0},rhe.prototype.cancelReprojections=function(){this._reprojectComputeCommands.length=0},rhe.prototype.getImageryFromCache=function(e,t,i,n){var r=hhe(e,t,i),a=this._imageryCache[r];return Object(u.a)(a)||(a=new ehe(this,e,t,i,n),this._imageryCache[r]=a),a.addReference(),a},rhe.prototype.removeImageryFromCache=function(e){var t=hhe(e.x,e.y,e.level);delete this._imageryCache[t]};var dhe={u_textureDimensions:function(){return this.textureDimensions},u_texture:function(){return this.texture},textureDimensions:new Rt,texture:void 0},fhe=Ri.supportsTypedArrays()?new Float32Array(128):void 0;var phe=rhe;function mhe(e){if(!Object(u.a)(e))throw new h.a("options is required.");if(!Object(u.a)(e.terrainProvider))throw new h.a("options.terrainProvider is required.");if(!Object(u.a)(e.imageryLayers))throw new h.a("options.imageryLayers is required.");if(!Object(u.a)(e.surfaceShaderSet))throw new h.a("options.surfaceShaderSet is required.");this.lightingFadeOutDistance=65e5,this.lightingFadeInDistance=9e6,this.hasWaterMask=!1,this.oceanNormalMap=void 0,this.zoomedOutOceanSpecularIntensity=.5,this.enableLighting=!1,this.showGroundAtmosphere=!1,this.shadows=rM.RECEIVE_ONLY,this.hueShift=void 0,this.saturationShift=void 0,this.brightnessShift=void 0,this._quadtree=void 0,this._terrainProvider=e.terrainProvider,this._imageryLayers=e.imageryLayers,this._surfaceShaderSet=e.surfaceShaderSet,this._renderState=void 0,this._blendRenderState=void 0,this._errorEvent=new $o.a,this._imageryLayers.layerAdded.addEventListener(mhe.prototype._onLayerAdded,this),this._imageryLayers.layerRemoved.addEventListener(mhe.prototype._onLayerRemoved,this),this._imageryLayers.layerMoved.addEventListener(mhe.prototype._onLayerMoved,this),this._imageryLayers.layerShownOrHidden.addEventListener(mhe.prototype._onLayerShownOrHidden,this),this._tileLoadedEvent=new $o.a,this._imageryLayersUpdatedEvent=new $o.a,this._layerOrderChanged=!1,this._tilesToRenderByTextureCount=[],this._drawCommands=[],this._uniformMaps=[],this._usedDrawCommands=0,this._vertexArraysToDestroy=[],this._debug={wireframe:!1,boundingSphereTile:void 0},this._baseColor=void 0,this._firstPassInitialColor=void 0,this.baseColor=new uf(0,0,.5,1),this._clippingPlanes=void 0,this.cartographicLimitRectangle=Ve.clone(Ve.MAX_VALUE)}function _he(e,t){var i=e.loadingImagery;Object(u.a)(i)||(i=e.readyImagery);var n=t.loadingImagery;return Object(u.a)(n)||(n=t.readyImagery),i.imageryLayer._layerIndex-n.imageryLayer._layerIndex}Object(O.a)(mhe.prototype,{baseColor:{get:function(){return this._baseColor},set:function(e){if(!Object(u.a)(e))throw new h.a("value is required.");this._baseColor=e,this._firstPassInitialColor=Te.fromColor(e,this._firstPassInitialColor)}},quadtree:{get:function(){return this._quadtree},set:function(e){if(!Object(u.a)(e))throw new h.a("value is required.");this._quadtree=e}},ready:{get:function(){return this._terrainProvider.ready&&(0===this._imageryLayers.length||this._imageryLayers.get(0).imageryProvider.ready)}},tilingScheme:{get:function(){return this._terrainProvider.tilingScheme}},errorEvent:{get:function(){return this._errorEvent}},tileLoadedEvent:{get:function(){return this._tileLoadedEvent}},imageryLayersUpdatedEvent:{get:function(){return this._imageryLayersUpdatedEvent}},terrainProvider:{get:function(){return this._terrainProvider},set:function(e){if(this._terrainProvider!==e){if(!Object(u.a)(e))throw new h.a("terrainProvider is required.");this._terrainProvider=e,Object(u.a)(this._quadtree)&&this._quadtree.invalidateAllTiles()}}},clippingPlanes:{get:function(){return this._clippingPlanes},set:function(e){iJ.setOwner(e,this,"_clippingPlanes")}}}),mhe.prototype.update=function(e){this._imageryLayers._update()},mhe.prototype.initialize=function(e){this._imageryLayers.queueReprojectionCommands(e),this._layerOrderChanged&&(this._layerOrderChanged=!1,this._quadtree.forEachLoadedTile((function(e){e.data.imagery.sort(_he)}))),function(e,t){var i=t.creditDisplay;e._terrainProvider.ready&&Object(u.a)(e._terrainProvider.credit)&&i.addCredit(e._terrainProvider.credit);for(var n=e._imageryLayers,r=0,a=n.length;r<a;++r){var o=n.get(r).imageryProvider;o.ready&&Object(u.a)(o.credit)&&i.addCredit(o.credit)}}(this,e);for(var t,i,n=this._vertexArraysToDestroy,r=n.length,a=0;a<r;++a)t=n[a],i=void 0,i=t.indexBuffer,t.destroy(),!i.isDestroyed()&&Object(u.a)(i.referenceCount)&&(--i.referenceCount,0===i.referenceCount&&i.destroy());n.length=0},mhe.prototype.beginUpdate=function(e){for(var t=this._tilesToRenderByTextureCount,i=0,n=t.length;i<n;++i){var r=t[i];Object(u.a)(r)&&(r.length=0)}var a=this._clippingPlanes;Object(u.a)(a)&&a.enabled&&a.update(e),this._usedDrawCommands=0},mhe.prototype.endUpdate=function(e){Object(u.a)(this._renderState)||(this._renderState=RM.fromCache({cull:{enabled:!0},depthTest:{enabled:!0,func:qN.LESS}}),this._blendRenderState=RM.fromCache({cull:{enabled:!0},depthTest:{enabled:!0,func:qN.LESS_OR_EQUAL},blending:FD.ALPHA_BLEND}));for(var t=this._tilesToRenderByTextureCount,i=0,n=t.length;i<n;++i){var r=t[i];if(Object(u.a)(r))for(var a=0,o=r.length;a<o;++a)khe(this,r[a],e)}},mhe.prototype.updateForPick=function(e){for(var t=this._drawCommands,i=0,n=this._usedDrawCommands;i<n;++i)e.commandList.push(t[i])},mhe.prototype.cancelReprojections=function(){this._imageryLayers.cancelReprojections()},mhe.prototype.getLevelMaximumGeometricError=function(e){return this._terrainProvider.getLevelMaximumGeometricError(e)},mhe.prototype.loadTile=function(e,t){Que.processStateMachine(t,e,this._terrainProvider,this._imageryLayers,this._vertexArraysToDestroy);var i=this._tileLoadedEvent;t._loadedCallbacks.tileLoadedEvent=function(e){return i.raiseEvent(),!0}};var ghe=new St,vhe=new Ve,bhe=new Ve,yhe=new K;function whe(e,t){if(t.west<t.east)return t;var i=Ve.clone(t,bhe);return Ve.center(e,yhe).longitude>0?i.east=I.PI:i.west=-I.PI,i}mhe.prototype.computeTileVisibility=function(e,t,i){var n=this.computeDistanceToTile(e,t);if(e._distance=n,t.fog.enabled&&I.fog(n,t.fog.density)>=1)return Bx.NONE;var r=e.data,a=t.cullingVolume,o=Object(w.a)(r.orientedBoundingBox,r.boundingSphere3D);r.clippedByBoundaries=!1;var s=whe(e.rectangle,this.cartographicLimitRectangle),c=Ve.simpleIntersection(s,e.rectangle,vhe);if(!Object(u.a)(c))return Bx.NONE;Ve.equals(c,e.rectangle)||(r.clippedByBoundaries=!0),t.mode!==xF.SCENE3D&&(o=ghe,St.fromRectangleWithHeights2D(e.rectangle,t.mapProjection,r.minimumHeight,r.maximumHeight,o),z.fromElements(o.center.z,o.center.x,o.center.y,o.center),t.mode===xF.MORPHING&&(o=St.union(r.boundingSphere3D,o,o)));var l=this._clippingPlanes;if(Object(u.a)(l)&&l.enabled){var h=l.computeIntersectionWithBoundingVolume(o);if(e.isClipped=h!==ce.INSIDE,h===ce.OUTSIDE)return Bx.NONE}var d=a.computeVisibility(o);if(d===ce.OUTSIDE)return Bx.NONE;var f=t.mode===xF.SCENE3D&&t.camera.frustum instanceof hb;if(t.mode===xF.SCENE3D&&!f&&Object(u.a)(i)){var p=r.occludeePointInScaledSpace;return Object(u.a)(p)?i.ellipsoid.isScaledSpacePointVisible(p)?d:Bx.NONE:d}return d};var Ohe=new Be,xhe=new Be,Ehe=new Te,The=new Te,Che=new z,She=new z,Ahe=new z,Phe=new z;mhe.prototype.showTileThisFrame=function(e,t){for(var i=0,n=e.data.imagery,r=0,a=n.length;r<a;++r){var o=n[r];Object(u.a)(o.readyImagery)&&0!==o.readyImagery.imageryLayer.alpha&&++i}var s=this._tilesToRenderByTextureCount[i];Object(u.a)(s)||(s=[],this._tilesToRenderByTextureCount[i]=s),s.push(e);var c=this._debug;++c.tilesRendered,c.texturesRendered+=i},mhe.prototype.computeDistanceToTile=function(e,t){return e.data.tileBoundingRegion.distanceToCamera(t)},mhe.prototype.isDestroyed=function(){return!1},mhe.prototype.destroy=function(){return this._tileProvider=this._tileProvider&&this._tileProvider.destroy(),this._clippingPlanes=this._clippingPlanes&&this._clippingPlanes.destroy(),rl(this)},mhe.prototype._onLayerAdded=function(e,t){if(e.show){var i=this._terrainProvider,n=this,r=e.imageryProvider,a=this._imageryLayersUpdatedEvent;r._reload=function(){e._imageryCache={},n._quadtree.forEachLoadedTile((function(t){if(!Object(u.a)(t._loadedCallbacks[e._layerIndex])){var n,r=t.data.imagery,a=r.length,o=-1,s=0;for(n=0;n<a;++n){var c=r[n];if(Object(w.a)(c.readyImagery,c.loadingImagery).imageryLayer===e)-1===o&&(o=n),++s;else if(-1!==o)break}if(-1!==o){var l=o+s;e._createTileImagerySkeletons(t,i,l)&&(t._loadedCallbacks[e._layerIndex]=function(e,t,i){return function(n){var r,a,o,s=-1,c=n.data.imagery,l=c.length;for(o=0;o<l;++o)if(r=c[o],(a=Object(w.a)(r.readyImagery,r.loadingImagery)).imageryLayer===t){s=o;break}if(-1!==s){var h=s+e;if(r=c[h],a=Object(u.a)(r)?Object(w.a)(r.readyImagery,r.loadingImagery):void 0,!Object(u.a)(a)||a.imageryLayer!==t)return!t._createTileImagerySkeletons(n,i,h);for(o=s;o<h;++o)c[o].freeResources();c.splice(s,e)}return!0}}(s,e,i),t.state=Nue.LOADING)}}}))},this._quadtree.forEachLoadedTile((function(t){e._createTileImagerySkeletons(t,i)&&(t.state=Nue.LOADING)})),this._layerOrderChanged=!0,a.raiseEvent()}},mhe.prototype._onLayerRemoved=function(e,t){this._quadtree.forEachLoadedTile((function(t){for(var i=t.data.imagery,n=-1,r=0,a=0,o=i.length;a<o;++a){var s=i[a],c=s.loadingImagery;if(Object(u.a)(c)||(c=s.readyImagery),c.imageryLayer===e)-1===n&&(n=a),s.freeResources(),++r;else if(-1!==n)break}-1!==n&&i.splice(n,r)})),Object(u.a)(e.imageryProvider)&&(e.imageryProvider._reload=void 0),this._imageryLayersUpdatedEvent.raiseEvent()},mhe.prototype._onLayerMoved=function(e,t,i){this._layerOrderChanged=!0,this._imageryLayersUpdatedEvent.raiseEvent()},mhe.prototype._onLayerShownOrHidden=function(e,t,i){i?this._onLayerAdded(e,t):this._onLayerRemoved(e,t)};var Ihe,Dhe,jhe,Mhe=new Be;function Rhe(e,t){return{u_initialColor:function(){return this.properties.initialColor},u_zoomedOutOceanSpecularIntensity:function(){return this.properties.zoomedOutOceanSpecularIntensity},u_oceanNormalMap:function(){return this.properties.oceanNormalMap},u_lightingFadeDistance:function(){return this.properties.lightingFadeDistance},u_nightFadeDistance:function(){return this.properties.nightFadeDistance},u_center3D:function(){return this.properties.center3D},u_tileRectangle:function(){return this.properties.tileRectangle},u_modifiedModelView:function(){var t=e.context.uniformState.view,i=Be.multiplyByPoint(t,this.properties.rtc,She);return Be.setTranslation(t,i,Ohe),Ohe},u_modifiedModelViewProjection:function(){var t=e.context.uniformState.view,i=e.context.uniformState.projection,n=Be.multiplyByPoint(t,this.properties.rtc,She);return Be.setTranslation(t,n,xhe),Be.multiply(i,xhe,xhe),xhe},u_dayTextures:function(){return this.properties.dayTextures},u_dayTextureTranslationAndScale:function(){return this.properties.dayTextureTranslationAndScale},u_dayTextureTexCoordsRectangle:function(){return this.properties.dayTextureTexCoordsRectangle},u_dayTextureUseWebMercatorT:function(){return this.properties.dayTextureUseWebMercatorT},u_dayTextureAlpha:function(){return this.properties.dayTextureAlpha},u_dayTextureBrightness:function(){return this.properties.dayTextureBrightness},u_dayTextureContrast:function(){return this.properties.dayTextureContrast},u_dayTextureHue:function(){return this.properties.dayTextureHue},u_dayTextureSaturation:function(){return this.properties.dayTextureSaturation},u_dayTextureOneOverGamma:function(){return this.properties.dayTextureOneOverGamma},u_dayIntensity:function(){return this.properties.dayIntensity},u_southAndNorthLatitude:function(){return this.properties.southAndNorthLatitude},u_southMercatorYAndOneOverHeight:function(){return this.properties.southMercatorYAndOneOverHeight},u_waterMask:function(){return this.properties.waterMask},u_waterMaskTranslationAndScale:function(){return this.properties.waterMaskTranslationAndScale},u_minMaxHeight:function(){return this.properties.minMaxHeight},u_scaleAndBias:function(){return this.properties.scaleAndBias},u_dayTextureSplit:function(){return this.properties.dayTextureSplit},u_dayTextureCutoutRectangles:function(){return this.properties.dayTextureCutoutRectangles},u_clippingPlanes:function(){var i=t._clippingPlanes;return Object(u.a)(i)&&Object(u.a)(i.texture)?i.texture:e.context.defaultTexture},u_cartographicLimitRectangle:function(){return this.properties.localizedCartographicLimitRectangle},u_clippingPlanesMatrix:function(){var i=t._clippingPlanes;return Object(u.a)(i)?Be.multiply(e.context.uniformState.view,i.modelMatrix,Mhe):Be.IDENTITY},u_clippingPlanesEdgeStyle:function(){var e=this.properties.clippingPlanesEdgeColor;return e.alpha=this.properties.clippingPlanesEdgeWidth,e},u_minimumBrightness:function(){return e.fog.minimumBrightness},u_hsbShift:function(){return this.properties.hsbShift},properties:{initialColor:new Te(0,0,.5,1),zoomedOutOceanSpecularIntensity:.5,oceanNormalMap:void 0,lightingFadeDistance:new Rt(65e5,9e6),nightFadeDistance:new Rt(1e7,4e7),hsbShift:new z,center3D:void 0,rtc:new z,modifiedModelView:new Be,tileRectangle:new Te,dayTextures:[],dayTextureTranslationAndScale:[],dayTextureTexCoordsRectangle:[],dayTextureUseWebMercatorT:[],dayTextureAlpha:[],dayTextureBrightness:[],dayTextureContrast:[],dayTextureHue:[],dayTextureSaturation:[],dayTextureOneOverGamma:[],dayTextureSplit:[],dayTextureCutoutRectangles:[],dayIntensity:0,southAndNorthLatitude:new Rt,southMercatorYAndOneOverHeight:new Rt,waterMask:void 0,waterMaskTranslationAndScale:new Te,minMaxHeight:new Rt,scaleAndBias:new Be,clippingPlanesEdgeColor:uf.clone(uf.WHITE),clippingPlanesEdgeWidth:0,localizedCartographicLimitRectangle:new Te}}}function Lhe(e,t,i){var n=i.data;Object(u.a)(n.wireframeVertexArray)||Object(u.a)(n.terrainData)&&Object(u.a)(n.terrainData._mesh)&&(n.wireframeVertexArray=function(e,t,i){var n={indices:i.indices,primitiveType:yn.TRIANGLES};id.toWireframe(n);var r=n.indices,a=ZN.createIndexBuffer({context:e,typedArray:r,usage:YN.STATIC_DRAW,indexDatatype:Sl.UNSIGNED_SHORT});return new tF({context:e,attributes:t._attributes,indexBuffer:a})}(e,n.vertexArray,n.terrainData._mesh))}!function(){var e,t,i=new Mu({geometry:$a.fromDimensions({dimensions:new z(2,2,2)})}),n=new Mu({geometry:new NP({radius:1})}),r=new Be;function a(e){return new ck({geometryInstances:e,appearance:new $j({translucent:!1,flat:!0}),asynchronous:!1})}Ihe=function(n,o){return n===e?t:(jhe(),e=n,r=Be.fromRotationTranslation(n.halfAxes,n.center,r),i.modelMatrix=r,i.attributes.color=df.fromColor(o),t=a(i))},Dhe=function(i,o){return i===e?t:(jhe(),e=i,r=Be.fromTranslation(i.center,r),r=Be.multiplyByUniformScale(r,i.radius,r),n.modelMatrix=r,n.attributes.color=df.fromColor(o),t=a(n))},jhe=function(){Object(u.a)(t)&&(t.destroy(),t=void 0,e=void 0)}}();var Nhe=new Te(0,0,0,0),Fhe={frameState:void 0,surfaceTile:void 0,numberOfDayTextures:void 0,applyBrightness:void 0,applyContrast:void 0,applyHue:void 0,applySaturation:void 0,applyGamma:void 0,applyAlpha:void 0,applySplit:void 0,showReflectiveOcean:void 0,showOceanWaves:void 0,enableLighting:void 0,showGroundAtmosphere:void 0,perFragmentGroundAtmosphere:void 0,hasVertexNormals:void 0,useWebMercatorProjection:void 0,enableFog:void 0,enableClippingPlanes:void 0,clippingPlanes:void 0,clippedByBoundaries:void 0,hasImageryLayerCutout:void 0,colorCorrect:void 0};function khe(e,t,i){var n=t.data,r=i.creditDisplay,a=n.terrainData;if(Object(u.a)(a)&&Object(u.a)(a.credits))for(var o=a.credits,s=0,c=o.length;s<c;++s)r.addCredit(o[s]);var l=HD.maximumTextureImageUnits,d=n.waterMaskTexture,f=e.hasWaterMask&&Object(u.a)(d),p=e.oceanNormalMap,m=f&&Object(u.a)(p),_=e.terrainProvider.ready&&e.terrainProvider.hasVertexNormals,g=i.fog.enabled,v=e.showGroundAtmosphere,b=rM.castShadows(e.shadows),y=rM.receiveShadows(e.shadows),w=e.hueShift,O=e.saturationShift,x=e.brightnessShift,E=!(I.equalsEpsilon(w,0,I.EPSILON7)&&I.equalsEpsilon(O,0,I.EPSILON7)&&I.equalsEpsilon(x,0,I.EPSILON7)),T=!1;if(v){var C,S=i.mode,A=i.camera;C=S===xF.SCENE2D||S===xF.COLUMBUS_VIEW?A.positionCartographic.height:z.magnitude(A.positionWC);var P=e.nightFadeOutDistance;S!==xF.SCENE3D&&(P-=i.mapProjection.ellipsoid.maximumRadius),T=C>P}f&&--l,m&&--l;var D=n.center,j=n.pickTerrain.mesh.encoding,M=Ehe,R=0,L=0,N=0,F=0,k=!1;if(i.mode!==xF.SCENE3D){var B=i.mapProjection,U=B.project(Ve.southwest(t.rectangle),Ahe),V=B.project(Ve.northeast(t.rectangle),Phe);if(M.x=U.x,M.y=U.y,M.z=V.x,M.w=V.y,i.mode!==xF.MORPHING&&((D=Che).x=0,D.y=.5*(M.z+M.x),D.z=.5*(M.w+M.y),M.x-=D.y,M.y-=D.z,M.z-=D.y,M.w-=D.z),i.mode===xF.SCENE2D&&j.quantization===kc.BITS12){var H=1/(Math.pow(2,12)-1)*.5,G=(M.z-M.x)*H,q=(M.w-M.y)*H;M.x-=G,M.y-=q,M.z+=G,M.w+=q}B instanceof Qc&&(R=t.rectangle.south,L=t.rectangle.north,N=Qc.geodeticLatitudeToMercatorAngle(R),F=1/(Qc.geodeticLatitudeToMercatorAngle(L)-N),k=!0)}var W=Fhe;W.frameState=i,W.surfaceTile=n,W.showReflectiveOcean=f,W.showOceanWaves=m,W.enableLighting=e.enableLighting,W.showGroundAtmosphere=v,W.perFragmentGroundAtmosphere=T,W.hasVertexNormals=_,W.useWebMercatorProjection=k,W.clippedByBoundaries=n.clippedByBoundaries;var Y=n.imagery,X=0,Z=Y.length,Q=e._renderState,K=e._blendRenderState,J=Q,$=e._firstPassInitialColor,ee=i.context;Object(u.a)(e._debug.boundingSphereTile)||jhe();do{var te,ie,ne=0;e._drawCommands.length<=e._usedDrawCommands?((te=new cM).owner=t,te.cull=!1,te.boundingVolume=new St,te.orientedBoundingBox=void 0,ie=Rhe(i,e),e._drawCommands.push(te),e._uniformMaps.push(ie)):(te=e._drawCommands[e._usedDrawCommands],ie=e._uniformMaps[e._usedDrawCommands]),te.owner=t,++e._usedDrawCommands,t===e._debug.boundingSphereTile&&(Object(u.a)(n.orientedBoundingBox)?Ihe(n.orientedBoundingBox,uf.RED).update(i):Object(u.a)(n.boundingSphere3D)&&Dhe(n.boundingSphere3D,uf.RED).update(i));var re=ie.properties;Te.clone($,re.initialColor),re.oceanNormalMap=p,re.lightingFadeDistance.x=e.lightingFadeOutDistance,re.lightingFadeDistance.y=e.lightingFadeInDistance,re.nightFadeDistance.x=e.nightFadeOutDistance,re.nightFadeDistance.y=e.nightFadeInDistance,re.zoomedOutOceanSpecularIntensity=e.zoomedOutOceanSpecularIntensity,re.center3D=n.center,z.clone(D,re.rtc),Te.clone(M,re.tileRectangle),re.southAndNorthLatitude.x=R,re.southAndNorthLatitude.y=L,re.southMercatorYAndOneOverHeight.x=N,re.southMercatorYAndOneOverHeight.y=F;var ae=The,oe=whe(t.rectangle,e.cartographicLimitRectangle);z.fromElements(w,O,x,re.hsbShift);var se=t.rectangle,ce=1/se.width,le=1/se.height;ae.x=(oe.west-se.west)*ce,ae.y=(oe.south-se.south)*le,ae.z=(oe.east-se.west)*ce,ae.w=(oe.north-se.south)*le,Te.clone(ae,re.localizedCartographicLimitRectangle);var ue=g&&I.fog(t._distance,i.fog.density)>I.EPSILON3;E=E&&(ue||v);for(var he=!1,de=!1,fe=!1,pe=!1,me=!1,_e=!1,ge=!1,ve=!1;ne<l&&X<Z;){var be=Y[X],ye=be.readyImagery;if(++X,Object(u.a)(ye)&&0!==ye.imageryLayer.alpha){var we=be.useWebMercatorT?ye.textureWebMercator:ye.texture;if(!Object(u.a)(we))throw new h.a("readyImagery is not actually ready!");var Oe=ye.imageryLayer;Object(u.a)(be.textureTranslationAndScale)||(be.textureTranslationAndScale=Oe._calculateTextureTranslationAndScale(t,be)),re.dayTextures[ne]=we,re.dayTextureTranslationAndScale[ne]=be.textureTranslationAndScale,re.dayTextureTexCoordsRectangle[ne]=be.textureCoordinateRectangle,re.dayTextureUseWebMercatorT[ne]=be.useWebMercatorT,re.dayTextureAlpha[ne]=Oe.alpha,_e=_e||1!==re.dayTextureAlpha[ne],re.dayTextureBrightness[ne]=Oe.brightness,he=he||re.dayTextureBrightness[ne]!==phe.DEFAULT_BRIGHTNESS,re.dayTextureContrast[ne]=Oe.contrast,de=de||re.dayTextureContrast[ne]!==phe.DEFAULT_CONTRAST,re.dayTextureHue[ne]=Oe.hue,fe=fe||re.dayTextureHue[ne]!==phe.DEFAULT_HUE,re.dayTextureSaturation[ne]=Oe.saturation,pe=pe||re.dayTextureSaturation[ne]!==phe.DEFAULT_SATURATION,re.dayTextureOneOverGamma[ne]=1/Oe.gamma,me=me||re.dayTextureOneOverGamma[ne]!==1/phe.DEFAULT_GAMMA,re.dayTextureSplit[ne]=Oe.splitDirection,ge=ge||0!==re.dayTextureSplit[ne];var xe=re.dayTextureCutoutRectangles[ne];if(Object(u.a)(xe)||(xe=re.dayTextureCutoutRectangles[ne]=new Te),Te.clone(Te.ZERO,xe),Object(u.a)(Oe.cutoutRectangle)){var Ee=whe(se,Oe.cutoutRectangle),Ce=Ve.simpleIntersection(Ee,se,vhe);ve=Object(u.a)(Ce)||ve,xe.x=(Ee.west-se.west)*ce,xe.y=(Ee.south-se.south)*le,xe.z=(Ee.east-se.west)*ce,xe.w=(Ee.north-se.south)*le}if(Object(u.a)(ye.credits))for(var Se=ye.credits,Ae=0,Pe=Se.length;Ae<Pe;++Ae)r.addCredit(Se[Ae]);++ne}}re.dayTextures.length=ne,re.waterMask=d,Te.clone(n.waterMaskTranslationAndScale,re.waterMaskTranslationAndScale),re.minMaxHeight.x=j.minimumHeight,re.minMaxHeight.y=j.maximumHeight,Be.clone(j.matrix,re.scaleAndBias);var Ie=e._clippingPlanes,De=Object(u.a)(Ie)&&Ie.enabled&&t.isClipped;De&&(re.clippingPlanesEdgeColor=uf.clone(Ie.edgeColor,re.clippingPlanesEdgeColor),re.clippingPlanesEdgeWidth=Ie.edgeWidth),Object(u.a)(e.uniformMap)&&(ie=Object(ff.a)(ie,e.uniformMap)),W.numberOfDayTextures=ne,W.applyBrightness=he,W.applyContrast=de,W.applyHue=fe,W.applySaturation=pe,W.applyGamma=me,W.applyAlpha=_e,W.applySplit=ge,W.enableFog=ue,W.enableClippingPlanes=De,W.clippingPlanes=Ie,W.hasImageryLayerCutout=ve,W.colorCorrect=E,te.shaderProgram=e._surfaceShaderSet.getShaderProgram(W),te.castShadows=b,te.receiveShadows=y,te.renderState=J,te.primitiveType=yn.TRIANGLES,te.vertexArray=n.vertexArray,te.uniformMap=ie,te.pass=lM.GLOBE,e._debug.wireframe&&(Lhe(ee,0,t),Object(u.a)(n.wireframeVertexArray)&&(te.vertexArray=n.wireframeVertexArray,te.primitiveType=yn.LINES));var je=te.boundingVolume,Me=te.orientedBoundingBox;i.mode!==xF.SCENE3D?(St.fromRectangleWithHeights2D(t.rectangle,i.mapProjection,n.minimumHeight,n.maximumHeight,je),z.fromElements(je.center.z,je.center.x,je.center.y,je.center),i.mode===xF.MORPHING&&(je=St.union(n.boundingSphere3D,je,je))):(te.boundingVolume=St.clone(n.boundingSphere3D,je),te.orientedBoundingBox=Fc.clone(n.orientedBoundingBox,Me)),te.dirty=!0,i.commandList.push(te),J=K,$=Nhe}while(X<Z)}var Bhe=mhe;function zhe(){this._layers=[],this.layerAdded=new $o.a,this.layerRemoved=new $o.a,this.layerMoved=new $o.a,this.layerShownOrHidden=new $o.a}function Uhe(e,t){if(!Object(u.a)(t))throw new h.a("layer is required.");var i=e.indexOf(t);if(-1===i)throw new h.a("layer is not in this collection.");return i}function Vhe(e,t,i){var n=e._layers;if((t=I.clamp(t,0,n.length-1))!==(i=I.clamp(i,0,n.length-1))){var r=n[t];n[t]=n[i],n[i]=r,e._update(),e.layerMoved.raiseEvent(r,i,t)}}Object(O.a)(zhe.prototype,{length:{get:function(){return this._layers.length}}}),zhe.prototype.add=function(e,t){var i=Object(u.a)(t);if(!Object(u.a)(e))throw new h.a("layer is required.");if(i){if(t<0)throw new h.a("index must be greater than or equal to zero.");if(t>this._layers.length)throw new h.a("index must be less than or equal to the number of layers.")}i?this._layers.splice(t,0,e):(t=this._layers.length,this._layers.push(e)),this._update(),this.layerAdded.raiseEvent(e,t)},zhe.prototype.addImageryProvider=function(e,t){if(!Object(u.a)(e))throw new h.a("imageryProvider is required.");var i=new phe(e);return this.add(i,t),i},zhe.prototype.remove=function(e,t){t=Object(w.a)(t,!0);var i=this._layers.indexOf(e);return-1!==i&&(this._layers.splice(i,1),this._update(),this.layerRemoved.raiseEvent(e,i),t&&e.destroy(),!0)},zhe.prototype.removeAll=function(e){e=Object(w.a)(e,!0);for(var t=this._layers,i=0,n=t.length;i<n;i++){var r=t[i];this.layerRemoved.raiseEvent(r,i),e&&r.destroy()}this._layers=[]},zhe.prototype.contains=function(e){return-1!==this.indexOf(e)},zhe.prototype.indexOf=function(e){return this._layers.indexOf(e)},zhe.prototype.get=function(e){if(!Object(u.a)(e))throw new h.a("index is required.","index");return this._layers[e]},zhe.prototype.raise=function(e){var t=Uhe(this._layers,e);Vhe(this,t,t+1)},zhe.prototype.lower=function(e){var t=Uhe(this._layers,e);Vhe(this,t,t-1)},zhe.prototype.raiseToTop=function(e){var t=Uhe(this._layers,e);t!==this._layers.length-1&&(this._layers.splice(t,1),this._layers.push(e),this._update(),this.layerMoved.raiseEvent(e,this._layers.length-1,t))},zhe.prototype.lowerToBottom=function(e){var t=Uhe(this._layers,e);0!==t&&(this._layers.splice(t,1),this._layers.splice(0,0,e),this._update(),this.layerMoved.raiseEvent(e,0,t))};var Hhe=new Ve;zhe.prototype.pickImageryLayerFeatures=function(e,t){var i=t.globe.pick(e,t);if(Object(u.a)(i)){for(var n,r=t.globe.ellipsoid.cartesianToCartographic(i),a=t.globe._surface._tilesToRender,o=0;!Object(u.a)(n)&&o<a.length;++o){var s=a[o];Ve.contains(s.rectangle,r)&&(n=s)}if(Object(u.a)(n)){for(var c=n.data.imagery,l=[],h=[],d=c.length-1;d>=0;--d){var f=c[d],p=f.readyImagery;if(Object(u.a)(p)){var m=p.imageryLayer.imageryProvider;if(Object(u.a)(m.pickFeatures)&&Ve.contains(p.rectangle,r)){var _=Hhe;if(_.west=I.lerp(n.rectangle.west,n.rectangle.east,f.textureCoordinateRectangle.x-1/1024),_.east=I.lerp(n.rectangle.west,n.rectangle.east,f.textureCoordinateRectangle.z+1/1024),_.south=I.lerp(n.rectangle.south,n.rectangle.north,f.textureCoordinateRectangle.y-1/1024),_.north=I.lerp(n.rectangle.south,n.rectangle.north,f.textureCoordinateRectangle.w+1/1024),Ve.contains(_,r)){var g=m.pickFeatures(p.x,p.y,p.level,r.longitude,r.latitude);Object(u.a)(g)&&(l.push(g),h.push(p.imageryLayer))}}}}if(0!==l.length)return Oi.a.all(l,(function(e){for(var t=[],i=0;i<e.length;++i){var n=e[i],a=h[i];if(Object(u.a)(n)&&n.length>0)for(var o=0;o<n.length;++o){var s=n[o];s.imageryLayer=a,Object(u.a)(s.position)||(s.position=r),t.push(s)}}return t}))}}},zhe.prototype.queueReprojectionCommands=function(e){for(var t=this._layers,i=0,n=t.length;i<n;++i)t[i].queueReprojectionCommands(e)},zhe.prototype.cancelReprojections=function(){for(var e=this._layers,t=0,i=e.length;t<i;++t)e[t].cancelReprojections()},zhe.prototype.isDestroyed=function(){return!1},zhe.prototype.destroy=function(){return this.removeAll(!0),rl(this)},zhe.prototype._update=function(){var e,t,i,n,r=!0,a=this._layers;for(i=0,n=a.length;i<n;++i)(t=a[i])._layerIndex=i,t.show?(t._isBaseLayer=r,r=!1):t._isBaseLayer=!1,t.show!==t._show&&(Object(u.a)(t._show)&&(Object(u.a)(e)||(e=[]),e.push(t)),t._show=t.show);if(Object(u.a)(e))for(i=0,n=e.length;i<n;++i)t=e[i],this.layerShownOrHidden.raiseEvent(t,t._layerIndex,t.show)};var Ghe=zhe;function qhe(e){this._ellipsoid=new fs(e.ellipsoid,z.ZERO)}Object(O.a)(qhe.prototype,{ellipsoid:{get:function(){return this._ellipsoid}}});var Whe=qhe;function Yhe(e){if(!Object(u.a)(e))throw new h.a("options is required.");if(!Object(u.a)(e.x))throw new h.a("options.x is required.");if(!Object(u.a)(e.y))throw new h.a("options.y is required.");if(e.x<0||e.y<0)throw new h.a("options.x and options.y must be greater than or equal to zero.");if(!Object(u.a)(e.level))throw new h.a("options.level is required and must be greater than or equal to zero.");if(!Object(u.a)(e.tilingScheme))throw new h.a("options.tilingScheme is required.");this._tilingScheme=e.tilingScheme,this._x=e.x,this._y=e.y,this._level=e.level,this._parent=e.parent,this._rectangle=this._tilingScheme.tileXYToRectangle(this._x,this._y,this._level),this._southwestChild=void 0,this._southeastChild=void 0,this._northwestChild=void 0,this._northeastChild=void 0,this._replacementPrevious=void 0,this._replacementNext=void 0,this._distance=0,this._priorityFunction=void 0,this._customData=[],this._frameUpdated=void 0,this._frameRendered=void 0,this._loadedCallbacks={},this.state=Nue.START,this.renderable=!1,this.upsampledFromParent=!1,this.data=void 0}function Xhe(e){Object(u.a)(e)&&e.freeResources()}Yhe.createLevelZeroTiles=function(e){if(!Object(u.a)(e))throw new h.a("tilingScheme is required.");for(var t=e.getNumberOfXTilesAtLevel(0),i=e.getNumberOfYTilesAtLevel(0),n=new Array(t*i),r=0,a=0;a<i;++a)for(var o=0;o<t;++o)n[r++]=new Yhe({tilingScheme:e,x:o,y:a,level:0});return n},Yhe.prototype._updateCustomData=function(e,t,i){var n,r,a,o=this.customData;if(Object(u.a)(t)&&Object(u.a)(i)){for(o=o.filter((function(e){return-1===i.indexOf(e)})),this._customData=o,a=this._rectangle,n=0;n<t.length;++n)r=t[n],Ve.contains(a,r.positionCartographic)&&o.push(r);this._frameUpdated=e}else{var s=this._parent;if(Object(u.a)(s)&&this._frameUpdated!==s._frameUpdated){o.length=0,a=this._rectangle;var c=s.customData;for(n=0;n<c.length;++n)r=c[n],Ve.contains(a,r.positionCartographic)&&o.push(r);this._frameUpdated=s._frameUpdated}}},Object(O.a)(Yhe.prototype,{tilingScheme:{get:function(){return this._tilingScheme}},x:{get:function(){return this._x}},y:{get:function(){return this._y}},level:{get:function(){return this._level}},parent:{get:function(){return this._parent}},rectangle:{get:function(){return this._rectangle}},children:{get:function(){return[this.northwestChild,this.northeastChild,this.southwestChild,this.southeastChild]}},southwestChild:{get:function(){return Object(u.a)(this._southwestChild)||(this._southwestChild=new Yhe({tilingScheme:this.tilingScheme,x:2*this.x,y:2*this.y+1,level:this.level+1,parent:this})),this._southwestChild}},southeastChild:{get:function(){return Object(u.a)(this._southeastChild)||(this._southeastChild=new Yhe({tilingScheme:this.tilingScheme,x:2*this.x+1,y:2*this.y+1,level:this.level+1,parent:this})),this._southeastChild}},northwestChild:{get:function(){return Object(u.a)(this._northwestChild)||(this._northwestChild=new Yhe({tilingScheme:this.tilingScheme,x:2*this.x,y:2*this.y,level:this.level+1,parent:this})),this._northwestChild}},northeastChild:{get:function(){return Object(u.a)(this._northeastChild)||(this._northeastChild=new Yhe({tilingScheme:this.tilingScheme,x:2*this.x+1,y:2*this.y,level:this.level+1,parent:this})),this._northeastChild}},customData:{get:function(){return this._customData}},needsLoading:{get:function(){return this.state<Nue.DONE}},eligibleForUnloading:{get:function(){var e=!0;return Object(u.a)(this.data)&&(e=this.data.eligibleForUnloading,Object(u.a)(e)||(e=!0)),e}}}),Yhe.prototype.freeResources=function(){this.state=Nue.START,this.renderable=!1,this.upsampledFromParent=!1,Object(u.a)(this.data)&&Object(u.a)(this.data.freeResources)&&this.data.freeResources(),Xhe(this._southwestChild),this._southwestChild=void 0,Xhe(this._southeastChild),this._southeastChild=void 0,Xhe(this._northwestChild),this._northwestChild=void 0,Xhe(this._northeastChild),this._northeastChild=void 0};var Zhe=Yhe;function Qhe(){this.head=void 0,this.tail=void 0,this.count=0,this._lastBeforeStartOfFrame=void 0}function Khe(e,t){var i=t.replacementPrevious,n=t.replacementNext;t===e._lastBeforeStartOfFrame&&(e._lastBeforeStartOfFrame=n),t===e.head?e.head=n:i.replacementNext=n,t===e.tail?e.tail=i:n.replacementPrevious=i,t.replacementPrevious=void 0,t.replacementNext=void 0,--e.count}Qhe.prototype.markStartOfRenderFrame=function(){this._lastBeforeStartOfFrame=this.head},Qhe.prototype.trimTiles=function(e){for(var t=this.tail,i=!0;i&&Object(u.a)(this._lastBeforeStartOfFrame)&&this.count>e&&Object(u.a)(t);){i=t!==this._lastBeforeStartOfFrame;var n=t.replacementPrevious;t.eligibleForUnloading&&(t.freeResources(),Khe(this,t)),t=n}},Qhe.prototype.markTileRendered=function(e){var t=this.head;if(t!==e){if(++this.count,!Object(u.a)(t))return e.replacementPrevious=void 0,e.replacementNext=void 0,this.head=e,void(this.tail=e);(Object(u.a)(e.replacementPrevious)||Object(u.a)(e.replacementNext))&&Khe(this,e),e.replacementPrevious=void 0,e.replacementNext=t,t.replacementPrevious=e,this.head=e}else e===this._lastBeforeStartOfFrame&&(this._lastBeforeStartOfFrame=e.replacementNext)};var Jhe,$he=Qhe;function ede(e){if(!Object(u.a)(e)||!Object(u.a)(e.tileProvider))throw new h.a("options.tileProvider is required.");if(Object(u.a)(e.tileProvider.quadtree))throw new h.a("A QuadtreeTileProvider can only be used with a single QuadtreePrimitive");this._tileProvider=e.tileProvider,this._tileProvider.quadtree=this,this._debug={enableDebugOutput:!1,maxDepth:0,tilesVisited:0,tilesCulled:0,tilesRendered:0,tilesWaitingForChildren:0,lastMaxDepth:-1,lastTilesVisited:-1,lastTilesCulled:-1,lastTilesRendered:-1,lastTilesWaitingForChildren:-1,suspendLodUpdate:!1};var t=this._tileProvider.tilingScheme.ellipsoid;this._tilesToRender=[],this._tileLoadQueueHigh=[],this._tileLoadQueueMedium=[],this._tileLoadQueueLow=[],this._tileReplacementQueue=new $he,this._levelZeroTiles=void 0,this._loadQueueTimeSlice=5,this._tilesInvalidated=!1,this._addHeightCallbacks=[],this._removeHeightCallbacks=[],this._tileToUpdateHeights=[],this._lastTileIndex=0,this._updateHeightsTimeSlice=2,this.maximumScreenSpaceError=Object(w.a)(e.maximumScreenSpaceError,2),this.tileCacheSize=Object(w.a)(e.tileCacheSize,100),this._occluders=new Whe({ellipsoid:t}),this._tileLoadProgressEvent=new $o.a,this._lastTileLoadQueueLength=0}function tde(e){var t=e._debug;t.maxDepth=0,t.tilesVisited=0,t.tilesCulled=0,t.tilesRendered=0,t.tilesWaitingForChildren=0,e._tileLoadQueueHigh.length=0,e._tileLoadQueueMedium.length=0,e._tileLoadQueueLow.length=0}Object(O.a)(ede.prototype,{tileProvider:{get:function(){return this._tileProvider}},tileLoadProgressEvent:{get:function(){return this._tileLoadProgressEvent}}}),ede.prototype.invalidateAllTiles=function(){this._tilesInvalidated=!0},ede.prototype.forEachLoadedTile=function(e){for(var t=this._tileReplacementQueue.head;Object(u.a)(t);)t.state!==Nue.START&&e(t),t=t.replacementNext},ede.prototype.forEachRenderedTile=function(e){for(var t=this._tilesToRender,i=0,n=t.length;i<n;++i)e(t[i])},ede.prototype.updateHeight=function(e,t){var i=this,n={positionOnEllipsoidSurface:void 0,positionCartographic:e,level:-1,callback:t,removeFunc:function(){for(var e=i._addHeightCallbacks,t=e.length,r=0;r<t;++r)if(e[r]===n){e.splice(r,1);break}i._removeHeightCallbacks.push(n)}};return i._addHeightCallbacks.push(n),n.removeFunc},ede.prototype.update=function(e){Object(u.a)(this._tileProvider.update)&&this._tileProvider.update(e)},ede.prototype.beginFrame=function(e){e.passes.render&&(this._tilesInvalidated&&(!function(e){var t=e._tileReplacementQueue;t.head=void 0,t.tail=void 0,t.count=0,tde(e);var i=e._levelZeroTiles;if(Object(u.a)(i))for(var n=0;n<i.length;++n){for(var r=i[n].customData,a=r.length,o=0;o<a;++o){var s=r[o];s.level=0,e._addHeightCallbacks.push(s)}i[n].freeResources()}e._levelZeroTiles=void 0,e._tileProvider.cancelReprojections()}(this),this._tilesInvalidated=!1),this._tileProvider.initialize(e),this._debug.suspendLodUpdate||(tde(this),this._tileReplacementQueue.markStartOfRenderFrame()))},ede.prototype.render=function(e){var t=e.passes,i=this._tileProvider;t.render&&(i.beginUpdate(e),function(e,t){var i=e._debug;if(i.suspendLodUpdate)return;e._tilesToRender.length=0;var n,r=e._tileProvider;if(!Object(u.a)(e._levelZeroTiles)){if(!r.ready)return;var a=r.tilingScheme;e._levelZeroTiles=Zhe.createLevelZeroTiles(a)}e._occluders.ellipsoid.cameraPosition=t.camera.positionWC;var o=e._levelZeroTiles,s=o.length>1?e._occluders:void 0;Jhe=t.camera.positionCartographic,o.sort(nde);var c,l,h=e._addHeightCallbacks,d=e._removeHeightCallbacks,f=t.frameNumber;if(h.length>0||d.length>0){for(c=0,l=o.length;c<l;++c)(n=o[c])._updateCustomData(f,h,d);h.length=0,d.length=0}for(c=0,l=o.length;c<l;++c)n=o[c],e._tileReplacementQueue.markTileRendered(n),n.renderable?r.computeTileVisibility(n,t,s)!==Bx.NONE?rde(e,t,n):(n.needsLoading&&e._tileLoadQueueLow.push(n),++i.tilesCulled):(n.needsLoading&&e._tileLoadQueueHigh.push(n),++i.tilesWaitingForChildren)}(this,e),function(e,t){for(var i=e._tileProvider,n=e._tilesToRender,r=e._tileToUpdateHeights,a=0,o=n.length;a<o;++a){var s=n[a];i.showTileThisFrame(s,t),s._frameRendered!==t.frameNumber-1&&r.push(s),s._frameRendered=t.frameNumber}}(this,e),i.endUpdate(e)),t.pick&&this._tilesToRender.length>0&&i.updateForPick(e)},ede.prototype.endFrame=function(e){e.passes.render&&e.mode!==xF.MORPHING&&(function(e,t){var i=e._tileLoadQueueHigh,n=e._tileLoadQueueMedium,r=e._tileLoadQueueLow;if(0===i.length&&0===n.length&&0===r.length)return;e._tileReplacementQueue.trimTiles(e.tileCacheSize);var a=Qd()+e._loadQueueTimeSlice,o=e._tileProvider;lde(e,t,o,a,i),lde(e,t,o,a,n),lde(e,t,o,a,r)}(this,e),function(e,t){var i=fde;i.length=0;var n,r=e._tileToUpdateHeights,a=e._tileProvider.terrainProvider,o=Qd(),s=e._updateHeightsTimeSlice,c=o+s,l=t.mode,h=t.mapProjection,d=h.ellipsoid;for(;r.length>0;){var f=r[0];if(f.state===Nue.DONE){var p=f.customData,m=p.length,_=!1;for(n=e._lastTileIndex;n<m;++n){var g=p[n];if(f.level>g.level){if(Object(u.a)(g.positionOnEllipsoidSurface)||(g.positionOnEllipsoidSurface=z.fromRadians(g.positionCartographic.longitude,g.positionCartographic.latitude,0,d)),l===xF.SCENE3D){var v=d.geodeticSurfaceNormal(g.positionOnEllipsoidSurface,ude.direction),b=d.getSurfaceNormalIntersectionWithZAxis(g.positionOnEllipsoidSurface,11500,ude.origin);if(!Object(u.a)(b)){var y=Math.min(Object(w.a)(f.data.minimumHeight,0),-11500),O=z.multiplyByScalar(v,Math.abs(y)+1,dde);z.subtract(g.positionOnEllipsoidSurface,O,ude.origin)}}else K.clone(g.positionCartographic,hde),hde.height=-11500,h.project(hde,dde),z.fromElements(dde.z,dde.x,dde.y,dde),z.clone(dde,ude.origin),z.clone(z.UNIT_X,ude.direction);var x=f.data.pick(ude,l,h,!1,dde);Object(u.a)(x)&&(g.callback(x),g.level=f.level)}else if(f.level===g.level){for(var E,T=f.children,C=T.length,S=0;S<C&&(E=T[S],!Ve.contains(E.rectangle,g.positionCartographic));++S);var A=a.getTileDataAvailable(E.x,E.y,E.level),P=f.parent;(Object(u.a)(A)&&!A||Object(u.a)(P)&&Object(u.a)(P.data)&&Object(u.a)(P.data.terrainData)&&!P.data.terrainData.isChildAvailable(P.x,P.y,E.x,E.y))&&g.removeFunc()}if(Qd()>=c){_=!0;break}}if(_){e._lastTileIndex=n;break}e._lastTileIndex=0,r.shift()}else i.push(f),r.shift(),e._lastTileIndex=0}for(n=0;n<i.length;n++)r.push(i[n])}(this,e),function(e,t){var i=e._tileLoadQueueHigh.length+e._tileLoadQueueMedium.length+e._tileLoadQueueLow.length;(i!==e._lastTileLoadQueueLength||e._tilesInvalidated)&&(t.afterRender.push($o.a.prototype.raiseEvent.bind(e._tileLoadProgressEvent,i)),e._lastTileLoadQueueLength=i);var n=e._debug;n.enableDebugOutput&&!n.suspendLodUpdate&&(n.tilesVisited===n.lastTilesVisited&&n.tilesRendered===n.lastTilesRendered&&n.tilesCulled===n.lastTilesCulled&&n.maxDepth===n.lastMaxDepth&&n.tilesWaitingForChildren===n.lastTilesWaitingForChildren||(console.log("Visited "+n.tilesVisited+", Rendered: "+n.tilesRendered+", Culled: "+n.tilesCulled+", Max Depth: "+n.maxDepth+", Waiting for children: "+n.tilesWaitingForChildren),n.lastTilesVisited=n.tilesVisited,n.lastTilesRendered=n.tilesRendered,n.lastTilesCulled=n.tilesCulled,n.lastMaxDepth=n.maxDepth,n.lastTilesWaitingForChildren=n.tilesWaitingForChildren))}(this,e))},ede.prototype.isDestroyed=function(){return!1},ede.prototype.destroy=function(){this._tileProvider=this._tileProvider&&this._tileProvider.destroy()};var ide=new K;function nde(e,t){var i=Ve.center(e.rectangle,ide),n=i.longitude-Jhe.longitude,r=i.latitude-Jhe.latitude,a=(i=Ve.center(t.rectangle,ide)).longitude-Jhe.longitude,o=i.latitude-Jhe.latitude;return n*n+r*r-(a*a+o*o)}function rde(e,t,i){var n=e._debug;if(++n.tilesVisited,e._tileReplacementQueue.markTileRendered(i),i._updateCustomData(t.frameNumber),i.level>n.maxDepth&&(n.maxDepth=i.level),function(e,t,i){if(t.mode===xF.SCENE2D||t.camera.frustum instanceof hb)return function(e,t,i){var n=t.camera.frustum;Object(u.a)(n._offCenterFrustum)&&(n=n._offCenterFrustum);var r=t.context,a=r.drawingBufferWidth,o=r.drawingBufferHeight,s=e._tileProvider.getLevelMaximumGeometricError(i.level),c=Math.max(n.top-n.bottom,n.right-n.left)/Math.max(a,o),l=s/c;t.fog.enabled&&t.mode!==xF.SCENE2D&&(l-=I.fog(i._distance,t.fog.density)*t.fog.sse);return l}(e,t,i);var n=e._tileProvider.getLevelMaximumGeometricError(i.level),r=i._distance,a=t.context.drawingBufferHeight,o=t.camera.frustum.sseDenominator,s=n*a/(r*o);t.fog.enabled&&(s-=I.fog(r,t.fog.density)*t.fog.sse);return s}(e,t,i)<e.maximumScreenSpaceError)return i.needsLoading&&e._tileLoadQueueMedium.push(i),void cde(e,i);var r=i.southwestChild,a=i.southeastChild,o=i.northwestChild,s=i.northeastChild,c=r.renderable&&a.renderable&&o.renderable&&s.renderable,l=r.upsampledFromParent&&a.upsampledFromParent&&o.upsampledFromParent&&s.upsampledFromParent;c?l?(cde(e,i),ade(e,t.camera.positionCartographic,r,a,o,s),i.needsLoading&&e._tileLoadQueueMedium.push(i)):(!function(e,t,i,n,r,a){var o=a.camera.positionCartographic,s=e._tileProvider,c=e._occluders;o.longitude<t.rectangle.east?o.latitude<t.rectangle.north?(sde(e,t,s,a,c),sde(e,i,s,a,c),sde(e,n,s,a,c),sde(e,r,s,a,c)):(sde(e,n,s,a,c),sde(e,t,s,a,c),sde(e,r,s,a,c),sde(e,i,s,a,c)):o.latitude<t.rectangle.north?(sde(e,i,s,a,c),sde(e,t,s,a,c),sde(e,r,s,a,c),sde(e,n,s,a,c)):(sde(e,r,s,a,c),sde(e,n,s,a,c),sde(e,i,s,a,c),sde(e,t,s,a,c))}(e,r,a,o,s,t),i.needsLoading&&e._tileLoadQueueLow.push(i)):(ade(e,t.camera.positionCartographic,r,a,o,s),cde(e,i),i.needsLoading&&e._tileLoadQueueLow.push(i))}function ade(e,t,i,n,r,a){t.longitude<i.east?t.latitude<i.north?(ode(e,i),ode(e,n),ode(e,r),ode(e,a)):(ode(e,r),ode(e,i),ode(e,a),ode(e,n)):t.latitude<i.north?(ode(e,n),ode(e,i),ode(e,a),ode(e,r)):(ode(e,a),ode(e,r),ode(e,n),ode(e,i))}function ode(e,t){e._tileReplacementQueue.markTileRendered(t),t.needsLoading&&(t.renderable?e._tileLoadQueueLow.push(t):e._tileLoadQueueHigh.push(t))}function sde(e,t,i,n,r){i.computeTileVisibility(t,n,r)!==Bx.NONE?rde(e,n,t):(++e._debug.tilesCulled,e._tileReplacementQueue.markTileRendered(t),t.needsLoading&&e._tileLoadQueueLow.push(t))}function cde(e,t){e._tilesToRender.push(t),++e._debug.tilesRendered}function lde(e,t,i,n,r){for(var a=0,o=r.length;a<o&&Qd()<n;++a){var s=r[a];e._tileReplacementQueue.markTileRendered(s),i.loadTile(t,s)}}var ude=new Ts,hde=new K,dde=new z,fde=[];var pde=ede;function mde(e){e=Object(w.a)(e,ae.WGS84);var t=new Jv({ellipsoid:e}),i=new Ghe;this._ellipsoid=e,this._imageryLayerCollection=i,this._surfaceShaderSet=new Rue,this._material=void 0,this._surface=new pde({tileProvider:new Bhe({terrainProvider:t,imageryLayers:i,surfaceShaderSet:this._surfaceShaderSet})}),this._terrainProvider=t,this._terrainProviderChanged=new $o.a,_de(this),this.show=!0,this._oceanNormalMapResourceDirty=!0,this._oceanNormalMapResource=new f.a({url:y("Assets/Textures/waterNormalsSmall.jpg")}),this.maximumScreenSpaceError=2,this.tileCacheSize=100,this.enableLighting=!1,this.showGroundAtmosphere=!0,this.lightingFadeOutDistance=1e7,this.lightingFadeInDistance=2e7,this.nightFadeOutDistance=1e7,this.nightFadeInDistance=5e7,this.showWaterEffect=!0,this.depthTestAgainstTerrain=!1,this.shadows=rM.RECEIVE_ONLY,this.atmosphereHueShift=0,this.atmosphereSaturationShift=0,this.atmosphereBrightnessShift=0,this._oceanNormalMap=void 0,this._zoomedOutOceanSpecularIntensity=void 0}function _de(e){var t=[],i=Object(u.a)(e._material)&&(e._material.shaderSource.match(/slope/)||e._material.shaderSource.match("normalEC")),n=[Due];!Object(u.a)(e._material)||i&&!e._terrainProvider.requestVertexNormals?e._surface._tileProvider.uniformMap=void 0:(n.push(e._material.shaderSource),t.push("APPLY_MATERIAL"),e._surface._tileProvider.uniformMap=e._material._uniforms),n.push(Pue),e._surfaceShaderSet.baseVertexShaderSource=new UN({sources:[Due,Iue],defines:t}),e._surfaceShaderSet.baseFragmentShaderSource=new UN({sources:n,defines:t}),e._surfaceShaderSet.material=e._material}Object(O.a)(mde.prototype,{ellipsoid:{get:function(){return this._ellipsoid}},imageryLayers:{get:function(){return this._imageryLayerCollection}},imageryLayersUpdatedEvent:{get:function(){return this._surface.tileProvider.imageryLayersUpdatedEvent}},tileLoadedEvent:{get:function(){return this._surface.tileProvider.tileLoadedEvent}},tilesLoaded:{get:function(){return!Object(u.a)(this._surface)||(!this.show||this._surface.tileProvider.ready&&0===this._surface._tileLoadQueueHigh.length&&0===this._surface._tileLoadQueueMedium.length&&0===this._surface._tileLoadQueueLow.length)}},baseColor:{get:function(){return this._surface.tileProvider.baseColor},set:function(e){this._surface.tileProvider.baseColor=e}},clippingPlanes:{get:function(){return this._surface.tileProvider.clippingPlanes},set:function(e){this._surface.tileProvider.clippingPlanes=e}},cartographicLimitRectangle:{get:function(){return this._surface.tileProvider.cartographicLimitRectangle},set:function(e){Object(u.a)(e)||(e=Ve.clone(Ve.MAX_VALUE)),this._surface.tileProvider.cartographicLimitRectangle=e}},oceanNormalMapUrl:{get:function(){return this._oceanNormalMapResource.url},set:function(e){this._oceanNormalMapResource.url=e,this._oceanNormalMapResourceDirty=!0}},terrainProvider:{get:function(){return this._terrainProvider},set:function(e){e!==this._terrainProvider&&(this._terrainProvider=e,this._terrainProviderChanged.raiseEvent(e),Object(u.a)(this._material)&&_de(this))}},terrainProviderChanged:{get:function(){return this._terrainProviderChanged}},tileLoadProgressEvent:{get:function(){return this._surface.tileLoadProgressEvent}},material:{get:function(){return this._material},set:function(e){this._material!==e&&(this._material=e,_de(this))}}});var gde=[],vde={start:0,stop:0};mde.prototype.pickWorldCoordinates=function(e,t,i){if(!Object(u.a)(e))throw new h.a("ray is required");if(!Object(u.a)(t))throw new h.a("scene is required");var n=t.mode,r=t.mapProjection,a=gde;a.length=0;var o,s,c,l,d=this._surface._tilesToRender,f=d.length;for(s=0;s<f;++s){var p=(o=d[s]).data;if(Object(u.a)(p)){var m=p.pickBoundingSphere;n!==xF.SCENE3D?(St.fromRectangleWithHeights2D(o.rectangle,r,p.minimumHeight,p.maximumHeight,m),z.fromElements(m.center.z,m.center.x,m.center.y,m.center)):St.clone(p.boundingSphere3D,m);var _=tc.raySphere(e,m,vde);Object(u.a)(_)&&a.push(p)}}for(a.sort((c=e.origin,function(e,t){return St.distanceSquaredTo(e.pickBoundingSphere,c)-St.distanceSquaredTo(t.pickBoundingSphere,c)})),f=a.length,s=0;s<f&&(l=a[s].pick(e,t.mode,t.mapProjection,!0,i),!Object(u.a)(l));++s);return l};var bde=new K;mde.prototype.pick=function(e,t,i){if(i=this.pickWorldCoordinates(e,t,i),Object(u.a)(i)&&t.mode!==xF.SCENE3D){i=z.fromElements(i.y,i.z,i.x,i);var n=t.mapProjection.unproject(i,bde);i=t.globe.ellipsoid.cartographicToCartesian(n,i)}return i};var yde=new z,wde=new z,Ode=new K,xde=new Ts;function Ede(e,t){return Ve.contains(e.rectangle,t)?e:void 0}mde.prototype.getHeight=function(e){if(!Object(u.a)(e))throw new h.a("cartographic is required");var t=this._surface._levelZeroTiles;if(Object(u.a)(t)){var i,n,r=t.length;for(n=0;n<r&&(i=t[n],!Ve.contains(i.rectangle,e));++n);if(Object(u.a)(i)&&Ve.contains(i.rectangle,e)){for(;i.renderable;)i=Ede(i.southwestChild,e)||Ede(i.southeastChild,e)||Ede(i.northwestChild,e)||i.northeastChild;for(;Object(u.a)(i)&&(!Object(u.a)(i.data)||!Object(u.a)(i.data.pickTerrain));)i=i.parent;if(Object(u.a)(i)){var a=this._surface._tileProvider.tilingScheme.ellipsoid,o=z.fromRadians(e.longitude,e.latitude,0,a,yde),s=xde,c=a.geodeticSurfaceNormal(o,s.direction),l=a.getSurfaceNormalIntersectionWithZAxis(o,11500,s.origin);if(!Object(u.a)(l)){var d=Math.min(Object(w.a)(i.data.minimumHeight,0),-11500),f=z.multiplyByScalar(c,Math.abs(d)+1,wde);z.subtract(o,f,s.origin)}var p=i.data.pick(s,void 0,void 0,!1,wde);if(Object(u.a)(p))return a.cartesianToCartographic(p,Ode).height}}}},mde.prototype.update=function(e){this.show&&e.passes.render&&this._surface.update(e)},mde.prototype.beginFrame=function(e){var t=this._surface,i=t.tileProvider,n=this.terrainProvider,r=this.showWaterEffect&&n.ready&&n.hasWaterMask;if(r&&this._oceanNormalMapResourceDirty){this._oceanNormalMapResourceDirty=!1;var a=this._oceanNormalMapResource,o=a.url;if(Object(u.a)(o)){var s=this;Object(Oi.a)(a.fetchImage(),(function(t){o===s._oceanNormalMapResource.url&&(s._oceanNormalMap=s._oceanNormalMap&&s._oceanNormalMap.destroy(),s._oceanNormalMap=new hj({context:e.context,source:t}))}))}else this._oceanNormalMap=this._oceanNormalMap&&this._oceanNormalMap.destroy()}var c=e.passes,l=e.mode;c.render&&(this.showGroundAtmosphere?this._zoomedOutOceanSpecularIntensity=.4:this._zoomedOutOceanSpecularIntensity=.5,t.maximumScreenSpaceError=this.maximumScreenSpaceError,t.tileCacheSize=this.tileCacheSize,i.terrainProvider=this.terrainProvider,i.lightingFadeOutDistance=this.lightingFadeOutDistance,i.lightingFadeInDistance=this.lightingFadeInDistance,i.nightFadeOutDistance=this.nightFadeOutDistance,i.nightFadeInDistance=this.nightFadeInDistance,i.zoomedOutOceanSpecularIntensity=l===xF.SCENE3D?this._zoomedOutOceanSpecularIntensity:0,i.hasWaterMask=r,i.oceanNormalMap=this._oceanNormalMap,i.enableLighting=this.enableLighting,i.showGroundAtmosphere=this.showGroundAtmosphere,i.shadows=this.shadows,i.hueShift=this.atmosphereHueShift,i.saturationShift=this.atmosphereSaturationShift,i.brightnessShift=this.atmosphereBrightnessShift,t.beginFrame(e))},mde.prototype.render=function(e){if(this.show){Object(u.a)(this._material)&&this._material.update(e.context);var t=this._surface,i=e.passes;i.render&&t.render(e),i.pick&&t.render(e)}},mde.prototype.endFrame=function(e){this.show&&e.passes.render&&this._surface.endFrame(e)},mde.prototype.isDestroyed=function(){return!1},mde.prototype.destroy=function(){return this._surfaceShaderSet=this._surfaceShaderSet&&this._surfaceShaderSet.destroy(),this._surface=this._surface&&this._surface.destroy(),this._oceanNormalMap=this._oceanNormalMap&&this._oceanNormalMap.destroy(),rl(this)};var Tde,Cde=mde,Sde="uniform sampler2D u_depthTexture;\nvarying vec2 v_textureCoordinates;\nvoid main()\n{\nfloat z_window = czm_unpackDepth(texture2D(u_depthTexture, v_textureCoordinates));\nz_window = czm_reverseLogDepth(z_window);\nfloat n_range = czm_depthRange.near;\nfloat f_range = czm_depthRange.far;\nfloat z_ndc = (2.0 * z_window - n_range - f_range) / (f_range - n_range);\nfloat scale = pow(z_ndc * 0.5 + 0.5, 8.0);\ngl_FragColor = vec4(mix(vec3(0.0), vec3(1.0), scale), 1.0);\n}\n",Ade="uniform sampler2D colorTexture;\nvarying vec2 v_textureCoordinates;\nvoid main()\n{\ngl_FragColor = texture2D(colorTexture, v_textureCoordinates);\n}\n",Pde="uniform sampler2D u_depthTexture;\nvarying vec2 v_textureCoordinates;\nvoid main()\n{\ngl_FragColor = czm_packDepth(texture2D(u_depthTexture, v_textureCoordinates).r);\n}\n",Ide="layout(location = 0) out vec4 mrt_fragColor;\nlayout(location = 1) out vec4 mrt_fragDepth;\nuniform vec4 clearColor;\nvoid main() {\nmrt_fragColor = clearColor;\nmrt_fragDepth = czm_packDepth(1.0);\n}\n";function Dde(){this._colorTexture=void 0,this._depthStencilTexture=void 0,this._globeDepthTexture=void 0,this._tempGlobeDepthTexture=void 0,this._tempCopyDepthTexture=void 0,this.framebuffer=void 0,this._copyDepthFramebuffer=void 0,this._tempCopyDepthFramebuffer=void 0,this._updateDepthFramebuffer=void 0,this._clearColorCommand=void 0,this._copyColorCommand=void 0,this._copyDepthCommand=void 0,this._tempCopyDepthCommand=void 0,this._updateDepthCommand=void 0,this._clearMRTCommand=void 0,this._viewport=new ln,this._rs=void 0,this._rsUpdate=void 0,this._useScissorTest=!1,this._scissorRectangle=void 0,this._useLogDepth=void 0,this._useHdr=void 0,this._debugGlobeDepthViewportCommand=void 0,this._multisamplingColorRenderbuffer=void 0,this._multisamplingDepthStencilRenderbuffer=void 0,this.multisamplingBlitFramerbuffer=void 0}function jde(e){e._colorTexture=e._colorTexture&&!e._colorTexture.isDestroyed()&&e._colorTexture.destroy(),e._depthStencilTexture=e._depthStencilTexture&&!e._depthStencilTexture.isDestroyed()&&e._depthStencilTexture.destroy(),e._globeDepthTexture=e._globeDepthTexture&&!e._globeDepthTexture.isDestroyed()&&e._globeDepthTexture.destroy(),e._multisamplingColorRenderbuffer=e._multisamplingColorRenderbuffer&&!e._multisamplingColorRenderbuffer.isDestroyed()&&e._multisamplingColorRenderbuffer.destroy(),e._multisamplingDepthStencilRenderbuffer=e._multisamplingDepthStencilRenderbuffer&&!e._multisamplingDepthStencilRenderbuffer.isDestroyed()&&e._multisamplingDepthStencilRenderbuffer.destroy()}function Mde(e){e.framebuffer=e.framebuffer&&!e.framebuffer.isDestroyed()&&e.framebuffer.destroy(),e._copyDepthFramebuffer=e._copyDepthFramebuffer&&!e._copyDepthFramebuffer.isDestroyed()&&e._copyDepthFramebuffer.destroy(),e.multisamplingBlitFramerbuffer=e.multisamplingBlitFramerbuffer&&!e.multisamplingBlitFramerbuffer.isDestroyed()&&e.multisamplingBlitFramerbuffer.destroy()}function Rde(e){e._tempCopyDepthFramebuffer=e._tempCopyDepthFramebuffer&&!e._tempCopyDepthFramebuffer.isDestroyed()&&e._tempCopyDepthFramebuffer.destroy(),e._updateDepthFramebuffer=e._updateDepthFramebuffer&&!e._updateDepthFramebuffer.isDestroyed()&&e._updateDepthFramebuffer.destroy(),e._tempGlobeDepthTexture=e._tempGlobeDepthTexture&&!e._tempGlobeDepthTexture.isDestroyed()&&e._tempGlobeDepthTexture.destroy()}function Lde(e,t,i,n,r){var a=e._colorTexture,o=!Object(u.a)(a)||a.width!==i||a.height!==n||r!==e._useHdr;Object(u.a)(e.framebuffer)&&!o||(jde(e),Mde(e),function(e,t,i,n,r){var a=r?t.halfFloatingPointTexture?mx.HALF_FLOAT:mx.FLOAT:mx.UNSIGNED_BYTE;if(e._colorTexture=new hj({context:t,width:i,height:n,pixelFormat:gx.RGBA,pixelDatatype:a,sampler:new tj({wrapS:$D.CLAMP_TO_EDGE,wrapT:$D.CLAMP_TO_EDGE,minificationFilter:KD.NEAREST,magnificationFilter:ZD.NEAREST})}),e._depthStencilTexture=new hj({context:t,width:i,height:n,pixelFormat:gx.DEPTH_STENCIL,pixelDatatype:mx.UNSIGNED_INT_24_8,sampler:new tj({wrapS:$D.CLAMP_TO_EDGE,wrapT:$D.CLAMP_TO_EDGE,minificationFilter:KD.NEAREST,magnificationFilter:ZD.NEAREST})}),e._globeDepthTexture=new hj({context:t,width:i,height:n,pixelFormat:gx.RGBA,pixelDatatype:mx.UNSIGNED_BYTE,sampler:new tj({wrapS:$D.CLAMP_TO_EDGE,wrapT:$D.CLAMP_TO_EDGE,minificationFilter:KD.NEAREST,magnificationFilter:ZD.NEAREST})}),fx.isWebgl2){var o=r?t.halfFloatingPointTexture?nre.RGBA16F:nre.RGBA32F:nre.RGBA8;e._multisamplingColorRenderbuffer=new are({context:t,width:i,height:n,format:o,samples:fx.multipleSamples}),e._multisamplingDepthStencilRenderbuffer=new are({context:t,width:i,height:n,format:nre.DEPTH24_STENCIL8,samples:fx.multipleSamples})}}(e,t,i,n,r),function(e,t){e.framebuffer=new cj({context:t,colorTextures:[e._colorTexture],depthStencilTexture:e._depthStencilTexture,destroyAttachments:!1}),e._copyDepthFramebuffer=new cj({context:t,colorTextures:[e._globeDepthTexture],destroyAttachments:!1}),fx.isWebgl2&&(e.multisamplingBlitFramerbuffer=new cj({context:t,colorRenderbuffers:[e._multisamplingColorRenderbuffer],depthStencilRenderbuffer:e._multisamplingDepthStencilRenderbuffer,destroyAttachments:!1}))}(e,t))}function Nde(e,t,i,n,r){e._viewport.width=i,e._viewport.height=n;var a=!ln.equals(e._viewport,r.viewport),o=a!==e._useScissorTest;e._useScissorTest=a,ln.equals(e._scissorRectangle,r.viewport)||(e._scissorRectangle=ln.clone(r.viewport,e._scissorRectangle),o=!0),Object(u.a)(e._rs)&&ln.equals(e._viewport,e._rs.viewport)&&!o||(e._rs=RM.fromCache({viewport:e._viewport,scissorTest:{enabled:e._useScissorTest,rectangle:e._scissorRectangle}}),e._rsUpdate=RM.fromCache({viewport:e._viewport,scissorTest:{enabled:e._useScissorTest,rectangle:e._scissorRectangle},stencilTest:{enabled:!0,frontFunction:Bk.EQUAL,frontOperation:{fail:Uk.KEEP,zFail:Uk.KEEP,zPass:Uk.KEEP},backFunction:Bk.NEVER,reference:Hk.CESIUM_3D_TILE_MASK,mask:Hk.CESIUM_3D_TILE_MASK}})),Object(u.a)(e._copyDepthCommand)||(e._copyDepthCommand=t.createViewportQuadCommand(Pde,{uniformMap:{u_depthTexture:function(){return e._depthStencilTexture}},owner:e})),e._copyDepthCommand.framebuffer=e._copyDepthFramebuffer,e._copyDepthCommand.renderState=e._rs,Object(u.a)(e._copyColorCommand)||(e._copyColorCommand=t.createViewportQuadCommand(Ade,{uniformMap:{colorTexture:function(){return e._colorTexture}},owner:e})),Object(u.a)(e._tempCopyDepthCommand)||(e._tempCopyDepthCommand=t.createViewportQuadCommand(Pde,{uniformMap:{u_depthTexture:function(){return e._tempCopyDepthTexture}},owner:e})),e._tempCopyDepthCommand.framebuffer=e._tempCopyDepthFramebuffer,e._tempCopyDepthCommand.renderState=e._rs,Object(u.a)(e._updateDepthCommand)||(e._updateDepthCommand=t.createViewportQuadCommand(Ade,{uniformMap:{colorTexture:function(){return e._tempGlobeDepthTexture}},owner:e})),e._updateDepthCommand.framebuffer=e._updateDepthFramebuffer,e._updateDepthCommand.renderState=e._rsUpdate,Object(u.a)(e._clearColorCommand)||(e._clearColorCommand=new fX({color:new uf(0,0,0,0),stencil:0,owner:e})),e._clearColorCommand.framebuffer=e.framebuffer}Dde.prototype.executeDebugGlobeDepth=function(e,t,i){!function(e,t,i,n){if(!Object(u.a)(e._debugGlobeDepthViewportCommand)||n!==e._useLogDepth){var r=new UN({defines:[n?"LOG_DEPTH":""],sources:["uniform sampler2D u_depthTexture;\nvarying vec2 v_textureCoordinates;\nvoid main()\n{\n    float z_window = czm_unpackDepth(texture2D(u_depthTexture, v_textureCoordinates));\n    z_window = czm_reverseLogDepth(z_window); \n    float n_range = czm_depthRange.near;\n    float f_range = czm_depthRange.far;\n    float z_ndc = (2.0 * z_window - n_range - f_range) / (f_range - n_range);\n    float scale = pow(z_ndc * 0.5 + 0.5, 8.0);\n    gl_FragColor = vec4(mix(vec3(0.0), vec3(1.0), scale), 1.0);\n}\n"]});e._debugGlobeDepthViewportCommand=t.createViewportQuadCommand(r,{uniformMap:{u_depthTexture:function(){return e._globeDepthTexture}},owner:e}),e._useLogDepth=n}e._debugGlobeDepthViewportCommand.execute(t,i)}(this,e,t,i)},Dde.prototype.update=function(e,t,i,n){var r=i.width,a=i.height;Lde(this,e,r,a,n),Nde(this,e,r,a,t),e.uniformState.globeDepthTexture=void 0,this._useHdr=n},Dde.prototype.blitFramebuffer=function(e,t){if(fx.isWebgl2){var i=t.width,n=t.height,r=e._gl;this.multisamplingBlitFramerbuffer._bind(r.READ_FRAMEBUFFER),this.framebuffer._bind(r.DRAW_FRAMEBUFFER),r.clearBufferfv(r.COLOR,0,[0,0,0,1]);var a=this.multisamplingBlitFramerbuffer._getActiveColorAttachments(),o=a.length;Tde||(Tde=new Array(o));for(var s=0;s<o;++s){for(var c=0;c<Tde.length;c++)Tde[c]=r.NONE;Tde[s]=a[s],r.readBuffer(Tde[s]),r.drawBuffers(Tde),r.blitFramebuffer(0,0,i,n,0,0,i,n,r.COLOR_BUFFER_BIT,r.NEAREST)}r.drawBuffers(a),r.clearBufferfi(r.DEPTH_STENCIL,0,1,0),r.blitFramebuffer(0,0,i,n,0,0,i,n,r.DEPTH_BUFFER_BIT|r.STENCIL_BUFFER_BIT,r.NEAREST)}},Dde.prototype.executeCopyDepth=function(e,t){Object(u.a)(this._copyDepthCommand)&&(this._copyDepthCommand.execute(e,t),e.uniformState.globeDepthTexture=this._globeDepthTexture)},Dde.prototype.executeUpdateDepth=function(e,t,i){var n=fx.isWebgl2?this._depthStencilTexture:t.framebuffer.depthStencilTexture;if(i||n!==this._depthStencilTexture){if(Object(u.a)(this._updateDepthCommand)){if(!Object(u.a)(this._updateDepthFramebuffer)||this._updateDepthFramebuffer.depthStencilTexture!==n||this._updateDepthFramebuffer.getColorTexture(0)!==this._globeDepthTexture){var r=this._globeDepthTexture.width,a=this._globeDepthTexture.height;Rde(this),function(e,t,i,n,r){e._tempGlobeDepthTexture=new hj({context:t,width:i,height:n,pixelFormat:gx.RGBA,pixelDatatype:mx.UNSIGNED_BYTE,sampler:new tj({wrapS:$D.CLAMP_TO_EDGE,wrapT:$D.CLAMP_TO_EDGE,minificationFilter:KD.NEAREST,magnificationFilter:ZD.NEAREST})}),e._tempCopyDepthFramebuffer=new cj({context:t,colorTextures:[e._tempGlobeDepthTexture],destroyAttachments:!1}),e._updateDepthFramebuffer=new cj({context:t,colorTextures:[e._globeDepthTexture],depthStencilTexture:r.framebuffer.depthStencilTexture,destroyAttachments:!1})}(this,e,r,a,t),Nde(this,e,r,a,t)}this._tempCopyDepthTexture=n,this._tempCopyDepthCommand.execute(e,t),this._updateDepthCommand.execute(e,t)}}else Object(u.a)(this._copyDepthCommand)&&this._copyDepthCommand.execute(e,t)},Dde.prototype.executeCopyColor=function(e,t){Object(u.a)(this._copyColorCommand)&&this._copyColorCommand.execute(e,t)},Dde.prototype.clear=function(e,t,i){var n=this._clearColorCommand;Object(u.a)(n)&&(uf.clone(i,n.color),n.execute(e,t))},Dde.prototype.clearMRTColorTexture=function(e,t){},Dde.prototype.isDestroyed=function(){return!1},Dde.prototype.destroy=function(){jde(this),Mde(this),Rde(this),Object(u.a)(this._copyColorCommand)&&(this._copyColorCommand.shaderProgram=this._copyColorCommand.shaderProgram.destroy()),Object(u.a)(this._copyDepthCommand)&&(this._copyDepthCommand.shaderProgram=this._copyDepthCommand.shaderProgram.destroy());var e=this._debugGlobeDepthViewportCommand;return Object(u.a)(e)&&(e.shaderProgram=e.shaderProgram.destroy()),rl(this)};var Fde=Dde;function kde(){this._image=new Image}function Bde(e){if(e=Object(w.a)(e,w.a.EMPTY_OBJECT),!Object(u.a)(e.url)&&!Object(u.a)(e.metadata))throw new h.a("options.url or options.metadata is required.");var t;if(Object(u.a)(e.metadata))t=e.metadata;else{var i=f.a.createIfNeeded(e.url);t=new wy(i)}this._metadata=t,this._tileDiscardPolicy=e.tileDiscardPolicy,this._tilingScheme=new Nt({numberOfLevelZeroTilesX:2,numberOfLevelZeroTilesY:2,rectangle:new Ve(-I.PI,-I.PI,I.PI,I.PI),ellipsoid:e.ellipsoid});var n=e.credit;"string"==typeof n&&(n=new Jo(n)),this._credit=n,this._tileWidth=256,this._tileHeight=256,this._maximumLevel=23,Object(u.a)(this._tileDiscardPolicy)||(this._tileDiscardPolicy=new kde),this._errorEvent=new $o.a,this._ready=!1;var r,a=this;this._readyPromise=t.readyPromise.then((function(e){if(!t.imageryPresent){var i=new Ce.a("The server "+t.url+" doesn't have imagery");return r=uu.handleError(r,a,a._errorEvent,i.message,void 0,void 0,void 0,i),Oi.a.reject(i)}return uu.handleSuccess(r),a._ready=e,e})).otherwise((function(e){return r=uu.handleError(r,a,a._errorEvent,e.message,void 0,void 0,void 0,e),Oi.a.reject(e)}))}kde.prototype.isReady=function(){return!0},kde.prototype.shouldDiscardImage=function(e){return e===this._image},Object(O.a)(Bde.prototype,{url:{get:function(){return this._metadata.url}},proxy:{get:function(){return this._metadata.proxy}},tileWidth:{get:function(){if(!this._ready)throw new h.a("tileWidth must not be called before the imagery provider is ready.");return this._tileWidth}},tileHeight:{get:function(){if(!this._ready)throw new h.a("tileHeight must not be called before the imagery provider is ready.");return this._tileHeight}},maximumLevel:{get:function(){if(!this._ready)throw new h.a("maximumLevel must not be called before the imagery provider is ready.");return this._maximumLevel}},minimumLevel:{get:function(){if(!this._ready)throw new h.a("minimumLevel must not be called before the imagery provider is ready.");return 0}},tilingScheme:{get:function(){if(!this._ready)throw new h.a("tilingScheme must not be called before the imagery provider is ready.");return this._tilingScheme}},rectangle:{get:function(){if(!this._ready)throw new h.a("rectangle must not be called before the imagery provider is ready.");return this._tilingScheme.rectangle}},tileDiscardPolicy:{get:function(){if(!this._ready)throw new h.a("tileDiscardPolicy must not be called before the imagery provider is ready.");return this._tileDiscardPolicy}},errorEvent:{get:function(){return this._errorEvent}},ready:{get:function(){return this._ready}},readyPromise:{get:function(){return this._readyPromise}},credit:{get:function(){return this._credit}},hasAlphaChannel:{get:function(){return!1}}}),Bde.prototype.getTileCredits=function(e,t,i){if(!this._ready)throw new h.a("getTileCredits must not be called before the imagery provider is ready.");var n=this._metadata,r=n.getTileInformation(e,t,i);if(Object(u.a)(r)){var a=n.providers[r.imageryProvider];if(Object(u.a)(a))return[a]}},Bde.prototype.requestImage=function(e,t,i,n){if(!this._ready)throw new h.a("requestImage must not be called before the imagery provider is ready.");var r=this._tileDiscardPolicy._image,a=this._metadata,o=wy.tileXYToQuadKey(e,t,i),s=a.getTileInformation(e,t,i);if(!Object(u.a)(s)){if(a.isValid(o)){var c=new Vl.a({throttle:n.throttle,throttleByServer:n.throttleByServer,type:n.type,priorityFunction:n.priorityFunction});return void a.populateSubtree(e,t,i,c)}return r}if(!s.hasImagery())return r;var l=function(e,t,i,n,r,a){var o=wy.tileXYToQuadKey(i,n,r),s=t.imageryVersion;return s=Object(u.a)(s)&&s>0?s:1,e._metadata.resource.getDerivedResource({url:"flatfile?f1-0"+o+"-i."+s.toString(),request:a})}(this,s,e,t,i,n).fetchArrayBuffer();return Object(u.a)(l)?l.then((function(e){dv(a.key,e);var t,i=new Uint8Array(e),n=a.protoImagery;if(Object(u.a)(n)&&n||(t=function(e){if(e[6]==="JFIF".charCodeAt(0)&&e[7]==="JFIF".charCodeAt(1)&&e[8]==="JFIF".charCodeAt(2)&&e[9]==="JFIF".charCodeAt(3))return"image/jpeg";if(e[1]==="PNG".charCodeAt(0)&&e[2]==="PNG".charCodeAt(1)&&e[3]==="PNG".charCodeAt(2))return"image/png";return}(i)),!Object(u.a)(t)&&(!Object(u.a)(n)||n)){var o=function(e){var t=ly.a.Reader.create(e),i=t.len,n={};for(;t.pos<i;){var r=t.uint32();switch(r>>>3){case 1:n.imageType=t.uint32();break;case 2:n.imageData=t.bytes();break;case 3:n.alphaType=t.uint32();break;case 4:n.imageAlpha=t.bytes();break;case 5:var a=n.copyrightIds;if(Object(u.a)(a)||(a=n.copyrightIds=[]),2==(7&r))for(var o=t.uint32()+t.pos;t.pos<o;)a.push(t.uint32());else a.push(t.uint32());break;default:t.skipType(7&r)}}var s=n.imageType;if(Object(u.a)(s))switch(s){case 0:n.imageType="image/jpeg";break;case 4:n.imageType="image/png";break;default:throw new Ce.a("GoogleEarthEnterpriseImageryProvider: Unsupported image type.")}var c=n.alphaType;Object(u.a)(c)&&0!==c&&(console.log("GoogleEarthEnterpriseImageryProvider: External alpha not supported."),delete n.alphaType,delete n.imageAlpha);return n}(i);t=o.imageType,i=o.imageData}return Object(u.a)(t)&&Object(u.a)(i)?hx(i,t):r})):void 0},Bde.prototype.pickFeatures=function(e,t,i,n,r){};var zde=Bde,Ude=new uf(1,1,1,.4),Vde=new uf(0,1,0,.05),Hde=new uf(0,.5,0,.2);function Gde(e){e=Object(w.a)(e,w.a.EMPTY_OBJECT),this._tilingScheme=Object(u.a)(e.tilingScheme)?e.tilingScheme:new Nt({ellipsoid:e.ellipsoid}),this._cells=Object(w.a)(e.cells,8),this._color=Object(w.a)(e.color,Ude),this._glowColor=Object(w.a)(e.glowColor,Vde),this._glowWidth=Object(w.a)(e.glowWidth,6),this._backgroundColor=Object(w.a)(e.backgroundColor,Hde),this._errorEvent=new $o.a,this._tileWidth=Object(w.a)(e.tileWidth,256),this._tileHeight=Object(w.a)(e.tileHeight,256),this._canvasSize=Object(w.a)(e.canvasSize,256),this._canvas=this._createGridCanvas(),this._readyPromise=Oi.a.resolve(!0)}Object(O.a)(Gde.prototype,{proxy:{get:function(){}},tileWidth:{get:function(){return this._tileWidth}},tileHeight:{get:function(){return this._tileHeight}},maximumLevel:{get:function(){}},minimumLevel:{get:function(){}},tilingScheme:{get:function(){return this._tilingScheme}},rectangle:{get:function(){return this._tilingScheme.rectangle}},tileDiscardPolicy:{get:function(){}},errorEvent:{get:function(){return this._errorEvent}},ready:{get:function(){return!0}},readyPromise:{get:function(){return this._readyPromise}},credit:{get:function(){}},hasAlphaChannel:{get:function(){return!0}}}),Gde.prototype._drawGrid=function(e){for(var t=this._canvasSize,i=0;i<=this._cells;++i){var n=1+i/this._cells*(t-1);e.moveTo(n,0),e.lineTo(n,t),e.moveTo(0,n),e.lineTo(t,n)}e.stroke()},Gde.prototype._createGridCanvas=function(){var e=document.createElement("canvas");e.width=this._canvasSize,e.height=this._canvasSize;var t=this._canvasSize,i=e.getContext("2d"),n=this._backgroundColor.toCssColorString();i.fillStyle=n,i.fillRect(0,0,t,t);var r=this._glowColor.toCssColorString();i.strokeStyle=r,i.lineWidth=this._glowWidth,i.strokeRect(0,0,t,t),this._drawGrid(i),i.lineWidth=.5*this._glowWidth,i.strokeRect(0,0,t,t),this._drawGrid(i);var a=this._color.toCssColorString();return i.strokeStyle=a,i.lineWidth=2,i.strokeRect(0,0,t,t),i.lineWidth=1,this._drawGrid(i),e},Gde.prototype.getTileCredits=function(e,t,i){},Gde.prototype.requestImage=function(e,t,i,n){return this._canvas},Gde.prototype.pickFeatures=function(e,t,i,n,r){};var qde=Gde;function Wde(){this.previousFramebuffer=void 0,this._previousFramebuffer=void 0,this._texture=void 0,this._classifiedTexture=void 0,this._depthStencilTexture=void 0,this._fbo=void 0,this._fboClassified=void 0,this._rsUnclassified=void 0,this._rsClassified=void 0,this._unclassifiedCommand=void 0,this._classifiedCommand=void 0,this._translucentCommand=void 0,this._clearColorCommand=new fX({color:new uf(0,0,0,0),owner:this}),this._clearCommand=new fX({color:new uf(0,0,0,0),depth:1,stencil:0});var e=this;this._uniformMap={colorTexture:function(){return e._texture},depthTexture:function(){return e._depthStencilTexture},classifiedTexture:function(){return e._classifiedTexture}}}Object(O.a)(Wde.prototype,{unclassifiedCommand:{get:function(){return this._unclassifiedCommand}}}),Wde.isTranslucencySupported=function(e){return e.depthTexture&&e.fragmentDepth};var Yde={depthMask:!1,stencilTest:{enabled:!0,frontFunction:Bk.EQUAL,frontOperation:{fail:Uk.KEEP,zFail:Uk.KEEP,zPass:Uk.KEEP},backFunction:Bk.NEVER,reference:0,mask:Hk.CLASSIFICATION_MASK},blending:FD.ALPHA_BLEND},Xde={depthMask:!1,stencilTest:{enabled:!0,frontFunction:Bk.NOT_EQUAL,frontOperation:{fail:Uk.KEEP,zFail:Uk.KEEP,zPass:Uk.KEEP},backFunction:Bk.NEVER,reference:0,mask:Hk.CLASSIFICATION_MASK},blending:FD.ALPHA_BLEND},Zde={depthMask:!0,depthTest:{enabled:!0},stencilTest:Hk.setCesium3DTileBit(),stencilMask:Hk.CESIUM_3D_TILE_MASK,blending:FD.ALPHA_BLEND};Wde.prototype.update=function(e){var t=this._texture,i=!Object(u.a)(t)||this.previousFramebuffer!==this._previousFramebuffer;this._previousFramebuffer=this.previousFramebuffer;var n,r,a=e.drawingBufferWidth,o=e.drawingBufferHeight,s=!Object(u.a)(t)||t.width!==a||t.height!==o;((s||i)&&(this._texture=this._texture&&this._texture.destroy(),this._classifiedTexture=this._classifiedTexture&&this._classifiedTexture.destroy(),this._depthStencilTexture=this._depthStencilTexture&&this._depthStencilTexture.destroy(),this._texture=new hj({context:e,width:a,height:o,pixelFormat:gx.RGBA,pixelDatatype:mx.UNSIGNED_BYTE,sampler:new tj({wrapS:$D.CLAMP_TO_EDGE,wrapT:$D.CLAMP_TO_EDGE,minificationFilter:KD.LINEAR,magnificationFilter:ZD.LINEAR})}),Object(u.a)(this._previousFramebuffer)||(this._classifiedTexture=new hj({context:e,width:a,height:o,pixelFormat:gx.RGBA,pixelDatatype:mx.UNSIGNED_BYTE,sampler:new tj({wrapS:$D.CLAMP_TO_EDGE,wrapT:$D.CLAMP_TO_EDGE,minificationFilter:KD.LINEAR,magnificationFilter:ZD.LINEAR})}),this._depthStencilTexture=new hj({context:e,width:a,height:o,pixelFormat:gx.DEPTH_STENCIL,pixelDatatype:mx.UNSIGNED_INT_24_8}))),!Object(u.a)(this._fbo)||s||i)&&(this._fbo=this._fbo&&this._fbo.destroy(),this._fboClassified=this._fboClassified&&this._fboClassified.destroy(),Object(u.a)(this._previousFramebuffer)?(n=this._previousFramebuffer.depthStencilTexture,r=this._previousFramebuffer.depthStencilRenderbuffer):n=this._depthStencilTexture,this._fbo=new cj({context:e,colorTextures:[this._texture],depthStencilTexture:n,depthStencilRenderbuffer:r,destroyAttachments:!1}),Object(u.a)(this._previousFramebuffer)||(this._fboClassified=new cj({context:e,colorTextures:[this._classifiedTexture],depthStencilTexture:n,destroyAttachments:!1})));if(Object(u.a)(this._rsUnclassified)||(this._rsUnclassified=RM.fromCache(Yde),this._rsClassified=RM.fromCache(Xde),this._rsDefault=RM.fromCache(Zde)),!Object(u.a)(this._unclassifiedCommand)||i){Object(u.a)(this._unclassifiedCommand)&&(this._unclassifiedCommand.shaderProgram=this._unclassifiedCommand.shaderProgram&&this._unclassifiedCommand.shaderProgram.destroy(),this._classifiedCommand.shaderProgram=this._classifiedCommand.shaderProgram&&this._classifiedCommand.shaderProgram.destroy());var c=Object(u.a)(this._previousFramebuffer)?"uniform sampler2D colorTexture;\nvarying vec2 v_textureCoordinates;\nvoid main()\n{\n    vec4 color = texture2D(colorTexture, v_textureCoordinates);\n    if (color.a == 0.0)\n    {\n        discard;\n    }\n#ifdef UNCLASSIFIED\n    gl_FragColor = color * czm_invertClassificationColor;\n#else\n    gl_FragColor = color;\n#endif\n}\n":"#extension GL_EXT_frag_depth : enable\nuniform sampler2D colorTexture;\nuniform sampler2D depthTexture;\nuniform sampler2D classifiedTexture;\nvarying vec2 v_textureCoordinates;\nvoid main()\n{\n    vec4 color = texture2D(colorTexture, v_textureCoordinates);\n    if (color.a == 0.0)\n    {\n        discard;\n    }\n    bool isClassified = all(equal(texture2D(classifiedTexture, v_textureCoordinates), vec4(0.0)));\n#ifdef UNCLASSIFIED\n    vec4 highlightColor = czm_invertClassificationColor;\n    if (isClassified)\n    {\n        discard;\n    }\n#else\n    vec4 highlightColor = vec4(1.0);\n    if (!isClassified)\n    {\n        discard;\n    }\n#endif\n    gl_FragColor = color * highlightColor;\n    gl_FragDepthEXT = texture2D(depthTexture, v_textureCoordinates).r;\n}\n",l=new UN({defines:["UNCLASSIFIED"],sources:[c]}),h=new UN({sources:[c]});this._unclassifiedCommand=e.createViewportQuadCommand(l,{renderState:Object(u.a)(this._previousFramebuffer)?this._rsUnclassified:this._rsDefault,uniformMap:this._uniformMap,owner:this}),this._classifiedCommand=e.createViewportQuadCommand(h,{renderState:Object(u.a)(this._previousFramebuffer)?this._rsClassified:this._rsDefault,uniformMap:this._uniformMap,owner:this}),Object(u.a)(this._translucentCommand)&&(this._translucentCommand.shaderProgram=this._translucentCommand.shaderProgram&&this._translucentCommand.shaderProgram.destroy()),Object(u.a)(this._previousFramebuffer)||(this._translucentCommand=e.createViewportQuadCommand(Ade,{renderState:this._rsUnclassified,uniformMap:this._uniformMap,owner:this}))}},Wde.prototype.clear=function(e,t){var i=t.framebuffer;Object(u.a)(this._previousFramebuffer)?(t.framebuffer=this._fbo,this._clearColorCommand.execute(e,t)):(t.framebuffer=this._fbo,this._clearCommand.execute(e,t),t.framebuffer=this._fboClassified,this._clearCommand.execute(e,t)),t.framebuffer=i},Wde.prototype.executeClassified=function(e,t){if(!Object(u.a)(this._previousFramebuffer)){var i=t.framebuffer;t.framebuffer=this._fboClassified,this._translucentCommand.execute(e,t),t.framebuffer=i}this._classifiedCommand.execute(e,t)},Wde.prototype.executeUnclassified=function(e,t){this._unclassifiedCommand.execute(e,t)},Wde.prototype.isDestroyed=function(){return!1},Wde.prototype.destroy=function(){return this._fbo=this._fbo&&this._fbo.destroy(),this._texture=this._texture&&this._texture.destroy(),this._depthStencilTexture=this._depthStencilTexture&&this._depthStencilTexture.destroy(),Object(u.a)(this._unclassifiedCommand)&&(this._unclassifiedCommand.shaderProgram=this._unclassifiedCommand.shaderProgram&&this._unclassifiedCommand.shaderProgram.destroy(),this._classifiedCommand.shaderProgram=this._classifiedCommand.shaderProgram&&this._classifiedCommand.shaderProgram.destroy()),rl(this)};var Qde=Wde;function Kde(e){this._total=e,this.usedThisFrame=0,this.stolenFromMeThisFrame=0,this.starvedThisFrame=!1,this.starvedLastFrame=!1}function Jde(e){if(Object(u.a)(e)&&e.length!==gJ.NUMBER_OF_JOB_TYPES)throw new h.a("A budget must be specified for each job type; budgets.length should equal JobType.NUMBER_OF_JOB_TYPES.");var t=new Array(gJ.NUMBER_OF_JOB_TYPES);t[gJ.TEXTURE]=new Kde(Object(u.a)(e)?e[gJ.TEXTURE]:10),t[gJ.PROGRAM]=new Kde(Object(u.a)(e)?e[gJ.PROGRAM]:10),t[gJ.BUFFER]=new Kde(Object(u.a)(e)?e[gJ.BUFFER]:30);var i,n=t.length,r=0;for(i=0;i<n;++i)r+=t[i].total;var a=new Array(n);for(i=0;i<n;++i)a[i]=!1;this._totalBudget=r,this._totalUsedThisFrame=0,this._budgets=t,this._executedThisFrame=a}Object(O.a)(Kde.prototype,{total:{get:function(){return this._total}}}),Jde.getTimestamp=Qd,Object(O.a)(Jde.prototype,{totalBudget:{get:function(){return this._totalBudget}}}),Jde.prototype.disableThisFrame=function(){this._totalUsedThisFrame=this._totalBudget},Jde.prototype.resetBudgets=function(){for(var e=this._budgets,t=e.length,i=0;i<t;++i){var n=e[i];n.starvedLastFrame=n.starvedThisFrame,n.starvedThisFrame=!1,n.usedThisFrame=0,n.stolenFromMeThisFrame=0}this._totalUsedThisFrame=0},Jde.prototype.execute=function(e,t){var i,n=this._budgets,r=n[t],a=this._executedThisFrame[t];if(this._totalUsedThisFrame>=this._totalBudget&&a)return r.starvedThisFrame=!0,!1;if(r.usedThisFrame+r.stolenFromMeThisFrame>=r.total){var o,s=n.length;for(o=0;o<s&&(!((i=n[o]).usedThisFrame+i.stolenFromMeThisFrame<i.total)||i.starvedLastFrame);++o);if(o===s&&a)return!1;a&&(r.starvedThisFrame=!0)}var c=Jde.getTimestamp();e.execute();var l=Jde.getTimestamp()-c;return this._totalUsedThisFrame+=l,i?i.stolenFromMeThisFrame+=l:r.usedThisFrame+=l,this._executedThisFrame[t]=!0,!0};var $de=Jde;function efe(e){var t=(e=Object(w.a)(e,w.a.EMPTY_OBJECT)).textureUrl;Object(u.a)(t)||(t=y("Assets/Textures/moonSmall.jpg")),this.show=Object(w.a)(e.show,!0),this.textureUrl=t,this._ellipsoid=Object(w.a)(e.ellipsoid,ae.MOON),this.onlySunLighting=Object(w.a)(e.onlySunLighting,!0),this._ellipsoidPrimitive=new uue({radii:this.ellipsoid.radii,material:qj.fromType(qj.ImageType),depthTestEnabled:!1,_owner:this}),this._ellipsoidPrimitive.material.translucent=!1,this._axes=new HO}Object(O.a)(efe.prototype,{ellipsoid:{get:function(){return this._ellipsoid}}});var tfe=new be,ife=new be,nfe=new z,rfe=[];efe.prototype.update=function(e){if(this.show){var t=this._ellipsoidPrimitive;t.material.uniforms.image=this.textureUrl,t.onlySunLighting=this.onlySunLighting;var i=e.time;Object(u.a)(xa.computeIcrfToFixedMatrix(i,tfe))||xa.computeTemeToPseudoFixedMatrix(i,tfe);var n=this._axes.evaluate(i,ife);be.transpose(n,n),be.multiply(tfe,n,n);var r=OP.computeMoonPositionInEarthInertialFrame(i,nfe);be.multiplyByVector(tfe,r,r),Be.fromRotationTranslation(n,r,t.modelMatrix);var a=e.commandList;return e.commandList=rfe,rfe.length=0,t.update(e),e.commandList=a,1===rfe.length?rfe[0]:void 0}},efe.prototype.isDestroyed=function(){return!1},efe.prototype.destroy=function(){return this._ellipsoidPrimitive=this._ellipsoidPrimitive&&this._ellipsoidPrimitive.destroy(),rl(this)};var afe=efe;function ofe(e){}ofe.prototype.isReady=function(){return!0},ofe.prototype.shouldDiscardImage=function(e){return!1};var sfe=ofe,cfe="#ifdef MRT\n#extension GL_EXT_draw_buffers : enable\n#endif\nuniform vec4 u_bgColor;\nuniform sampler2D u_depthTexture;\nvarying vec2 v_textureCoordinates;\nvoid main()\n{\nif (texture2D(u_depthTexture, v_textureCoordinates).r < 1.0)\n{\n#ifdef MRT\ngl_FragData[0] = u_bgColor;\ngl_FragData[1] = vec4(u_bgColor.a);\n#else\ngl_FragColor = u_bgColor;\n#endif\nreturn;\n}\ndiscard;\n}\n",lfe="uniform sampler2D u_opaque;\nuniform sampler2D u_accumulation;\nuniform sampler2D u_revealage;\nvarying vec2 v_textureCoordinates;\nvoid main()\n{\nvec4 opaque = texture2D(u_opaque, v_textureCoordinates);\nvec4 accum = texture2D(u_accumulation, v_textureCoordinates);\nfloat r = texture2D(u_revealage, v_textureCoordinates).r;\n#ifdef MRT\nvec4 transparent = vec4(accum.rgb / clamp(r, 1e-4, 5e4), accum.a);\n#else\nvec4 transparent = vec4(accum.rgb / clamp(accum.a, 1e-4, 5e4), r);\n#endif\ngl_FragColor = (1.0 - transparent.a) * transparent + transparent.a * opaque;\nif (opaque != czm_backgroundColor)\n{\ngl_FragColor.a = 1.0;\n}\n}\n";function ufe(e){this._translucentMultipassSupport=!1,this._translucentMRTSupport=!1;var t=e.colorBufferFloat&&e.depthTexture;this._translucentMRTSupport=e.drawBuffers&&t,this._translucentMultipassSupport=!this._translucentMRTSupport&&t,this._opaqueFBO=void 0,this._opaqueTexture=void 0,this._depthStencilTexture=void 0,this._accumulationTexture=void 0,this._translucentFBO=void 0,this._alphaFBO=void 0,this._adjustTranslucentFBO=void 0,this._adjustAlphaFBO=void 0,this._opaqueClearCommand=new fX({color:new uf(0,0,0,0),owner:this}),this._translucentMRTClearCommand=new fX({color:new uf(0,0,0,1),owner:this}),this._translucentMultipassClearCommand=new fX({color:new uf(0,0,0,0),owner:this}),this._alphaClearCommand=new fX({color:new uf(1,1,1,1),owner:this}),this._translucentRenderStateCache={},this._alphaRenderStateCache={},this._compositeCommand=void 0,this._adjustTranslucentCommand=void 0,this._adjustAlphaCommand=void 0,this._viewport=new ln,this._rs=void 0,this._useScissorTest=!1,this._scissorRectangle=void 0,this._useHDR=!1,this._multisamplingAccumulationRenderbuffer=void 0,this._multisamplingRevealageRenderbuffer=void 0,this._multisamplingDepthStencilRenderbuffer=void 0,this._multisamplingTempAccumulationFBO=void 0,this._multisamplingTempRevealageFBO=void 0}function hfe(e){e._accumulationTexture=e._accumulationTexture&&!e._accumulationTexture.isDestroyed()&&e._accumulationTexture.destroy(),e._revealageTexture=e._revealageTexture&&!e._revealageTexture.isDestroyed()&&e._revealageTexture.destroy(),e._multisamplingAccumulationRenderbuffer=e._multisamplingAccumulationRenderbuffer&&!e._multisamplingAccumulationRenderbuffer.isDestroyed()&&e._multisamplingAccumulationRenderbuffer.destroy(),e._multisamplingRevealageRenderbuffer=e._multisamplingRevealageRenderbuffer&&!e._multisamplingRevealageRenderbuffer.isDestroyed()&&e._multisamplingRevealageRenderbuffer.destroy()}function dfe(e){e._translucentFBO=e._translucentFBO&&!e._translucentFBO.isDestroyed()&&e._translucentFBO.destroy(),e._alphaFBO=e._alphaFBO&&!e._alphaFBO.isDestroyed()&&e._alphaFBO.destroy(),e._adjustTranslucentFBO=e._adjustTranslucentFBO&&!e._adjustTranslucentFBO.isDestroyed()&&e._adjustTranslucentFBO.destroy(),e._adjustAlphaFBO=e._adjustAlphaFBO&&!e._adjustAlphaFBO.isDestroyed()&&e._adjustAlphaFBO.destroy(),e._multisamplingTempAccumulationFBO=e._multisamplingTempAccumulationFBO&&!e._multisamplingTempAccumulationFBO.isDestroyed()&&e._multisamplingTempAccumulationFBO.destroy(),e._multisamplingTempRevealageFBO=e._multisamplingTempRevealageFBO&&!e._multisamplingTempRevealageFBO.isDestroyed()&&e._multisamplingTempRevealageFBO.destroy()}function ffe(e){hfe(e),dfe(e)}ufe.prototype.blitFramebuffer=function(e,t){if(fx.isWebgl2){var i=t.width,n=t.height,r=e._gl;this._translucentFBO._bind(r.READ_FRAMEBUFFER),this._multisamplingTempAccumulationFBO._bind(r.DRAW_FRAMEBUFFER),r.clearBufferfv(r.COLOR,0,[0,0,0,1]),r.readBuffer(r.COLOR_ATTACHMENT0),r.blitFramebuffer(0,0,i,n,0,0,i,n,r.COLOR_BUFFER_BIT,r.NEAREST),this._translucentFBO._bind(r.READ_FRAMEBUFFER),this._multisamplingTempRevealageFBO._bind(r.DRAW_FRAMEBUFFER),r.clearBufferfv(r.COLOR,0,[0,0,0,1]),r.readBuffer(r.COLOR_ATTACHMENT1),r.blitFramebuffer(0,0,i,n,0,0,i,n,r.COLOR_BUFFER_BIT,r.NEAREST)}},ufe.prototype.update=function(e,t,i,n){if(this.isSupported()){var r=i.framebuffer;this._multisamplingDepthStencilRenderbuffer=i._multisamplingDepthStencilRenderbuffer,this._opaqueFBO=r,this._opaqueTexture=r.getColorTexture(0),this._depthStencilTexture=r.depthStencilTexture;var a=this._opaqueTexture.width,o=this._opaqueTexture.height,s=this._accumulationTexture,c=!Object(u.a)(s)||s.width!==a||s.height!==o||n!==this._useHDR;if(c&&function(e,t,i,n){hfe(e),e._accumulationTexture=new hj({context:t,width:i,height:n,pixelFormat:gx.RGBA,pixelDatatype:mx.FLOAT});var r=new Float32Array(i*n*4);e._revealageTexture=new hj({context:t,pixelFormat:gx.RGBA,pixelDatatype:mx.FLOAT,source:{arrayBufferView:r,width:i,height:n},flipY:!1}),fx.isWebgl2&&(e._multisamplingAccumulationRenderbuffer=new are({context:t,width:i,height:n,format:nre.RGBA32F,samples:fx.multipleSamples}),e._multisamplingRevealageRenderbuffer=new are({context:t,width:i,height:n,format:nre.RGBA32F,samples:fx.multipleSamples}))}(this,e,a,o),Object(u.a)(this._translucentFBO)&&!c||function(e,t){dfe(e);var i=un.FRAMEBUFFER_COMPLETE,n=!0;if(e._translucentMRTSupport&&(fx.isWebgl2?(e._translucentFBO=new cj({context:t,colorRenderbuffers:[e._multisamplingAccumulationRenderbuffer,e._multisamplingRevealageRenderbuffer],depthStencilRenderbuffer:e._multisamplingDepthStencilRenderbuffer,destroyAttachments:!1}),e._adjustTranslucentFBO=new cj({context:t,colorRenderbuffers:[e._multisamplingAccumulationRenderbuffer,e._multisamplingRevealageRenderbuffer],destroyAttachments:!1})):(e._translucentFBO=new cj({context:t,colorTextures:[e._accumulationTexture,e._revealageTexture],depthStencilTexture:e._depthStencilTexture,destroyAttachments:!1}),e._adjustTranslucentFBO=new cj({context:t,colorTextures:[e._accumulationTexture,e._revealageTexture],destroyAttachments:!1})),e._translucentFBO.status===i&&e._adjustTranslucentFBO.status===i||(dfe(e),e._translucentMRTSupport=!1),fx.isWebgl2&&(e._multisamplingTempAccumulationFBO=new cj({context:t,colorTextures:[e._accumulationTexture],destroyAttachments:!1}),e._multisamplingTempRevealageFBO=new cj({context:t,colorTextures:[e._revealageTexture],destroyAttachments:!1}))),!e._translucentMRTSupport){e._translucentFBO=new cj({context:t,colorTextures:[e._accumulationTexture],depthStencilTexture:e._depthStencilTexture,destroyAttachments:!1}),e._alphaFBO=new cj({context:t,colorTextures:[e._revealageTexture],depthStencilTexture:e._depthStencilTexture,destroyAttachments:!1}),e._adjustTranslucentFBO=new cj({context:t,colorTextures:[e._accumulationTexture],destroyAttachments:!1}),e._adjustAlphaFBO=new cj({context:t,colorTextures:[e._revealageTexture],destroyAttachments:!1});var r=e._translucentFBO.status===i,a=e._alphaFBO.status===i,o=e._adjustTranslucentFBO.status===i,s=e._adjustAlphaFBO.status===i;r&&a&&o&&s||(ffe(e),e._translucentMultipassSupport=!1,n=!1)}return n}(this,e)){this._useHDR=n;var l,h,d=this;Object(u.a)(this._compositeCommand)||(l=new UN({sources:[lfe]}),this._translucentMRTSupport&&l.defines.push("MRT"),h={u_opaque:function(){return d._opaqueTexture},u_accumulation:function(){return d._accumulationTexture},u_revealage:function(){return d._revealageTexture}},this._compositeCommand=e.createViewportQuadCommand(l,{uniformMap:h,owner:this})),Object(u.a)(this._adjustTranslucentCommand)||(this._translucentMRTSupport?(l=new UN({defines:["MRT"],sources:[cfe]}),h={u_bgColor:function(){return d._translucentMRTClearCommand.color},u_depthTexture:function(){return d._depthStencilTexture}},this._adjustTranslucentCommand=e.createViewportQuadCommand(l,{uniformMap:h,owner:this})):this._translucentMultipassSupport&&(l=new UN({sources:[cfe]}),h={u_bgColor:function(){return d._translucentMultipassClearCommand.color},u_depthTexture:function(){return d._depthStencilTexture}},this._adjustTranslucentCommand=e.createViewportQuadCommand(l,{uniformMap:h,owner:this}),h={u_bgColor:function(){return d._alphaClearCommand.color},u_depthTexture:function(){return d._depthStencilTexture}},this._adjustAlphaCommand=e.createViewportQuadCommand(l,{uniformMap:h,owner:this}))),this._viewport.width=a,this._viewport.height=o;var f=!ln.equals(this._viewport,t.viewport),p=f!==this._useScissorTest;this._useScissorTest=f,ln.equals(this._scissorRectangle,t.viewport)||(this._scissorRectangle=ln.clone(t.viewport,this._scissorRectangle),p=!0),Object(u.a)(this._rs)&&ln.equals(this._viewport,this._rs.viewport)&&!p||(this._rs=RM.fromCache({viewport:this._viewport,scissorTest:{enabled:this._useScissorTest,rectangle:this._scissorRectangle}})),Object(u.a)(this._compositeCommand)&&(this._compositeCommand.renderState=this._rs),this._adjustTranslucentCommand&&(this._adjustTranslucentCommand.renderState=this._rs),Object(u.a)(this._adjustAlphaCommand)&&(this._adjustAlphaCommand.renderState=this._rs)}}};var pfe={enabled:!0,color:new uf(0,0,0,0),equationRgb:MD.ADD,equationAlpha:MD.ADD,functionSourceRgb:LD.ONE,functionDestinationRgb:LD.ONE,functionSourceAlpha:LD.ZERO,functionDestinationAlpha:LD.ONE_MINUS_SOURCE_ALPHA},mfe={enabled:!0,color:new uf(0,0,0,0),equationRgb:MD.ADD,equationAlpha:MD.ADD,functionSourceRgb:LD.ONE,functionDestinationRgb:LD.ONE,functionSourceAlpha:LD.ONE,functionDestinationAlpha:LD.ONE},_fe={enabled:!0,color:new uf(0,0,0,0),equationRgb:MD.ADD,equationAlpha:MD.ADD,functionSourceRgb:LD.ZERO,functionDestinationRgb:LD.ONE_MINUS_SOURCE_ALPHA,functionSourceAlpha:LD.ZERO,functionDestinationAlpha:LD.ONE_MINUS_SOURCE_ALPHA};function gfe(e,t,i,n){var r=i[n.id];if(!Object(u.a)(r)){var a=RM.getState(n);a.depthMask=!1,a.blending=t,r=RM.fromCache(a),i[n.id]=r}return r}var vfe="    vec3 Ci = czm_gl_FragColor.rgb * czm_gl_FragColor.a;\n    float ai = czm_gl_FragColor.a;\n    float wzi = czm_alphaWeight(ai);\n    gl_FragData[0] = vec4(Ci * wzi, ai);\n    gl_FragData[1] = vec4(ai * wzi);\n",bfe="    vec3 Ci = czm_gl_FragColor.rgb * czm_gl_FragColor.a;\n    float ai = czm_gl_FragColor.a;\n    float wzi = czm_alphaWeight(ai);\n    gl_FragColor = vec4(Ci, ai) * wzi;\n",yfe="    float ai = czm_gl_FragColor.a;\n    gl_FragColor = vec4(ai);\n";function wfe(e,t,i,n){var r=e.shaderCache.getDerivedShaderProgram(t,i);if(!Object(u.a)(r)){var a=t._attributeLocations,o=t.fragmentShaderSource.clone();o.sources=o.sources.map((function(e){return e=(e=(e=(e=UN.replaceMain(e,"czm_translucent_main")).replace(/gl_FragColor/g,"czm_gl_FragColor")).replace(/\bdiscard\b/g,"czm_discard = true")).replace(/czm_phong/g,"czm_translucentPhong")})),o.sources.splice(0,0,(-1!==n.indexOf("gl_FragData")?"#extension GL_EXT_draw_buffers : enable \n":"")+"vec4 czm_gl_FragColor;\nbool czm_discard = false;\n"),o.sources.push("void main()\n{\n    czm_translucent_main();\n    if (czm_discard)\n    {\n        discard;\n    }\n"+n+"}\n"),r=e.shaderCache.createDerivedShaderProgram(t,i,{vertexShaderSource:t.vertexShaderSource,fragmentShaderSource:o,attributeLocations:a})}return r}ufe.prototype.createDerivedCommands=function(e,t,i){var n,r,a,o,s,c,l,h;(Object(u.a)(i)||(i={}),this._translucentMRTSupport)?(Object(u.a)(i.translucentCommand)&&(n=i.translucentCommand.shaderProgram,r=i.translucentCommand.renderState),i.translucentCommand=cM.shallowClone(e,i.translucentCommand),Object(u.a)(n)&&i.shaderProgramId===e.shaderProgram.id?(i.translucentCommand.shaderProgram=n,i.translucentCommand.renderState=r):(i.translucentCommand.shaderProgram=function(e,t){return wfe(e,t,"translucentMRT",vfe)}(t,e.shaderProgram),i.translucentCommand.renderState=(l=this,h=e.renderState,gfe(0,pfe,l._translucentRenderStateCache,h)),i.shaderProgramId=e.shaderProgram.id)):(Object(u.a)(i.translucentCommand)&&(a=i.translucentCommand.shaderProgram,o=i.translucentCommand.renderState,s=i.alphaCommand.shaderProgram,c=i.alphaCommand.renderState),i.translucentCommand=cM.shallowClone(e,i.translucentCommand),i.alphaCommand=cM.shallowClone(e,i.alphaCommand),Object(u.a)(a)&&i.shaderProgramId===e.shaderProgram.id?(i.translucentCommand.shaderProgram=a,i.translucentCommand.renderState=o,i.alphaCommand.shaderProgram=s,i.alphaCommand.renderState=c):(i.translucentCommand.shaderProgram=function(e,t){return wfe(e,t,"translucentMultipass",bfe)}(t,e.shaderProgram),i.translucentCommand.renderState=function(e,t,i){return gfe(0,mfe,e._translucentRenderStateCache,i)}(this,0,e.renderState),i.alphaCommand.shaderProgram=function(e,t){return wfe(e,t,"alphaMultipass",yfe)}(t,e.shaderProgram),i.alphaCommand.renderState=function(e,t,i){return gfe(0,_fe,e._alphaRenderStateCache,i)}(this,0,e.renderState),i.shaderProgramId=e.shaderProgram.id));return i},ufe.prototype.executeCommands=function(e,t,i,n,r){this._translucentMRTSupport?function(e,t,i,n,r,a){var o=t.context,s=t.frameState.useLogDepth,c=t._hdr,l=n.framebuffer,h=r.length,d=t.frameState.shadowState.lightShadowsEnabled,f=t.gradualRender;f.needUpdateDrawCommand()&&(n.framebuffer=e._adjustTranslucentFBO,e._adjustTranslucentCommand.execute(o,n));var p,m=e._opaqueFBO;n.framebuffer=e._translucentFBO;for(var _=f.getPassName(lM.TRANSLUCENT),g=f.getDrawCommandStartOffset(_,h);g<h&&!f.needToPause();++g)p=r[g],p=s?p.derivedCommands.logDepth.command:p,p=c?p.derivedCommands.hdr.command:p,i(d&&p.receiveShadows?p.derivedCommands.oit.shadows.translucentCommand:p.derivedCommands.oit.translucentCommand,t,o,n,m);var v=g;v=v>=h?h:v,f.setDrawCommandStep(_,h,v,v),Object(u.a)(a)&&(p=a.unclassifiedCommand,i(d&&p.receiveShadows?p.derivedCommands.oit.shadows.translucentCommand:p.derivedCommands.oit.translucentCommand,t,o,n,m)),n.framebuffer=l}(this,e,t,i,n,r):function(e,t,i,n,r,a){var o,s,c=t.context,l=t.frameState.useLogDepth,h=t._hdr,d=n.framebuffer,f=r.length,p=t.frameState.shadowState.lightShadowsEnabled;n.framebuffer=e._adjustTranslucentFBO,e._adjustTranslucentCommand.execute(c,n),n.framebuffer=e._adjustAlphaFBO,e._adjustAlphaCommand.execute(c,n);var m=e._opaqueFBO;for(n.framebuffer=e._translucentFBO,s=0;s<f;++s)o=r[s],o=l?o.derivedCommands.logDepth.command:o,o=h?o.derivedCommands.hdr.command:o,i(p&&o.receiveShadows?o.derivedCommands.oit.shadows.translucentCommand:o.derivedCommands.oit.translucentCommand,t,c,n,m);for(Object(u.a)(a)&&(o=a.unclassifiedCommand,i(p&&o.receiveShadows?o.derivedCommands.oit.shadows.translucentCommand:o.derivedCommands.oit.translucentCommand,t,c,n,m)),n.framebuffer=e._alphaFBO,s=0;s<f;++s)o=r[s],o=l?o.derivedCommands.logDepth.command:o,o=h?o.derivedCommands.hdr.command:o,i(p&&o.receiveShadows?o.derivedCommands.oit.shadows.alphaCommand:o.derivedCommands.oit.alphaCommand,t,c,n,m);Object(u.a)(a)&&(o=a.unclassifiedCommand,i(p&&o.receiveShadows?o.derivedCommands.oit.shadows.alphaCommand:o.derivedCommands.oit.alphaCommand,t,c,n,m)),n.framebuffer=d}(this,e,t,i,n,r)},ufe.prototype.execute=function(e,t){this._compositeCommand.execute(e,t)},ufe.prototype.clear=function(e,t,i){var n=t.framebuffer;t.framebuffer=this._opaqueFBO,uf.clone(i,this._opaqueClearCommand.color),this._opaqueClearCommand.execute(e,t),t.framebuffer=this._translucentFBO,(this._translucentMRTSupport?this._translucentMRTClearCommand:this._translucentMultipassClearCommand).execute(e,t),this._translucentMultipassSupport&&(t.framebuffer=this._alphaFBO,this._alphaClearCommand.execute(e,t)),t.framebuffer=n},ufe.prototype.isSupported=function(){return this._translucentMRTSupport||this._translucentMultipassSupport},ufe.prototype.isDestroyed=function(){return!1},ufe.prototype.destroy=function(){return ffe(this),Object(u.a)(this._compositeCommand)&&(this._compositeCommand.shaderProgram=this._compositeCommand.shaderProgram&&this._compositeCommand.shaderProgram.destroy()),Object(u.a)(this._adjustTranslucentCommand)&&(this._adjustTranslucentCommand.shaderProgram=this._adjustTranslucentCommand.shaderProgram&&this._adjustTranslucentCommand.shaderProgram.destroy()),Object(u.a)(this._adjustAlphaCommand)&&(this._adjustAlphaCommand.shaderProgram=this._adjustAlphaCommand.shaderProgram&&this._adjustAlphaCommand.shaderProgram.destroy()),rl(this)};var Ofe=ufe,xfe=new Rt(1,1);function Efe(e){e=Object(w.a)(e,w.a.EMPTY_OBJECT),this.mass=Object(w.a)(e.mass,1),this.position=z.clone(Object(w.a)(e.position,z.ZERO)),this.velocity=z.clone(Object(w.a)(e.velocity,z.ZERO)),this.life=Object(w.a)(e.life,Number.MAX_VALUE),this.image=e.image,this.startColor=uf.clone(Object(w.a)(e.startColor,uf.WHITE)),this.endColor=uf.clone(Object(w.a)(e.endColor,uf.WHITE)),this.startScale=Object(w.a)(e.startScale,1),this.endScale=Object(w.a)(e.endScale,1),this.imageSize=Rt.clone(Object(w.a)(e.imageSize,xfe)),this._age=0,this._normalizedAge=0,this._billboard=void 0}Object(O.a)(Efe.prototype,{age:{get:function(){return this._age}},normalizedAge:{get:function(){return this._normalizedAge}}});var Tfe=new z;Efe.prototype.update=function(e,t){return z.multiplyByScalar(this.velocity,e,Tfe),z.add(this.position,Tfe,this.position),Object(u.a)(t)&&t(this,e),this._age+=e,this.life===Number.MAX_VALUE?this._normalizedAge=0:this._normalizedAge=this._age/this.life,this._age<=this.life};var Cfe=Efe;function Sfe(e){e=Object(w.a)(e,w.a.EMPTY_OBJECT),this.time=Object(w.a)(e.time,0),this.minimum=Object(w.a)(e.minimum,0),this.maximum=Object(w.a)(e.maximum,50),this._complete=!1}Object(O.a)(Sfe.prototype,{complete:{get:function(){return this._complete}}});var Afe=Sfe;function Pfe(e){throw new h.a("This type should not be instantiated directly.  Instead, use BoxEmitter, CircleEmitter, ConeEmitter or SphereEmitter.")}Pfe.prototype.emit=function(e){h.a.throwInstantiationError()};var Ife=Pfe,Dfe=new Rt(1,1);function jfe(e){e=Object(w.a)(e,w.a.EMPTY_OBJECT),this.show=Object(w.a)(e.show,!0),this.updateCallback=e.updateCallback,this.loop=Object(w.a)(e.loop,!0),this.image=Object(w.a)(e.image,void 0);var t=e.emitter;Object(u.a)(t)||(t=new Xse(.5)),this._emitter=t,this._bursts=e.bursts,this._modelMatrix=Be.clone(Object(w.a)(e.modelMatrix,Be.IDENTITY)),this._emitterModelMatrix=Be.clone(Object(w.a)(e.emitterModelMatrix,Be.IDENTITY)),this._matrixDirty=!0,this._combinedMatrix=new Be,this._startColor=uf.clone(Object(w.a)(e.color,Object(w.a)(e.startColor,uf.WHITE))),this._endColor=uf.clone(Object(w.a)(e.color,Object(w.a)(e.endColor,uf.WHITE))),this._startScale=Object(w.a)(e.scale,Object(w.a)(e.startScale,1)),this._endScale=Object(w.a)(e.scale,Object(w.a)(e.endScale,1)),this._emissionRate=Object(w.a)(e.emissionRate,5),this._minimumSpeed=Object(w.a)(e.speed,Object(w.a)(e.minimumSpeed,1)),this._maximumSpeed=Object(w.a)(e.speed,Object(w.a)(e.maximumSpeed,1)),this._minimumParticleLife=Object(w.a)(e.particleLife,Object(w.a)(e.minimumParticleLife,5)),this._maximumParticleLife=Object(w.a)(e.particleLife,Object(w.a)(e.maximumParticleLife,5)),this._minimumMass=Object(w.a)(e.mass,Object(w.a)(e.minimumMass,1)),this._maximumMass=Object(w.a)(e.mass,Object(w.a)(e.maximumMass,1)),this._minimumImageSize=Rt.clone(Object(w.a)(e.imageSize,Object(w.a)(e.minimumImageSize,Dfe))),this._maximumImageSize=Rt.clone(Object(w.a)(e.imageSize,Object(w.a)(e.maximumImageSize,Dfe))),this._lifetime=Object(w.a)(e.lifetime,Number.MAX_VALUE),this._sizeInMeters=Object(w.a)(e.sizeInMeters,!1),this._billboardCollection=void 0,this._particles=[],this._particlePool=[],this._previousTime=void 0,this._currentTime=0,this._carryOver=0,this._complete=new $o.a,this._isComplete=!1,this._updateParticlePool=!0,this._particleEstimate=0}function Mfe(e){var t=e._particlePool.pop();return Object(u.a)(t)||(t=new Cfe),t}function Rfe(e,t){e._particlePool.push(t)}function Lfe(e){Object(u.a)(e._billboard)&&(e._billboard.show=!1)}function Nfe(e,t){var i=t._billboard;Object(u.a)(i)||(i=t._billboard=e._billboardCollection.add({image:t.image})),i.width=t.imageSize.x,i.height=t.imageSize.y,i.position=t.position,i.show=!0;var n=I.lerp(t.startColor.red,t.endColor.red,t.normalizedAge),r=I.lerp(t.startColor.green,t.endColor.green,t.normalizedAge),a=I.lerp(t.startColor.blue,t.endColor.blue,t.normalizedAge),o=I.lerp(t.startColor.alpha,t.endColor.alpha,t.normalizedAge);i.color=new uf(n,r,a,o),i.scale=I.lerp(t.startScale,t.endScale,t.normalizedAge)}function Ffe(e,t){t.startColor=uf.clone(e._startColor,t.startColor),t.endColor=uf.clone(e._endColor,t.endColor),t.startScale=e._startScale,t.endScale=e._endScale,t.image=e.image,t.life=I.randomBetween(e._minimumParticleLife,e._maximumParticleLife),t.mass=I.randomBetween(e._minimumMass,e._maximumMass),t.imageSize.x=I.randomBetween(e._minimumImageSize.x,e._maximumImageSize.x),t.imageSize.y=I.randomBetween(e._minimumImageSize.y,e._maximumImageSize.y),t._normalizedAge=0,t._age=0;var i=I.randomBetween(e._minimumSpeed,e._maximumSpeed);z.multiplyByScalar(t.velocity,i,t.velocity),e._particles.push(t)}Object(O.a)(jfe.prototype,{emitter:{get:function(){return this._emitter},set:function(e){x.a.defined("value",e),this._emitter=e}},bursts:{get:function(){return this._bursts},set:function(e){this._bursts=e,this._updateParticlePool=!0}},modelMatrix:{get:function(){return this._modelMatrix},set:function(e){x.a.defined("value",e),this._matrixDirty=this._matrixDirty||!Be.equals(this._modelMatrix,e),Be.clone(e,this._modelMatrix)}},emitterModelMatrix:{get:function(){return this._emitterModelMatrix},set:function(e){x.a.defined("value",e),this._matrixDirty=this._matrixDirty||!Be.equals(this._emitterModelMatrix,e),Be.clone(e,this._emitterModelMatrix)}},startColor:{get:function(){return this._startColor},set:function(e){x.a.defined("value",e),uf.clone(e,this._startColor)}},endColor:{get:function(){return this._endColor},set:function(e){x.a.defined("value",e),uf.clone(e,this._endColor)}},startScale:{get:function(){return this._startScale},set:function(e){x.a.typeOf.number.greaterThanOrEquals("value",e,0),this._startScale=e}},endScale:{get:function(){return this._endScale},set:function(e){x.a.typeOf.number.greaterThanOrEquals("value",e,0),this._endScale=e}},emissionRate:{get:function(){return this._emissionRate},set:function(e){x.a.typeOf.number.greaterThanOrEquals("value",e,0),this._emissionRate=e,this._updateParticlePool=!0}},minimumSpeed:{get:function(){return this._minimumSpeed},set:function(e){x.a.typeOf.number.greaterThanOrEquals("value",e,0),this._minimumSpeed=e}},maximumSpeed:{get:function(){return this._maximumSpeed},set:function(e){x.a.typeOf.number.greaterThanOrEquals("value",e,0),this._maximumSpeed=e}},minimumParticleLife:{get:function(){return this._minimumParticleLife},set:function(e){x.a.typeOf.number.greaterThanOrEquals("value",e,0),this._minimumParticleLife=e}},maximumParticleLife:{get:function(){return this._maximumParticleLife},set:function(e){x.a.typeOf.number.greaterThanOrEquals("value",e,0),this._maximumParticleLife=e,this._updateParticlePool=!0}},minimumMass:{get:function(){return this._minimumMass},set:function(e){x.a.typeOf.number.greaterThanOrEquals("value",e,0),this._minimumMass=e}},maximumMass:{get:function(){return this._maximumMass},set:function(e){x.a.typeOf.number.greaterThanOrEquals("value",e,0),this._maximumMass=e}},minimumImageSize:{get:function(){return this._minimumImageSize},set:function(e){x.a.typeOf.object("value",e),x.a.typeOf.number.greaterThanOrEquals("value.x",e.x,0),x.a.typeOf.number.greaterThanOrEquals("value.y",e.y,0),this._minimumImageSize=e}},maximumImageSize:{get:function(){return this._maximumImageSize},set:function(e){x.a.typeOf.object("value",e),x.a.typeOf.number.greaterThanOrEquals("value.x",e.x,0),x.a.typeOf.number.greaterThanOrEquals("value.y",e.y,0),this._maximumImageSize=e}},lifetime:{get:function(){return this._lifetime},set:function(e){x.a.typeOf.number.greaterThanOrEquals("value",e,0),this._lifetime=e}},complete:{get:function(){return this._complete}},isComplete:{get:function(){return this._isComplete}}});var kfe=new z;jfe.prototype.update=function(e){if(this.show){Object(u.a)(this._billboardCollection)||(this._billboardCollection=new nG),this._updateParticlePool&&(!function(e){var t=e._emissionRate,i=e._maximumParticleLife,n=0,r=e._bursts;if(Object(u.a)(r))for(var a=r.length,o=0;o<a;++o)n+=r[o].maximum;for(var s=e._billboardCollection,c=e.image,l=Math.ceil(t*i+n),h=e._particles,d=e._particlePool,f=Math.max(l-h.length-d.length,0),p=0;p<f;++p){var m=new Cfe;m._billboard=s.add({image:c,sizeInMeters:e._sizeInMeters}),d.push(m)}e._particleEstimate=l}(this),this._updateParticlePool=!1);var t=0;this._previousTime&&(t=Tr.secondsDifference(e.time,this._previousTime)),t<0&&(t=0);var i,n,r=this._particles,a=this._emitter,o=this.updateCallback,s=r.length;for(i=0;i<s;++i)(n=r[i]).update(t,o)?Nfe(this,n):(Lfe(n),Rfe(this,n),r[i]=r[s-1],--i,--s);r.length=s;var c=function(e,t){if(e._isComplete)return 0;var i=(t=I.mod(t,e._lifetime))*e._emissionRate,n=Math.floor(i);if(e._carryOver+=i-n,e._carryOver>1&&(n++,e._carryOver-=1),Object(u.a)(e.bursts))for(var r=e.bursts.length,a=0;a<r;a++){var o=e.bursts[a],s=e._currentTime;Object(u.a)(o)&&!o._complete&&s>o.time&&(n+=I.randomBetween(o.minimum,o.maximum),o._complete=!0)}return n}(this,t);if(c>0&&Object(u.a)(a)){this._matrixDirty&&(this._combinedMatrix=Be.multiply(this.modelMatrix,this.emitterModelMatrix,this._combinedMatrix),this._matrixDirty=!1);var l=this._combinedMatrix;for(i=0;i<c;i++)n=Mfe(this),this._emitter.emit(n),z.add(n.position,n.velocity,kfe),Be.multiplyByPoint(l,kfe,kfe),n.position=Be.multiplyByPoint(l,n.position,n.position),z.subtract(kfe,n.position,n.velocity),z.normalize(n.velocity,n.velocity),Ffe(this,n),Nfe(this,n)}if(this._billboardCollection.update(e),this._previousTime=Tr.clone(e.time,this._previousTime),this._currentTime+=t,this._lifetime!==Number.MAX_VALUE&&this._currentTime>this._lifetime)if(this.loop){if(this._currentTime=I.mod(this._currentTime,this._lifetime),this.bursts){var h=this.bursts.length;for(i=0;i<h;i++)this.bursts[i]._complete=!1}}else this._isComplete=!0,this._complete.raiseEvent(this);e.frameNumber%120==0&&function(e){for(var t=e._particles,i=e._particlePool,n=e._billboardCollection,r=t.length,a=i.length,o=e._particleEstimate,s=a-Math.max(o-r-a,0),c=s;c<a;++c){var l=i[c];n.remove(l._billboard)}i.length=s}(this)}},jfe.prototype.isDestroyed=function(){return!1},jfe.prototype.destroy=function(){return this._billboardCollection=this._billboardCollection&&this._billboardCollection.destroy(),rl(this)};var Bfe=jfe;var zfe=function(e){if("string"==typeof e){var t=document.getElementById(e);if(null===t)throw new h.a('Element with id "'+e+'" does not exist in the document.');e=t}return e};function Ufe(e){e=Object(w.a)(e,w.a.EMPTY_OBJECT);var t=zfe(e.container);if(!Object(u.a)(t))throw new h.a("container is required");this._container=t;var i=document.createElement("div");i.className="cesium-performanceDisplay";var n=document.createElement("div");n.className="cesium-performanceDisplay-fps",this._fpsText=document.createTextNode(""),n.appendChild(this._fpsText);var r=document.createElement("div");r.className="cesium-performanceDisplay-ms",this._msText=document.createTextNode(""),r.appendChild(this._msText),i.appendChild(r),i.appendChild(n),this._container.appendChild(i),this._lastFpsSampleTime=Qd(),this._lastMsSampleTime=Qd(),this._fpsFrameCount=0,this._msFrameCount=0,this._throttled=!1;var a=document.createElement("div");a.className="cesium-performanceDisplay-throttled",this._throttledText=document.createTextNode(""),a.appendChild(this._throttledText),i.appendChild(a)}Object(O.a)(Ufe.prototype,{throttled:{get:function(){return this._throttled},set:function(e){this._throttled!==e&&(this._throttledText.nodeValue=e?"(throttled)":"",this._throttled=e)}}}),Ufe.prototype.update=function(e){var t=Qd(),i=Object(w.a)(e,!0);this._fpsFrameCount++;var n=t-this._lastFpsSampleTime;if(n>1e3){var r="N/A";i&&(r=1e3*this._fpsFrameCount/n|0),this._fpsText.nodeValue=r+" FPS",this._lastFpsSampleTime=t,this._fpsFrameCount=0}this._msFrameCount++;var a=t-this._lastMsSampleTime;if(a>200){var o="N/A";i&&(o=(a/this._msFrameCount).toFixed(2)),this._msText.nodeValue=o+" MS",this._lastMsSampleTime=t,this._msFrameCount=0}},Ufe.prototype.destroy=function(){return rl(this)};var Vfe=Ufe;function Hfe(){this._framebuffer=void 0,this._depthTexture=void 0,this._textureToCopy=void 0,this._copyDepthCommand=void 0,this._useLogDepth=void 0,this._debugPickDepthViewportCommand=void 0}function Gfe(e){e._depthTexture=e._depthTexture&&!e._depthTexture.isDestroyed()&&e._depthTexture.destroy()}function qfe(e){e._framebuffer=e._framebuffer&&!e._framebuffer.isDestroyed()&&e._framebuffer.destroy()}function Wfe(e,t,i,n){Gfe(e),qfe(e),function(e,t,i,n){e._depthTexture=new hj({context:t,width:i,height:n,pixelFormat:gx.RGBA,pixelDatatype:mx.UNSIGNED_BYTE})}(e,t,i,n),e._framebuffer=new cj({context:t,colorTextures:[e._depthTexture],destroyAttachments:!1})}Hfe.prototype.executeDebugPickDepth=function(e,t,i){!function(e,t,i,n){if(!Object(u.a)(e._debugPickDepthViewportCommand)||n!==e._useLogDepth){var r=new UN({defines:[n?"LOG_DEPTH":""],sources:["uniform sampler2D u_texture;\nvarying vec2 v_textureCoordinates;\nvoid main()\n{\n    float z_window = czm_unpackDepth(texture2D(u_texture, v_textureCoordinates));\n    z_window = czm_reverseLogDepth(z_window); \n    float n_range = czm_depthRange.near;\n    float f_range = czm_depthRange.far;\n    float z_ndc = (2.0 * z_window - n_range - f_range) / (f_range - n_range);\n    float scale = pow(z_ndc * 0.5 + 0.5, 8.0);\n    gl_FragColor = vec4(mix(vec3(0.0), vec3(1.0), scale), 1.0);\n}\n"]});e._debugPickDepthViewportCommand=t.createViewportQuadCommand(r,{uniformMap:{u_texture:function(){return e._depthTexture}},owner:e}),e._useLogDepth=n}e._debugPickDepthViewportCommand.execute(t,i)}(this,e,t,i)},Hfe.prototype.update=function(e,t){!function(e,t,i){var n=i.width,r=i.height,a=e._depthTexture,o=!Object(u.a)(a)||a.width!==n||a.height!==r;Object(u.a)(e._framebuffer)&&!o||Wfe(e,t,n,r)}(this,e,t),function(e,t,i){if(!Object(u.a)(e._copyDepthCommand)){e._copyDepthCommand=t.createViewportQuadCommand("uniform sampler2D u_texture;\nvarying vec2 v_textureCoordinates;\nvoid main()\n{\n    gl_FragColor = czm_packDepth(texture2D(u_texture, v_textureCoordinates).r);\n}\n",{renderState:RM.fromCache(),uniformMap:{u_texture:function(){return e._textureToCopy}},owner:e})}e._textureToCopy=i,e._copyDepthCommand.framebuffer=e._framebuffer}(this,e,t)};var Yfe=new Te,Xfe=new Te(1,1/255,1/65025,1/16581375);Hfe.prototype.getDepth=function(e,t,i){var n=e.readPixels({x:t,y:i,width:1,height:1,framebuffer:this._framebuffer}),r=Te.unpack(n,0,Yfe);return Te.divideByScalar(r,255,r),Te.dot(r,Xfe)},Hfe.prototype.executeCopyDepth=function(e,t){this._copyDepthCommand.execute(e,t)},Hfe.prototype.isDestroyed=function(){return!1},Hfe.prototype.destroy=function(){return Gfe(this),qfe(this),this._copyDepthCommand.shaderProgram=Object(u.a)(this._copyDepthCommand.shaderProgram)&&this._copyDepthCommand.shaderProgram.destroy(),rl(this)};var Zfe=Hfe;function Qfe(){this._depthStencilTexture=void 0,this._framebuffer=void 0,this._passState=void 0}function Kfe(e){e._framebuffer=e._framebuffer&&e._framebuffer.destroy(),e._depthStencilTexture=e._depthStencilTexture&&e._depthStencilTexture.destroy()}Qfe.prototype.update=function(e,t,i){var n=i.width,r=i.height;Object(u.a)(this._framebuffer)&&n===this._depthStencilTexture.width&&r===this._depthStencilTexture.height||(Kfe(this),function(e,t){var i=t.drawingBufferWidth,n=t.drawingBufferHeight;e._depthStencilTexture=new hj({context:t,width:i,height:n,pixelFormat:gx.DEPTH_STENCIL,pixelDatatype:mx.UNSIGNED_INT_24_8}),e._framebuffer=new cj({context:t,depthStencilTexture:e._depthStencilTexture,destroyAttachments:!1});var r=new bne(t);r.blendingEnabled=!1,r.scissorTest={enabled:!0,rectangle:new ln},r.viewport=new ln,e._passState=r}(this,e));var a=this._framebuffer,o=this._passState;return o.framebuffer=a,o.viewport.width=n,o.viewport.height=r,o.scissorTest.rectangle.x=t.x,o.scissorTest.rectangle.y=r-t.y,o.scissorTest.rectangle.width=1,o.scissorTest.rectangle.height=1,o},Qfe.prototype.isDestroyed=function(){return!1},Qfe.prototype.destroy=function(){return Kfe(this),rl(this)};var Jfe=Qfe;function $fe(e){var t=new bne(e);t.blendingEnabled=!1,t.scissorTest={enabled:!0,rectangle:new ln},t.viewport=new ln,this._context=e,this._fb=void 0,this._passState=t,this._width=0,this._height=0}$fe.prototype.begin=function(e,t){var i=this._context,n=t.width,r=t.height;return ln.clone(e,this._passState.scissorTest.rectangle),Object(u.a)(this._fb)&&this._width===n&&this._height===r||(this._width=n,this._height=r,this._fb=this._fb&&this._fb.destroy(),this._fb=new cj({context:i,colorTextures:[new hj({context:i,width:n,height:r})],depthStencilRenderbuffer:new are({context:i,width:n,height:r,format:nre.DEPTH_STENCIL})}),this._passState.framebuffer=this._fb),this._passState.viewport.width=n,this._passState.viewport.height=r,this._passState};var epe=new uf;$fe.prototype.end=function(e){for(var t=Object(w.a)(e.width,1),i=Object(w.a)(e.height,1),n=this._context,r=n.readPixels({x:e.x,y:e.y,width:t,height:i,framebuffer:this._fb}),a=Math.max(t,i),o=a*a,s=Math.floor(.5*t),c=Math.floor(.5*i),l=0,h=0,d=0,f=-1,p=0;p<o;++p){if(-s<=l&&l<=s&&-c<=h&&h<=c){var m=4*((c-h)*t+l+s);epe.red=uf.byteToFloat(r[m]),epe.green=uf.byteToFloat(r[m+1]),epe.blue=uf.byteToFloat(r[m+2]),epe.alpha=uf.byteToFloat(r[m+3]);var _=n.getObjectByPickColor(epe);if(Object(u.a)(_))return _}if(l===h||l<0&&-l===h||l>0&&l===1-h){var g=d;d=-f,f=g}l+=d,h+=f}},$fe.prototype.isDestroyed=function(){return!1},$fe.prototype.destroy=function(){return this._fb=this._fb&&this._fb.destroy(),rl(this)};var tpe=$fe,ipe={NEAREST:0,LINEAR:1};function npe(e){var t=(e=Object(w.a)(e,w.a.EMPTY_OBJECT)).fragmentShader,i=Object(w.a)(e.textureScale,1),n=Object(w.a)(e.pixelFormat,gx.RGBA);if(x.a.typeOf.string("options.fragmentShader",t),x.a.typeOf.number.greaterThan("options.textureScale",i,0),x.a.typeOf.number.lessThanOrEquals("options.textureScale",i,1),!gx.isColorFormat(n))throw new h.a("options.pixelFormat must be a color format.");this._fragmentShader=t,this._uniforms=e.uniforms,this._textureScale=i,this._forcePowerOfTwo=Object(w.a)(e.forcePowerOfTwo,!1),this._sampleMode=Object(w.a)(e.sampleMode,ipe.NEAREST),this._pixelFormat=n,this._pixelDatatype=Object(w.a)(e.pixelDatatype,mx.UNSIGNED_BYTE),this._clearColor=Object(w.a)(e.clearColor,uf.BLACK),this._uniformMap=void 0,this._command=void 0,this._colorTexture=void 0,this._depthTexture=void 0,this._idTexture=void 0,this._actualUniforms={},this._dirtyUniforms=[],this._texturesToRelease=[],this._texturesToCreate=[],this._texturePromise=void 0;var r=new bne;r.scissorTest={enabled:!0,rectangle:Object(u.a)(e.scissorRectangle)?ln.clone(e.scissorRectangle):new ln},this._passState=r,this._ready=!1;var a=e.name;Object(u.a)(a)||(a=Mg()),this._name=a,this._logDepthChanged=void 0,this._useLogDepth=void 0,this._selectedIdTexture=void 0,this._selected=void 0,this._selectedShadow=void 0,this._parentSelected=void 0,this._parentSelectedShadow=void 0,this._combinedSelected=void 0,this._combinedSelectedShadow=void 0,this._selectedLength=0,this._parentSelectedLength=0,this._selectedDirty=!0,this._textureCache=void 0,this._index=void 0,this.enabled=!0,this._enabled=!0}Object(O.a)(npe.prototype,{ready:{get:function(){return this._ready}},name:{get:function(){return this._name}},fragmentShader:{get:function(){return this._fragmentShader}},uniforms:{get:function(){return this._uniforms}},textureScale:{get:function(){return this._textureScale}},forcePowerOfTwo:{get:function(){return this._forcePowerOfTwo}},sampleMode:{get:function(){return this._sampleMode}},pixelFormat:{get:function(){return this._pixelFormat}},pixelDatatype:{get:function(){return this._pixelDatatype}},clearColor:{get:function(){return this._clearColor}},scissorRectangle:{get:function(){return this._passState.scissorTest.rectangle}},outputTexture:{get:function(){if(Object(u.a)(this._textureCache)){var e=this._textureCache.getFramebuffer(this._name);if(Object(u.a)(e))return e.getColorTexture(0)}}},selected:{get:function(){return this._selected},set:function(e){this._selected=e}},parentSelected:{get:function(){return this._parentSelected},set:function(e){this._parentSelected=e}}});var rpe=/uniform\s+sampler2D\s+depthTexture/g;function ape(e,t,i){var n=t[i];return("string"==typeof n||n instanceof HTMLCanvasElement||n instanceof HTMLImageElement||n instanceof HTMLVideoElement||n instanceof ImageData)&&e._dirtyUniforms.push(i),{get:function(){return t[i]},set:function(n){var r=t[i];t[i]=n;var a=e._actualUniforms,o=a[i];Object(u.a)(o)&&o!==r&&o instanceof hj&&!Object(u.a)(e._textureCache.getStageByName(i))&&(e._texturesToRelease.push(o),delete a[i],delete a[i+"Dimensions"]),r instanceof hj&&e._texturesToRelease.push(r),"string"==typeof n||n instanceof HTMLCanvasElement||n instanceof HTMLImageElement||n instanceof HTMLVideoElement||n instanceof ImageData?e._dirtyUniforms.push(i):a[i]=n}}}function ope(e,t){return function(){var i=e._actualUniforms[t];return"function"==typeof i?i():i}}function spe(e,t){return function(){var i=e[t]();if(Object(u.a)(i))return i.dimensions}}function cpe(e,t){return function(i){e._texturesToCreate.push({name:t,source:i})}}function lpe(e,t){return function(){return e._textureCache.getOutputTexture(t)}}function upe(e){Object(u.a)(e._command)&&(e._command.shaderProgram=e._command.shaderProgram&&e._command.shaderProgram.destroy(),e._command=void 0),e._selectedIdTexture=e._selectedIdTexture&&e._selectedIdTexture.destroy();var t=e._textureCache;if(Object(u.a)(t)){var i=e._uniforms,n=e._actualUniforms;for(var r in n)n.hasOwnProperty(r)&&n[r]instanceof hj&&(Object(u.a)(t.getStageByName(i[r]))||n[r].destroy(),e._dirtyUniforms.push(r))}}npe.prototype._isSupported=function(e){return!rpe.test(this._fragmentShader)||e.depthTexture},npe.prototype.update=function(e,t){if(this.enabled===this._enabled||this.enabled||upe(this),this._enabled=this.enabled,this._enabled&&(this._logDepthChanged=t!==this._useLogDepth,this._useLogDepth=t,this._selectedDirty=function(e){var t=Object(u.a)(e._selected)?e._selected.length:0,i=Object(u.a)(e._parentSelected)?e._parentSelected:0,n=e._selected!==e._selectedShadow||t!==e._selectedLength;if(n=n||e._parentSelected!==e._parentSelectedShadow||i!==e._parentSelectedLength,Object(u.a)(e._selected)&&Object(u.a)(e._parentSelected)?e._combinedSelected=e._selected.concat(e._parentSelected):Object(u.a)(e._parentSelected)?e._combinedSelected=e._parentSelected:e._combinedSelected=e._selected,!n&&Object(u.a)(e._combinedSelected)){if(!Object(u.a)(e._combinedSelectedShadow))return!0;t=e._combinedSelected.length;for(var r=0;r<t;++r)if(e._combinedSelected[r]!==e._combinedSelectedShadow[r])return!0}return n}(this),this._selectedShadow=this._selected,this._parentSelectedShadow=this._parentSelected,this._combinedSelectedShadow=this._combinedSelected,this._selectedLength=Object(u.a)(this._selected)?this._selected.length:0,this._parentSelectedLength=Object(u.a)(this._parentSelected)?this._parentSelected.length:0,function(e,t){if(e._selectedDirty){e._selectedIdTexture=e._selectedIdTexture&&e._selectedIdTexture.destroy(),e._selectedIdTexture=void 0;var i=e._combinedSelected;if(Object(u.a)(i)){var n,r,a,o=0,s=i.length;for(n=0;n<s;++n)r=i[n],Object(u.a)(r.pickIds)?o+=r.pickIds.length:Object(u.a)(r.pickId)&&++o;if(0===s||0===o){var c=new Uint8Array(4);return c[0]=255,c[1]=255,c[2]=255,c[3]=255,void(e._selectedIdTexture=new hj({context:t,pixelFormat:gx.RGBA,pixelDatatype:mx.UNSIGNED_BYTE,source:{arrayBufferView:c,width:1,height:1},sampler:new tj({wrapS:$D.CLAMP_TO_EDGE,wrapT:$D.CLAMP_TO_EDGE,minificationFilter:KD.NEAREST,magnificationFilter:ZD.NEAREST})}))}var l=0,h=new Uint8Array(4*o);for(n=0;n<s;++n)if(r=i[n],Object(u.a)(r.pickIds))for(var d=r.pickIds,f=d.length,p=0;p<f;++p)a=d[p].color,h[l]=uf.floatToByte(a.red),h[l+1]=uf.floatToByte(a.green),h[l+2]=uf.floatToByte(a.blue),h[l+3]=uf.floatToByte(a.alpha),l+=4;else Object(u.a)(r.pickId)&&(a=r.pickId.color,h[l]=uf.floatToByte(a.red),h[l+1]=uf.floatToByte(a.green),h[l+2]=uf.floatToByte(a.blue),h[l+3]=uf.floatToByte(a.alpha),l+=4);e._selectedIdTexture=new hj({context:t,pixelFormat:gx.RGBA,pixelDatatype:mx.UNSIGNED_BYTE,source:{arrayBufferView:h,width:o,height:1},sampler:new tj({wrapS:$D.CLAMP_TO_EDGE,wrapT:$D.CLAMP_TO_EDGE,minificationFilter:KD.NEAREST,magnificationFilter:ZD.NEAREST})})}}}(this,e),function(e){if(!Object(u.a)(e._uniformMap)){var t={},i={},n=e._uniforms,r=e._actualUniforms;for(var a in n)if(n.hasOwnProperty(a)){"function"!=typeof n[a]?(t[a]=ope(e,a),i[a]=ape(e,n,a)):(t[a]=n[a],i[a]=n[a]),r[a]=n[a];var o=t[a]();("string"==typeof o||o instanceof hj||o instanceof HTMLImageElement||o instanceof HTMLCanvasElement||o instanceof HTMLVideoElement)&&(t[a+"Dimensions"]=spe(t,a))}e._uniforms={},Object(O.a)(e._uniforms,i),e._uniformMap=Object(ff.a)(t,{colorTexture:function(){return e._colorTexture},colorTextureDimensions:function(){return e._colorTexture.dimensions},depthTexture:function(){return e._depthTexture},depthTextureDimensions:function(){return e._depthTexture.dimensions},czm_idTexture:function(){return e._idTexture},czm_selectedIdTexture:function(){return e._selectedIdTexture},czm_selectedIdTextureStep:function(){return 1/e._selectedIdTexture.width}})}}(this),function(e,t){var i,n,r,a=e._texturesToRelease,o=a.length;for(i=0;i<o;++i)n=(n=a[i])&&n.destroy();a.length=0;var s=e._texturesToCreate;for(o=s.length,i=0;i<o;++i){var c=s[i];r=c.name;var l=c.source;e._actualUniforms[r]=new hj({context:t,source:l})}s.length=0;var h=e._dirtyUniforms;if(0!==h.length||Object(u.a)(e._texturePromise)){if(0!==h.length&&!Object(u.a)(e._texturePromise)){o=h.length;var d=e._uniforms,p=[];for(i=0;i<o;++i){var m=d[r=h[i]],_=e._textureCache.getStageByName(m);if(Object(u.a)(_))e._actualUniforms[r]=lpe(e,m);else if("string"==typeof m){var g=new f.a({url:m});p.push(g.fetchImage().then(cpe(e,r)))}else e._texturesToCreate.push({name:r,source:m})}h.length=0,p.length>0?(e._ready=!1,e._texturePromise=Oi.a.all(p).then((function(){e._ready=!0,e._texturePromise=void 0}))):e._ready=!0}}else e._ready=!0}(this,e),function(e,t){if(!Object(u.a)(e._command)||e._logDepthChanged||e._selectedDirty){var i=e._fragmentShader;if(Object(u.a)(e._selectedIdTexture))i="#define CZM_SELECTED_FEATURE \nuniform sampler2D czm_idTexture; \nuniform sampler2D czm_selectedIdTexture; \nuniform float czm_selectedIdTextureStep; \nvarying vec2 v_textureCoordinates; \nbool czm_selected(vec2 offset) \n{ \n    bool selected = false;\n    vec4 id = texture2D(czm_idTexture, v_textureCoordinates + offset); \n    for (int i = 0; i < "+e._selectedIdTexture.width+"; ++i) \n    { \n        vec4 selectedId = texture2D(czm_selectedIdTexture, vec2(float(i) * czm_selectedIdTextureStep, 0.5)); \n        if (all(equal(id, selectedId))) \n        { \n            return true; \n        } \n    } \n    return false; \n} \n\nbool czm_selected() \n{ \n    return czm_selected(vec2(0.0)); \n} \n\n"+(i=i.replace(/varying\s+vec2\s+v_textureCoordinates;/g,""));var n=new UN({defines:[e._useLogDepth?"LOG_DEPTH":""],sources:[i]});e._command=t.createViewportQuadCommand(n,{uniformMap:e._uniformMap,owner:e})}}(this,e),function(e){var t,i;e._sampleMode===ipe.LINEAR?(t=KD.LINEAR,i=ZD.LINEAR):(t=KD.NEAREST,i=ZD.NEAREST);var n=e._sampler;Object(u.a)(n)&&n.minificationFilter===t&&n.magnificationFilter===i||(e._sampler=new tj({wrapS:$D.CLAMP_TO_EDGE,wrapT:$D.CLAMP_TO_EDGE,minificationFilter:t,magnificationFilter:i}))}(this),this._selectedDirty=!1,this._ready)){var i=this._textureCache.getFramebuffer(this._name);if(this._command.framebuffer=i,Object(u.a)(i)){var n,r=i.getColorTexture(0);r.width===e.drawingBufferWidth&&r.height===e.drawingBufferHeight||(n=this._renderState,Object(u.a)(n)&&r.width===n.viewport.width&&r.height===n.viewport.height||(this._renderState=RM.fromCache({viewport:new ln(0,0,r.width,r.height)}))),this._command.renderState=n}}},npe.prototype.execute=function(e,t,i,n){if(Object(u.a)(this._command)&&Object(u.a)(this._command.framebuffer)&&this._ready&&this._enabled){this._colorTexture=t,this._depthTexture=i,this._idTexture=n,tj.equals(this._colorTexture.sampler,this._sampler)||(this._colorTexture.sampler=this._sampler);var r=this.scissorRectangle.width>0&&this.scissorRectangle.height>0?this._passState:void 0;Object(u.a)(r)&&(r.context=e),this._command.execute(e,r)}},npe.prototype.isDestroyed=function(){return!1},npe.prototype.destroy=function(){return upe(this),rl(this)};var hpe=npe,dpe="uniform sampler2D colorTexture;\nvarying vec2 v_textureCoordinates;\n#ifdef AUTO_EXPOSURE\nuniform sampler2D autoExposure;\n#endif\nvoid main()\n{\nvec4 fragmentColor = texture2D(colorTexture, v_textureCoordinates);\nvec3 color = fragmentColor.rgb;\n#ifdef AUTO_EXPOSURE\ncolor /= texture2D(autoExposure, vec2(0.5)).r;\n#endif\nfloat g = 0.985;\nfloat a = 0.065;\nfloat b = 0.0001;\nfloat c = 0.433;\nfloat d = 0.238;\ncolor = (color * (color + a) - b) / (color * (g * color + c) + d);\ncolor = clamp(color, 0.0, 1.0);\ncolor = czm_inverseGamma(color);\ngl_FragColor = vec4(color, fragmentColor.a);\n}\n",fpe="uniform sampler2D randomTexture;\nuniform sampler2D depthTexture;\nuniform float intensity;\nuniform float bias;\nuniform float lengthCap;\nuniform float stepSize;\nuniform float frustumLength;\nvarying vec2 v_textureCoordinates;\nvec4 clipToEye(vec2 uv, float depth)\n{\nvec2 xy = vec2((uv.x * 2.0 - 1.0), ((1.0 - uv.y) * 2.0 - 1.0));\nvec4 posEC = czm_inverseProjection * vec4(xy, depth, 1.0);\nposEC = posEC / posEC.w;\nreturn posEC;\n}\nvec3 getNormalXEdge(vec3 posInCamera, float depthU, float depthD, float depthL, float depthR, vec2 pixelSize)\n{\nvec4 posInCameraUp = clipToEye(v_textureCoordinates - vec2(0.0, pixelSize.y), depthU);\nvec4 posInCameraDown = clipToEye(v_textureCoordinates + vec2(0.0, pixelSize.y), depthD);\nvec4 posInCameraLeft = clipToEye(v_textureCoordinates - vec2(pixelSize.x, 0.0), depthL);\nvec4 posInCameraRight = clipToEye(v_textureCoordinates + vec2(pixelSize.x, 0.0), depthR);\nvec3 up = posInCamera.xyz - posInCameraUp.xyz;\nvec3 down = posInCameraDown.xyz - posInCamera.xyz;\nvec3 left = posInCamera.xyz - posInCameraLeft.xyz;\nvec3 right = posInCameraRight.xyz - posInCamera.xyz;\nvec3 DX = length(left) < length(right) ? left : right;\nvec3 DY = length(up) < length(down) ? up : down;\nreturn normalize(cross(DY, DX));\n}\nvoid main(void)\n{\nfloat depth = czm_readDepth(depthTexture, v_textureCoordinates);\nvec4 posInCamera = clipToEye(v_textureCoordinates, depth);\nif (posInCamera.z > frustumLength)\n{\ngl_FragColor = vec4(1.0);\nreturn;\n}\nvec2 pixelSize = 1.0 / czm_viewport.zw;\nfloat depthU = czm_readDepth(depthTexture, v_textureCoordinates- vec2(0.0, pixelSize.y));\nfloat depthD = czm_readDepth(depthTexture, v_textureCoordinates+ vec2(0.0, pixelSize.y));\nfloat depthL = czm_readDepth(depthTexture, v_textureCoordinates- vec2(pixelSize.x, 0.0));\nfloat depthR = czm_readDepth(depthTexture, v_textureCoordinates+ vec2(pixelSize.x, 0.0));\nvec3 normalInCamera = getNormalXEdge(posInCamera.xyz, depthU, depthD, depthL, depthR, pixelSize);\nfloat ao = 0.0;\nvec2 sampleDirection = vec2(1.0, 0.0);\nfloat gapAngle = 90.0 * czm_radiansPerDegree;\nfloat randomVal = texture2D(randomTexture, v_textureCoordinates).x;\nfloat inverseViewportWidth = 1.0 / czm_viewport.z;\nfloat inverseViewportHeight = 1.0 / czm_viewport.w;\nfor (int i = 0; i < 4; i++)\n{\nfloat newGapAngle = gapAngle * (float(i) + randomVal);\nfloat cosVal = cos(newGapAngle);\nfloat sinVal = sin(newGapAngle);\nvec2 rotatedSampleDirection = vec2(cosVal * sampleDirection.x - sinVal * sampleDirection.y, sinVal * sampleDirection.x + cosVal * sampleDirection.y);\nfloat localAO = 0.0;\nfloat localStepSize = stepSize;\nfor (int j = 0; j < 6; j++)\n{\nvec2 directionWithStep = vec2(rotatedSampleDirection.x * localStepSize * inverseViewportWidth, rotatedSampleDirection.y * localStepSize * inverseViewportHeight);\nvec2 newCoords = directionWithStep + v_textureCoordinates;\nif(newCoords.x > 1.0 || newCoords.y > 1.0 || newCoords.x < 0.0 || newCoords.y < 0.0)\n{\nbreak;\n}\nfloat stepDepthInfo = czm_readDepth(depthTexture, newCoords);\nvec4 stepPosInCamera = clipToEye(newCoords, stepDepthInfo);\nvec3 diffVec = stepPosInCamera.xyz - posInCamera.xyz;\nfloat len = length(diffVec);\nif (len > lengthCap)\n{\nbreak;\n}\nfloat dotVal = clamp(dot(normalInCamera, normalize(diffVec)), 0.0, 1.0 );\nfloat weight = len / lengthCap;\nweight = 1.0 - weight * weight;\nif (dotVal < bias)\n{\ndotVal = 0.0;\n}\nlocalAO = max(localAO, dotVal * weight);\nlocalStepSize += stepSize;\n}\nao += localAO;\n}\nao /= 4.0;\nao = 1.0 - clamp(ao, 0.0, 1.0);\nao = pow(ao, intensity);\ngl_FragColor = vec4(vec3(ao), 1.0);\n}\n",ppe="uniform sampler2D colorTexture;\nuniform sampler2D ambientOcclusionTexture;\nuniform bool ambientOcclusionOnly;\nvarying vec2 v_textureCoordinates;\nvoid main(void)\n{\nvec3 color = texture2D(colorTexture, v_textureCoordinates).rgb;\nvec3 ao = texture2D(ambientOcclusionTexture, v_textureCoordinates).rgb;\ngl_FragColor.rgb = ambientOcclusionOnly ? ao : ao * color;\n}\n",mpe="uniform sampler2D colorTexture;\nuniform float gradations;\nvarying vec2 v_textureCoordinates;\nvoid main(void)\n{\nvec3 rgb = texture2D(colorTexture, v_textureCoordinates).rgb;\n#ifdef CZM_SELECTED_FEATURE\nif (czm_selected()) {\ngl_FragColor = vec4(rgb, 1.0);\nreturn;\n}\n#endif\nfloat luminance = czm_luminance(rgb);\nfloat darkness = luminance * gradations;\ndarkness = (darkness - fract(darkness)) / gradations;\ngl_FragColor = vec4(vec3(darkness), 1.0);\n}\n",_pe="uniform sampler2D colorTexture;\nuniform sampler2D bloomTexture;\nuniform bool  glowOnly;\nvarying vec2 v_textureCoordinates;\nvoid main(void)\n{\nvec4 bloom = texture2D(bloomTexture, v_textureCoordinates);\nvec4 color = texture2D(colorTexture, v_textureCoordinates);\ngl_FragColor = glowOnly ? bloom : bloom + color;\n}\n",gpe="uniform sampler2D colorTexture;\nuniform float brightness;\nvarying vec2 v_textureCoordinates;\nvoid main(void)\n{\nvec3 rgb = texture2D(colorTexture, v_textureCoordinates).rgb;\nvec3 target = vec3(0.0);\ngl_FragColor = vec4(mix(target, rgb, brightness), 1.0);\n}\n",vpe="uniform sampler2D colorTexture;\nuniform float contrast;\nuniform float brightness;\nvarying vec2 v_textureCoordinates;\nvoid main(void)\n{\nvec3 sceneColor = texture2D(colorTexture, v_textureCoordinates).xyz;\nsceneColor = czm_RGBToHSB(sceneColor);\nsceneColor.z += brightness;\nsceneColor = czm_HSBToRGB(sceneColor);\nfloat factor = (259.0 * (contrast + 255.0)) / (255.0 * (259.0 - contrast));\nsceneColor = factor * (sceneColor - vec3(0.5)) + vec3(0.5);\ngl_FragColor = vec4(sceneColor, 1.0);\n}\n",bpe="uniform sampler2D colorTexture;\nuniform sampler2D blurTexture;\nuniform sampler2D depthTexture;\nuniform float focalDistance;\nvarying vec2 v_textureCoordinates;\nvec4 toEye(vec2 uv, float depth)\n{\nvec2 xy = vec2((uv.x * 2.0 - 1.0), ((1.0 - uv.y) * 2.0 - 1.0));\nvec4 posInCamera = czm_inverseProjection * vec4(xy, depth, 1.0);\nposInCamera = posInCamera / posInCamera.w;\nreturn posInCamera;\n}\nfloat computeDepthBlur(float depth)\n{\nfloat f;\nif (depth < focalDistance)\n{\nf = (focalDistance - depth) / (focalDistance - czm_currentFrustum.x);\n}\nelse\n{\nf = (depth - focalDistance) / (czm_currentFrustum.y - focalDistance);\nf = pow(f, 0.1);\n}\nf *= f;\nf = clamp(f, 0.0, 1.0);\nreturn pow(f, 0.5);\n}\nvoid main(void)\n{\nfloat depth = czm_readDepth(depthTexture, v_textureCoordinates);\nvec4 posInCamera = toEye(v_textureCoordinates, depth);\nfloat d = computeDepthBlur(-posInCamera.z);\ngl_FragColor = mix(texture2D(colorTexture, v_textureCoordinates), texture2D(blurTexture, v_textureCoordinates), d);\n}\n",ype="uniform sampler2D depthTexture;\nvarying vec2 v_textureCoordinates;\nvoid main(void)\n{\nfloat depth = czm_readDepth(depthTexture, v_textureCoordinates);\ngl_FragColor = vec4(vec3(depth), 1.0);\n}\n",wpe="uniform sampler2D depthTexture;\nuniform float length;\nuniform vec4 color;\nvarying vec2 v_textureCoordinates;\nvoid main(void)\n{\nfloat directions[3];\ndirections[0] = -1.0;\ndirections[1] = 0.0;\ndirections[2] = 1.0;\nfloat scalars[3];\nscalars[0] = 3.0;\nscalars[1] = 10.0;\nscalars[2] = 3.0;\nfloat padx = 1.0 / czm_viewport.z;\nfloat pady = 1.0 / czm_viewport.w;\n#ifdef CZM_SELECTED_FEATURE\nbool selected = false;\nfor (int i = 0; i < 3; ++i)\n{\nfloat dir = directions[i];\nselected = selected || czm_selected(vec2(-padx, dir * pady));\nselected = selected || czm_selected(vec2(padx, dir * pady));\nselected = selected || czm_selected(vec2(dir * padx, -pady));\nselected = selected || czm_selected(vec2(dir * padx, pady));\nif (selected)\n{\nbreak;\n}\n}\nif (!selected)\n{\ngl_FragColor = vec4(color.rgb, 0.0);\nreturn;\n}\n#endif\nfloat horizEdge = 0.0;\nfloat vertEdge = 0.0;\nfor (int i = 0; i < 3; ++i)\n{\nfloat dir = directions[i];\nfloat scale = scalars[i];\nhorizEdge -= texture2D(depthTexture, v_textureCoordinates + vec2(-padx, dir * pady)).x * scale;\nhorizEdge += texture2D(depthTexture, v_textureCoordinates + vec2(padx, dir * pady)).x * scale;\nvertEdge -= texture2D(depthTexture, v_textureCoordinates + vec2(dir * padx, -pady)).x * scale;\nvertEdge += texture2D(depthTexture, v_textureCoordinates + vec2(dir * padx, pady)).x * scale;\n}\nfloat len = sqrt(horizEdge * horizEdge + vertEdge * vertEdge);\ngl_FragColor = vec4(color.rgb, len > length ? color.a : 0.0);\n}\n",Ope="uniform sampler2D colorTexture;\nvarying vec2 v_textureCoordinates;\n#ifdef AUTO_EXPOSURE\nuniform sampler2D autoExposure;\n#endif\nvoid main()\n{\nvec4 fragmentColor = texture2D(colorTexture, v_textureCoordinates);\nvec3 color = fragmentColor.rgb;\n#ifdef AUTO_EXPOSURE\nfloat exposure = texture2D(autoExposure, vec2(0.5)).r;\ncolor /= exposure;\n#endif\nconst float A = 0.50;\nconst float B = 0.15;\nconst float C = 0.10;\nconst float D = 0.20;\nconst float E = 0.01;\nconst float F = 0.30;\nconst float white = 1.2;\nvec3 c = ((color * (A * color + C * B) + D * E) / (color * ( A * color + B) + D * F)) - E / F;\nfloat w = ((white * (A * white + C * B) + D * E) / (white * ( A * white + B) + D * F)) - E / F;\nc = czm_inverseGamma(c / w);\ngl_FragColor = vec4(c, fragmentColor.a);\n}\n",xpe="varying vec2 v_textureCoordinates;\nuniform sampler2D colorTexture;\nconst float fxaaQualitySubpix = 0.5;\nconst float fxaaQualityEdgeThreshold = 0.125;\nconst float fxaaQualityEdgeThresholdMin = 0.0833;\nvoid main()\n{\nvec2 fxaaQualityRcpFrame = vec2(1.0) / czm_viewport.zw;\nvec4 color = FxaaPixelShader(\nv_textureCoordinates,\ncolorTexture,\nfxaaQualityRcpFrame,\nfxaaQualitySubpix,\nfxaaQualityEdgeThreshold,\nfxaaQualityEdgeThresholdMin);\nfloat alpha = texture2D(colorTexture, v_textureCoordinates).a;\ngl_FragColor = vec4(color.rgb, alpha);\n}\n",Epe="#define SAMPLES 8\nuniform float delta;\nuniform float sigma;\nuniform float direction;\nuniform sampler2D colorTexture;\n#ifdef USE_STEP_SIZE\nuniform float stepSize;\n#else\nuniform vec2 step;\n#endif\nvarying vec2 v_textureCoordinates;\nvoid main()\n{\nvec2 st = v_textureCoordinates;\nvec2 dir = vec2(1.0 - direction, direction);\n#ifdef USE_STEP_SIZE\nvec2 step = vec2(stepSize / czm_viewport.zw);\n#else\nvec2 step = step;\n#endif\nvec3 g;\ng.x = 1.0 / (sqrt(czm_twoPi) * sigma);\ng.y = exp((-0.5 * delta * delta) / (sigma * sigma));\ng.z = g.y * g.y;\nvec4 result = texture2D(colorTexture, st) * g.x;\nfor (int i = 1; i < SAMPLES; ++i)\n{\ng.xy *= g.yz;\nvec2 offset = float(i) * dir * step;\nresult += texture2D(colorTexture, st - offset) * g.x;\nresult += texture2D(colorTexture, st + offset) * g.x;\n}\ngl_FragColor = result;\n}\n",Tpe="uniform sampler2D colorTexture;\nuniform sampler2D dirtTexture;\nuniform sampler2D starTexture;\nuniform vec2 dirtTextureDimensions;\nuniform float distortion;\nuniform float ghostDispersal;\nuniform float haloWidth;\nuniform float earthRadius;\nuniform float intensity;\nvarying vec2 v_textureCoordinates;\n#define DISTANCE_TO_SPACE 6500000.0\nvec4 getNDCFromWC(vec3 WC, float earthRadius)\n{\nvec4 positionEC = czm_view * vec4(WC, 1.0);\npositionEC = vec4(positionEC.x + earthRadius , positionEC.y, positionEC.z, 1.0);\nvec4 positionWC = czm_eyeToWindowCoordinates(positionEC);\nreturn czm_viewportOrthographic * vec4(positionWC.xy, -positionWC.z, 1.0);\n}\nfloat isInEarth(vec2 texcoord, vec2 sceneSize)\n{\nvec2 NDC = texcoord * 2.0 - 1.0;\nvec4 earthPosSC = getNDCFromWC(vec3(0.0), 0.0);\nvec4 earthPosSCEdge = getNDCFromWC(vec3(0.0), earthRadius * 1.5);\nNDC.xy -= earthPosSC.xy;\nfloat X = abs(NDC.x) * sceneSize.x;\nfloat Y = abs(NDC.y) * sceneSize.y;\nreturn clamp(0.0, 1.0, max(sqrt(X * X + Y * Y) / max(abs(earthPosSCEdge.x * sceneSize.x), 1.0) - 0.8 , 0.0));\n}\nvec4 textureDistorted(sampler2D tex, vec2 texcoord, vec2 direction, vec3 distortion, bool isSpace)\n{\nvec2 sceneSize = czm_viewport.zw;\nvec3 color;\nif(isSpace)\n{\ncolor.r = isInEarth(texcoord + direction * distortion.r, sceneSize) * texture2D(tex, texcoord + direction * distortion.r).r;\ncolor.g = isInEarth(texcoord + direction * distortion.g, sceneSize) * texture2D(tex, texcoord + direction * distortion.g).g;\ncolor.b = isInEarth(texcoord  + direction * distortion.b, sceneSize) * texture2D(tex, texcoord + direction * distortion.b).b;\n}\nelse\n{\ncolor.r = texture2D(tex, texcoord + direction * distortion.r).r;\ncolor.g = texture2D(tex, texcoord + direction * distortion.g).g;\ncolor.b = texture2D(tex, texcoord + direction * distortion.b).b;\n}\nreturn vec4(clamp(color, 0.0, 1.0), 0.0);\n}\nvoid main(void)\n{\nvec4 originalColor = texture2D(colorTexture, v_textureCoordinates);\nvec3 rgb = originalColor.rgb;\nbool isSpace = length(czm_viewerPositionWC.xyz) > DISTANCE_TO_SPACE;\nvec4 sunPos = czm_morphTime == 1.0 ? vec4(czm_sunPositionWC, 1.0) : vec4(czm_sunPositionColumbusView.zxy, 1.0);\nvec4 sunPositionEC = czm_view * sunPos;\nvec4 sunPositionWC = czm_eyeToWindowCoordinates(sunPositionEC);\nsunPos = czm_viewportOrthographic * vec4(sunPositionWC.xy, -sunPositionWC.z, 1.0);\nif(!isSpace || !((sunPos.x >= -1.1 && sunPos.x <= 1.1) && (sunPos.y >= -1.1 && sunPos.y <= 1.1)))\n{\ngl_FragColor = originalColor;\nreturn;\n}\nvec2 texcoord = -v_textureCoordinates + vec2(1.0);\nvec2 texelSize = 1.0 / czm_viewport.zw;\nvec3 distortionVec = vec3(-texelSize.x * distortion, 0.0, texelSize.x * distortion);\nvec2 ghostVec = (vec2(0.5) - texcoord) * ghostDispersal;\nvec3 direction = normalize(vec3(ghostVec, 0.0));\nvec4 result = vec4(0.0);\nvec4 ghost = vec4(0.0);\nfor (int i = 0; i < 4; ++i)\n{\nvec2 offset = fract(texcoord + ghostVec * float(i));\nghost += textureDistorted(colorTexture, offset, direction.xy, distortionVec, isSpace);\n}\nresult += ghost;\nvec2 haloVec = normalize(ghostVec) * haloWidth;\nfloat weightForHalo = length(vec2(0.5) - fract(texcoord + haloVec)) / length(vec2(0.5));\nweightForHalo = pow(1.0 - weightForHalo, 5.0);\nresult += textureDistorted(colorTexture, texcoord + haloVec, direction.xy, distortionVec, isSpace) * weightForHalo * 1.5;\nvec2 dirtTexCoords = (v_textureCoordinates * czm_viewport.zw) / dirtTextureDimensions;\nif (dirtTexCoords.x > 1.0)\n{\ndirtTexCoords.x = mod(floor(dirtTexCoords.x), 2.0) == 1.0 ? 1.0 - fract(dirtTexCoords.x) :  fract(dirtTexCoords.x);\n}\nif (dirtTexCoords.y > 1.0)\n{\ndirtTexCoords.y = mod(floor(dirtTexCoords.y), 2.0) == 1.0 ? 1.0 - fract(dirtTexCoords.y) :  fract(dirtTexCoords.y);\n}\nresult += texture2D(dirtTexture, dirtTexCoords);\nfloat camrot = czm_view[0].z + czm_view[1].y;\nfloat cosValue = cos(camrot);\nfloat sinValue = sin(camrot);\nmat3 rotation = mat3(\ncosValue, -sinValue, 0.0,\nsinValue, cosValue, 0.0,\n0.0, 0.0, 1.0\n);\nvec3 st1 = vec3(v_textureCoordinates * 2.0 - vec2(1.0), 1.0);\nvec3 st2 = vec3((rotation * st1).xy, 1.0);\nvec3 st3 = st2 * 0.5 + vec3(0.5);\nvec2 lensStarTexcoord = st3.xy;\nfloat weightForLensFlare = length(vec3(sunPos.xy, 0.0));\nfloat oneMinusWeightForLensFlare = max(1.0 - weightForLensFlare, 0.0);\nif (!isSpace)\n{\nresult *= oneMinusWeightForLensFlare * intensity * 0.2;\n}\nelse\n{\nresult *= oneMinusWeightForLensFlare * intensity;\nresult *= texture2D(starTexture, lensStarTexcoord) * pow(weightForLensFlare, 1.0) * max((1.0 - length(vec3(st1.xy, 0.0))), 0.0) * 2.0;\n}\nresult += texture2D(colorTexture, v_textureCoordinates);\ngl_FragColor = result;\n}\n",Cpe="uniform sampler2D colorTexture;\nuniform vec3 white;\nvarying vec2 v_textureCoordinates;\n#ifdef AUTO_EXPOSURE\nuniform sampler2D autoExposure;\n#endif\nvoid main()\n{\nvec4 fragmentColor = texture2D(colorTexture, v_textureCoordinates);\nvec3 color = fragmentColor.rgb;\n#ifdef AUTO_EXPOSURE\nfloat exposure = texture2D(autoExposure, vec2(0.5)).r;\ncolor /= exposure;\n#endif\ncolor = (color * (1.0 + color / white)) / (1.0 + color);\ncolor = czm_inverseGamma(color);\ngl_FragColor = vec4(color, fragmentColor.a);\n}\n",Spe="uniform sampler2D colorTexture;\nvarying vec2 v_textureCoordinates;\nfloat rand(vec2 co)\n{\nreturn fract(sin(dot(co.xy ,vec2(12.9898, 78.233))) * 43758.5453);\n}\nvoid main(void)\n{\nfloat noiseValue = rand(v_textureCoordinates + sin(czm_frameNumber)) * 0.1;\nvec3 rgb = texture2D(colorTexture, v_textureCoordinates).rgb;\nvec3 green = vec3(0.0, 1.0, 0.0);\ngl_FragColor = vec4((noiseValue + rgb) * green, 1.0);\n}\n",Ape="uniform sampler2D colorTexture;\nvarying vec2 v_textureCoordinates;\n#ifdef AUTO_EXPOSURE\nuniform sampler2D autoExposure;\n#endif\nvoid main()\n{\nvec4 fragmentColor = texture2D(colorTexture, v_textureCoordinates);\nvec3 color = fragmentColor.rgb;\n#ifdef AUTO_EXPOSURE\nfloat exposure = texture2D(autoExposure, vec2(0.5)).r;\ncolor /= exposure;\n#endif\ncolor = color / (1.0 + color);\ncolor = czm_inverseGamma(color);\ngl_FragColor = vec4(color, fragmentColor.a);\n}\n",Ppe="uniform sampler2D colorTexture;\nuniform sampler2D silhouetteTexture;\nvarying vec2 v_textureCoordinates;\nvoid main(void)\n{\nvec4 silhouetteColor = texture2D(silhouetteTexture, v_textureCoordinates);\nvec4 color = texture2D(colorTexture, v_textureCoordinates);\ngl_FragColor = mix(color, silhouetteColor, silhouetteColor.a);\n}\n",Ipe="uniform sampler2D colorTexture;\nvarying vec2 v_textureCoordinates;\nuniform vec3 powRGB;\nuniform vec3 mulRGB;\nuniform vec3 addRGB;\nvoid main() {\ngl_FragColor = texture2D( colorTexture, v_textureCoordinates );\ngl_FragColor.rgb = mulRGB * pow( ( gl_FragColor.rgb + addRGB ), powRGB );\n}\n",Dpe="#if (FXAA_QUALITY_PRESET == 10)\n#define FXAA_QUALITY_PS 3\n#define FXAA_QUALITY_P0 1.5\n#define FXAA_QUALITY_P1 3.0\n#define FXAA_QUALITY_P2 12.0\n#endif\n#if (FXAA_QUALITY_PRESET == 11)\n#define FXAA_QUALITY_PS 4\n#define FXAA_QUALITY_P0 1.0\n#define FXAA_QUALITY_P1 1.5\n#define FXAA_QUALITY_P2 3.0\n#define FXAA_QUALITY_P3 12.0\n#endif\n#if (FXAA_QUALITY_PRESET == 12)\n#define FXAA_QUALITY_PS 5\n#define FXAA_QUALITY_P0 1.0\n#define FXAA_QUALITY_P1 1.5\n#define FXAA_QUALITY_P2 2.0\n#define FXAA_QUALITY_P3 4.0\n#define FXAA_QUALITY_P4 12.0\n#endif\n#if (FXAA_QUALITY_PRESET == 13)\n#define FXAA_QUALITY_PS 6\n#define FXAA_QUALITY_P0 1.0\n#define FXAA_QUALITY_P1 1.5\n#define FXAA_QUALITY_P2 2.0\n#define FXAA_QUALITY_P3 2.0\n#define FXAA_QUALITY_P4 4.0\n#define FXAA_QUALITY_P5 12.0\n#endif\n#if (FXAA_QUALITY_PRESET == 14)\n#define FXAA_QUALITY_PS 7\n#define FXAA_QUALITY_P0 1.0\n#define FXAA_QUALITY_P1 1.5\n#define FXAA_QUALITY_P2 2.0\n#define FXAA_QUALITY_P3 2.0\n#define FXAA_QUALITY_P4 2.0\n#define FXAA_QUALITY_P5 4.0\n#define FXAA_QUALITY_P6 12.0\n#endif\n#if (FXAA_QUALITY_PRESET == 15)\n#define FXAA_QUALITY_PS 8\n#define FXAA_QUALITY_P0 1.0\n#define FXAA_QUALITY_P1 1.5\n#define FXAA_QUALITY_P2 2.0\n#define FXAA_QUALITY_P3 2.0\n#define FXAA_QUALITY_P4 2.0\n#define FXAA_QUALITY_P5 2.0\n#define FXAA_QUALITY_P6 4.0\n#define FXAA_QUALITY_P7 12.0\n#endif\n#if (FXAA_QUALITY_PRESET == 20)\n#define FXAA_QUALITY_PS 3\n#define FXAA_QUALITY_P0 1.5\n#define FXAA_QUALITY_P1 2.0\n#define FXAA_QUALITY_P2 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 21)\n#define FXAA_QUALITY_PS 4\n#define FXAA_QUALITY_P0 1.0\n#define FXAA_QUALITY_P1 1.5\n#define FXAA_QUALITY_P2 2.0\n#define FXAA_QUALITY_P3 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 22)\n#define FXAA_QUALITY_PS 5\n#define FXAA_QUALITY_P0 1.0\n#define FXAA_QUALITY_P1 1.5\n#define FXAA_QUALITY_P2 2.0\n#define FXAA_QUALITY_P3 2.0\n#define FXAA_QUALITY_P4 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 23)\n#define FXAA_QUALITY_PS 6\n#define FXAA_QUALITY_P0 1.0\n#define FXAA_QUALITY_P1 1.5\n#define FXAA_QUALITY_P2 2.0\n#define FXAA_QUALITY_P3 2.0\n#define FXAA_QUALITY_P4 2.0\n#define FXAA_QUALITY_P5 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 24)\n#define FXAA_QUALITY_PS 7\n#define FXAA_QUALITY_P0 1.0\n#define FXAA_QUALITY_P1 1.5\n#define FXAA_QUALITY_P2 2.0\n#define FXAA_QUALITY_P3 2.0\n#define FXAA_QUALITY_P4 2.0\n#define FXAA_QUALITY_P5 3.0\n#define FXAA_QUALITY_P6 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 25)\n#define FXAA_QUALITY_PS 8\n#define FXAA_QUALITY_P0 1.0\n#define FXAA_QUALITY_P1 1.5\n#define FXAA_QUALITY_P2 2.0\n#define FXAA_QUALITY_P3 2.0\n#define FXAA_QUALITY_P4 2.0\n#define FXAA_QUALITY_P5 2.0\n#define FXAA_QUALITY_P6 4.0\n#define FXAA_QUALITY_P7 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 26)\n#define FXAA_QUALITY_PS 9\n#define FXAA_QUALITY_P0 1.0\n#define FXAA_QUALITY_P1 1.5\n#define FXAA_QUALITY_P2 2.0\n#define FXAA_QUALITY_P3 2.0\n#define FXAA_QUALITY_P4 2.0\n#define FXAA_QUALITY_P5 2.0\n#define FXAA_QUALITY_P6 2.0\n#define FXAA_QUALITY_P7 4.0\n#define FXAA_QUALITY_P8 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 27)\n#define FXAA_QUALITY_PS 10\n#define FXAA_QUALITY_P0 1.0\n#define FXAA_QUALITY_P1 1.5\n#define FXAA_QUALITY_P2 2.0\n#define FXAA_QUALITY_P3 2.0\n#define FXAA_QUALITY_P4 2.0\n#define FXAA_QUALITY_P5 2.0\n#define FXAA_QUALITY_P6 2.0\n#define FXAA_QUALITY_P7 2.0\n#define FXAA_QUALITY_P8 4.0\n#define FXAA_QUALITY_P9 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 28)\n#define FXAA_QUALITY_PS 11\n#define FXAA_QUALITY_P0 1.0\n#define FXAA_QUALITY_P1 1.5\n#define FXAA_QUALITY_P2 2.0\n#define FXAA_QUALITY_P3 2.0\n#define FXAA_QUALITY_P4 2.0\n#define FXAA_QUALITY_P5 2.0\n#define FXAA_QUALITY_P6 2.0\n#define FXAA_QUALITY_P7 2.0\n#define FXAA_QUALITY_P8 2.0\n#define FXAA_QUALITY_P9 4.0\n#define FXAA_QUALITY_P10 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 29)\n#define FXAA_QUALITY_PS 12\n#define FXAA_QUALITY_P0 1.0\n#define FXAA_QUALITY_P1 1.5\n#define FXAA_QUALITY_P2 2.0\n#define FXAA_QUALITY_P3 2.0\n#define FXAA_QUALITY_P4 2.0\n#define FXAA_QUALITY_P5 2.0\n#define FXAA_QUALITY_P6 2.0\n#define FXAA_QUALITY_P7 2.0\n#define FXAA_QUALITY_P8 2.0\n#define FXAA_QUALITY_P9 2.0\n#define FXAA_QUALITY_P10 4.0\n#define FXAA_QUALITY_P11 8.0\n#endif\n#if (FXAA_QUALITY_PRESET == 39)\n#define FXAA_QUALITY_PS 12\n#define FXAA_QUALITY_P0 1.0\n#define FXAA_QUALITY_P1 1.0\n#define FXAA_QUALITY_P2 1.0\n#define FXAA_QUALITY_P3 1.0\n#define FXAA_QUALITY_P4 1.0\n#define FXAA_QUALITY_P5 1.5\n#define FXAA_QUALITY_P6 2.0\n#define FXAA_QUALITY_P7 2.0\n#define FXAA_QUALITY_P8 2.0\n#define FXAA_QUALITY_P9 2.0\n#define FXAA_QUALITY_P10 4.0\n#define FXAA_QUALITY_P11 8.0\n#endif\n#define FxaaBool bool\n#define FxaaFloat float\n#define FxaaFloat2 vec2\n#define FxaaFloat3 vec3\n#define FxaaFloat4 vec4\n#define FxaaHalf float\n#define FxaaHalf2 vec2\n#define FxaaHalf3 vec3\n#define FxaaHalf4 vec4\n#define FxaaInt2 vec2\n#define FxaaTex sampler2D\n#define FxaaSat(x) clamp(x, 0.0, 1.0)\n#define FxaaTexTop(t, p) texture2D(t, p)\n#define FxaaTexOff(t, p, o, r) texture2D(t, p + (o * r))\nFxaaFloat FxaaLuma(FxaaFloat4 rgba) { return rgba.y; }\nFxaaFloat4 FxaaPixelShader(\nFxaaFloat2 pos,\nFxaaTex tex,\nFxaaFloat2 fxaaQualityRcpFrame,\nFxaaFloat fxaaQualitySubpix,\nFxaaFloat fxaaQualityEdgeThreshold,\nFxaaFloat fxaaQualityEdgeThresholdMin\n) {\nFxaaFloat2 posM;\nposM.x = pos.x;\nposM.y = pos.y;\nFxaaFloat4 rgbyM = FxaaTexTop(tex, posM);\n#define lumaM rgbyM.y\nFxaaFloat lumaS = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 0, 1), fxaaQualityRcpFrame.xy));\nFxaaFloat lumaE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1, 0), fxaaQualityRcpFrame.xy));\nFxaaFloat lumaN = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 0,-1), fxaaQualityRcpFrame.xy));\nFxaaFloat lumaW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 0), fxaaQualityRcpFrame.xy));\nFxaaFloat maxSM = max(lumaS, lumaM);\nFxaaFloat minSM = min(lumaS, lumaM);\nFxaaFloat maxESM = max(lumaE, maxSM);\nFxaaFloat minESM = min(lumaE, minSM);\nFxaaFloat maxWN = max(lumaN, lumaW);\nFxaaFloat minWN = min(lumaN, lumaW);\nFxaaFloat rangeMax = max(maxWN, maxESM);\nFxaaFloat rangeMin = min(minWN, minESM);\nFxaaFloat rangeMaxScaled = rangeMax * fxaaQualityEdgeThreshold;\nFxaaFloat range = rangeMax - rangeMin;\nFxaaFloat rangeMaxClamped = max(fxaaQualityEdgeThresholdMin, rangeMaxScaled);\nFxaaBool earlyExit = range < rangeMaxClamped;\nif(earlyExit)\nreturn rgbyM;\nFxaaFloat lumaNW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1,-1), fxaaQualityRcpFrame.xy));\nFxaaFloat lumaSE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1, 1), fxaaQualityRcpFrame.xy));\nFxaaFloat lumaNE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1,-1), fxaaQualityRcpFrame.xy));\nFxaaFloat lumaSW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 1), fxaaQualityRcpFrame.xy));\nFxaaFloat lumaNS = lumaN + lumaS;\nFxaaFloat lumaWE = lumaW + lumaE;\nFxaaFloat subpixRcpRange = 1.0/range;\nFxaaFloat subpixNSWE = lumaNS + lumaWE;\nFxaaFloat edgeHorz1 = (-2.0 * lumaM) + lumaNS;\nFxaaFloat edgeVert1 = (-2.0 * lumaM) + lumaWE;\nFxaaFloat lumaNESE = lumaNE + lumaSE;\nFxaaFloat lumaNWNE = lumaNW + lumaNE;\nFxaaFloat edgeHorz2 = (-2.0 * lumaE) + lumaNESE;\nFxaaFloat edgeVert2 = (-2.0 * lumaN) + lumaNWNE;\nFxaaFloat lumaNWSW = lumaNW + lumaSW;\nFxaaFloat lumaSWSE = lumaSW + lumaSE;\nFxaaFloat edgeHorz4 = (abs(edgeHorz1) * 2.0) + abs(edgeHorz2);\nFxaaFloat edgeVert4 = (abs(edgeVert1) * 2.0) + abs(edgeVert2);\nFxaaFloat edgeHorz3 = (-2.0 * lumaW) + lumaNWSW;\nFxaaFloat edgeVert3 = (-2.0 * lumaS) + lumaSWSE;\nFxaaFloat edgeHorz = abs(edgeHorz3) + edgeHorz4;\nFxaaFloat edgeVert = abs(edgeVert3) + edgeVert4;\nFxaaFloat subpixNWSWNESE = lumaNWSW + lumaNESE;\nFxaaFloat lengthSign = fxaaQualityRcpFrame.x;\nFxaaBool horzSpan = edgeHorz >= edgeVert;\nFxaaFloat subpixA = subpixNSWE * 2.0 + subpixNWSWNESE;\nif(!horzSpan) lumaN = lumaW;\nif(!horzSpan) lumaS = lumaE;\nif(horzSpan) lengthSign = fxaaQualityRcpFrame.y;\nFxaaFloat subpixB = (subpixA * (1.0/12.0)) - lumaM;\nFxaaFloat gradientN = lumaN - lumaM;\nFxaaFloat gradientS = lumaS - lumaM;\nFxaaFloat lumaNN = lumaN + lumaM;\nFxaaFloat lumaSS = lumaS + lumaM;\nFxaaBool pairN = abs(gradientN) >= abs(gradientS);\nFxaaFloat gradient = max(abs(gradientN), abs(gradientS));\nif(pairN) lengthSign = -lengthSign;\nFxaaFloat subpixC = FxaaSat(abs(subpixB) * subpixRcpRange);\nFxaaFloat2 posB;\nposB.x = posM.x;\nposB.y = posM.y;\nFxaaFloat2 offNP;\noffNP.x = (!horzSpan) ? 0.0 : fxaaQualityRcpFrame.x;\noffNP.y = ( horzSpan) ? 0.0 : fxaaQualityRcpFrame.y;\nif(!horzSpan) posB.x += lengthSign * 0.5;\nif( horzSpan) posB.y += lengthSign * 0.5;\nFxaaFloat2 posN;\nposN.x = posB.x - offNP.x * FXAA_QUALITY_P0;\nposN.y = posB.y - offNP.y * FXAA_QUALITY_P0;\nFxaaFloat2 posP;\nposP.x = posB.x + offNP.x * FXAA_QUALITY_P0;\nposP.y = posB.y + offNP.y * FXAA_QUALITY_P0;\nFxaaFloat subpixD = ((-2.0)*subpixC) + 3.0;\nFxaaFloat lumaEndN = FxaaLuma(FxaaTexTop(tex, posN));\nFxaaFloat subpixE = subpixC * subpixC;\nFxaaFloat lumaEndP = FxaaLuma(FxaaTexTop(tex, posP));\nif(!pairN) lumaNN = lumaSS;\nFxaaFloat gradientScaled = gradient * 1.0/4.0;\nFxaaFloat lumaMM = lumaM - lumaNN * 0.5;\nFxaaFloat subpixF = subpixD * subpixE;\nFxaaBool lumaMLTZero = lumaMM < 0.0;\nlumaEndN -= lumaNN * 0.5;\nlumaEndP -= lumaNN * 0.5;\nFxaaBool doneN = abs(lumaEndN) >= gradientScaled;\nFxaaBool doneP = abs(lumaEndP) >= gradientScaled;\nif(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P1;\nif(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P1;\nFxaaBool doneNP = (!doneN) || (!doneP);\nif(!doneP) posP.x += offNP.x * FXAA_QUALITY_P1;\nif(!doneP) posP.y += offNP.y * FXAA_QUALITY_P1;\nif(doneNP) {\nif(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\nif(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\nif(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\nif(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\ndoneN = abs(lumaEndN) >= gradientScaled;\ndoneP = abs(lumaEndP) >= gradientScaled;\nif(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P2;\nif(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P2;\ndoneNP = (!doneN) || (!doneP);\nif(!doneP) posP.x += offNP.x * FXAA_QUALITY_P2;\nif(!doneP) posP.y += offNP.y * FXAA_QUALITY_P2;\n#if (FXAA_QUALITY_PS > 3)\nif(doneNP) {\nif(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\nif(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\nif(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\nif(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\ndoneN = abs(lumaEndN) >= gradientScaled;\ndoneP = abs(lumaEndP) >= gradientScaled;\nif(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P3;\nif(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P3;\ndoneNP = (!doneN) || (!doneP);\nif(!doneP) posP.x += offNP.x * FXAA_QUALITY_P3;\nif(!doneP) posP.y += offNP.y * FXAA_QUALITY_P3;\n#if (FXAA_QUALITY_PS > 4)\nif(doneNP) {\nif(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\nif(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\nif(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\nif(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\ndoneN = abs(lumaEndN) >= gradientScaled;\ndoneP = abs(lumaEndP) >= gradientScaled;\nif(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P4;\nif(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P4;\ndoneNP = (!doneN) || (!doneP);\nif(!doneP) posP.x += offNP.x * FXAA_QUALITY_P4;\nif(!doneP) posP.y += offNP.y * FXAA_QUALITY_P4;\n#if (FXAA_QUALITY_PS > 5)\nif(doneNP) {\nif(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\nif(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\nif(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\nif(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\ndoneN = abs(lumaEndN) >= gradientScaled;\ndoneP = abs(lumaEndP) >= gradientScaled;\nif(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P5;\nif(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P5;\ndoneNP = (!doneN) || (!doneP);\nif(!doneP) posP.x += offNP.x * FXAA_QUALITY_P5;\nif(!doneP) posP.y += offNP.y * FXAA_QUALITY_P5;\n#if (FXAA_QUALITY_PS > 6)\nif(doneNP) {\nif(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\nif(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\nif(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\nif(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\ndoneN = abs(lumaEndN) >= gradientScaled;\ndoneP = abs(lumaEndP) >= gradientScaled;\nif(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P6;\nif(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P6;\ndoneNP = (!doneN) || (!doneP);\nif(!doneP) posP.x += offNP.x * FXAA_QUALITY_P6;\nif(!doneP) posP.y += offNP.y * FXAA_QUALITY_P6;\n#if (FXAA_QUALITY_PS > 7)\nif(doneNP) {\nif(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\nif(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\nif(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\nif(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\ndoneN = abs(lumaEndN) >= gradientScaled;\ndoneP = abs(lumaEndP) >= gradientScaled;\nif(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P7;\nif(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P7;\ndoneNP = (!doneN) || (!doneP);\nif(!doneP) posP.x += offNP.x * FXAA_QUALITY_P7;\nif(!doneP) posP.y += offNP.y * FXAA_QUALITY_P7;\n#if (FXAA_QUALITY_PS > 8)\nif(doneNP) {\nif(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\nif(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\nif(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\nif(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\ndoneN = abs(lumaEndN) >= gradientScaled;\ndoneP = abs(lumaEndP) >= gradientScaled;\nif(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P8;\nif(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P8;\ndoneNP = (!doneN) || (!doneP);\nif(!doneP) posP.x += offNP.x * FXAA_QUALITY_P8;\nif(!doneP) posP.y += offNP.y * FXAA_QUALITY_P8;\n#if (FXAA_QUALITY_PS > 9)\nif(doneNP) {\nif(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\nif(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\nif(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\nif(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\ndoneN = abs(lumaEndN) >= gradientScaled;\ndoneP = abs(lumaEndP) >= gradientScaled;\nif(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P9;\nif(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P9;\ndoneNP = (!doneN) || (!doneP);\nif(!doneP) posP.x += offNP.x * FXAA_QUALITY_P9;\nif(!doneP) posP.y += offNP.y * FXAA_QUALITY_P9;\n#if (FXAA_QUALITY_PS > 10)\nif(doneNP) {\nif(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\nif(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\nif(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\nif(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\ndoneN = abs(lumaEndN) >= gradientScaled;\ndoneP = abs(lumaEndP) >= gradientScaled;\nif(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P10;\nif(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P10;\ndoneNP = (!doneN) || (!doneP);\nif(!doneP) posP.x += offNP.x * FXAA_QUALITY_P10;\nif(!doneP) posP.y += offNP.y * FXAA_QUALITY_P10;\n#if (FXAA_QUALITY_PS > 11)\nif(doneNP) {\nif(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\nif(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\nif(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\nif(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\ndoneN = abs(lumaEndN) >= gradientScaled;\ndoneP = abs(lumaEndP) >= gradientScaled;\nif(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P11;\nif(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P11;\ndoneNP = (!doneN) || (!doneP);\nif(!doneP) posP.x += offNP.x * FXAA_QUALITY_P11;\nif(!doneP) posP.y += offNP.y * FXAA_QUALITY_P11;\n#if (FXAA_QUALITY_PS > 12)\nif(doneNP) {\nif(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));\nif(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));\nif(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;\nif(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;\ndoneN = abs(lumaEndN) >= gradientScaled;\ndoneP = abs(lumaEndP) >= gradientScaled;\nif(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P12;\nif(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P12;\ndoneNP = (!doneN) || (!doneP);\nif(!doneP) posP.x += offNP.x * FXAA_QUALITY_P12;\nif(!doneP) posP.y += offNP.y * FXAA_QUALITY_P12;\n}\n#endif\n}\n#endif\n}\n#endif\n}\n#endif\n}\n#endif\n}\n#endif\n}\n#endif\n}\n#endif\n}\n#endif\n}\n#endif\n}\nFxaaFloat dstN = posM.x - posN.x;\nFxaaFloat dstP = posP.x - posM.x;\nif(!horzSpan) dstN = posM.y - posN.y;\nif(!horzSpan) dstP = posP.y - posM.y;\nFxaaBool goodSpanN = (lumaEndN < 0.0) != lumaMLTZero;\nFxaaFloat spanLength = (dstP + dstN);\nFxaaBool goodSpanP = (lumaEndP < 0.0) != lumaMLTZero;\nFxaaFloat spanLengthRcp = 1.0/spanLength;\nFxaaBool directionN = dstN < dstP;\nFxaaFloat dst = min(dstN, dstP);\nFxaaBool goodSpan = directionN ? goodSpanN : goodSpanP;\nFxaaFloat subpixG = subpixF * subpixF;\nFxaaFloat pixelOffset = (dst * (-spanLengthRcp)) + 0.5;\nFxaaFloat subpixH = subpixG * fxaaQualitySubpix;\nFxaaFloat pixelOffsetGood = goodSpan ? pixelOffset : 0.0;\nFxaaFloat pixelOffsetSubpix = max(pixelOffsetGood, subpixH);\nif(!horzSpan) posM.x += pixelOffsetSubpix * lengthSign;\nif( horzSpan) posM.y += pixelOffsetSubpix * lengthSign;\nreturn FxaaFloat4(FxaaTexTop(tex, posM).xyz, lumaM);\n}\n";function jpe(e){e=Object(w.a)(e,w.a.EMPTY_OBJECT),x.a.defined("options.stages",e.stages),x.a.typeOf.number.greaterThan("options.stages.length",e.stages.length,0),this._stages=e.stages,this._inputPreviousStageTexture=Object(w.a)(e.inputPreviousStageTexture,!0);var t=e.name;Object(u.a)(t)||(t=Mg()),this._name=t,this._uniforms=e.uniforms,this._textureCache=void 0,this._index=void 0,this._selected=void 0,this._selectedShadow=void 0,this._parentSelected=void 0,this._parentSelectedShadow=void 0,this._combinedSelected=void 0,this._combinedSelectedShadow=void 0,this._selectedLength=0,this._parentSelectedLength=0,this._selectedDirty=!0}Object(O.a)(jpe.prototype,{ready:{get:function(){for(var e=this._stages,t=e.length,i=0;i<t;++i)if(!e[i].ready)return!1;return!0}},name:{get:function(){return this._name}},enabled:{get:function(){return this._stages[0].enabled},set:function(e){for(var t=this._stages,i=t.length,n=0;n<i;++n)t[n].enabled=e}},uniforms:{get:function(){return this._uniforms}},inputPreviousStageTexture:{get:function(){return this._inputPreviousStageTexture}},length:{get:function(){return this._stages.length}},selected:{get:function(){return this._selected},set:function(e){this._selected=e}},parentSelected:{get:function(){return this._parentSelected},set:function(e){this._parentSelected=e}}}),jpe.prototype._isSupported=function(e){for(var t=this._stages,i=t.length,n=0;n<i;++n)if(!t[n]._isSupported(e))return!1;return!0},jpe.prototype.get=function(e){return x.a.typeOf.number.greaterThanOrEquals("index",e,0),x.a.typeOf.number.lessThan("index",e,this.length),this._stages[e]},jpe.prototype.update=function(e,t){this._selectedDirty=function(e){var t=Object(u.a)(e._selected)?e._selected.length:0,i=Object(u.a)(e._parentSelected)?e._parentSelected:0,n=e._selected!==e._selectedShadow||t!==e._selectedLength;if(n=n||e._parentSelected!==e._parentSelectedShadow||i!==e._parentSelectedLength,Object(u.a)(e._selected)&&Object(u.a)(e._parentSelected)?e._combinedSelected=e._selected.concat(e._parentSelected):Object(u.a)(e._parentSelected)?e._combinedSelected=e._parentSelected:e._combinedSelected=e._selected,!n&&Object(u.a)(e._combinedSelected)){if(!Object(u.a)(e._combinedSelectedShadow))return!0;t=e._combinedSelected.length;for(var r=0;r<t;++r)if(e._combinedSelected[r]!==e._combinedSelectedShadow[r])return!0}return n}(this),this._selectedShadow=this._selected,this._parentSelectedShadow=this._parentSelected,this._combinedSelectedShadow=this._combinedSelected,this._selectedLength=Object(u.a)(this._selected)?this._selected.length:0,this._parentSelectedLength=Object(u.a)(this._parentSelected)?this._parentSelected.length:0;for(var i=this._stages,n=i.length,r=0;r<n;++r){var a=i[r];this._selectedDirty&&(a.parentSelected=this._combinedSelected),a.update(e,t)}},jpe.prototype.isDestroyed=function(){return!1},jpe.prototype.destroy=function(){for(var e=this._stages,t=e.length,i=0;i<t;++i)e[i].destroy();return rl(this)};var Mpe=jpe,Rpe="uniform sampler2D colorTexture;\nvarying vec2 v_textureCoordinates;\nfloat snow(vec2 uv,float scale)\n{\nfloat time = czm_frameNumber / 60.0;\nfloat w=smoothstep(1.0,0.0,-uv.y*(scale/10.0));\nif(w<0.1)\nreturn 0.0;\nuv+=time/scale;\nuv.y+=time*2.0/scale;\nuv.x+=sin(uv.y+time*0.5)/scale;\nuv*=scale;\nvec2 s=floor(uv),f=fract(uv),p;\nfloat k=3.0,d;\np=0.5+0.35*sin(11.0*fract(sin((s+p+scale)*mat2(7,3,6,5))*5.0))-f;\nd=length(p);\nk=min(d,k);\nk=smoothstep(0.0,k,sin(f.x+f.y)*0.01);\nreturn k*w;\n}\nvoid main(void){\nvec2 resolution = czm_viewport.zw;\nvec2 uv=(gl_FragCoord.xy*2.0-resolution.xy)/min(resolution.x,resolution.y);\nvec3 finalColor=vec3(0);\nfloat c = 0.0;\nc+=snow(uv,30.0)*0.0;\nc+=snow(uv,20.0)*0.0;\nc+=snow(uv,15.0)*0.0;\nc+=snow(uv,10.0);\nc+=snow(uv,8.0);\nc+=snow(uv,6.0);\nc+=snow(uv,5.0);\nfinalColor=(vec3(c));\ngl_FragColor = mix(texture2D(colorTexture, v_textureCoordinates), vec4(finalColor,1), 0.5);\n}\n",Lpe="uniform sampler2D colorTexture;\nvarying vec2 v_textureCoordinates;\nfloat hash(float x){\nreturn fract(sin(x*133.3)*13.13);\n}\nvoid main(void){\nfloat time = czm_frameNumber / 60.0;\nvec2 resolution = czm_viewport.zw;\nvec2 uv=(gl_FragCoord.xy*2.-resolution.xy)/min(resolution.x,resolution.y);\nvec3 c=vec3(0.6,0.7,0.8);\nfloat a=-0.4;\nfloat si=sin(a),co=cos(a);\nuv*=mat2(co,-si,si,co);\nuv*=length(uv+vec2(0,4.9))*0.3+1.;\nfloat v=1.0-sin(hash(floor(uv.x*100.0))*2.0);\nfloat b=clamp(abs(sin(20.0*time*v+uv.y*(5.0/(2.0+v))))-0.95,0.0,1.0)*20.0;\nc*=v*b;\ngl_FragColor = mix(texture2D(colorTexture, v_textureCoordinates), vec4(c,1), 0.5);\n}\n",Npe="uniform sampler2D colorTexture;\nuniform float colorAmount;\nuniform float edgeAmount;\nvarying vec2 v_textureCoordinates;\nvoid main()\n{\nvec2 onePixel = vec2(1.0, 1.0) / czm_viewport.zw;\nvec4 color = texture2D(colorTexture, v_textureCoordinates);\nvec4 edgeDetection = texture2D(colorTexture, v_textureCoordinates + onePixel * vec2(0, -1)) +\ntexture2D(colorTexture, v_textureCoordinates + onePixel * vec2(-1, 0)) +\ntexture2D(colorTexture, v_textureCoordinates + onePixel * vec2(1, 0)) +\ntexture2D(colorTexture, v_textureCoordinates + onePixel * vec2(0, 1)) -\ncolor * 4.0;\ngl_FragColor = max(vec4(color.rgb * colorAmount, color.a) - (edgeAmount * vec4(edgeDetection.rgb, 0.0)), 0.0);\n}\n",Fpe="uniform sampler2D colorTexture;\nuniform sampler2D depthTexture;\nvarying vec2 v_textureCoordinates;\n#ifdef VIGNETTE\nuniform vec4 color1;\nuniform vec4 color2;\nuniform float aspect;\nuniform vec2 offset;\nuniform vec2 scale;\nuniform float noiseAlpha;\nuniform bool aspectCorrection;\nuniform float grainScale;\nuniform float grainTime;\nuniform vec2 smoothRange;\nvec3 mod289(vec3 x)\n{\nreturn x - floor(x * (1.0 / 289.0)) * 289.0;\n}\nvec4 mod289(vec4 x)\n{\nreturn x - floor(x * (1.0 / 289.0)) * 289.0;\n}\nvec4 permute(vec4 x)\n{\nreturn mod289(((x*34.0)+1.0)*x);\n}\nvec4 taylorInvSqrt(vec4 r)\n{\nreturn 1.79284291400159 - 0.85373472095314 * r;\n}\nvec3 fade(vec3 t) {\nreturn t*t*t*(t*(t*6.0-15.0)+10.0);\n}\nfloat pnoise(vec3 P, vec3 rep)\n{\nvec3 Pi0 = mod(floor(P), rep);\nvec3 Pi1 = mod(Pi0 + vec3(1.0), rep);\nPi0 = mod289(Pi0);\nPi1 = mod289(Pi1);\nvec3 Pf0 = fract(P);\nvec3 Pf1 = Pf0 - vec3(1.0);\nvec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);\nvec4 iy = vec4(Pi0.yy, Pi1.yy);\nvec4 iz0 = Pi0.zzzz;\nvec4 iz1 = Pi1.zzzz;\nvec4 ixy = permute(permute(ix) + iy);\nvec4 ixy0 = permute(ixy + iz0);\nvec4 ixy1 = permute(ixy + iz1);\nvec4 gx0 = ixy0 * (1.0 / 7.0);\nvec4 gy0 = fract(floor(gx0) * (1.0 / 7.0)) - 0.5;\ngx0 = fract(gx0);\nvec4 gz0 = vec4(0.5) - abs(gx0) - abs(gy0);\nvec4 sz0 = step(gz0, vec4(0.0));\ngx0 -= sz0 * (step(0.0, gx0) - 0.5);\ngy0 -= sz0 * (step(0.0, gy0) - 0.5);\nvec4 gx1 = ixy1 * (1.0 / 7.0);\nvec4 gy1 = fract(floor(gx1) * (1.0 / 7.0)) - 0.5;\ngx1 = fract(gx1);\nvec4 gz1 = vec4(0.5) - abs(gx1) - abs(gy1);\nvec4 sz1 = step(gz1, vec4(0.0));\ngx1 -= sz1 * (step(0.0, gx1) - 0.5);\ngy1 -= sz1 * (step(0.0, gy1) - 0.5);\nvec3 g000 = vec3(gx0.x,gy0.x,gz0.x);\nvec3 g100 = vec3(gx0.y,gy0.y,gz0.y);\nvec3 g010 = vec3(gx0.z,gy0.z,gz0.z);\nvec3 g110 = vec3(gx0.w,gy0.w,gz0.w);\nvec3 g001 = vec3(gx1.x,gy1.x,gz1.x);\nvec3 g101 = vec3(gx1.y,gy1.y,gz1.y);\nvec3 g011 = vec3(gx1.z,gy1.z,gz1.z);\nvec3 g111 = vec3(gx1.w,gy1.w,gz1.w);\nvec4 norm0 = taylorInvSqrt(vec4(dot(g000, g000), dot(g010, g010), dot(g100, g100), dot(g110, g110)));\ng000 *= norm0.x;\ng010 *= norm0.y;\ng100 *= norm0.z;\ng110 *= norm0.w;\nvec4 norm1 = taylorInvSqrt(vec4(dot(g001, g001), dot(g011, g011), dot(g101, g101), dot(g111, g111)));\ng001 *= norm1.x;\ng011 *= norm1.y;\ng101 *= norm1.z;\ng111 *= norm1.w;\nfloat n000 = dot(g000, Pf0);\nfloat n100 = dot(g100, vec3(Pf1.x, Pf0.yz));\nfloat n010 = dot(g010, vec3(Pf0.x, Pf1.y, Pf0.z));\nfloat n110 = dot(g110, vec3(Pf1.xy, Pf0.z));\nfloat n001 = dot(g001, vec3(Pf0.xy, Pf1.z));\nfloat n101 = dot(g101, vec3(Pf1.x, Pf0.y, Pf1.z));\nfloat n011 = dot(g011, vec3(Pf0.x, Pf1.yz));\nfloat n111 = dot(g111, Pf1);\nvec3 fade_xyz = fade(Pf0);\nvec4 n_z = mix(vec4(n000, n100, n010, n110), vec4(n001, n101, n011, n111), fade_xyz.z);\nvec2 n_yz = mix(n_z.xy, n_z.zw, fade_xyz.y);\nfloat n_xyz = mix(n_yz.x, n_yz.y, fade_xyz.x);\nreturn 2.2 * n_xyz;\n}\nfloat snoise(vec3 v)\n{\nconst vec2  C = vec2(1.0/6.0, 1.0/3.0) ;\nconst vec4  D = vec4(0.0, 0.5, 1.0, 2.0);\nvec3 i  = floor(v + dot(v, C.yyy) );\nvec3 x0 =   v - i + dot(i, C.xxx) ;\nvec3 g = step(x0.yzx, x0.xyz);\nvec3 l = 1.0 - g;\nvec3 i1 = min( g.xyz, l.zxy );\nvec3 i2 = max( g.xyz, l.zxy );\nvec3 x1 = x0 - i1 + C.xxx;\nvec3 x2 = x0 - i2 + C.yyy;\nvec3 x3 = x0 - D.yyy;\ni = mod289(i);\nvec4 p = permute( permute( permute(\ni.z + vec4(0.0, i1.z, i2.z, 1.0 ))\n+ i.y + vec4(0.0, i1.y, i2.y, 1.0 ))\n+ i.x + vec4(0.0, i1.x, i2.x, 1.0 ));\nfloat n_ = 0.142857142857;\nvec3  ns = n_ * D.wyz - D.xzx;\nvec4 j = p - 49.0 * floor(p * ns.z * ns.z);\nvec4 x_ = floor(j * ns.z);\nvec4 y_ = floor(j - 7.0 * x_ );\nvec4 x = x_ *ns.x + ns.yyyy;\nvec4 y = y_ *ns.x + ns.yyyy;\nvec4 h = 1.0 - abs(x) - abs(y);\nvec4 b0 = vec4( x.xy, y.xy );\nvec4 b1 = vec4( x.zw, y.zw );\nvec4 s0 = floor(b0)*2.0 + 1.0;\nvec4 s1 = floor(b1)*2.0 + 1.0;\nvec4 sh = -step(h, vec4(0.0));\nvec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;\nvec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;\nvec3 p0 = vec3(a0.xy,h.x);\nvec3 p1 = vec3(a0.zw,h.y);\nvec3 p2 = vec3(a1.xy,h.z);\nvec3 p3 = vec3(a1.zw,h.w);\nvec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));\np0 *= norm.x;\np1 *= norm.y;\np2 *= norm.z;\np3 *= norm.w;\nvec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);\nm = m * m;\nreturn 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1),\ndot(p2,x2), dot(p3,x3) ) );\n}\nfloat grain(vec2 texCoord, vec2 resolution, float frame, float multiplier) {\nvec2 mult = texCoord * resolution;\nfloat offset = snoise(vec3(mult / multiplier, frame));\nfloat n1 = pnoise(vec3(mult, offset), vec3(1.0/texCoord * resolution, 1.0));\nreturn n1 / 2.0 + 0.5;\n}\nfloat grain(vec2 texCoord, vec2 resolution, float frame) {\nreturn grain(texCoord, resolution, frame, 2.5);\n}\nfloat grain(vec2 texCoord, vec2 resolution) {\nreturn grain(texCoord, resolution, 0.0);\n}\nvec3 blendSoftLight(vec3 base, vec3 blend) {\nreturn mix(\nsqrt(base) * (2.0 * blend - 1.0) + 2.0 * base * (1.0 - blend),\n2.0 * base * blend + base * base * (1.0 - 2.0 * blend),\nstep(base, vec3(0.5))\n);\n}\nvec4 vignette() {\nvec4 vignetteColor = vec4(0.0,0.0,0.0,0.0);\nvec2 q = vec2(v_textureCoordinates - 0.5);\nif (aspectCorrection) {\nq.x *= aspect;\n}\nq /= scale;\nq -= offset;\nfloat dst = length(q);\ndst = smoothstep(smoothRange.x, smoothRange.y, dst);\nvec3 color = mix(color1.rgb, color2.rgb, dst);\nif (noiseAlpha > 0.0 && grainScale > 0.0) {\nfloat gSize = 1.0 / grainScale;\nfloat g = grain(v_textureCoordinates, vec2(gSize * aspect, gSize), grainTime);\nvec3 noiseColor = blendSoftLight(color, vec3(g));\nvignetteColor.rgb = mix(color, noiseColor, noiseAlpha);\n} else {\nvignetteColor.rgb = color;\n}\nvignetteColor.a = 1.0;\nreturn vignetteColor;\n}\n#else\nuniform vec4 backgroundColor;\n#endif\nvoid main()\n{\nvec4 vignetteColor = vec4(0.0);\n#ifdef VIGNETTE\nvignetteColor = vignette();\n#else\nvignetteColor = backgroundColor;\n#endif\nvec4 color = texture2D(colorTexture, v_textureCoordinates);\nfloat depth = czm_readDepth(depthTexture, v_textureCoordinates);\nif(depth == 1.0 && length(color) == 1.0){\ncolor = vignetteColor;\n}\ngl_FragColor = color;\n}\n",kpe={};function Bpe(e){var t="#define USE_STEP_SIZE\n"+Epe,i=new hpe({name:e+"_x_direction",fragmentShader:t,uniforms:{delta:1,sigma:2,stepSize:1,direction:0},sampleMode:ipe.LINEAR}),n=new hpe({name:e+"_y_direction",fragmentShader:t,uniforms:{delta:1,sigma:2,stepSize:1,direction:1},sampleMode:ipe.LINEAR}),r={};return Object(O.a)(r,{delta:{get:function(){return i.uniforms.delta},set:function(e){var t=i.uniforms,r=n.uniforms;t.delta=r.delta=e}},sigma:{get:function(){return i.uniforms.sigma},set:function(e){var t=i.uniforms,r=n.uniforms;t.sigma=r.sigma=e}},stepSize:{get:function(){return i.uniforms.stepSize},set:function(e){var t=i.uniforms,r=n.uniforms;t.stepSize=r.stepSize=e}}}),new Mpe({name:e,stages:[i,n],uniforms:r})}kpe.createBlurStage=function(){return Bpe("czm_blur")},kpe.createDepthOfFieldStage=function(){var e=Bpe("czm_depth_of_field_blur"),t=new hpe({name:"czm_depth_of_field_composite",fragmentShader:bpe,uniforms:{focalDistance:5,blurTexture:e.name}}),i={};return Object(O.a)(i,{focalDistance:{get:function(){return t.uniforms.focalDistance},set:function(e){t.uniforms.focalDistance=e}},delta:{get:function(){return e.uniforms.delta},set:function(t){e.uniforms.delta=t}},sigma:{get:function(){return e.uniforms.sigma},set:function(t){e.uniforms.sigma=t}},stepSize:{get:function(){return e.uniforms.stepSize},set:function(t){e.uniforms.stepSize=t}}}),new Mpe({name:"czm_depth_of_field",stages:[e,t],inputPreviousStageTexture:!1,uniforms:i})},kpe.isDepthOfFieldSupported=function(e){return e.context.depthTexture},kpe.createEdgeDetectionStage=function(){var e=Mg();return new hpe({name:"czm_edge_detection_"+e,fragmentShader:wpe,uniforms:{length:.25,color:uf.clone(uf.BLACK)}})},kpe.isEdgeDetectionSupported=function(e){return e.context.depthTexture},kpe.createSilhouetteStage=function(e){var t=function(e){if(!Object(u.a)(e))return kpe.createEdgeDetectionStage();for(var t=new Mpe({name:"czm_edge_detection_multiple",stages:e,inputPreviousStageTexture:!1}),i={},n="",r="",a=0;a<e.length;++a)n+="uniform sampler2D edgeTexture"+a+"; \n",r+="        vec4 edge"+a+" = texture2D(edgeTexture"+a+", v_textureCoordinates); \n        if (edge"+a+".a > 0.0) \n        { \n            color = edge"+a+"; \n            break; \n        } \n",i["edgeTexture"+a]=e[a].name;var o=n+"varying vec2 v_textureCoordinates; \nvoid main() { \n    vec4 color = vec4(0.0); \n    for (int i = 0; i < "+e.length+"; i++) \n    { \n"+r+"    } \n    gl_FragColor = color; \n} \n",s=new hpe({name:"czm_edge_detection_combine",fragmentShader:o,uniforms:i});return new Mpe({name:"czm_edge_detection_composite",stages:[t,s]})}(e),i=new hpe({name:"czm_silhouette_color_edges",fragmentShader:Ppe,uniforms:{silhouetteTexture:t.name}});return new Mpe({name:"czm_silhouette",stages:[t,i],inputPreviousStageTexture:!1,uniforms:t.uniforms})},kpe.isSilhouetteSupported=function(e){return e.context.depthTexture},kpe.createBloomStage=function(){var e=new hpe({name:"czm_bloom_contrast_bias",fragmentShader:vpe,uniforms:{contrast:128,brightness:-.3}}),t=Bpe("czm_bloom_blur"),i=new Mpe({name:"czm_bloom_contrast_bias_blur",stages:[e,t]}),n=new hpe({name:"czm_bloom_generate_composite",fragmentShader:_pe,uniforms:{glowOnly:!1,bloomTexture:i.name}}),r={};return Object(O.a)(r,{glowOnly:{get:function(){return n.uniforms.glowOnly},set:function(e){n.uniforms.glowOnly=e}},contrast:{get:function(){return e.uniforms.contrast},set:function(t){e.uniforms.contrast=t}},brightness:{get:function(){return e.uniforms.brightness},set:function(t){e.uniforms.brightness=t}},delta:{get:function(){return t.uniforms.delta},set:function(e){t.uniforms.delta=e}},sigma:{get:function(){return t.uniforms.sigma},set:function(e){t.uniforms.sigma=e}},stepSize:{get:function(){return t.uniforms.stepSize},set:function(e){t.uniforms.stepSize=e}}}),new Mpe({name:"czm_bloom",stages:[i,n],inputPreviousStageTexture:!1,uniforms:r})},kpe.createAmbientOcclusionStage=function(){var e=new hpe({name:"czm_ambient_occlusion_generate",fragmentShader:fpe,uniforms:{intensity:3,bias:.1,lengthCap:.26,stepSize:1.95,frustumLength:1e3,randomTexture:void 0}}),t=Bpe("czm_ambient_occlusion_blur");t.uniforms.stepSize=.86;var i=new Mpe({name:"czm_ambient_occlusion_generate_blur",stages:[e,t]}),n=new hpe({name:"czm_ambient_occlusion_composite",fragmentShader:ppe,uniforms:{ambientOcclusionOnly:!1,ambientOcclusionTexture:i.name}}),r={};return Object(O.a)(r,{intensity:{get:function(){return e.uniforms.intensity},set:function(t){e.uniforms.intensity=t}},bias:{get:function(){return e.uniforms.bias},set:function(t){e.uniforms.bias=t}},lengthCap:{get:function(){return e.uniforms.lengthCap},set:function(t){e.uniforms.lengthCap=t}},stepSize:{get:function(){return e.uniforms.stepSize},set:function(t){e.uniforms.stepSize=t}},frustumLength:{get:function(){return e.uniforms.frustumLength},set:function(t){e.uniforms.frustumLength=t}},randomTexture:{get:function(){return e.uniforms.randomTexture},set:function(t){e.uniforms.randomTexture=t}},delta:{get:function(){return t.uniforms.delta},set:function(e){t.uniforms.delta=e}},sigma:{get:function(){return t.uniforms.sigma},set:function(e){t.uniforms.sigma=e}},blurStepSize:{get:function(){return t.uniforms.stepSize},set:function(e){t.uniforms.stepSize=e}},ambientOcclusionOnly:{get:function(){return n.uniforms.ambientOcclusionOnly},set:function(e){n.uniforms.ambientOcclusionOnly=e}}}),new Mpe({name:"czm_ambient_occlusion",stages:[i,n],inputPreviousStageTexture:!1,uniforms:r})},kpe.isAmbientOcclusionSupported=function(e){return e.context.depthTexture};var zpe="#define FXAA_QUALITY_PRESET 39 \n"+Dpe+"\n"+xpe;kpe.createFXAAStage=function(){return new hpe({name:"czm_FXAA",fragmentShader:zpe,sampleMode:ipe.LINEAR})},kpe.createAcesTonemappingStage=function(e){var t=e?"#define AUTO_EXPOSURE\n":"";return new hpe({name:"czm_aces",fragmentShader:t+=dpe,uniforms:{autoExposure:void 0}})},kpe.createFilmicTonemappingStage=function(e){var t=e?"#define AUTO_EXPOSURE\n":"";return new hpe({name:"czm_filmic",fragmentShader:t+=Ope,uniforms:{autoExposure:void 0}})},kpe.createReinhardTonemappingStage=function(e){var t=e?"#define AUTO_EXPOSURE\n":"";return new hpe({name:"czm_reinhard",fragmentShader:t+=Ape,uniforms:{autoExposure:void 0}})},kpe.createModifiedReinhardTonemappingStage=function(e){var t=e?"#define AUTO_EXPOSURE\n":"";return new hpe({name:"czm_modified_reinhard",fragmentShader:t+=Cpe,uniforms:{white:uf.WHITE,autoExposure:void 0}})},kpe.createAutoExposureStage=function(){return new Ore},kpe.createBlackAndWhiteStage=function(){return new hpe({name:"czm_black_and_white",fragmentShader:mpe,uniforms:{gradations:5}})},kpe.createBrightnessStage=function(){return new hpe({name:"czm_brightness",fragmentShader:gpe,uniforms:{brightness:.5}})},kpe.createNightVisionStage=function(){return new hpe({name:"czm_night_vision",fragmentShader:Spe})},kpe.createDepthViewStage=function(){return new hpe({name:"czm_depth_view",fragmentShader:ype})},kpe.createLensFlareStage=function(){return new hpe({name:"czm_lens_flare",fragmentShader:Tpe,uniforms:{dirtTexture:y("Assets/Textures/LensFlare/DirtMask.jpg"),starTexture:y("Assets/Textures/LensFlare/StarBurst.jpg"),intensity:2,distortion:10,ghostDispersal:.4,haloWidth:.4,earthRadius:ae.WGS84.maximumRadius}})},kpe.createColorCorrectionStage=function(){return new hpe({name:"czm_color_correction",fragmentShader:Ipe,uniforms:{powRGB:void 0,mulRGB:void 0,addRGB:void 0}})},kpe.createSnowStage=function(){return new hpe({name:"lunban_snow",fragmentShader:Rpe})},kpe.createRainStage=function(){return new hpe({name:"lunban_rain",fragmentShader:Lpe})},kpe.createSharpenStage=function(){return new hpe({name:"lunban_sharpen",fragmentShader:Npe,uniforms:{colorAmount:1,edgeAmount:.3}})},kpe.createBackgroundStage=function(e){var t,i=e.enableVignetteMode?"#define VIGNETTE\n":"";return i+=Fpe,t=e.enableVignetteMode?{aspectCorrection:!0,grainTime:0,noiseAlpha:.25,offset:new Rt(-.2,.25),scale:new Rt(2.5,2.5),smoothRange:new Rt(0,1),aspect:e.aspect,grainScale:e.grainScale,color1:e.color1,color2:e.color2}:{backgroundColor:e.backgroundColor},new hpe({name:"lunban_background",fragmentShader:i,uniforms:t})};var Upe=kpe;function Vpe(e){this._collection=e,this._framebuffers=[],this._stageNameToFramebuffer={},this._width=void 0,this._height=void 0,this._updateDependencies=!1}function Hpe(e){for(;Object(u.a)(e.length);)e=e.get(e.length-1);return e.name}function Gpe(e,t,i,n,r){if(!n.enabled||!n._isSupported(t))return r;var a=i[n.name]={};Object(u.a)(r)&&(a[Hpe(e.getStageByName(r))]=!0);var o=n.uniforms;if(Object(u.a)(o))for(var s=Object.getOwnPropertyNames(o),c=s.length,l=0;l<c;++l){var h=o[s[l]];if("string"==typeof h){var d=e.getStageByName(h);Object(u.a)(d)&&(a[Hpe(d)]=!0)}}return n.name}function qpe(e,t,i,n,r){if(Object(u.a)(n.enabled)&&!n.enabled||Object(u.a)(n._isSupported)&&!n._isSupported(t))return r;for(var a,o,s=r,c=!Object(u.a)(n.inputPreviousStageTexture)||n.inputPreviousStageTexture,l=r,h=n.length,d=0;d<h;++d){var f=n.get(d);l=Object(u.a)(f.length)?qpe(e,t,i,f,r):Gpe(e,t,i,f,r),c&&(r=l)}if(c)for(a=1;a<h;++a)o=Hpe(n.get(a)),Object(u.a)(i[o])||(i[o]={}),i[o][s]=!0;else for(a=1;a<h;++a)for(var p=i[o=Hpe(n.get(a))],m=0;m<a;++m)p[Hpe(n.get(m))]=!0;return l}function Wpe(e,t,i){var n,r=e._collection.getStageByName(t);return n={textureScale:r._textureScale,forcePowerOfTwo:r._forcePowerOfTwo,pixelFormat:r._pixelFormat,pixelDatatype:r._pixelDatatype,clearColor:r._clearColor,stages:[t],buffer:void 0,clear:void 0},e._framebuffers.push(n),n}function Ype(e,t){var i=function(e,t){var i={};if(Object(u.a)(e.ambientOcclusion)){var n=e.ambientOcclusion,r=e.bloom,a=e._tonemapping,o=e.fxaa,s=qpe(e,t,i,n,void 0);s=Gpe(e,t,i,a,s=qpe(e,t,i,r,s)),Gpe(e,t,i,o,s=qpe(e,t,i,e,s))}else qpe(e,t,i,e,void 0);return i}(e._collection,t);for(var n in i)i.hasOwnProperty(n)&&(e._stageNameToFramebuffer[n]=Wpe(e,n,i[n]))}function Xpe(e){for(var t=e._framebuffers,i=t.length,n=0;n<i;++n){var r=t[n];r.buffer=r.buffer&&r.buffer.destroy(),r.buffer=void 0}}Vpe.prototype.updateDependencies=function(){this._updateDependencies=!0},Vpe.prototype.update=function(e){var t=this._collection,i=this._updateDependencies,n=Object(u.a)(t.ambientOcclusion)&&t.ambientOcclusion.enabled&&t.ambientOcclusion._isSupported(e),r=Object(u.a)(t.bloom)&&t.bloom.enabled&&t.bloom._isSupported(e),a=Object(u.a)(t._tonemapping)&&t._tonemapping.enabled&&t._tonemapping._isSupported(e),o=Object(u.a)(t.fxaa)&&t.fxaa.enabled&&t.fxaa._isSupported(e),s=!Object(u.a)(t._activeStages)||t._activeStages.length>0||n||r||a||o;if((i||!s&&this._framebuffers.length>0)&&(Xpe(this),this._framebuffers.length=0,this._stageNameToFramebuffer={},this._width=void 0,this._height=void 0),i||s){0===this._framebuffers.length&&Ype(this,e);var c=e.drawingBufferWidth,l=e.drawingBufferHeight,h=this._width!==c||this._height!==l;(i||h)&&(this._width=c,this._height=l,this._updateDependencies=!1,Xpe(this),function(e,t){for(var i=e._width,n=e._height,r=e._framebuffers,a=r.length,o=0;o<a;++o){var s=r[o],c=s.textureScale,l=Math.ceil(i*c),u=Math.ceil(n*c),h=Math.min(l,u);s.forcePowerOfTwo&&(I.isPowerOfTwo(h)||(h=I.nextPowerOfTwo(h)),l=h,u=h),s.buffer=new cj({context:t,colorTextures:[new hj({context:t,width:l,height:u,pixelFormat:s.pixelFormat,pixelDatatype:s.pixelDatatype})]}),s.clear=new fX({color:s.clearColor,framebuffer:s.buffer})}}(this,e))}},Vpe.prototype.clear=function(e){for(var t=this._framebuffers,i=0;i<0;++i)t[i].clear.execute(e)},Vpe.prototype.getStageByName=function(e){return this._collection.getStageByName(e)},Vpe.prototype.getOutputTexture=function(e){return this._collection.getOutputTexture(e)},Vpe.prototype.getFramebuffer=function(e){var t=this._stageNameToFramebuffer[e];if(Object(u.a)(t))return t.buffer},Vpe.prototype.isDestroyed=function(){return!1},Vpe.prototype.destroy=function(){return Xpe(this),rl(this)};var Zpe=Vpe,Qpe={REINHARD:0,MODIFIED_REINHARD:1,FILMIC:2,ACES:3,validate:function(e){return e===Qpe.REINHARD||e===Qpe.MODIFIED_REINHARD||e===Qpe.FILMIC||e===Qpe.ACES}},Kpe=Object(E.a)(Qpe),Jpe=[];function $pe(){var e=Upe.createFXAAStage(),t=Upe.createAmbientOcclusionStage(),i=Upe.createBloomStage();this._autoExposureEnabled=!1,this._autoExposure=Upe.createAutoExposureStage(),this._tonemapping=void 0,this._tonemapper=void 0,this.tonemapper=Kpe.ACES;var n=this._tonemapping;t.enabled=!1,i.enabled=!1,n.enabled=!1;var r=new Zpe(this),a={},o=Jpe;for(o.push(e,t,i,n);o.length>0;){var s=o.pop();a[s.name]=s,s._textureCache=r;var c=s.length;if(Object(u.a)(c))for(var l=0;l<c;++l)o.push(s.get(l))}this._stages=[],this._activeStages=[],this._previousActiveStages=[],this._randomTexture=void 0,this._randomTextureResolution=1024;var h=this;t.uniforms.randomTexture=function(){return h._randomTexture},this._ao=t,this._bloom=i,this._fxaa=e,this._lastLength=void 0,this._aoEnabled=void 0,this._bloomEnabled=void 0,this._tonemappingEnabled=void 0,this._fxaaEnabled=void 0,this._stagesRemoved=!1,this._textureCacheDirty=!1,this._stageNames=a,this._textureCache=r}function eme(e){if(e._stagesRemoved){e._stagesRemoved=!1;for(var t=[],i=e._stages,n=i.length,r=0,a=0;r<n;++r){var o=i[r];o&&(o._index=a++,t.push(o))}e._stages=t}}function tme(e){for(;Object(u.a)(e.length);)e=e.get(e.length-1);return e.outputTexture}function ime(e,t,i,n,r){if(Object(u.a)(e.execute))e.execute(t,i,n,r);else{var a,o=e.length;if(e.inputPreviousStageTexture)for(ime(e.get(0),t,i,n,r),a=1;a<o;++a)ime(e.get(a),t,tme(e.get(a-1)),n,r);else for(a=0;a<o;++a)ime(e.get(a),t,i,n,r)}}Object(O.a)($pe.prototype,{ready:{get:function(){for(var e=!1,t=this._stages,i=t.length-1;i>=0;--i){var n=t[i];e=e||n.ready&&n.enabled}var r=this._fxaa,a=this._ao,o=this._bloom,s=this._tonemapping;return e=(e=(e=(e=e||r.ready&&r.enabled)||a.ready&&a.enabled)||o.ready&&o.enabled)||s.ready&&s.enabled}},fxaa:{get:function(){return this._fxaa}},ambientOcclusion:{get:function(){return this._ao}},bloom:{get:function(){return this._bloom}},length:{get:function(){return eme(this),this._stages.length}},outputTexture:{get:function(){var e=this._fxaa;if(e.enabled&&e.ready)return this.getOutputTexture(e.name);for(var t=this._stages,i=t.length-1;i>=0;--i){var n=t[i];if(Object(u.a)(n)&&n.ready&&n.enabled)return this.getOutputTexture(n.name)}var r=this._tonemapping;if(r.enabled&&r.ready)return this.getOutputTexture(r.name);var a=this._bloom;if(a.enabled&&a.ready)return this.getOutputTexture(a.name);var o=this._ao;return o.enabled&&o.ready?this.getOutputTexture(o.name):void 0}},hasSelected:{get:function(){for(var e=Li(this._stages);e.length>0;){var t=e.pop();if(Object(u.a)(t)){if(Object(u.a)(t.selected))return!0;var i=t.length;if(Object(u.a)(i))for(var n=0;n<i;++n)e.push(t.get(n))}}return!1}},tonemapper:{get:function(){return this._tonemapper},set:function(e){if(this._tonemapper!==e){if(!Kpe.validate(e))throw new h.a("tonemapper was set to an invalid value.");Object(u.a)(this._tonemapping)&&(delete this._stageNames[this._tonemapping.name],this._tonemapping.destroy());var t,i=this._autoExposureEnabled;switch(e){case Kpe.REINHARD:t=Upe.createReinhardTonemappingStage(i);break;case Kpe.MODIFIED_REINHARD:t=Upe.createModifiedReinhardTonemappingStage(i);break;case Kpe.FILMIC:t=Upe.createFilmicTonemappingStage(i);break;default:t=Upe.createAcesTonemappingStage(i)}if(i){var n=this._autoExposure;t.uniforms.autoExposure=function(){return n.outputTexture}}this._tonemapper=e,this._tonemapping=t,Object(u.a)(this._stageNames)&&(this._stageNames[t.name]=t,t._textureCache=this._textureCache),this._textureCacheDirty=!0}}}}),$pe.prototype.add=function(e){x.a.typeOf.object("stage",e);var t=this._stageNames,i=Jpe;for(i.push(e);i.length>0;){var n=i.pop();if(Object(u.a)(t[n.name]))throw new h.a(n.name+" has already been added to the collection or does not have a unique name.");t[n.name]=n,n._textureCache=this._textureCache;var r=n.length;if(Object(u.a)(r))for(var a=0;a<r;++a)i.push(n.get(a))}var o=this._stages;return e._index=o.length,o.push(e),this._textureCacheDirty=!0,e},$pe.prototype.remove=function(e){if(!this.contains(e))return!1;var t=this._stageNames,i=Jpe;for(i.push(e);i.length>0;){var n=i.pop();delete t[n.name];var r=n.length;if(Object(u.a)(r))for(var a=0;a<r;++a)i.push(n.get(a))}return this._stages[e._index]=void 0,this._stagesRemoved=!0,this._textureCacheDirty=!0,e._index=void 0,e._textureCache=void 0,e.destroy(),!0},$pe.prototype.contains=function(e){return Object(u.a)(e)&&Object(u.a)(e._index)&&e._textureCache===this._textureCache},$pe.prototype.get=function(e){eme(this);var t=this._stages,i=t.length;return x.a.typeOf.number.greaterThanOrEquals("stages length",i,0),x.a.typeOf.number.greaterThanOrEquals("index",e,0),x.a.typeOf.number.lessThan("index",e,i),t[e]},$pe.prototype.removeAll=function(){for(var e=this._stages,t=e.length,i=0;i<t;++i)this.remove(e[i]);e.length=0},$pe.prototype.getStageByName=function(e){return this._stageNames[e]},$pe.prototype.update=function(e,t,i){eme(this);var n=this._activeStages,r=this._activeStages=this._previousActiveStages;this._previousActiveStages=n;var a,o,s=this._stages,c=r.length=s.length,l=0;for(a=0;a<c;++a)(o=s[a]).ready&&o.enabled&&o._isSupported(e)&&(r[l++]=o);r.length=l;var h=l!==n.length;if(!h)for(a=0;a<l;++a)if(r[a]!==n[a]){h=!0;break}var d=this._ao,f=this._bloom,p=this._autoExposure,m=this._tonemapping,_=this._fxaa;m.enabled=i;var g=d.enabled&&d._isSupported(e),v=f.enabled&&f._isSupported(e),b=m.enabled&&m._isSupported(e),y=_.enabled&&_._isSupported(e);if((h||this._textureCacheDirty||l!==this._lastLength||g!==this._aoEnabled||v!==this._bloomEnabled||b!==this._tonemappingEnabled||y!==this._fxaaEnabled)&&(this._textureCache.updateDependencies(),this._lastLength=l,this._aoEnabled=g,this._bloomEnabled=v,this._tonemappingEnabled=b,this._fxaaEnabled=y,this._textureCacheDirty=!1),Object(u.a)(this._randomTexture)&&!g&&(this._randomTexture.destroy(),this._randomTexture=void 0),!Object(u.a)(this._randomTexture)&&g){var w=this._randomTextureResolution;c=w*w*3;var O=new Uint8Array(c);for(a=0;a<c;a+=3)O[a]=Math.floor(255*Math.random());this._randomTexture=new hj({context:e,pixelFormat:gx.RGB,pixelDatatype:mx.UNSIGNED_BYTE,source:{arrayBufferView:O,width:w,height:w},sampler:new tj({wrapS:$D.REPEAT,wrapT:$D.REPEAT,minificationFilter:KD.NEAREST,magnificationFilter:ZD.NEAREST})})}for(this._textureCache.update(e),_.update(e,t),d.update(e,t),f.update(e,t),m.update(e,t),this._autoExposureEnabled&&p.update(e,t),c=s.length,a=0;a<c;++a)s[a].update(e,t)},$pe.prototype.clear=function(e){this._textureCache.clear(e),this._autoExposureEnabled&&this._autoExposure.clear(e)},$pe.prototype.getOutputTexture=function(e){var t=this.getStageByName(e);if(Object(u.a)(t))return tme(t)},$pe.prototype.execute=function(e,t,i,n){var r=this._activeStages,a=r.length,o=this._fxaa,s=this._ao,c=this._bloom,l=this._autoExposure,u=this._tonemapping,h=s.enabled&&s._isSupported(e),d=c.enabled&&c._isSupported(e),f=this._autoExposureEnabled,p=u.enabled&&u._isSupported(e),m=o.enabled&&o._isSupported(e);if(m||h||d||p||0!==a){var _=t;h&&s.ready&&(ime(s,e,_,i,n),_=tme(s)),d&&c.ready&&(ime(c,e,_,i,n),_=tme(c)),f&&l.ready&&ime(l,e,_,i,n),p&&u.ready&&(ime(u,e,_,i,n),_=tme(u));var g=_;if(a>0){ime(r[0],e,_,i,n);for(var v=1;v<a;++v)ime(r[v],e,tme(r[v-1]),i,n);g=tme(r[a-1])}m&&o.ready&&ime(o,e,g,i,n)}},$pe.prototype.copy=function(e,t){if(!Object(u.a)(this._copyColorCommand)){var i=this;this._copyColorCommand=e.createViewportQuadCommand(Ade,{uniformMap:{colorTexture:function(){return i.outputTexture}},owner:this})}this._copyColorCommand.framebuffer=t,this._copyColorCommand.execute(e)},$pe.prototype.isDestroyed=function(){return!1},$pe.prototype.destroy=function(){return this._fxaa.destroy(),this._ao.destroy(),this._bloom.destroy(),this._autoExposure.destroy(),this._tonemapping.destroy(),this.removeAll(),this._textureCache=this._textureCache&&this._textureCache.destroy(),rl(this)};var nme=$pe;function rme(){h.a.throwInstantiationError()}rme.computeDefaultLevelZeroMaximumGeometricError=function(e){return 2*e.ellipsoid.maximumRadius*Math.PI*.25/(65*e.getNumberOfXTilesAtLevel(0))},Object(O.a)(rme.prototype,{quadtree:{get:h.a.throwInstantiationError,set:h.a.throwInstantiationError},ready:{get:h.a.throwInstantiationError},tilingScheme:{get:h.a.throwInstantiationError},errorEvent:{get:h.a.throwInstantiationError}}),rme.prototype.update=h.a.throwInstantiationError,rme.prototype.beginUpdate=h.a.throwInstantiationError,rme.prototype.endUpdate=h.a.throwInstantiationError,rme.prototype.getLevelMaximumGeometricError=h.a.throwInstantiationError,rme.prototype.loadTile=h.a.throwInstantiationError,rme.prototype.computeTileVisibility=h.a.throwInstantiationError,rme.prototype.showTileThisFrame=h.a.throwInstantiationError,rme.prototype.computeDistanceToTile=h.a.throwInstantiationError,rme.prototype.isDestroyed=h.a.throwInstantiationError,rme.prototype.destroy=h.a.throwInstantiationError;var ame=rme;function ome(e){x.a.typeOf.object("scene",e),this._scene=e,this._currentTweens=[],this._morphHandler=void 0,this._morphCancelled=!1,this._completeMorph=void 0,this._morphToOrthographic=!1}ome.prototype.completeMorph=function(){Object(u.a)(this._completeMorph)&&this._completeMorph()},ome.prototype.morphTo2D=function(e,t){Object(u.a)(this._completeMorph)&&this._completeMorph();var i=this._scene;this._previousMode=i.mode,this._morphToOrthographic=i.camera.frustum instanceof hb,this._previousMode!==xF.SCENE2D&&this._previousMode!==xF.MORPHING&&(this._scene.morphStart.raiseEvent(this,this._previousMode,xF.SCENE2D,!0),i._mode=xF.MORPHING,i.camera._setTransform(Be.IDENTITY),this._previousMode===xF.COLUMBUS_VIEW?function(e,t){t*=.5;var i=e._scene,n=i.camera,r=z.clone(n.position,Hme),a=z.clone(n.direction,Gme),o=z.clone(n.up,qme),s=z.negate(z.UNIT_Z,Yme),c=z.clone(z.UNIT_Y,Xme),l=Wme;if(t>0)z.clone(z.ZERO,Wme),l.z=5*i.mapProjection.ellipsoid.maximumRadius;else{z.clone(r,Wme);var h=Qme;Be.multiplyByPoint(ose.TRANSFORM_2D,r,h.origin),Be.multiplyByPointAsVector(ose.TRANSFORM_2D,a,h.direction);var d=i.globe;if(Object(u.a)(d)){var f=d.pickWorldCoordinates(h,i,Kme);Object(u.a)(f)&&(Be.multiplyByPoint(ose.TRANSFORM_2D_INVERSE,f,l),l.z+=z.distance(r,l))}}var p=Zme;p.right=.5*l.z,p.left=-p.right,p.top=p.right*(i.drawingBufferHeight/i.drawingBufferWidth),p.bottom=-p.top;var m=Jme;m.position=l,m.direction=s,m.up=c,m.frustum=p;var _=u_e(m);function g(e,t){e.position.z=t}wme(e,_);var v=i.tweens.add({duration:t,easingFunction:Pv.QUARTIC_OUT,startObject:{time:0},stopObject:{time:1},update:function(e){Ume(r,l,e.time,n.position),Ume(a,s,e.time,n.direction),Ume(o,c,e.time,n.up),z.cross(n.direction,n.up,n.right),z.normalize(n.right,n.right),n._adjustOrthographicFrustum(!0)},complete:function(){Vme(e,t,m,g,_)}});e._currentTweens.push(v)}(this,e):function(e,t,i){t*=.5;var n=e._scene,r=n.camera,a=e_e;if(t>0)z.clone(z.ZERO,a.position),a.position.z=5*i.maximumRadius,z.negate(z.UNIT_Z,a.direction),z.clone(z.UNIT_Y,a.up);else{i.cartesianToCartographic(r.positionWC,$me),n.mapProjection.project($me,a.position),z.negate(z.UNIT_Z,a.direction),z.clone(z.UNIT_Y,a.up);var o=n_e;z.clone(a.position2D,o.origin);var s=z.clone(r.directionWC,o.direction),c=i.scaleToGeodeticSurface(r.positionWC,a_e),l=xa.eastNorthUpToFixedFrame(c,i,r_e);Be.inverseTransformation(l,l),Be.multiplyByPointAsVector(l,s,s),Be.multiplyByPointAsVector(ose.TRANSFORM_2D,s,s);var h=n.globe;if(Object(u.a)(h)){var d=h.pickWorldCoordinates(o,n,i_e);if(Object(u.a)(d)){var f=z.distance(a.position2D,d);d.x+=f,z.clone(d,a.position2D)}}}function p(e,t){e.position.x=t}Be.multiplyByPoint(ose.TRANSFORM_2D,a.position,a.position2D),Be.multiplyByPointAsVector(ose.TRANSFORM_2D,a.direction,a.direction2D),Be.multiplyByPointAsVector(ose.TRANSFORM_2D,a.up,a.up2D);var m=a.frustum;m.right=.5*a.position.z,m.left=-m.right,m.top=m.right*(n.drawingBufferHeight/n.drawingBufferWidth),m.bottom=-m.top;var _=t_e;Be.multiplyByPoint(ose.TRANSFORM_2D_INVERSE,a.position2D,_.position),z.clone(a.direction,_.direction),z.clone(a.up,_.up),_.frustum=m;var g=u_e(_);wme(e,g),s_e(e,t,a,(function(){Vme(e,t,a,p,g)}))}(this,e,t),0===e&&Object(u.a)(this._completeMorph)&&this._completeMorph())};var sme=new z,cme=new z,lme=new z,ume=new z,hme=new z,dme=new z,fme=new z,pme=new K,mme=new Be,_me=new wb,gme=new hb,vme={position:void 0,direction:void 0,up:void 0,position2D:void 0,direction2D:void 0,up2D:void 0,frustum:void 0};ome.prototype.morphToColumbusView=function(e,t){Object(u.a)(this._completeMorph)&&this._completeMorph();var i=this._scene;if(this._previousMode=i.mode,this._previousMode!==xF.COLUMBUS_VIEW&&this._previousMode!==xF.MORPHING){this._scene.morphStart.raiseEvent(this,this._previousMode,xF.COLUMBUS_VIEW,!0),i.camera._setTransform(Be.IDENTITY);var n,r=sme,a=cme,o=lme;if(e>0)r.x=0,r.y=-1,r.z=1,r=z.multiplyByScalar(z.normalize(r,r),5*t.maximumRadius,r),z.negate(z.normalize(r,a),a),z.cross(z.UNIT_X,a,o);else{var s=i.camera;if(this._previousMode===xF.SCENE2D)z.clone(s.position,r),r.z=s.frustum.right-s.frustum.left,z.negate(z.UNIT_Z,a),z.clone(z.UNIT_Y,o);else{z.clone(s.positionWC,r),z.clone(s.directionWC,a),z.clone(s.upWC,o);var c=t.scaleToGeodeticSurface(r,fme),l=xa.eastNorthUpToFixedFrame(c,t,mme);Be.inverseTransformation(l,l),i.mapProjection.project(t.cartesianToCartographic(r,pme),r),Be.multiplyByPointAsVector(l,a,a),Be.multiplyByPointAsVector(l,o,o)}}this._morphToOrthographic?((n=gme).width=i.camera.frustum.right-i.camera.frustum.left,n.aspectRatio=i.drawingBufferWidth/i.drawingBufferHeight):((n=_me).aspectRatio=i.drawingBufferWidth/i.drawingBufferHeight,n.fov=I.toRadians(60));var h=vme;h.position=r,h.direction=a,h.up=o,h.frustum=n;var d=function(e){return function(t){var i=t._scene;i._mode=xF.COLUMBUS_VIEW,i.morphTime=xF.getMorphTime(xF.COLUMBUS_VIEW),Ome(t);var n=i.camera;(t._previousModeMode!==xF.MORPHING||t._morphCancelled)&&(t._morphCancelled=!1,z.clone(e.position,n.position),z.clone(e.direction,n.direction),z.clone(e.up,n.up),z.cross(n.direction,n.up,n.right),z.normalize(n.right,n.right));var r=n.frustum;i.frameState.useLogDepth&&(r.near=.1,r.far=1e10);var a=Object(u.a)(t._completeMorph);t._completeMorph=void 0,i.camera.update(i.mode),t._scene.morphComplete.raiseEvent(t,t._previousMode,xF.COLUMBUS_VIEW,a)}}(h);wme(this,d),this._previousMode===xF.SCENE2D?function(e,t,i,n){t*=.5;var r=e._scene,a=r.camera,o=z.clone(i.position,kme),s=z.clone(i.direction,Bme),c=z.clone(i.up,zme);function l(){a.frustum=i.frustum.clone();var l=z.clone(a.position,Lme),u=z.clone(a.direction,Nme),h=z.clone(a.up,Fme);l.z=o.z;var d=r.tweens.add({duration:t,easingFunction:Pv.QUARTIC_OUT,startObject:{time:0},stopObject:{time:1},update:function(e){Ume(l,o,e.time,a.position),Ume(u,s,e.time,a.direction),Ume(h,c,e.time,a.up),z.cross(a.direction,a.up,a.right),z.normalize(a.right,a.right)},complete:function(){n(e)}});e._currentTweens.push(d)}r._mode=xF.MORPHING,e._morphToOrthographic?l():o_e(e,0,i,l)}(this,e,h,d):(h.position2D=Be.multiplyByPoint(ose.TRANSFORM_2D,r,ume),h.direction2D=Be.multiplyByPointAsVector(ose.TRANSFORM_2D,a,hme),h.up2D=Be.multiplyByPointAsVector(ose.TRANSFORM_2D,o,dme),i._mode=xF.MORPHING,s_e(this,e,h,d)),0===e&&Object(u.a)(this._completeMorph)&&this._completeMorph()}};var bme={position:new z,direction:new z,up:new z,frustum:void 0},yme=new wb;function wme(e,t){if(e._scene.completeMorphOnUserInput){e._morphHandler=new aA(e._scene.canvas,!1);var i=function(){e._morphCancelled=!0,e._scene.camera.cancelFlight(),t(e)};e._completeMorph=i,e._morphHandler.setInputAction(i,TS.LEFT_DOWN),e._morphHandler.setInputAction(i,TS.MIDDLE_DOWN),e._morphHandler.setInputAction(i,TS.RIGHT_DOWN),e._morphHandler.setInputAction(i,TS.WHEEL)}}function Ome(e){for(var t=e._currentTweens,i=0;i<t.length;++i)t[i].cancelTween();e._currentTweens.length=0,e._morphHandler=e._morphHandler&&e._morphHandler.destroy()}ome.prototype.morphTo3D=function(e,t){Object(u.a)(this._completeMorph)&&this._completeMorph();var i=this._scene;if(this._previousMode=i.mode,this._previousMode!==xF.SCENE3D&&this._previousMode!==xF.MORPHING){if(this._scene.morphStart.raiseEvent(this,this._previousMode,xF.SCENE3D,!0),i._mode=xF.MORPHING,i.camera._setTransform(Be.IDENTITY),this._previousMode===xF.SCENE2D)!function(e,t,i){t/=3;var n,r,a=e._scene,o=a.camera;t>0?(n=bme,z.fromDegrees(0,0,5*i.maximumRadius,i,n.position),z.negate(n.position,n.direction),z.normalize(n.direction,n.direction),z.clone(z.UNIT_Z,n.up)):(o.position.z=o.frustum.right-o.frustum.left,n=Cme(e,i));e._morphToOrthographic?((r=Rme).aspectRatio=a.drawingBufferWidth/a.drawingBufferHeight,r.width=o.frustum.right-o.frustum.left):((r=yme).aspectRatio=a.drawingBufferWidth/a.drawingBufferHeight,r.fov=I.toRadians(60));n.frustum=r;var s,c=l_e(n);wme(e,c),s=e._morphToOrthographic?function(){Mme(e,t,n,c)}:function(){o_e(e,t,n,(function(){Mme(e,t,n,c)}))};t>0?(a._mode=xF.SCENE2D,o.flyTo({duration:t,destination:z.fromDegrees(0,0,5*i.maximumRadius,i,kme),complete:function(){a._mode=xF.MORPHING,s()}})):s()}(this,e,t);else{var n,r;e>0?(n=bme,z.fromDegrees(0,0,5*t.maximumRadius,t,n.position),z.negate(n.position,n.direction),z.normalize(n.direction,n.direction),z.clone(z.UNIT_Z,n.up)):n=Cme(this,t);var a=i.camera;a.frustum instanceof hb?r=a.frustum.clone():((r=yme).aspectRatio=i.drawingBufferWidth/i.drawingBufferHeight,r.fov=I.toRadians(60)),n.frustum=r;var o=l_e(n);wme(this,o),Mme(this,e,n,o)}0===e&&Object(u.a)(this._completeMorph)&&this._completeMorph()}},ome.prototype.isDestroyed=function(){return!1},ome.prototype.destroy=function(){return Ome(this),rl(this)};var xme=new K,Eme=new z,Tme=new Be;function Cme(e,t){var i=e._scene,n=i.camera,r=bme,a=r.position,o=r.direction,s=r.up,c=i.mapProjection.unproject(n.position,xme);t.cartographicToCartesian(c,a);var l=t.scaleToGeodeticSurface(a,Eme),u=xa.eastNorthUpToFixedFrame(l,t,Tme);return Be.multiplyByPointAsVector(u,n.direction,o),Be.multiplyByPointAsVector(u,n.up,s),r}var Sme=new z,Ame=new z,Pme=new z,Ime=new z,Dme=new z,jme=new z;function Mme(e,t,i,n){t*=.5;var r=e._scene,a=r.camera,o=z.clone(a.position,Sme),s=z.clone(a.direction,Ame),c=z.clone(a.up,Pme),l=Be.multiplyByPoint(ose.TRANSFORM_2D_INVERSE,i.position,Ime),u=Be.multiplyByPointAsVector(ose.TRANSFORM_2D_INVERSE,i.direction,Dme),h=Be.multiplyByPointAsVector(ose.TRANSFORM_2D_INVERSE,i.up,jme);var d=r.tweens.add({duration:t,easingFunction:Pv.QUARTIC_OUT,startObject:{time:0},stopObject:{time:1},update:function(e){Ume(o,l,e.time,a.position),Ume(s,u,e.time,a.direction),Ume(c,h,e.time,a.up),z.cross(a.direction,a.up,a.right),z.normalize(a.right,a.right)},complete:function(){c_e(e,r,0,1,t,n)}});e._currentTweens.push(d)}var Rme=new hb,Lme=new z,Nme=new z,Fme=new z,kme=new z,Bme=new z,zme=new z;function Ume(e,t,i,n){return z.lerp(e,t,i,n)}function Vme(e,t,i,n,r){var a=e._scene,o=a.camera;if(!(o.frustum instanceof hb)){var s=o.frustum.fov,c=.5*I.RADIANS_PER_DEGREE,l=i.position.z*Math.tan(.5*s);o.frustum.far=l/Math.tan(.5*c)+1e7;var u=a.tweens.add({duration:t,easingFunction:Pv.QUARTIC_OUT,startObject:{time:0},stopObject:{time:1},update:function(e){o.frustum.fov=I.lerp(s,c,e.time);var t=l/Math.tan(.5*o.frustum.fov);n(o,t)},complete:function(){o.frustum=i.frustum.clone(),r(e)}});e._currentTweens.push(u)}}var Hme=new z,Gme=new z,qme=new z,Wme=new z,Yme=new z,Xme=new z,Zme=new cb,Qme=new Ts,Kme=new z,Jme={position:void 0,direction:void 0,up:void 0,frustum:void 0};var $me=new K,e_e={position:new z,direction:new z,up:new z,position2D:new z,direction2D:new z,up2D:new z,frustum:new cb},t_e={position:new z,direction:new z,up:new z,frustum:void 0},i_e=new z,n_e=new Ts,r_e=new Be,a_e=new z;function o_e(e,t,i,n){var r=e._scene,a=r.camera,o=a.frustum.right-a.frustum.left;a.frustum=i.frustum.clone();var s=a.frustum.fov,c=.5*I.RADIANS_PER_DEGREE,l=o*Math.tan(.5*s);a.frustum.far=l/Math.tan(.5*c)+1e7,a.frustum.fov=c;var u=r.tweens.add({duration:t,easingFunction:Pv.QUARTIC_OUT,startObject:{time:0},stopObject:{time:1},update:function(e){a.frustum.fov=I.lerp(c,s,e.time),a.position.z=l/Math.tan(.5*a.frustum.fov)},complete:function(){n(e)}});e._currentTweens.push(u)}function s_e(e,t,i,n){var r=e._scene,a=r.camera,o=z.clone(a.position,Lme),s=z.clone(a.direction,Nme),c=z.clone(a.up,Fme),l=z.clone(i.position2D,kme),u=z.clone(i.direction2D,Bme),h=z.clone(i.up2D,zme);var d=r.tweens.add({duration:t,easingFunction:Pv.QUARTIC_OUT,startObject:{time:0},stopObject:{time:1},update:function(e){Ume(o,l,e.time,a.position),Ume(s,u,e.time,a.direction),Ume(c,h,e.time,a.up),z.cross(a.direction,a.up,a.right),z.normalize(a.right,a.right),a._adjustOrthographicFrustum(!0)},complete:function(){c_e(e,r,1,0,t,n)}});e._currentTweens.push(d)}function c_e(e,t,i,n,r,a){var o={object:t,property:"morphTime",startValue:i,stopValue:n,duration:r,easingFunction:Pv.QUARTIC_OUT};Object(u.a)(a)&&(o.complete=function(){a(e)});var s=t.tweens.addProperty(o);e._currentTweens.push(s)}function l_e(e){return function(t){var i=t._scene;i._mode=xF.SCENE3D,i.morphTime=xF.getMorphTime(xF.SCENE3D),Ome(t);var n=i.camera;(t._previousMode!==xF.MORPHING||t._morphCancelled)&&(t._morphCancelled=!1,z.clone(e.position,n.position),z.clone(e.direction,n.direction),z.clone(e.up,n.up),z.cross(n.direction,n.up,n.right),z.normalize(n.right,n.right),n.frustum=e.frustum.clone());var r=n.frustum;i.frameState.useLogDepth&&(r.near=.1,r.far=1e10);var a=Object(u.a)(t._completeMorph);t._completeMorph=void 0,i.camera.update(i.mode),t._scene.morphComplete.raiseEvent(t,t._previousMode,xF.SCENE3D,a)}}function u_e(e){return function(t){var i=t._scene;i._mode=xF.SCENE2D,i.morphTime=xF.getMorphTime(xF.SCENE2D),Ome(t);var n=i.camera;z.clone(e.position,n.position),n.position.z=2*i.mapProjection.ellipsoid.maximumRadius,z.clone(e.direction,n.direction),z.clone(e.up,n.up),z.cross(n.direction,n.up,n.right),z.normalize(n.right,n.right),n.frustum=e.frustum.clone();var r=Object(u.a)(t._completeMorph);t._completeMorph=void 0,i.camera.update(i.mode),t._scene.morphComplete.raiseEvent(t,t._previousMode,xF.SCENE2D,r)}}var h_e=ome;function d_e(e,t,i,n,r,a,o,s,c,l){this._tweens=e,this._tweenjs=t,this._startObject=Object(nf.a)(i),this._stopObject=Object(nf.a)(n),this._duration=r,this._delay=a,this._easingFunction=o,this._update=s,this._complete=c,this.cancel=l,this.needsStart=!0}function f_e(){this._tweens=[]}Object(O.a)(d_e.prototype,{startObject:{get:function(){return this._startObject}},stopObject:{get:function(){return this._stopObject}},duration:{get:function(){return this._duration}},delay:{get:function(){return this._delay}},easingFunction:{get:function(){return this._easingFunction}},update:{get:function(){return this._update}},complete:{get:function(){return this._complete}},tweenjs:{get:function(){return this._tweenjs}}}),d_e.prototype.cancelTween=function(){this._tweens.remove(this)},Object(O.a)(f_e.prototype,{length:{get:function(){return this._tweens.length}}}),f_e.prototype.add=function(e){if(e=Object(w.a)(e,w.a.EMPTY_OBJECT),!Object(u.a)(e.startObject)||!Object(u.a)(e.stopObject))throw new h.a("options.startObject and options.stopObject are required.");if(!Object(u.a)(e.duration)||e.duration<0)throw new h.a("options.duration is required and must be positive.");if(0===e.duration)return Object(u.a)(e.complete)&&e.complete(),new d_e(this);var t=e.duration/nr.SECONDS_PER_MILLISECOND,i=Object(w.a)(e.delay,0),n=i/nr.SECONDS_PER_MILLISECOND,r=Object(w.a)(e.easingFunction,Pv.LINEAR_NONE),a=e.startObject,o=new Sv.Tween(a);o.to(Object(nf.a)(e.stopObject),t),o.delay(n),o.easing(r),Object(u.a)(e.update)&&o.onUpdate((function(){e.update(a)})),o.onComplete(Object(w.a)(e.complete,null)),o.repeat(Object(w.a)(e._repeat,0));var s=new d_e(this,o,e.startObject,e.stopObject,e.duration,i,r,e.update,e.complete,e.cancel);return this._tweens.push(s),s},f_e.prototype.addProperty=function(e){var t=(e=Object(w.a)(e,w.a.EMPTY_OBJECT)).object,i=e.property,n=e.startValue,r=e.stopValue;if(!Object(u.a)(t)||!Object(u.a)(e.property))throw new h.a("options.object and options.property are required.");if(!Object(u.a)(t[i]))throw new h.a("options.object must have the specified property.");if(!Object(u.a)(n)||!Object(u.a)(r))throw new h.a("options.startValue and options.stopValue are required.");return this.add({startObject:{value:n},stopObject:{value:r},duration:Object(w.a)(e.duration,3),delay:e.delay,easingFunction:e.easingFunction,update:function(e){t[i]=e.value},complete:e.complete,cancel:e.cancel,_repeat:e._repeat})},f_e.prototype.addAlpha=function(e){var t=(e=Object(w.a)(e,w.a.EMPTY_OBJECT)).material;if(!Object(u.a)(t))throw new h.a("options.material is required.");var i=[];for(var n in t.uniforms)t.uniforms.hasOwnProperty(n)&&Object(u.a)(t.uniforms[n])&&Object(u.a)(t.uniforms[n].alpha)&&i.push(n);if(0===i.length)throw new h.a("material has no properties with alpha components.");return this.add({startObject:{alpha:Object(w.a)(e.startValue,0)},stopObject:{alpha:Object(w.a)(e.stopValue,1)},duration:Object(w.a)(e.duration,3),delay:e.delay,easingFunction:e.easingFunction,update:function(e){for(var n=i.length,r=0;r<n;++r)t.uniforms[i[r]].alpha=e.alpha},complete:e.complete,cancel:e.cancel})},f_e.prototype.addOffsetIncrement=function(e){var t=(e=Object(w.a)(e,w.a.EMPTY_OBJECT)).material;if(!Object(u.a)(t))throw new h.a("material is required.");if(!Object(u.a)(t.uniforms.offset))throw new h.a("material.uniforms must have an offset property.");var i=t.uniforms;return this.addProperty({object:i,property:"offset",startValue:i.offset,stopValue:i.offset+1,duration:e.duration,delay:e.delay,easingFunction:e.easingFunction,update:e.update,cancel:e.cancel,_repeat:1/0})},f_e.prototype.remove=function(e){if(!Object(u.a)(e))return!1;var t=this._tweens.indexOf(e);return-1!==t&&(e.tweenjs.stop(),Object(u.a)(e.cancel)&&e.cancel(),this._tweens.splice(t,1),!0)},f_e.prototype.removeAll=function(){for(var e=this._tweens,t=0;t<e.length;++t){var i=e[t];i.tweenjs.stop(),Object(u.a)(i.cancel)&&i.cancel()}e.length=0},f_e.prototype.contains=function(e){return Object(u.a)(e)&&-1!==this._tweens.indexOf(e)},f_e.prototype.get=function(e){if(!Object(u.a)(e))throw new h.a("index is required.");return this._tweens[e]},f_e.prototype.update=function(e){var t=this._tweens,i=0;for(e=Object(u.a)(e)?e/nr.SECONDS_PER_MILLISECOND:Qd();i<t.length;){var n=t[i],r=n.tweenjs;n.needsStart?(n.needsStart=!1,r.start(e)):r.update(e)?i++:(r.stop(),t.splice(i,1))}};var p_e=f_e;function m_e(e){if(!Object(u.a)(e))throw new h.a("scene is required.");this.enableInputs=!0,this.enableTranslate=!0,this.enableZoom=!0,this.enableRotate=!0,this.enableTilt=!0,this.enableLook=!0,this.inertiaSpin=.9,this.inertiaTranslate=.9,this.inertiaZoom=.8,this.maximumMovementRatio=.1,this.bounceAnimationTime=3,this.minimumZoomDistance=1,this.maximumZoomDistance=Number.POSITIVE_INFINITY,this.translateEventTypes=sse.LEFT_DRAG,this.zoomEventTypes=[sse.RIGHT_DRAG,sse.WHEEL,sse.PINCH],this.rotateEventTypes=sse.LEFT_DRAG,this.tiltEventTypes=[sse.MIDDLE_DRAG,sse.PINCH,{eventType:sse.LEFT_DRAG,modifier:rx.CTRL},{eventType:sse.RIGHT_DRAG,modifier:rx.CTRL}],this.lookEventTypes={eventType:sse.LEFT_DRAG,modifier:rx.SHIFT},this.minimumPickingTerrainHeight=15e4,this._minimumPickingTerrainHeight=this.minimumPickingTerrainHeight,this.minimumCollisionTerrainHeight=15e3,this._minimumCollisionTerrainHeight=this.minimumCollisionTerrainHeight,this.minimumTrackBallHeight=75e5,this._minimumTrackBallHeight=this.minimumTrackBallHeight,this.enableCollisionDetection=!0,this._scene=e,this._globe=void 0,this._ellipsoid=void 0,this._aggregator=new mse(e.canvas),this._lastInertiaSpinMovement=void 0,this._lastInertiaZoomMovement=void 0,this._lastInertiaTranslateMovement=void 0,this._lastInertiaTiltMovement=void 0,this._tweens=new p_e,this._tween=void 0,this._horizontalRotationAxis=void 0,this._tiltCenterMousePosition=new Rt(-1,-1),this._tiltCenter=new z,this._rotateMousePosition=new Rt(-1,-1),this._rotateStartPosition=new z,this._strafeStartPosition=new z,this._zoomMouseStart=new Rt(-1,-1),this._zoomWorldPosition=new z,this._useZoomWorldPosition=!1,this._tiltCVOffMap=!1,this._looking=!1,this._rotating=!1,this._strafing=!1,this._zoomingOnVector=!1,this._rotatingZoom=!1;var t=e.mapProjection;this._maxCoord=t.project(new K(Math.PI,I.PI_OVER_TWO)),this._zoomFactor=5,this._rotateFactor=void 0,this._rotateRateRangeAdjustment=void 0,this._maximumRotateRate=1.77,this._minimumRotateRate=2e-4,this._minimumZoomRate=20,this._maximumZoomRate=5906376272e3}var __e=.4;function g_e(e,t,i,n,r,a,o){var s=a[o];Object(u.a)(s)||(s=a[o]={startPosition:new Rt,endPosition:new Rt,motion:new Rt,active:!1});var c,l=e.getButtonPressTime(t,i),h=e.getButtonReleaseTime(t,i),d=l&&h&&(h.getTime()-l.getTime())/1e3,f=new Date,p=h&&(f.getTime()-h.getTime())/1e3;if(l&&h&&d<__e){var m=function(e,t){if(e<0)return 0;var i=25*(1-t);return Math.exp(-i*e)}(p,n);if(s.active)s.startPosition=Rt.clone(s.endPosition,s.startPosition),s.endPosition=Rt.multiplyByScalar(s.motion,m,s.endPosition),s.endPosition=Rt.add(s.startPosition,s.endPosition,s.endPosition),s.motion=Rt.clone(Rt.ZERO,s.motion);else{var _=e.getLastMovement(t,i);if(!Object(u.a)(_)||(c=_,Rt.equalsEpsilon(c.startPosition,c.endPosition,I.EPSILON14)))return;s.motion.x=.5*(_.endPosition.x-_.startPosition.x),s.motion.y=.5*(_.endPosition.y-_.startPosition.y),s.startPosition=Rt.clone(_.startPosition,s.startPosition),s.endPosition=Rt.multiplyByScalar(s.motion,m,s.endPosition),s.endPosition=Rt.add(s.startPosition,s.endPosition,s.endPosition),s.active=!0}if(isNaN(s.endPosition.x)||isNaN(s.endPosition.y)||Rt.distance(s.startPosition,s.endPosition)<.5)return void(s.active=!1);if(!e.isButtonDown(t,i))r(a,e.getStartMousePosition(t,i),s)}else s.active=!1}var v_e=[];function b_e(e,t,i,n,r,a){if(Object(u.a)(i)){var o=e._aggregator;Object(ym.a)(i)||(v_e[0]=i,i=v_e);for(var s=i.length,c=0;c<s;++c){var l=i[c],h=Object(u.a)(l.eventType)?l.eventType:l,d=l.modifier,f=o.isMoving(h,d)&&o.getMovement(h,d),p=o.getStartMousePosition(h,d);e.enableInputs&&t&&(f?n(e,p,f):r<1&&g_e(o,h,d,r,n,e,a))}}}var y_e=new Ts,w_e=new z,O_e=new Rt,x_e=new z,E_e=new Rt,T_e=new z,C_e=new z,S_e=new z,A_e=new z,P_e=new z,I_e=new z,D_e=new z,j_e=new z,M_e=new z,R_e=new z,L_e=new z,N_e=new z,F_e=new z,k_e=new z,B_e=new z,z_e=new z,U_e=new z,V_e=new z,H_e={orientation:new Rr};function G_e(e,t,i,n,r,a){var o=1;Object(u.a)(a)&&(o=I.clamp(Math.abs(a),.25,1));var s=e.minimumZoomDistance*o,c=e.maximumZoomDistance,l=n*(r-s);l=I.clamp(l,e._minimumZoomRate,e._maximumZoomRate);var h=(i.endPosition.y-i.startPosition.y)/e._scene.canvas.clientHeight,d=l*(h=Math.min(h,e.maximumMovementRatio));if(!(d>0&&Math.abs(r-s)<1||d<0&&Math.abs(r-c)<1)){r-d<s?d=r-s-1:r-d>c&&(d=r-c);var f=e._scene,p=f.camera,m=f.mode,_=H_e.orientation;if(_.heading=p.heading,_.pitch=p.pitch,_.roll=p.roll,p.frustum instanceof hb)Math.abs(d)>0&&(p.zoomIn(d),p._adjustOrthographicFrustum());else{var g,v=Rt.equals(t,e._zoomMouseStart),b=e._zoomingOnVector,y=e._rotatingZoom;if(v||(e._zoomMouseStart=Rt.clone(t,e._zoomMouseStart),Object(u.a)(e._globe)&&(m===xF.SCENE2D?(g=p.getPickRay(t,y_e).origin,g=z.fromElements(g.y,g.z,g.x)):g=ige(e,t,w_e)),Object(u.a)(g)?(e._useZoomWorldPosition=!0,e._zoomWorldPosition=z.clone(g,e._zoomWorldPosition)):e._useZoomWorldPosition=!1,b=e._zoomingOnVector=!1,y=e._rotatingZoom=!1),e._useZoomWorldPosition){var w=m===xF.COLUMBUS_VIEW;if(p.positionCartographic.height<2e6&&(y=!0),!v||y){if(m===xF.SCENE2D){var O=e._zoomWorldPosition,x=p.position;if(!z.equals(O,x)&&p.positionCartographic.height<2*e._maxCoord.x){var E=p.position.x,T=z.subtract(O,x,x_e);z.normalize(T,T);var C=z.distance(O,x)*d/(.5*p.getMagnitude());p.move(T,.5*C),(p.position.x<0&&E>0||p.position.x>0&&E<0)&&(g=p.getPickRay(t,y_e).origin,g=z.fromElements(g.y,g.z,g.x),e._zoomWorldPosition=z.clone(g,e._zoomWorldPosition))}}else if(m===xF.SCENE3D){var S=z.normalize(p.position,P_e);if(p.positionCartographic.height<3e3&&Math.abs(z.dot(p.direction,S))<.6)w=!0;else{var A=f.canvas,P=E_e;P.x=A.clientWidth/2,P.y=A.clientHeight/2;var D=ige(e,P,T_e);if(Object(u.a)(D)&&p.positionCartographic.height<1e6){var j=D_e;z.clone(p.position,j);var M=e._zoomWorldPosition,R=I_e;if(R=z.normalize(M,R),z.dot(R,S)<0)return;var L=B_e,N=R_e;z.clone(p.direction,N),z.add(j,z.multiplyByScalar(N,1e3,z_e),L);var F=L_e,k=N_e;z.subtract(M,j,F),z.normalize(F,k);var B=z.dot(S,k);if(B>=0)return void(e._zoomMouseStart.x=-1);var U=Math.acos(-B),V=z.magnitude(j),H=z.magnitude(M),G=V-d,q=z.magnitude(F),W=Math.asin(I.clamp(q/H*Math.sin(U),-1,1))-Math.asin(I.clamp(G/H*Math.sin(U),-1,1))+U,Y=j_e;z.normalize(j,Y);var X=M_e;X=z.cross(k,Y,X),X=z.normalize(X,X),z.normalize(z.cross(Y,X,z_e),N),z.multiplyByScalar(z.normalize(L,z_e),z.magnitude(L)-d,L),z.normalize(j,j),z.multiplyByScalar(j,G,j);var Z=F_e;z.multiplyByScalar(z.add(z.multiplyByScalar(Y,Math.cos(W)-1,U_e),z.multiplyByScalar(N,Math.sin(W),V_e),z_e),G,Z),z.add(j,Z,j),z.normalize(L,Y),z.normalize(z.cross(Y,X,z_e),N);var Q=k_e;return z.multiplyByScalar(z.add(z.multiplyByScalar(Y,Math.cos(W)-1,U_e),z.multiplyByScalar(N,Math.sin(W),V_e),z_e),z.magnitude(L),Q),z.add(L,Q,L),z.clone(j,p.position),z.normalize(z.subtract(L,j,z_e),p.direction),z.clone(p.direction,p.direction),z.cross(p.direction,p.up,p.right),z.cross(p.right,p.direction,p.up),void p.setView(H_e)}if(Object(u.a)(D)){var K=z.normalize(D,C_e),J=z.normalize(e._zoomWorldPosition,S_e),$=z.dot(J,K);if($>0&&$<1){var ee=I.acosClamped($),te=z.cross(J,K,A_e),ie=d/(Math.abs(ee)>I.toRadians(20)?.75*p.positionCartographic.height:p.positionCartographic.height-d);p.rotate(te,ee*ie)}}else w=!0}}e._rotatingZoom=!w}if(!v&&w||b){var ne=gV.wgs84ToWindowCoordinates(f,e._zoomWorldPosition,O_e),re=(m!==xF.COLUMBUS_VIEW&&Rt.equals(t,e._zoomMouseStart)&&Object(u.a)(ne)?p.getPickRay(ne,y_e):p.getPickRay(t,y_e)).direction;m!==xF.COLUMBUS_VIEW&&m!==xF.SCENE2D||z.fromElements(re.y,re.z,re.x,re),p.move(re,d),e._zoomingOnVector=!0}else p.zoomIn(d);p.setView(H_e)}else p.zoomIn(d)}}}var q_e=new Ts,W_e=new Ts,Y_e=new z;function X_e(e,t,i){var n=e._scene.camera,r=n.getPickRay(i.startPosition,q_e).origin,a=n.getPickRay(i.endPosition,W_e).origin;r=z.fromElements(r.y,r.z,r.x,r),a=z.fromElements(a.y,a.z,a.x,a);var o=z.subtract(r,a,Y_e),s=z.magnitude(o);s>0&&(z.normalize(o,o),n.move(o,s))}function Z_e(e,t,i){Object(u.a)(i.distance)&&(i=i.distance);var n=e._scene.camera;G_e(e,t,i,e._zoomFactor,n.getMagnitude())}var Q_e=new Rt,K_e=new Rt;function J_e(e,t,i){if(Object(u.a)(i.angleAndHeight))!function(e,t,i){var n=e._rotateFactor*e._rotateRateRangeAdjustment;n>e._maximumRotateRate&&(n=e._maximumRotateRate);n<e._minimumRotateRate&&(n=e._minimumRotateRate);var r=e._scene,a=r.camera,o=r.canvas,s=(i.endPosition.x-i.startPosition.x)/o.clientWidth;s=Math.min(s,e.maximumMovementRatio);var c=n*s*Math.PI*4;a.twistRight(c)}(e,0,i.angleAndHeight);else{var n=e._scene,r=n.camera,a=n.canvas,o=a.clientWidth,s=a.clientHeight,c=Q_e;c.x=2/o*i.startPosition.x-1,c.y=2/s*(s-i.startPosition.y)-1,c=Rt.normalize(c,c);var l=K_e;l.x=2/o*i.endPosition.x-1,l.y=2/s*(s-i.endPosition.y)-1,l=Rt.normalize(l,l);var h=I.acosClamped(c.x);c.y<0&&(h=I.TWO_PI-h);var d=I.acosClamped(l.x);l.y<0&&(d=I.TWO_PI-d);var f=d-h;r.twistRight(f)}}var $_e=new Ts,ege=new z,tge=new z;function ige(e,t,i){var n=e._scene,r=e._globe,a=n.camera;if(Object(u.a)(r)){var o;n.pickPositionSupported&&(o=n.pickPositionWorldCoordinates(t,ege));var s=a.getPickRay(t,$_e),c=r.pickWorldCoordinates(s,n,tge);return(Object(u.a)(o)?z.distance(o,a.positionWC):Number.POSITIVE_INFINITY)<(Object(u.a)(c)?z.distance(c,a.positionWC):Number.POSITIVE_INFINITY)?z.clone(o,i):z.clone(c,i)}}var nge=new Ts,rge=new Ts,age=new z,oge=new z,sge=new z,cge=new z,lge=new oc(z.UNIT_X,0),uge=new Rt,hge=new Rt;function dge(e,t,i){if(z.equals(t,e._translateMousePosition)||(e._looking=!1),z.equals(t,e._strafeMousePosition)||(e._strafing=!1),e._looking)Ove(e,t,i);else if(e._strafing)Fge(e,t,i);else{var n,r=e._scene.camera,a=Rt.clone(i.startPosition,uge),o=Rt.clone(i.endPosition,hge),s=r.getPickRay(a,nge),c=z.clone(z.ZERO,cge),l=z.UNIT_X;if(r.position.z<e._minimumPickingTerrainHeight&&(n=ige(e,a,age),Object(u.a)(n)&&(c.x=n.x)),c.x>r.position.z&&Object(u.a)(n))return z.clone(n,e._strafeStartPosition),e._strafing=!0,Fge(e,t,i),void(e._strafeMousePosition=Rt.clone(t,e._strafeMousePosition));var h=oc.fromPointNormal(c,l,lge);s=r.getPickRay(a,nge);var d=tc.rayPlane(s,h,age),f=r.getPickRay(o,rge),p=tc.rayPlane(f,h,oge);if(!Object(u.a)(d)||!Object(u.a)(p))return e._looking=!0,Ove(e,t,i),void Rt.clone(t,e._translateMousePosition);var m=z.subtract(d,p,sge),_=m.x;m.x=m.y,m.y=m.z,m.z=_;var g=z.magnitude(m);g>I.EPSILON6&&(z.normalize(m,m),r.move(m,g))}}var fge=new Rt,pge=new Ts,mge=new z,_ge=new z,gge=new Be,vge=new Be,bge=new z,yge=new oc(z.UNIT_X,0),wge=new z,Oge=new K,xge=new Be,Ege=new Kn,Tge=new be,Cge=new z;function Sge(e,t,i){if(Object(u.a)(i.angleAndHeight)&&(i=i.angleAndHeight),Rt.equals(t,e._tiltCenterMousePosition)||(e._tiltCVOffMap=!1,e._looking=!1),e._looking)Ove(e,t,i);else{var n=e._scene.camera,r=e._maxCoord,a=Math.abs(n.position.x)-r.x<0&&Math.abs(n.position.y)-r.y<0;e._tiltCVOffMap||!a||n.position.z>e._minimumPickingTerrainHeight?(e._tiltCVOffMap=!0,function(e,t,i){var n=e._scene,r=n.camera,a=n.canvas,o=fge;o.x=a.clientWidth/2,o.y=a.clientHeight/2;var s,c=r.getPickRay(o,pge),l=z.UNIT_X,h=c.origin,d=c.direction,f=z.dot(l,d);Math.abs(f)>I.EPSILON6&&(s=-z.dot(l,h)/f);if(!Object(u.a)(s)||s<=0)return e._looking=!0,Ove(e,t,i),void Rt.clone(t,e._tiltCenterMousePosition);var p=z.multiplyByScalar(d,s,mge);z.add(h,p,p);var m=n.mapProjection,_=m.ellipsoid;z.fromElements(p.y,p.z,p.x,p);var g=m.unproject(p,Oge);_.cartographicToCartesian(g,p);var v=xa.eastNorthUpToFixedFrame(p,_,gge),b=e._globe,y=e._ellipsoid;e._globe=void 0,e._ellipsoid=ae.UNIT_SPHERE,e._rotateFactor=1,e._rotateRateRangeAdjustment=1;var w=Be.clone(r.transform,xge);r._setTransform(v),Gge(e,t,i,z.UNIT_Z),r._setTransform(w),e._globe=b,e._ellipsoid=y;var O=y.maximumRadius;e._rotateFactor=1/O,e._rotateRateRangeAdjustment=O}(e,t,i)):function(e,t,i){var n,r,a=e._scene,o=a.camera,s=z.UNIT_X;if(Rt.equals(t,e._tiltCenterMousePosition))n=z.clone(e._tiltCenter,mge);else{if(o.position.z<e._minimumPickingTerrainHeight&&(n=ige(e,t,mge)),!Object(u.a)(n)){var c,l=(r=o.getPickRay(t,pge)).origin,h=r.direction,d=z.dot(s,h);if(Math.abs(d)>I.EPSILON6&&(c=-z.dot(s,l)/d),!Object(u.a)(c)||c<=0)return e._looking=!0,Ove(e,t,i),void Rt.clone(t,e._tiltCenterMousePosition);n=z.multiplyByScalar(h,c,mge),z.add(l,n,n)}Rt.clone(t,e._tiltCenterMousePosition),z.clone(n,e._tiltCenter)}var f=a.canvas,p=fge;p.x=f.clientWidth/2,p.y=e._tiltCenterMousePosition.y,r=o.getPickRay(p,pge);var m=z.clone(z.ZERO,bge);m.x=n.x;var _=oc.fromPointNormal(m,s,yge),g=tc.rayPlane(r,_,_ge),v=o._projection,b=v.ellipsoid;z.fromElements(n.y,n.z,n.x,n);var y=v.unproject(n,Oge);b.cartographicToCartesian(y,n);var w,O=xa.eastNorthUpToFixedFrame(n,b,gge);Object(u.a)(g)?(z.fromElements(g.y,g.z,g.x,g),y=v.unproject(g,Oge),b.cartographicToCartesian(y,g),w=xa.eastNorthUpToFixedFrame(g,b,vge)):w=O;var x=e._globe,E=e._ellipsoid;e._globe=void 0,e._ellipsoid=ae.UNIT_SPHERE,e._rotateFactor=1,e._rotateRateRangeAdjustment=1;var T=z.UNIT_Z,C=Be.clone(o.transform,xge);o._setTransform(O);var S=z.cross(z.UNIT_Z,z.normalize(o.position,wge),wge),A=z.dot(o.right,S);if(Gge(e,t,i,T,!1,!0),o._setTransform(w),A<0){i.startPosition.y>i.endPosition.y&&(T=void 0);var P=o.constrainedAxis;o.constrainedAxis=void 0,Gge(e,t,i,T,!0,!1),o.constrainedAxis=P}else Gge(e,t,i,T,!0,!1);if(Object(u.a)(o.constrainedAxis)){var D=z.cross(o.direction,o.constrainedAxis,Cge);z.equalsEpsilon(D,z.ZERO,I.EPSILON6)||(z.dot(D,o.right)<0&&z.negate(D,D),z.cross(D,o.direction,o.up),z.cross(o.direction,o.up,o.right),z.normalize(o.up,o.up),z.normalize(o.right,o.right))}o._setTransform(C),e._globe=x,e._ellipsoid=E;var j=E.maximumRadius;e._rotateFactor=1/j,e._rotateRateRangeAdjustment=j;var M=z.clone(o.positionWC,wge);if(o._adjustHeightForTerrain(),!z.equals(o.positionWC,M)){o._setTransform(w),o.worldToCameraCoordinatesPoint(M,M);var R=z.magnitudeSquared(M);z.magnitudeSquared(o.position)>R&&(z.normalize(o.position,o.position),z.multiplyByScalar(o.position,Math.sqrt(R),o.position));var L=z.angleBetween(M,o.position),N=z.cross(M,o.position,M);z.normalize(N,N);var F=Kn.fromAxisAngle(N,L,Ege),k=be.fromQuaternion(F,Tge);be.multiplyByVector(k,o.direction,o.direction),be.multiplyByVector(k,o.up,o.up),z.cross(o.direction,o.up,o.right),z.cross(o.right,o.direction,o.up),o._setTransform(C)}}(e,t,i)}}var Age=new Rt,Pge=new Ts,Ige=new z;function Dge(e,t,i){Object(u.a)(i.distance)&&(i=i.distance);var n=e._scene,r=n.camera,a=n.canvas,o=Age;o.x=a.clientWidth/2,o.y=a.clientHeight/2;var s,c,l=r.getPickRay(o,Pge);if(r.position.z<e._minimumPickingTerrainHeight&&(s=ige(e,o,Ige)),Object(u.a)(s))c=z.distance(l.origin,s);else{var h=z.UNIT_X,d=l.origin,f=l.direction;c=-z.dot(h,d)/z.dot(h,f)}G_e(e,t,i,e._zoomFactor,c)}var jge=new Ts,Mge=new oc(z.UNIT_X,0),Rge=new z,Lge=new z,Nge=new z;function Fge(e,t,i){var n=e._scene,r=n.camera,a=ige(e,i.startPosition,Nge);if(Object(u.a)(a)){var o=i.endPosition,s=r.getPickRay(o,jge),c=z.clone(r.direction,Lge);n.mode===xF.COLUMBUS_VIEW&&z.fromElements(c.z,c.x,c.y,c);var l=oc.fromPointNormal(a,c,Mge),h=tc.rayPlane(s,l,Rge);Object(u.a)(h)&&(c=z.subtract(a,h,c),n.mode===xF.COLUMBUS_VIEW&&z.fromElements(c.y,c.z,c.x,c),z.add(r.position,c,r.position))}}var kge=new z,Bge=new K,zge=new z,Uge=new ae,Vge=new z;function Hge(e,t,i){var n=e._scene.camera;if(Be.equals(n.transform,Be.IDENTITY)){var r,a,o,s=e._ellipsoid.geodeticSurfaceNormal(n.position,Vge),c=e._ellipsoid.cartesianToCartographic(n.positionWC,Bge).height,l=e._globe;if(Object(u.a)(l)&&c<e._minimumPickingTerrainHeight&&(o=ige(e,i.startPosition,Nge),Object(u.a)(o))){var h=n.getPickRay(i.startPosition,$_e),d=e._ellipsoid.geodeticSurfaceNormal(o);Math.abs(z.dot(h.direction,d))<.05&&!e._looking&&(e._rotating=!1,e._strafing=!0)}Rt.equals(t,e._rotateMousePosition)?e._looking?Ove(e,t,i,s):e._rotating?Gge(e,t,i):e._strafing?(z.clone(o,e._strafeStartPosition),Fge(e,0,i)):(r=z.magnitude(e._rotateStartPosition),(a=zge).x=a.y=a.z=r,$ge(e,t,i,ae.fromCartesian3(a,Uge))):(e._looking=!1,e._rotating=!1,e._strafing=!1,Object(u.a)(l)&&c<e._minimumPickingTerrainHeight?Object(u.a)(o)?z.magnitude(n.position)<z.magnitude(o)?(z.clone(o,e._strafeStartPosition),e._strafing=!0,Fge(e,0,i)):(r=z.magnitude(o),(a=zge).x=a.y=a.z=r,$ge(e,t,i,ae.fromCartesian3(a,Uge)),z.clone(o,e._rotateStartPosition)):(e._looking=!0,Ove(e,t,i,s)):Object(u.a)(n.pickEllipsoid(i.startPosition,e._ellipsoid,kge))?($ge(e,t,i,e._ellipsoid),z.clone(kge,e._rotateStartPosition)):c>e._minimumTrackBallHeight?(e._rotating=!0,Gge(e,t,i)):(e._looking=!0,Ove(e,t,i,s)),Rt.clone(t,e._rotateMousePosition))}else Gge(e,t,i)}function Gge(e,t,i,n,r,a){r=Object(w.a)(r,!1),a=Object(w.a)(a,!1);var o=e._scene,s=o.camera,c=o.canvas,l=s.constrainedAxis;Object(u.a)(n)&&(s.constrainedAxis=n);var h=z.magnitude(s.position),d=e._rotateFactor*(h-e._rotateRateRangeAdjustment);d>e._maximumRotateRate&&(d=e._maximumRotateRate),d<e._minimumRotateRate&&(d=e._minimumRotateRate);var f=(i.startPosition.x-i.endPosition.x)/c.clientWidth,p=(i.startPosition.y-i.endPosition.y)/c.clientHeight;f=Math.min(f,e.maximumMovementRatio),p=Math.min(p,e.maximumMovementRatio);var m=d*f*Math.PI*2,_=d*p*Math.PI;r||s.rotateRight(m),a||s.rotateUp(_),s.constrainedAxis=l}var qge=Te.clone(Te.UNIT_W),Wge=Te.clone(Te.UNIT_W),Yge=new z,Xge=new z,Zge=new z,Qge=new z,Kge=new Rt,Jge=new Rt;function $ge(e,t,i,n){var r=e._scene.camera,a=Rt.clone(i.startPosition,Kge),o=Rt.clone(i.endPosition,Jge),s=r.pickEllipsoid(a,n,qge),c=r.pickEllipsoid(o,n,Wge);if(!Object(u.a)(s)||!Object(u.a)(c))return e._rotating=!0,void Gge(e,0,i);if(s=r.worldToCameraCoordinates(s,s),c=r.worldToCameraCoordinates(c,c),Object(u.a)(r.constrainedAxis)){var l=r.constrainedAxis,h=z.mostOrthogonalAxis(l,Yge);z.cross(h,l,h),z.normalize(h,h);var d=z.cross(l,h,Xge),f=z.magnitude(s),p=z.dot(l,s),m=Math.acos(p/f),_=z.multiplyByScalar(l,p,Zge);z.subtract(s,_,_),z.normalize(_,_);var g=z.magnitude(c),v=z.dot(l,c),b=Math.acos(v/g),y=z.multiplyByScalar(l,v,Qge);z.subtract(c,y,y),z.normalize(y,y);var w=Math.acos(z.dot(_,h));z.dot(_,d)<0&&(w=I.TWO_PI-w);var O=Math.acos(z.dot(y,h));z.dot(y,d)<0&&(O=I.TWO_PI-O);var x,E=w-O;x=z.equalsEpsilon(l,r.position,I.EPSILON2)?r.right:z.cross(l,r.position,Yge);var T,C=z.cross(l,x,Yge),S=z.dot(C,z.subtract(s,l,Xge)),A=z.dot(C,z.subtract(c,l,Xge));T=S>0&&A>0?b-m:S>0&&A<=0?z.dot(r.position,l)>0?-m-b:m+b:m-b,r.rotateRight(E),r.rotateUp(T)}else{z.normalize(s,s),z.normalize(c,c);var P=z.dot(s,c),D=z.cross(s,c,Yge);if(P<1&&!z.equalsEpsilon(D,z.ZERO,I.EPSILON14)){var j=Math.acos(P);r.rotate(D,j)}}}var eve=new z,tve=new K;function ive(e,t,i){Object(u.a)(i.distance)&&(i=i.distance);var n=e._ellipsoid,r=e._scene,a=r.camera,o=r.canvas,s=Age;s.x=o.clientWidth/2,s.y=o.clientHeight/2;var c,l,h=a.getPickRay(s,Pge),d=n.cartesianToCartographic(a.position,tve).height;d<e._minimumPickingTerrainHeight&&(c=ige(e,s,Ige)),l=Object(u.a)(c)?z.distance(h.origin,c):d;var f=z.normalize(a.position,eve);G_e(e,t,i,e._zoomFactor,l,z.dot(f,a.direction))}var nve=new Rt,rve=new Ts,ave=new z,ove=new z,sve=new Be,cve=new Be,lve=new Be,uve=new Kn,hve=new be,dve=new K,fve=new z;function pve(e,t,i){var n=e._scene.camera;if(Be.equals(n.transform,Be.IDENTITY))if(Object(u.a)(i.angleAndHeight)&&(i=i.angleAndHeight),Rt.equals(t,e._tiltCenterMousePosition)||(e._tiltOnEllipsoid=!1,e._looking=!1),e._looking){var r=e._ellipsoid.geodeticSurfaceNormal(n.position,fve);Ove(e,t,i,r)}else{var a=e._ellipsoid.cartesianToCartographic(n.position,dve);e._tiltOnEllipsoid||a.height>e._minimumCollisionTerrainHeight?(e._tiltOnEllipsoid=!0,function(e,t,i){var n=e._ellipsoid,r=e._scene,a=r.camera,o=.25*e.minimumZoomDistance,s=n.cartesianToCartographic(a.positionWC,mve).height;if(s-o-1<I.EPSILON3&&i.endPosition.y-i.startPosition.y<0)return;var c=r.canvas,l=nve;l.x=c.clientWidth/2,l.y=c.clientHeight/2;var h,d=a.getPickRay(l,rve),f=tc.rayEllipsoid(d,n);if(Object(u.a)(f))h=Ts.getPoint(d,f.start,ave);else{if(!(s>e._minimumTrackBallHeight)){e._looking=!0;var p=e._ellipsoid.geodeticSurfaceNormal(a.position,fve);return Ove(e,t,i,p),void Rt.clone(t,e._tiltCenterMousePosition)}var m=tc.grazingAltitudeLocation(d,n);if(!Object(u.a)(m))return;var _=n.cartesianToCartographic(m,dve);_.height=0,h=n.cartographicToCartesian(_,ave)}var g=xa.eastNorthUpToFixedFrame(h,n,sve),v=e._globe,b=e._ellipsoid;e._globe=void 0,e._ellipsoid=ae.UNIT_SPHERE,e._rotateFactor=1,e._rotateRateRangeAdjustment=1;var y=Be.clone(a.transform,lve);a._setTransform(g),Gge(e,0,i,z.UNIT_Z),a._setTransform(y),e._globe=v,e._ellipsoid=b;var w=b.maximumRadius;e._rotateFactor=1/w,e._rotateRateRangeAdjustment=w}(e,t,i)):function(e,t,i){var n,r,a,o=e._ellipsoid,s=e._scene,c=s.camera;if(Rt.equals(t,e._tiltCenterMousePosition))n=z.clone(e._tiltCenter,ave);else{if(n=ige(e,t,ave),!Object(u.a)(n)){if(r=c.getPickRay(t,rve),a=tc.rayEllipsoid(r,o),!Object(u.a)(a)){if(o.cartesianToCartographic(c.position,dve).height<=e._minimumTrackBallHeight){e._looking=!0;var l=e._ellipsoid.geodeticSurfaceNormal(c.position,fve);Ove(e,t,i,l),Rt.clone(t,e._tiltCenterMousePosition)}return}n=Ts.getPoint(r,a.start,ave)}Rt.clone(t,e._tiltCenterMousePosition),z.clone(n,e._tiltCenter)}var h=s.canvas,d=nve;d.x=h.clientWidth/2,d.y=e._tiltCenterMousePosition.y,r=c.getPickRay(d,rve);var f=z.magnitude(n),p=z.fromElements(f,f,f,zge),m=ae.fromCartesian3(p,Uge);if(a=tc.rayEllipsoid(r,m),!Object(u.a)(a))return;var _=z.magnitude(r.origin)>f?a.start:a.stop,g=Ts.getPoint(r,_,ove),v=xa.eastNorthUpToFixedFrame(n,o,sve),b=xa.eastNorthUpToFixedFrame(g,m,cve),y=e._globe,w=e._ellipsoid;e._globe=void 0,e._ellipsoid=ae.UNIT_SPHERE,e._rotateFactor=1,e._rotateRateRangeAdjustment=1;var O=z.UNIT_Z,x=Be.clone(c.transform,lve);c._setTransform(v);var E=z.cross(g,c.positionWC,Cge),T=z.dot(c.rightWC,E);if(Gge(e,0,i,O,!1,!0),c._setTransform(b),T<0){i.startPosition.y>i.endPosition.y&&(O=void 0);var C=c.constrainedAxis;c.constrainedAxis=void 0,Gge(e,0,i,O,!0,!1),c.constrainedAxis=C}else Gge(e,0,i,O,!0,!1);if(Object(u.a)(c.constrainedAxis)){var S=z.cross(c.direction,c.constrainedAxis,Cge);z.equalsEpsilon(S,z.ZERO,I.EPSILON6)||(z.dot(S,c.right)<0&&z.negate(S,S),z.cross(S,c.direction,c.up),z.cross(c.direction,c.up,c.right),z.normalize(c.up,c.up),z.normalize(c.right,c.right))}c._setTransform(x),e._globe=y,e._ellipsoid=w;var A=w.maximumRadius;e._rotateFactor=1/A,e._rotateRateRangeAdjustment=A;var P=z.clone(c.positionWC,Cge);if(c._adjustHeightForTerrain(),!z.equals(c.positionWC,P)){c._setTransform(b),c.worldToCameraCoordinatesPoint(P,P);var D=z.magnitudeSquared(P);z.magnitudeSquared(c.position)>D&&(z.normalize(c.position,c.position),z.multiplyByScalar(c.position,Math.sqrt(D),c.position));var j=z.angleBetween(P,c.position),M=z.cross(P,c.position,P);z.normalize(M,M);var R=Kn.fromAxisAngle(M,j,uve),L=be.fromQuaternion(R,hve);be.multiplyByVector(L,c.direction,c.direction),be.multiplyByVector(L,c.up,c.up),z.cross(c.direction,c.up,c.right),z.cross(c.right,c.direction,c.up),c._setTransform(x)}}(e,t,i)}}var mve=new K;var _ve=new Rt,gve=new Rt,vve=new Ts,bve=new Ts,yve=new z,wve=new z;function Ove(e,t,i,n){var r=e._scene.camera,a=_ve;a.x=i.startPosition.x,a.y=0;var o=gve;o.x=i.endPosition.x,o.y=0;var s,c,l=r.getPickRay(a,vve),h=r.getPickRay(o,bve),d=0;r.frustum instanceof hb?(s=l.origin,c=h.origin,z.add(r.direction,s,s),z.add(r.direction,c,c),z.subtract(s,r.position,s),z.subtract(c,r.position,c),z.normalize(s,s),z.normalize(c,c)):(s=l.direction,c=h.direction);var f=z.dot(s,c);f<1&&(d=Math.acos(f)),d=i.startPosition.x>i.endPosition.x?-d:d;var p=e._horizontalRotationAxis;if(Object(u.a)(n)?r.look(n,-d):Object(u.a)(p)?r.look(p,-d):r.lookLeft(d),a.x=0,a.y=i.startPosition.y,o.x=0,o.y=i.endPosition.y,l=r.getPickRay(a,vve),h=r.getPickRay(o,bve),d=0,r.frustum instanceof hb?(s=l.origin,c=h.origin,z.add(r.direction,s,s),z.add(r.direction,c,c),z.subtract(s,r.position,s),z.subtract(c,r.position,c),z.normalize(s,s),z.normalize(c,c)):(s=l.direction,c=h.direction),(f=z.dot(s,c))<1&&(d=Math.acos(f)),d=i.startPosition.y>i.endPosition.y?-d:d,n=Object(w.a)(n,p),Object(u.a)(n)){var m=r.direction,_=z.negate(n,yve),g=z.equalsEpsilon(m,n,I.EPSILON2),v=z.equalsEpsilon(m,_,I.EPSILON2);if(g||v)(g&&d<0||v&&d>0)&&r.look(r.right,-d);else{f=z.dot(m,n);var b=I.acosClamped(f);d>0&&d>b&&(d=b-I.EPSILON4),f=z.dot(m,_),b=I.acosClamped(f),d<0&&-d>b&&(d=-b+I.EPSILON4);var y=z.cross(n,m,wve);r.look(y,d)}}else r.lookUp(d)}m_e.prototype.update=function(){Be.equals(this._scene.camera.transform,Be.IDENTITY)?(this._globe=this._scene.globe,this._ellipsoid=Object(u.a)(this._globe)?this._globe.ellipsoid:this._scene.mapProjection.ellipsoid):(this._globe=void 0,this._ellipsoid=ae.UNIT_SPHERE),this._minimumCollisionTerrainHeight=this.minimumCollisionTerrainHeight*this._scene.terrainExaggeration,this._minimumPickingTerrainHeight=this.minimumPickingTerrainHeight*this._scene.terrainExaggeration,this._minimumTrackBallHeight=this.minimumTrackBallHeight*this._scene.terrainExaggeration;var e=this._ellipsoid.maximumRadius;this._rotateFactor=1/e,this._rotateRateRangeAdjustment=e;var t,i,n=this._scene.mode;n===xF.SCENE2D?(i=(t=this)._scene.mapMode2D===Jre.ROTATE,Be.equals(Be.IDENTITY,t._scene.camera.transform)?(b_e(t,t.enableTranslate,t.translateEventTypes,X_e,t.inertiaTranslate,"_lastInertiaTranslateMovement"),b_e(t,t.enableZoom,t.zoomEventTypes,Z_e,t.inertiaZoom,"_lastInertiaZoomMovement"),i&&b_e(t,t.enableRotate,t.tiltEventTypes,J_e,t.inertiaSpin,"_lastInertiaTiltMovement")):(b_e(t,t.enableZoom,t.zoomEventTypes,Z_e,t.inertiaZoom,"_lastInertiaZoomMovement"),i&&b_e(t,t.enableRotate,t.translateEventTypes,J_e,t.inertiaSpin,"_lastInertiaSpinMovement"))):n===xF.COLUMBUS_VIEW?(this._horizontalRotationAxis=z.UNIT_Z,function(e){var t=e._scene.camera;if(Be.equals(Be.IDENTITY,t.transform)){var i=e._tweens;if(e._aggregator.anyButtonDown&&i.removeAll(),b_e(e,e.enableTilt,e.tiltEventTypes,Sge,e.inertiaSpin,"_lastInertiaTiltMovement"),b_e(e,e.enableTranslate,e.translateEventTypes,dge,e.inertiaTranslate,"_lastInertiaTranslateMovement"),b_e(e,e.enableZoom,e.zoomEventTypes,Dge,e.inertiaZoom,"_lastInertiaZoomMovement"),b_e(e,e.enableLook,e.lookEventTypes,Ove),!(e._aggregator.anyButtonDown||Object(u.a)(e._lastInertiaZoomMovement)&&e._lastInertiaZoomMovement.active||Object(u.a)(e._lastInertiaTranslateMovement)&&e._lastInertiaTranslateMovement.active||i.contains(e._tween))){var n=t.createCorrectPositionTween(e.bounceAnimationTime);Object(u.a)(n)&&(e._tween=i.add(n))}i.update()}else b_e(e,e.enableRotate,e.rotateEventTypes,Gge,e.inertiaSpin,"_lastInertiaSpinMovement"),b_e(e,e.enableZoom,e.zoomEventTypes,ive,e.inertiaZoom,"_lastInertiaZoomMovement")}(this)):n===xF.SCENE3D&&(this._horizontalRotationAxis=void 0,function(e){b_e(e,e.enableRotate,e.rotateEventTypes,Hge,e.inertiaSpin,"_lastInertiaSpinMovement"),b_e(e,e.enableZoom,e.zoomEventTypes,ive,e.inertiaZoom,"_lastInertiaZoomMovement"),b_e(e,e.enableTilt,e.tiltEventTypes,pve,e.inertiaSpin,"_lastInertiaTiltMovement"),b_e(e,e.enableLook,e.lookEventTypes,Ove)}(this)),this._aggregator.reset()},m_e.prototype.isDestroyed=function(){return!1},m_e.prototype.destroy=function(){return this._tweens.removeAll(),this._aggregator=this._aggregator&&this._aggregator.destroy(),rl(this)};var xve=m_e;function Eve(){}Eve.getShadowCastShaderKeyword=function(e,t,i,n){return"castShadow "+e+" "+t+" "+i+" "+n},Eve.createShadowCastVertexShader=function(e,t,i){var n=e.defines.slice(0),r=e.sources.slice(0);n.push("SHADOW_MAP"),i&&n.push("GENERATE_POSITION");var a=UN.findPositionVarying(e),o=Object(u.a)(a);if(t&&!o){for(var s=r.length,c=0;c<s;++c)r[c]=UN.replaceMain(r[c],"czm_shadow_cast_main");r.push("varying vec3 v_positionEC; \nvoid main() \n{ \n    czm_shadow_cast_main(); \n    v_positionEC = (czm_inverseProjection * gl_Position).xyz; \n}")}return new UN({defines:n,sources:r})},Eve.createShadowCastFragmentShader=function(e,t,i,n){var r=e.defines.slice(0),a=e.sources.slice(0),o=UN.findPositionVarying(e),s=Object(u.a)(o);s||(o="v_positionEC");for(var c=a.length,l=0;l<c;++l)a[l]=UN.replaceMain(a[l],"czm_shadow_cast_main");var h="";return t&&(s||(h+="varying vec3 v_positionEC; \n"),h+="uniform vec4 shadowMap_lightPositionEC; \n"),h+=n?"void main() \n{ \n":"void main() \n{ \n    czm_shadow_cast_main(); \n    if (gl_FragColor.a == 0.0) \n    { \n       discard; \n    } \n",t?h+="    float distance = length("+o+"); \n    if (distance >= shadowMap_lightPositionEC.w) \n    { \n        discard; \n    } \n    distance /= shadowMap_lightPositionEC.w; // radius \n    gl_FragColor = czm_packDepth(distance); \n":i?(h+="    czm_depth_main(); \n",h+="    if(gl_FragColor.a < 0.3){\n",h+="       discard;\n",h+="    }\n",h+="    else{\n",h+="       gl_FragColor = vec4(1.0); \n",h+="    }\n"):h+="    gl_FragColor = czm_packDepth(gl_FragCoord.z); \n",h+="} \n",a.push(h),new UN({defines:r,sources:a})},Eve.getShadowReceiveShaderKeyword=function(e,t,i,n){return"receiveShadow "+e._usesDepthTexture+e._polygonOffsetSupported+e._isPointLight+e._isSpotLight+(e._numberOfCascades>1)+e.debugCascadeColors+e.softShadows+t+i+n},Eve.createShadowReceiveVertexShader=function(e,t,i){var n=e.defines.slice(0),r=e.sources.slice(0);return n.push("SHADOW_MAP"),t&&(i?n.push("GENERATE_POSITION_AND_NORMAL"):n.push("GENERATE_POSITION")),new UN({defines:n,sources:r})},Eve.createShadowReceiveFragmentShader=function(e,t,i,n,r){for(var a=UN.findNormalVarying(e),o=!n&&Object(u.a)(a)||n&&r,s=UN.findPositionVarying(e),c=Object(u.a)(s),l=t._usesDepthTexture,h=t._polygonOffsetSupported,d=t._isPointLight,f=t._isSpotLight,p=t._numberOfCascades>1,m=t.debugCascadeColors,_=t.softShadows,g=d?t._pointBias:n?t._terrainBias:t._primitiveBias,v=e.defines.slice(0),b=e.sources.slice(0),y=b.length,w=0;w<y;++w)b[w]=UN.replaceMain(b[w],"czm_shadow_receive_main");d?v.push("USE_CUBE_MAP_SHADOW"):l&&v.push("USE_SHADOW_DEPTH_TEXTURE"),_&&!d&&v.push("USE_SOFT_SHADOWS"),p&&i&&n&&(o?v.push("ENABLE_VERTEX_LIGHTING"):v.push("ENABLE_DAYNIGHT_SHADING")),i&&g.normalShading&&o&&(v.push("USE_NORMAL_SHADING"),g.normalShadingSmooth>0&&v.push("USE_NORMAL_SHADING_SMOOTH"));var O="";return O+=d?"uniform samplerCube shadowMap_textureCube; \n":"uniform sampler2D shadowMap_texture; \n",O+="uniform mat4 shadowMap_matrix; \nuniform vec3 shadowMap_lightDirectionEC; \nuniform vec4 shadowMap_lightPositionEC; \nuniform vec4 shadowMap_normalOffsetScaleDistanceMaxDistanceAndDarkness; \nuniform vec4 shadowMap_texelSizeDepthBiasAndNormalShadingSmooth; \n#ifdef LOG_DEPTH \nvarying vec3 v_logPositionEC; \n#endif \nvec4 getPositionEC() \n{ \n"+(c?"    return vec4("+s+", 1.0); \n":"#ifndef LOG_DEPTH \n    return czm_windowToEyeCoordinates(gl_FragCoord); \n#else \n    return vec4(v_logPositionEC, 1.0); \n#endif \n")+"} \nvec3 getNormalEC() \n{ \n"+(o?"    return normalize("+a+"); \n":"    return vec3(1.0); \n")+"} \nvoid applyNormalOffset(inout vec4 positionEC, vec3 normalEC, float nDotL) \n{ \n"+(g.normalOffset&&o?"    float normalOffset = shadowMap_normalOffsetScaleDistanceMaxDistanceAndDarkness.x; \n    float normalOffsetScale = 1.0 - nDotL; \n    vec3 offset = normalOffset * normalOffsetScale * normalEC; \n    positionEC.xyz += offset; \n":"")+"} \n",O+="void main() \n{ \n    czm_shadow_receive_main(); \n    vec4 positionEC = getPositionEC(); \n    vec3 normalEC = getNormalEC(); \n    float depth = -positionEC.z; \n",O+="    czm_shadowParameters shadowParameters; \n    shadowParameters.texelStepSize = shadowMap_texelSizeDepthBiasAndNormalShadingSmooth.xy; \n    shadowParameters.depthBias = shadowMap_texelSizeDepthBiasAndNormalShadingSmooth.z; \n    shadowParameters.normalShadingSmooth = shadowMap_texelSizeDepthBiasAndNormalShadingSmooth.w; \n    shadowParameters.darkness = shadowMap_normalOffsetScaleDistanceMaxDistanceAndDarkness.w; \n",n?O+="    shadowParameters.depthBias *= max(depth * 0.01, 1.0); \n":h||(O+="    shadowParameters.depthBias *= mix(1.0, 100.0, depth * 0.0015); \n"),O+=d?"    vec3 directionEC = positionEC.xyz - shadowMap_lightPositionEC.xyz; \n    float distance = length(directionEC); \n    directionEC = normalize(directionEC); \n    float radius = shadowMap_lightPositionEC.w; \n    // Stop early if the fragment is beyond the point light radius \n    if (distance > radius) \n    { \n        return; \n    } \n    vec3 directionWC  = czm_inverseViewRotation * directionEC; \n    shadowParameters.depth = distance / radius; \n    shadowParameters.nDotL = clamp(dot(normalEC, -directionEC), 0.0, 1.0); \n    shadowParameters.texCoords = directionWC; \n    float visibility = czm_shadowVisibility(shadowMap_textureCube, shadowParameters); \n":f?"    vec3 directionEC = normalize(positionEC.xyz - shadowMap_lightPositionEC.xyz); \n    float nDotL = clamp(dot(normalEC, -directionEC), 0.0, 1.0); \n    applyNormalOffset(positionEC, normalEC, nDotL); \n    vec4 shadowPosition = shadowMap_matrix * positionEC; \n    // Spot light uses a perspective projection, so perform the perspective divide \n    shadowPosition /= shadowPosition.w; \n    // Stop early if the fragment is not in the shadow bounds \n    if (any(lessThan(shadowPosition.xyz, vec3(0.0))) || any(greaterThan(shadowPosition.xyz, vec3(1.0)))) \n    { \n        return; \n    } \n    shadowParameters.texCoords = shadowPosition.xy; \n    shadowParameters.depth = shadowPosition.z; \n    shadowParameters.nDotL = nDotL; \n    float visibility = czm_shadowVisibility(shadowMap_texture, shadowParameters); \n":p?"    float maxDepth = shadowMap_cascadeSplits[1].w; \n    // Stop early if the eye depth exceeds the last cascade \n    if (depth > maxDepth) \n    { \n        return; \n    } \n    // Get the cascade based on the eye-space depth \n    vec4 weights = czm_cascadeWeights(depth); \n    // Apply normal offset \n    float nDotL = clamp(dot(normalEC, shadowMap_lightDirectionEC), 0.0, 1.0); \n    applyNormalOffset(positionEC, normalEC, nDotL); \n    // Transform position into the cascade \n    vec4 shadowPosition = czm_cascadeMatrix(weights) * positionEC; \n    // Get visibility \n    shadowParameters.texCoords = shadowPosition.xy; \n    shadowParameters.depth = shadowPosition.z; \n    shadowParameters.nDotL = nDotL; \n    float visibility = czm_shadowVisibility(shadowMap_texture, shadowParameters); \n    // Fade out shadows that are far away \n    float shadowMapMaximumDistance = shadowMap_normalOffsetScaleDistanceMaxDistanceAndDarkness.z; \n    float fade = max((depth - shadowMapMaximumDistance * 0.8) / (shadowMapMaximumDistance * 0.2), 0.0); \n    visibility = mix(visibility, 1.0, fade); \n"+(m?"    // Draw cascade colors for debugging \n    gl_FragColor *= czm_cascadeColor(weights); \n":""):"    float nDotL = clamp(dot(normalEC, shadowMap_lightDirectionEC), 0.0, 1.0); \n    applyNormalOffset(positionEC, normalEC, nDotL); \n    vec4 shadowPosition = shadowMap_matrix * positionEC; \n    // Stop early if the fragment is not in the shadow bounds \n    if (any(lessThan(shadowPosition.xyz, vec3(0.0))) || any(greaterThan(shadowPosition.xyz, vec3(1.0)))) \n    { \n        return; \n    } \n    shadowParameters.texCoords = shadowPosition.xy; \n    shadowParameters.depth = shadowPosition.z; \n    shadowParameters.nDotL = nDotL; \n    float visibility = czm_shadowVisibility(shadowMap_texture, shadowParameters); \n",O+="    gl_FragColor.rgb *= visibility; \n} \n",b.push(O),new UN({defines:v,sources:b})};var Tve=Eve;function Cve(e){var t=(e=Object(w.a)(e,w.a.EMPTY_OBJECT)).context;if(!Object(u.a)(t))throw new h.a("context is required.");if(!Object(u.a)(e.lightCamera))throw new h.a("lightCamera is required.");if(Object(u.a)(e.numberOfCascades)&&1!==e.numberOfCascades&&4!==e.numberOfCascades)throw new h.a("Only one or four cascades are supported.");this._enabled=Object(w.a)(e.enabled,!0),this._softShadows=Object(w.a)(e.softShadows,!1),this._normalOffset=Object(w.a)(e.normalOffset,!0),this.dirty=!0,this.fromLightSource=Object(w.a)(e.fromLightSource,!0),this.darkness=Object(w.a)(e.darkness,.3),this._darkness=this.darkness,this.maximumDistance=Object(w.a)(e.maximumDistance,5e3),this._outOfView=!1,this._outOfViewPrevious=!1,this._needsUpdate=!0;var i,n=!0;(Ri.isInternetExplorer()||Ri.isEdge()||(Ri.isChrome()||Ri.isFirefox())&&Ri.isWindows()&&!t.depthTexture)&&(n=!1),this._polygonOffsetSupported=n,this._terrainBias={polygonOffset:n,polygonOffsetFactor:1.1,polygonOffsetUnits:4,normalOffset:this._normalOffset,normalOffsetScale:.5,normalShading:!0,normalShadingSmooth:.3,depthBias:1e-4},this._primitiveBias={polygonOffset:n,polygonOffsetFactor:1.1,polygonOffsetUnits:4,normalOffset:this._normalOffset,normalOffsetScale:.1,normalShading:!0,normalShadingSmooth:.05,depthBias:2e-5},this._pointBias={polygonOffset:!1,polygonOffsetFactor:1.1,polygonOffsetUnits:4,normalOffset:this._normalOffset,normalOffsetScale:0,normalShading:!0,normalShadingSmooth:.1,depthBias:5e-4},this._depthAttachment=void 0,this._colorAttachment=void 0,this._shadowMapMatrix=new Be,this._shadowMapTexture=void 0,this._lightDirectionEC=new z,this._lightPositionEC=new Te,this._distance=0,this._lightCamera=e.lightCamera,this._shadowMapCamera=new Gve,this._shadowMapCullingVolume=void 0,this._sceneCamera=void 0,this._boundingSphere=new St,this._isPointLight=Object(w.a)(e.isPointLight,!1),this._pointLightRadius=Object(w.a)(e.pointLightRadius,100),this._cascadesEnabled=!this._isPointLight&&Object(w.a)(e.cascadesEnabled,!0),this._numberOfCascades=this._cascadesEnabled?Object(w.a)(e.numberOfCascades,4):0,this._fitNearFar=!0,this._maximumCascadeDistances=[25,150,700,Number.MAX_VALUE],this._textureSize=new Rt,this._isSpotLight=!1,this._cascadesEnabled?this._shadowMapCamera.frustum=new cb:Object(u.a)(this._lightCamera.frustum.fov)&&(this._isSpotLight=!0),this._cascadeSplits=[new Te,new Te],this._cascadeMatrices=[new Be,new Be,new Be,new Be],this._cascadeDistances=new Te,i=this._isPointLight?6:this._cascadesEnabled?this._numberOfCascades:1,this._passes=new Array(i);for(var r=0;r<i;++r)this._passes[r]=new Sve(t);this.debugShow=!1,this.debugFreezeFrame=!1,this._debugFreezeFrame=!1,this._debugCascadeColors=!1,this._debugLightFrustum=void 0,this._debugCameraFrustum=void 0,this._debugCascadeFrustums=new Array(this._numberOfCascades),this._debugShadowViewCommand=void 0,this._usesDepthTexture=t.depthTexture,this._isPointLight&&(this._usesDepthTexture=!1),this._primitiveRenderState=void 0,this._terrainRenderState=void 0,this._pointRenderState=void 0,Pve(this),this._clearCommand=new fX({depth:1,color:new uf}),this._clearPassState=new bne(t),this._size=Object(w.a)(e.size,2048),this.size=this._size}function Sve(e){this.camera=new Gve,this.passState=new bne(e),this.framebuffer=void 0,this.textureOffsets=void 0,this.commandList=[],this.cullingVolume=void 0}function Ave(e,t){return RM.fromCache({cull:{enabled:!0,face:BD.BACK},depthTest:{enabled:!0},colorMask:{red:e,green:e,blue:e,alpha:e},depthMask:!0,polygonOffset:{enabled:t.polygonOffset,factor:t.polygonOffsetFactor,units:t.polygonOffsetUnits}})}function Pve(e){var t=!e._usesDepthTexture;e._primitiveRenderState=Ave(t,e._primitiveBias),e._terrainRenderState=Ave(t,e._terrainBias),e._pointRenderState=Ave(t,e._pointBias)}function Ive(e){for(var t=e._passes.length,i=0;i<t;++i){var n=e._passes[i],r=n.framebuffer;Object(u.a)(r)&&!r.isDestroyed()&&r.destroy(),n.framebuffer=void 0}e._depthAttachment=e._depthAttachment&&e._depthAttachment.destroy(),e._colorAttachment=e._colorAttachment&&e._colorAttachment.destroy()}function Dve(){return new tj({wrapS:$D.CLAMP_TO_EDGE,wrapT:$D.CLAMP_TO_EDGE,minificationFilter:KD.NEAREST,magnificationFilter:ZD.NEAREST})}function jve(e,t){e._isPointLight?function(e,t){for(var i=new are({context:t,width:e._textureSize.x,height:e._textureSize.y,format:nre.DEPTH_COMPONENT16}),n=new nj({context:t,width:e._textureSize.x,height:e._textureSize.y,pixelFormat:gx.RGBA,pixelDatatype:mx.UNSIGNED_BYTE,sampler:Dve()}),r=[n.negativeX,n.negativeY,n.negativeZ,n.positiveX,n.positiveY,n.positiveZ],a=0;a<6;++a){var o=new cj({context:t,depthRenderbuffer:i,colorTextures:[r[a]],destroyAttachments:!1}),s=e._passes[a];s.framebuffer=o,s.passState.framebuffer=o}e._shadowMapTexture=n,e._depthAttachment=i,e._colorAttachment=n}(e,t):e._usesDepthTexture?function(e,t){for(var i=new hj({context:t,width:e._textureSize.x,height:e._textureSize.y,pixelFormat:gx.DEPTH_STENCIL,pixelDatatype:mx.UNSIGNED_INT_24_8,sampler:Dve()}),n=new cj({context:t,depthStencilTexture:i,destroyAttachments:!1}),r=e._passes.length,a=0;a<r;++a){var o=e._passes[a];o.framebuffer=n,o.passState.framebuffer=n}e._shadowMapTexture=i,e._depthAttachment=i}(e,t):function(e,t){for(var i=new are({context:t,width:e._textureSize.x,height:e._textureSize.y,format:nre.DEPTH_COMPONENT16}),n=new hj({context:t,width:e._textureSize.x,height:e._textureSize.y,pixelFormat:gx.RGBA,pixelDatatype:mx.UNSIGNED_BYTE,sampler:Dve()}),r=new cj({context:t,depthRenderbuffer:i,colorTextures:[n],destroyAttachments:!1}),a=e._passes.length,o=0;o<a;++o){var s=e._passes[o];s.framebuffer=r,s.passState.framebuffer=r}e._shadowMapTexture=n,e._depthAttachment=i,e._colorAttachment=n}(e,t)}function Mve(e,t){Object(u.a)(e._passes[0].framebuffer)&&e._shadowMapTexture.width===e._textureSize.x||(Ive(e),jve(e,t),function(e,t){e._usesDepthTexture&&e._passes[0].framebuffer.status!==un.FRAMEBUFFER_COMPLETE&&(e._usesDepthTexture=!1,Pve(e),Ive(e),jve(e,t))}(e,t),Rve(e,t))}function Rve(e,t,i){i=Object(w.a)(i,0),(e._isPointLight||0===i)&&(e._clearCommand.framebuffer=e._passes[i].framebuffer,e._clearCommand.execute(t,e._clearPassState))}Cve.MAXIMUM_DISTANCE=2e4,Cve.prototype.debugCreateRenderStates=function(){Pve(this)},Object(O.a)(Cve.prototype,{enabled:{get:function(){return this._enabled},set:function(e){this.dirty=this._enabled!==e,this._enabled=e}},normalOffset:{get:function(){return this._normalOffset},set:function(e){this.dirty=this._normalOffset!==e,this._normalOffset=e,this._terrainBias.normalOffset=e,this._primitiveBias.normalOffset=e,this._pointBias.normalOffset=e}},softShadows:{get:function(){return this._softShadows},set:function(e){this.dirty=this._softShadows!==e,this._softShadows=e}},size:{get:function(){return this._size},set:function(e){!function(e,t){e._size=t;var i=e._passes,n=i.length,r=e._textureSize;if(e._isPointLight){t=HD.maximumCubeMapSize>=t?t:HD.maximumCubeMapSize,r.x=t,r.y=t;var a=new ln(0,0,t,t);i[0].passState.viewport=a,i[1].passState.viewport=a,i[2].passState.viewport=a,i[3].passState.viewport=a,i[4].passState.viewport=a,i[5].passState.viewport=a}else 1===n?(t=HD.maximumTextureSize>=t?t:HD.maximumTextureSize,r.x=t,r.y=t,i[0].passState.viewport=new ln(0,0,t,t)):4===n&&(t=HD.maximumTextureSize>=2*t?t:HD.maximumTextureSize/2,r.x=2*t,r.y=2*t,i[0].passState.viewport=new ln(0,0,t,t),i[1].passState.viewport=new ln(t,0,t,t),i[2].passState.viewport=new ln(0,t,t,t),i[3].passState.viewport=new ln(t,t,t,t));e._clearPassState.viewport=new ln(0,0,r.x,r.y);for(var o=0;o<n;++o){var s=i[o],c=s.passState.viewport,l=c.x/r.x,u=c.y/r.y,h=c.width/r.x,d=c.height/r.y;s.textureOffsets=new Be(h,0,0,l,0,d,0,u,0,0,1,0,0,0,0,1)}}(this,e)}},outOfView:{get:function(){return this._outOfView}},shadowMapCullingVolume:{get:function(){return this._shadowMapCullingVolume}},passes:{get:function(){return this._passes}},isPointLight:{get:function(){return this._isPointLight}},debugCascadeColors:{get:function(){return this._debugCascadeColors},set:function(e){this.dirty=this._debugCascadeColors!==e,this._debugCascadeColors=e}}});var Lve=new ln;function Nve(e,t){var i=t.context,n=t.context.drawingBufferWidth,r=t.context.drawingBufferHeight,a=.3*Math.min(n,r),o=Lve;o.x=n-a,o.y=0,o.width=a,o.height=a;var s=e._debugShadowViewCommand;Object(u.a)(s)||(s=function(e,t){var i;i=e._isPointLight?"uniform samplerCube shadowMap_textureCube; \nvarying vec2 v_textureCoordinates; \nvoid main() \n{ \n    vec2 uv = v_textureCoordinates; \n    vec3 dir; \n \n    if (uv.y < 0.5) \n    { \n        if (uv.x < 0.333) \n        { \n            dir.x = -1.0; \n            dir.y = uv.x * 6.0 - 1.0; \n            dir.z = uv.y * 4.0 - 1.0; \n        } \n        else if (uv.x < 0.666) \n        { \n            dir.y = -1.0; \n            dir.x = uv.x * 6.0 - 3.0; \n            dir.z = uv.y * 4.0 - 1.0; \n        } \n        else \n        { \n            dir.z = -1.0; \n            dir.x = uv.x * 6.0 - 5.0; \n            dir.y = uv.y * 4.0 - 1.0; \n        } \n    } \n    else \n    { \n        if (uv.x < 0.333) \n        { \n            dir.x = 1.0; \n            dir.y = uv.x * 6.0 - 1.0; \n            dir.z = uv.y * 4.0 - 3.0; \n        } \n        else if (uv.x < 0.666) \n        { \n            dir.y = 1.0; \n            dir.x = uv.x * 6.0 - 3.0; \n            dir.z = uv.y * 4.0 - 3.0; \n        } \n        else \n        { \n            dir.z = 1.0; \n            dir.x = uv.x * 6.0 - 5.0; \n            dir.y = uv.y * 4.0 - 3.0; \n        } \n    } \n \n    float shadow = czm_unpackDepth(textureCube(shadowMap_textureCube, dir)); \n    gl_FragColor = vec4(vec3(shadow), 1.0); \n} \n":"uniform sampler2D shadowMap_texture; \nvarying vec2 v_textureCoordinates; \nvoid main() \n{ \n"+(e._usesDepthTexture?"    float shadow = texture2D(shadowMap_texture, v_textureCoordinates).r; \n":"    float shadow = czm_unpackDepth(texture2D(shadowMap_texture, v_textureCoordinates)); \n")+"    gl_FragColor = vec4(vec3(shadow), 1.0); \n} \n";var n=t.createViewportQuadCommand(i,{uniformMap:{shadowMap_texture:function(){return e._shadowMapTexture},shadowMap_textureCube:function(){return e._shadowMapTexture}}});return n.pass=lM.OVERLAY,n}(e,i),e._debugShadowViewCommand=s),Object(u.a)(s.renderState)&&ln.equals(s.renderState.viewport,o)||(s.renderState=RM.fromCache({viewport:ln.clone(o)})),t.commandList.push(e._debugShadowViewCommand)}var Fve=new Array(8);Fve[0]=new Te(-1,-1,-1,1),Fve[1]=new Te(1,-1,-1,1),Fve[2]=new Te(1,1,-1,1),Fve[3]=new Te(-1,1,-1,1),Fve[4]=new Te(-1,-1,1,1),Fve[5]=new Te(1,-1,1,1),Fve[6]=new Te(1,1,1,1),Fve[7]=new Te(-1,1,1,1);for(var kve=new Be,Bve=new Array(8),zve=0;zve<8;++zve)Bve[zve]=new Te;var Uve=[uf.RED,uf.GREEN,uf.BLUE,uf.MAGENTA],Vve=new z;function Hve(e,t){Nve(e,t);var i=e.debugFreezeFrame&&!e._debugFreezeFrame;if(e._debugFreezeFrame=e.debugFreezeFrame,e.debugFreezeFrame&&(i&&(e._debugCameraFrustum=e._debugCameraFrustum&&e._debugCameraFrustum.destroy(),e._debugCameraFrustum=new Lle({camera:e._sceneCamera,color:uf.CYAN,updateOnChange:!1})),e._debugCameraFrustum.update(t)),e._cascadesEnabled){if(e.debugFreezeFrame){i&&(e._debugLightFrustum=e._debugLightFrustum&&e._debugLightFrustum.destroy(),e._debugLightFrustum=new Lle({camera:e._shadowMapCamera,color:uf.YELLOW,updateOnChange:!1})),e._debugLightFrustum.update(t);for(var n=0;n<e._numberOfCascades;++n)i&&(e._debugCascadeFrustums[n]=e._debugCascadeFrustums[n]&&e._debugCascadeFrustums[n].destroy(),e._debugCascadeFrustums[n]=new Lle({camera:e._passes[n].camera,color:Uve[n],updateOnChange:!1})),e._debugCascadeFrustums[n].update(t)}}else if(e._isPointLight){if(!Object(u.a)(e._debugLightFrustum)||e._needsUpdate){var r=e._shadowMapCamera.positionWC,a=Kn.IDENTITY,o=2*e._pointLightRadius,s=z.fromElements(o,o,o,Vve),c=Be.fromTranslationQuaternionRotationScale(r,a,s,kve);e._debugLightFrustum=e._debugLightFrustum&&e._debugLightFrustum.destroy(),e._debugLightFrustum=function(e,t){var i=new Mu({geometry:new $a({minimum:new z(-.5,-.5,-.5),maximum:new z(.5,.5,.5)}),attributes:{color:df.fromColor(t)}}),n=new Mu({geometry:new NP({radius:.5}),attributes:{color:df.fromColor(t)}});return new ck({geometryInstances:[i,n],appearance:new $j({translucent:!1,flat:!0}),asynchronous:!1,modelMatrix:e})}(c,uf.YELLOW)}e._debugLightFrustum.update(t)}else Object(u.a)(e._debugLightFrustum)&&!e._needsUpdate||(e._debugLightFrustum=new Lle({camera:e._shadowMapCamera,color:uf.YELLOW,updateOnChange:!1})),e._debugLightFrustum.update(t)}function Gve(){this.viewMatrix=new Be,this.inverseViewMatrix=new Be,this.frustum=void 0,this.positionCartographic=new K,this.positionWC=new z,this.directionWC=z.clone(z.UNIT_Z),this.upWC=z.clone(z.UNIT_Y),this.rightWC=z.clone(z.UNIT_X),this.viewProjectionMatrix=new Be}Gve.prototype.clone=function(e){Be.clone(e.viewMatrix,this.viewMatrix),Be.clone(e.inverseViewMatrix,this.inverseViewMatrix),this.frustum=e.frustum.clone(this.frustum),K.clone(e.positionCartographic,this.positionCartographic),z.clone(e.positionWC,this.positionWC),z.clone(e.directionWC,this.directionWC),z.clone(e.upWC,this.upWC),z.clone(e.rightWC,this.rightWC)};var qve=new Be(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1);Gve.prototype.getViewProjection=function(){var e=this.viewMatrix,t=this.frustum.projectionMatrix;return Be.multiply(t,e,this.viewProjectionMatrix),Be.multiply(qve,this.viewProjectionMatrix,this.viewProjectionMatrix),this.viewProjectionMatrix};var Wve=new Array(5),Yve=new wb,Xve=new Array(4),Zve=new z,Qve=new z;var Kve=new Be,Jve=new z,$ve=new z,ebe=new z;var tbe=[new z(-1,0,0),new z(0,-1,0),new z(0,0,-1),new z(1,0,0),new z(0,1,0),new z(0,0,1)],ibe=[new z(0,-1,0),new z(0,0,-1),new z(0,-1,0),new z(0,-1,0),new z(0,0,1),new z(0,-1,0)],nbe=[new z(0,0,1),new z(1,0,0),new z(-1,0,0),new z(0,0,-1),new z(1,0,0),new z(1,0,0)];var rbe=new z,abe=new z,obe=new St,sbe=obe.center;function cbe(e,t){var i=t.camera,n=e._lightCamera,r=e._sceneCamera,a=e._shadowMapCamera;e._cascadesEnabled?z.clone(n.directionWC,a.directionWC):e._isPointLight?z.clone(n.positionWC,a.positionWC):a.clone(n);var o,s,c=e._lightDirectionEC;Be.multiplyByPointAsVector(i.viewMatrix,a.directionWC,c),z.normalize(c,c),z.negate(c,c),Be.multiplyByPoint(i.viewMatrix,a.positionWC,e._lightPositionEC),e._lightPositionEC.w=e._pointLightRadius,e._fitNearFar?(o=Math.min(t.shadowState.nearPlane,e.maximumDistance),s=Math.min(t.shadowState.farPlane,e.maximumDistance+1)):(o=i.frustum.near,s=e.maximumDistance),e._sceneCamera=ose.clone(i,r),i.frustum.clone(e._sceneCamera.frustum),e._sceneCamera.frustum.near=o,e._sceneCamera.frustum.far=s,e._distance=s-o,function(e,t){var i=e._sceneCamera,n=e._shadowMapCamera,r=obe;if(e._cascadesEnabled){if(i.frustum.near>=e.maximumDistance)return e._outOfView=!0,void(e._needsUpdate=!1);var a=t.mapProjection.ellipsoid.geodeticSurfaceNormal(i.positionWC,rbe),o=z.negate(n.directionWC,abe),s=z.dot(a,o),c=I.clamp(s/.1,0,1);if(e._darkness=I.lerp(1,e.darkness,c),s<0)return e._outOfView=!0,void(e._needsUpdate=!1);e._needsUpdate=!0,e._outOfView=!1}else if(e._isPointLight)r.center=n.positionWC,r.radius=e._pointLightRadius,e._outOfView=t.cullingVolume.computeVisibility(r)===ce.OUTSIDE,e._needsUpdate=!e._outOfView&&!e._boundingSphere.equals(r),St.clone(r,e._boundingSphere);else{var l=n.frustum.far/2,u=z.add(n.positionWC,z.multiplyByScalar(n.directionWC,l,sbe),sbe);r.center=u,r.radius=l,e._outOfView=t.cullingVolume.computeVisibility(r)===ce.OUTSIDE,e._needsUpdate=!e._outOfView&&!e._boundingSphere.equals(r),St.clone(r,e._boundingSphere)}}(e,t),!e._outOfViewPrevious&&e._outOfView&&(e._needsUpdate=!0),e._outOfViewPrevious=e._outOfView}Cve.prototype.update=function(e){if(cbe(this,e),this._needsUpdate)if(Mve(this,e.context),this._isPointLight&&function(e,t){var i=new wb;i.fov=I.PI_OVER_TWO,i.near=1,i.far=e._pointLightRadius,i.aspectRatio=1;for(var n=0;n<6;++n){var r=e._passes[n].camera;r.positionWC=e._shadowMapCamera.positionWC,r.positionCartographic=t.mapProjection.ellipsoid.cartesianToCartographic(r.positionWC,r.positionCartographic),r.directionWC=tbe[n],r.upWC=ibe[n],r.rightWC=nbe[n],Be.computeView(r.positionWC,r.directionWC,r.upWC,r.rightWC,r.viewMatrix),Be.inverse(r.viewMatrix,r.inverseViewMatrix),r.frustum=i}}(this,e),this._cascadesEnabled&&(function(e,t){var i=e._shadowMapCamera,n=e._sceneCamera,r=Be.multiply(n.frustum.projectionMatrix,n.viewMatrix,kve),a=Be.inverse(r,kve),o=i.directionWC,s=n.directionWC,c=z.cross(o,s,Jve);s=z.cross(c,o,$ve),z.normalize(s,s),z.normalize(c,c);for(var l=z.fromElements(0,0,0,ebe),u=Be.computeView(l,o,s,c,Kve),h=Be.multiply(u,a,kve),d=z.fromElements(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,Zve),f=z.fromElements(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE,Qve),p=0;p<8;++p){var m=Te.clone(Fve[p],Bve[p]);Be.multiplyByVector(h,m,m),z.divideByScalar(m,m.w,m),z.minimumByComponent(m,d,d),z.maximumByComponent(m,f,f)}f.z+=1e3,d.z-=10;var _=ebe;_.x=-.5*(d.x+f.x),_.y=-.5*(d.y+f.y),_.z=-f.z;var g=Be.fromTranslation(_,kve);u=Be.multiply(g,u,u);var v=.5*(f.x-d.x),b=.5*(f.y-d.y),y=f.z-d.z,w=i.frustum;w.left=-v,w.right=v,w.bottom=-b,w.top=b,w.near=.01,w.far=y,Be.clone(u,i.viewMatrix),Be.inverse(u,i.inverseViewMatrix),Be.getTranslation(i.inverseViewMatrix,i.positionWC),t.mapProjection.ellipsoid.cartesianToCartographic(i.positionWC,i.positionCartographic),z.clone(o,i.directionWC),z.clone(s,i.upWC),z.clone(c,i.rightWC)}(this,e),this._numberOfCascades>1&&function(e,t){var i,n=e._shadowMapCamera,r=e._sceneCamera,a=r.frustum.near,o=r.frustum.far,s=e._numberOfCascades,c=o-a,l=o/a,u=.9,h=!1;t.shadowState.closestObjectSize<200&&(h=!0,u=.9);var d=Xve,f=Wve;for(f[0]=a,f[s]=o,i=0;i<s;++i){var p=(i+1)/s,m=a*Math.pow(l,p),_=a+c*p,g=I.lerp(_,m,u);f[i+1]=g,d[i]=g-f[i]}if(h){for(i=0;i<s;++i)d[i]=Math.min(d[i],e._maximumCascadeDistances[i]);var v=f[0];for(i=0;i<s-1;++i)v+=d[i],f[i+1]=v}Te.unpack(f,0,e._cascadeSplits[0]),Te.unpack(f,1,e._cascadeSplits[1]),Te.unpack(d,0,e._cascadeDistances);var b=n.frustum,y=b.left,w=b.right,O=b.bottom,x=b.top,E=b.near,T=b.far,C=n.positionWC,S=n.directionWC,A=n.upWC,P=r.frustum.clone(Yve),D=n.getViewProjection();for(i=0;i<s;++i){P.near=f[i],P.far=f[i+1];for(var j=Be.multiply(P.projectionMatrix,r.viewMatrix,kve),M=Be.inverse(j,kve),R=Be.multiply(D,M,kve),L=z.fromElements(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,Zve),N=z.fromElements(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE,Qve),F=0;F<8;++F){var k=Te.clone(Fve[F],Bve[F]);Be.multiplyByVector(R,k,k),z.divideByScalar(k,k.w,k),z.minimumByComponent(k,L,L),z.maximumByComponent(k,N,N)}L.x=Math.max(L.x,0),L.y=Math.max(L.y,0),L.z=0,N.x=Math.min(N.x,1),N.y=Math.min(N.y,1),N.z=Math.min(N.z,1);var B=e._passes[i],U=B.camera;U.clone(n);var V=U.frustum;V.left=y+L.x*(w-y),V.right=y+N.x*(w-y),V.bottom=O+L.y*(x-O),V.top=O+N.y*(x-O),V.near=E+L.z*(T-E),V.far=E+N.z*(T-E),B.cullingVolume=U.frustum.computeCullingVolume(C,S,A);var H=e._cascadeMatrices[i];Be.multiply(U.getViewProjection(),r.inverseViewMatrix,H),Be.multiply(B.textureOffsets,H,H)}}(this,e)),this._isPointLight)this._shadowMapCullingVolume=Wg.fromBoundingSphere(this._boundingSphere);else{var t=this._shadowMapCamera,i=t.positionWC,n=t.directionWC,r=t.upWC;this._shadowMapCullingVolume=t.frustum.computeCullingVolume(i,n,r),1===this._passes.length&&this._passes[0].camera.clone(t)}if(1===this._passes.length){var a=this._sceneCamera.inverseViewMatrix;Be.multiply(this._shadowMapCamera.getViewProjection(),a,this._shadowMapMatrix)}this.debugShow&&Hve(this,e)},Cve.prototype.updatePass=function(e,t){Rve(this,e,t)};var lbe=new Rt;function ube(e,t,i){var n=e._isPointLight?e._pointBias:i?e._terrainBias:e._primitiveBias,r={shadowMap_texture:function(){return e._shadowMapTexture},shadowMap_textureCube:function(){return e._shadowMapTexture},shadowMap_matrix:function(){return e._shadowMapMatrix},shadowMap_cascadeSplits:function(){return e._cascadeSplits},shadowMap_cascadeMatrices:function(){return e._cascadeMatrices},shadowMap_lightDirectionEC:function(){return e._lightDirectionEC},shadowMap_lightPositionEC:function(){return e._lightPositionEC},shadowMap_cascadeDistances:function(){return e._cascadeDistances},shadowMap_texelSizeDepthBiasAndNormalShadingSmooth:function(){var t=lbe;return t.x=1/e._textureSize.x,t.y=1/e._textureSize.y,Te.fromElements(t.x,t.y,n.depthBias,n.normalShadingSmooth,this.combinedUniforms1)},shadowMap_normalOffsetScaleDistanceMaxDistanceAndDarkness:function(){return Te.fromElements(n.normalOffsetScale,e._distance,e.maximumDistance,e._darkness,this.combinedUniforms2)},combinedUniforms1:new Te,combinedUniforms2:new Te};return Object(ff.a)(t,r,!1)}function hbe(e,t,i,n,r,a){var o,s,c;if(Object(u.a)(a)&&(o=a.shaderProgram,s=a.renderState,c=a.uniformMap),(a=cM.shallowClone(i,a)).castShadows=!0,a.receiveShadows=!1,!Object(u.a)(o)||r!==i.shaderProgram.id||t){var l=i.shaderProgram,h=i.pass===lM.GLOBE,d=i.pass!==lM.TRANSLUCENT,f=e._isPointLight,p=e._usesDepthTexture,m=Tve.getShadowCastShaderKeyword(f,h,p,d);if(o=n.shaderCache.getDerivedShaderProgram(l,m),!Object(u.a)(o)){var _=l.vertexShaderSource,g=l.fragmentShaderSource,v=Tve.createShadowCastVertexShader(_,f,h),b=Tve.createShadowCastFragmentShader(g,f,p,d);o=n.shaderCache.createDerivedShaderProgram(l,m,{vertexShaderSource:v,fragmentShaderSource:b,attributeLocations:l._attributeLocations})}s=e._primitiveRenderState,f?s=e._pointRenderState:h&&(s=e._terrainRenderState),i.renderState.cull.enabled||((s=Object(nf.a)(s,!1)).cull=Object(nf.a)(s.cull,!1),s.cull.enabled=!1,s=RM.fromCache(s)),c=ube(e,i.uniformMap,h)}return a.shaderProgram=o,a.renderState=s,a.uniformMap=c,a}Cve.createReceiveDerivedCommand=function(e,t,i,n,r){Object(u.a)(r)||(r={});var a=e.length>0,o=t.shaderProgram,s=o.vertexShaderSource,c=o.fragmentShaderSource,l=t.pass===lM.GLOBE,h=!1;if(l&&(h=t.owner.data.pickTerrain.mesh.encoding.hasVertexNormals),t.receiveShadows&&a){var d,f;Object(u.a)(r.receiveCommand)&&(d=r.receiveCommand.shaderProgram,f=r.receiveCommand.uniformMap),r.receiveCommand=cM.shallowClone(t,r.receiveCommand),r.castShadows=!1,r.receiveShadows=!0;var p=r.receiveShaderCastShadows!==t.castShadows,m=r.receiveShaderProgramId!==t.shaderProgram.id;if(!Object(u.a)(d)||m||i||p){var _=Tve.getShadowReceiveShaderKeyword(e[0],t.castShadows,l,h);if(d=n.shaderCache.getDerivedShaderProgram(o,_),!Object(u.a)(d)){var g=Tve.createShadowReceiveVertexShader(s,l,h),v=Tve.createShadowReceiveFragmentShader(c,e[0],t.castShadows,l,h);d=n.shaderCache.createDerivedShaderProgram(o,_,{vertexShaderSource:g,fragmentShaderSource:v,attributeLocations:o._attributeLocations})}f=ube(e[0],t.uniformMap,l)}r.receiveCommand.shaderProgram=d,r.receiveCommand.uniformMap=f,r.receiveShaderProgramId=t.shaderProgram.id,r.receiveShaderCastShadows=t.castShadows}return r},Cve.createCastDerivedCommand=function(e,t,i,n,r){if(Object(u.a)(r)||(r={}),t.castShadows){var a=r.castCommands;Object(u.a)(a)||(a=r.castCommands=[]);var o=r.castShaderProgramId,s=e.length;a.length=s;for(var c=0;c<s;++c)a[c]=hbe(e[c],i,t,n,o,a[c]);r.castShaderProgramId=t.shaderProgram.id}return r},Cve.prototype.isDestroyed=function(){return!1},Cve.prototype.destroy=function(){Ive(this),this._debugLightFrustum=this._debugLightFrustum&&this._debugLightFrustum.destroy(),this._debugCameraFrustum=this._debugCameraFrustum&&this._debugCameraFrustum.destroy(),this._debugShadowViewCommand=this._debugShadowViewCommand&&this._debugShadowViewCommand.shaderProgram&&this._debugShadowViewCommand.shaderProgram.destroy();for(var e=0;e<this._numberOfCascades;++e)this._debugCascadeFrustums[e]=this._debugCascadeFrustums[e]&&this._debugCascadeFrustums[e].destroy();return rl(this)};var dbe=Cve,fbe="uniform sampler2D colorTexture;\nuniform sampler2D colorTexture2;\nuniform vec2 center;\nuniform float radius;\nvarying vec2 v_textureCoordinates;\nvoid main()\n{\nvec4 color0 = texture2D(colorTexture, v_textureCoordinates);\nvec4 color1 = texture2D(colorTexture2, v_textureCoordinates);\nfloat x = length(gl_FragCoord.xy - center) / radius;\nfloat t = smoothstep(0.5, 0.8, x);\ngl_FragColor = mix(color0 + color1, color1, t);\n}\n",pbe="uniform sampler2D colorTexture;\nuniform float avgLuminance;\nuniform float threshold;\nuniform float offset;\nvarying vec2 v_textureCoordinates;\nfloat key(float avg)\n{\nfloat guess = 1.5 - (1.5 / (avg * 0.1 + 1.0));\nreturn max(0.0, guess) + 0.1;\n}\nvoid main()\n{\nvec4 color = texture2D(colorTexture, v_textureCoordinates);\nvec3 xyz = czm_RGBToXYZ(color.rgb);\nfloat luminance = xyz.r;\nfloat scaledLum = key(avgLuminance) * luminance / avgLuminance;\nfloat brightLum = max(scaledLum - threshold, 0.0);\nfloat brightness = brightLum / (offset + brightLum);\nxyz.r = brightness;\ngl_FragColor = vec4(czm_XYZToRGB(xyz), 1.0);\n}\n";function mbe(){this._colorTexture=void 0,this._idTexture=void 0,this._depthStencilTexture=void 0,this._depthStencilRenderbuffer=void 0,this._framebuffer=void 0,this._idFramebuffer=void 0,this._idClearColor=new uf(0,0,0,0),this._useHdr=void 0,this._clearCommand=new fX({color:new uf(0,0,0,0),depth:1,owner:this})}function _be(e){e._framebuffer=e._framebuffer&&e._framebuffer.destroy(),e._idFramebuffer=e._idFramebuffer&&e._idFramebuffer.destroy(),e._colorTexture=e._colorTexture&&e._colorTexture.destroy(),e._idTexture=e._idTexture&&e._idTexture.destroy(),e._depthStencilTexture=e._depthStencilTexture&&e._depthStencilTexture.destroy(),e._depthStencilRenderbuffer=e._depthStencilRenderbuffer&&e._depthStencilRenderbuffer.destroy(),e._depthStencilIdTexture=e._depthStencilIdTexture&&e._depthStencilIdTexture.destroy(),e._depthStencilIdRenderbuffer=e._depthStencilIdRenderbuffer&&e._depthStencilIdRenderbuffer.destroy(),e._framebuffer=void 0,e._idFramebuffer=void 0,e._colorTexture=void 0,e._idTexture=void 0,e._depthStencilTexture=void 0,e._depthStencilRenderbuffer=void 0,e._depthStencilIdTexture=void 0,e._depthStencilIdRenderbuffer=void 0}mbe.prototype.update=function(e,t,i){var n=t.width,r=t.height,a=this._colorTexture;if(!Object(u.a)(a)||a.width!==n||a.height!==r||i!==this._useHdr){_be(this),this._useHdr=i;var o=i?e.halfFloatingPointTexture?mx.HALF_FLOAT:mx.FLOAT:mx.UNSIGNED_BYTE;this._colorTexture=new hj({context:e,width:n,height:r,pixelFormat:gx.RGBA,pixelDatatype:o,sampler:new tj({wrapS:$D.CLAMP_TO_EDGE,wrapT:$D.CLAMP_TO_EDGE,minificationFilter:KD.NEAREST,magnificationFilter:ZD.NEAREST})}),this._idTexture=new hj({context:e,width:n,height:r,pixelFormat:gx.RGBA,pixelDatatype:mx.UNSIGNED_BYTE,sampler:new tj({wrapS:$D.CLAMP_TO_EDGE,wrapT:$D.CLAMP_TO_EDGE,minificationFilter:KD.NEAREST,magnificationFilter:ZD.NEAREST})}),e.depthTexture?(this._depthStencilTexture=new hj({context:e,width:n,height:r,pixelFormat:gx.DEPTH_STENCIL,pixelDatatype:mx.UNSIGNED_INT_24_8,sampler:new tj({wrapS:$D.CLAMP_TO_EDGE,wrapT:$D.CLAMP_TO_EDGE,minificationFilter:KD.NEAREST,magnificationFilter:ZD.NEAREST})}),this._depthStencilIdTexture=new hj({context:e,width:n,height:r,pixelFormat:gx.DEPTH_STENCIL,pixelDatatype:mx.UNSIGNED_INT_24_8,sampler:new tj({wrapS:$D.CLAMP_TO_EDGE,wrapT:$D.CLAMP_TO_EDGE,minificationFilter:KD.NEAREST,magnificationFilter:ZD.NEAREST})})):(this._depthStencilRenderbuffer=new are({context:e,width:n,height:r,format:nre.DEPTH_STENCIL}),this._depthStencilIdRenderbuffer=new are({context:e,width:n,height:r,format:nre.DEPTH_STENCIL})),this._framebuffer=new cj({context:e,colorTextures:[this._colorTexture],depthStencilTexture:this._depthStencilTexture,depthStencilRenderbuffer:this._depthStencilRenderbuffer,destroyAttachments:!1}),this._idFramebuffer=new cj({context:e,colorTextures:[this._idTexture],depthStencilTexture:this._depthStencilIdTexture,depthStencilRenderbuffer:this._depthStencilIdRenderbuffer,destroyAttachments:!1})}},mbe.prototype.clear=function(e,t,i){var n=t.framebuffer;t.framebuffer=this._framebuffer,uf.clone(i,this._clearCommand.color),this._clearCommand.execute(e,t),t.framebuffer=this._idFramebuffer,uf.clone(this._idClearColor,this._clearCommand.color),this._clearCommand.execute(e,t),t.framebuffer=n},mbe.prototype.getFramebuffer=function(){return this._framebuffer},mbe.prototype.getIdFramebuffer=function(){return this._idFramebuffer},mbe.prototype.isDestroyed=function(){return!1},mbe.prototype.destroy=function(){return _be(this),rl(this)};var gbe=mbe;function vbe(){this._sceneFramebuffer=new gbe;var e=new Array(6);e[0]=new hpe({fragmentShader:Ade,textureScale:.125,forcePowerOfTwo:!0,sampleMode:ipe.LINEAR});var t=e[1]=new hpe({fragmentShader:pbe,uniforms:{avgLuminance:.5,threshold:.25,offset:.1},textureScale:.125,forcePowerOfTwo:!0}),i=this;this._delta=1,this._sigma=2,this._blurStep=new Rt,e[2]=new hpe({fragmentShader:Epe,uniforms:{step:function(){return i._blurStep.x=i._blurStep.y=1/t.outputTexture.width,i._blurStep},delta:function(){return i._delta},sigma:function(){return i._sigma},direction:0},textureScale:.125,forcePowerOfTwo:!0}),e[3]=new hpe({fragmentShader:Epe,uniforms:{step:function(){return i._blurStep.x=i._blurStep.y=1/t.outputTexture.width,i._blurStep},delta:function(){return i._delta},sigma:function(){return i._sigma},direction:1},textureScale:.125,forcePowerOfTwo:!0}),e[4]=new hpe({fragmentShader:Ade,sampleMode:ipe.LINEAR}),this._uCenter=new Rt,this._uRadius=void 0,e[5]=new hpe({fragmentShader:fbe,uniforms:{center:function(){return i._uCenter},radius:function(){return i._uRadius},colorTexture2:function(){return i._sceneFramebuffer.getFramebuffer().getColorTexture(0)}}}),this._stages=new Mpe({stages:e});for(var n=new Zpe(this),r=e.length,a=0;a<r;++a)e[a]._textureCache=n;this._textureCache=n,this.length=e.length}vbe.prototype.get=function(e){return this._stages.get(e)},vbe.prototype.getStageByName=function(e){for(var t=this._stages.length,i=0;i<t;++i){var n=this._stages.get(i);if(n.name===e)return n}};var bbe=new Te,ybe=new Rt,wbe=new Rt,Obe=new Be;vbe.prototype.clear=function(e,t,i){this._sceneFramebuffer.clear(e,t,i),this._textureCache.clear(e)},vbe.prototype.update=function(e){var t=e.context,i=e.viewport,n=this._sceneFramebuffer;n.update(t,i);var r=n.getFramebuffer();return this._textureCache.update(t),this._stages.update(t,!1),function(e,t,i){var n=t.uniformState,r=n.sunPositionWC,a=n.view,o=n.viewProjection,s=n.projection,c=Be.computeViewportTransformation(i,0,1,Obe),l=Be.multiplyByPoint(a,r,bbe),u=xa.pointToGLWindowCoordinates(o,c,r,ybe);l.x+=I.SOLAR_RADIUS;var h=xa.pointToGLWindowCoordinates(s,c,l,l),d=30*Rt.magnitude(Rt.subtract(h,u,h))*2,f=wbe;f.x=d,f.y=d,e._uCenter=Rt.clone(u,e._uCenter),e._uRadius=.15*Math.max(f.x,f.y);var p=t.drawingBufferWidth,m=t.drawingBufferHeight,_=e._stages,g=_.get(0),v=g.outputTexture.width,b=g.outputTexture.height,y=new ln;y.width=v,y.height=b,c=Be.computeViewportTransformation(y,0,1,Obe),u=xa.pointToGLWindowCoordinates(o,c,r,ybe),f.x*=v/p,f.y*=b/m;var w=g.scissorRectangle;w.x=Math.max(u.x-.5*f.x,0),w.y=Math.max(u.y-.5*f.y,0),w.width=Math.min(f.x,p),w.height=Math.min(f.y,m);for(var O=1;O<4;++O)ln.clone(w,_.get(O).scissorRectangle)}(this,t,i),r},vbe.prototype.execute=function(e){var t=this._sceneFramebuffer.getFramebuffer().getColorTexture(0),i=this._stages,n=i.length;i.get(0).execute(e,t);for(var r=1;r<n;++r)i.get(r).execute(e,i.get(r-1).outputTexture)},vbe.prototype.copy=function(e,t){if(!Object(u.a)(this._copyColorCommand)){var i=this;this._copyColorCommand=e.createViewportQuadCommand(Ade,{uniformMap:{colorTexture:function(){return i._stages.get(i._stages.length-1).outputTexture}},owner:this})}this._copyColorCommand.framebuffer=t,this._copyColorCommand.execute(e)},vbe.prototype.isDestroyed=function(){return!1},vbe.prototype.destroy=function(){return this._textureCache.destroy(),this._stages.destroy(),rl(this)};var xbe=vbe;function Ebe(e,t,i){var n,r,a=e.context,o=[],s=t.frustum.near,c=t.frustum.far,l=e.logarithmicDepthBuffer?e.logarithmicDepthFarToNearRatio:e.farToNearRatio;Abe(s,c,l,Math.ceil(Math.log(c/s)/Math.log(l)),e.logarithmicDepthBuffer,o,!1,void 0),a.depthTexture&&(n=new Fde),e._useOIT&&a.depthTexture&&(r=new Ofe(a));var u=new bne(a);u.viewport=ln.clone(i),this.camera=t,this._cameraClone=ose.clone(t),this._cameraStartFired=!1,this._cameraMovedTime=void 0,this.viewport=i,this.passState=u,this.pickFramebuffer=new tpe(a),this.pickDepthFramebuffer=new Jfe,this.sceneFramebuffer=new gbe,this.globeDepth=n,this.oit=r,this.pickDepths=[],this.debugGlobeDepths=[],this.frustumCommandsList=o,this.debugFrustumStatistics=void 0,this.updateFrustums=!1}var Tbe=new z,Cbe=new z;function Sbe(e,t,i){var n=1/Math.max(1,function(e,t){var i=Math.max(Math.abs(e.x),Math.abs(t.x)),n=Math.max(Math.abs(e.y),Math.abs(t.y)),r=Math.max(Math.abs(e.z),Math.abs(t.z));return Math.max(Math.max(i,n),r)}(e.position,t.position));return z.multiplyByScalar(e.position,n,Tbe),z.multiplyByScalar(t.position,n,Cbe),z.equalsEpsilon(Tbe,Cbe,i)&&z.equalsEpsilon(e.direction,t.direction,i)&&z.equalsEpsilon(e.up,t.up,i)&&z.equalsEpsilon(e.right,t.right,i)&&Be.equalsEpsilon(e.transform,t.transform,i)&&e.frustum.equalsEpsilon(t.frustum,i)}function Abe(e,t,i,n,r,a,o,s){a.length=n;for(var c=0;c<n;++c){var l,h;o?(l=Math.min(t-s,e+c*s),h=Math.min(t,l+s)):(h=i*(l=Math.max(e,Math.pow(i,c)*e)),r||(h=Math.min(t,h)));var d=a[c];Object(u.a)(d)?(d.near=l,d.far=h):d=a[c]=new Aue(l,h)}}function Pbe(e,t,i,n){e.debugShowFrustums&&(i.debugOverlappingFrustums=0);for(var r=t.frustumCommandsList,a=r.length,o=0;o<a;++o){var s=r[o],c=s.near,l=s.far;if(!(n.start>l)){if(n.stop<c)break;var h=i.pass,d=s.indices[h]++;if(s.commands[h][d]=i,e.debugShowFrustums&&(i.debugOverlappingFrustums|=1<<o),i.executeInClosestFrustum)break}}if(e.debugShowFrustums){var f=t.debugFrustumStatistics.commandsInFrustums;f[i.debugOverlappingFrustums]=Object(u.a)(f[i.debugOverlappingFrustums])?f[i.debugOverlappingFrustums]+1:1,++t.debugFrustumStatistics.totalCommands}e.updateDerivedCommands(i)}Ebe.prototype.checkForCameraUpdates=function(e){var t=this.camera,i=this._cameraClone;return Sbe(t,i,I.EPSILON10)?(this._cameraStartFired&&Qd()-this._cameraMovedTime>e.cameraEventWaitTime&&(t.moveEnd.raiseEvent(),this._cameraStartFired=!1),!1):(this._cameraStartFired||(t.moveStart.raiseEvent(),this._cameraStartFired=!0),this._cameraMovedTime=Qd(),ose.clone(t,i),this.camera.changed.raiseEvent(),!0)};var Ibe=new Wg,Dbe=new le;Ebe.prototype.createPotentiallyVisibleSet=function(e){var t=e.frameState,i=t.camera,n=i.directionWC,r=i.positionWC,a=e._computeCommandList,o=e._overlayCommandList,s=t.commandList;e.debugShowFrustums&&(this.debugFrustumStatistics={totalCommands:0,commandsInFrustums:{}});for(var c=this.frustumCommandsList,l=c.length,h=lM.NUMBER_OF_PASSES,d=0;d<l;++d)for(var f=0;f<h;++f)c[d].indices[f]=0;a.length=0,o.length=0;for(var p=Number.MAX_VALUE,m=-Number.MAX_VALUE,_=!1,g=t.shadowState.shadowsEnabled,v=Number.MAX_VALUE,b=-Number.MAX_VALUE,y=Number.MAX_VALUE,w=t.mode===xF.SCENE3D?t.occluder:void 0,O=t.cullingVolume,x=Ibe.planes,E=0;E<5;++E)x[E]=O.planes[E];O=Ibe;for(var T=s.length,C=0;C<T;++C){var S=s[C],A=S.pass;if(A===lM.COMPUTE)a.push(S);else if(A===lM.OVERLAY)o.push(S);else{var P=S.boundingVolume;if(Object(u.a)(P)){if(!e.isVisible(S,O,w))continue;if(Dbe=P.computePlaneDistances(r,n,Dbe),p=Math.min(p,Dbe.start),m=Math.max(m,Dbe.stop),g&&S.receiveShadows&&Dbe.start<dbe.MAXIMUM_DISTANCE&&!(A===lM.GLOBE&&Dbe.start<-100&&Dbe.stop>100)){var D=Dbe.stop-Dbe.start;A!==lM.GLOBE&&Dbe.start<100&&(y=Math.min(y,D)),v=Math.min(v,Dbe.start),b=Math.max(b,Dbe.stop)}}else Dbe.start=i.frustum.near,Dbe.stop=i.frustum.far,_=!(S instanceof fX);Pbe(e,this,S,Dbe)}}_?(p=i.frustum.near,m=i.frustum.far):(p=Math.min(Math.max(p,i.frustum.near),i.frustum.far),m=Math.max(Math.min(m,i.frustum.far),p),g&&(v=Math.min(Math.max(v,i.frustum.near),i.frustum.far),b=Math.max(Math.min(b,i.frustum.far),v))),g&&(t.shadowState.nearPlane=v,t.shadowState.farPlane=b,t.shadowState.closestObjectSize=y);var j,M=e.mode===xF.SCENE2D,R=t.useLogDepth,L=R?e.logarithmicDepthFarToNearRatio:e.farToNearRatio;M?(m=Math.min(m,i.position.z+e.nearToFarDistance2D),p=Math.min(p,m),j=Math.ceil(Math.max(1,m-p)/e.nearToFarDistance2D)):j=Math.ceil(Math.log(m/p)/Math.log(L)),(this.updateFrustums||p!==Number.MAX_VALUE&&(j!==l||0!==c.length&&(p<c[0].near||m>c[l-1].far&&(R||!I.equalsEpsilon(m,c[l-1].far,I.EPSILON8)))))&&(this.updateFrustums=!1,Abe(p,m,L,j,R,c,M,e.nearToFarDistance2D),this.createPotentiallyVisibleSet(e));var N=t.frustumSplits;N.length=j+1;for(var F=0;F<j;++F)N[F]=c[F].near,F===j-1&&(N[F+1]=c[F].far)},Ebe.prototype.destroy=function(){var e,t;this.pickFramebuffer=this.pickFramebuffer&&this.pickFramebuffer.destroy(),this.pickDepthFramebuffer=this.pickDepthFramebuffer&&this.pickDepthFramebuffer.destroy(),this.sceneFramebuffer=this.sceneFramebuffer&&this.sceneFramebuffer.destroy(),this.globeDepth=this.globeDepth&&this.globeDepth.destroy(),this.oit=this.oit&&this.oit.destroy();var i=this.pickDepths,n=this.debugGlobeDepths;for(t=i.length,e=0;e<t;++e)i[e].destroy();for(t=n.length,e=0;e<t;++e)n[e].destroy()};var jbe=Ebe;function Mbe(e){this._water=[],this._scene=e}Object(O.a)(Mbe.prototype,{length:{get:function(){return this._water.length}}}),Mbe.prototype.add=function(e){this._water.push(e),this._scene.primitives.add(e)},Mbe.prototype.remove=function(e){var t=this._water.indexOf(e);-1!==t&&this._water.splice(t,1),this._scene.primitives.remove(e)};var Rbe=Mbe;function Lbe(){}Lbe.getShadowCastShaderKeyword=function(e,t,i,n){return"castShadow "+e+" "+t+" "+i+" "+n},Lbe.createShadowCastVertexShader=function(e,t,i){var n=e.defines.slice(0),r=e.sources.slice(0);e.defines.push("SHADOW_MAP"),i&&n.push("GENERATE_POSITION");var a=UN.findPositionVarying(e),o=Object(u.a)(a);if(t&&!o){for(var s=r.length,c=0;c<s;++c)r[c]=UN.replaceMain(r[c],"czm_shadow_cast_main");r.push("varying vec3 v_positionEC; \nvoid main() \n{ \n    czm_shadow_cast_main(); \n    v_positionEC = (czm_inverseProjection * gl_Position).xyz; \n}")}return new UN({defines:n,sources:r})},Lbe.createShadowCastFragmentShader=function(e,t,i,n){var r=e.defines.slice(0),a=e.sources.slice(0),o=UN.findPositionVarying(e),s=Object(u.a)(o);s||(o="v_positionEC");for(var c=a.length,l=0;l<c;++l)a[l]=UN.replaceMain(a[l],"czm_shadow_cast_main");var h="";return t&&(s||(h+="varying vec3 v_positionEC; \n"),h+="uniform vec4 shadowMap_lightPositionEC; \n"),h+=n?"void main() \n{ \n":"void main() \n{ \n    czm_shadow_cast_main(); \n    if (gl_FragColor.a == 0.0) \n    { \n       discard; \n    } \n",h+=t?"    float distance = length("+o+"); \n    if (distance >= shadowMap_lightPositionEC.w) \n    { \n        discard; \n    } \n    distance /= shadowMap_lightPositionEC.w; // radius \n    gl_FragColor = czm_packDepth(distance); \n":i?"    gl_FragColor = vec4(1.0); \n":"    gl_FragColor = czm_packDepth(gl_FragCoord.z); \n",h+="} \n",a.push(h),new UN({defines:r,sources:a})},Lbe.getShadowReceiveShaderKeyword=function(e,t,i,n){return"receiveShadow "+e._usesDepthTexture+e._polygonOffsetSupported+e._isPointLight+e._isSpotLight+(e._numberOfCascades>1)+e.debugCascadeColors+e.softShadows+t+i+n},Lbe.createShadowReceiveVertexShader=function(e,t,i){var n=e.defines.slice(0),r=e.sources.slice(0);return e.defines.push("SHADOW_MAP"),t&&(i?n.push("GENERATE_POSITION_AND_NORMAL"):n.push("GENERATE_POSITION")),new UN({defines:n,sources:r})},Lbe.createShadowReceiveFragmentShader=function(e,t,i,n,r,a){for(var o=UN.findNormalVarying(e),s=!n&&Object(u.a)(o)||n&&r,c=UN.findPositionVarying(e),l=Object(u.a)(c),h=t._usesDepthTexture,d=t._polygonOffsetSupported,f=t._isPointLight,p=t._isSpotLight,m=t._numberOfCascades>1,_=t.debugCascadeColors,g=t.softShadows,v=f?t._pointBias:n?t._terrainBias:t._primitiveBias,b=e.defines.slice(0),y=e.sources.slice(0),w=y.length,O=0;O<w;++O)y[O]=UN.replaceMain(y[O],"czm_shadow_receive_main");f?b.push("USE_CUBE_MAP_SHADOW"):h&&b.push("USE_SHADOW_DEPTH_TEXTURE"),g&&!f&&b.push("USE_SOFT_SHADOWS"),m&&i&&n&&(s?b.push("ENABLE_VERTEX_LIGHTING"):b.push("ENABLE_DAYNIGHT_SHADING")),i&&v.normalShading&&s&&(b.push("USE_NORMAL_SHADING"),v.normalShadingSmooth>0&&b.push("USE_NORMAL_SHADING_SMOOTH"));var x="";return f?x+="uniform samplerCube shadowMap_textureCube; \n":(x+="uniform sampler2D shadowMap_texture; \n",x+="uniform sampler2D video_texture; \n"),x+="uniform mat4 shadowMap_matrix; \nuniform vec3 shadowMap_lightDirectionEC; \nuniform vec4 shadowMap_lightPositionEC; \nuniform vec4 shadowMap_normalOffsetScaleDistanceMaxDistanceAndDarkness; \nuniform vec4 shadowMap_texelSizeDepthBiasAndNormalShadingSmooth; \n#ifdef LOG_DEPTH \nvarying vec3 v_logPositionEC; \n#endif \nvec4 getPositionEC() \n{ \n"+(l?"    return vec4("+c+", 1.0); \n":"#ifndef LOG_DEPTH \n    return czm_windowToEyeCoordinates(gl_FragCoord); \n#else \n    return vec4(v_logPositionEC, 1.0); \n#endif \n")+"} \nvec3 getNormalEC() \n{ \n"+(s?"    return normalize("+o+"); \n":"    return vec3(1.0); \n")+"} \nvoid applyNormalOffset(inout vec4 positionEC, vec3 normalEC, float nDotL) \n{ \n"+(v.normalOffset&&s?"    float normalOffset = shadowMap_normalOffsetScaleDistanceMaxDistanceAndDarkness.x; \n    float normalOffsetScale = 1.0 - nDotL; \n    vec3 offset = normalOffset * normalOffsetScale * normalEC; \n    positionEC.xyz += offset; \n":"")+"} \n",x+="void main() \n{ \n    czm_shadow_receive_main(); \n    vec4 positionEC = getPositionEC(); \n    vec3 normalEC = getNormalEC(); \n    float depth = -positionEC.z; \n",x+="    czm_shadowParameters shadowParameters; \n    shadowParameters.texelStepSize = shadowMap_texelSizeDepthBiasAndNormalShadingSmooth.xy; \n    shadowParameters.depthBias = shadowMap_texelSizeDepthBiasAndNormalShadingSmooth.z; \n    shadowParameters.normalShadingSmooth = shadowMap_texelSizeDepthBiasAndNormalShadingSmooth.w; \n    shadowParameters.darkness = shadowMap_normalOffsetScaleDistanceMaxDistanceAndDarkness.w; \n",n?x+="    shadowParameters.depthBias *= max(depth * 0.01, 1.0); \n":d||(x+="    shadowParameters.depthBias *= mix(1.0, 100.0, depth * 0.0015); \n"),x+=f?"    vec3 directionEC = positionEC.xyz - shadowMap_lightPositionEC.xyz; \n    float distance = length(directionEC); \n    directionEC = normalize(directionEC); \n    float radius = shadowMap_lightPositionEC.w; \n    // Stop early if the fragment is beyond the point light radius \n    if (distance > radius) \n    { \n        return; \n    } \n    vec3 directionWC  = czm_inverseViewRotation * directionEC; \n    shadowParameters.depth = distance / radius; \n    shadowParameters.nDotL = clamp(dot(normalEC, -directionEC), 0.0, 1.0); \n    shadowParameters.texCoords = directionWC; \n    float visibility = czm_shadowVisibility(shadowMap_textureCube, shadowParameters); \n":p?"    vec3 directionEC = normalize(positionEC.xyz - shadowMap_lightPositionEC.xyz); \n    float nDotL = clamp(dot(normalEC, -directionEC), 0.0, 1.0); \n    applyNormalOffset(positionEC, normalEC, nDotL); \n    vec4 shadowPosition = shadowMap_matrix * positionEC; \n    // Spot light uses a perspective projection, so perform the perspective divide \n    shadowPosition /= shadowPosition.w; \n    // Stop early if the fragment is not in the shadow bounds \n    if (any(lessThan(shadowPosition.xyz, vec3(0.0))) || any(greaterThan(shadowPosition.xyz, vec3(1.0)))) \n    { \n        return; \n    } \n    shadowParameters.texCoords = shadowPosition.xy; \n    shadowParameters.depth = shadowPosition.z; \n    shadowParameters.nDotL = nDotL; \n    float visibility = czm_shadowVisibility(shadowMap_texture, shadowParameters); \n":m?"    float maxDepth = shadowMap_cascadeSplits[1].w; \n    // Stop early if the eye depth exceeds the last cascade \n    if (depth > maxDepth) \n    { \n        return; \n    } \n    // Get the cascade based on the eye-space depth \n    vec4 weights = czm_cascadeWeights(depth); \n    // Apply normal offset \n    float nDotL = clamp(dot(normalEC, shadowMap_lightDirectionEC), 0.0, 1.0); \n    applyNormalOffset(positionEC, normalEC, nDotL); \n    // Transform position into the cascade \n    vec4 shadowPosition = czm_cascadeMatrix(weights) * positionEC; \n    // Get visibility \n    shadowParameters.texCoords = shadowPosition.xy; \n    shadowParameters.depth = shadowPosition.z; \n    shadowParameters.nDotL = nDotL; \n    float visibility = czm_shadowVisibility(shadowMap_texture, shadowParameters); \n    // Fade out shadows that are far away \n    float shadowMapMaximumDistance = shadowMap_normalOffsetScaleDistanceMaxDistanceAndDarkness.z; \n    float fade = max((depth - shadowMapMaximumDistance * 0.8) / (shadowMapMaximumDistance * 0.2), 0.0); \n    visibility = mix(visibility, 1.0, fade); \n"+(_?"    // Draw cascade colors for debugging \n    gl_FragColor *= czm_cascadeColor(weights); \n":""):"    float nDotL = clamp(dot(normalEC, shadowMap_lightDirectionEC), 0.0, 1.0); \n    applyNormalOffset(positionEC, normalEC, nDotL); \n    vec4 shadowPosition = shadowMap_matrix * positionEC; \n    // Stop early if the fragment is not in the shadow bounds \n    if (any(lessThan(shadowPosition.xyz, vec3(0.0))) || any(greaterThan(shadowPosition.xyz, vec3(1.0)))) \n    { \n        return; \n    } \n    shadowParameters.texCoords = shadowPosition.xy; \n    shadowParameters.depth = shadowPosition.z; \n    shadowParameters.nDotL = nDotL; \n    float visibility = czm_shadowVisibility(shadowMap_texture, shadowParameters); \n",x+="if(visibility != 1.0){ \n}else{\n vec4 col = texture2D(video_texture,shadowPosition.xy);\n  gl_FragColor.rgb = mix(gl_FragColor.rgb,col.rgb,"+a.toFixed(1)+"); \n} \n} \n",y.push(x),new UN({defines:b,sources:y})};var Nbe=Lbe,Fbe="uniform vec4 u_bgColor;\nvoid main()\n{\ngl_FragColor = u_bgColor;\n}\n",kbe="attribute vec3 position;\nuniform mat4 u_modelViewMatrix;\nvoid main()\n{\ngl_Position = czm_projection* u_modelViewMatrix* vec4(position.xyz,1.0);\n}\n";function Bbe(e){var t=(e=Object(w.a)(e,w.a.EMPTY_OBJECT)).context;if(!Object(u.a)(t))throw new h.a("context is required.");if(!Object(u.a)(e.lightCamera))throw new h.a("lightCamera is required.");if(Object(u.a)(e.numberOfCascades)&&1!==e.numberOfCascades&&4!==e.numberOfCascades)throw new h.a("Only one or four cascades are supported.");this._enabled=Object(w.a)(e.enabled,!0),this._softShadows=Object(w.a)(e.softShadows,!1),this._normalOffset=Object(w.a)(e.normalOffset,!0),this.dirty=!0,this.fromLightSource=Object(w.a)(e.fromLightSource,!0),this.darkness=Object(w.a)(e.darkness,.3),this._darkness=this.darkness,this.maximumDistance=Object(w.a)(e.maximumDistance,5e3),this._outOfView=!1,this._outOfViewPrevious=!1,this._needsUpdate=!0;var i,n=!0;(Ri.isInternetExplorer()||Ri.isEdge()||(Ri.isChrome()||Ri.isFirefox())&&Ri.isWindows()&&!t.depthTexture)&&(n=!1),this._polygonOffsetSupported=n,this._terrainBias={polygonOffset:n,polygonOffsetFactor:1.1,polygonOffsetUnits:4,normalOffset:this._normalOffset,normalOffsetScale:.5,normalShading:!0,normalShadingSmooth:.3,depthBias:1e-4},this._primitiveBias={polygonOffset:n,polygonOffsetFactor:1.1,polygonOffsetUnits:4,normalOffset:this._normalOffset,normalOffsetScale:.1,normalShading:!0,normalShadingSmooth:.05,depthBias:2e-5},this._pointBias={polygonOffset:!1,polygonOffsetFactor:1.1,polygonOffsetUnits:4,normalOffset:this._normalOffset,normalOffsetScale:0,normalShading:!0,normalShadingSmooth:.1,depthBias:5e-4},this._depthAttachment=void 0,this._colorAttachment=void 0,this._shadowMapMatrix=new Be,this._shadowMapTexture=void 0,this._lightDirectionEC=new z,this._lightPositionEC=new Te,this._distance=0,this._videoTexture=e.videoTexture,this._lightCamera=e.lightCamera,this._shadowMapCamera=new nye,this._shadowMapCullingVolume=void 0,this._sceneCamera=void 0,this._boundingSphere=new St,this._isPointLight=Object(w.a)(e.isPointLight,!1),this._pointLightRadius=Object(w.a)(e.pointLightRadius,100),this._cascadesEnabled=!this._isPointLight&&Object(w.a)(e.cascadesEnabled,!0),this._numberOfCascades=this._cascadesEnabled?Object(w.a)(e.numberOfCascades,4):0,this._fitNearFar=!0,this._maximumCascadeDistances=[25,150,700,Number.MAX_VALUE],this._textureSize=new Rt,this._isSpotLight=!1,this._cascadesEnabled?this._shadowMapCamera.frustum=new cb:Object(u.a)(this._lightCamera.frustum.fov)&&(this._isSpotLight=!0),this._cascadeSplits=[new Te,new Te],this._cascadeMatrices=[new Be,new Be,new Be,new Be],this._cascadeDistances=new Te,i=this._isPointLight?6:this._cascadesEnabled?this._numberOfCascades:1,this._passes=new Array(i);for(var r=0;r<i;++r)this._passes[r]=new zbe(t);this.debugShow=!1,this.debugFreezeFrame=!1,this._debugFreezeFrame=!1,this._debugCascadeColors=!1,this._debugLightFrustum=void 0,this._debugCameraFrustum=void 0,this._debugCascadeFrustums=new Array(this._numberOfCascades),this._debugShadowViewCommand=void 0,this._usesDepthTexture=t.depthTexture,this._isPointLight&&(this._usesDepthTexture=!1),this._primitiveRenderState=void 0,this._terrainRenderState=void 0,this._pointRenderState=void 0,Vbe(this),this._clearCommand=new fX({depth:1,color:new uf}),this._clearPassState=new bne(t),this._size=Object(w.a)(e.size,2048),this.size=this._size,this._viewerPosition=Object(w.a)(e.viewerPosition,new z(0,0,0)),this._direction=0,this._pitch=0,this._horizontalFov=60,this._verticalFov=60,this._distance=100,this._targetPoint=new z(0,0,0),this._modelMatrix=new Be,this._lineColor=uf.YELLOW,this._hintLineUpdated=!1,this._initialized=!1,this._cameraUpdated=!1,this._indices=void 0,this._positions=void 0,this._drawLineCommand=void 0,this.setPoseByTargetPoint(Object(w.a)(e.target,new z(0,0,0))),this._alpha=Object(w.a)(e.alpha,1)}function zbe(e){this.camera=new nye,this.passState=new bne(e),this.framebuffer=void 0,this.textureOffsets=void 0,this.commandList=[],this.cullingVolume=void 0}function Ube(e,t){return RM.fromCache({cull:{enabled:!0,face:BD.BACK},depthTest:{enabled:!0},colorMask:{red:e,green:e,blue:e,alpha:e},depthMask:!0,polygonOffset:{enabled:t.polygonOffset,factor:t.polygonOffsetFactor,units:t.polygonOffsetUnits}})}function Vbe(e){var t=!e._usesDepthTexture;e._primitiveRenderState=Ube(t,e._primitiveBias),e._terrainRenderState=Ube(t,e._terrainBias),e._pointRenderState=Ube(t,e._pointBias)}function Hbe(e){for(var t=e._passes.length,i=0;i<t;++i){var n=e._passes[i],r=n.framebuffer;Object(u.a)(r)&&!r.isDestroyed()&&r.destroy(),n.framebuffer=void 0}e._depthAttachment=e._depthAttachment&&e._depthAttachment.destroy(),e._colorAttachment=e._colorAttachment&&e._colorAttachment.destroy()}function Gbe(){return new tj({wrapS:$D.CLAMP_TO_EDGE,wrapT:$D.CLAMP_TO_EDGE,minificationFilter:KD.NEAREST,magnificationFilter:ZD.NEAREST})}function qbe(e,t){e._isPointLight?function(e,t){for(var i=new are({context:t,width:e._textureSize.x,height:e._textureSize.y,format:nre.DEPTH_COMPONENT16}),n=new nj({context:t,width:e._textureSize.x,height:e._textureSize.y,pixelFormat:gx.RGBA,pixelDatatype:mx.UNSIGNED_BYTE,sampler:Gbe()}),r=[n.negativeX,n.negativeY,n.negativeZ,n.positiveX,n.positiveY,n.positiveZ],a=0;a<6;++a){var o=new cj({context:t,depthRenderbuffer:i,colorTextures:[r[a]],destroyAttachments:!1}),s=e._passes[a];s.framebuffer=o,s.passState.framebuffer=o}e._shadowMapTexture=n,e._depthAttachment=i,e._colorAttachment=n}(e,t):e._usesDepthTexture?function(e,t){for(var i=new hj({context:t,width:e._textureSize.x,height:e._textureSize.y,pixelFormat:gx.DEPTH_STENCIL,pixelDatatype:mx.UNSIGNED_INT_24_8,sampler:Gbe()}),n=new cj({context:t,depthStencilTexture:i,destroyAttachments:!1}),r=e._passes.length,a=0;a<r;++a){var o=e._passes[a];o.framebuffer=n,o.passState.framebuffer=n}e._shadowMapTexture=i,e._depthAttachment=i}(e,t):function(e,t){for(var i=new are({context:t,width:e._textureSize.x,height:e._textureSize.y,format:nre.DEPTH_COMPONENT16}),n=new hj({context:t,width:e._textureSize.x,height:e._textureSize.y,pixelFormat:gx.RGBA,pixelDatatype:mx.UNSIGNED_BYTE,sampler:Gbe()}),r=new cj({context:t,depthRenderbuffer:i,colorTextures:[n],destroyAttachments:!1}),a=e._passes.length,o=0;o<a;++o){var s=e._passes[o];s.framebuffer=r,s.passState.framebuffer=r}e._shadowMapTexture=n,e._depthAttachment=i,e._colorAttachment=n}(e,t)}function Wbe(e,t){Object(u.a)(e._passes[0].framebuffer)&&e._shadowMapTexture.width===e._textureSize.x||(Hbe(e),qbe(e,t),function(e,t){e._usesDepthTexture&&e._passes[0].framebuffer.status!==un.FRAMEBUFFER_COMPLETE&&(e._usesDepthTexture=!1,Vbe(e),Hbe(e),qbe(e,t))}(e,t),Ybe(e,t))}function Ybe(e,t,i){i=Object(w.a)(i,0),(e._isPointLight||0===i)&&(e._clearCommand.framebuffer=e._passes[i].framebuffer,e._clearCommand.execute(t,e._clearPassState))}Bbe.prototype.setPoseByHeading=function(e){this._direction=e,this._cameraUpdated=!1},Bbe.prototype.setPoseByPitch=function(e){this._pitch=e,this._cameraUpdated=!1},Bbe.prototype.setPoseByRoll=function(e){this._roll=e,this._cameraUpdated=!1},Bbe.prototype.setPoseByTargetPoint=function(e){this._distance=z.distance(this._viewerPosition,e);var t=new z,i=xa.eastNorthUpToFixedFrame(this._viewerPosition);Be.inverse(i,i),Be.multiplyByPoint(i,e,t),z.normalize(t,t),this._direction=I.toDegrees(Math.atan2(t.x,t.y)),this._pitch=I.toDegrees(Math.asin(t.z)),this._cameraUpdated=!1},Bbe.prototype._initialize=function(){this._positions=new Float32Array(633),this._indices=new Uint16Array(408);var e=this._indices,t=0;e[t++]=0,e[t++]=1,e[t++]=0,e[t++]=21,e[t++]=0,e[t++]=85,e[t++]=0,e[t++]=105;for(var i=0,n=0;n<5;++n){i++;for(var r=0;r<20;++r)e[t++]=i++,e[t++]=i}i++;for(var a=0;a<20;++a)for(var o=0;o<5;++o)e[t++]=i,e[t++]=5+i++;this._initialized=!0},Bbe.prototype._updateCamera=function(){this._lightCamera.setView({destination:this._viewerPosition,orientation:{heading:I.toRadians(this._direction),pitch:I.toRadians(this._pitch)}}),this._modelMatrix=this._lightCamera.inverseViewMatrix,this._cameraUpdated=!0},Bbe.prototype._updateHintLine=function(e){var t,i;this._distance=50;var n=this._positions,r=I.toRadians(this._horizontalFov),a=I.toRadians(this._verticalFov),o=Math.tan(.5*r),s=Math.tan(.5*a);t=this._distance*o,i=this._distance*s;var c=new z(-t,-i,-this._distance),l=new z(t,i,0);Be.multiplyByPoint(this._modelMatrix,c,c),Be.multiplyByPoint(this._modelMatrix,l,l);var h=St.fromCornerPoints(c,l);if(e.cullingVolume.computeVisibility(h)!==ce.OUTSIDE){this._valid=!0;var d,f,p=0;n[p++]=0,n[p++]=0,n[p++]=0;for(var m=Math.PI-.5*r,_=r/4,g=0;g<5;++g){d=m+g*_;for(var v=i/(this._distance/Math.cos(d)),b=Math.atan(v),y=-b,w=b/10,O=0;O<21;++O)f=y+O*w,n[p++]=this._distance*Math.cos(f)*Math.sin(d),n[p++]=this._distance*Math.sin(f),n[p++]=this._distance*Math.cos(f)*Math.cos(d)}_=r/20;for(var x=0;x<21;++x){d=m+x*_;for(var E=i/(this._distance/Math.cos(d)),T=Math.atan(E),C=-T,S=T/2,A=0;A<5;++A)f=C+A*S,n[p++]=this._distance*Math.cos(f)*Math.sin(d),n[p++]=this._distance*Math.sin(f),n[p++]=this._distance*Math.cos(f)*Math.cos(d)}var P=e.context,D=ZN.createIndexBuffer({context:P,typedArray:new Uint32Array(this._indices),usage:YN.STATIC_DRAW,indexDatatype:Sl.UNSIGNED_INT}),j=ZN.createVertexBuffer({context:P,typedArray:dn.createTypedArray(dn.FLOAT,this._positions),usage:YN.STATIC_DRAW}),M=[];M.push({index:0,vertexBuffer:j,componentDatatype:dn.FLOAT,componentsPerAttribute:3,normalize:!1});var R=new tF({context:P,attributes:M,indexBuffer:D});if(Object(u.a)(this._drawLineCommand))this._drawLineCommand.vertexArray.destroy(),this._drawLineCommand.vertexArray=R,this._drawLineCommand.modelMatrix=this._modelMatrix,this._drawLineCommand.boundingVolume=h;else{var L=bR.fromCache({context:P,vertexShaderSource:kbe,fragmentShaderSource:Fbe}),N=RM.fromCache({depthTest:{enabled:!0}}),F=this,k={u_bgColor:function(){return F._lineColor},u_modelViewMatrix:function(){return P.uniformState.modelView}};this._drawLineCommand=new cM({boundingVolume:h,modelMatrix:F._modelMatrix,primitiveType:yn.LINES,vertexArray:R,shaderProgram:L,castShadows:!1,receiveShadows:!1,uniformMap:k,renderState:N,pass:lM.OPAQUE})}this._hintLineUpdated=!0}else this._valid=!1},Bbe.MAXIMUM_DISTANCE=2e4,Bbe.prototype.debugCreateRenderStates=function(){Vbe(this)},Object(O.a)(Bbe.prototype,{enabled:{get:function(){return this._enabled},set:function(e){this.dirty=this._enabled!==e,this._enabled=e}},viewerPosition:{get:function(){return this._viewerPosition},set:function(e){this._viewerPosition=e,this._cameraUpdated=!1}},normalOffset:{get:function(){return this._normalOffset},set:function(e){this.dirty=this._normalOffset!==e,this._normalOffset=e,this._terrainBias.normalOffset=e,this._primitiveBias.normalOffset=e,this._pointBias.normalOffset=e}},softShadows:{get:function(){return this._softShadows},set:function(e){this.dirty=this._softShadows!==e,this._softShadows=e}},size:{get:function(){return this._size},set:function(e){!function(e,t){e._size=t;var i=e._passes,n=i.length,r=e._textureSize;if(e._isPointLight){t=HD.maximumCubeMapSize>=t?t:HD.maximumCubeMapSize,r.x=t,r.y=t;var a=new ln(0,0,t,t);i[0].passState.viewport=a,i[1].passState.viewport=a,i[2].passState.viewport=a,i[3].passState.viewport=a,i[4].passState.viewport=a,i[5].passState.viewport=a}else 1===n?(t=HD.maximumTextureSize>=t?t:HD.maximumTextureSize,r.x=t,r.y=t,i[0].passState.viewport=new ln(0,0,t,t)):4===n&&(t=HD.maximumTextureSize>=2*t?t:HD.maximumTextureSize/2,r.x=2*t,r.y=2*t,i[0].passState.viewport=new ln(0,0,t,t),i[1].passState.viewport=new ln(t,0,t,t),i[2].passState.viewport=new ln(0,t,t,t),i[3].passState.viewport=new ln(t,t,t,t));e._clearPassState.viewport=new ln(0,0,r.x,r.y);for(var o=0;o<n;++o){var s=i[o],c=s.passState.viewport,l=c.x/r.x,u=c.y/r.y,h=c.width/r.x,d=c.height/r.y;s.textureOffsets=new Be(h,0,0,l,0,d,0,u,0,0,1,0,0,0,0,1)}}(this,e)}},outOfView:{get:function(){return this._outOfView}},shadowMapCullingVolume:{get:function(){return this._shadowMapCullingVolume}},passes:{get:function(){return this._passes}},isPointLight:{get:function(){return this._isPointLight}},debugCascadeColors:{get:function(){return this._debugCascadeColors},set:function(e){this.dirty=this._debugCascadeColors!==e,this._debugCascadeColors=e}}});var Xbe=new ln;function Zbe(e,t){var i;i=e._isPointLight?"uniform samplerCube shadowMap_textureCube; \nvarying vec2 v_textureCoordinates; \nvoid main() \n{ \n    vec2 uv = v_textureCoordinates; \n    vec3 dir; \n \n    if (uv.y < 0.5) \n    { \n        if (uv.x < 0.333) \n        { \n            dir.x = -1.0; \n            dir.y = uv.x * 6.0 - 1.0; \n            dir.z = uv.y * 4.0 - 1.0; \n        } \n        else if (uv.x < 0.666) \n        { \n            dir.y = -1.0; \n            dir.x = uv.x * 6.0 - 3.0; \n            dir.z = uv.y * 4.0 - 1.0; \n        } \n        else \n        { \n            dir.z = -1.0; \n            dir.x = uv.x * 6.0 - 5.0; \n            dir.y = uv.y * 4.0 - 1.0; \n        } \n    } \n    else \n    { \n        if (uv.x < 0.333) \n        { \n            dir.x = 1.0; \n            dir.y = uv.x * 6.0 - 1.0; \n            dir.z = uv.y * 4.0 - 3.0; \n        } \n        else if (uv.x < 0.666) \n        { \n            dir.y = 1.0; \n            dir.x = uv.x * 6.0 - 3.0; \n            dir.z = uv.y * 4.0 - 3.0; \n        } \n        else \n        { \n            dir.z = 1.0; \n            dir.x = uv.x * 6.0 - 5.0; \n            dir.y = uv.y * 4.0 - 3.0; \n        } \n    } \n \n    float shadow = czm_unpackDepth(textureCube(shadowMap_textureCube, dir)); \n    gl_FragColor = vec4(vec3(shadow), 1.0); \n} \n":"uniform sampler2D shadowMap_texture; \nvarying vec2 v_textureCoordinates; \nvoid main() \n{ \n"+(e._usesDepthTexture?"    float shadow = texture2D(shadowMap_texture, v_textureCoordinates).r; \n":"    float shadow = czm_unpackDepth(texture2D(shadowMap_texture, v_textureCoordinates)); \n")+"    gl_FragColor = vec4(vec3(shadow), 1.0); \n} \n";var n=t.createViewportQuadCommand(i,{uniformMap:{shadowMap_texture:function(){return e._videoTexture},shadowMap_textureCube:function(){return e._shadowMapTexture}}});return n.pass=lM.OVERLAY,n}Bbe.prototype.updateDebugMode=function(e,t){var i=t.context,n=t.context.drawingBufferWidth,r=t.context.drawingBufferHeight,a=.3*Math.min(n,r),o=Xbe;o.x=n-a,o.y=0,o.width=a,o.height=a;var s=e._debugShadowViewCommand;s=Zbe(e,i),e._debugShadowViewCommand=s,Object(u.a)(s.renderState)&&ln.equals(s.renderState.viewport,o)||(s.renderState=RM.fromCache({viewport:ln.clone(o)})),t.commandList.push(e._debugShadowViewCommand)};var Qbe=new Array(8);Qbe[0]=new Te(-1,-1,-1,1),Qbe[1]=new Te(1,-1,-1,1),Qbe[2]=new Te(1,1,-1,1),Qbe[3]=new Te(-1,1,-1,1),Qbe[4]=new Te(-1,-1,1,1),Qbe[5]=new Te(1,-1,1,1),Qbe[6]=new Te(1,1,1,1),Qbe[7]=new Te(-1,1,1,1);for(var Kbe=new Be,Jbe=new Array(8),$be=0;$be<8;++$be)Jbe[$be]=new Te;var eye=[uf.RED,uf.GREEN,uf.BLUE,uf.MAGENTA],tye=new z;function iye(e,t){!function(e,t){var i=t.context,n=t.context.drawingBufferWidth,r=t.context.drawingBufferHeight,a=.3*Math.min(n,r),o=Xbe;o.x=n-a,o.y=0,o.width=a,o.height=a;var s=e._debugShadowViewCommand;Object(u.a)(s)||(s=Zbe(e,i),e._debugShadowViewCommand=s),Object(u.a)(s.renderState)&&ln.equals(s.renderState.viewport,o)||(s.renderState=RM.fromCache({viewport:ln.clone(o)})),t.commandList.push(e._debugShadowViewCommand)}(e,t);var i=e.debugFreezeFrame&&!e._debugFreezeFrame;if(e._debugFreezeFrame=e.debugFreezeFrame,e.debugFreezeFrame&&(i&&(e._debugCameraFrustum=e._debugCameraFrustum&&e._debugCameraFrustum.destroy(),e._debugCameraFrustum=new Lle({camera:e._sceneCamera,color:uf.CYAN,updateOnChange:!1})),e._debugCameraFrustum.update(t)),e._cascadesEnabled){if(e.debugFreezeFrame){i&&(e._debugLightFrustum=e._debugLightFrustum&&e._debugLightFrustum.destroy(),e._debugLightFrustum=new Lle({camera:e._shadowMapCamera,color:uf.YELLOW,updateOnChange:!1})),e._debugLightFrustum.update(t);for(var n=0;n<e._numberOfCascades;++n)i&&(e._debugCascadeFrustums[n]=e._debugCascadeFrustums[n]&&e._debugCascadeFrustums[n].destroy(),e._debugCascadeFrustums[n]=new Lle({camera:e._passes[n].camera,color:eye[n],updateOnChange:!1})),e._debugCascadeFrustums[n].update(t)}}else if(e._isPointLight){if(!Object(u.a)(e._debugLightFrustum)||e._needsUpdate){var r=e._shadowMapCamera.positionWC,a=Kn.IDENTITY,o=2*e._pointLightRadius,s=z.fromElements(o,o,o,tye),c=Be.fromTranslationQuaternionRotationScale(r,a,s,Kbe);e._debugLightFrustum=e._debugLightFrustum&&e._debugLightFrustum.destroy(),e._debugLightFrustum=function(e,t){var i=new Mu({geometry:new $a({minimum:new z(-.5,-.5,-.5),maximum:new z(.5,.5,.5)}),attributes:{color:df.fromColor(t)}}),n=new Mu({geometry:new NP({radius:.5}),attributes:{color:df.fromColor(t)}});return new ck({geometryInstances:[i,n],appearance:new $j({translucent:!1,flat:!0}),asynchronous:!1,modelMatrix:e})}(c,uf.YELLOW)}e._debugLightFrustum.update(t)}else Object(u.a)(e._debugLightFrustum)&&!e._needsUpdate||(e._debugLightFrustum=new Lle({camera:e._shadowMapCamera,color:uf.YELLOW,updateOnChange:!1})),e._debugLightFrustum.update(t)}function nye(){this.viewMatrix=new Be,this.inverseViewMatrix=new Be,this.frustum=void 0,this.positionCartographic=new K,this.positionWC=new z,this.directionWC=z.clone(z.UNIT_Z),this.upWC=z.clone(z.UNIT_Y),this.rightWC=z.clone(z.UNIT_X),this.viewProjectionMatrix=new Be}nye.prototype.clone=function(e){Be.clone(e.viewMatrix,this.viewMatrix),Be.clone(e.inverseViewMatrix,this.inverseViewMatrix),this.frustum=e.frustum.clone(this.frustum),K.clone(e.positionCartographic,this.positionCartographic),z.clone(e.positionWC,this.positionWC),z.clone(e.directionWC,this.directionWC),z.clone(e.upWC,this.upWC),z.clone(e.rightWC,this.rightWC)};var rye=new Be(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1);nye.prototype.getViewProjection=function(){var e=this.viewMatrix,t=this.frustum.projectionMatrix;return Be.multiply(t,e,this.viewProjectionMatrix),Be.multiply(rye,this.viewProjectionMatrix,this.viewProjectionMatrix),this.viewProjectionMatrix};var aye=new Array(5),oye=new wb,sye=new Array(4),cye=new z,lye=new z;var uye=new Be,hye=new z,dye=new z,fye=new z;var pye=[new z(-1,0,0),new z(0,-1,0),new z(0,0,-1),new z(1,0,0),new z(0,1,0),new z(0,0,1)],mye=[new z(0,-1,0),new z(0,0,-1),new z(0,-1,0),new z(0,-1,0),new z(0,0,1),new z(0,-1,0)],_ye=[new z(0,0,1),new z(1,0,0),new z(-1,0,0),new z(0,0,-1),new z(1,0,0),new z(1,0,0)];var gye=new z,vye=new z,bye=new St,yye=bye.center;function wye(e,t){var i=t.camera,n=e._lightCamera,r=e._sceneCamera,a=e._shadowMapCamera;e._cascadesEnabled?z.clone(n.directionWC,a.directionWC):e._isPointLight?z.clone(n.positionWC,a.positionWC):a.clone(n);var o,s,c=e._lightDirectionEC;Be.multiplyByPointAsVector(i.viewMatrix,a.directionWC,c),z.normalize(c,c),z.negate(c,c),Be.multiplyByPoint(i.viewMatrix,a.positionWC,e._lightPositionEC),e._lightPositionEC.w=e._pointLightRadius,e._fitNearFar?(o=Math.min(t.shadowState.nearPlane,e.maximumDistance),s=Math.min(t.shadowState.farPlane,e.maximumDistance+1)):(o=i.frustum.near,s=e.maximumDistance),e._sceneCamera=ose.clone(i,r),i.frustum.clone(e._sceneCamera.frustum),e._sceneCamera.frustum.near=o,e._sceneCamera.frustum.far=s,e._distance=s-o,function(e,t){var i=e._sceneCamera,n=e._shadowMapCamera,r=bye;if(e._cascadesEnabled){if(i.frustum.near>=e.maximumDistance)return e._outOfView=!0,void(e._needsUpdate=!1);var a=t.mapProjection.ellipsoid.geodeticSurfaceNormal(i.positionWC,gye),o=z.negate(n.directionWC,vye),s=z.dot(a,o),c=I.clamp(s/.1,0,1);if(e._darkness=I.lerp(1,e.darkness,c),s<0)return e._outOfView=!0,void(e._needsUpdate=!1);e._needsUpdate=!0,e._outOfView=!1}else if(e._isPointLight)r.center=n.positionWC,r.radius=e._pointLightRadius,e._outOfView=t.cullingVolume.computeVisibility(r)===ce.OUTSIDE,e._needsUpdate=!e._outOfView&&!e._boundingSphere.equals(r),St.clone(r,e._boundingSphere);else{var l=n.frustum.far/2,u=z.add(n.positionWC,z.multiplyByScalar(n.directionWC,l,yye),yye);r.center=u,r.radius=l,e._outOfView=t.cullingVolume.computeVisibility(r)===ce.OUTSIDE,e._needsUpdate=!e._outOfView&&!e._boundingSphere.equals(r),St.clone(r,e._boundingSphere)}}(e,t),!e._outOfViewPrevious&&e._outOfView&&(e._needsUpdate=!0),e._outOfViewPrevious=e._outOfView}Bbe.prototype.updateVideoTexture=function(e,t,i,n){Object(u.a)(t)&&e._videoTexture.copyFrom(t),this._initialized||this._initialize(),this._cameraUpdated||this._updateCamera()},Bbe.prototype.update=function(e){if(wye(this,e),this._cameraUpdated||this._updateCamera(),this._needsUpdate)if(Wbe(this,e.context),this._isPointLight&&function(e,t){var i=new wb;i.fov=I.PI_OVER_TWO,i.near=1,i.far=e._pointLightRadius,i.aspectRatio=1;for(var n=0;n<6;++n){var r=e._passes[n].camera;r.positionWC=e._shadowMapCamera.positionWC,r.positionCartographic=t.mapProjection.ellipsoid.cartesianToCartographic(r.positionWC,r.positionCartographic),r.directionWC=pye[n],r.upWC=mye[n],r.rightWC=_ye[n],Be.computeView(r.positionWC,r.directionWC,r.upWC,r.rightWC,r.viewMatrix),Be.inverse(r.viewMatrix,r.inverseViewMatrix),r.frustum=i}}(this,e),this._cascadesEnabled&&(function(e,t){var i=e._shadowMapCamera,n=e._sceneCamera,r=Be.multiply(n.frustum.projectionMatrix,n.viewMatrix,Kbe),a=Be.inverse(r,Kbe),o=i.directionWC,s=n.directionWC,c=z.cross(o,s,hye);s=z.cross(c,o,dye),z.normalize(s,s),z.normalize(c,c);for(var l=z.fromElements(0,0,0,fye),u=Be.computeView(l,o,s,c,uye),h=Be.multiply(u,a,Kbe),d=z.fromElements(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,cye),f=z.fromElements(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE,lye),p=0;p<8;++p){var m=Te.clone(Qbe[p],Jbe[p]);Be.multiplyByVector(h,m,m),z.divideByScalar(m,m.w,m),z.minimumByComponent(m,d,d),z.maximumByComponent(m,f,f)}f.z+=1e3,d.z-=10;var _=fye;_.x=-.5*(d.x+f.x),_.y=-.5*(d.y+f.y),_.z=-f.z;var g=Be.fromTranslation(_,Kbe);u=Be.multiply(g,u,u);var v=.5*(f.x-d.x),b=.5*(f.y-d.y),y=f.z-d.z,w=i.frustum;w.left=-v,w.right=v,w.bottom=-b,w.top=b,w.near=.01,w.far=y,Be.clone(u,i.viewMatrix),Be.inverse(u,i.inverseViewMatrix),Be.getTranslation(i.inverseViewMatrix,i.positionWC),t.mapProjection.ellipsoid.cartesianToCartographic(i.positionWC,i.positionCartographic),z.clone(o,i.directionWC),z.clone(s,i.upWC),z.clone(c,i.rightWC)}(this,e),this._numberOfCascades>1&&function(e,t){var i,n=e._shadowMapCamera,r=e._sceneCamera,a=r.frustum.near,o=r.frustum.far,s=e._numberOfCascades,c=o-a,l=o/a,u=.9,h=!1;t.shadowState.closestObjectSize<200&&(h=!0,u=.9);var d=sye,f=aye;for(f[0]=a,f[s]=o,i=0;i<s;++i){var p=(i+1)/s,m=a*Math.pow(l,p),_=a+c*p,g=I.lerp(_,m,u);f[i+1]=g,d[i]=g-f[i]}if(h){for(i=0;i<s;++i)d[i]=Math.min(d[i],e._maximumCascadeDistances[i]);var v=f[0];for(i=0;i<s-1;++i)v+=d[i],f[i+1]=v}Te.unpack(f,0,e._cascadeSplits[0]),Te.unpack(f,1,e._cascadeSplits[1]),Te.unpack(d,0,e._cascadeDistances);var b=n.frustum,y=b.left,w=b.right,O=b.bottom,x=b.top,E=b.near,T=b.far,C=n.positionWC,S=n.directionWC,A=n.upWC,P=r.frustum.clone(oye),D=n.getViewProjection();for(i=0;i<s;++i){P.near=f[i],P.far=f[i+1];for(var j=Be.multiply(P.projectionMatrix,r.viewMatrix,Kbe),M=Be.inverse(j,Kbe),R=Be.multiply(D,M,Kbe),L=z.fromElements(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,cye),N=z.fromElements(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE,lye),F=0;F<8;++F){var k=Te.clone(Qbe[F],Jbe[F]);Be.multiplyByVector(R,k,k),z.divideByScalar(k,k.w,k),z.minimumByComponent(k,L,L),z.maximumByComponent(k,N,N)}L.x=Math.max(L.x,0),L.y=Math.max(L.y,0),L.z=0,N.x=Math.min(N.x,1),N.y=Math.min(N.y,1),N.z=Math.min(N.z,1);var B=e._passes[i],U=B.camera;U.clone(n);var V=U.frustum;V.left=y+L.x*(w-y),V.right=y+N.x*(w-y),V.bottom=O+L.y*(x-O),V.top=O+N.y*(x-O),V.near=E+L.z*(T-E),V.far=E+N.z*(T-E),B.cullingVolume=U.frustum.computeCullingVolume(C,S,A);var H=e._cascadeMatrices[i];Be.multiply(U.getViewProjection(),r.inverseViewMatrix,H),Be.multiply(B.textureOffsets,H,H)}}(this,e)),this._isPointLight)this._shadowMapCullingVolume=Wg.fromBoundingSphere(this._boundingSphere);else{var t=this._shadowMapCamera,i=t.positionWC,n=t.directionWC,r=t.upWC;this._shadowMapCullingVolume=t.frustum.computeCullingVolume(i,n,r),1===this._passes.length&&this._passes[0].camera.clone(t)}if(1===this._passes.length){var a=this._sceneCamera.inverseViewMatrix;Be.multiply(this._shadowMapCamera.getViewProjection(),a,this._shadowMapMatrix)}this.debugShow&&iye(this,e)},Bbe.prototype.updatePass=function(e,t){Ybe(this,e,t)};var Oye=new Rt;function xye(e,t,i){var n=e._isPointLight?e._pointBias:i?e._terrainBias:e._primitiveBias,r={shadowMap_texture:function(){return e._shadowMapTexture},video_texture:function(){return e._videoTexture},shadowMap_textureCube:function(){return e._shadowMapTexture},shadowMap_matrix:function(){return e._shadowMapMatrix},shadowMap_cascadeSplits:function(){return e._cascadeSplits},shadowMap_cascadeMatrices:function(){return e._cascadeMatrices},shadowMap_lightDirectionEC:function(){return e._lightDirectionEC},shadowMap_lightPositionEC:function(){return e._lightPositionEC},shadowMap_cascadeDistances:function(){return e._cascadeDistances},shadowMap_texelSizeDepthBiasAndNormalShadingSmooth:function(){var t=Oye;return t.x=1/e._textureSize.x,t.y=1/e._textureSize.y,Te.fromElements(t.x,t.y,n.depthBias,n.normalShadingSmooth,this.combinedUniforms1)},shadowMap_normalOffsetScaleDistanceMaxDistanceAndDarkness:function(){return Te.fromElements(n.normalOffsetScale,e._distance,e.maximumDistance,e._darkness,this.combinedUniforms2)},combinedUniforms1:new Te,combinedUniforms2:new Te};return Object(ff.a)(t,r,!1)}function Eye(e,t,i,n,r,a){var o,s,c;if(Object(u.a)(a)&&(o=a.shaderProgram,s=a.renderState,c=a.uniformMap),(a=cM.shallowClone(i,a)).castShadows=!0,a.receiveShadows=!1,!Object(u.a)(o)||r!==i.shaderProgram.id||t){var l=i.shaderProgram,h=i.pass===lM.GLOBE,d=i.pass!==lM.TRANSLUCENT,f=e._isPointLight,p=e._usesDepthTexture,m=Nbe.getShadowCastShaderKeyword(f,h,p,d);if(o=n.shaderCache.getDerivedShaderProgram(l,m),!Object(u.a)(o)){var _=l.vertexShaderSource,g=l.fragmentShaderSource,v=Nbe.createShadowCastVertexShader(_,f,h),b=Nbe.createShadowCastFragmentShader(g,f,p,d);o=n.shaderCache.createDerivedShaderProgram(l,m,{vertexShaderSource:v,fragmentShaderSource:b,attributeLocations:l._attributeLocations})}s=e._primitiveRenderState,f?s=e._pointRenderState:h&&(s=e._terrainRenderState),i.renderState.cull.enabled||((s=Object(nf.a)(s,!1)).cull=Object(nf.a)(s.cull,!1),s.cull.enabled=!1,s=RM.fromCache(s)),c=xye(e,i.uniformMap,h)}return a.shaderProgram=o,a.renderState=s,a.uniformMap=c,a}Bbe.createReceiveDerivedCommand=function(e,t,i,n,r){Object(u.a)(r)||(r={});var a=e.length>0,o=t.shaderProgram,s=o.vertexShaderSource,c=o.fragmentShaderSource,l=t.pass===lM.GLOBE,h=!1;if(l&&(h=t.owner.data.pickTerrain.mesh.encoding.hasVertexNormals),t.receiveShadows&&a){var d,f;Object(u.a)(r.receiveCommand)&&(d=r.receiveCommand.shaderProgram,f=r.receiveCommand.uniformMap),r.receiveCommand=cM.shallowClone(t,r.receiveCommand),r.castShadows=!1,r.receiveShadows=!0;var p=r.receiveShaderCastShadows!==t.castShadows,m=r.receiveShaderProgramId!==t.shaderProgram.id;if(!Object(u.a)(d)||m||i||p){var _=Nbe.getShadowReceiveShaderKeyword(e[0],t.castShadows,l,h);if(d=n.shaderCache.getDerivedShaderProgram(o,_),!Object(u.a)(d)){var g=Nbe.createShadowReceiveVertexShader(s,l,h),v=Nbe.createShadowReceiveFragmentShader(c,e[0],t.castShadows,l,h,e[0]._alpha);d=n.shaderCache.createDerivedShaderProgram(o,_,{vertexShaderSource:g,fragmentShaderSource:v,attributeLocations:o._attributeLocations})}f=xye(e[0],t.uniformMap,l)}r.receiveCommand.shaderProgram=d,r.receiveCommand.uniformMap=f,r.receiveShaderProgramId=t.shaderProgram.id,r.receiveShaderCastShadows=t.castShadows}return r},Bbe.createCastDerivedCommand=function(e,t,i,n,r){if(Object(u.a)(r)||(r={}),t.castShadows){var a=r.castCommands;Object(u.a)(a)||(a=r.castCommands=[]);var o=r.castShaderProgramId,s=e.length;a.length=s;for(var c=0;c<s;++c)a[c]=Eye(e[c],i,t,n,o,a[c]);r.castShaderProgramId=t.shaderProgram.id}return r},Bbe.prototype.isDestroyed=function(){return!1},Bbe.prototype.destroy=function(){Hbe(this),this._debugLightFrustum=this._debugLightFrustum&&this._debugLightFrustum.destroy(),this._debugCameraFrustum=this._debugCameraFrustum&&this._debugCameraFrustum.destroy(),this._debugShadowViewCommand=this._debugShadowViewCommand&&this._debugShadowViewCommand.shaderProgram&&this._debugShadowViewCommand.shaderProgram.destroy();for(var e=0;e<this._numberOfCascades;++e)this._debugCascadeFrustums[e]=this._debugCascadeFrustums[e]&&this._debugCascadeFrustums[e].destroy();return rl(this)};var Tye=Bbe;function Cye(e){this._scene=e,this._cameraChanged=!1,this._startRenderTime=void 0,this._isGradualRender=!1,this._expectFrameNumber=24,this._commandCount=0,this._render3DTileCount=0,this._renderTimes=0,this._totalRenderCommandsCount=0,this._hasCalculated=!1,this._currentFrameRenderRequested=!1,this._commandsStep={},function(e){for(var t in lM)e._commandsStep[t]={length:0,startOffset:0,endOffset:0},e._commandsStep[t+"_ID"]={length:0,startOffset:0,endOffset:0}}(this)}Object(O.a)(Cye.prototype,{cameraChanged:{get:function(){return this._cameraChanged},set:function(e){this._cameraChanged=e}},startRenderTime:{get:function(){return this._startRenderTime},set:function(e){this._startRenderTime=e}},isGradualRender:{get:function(){return this._isGradualRender},set:function(e){this._isGradualRender=e}}}),Cye.prototype.getFrameTime=function(){return 1e3/this._expectFrameNumber},Cye.prototype.isAllRendered=function(){var e=!0;if(this.isGradualRender)for(var t in this._commandsStep){var i=this._commandsStep[t];if(i&&i.length!==i.startOffset){e=!1;break}}return e},Cye.prototype.resetStep=function(){if(this.needUpdateDrawCommand())for(var e in this._commandsStep){var t=this._commandsStep[e];t.length=0,t.startOffset=0}},Cye.prototype.getDrawCommandStartOffset=function(e,t){if(this.needUpdateDrawCommand())return 0;var i=this._commandsStep[e];return i.length===t?i.startOffset:0},Cye.prototype.getDrawCommandEndOffset=function(e,t){var i=this._commandsStep[e];return this.isGradualRender&&this.needUpdateDrawCommand()&&i.endOffset>0&&i.endOffset<t?i.endOffset:t},Cye.prototype.setDrawCommandStep=function(e,t,i,n){var r=this._commandsStep[e];r&&(r.length=t,r.startOffset=i,this.needUpdateDrawCommand()?r.endOffset=n:r.endOffset=0)},Cye.prototype.needToPause=function(){return!(!this.isGradualRender||!this.cameraChanged&&this.isAllRendered()||!(Qd()-this.startRenderTime>this.getFrameTime()))},Cye.prototype.needUpdateDrawCommand=function(){return!this.isGradualRender||(this.cameraChanged||this._currentFrameRenderRequested)},Cye.prototype.getPassName=function(e){for(var t in lM)if(e===lM[t])return t;return""},Cye.prototype.isWaterPassReady=function(){var e=!0;for(var t in this._commandsStep)if("WATER"!==t&&t.indexOf("_ID")<0){var i=this._commandsStep[t];if(i&&i.length!==i.startOffset){e=!1;break}}return e},Cye.prototype.isPassRendered=function(e){var t=this.getPassName(e),i=this._commandsStep[t];return i&&i.length===i.startOffset},Cye.prototype.getPassCommandsLength=function(e){var t=this.getPassName(e),i=this._commandsStep[t];return i?i.length:0};var Sye=Cye,Aye="uniform sampler2D tDiffuse;\nuniform sampler2D tLastFrame;\nuniform float weight1;\nuniform float weight2;\nvarying vec2 v_textureCoordinates;\nvoid main() {\nvec4 color = vec4(0.0);\ncolor += texture2D(tLastFrame, v_textureCoordinates) * weight1;\ncolor += texture2D(tDiffuse, v_textureCoordinates) * weight2;\ngl_FragColor = color;\n}\n";function Pye(){this._jitterIndex=0,this._maxFrameCount=32,this._jitterOffsets=this._generateHaltonJiters(this._maxFrameCount),this._frameCount=0,this._defaultFrameBuffer=void 0,this._copyColorTexture=void 0,this._lastFrameBuffer=void 0,this._copyColorCommand=void 0,this._multipleSamplesFrameBuffer=void 0,this._taaDrawCommand=void 0,this._currentColorTexture=void 0}Object(O.a)(Pye.prototype,{multipleSamplesFrameBuffer:{get:function(){return this._multipleSamplesFrameBuffer}},defaultFrameBuffer:{get:function(){return this._defaultFrameBuffer}}}),Pye.prototype.generateShader=function(e){var t=this,i={tDiffuse:function(){return t._currentColorTexture},tLastFrame:function(){return t._frameCount<1?t._currentColorTexture:t._lastFrameBuffer.getColorTexture(0)},weight1:function(){return t._frameCount<1?0:.9},weight2:function(){return t._frameCount<1?1:.1}};t._taaDrawCommand=e.createViewportQuadCommand(Aye,{uniformMap:i,owner:t}),t._copyColorCommand=e.createViewportQuadCommand(Ade,{uniformMap:{colorTexture:function(){return t._copyColorTexture}},owner:t})},Pye.prototype._generateHaltonJiters=function(e){for(var t=[],i=1;i<=e;i++)t.push([2*this._haltonNumber(2,i)-1,2*this._haltonNumber(3,i)-1]);return t},Pye.prototype._haltonNumber=function(e,t){for(var i=0,n=1/e,r=t;r>0;)i+=n*(r%e),r=Math.floor(r/e),n/=e;return i},Pye.prototype.createFramebuffer=function(e,t){var i=t?e.halfFloatingPointTexture?mx.HALF_FLOAT:mx.FLOAT:mx.UNSIGNED_BYTE,n=new hj({context:e,width:e.drawingBufferWidth,height:e.drawingBufferHeight,pixelFormat:gx.RGBA,pixelDatatype:i}),r=new are({context:e,format:nre.DEPTH_COMPONENT16,width:e.drawingBufferWidth,height:e.drawingBufferHeight});return new cj({context:e,colorTextures:[n],depthRenderbuffer:r})},Pye.prototype.beginFrame=function(e){if(fx.currentFrameTaaEnabled){this._jitterIndex=(this._jitterIndex+1)%this._jitterOffsets.length;var t=e.context,i=t.drawingBufferWidth,n=t.drawingBufferHeight,[r,a]=this._jitterOffsets[this._jitterIndex];fx.jitterOffset=[r/i,a/n]}else{fx.jitterOffset=[0,0],e._frameState.passes.pick||(this._frameCount=0,fx.historicalInvalid&&(fx.historicalInvalid=!1))}},Pye.prototype.render=function(e,t,i){var n=t.framebuffer;this._currentColorTexture=i;var r=e.context;this.resetJitter(e),t.framebuffer=this._multipleSamplesFrameBuffer,this._taaDrawCommand.execute(r,t),this._copyColorTexture=this._multipleSamplesFrameBuffer.getColorTexture(0),this._frameCount+=1,t.framebuffer=this._lastFrameBuffer,this._copyColorCommand.execute(r,t),t.framebuffer=n},Pye.prototype.update=function(e,t,i,n){!function(e,t,i,n,r){var a=e._copyColorTexture,o=!Object(u.a)(a)||a.width!==i||a.height!==n;Object(u.a)(e._defaultFrameBuffer)&&!o||(function(e){e._defaultFrameBuffer=e._defaultFrameBuffer&&!e._defaultFrameBuffer.isDestroyed()&&e._defaultFrameBuffer.destroy(),e._multipleSamplesFrameBuffer=e._multipleSamplesFrameBuffer&&!e._multipleSamplesFrameBuffer.isDestroyed()&&e._multipleSamplesFrameBuffer.destroy(),e._lastFrameBuffer=e._lastFrameBuffer&&!e._lastFrameBuffer.isDestroyed()&&e._lastFrameBuffer.destroy()}(e),function(e,t,i){e._defaultFrameBuffer=e.createFramebuffer(t,i),e._multipleSamplesFrameBuffer=e.createFramebuffer(t,i),e._lastFrameBuffer=e.createFramebuffer(t,i)}(e,t,r))}(this,e,i.width,i.height,n),Object(u.a)(this._taaDrawCommand)||this.generateShader(e)},Pye.prototype.resetJitter=function(e){fx.jitterOffset=[0,0];var t=e.camera;e.context.uniformState.updateFrustum(t.frustum)};var Iye=Pye,Dye="attribute vec4 position;\nattribute vec2 textureCoordinates;\nvarying vec2 vUv;\nvoid main() {\ngl_Position = position;\nvUv = vec2(position.x, position.y) * 0.5 + 0.5;\n}\n",jye="uniform vec3 color1;\nuniform vec3 color2;\nuniform float aspect;\nuniform vec2 offset;\nuniform vec2 scale;\nuniform float noiseAlpha;\nuniform bool aspectCorrection;\nuniform float grainScale;\nuniform float grainTime;\nuniform vec2 smoothRange;\nvarying vec2 vUv;\nvec3 mod289(vec3 x)\n{\nreturn x - floor(x * (1.0 / 289.0)) * 289.0;\n}\nvec4 mod289(vec4 x)\n{\nreturn x - floor(x * (1.0 / 289.0)) * 289.0;\n}\nvec4 permute(vec4 x)\n{\nreturn mod289(((x*34.0)+1.0)*x);\n}\nvec4 taylorInvSqrt(vec4 r)\n{\nreturn 1.79284291400159 - 0.85373472095314 * r;\n}\nvec3 fade(vec3 t) {\nreturn t*t*t*(t*(t*6.0-15.0)+10.0);\n}\nfloat pnoise(vec3 P, vec3 rep)\n{\nvec3 Pi0 = mod(floor(P), rep);\nvec3 Pi1 = mod(Pi0 + vec3(1.0), rep);\nPi0 = mod289(Pi0);\nPi1 = mod289(Pi1);\nvec3 Pf0 = fract(P);\nvec3 Pf1 = Pf0 - vec3(1.0);\nvec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);\nvec4 iy = vec4(Pi0.yy, Pi1.yy);\nvec4 iz0 = Pi0.zzzz;\nvec4 iz1 = Pi1.zzzz;\nvec4 ixy = permute(permute(ix) + iy);\nvec4 ixy0 = permute(ixy + iz0);\nvec4 ixy1 = permute(ixy + iz1);\nvec4 gx0 = ixy0 * (1.0 / 7.0);\nvec4 gy0 = fract(floor(gx0) * (1.0 / 7.0)) - 0.5;\ngx0 = fract(gx0);\nvec4 gz0 = vec4(0.5) - abs(gx0) - abs(gy0);\nvec4 sz0 = step(gz0, vec4(0.0));\ngx0 -= sz0 * (step(0.0, gx0) - 0.5);\ngy0 -= sz0 * (step(0.0, gy0) - 0.5);\nvec4 gx1 = ixy1 * (1.0 / 7.0);\nvec4 gy1 = fract(floor(gx1) * (1.0 / 7.0)) - 0.5;\ngx1 = fract(gx1);\nvec4 gz1 = vec4(0.5) - abs(gx1) - abs(gy1);\nvec4 sz1 = step(gz1, vec4(0.0));\ngx1 -= sz1 * (step(0.0, gx1) - 0.5);\ngy1 -= sz1 * (step(0.0, gy1) - 0.5);\nvec3 g000 = vec3(gx0.x,gy0.x,gz0.x);\nvec3 g100 = vec3(gx0.y,gy0.y,gz0.y);\nvec3 g010 = vec3(gx0.z,gy0.z,gz0.z);\nvec3 g110 = vec3(gx0.w,gy0.w,gz0.w);\nvec3 g001 = vec3(gx1.x,gy1.x,gz1.x);\nvec3 g101 = vec3(gx1.y,gy1.y,gz1.y);\nvec3 g011 = vec3(gx1.z,gy1.z,gz1.z);\nvec3 g111 = vec3(gx1.w,gy1.w,gz1.w);\nvec4 norm0 = taylorInvSqrt(vec4(dot(g000, g000), dot(g010, g010), dot(g100, g100), dot(g110, g110)));\ng000 *= norm0.x;\ng010 *= norm0.y;\ng100 *= norm0.z;\ng110 *= norm0.w;\nvec4 norm1 = taylorInvSqrt(vec4(dot(g001, g001), dot(g011, g011), dot(g101, g101), dot(g111, g111)));\ng001 *= norm1.x;\ng011 *= norm1.y;\ng101 *= norm1.z;\ng111 *= norm1.w;\nfloat n000 = dot(g000, Pf0);\nfloat n100 = dot(g100, vec3(Pf1.x, Pf0.yz));\nfloat n010 = dot(g010, vec3(Pf0.x, Pf1.y, Pf0.z));\nfloat n110 = dot(g110, vec3(Pf1.xy, Pf0.z));\nfloat n001 = dot(g001, vec3(Pf0.xy, Pf1.z));\nfloat n101 = dot(g101, vec3(Pf1.x, Pf0.y, Pf1.z));\nfloat n011 = dot(g011, vec3(Pf0.x, Pf1.yz));\nfloat n111 = dot(g111, Pf1);\nvec3 fade_xyz = fade(Pf0);\nvec4 n_z = mix(vec4(n000, n100, n010, n110), vec4(n001, n101, n011, n111), fade_xyz.z);\nvec2 n_yz = mix(n_z.xy, n_z.zw, fade_xyz.y);\nfloat n_xyz = mix(n_yz.x, n_yz.y, fade_xyz.x);\nreturn 2.2 * n_xyz;\n}\nfloat snoise(vec3 v)\n{\nconst vec2  C = vec2(1.0/6.0, 1.0/3.0) ;\nconst vec4  D = vec4(0.0, 0.5, 1.0, 2.0);\nvec3 i  = floor(v + dot(v, C.yyy) );\nvec3 x0 =   v - i + dot(i, C.xxx) ;\nvec3 g = step(x0.yzx, x0.xyz);\nvec3 l = 1.0 - g;\nvec3 i1 = min( g.xyz, l.zxy );\nvec3 i2 = max( g.xyz, l.zxy );\nvec3 x1 = x0 - i1 + C.xxx;\nvec3 x2 = x0 - i2 + C.yyy;\nvec3 x3 = x0 - D.yyy;\ni = mod289(i);\nvec4 p = permute( permute( permute(\ni.z + vec4(0.0, i1.z, i2.z, 1.0 ))\n+ i.y + vec4(0.0, i1.y, i2.y, 1.0 ))\n+ i.x + vec4(0.0, i1.x, i2.x, 1.0 ));\nfloat n_ = 0.142857142857;\nvec3  ns = n_ * D.wyz - D.xzx;\nvec4 j = p - 49.0 * floor(p * ns.z * ns.z);\nvec4 x_ = floor(j * ns.z);\nvec4 y_ = floor(j - 7.0 * x_ );\nvec4 x = x_ *ns.x + ns.yyyy;\nvec4 y = y_ *ns.x + ns.yyyy;\nvec4 h = 1.0 - abs(x) - abs(y);\nvec4 b0 = vec4( x.xy, y.xy );\nvec4 b1 = vec4( x.zw, y.zw );\nvec4 s0 = floor(b0)*2.0 + 1.0;\nvec4 s1 = floor(b1)*2.0 + 1.0;\nvec4 sh = -step(h, vec4(0.0));\nvec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;\nvec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;\nvec3 p0 = vec3(a0.xy,h.x);\nvec3 p1 = vec3(a0.zw,h.y);\nvec3 p2 = vec3(a1.xy,h.z);\nvec3 p3 = vec3(a1.zw,h.w);\nvec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));\np0 *= norm.x;\np1 *= norm.y;\np2 *= norm.z;\np3 *= norm.w;\nvec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);\nm = m * m;\nreturn 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1),\ndot(p2,x2), dot(p3,x3) ) );\n}\nfloat grain(vec2 texCoord, vec2 resolution, float frame, float multiplier) {\nvec2 mult = texCoord * resolution;\nfloat offset = snoise(vec3(mult / multiplier, frame));\nfloat n1 = pnoise(vec3(mult, offset), vec3(1.0/texCoord * resolution, 1.0));\nreturn n1 / 2.0 + 0.5;\n}\nfloat grain(vec2 texCoord, vec2 resolution, float frame) {\nreturn grain(texCoord, resolution, frame, 2.5);\n}\nfloat grain(vec2 texCoord, vec2 resolution) {\nreturn grain(texCoord, resolution, 0.0);\n}\nvec3 blendSoftLight(vec3 base, vec3 blend) {\nreturn mix(\nsqrt(base) * (2.0 * blend - 1.0) + 2.0 * base * (1.0 - blend),\n2.0 * base * blend + base * base * (1.0 - 2.0 * blend),\nstep(base, vec3(0.5))\n);\n}\nvoid main() {\nvec2 q = vec2(vUv - 0.5);\nif (aspectCorrection) {\nq.x *= aspect;\n}\nq /= scale;\nq -= offset;\nfloat dst = length(q);\ndst = smoothstep(smoothRange.x, smoothRange.y, dst);\nvec3 color = mix(color1, color2, dst);\nif (noiseAlpha > 0.0 && grainScale > 0.0) {\nfloat gSize = 1.0 / grainScale;\nfloat g = grain(vUv, vec2(gSize * aspect, gSize), grainTime);\nvec3 noiseColor = blendSoftLight(color, vec3(g));\ngl_FragColor.rgb = mix(color, noiseColor, noiseAlpha);\n} else {\ngl_FragColor.rgb = color;\n}\ngl_FragColor.a = 1.0;\n}\n";function Mye(e){this._context=e.context,this._offset=new Rt(-.2,.25),this._scale=new Rt(2.5,2.5),this._smoothRange=new Rt(0,1),this._color1=Object(w.a)(e.color1,uf.fromCssColorString("#ffffff")),this._color2=Object(w.a)(e.color2,uf.fromCssColorString("#283844"));var t=this;t._command=this._context.createViewportQuadCommand(jye,{vertexShaderSource:Dye,uniformMap:{aspectCorrection:function(){return!0},aspect:function(){return t._context.drawingBufferWidth/t._context.drawingBufferHeight},grainScale:function(){return 1.5/Math.min(t._context.drawingBufferWidth,t._context.drawingBufferHeight)},grainTime:function(){return 0},noiseAlpha:function(){return.25},offset:function(){return t._offset},scale:function(){return t._scale},smoothRange:function(){return t._smoothRange},color1:function(){return t._color1},color2:function(){return t._color2}},owner:t})}Object(O.a)(Mye.prototype,{color1:{get:function(){return this._color1},set:function(e){this._color1=e}},color2:{get:function(){return this._color2},set:function(e){this._color2=e}}}),Mye.prototype.update=function(e){this._command.execute(this._context,e)};var Rye=Mye,Lye="void main() {\nczm_water_main();\n}\n",Nye="uniform sampler2D mirrorSampler;\nuniform sampler2D normalSampler;\nuniform sampler2D depthTexture;\nuniform float size;\nuniform float reflectFactor;\nuniform float speed;\nuniform vec3 sunColor;\nuniform vec3 waterColor;\nuniform vec2 flowDir;\n#define MAX_STEPS 500\nvec4 getNoise( vec2 uv) {\nvec3 sam = vec3(flowDir, 1.0);\nvec2 flowdir = sam.xy -0.5;\nflowdir *= sam.b;\nmat2 rotmat = mat2(flowdir.x, -flowdir.y, flowdir.y ,flowdir.x);\nvec2 uv0 = ( (rotmat * uv  ) / 103.0 ) + vec2(czm_frameNumber * speed / 17.0, czm_frameNumber * speed / 29.0);\nvec2 uv1 = (rotmat * uv ) / 107.0-vec2( czm_frameNumber * speed / -19.0, czm_frameNumber* speed / 31.0 );\nvec2 uv2 = (rotmat * uv )/ vec2( 8907.0, 9803.0 ) + vec2( czm_frameNumber * speed  / 101.0, czm_frameNumber * speed / 97.0 );\nvec2 uv3 = (rotmat * uv ) / vec2( 1091.0, 1027.0 ) - vec2( czm_frameNumber * speed / 109.0, czm_frameNumber * speed / -113.0 );\nvec4 noise = texture2D( normalSampler, uv0 ) +\ntexture2D( normalSampler, uv1 ) +\ntexture2D( normalSampler, uv2 ) +\ntexture2D( normalSampler, uv3 );\nreturn noise * 0.5 - 1.0;\n}\nvoid sunLight( const vec3 surfaceNormal, const vec3 eyeDirection, float shiny, float spec, inout vec3 diffuseColor, inout vec3 specularColor ) {\nvec3 lightDir = normalize(czm_sunDirectionEC);\ndiffuseColor += max( dot(surfaceNormal, lightDir), 0.0 ) * sunColor;\nvec3 reflection = normalize(reflect(-lightDir, surfaceNormal));\nfloat direction = max(0.0, dot( eyeDirection, reflection ));\nspecularColor += pow(direction, shiny) * sunColor * spec;\n}\nfloat getPositionWComponent(float logZ)\n{\n#ifdef LOG_DEPTH\nfloat near = czm_currentFrustum.x;\nfloat far = czm_currentFrustum.y;\nlogZ = pow(2.0, logZ * czm_log2FarPlusOne) - 1.0;\n#endif\nreturn logZ;\n}\nvec2 normalizedDeviceCoordToScreenCoord(vec2 ndc, vec2 screenSize)\n{\nvec2 screenCoord;\nscreenCoord = screenSize * (ndc + 1.0) * 0.5;\nreturn screenCoord;\n}\nfloat distanceSquared(vec2 a, vec2 b)\n{\na -= b;\nreturn dot(a, a);\n}\nvec3 getReflectColor(vec2 distortion)\n{\nvec4 reflectColor = vec4(0.0, 0.0, 0.0, 0.0);\nvec2 screenSize = czm_viewport.zw;\nvec2 texcoord = gl_FragCoord.xy / screenSize;\nvec3 viewPos = v_positionEC.xyz;\n#ifdef POLYGON_WATER\nvec3 viewNormal = v_normalEC;\n#else\nvec3 viewNormal = normalize((czm_modelViewRotation * vec3(0.0, 1.0, 0.0)));\n#endif\nvec2 origin = gl_FragCoord.xy;\nvec3 v0 = viewPos;\nvec3 vsNormal = viewNormal;\nvec3 eyeToPixel = normalize(v0);\nvec3 reflRay = normalize(reflect(eyeToPixel, vsNormal));\nfloat farPlane = 1000.0;\nvec3 v1 = v0 + reflRay * farPlane;\nvec4 p0 = czm_projection * vec4(v0, 1.0);\nvec4 p1 = czm_projection * vec4(v1, 1.0);\nfloat k0 = 1.0 / p0.w;\nfloat k1 = 1.0 / p1.w;\np0 *= k0;\np1 *= k1;\nv0 *= k0;\nv1 *= k1;\np0.xy = normalizedDeviceCoordToScreenCoord(p0.xy, screenSize.xy);\np1.xy = normalizedDeviceCoordToScreenCoord(p1.xy, screenSize.xy);\nfloat ds = distanceSquared(p1.xy, p0.xy);\np1 += ds < 0.0001 ? 0.01 : 0.0;\nfloat divisions = length(p1.xy - p0.xy);\nvec3 dV = (v1 - v0) / divisions;\nfloat dK = (k1 - k0) / divisions;\nvec2 screenTraceDir = ((p1 - p0) / divisions).xy;\nfor (float stride = 0.5; stride <= float(MAX_STEPS); stride += 0.5) {\nif(stride > divisions){\nbreak;\n}\nvec2 coord = origin + screenTraceDir * stride;\nif (coord.x > screenSize.x || coord.y > screenSize.y || coord.x < 0.0 || coord.y < 0.0){\nbreak;\n}\nfloat curDepth = (v0 + dV * stride).z;\ncurDepth *= -1.0;\nfloat k = k0 + dK * stride;\ncurDepth /= k;\ntexcoord = vec2(coord) / screenSize;\nfloat storeFrontDepth = getPositionWComponent(czm_unpackDepth(texture2D(depthTexture, texcoord)));\nif ((curDepth >= storeFrontDepth) && ((curDepth - storeFrontDepth) <= 0.1)){\nreflectColor = texture2D(mirrorSampler, texcoord + distortion * 0.1);\nbreak;\n}\n}\nreturn reflectColor.xyz;\n}\nvoid main() {\nczm_water_main();\nif (czm_discard)\n{\ndiscard;\n}\nvec3 eyeToPixel = normalize(v_positionEC.xyz);\n#ifdef POLYGON_WATER\nvec3 reflRay = normalize(reflect(eyeToPixel, v_normalEC));\nvec2 uv = fract(repeat_1 * v_st);\nvec4 noise = getNoise( uv * size);\nvec3 surfaceNormal = normalize(czm_normal * noise.xyz);\n#else\nvec3 viewNormal = normalize((czm_modelViewRotation * vec3(0.0, 1.0, 0.0)));\nvec3 reflRay = normalize(reflect(eyeToPixel, viewNormal));\nvec4 noise = getNoise( v_texcoord_0 * size);\nvec3 surfaceNormal = normalize(czm_modelViewRotation * noise.xzy);\n#endif\n#ifdef BIM_MODE\nvec3 reflectedRay = normalize(czm_inverseGltfRotation * czm_inverseSkyBoxModelViewRotation * reflRay);\nvec3 sceneSkyBox = textureCube(czm_environmentMap, reflectedRay).rgb;\n#else\nvec3 sceneSkyBox = vec3(0.0,0.0,0.0);\n#endif\nvec2 final = gl_FragCoord.xy / czm_viewport.zw;\nfloat terrainDepth = getPositionWComponent(czm_unpackDepth(texture2D(depthTexture, final)));\n#ifdef LOG_DEPTH\nfloat currentDepth = v_logZ - 1.0;\n#else\nfloat currentDepth = 1.0/gl_FragCoord.w;\n#endif\nfloat waterDepth = abs(terrainDepth - currentDepth);\nvec3 refractColor = texture2D(mirrorSampler, final).xyz * (1.0 - clamp(waterDepth,0.0,1.0));\nvec3 ambientLight = 0.1 * sunColor;\nvec3 diffuseLight = vec3(0.0);\nvec3 specularLight = vec3(0.0);\nvec3 worldToEye = -v_positionEC;\nvec3 eyeDirection = normalize( worldToEye );\nsunLight( surfaceNormal, eyeDirection, 32.0, 0.5, diffuseLight, specularLight );\nvec3 color = (ambientLight + diffuseLight + specularLight + sceneSkyBox) * (waterColor + refractColor);\n#ifdef REFLECTENABLE\nfloat distance = length(worldToEye);\nfloat distortionScale = 3.0;\nvec2 distortion = surfaceNormal.xz * ( 0.001 + 1.0 / distance ) * distortionScale;\nfloat theta = max( dot( eyeDirection, surfaceNormal ), 0.0 );\nfloat rf0 = 0.3;\nfloat reflectance = rf0 + ( 1.0 - rf0 ) * pow( ( 1.0 - theta ), 5.0 );\nvec3 reflectionSample = getReflectColor(distortion);\nvec3 albedo = mix(color, ( vec3( 0.1 ) + reflectionSample * 0.9 + reflectionSample * specularLight ), reflectance * reflectFactor );\n#else\nvec3 albedo = color;\n#endif\nvec3 outgoingLight = albedo;\ngl_FragColor = vec4( outgoingLight, 1.0);\n}\n";function Fye(e){var t;this._scene=e.scene,this._flowAngle=0,this._flowDir=new Rt(.5*Math.sin(this._flowAngle)+.5,.5*Math.cos(this._flowAngle)+.5),this._waterColor=new uf(28/255,60/255,80/255),this._speed=.05,this._sunColor=new uf(1,1,1,1),this._reflectFactor=.5,this._reflectEnable=!1,this.normalTexture=void 0,t=this,f.a.fetchImage(y("Assets/Textures/waterNormals.jpg")).then((function(e){Object(u.a)(t.normalTexture)&&t.normalTexture.destroy(),t.normalTexture=new hj({context:t._scene.context,width:e.width,height:e.height,source:e,sampler:new tj({wrapS:$D.REPEAT,wrapT:$D.REPEAT,minificationFilter:KD.LINEAR,magnificationFilter:ZD.LINEAR})})}),(function(e){console.log("loadNormalTexture failed")})),this._depthStencilTexture=void 0,this._copyDepthTexture=void 0,this._copyDepthFramebuffer=void 0,this._copyDepthCommand=void 0,this._colorTexture=void 0,this._copyColorTexture=void 0,this._copyColorFramebuffer=void 0,this._copyColorCommand=void 0,this._staticalFramebuffer=void 0}Object(O.a)(Fye.prototype,{flowAngle:{get:function(){return this._flowAngle},set:function(e){this._flowAngle=e*Math.PI/180}},waterColor:{get:function(){return this._waterColor},set:function(e){this._waterColor=e}},reflectEnable:{get:function(){return this._reflectEnable},set:function(e){this._reflectEnable=e}},speed:{get:function(){return this._speed},set:function(e){this._speed=e}}}),Fye.prototype.update=function(e,t,i,n){this._staticalFramebuffer=i,this._colorTexture=i.getColorTexture(0),this._depthStencilTexture=i.depthStencilTexture,function(e,t,i,n){var r=e._copyColorTexture;Object(u.a)(r)&&r.width===i&&r.height===n||(function(e){e._copyColorTexture=e._copyColorTexture&&!e._copyColorTexture.isDestroyed()&&e._copyColorTexture.destroy(),e._copyDepthTexture=e._copyDepthTexture&&!e._copyDepthTexture.isDestroyed()&&e._copyDepthTexture.destroy()}(e),function(e){e._copyColorFramebuffer=e._copyColorFramebuffer&&!e._copyColorFramebuffer.isDestroyed()&&e._copyColorFramebuffer.destroy(),e._copyDepthFramebuffer=e._copyDepthFramebuffer&&!e._copyDepthFramebuffer.isDestroyed()&&e._copyDepthFramebuffer.destroy()}(e),function(e,t,i,n){var r=e._scene._hdr?t.halfFloatingPointTexture?mx.HALF_FLOAT:mx.FLOAT:mx.UNSIGNED_BYTE;e._copyColorTexture=new hj({context:t,width:i,height:n,pixelFormat:gx.RGBA,pixelDatatype:r,sampler:new tj({wrapS:$D.CLAMP_TO_EDGE,wrapT:$D.CLAMP_TO_EDGE,minificationFilter:KD.NEAREST,magnificationFilter:ZD.NEAREST})}),e._copyDepthTexture=new hj({context:t,width:i,height:n,pixelFormat:gx.RGBA,pixelDatatype:mx.UNSIGNED_BYTE,sampler:new tj({wrapS:$D.CLAMP_TO_EDGE,wrapT:$D.CLAMP_TO_EDGE,minificationFilter:KD.NEAREST,magnificationFilter:ZD.NEAREST})}),Object(u.a)(e.normalTexture)||(e.normalTexture=new hj({context:t,width:i,height:n,pixelFormat:gx.RGBA,pixelDatatype:mx.UNSIGNED_BYTE}))}(e,t,i,n),function(e,t){e._copyColorFramebuffer=new cj({context:t,colorTextures:[e._copyColorTexture],destroyAttachments:!1}),e._copyDepthFramebuffer=new cj({context:t,colorTextures:[e._copyDepthTexture],destroyAttachments:!1})}(e,t))}(this,e,n.width,n.height),function(e,t){Object(u.a)(e._copyColorCommand)?e._copyColorCommand.framebuffer=e._copyColorFramebuffer:e._copyColorCommand=t.createViewportQuadCommand(Ade,{uniformMap:{colorTexture:function(){return e._colorTexture}},framebuffer:e._copyColorFramebuffer,owner:e});Object(u.a)(e._copyDepthCommand)?e._copyDepthCommand.framebuffer=e._copyDepthFramebuffer:e._copyDepthCommand=t.createViewportQuadCommand(Pde,{uniformMap:{u_depthTexture:function(){return e._depthStencilTexture}},framebuffer:e._copyDepthFramebuffer,owner:e})}(this,e)},Fye.prototype.createDerivedCommands=function(e,t,i){var n,r,a;return Object(u.a)(i)||(i={}),Object(u.a)(i.waterCommand)&&(n=i.waterCommand.shaderProgram,r=i.waterCommand.renderState,a=i.waterCommand.uniformMap),i.waterCommand=cM.shallowClone(e,i.waterCommand),Object(u.a)(n)&&i.shaderProgramId===e.shaderProgram.id?(i.waterCommand.shaderProgram=n,i.waterCommand.renderState=r,i.waterCommand.uniformMap=a):(i.waterCommand.shaderProgram=function(e,t,i){var n=t.shaderCache.getDerivedShaderProgram(i,"water");if(!Object(u.a)(n)){var r=i._attributeLocations,a=function(e,t){t.sources=t.sources.map((function(e){return e=(e=(e=UN.replaceMain(e,"czm_water_main")).replace(/gl_FragColor/g,"czm_gl_FragColor")).replace(/\bdiscard\b/g,"czm_discard = true")})),t.sources.splice(0,0,"vec4 czm_gl_FragColor;\nbool czm_discard = false;\n"),t.sources.push(Nye),e._reflectEnable&&t.defines.push("REFLECTENABLE");fx.isBIMMode&&t.defines.push("BIM_MODE");return t}(e,i.fragmentShaderSource.clone());n=t.shaderCache.createDerivedShaderProgram(i,"water",{vertexShaderSource:i.vertexShaderSource,fragmentShaderSource:a,attributeLocations:r})}return n}(this,t,e.shaderProgram),i.waterCommand.renderState=(e.renderState,RM.fromCache({depthTest:{enabled:!0},depthMask:!1,cull:{enabled:!0,face:BD.BACK},blending:FD.ALPHA_BLEND})),i.waterCommand.uniformMap=function(e,t,i){var n=i.uniformMap,r=e,a={normalSampler:function(){return r.normalTexture},mirrorSampler:function(){return r._copyColorTexture},depthTexture:function(){return r._copyDepthTexture},waterColor:function(){return r._waterColor},sunColor:function(){return r._sunColor},size:function(){return 2*i.boundingVolume.radius},speed:function(){return r._speed},reflectFactor:function(){return r._reflectFactor},flowDir:function(){return r._flowDir}};return Object(ff.a)(n,a)}(this,0,e),i.shaderProgramId=e.shaderProgram.id),i},Fye.prototype.executeCommands=function(e,t,i,n,r){var a=e.context,o=n.length;if(r)for(var s=0;s<o;++s)t(n[s],e,a,i);else{var c=e.frameState.useLogDepth,l=e._hdr;this._copyColorCommand.execute(a,i),this._copyDepthCommand.execute(a,i);var u=i.framebuffer;i.framebuffer=this._staticalFramebuffer;for(var h=0;h<o;++h){var d=n[h];d=c?d.derivedCommands.logDepth.command:d,t((d=l?d.derivedCommands.hdr.command:d).derivedCommands.water.waterCommand,e,a,i)}i.framebuffer=u}},Fye.prototype.isDestroyed=function(){return!1},Fye.prototype.destroy=function(){return this.removeWaterEventCallback(),rl(this)};var kye=Fye;var Bye=function(e,t){this.border=z.fromDegreesArray(e.border),this.bottom=Math.max(.2,e.bottom),this.flatten=e.flatten,this.guid=e.guid,this.height=e.height,this.batchId=t},zye="uniform float u_planishBatchId;\nuniform float u_planishBottom;\nuniform float u_planishHeight;\nuniform float u_planishFlatten;\nvoid main(){\ngl_FragColor = vec4(u_planishBatchId,u_planishBottom,u_planishHeight,u_planishFlatten);\n}\n",Uye="uniform mat4 u_planishMVPMatrix;\nuniform sampler2D u_planishInfoTexture;\nuniform vec4 u_planishPickPosition;\nuniform vec4 u_planishPickColor;\nvarying vec4 planishPositon;\nvec4 getPlanishInfoByPosition(vec4 projectionCoord)\n{\nvec2 planishInfoUV = projectionCoord.xy / projectionCoord.w;\nplanishInfoUV = planishInfoUV * 0.5 + 0.5;\nreturn texture2D(u_planishInfoTexture, planishInfoUV);\n}\nvoid main()\n{\nczm_model_main();\nvec4 pickPlanishInfo = getPlanishInfoByPosition(u_planishPickPosition);\nvec4 planishInfo = getPlanishInfoByPosition(u_planishMVPMatrix * planishPositon);\nif(length(planishInfo) > 0.0 && pickPlanishInfo.x == planishInfo.x)\n{\nvec4 planishFeatureColor = u_planishPickColor;\nplanishFeatureColor = czm_gammaCorrect(planishFeatureColor);\ngl_FragColor.a *= planishFeatureColor.a;\ngl_FragColor.rgb *= mix(planishFeatureColor.rgb, vec3(1.0), 0.0);\n}\n}\n";function Vye(e){this._scene=e,this.infos=new Map,this._infosCount=0,this._colorTexture=void 0,this._renderBuffer=void 0,this._colorFramebuffer=void 0,this._clearCommand=void 0,this._copyColorTexture=void 0,this._copyColorFramebuffer=void 0,this._copyColorCommand=void 0,this._modelPlanishCamera=void 0,this._center=void 0,this._maxHeight=0,this._isPlanishMode=!1,this._planishCameraViewMatrix=new Be,this._planishCameraProjectionMatrix=new Be,this._pickPosition=new z}Object(O.a)(Vye.prototype,{modelPlanishTexture:{get:function(){return this._colorTexture}},planishCameraViewMatrix:{get:function(){return this._planishCameraViewMatrix},set:function(e){Be.clone(e,this._planishCameraViewMatrix)}},planishCameraProjectionMatrix:{get:function(){return this._planishCameraProjectionMatrix},set:function(e){Be.clone(e,this._planishCameraProjectionMatrix)}},clearCommand:{get:function(){return this._clearCommand}},camera:{get:function(){return this._modelPlanishCamera}},isPlanishMode:{get:function(){return this._isPlanishMode}},pickPosition:{get:function(){return this._pickPosition},set:function(e){this._pickPosition=e}}}),Vye.prototype.render=function(e){if(this.isPlanishMode){var t=e.framebuffer,i=this._scene.context;e.framebuffer=this._colorFramebuffer,this._scene.renderModelPlanishColorTexture(this,e),e.framebuffer=this._copyColorFramebuffer,this._copyColorCommand.execute(i,e),e.framebuffer=t}},Vye.prototype.update=function(e,t,i){this.isPlanishMode&&(!function(e,t,i,n){var r=e._copyColorTexture;Object(u.a)(r)&&r.width===i&&r.height===n||(function(e){e._colorTexture=e._colorTexture&&!e._colorTexture.isDestroyed()&&e._colorTexture.destroy(),e._renderBuffer=e._renderBuffer&&!e._renderBuffer.isDestroyed()&&e._renderBuffer.destroy(),e._copyColorTexture=e._copyColorTexture&&!e._copyColorTexture.isDestroyed()&&e._copyColorTexture.destroy()}(e),function(e){e._colorFramebuffer=e._colorFramebuffer&&!e._colorFramebuffer.isDestroyed()&&e._colorFramebuffer.destroy(),e._copyColorFramebuffer=e._copyColorFramebuffer&&!e._copyColorFramebuffer.isDestroyed()&&e._copyColorFramebuffer.destroy()}(e),function(e,t,i,n){var r=e._scene._hdr?t.halfFloatingPointTexture?mx.HALF_FLOAT:mx.FLOAT:mx.UNSIGNED_BYTE;e._colorTexture=new hj({context:t,width:i,height:n,pixelFormat:gx.RGBA,pixelDatatype:r,sampler:new tj({wrapS:$D.CLAMP_TO_EDGE,wrapT:$D.CLAMP_TO_EDGE,minificationFilter:KD.NEAREST,magnificationFilter:ZD.NEAREST})}),e._copyColorTexture=new hj({context:t,width:i,height:n,pixelFormat:gx.RGBA,pixelDatatype:r,sampler:new tj({wrapS:$D.CLAMP_TO_EDGE,wrapT:$D.CLAMP_TO_EDGE,minificationFilter:KD.NEAREST,magnificationFilter:ZD.NEAREST})}),e._renderBuffer=new are({context:t,format:nre.DEPTH_COMPONENT16,width:t.drawingBufferWidth,height:t.drawingBufferHeight})}(e,t,i,n),function(e,t,i,n){e._colorFramebuffer=new cj({context:t,colorTextures:[e._colorTexture],depthRenderbuffer:e._renderBuffer,destroyAttachments:!1}),e._copyColorFramebuffer=new cj({context:t,colorTextures:[e._copyColorTexture],destroyAttachments:!1})}(e,t))}(this,e,i.width,i.height),function(e,t){Object(u.a)(e._copyColorCommand)||(e._copyColorCommand=t.createViewportQuadCommand(Ade,{uniformMap:{colorTexture:function(){return e._colorTexture}},owner:e}));Object(u.a)(e._clearCommand)||(e._clearCommand=new fX({color:uf.fromBytes(0,0,0,0),depth:1}))}(this,e),function(e){Object(u.a)(e._modelPlanishCamera)||(e._modelPlanishCamera=new ose(e._scene),e._modelPlanishCamera.switchToOrthographicFrustum(),e._modelPlanishCamera.frustum.aspectRatio=1);e._modelPlanishCamera.lookAt(e._center,new z(0,0,e._maxHeight+50))}(this))},Vye.prototype.addBorderInfos=function(e){if(Object(u.a)(e)&&e.length>0){var t=[];for(var i of e){this._infosCount+=1;var n=new Bye(i,this._infosCount);t=t.concat(n.border),this._maxHeight=Math.max(this._maxHeight,n.height+n.bottom),this.infos.set(n.guid,n);var r=new Mu({geometry:lT.fromPositions({positions:n.border,vertexFormat:$j.VERTEX_FORMAT}),attributes:{color:df.fromColor(uf.ORANGE)},id:i.guid});this._scene.primitives.add(new ck({geometryInstances:r,appearance:new $j({closed:!0,translucent:!1})}))}var a=St.fromPoints(t);this._center=a.center,this._isPlanishMode=!0}},Vye.prototype.getBorderInfos=function(e){return this.infos.get(e)},Vye.prototype.createPrimitiveDerivedCommands=function(e,t,i,n){return e.pass=lM.MODEL_PLANISH,Object(u.a)(i)||(i={}),this.isPlanishMode?(Object(u.a)(i.planishCommand)&&(r=i.planishCommand.shaderProgram,a=i.planishCommand.uniformMap),i.planishCommand=cM.shallowClone(e,i.planishCommand),Object(u.a)(r)&&i.shaderProgramId===e.shaderProgram.id?(i.planishCommand.shaderProgram=r,i.planishCommand.uniformMap=a):(i.planishCommand.shaderProgram=function(e,t,i){var n=t.shaderCache.getDerivedShaderProgram(i,"primitivePlanishInfo");if(!Object(u.a)(n)){var r=i._attributeLocations,a=new UN({sources:[zye]});n=t.shaderCache.createDerivedShaderProgram(i,"primitivePlanishInfo",{vertexShaderSource:i.vertexShaderSource,fragmentShaderSource:a,attributeLocations:r})}return n}(0,t,e.shaderProgram),i.planishCommand.uniformMap=function(e,t,i,n){var r=i.uniformMap,a=e.getBorderInfos(n),o={u_planishBatchId:function(){return a.batchId},u_planishBottom:function(){return a.bottom},u_planishHeight:function(){return a.height},u_planishFlatten:function(){return a.flatten?1:0}};return Object(ff.a)(r,o)}(this,0,e,n),i.shaderProgramId=e.shaderProgram.id),i):i;var r,a},Vye.prototype.createModelPlanishDerivedCommands=function(e,t,i){return Object(u.a)(i)||(i={}),this.isPlanishMode?(Object(u.a)(i.planishCommand)&&(n=i.planishCommand.shaderProgram,r=i.planishCommand.uniformMap),i.planishCommand=cM.shallowClone(e,i.planishCommand),Object(u.a)(n)&&i.shaderProgramId===e.shaderProgram.id?(i.planishCommand.shaderProgram=n,i.planishCommand.uniformMap=r):(i.planishCommand.shaderProgram=function(e,t,i){var n=t.shaderCache.getDerivedShaderProgram(i,"modelPlanish");if(!Object(u.a)(n)){var r=i._attributeLocations,a=function(e){return e.defines.push("MODEL_PLANISH"),e}(i.vertexShaderSource.clone());n=t.shaderCache.createDerivedShaderProgram(i,"modelPlanish",{vertexShaderSource:a,fragmentShaderSource:i.fragmentShaderSource,attributeLocations:r})}return n}(0,t,e.shaderProgram),i.planishCommand.uniformMap=function(e,t,i){var n=i.uniformMap,r={u_planishMVPMatrix:function(){return Be.multiplyTransformation(e._planishCameraViewMatrix,i._modelMatrix,Hye),Be.multiply(e._planishCameraProjectionMatrix,Hye,Hye),Hye},u_planishInfoTexture:function(){return e._colorTexture},u_planeCenter:function(){return Be.inverse(i._modelMatrix,qye),Be.multiplyByPoint(qye,e._center,Gye)}};return Object(ff.a)(n,r)}(this,0,e),i.shaderProgramId=e.shaderProgram.id),i):i;var n,r};var Hye=new Be,Gye=new z,qye=new Be;var Wye=Vye;function Yye(e){this._scene=e,this.context=this._scene.context,this.drawCommand=void 0}Object(O.a)(Yye.prototype,{}),Yye.prototype.update=function(e){this.updateDepthTexture(e)};var Xye=new ln;Yye.prototype.updateDepthTexture=function(e){var t=this.context;if(!Object(u.a)(this.drawCommand)){var i=t.drawingBufferWidth,n=t.drawingBufferHeight,r=Xye;r.x=i-.4*i,r.y=0,r.width=.4*i,r.height=.4*n;var a=RM.fromCache({depthTest:{enabled:!1},depthMask:!1,viewport:ln.clone(r)}),o=this;this.drawCommand=t.createViewportQuadCommand("uniform sampler2D colorTexture; \nvarying vec2 v_textureCoordinates; \nvoid main() \n{ \n    vec4 color = texture2D(colorTexture, v_textureCoordinates); \n    gl_FragColor = color; \n} \n",{uniformMap:{colorTexture:function(){return o._scene._view.globeDepth._depthStencilTexture}},renderState:a,pass:lM.OVERLAY})}this.drawCommand.execute(t,e)};var Zye=Yye,Qye=function(e){return function(){e.frameState.afterRender.push((function(){e.requestRender()}))}};function Kye(e,t,i){this.ray=e,this.width=t,this.primitives=i,this.ready=!1,this.deferred=Oi.a.defer(),this.promise=this.deferred.promise}function Jye(e){var t=(e=Object(w.a)(e,w.a.EMPTY_OBJECT)).canvas,i=e.contextOptions,n=e.creditContainer,r=e.creditViewport;if(!Object(u.a)(t))throw new h.a("options and options.canvas are required.");var a=Object(u.a)(n),o=new ere(t,i);a||((n=document.createElement("div")).style.position="absolute",n.style.bottom="0",n.style["text-shadow"]="0 0 2px #000000",n.style.color="#ffffff",n.style["font-size"]="10px",n.style["padding-right"]="5px",t.parentNode.appendChild(n)),Object(u.a)(r)||(r=t.parentNode),this._id=Mg(),this._jobScheduler=new $de,this._frameState=new Sue(o,new Ole(n," • ",r),this._jobScheduler),this._frameState.scene3DOnly=Object(w.a)(e.scene3DOnly,!1),this._removeCreditContainer=!a,this._creditContainer=n,this._canvas=t,this._context=o,this._computeEngine=new vne(o),this._globe=void 0,this._primitives=new R6,this._groundPrimitives=new R6,this._asyncRayPicks=[],this._logDepthBuffer=o.fragmentDepth,this._logDepthBufferDirty=!0,this._tweens=new p_e,this._shaderFrameCount=0,this._sunPostProcess=void 0,this._computeCommandList=[],this._overlayCommandList=[],this._useOIT=Object(w.a)(e.orderIndependentTranslucency,!0),this._executeOITFunction=void 0,this._depthPlane=new Wle,this._clearColorCommand=new fX({color:new uf,stencil:0,owner:this}),this._depthClearCommand=new fX({depth:1,owner:this}),this._stencilClearCommand=new fX({stencil:0}),this._classificationStencilClearCommand=new fX({stencil:0,renderState:RM.fromCache({stencilMask:Hk.CLASSIFICATION_MASK})}),this._depthOnlyRenderStateCache={},this._pickRenderStateCache={},this._transitioner=new h_e(this),this._preUpdate=new $o.a,this._postUpdate=new $o.a,this._renderError=new $o.a,this._preRender=new $o.a,this._postRender=new $o.a,this._pickPositionCache={},this._pickPositionCacheDirty=!1,this._minimumDisableDepthTestDistance=0,this.rethrowRenderErrors=!1,this.completeMorphOnUserInput=!0,this.morphStart=new $o.a,this.morphComplete=new $o.a,this.skyBox=void 0,this.skyAtmosphere=void 0,this.sun=void 0,this.sunBloom=!0,this._sunBloom=void 0,this.moon=void 0,this.backgroundColor=uf.clone(uf.BLACK),this._mode=xF.SCENE3D,this._mapProjection=Object(u.a)(e.mapProjection)?e.mapProjection:new se,this.morphTime=1,this.farToNearRatio=1e3,this.logarithmicDepthFarToNearRatio=1e9,this.nearToFarDistance2D=175e4,this.debugCommandFilter=void 0,this.debugShowCommands=!1,this.debugShowFrustums=!1,this.debugShowFramesPerSecond=!1,this.debugShowGlobeDepth=!1,this.debugShowDepthFrustum=1,this.debugShowFrustumPlanes=!1,this._debugShowFrustumPlanes=!1,this._debugFrustumPlanes=void 0,this.useDepthPicking=!0,this._pickTranslucentDepth=!1,this.cameraEventWaitTime=500,this.fog=new Eue,this._sunCamera=new ose(this),this.shadowMap=new dbe({context:o,lightCamera:this._sunCamera,enabled:Object(w.a)(e.shadows,!1)}),this.invertClassification=!1,this.invertClassificationColor=uf.clone(uf.WHITE),this._actualInvertClassificationColor=uf.clone(this._invertClassificationColor),this._invertClassification=new Qde,this.focalLength=void 0,this.eyeSeparation=void 0,this.postProcessStages=new nme,this._brdfLutGenerator=new Lre,this._terrainExaggeration=Object(w.a)(e.terrainExaggeration,1),this._performanceDisplay=void 0,this._debugVolume=void 0,this._screenSpaceCameraController=new xve(this),this._mapMode2D=Object(w.a)(e.mapMode2D,Jre.INFINITE_SCROLL),this._environmentState={skyBoxCommand:void 0,skyAtmosphereCommand:void 0,sunDrawCommand:void 0,sunComputeCommand:void 0,moonCommand:void 0,isSunVisible:!1,isMoonVisible:!1,isReadyForAtmosphere:!1,isSkyAtmosphereVisible:!1,clearGlobeDepth:!1,useDepthPlane:!1,renderTranslucentDepthForPick:!1,originalFramebuffer:void 0,useGlobeDepthFramebuffer:!1,useOIT:!1,useInvertClassification:!1,usePostProcess:!1,usePostProcessSelected:!1,useWebVR:!1},this._useWebVR=!1,this._cameraVR=void 0,this._aspectRatioVR=void 0,this._waterCollection=new Rbe(this),this.requestRenderMode=Object(w.a)(e.requestRenderMode,!1),this._renderRequested=!0,this.maximumRenderTimeChange=Object(w.a)(e.maximumRenderTimeChange,0),this._lastRenderTime=void 0,this._frameRateMonitor=void 0,this._removeRequestListenerCallback=bS.a.requestCompletedEvent.addEventListener(Qye(this)),this._removeTaskProcessorListenerCallback=pl.taskCompletedEvent.addEventListener(Qye(this)),this._removeGlobeCallbacks=[];var s=new ln(0,0,o.drawingBufferWidth,o.drawingBufferHeight),c=new ose(this);this._logDepthBuffer&&(c.frustum.near=.1,c.frustum.far=1e10);var l=new ln(0,0,1,1),d=new ose(this);d.frustum=new hb({width:.1,aspectRatio:1,near:.1}),this._view=new jbe(this,c,s),this._pickOffscreenView=new jbe(this,d,l),this.pickOffscreenDefaultWidth=.1,this._defaultView=new jbe(this,c,s),this._view=this._defaultView,this._hdr=void 0,this._hdrDirty=void 0,this.highDynamicRange=!0,this.gamma=2.2,this._sunColor=new z(1.8,1.85,2),this.sphericalHarmonicCoefficients=void 0,this.specularEnvironmentMaps=void 0,this._specularEnvironmentMapAtlas=void 0,this._gradualRender=new Sye(this),this.lastCommandListLength=0,this._mouseDownFlag=0,this._taaRenderPass=new Iye,this._needRenderNextFrame=!1,this._cameraChanged=!1,fx.vignetteMode&&(this._vignetteCommand=new Rye({context:this._context})),this._surfaceWater=new kye({scene:this}),nwe(this,0,Tr.now()),rwe(this),this.initializeFrame(),this._modelPlanishCollection=new Wye(this)}function $ye(e,t,i,n){var r=e._frameState,a=e._context,o=e._view.oit,s=r.shadowState.lightShadowMaps,c=r.shadowState.lightShadowsEnabled,l=r.viewShedState.lightViewShedsMaps,h=t.derivedCommands;Object(u.a)(t.pickId)&&(h.picking=$le.createPickDerivedCommand(e,t,a,h.picking)),t.pickOnly||(h.depth=$le.createDepthOnlyDerivedCommand(e,t,a,h.depth)),h.originalCommand=t,e._hdr&&(h.hdr=$le.createHdrCommand(t,a,h.hdr),h=(t=h.hdr.command).derivedCommands),h.viewSheds=Tye.createReceiveDerivedCommand(l,t,n,a,h.viewSheds),c&&t.receiveShadows&&(h.shadows=dbe.createReceiveDerivedCommand(s,t,i,a,h.shadows)),t.pass===lM.TRANSLUCENT&&Object(u.a)(o)&&o.isSupported()&&(c&&t.receiveShadows?(h.oit=Object(u.a)(h.oit)?h.oit:{},h.oit.shadows=o.createDerivedCommands(h.shadows.receiveCommand,a,h.oit.shadows)):h.oit=o.createDerivedCommands(t,a,h.oit));var d=e._surfaceWater;t.pass===lM.WATER&&(h.water=Object(u.a)(h.water)?h.water:{},h.water=d.createDerivedCommands(t,a,h.water));var f=e._modelPlanishCollection;f.isPlanishMode&&t.pass===lM.CESIUM_3D_TILE&&(h.modelPlanish=Object(u.a)(h.modelPlanish)?h.modelPlanish:{},f.createModelPlanishDerivedCommands(t,a,h.modelPlanish))}Object(O.a)(Jye.prototype,{canvas:{get:function(){return this._canvas}},gradualRender:{get:function(){return this._gradualRender}},mouseDownFlag:{get:function(){return this._mouseDownFlag},set:function(e){this._mouseDownFlag=e,this._mouseDownFlag<0&&(this._mouseDownFlag=0)}},vignette:{get:function(){return this._vignetteCommand}},drawingBufferHeight:{get:function(){return this._context.drawingBufferHeight}},drawingBufferWidth:{get:function(){return this._context.drawingBufferWidth}},maximumAliasedLineWidth:{get:function(){return HD.maximumAliasedLineWidth}},maximumCubeMapSize:{get:function(){return HD.maximumCubeMapSize}},pickPositionSupported:{get:function(){return this._context.depthTexture}},sampleHeightSupported:{get:function(){return this._context.depthTexture}},clampToHeightSupported:{get:function(){return this._context.depthTexture}},invertClassificationSupported:{get:function(){return this._context.depthTexture}},globe:{get:function(){return this._globe},set:function(e){this._globe=this._globe&&this._globe.destroy(),this._globe=e,function(e,t){for(var i=0;i<e._removeGlobeCallbacks.length;++i)e._removeGlobeCallbacks[i]();e._removeGlobeCallbacks.length=0;var n=[];Object(u.a)(t)&&(n.push(t.imageryLayersUpdatedEvent.addEventListener(Qye(e))),n.push(t.terrainProviderChanged.addEventListener(Qye(e)))),e._removeGlobeCallbacks=n}(this,e)}},primitives:{get:function(){return this._primitives}},groundPrimitives:{get:function(){return this._groundPrimitives}},camera:{get:function(){return this._view.camera},set:function(e){this._view.camera=e}},screenSpaceCameraController:{get:function(){return this._screenSpaceCameraController}},mapProjection:{get:function(){return this._mapProjection}},frameState:{get:function(){return this._frameState}},tweens:{get:function(){return this._tweens}},imageryLayers:{get:function(){if(Object(u.a)(this.globe))return this.globe.imageryLayers}},waterCollection:{get:function(){return this._waterCollection}},terrainProvider:{get:function(){if(Object(u.a)(this.globe))return this.globe.terrainProvider},set:function(e){Object(u.a)(this.globe)&&(this.globe.terrainProvider=e)}},terrainProviderChanged:{get:function(){if(Object(u.a)(this.globe))return this.globe.terrainProviderChanged}},preUpdate:{get:function(){return this._preUpdate}},postUpdate:{get:function(){return this._postUpdate}},renderError:{get:function(){return this._renderError}},preRender:{get:function(){return this._preRender}},postRender:{get:function(){return this._postRender}},lastRenderTime:{get:function(){return this._lastRenderTime}},context:{get:function(){return this._context}},debugFrustumStatistics:{get:function(){return this._view.debugFrustumStatistics}},scene3DOnly:{get:function(){return this._frameState.scene3DOnly}},orderIndependentTranslucency:{get:function(){return this._useOIT}},id:{get:function(){return this._id}},mode:{get:function(){return this._mode},set:function(e){if(this.scene3DOnly&&e!==xF.SCENE3D)throw new h.a("Only SceneMode.SCENE3D is valid when scene3DOnly is true.");if(e===xF.SCENE2D)this.morphTo2D(0);else if(e===xF.SCENE3D)this.morphTo3D(0);else{if(e!==xF.COLUMBUS_VIEW)throw new h.a("value must be a valid SceneMode enumeration.");this.morphToColumbusView(0)}this._mode=e}},frustumCommandsList:{get:function(){return this._view.frustumCommandsList}},numberOfFrustums:{get:function(){return this._view.frustumCommandsList.length}},terrainExaggeration:{get:function(){return this._terrainExaggeration}},useWebVR:{get:function(){return this._useWebVR},set:function(e){if(this.camera.frustum instanceof hb)throw new h.a("VR is unsupported with an orthographic projection.");this._useWebVR=e,this._useWebVR?(this._frameState.creditDisplay.container.style.visibility="hidden",this._cameraVR=new ose(this),Object(u.a)(this._deviceOrientationCameraController)||(this._deviceOrientationCameraController=new rue(this)),this._aspectRatioVR=this.camera.frustum.aspectRatio):(this._frameState.creditDisplay.container.style.visibility="visible",this._cameraVR=void 0,this._deviceOrientationCameraController=this._deviceOrientationCameraController&&!this._deviceOrientationCameraController.isDestroyed()&&this._deviceOrientationCameraController.destroy(),this.camera.frustum.aspectRatio=this._aspectRatioVR,this.camera.frustum.xOffset=0)}},mapMode2D:{get:function(){return this._mapMode2D}},imagerySplitPosition:{get:function(){return this._frameState.imagerySplitPosition},set:function(e){this._frameState.imagerySplitPosition=e}},minimumDisableDepthTestDistance:{get:function(){return this._minimumDisableDepthTestDistance},set:function(e){if(!Object(u.a)(e)||e<0)throw new h.a("minimumDisableDepthTestDistance must be greater than or equal to 0.0.");this._minimumDisableDepthTestDistance=e}},logarithmicDepthBuffer:{get:function(){return this._logDepthBuffer},set:function(e){e=this._context.fragmentDepth&&e,this._logDepthBuffer!==e&&(this._logDepthBuffer=e,this._logDepthBufferDirty=!0,this._defaultView.updateFrustums=!0)}},gamma:{get:function(){return this._context.uniformState.gamma},set:function(e){this._context.uniformState.gamma=e}},highDynamicRange:{get:function(){return this._hdr},set:function(e){var t=this._context,i=e&&t.depthTexture&&(t.colorBufferFloat||t.colorBufferHalfFloat);this._hdrDirty=i!==this._hdr,this._hdr=i}},highDynamicRangeSupported:{get:function(){var e=this._context;return e.depthTexture&&(e.colorBufferFloat||e.colorBufferHalfFloat)}},sunColor:{get:function(){return this._sunColor},set:function(e){this._sunColor=e}},opaqueFrustumNearOffset:{get:function(){return this._frameState.useLogDepth?.9:.9999}},modelPlanishCollection:{get:function(){return this._modelPlanishCollection}},pickTranslucentDepth:{get:function(){return this._pickTranslucentDepth},set:function(e){this._pickTranslucentDepth=e&&!fx.gradualRenderMode}}}),Jye.prototype.getCompressedTextureFormatSupported=function(e){var t=this.context;return("WEBGL_compressed_texture_s3tc"===e||"s3tc"===e)&&t.s3tc||("WEBGL_compressed_texture_pvrtc"===e||"pvrtc"===e)&&t.pvrtc||("WEBGL_compressed_texture_etc1"===e||"etc1"===e)&&t.etc1},Jye.prototype.updateDerivedCommands=function(e){if(Object(u.a)(e.derivedCommands)){var t=this._frameState,i=this._context,n=!1,r=t.shadowState.lastDirtyTime;e.lastDirtyTime!==r&&(e.lastDirtyTime=r,e.dirty=!0,n=!0);var a=!1,o=t.viewShedState.lastDirtyTime;e.lastViewShedDirtyTime!==o&&(e.lastViewShedDirtyTime=o,e.dirty=!0,a=!0);var s=t.useLogDepth,c=this._hdr,l=e.derivedCommands,h=Object(u.a)(l.logDepth),d=Object(u.a)(l.hdr),f=Object(u.a)(l.originalCommand),p=s&&!h,m=c&&!d,_=!(s&&c||f);if(e.dirty=e.dirty||p||m||_,e.dirty){e.dirty=!1;var g=t.viewShedState.viewSheds;l.viewSheds=dbe.createCastDerivedCommand(g,e,a,i,l.viewSheds);var v=t.shadowState.shadowMaps;t.shadowState.shadowsEnabled&&e.castShadows&&(l.shadows=dbe.createCastDerivedCommand(v,e,n,i,l.shadows)),(h||p)&&(l.logDepth=$le.createLogDepthCommand(e,i,l.logDepth),$ye(this,l.logDepth.command,n,a)),(f||_)&&$ye(this,e,n,a)}var b=this._modelPlanishCollection;if(b.isPlanishMode&&e.pass===lM.OPAQUE){var y=e._owner&&e._owner._instanceIds&&e._owner._instanceIds;if(y&&y.length>0){var w=y[0];b.getBorderInfos(w)&&(l.modelPlanishInfo=Object(u.a)(l.modelPlanishInfo)?l.modelPlanishInfo:{},b.createPrimitiveDerivedCommands(e,i,l.modelPlanishInfo,w))}}}};var ewe,twe=new St;function iwe(e){e.render=!1,e.pick=!1,e.depth=!1,e.postProcess=!1,e.offscreen=!1,e.asynchronous=!1}function nwe(e,t,i){var n=e._frameState;n.frameNumber=t,n.time=Tr.clone(i,n.time)}function rwe(e){var t=e.camera,i=e._frameState;i.commandList.length=0,i.shadowMaps.length=0,i.viewSheds.length=0,i.brdfLutGenerator=e._brdfLutGenerator,i.environmentMap=e.skyBox&&e.skyBox._cubeMap,i.mode=e._mode,i.morphTime=e.morphTime,i.mapProjection=e.mapProjection,i.camera=t,i.cullingVolume=t.frustum.computeCullingVolume(t.positionWC,t.directionWC,t.upWC),i.occluder=function(e){var t=e.globe;if(e._mode===xF.SCENE3D&&Object(u.a)(t)&&t.show){var i=t.ellipsoid;return twe.radius=i.minimumRadius,ewe=$x.fromBoundingSphere(twe,e.camera.positionWC,ewe)}}(e),i.terrainExaggeration=e._terrainExaggeration,i.minimumDisableDepthTestDistance=e._minimumDisableDepthTestDistance,i.invertClassification=e.invertClassification,i.skyBoxModelMatrix=e.skyBox&&e.skyBox.modelMatrix,i.ambientLight=fx.ambientLight,i.lightScaleFactor=fx.lightScaleFactor,i.useLogDepth=e._logDepthBuffer&&!(e.camera.frustum instanceof hb||e.camera.frustum instanceof cb),i.sunColor=e._sunColor,Object(u.a)(e._specularEnvironmentMapAtlas)&&e._specularEnvironmentMapAtlas.ready?(i.specularEnvironmentMaps=e._specularEnvironmentMapAtlas.texture,i.specularEnvironmentMapsMaximumLOD=e._specularEnvironmentMapAtlas.maximumMipmapLevel):(i.specularEnvironmentMaps=void 0,i.specularEnvironmentMapsMaximumLOD=void 0),i.sphericalHarmonicCoefficients=e.sphericalHarmonicCoefficients,e._actualInvertClassificationColor=uf.clone(e.invertClassificationColor,e._actualInvertClassificationColor),Qde.isTranslucencySupported(e._context)||(e._actualInvertClassificationColor.alpha=1),i.invertClassificationColor=e._actualInvertClassificationColor,Object(u.a)(e.globe)?i.maximumScreenSpaceError=e.globe.maximumScreenSpaceError:i.maximumScreenSpaceError=2,iwe(i.passes)}var awe=new Wg;function owe(e,t,i){var n=cM.shallowClone(e);n.shaderProgram=function(e,t,i){var n=t.context,r=Object(w.a)(i,e.shaderProgram),a=r.fragmentShaderSource.clone(),o=[];a.sources=a.sources.map((function(e){e=UN.replaceMain(e,"czm_Debug_main");for(var t,i=/gl_FragData\[(\d+)\]/g;null!==(t=i.exec(e));)-1===o.indexOf(t[1])&&o.push(t[1]);return e}));var s,c=o.length,l="void main() \n{ \n    czm_Debug_main(); \n";if(t.debugShowCommands){Object(u.a)(e._debugColor)||(e._debugColor=uf.fromRandom());var h=e._debugColor;if(c>0)for(s=0;s<c;++s)l+="    gl_FragData["+o[s]+"].rgb *= vec3("+h.red+", "+h.green+", "+h.blue+"); \n";else l+="    gl_FragColor.rgb *= vec3("+h.red+", "+h.green+", "+h.blue+"); \n"}if(t.debugShowFrustums){var d=1&e.debugOverlappingFrustums?"1.0":"0.0",f=2&e.debugOverlappingFrustums?"1.0":"0.0",p=4&e.debugOverlappingFrustums?"1.0":"0.0";if(c>0)for(s=0;s<c;++s)l+="    gl_FragData["+o[s]+"].rgb *= vec3("+d+", "+f+", "+p+"); \n";else l+="    gl_FragColor.rgb *= vec3("+d+", "+f+", "+p+"); \n"}l+="}",a.sources.push(l);var m=function(e){var t={},i=e.vertexAttributes;for(var n in i)i.hasOwnProperty(n)&&(t[n]=i[n].index);return t}(r);return bR.fromCache({context:n,vertexShaderSource:r.vertexShaderSource,fragmentShaderSource:a,attributeLocations:m})}(e,t),n.execute(t.context,i),n.shaderProgram.destroy()}Jye.prototype.isVisible=function(e,t,i){return Object(u.a)(e)&&(!Object(u.a)(e.boundingVolume)||!e.cull||t.computeVisibility(e.boundingVolume)!==ce.OUTSIDE&&(!Object(u.a)(i)||!e.occlude||!e.boundingVolume.isOccluded(i)))};var swe=new Be(0,0,1,0,1,0,0,0,0,1,0,0,0,0,0,1);function cwe(e,t,i,n,r){for(var a=t._frameState,o=t._waterCollection._water,s=o.length,c=0;c<s;++c)o[c].execute(i,n);if(!Object(u.a)(t.debugCommandFilter)||t.debugCommandFilter(e))if(e instanceof fX)e.execute(i,n);else{e.debugShowBoundingVolume&&Object(u.a)(e.boundingVolume)&&function(e,t,i,n){var r,a=t._frameState,o=a.context,s=e.boundingVolume;Object(u.a)(t._debugVolume)&&t._debugVolume.destroy();var c=z.clone(s.center);if(a.mode!==xF.SCENE3D){c=Be.multiplyByPoint(swe,c,c);var l=a.mapProjection,h=l.unproject(c);c=l.ellipsoid.cartographicToCartesian(h)}if(Object(u.a)(s.radius)){var d=s.radius;r=id.toWireframe(Hv.createGeometry(new Hv({radii:new z(d,d,d),vertexFormat:$j.FLAT_VERTEX_FORMAT}))),t._debugVolume=new ck({geometryInstances:new Mu({geometry:r,modelMatrix:Be.fromTranslation(c),attributes:{color:new df(1,0,0,1)}}),appearance:new $j({flat:!0,translucent:!1}),asynchronous:!1})}else{var f=s.halfAxes;r=id.toWireframe(Ya.createGeometry(Ya.fromDimensions({dimensions:new z(2,2,2),vertexFormat:$j.FLAT_VERTEX_FORMAT}))),t._debugVolume=new ck({geometryInstances:new Mu({geometry:r,modelMatrix:Be.fromRotationTranslation(f,c,new Be),attributes:{color:new df(1,0,0,1)}}),appearance:new $j({flat:!0,translucent:!1}),asynchronous:!1})}var p,m=a.commandList,_=a.commandList=[];t._debugVolume.update(a),e=_[0],a.useLogDepth&&(e=$le.createLogDepthCommand(e,o).command),Object(u.a)(n)&&(p=i.framebuffer,i.framebuffer=n),e.execute(o,i),Object(u.a)(p)&&(i.framebuffer=p),a.commandList=m}(e,t,n,r),a.useLogDepth&&Object(u.a)(e.derivedCommands.logDepth)&&(e=e.derivedCommands.logDepth.command);var l=a.passes;if(!l.pick&&t._hdr&&Object(u.a)(e.derivedCommands)&&Object(u.a)(e.derivedCommands.hdr)&&(e=e.derivedCommands.hdr.command),Object(u.a)(e.derivedCommands)&&Object(u.a)(e.derivedCommands.modelPlanish)&&(e=e.derivedCommands.modelPlanish.planishCommand),e.owner===h$);else if(l.pick||l.depth){if(l.pick&&!l.depth&&Object(u.a)(e.derivedCommands.picking))return void(e=e.derivedCommands.picking.pickCommand).execute(i,n);if(Object(u.a)(e.derivedCommands.depth))return void(e=e.derivedCommands.depth.depthOnlyCommand).execute(i,n)}t.debugShowCommands||t.debugShowFrustums?owe(e,t,n):(a.viewShedState.lightViewShedEnabled&&Object(u.a)(e.derivedCommands.viewSheds)&&e.receiveShadows&&e.derivedCommands.viewSheds.receiveCommand.execute(i,n),a.shadowState.lightShadowsEnabled&&e.receiveShadows&&Object(u.a)(e.derivedCommands.shadows)?e.derivedCommands.shadows.receiveCommand.execute(i,n):e.execute(i,n))}}function lwe(e,t,i,n){var r=t._frameState,a=e.derivedCommands;Object(u.a)(a)&&(r.useLogDepth&&Object(u.a)(a.logDepth)&&(e=a.logDepth.command),a=e.derivedCommands,Object(u.a)(a.picking)?(e=a.picking.pickCommand).execute(i,n):Object(u.a)(a.depth)&&(e=a.depth.depthOnlyCommand).execute(i,n))}function uwe(e,t,i){return t.boundingVolume.distanceSquaredTo(i)-e.boundingVolume.distanceSquaredTo(i)}function hwe(e,t,i){return e.boundingVolume.distanceSquaredTo(i)-t.boundingVolume.distanceSquaredTo(i)+I.EPSILON12}function dwe(e,t,i,n,r){var a=e.context;Lx(n,uwe,e.camera.positionWC),Object(u.a)(r)&&t(r.unclassifiedCommand,e,a,i);for(var o=n.length,s=0;s<o;++s)t(n[s],e,a,i)}function fwe(e,t,i,n,r){var a=e.context;Lx(n,hwe,e.camera.positionWC),Object(u.a)(r)&&t(r.unclassifiedCommand,e,a,i);for(var o=n.length,s=0;s<o;++s)t(n[s],e,a,i)}function pwe(e,t){var i=e._view.debugGlobeDepths,n=i[t];return!Object(u.a)(n)&&e.context.depthTexture&&(n=new Fde,i[t]=n),n}function mwe(e,t){var i=e._view.pickDepths,n=i[t];return Object(u.a)(n)||(n=new Zfe,i[t]=n),n}function _we(e,t,i,n){var r=e.context,a=r.uniformState,o=e.gradualRender,s=i.indices[n];if(s>0){a.updatePass(n);var c=i.commands[n],l=o.getPassName(n),u=o.getDrawCommandStartOffset(l,s),h=o.getDrawCommandEndOffset(l,s);for(lM.GLOBE!==n&&lM.TERRAIN_CLASSIFICATION!==n||(h=s);u<h&&(lM.GLOBE===n||lM.TERRAIN_CLASSIFICATION===n||h!==s||!o.needToPause());++u)cwe(c[u],e,r,t);var d=u;d=d>=s?s:d,o.setDrawCommandStep(l,s,d,d)}return s}function gwe(e,t,i,n){var r=e.context,a=r.uniformState,o=e.gradualRender,s=i.indices[n];if(s>0){a.updatePass(n);for(var c=i.commands[n],l=o.getPassName(n)+"_ID",u=o.getDrawCommandStartOffset(l,s),h=o.getDrawCommandEndOffset(l,s);u<h&&(h!==s||!o.needToPause());++u)lwe(c[u],e,r,t);var d=u;d=d>=s?s:d,o.setDrawCommandStep(l,s,d,d)}}swe=Be.inverseTransformation(swe,swe);var vwe=new wb,bwe=new vb,ywe=new hb,wwe=new cb;function Owe(e,t){var i,n=e.camera,r=e.context,a=r.uniformState;a.updateCamera(n),(i=Object(u.a)(n.frustum.fov)?n.frustum.clone(vwe):Object(u.a)(n.frustum.infiniteProjectionMatrix)?n.frustum.clone(bwe):Object(u.a)(n.frustum.width)?n.frustum.clone(ywe):n.frustum.clone(wwe)).near=n.frustum.near,i.far=n.frustum.far,a.updateFrustum(i),a.updatePass(lM.ENVIRONMENT);var o,s=e._frameState.passes,c=s.pick,l=e._environmentState,h=e._view,d=l.renderTranslucentDepthForPick,f=l.useWebVR,p=e.gradualRender,m=p.needUpdateDrawCommand();if(!c&&m){var _,g=l.skyBoxCommand;if(Object(u.a)(g)&&cwe(g,e,r,t),l.isSkyAtmosphereVisible&&cwe(l.skyAtmosphereCommand,e,r,t),l.isSunVisible)if(l.sunDrawCommand.execute(r,t),e.sunBloom&&!f)_=l.useGlobeDepthFramebuffer?h.globeDepth.framebuffer:l.usePostProcess?h.sceneFramebuffer.getFramebuffer():l.originalFramebuffer,e._sunPostProcess.execute(r),e._sunPostProcess.copy(r,_),t.framebuffer=_;l.isMoonVisible&&l.moonCommand.execute(r,t)}l.useOIT?(Object(u.a)(e._executeOITFunction)||(e._executeOITFunction=function(e,t,i,n,r){h.oit.executeCommands(e,t,i,n,r)}),o=e._executeOITFunction):o=s.render?dwe:fwe;var v=l.clearGlobeDepth,b=l.useDepthPlane,y=e._depthClearCommand,w=e._stencilClearCommand,O=e._classificationStencilClearCommand,x=e._depthPlane,E=l.usePostProcessSelected,T=n.position.z,C=h.frustumCommandsList,S=C.length;n.workingFrustums.length=0,n.workingFrustums.push(i);for(var A=0;A<S;++A){var P=S-A-1,I=C[P];e.mode===xF.SCENE2D?(n.position.z=T-I.near+1,i.far=Math.max(1,I.far-I.near),i.near=1,a.update(e.frameState),a.updateFrustum(i)):(i.near=0!==P?I.near*e.opaqueFrustumNearOffset:I.near,i.far=I.far,a.updateFrustum(i));var D,j,M,R=e.debugShowGlobeDepth?pwe(e,P):h.globeDepth;if(e.debugShowGlobeDepth&&Object(u.a)(R)&&l.useGlobeDepthFramebuffer&&(R.update(r,t,h.viewport),R.clear(r,t,e._clearColorCommand.color),D=t.framebuffer,t.framebuffer=R.framebuffer),m&&(y.execute(r,t),r.stencilBuffer&&w.execute(r,t)),_we(e,t,I,lM.GLOBE),Object(u.a)(R)&&l.useGlobeDepthFramebuffer&&R.executeCopyDepth(r,t),e.debugShowGlobeDepth&&Object(u.a)(R)&&l.useGlobeDepthFramebuffer&&(t.framebuffer=D),_we(e,t,I,lM.TERRAIN_CLASSIFICATION),v&&(y.execute(r,t),b&&x.execute(r,t)),!l.useInvertClassification||c)(j=_we(e,t,I,lM.CESIUM_3D_TILE))>0&&(Object(u.a)(R)&&l.useGlobeDepthFramebuffer&&R.executeUpdateDepth(r,t,v),_we(e,t,I,lM.CESIUM_3D_TILE_CLASSIFICATION));else{e._invertClassification.clear(r,t);var L=t.framebuffer;t.framebuffer=e._invertClassification._fbo,_we(e,t,I,lM.CESIUM_3D_TILE),Object(u.a)(R)&&l.useGlobeDepthFramebuffer&&R.executeUpdateDepth(r,t,v),j=_we(e,t,I,lM.CESIUM_3D_TILE_CLASSIFICATION_IGNORE_SHOW),t.framebuffer=L,e._invertClassification.executeClassified(r,t),1===e.frameState.invertClassificationColor.alpha&&e._invertClassification.executeUnclassified(r,t),j>0&&r.stencilBuffer&&O.execute(r,t),j=_we(e,t,I,lM.CESIUM_3D_TILE_CLASSIFICATION)}j>0&&r.stencilBuffer&&w.execute(r,t),_we(e,t,I,lM.OPAQUE),e._modelPlanishCollection.render(t),0!==P&&e.mode!==xF.SCENE2D&&(i.near=I.near,a.updateFrustum(i)),!c&&l.useInvertClassification&&e.frameState.invertClassificationColor.alpha<1&&(M=e._invertClassification),a.updatePass(lM.TRANSLUCENT);var N=I.commands[lM.TRANSLUCENT];N.length=I.indices[lM.TRANSLUCENT],o(e,cwe,t,N,M),fx.isWebgl2&&!c&&(Object(u.a)(h.globeDepth)&&h.globeDepth.blitFramebuffer(e._context,h.viewport),l.useOIT&&h.oit.blitFramebuffer(e._context,h.viewport));var F=p.isWaterPassReady();if(l.useGlobeDepthFramebuffer&&F&&(a.updatePass(lM.WATER),(N=I.commands[lM.WATER]).length=I.indices[lM.WATER],e._surfaceWater.executeCommands(e,cwe,t,N,c)),r.depthTexture&&e.useDepthPicking&&(l.useGlobeDepthFramebuffer||d)){var k=d&&t.framebuffer.depthStencilTexture?t.framebuffer.depthStencilTexture:R.framebuffer.depthStencilTexture,B=mwe(e,P);B.update(r,k),B.executeCopyDepth(r,t)}if(!c&&E){var z=t.framebuffer;t.framebuffer=h.sceneFramebuffer.getIdFramebuffer(),i.near=0!==P?I.near*e.opaqueFrustumNearOffset:I.near,i.far=I.far,a.updateFrustum(i),gwe(e,t,I,lM.GLOBE),v&&(y.framebuffer=t.framebuffer,y.execute(r,t),y.framebuffer=void 0),v&&b&&x.execute(r,t),gwe(e,t,I,lM.CESIUM_3D_TILE),gwe(e,t,I,lM.OPAQUE),gwe(e,t,I,lM.TRANSLUCENT),gwe(e,t,I,lM.WATER),gwe(e,t,I,lM.MODEL_PLANISH),t.framebuffer=z}}}function xwe(e){e.context.uniformState.updatePass(lM.COMPUTE);var t=e._environmentState.sunComputeCommand;Object(u.a)(t)&&t.execute(e._computeEngine);for(var i=e._computeCommandList,n=i.length,r=0;r<n;++r)i[r].execute(e._computeEngine)}function Ewe(e,t,i){for(var n=i.shadowMapCullingVolume,r=i.isPointLight,a=i.passes,o=a.length,s=t.length,c=0;c<s;++c){var l=t[c];if(e.updateDerivedCommands(l),l.castShadows&&(l.pass===lM.GLOBE||l.pass===lM.CESIUM_3D_TILE||l.pass===lM.OPAQUE||l.pass===lM.TRANSLUCENT)&&e.isVisible(l,n))if(r)for(var u=0;u<o;++u)a[u].commandList.push(l);else if(1===o)a[0].commandList.push(l);else for(var h=!1,d=o-1;d>=0;--d){var f=a[d].cullingVolume;if(e.isVisible(l,f))a[d].commandList.push(l),h=!0;else if(h)break}}}function Twe(e){var t=e.frameState,i=t.shadowState.shadowMaps,n=i.length;if(t.shadowState.shadowsEnabled)for(var r=e.context,a=r.uniformState,o=0;o<n;++o){var s=i[o];if(!s.outOfView){var c,l=s.passes,u=l.length;for(c=0;c<u;++c)l[c].commandList.length=0;for(Ewe(e,e.frameState.commandList,s),c=0;c<u;++c){var h=s.passes[c];a.updateCamera(h.camera),s.updatePass(r,c);for(var d=h.commandList.length,f=0;f<d;++f){var p=h.commandList[f];a.updatePass(p.pass),cwe(p.derivedCommands.shadows.castCommands[o],e,r,h.passState)}}}}}var Cwe=new z;function Swe(e,t,i,n){var r=e._frameState;e.gradualRender.isGradualRender=Object(w.a)(n,!1);var a=r.mode;e._environmentState.useWebVR?function(e,t,i){var n=e._view,r=n.camera,a=e._environmentState.renderTranslucentDepthForPick;Bwe(e,t,i),a||kwe(e);n.createPotentiallyVisibleSet(e),a||(xwe(e),Twe(e));var o=t.viewport;o.x=0,o.y=0,o.width=.5*o.width;var s=ose.clone(r,e._cameraVR);s.frustum=r.frustum;var c=r.frustum.near,l=c*Object(w.a)(e.focalLength,5),u=Object(w.a)(e.eyeSeparation,l/30),h=z.multiplyByScalar(s.right,.5*u,Cwe);r.frustum.aspectRatio=o.width/o.height;var d=.5*u*c/l;z.add(s.position,h,r.position),r.frustum.xOffset=d,Owe(e,t),o.x=o.width,z.subtract(s.position,h,r.position),r.frustum.xOffset=-d,Owe(e,t),ose.clone(s,r)}(e,t,i):a!==xF.SCENE2D||e._mapMode2D===Jre.ROTATE?Nwe(!0,e,t,i):(Bwe(e,t,i),function(e,t){var i=e.context,n=e.frameState,r=e.camera,a=t.viewport,o=ln.clone(a,Lwe);t.viewport=o;var s=Awe,c=Pwe;e.mapProjection.project(s,c);var l=z.clone(r.position,Iwe),u=Be.clone(r.transform,jwe),h=r.frustum.clone();r._setTransform(Be.IDENTITY);var d=Be.computeViewportTransformation(o,0,1,Dwe),f=r.frustum.projectionMatrix,p=r.positionWC.y,m=z.fromElements(I.sign(p)*c.x-p,0,-r.positionWC.x,Mwe),_=xa.pointToGLWindowCoordinates(f,d,m,Rwe);_.x=Math.floor(_.x);var g=o.x,v=o.width;if(0===p||_.x<=g||_.x>=g+v)Nwe(!0,e,t);else if(Math.abs(g+.5*v-_.x)<1)o.width=_.x-o.x,r.position.x*=I.sign(r.position.x),r.frustum.right=0,n.cullingVolume=r.frustum.computeCullingVolume(r.positionWC,r.directionWC,r.upWC),i.uniformState.update(n),Nwe(!0,e,t),o.x=_.x,r.position.x=-r.position.x,r.frustum.right=-r.frustum.left,r.frustum.left=0,n.cullingVolume=r.frustum.computeCullingVolume(r.positionWC,r.directionWC,r.upWC),i.uniformState.update(n),Nwe(!1,e,t);else if(_.x>g+.5*v){o.width=_.x-g;var b=r.frustum.right;r.frustum.right=c.x-p,n.cullingVolume=r.frustum.computeCullingVolume(r.positionWC,r.directionWC,r.upWC),i.uniformState.update(n),Nwe(!0,e,t),o.x=_.x,o.width=g+v-_.x,r.position.x=-r.position.x,r.frustum.left=-r.frustum.right,r.frustum.right=b-2*r.frustum.right,n.cullingVolume=r.frustum.computeCullingVolume(r.positionWC,r.directionWC,r.upWC),i.uniformState.update(n),Nwe(!1,e,t)}else{o.x=_.x,o.width=g+v-_.x;var y=r.frustum.left;r.frustum.left=-c.x-p,n.cullingVolume=r.frustum.computeCullingVolume(r.positionWC,r.directionWC,r.upWC),i.uniformState.update(n),Nwe(!0,e,t),o.x=g,o.width=_.x-g,r.position.x=-r.position.x,r.frustum.right=-r.frustum.left,r.frustum.left=y-2*r.frustum.left,n.cullingVolume=r.frustum.computeCullingVolume(r.positionWC,r.directionWC,r.upWC),i.uniformState.update(n),Nwe(!1,e,t)}r._setTransform(u),z.clone(l,r.position),r.frustum=h.clone(),t.viewport=a}(e,t))}var Awe=new K(Math.PI,I.PI_OVER_TWO),Pwe=new z,Iwe=new z,Dwe=new Be,jwe=new Be,Mwe=new z,Rwe=new z,Lwe=new ln;function Nwe(e,t,i,n){var r=t._environmentState,a=t._view,o=r.renderTranslucentDepthForPick;e||o||(t.frameState.commandList.length=0),o||(kwe(t),t.lastCommandListLength=t.frameState.commandList.length),a.createPotentiallyVisibleSet(t),t.gradualRender.resetStep(),e&&(Object(u.a)(n)&&Bwe(t,i,n),o||(xwe(t),Twe(t),function(e){var t=e.frameState,i=t.viewShedState.viewSheds,n=i.length;if(t.viewShedState.viewShedsEnabled)for(var r=e.context,a=r.uniformState,o=0;o<n;++o){var s=i[o];if(!s.outOfView){var c,l=s.passes,u=l.length;for(c=0;c<u;++c)l[c].commandList.length=0;for(Ewe(e,e.frameState.commandList,s),c=0;c<u;++c){var h=s.passes[c];a.updateCamera(h.camera),s.updatePass(r,c);for(var d=h.commandList.length,f=0;f<d;++f){var p=h.commandList[f];a.updatePass(p.pass),cwe(p.derivedCommands.viewSheds.castCommands[o],e,r,h.passState)}}}}}(t))),Owe(t,i)}function Fwe(e){var t=e._frameState,i=e._view,n=e._environmentState,r=t.passes.render,a=t.passes.offscreen,o=e.skyAtmosphere,s=e.globe;if(!r||e._mode!==xF.SCENE2D&&i.camera.frustum instanceof hb)n.skyAtmosphereCommand=void 0,n.skyBoxCommand=void 0,n.sunDrawCommand=void 0,n.sunComputeCommand=void 0,n.moonCommand=void 0;else{Object(u.a)(o)&&Object(u.a)(s)&&(o.setDynamicAtmosphereColor(s.enableLighting),n.isReadyForAtmosphere=n.isReadyForAtmosphere||s._surface._tilesToRender.length>0),n.skyAtmosphereCommand=Object(u.a)(o)?o.update(t):void 0,n.skyBoxCommand=Object(u.a)(e.skyBox)?e.skyBox.update(t,e._hdr):void 0;var c=Object(u.a)(e.sun)?e.sun.update(t,i.passState,e._hdr):void 0;n.sunDrawCommand=Object(u.a)(c)?c.drawCommand:void 0,n.sunComputeCommand=Object(u.a)(c)?c.computeCommand:void 0,n.moonCommand=Object(u.a)(e.moon)?e.moon.update(t):void 0}var l=n.clearGlobeDepth=Object(u.a)(s)&&(!s.depthTestAgainstTerrain||e.mode===xF.SCENE2D);(n.useDepthPlane=l&&e.mode===xF.SCENE3D)&&e._depthPlane.update(t),n.renderTranslucentDepthForPick=!1,n.useWebVR=e._useWebVR&&e.mode!==xF.SCENE2D&&!a;for(var h=t.mode===xF.SCENE3D?t.occluder:void 0,d=t.cullingVolume,f=awe.planes,p=0;p<5;++p)f[p]=d.planes[p];d=awe,n.isSkyAtmosphereVisible=Object(u.a)(n.skyAtmosphereCommand)&&n.isReadyForAtmosphere,n.isSunVisible=e.isVisible(n.sunDrawCommand,d,h),n.isMoonVisible=e.isVisible(n.moonCommand,d,h);var m=e.specularEnvironmentMaps,_=e._specularEnvironmentMapAtlas;!Object(u.a)(m)||Object(u.a)(_)&&_.url===m?!Object(u.a)(m)&&Object(u.a)(_)&&(_.destroy(),e._specularEnvironmentMapAtlas=void 0):(_=_&&_.destroy(),e._specularEnvironmentMapAtlas=new o$(m)),Object(u.a)(e._specularEnvironmentMapAtlas)&&e._specularEnvironmentMapAtlas.update(t)}function kwe(e){var t=e._frameState;e._groundPrimitives.update(t),e._primitives.update(t),function(e){var t=e._frameState;e.debugShowFrustumPlanes!==e._debugShowFrustumPlanes&&(e.debugShowFrustumPlanes?e._debugFrustumPlanes=new Lle({camera:e.camera,updateOnChange:!1}):e._debugFrustumPlanes=e._debugFrustumPlanes&&e._debugFrustumPlanes.destroy(),e._debugShowFrustumPlanes=e.debugShowFrustumPlanes),Object(u.a)(e._debugFrustumPlanes)&&e._debugFrustumPlanes.update(t)}(e),function(e){var t=e._frameState,i=t.shadowMaps,n=i.length,r=n>0&&!t.passes.pick&&e.mode===xF.SCENE3D;if(r!==t.shadowState.shadowsEnabled&&(++t.shadowState.lastDirtyTime,t.shadowState.shadowsEnabled=r),t.shadowState.lightShadowsEnabled=!1,r){for(var a=0;a<n;++a)if(i[a]!==t.shadowState.shadowMaps[a]){++t.shadowState.lastDirtyTime;break}t.shadowState.shadowMaps.length=0,t.shadowState.lightShadowMaps.length=0;for(var o=0;o<n;++o){var s=i[o];s.update(t),t.shadowState.shadowMaps.push(s),s.fromLightSource&&(t.shadowState.lightShadowMaps.push(s),t.shadowState.lightShadowsEnabled=!0),s.dirty&&(++t.shadowState.lastDirtyTime,s.dirty=!1)}}}(e),function(e){var t=e._frameState,i=t.viewSheds,n=i.length,r=n>0&&!t.passes.pick&&e.mode===xF.SCENE3D;if(r!==t.viewShedState.viewShedsEnabled&&(++t.viewShedState.lastDirtyTime,t.viewShedState.viewShedsEnabled=r),t.viewShedState.lightViewShedEnabled=!1,r){for(var a=0;a<n;++a)if(i[a]!==t.viewShedState.viewSheds[a]){++t.viewShedState.lastDirtyTime;break}t.viewShedState.viewSheds.length=0,t.viewShedState.lightViewShedsMaps.length=0;for(var o=0;o<n;++o){var s=i[o];s.update(t),t.viewShedState.viewSheds.push(s),s.fromLightSource&&(t.viewShedState.lightViewShedsMaps.push(s),t.viewShedState.lightViewShedEnabled=!0),s.dirty&&(++t.viewShedState.lastDirtyTime,s.dirty=!1)}}}(e),e._globe&&e._globe.render(t)}function Bwe(e,t,i){var n=e._context,r=e._frameState,a=e._environmentState,o=e._view,s=e._frameState.passes.pick,c=a.useWebVR;a.originalFramebuffer=t.framebuffer,Object(u.a)(e.sun)&&e.sunBloom!==e._sunBloom?(e.sunBloom&&!c?e._sunPostProcess=new xbe:Object(u.a)(e._sunPostProcess)&&(e._sunPostProcess=e._sunPostProcess.destroy()),e._sunBloom=e.sunBloom):!Object(u.a)(e.sun)&&Object(u.a)(e._sunPostProcess)&&(e._sunPostProcess=e._sunPostProcess.destroy(),e._sunBloom=!1);var l=e._clearColorCommand;uf.clone(i,l.color),l.execute(n,t);var h=e.gradualRender.needUpdateDrawCommand(),d=a.useGlobeDepthFramebuffer=Object(u.a)(o.globeDepth);d&&(o.globeDepth.update(n,t,o.viewport,e._hdr),h&&o.globeDepth.clear(n,t,i),e._surfaceWater.update(n,t,o.globeDepth.framebuffer,o.viewport));var f=o.oit,p=a.useOIT=!s&&Object(u.a)(f)&&f.isSupported();p&&(f.update(n,t,o.globeDepth,e._hdr),h&&f.clear(n,t,i),a.useOIT=f.isSupported()),e._modelPlanishCollection.update(n,t,o.viewport),fx.currentFrameTaaEnabled=fx.taaEnabled&&!(e._cameraChanged||fx.gradualRenderMode||fx.historicalInvalid)&&!s,e._taaRenderPass.beginFrame(e),fx.currentFrameTaaEnabled&&e._taaRenderPass.update(n,t,o.viewport,e._hdr);var m,_=e.postProcessStages,g=a.usePostProcess=!s&&(e._hdr||_.length>0||_.ambientOcclusion.enabled||_.fxaa.enabled||_.bloom.enabled);if(a.usePostProcessSelected=!1,g&&(o.sceneFramebuffer.update(n,o.viewport,e._hdr),o.sceneFramebuffer.clear(n,t,i),_.update(n,r.useLogDepth,e._hdr),_.clear(n),g=a.usePostProcess=_.ready,a.usePostProcessSelected=g&&_.hasSelected),a.isSunVisible&&e.sunBloom&&!c?(t.framebuffer=e._sunPostProcess.update(t),e._sunPostProcess.clear(n,t,i)):d?fx.isWebgl2&&!s?t.framebuffer=o.globeDepth.multisamplingBlitFramerbuffer:t.framebuffer=o.globeDepth.framebuffer:g&&(t.framebuffer=o.sceneFramebuffer.getFramebuffer()),h&&Object(u.a)(t.framebuffer)&&(l.execute(n,t),d&&o.globeDepth.clearMRTColorTexture(n,t),fx.vignetteMode&&e._vignetteCommand.update(t)),a.useInvertClassification=!s&&Object(u.a)(t.framebuffer)&&e.invertClassification)if(1===e.frameState.invertClassificationColor.alpha&&a.useGlobeDepthFramebuffer&&(m=o.globeDepth.framebuffer),Object(u.a)(m)||n.depthTexture){if(e._invertClassification.previousFramebuffer=m,e._invertClassification.update(n),e._invertClassification.clear(n,t),e.frameState.invertClassificationColor.alpha<1&&p){var v=e._invertClassification.unclassifiedCommand,b=v.derivedCommands;b.oit=f.createDerivedCommands(v,n,b.oit)}}else a.useInvertClassification=!1}function zwe(e,t){var i=e._context,n=e._frameState,r=e._environmentState,a=e._view,o=e._gradualRender,s=n.commandList.length>0,c=o.getPassCommandsLength(lM.TRANSLUCENT)>0,l=r.useOIT&&c,u=r.useGlobeDepthFramebuffer,h=r.usePostProcess,d=fx.currentFrameTaaEnabled&&s,f=r.originalFramebuffer,p=u?a.globeDepth.framebuffer:void 0,m=a.sceneFramebuffer.getFramebuffer(),_=a.sceneFramebuffer.getIdFramebuffer(),g=e._taaRenderPass.defaultFrameBuffer,v=Object(w.a)(p,m).depthStencilTexture;if(l&&(t.framebuffer=d?g:h?m:f,o.isPassRendered(lM.TRANSLUCENT)&&a.oit.execute(i,t)),d){var b=l?t.framebuffer.getColorTexture(0):Object(w.a)(p,m).getColorTexture(0);e._taaRenderPass.render(e,t,b)}if(h){var y=d?e._taaRenderPass.multipleSamplesFrameBuffer:l?m:f;!u||d||l||(y=p);var O=e.postProcessStages,x=y.getColorTexture(0),E=_.getColorTexture(0);O.execute(i,x,v,E),O.copy(i,f)}l||h||!u||(t.framebuffer=f,a.globeDepth.executeCopyColor(i,t));var T=n.useLogDepth;e.debugShowGlobeDepth&&u&&pwe(e,e.debugShowDepthFrustum-1).executeDebugGlobeDepth(i,t,T);e.debugShowPickDepth&&u&&mwe(e,e.debugShowDepthFrustum-1).executeDebugPickDepth(i,t,T)}function Uwe(e){var t=e._frameState;Object(u.a)(e.globe)&&e.globe.update(t),function(e){for(var t=e._asyncRayPicks,i=0;i<t.length;++i)cOe(e,t[i])&&t.splice(i--,1)}(e),t.creditDisplay.update()}Jye.prototype.initializeFrame=function(){120==this._shaderFrameCount++&&(this._shaderFrameCount=0,this._context.shaderCache.destroyReleasedShaderPrograms(),this._context.textureCache.destroyReleasedTextures()),this._tweens.update(),this._screenSpaceCameraController.update(),Object(u.a)(this._deviceOrientationCameraController)&&this._deviceOrientationCameraController.update(),this.camera.update(this._mode),this.camera._updateCameraChanged()};var Vwe=new uf;function Hwe(e){e._pickPositionCacheDirty=!0;var t=e.context,i=t.uniformState,n=e._frameState,r=e._defaultView;e._view=r,rwe(e),n.passes.render=!0,n.passes.postProcess=e.postProcessStages.hasSelected;var a=Object(w.a)(e.backgroundColor,uf.BLACK);e._hdr&&((a=uf.clone(a,Vwe)).red=Math.pow(a.red,e.gamma),a.green=Math.pow(a.green,e.gamma),a.blue=Math.pow(a.blue,e.gamma)),n.backgroundColor=a,n.creditDisplay.beginFrame(),e.fog.update(n),i.update(n);var o=e.shadowMap;Object(u.a)(o)&&o.enabled&&(z.negate(i.sunDirectionWC,e._sunCamera.direction),n.shadowMaps.push(o)),e._computeCommandList.length=0,e._overlayCommandList.length=0;var s=r.viewport;s.x=0,s.y=0,s.width=t.drawingBufferWidth,s.height=t.drawingBufferHeight;var c=r.passState;c.framebuffer=void 0,c.blendingEnabled=void 0,c.scissorTest=void 0,c.viewport=ln.clone(s,c.viewport),Object(u.a)(e.globe)&&e.globe.beginFrame(n),Fwe(e),Swe(e,c,a,fx.gradualRenderMode),zwe(e,c),c.framebuffer=void 0,function(e,t){e.context.uniformState.updatePass(lM.OVERLAY);for(var i=e.context,n=e._overlayCommandList,r=n.length,a=0;a<r;++a)n[a].execute(i,t)}(e,c),Object(u.a)(e.globe)&&(e.globe.endFrame(n),e.globe.tilesLoaded||(e._renderRequested=!0)),n.creditDisplay.endFrame(),t.endFrame()}function Gwe(e,t){try{t(e)}catch(t){if(e._renderError.raiseEvent(e,t),e.rethrowRenderErrors)throw t}}Jye.prototype.render=function(e){Object(u.a)(e)||(e=Tr.now());var t=this._frameState;this._jobScheduler.resetBudgets();var i=this._view.checkForCameraUpdates(this);this._cameraChanged=i;var n=i||this._mouseDownFlag>0;this._needRenderNextFrame=n,this.gradualRender.cameraChanged=n,this.gradualRender._currentFrameRenderRequested=this._renderRequested;var r=(fx._gradualRenderMode?!this.gradualRender.isAllRendered():!this.requestRenderMode)||this._renderRequested||n||this._logDepthBufferDirty||this._hdrDirty||this.mode===xF.MORPHING;r&&(this._lastRenderTime=Tr.clone(e,this._lastRenderTime),this._renderRequested=!1,this._logDepthBufferDirty=!1,this._hdrDirty=!1,nwe(this,I.incrementWrap(t.frameNumber,15e6,1),e));if(this._preUpdate.raiseEvent(this,e),Gwe(this,Uwe),this._postUpdate.raiseEvent(this,e),r)this._preRender.raiseEvent(this,e),Gwe(this,Hwe),bS.a.update();else if(fx._gradualRenderMode){rwe(this),t.passes.render=!0,t.passes.postProcess=this.postProcessStages.hasSelected,t.frameNumber=I.incrementWrap(t.frameNumber,15e6,1),kwe(this);var a=t.commandList.length;this._needRenderNextFrame=this.lastCommandListLength!==a,this.lastCommandListLength=a}!function(e,t){if(e.debugShowFramesPerSecond){if(!Object(u.a)(e._performanceDisplay)){var i=document.createElement("div");i.className="cesium-performanceDisplay-defaultContainer",e._canvas.parentNode.appendChild(i);var n=new Vfe({container:i});e._performanceDisplay=n,e._performanceContainer=i}e._performanceDisplay.throttled=e.requestRenderMode,e._performanceDisplay.update(t)}else Object(u.a)(e._performanceDisplay)&&(e._performanceDisplay=e._performanceDisplay&&e._performanceDisplay.destroy(),e._performanceContainer.parentNode.removeChild(e._performanceContainer))}(this,r),function(e){for(var t=e._frameState.afterRender,i=0,n=t.length;i<n;++i)t[i](),e.requestRender();t.length=0}(this),r&&this._postRender.raiseEvent(this,e),this._needRenderNextFrame&&(this._renderRequested=!0),this.gradualRender.startRenderTime=Qd()},Jye.prototype.forceRender=function(e){this._renderRequested=!0,this.render(e)},Jye.prototype.requestRender=function(){this._renderRequested=!0},Jye.prototype.isRenderRequested=function(){return this._renderRequested},Jye.prototype.renderToTexture=function(e,t,i,n){var r=this.frameState,a=this.context,o=a.uniformState;iwe(this._frameState.passes),r.passes.render=!0;var s=r.camera;r.camera=i,o.updateCamera(i),e.execute(this.context,t),Object(u.a)(n)&&cwe(n,this,a,t),o.updateCamera(this.camera),o.updateFrustum(this.camera.workingFrustums[0]),r.camera=s},Jye.prototype.renderModelPlanishColorTexture=function(e,t){var i=this.frameState,n=this.context,r=n.uniformState,a=e.clearCommand,o=e.camera;a.execute(n,t);var s=i.camera;i.camera=o,r.updateCamera(o),e.planishCameraViewMatrix=r.view,e.planishCameraProjectionMatrix=r.projection;for(var c=i.commandList,l=c.length,u=0;u<l;++u){var h=c[u];if(h.pass===lM.MODEL_PLANISH)r.updatePass(h.pass),cwe(h.derivedCommands.modelPlanishInfo.planishCommand,this,n,t)}r.updateCamera(s),r.updateFrustum(s.workingFrustums[0]),i.camera=s},Jye.prototype.renderColorTexture=function(e,t,i){var n=this.frameState,r=this.context,a=r.uniformState;iwe(n.passes),e.execute(r,t);var o=n.camera;n.camera=i,a.updateCamera(i),Fwe(this);var s=n.commandList,c=s.length,l=this._environmentState;l.isSkyAtmosphereVisible&&cwe(l.skyAtmosphereCommand,this,r,t);for(var u=0;u<c;++u){var h=s[u];h.pass===lM.CESIUM_3D_TILE&&(a.updatePass(h.pass),cwe(h,this,r,t))}a.updateCamera(this.camera),a.updateFrustum(this.camera.workingFrustums[0]),n.camera=o},Jye.prototype.clampLineWidth=function(e){return Math.max(HD.minimumAliasedLineWidth,Math.min(e,HD.maximumAliasedLineWidth))};var qwe=new cb,Wwe=new z,Ywe=new z,Xwe=new Rt,Zwe=new Be;var Qwe=new vb;function Kwe(e,t,i,n,r){var a=e.camera.frustum;return a instanceof hb||a instanceof cb?function(e,t,i,n,r){var a=e.camera,o=a.frustum;Object(u.a)(o._offCenterFrustum)&&(o=o._offCenterFrustum);var s=2*(t.x-r.x)/r.width-1;s*=.5*(o.right-o.left);var c=2*(r.height-t.y-r.y)/r.height-1;c*=.5*(o.top-o.bottom);var l=Be.clone(a.transform,Zwe);a._setTransform(Be.IDENTITY);var h=z.clone(a.position,Wwe);z.multiplyByScalar(a.right,s,Ywe),z.add(Ywe,h,h),z.multiplyByScalar(a.up,c,Ywe),z.add(Ywe,h,h),a._setTransform(l),e.mode===xF.SCENE2D&&z.fromElements(h.z,h.x,h.y,h);var d=o.getPixelDimensions(r.width,r.height,1,Xwe),f=qwe;return f.right=.5*d.x,f.left=-f.right,f.top=.5*d.y,f.bottom=-f.top,f.near=o.near,f.far=o.far,f.computeCullingVolume(h,a.directionWC,a.upWC)}(e,t,0,0,r):function(e,t,i,n,r){var a=e.camera,o=a.frustum,s=o.near,c=Math.tan(.5*o.fovy),l=o.aspectRatio*c,u=(2*(t.x-r.x)/r.width-1)*s*l,h=(2*(r.height-t.y-r.y)/r.height-1)*s*c,d=o.getPixelDimensions(r.width,r.height,1,Xwe),f=d.x*i*.5,p=d.y*n*.5,m=Qwe;return m.top=h+p,m.bottom=h-p,m.right=u+f,m.left=u-f,m.near=s,m.far=o.far,m.computeCullingVolume(a.positionWC,a.directionWC,a.upWC)}(e,t,i,n,r)}var Jwe=3,$we=3,eOe=new ln(0,0,Jwe,$we),tOe=new uf(0,0,0,0),iOe=new Rt;Jye.prototype.pick=function(e,t,i){if(!Object(u.a)(e))throw new h.a("windowPosition is undefined.");Jwe=Object(w.a)(t,3),$we=Object(w.a)(i,Jwe);var n=this._context,r=n.uniformState,a=this._frameState,o=this._defaultView;this._view=o;var s=o.viewport;s.x=0,s.y=0,s.width=n.drawingBufferWidth,s.height=n.drawingBufferHeight;var c=o.passState;c.viewport=ln.clone(s,c.viewport);var l=gV.transformWindowToDrawingBuffer(this,e,iOe);this._jobScheduler.disableThisFrame(),rwe(this),a.cullingVolume=Kwe(this,l,Jwe,$we,s),a.invertClassification=!1,a.passes.pick=!0,r.update(a),Fwe(this),eOe.x=l.x-.5*(Jwe-1),eOe.y=this.drawingBufferHeight-l.y-.5*($we-1),eOe.width=Jwe,eOe.height=$we,Swe(this,c=o.pickFramebuffer.begin(eOe,o.viewport),tOe),zwe(this,c);var d=o.pickFramebuffer.end(eOe);return n.endFrame(),d},Jye.prototype.pickPositionWorldCoordinates=function(e,t){if(this.useDepthPicking){if(!Object(u.a)(e))throw new h.a("windowPosition is undefined.");if(!this._context.depthTexture)throw new h.a("Picking from the depth buffer is not supported. Check pickPositionSupported.");var i=e.toString();if(this._pickPositionCacheDirty)this._pickPositionCache={},this._pickPositionCacheDirty=!1;else if(this._pickPositionCache.hasOwnProperty(i))return z.clone(this._pickPositionCache[i],t);var n=this._frameState,r=this._context,a=r.uniformState,o=this._defaultView;this._view=o;var s=gV.transformWindowToDrawingBuffer(this,e,iOe);this.pickTranslucentDepth?function(e,t){var i=e._context,n=e._frameState,r=e._environmentState,a=e._defaultView;e._view=a;var o=a.viewport;o.x=0,o.y=0,o.width=i.drawingBufferWidth,o.height=i.drawingBufferHeight;var s=a.passState;s.viewport=ln.clone(o,s.viewport),iwe(n.passes),n.passes.pick=!0,n.passes.depth=!0,n.cullingVolume=Kwe(e,t,1,1,o),Fwe(e),r.renderTranslucentDepthForPick=!0,Swe(e,s=a.pickDepthFramebuffer.update(i,t,o),tOe),zwe(e,s),i.endFrame()}(this,s):(rwe(this),a.update(n),Fwe(this)),s.y=this.drawingBufferHeight-s.y;var c,l=this.camera;c=Object(u.a)(l.frustum.fov)?l.frustum.clone(vwe):Object(u.a)(l.frustum.infiniteProjectionMatrix)?l.frustum.clone(bwe):Object(u.a)(l.frustum.width)?l.frustum.clone(ywe):l.frustum.clone(wwe);for(var d=o.frustumCommandsList,f=d.length,p=0;p<f;++p){var m=mwe(this,p).getDepth(r,s.x,s.y);if(m>0&&m<1){var _,g=d[p];return this.mode===xF.SCENE2D?(_=l.position.z,l.position.z=_-g.near+1,c.far=Math.max(1,g.far-g.near),c.near=1,a.update(n),a.updateFrustum(c)):(c.near=g.near*(0!==p?this.opaqueFrustumNearOffset:1),c.far=g.far,a.updateFrustum(c)),t=gV.drawingBufferToWgs84Coordinates(this,s,m,t),this.mode===xF.SCENE2D&&(l.position.z=_,a.update(n)),this._pickPositionCache[i]=z.clone(t),t}}this._pickPositionCache[i]=void 0}};var nOe=new K;function rOe(e,t){var i,n,r=[],a=[],o=[],s=[];Object(u.a)(e)||(e=Number.MAX_VALUE);for(var c=t();Object(u.a)(c);){var l=c.object,h=c.position,d=c.exclude;if(Object(u.a)(h)&&!Object(u.a)(l)){r.push(c);break}if(!Object(u.a)(l)||!Object(u.a)(l.primitive))break;if(!d&&(r.push(c),0>=--e))break;var f=l.primitive,p=!1;"function"==typeof f.getGeometryInstanceAttributes&&Object(u.a)(l.id)&&(n=f.getGeometryInstanceAttributes(l.id),Object(u.a)(n)&&Object(u.a)(n.show)&&(p=!0,n.show=sA.toValue(!1,n.show),o.push(n))),l instanceof KX&&(p=!0,l.show=!1,s.push(l)),p||(f.show=!1,a.push(f)),c=t()}for(i=0;i<a.length;++i)a[i].show=!0;for(i=0;i<o.length;++i)(n=o[i]).show=sA.toValue(!0,n.show);for(i=0;i<s.length;++i)s[i].show=!0;return r}Jye.prototype.pickPosition=function(e,t){if(t=this.pickPositionWorldCoordinates(e,t),Object(u.a)(t)&&this.mode!==xF.SCENE3D){z.fromElements(t.y,t.z,t.x,t);var i=this.mapProjection,n=i.ellipsoid,r=i.unproject(t,nOe);n.cartographicToCartesian(r,t)}return t},Jye.prototype.drillPick=function(e,t,i,n){var r=this;return rOe(t,(function(){var t=r.pick(e,i,n);if(Object(u.a)(t))return{object:t,position:void 0,exclude:!1}})).map((function(e){return e.object}))};var aOe=new z,oOe=new z;function sOe(e,t,i,n){var r=t.direction,a=z.mostOrthogonalAxis(r,aOe),o=z.cross(r,a,aOe),s=z.cross(r,o,oOe);n.position=t.origin,n.direction=r,n.up=s,n.right=o,n.frustum.width=Object(w.a)(i,e.pickOffscreenDefaultWidth)}function cOe(e,t){var i=e._context.uniformState,n=e._frameState,r=e._pickOffscreenView;e._view=r;var a=t.ray,o=t.width,s=t.primitives;sOe(e,a,o,r.camera),rwe(e),n.passes.offscreen=!0,n.passes.asynchronous=!0,i.update(n);for(var c=n.commandList,l=c.length,u=!0,h=s.length,d=0;d<h;++d){var f=s[d];if(f.show&&e.primitives.contains(f)){var p=f.updateAsync(n);u=u&&p}}return c.length=l,e._view=e._defaultView,u&&t.deferred.resolve(),u}function lOe(e,t,i,n,r){for(var a=[],o=e.primitives,s=o.length,c=0;c<s;++c){var l=o.get(c);l instanceof zse&&l.show&&(Object(u.a)(i)&&-1!==i.indexOf(l)||a.push(l))}if(0===a.length)return Oi.a.resolve(r());var h=new Kye(t,n,a);return e._asyncRayPicks.push(h),h.promise.then((function(){return r()}))}function uOe(e,t){return!(!Object(u.a)(e)||!Object(u.a)(t)||0===t.length)&&(t.indexOf(e)>-1||t.indexOf(e.primitive)>-1||t.indexOf(e.id)>-1)}function hOe(e,t,i,n,r,a,o){return rOe(i,(function(){return function(e,t,i,n,r,a){var o=e._context,s=o.uniformState,c=e._frameState,l=e._pickOffscreenView;e._view=l,sOe(e,t,n,l.camera),eOe=ln.clone(l.viewport,eOe);var h,d=l.pickFramebuffer.begin(eOe,l.viewport);e._jobScheduler.disableThisFrame(),rwe(e),c.invertClassification=!1,c.passes.pick=!0,c.passes.offscreen=!0,c.passes.asynchronous=a,s.update(c),Fwe(e),Swe(e,d,tOe),zwe(e,d);var f=l.pickFramebuffer.end(o);if(e._context.depthTexture)for(var p=l.frustumCommandsList.length,m=0;m<p;++m){var _=mwe(e,m).getDepth(o,0,0);if(_>0&&_<1){var g=l.frustumCommandsList[m],v=g.near*(0!==m?e.opaqueFrustumNearOffset:1),b=v+_*(g.far-v);h=Ts.getPoint(t,b);break}}if(e._view=e._defaultView,o.endFrame(),Object(u.a)(f)||Object(u.a)(h))return{object:f,position:h,exclude:!Object(u.a)(h)&&r||uOe(f,i)}}(e,t,n,r,a,o)}))}function dOe(e,t,i,n,r,a){var o=hOe(e,t,1,i,n,r,a);if(o.length>0)return o[0]}function fOe(e,t,i,n,r,a,o){return hOe(e,t,i,n,r,a,o)}Jye.prototype.pickFromRay=function(e,t,i){if(x.a.defined("ray",e),this._mode!==xF.SCENE3D)throw new h.a("Ray intersections are only supported in 3D mode.");return dOe(this,e,t,i,!1,!1)},Jye.prototype.drillPickFromRay=function(e,t,i,n){if(x.a.defined("ray",e),this._mode!==xF.SCENE3D)throw new h.a("Ray intersections are only supported in 3D mode.");return fOe(this,e,t,i,n,!1,!1)},Jye.prototype.pickFromRayMostDetailed=function(e,t,i){if(x.a.defined("ray",e),this._mode!==xF.SCENE3D)throw new h.a("Ray intersections are only supported in 3D mode.");var n=this;return e=Ts.clone(e),t=Object(u.a)(t)?t.slice():t,lOe(this,e,t,i,(function(){return dOe(n,e,t,i,!1,!0)}))},Jye.prototype.drillPickFromRayMostDetailed=function(e,t,i,n){if(x.a.defined("ray",e),this._mode!==xF.SCENE3D)throw new h.a("Ray intersections are only supported in 3D mode.");var r=this;return e=Ts.clone(e),i=Object(u.a)(i)?i.slice():i,lOe(this,e,i,n,(function(){return fOe(r,e,t,i,n,!1,!0)}))};var pOe=new z,mOe=new z,_Oe=new Ts,gOe=new K;function vOe(e,t){var i=e.globe,n=Object(u.a)(i)?i.ellipsoid:e.mapProjection.ellipsoid,r=Xt._defaultMaxTerrainHeight,a=n.geodeticSurfaceNormalCartographic(t,mOe),o=K.toCartesian(t,n,pOe),s=_Oe;s.origin=o,s.direction=a;var c=new Ts;return Ts.getPoint(s,r,c.origin),z.negate(a,c.direction),c}function bOe(e,t){var i=e.globe,n=Object(u.a)(i)?i.ellipsoid:e.mapProjection.ellipsoid;return vOe(e,K.fromCartesian(t,n,gOe))}function yOe(e,t){var i=e.globe,n=Object(u.a)(i)?i.ellipsoid:e.mapProjection.ellipsoid;return K.fromCartesian(t,n,gOe).height}function wOe(e,t,i,n){var r=vOe(e,t);return lOe(e,r,i,n,(function(){var t=dOe(e,r,i,n,!0,!0);if(Object(u.a)(t))return yOe(e,t.position)}))}function OOe(e,t,i,n,r){var a=bOe(e,t);return lOe(e,a,i,n,(function(){var t=dOe(e,a,i,n,!0,!0);if(Object(u.a)(t))return z.clone(t.position,r)}))}Jye.prototype.sampleHeight=function(e,t,i){if(x.a.defined("position",e),this._mode!==xF.SCENE3D)throw new h.a("sampleHeight is only supported in 3D mode.");if(!this.sampleHeightSupported)throw new h.a("sampleHeight requires depth texture support. Check sampleHeightSupported.");var n=dOe(this,vOe(this,e),t,i,!0,!1);if(Object(u.a)(n))return yOe(this,n.position)},Jye.prototype.clampToHeight=function(e,t,i,n){if(x.a.defined("cartesian",e),this._mode!==xF.SCENE3D)throw new h.a("sampleHeight is only supported in 3D mode.");if(!this.clampToHeightSupported)throw new h.a("clampToHeight requires depth texture support. Check clampToHeightSupported.");i instanceof z&&(n=i,i=void 0,Object(mv.a)("clampToHeight-parameter-change","clampToHeight now takes an optional width argument before the result argument in Cesium 1.54.  The previous function definition will no longer work in 1.56."));var r=dOe(this,bOe(this,e),t,i,!0,!1);if(Object(u.a)(r))return z.clone(r.position,n)},Jye.prototype.sampleHeightMostDetailed=function(e,t,i){if(x.a.defined("positions",e),this._mode!==xF.SCENE3D)throw new h.a("sampleHeightMostDetailed is only supported in 3D mode.");if(!this.sampleHeightSupported)throw new h.a("sampleHeightMostDetailed requires depth texture support. Check sampleHeightSupported.");t=Object(u.a)(t)?t.slice():t;for(var n=e.length,r=new Array(n),a=0;a<n;++a)r[a]=wOe(this,e[a],t,i);return Oi.a.all(r).then((function(t){for(var i=t.length,n=0;n<i;++n)e[n].height=t[n];return e}))},Jye.prototype.clampToHeightMostDetailed=function(e,t,i){if(x.a.defined("cartesians",e),this._mode!==xF.SCENE3D)throw new h.a("clampToHeightMostDetailed is only supported in 3D mode.");if(!this.clampToHeightSupported)throw new h.a("clampToHeightMostDetailed requires depth texture support. Check clampToHeightSupported.");t=Object(u.a)(t)?t.slice():t;for(var n=e.length,r=new Array(n),a=0;a<n;++a)r[a]=OOe(this,e[a],t,i,e[a]);return Oi.a.all(r).then((function(t){for(var i=t.length,n=0;n<i;++n)e[n]=t[n];return e}))},Jye.prototype.cartesianToCanvasCoordinates=function(e,t){return gV.wgs84ToWindowCoordinates(this,e,t)},Jye.prototype.completeMorph=function(){this._transitioner.completeMorph()},Jye.prototype.morphTo2D=function(e){var t,i=this.globe;t=Object(u.a)(i)?i.ellipsoid:this.mapProjection.ellipsoid,e=Object(w.a)(e,2),this._transitioner.morphTo2D(e,t)},Jye.prototype.morphToColumbusView=function(e){var t,i=this.globe;t=Object(u.a)(i)?i.ellipsoid:this.mapProjection.ellipsoid,e=Object(w.a)(e,2),this._transitioner.morphToColumbusView(e,t)},Jye.prototype.morphTo3D=function(e){var t,i=this.globe;t=Object(u.a)(i)?i.ellipsoid:this.mapProjection.ellipsoid,e=Object(w.a)(e,2),this._transitioner.morphTo3D(e,t)},Jye.prototype.isDestroyed=function(){return!1},Jye.prototype.destroy=function(){this._tweens.removeAll(),this._computeEngine=this._computeEngine&&this._computeEngine.destroy(),this._screenSpaceCameraController=this._screenSpaceCameraController&&this._screenSpaceCameraController.destroy(),this._deviceOrientationCameraController=this._deviceOrientationCameraController&&!this._deviceOrientationCameraController.isDestroyed()&&this._deviceOrientationCameraController.destroy(),this._primitives=this._primitives&&this._primitives.destroy(),this._groundPrimitives=this._groundPrimitives&&this._groundPrimitives.destroy(),this._globe=this._globe&&this._globe.destroy(),this.skyBox=this.skyBox&&this.skyBox.destroy(),this.skyAtmosphere=this.skyAtmosphere&&this.skyAtmosphere.destroy(),this._debugSphere=this._debugSphere&&this._debugSphere.destroy(),this.sun=this.sun&&this.sun.destroy(),this._sunPostProcess=this._sunPostProcess&&this._sunPostProcess.destroy(),this._depthPlane=this._depthPlane&&this._depthPlane.destroy(),this._transitioner=this._transitioner&&this._transitioner.destroy(),this._debugFrustumPlanes=this._debugFrustumPlanes&&this._debugFrustumPlanes.destroy(),this._brdfLutGenerator=this._brdfLutGenerator&&this._brdfLutGenerator.destroy(),this._defaultView=this._defaultView&&this._defaultView.destroy(),this._pickOffscreenView=this._pickOffscreenView&&this._pickOffscreenView.destroy(),this._view=void 0,this._removeCreditContainer&&this._canvas.parentNode.removeChild(this._creditContainer),this.postProcessStages=this.postProcessStages&&this.postProcessStages.destroy(),this._context=this._context&&this._context.destroy(),this._frameState.creditDisplay=this._frameState.creditDisplay&&this._frameState.creditDisplay.destroy(),Object(u.a)(this._performanceDisplay)&&(this._performanceDisplay=this._performanceDisplay&&this._performanceDisplay.destroy(),this._performanceContainer.parentNode.removeChild(this._performanceContainer)),this._removeRequestListenerCallback(),this._removeTaskProcessorListenerCallback();for(var e=0;e<this._removeGlobeCallbacks.length;++e)this._removeGlobeCallbacks[e]();return this._removeGlobeCallbacks.length=0,rl(this)};var xOe=Jye,EOe="#ifdef COLOR_CORRECT\nuniform vec3 u_hsbShift;\n#endif\nuniform vec4 u_cameraAndRadiiAndDynamicAtmosphereColor;\nconst float g = -0.95;\nconst float g2 = g * g;\nvarying vec3 v_rayleighColor;\nvarying vec3 v_mieColor;\nvarying vec3 v_toCamera;\nvarying vec3 v_positionEC;\nvoid main (void)\n{\nfloat cosAngle = dot(czm_sunDirectionWC, normalize(v_toCamera)) / length(v_toCamera);\nfloat rayleighPhase = 0.75 * (1.0 + cosAngle * cosAngle);\nfloat miePhase = 1.5 * ((1.0 - g2) / (2.0 + g2)) * (1.0 + cosAngle * cosAngle) / pow(1.0 + g2 - 2.0 * g * cosAngle, 1.5);\nvec3 rgb = rayleighPhase * v_rayleighColor + miePhase * v_mieColor;\n#ifndef HDR\nconst float exposure = 1.1;\nrgb = vec3(1.0) - exp(-exposure * rgb);\n#endif\n#ifdef COLOR_CORRECT\nvec3 hsb = czm_RGBToHSB(rgb);\nhsb.x += u_hsbShift.x;\nhsb.y = clamp(hsb.y + u_hsbShift.y, 0.0, 1.0);\nhsb.z = hsb.z > czm_epsilon7 ? hsb.z + u_hsbShift.z : 0.0;\nrgb = czm_HSBToRGB(hsb);\n#endif\nfloat atmosphereAlpha = clamp((u_cameraAndRadiiAndDynamicAtmosphereColor.y - u_cameraAndRadiiAndDynamicAtmosphereColor.x) / (u_cameraAndRadiiAndDynamicAtmosphereColor.y - u_cameraAndRadiiAndDynamicAtmosphereColor.z), 0.0, 1.0);\nfloat nightAlpha = (u_cameraAndRadiiAndDynamicAtmosphereColor.w > 0.0) ? clamp(dot(normalize(czm_viewerPositionWC), normalize(czm_sunPositionWC)), 0.0, 1.0) : 1.0;\natmosphereAlpha *= pow(nightAlpha, 0.5);\ngl_FragColor = vec4(rgb, mix(rgb.b, 1.0, atmosphereAlpha) * smoothstep(0.0, 1.0, czm_morphTime));\n}\n",TOe="attribute vec4 position;\nuniform vec4 u_cameraAndRadiiAndDynamicAtmosphereColor;\nconst float Kr = 0.0025;\nconst float Kr4PI = Kr * 4.0 * czm_pi;\nconst float Km = 0.0015;\nconst float Km4PI = Km * 4.0 * czm_pi;\nconst float ESun = 15.0;\nconst float KmESun = Km * ESun;\nconst float KrESun = Kr * ESun;\nconst vec3 InvWavelength = vec3(\n5.60204474633241,\n9.473284437923038,\n19.643802610477206);\nconst float rayleighScaleDepth = 0.25;\nconst int nSamples = 2;\nconst float fSamples = 2.0;\nvarying vec3 v_rayleighColor;\nvarying vec3 v_mieColor;\nvarying vec3 v_toCamera;\nfloat scale(float cosAngle)\n{\nfloat x = 1.0 - cosAngle;\nreturn rayleighScaleDepth  * exp(-0.00287 + x*(0.459 + x*(3.83 + x*(-6.80 + x*5.25))));\n}\nvoid main(void)\n{\nfloat cameraHeight = u_cameraAndRadiiAndDynamicAtmosphereColor.x;\nfloat outerRadius = u_cameraAndRadiiAndDynamicAtmosphereColor.y;\nfloat innerRadius = u_cameraAndRadiiAndDynamicAtmosphereColor.z;\nvec3 positionV3 = position.xyz;\nvec3 ray = positionV3 - czm_viewerPositionWC;\nfloat far = length(ray);\nray /= far;\nfloat atmosphereScale = 1.0 / (outerRadius - innerRadius);\n#ifdef SKY_FROM_SPACE\nfloat B = 2.0 * dot(czm_viewerPositionWC, ray);\nfloat C = cameraHeight * cameraHeight - outerRadius * outerRadius;\nfloat det = max(0.0, B*B - 4.0 * C);\nfloat near = 0.5 * (-B - sqrt(det));\nvec3 start = czm_viewerPositionWC + ray * near;\nfar -= near;\nfloat startAngle = dot(ray, start) / outerRadius;\nfloat startDepth = exp(-1.0 / rayleighScaleDepth );\nfloat startOffset = startDepth*scale(startAngle);\n#else // SKY_FROM_ATMOSPHERE\nvec3 start = czm_viewerPositionWC;\nfloat height = length(start);\nfloat depth = exp((atmosphereScale / rayleighScaleDepth ) * (innerRadius - cameraHeight));\nfloat startAngle = dot(ray, start) / height;\nfloat startOffset = depth*scale(startAngle);\n#endif\nfloat sampleLength = far / fSamples;\nfloat scaledLength = sampleLength * atmosphereScale;\nvec3 sampleRay = ray * sampleLength;\nvec3 samplePoint = start + sampleRay * 0.5;\nvec3 frontColor = vec3(0.0, 0.0, 0.0);\nvec3 lightDir = (u_cameraAndRadiiAndDynamicAtmosphereColor.w > 0.0) ? czm_sunPositionWC - czm_viewerPositionWC : czm_viewerPositionWC;\nlightDir = normalize(lightDir);\nfor(int i=0; i<nSamples; i++)\n{\nfloat height = length(samplePoint);\nfloat depth = exp((atmosphereScale / rayleighScaleDepth ) * (innerRadius - height));\nfloat fLightAngle = dot(lightDir, samplePoint) / height;\nfloat fCameraAngle = dot(ray, samplePoint) / height;\nfloat fScatter = (startOffset + depth*(scale(fLightAngle) - scale(fCameraAngle)));\nvec3 attenuate = exp(-fScatter * (InvWavelength * Kr4PI + Km4PI));\nfrontColor += attenuate * (depth * scaledLength);\nsamplePoint += sampleRay;\n}\nv_mieColor = frontColor * KmESun;\nv_rayleighColor = frontColor * (InvWavelength * KrESun);\nv_toCamera = czm_viewerPositionWC - positionV3;\ngl_Position = czm_modelViewProjection * position;\n}\n";
/**
 * @license
 * Copyright (c) 2000-2005, Sean O'Neil (s_p_oneil@hotmail.com)
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 *
 * * Redistributions of source code must retain the above copyright notice,
 *   this list of conditions and the following disclaimer.
 * * Redistributions in binary form must reproduce the above copyright notice,
 *   this list of conditions and the following disclaimer in the documentation
 *   and/or other materials provided with the distribution.
 * * Neither the name of the project nor the names of its contributors may be
 *   used to endorse or promote products derived from this software without
 *   specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
 * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
 * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE
 * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
 * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
 * SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
 * CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
 * OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 *
 * Modifications made by Analytical Graphics, Inc.
 */function COe(e){e=Object(w.a)(e,ae.WGS84),this.show=!0,this._ellipsoid=e,this._command=new cM({owner:this}),this._spSkyFromSpace=void 0,this._spSkyFromAtmosphere=void 0,this._spSkyFromSpaceColorCorrect=void 0,this._spSkyFromAtmosphereColorCorrect=void 0,this.hueShift=0,this.saturationShift=0,this.brightnessShift=0,this._hueSaturationBrightness=new z;var t=new Te;t.w=0,t.y=z.maximumComponent(z.multiplyByScalar(e.radii,1.025,new z)),t.z=e.maximumRadius,this._cameraAndRadiiAndDynamicAtmosphereColor=t;var i=this;this._command.uniformMap={u_cameraAndRadiiAndDynamicAtmosphereColor:function(){return i._cameraAndRadiiAndDynamicAtmosphereColor},u_hsbShift:function(){return i._hueSaturationBrightness.x=i.hueShift,i._hueSaturationBrightness.y=i.saturationShift,i._hueSaturationBrightness.z=i.brightnessShift,i._hueSaturationBrightness}}}Object(O.a)(COe.prototype,{ellipsoid:{get:function(){return this._ellipsoid}}}),COe.prototype.setDynamicAtmosphereColor=function(e){this._cameraAndRadiiAndDynamicAtmosphereColor.w=e?1:0},COe.prototype.update=function(e){if(this.show){var t=e.mode;if((t===xF.SCENE3D||t===xF.MORPHING)&&e.passes.render){var i=this._command;if(!Object(u.a)(i.vertexArray)){var n=e.context,r=Hv.createGeometry(new Hv({radii:z.multiplyByScalar(this._ellipsoid.radii,1.025,new z),slicePartitions:256,stackPartitions:256,vertexFormat:Ba.POSITION_ONLY}));i.vertexArray=tF.fromGeometry({context:n,geometry:r,attributeLocations:id.createAttributeLocations(r),bufferUsage:YN.STATIC_DRAW}),i.renderState=RM.fromCache({cull:{enabled:!0,face:BD.FRONT},blending:FD.ALPHA_BLEND,depthMask:!1});var a=new UN({defines:["SKY_FROM_SPACE"],sources:[TOe]});this._spSkyFromSpace=bR.fromCache({context:n,vertexShaderSource:a,fragmentShaderSource:EOe}),a=new UN({defines:["SKY_FROM_ATMOSPHERE"],sources:[TOe]}),this._spSkyFromAtmosphere=bR.fromCache({context:n,vertexShaderSource:a,fragmentShaderSource:EOe})}var o,s=(o=this,!(I.equalsEpsilon(o.hueShift,0,I.EPSILON7)&&I.equalsEpsilon(o.saturationShift,0,I.EPSILON7)&&I.equalsEpsilon(o.brightnessShift,0,I.EPSILON7)));if(s&&(!Object(u.a)(this._spSkyFromSpaceColorCorrect)||!Object(u.a)(this._spSkyFromAtmosphereColorCorrect))){var c=e.context,l=new UN({defines:["SKY_FROM_SPACE"],sources:[TOe]}),h=new UN({defines:["COLOR_CORRECT"],sources:[EOe]});this._spSkyFromSpaceColorCorrect=bR.fromCache({context:c,vertexShaderSource:l,fragmentShaderSource:h}),l=new UN({defines:["SKY_FROM_ATMOSPHERE"],sources:[TOe]}),this._spSkyFromAtmosphereColorCorrect=bR.fromCache({context:c,vertexShaderSource:l,fragmentShaderSource:h})}var d=e.camera.positionWC,f=z.magnitude(d);return this._cameraAndRadiiAndDynamicAtmosphereColor.x=f,f>this._cameraAndRadiiAndDynamicAtmosphereColor.y?i.shaderProgram=s?this._spSkyFromSpaceColorCorrect:this._spSkyFromSpace:i.shaderProgram=s?this._spSkyFromAtmosphereColorCorrect:this._spSkyFromAtmosphere,i}}},COe.prototype.isDestroyed=function(){return!1},COe.prototype.destroy=function(){var e=this._command;return e.vertexArray=e.vertexArray&&e.vertexArray.destroy(),this._spSkyFromSpace=this._spSkyFromSpace&&this._spSkyFromSpace.destroy(),this._spSkyFromAtmosphere=this._spSkyFromAtmosphere&&this._spSkyFromAtmosphere.destroy(),this._spSkyFromSpaceColorCorrect=this._spSkyFromSpaceColorCorrect&&this._spSkyFromSpaceColorCorrect.destroy(),this._spSkyFromAtmosphereColorCorrect=this._spSkyFromAtmosphereColorCorrect&&this._spSkyFromAtmosphereColorCorrect.destroy(),rl(this)};var SOe=COe,AOe="uniform samplerCube u_cubeMap;\nvarying vec3 v_texCoord;\nvoid main()\n{\nvec4 color = textureCube(u_cubeMap, normalize(v_texCoord));\ngl_FragColor = vec4(czm_gammaCorrect(color).rgb, czm_morphTime);\n}\n",POe="attribute vec3 position;\nvarying vec3 v_texCoord;\nvoid main()\n{\n#ifdef BIM_MODE\nvec3 p = czm_modelViewRotation * (czm_entireFrustum.y * czm_gltfRotation * position);\n#else\nvec3 p = czm_viewRotation * (czm_temeToPseudoFixed * (czm_entireFrustum.y * position));\n#endif\ngl_Position = czm_projection * vec4(p, 1.0);\nv_texCoord = position.xyz;\n}\n";function IOe(e){this.sources=e.sources,this._sources=void 0,this.show=Object(w.a)(e.show,!0),this._command=new cM({modelMatrix:Be.clone(Be.IDENTITY),owner:this}),this._cubeMap=void 0,this._attributeLocations=void 0,this._useHdr=void 0}Object(O.a)(IOe.prototype,{modelMatrix:{get:function(){return this._command.modelMatrix},set:function(e){Be.clone(e,this._command.modelMatrix)}}}),IOe.prototype.update=function(e,t){var i=this;if(this.show&&(e.mode===xF.SCENE3D||e.mode===xF.MORPHING)&&e.passes.render){var n=e.context;if(this._sources!==this.sources){this._sources=this.sources;var r=this.sources;if(!(Object(u.a)(r.positiveX)&&Object(u.a)(r.negativeX)&&Object(u.a)(r.positiveY)&&Object(u.a)(r.negativeY)&&Object(u.a)(r.positiveZ)&&Object(u.a)(r.negativeZ)))throw new h.a("this.sources is required and must have positiveX, negativeX, positiveY, negativeY, positiveZ, and negativeZ properties.");if(typeof r.positiveX!=typeof r.negativeX||typeof r.positiveX!=typeof r.positiveY||typeof r.positiveX!=typeof r.negativeY||typeof r.positiveX!=typeof r.positiveZ||typeof r.positiveX!=typeof r.negativeZ)throw new h.a("this.sources properties must all be the same type.");"string"==typeof r.positiveX?tre(n,this._sources).then((function(e){i._cubeMap=i._cubeMap&&i._cubeMap.destroy(),i._cubeMap=e})):(this._cubeMap=this._cubeMap&&this._cubeMap.destroy(),this._cubeMap=new nj({context:n,source:r}))}var a=this._command;if(!Object(u.a)(a.vertexArray)){a.uniformMap={u_cubeMap:function(){return i._cubeMap}};var o=Ya.createGeometry(Ya.fromDimensions({dimensions:new z(2,2,2),vertexFormat:Ba.POSITION_ONLY})),s=this._attributeLocations=id.createAttributeLocations(o);a.vertexArray=tF.fromGeometry({context:n,geometry:o,attributeLocations:s,bufferUsage:YN.STATIC_DRAW}),a.renderState=RM.fromCache({blending:FD.ALPHA_BLEND})}if(!Object(u.a)(a.shaderProgram)||this._useHdr!==t){var c=new UN({defines:[fx.isBIMMode?"BIM_MODE":""],sources:[POe]}),l=new UN({defines:[t?"HDR":""],sources:[AOe]});a.shaderProgram=bR.fromCache({context:n,vertexShaderSource:c,fragmentShaderSource:l,attributeLocations:this._attributeLocations}),this._useHdr=t}if(Object(u.a)(this._cubeMap))return a}},IOe.prototype.isDestroyed=function(){return!1},IOe.prototype.destroy=function(){var e=this._command;return e.vertexArray=e.vertexArray&&e.vertexArray.destroy(),e.shaderProgram=e.shaderProgram&&e.shaderProgram.destroy(),this._cubeMap=this._cubeMap&&this._cubeMap.destroy(),rl(this)};var DOe=IOe;function jOe(e){e=Object(w.a)(e,1),x.a.typeOf.number.greaterThan("radius",e,0),this._radius=Object(w.a)(e,1)}Object(O.a)(jOe.prototype,{radius:{get:function(){return this._radius},set:function(e){x.a.typeOf.number.greaterThan("value",e,0),this._radius=e}}}),jOe.prototype.emit=function(e){var t=I.randomBetween(0,I.TWO_PI),i=I.randomBetween(0,I.PI),n=I.randomBetween(0,this._radius),r=n*Math.cos(t)*Math.sin(i),a=n*Math.sin(t)*Math.sin(i),o=n*Math.cos(i);e.position=z.fromElements(r,a,o,e.position),e.velocity=z.normalize(e.position,e.velocity)};var MOe=jOe;function ROe(){}ROe.prototype.evaluate=function(e,t){h.a.throwInstantiationError()},ROe.prototype.evaluateColor=function(e,t){h.a.throwInstantiationError()},ROe.prototype.getShaderFunction=function(e,t,i,n){h.a.throwInstantiationError()};var LOe=ROe,NOe="uniform sampler2D u_texture;\nvarying vec2 v_textureCoordinates;\nvoid main()\n{\nvec4 color = texture2D(u_texture, v_textureCoordinates);\ngl_FragColor = czm_gammaCorrect(color);\n}\n",FOe="uniform float u_radiusTS;\nvarying vec2 v_textureCoordinates;\nvec2 rotate(vec2 p, vec2 direction)\n{\nreturn vec2(p.x * direction.x - p.y * direction.y, p.x * direction.y + p.y * direction.x);\n}\nvec4 addBurst(vec2 position, vec2 direction, float lengthScalar)\n{\nvec2 rotatedPosition = rotate(position, direction) * vec2(25.0, 0.75);\nfloat radius = length(rotatedPosition) * lengthScalar;\nfloat burst = 1.0 - smoothstep(0.0, 0.55, radius);\nreturn vec4(burst);\n}\nvoid main()\n{\nfloat lengthScalar = 2.0 / sqrt(2.0);\nvec2 position = v_textureCoordinates - vec2(0.5);\nfloat radius = length(position) * lengthScalar;\nfloat surface = step(radius, u_radiusTS);\nvec4 color = vec4(vec2(1.0), surface + 0.2, surface);\nfloat glow = 1.0 - smoothstep(0.0, 0.55, radius);\ncolor.ba += mix(vec2(0.0), vec2(1.0), glow) * 0.75;\nvec4 burst = vec4(0.0);\nburst += 0.4 * addBurst(position, vec2(0.38942,  0.92106), lengthScalar);\nburst += 0.4 * addBurst(position, vec2(0.99235,  0.12348), lengthScalar);\nburst += 0.4 * addBurst(position, vec2(0.60327, -0.79754), lengthScalar);\nburst += 0.3 * addBurst(position, vec2(0.31457,  0.94924), lengthScalar);\nburst += 0.3 * addBurst(position, vec2(0.97931,  0.20239), lengthScalar);\nburst += 0.3 * addBurst(position, vec2(0.66507, -0.74678), lengthScalar);\ncolor += clamp(burst, vec4(0.0), vec4(1.0)) * 0.15;\ngl_FragColor = clamp(color, vec4(0.0), vec4(1.0));\n}\n",kOe="attribute vec2 direction;\nuniform float u_size;\nvarying vec2 v_textureCoordinates;\nvoid main()\n{\nvec4 position;\nif (czm_morphTime == 1.0)\n{\nposition = vec4(czm_sunPositionWC, 1.0);\n}\nelse\n{\nposition = vec4(czm_sunPositionColumbusView.zxy, 1.0);\n}\nvec4 positionEC = czm_view * position;\nvec4 positionWC = czm_eyeToWindowCoordinates(positionEC);\nvec2 halfSize = vec2(u_size * 0.5);\nhalfSize *= ((direction * 2.0) - 1.0);\ngl_Position = czm_viewportOrthographic * vec4(positionWC.xy + halfSize, -positionWC.z, 1.0);\nv_textureCoordinates = direction;\n}\n";function BOe(){this.show=!0,this._drawCommand=new cM({primitiveType:yn.TRIANGLES,boundingVolume:new St,owner:this}),this._commands={drawCommand:this._drawCommand,computeCommand:void 0},this._boundingVolume=new St,this._boundingVolume2D=new St,this._texture=void 0,this._drawingBufferWidth=void 0,this._drawingBufferHeight=void 0,this._radiusTS=void 0,this._size=void 0,this.glowFactor=1,this._glowFactorDirty=!1,this._useHdr=void 0;var e=this;this._uniformMap={u_texture:function(){return e._texture},u_size:function(){return e._size}}}Object(O.a)(BOe.prototype,{glowFactor:{get:function(){return this._glowFactor},set:function(e){e=Math.max(e,0),this._glowFactor=e,this._glowFactorDirty=!0}}});var zOe=new Rt,UOe=new Rt,VOe=new Te,HOe=new Te;BOe.prototype.update=function(e,t,i){if(this.show){var n=e.mode;if(n!==xF.SCENE2D&&n!==xF.MORPHING&&e.passes.render){var r=e.context,a=t.viewport.width,o=t.viewport.height;if(!Object(u.a)(this._texture)||a!==this._drawingBufferWidth||o!==this._drawingBufferHeight||this._glowFactorDirty||i!==this._useHdr){this._texture=this._texture&&this._texture.destroy(),this._drawingBufferWidth=a,this._drawingBufferHeight=o,this._glowFactorDirty=!1,this._useHdr=i;var s=Math.max(a,o);s=Math.pow(2,Math.ceil(Math.log(s)/Math.log(2))-2),s=Math.max(1,s);var c=i?r.halfFloatingPointTexture?mx.HALF_FLOAT:mx.FLOAT:mx.UNSIGNED_BYTE;this._texture=new hj({context:r,width:s,height:s,pixelFormat:gx.RGBA,pixelDatatype:c}),this._glowLengthTS=5*this._glowFactor,this._radiusTS=1/(1+2*this._glowLengthTS)*.5;var l=this,h={u_radiusTS:function(){return l._radiusTS}};this._commands.computeCommand=new OX({fragmentShaderSource:FOe,outputTexture:this._texture,uniformMap:h,persists:!1,owner:this,postExecute:function(){l._commands.computeCommand=void 0}})}var d=this._drawCommand;if(!Object(u.a)(d.vertexArray)){var f={direction:0},p=new Uint8Array(8);p[0]=0,p[1]=0,p[2]=255,p[3]=0,p[4]=255,p[5]=255,p[6]=0,p[7]=255;var m=ZN.createVertexBuffer({context:r,typedArray:p,usage:YN.STATIC_DRAW}),_=[{index:f.direction,vertexBuffer:m,componentsPerAttribute:2,normalize:!0,componentDatatype:dn.UNSIGNED_BYTE}],g=ZN.createIndexBuffer({context:r,typedArray:new Uint16Array([0,1,2,0,2,3]),usage:YN.STATIC_DRAW,indexDatatype:Sl.UNSIGNED_SHORT});d.vertexArray=new tF({context:r,attributes:_,indexBuffer:g}),d.shaderProgram=bR.fromCache({context:r,vertexShaderSource:kOe,fragmentShaderSource:NOe,attributeLocations:f}),d.renderState=RM.fromCache({blending:FD.ALPHA_BLEND}),d.uniformMap=this._uniformMap}var v=r.uniformState.sunPositionWC,b=r.uniformState.sunPositionColumbusView,y=this._boundingVolume,w=this._boundingVolume2D;z.clone(v,y.center),w.center.x=b.z,w.center.y=b.x,w.center.z=b.y,y.radius=I.SOLAR_RADIUS+I.SOLAR_RADIUS*this._glowLengthTS,w.radius=y.radius,n===xF.SCENE3D?St.clone(y,d.boundingVolume):n===xF.COLUMBUS_VIEW&&St.clone(w,d.boundingVolume);var O=gV.computeActualWgs84Position(e,v,HOe),x=z.magnitude(z.subtract(O,e.camera.position,HOe)),E=r.uniformState.projection,T=VOe;T.x=0,T.y=0,T.z=-x,T.w=1;var C=Be.multiplyByVector(E,T,HOe),S=gV.clipToGLWindowCoordinates(t.viewport,C,zOe);T.x=I.SOLAR_RADIUS;var A=Be.multiplyByVector(E,T,HOe),P=gV.clipToGLWindowCoordinates(t.viewport,A,UOe);return this._size=Math.ceil(Rt.magnitude(Rt.subtract(P,S,HOe))),this._size=2*this._size*(1+2*this._glowLengthTS),this._commands}}},BOe.prototype.isDestroyed=function(){return!1},BOe.prototype.destroy=function(){var e=this._drawCommand;return e.vertexArray=e.vertexArray&&e.vertexArray.destroy(),e.shaderProgram=e.shaderProgram&&e.shaderProgram.destroy(),this._texture=this._texture&&this._texture.destroy(),rl(this)};var GOe=BOe;function qOe(){}qOe.prototype.boundingVolume=void 0,qOe.prototype.boundingSphere=void 0,qOe.prototype.distanceToCamera=function(e){h.a.throwInstantiationError()},qOe.prototype.intersectPlane=function(e){h.a.throwInstantiationError()},qOe.prototype.createDebugVolume=function(e){h.a.throwInstantiationError()};var WOe=qOe;function YOe(e){e=Object(w.a)(e,w.a.EMPTY_OBJECT),this._tilingScheme=Object(u.a)(e.tilingScheme)?e.tilingScheme:new Nt({ellipsoid:e.ellipsoid}),this._color=Object(w.a)(e.color,uf.YELLOW),this._errorEvent=new $o.a,this._tileWidth=Object(w.a)(e.tileWidth,256),this._tileHeight=Object(w.a)(e.tileHeight,256),this._readyPromise=Oi.a.resolve(!0)}Object(O.a)(YOe.prototype,{proxy:{get:function(){}},tileWidth:{get:function(){return this._tileWidth}},tileHeight:{get:function(){return this._tileHeight}},maximumLevel:{get:function(){}},minimumLevel:{get:function(){}},tilingScheme:{get:function(){return this._tilingScheme}},rectangle:{get:function(){return this._tilingScheme.rectangle}},tileDiscardPolicy:{get:function(){}},errorEvent:{get:function(){return this._errorEvent}},ready:{get:function(){return!0}},readyPromise:{get:function(){return this._readyPromise}},credit:{get:function(){}},hasAlphaChannel:{get:function(){return!0}}}),YOe.prototype.getTileCredits=function(e,t,i){},YOe.prototype.requestImage=function(e,t,i,n){var r=document.createElement("canvas");r.width=256,r.height=256;var a=r.getContext("2d"),o=this._color.toCssColorString();a.strokeStyle=o,a.lineWidth=2,a.strokeRect(1,1,255,255);var s="L"+i+"X"+e+"Y"+t;return a.font="bold 25px Arial",a.textAlign="center",a.fillStyle="black",a.fillText(s,127,127),a.fillStyle=o,a.fillText(s,124,124),r},YOe.prototype.pickFeatures=function(e,t,i,n,r){};var XOe=YOe;function ZOe(e){h.a.throwInstantiationError()}ZOe.prototype.isReady=h.a.throwInstantiationError,ZOe.prototype.shouldDiscardImage=h.a.throwInstantiationError;var QOe=ZOe,KOe=Object(E.a)({START:0,LOADING:1,READY:2,UPSAMPLED_ONLY:3});function JOe(e){e=Object(w.a)(e,w.a.EMPTY_OBJECT),x.a.typeOf.object("options.clock",e.clock),x.a.typeOf.object("options.intervals",e.intervals),this.show=Object(w.a)(e.show,!0),this.modelMatrix=Be.clone(Object(w.a)(e.modelMatrix,Be.IDENTITY)),this.shadows=Object(w.a)(e.shadows,rM.ENABLED),this.maximumMemoryUsage=Object(w.a)(e.maximumMemoryUsage,256),this.shading=new u6(e.shading),this.style=e.style,this.frameFailed=new $o.a,this.frameChanged=new $o.a,this._clock=e.clock,this._intervals=e.intervals,this._clippingPlanes=void 0,this.clippingPlanes=e.clippingPlanes,this._pointCloudEyeDomeLighting=new c6,this._loadTimestamp=void 0,this._clippingPlanesState=0,this._styleDirty=!1,this._pickId=void 0,this._totalMemoryUsageInBytes=0,this._frames=[],this._previousInterval=void 0,this._nextInterval=void 0,this._lastRenderedFrame=void 0,this._clockMultiplier=0,this._readyPromise=Oi.a.defer(),this._runningSum=0,this._runningLength=0,this._runningIndex=0,this._runningSamples=Qt(new Array(5),0),this._runningAverage=0}function $Oe(e){return"uniform vec4 czm_pickColor;\n"+e}function exe(){return"czm_pickColor"}Object(O.a)(JOe.prototype,{clippingPlanes:{get:function(){return this._clippingPlanes},set:function(e){iJ.setOwner(e,this,"_clippingPlanes")}},totalMemoryUsageInBytes:{get:function(){return this._totalMemoryUsageInBytes}},boundingSphere:{get:function(){if(Object(u.a)(this._lastRenderedFrame))return this._lastRenderedFrame.pointCloud.boundingSphere}},readyPromise:{get:function(){return this._readyPromise.promise}}}),JOe.prototype.makeStyleDirty=function(){this._styleDirty=!0},JOe.prototype._getAverageLoadTime=function(){return 0===this._runningLength?.05:this._runningAverage};var txe=new Tr;function ixe(e){var t=e._clock,i=t.canAnimate&&t.shouldAnimate,n=t.multiplier;return i?n:0}function nxe(e,t){return e._intervals.indexOf(t.start)}function rxe(e,t,i){var n=nxe(e,t),r=e._frames,a=r[n];if(!Object(u.a)(a)){var o=t.data.transform,s=Object(u.a)(o)?Be.fromArray(o):void 0,c=t.data.uri;a={pointCloud:void 0,transform:s,timestamp:Qd(),sequential:!0,ready:!1,touchedFrameNumber:i.frameNumber},r[n]=a,f.a.fetchArrayBuffer({url:c}).then((function(t){var i;return a.pointCloud=new m2({arrayBuffer:t,cull:!0,fragmentShaderLoaded:$Oe,uniformMapLoaded:(i=e,function(e){return Object(ff.a)(e,{czm_pickColor:function(){return i._pickId.color}})}),pickIdLoaded:exe}),a.pointCloud.readyPromise})).otherwise(function(e,t){return function(i){var n=Object(u.a)(i.message)?i.message:i.toString();e.frameFailed.numberOfListeners>0?e.frameFailed.raiseEvent({uri:t,message:n}):(console.log("A frame failed to load: "+t),console.log("Error: "+n))}}(e,c))}return a}function axe(e,t,i,n){t.touchedFrameNumber<n.frameNumber-1&&(t.sequential=!1);var r=t.pointCloud;if(Object(u.a)(r)&&!t.ready){var a=n.commandList,o=a.length;if(sxe(e,t,i,n),r.ready)if(t.ready=!0,e._totalMemoryUsageInBytes+=r.geometryByteLength,a.length=o,t.sequential)!function(e,t){e._runningSum+=t,e._runningSum-=e._runningSamples[e._runningIndex],e._runningSamples[e._runningIndex]=t,e._runningLength=Math.min(e._runningLength+1,e._runningSamples.length),e._runningIndex=(e._runningIndex+1)%e._runningSamples.length,e._runningAverage=e._runningSum/e._runningLength}(e,(Qd()-t.timestamp)/1e3)}t.touchedFrameNumber=n.frameNumber}var oxe=new Be;function sxe(e,t,i,n){var r=t.pointCloud,a=Object(w.a)(t.transform,Be.IDENTITY);r.modelMatrix=Be.multiplyTransformation(e.modelMatrix,a,oxe),r.style=e.style,r.time=i.timeSinceLoad,r.shadows=e.shadows,r.clippingPlanes=e._clippingPlanes,r.isClipped=i.isClipped;var o=e.shading;Object(u.a)(o)&&(r.attenuation=o.attenuation,r.geometricError=function(e,t){var i=e.shading;return Object(u.a)(i)&&Object(u.a)(i.baseResolution)?i.baseResolution:Object(u.a)(t.boundingSphere)?I.cbrt(t.boundingSphere.volume()/t.pointsLength):0}(e,r),r.geometricErrorScale=o.geometricErrorScale,r.maximumAttenuation=function(e){var t=e.shading;return Object(u.a)(t)&&Object(u.a)(t.maximumAttenuation)?t.maximumAttenuation:10}(e)),r.update(n),t.touchedFrameNumber=n.frameNumber}function cxe(e,t,i,n){axe(e,rxe(e,t,n),i,n)}function lxe(e,t){for(var i=e._frames,n=i.length,r=0;r<n;++r){var a=i[r];if(Object(u.a)(a)&&(!Object(u.a)(t)||t(a))){var o=a.pointCloud;a.ready&&(e._totalMemoryUsageInBytes-=o.geometryByteLength),Object(u.a)(o)&&o.destroy(),a===e._lastRenderedFrame&&(e._lastRenderedFrame=void 0),i[r]=void 0}}}function uxe(e,t,i,n,r){return!!Object(u.a)(i)&&(!!i.ready||(cxe(e,t,n,r),i.ready))}var hxe={timeSinceLoad:0,isClipped:!1,clippingPlanesDirty:!1};JOe.prototype.update=function(e){if(e.mode!==xF.MORPHING&&this.show){Object(u.a)(this._pickId)||(this._pickId=e.context.createPickId({primitive:this})),Object(u.a)(this._loadTimestamp)||(this._loadTimestamp=Tr.clone(e.time));var t=Math.max(1e3*Tr.secondsDifference(e.time,this._loadTimestamp),0),i=this._clippingPlanes,n=0,r=!1,a=Object(u.a)(i)&&i.enabled;a&&(i.update(e),n=i.clippingPlanesState),this._clippingPlanesState!==n&&(this._clippingPlanesState=n,r=!0);var o=this._styleDirty;this._styleDirty=!1,(r||o)&&function(e,t,i){for(var n=e._frames,r=n.length,a=0;a<r;++a){var o=n[a];Object(u.a)(o)&&Object(u.a)(o.pointCloud)&&(o.pointCloud.clippingPlanesDirty=t,o.pointCloud.styleDirty=i)}}(this,r,o),hxe.timeSinceLoad=t,hxe.isClipped=a;var s=this.shading,c=this._pointCloudEyeDomeLighting,l=e.commandList,h=l.length,d=this._previousInterval,f=this._nextInterval,p=function(e){var t=e._intervals,i=e._clock.currentTime,n=t.indexOf(i);return t.get(n)}(this);if(Object(u.a)(p)){var m=!1,_=ixe(this),g=0===_;_!==this._clockMultiplier&&(m=!0,this._clockMultiplier=_),Object(u.a)(d)&&!g||(d=p),(!Object(u.a)(f)||m||function(e,t,i){var n=ixe(e),r=nxe(e,t),a=nxe(e,i);return n>=0?r>=a:r<=a}(this,p,f))&&(f=function(e,t){var i=e._intervals,n=e._clock,r=ixe(e);if(0!==r){var a=e._getAverageLoadTime(),o=Tr.addSeconds(n.currentTime,a*r,txe),s=i.indexOf(o);return s===nxe(e,t)&&(r>=0?++s:--s),i.get(s)}}(this,p));var v=function(e,t){var i=nxe(e,t),n=e._frames[i];if(Object(u.a)(n)&&n.ready)return n}(this,d=function(e,t,i,n,r){var a,o,s=e._intervals,c=e._frames,l=nxe(e,i),u=nxe(e,t);if(l>=u){for(a=l;a>=u;--a)if(uxe(e,o=s.get(a),c[a],n,r))return o}else for(a=l;a<=u;++a)if(uxe(e,o=s.get(a),c[a],n,r))return o;return t}(this,d,p,hxe,e));Object(u.a)(v)||(cxe(this,d,hxe,e),v=this._lastRenderedFrame),Object(u.a)(v)&&sxe(this,v,hxe,e),Object(u.a)(f)&&cxe(this,f,hxe,e);var b=this;Object(u.a)(v)&&!Object(u.a)(this._lastRenderedFrame)&&e.afterRender.push((function(){b._readyPromise.resolve(b)})),Object(u.a)(v)&&v!==this._lastRenderedFrame&&b.frameChanged.numberOfListeners>0&&e.afterRender.push((function(){b.frameChanged.raiseEvent(b)})),this._previousInterval=d,this._nextInterval=f,this._lastRenderedFrame=v,this._totalMemoryUsageInBytes>1024*this.maximumMemoryUsage*1024&&lxe(this,function(e){return function(t){return t.touchedFrameNumber<e.frameNumber}}(e));var y=l.length-h;Object(u.a)(s)&&s.attenuation&&s.eyeDomeLighting&&y>0&&c.update(e,h,s)}}},JOe.prototype.isDestroyed=function(){return!1},JOe.prototype.destroy=function(){return lxe(this),this._clippingPlanes=this._clippingPlanes&&this._clippingPlanes.destroy(),this._pickId=this._pickId&&this._pickId.destroy(),rl(this)};var dxe=JOe,fxe="varying vec2 v_textureCoordinates;\nvoid main()\n{\nczm_materialInput materialInput;\nmaterialInput.s = v_textureCoordinates.s;\nmaterialInput.st = v_textureCoordinates;\nmaterialInput.str = vec3(v_textureCoordinates, 0.0);\nmaterialInput.normalEC = vec3(0.0, 0.0, -1.0);\nczm_material material = czm_getMaterial(materialInput);\ngl_FragColor = vec4(material.diffuse + material.emission, material.alpha);\n}\n";function pxe(e,t){this.show=!0,Object(u.a)(e)||(e=new ln),this.rectangle=ln.clone(e),Object(u.a)(t)||(t=qj.fromType(qj.ColorType,{color:new uf(1,1,1,1)})),this.material=t,this._material=void 0,this._overlayCommand=void 0,this._rs=void 0}pxe.prototype.update=function(e){if(this.show){if(!Object(u.a)(this.material))throw new h.a("this.material must be defined.");if(!Object(u.a)(this.rectangle))throw new h.a("this.rectangle must be defined.");var t=this._rs;if(Object(u.a)(t)&&ln.equals(t.viewport,this.rectangle)||(this._rs=RM.fromCache({blending:FD.ALPHA_BLEND,viewport:this.rectangle})),e.passes.render){var i=e.context;if(this._material!==this.material||!Object(u.a)(this._overlayCommand)){this._material=this.material,Object(u.a)(this._overlayCommand)&&this._overlayCommand.shaderProgram.destroy();var n=new UN({sources:[this._material.shaderSource,fxe]});this._overlayCommand=i.createViewportQuadCommand(n,{renderState:this._rs,uniformMap:this._material._uniforms,owner:this}),this._overlayCommand.pass=lM.OVERLAY}this._material.update(i),this._overlayCommand.uniformMap=this._material._uniforms,e.commandList.push(this._overlayCommand)}}},pxe.prototype.isDestroyed=function(){return!1},pxe.prototype.destroy=function(){return Object(u.a)(this._overlayCommand)&&(this._overlayCommand.shaderProgram=this._overlayCommand.shaderProgram&&this._overlayCommand.shaderProgram.destroy()),rl(this)};var mxe=pxe,_xe=1e20;function gxe(e,t,i,n,r,a,o){for(var s=0;s<t;s++){for(var c=0;c<i;c++)n[c]=e[c*t+s];for(vxe(n,r,a,o,i),c=0;c<i;c++)e[c*t+s]=r[c]}for(c=0;c<i;c++){for(s=0;s<t;s++)n[s]=e[c*t+s];for(vxe(n,r,a,o,t),s=0;s<t;s++)e[c*t+s]=Math.sqrt(r[s])}}function vxe(e,t,i,n,r){i[0]=0,n[0]=-_xe,n[1]=+_xe;for(var a=1,o=0;a<r;a++){for(var s=(e[a]+a*a-(e[i[o]]+i[o]*i[o]))/(2*a-2*i[o]);s<=n[o];)o--,s=(e[a]+a*a-(e[i[o]]+i[o]*i[o]))/(2*a-2*i[o]);i[++o]=a,n[o]=s,n[o+1]=+_xe}for(a=0,o=0;a<r;a++){for(;n[o+1]<a;)o++;t[a]=(a-i[o])*(a-i[o])+e[i[o]]}}var bxe=function(e,t){t||(t={});var i,n,r,a,o,s,c,l,u,h,d,f=null==t.cutoff?.25:t.cutoff,p=null==t.radius?8:t.radius,m=t.channel||0;if(ArrayBuffer.isView(e)||Array.isArray(e)){if(!t.width||!t.height)throw Error("For raw data width and height should be provided by options");i=t.width,n=t.height,a=e,s=t.stride?t.stride:Math.floor(e.length/i/n)}else window.HTMLCanvasElement&&e instanceof window.HTMLCanvasElement?(c=(l=e).getContext("2d"),i=l.width,n=l.height,a=(u=c.getImageData(0,0,i,n)).data,s=4):window.CanvasRenderingContext2D&&e instanceof window.CanvasRenderingContext2D?(c=e,i=(l=e.canvas).width,n=l.height,a=(u=c.getImageData(0,0,i,n)).data,s=4):window.ImageData&&e instanceof window.ImageData&&(u=e,i=e.width,n=e.height,a=u.data,s=4);if(r=Math.max(i,n),window.Uint8ClampedArray&&a instanceof window.Uint8ClampedArray||window.Uint8Array&&a instanceof window.Uint8Array)for(o=a,a=Array(i*n),h=0,d=o.length;h<d;h++)a[h]=o[h*s+m]/255;else if(1!==s)throw Error("Raw data can have only 1 value per pixel");var _=Array(i*n),g=Array(i*n),v=Array(r),b=Array(r),y=Array(r+1),w=Array(r);for(h=0,d=i*n;h<d;h++){var O=a[h];_[h]=1===O?0:0===O?_xe:Math.pow(Math.max(0,.5-O),2),g[h]=1===O?_xe:0===O?0:Math.pow(Math.max(0,O-.5),2)}gxe(_,i,n,v,b,w,y),gxe(g,i,n,v,b,w,y);var x,E,T,C=window.Float32Array?new Float32Array(i*n):new Array(i*n);for(h=0,d=i*n;h<d;h++)C[h]=(x=1-((_[h]-g[h])/p+f),(E=0)<(T=1)?x<E?E:x>T?T:x:x<T?T:x>E?E:x);return C};var yxe=function(){var e=0,t=1,i=2,n=3,r=4,a=5,o=6,s=7,c=8,l=9,u=10,h=11,d=12,f=13,p=14,m=15,_=16,g=17,v=0,b=1,y=2,w=3,O=4;function x(e,t){void 0===t&&(t=0);var i=e.charCodeAt(t);if(55296<=i&&i<=56319&&t<e.length-1){var n=i;return 56320<=(r=e.charCodeAt(t+1))&&r<=57343?1024*(n-55296)+(r-56320)+65536:n}if(56320<=i&&i<=57343&&t>=1){var r=i;return 55296<=(n=e.charCodeAt(t-1))&&n<=56319?1024*(n-55296)+(r-56320)+65536:r}return i}function E(h,x,E){var T=[h].concat(x).concat([E]),C=T[T.length-2],S=E,A=T.lastIndexOf(p);if(A>1&&T.slice(1,A).every((function(e){return e==n}))&&-1==[n,f,g].indexOf(h))return y;var P=T.lastIndexOf(r);if(P>0&&T.slice(1,P).every((function(e){return e==r}))&&-1==[d,r].indexOf(C))return T.filter((function(e){return e==r})).length%2==1?w:O;if(C==e&&S==t)return v;if(C==i||C==e||C==t)return S==p&&x.every((function(e){return e==n}))?y:b;if(S==i||S==e||S==t)return b;if(C==o&&(S==o||S==s||S==l||S==u))return v;if(!(C!=l&&C!=s||S!=s&&S!=c))return v;if((C==u||C==c)&&S==c)return v;if(S==n||S==m)return v;if(S==a)return v;if(C==d)return v;var I=-1!=T.indexOf(n)?T.lastIndexOf(n)-1:T.length-2;return-1!=[f,g].indexOf(T[I])&&T.slice(I+1,-1).every((function(e){return e==n}))&&S==p?v:C==m&&-1!=[_,g].indexOf(S)?v:-1!=x.indexOf(r)?y:C==r&&S==r?v:b}function T(v){return 1536<=v&&v<=1541||1757==v||1807==v||2274==v||3406==v||69821==v||70082<=v&&v<=70083||72250==v||72326<=v&&v<=72329||73030==v?d:13==v?e:10==v?t:0<=v&&v<=9||11<=v&&v<=12||14<=v&&v<=31||127<=v&&v<=159||173==v||1564==v||6158==v||8203==v||8206<=v&&v<=8207||8232==v||8233==v||8234<=v&&v<=8238||8288<=v&&v<=8292||8293==v||8294<=v&&v<=8303||55296<=v&&v<=57343||65279==v||65520<=v&&v<=65528||65529<=v&&v<=65531||113824<=v&&v<=113827||119155<=v&&v<=119162||917504==v||917505==v||917506<=v&&v<=917535||917632<=v&&v<=917759||918e3<=v&&v<=921599?i:768<=v&&v<=879||1155<=v&&v<=1159||1160<=v&&v<=1161||1425<=v&&v<=1469||1471==v||1473<=v&&v<=1474||1476<=v&&v<=1477||1479==v||1552<=v&&v<=1562||1611<=v&&v<=1631||1648==v||1750<=v&&v<=1756||1759<=v&&v<=1764||1767<=v&&v<=1768||1770<=v&&v<=1773||1809==v||1840<=v&&v<=1866||1958<=v&&v<=1968||2027<=v&&v<=2035||2070<=v&&v<=2073||2075<=v&&v<=2083||2085<=v&&v<=2087||2089<=v&&v<=2093||2137<=v&&v<=2139||2260<=v&&v<=2273||2275<=v&&v<=2306||2362==v||2364==v||2369<=v&&v<=2376||2381==v||2385<=v&&v<=2391||2402<=v&&v<=2403||2433==v||2492==v||2494==v||2497<=v&&v<=2500||2509==v||2519==v||2530<=v&&v<=2531||2561<=v&&v<=2562||2620==v||2625<=v&&v<=2626||2631<=v&&v<=2632||2635<=v&&v<=2637||2641==v||2672<=v&&v<=2673||2677==v||2689<=v&&v<=2690||2748==v||2753<=v&&v<=2757||2759<=v&&v<=2760||2765==v||2786<=v&&v<=2787||2810<=v&&v<=2815||2817==v||2876==v||2878==v||2879==v||2881<=v&&v<=2884||2893==v||2902==v||2903==v||2914<=v&&v<=2915||2946==v||3006==v||3008==v||3021==v||3031==v||3072==v||3134<=v&&v<=3136||3142<=v&&v<=3144||3146<=v&&v<=3149||3157<=v&&v<=3158||3170<=v&&v<=3171||3201==v||3260==v||3263==v||3266==v||3270==v||3276<=v&&v<=3277||3285<=v&&v<=3286||3298<=v&&v<=3299||3328<=v&&v<=3329||3387<=v&&v<=3388||3390==v||3393<=v&&v<=3396||3405==v||3415==v||3426<=v&&v<=3427||3530==v||3535==v||3538<=v&&v<=3540||3542==v||3551==v||3633==v||3636<=v&&v<=3642||3655<=v&&v<=3662||3761==v||3764<=v&&v<=3769||3771<=v&&v<=3772||3784<=v&&v<=3789||3864<=v&&v<=3865||3893==v||3895==v||3897==v||3953<=v&&v<=3966||3968<=v&&v<=3972||3974<=v&&v<=3975||3981<=v&&v<=3991||3993<=v&&v<=4028||4038==v||4141<=v&&v<=4144||4146<=v&&v<=4151||4153<=v&&v<=4154||4157<=v&&v<=4158||4184<=v&&v<=4185||4190<=v&&v<=4192||4209<=v&&v<=4212||4226==v||4229<=v&&v<=4230||4237==v||4253==v||4957<=v&&v<=4959||5906<=v&&v<=5908||5938<=v&&v<=5940||5970<=v&&v<=5971||6002<=v&&v<=6003||6068<=v&&v<=6069||6071<=v&&v<=6077||6086==v||6089<=v&&v<=6099||6109==v||6155<=v&&v<=6157||6277<=v&&v<=6278||6313==v||6432<=v&&v<=6434||6439<=v&&v<=6440||6450==v||6457<=v&&v<=6459||6679<=v&&v<=6680||6683==v||6742==v||6744<=v&&v<=6750||6752==v||6754==v||6757<=v&&v<=6764||6771<=v&&v<=6780||6783==v||6832<=v&&v<=6845||6846==v||6912<=v&&v<=6915||6964==v||6966<=v&&v<=6970||6972==v||6978==v||7019<=v&&v<=7027||7040<=v&&v<=7041||7074<=v&&v<=7077||7080<=v&&v<=7081||7083<=v&&v<=7085||7142==v||7144<=v&&v<=7145||7149==v||7151<=v&&v<=7153||7212<=v&&v<=7219||7222<=v&&v<=7223||7376<=v&&v<=7378||7380<=v&&v<=7392||7394<=v&&v<=7400||7405==v||7412==v||7416<=v&&v<=7417||7616<=v&&v<=7673||7675<=v&&v<=7679||8204==v||8400<=v&&v<=8412||8413<=v&&v<=8416||8417==v||8418<=v&&v<=8420||8421<=v&&v<=8432||11503<=v&&v<=11505||11647==v||11744<=v&&v<=11775||12330<=v&&v<=12333||12334<=v&&v<=12335||12441<=v&&v<=12442||42607==v||42608<=v&&v<=42610||42612<=v&&v<=42621||42654<=v&&v<=42655||42736<=v&&v<=42737||43010==v||43014==v||43019==v||43045<=v&&v<=43046||43204<=v&&v<=43205||43232<=v&&v<=43249||43302<=v&&v<=43309||43335<=v&&v<=43345||43392<=v&&v<=43394||43443==v||43446<=v&&v<=43449||43452==v||43493==v||43561<=v&&v<=43566||43569<=v&&v<=43570||43573<=v&&v<=43574||43587==v||43596==v||43644==v||43696==v||43698<=v&&v<=43700||43703<=v&&v<=43704||43710<=v&&v<=43711||43713==v||43756<=v&&v<=43757||43766==v||44005==v||44008==v||44013==v||64286==v||65024<=v&&v<=65039||65056<=v&&v<=65071||65438<=v&&v<=65439||66045==v||66272==v||66422<=v&&v<=66426||68097<=v&&v<=68099||68101<=v&&v<=68102||68108<=v&&v<=68111||68152<=v&&v<=68154||68159==v||68325<=v&&v<=68326||69633==v||69688<=v&&v<=69702||69759<=v&&v<=69761||69811<=v&&v<=69814||69817<=v&&v<=69818||69888<=v&&v<=69890||69927<=v&&v<=69931||69933<=v&&v<=69940||70003==v||70016<=v&&v<=70017||70070<=v&&v<=70078||70090<=v&&v<=70092||70191<=v&&v<=70193||70196==v||70198<=v&&v<=70199||70206==v||70367==v||70371<=v&&v<=70378||70400<=v&&v<=70401||70460==v||70462==v||70464==v||70487==v||70502<=v&&v<=70508||70512<=v&&v<=70516||70712<=v&&v<=70719||70722<=v&&v<=70724||70726==v||70832==v||70835<=v&&v<=70840||70842==v||70845==v||70847<=v&&v<=70848||70850<=v&&v<=70851||71087==v||71090<=v&&v<=71093||71100<=v&&v<=71101||71103<=v&&v<=71104||71132<=v&&v<=71133||71219<=v&&v<=71226||71229==v||71231<=v&&v<=71232||71339==v||71341==v||71344<=v&&v<=71349||71351==v||71453<=v&&v<=71455||71458<=v&&v<=71461||71463<=v&&v<=71467||72193<=v&&v<=72198||72201<=v&&v<=72202||72243<=v&&v<=72248||72251<=v&&v<=72254||72263==v||72273<=v&&v<=72278||72281<=v&&v<=72283||72330<=v&&v<=72342||72344<=v&&v<=72345||72752<=v&&v<=72758||72760<=v&&v<=72765||72767==v||72850<=v&&v<=72871||72874<=v&&v<=72880||72882<=v&&v<=72883||72885<=v&&v<=72886||73009<=v&&v<=73014||73018==v||73020<=v&&v<=73021||73023<=v&&v<=73029||73031==v||92912<=v&&v<=92916||92976<=v&&v<=92982||94095<=v&&v<=94098||113821<=v&&v<=113822||119141==v||119143<=v&&v<=119145||119150<=v&&v<=119154||119163<=v&&v<=119170||119173<=v&&v<=119179||119210<=v&&v<=119213||119362<=v&&v<=119364||121344<=v&&v<=121398||121403<=v&&v<=121452||121461==v||121476==v||121499<=v&&v<=121503||121505<=v&&v<=121519||122880<=v&&v<=122886||122888<=v&&v<=122904||122907<=v&&v<=122913||122915<=v&&v<=122916||122918<=v&&v<=122922||125136<=v&&v<=125142||125252<=v&&v<=125258||917536<=v&&v<=917631||917760<=v&&v<=917999?n:127462<=v&&v<=127487?r:2307==v||2363==v||2366<=v&&v<=2368||2377<=v&&v<=2380||2382<=v&&v<=2383||2434<=v&&v<=2435||2495<=v&&v<=2496||2503<=v&&v<=2504||2507<=v&&v<=2508||2563==v||2622<=v&&v<=2624||2691==v||2750<=v&&v<=2752||2761==v||2763<=v&&v<=2764||2818<=v&&v<=2819||2880==v||2887<=v&&v<=2888||2891<=v&&v<=2892||3007==v||3009<=v&&v<=3010||3014<=v&&v<=3016||3018<=v&&v<=3020||3073<=v&&v<=3075||3137<=v&&v<=3140||3202<=v&&v<=3203||3262==v||3264<=v&&v<=3265||3267<=v&&v<=3268||3271<=v&&v<=3272||3274<=v&&v<=3275||3330<=v&&v<=3331||3391<=v&&v<=3392||3398<=v&&v<=3400||3402<=v&&v<=3404||3458<=v&&v<=3459||3536<=v&&v<=3537||3544<=v&&v<=3550||3570<=v&&v<=3571||3635==v||3763==v||3902<=v&&v<=3903||3967==v||4145==v||4155<=v&&v<=4156||4182<=v&&v<=4183||4228==v||6070==v||6078<=v&&v<=6085||6087<=v&&v<=6088||6435<=v&&v<=6438||6441<=v&&v<=6443||6448<=v&&v<=6449||6451<=v&&v<=6456||6681<=v&&v<=6682||6741==v||6743==v||6765<=v&&v<=6770||6916==v||6965==v||6971==v||6973<=v&&v<=6977||6979<=v&&v<=6980||7042==v||7073==v||7078<=v&&v<=7079||7082==v||7143==v||7146<=v&&v<=7148||7150==v||7154<=v&&v<=7155||7204<=v&&v<=7211||7220<=v&&v<=7221||7393==v||7410<=v&&v<=7411||7415==v||43043<=v&&v<=43044||43047==v||43136<=v&&v<=43137||43188<=v&&v<=43203||43346<=v&&v<=43347||43395==v||43444<=v&&v<=43445||43450<=v&&v<=43451||43453<=v&&v<=43456||43567<=v&&v<=43568||43571<=v&&v<=43572||43597==v||43755==v||43758<=v&&v<=43759||43765==v||44003<=v&&v<=44004||44006<=v&&v<=44007||44009<=v&&v<=44010||44012==v||69632==v||69634==v||69762==v||69808<=v&&v<=69810||69815<=v&&v<=69816||69932==v||70018==v||70067<=v&&v<=70069||70079<=v&&v<=70080||70188<=v&&v<=70190||70194<=v&&v<=70195||70197==v||70368<=v&&v<=70370||70402<=v&&v<=70403||70463==v||70465<=v&&v<=70468||70471<=v&&v<=70472||70475<=v&&v<=70477||70498<=v&&v<=70499||70709<=v&&v<=70711||70720<=v&&v<=70721||70725==v||70833<=v&&v<=70834||70841==v||70843<=v&&v<=70844||70846==v||70849==v||71088<=v&&v<=71089||71096<=v&&v<=71099||71102==v||71216<=v&&v<=71218||71227<=v&&v<=71228||71230==v||71340==v||71342<=v&&v<=71343||71350==v||71456<=v&&v<=71457||71462==v||72199<=v&&v<=72200||72249==v||72279<=v&&v<=72280||72343==v||72751==v||72766==v||72873==v||72881==v||72884==v||94033<=v&&v<=94078||119142==v||119149==v?a:4352<=v&&v<=4447||43360<=v&&v<=43388?o:4448<=v&&v<=4519||55216<=v&&v<=55238?s:4520<=v&&v<=4607||55243<=v&&v<=55291?c:44032==v||44060==v||44088==v||44116==v||44144==v||44172==v||44200==v||44228==v||44256==v||44284==v||44312==v||44340==v||44368==v||44396==v||44424==v||44452==v||44480==v||44508==v||44536==v||44564==v||44592==v||44620==v||44648==v||44676==v||44704==v||44732==v||44760==v||44788==v||44816==v||44844==v||44872==v||44900==v||44928==v||44956==v||44984==v||45012==v||45040==v||45068==v||45096==v||45124==v||45152==v||45180==v||45208==v||45236==v||45264==v||45292==v||45320==v||45348==v||45376==v||45404==v||45432==v||45460==v||45488==v||45516==v||45544==v||45572==v||45600==v||45628==v||45656==v||45684==v||45712==v||45740==v||45768==v||45796==v||45824==v||45852==v||45880==v||45908==v||45936==v||45964==v||45992==v||46020==v||46048==v||46076==v||46104==v||46132==v||46160==v||46188==v||46216==v||46244==v||46272==v||46300==v||46328==v||46356==v||46384==v||46412==v||46440==v||46468==v||46496==v||46524==v||46552==v||46580==v||46608==v||46636==v||46664==v||46692==v||46720==v||46748==v||46776==v||46804==v||46832==v||46860==v||46888==v||46916==v||46944==v||46972==v||47e3==v||47028==v||47056==v||47084==v||47112==v||47140==v||47168==v||47196==v||47224==v||47252==v||47280==v||47308==v||47336==v||47364==v||47392==v||47420==v||47448==v||47476==v||47504==v||47532==v||47560==v||47588==v||47616==v||47644==v||47672==v||47700==v||47728==v||47756==v||47784==v||47812==v||47840==v||47868==v||47896==v||47924==v||47952==v||47980==v||48008==v||48036==v||48064==v||48092==v||48120==v||48148==v||48176==v||48204==v||48232==v||48260==v||48288==v||48316==v||48344==v||48372==v||48400==v||48428==v||48456==v||48484==v||48512==v||48540==v||48568==v||48596==v||48624==v||48652==v||48680==v||48708==v||48736==v||48764==v||48792==v||48820==v||48848==v||48876==v||48904==v||48932==v||48960==v||48988==v||49016==v||49044==v||49072==v||49100==v||49128==v||49156==v||49184==v||49212==v||49240==v||49268==v||49296==v||49324==v||49352==v||49380==v||49408==v||49436==v||49464==v||49492==v||49520==v||49548==v||49576==v||49604==v||49632==v||49660==v||49688==v||49716==v||49744==v||49772==v||49800==v||49828==v||49856==v||49884==v||49912==v||49940==v||49968==v||49996==v||50024==v||50052==v||50080==v||50108==v||50136==v||50164==v||50192==v||50220==v||50248==v||50276==v||50304==v||50332==v||50360==v||50388==v||50416==v||50444==v||50472==v||50500==v||50528==v||50556==v||50584==v||50612==v||50640==v||50668==v||50696==v||50724==v||50752==v||50780==v||50808==v||50836==v||50864==v||50892==v||50920==v||50948==v||50976==v||51004==v||51032==v||51060==v||51088==v||51116==v||51144==v||51172==v||51200==v||51228==v||51256==v||51284==v||51312==v||51340==v||51368==v||51396==v||51424==v||51452==v||51480==v||51508==v||51536==v||51564==v||51592==v||51620==v||51648==v||51676==v||51704==v||51732==v||51760==v||51788==v||51816==v||51844==v||51872==v||51900==v||51928==v||51956==v||51984==v||52012==v||52040==v||52068==v||52096==v||52124==v||52152==v||52180==v||52208==v||52236==v||52264==v||52292==v||52320==v||52348==v||52376==v||52404==v||52432==v||52460==v||52488==v||52516==v||52544==v||52572==v||52600==v||52628==v||52656==v||52684==v||52712==v||52740==v||52768==v||52796==v||52824==v||52852==v||52880==v||52908==v||52936==v||52964==v||52992==v||53020==v||53048==v||53076==v||53104==v||53132==v||53160==v||53188==v||53216==v||53244==v||53272==v||53300==v||53328==v||53356==v||53384==v||53412==v||53440==v||53468==v||53496==v||53524==v||53552==v||53580==v||53608==v||53636==v||53664==v||53692==v||53720==v||53748==v||53776==v||53804==v||53832==v||53860==v||53888==v||53916==v||53944==v||53972==v||54e3==v||54028==v||54056==v||54084==v||54112==v||54140==v||54168==v||54196==v||54224==v||54252==v||54280==v||54308==v||54336==v||54364==v||54392==v||54420==v||54448==v||54476==v||54504==v||54532==v||54560==v||54588==v||54616==v||54644==v||54672==v||54700==v||54728==v||54756==v||54784==v||54812==v||54840==v||54868==v||54896==v||54924==v||54952==v||54980==v||55008==v||55036==v||55064==v||55092==v||55120==v||55148==v||55176==v?l:44033<=v&&v<=44059||44061<=v&&v<=44087||44089<=v&&v<=44115||44117<=v&&v<=44143||44145<=v&&v<=44171||44173<=v&&v<=44199||44201<=v&&v<=44227||44229<=v&&v<=44255||44257<=v&&v<=44283||44285<=v&&v<=44311||44313<=v&&v<=44339||44341<=v&&v<=44367||44369<=v&&v<=44395||44397<=v&&v<=44423||44425<=v&&v<=44451||44453<=v&&v<=44479||44481<=v&&v<=44507||44509<=v&&v<=44535||44537<=v&&v<=44563||44565<=v&&v<=44591||44593<=v&&v<=44619||44621<=v&&v<=44647||44649<=v&&v<=44675||44677<=v&&v<=44703||44705<=v&&v<=44731||44733<=v&&v<=44759||44761<=v&&v<=44787||44789<=v&&v<=44815||44817<=v&&v<=44843||44845<=v&&v<=44871||44873<=v&&v<=44899||44901<=v&&v<=44927||44929<=v&&v<=44955||44957<=v&&v<=44983||44985<=v&&v<=45011||45013<=v&&v<=45039||45041<=v&&v<=45067||45069<=v&&v<=45095||45097<=v&&v<=45123||45125<=v&&v<=45151||45153<=v&&v<=45179||45181<=v&&v<=45207||45209<=v&&v<=45235||45237<=v&&v<=45263||45265<=v&&v<=45291||45293<=v&&v<=45319||45321<=v&&v<=45347||45349<=v&&v<=45375||45377<=v&&v<=45403||45405<=v&&v<=45431||45433<=v&&v<=45459||45461<=v&&v<=45487||45489<=v&&v<=45515||45517<=v&&v<=45543||45545<=v&&v<=45571||45573<=v&&v<=45599||45601<=v&&v<=45627||45629<=v&&v<=45655||45657<=v&&v<=45683||45685<=v&&v<=45711||45713<=v&&v<=45739||45741<=v&&v<=45767||45769<=v&&v<=45795||45797<=v&&v<=45823||45825<=v&&v<=45851||45853<=v&&v<=45879||45881<=v&&v<=45907||45909<=v&&v<=45935||45937<=v&&v<=45963||45965<=v&&v<=45991||45993<=v&&v<=46019||46021<=v&&v<=46047||46049<=v&&v<=46075||46077<=v&&v<=46103||46105<=v&&v<=46131||46133<=v&&v<=46159||46161<=v&&v<=46187||46189<=v&&v<=46215||46217<=v&&v<=46243||46245<=v&&v<=46271||46273<=v&&v<=46299||46301<=v&&v<=46327||46329<=v&&v<=46355||46357<=v&&v<=46383||46385<=v&&v<=46411||46413<=v&&v<=46439||46441<=v&&v<=46467||46469<=v&&v<=46495||46497<=v&&v<=46523||46525<=v&&v<=46551||46553<=v&&v<=46579||46581<=v&&v<=46607||46609<=v&&v<=46635||46637<=v&&v<=46663||46665<=v&&v<=46691||46693<=v&&v<=46719||46721<=v&&v<=46747||46749<=v&&v<=46775||46777<=v&&v<=46803||46805<=v&&v<=46831||46833<=v&&v<=46859||46861<=v&&v<=46887||46889<=v&&v<=46915||46917<=v&&v<=46943||46945<=v&&v<=46971||46973<=v&&v<=46999||47001<=v&&v<=47027||47029<=v&&v<=47055||47057<=v&&v<=47083||47085<=v&&v<=47111||47113<=v&&v<=47139||47141<=v&&v<=47167||47169<=v&&v<=47195||47197<=v&&v<=47223||47225<=v&&v<=47251||47253<=v&&v<=47279||47281<=v&&v<=47307||47309<=v&&v<=47335||47337<=v&&v<=47363||47365<=v&&v<=47391||47393<=v&&v<=47419||47421<=v&&v<=47447||47449<=v&&v<=47475||47477<=v&&v<=47503||47505<=v&&v<=47531||47533<=v&&v<=47559||47561<=v&&v<=47587||47589<=v&&v<=47615||47617<=v&&v<=47643||47645<=v&&v<=47671||47673<=v&&v<=47699||47701<=v&&v<=47727||47729<=v&&v<=47755||47757<=v&&v<=47783||47785<=v&&v<=47811||47813<=v&&v<=47839||47841<=v&&v<=47867||47869<=v&&v<=47895||47897<=v&&v<=47923||47925<=v&&v<=47951||47953<=v&&v<=47979||47981<=v&&v<=48007||48009<=v&&v<=48035||48037<=v&&v<=48063||48065<=v&&v<=48091||48093<=v&&v<=48119||48121<=v&&v<=48147||48149<=v&&v<=48175||48177<=v&&v<=48203||48205<=v&&v<=48231||48233<=v&&v<=48259||48261<=v&&v<=48287||48289<=v&&v<=48315||48317<=v&&v<=48343||48345<=v&&v<=48371||48373<=v&&v<=48399||48401<=v&&v<=48427||48429<=v&&v<=48455||48457<=v&&v<=48483||48485<=v&&v<=48511||48513<=v&&v<=48539||48541<=v&&v<=48567||48569<=v&&v<=48595||48597<=v&&v<=48623||48625<=v&&v<=48651||48653<=v&&v<=48679||48681<=v&&v<=48707||48709<=v&&v<=48735||48737<=v&&v<=48763||48765<=v&&v<=48791||48793<=v&&v<=48819||48821<=v&&v<=48847||48849<=v&&v<=48875||48877<=v&&v<=48903||48905<=v&&v<=48931||48933<=v&&v<=48959||48961<=v&&v<=48987||48989<=v&&v<=49015||49017<=v&&v<=49043||49045<=v&&v<=49071||49073<=v&&v<=49099||49101<=v&&v<=49127||49129<=v&&v<=49155||49157<=v&&v<=49183||49185<=v&&v<=49211||49213<=v&&v<=49239||49241<=v&&v<=49267||49269<=v&&v<=49295||49297<=v&&v<=49323||49325<=v&&v<=49351||49353<=v&&v<=49379||49381<=v&&v<=49407||49409<=v&&v<=49435||49437<=v&&v<=49463||49465<=v&&v<=49491||49493<=v&&v<=49519||49521<=v&&v<=49547||49549<=v&&v<=49575||49577<=v&&v<=49603||49605<=v&&v<=49631||49633<=v&&v<=49659||49661<=v&&v<=49687||49689<=v&&v<=49715||49717<=v&&v<=49743||49745<=v&&v<=49771||49773<=v&&v<=49799||49801<=v&&v<=49827||49829<=v&&v<=49855||49857<=v&&v<=49883||49885<=v&&v<=49911||49913<=v&&v<=49939||49941<=v&&v<=49967||49969<=v&&v<=49995||49997<=v&&v<=50023||50025<=v&&v<=50051||50053<=v&&v<=50079||50081<=v&&v<=50107||50109<=v&&v<=50135||50137<=v&&v<=50163||50165<=v&&v<=50191||50193<=v&&v<=50219||50221<=v&&v<=50247||50249<=v&&v<=50275||50277<=v&&v<=50303||50305<=v&&v<=50331||50333<=v&&v<=50359||50361<=v&&v<=50387||50389<=v&&v<=50415||50417<=v&&v<=50443||50445<=v&&v<=50471||50473<=v&&v<=50499||50501<=v&&v<=50527||50529<=v&&v<=50555||50557<=v&&v<=50583||50585<=v&&v<=50611||50613<=v&&v<=50639||50641<=v&&v<=50667||50669<=v&&v<=50695||50697<=v&&v<=50723||50725<=v&&v<=50751||50753<=v&&v<=50779||50781<=v&&v<=50807||50809<=v&&v<=50835||50837<=v&&v<=50863||50865<=v&&v<=50891||50893<=v&&v<=50919||50921<=v&&v<=50947||50949<=v&&v<=50975||50977<=v&&v<=51003||51005<=v&&v<=51031||51033<=v&&v<=51059||51061<=v&&v<=51087||51089<=v&&v<=51115||51117<=v&&v<=51143||51145<=v&&v<=51171||51173<=v&&v<=51199||51201<=v&&v<=51227||51229<=v&&v<=51255||51257<=v&&v<=51283||51285<=v&&v<=51311||51313<=v&&v<=51339||51341<=v&&v<=51367||51369<=v&&v<=51395||51397<=v&&v<=51423||51425<=v&&v<=51451||51453<=v&&v<=51479||51481<=v&&v<=51507||51509<=v&&v<=51535||51537<=v&&v<=51563||51565<=v&&v<=51591||51593<=v&&v<=51619||51621<=v&&v<=51647||51649<=v&&v<=51675||51677<=v&&v<=51703||51705<=v&&v<=51731||51733<=v&&v<=51759||51761<=v&&v<=51787||51789<=v&&v<=51815||51817<=v&&v<=51843||51845<=v&&v<=51871||51873<=v&&v<=51899||51901<=v&&v<=51927||51929<=v&&v<=51955||51957<=v&&v<=51983||51985<=v&&v<=52011||52013<=v&&v<=52039||52041<=v&&v<=52067||52069<=v&&v<=52095||52097<=v&&v<=52123||52125<=v&&v<=52151||52153<=v&&v<=52179||52181<=v&&v<=52207||52209<=v&&v<=52235||52237<=v&&v<=52263||52265<=v&&v<=52291||52293<=v&&v<=52319||52321<=v&&v<=52347||52349<=v&&v<=52375||52377<=v&&v<=52403||52405<=v&&v<=52431||52433<=v&&v<=52459||52461<=v&&v<=52487||52489<=v&&v<=52515||52517<=v&&v<=52543||52545<=v&&v<=52571||52573<=v&&v<=52599||52601<=v&&v<=52627||52629<=v&&v<=52655||52657<=v&&v<=52683||52685<=v&&v<=52711||52713<=v&&v<=52739||52741<=v&&v<=52767||52769<=v&&v<=52795||52797<=v&&v<=52823||52825<=v&&v<=52851||52853<=v&&v<=52879||52881<=v&&v<=52907||52909<=v&&v<=52935||52937<=v&&v<=52963||52965<=v&&v<=52991||52993<=v&&v<=53019||53021<=v&&v<=53047||53049<=v&&v<=53075||53077<=v&&v<=53103||53105<=v&&v<=53131||53133<=v&&v<=53159||53161<=v&&v<=53187||53189<=v&&v<=53215||53217<=v&&v<=53243||53245<=v&&v<=53271||53273<=v&&v<=53299||53301<=v&&v<=53327||53329<=v&&v<=53355||53357<=v&&v<=53383||53385<=v&&v<=53411||53413<=v&&v<=53439||53441<=v&&v<=53467||53469<=v&&v<=53495||53497<=v&&v<=53523||53525<=v&&v<=53551||53553<=v&&v<=53579||53581<=v&&v<=53607||53609<=v&&v<=53635||53637<=v&&v<=53663||53665<=v&&v<=53691||53693<=v&&v<=53719||53721<=v&&v<=53747||53749<=v&&v<=53775||53777<=v&&v<=53803||53805<=v&&v<=53831||53833<=v&&v<=53859||53861<=v&&v<=53887||53889<=v&&v<=53915||53917<=v&&v<=53943||53945<=v&&v<=53971||53973<=v&&v<=53999||54001<=v&&v<=54027||54029<=v&&v<=54055||54057<=v&&v<=54083||54085<=v&&v<=54111||54113<=v&&v<=54139||54141<=v&&v<=54167||54169<=v&&v<=54195||54197<=v&&v<=54223||54225<=v&&v<=54251||54253<=v&&v<=54279||54281<=v&&v<=54307||54309<=v&&v<=54335||54337<=v&&v<=54363||54365<=v&&v<=54391||54393<=v&&v<=54419||54421<=v&&v<=54447||54449<=v&&v<=54475||54477<=v&&v<=54503||54505<=v&&v<=54531||54533<=v&&v<=54559||54561<=v&&v<=54587||54589<=v&&v<=54615||54617<=v&&v<=54643||54645<=v&&v<=54671||54673<=v&&v<=54699||54701<=v&&v<=54727||54729<=v&&v<=54755||54757<=v&&v<=54783||54785<=v&&v<=54811||54813<=v&&v<=54839||54841<=v&&v<=54867||54869<=v&&v<=54895||54897<=v&&v<=54923||54925<=v&&v<=54951||54953<=v&&v<=54979||54981<=v&&v<=55007||55009<=v&&v<=55035||55037<=v&&v<=55063||55065<=v&&v<=55091||55093<=v&&v<=55119||55121<=v&&v<=55147||55149<=v&&v<=55175||55177<=v&&v<=55203?u:9757==v||9977==v||9994<=v&&v<=9997||127877==v||127938<=v&&v<=127940||127943==v||127946<=v&&v<=127948||128066<=v&&v<=128067||128070<=v&&v<=128080||128110==v||128112<=v&&v<=128120||128124==v||128129<=v&&v<=128131||128133<=v&&v<=128135||128170==v||128372<=v&&v<=128373||128378==v||128400==v||128405<=v&&v<=128406||128581<=v&&v<=128583||128587<=v&&v<=128591||128675==v||128692<=v&&v<=128694||128704==v||128716==v||129304<=v&&v<=129308||129310<=v&&v<=129311||129318==v||129328<=v&&v<=129337||129341<=v&&v<=129342||129489<=v&&v<=129501?f:127995<=v&&v<=127999?p:8205==v?m:9792==v||9794==v||9877<=v&&v<=9878||9992==v||10084==v||127752==v||127806==v||127859==v||127891==v||127908==v||127912==v||127979==v||127981==v||128139==v||128187<=v&&v<=128188||128295==v||128300==v||128488==v||128640==v||128658==v?_:128102<=v&&v<=128105?g:h}return this.nextBreak=function(e,t){if(void 0===t&&(t=0),t<0)return 0;if(t>=e.length-1)return e.length;for(var i,n,r=T(x(e,t)),a=[],o=t+1;o<e.length;o++)if(n=o-1,!(55296<=(i=e).charCodeAt(n)&&i.charCodeAt(n)<=56319&&56320<=i.charCodeAt(n+1)&&i.charCodeAt(n+1)<=57343)){var s=T(x(e,o));if(E(r,a,s))return o;a.push(s)}return e.length},this.splitGraphemes=function(e){for(var t,i=[],n=0;(t=this.nextBreak(e,n))<e.length;)i.push(e.slice(n,t)),n=t;return n<e.length&&i.push(e.slice(n)),i},this.iterateGraphemes=function(e){var t=0,i={next:function(){var i,n;return(n=this.nextBreak(e,t))<e.length?(i=e.slice(t,n),t=n,{value:i,done:!1}):t<e.length?(i=e.slice(t),t=e.length,{value:i,done:!1}):{value:void 0,done:!0}}.bind(this)};return"undefined"!=typeof Symbol&&Symbol.iterator&&(i[Symbol.iterator]=function(){return i}),i},this.countGraphemes=function(e){for(var t,i=0,n=0;(t=this.nextBreak(e,n))<e.length;)n=t,i++;return n<e.length&&i++,i},this},wxe=n(87),Oxe="__knockoutObservables",xxe="__knockoutSubscribable";function Exe(e,t){if(!e)throw new Error("When calling ko.track, you must pass an object as the first parameter.");var i=this,n=Txe(e,!0);return(t=t||Object.getOwnPropertyNames(e)).forEach((function(t){if(t!==Oxe&&t!==xxe&&!(t in n)){var r=e[t],a=r instanceof Array,o=i.isObservable(r)?r:a?i.observableArray(r):i.observable(r);Object.defineProperty(e,t,{configurable:!0,enumerable:!0,get:o,set:i.isWriteableObservable(o)?o:void 0}),n[t]=o,a&&function(e,t){var i=null;e.computed((function(){i&&(i.dispose(),i=null);var n=t();n instanceof Array&&(i=function(e,t,i){return function(e,t){var i=t[xxe];if(!i){i=new e.subscribable,Object.defineProperty(t,xxe,{value:i});var n={};!function(e,t,i){["pop","push","reverse","shift","sort","splice","unshift"].forEach((function(n){var r=e[n];e[n]=function(){var e=r.apply(this,arguments);return!0!==i.pause&&t.notifySubscribers(this),e}}))}(t,i,n),function(e,t,i,n){["remove","removeAll","destroy","destroyAll","replace"].forEach((function(r){Object.defineProperty(t,r,{enumerable:!1,value:function(){var a;n.pause=!0;try{a=e.observableArray.fn[r].apply(e.observableArray(t),arguments)}finally{n.pause=!1}return i.notifySubscribers(t),a}})}))}(e,t,i,n)}return i}(e,i).subscribe(t)}(e,t,n))}))}(i,o)}})),e}function Txe(e,t){var i=e[Oxe];return!i&&t&&(i={},Object.defineProperty(e,Oxe,{value:i})),i}function Cxe(e,t,i){var n={owner:e,deferEvaluation:!0};if("function"==typeof i)n.read=i;else{if("value"in i)throw new Error('For ko.defineProperty, you must not specify a "value" for the property. You must provide a "get" function.');if("function"!=typeof i.get)throw new Error('For ko.defineProperty, the third parameter must be either an evaluator function, or an options object containing a function called "get".');n.read=i.get,n.write=i.set}return e[t]=this.computed(n),Exe.call(this,e,[t]),e}function Sxe(e,t){if(!e)return null;var i=Txe(e,!1);return i&&i[t]||null}function Axe(e,t){var i=Sxe(e,t);i&&i.valueHasMutated()}var Pxe={attachToKo:function(e){e.track=Exe,e.getObservable=Sxe,e.valueHasMutated=Axe,e.defineProperty=Cxe}},Ixe={register:function(e){e.bindingHandlers.cesiumSvgPath={init:function(t,i){var n=document.createElementNS("http://www.w3.org/2000/svg","svg:svg");n.setAttribute("class","cesium-svgPath-svg");var r=document.createElementNS("http://www.w3.org/2000/svg","path");return n.appendChild(r),e.virtualElements.setDomNodeChildren(t,[n]),e.computed({read:function(){var t=e.unwrap(i());r.setAttribute("d",e.unwrap(t.path));var a=e.unwrap(t.width),o=e.unwrap(t.height);n.setAttribute("width",a),n.setAttribute("height",o),n.setAttribute("viewBox","0 0 "+a+" "+o),t.css&&n.setAttribute("class","cesium-svgPath-svg "+e.unwrap(t.css))},disposeWhenNodeIsRemoved:t}),{controlsDescendantBindings:!0}}},e.virtualElements.allowedBindings.cesiumSvgPath=!0}};Pxe.attachToKo(wxe.a),Ixe.register(wxe.a);var Dxe=wxe.a,jxe={};
/* Copyright 2015-2018 Esri. Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except in compliance with the License. You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0 @preserve */!function(){var e,t,i,n,r,a,o,s,c,l,u,h,d,f,p=(e={defaultNoDataValue:-34027999387901484e22,decode:function(a,o){var s=(o=o||{}).encodedMaskData||null===o.encodedMaskData,c=r(a,o.inputOffset||0,s),l=null!==o.noDataValue?o.noDataValue:e.defaultNoDataValue,u=t(c,o.pixelType||Float32Array,o.encodedMaskData,l,o.returnMask),h={width:c.width,height:c.height,pixelData:u.resultPixels,minValue:u.minValue,maxValue:c.pixels.maxValue,noDataValue:l};return u.resultMask&&(h.maskData=u.resultMask),o.returnEncodedMask&&c.mask&&(h.encodedMaskData=c.mask.bitset?c.mask.bitset:null),o.returnFileInfo&&(h.fileInfo=i(c),o.computeUsedBitDepths&&(h.fileInfo.bitDepths=n(c))),h}},t=function(e,t,i,n,r){var o,s,c,l=0,u=e.pixels.numBlocksX,h=e.pixels.numBlocksY,d=Math.floor(e.width/u),f=Math.floor(e.height/h),p=2*e.maxZError,m=Number.MAX_VALUE;i=i||(e.mask?e.mask.bitset:null),s=new t(e.width*e.height),r&&i&&(c=new Uint8Array(e.width*e.height));for(var _,g,v=new Float32Array(d*f),b=0;b<=h;b++){var y=b!==h?f:e.height%h;if(0!==y)for(var w=0;w<=u;w++){var O=w!==u?d:e.width%u;if(0!==O){var x,E,T,C,S=b*e.width*f+w*d,A=e.width-O,P=e.pixels.blocks[l];if(P.encoding<2?(0===P.encoding?x=P.rawData:(a(P.stuffedData,P.bitsPerPixel,P.numValidPixels,P.offset,p,v,e.pixels.maxValue),x=v),E=0):T=2===P.encoding?0:P.offset,i)for(g=0;g<y;g++){for(7&S&&(C=i[S>>3],C<<=7&S),_=0;_<O;_++)7&S||(C=i[S>>3]),128&C?(c&&(c[S]=1),m=m>(o=P.encoding<2?x[E++]:T)?o:m,s[S++]=o):(c&&(c[S]=0),s[S++]=n),C<<=1;S+=A}else if(P.encoding<2)for(g=0;g<y;g++){for(_=0;_<O;_++)m=m>(o=x[E++])?o:m,s[S++]=o;S+=A}else for(m=m>T?T:m,g=0;g<y;g++){for(_=0;_<O;_++)s[S++]=T;S+=A}if(1===P.encoding&&E!==P.numValidPixels)throw"Block and Mask do not match";l++}}}return{resultPixels:s,resultMask:c,minValue:m}},i=function(e){return{fileIdentifierString:e.fileIdentifierString,fileVersion:e.fileVersion,imageType:e.imageType,height:e.height,width:e.width,maxZError:e.maxZError,eofOffset:e.eofOffset,mask:e.mask?{numBlocksX:e.mask.numBlocksX,numBlocksY:e.mask.numBlocksY,numBytes:e.mask.numBytes,maxValue:e.mask.maxValue}:null,pixels:{numBlocksX:e.pixels.numBlocksX,numBlocksY:e.pixels.numBlocksY,numBytes:e.pixels.numBytes,maxValue:e.pixels.maxValue,noDataValue:e.noDataValue}}},n=function(e){for(var t=e.pixels.numBlocksX*e.pixels.numBlocksY,i={},n=0;n<t;n++){var r=e.pixels.blocks[n];0===r.encoding?i.float32=!0:1===r.encoding?i[r.bitsPerPixel]=!0:i[0]=!0}return Object.keys(i)},r=function(e,t,i){var n={},r=new Uint8Array(e,t,10);if(n.fileIdentifierString=String.fromCharCode.apply(null,r),"CntZImage"!==n.fileIdentifierString.trim())throw"Unexpected file identifier string: "+n.fileIdentifierString;t+=10;var a=new DataView(e,t,24);if(n.fileVersion=a.getInt32(0,!0),n.imageType=a.getInt32(4,!0),n.height=a.getUint32(8,!0),n.width=a.getUint32(12,!0),n.maxZError=a.getFloat64(16,!0),t+=24,!i)if(a=new DataView(e,t,16),n.mask={},n.mask.numBlocksY=a.getUint32(0,!0),n.mask.numBlocksX=a.getUint32(4,!0),n.mask.numBytes=a.getUint32(8,!0),n.mask.maxValue=a.getFloat32(12,!0),t+=16,n.mask.numBytes>0){var o=new Uint8Array(Math.ceil(n.width*n.height/8)),s=(a=new DataView(e,t,n.mask.numBytes)).getInt16(0,!0),c=2,l=0;do{if(s>0)for(;s--;)o[l++]=a.getUint8(c++);else{var u=a.getUint8(c++);for(s=-s;s--;)o[l++]=u}s=a.getInt16(c,!0),c+=2}while(c<n.mask.numBytes);if(-32768!==s||l<o.length)throw"Unexpected end of mask RLE encoding";n.mask.bitset=o,t+=n.mask.numBytes}else 0==(n.mask.numBytes|n.mask.numBlocksY|n.mask.maxValue)&&(n.mask.bitset=new Uint8Array(Math.ceil(n.width*n.height/8)));a=new DataView(e,t,16),n.pixels={},n.pixels.numBlocksY=a.getUint32(0,!0),n.pixels.numBlocksX=a.getUint32(4,!0),n.pixels.numBytes=a.getUint32(8,!0),n.pixels.maxValue=a.getFloat32(12,!0),t+=16;var h=n.pixels.numBlocksX,d=n.pixels.numBlocksY,f=h+(n.width%h>0?1:0),p=d+(n.height%d>0?1:0);n.pixels.blocks=new Array(f*p);for(var m=0,_=0;_<p;_++)for(var g=0;g<f;g++){var v=0,b=e.byteLength-t;a=new DataView(e,t,Math.min(10,b));var y={};n.pixels.blocks[m++]=y;var w=a.getUint8(0);if(v++,y.encoding=63&w,y.encoding>3)throw"Invalid block encoding ("+y.encoding+")";if(2!==y.encoding){if(0!==w&&2!==w){if(w>>=6,y.offsetType=w,2===w)y.offset=a.getInt8(1),v++;else if(1===w)y.offset=a.getInt16(1,!0),v+=2;else{if(0!==w)throw"Invalid block offset type";y.offset=a.getFloat32(1,!0),v+=4}if(1===y.encoding)if(w=a.getUint8(v),v++,y.bitsPerPixel=63&w,w>>=6,y.numValidPixelsType=w,2===w)y.numValidPixels=a.getUint8(v),v++;else if(1===w)y.numValidPixels=a.getUint16(v,!0),v+=2;else{if(0!==w)throw"Invalid valid pixel count type";y.numValidPixels=a.getUint32(v,!0),v+=4}}var O;if(t+=v,3!==y.encoding)if(0===y.encoding){var x=(n.pixels.numBytes-1)/4;if(x!==Math.floor(x))throw"uncompressed block has invalid length";O=new ArrayBuffer(4*x),new Uint8Array(O).set(new Uint8Array(e,t,4*x));var E=new Float32Array(O);y.rawData=E,t+=4*x}else if(1===y.encoding){var T=Math.ceil(y.numValidPixels*y.bitsPerPixel/8),C=Math.ceil(T/4);O=new ArrayBuffer(4*C),new Uint8Array(O).set(new Uint8Array(e,t,T)),y.stuffedData=new Uint32Array(O),t+=T}}else t++}return n.eofOffset=t,n},a=function(e,t,i,n,r,a,o){var s,c,l,u=(1<<t)-1,h=0,d=0,f=Math.ceil((o-n)/r),p=4*e.length-Math.ceil(t*i/8);for(e[e.length-1]<<=8*p,s=0;s<i;s++){if(0===d&&(l=e[h++],d=32),d>=t)c=l>>>d-t&u,d-=t;else{var m=t-d;c=(l&u)<<m&u,c+=(l=e[h++])>>>(d=32-m)}a[s]=c<f?n+c*r:o}return a},e),m=(o=function(e,t,i,n,r,a,o,s){var c,l,u,h,d,f=(1<<i)-1,p=0,m=0,_=4*e.length-Math.ceil(i*n/8);if(e[e.length-1]<<=8*_,r)for(c=0;c<n;c++)0===m&&(u=e[p++],m=32),m>=i?(l=u>>>m-i&f,m-=i):(l=(u&f)<<(h=i-m)&f,l+=(u=e[p++])>>>(m=32-h)),t[c]=r[l];else for(d=Math.ceil((s-a)/o),c=0;c<n;c++)0===m&&(u=e[p++],m=32),m>=i?(l=u>>>m-i&f,m-=i):(l=(u&f)<<(h=i-m)&f,l+=(u=e[p++])>>>(m=32-h)),t[c]=l<d?a+l*o:s},s=function(e,t,i,n,r,a){var o,s=(1<<t)-1,c=0,l=0,u=0,h=0,d=0,f=[],p=4*e.length-Math.ceil(t*i/8);e[e.length-1]<<=8*p;var m=Math.ceil((a-n)/r);for(l=0;l<i;l++)0===h&&(o=e[c++],h=32),h>=t?(d=o>>>h-t&s,h-=t):(d=(o&s)<<(u=t-h)&s,d+=(o=e[c++])>>>(h=32-u)),f[l]=d<m?n+d*r:a;return f.unshift(n),f},c=function(e,t,i,n,r,a,o,s){var c,l,u,h,d=(1<<i)-1,f=0,p=0,m=0;if(r)for(c=0;c<n;c++)0===p&&(u=e[f++],p=32,m=0),p>=i?(l=u>>>m&d,p-=i,m+=i):(l=u>>>m&d,p=32-(h=i-p),l|=((u=e[f++])&(1<<h)-1)<<i-h,m=h),t[c]=r[l];else{var _=Math.ceil((s-a)/o);for(c=0;c<n;c++)0===p&&(u=e[f++],p=32,m=0),p>=i?(l=u>>>m&d,p-=i,m+=i):(l=u>>>m&d,p=32-(h=i-p),l|=((u=e[f++])&(1<<h)-1)<<i-h,m=h),t[c]=l<_?a+l*o:s}return t},l=function(e,t,i,n,r,a){var o,s=(1<<t)-1,c=0,l=0,u=0,h=0,d=0,f=0,p=[],m=Math.ceil((a-n)/r);for(l=0;l<i;l++)0===h&&(o=e[c++],h=32,f=0),h>=t?(d=o>>>f&s,h-=t,f+=t):(d=o>>>f&s,h=32-(u=t-h),d|=((o=e[c++])&(1<<u)-1)<<t-u,f=u),p[l]=d<m?n+d*r:a;return p.unshift(n),p},u=function(e,t,i,n){var r,a,o,s,c=(1<<i)-1,l=0,u=0,h=4*e.length-Math.ceil(i*n/8);for(e[e.length-1]<<=8*h,r=0;r<n;r++)0===u&&(o=e[l++],u=32),u>=i?(a=o>>>u-i&c,u-=i):(a=(o&c)<<(s=i-u)&c,a+=(o=e[l++])>>>(u=32-s)),t[r]=a;return t},h=function(e,t,i,n){var r,a,o,s,c=(1<<i)-1,l=0,u=0,h=0;for(r=0;r<n;r++)0===u&&(o=e[l++],u=32,h=0),u>=i?(a=o>>>h&c,u-=i,h+=i):(a=o>>>h&c,u=32-(s=i-u),a|=((o=e[l++])&(1<<s)-1)<<i-s,h=s),t[r]=a;return t},d={HUFFMAN_LUT_BITS_MAX:12,computeChecksumFletcher32:function(e){for(var t=65535,i=65535,n=e.length,r=Math.floor(n/2),a=0;r;){var o=r>=359?359:r;r-=o;do{t+=e[a++]<<8,i+=t+=e[a++]}while(--o);t=(65535&t)+(t>>>16),i=(65535&i)+(i>>>16)}return 1&n&&(i+=t+=e[a]<<8),((i=(65535&i)+(i>>>16))<<16|(t=(65535&t)+(t>>>16)))>>>0},readHeaderInfo:function(e,t){var i=t.ptr,n=new Uint8Array(e,i,6),r={};if(r.fileIdentifierString=String.fromCharCode.apply(null,n),0!==r.fileIdentifierString.lastIndexOf("Lerc2",0))throw"Unexpected file identifier string (expect Lerc2 ): "+r.fileIdentifierString;i+=6;var a,o=new DataView(e,i,8),s=o.getInt32(0,!0);if(r.fileVersion=s,i+=4,s>=3&&(r.checksum=o.getUint32(4,!0),i+=4),o=new DataView(e,i,12),r.height=o.getUint32(0,!0),r.width=o.getUint32(4,!0),i+=8,s>=4?(r.numDims=o.getUint32(8,!0),i+=4):r.numDims=1,o=new DataView(e,i,40),r.numValidPixel=o.getUint32(0,!0),r.microBlockSize=o.getInt32(4,!0),r.blobSize=o.getInt32(8,!0),r.imageType=o.getInt32(12,!0),r.maxZError=o.getFloat64(16,!0),r.zMin=o.getFloat64(24,!0),r.zMax=o.getFloat64(32,!0),i+=40,t.headerInfo=r,t.ptr=i,s>=3&&(a=s>=4?52:48,this.computeChecksumFletcher32(new Uint8Array(e,i-a,r.blobSize-14))!==r.checksum))throw"Checksum failed.";return!0},checkMinMaxRanges:function(e,t){var i=t.headerInfo,n=this.getDataTypeArray(i.imageType),r=i.numDims*this.getDataTypeSize(i.imageType),a=this.readSubArray(e,t.ptr,n,r),o=this.readSubArray(e,t.ptr+r,n,r);t.ptr+=2*r;var s,c=!0;for(s=0;s<i.numDims;s++)if(a[s]!==o[s]){c=!1;break}return i.minValues=a,i.maxValues=o,c},readSubArray:function(e,t,i,n){var r;if(i===Uint8Array)r=new Uint8Array(e,t,n);else{var a=new ArrayBuffer(n);new Uint8Array(a).set(new Uint8Array(e,t,n)),r=new i(a)}return r},readMask:function(e,t){var i,n,r=t.ptr,a=t.headerInfo,o=a.width*a.height,s=a.numValidPixel,c=new DataView(e,r,4),l={};if(l.numBytes=c.getUint32(0,!0),r+=4,(0===s||o===s)&&0!==l.numBytes)throw"invalid mask";if(0===s)i=new Uint8Array(Math.ceil(o/8)),l.bitset=i,n=new Uint8Array(o),t.pixels.resultMask=n,r+=l.numBytes;else if(l.numBytes>0){i=new Uint8Array(Math.ceil(o/8));var u=(c=new DataView(e,r,l.numBytes)).getInt16(0,!0),h=2,d=0,f=0;do{if(u>0)for(;u--;)i[d++]=c.getUint8(h++);else for(f=c.getUint8(h++),u=-u;u--;)i[d++]=f;u=c.getInt16(h,!0),h+=2}while(h<l.numBytes);if(-32768!==u||d<i.length)throw"Unexpected end of mask RLE encoding";n=new Uint8Array(o);var p=0,m=0;for(m=0;m<o;m++)7&m?(p=i[m>>3],p<<=7&m):p=i[m>>3],128&p&&(n[m]=1);t.pixels.resultMask=n,l.bitset=i,r+=l.numBytes}return t.ptr=r,t.mask=l,!0},readDataOneSweep:function(e,t,i){var n,r=t.ptr,a=t.headerInfo,o=a.numDims,s=a.width*a.height,c=a.imageType,l=a.numValidPixel*d.getDataTypeSize(c)*o,u=t.pixels.resultMask;if(i===Uint8Array)n=new Uint8Array(e,r,l);else{var h=new ArrayBuffer(l);new Uint8Array(h).set(new Uint8Array(e,r,l)),n=new i(h)}if(n.length===s*o)t.pixels.resultPixels=n;else{t.pixels.resultPixels=new i(s*o);var f=0,p=0,m=0,_=0;if(o>1)for(m=0;m<o;m++)for(_=m*s,p=0;p<s;p++)u[p]&&(t.pixels.resultPixels[_+p]=n[f++]);else for(p=0;p<s;p++)u[p]&&(t.pixels.resultPixels[p]=n[f++])}return r+=l,t.ptr=r,!0},readHuffmanTree:function(e,t){var i=this.HUFFMAN_LUT_BITS_MAX,n=new DataView(e,t.ptr,16);if(t.ptr+=16,n.getInt32(0,!0)<2)throw"unsupported Huffman version";var r=n.getInt32(4,!0),a=n.getInt32(8,!0),o=n.getInt32(12,!0);if(a>=o)return!1;var s=new Uint32Array(o-a);d.decodeBits(e,t,s);var c,l,u,h,p=[];for(c=a;c<o;c++)p[l=c-(c<r?0:r)]={first:s[c-a],second:null};var m=e.byteLength-t.ptr,_=Math.ceil(m/4),g=new ArrayBuffer(4*_);new Uint8Array(g).set(new Uint8Array(e,t.ptr,m));var v,b=new Uint32Array(g),y=0,w=0;for(v=b[0],c=a;c<o;c++)(h=p[l=c-(c<r?0:r)].first)>0&&(p[l].second=v<<y>>>32-h,32-y>=h?32===(y+=h)&&(y=0,v=b[++w]):(y+=h-32,v=b[++w],p[l].second|=v>>>32-y));var O=0,x=0,E=new f;for(c=0;c<p.length;c++)void 0!==p[c]&&(O=Math.max(O,p[c].first));x=O>=i?i:O,O>=30&&console.log("WARning, large NUM LUT BITS IS "+O);var T,C,S,A,P,I=[];for(c=a;c<o;c++)if((h=p[l=c-(c<r?0:r)].first)>0)if(T=[h,l],h<=x)for(C=p[l].second<<x-h,S=1<<x-h,u=0;u<S;u++)I[C|u]=T;else for(C=p[l].second,P=E,A=h-1;A>=0;A--)C>>>A&1?(P.right||(P.right=new f),P=P.right):(P.left||(P.left=new f),P=P.left),0!==A||P.val||(P.val=T[1]);return{decodeLut:I,numBitsLUTQick:x,numBitsLUT:O,tree:E,stuffedData:b,srcPtr:w,bitPos:y}},readHuffman:function(e,t,i){var n,r,a,o,s,c,l,u,h,d=t.headerInfo,f=d.numDims,p=t.headerInfo.height,m=t.headerInfo.width,_=m*p,g=this.readHuffmanTree(e,t),v=g.decodeLut,b=g.tree,y=g.stuffedData,w=g.srcPtr,O=g.bitPos,x=g.numBitsLUTQick,E=g.numBitsLUT,T=0===t.headerInfo.imageType?128:0,C=t.pixels.resultMask,S=0;O>0&&(w++,O=0);var A,P=y[w],I=1===t.encodeMode,D=new i(_*f),j=D;for(A=0;A<d.numDims;A++){if(f>1&&(j=new i(D.buffer,_*A,_),S=0),t.headerInfo.numValidPixel===m*p)for(u=0,c=0;c<p;c++)for(l=0;l<m;l++,u++){if(r=0,s=o=P<<O>>>32-x,32-O<x&&(s=o|=y[w+1]>>>64-O-x),v[s])r=v[s][1],O+=v[s][0];else for(s=o=P<<O>>>32-E,32-O<E&&(s=o|=y[w+1]>>>64-O-E),n=b,h=0;h<E;h++)if(!(n=o>>>E-h-1&1?n.right:n.left).left&&!n.right){r=n.val,O=O+h+1;break}O>=32&&(O-=32,P=y[++w]),a=r-T,I?(a+=l>0?S:c>0?j[u-m]:S,a&=255,j[u]=a,S=a):j[u]=a}else for(u=0,c=0;c<p;c++)for(l=0;l<m;l++,u++)if(C[u]){if(r=0,s=o=P<<O>>>32-x,32-O<x&&(s=o|=y[w+1]>>>64-O-x),v[s])r=v[s][1],O+=v[s][0];else for(s=o=P<<O>>>32-E,32-O<E&&(s=o|=y[w+1]>>>64-O-E),n=b,h=0;h<E;h++)if(!(n=o>>>E-h-1&1?n.right:n.left).left&&!n.right){r=n.val,O=O+h+1;break}O>=32&&(O-=32,P=y[++w]),a=r-T,I?(l>0&&C[u-1]?a+=S:c>0&&C[u-m]?a+=j[u-m]:a+=S,a&=255,j[u]=a,S=a):j[u]=a}t.ptr=t.ptr+4*(w+1)+(O>0?4:0)}t.pixels.resultPixels=D},decodeBits:function(e,t,i,n,r){var a=t.headerInfo,d=a.fileVersion,f=0,p=e.byteLength-t.ptr>=5?5:e.byteLength-t.ptr,m=new DataView(e,t.ptr,p),_=m.getUint8(0);f++;var g=_>>6,v=0===g?4:3-g,b=(32&_)>0,y=31&_,w=0;if(1===v)w=m.getUint8(f),f++;else if(2===v)w=m.getUint16(f,!0),f+=2;else{if(4!==v)throw"Invalid valid pixel count type";w=m.getUint32(f,!0),f+=4}var O,x,E,T,C,S,A,P,I,D=2*a.maxZError,j=a.numDims>1?a.maxValues[r]:a.zMax;if(b){for(t.counter.lut++,P=m.getUint8(f),f++,T=Math.ceil((P-1)*y/8),C=Math.ceil(T/4),x=new ArrayBuffer(4*C),E=new Uint8Array(x),t.ptr+=f,E.set(new Uint8Array(e,t.ptr,T)),A=new Uint32Array(x),t.ptr+=T,I=0;P-1>>>I;)I++;T=Math.ceil(w*I/8),C=Math.ceil(T/4),x=new ArrayBuffer(4*C),(E=new Uint8Array(x)).set(new Uint8Array(e,t.ptr,T)),O=new Uint32Array(x),t.ptr+=T,S=d>=3?l(A,y,P-1,n,D,j):s(A,y,P-1,n,D,j),d>=3?c(O,i,I,w,S):o(O,i,I,w,S)}else t.counter.bitstuffer++,I=y,t.ptr+=f,I>0&&(T=Math.ceil(w*I/8),C=Math.ceil(T/4),x=new ArrayBuffer(4*C),(E=new Uint8Array(x)).set(new Uint8Array(e,t.ptr,T)),O=new Uint32Array(x),t.ptr+=T,d>=3?null===n?h(O,i,I,w):c(O,i,I,w,!1,n,D,j):null===n?u(O,i,I,w):o(O,i,I,w,!1,n,D,j))},readTiles:function(e,t,i){var n=t.headerInfo,r=n.width,a=n.height,o=n.microBlockSize,s=n.imageType,c=d.getDataTypeSize(s),l=Math.ceil(r/o),u=Math.ceil(a/o);t.pixels.numBlocksY=u,t.pixels.numBlocksX=l,t.pixels.ptr=0;var h,f,p,m,_,g,v,b,y=0,w=0,O=0,x=0,E=0,T=0,C=0,S=0,A=0,P=0,I=0,D=0,j=0,M=0,R=0,L=new i(o*o),N=a%o||o,F=r%o||o,k=n.numDims,B=t.pixels.resultMask,z=t.pixels.resultPixels;for(O=0;O<u;O++)for(E=O!==u-1?o:N,x=0;x<l;x++)for(P=O*r*o+x*o,I=r-(T=x!==l-1?o:F),b=0;b<k;b++){if(k>1&&(z=new i(t.pixels.resultPixels.buffer,r*a*b*c,r*a)),C=e.byteLength-t.ptr,f={},R=0,R++,A=(S=(h=new DataView(e,t.ptr,Math.min(10,C))).getUint8(0))>>6&255,(S>>2&15)!=(x*o>>3&15))throw"integrity issue";if((_=3&S)>3)throw t.ptr+=R,"Invalid block encoding ("+_+")";if(2!==_)if(0===_){if(t.counter.uncompressed++,t.ptr+=R,D=(D=E*T*c)<(j=e.byteLength-t.ptr)?D:j,p=new ArrayBuffer(D%c==0?D:D+c-D%c),new Uint8Array(p).set(new Uint8Array(e,t.ptr,D)),m=new i(p),M=0,B)for(y=0;y<E;y++){for(w=0;w<T;w++)B[P]&&(z[P]=m[M++]),P++;P+=I}else for(y=0;y<E;y++){for(w=0;w<T;w++)z[P++]=m[M++];P+=I}t.ptr+=M*c}else if(g=d.getDataTypeUsed(s,A),v=d.getOnePixel(f,R,g,h),R+=d.getDataTypeSize(g),3===_)if(t.ptr+=R,t.counter.constantoffset++,B)for(y=0;y<E;y++){for(w=0;w<T;w++)B[P]&&(z[P]=v),P++;P+=I}else for(y=0;y<E;y++){for(w=0;w<T;w++)z[P++]=v;P+=I}else if(t.ptr+=R,d.decodeBits(e,t,L,v,b),R=0,B)for(y=0;y<E;y++){for(w=0;w<T;w++)B[P]&&(z[P]=L[R++]),P++;P+=I}else for(y=0;y<E;y++){for(w=0;w<T;w++)z[P++]=L[R++];P+=I}else t.counter.constant++,t.ptr+=R}},formatFileInfo:function(e){return{fileIdentifierString:e.headerInfo.fileIdentifierString,fileVersion:e.headerInfo.fileVersion,imageType:e.headerInfo.imageType,height:e.headerInfo.height,width:e.headerInfo.width,numValidPixel:e.headerInfo.numValidPixel,microBlockSize:e.headerInfo.microBlockSize,blobSize:e.headerInfo.blobSize,maxZError:e.headerInfo.maxZError,pixelType:d.getPixelType(e.headerInfo.imageType),eofOffset:e.eofOffset,mask:e.mask?{numBytes:e.mask.numBytes}:null,pixels:{numBlocksX:e.pixels.numBlocksX,numBlocksY:e.pixels.numBlocksY,maxValue:e.headerInfo.zMax,minValue:e.headerInfo.zMin,noDataValue:e.noDataValue}}},constructConstantSurface:function(e){var t=e.headerInfo.zMax,i=e.headerInfo.numDims,n=e.headerInfo.height*e.headerInfo.width,r=n*i,a=0,o=0,s=0,c=e.pixels.resultMask;if(c)if(i>1)for(a=0;a<i;a++)for(s=a*n,o=0;o<n;o++)c[o]&&(e.pixels.resultPixels[s+o]=t);else for(o=0;o<n;o++)c[o]&&(e.pixels.resultPixels[o]=t);else if(e.pixels.resultPixels.fill)e.pixels.resultPixels.fill(t);else for(o=0;o<r;o++)e.pixels.resultPixels[o]=t},getDataTypeArray:function(e){var t;switch(e){case 0:t=Int8Array;break;case 1:t=Uint8Array;break;case 2:t=Int16Array;break;case 3:t=Uint16Array;break;case 4:t=Int32Array;break;case 5:t=Uint32Array;break;case 6:t=Float32Array;break;case 7:t=Float64Array;break;default:t=Float32Array}return t},getPixelType:function(e){var t;switch(e){case 0:t="S8";break;case 1:t="U8";break;case 2:t="S16";break;case 3:t="U16";break;case 4:t="S32";break;case 5:t="U32";break;case 6:t="F32";break;case 7:t="F64";break;default:t="F32"}return t},isValidPixelValue:function(e,t){if(null===t)return!1;var i;switch(e){case 0:i=t>=-128&&t<=127;break;case 1:i=t>=0&&t<=255;break;case 2:i=t>=-32768&&t<=32767;break;case 3:i=t>=0&&t<=65536;break;case 4:i=t>=-2147483648&&t<=2147483647;break;case 5:i=t>=0&&t<=4294967296;break;case 6:i=t>=-34027999387901484e22&&t<=34027999387901484e22;break;case 7:i=t>=5e-324&&t<=17976931348623157e292;break;default:i=!1}return i},getDataTypeSize:function(e){var t=0;switch(e){case 0:case 1:t=1;break;case 2:case 3:t=2;break;case 4:case 5:case 6:t=4;break;case 7:t=8;break;default:t=e}return t},getDataTypeUsed:function(e,t){var i=e;switch(e){case 2:case 4:i=e-t;break;case 3:case 5:i=e-2*t;break;case 6:i=0===t?e:1===t?2:1;break;case 7:i=0===t?e:e-2*t+1;break;default:i=e}return i},getOnePixel:function(e,t,i,n){var r=0;switch(i){case 0:r=n.getInt8(t);break;case 1:r=n.getUint8(t);break;case 2:r=n.getInt16(t,!0);break;case 3:r=n.getUint16(t,!0);break;case 4:r=n.getInt32(t,!0);break;case 5:r=n.getUInt32(t,!0);break;case 6:r=n.getFloat32(t,!0);break;case 7:r=n.getFloat64(t,!0);break;default:throw"the decoder does not understand this pixel type"}return r}},f=function(e,t,i){this.val=e,this.left=t,this.right=i},{decode:function(e,t){var i=(t=t||{}).noDataValue,n=0,r={};if(r.ptr=t.inputOffset||0,r.pixels={},d.readHeaderInfo(e,r)){var a=r.headerInfo,o=a.fileVersion,s=d.getDataTypeArray(a.imageType);d.readMask(e,r),a.numValidPixel===a.width*a.height||r.pixels.resultMask||(r.pixels.resultMask=t.maskData);var c,l=a.width*a.height;if(r.pixels.resultPixels=new s(l*a.numDims),r.counter={onesweep:0,uncompressed:0,lut:0,bitstuffer:0,constant:0,constantoffset:0},0!==a.numValidPixel)if(a.zMax===a.zMin)d.constructConstantSurface(r);else if(o>=4&&d.checkMinMaxRanges(e,r))d.constructConstantSurface(r);else{var u=new DataView(e,r.ptr,2),h=u.getUint8(0);if(r.ptr++,h)d.readDataOneSweep(e,r,s);else if(o>1&&a.imageType<=1&&Math.abs(a.maxZError-.5)<1e-5){var f=u.getUint8(1);if(r.ptr++,r.encodeMode=f,f>2||o<4&&f>1)throw"Invalid Huffman flag "+f;f?d.readHuffman(e,r,s):d.readTiles(e,r,s)}else d.readTiles(e,r,s)}r.eofOffset=r.ptr,t.inputOffset?(c=r.headerInfo.blobSize+t.inputOffset-r.ptr,Math.abs(c)>=1&&(r.eofOffset=t.inputOffset+r.headerInfo.blobSize)):(c=r.headerInfo.blobSize-r.ptr,Math.abs(c)>=1&&(r.eofOffset=r.headerInfo.blobSize));var p={width:a.width,height:a.height,pixelData:r.pixels.resultPixels,minValue:a.zMin,maxValue:a.zMax,validPixelCount:a.numValidPixel,dimCount:a.numDims,dimStats:{minValues:a.minValues,maxValues:a.maxValues},maskData:r.pixels.resultMask};if(r.pixels.resultMask&&d.isValidPixelValue(a.imageType,i)){var m=r.pixels.resultMask;for(n=0;n<l;n++)m[n]||(p.pixelData[n]=i);p.noDataValue=i}return r.noDataValue=i,t.returnFileInfo&&(p.fileInfo=d.formatFileInfo(r)),p}},getBandCount:function(e){for(var t=0,i=0,n={ptr:0,pixels:{}};i<e.byteLength-58;)d.readHeaderInfo(e,n),i+=n.headerInfo.blobSize,t++,n.ptr=i;return t}}),_=function(){var e=new ArrayBuffer(4),t=new Uint8Array(e);return new Uint32Array(e)[0]=1,1===t[0]}(),g={decode:function(e,t){if(!_)throw"Big endian system is not supported.";var i,n,r=(t=t||{}).inputOffset||0,a=new Uint8Array(e,r,10),o=String.fromCharCode.apply(null,a);if("CntZImage"===o.trim())i=p,n=1;else{if("Lerc2"!==o.substring(0,5))throw"Unexpected file identifier string: "+o;i=m,n=2}for(var s,c,l,u,h,d,f=0,g=e.byteLength-10,v=[],b={width:0,height:0,pixels:[],pixelType:t.pixelType,mask:null,statistics:[]};r<g;){var y=i.decode(e,{inputOffset:r,encodedMaskData:s,maskData:l,returnMask:0===f,returnEncodedMask:0===f,returnFileInfo:!0,pixelType:t.pixelType||null,noDataValue:t.noDataValue||null});r=y.fileInfo.eofOffset,0===f&&(s=y.encodedMaskData,l=y.maskData,b.width=y.width,b.height=y.height,b.dimCount=y.dimCount||1,b.pixelType=y.pixelType||y.fileInfo.pixelType,b.mask=y.maskData),n>1&&y.fileInfo.mask&&y.fileInfo.mask.numBytes>0&&v.push(y.maskData),f++,b.pixels.push(y.pixelData),b.statistics.push({minValue:y.minValue,maxValue:y.maxValue,noDataValue:y.noDataValue,dimStats:y.dimStats})}if(n>1&&v.length>1){for(d=b.width*b.height,b.bandMasks=v,(l=new Uint8Array(d)).set(v[0]),u=1;u<v.length;u++)for(c=v[u],h=0;h<d;h++)l[h]=l[h]&c[h];b.maskData=l}return b}};jxe.Lerc=g}();var Mxe=jxe.Lerc,Rxe={};
/*! NoSleep.js v0.9.0 - git.io/vfn01 - Rich Tibbett - MIT license */
!function(e,t){e.NoSleep=t()}(Rxe,(function(){return function(e){var t={};function i(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}return i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=0)}([function(e,t,i){var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}();var r=i(1),a=r.webm,o=r.mp4,s="undefined"!=typeof navigator&&parseFloat((""+(/CPU.*OS ([0-9_]{3,4})[0-9_]{0,1}|(CPU like).*AppleWebKit.*Mobile/i.exec(navigator.userAgent)||[0,""])[1]).replace("undefined","3_2").replace("_",".").replace("_",""))<10&&!window.MSStream,c=function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),s?this.noSleepTimer=null:(this.noSleepVideo=document.createElement("video"),this.noSleepVideo.setAttribute("muted",""),this.noSleepVideo.setAttribute("title","No Sleep"),this.noSleepVideo.setAttribute("playsinline",""),this._addSourceToVideo(this.noSleepVideo,"webm",a),this._addSourceToVideo(this.noSleepVideo,"mp4",o),this.noSleepVideo.addEventListener("loadedmetadata",(function(){t.noSleepVideo.duration<=1?t.noSleepVideo.setAttribute("loop",""):t.noSleepVideo.addEventListener("timeupdate",(function(){t.noSleepVideo.currentTime>.5&&(t.noSleepVideo.currentTime=Math.random())}))})))}return n(e,[{key:"_addSourceToVideo",value:function(e,t,i){var n=document.createElement("source");n.src=i,n.type="video/"+t,e.appendChild(n)}},{key:"enable",value:function(){s?(this.disable(),console.warn("\n        NoSleep enabled for older iOS devices. This can interrupt\n        active or long-running network requests from completing successfully.\n        See https://github.com/richtr/NoSleep.js/issues/15 for more details.\n      "),this.noSleepTimer=window.setInterval((function(){document.hidden||(window.location.href=window.location.href.split("#")[0],window.setTimeout(window.stop,0))}),15e3)):this.noSleepVideo.play()}},{key:"disable",value:function(){s?this.noSleepTimer&&(console.warn("\n          NoSleep now disabled for older iOS devices.\n        "),window.clearInterval(this.noSleepTimer),this.noSleepTimer=null):this.noSleepVideo.pause()}}]),e}();e.exports=c},function(e,t,i){e.exports={webm:"data:video/webm;base64,GkXfo0AgQoaBAUL3gQFC8oEEQvOBCEKCQAR3ZWJtQoeBAkKFgQIYU4BnQI0VSalmQCgq17FAAw9CQE2AQAZ3aGFtbXlXQUAGd2hhbW15RIlACECPQAAAAAAAFlSua0AxrkAu14EBY8WBAZyBACK1nEADdW5khkAFVl9WUDglhohAA1ZQOIOBAeBABrCBCLqBCB9DtnVAIueBAKNAHIEAAIAwAQCdASoIAAgAAUAmJaQAA3AA/vz0AAA=",mp4:"data:video/mp4;base64,AAAAIGZ0eXBtcDQyAAACAGlzb21pc28yYXZjMW1wNDEAAAAIZnJlZQAACKBtZGF0AAAC8wYF///v3EXpvebZSLeWLNgg2SPu73gyNjQgLSBjb3JlIDE0MiByMjQ3OSBkZDc5YTYxIC0gSC4yNjQvTVBFRy00IEFWQyBjb2RlYyAtIENvcHlsZWZ0IDIwMDMtMjAxNCAtIGh0dHA6Ly93d3cudmlkZW9sYW4ub3JnL3gyNjQuaHRtbCAtIG9wdGlvbnM6IGNhYmFjPTEgcmVmPTEgZGVibG9jaz0xOjA6MCBhbmFseXNlPTB4MToweDExMSBtZT1oZXggc3VibWU9MiBwc3k9MSBwc3lfcmQ9MS4wMDowLjAwIG1peGVkX3JlZj0wIG1lX3JhbmdlPTE2IGNocm9tYV9tZT0xIHRyZWxsaXM9MCA4eDhkY3Q9MCBjcW09MCBkZWFkem9uZT0yMSwxMSBmYXN0X3Bza2lwPTEgY2hyb21hX3FwX29mZnNldD0wIHRocmVhZHM9NiBsb29rYWhlYWRfdGhyZWFkcz0xIHNsaWNlZF90aHJlYWRzPTAgbnI9MCBkZWNpbWF0ZT0xIGludGVybGFjZWQ9MCBibHVyYXlfY29tcGF0PTAgY29uc3RyYWluZWRfaW50cmE9MCBiZnJhbWVzPTMgYl9weXJhbWlkPTIgYl9hZGFwdD0xIGJfYmlhcz0wIGRpcmVjdD0xIHdlaWdodGI9MSBvcGVuX2dvcD0wIHdlaWdodHA9MSBrZXlpbnQ9MzAwIGtleWludF9taW49MzAgc2NlbmVjdXQ9NDAgaW50cmFfcmVmcmVzaD0wIHJjX2xvb2thaGVhZD0xMCByYz1jcmYgbWJ0cmVlPTEgY3JmPTIwLjAgcWNvbXA9MC42MCBxcG1pbj0wIHFwbWF4PTY5IHFwc3RlcD00IHZidl9tYXhyYXRlPTIwMDAwIHZidl9idWZzaXplPTI1MDAwIGNyZl9tYXg9MC4wIG5hbF9ocmQ9bm9uZSBmaWxsZXI9MCBpcF9yYXRpbz0xLjQwIGFxPTE6MS4wMACAAAAAOWWIhAA3//p+C7v8tDDSTjf97w55i3SbRPO4ZY+hkjD5hbkAkL3zpJ6h/LR1CAABzgB1kqqzUorlhQAAAAxBmiQYhn/+qZYADLgAAAAJQZ5CQhX/AAj5IQADQGgcIQADQGgcAAAACQGeYUQn/wALKCEAA0BoHAAAAAkBnmNEJ/8ACykhAANAaBwhAANAaBwAAAANQZpoNExDP/6plgAMuSEAA0BoHAAAAAtBnoZFESwr/wAI+SEAA0BoHCEAA0BoHAAAAAkBnqVEJ/8ACykhAANAaBwAAAAJAZ6nRCf/AAsoIQADQGgcIQADQGgcAAAADUGarDRMQz/+qZYADLghAANAaBwAAAALQZ7KRRUsK/8ACPkhAANAaBwAAAAJAZ7pRCf/AAsoIQADQGgcIQADQGgcAAAACQGe60Qn/wALKCEAA0BoHAAAAA1BmvA0TEM//qmWAAy5IQADQGgcIQADQGgcAAAAC0GfDkUVLCv/AAj5IQADQGgcAAAACQGfLUQn/wALKSEAA0BoHCEAA0BoHAAAAAkBny9EJ/8ACyghAANAaBwAAAANQZs0NExDP/6plgAMuCEAA0BoHAAAAAtBn1JFFSwr/wAI+SEAA0BoHCEAA0BoHAAAAAkBn3FEJ/8ACyghAANAaBwAAAAJAZ9zRCf/AAsoIQADQGgcIQADQGgcAAAADUGbeDRMQz/+qZYADLkhAANAaBwAAAALQZ+WRRUsK/8ACPghAANAaBwhAANAaBwAAAAJAZ+1RCf/AAspIQADQGgcAAAACQGft0Qn/wALKSEAA0BoHCEAA0BoHAAAAA1Bm7w0TEM//qmWAAy4IQADQGgcAAAAC0Gf2kUVLCv/AAj5IQADQGgcAAAACQGf+UQn/wALKCEAA0BoHCEAA0BoHAAAAAkBn/tEJ/8ACykhAANAaBwAAAANQZvgNExDP/6plgAMuSEAA0BoHCEAA0BoHAAAAAtBnh5FFSwr/wAI+CEAA0BoHAAAAAkBnj1EJ/8ACyghAANAaBwhAANAaBwAAAAJAZ4/RCf/AAspIQADQGgcAAAADUGaJDRMQz/+qZYADLghAANAaBwAAAALQZ5CRRUsK/8ACPkhAANAaBwhAANAaBwAAAAJAZ5hRCf/AAsoIQADQGgcAAAACQGeY0Qn/wALKSEAA0BoHCEAA0BoHAAAAA1Bmmg0TEM//qmWAAy5IQADQGgcAAAAC0GehkUVLCv/AAj5IQADQGgcIQADQGgcAAAACQGepUQn/wALKSEAA0BoHAAAAAkBnqdEJ/8ACyghAANAaBwAAAANQZqsNExDP/6plgAMuCEAA0BoHCEAA0BoHAAAAAtBnspFFSwr/wAI+SEAA0BoHAAAAAkBnulEJ/8ACyghAANAaBwhAANAaBwAAAAJAZ7rRCf/AAsoIQADQGgcAAAADUGa8DRMQz/+qZYADLkhAANAaBwhAANAaBwAAAALQZ8ORRUsK/8ACPkhAANAaBwAAAAJAZ8tRCf/AAspIQADQGgcIQADQGgcAAAACQGfL0Qn/wALKCEAA0BoHAAAAA1BmzQ0TEM//qmWAAy4IQADQGgcAAAAC0GfUkUVLCv/AAj5IQADQGgcIQADQGgcAAAACQGfcUQn/wALKCEAA0BoHAAAAAkBn3NEJ/8ACyghAANAaBwhAANAaBwAAAANQZt4NExC//6plgAMuSEAA0BoHAAAAAtBn5ZFFSwr/wAI+CEAA0BoHCEAA0BoHAAAAAkBn7VEJ/8ACykhAANAaBwAAAAJAZ+3RCf/AAspIQADQGgcAAAADUGbuzRMQn/+nhAAYsAhAANAaBwhAANAaBwAAAAJQZ/aQhP/AAspIQADQGgcAAAACQGf+UQn/wALKCEAA0BoHCEAA0BoHCEAA0BoHCEAA0BoHCEAA0BoHCEAA0BoHAAACiFtb292AAAAbG12aGQAAAAA1YCCX9WAgl8AAAPoAAAH/AABAAABAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAGGlvZHMAAAAAEICAgAcAT////v7/AAAF+XRyYWsAAABcdGtoZAAAAAPVgIJf1YCCXwAAAAEAAAAAAAAH0AAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAygAAAMoAAAAAACRlZHRzAAAAHGVsc3QAAAAAAAAAAQAAB9AAABdwAAEAAAAABXFtZGlhAAAAIG1kaGQAAAAA1YCCX9WAgl8AAV+QAAK/IFXEAAAAAAAtaGRscgAAAAAAAAAAdmlkZQAAAAAAAAAAAAAAAFZpZGVvSGFuZGxlcgAAAAUcbWluZgAAABR2bWhkAAAAAQAAAAAAAAAAAAAAJGRpbmYAAAAcZHJlZgAAAAAAAAABAAAADHVybCAAAAABAAAE3HN0YmwAAACYc3RzZAAAAAAAAAABAAAAiGF2YzEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAygDKAEgAAABIAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAY//8AAAAyYXZjQwFNQCj/4QAbZ01AKOyho3ySTUBAQFAAAAMAEAAr8gDxgxlgAQAEaO+G8gAAABhzdHRzAAAAAAAAAAEAAAA8AAALuAAAABRzdHNzAAAAAAAAAAEAAAABAAAB8GN0dHMAAAAAAAAAPAAAAAEAABdwAAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAAC7gAAAAAQAAF3AAAAABAAAAAAAAABxzdHNjAAAAAAAAAAEAAAABAAAAAQAAAAEAAAEEc3RzegAAAAAAAAAAAAAAPAAAAzQAAAAQAAAADQAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAANAAAADQAAAQBzdGNvAAAAAAAAADwAAAAwAAADZAAAA3QAAAONAAADoAAAA7kAAAPQAAAD6wAAA/4AAAQXAAAELgAABEMAAARcAAAEbwAABIwAAAShAAAEugAABM0AAATkAAAE/wAABRIAAAUrAAAFQgAABV0AAAVwAAAFiQAABaAAAAW1AAAFzgAABeEAAAX+AAAGEwAABiwAAAY/AAAGVgAABnEAAAaEAAAGnQAABrQAAAbPAAAG4gAABvUAAAcSAAAHJwAAB0AAAAdTAAAHcAAAB4UAAAeeAAAHsQAAB8gAAAfjAAAH9gAACA8AAAgmAAAIQQAACFQAAAhnAAAIhAAACJcAAAMsdHJhawAAAFx0a2hkAAAAA9WAgl/VgIJfAAAAAgAAAAAAAAf8AAAAAAAAAAAAAAABAQAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAACsm1kaWEAAAAgbWRoZAAAAADVgIJf1YCCXwAArEQAAWAAVcQAAAAAACdoZGxyAAAAAAAAAABzb3VuAAAAAAAAAAAAAAAAU3RlcmVvAAAAAmNtaW5mAAAAEHNtaGQAAAAAAAAAAAAAACRkaW5mAAAAHGRyZWYAAAAAAAAAAQAAAAx1cmwgAAAAAQAAAidzdGJsAAAAZ3N0c2QAAAAAAAAAAQAAAFdtcDRhAAAAAAAAAAEAAAAAAAAAAAACABAAAAAArEQAAAAAADNlc2RzAAAAAAOAgIAiAAIABICAgBRAFQAAAAADDUAAAAAABYCAgAISEAaAgIABAgAAABhzdHRzAAAAAAAAAAEAAABYAAAEAAAAABxzdHNjAAAAAAAAAAEAAAABAAAAAQAAAAEAAAAUc3RzegAAAAAAAAAGAAAAWAAAAXBzdGNvAAAAAAAAAFgAAAOBAAADhwAAA5oAAAOtAAADswAAA8oAAAPfAAAD5QAAA/gAAAQLAAAEEQAABCgAAAQ9AAAEUAAABFYAAARpAAAEgAAABIYAAASbAAAErgAABLQAAATHAAAE3gAABPMAAAT5AAAFDAAABR8AAAUlAAAFPAAABVEAAAVXAAAFagAABX0AAAWDAAAFmgAABa8AAAXCAAAFyAAABdsAAAXyAAAF+AAABg0AAAYgAAAGJgAABjkAAAZQAAAGZQAABmsAAAZ+AAAGkQAABpcAAAauAAAGwwAABskAAAbcAAAG7wAABwYAAAcMAAAHIQAABzQAAAc6AAAHTQAAB2QAAAdqAAAHfwAAB5IAAAeYAAAHqwAAB8IAAAfXAAAH3QAAB/AAAAgDAAAICQAACCAAAAg1AAAIOwAACE4AAAhhAAAIeAAACH4AAAiRAAAIpAAACKoAAAiwAAAItgAACLwAAAjCAAAAFnVkdGEAAAAObmFtZVN0ZXJlbwAAAHB1ZHRhAAAAaG1ldGEAAAAAAAAAIWhkbHIAAAAAAAAAAG1kaXJhcHBsAAAAAAAAAAAAAAAAO2lsc3QAAAAzqXRvbwAAACtkYXRhAAAAAQAAAABIYW5kQnJha2UgMC4xMC4yIDIwMTUwNjExMDA="}}])}));var Lxe=Rxe.NoSleep;function Nxe(e){Object(u.a)(e)||(e=new tf),this._clock=e,this._eventHelper=new eb,this._eventHelper.add(e.onTick,this.synchronize,this),this.systemTime=Dxe.observable(Tr.now()),this.systemTime.equalityComparer=Tr.equals,this.startTime=Dxe.observable(e.startTime),this.startTime.equalityComparer=Tr.equals,this.startTime.subscribe((function(t){e.startTime=t,this.synchronize()}),this),this.stopTime=Dxe.observable(e.stopTime),this.stopTime.equalityComparer=Tr.equals,this.stopTime.subscribe((function(t){e.stopTime=t,this.synchronize()}),this),this.currentTime=Dxe.observable(e.currentTime),this.currentTime.equalityComparer=Tr.equals,this.currentTime.subscribe((function(t){e.currentTime=t,this.synchronize()}),this),this.multiplier=Dxe.observable(e.multiplier),this.multiplier.subscribe((function(t){e.multiplier=t,this.synchronize()}),this),this.clockStep=Dxe.observable(e.clockStep),this.clockStep.subscribe((function(t){e.clockStep=t,this.synchronize()}),this),this.clockRange=Dxe.observable(e.clockRange),this.clockRange.subscribe((function(t){e.clockRange=t,this.synchronize()}),this),this.canAnimate=Dxe.observable(e.canAnimate),this.canAnimate.subscribe((function(t){e.canAnimate=t,this.synchronize()}),this),this.shouldAnimate=Dxe.observable(e.shouldAnimate),this.shouldAnimate.subscribe((function(t){e.shouldAnimate=t,this.synchronize()}),this),Dxe.track(this,["systemTime","startTime","stopTime","currentTime","multiplier","clockStep","clockRange","canAnimate","shouldAnimate"])}Object(O.a)(Nxe.prototype,{clock:{get:function(){return this._clock}}}),Nxe.prototype.synchronize=function(){var e=this._clock;this.systemTime=Tr.now(),this.startTime=e.startTime,this.stopTime=e.stopTime,this.currentTime=e.currentTime,this.multiplier=e.multiplier,this.clockStep=e.clockStep,this.clockRange=e.clockRange,this.canAnimate=e.canAnimate,this.shouldAnimate=e.shouldAnimate},Nxe.prototype.isDestroyed=function(){return!1},Nxe.prototype.destroy=function(){this._eventHelper.removeAll(),rl(this)};var Fxe=Nxe;var kxe=function(){this.canExecute=void 0,this.beforeExecute=void 0,this.afterExecute=void 0,h.a.throwInstantiationError()};var Bxe=function(e,t){if(!Object(u.a)(e))throw new h.a("func is required.");t=Object(w.a)(t,!0);var i=new $o.a,n=new $o.a;function r(){if(!r.canExecute)throw new h.a("Cannot execute command, canExecute is false.");var t,a={args:arguments,cancel:!1};return i.raiseEvent(a),a.cancel||(t=e.apply(null,arguments),n.raiseEvent(t)),t}return r.canExecute=t,Dxe.track(r,["canExecute"]),Object(O.a)(r,{beforeExecute:{value:i},afterExecute:{value:n}}),r},zxe={createCheckbox:function(e,t,i){x.a.typeOf.string("labelText",e),x.a.typeOf.string("checkedBinding",t);var n=document.createElement("div"),r=document.createElement("label"),a=document.createElement("input");a.type="checkbox";var o="checked: "+t;return Object(u.a)(i)&&(o+=", enable: "+i),a.setAttribute("data-bind",o),r.appendChild(a),r.appendChild(document.createTextNode(e)),n.appendChild(r),n},createSection:function(e,t,i,n){x.a.defined("panel",e),x.a.typeOf.string("headerText",t),x.a.typeOf.string("sectionVisibleBinding",i),x.a.typeOf.string("toggleSectionVisibilityBinding",n);var r=document.createElement("div");r.className="cesium-cesiumInspector-section",r.setAttribute("data-bind",'css: { "cesium-cesiumInspector-section-collapsed": !'+i+" }"),e.appendChild(r);var a=document.createElement("h3");a.className="cesium-cesiumInspector-sectionHeader",a.appendChild(document.createTextNode(t)),a.setAttribute("data-bind","click: "+n),r.appendChild(a);var o=document.createElement("div");return o.className="cesium-cesiumInspector-sectionContent",r.appendChild(o),o}},Uxe=zxe;var Vxe=function(e,t,i,n,r){return i.call(n,e[t]),Dxe.getObservable(e,t).subscribe(i,n,r)};function Hxe(e,t){if(!Object(u.a)(e))throw new h.a("command is required.");this._command=e,t=Object(w.a)(t,w.a.EMPTY_OBJECT),this.toggled=Object(w.a)(t.toggled,!1),this.tooltip=Object(w.a)(t.tooltip,""),Dxe.track(this,["toggled","tooltip"])}Object(O.a)(Hxe.prototype,{command:{get:function(){return this._command}}});var Gxe,qxe=Hxe,Wxe="http://www.w3.org/2000/svg",Yxe="http://www.w3.org/1999/xlink",Xxe=uf.fromCssColorString("rgba(247,250,255,0.384)"),Zxe=uf.fromCssColorString("rgba(143,191,255,0.216)"),Qxe=uf.fromCssColorString("rgba(153,197,255,0.098)"),Kxe=uf.fromCssColorString("rgba(255,255,255,0.086)"),Jxe=uf.fromCssColorString("rgba(255,255,255,0.267)"),$xe=uf.fromCssColorString("rgba(255,255,255,0)"),eEe=uf.fromCssColorString("rgba(66,67,68,0.3)"),tEe=uf.fromCssColorString("rgba(0,0,0,0.5)");function iEe(e){return uf.fromCssColorString(window.getComputedStyle(e).getPropertyValue("color"))}function nEe(e){var t=document.createElementNS(Wxe,e.tagName);for(var i in e)if(e.hasOwnProperty(i)&&"tagName"!==i)if("children"===i){var n,r=e.children.length;for(n=0;n<r;++n)t.appendChild(nEe(e.children[n]))}else 0===i.indexOf("xlink:")?t.setAttributeNS(Yxe,i.substring(6),e[i]):"textContent"===i?t.textContent=e[i]:t.setAttribute(i,e[i]);return t}function rEe(e,t,i){var n=document.createElementNS(Wxe,"text");n.setAttribute("x",e),n.setAttribute("y",t),n.setAttribute("class","cesium-animation-svgText");var r=document.createElementNS(Wxe,"tspan");return r.textContent=i,n.appendChild(r),n}var aEe=new uf;function oEe(e,t){var i=t.alpha,n=1-i;return aEe.red=e.red*n+t.red*i,aEe.green=e.green*n+t.green*i,aEe.blue=e.blue*n+t.blue*i,aEe.toCssColorString()}function sEe(e,t,i){return nEe({tagName:"g",class:"cesium-animation-rectButton",transform:"translate("+e+","+t+")",children:[{tagName:"rect",class:"cesium-animation-buttonGlow",width:32,height:32,rx:2,ry:2},{tagName:"rect",class:"cesium-animation-buttonMain",width:32,height:32,rx:4,ry:4},{tagName:"use",class:"cesium-animation-buttonPath","xlink:href":i},{tagName:"title",textContent:""}]})}function cEe(e,t){this._viewModel=t,this.svgElement=e,this._enabled=void 0,this._toggled=void 0;var i=this;this._clickFunction=function(){var e=i._viewModel.command;e.canExecute&&e()},e.addEventListener("click",this._clickFunction,!0),this._subscriptions=[Vxe(t,"toggled",this.setToggled,this),Vxe(t,"tooltip",this.setTooltip,this),Vxe(t.command,"canExecute",this.setEnabled,this)]}function lEe(e,t){if(!Object(u.a)(e))throw new h.a("container is required.");if(!Object(u.a)(t))throw new h.a("viewModel is required.");e=zfe(e),this._viewModel=t,this._container=e,this._centerX=0,this._centerY=0,this._defsElement=void 0,this._svgNode=void 0,this._topG=void 0,this._lastHeight=void 0,this._lastWidth=void 0;var i=document.createElement("style");i.textContent=".cesium-animation-rectButton .cesium-animation-buttonGlow { filter: url(#animation_blurred); }.cesium-animation-rectButton .cesium-animation-buttonMain { fill: url(#animation_buttonNormal); }.cesium-animation-buttonToggled .cesium-animation-buttonMain { fill: url(#animation_buttonToggled); }.cesium-animation-rectButton:hover .cesium-animation-buttonMain { fill: url(#animation_buttonHovered); }.cesium-animation-buttonDisabled .cesium-animation-buttonMain { fill: url(#animation_buttonDisabled); }.cesium-animation-shuttleRingG .cesium-animation-shuttleRingSwoosh { fill: url(#animation_shuttleRingSwooshGradient); }.cesium-animation-shuttleRingG:hover .cesium-animation-shuttleRingSwoosh { fill: url(#animation_shuttleRingSwooshHovered); }.cesium-animation-shuttleRingPointer { fill: url(#animation_shuttleRingPointerGradient); }.cesium-animation-shuttleRingPausePointer { fill: url(#animation_shuttleRingPointerPaused); }.cesium-animation-knobOuter { fill: url(#animation_knobOuter); }.cesium-animation-knobInner { fill: url(#animation_knobInner); }",document.head.insertBefore(i,document.head.childNodes[0]);var n=document.createElement("div");n.className="cesium-animation-theme",n.innerHTML='<div class="cesium-animation-themeNormal"></div><div class="cesium-animation-themeHover"></div><div class="cesium-animation-themeSelect"></div><div class="cesium-animation-themeDisabled"></div><div class="cesium-animation-themeKnob"></div><div class="cesium-animation-themePointer"></div><div class="cesium-animation-themeSwoosh"></div><div class="cesium-animation-themeSwooshHover"></div>',this._theme=n,this._themeNormal=n.childNodes[0],this._themeHover=n.childNodes[1],this._themeSelect=n.childNodes[2],this._themeDisabled=n.childNodes[3],this._themeKnob=n.childNodes[4],this._themePointer=n.childNodes[5],this._themeSwoosh=n.childNodes[6],this._themeSwooshHover=n.childNodes[7];var r=document.createElementNS(Wxe,"svg:svg");this._svgNode=r,r.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink",Yxe);var a=document.createElementNS(Wxe,"g");this._topG=a,this._realtimeSVG=new cEe(nEe({tagName:"g",class:"cesium-animation-rectButton",transform:"translate("+3+","+4+")",children:[{tagName:"use",class:"cesium-animation-buttonGlow","xlink:href":"#animation_pathWingButton"},{tagName:"use",class:"cesium-animation-buttonMain","xlink:href":"#animation_pathWingButton"},{tagName:"use",class:"cesium-animation-buttonPath","xlink:href":"#animation_pathClock"},{tagName:"title",textContent:""}]}),t.playRealtimeViewModel),this._playReverseSVG=new cEe(sEe(44,99,"#animation_pathPlayReverse"),t.playReverseViewModel),this._playForwardSVG=new cEe(sEe(124,99,"#animation_pathPlay"),t.playForwardViewModel),this._pauseSVG=new cEe(sEe(84,99,"#animation_pathPause"),t.pauseViewModel);var o=document.createElementNS(Wxe,"g");o.appendChild(this._realtimeSVG.svgElement),o.appendChild(this._playReverseSVG.svgElement),o.appendChild(this._playForwardSVG.svgElement),o.appendChild(this._pauseSVG.svgElement);var s=nEe({tagName:"circle",class:"cesium-animation-shuttleRingBack",cx:100,cy:100,r:99});this._shuttleRingBackPanel=s;var c=nEe({tagName:"g",class:"cesium-animation-shuttleRingSwoosh",children:[{tagName:"use",transform:"translate(100,97) scale(-1,1)","xlink:href":"#animation_pathSwooshFX"},{tagName:"use",transform:"translate(100,97)","xlink:href":"#animation_pathSwooshFX"},{tagName:"line",x1:100,y1:8,x2:100,y2:22}]});this._shuttleRingSwooshG=c,this._shuttleRingPointer=nEe({tagName:"use",class:"cesium-animation-shuttleRingPointer","xlink:href":"#animation_pathPointer"});var l=nEe({tagName:"g",transform:"translate(100,100)"});this._knobOuter=nEe({tagName:"circle",class:"cesium-animation-knobOuter",cx:0,cy:0,r:71});var d=nEe({tagName:"circle",class:"cesium-animation-knobInner",cx:0,cy:0,r:61});this._knobDate=rEe(0,-24,""),this._knobTime=rEe(0,-7,""),this._knobStatus=rEe(0,-41,"");var f=nEe({tagName:"circle",class:"cesium-animation-blank",cx:0,cy:0,r:61}),p=document.createElementNS(Wxe,"g");p.setAttribute("class","cesium-animation-shuttleRingG"),e.appendChild(n),a.appendChild(p),a.appendChild(l),a.appendChild(o),p.appendChild(s),p.appendChild(c),p.appendChild(this._shuttleRingPointer),l.appendChild(this._knobOuter),l.appendChild(d),l.appendChild(this._knobDate),l.appendChild(this._knobTime),l.appendChild(this._knobStatus),l.appendChild(f),r.appendChild(a),e.appendChild(r);var m=this;function _(e){!function(e,t){var i=e._viewModel,n=i.shuttleRingDragging;if(!n||Gxe===e)if("mousedown"===t.type||n&&"mousemove"===t.type||"touchstart"===t.type&&1===t.touches.length||n&&"touchmove"===t.type&&1===t.touches.length){var r,a,o=e._centerX,s=e._centerY,c=e._svgNode.getBoundingClientRect();if("touchstart"===t.type||"touchmove"===t.type?(r=t.touches[0].clientX,a=t.touches[0].clientY):(r=t.clientX,a=t.clientY),!n&&(r>c.right||r<c.left||a<c.top||a>c.bottom))return;var l=e._shuttleRingPointer.getBoundingClientRect(),u=r-o-c.left,h=a-s-c.top,d=180*Math.atan2(h,u)/Math.PI+90;d>180&&(d-=360);var f=i.shuttleRingAngle;n||r<l.right&&r>l.left&&a>l.top&&a<l.bottom?(Gxe=e,i.shuttleRingDragging=!0,i.shuttleRingAngle=d):d<f?i.slower():d>f&&i.faster(),t.preventDefault()}else e===Gxe&&(Gxe=void 0),i.shuttleRingDragging=!1}(m,e)}this._mouseCallback=_,s.addEventListener("mousedown",_,!0),s.addEventListener("touchstart",_,!0),c.addEventListener("mousedown",_,!0),c.addEventListener("touchstart",_,!0),document.addEventListener("mousemove",_,!0),document.addEventListener("touchmove",_,!0),document.addEventListener("mouseup",_,!0),document.addEventListener("touchend",_,!0),document.addEventListener("touchcancel",_,!0),this._shuttleRingPointer.addEventListener("mousedown",_,!0),this._shuttleRingPointer.addEventListener("touchstart",_,!0),this._knobOuter.addEventListener("mousedown",_,!0),this._knobOuter.addEventListener("touchstart",_,!0);var g,v=this._knobTime.childNodes[0],b=this._knobDate.childNodes[0],y=this._knobStatus.childNodes[0];this._subscriptions=[Vxe(t.pauseViewModel,"toggled",(function(e){g!==e&&((g=e)?m._shuttleRingPointer.setAttribute("class","cesium-animation-shuttleRingPausePointer"):m._shuttleRingPointer.setAttribute("class","cesium-animation-shuttleRingPointer"))})),Vxe(t,"shuttleRingAngle",(function(e){var t,i,n;t=m._shuttleRingPointer,i=m._knobOuter,n=e,t.setAttribute("transform","translate(100,100) rotate("+n+")"),i.setAttribute("transform","rotate("+n+")")})),Vxe(t,"dateLabel",(function(e){b.textContent!==e&&(b.textContent=e)})),Vxe(t,"timeLabel",(function(e){v.textContent!==e&&(v.textContent=e)})),Vxe(t,"multiplierLabel",(function(e){y.textContent!==e&&(y.textContent=e)}))],this.applyThemeChanges(),this.resize()}cEe.prototype.destroy=function(){this.svgElement.removeEventListener("click",this._clickFunction,!0);for(var e=this._subscriptions,t=0,i=e.length;t<i;t++)e[t].dispose();rl(this)},cEe.prototype.isDestroyed=function(){return!1},cEe.prototype.setEnabled=function(e){if(this._enabled!==e){if(this._enabled=e,!e)return void this.svgElement.setAttribute("class","cesium-animation-buttonDisabled");if(this._toggled)return void this.svgElement.setAttribute("class","cesium-animation-rectButton cesium-animation-buttonToggled");this.svgElement.setAttribute("class","cesium-animation-rectButton")}},cEe.prototype.setToggled=function(e){this._toggled!==e&&(this._toggled=e,this._enabled&&(e?this.svgElement.setAttribute("class","cesium-animation-rectButton cesium-animation-buttonToggled"):this.svgElement.setAttribute("class","cesium-animation-rectButton")))},cEe.prototype.setTooltip=function(e){this.svgElement.getElementsByTagName("title")[0].textContent=e},Object(O.a)(lEe.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}}),lEe.prototype.isDestroyed=function(){return!1},lEe.prototype.destroy=function(){Object(u.a)(this._observer)&&(this._observer.disconnect(),this._observer=void 0);var e=this._mouseCallback;this._shuttleRingBackPanel.removeEventListener("mousedown",e,!0),this._shuttleRingBackPanel.removeEventListener("touchstart",e,!0),this._shuttleRingSwooshG.removeEventListener("mousedown",e,!0),this._shuttleRingSwooshG.removeEventListener("touchstart",e,!0),document.removeEventListener("mousemove",e,!0),document.removeEventListener("touchmove",e,!0),document.removeEventListener("mouseup",e,!0),document.removeEventListener("touchend",e,!0),document.removeEventListener("touchcancel",e,!0),this._shuttleRingPointer.removeEventListener("mousedown",e,!0),this._shuttleRingPointer.removeEventListener("touchstart",e,!0),this._knobOuter.removeEventListener("mousedown",e,!0),this._knobOuter.removeEventListener("touchstart",e,!0),this._container.removeChild(this._svgNode),this._container.removeChild(this._theme),this._realtimeSVG.destroy(),this._playReverseSVG.destroy(),this._playForwardSVG.destroy(),this._pauseSVG.destroy();for(var t=this._subscriptions,i=0,n=t.length;i<n;i++)t[i].dispose();return rl(this)},lEe.prototype.resize=function(){var e=this._container.clientWidth,t=this._container.clientHeight;if(e!==this._lastWidth||t!==this._lastHeight){var i=this._svgNode,n=e,r=t;0===e&&0===t?(n=200,r=132):0===e?(r=t,n=t/132*200):0===t&&(n=e,r=e/200*132);var a=n/200,o=r/132;i.style.cssText="width: "+n+"px; height: "+r+"px; position: absolute; bottom: 0; left: 0; overflow: hidden;",i.setAttribute("width",n),i.setAttribute("height",r),i.setAttribute("viewBox","0 0 "+n+" "+r),this._topG.setAttribute("transform","scale("+a+","+o+")"),this._centerX=Math.max(1,100*a),this._centerY=Math.max(1,100*o),this._lastHeight=e,this._lastWidth=t}},lEe.prototype.applyThemeChanges=function(){if(!document.body.contains(this._container)){if(Object(u.a)(this._observer))return;var e=this;return e._observer=new MutationObserver((function(){document.body.contains(e._container)&&(e._observer.disconnect(),e._observer=void 0,e.applyThemeChanges())})),void e._observer.observe(document,{childList:!0,subtree:!0})}var t=iEe(this._themeNormal),i=iEe(this._themeHover),n=iEe(this._themeSelect),r=iEe(this._themeDisabled),a=iEe(this._themeKnob),o=iEe(this._themePointer),s=iEe(this._themeSwoosh),c=iEe(this._themeSwooshHover),l=nEe({tagName:"defs",children:[{id:"animation_buttonNormal",tagName:"linearGradient",x1:"50%",y1:"0%",x2:"50%",y2:"100%",children:[{tagName:"stop",offset:"0%","stop-color":oEe(t,Xxe)},{tagName:"stop",offset:"12%","stop-color":oEe(t,Zxe)},{tagName:"stop",offset:"46%","stop-color":oEe(t,Qxe)},{tagName:"stop",offset:"81%","stop-color":oEe(t,Kxe)}]},{id:"animation_buttonHovered",tagName:"linearGradient",x1:"50%",y1:"0%",x2:"50%",y2:"100%",children:[{tagName:"stop",offset:"0%","stop-color":oEe(i,Xxe)},{tagName:"stop",offset:"12%","stop-color":oEe(i,Zxe)},{tagName:"stop",offset:"46%","stop-color":oEe(i,Qxe)},{tagName:"stop",offset:"81%","stop-color":oEe(i,Kxe)}]},{id:"animation_buttonToggled",tagName:"linearGradient",x1:"50%",y1:"0%",x2:"50%",y2:"100%",children:[{tagName:"stop",offset:"0%","stop-color":oEe(n,Xxe)},{tagName:"stop",offset:"12%","stop-color":oEe(n,Zxe)},{tagName:"stop",offset:"46%","stop-color":oEe(n,Qxe)},{tagName:"stop",offset:"81%","stop-color":oEe(n,Kxe)}]},{id:"animation_buttonDisabled",tagName:"linearGradient",x1:"50%",y1:"0%",x2:"50%",y2:"100%",children:[{tagName:"stop",offset:"0%","stop-color":oEe(r,Jxe)},{tagName:"stop",offset:"75%","stop-color":oEe(r,$xe)}]},{id:"animation_blurred",tagName:"filter",width:"200%",height:"200%",x:"-50%",y:"-50%",children:[{tagName:"feGaussianBlur",stdDeviation:4,in:"SourceGraphic"}]},{id:"animation_shuttleRingSwooshGradient",tagName:"linearGradient",x1:"50%",y1:"0%",x2:"50%",y2:"100%",children:[{tagName:"stop",offset:"0%","stop-opacity":.2,"stop-color":s.toCssColorString()},{tagName:"stop",offset:"85%","stop-opacity":.85,"stop-color":s.toCssColorString()},{tagName:"stop",offset:"95%","stop-opacity":.05,"stop-color":s.toCssColorString()}]},{id:"animation_shuttleRingSwooshHovered",tagName:"linearGradient",x1:"50%",y1:"0%",x2:"50%",y2:"100%",children:[{tagName:"stop",offset:"0%","stop-opacity":.2,"stop-color":c.toCssColorString()},{tagName:"stop",offset:"85%","stop-opacity":.85,"stop-color":c.toCssColorString()},{tagName:"stop",offset:"95%","stop-opacity":.05,"stop-color":c.toCssColorString()}]},{id:"animation_shuttleRingPointerGradient",tagName:"linearGradient",x1:"0%",y1:"50%",x2:"100%",y2:"50%",children:[{tagName:"stop",offset:"0%","stop-color":o.toCssColorString()},{tagName:"stop",offset:"40%","stop-color":o.toCssColorString()},{tagName:"stop",offset:"60%","stop-color":oEe(o,tEe)},{tagName:"stop",offset:"100%","stop-color":oEe(o,tEe)}]},{id:"animation_shuttleRingPointerPaused",tagName:"linearGradient",x1:"0%",y1:"50%",x2:"100%",y2:"50%",children:[{tagName:"stop",offset:"0%","stop-color":"#CCC"},{tagName:"stop",offset:"40%","stop-color":"#CCC"},{tagName:"stop",offset:"60%","stop-color":"#555"},{tagName:"stop",offset:"100%","stop-color":"#555"}]},{id:"animation_knobOuter",tagName:"linearGradient",x1:"20%",y1:"0%",x2:"90%",y2:"100%",children:[{tagName:"stop",offset:"5%","stop-color":oEe(a,Xxe)},{tagName:"stop",offset:"60%","stop-color":oEe(a,eEe)},{tagName:"stop",offset:"85%","stop-color":oEe(a,Zxe)}]},{id:"animation_knobInner",tagName:"linearGradient",x1:"20%",y1:"0%",x2:"90%",y2:"100%",children:[{tagName:"stop",offset:"5%","stop-color":oEe(a,eEe)},{tagName:"stop",offset:"60%","stop-color":oEe(a,Xxe)},{tagName:"stop",offset:"85%","stop-color":oEe(a,Kxe)}]},{id:"animation_pathReset",tagName:"path",transform:"translate(16,16) scale(0.85) translate(-16,-16)",d:"M24.316,5.318,9.833,13.682,9.833,5.5,5.5,5.5,5.5,25.5,9.833,25.5,9.833,17.318,24.316,25.682z"},{id:"animation_pathPause",tagName:"path",transform:"translate(16,16) scale(0.85) translate(-16,-16)",d:"M13,5.5,7.5,5.5,7.5,25.5,13,25.5zM24.5,5.5,19,5.5,19,25.5,24.5,25.5z"},{id:"animation_pathPlay",tagName:"path",transform:"translate(16,16) scale(0.85) translate(-16,-16)",d:"M6.684,25.682L24.316,15.5L6.684,5.318V25.682z"},{id:"animation_pathPlayReverse",tagName:"path",transform:"translate(16,16) scale(-0.85,0.85) translate(-16,-16)",d:"M6.684,25.682L24.316,15.5L6.684,5.318V25.682z"},{id:"animation_pathLoop",tagName:"path",transform:"translate(16,16) scale(0.85) translate(-16,-16)",d:"M24.249,15.499c-0.009,4.832-3.918,8.741-8.75,8.75c-2.515,0-4.768-1.064-6.365-2.763l2.068-1.442l-7.901-3.703l0.744,8.694l2.193-1.529c2.244,2.594,5.562,4.242,9.26,4.242c6.767,0,12.249-5.482,12.249-12.249H24.249zM15.499,6.75c2.516,0,4.769,1.065,6.367,2.764l-2.068,1.443l7.901,3.701l-0.746-8.693l-2.192,1.529c-2.245-2.594-5.562-4.245-9.262-4.245C8.734,3.25,3.25,8.734,3.249,15.499H6.75C6.758,10.668,10.668,6.758,15.499,6.75z"},{id:"animation_pathClock",tagName:"path",transform:"translate(16,16) scale(0.85) translate(-16,-15.5)",d:"M15.5,2.374C8.251,2.375,2.376,8.251,2.374,15.5C2.376,22.748,8.251,28.623,15.5,28.627c7.249-0.004,13.124-5.879,13.125-13.127C28.624,8.251,22.749,2.375,15.5,2.374zM15.5,25.623C9.909,25.615,5.385,21.09,5.375,15.5C5.385,9.909,9.909,5.384,15.5,5.374c5.59,0.01,10.115,4.535,10.124,10.125C25.615,21.09,21.091,25.615,15.5,25.623zM8.625,15.5c-0.001-0.552-0.448-0.999-1.001-1c-0.553,0-1,0.448-1,1c0,0.553,0.449,1,1,1C8.176,16.5,8.624,16.053,8.625,15.5zM8.179,18.572c-0.478,0.277-0.642,0.889-0.365,1.367c0.275,0.479,0.889,0.641,1.365,0.365c0.479-0.275,0.643-0.887,0.367-1.367C9.27,18.461,8.658,18.297,8.179,18.572zM9.18,10.696c-0.479-0.276-1.09-0.112-1.366,0.366s-0.111,1.09,0.365,1.366c0.479,0.276,1.09,0.113,1.367-0.366C9.821,11.584,9.657,10.973,9.18,10.696zM22.822,12.428c0.478-0.275,0.643-0.888,0.366-1.366c-0.275-0.478-0.89-0.642-1.366-0.366c-0.479,0.278-0.642,0.89-0.366,1.367C21.732,12.54,22.344,12.705,22.822,12.428zM12.062,21.455c-0.478-0.275-1.089-0.111-1.366,0.367c-0.275,0.479-0.111,1.09,0.366,1.365c0.478,0.277,1.091,0.111,1.365-0.365C12.704,22.344,12.54,21.732,12.062,21.455zM12.062,9.545c0.479-0.276,0.642-0.888,0.366-1.366c-0.276-0.478-0.888-0.642-1.366-0.366s-0.642,0.888-0.366,1.366C10.973,9.658,11.584,9.822,12.062,9.545zM22.823,18.572c-0.48-0.275-1.092-0.111-1.367,0.365c-0.275,0.479-0.112,1.092,0.367,1.367c0.477,0.275,1.089,0.113,1.365-0.365C23.464,19.461,23.3,18.848,22.823,18.572zM19.938,7.813c-0.477-0.276-1.091-0.111-1.365,0.366c-0.275,0.48-0.111,1.091,0.366,1.367s1.089,0.112,1.366-0.366C20.581,8.702,20.418,8.089,19.938,7.813zM23.378,14.5c-0.554,0.002-1.001,0.45-1.001,1c0.001,0.552,0.448,1,1.001,1c0.551,0,1-0.447,1-1C24.378,14.949,23.929,14.5,23.378,14.5zM15.501,6.624c-0.552,0-1,0.448-1,1l-0.466,7.343l-3.004,1.96c-0.478,0.277-0.642,0.889-0.365,1.365c0.275,0.479,0.889,0.643,1.365,0.367l3.305-1.676C15.39,16.99,15.444,17,15.501,17c0.828,0,1.5-0.671,1.5-1.5l-0.5-7.876C16.501,7.072,16.053,6.624,15.501,6.624zM15.501,22.377c-0.552,0-1,0.447-1,1s0.448,1,1,1s1-0.447,1-1S16.053,22.377,15.501,22.377zM18.939,21.455c-0.479,0.277-0.643,0.889-0.366,1.367c0.275,0.477,0.888,0.643,1.366,0.365c0.478-0.275,0.642-0.889,0.366-1.365C20.028,21.344,19.417,21.18,18.939,21.455z"},{id:"animation_pathWingButton",tagName:"path",d:"m 4.5,0.5 c -2.216,0 -4,1.784 -4,4 l 0,24 c 0,2.216 1.784,4 4,4 l 13.71875,0 C 22.478584,27.272785 27.273681,22.511272 32.5,18.25 l 0,-13.75 c 0,-2.216 -1.784,-4 -4,-4 l -24,0 z"},{id:"animation_pathPointer",tagName:"path",d:"M-15,-65,-15,-55,15,-55,15,-65,0,-95z"},{id:"animation_pathSwooshFX",tagName:"path",d:"m 85,0 c 0,16.617 -4.813944,35.356 -13.131081,48.4508 h 6.099803 c 8.317138,-13.0948 13.13322,-28.5955 13.13322,-45.2124 0,-46.94483 -38.402714,-85.00262 -85.7743869,-85.00262 -1.0218522,0 -2.0373001,0.0241 -3.0506131,0.0589 45.958443,1.59437 82.723058,35.77285 82.723058,81.70532 z"}]});Object(u.a)(this._defsElement)?this._svgNode.replaceChild(l,this._defsElement):this._svgNode.appendChild(l),this._defsElement=l};var uEe=lEe,hEe=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dEe=15,fEe=105;function pEe(e,t){return e-t}function mEe(e,t){var i=Ji(t,e,pEe);return i<0?~i:i}function _Ee(e){if(!Object(u.a)(e))throw new h.a("clockViewModel is required.");var t=this;this._clockViewModel=e,this._allShuttleRingTicks=[],this._dateFormatter=_Ee.defaultDateFormatter,this._timeFormatter=_Ee.defaultTimeFormatter,this.shuttleRingDragging=!1,this.snapToTicks=!1,Dxe.track(this,["_allShuttleRingTicks","_dateFormatter","_timeFormatter","shuttleRingDragging","snapToTicks"]),this._sortedFilteredPositiveTicks=[],this.setShuttleRingTicks(_Ee.defaultTicks),this.timeLabel=void 0,Dxe.defineProperty(this,"timeLabel",(function(){return t._timeFormatter(t._clockViewModel.currentTime,t)})),this.dateLabel=void 0,Dxe.defineProperty(this,"dateLabel",(function(){return t._dateFormatter(t._clockViewModel.currentTime,t)})),this.multiplierLabel=void 0,Dxe.defineProperty(this,"multiplierLabel",(function(){var e=t._clockViewModel;if(e.clockStep===Zd.SYSTEM_CLOCK)return"Today";var i=e.multiplier;return i%1==0?i.toFixed(0)+"x":i.toFixed(3).replace(/0{0,3}$/,"")+"x"})),this.shuttleRingAngle=void 0,Dxe.defineProperty(this,"shuttleRingAngle",{get:function(){return function(e,t,i){if(i.clockStep===Zd.SYSTEM_CLOCK)return dEe;if(Math.abs(e)<=1)return e*dEe;var n=t[t.length-1];e>n?e=n:e<-n&&(e=-n);var r,a=dEe,o=fEe;return e>0?(r=(Math.log(n)-0)/(o-a),(Math.log(e)-0)/r+a):(r=(Math.log(-t[0])-0)/(o-a),-((Math.log(Math.abs(e))-0)/r+a))}(e.multiplier,t._allShuttleRingTicks,e)},set:function(e){e=Math.max(Math.min(e,fEe),-fEe);var i=t._allShuttleRingTicks,n=t._clockViewModel;if(n.clockStep=Zd.SYSTEM_CLOCK_MULTIPLIER,Math.abs(e)!==fEe){var r=function(e,t){if(Math.abs(e)<=dEe)return e/dEe;var i,n=dEe,r=fEe;return e>0?(i=(Math.log(t[t.length-1])-0)/(r-n),Math.exp(0+i*(e-n))):(i=(Math.log(-t[0])-0)/(r-n),-Math.exp(0+i*(Math.abs(e)-n)))}(e,i);if(t.snapToTicks)r=i[mEe(r,i)];else if(0!==r){var a=Math.abs(r);if(a>100){var o=a.toFixed(0).length-2,s=Math.pow(10,o);r=Math.round(r/s)*s|0}else a>dEe?r=Math.round(r):a>1?r=+r.toFixed(1):a>0&&(r=+r.toFixed(2))}n.multiplier=r}else n.multiplier=e>0?i[i.length-1]:i[0]}}),this._canAnimate=void 0,Dxe.defineProperty(this,"_canAnimate",(function(){var e=t._clockViewModel,i=e.clockRange;if(t.shuttleRingDragging||i===Xd.UNBOUNDED)return!0;var n=e.multiplier,r=e.currentTime,a=e.startTime,o=!1;if(i===Xd.LOOP_STOP)o=Tr.greaterThan(r,a)||r.equals(a)&&n>0;else{var s=e.stopTime;o=Tr.greaterThan(r,a)&&Tr.lessThan(r,s)||r.equals(a)&&n>0||r.equals(s)&&n<0}return o||(e.shouldAnimate=!1),o})),this._isSystemTimeAvailable=void 0,Dxe.defineProperty(this,"_isSystemTimeAvailable",(function(){var e=t._clockViewModel;if(e.clockRange===Xd.UNBOUNDED)return!0;var i=e.systemTime;return Tr.greaterThanOrEquals(i,e.startTime)&&Tr.lessThanOrEquals(i,e.stopTime)})),this._isAnimating=void 0,Dxe.defineProperty(this,"_isAnimating",(function(){return t._clockViewModel.shouldAnimate&&(t._canAnimate||t.shuttleRingDragging)}));var i=Bxe((function(){var e=t._clockViewModel;e.shouldAnimate?e.shouldAnimate=!1:t._canAnimate&&(e.shouldAnimate=!0)}));this._pauseViewModel=new qxe(i,{toggled:Dxe.computed((function(){return!t._isAnimating})),tooltip:"Pause"});var n=Bxe((function(){var e=t._clockViewModel,i=e.multiplier;i>0&&(e.multiplier=-i),e.shouldAnimate=!0}));this._playReverseViewModel=new qxe(n,{toggled:Dxe.computed((function(){return t._isAnimating&&e.multiplier<0})),tooltip:"Play Reverse"});var r=Bxe((function(){var e=t._clockViewModel,i=e.multiplier;i<0&&(e.multiplier=-i),e.shouldAnimate=!0}));this._playForwardViewModel=new qxe(r,{toggled:Dxe.computed((function(){return t._isAnimating&&e.multiplier>0&&e.clockStep!==Zd.SYSTEM_CLOCK})),tooltip:"Play Forward"});var a=Bxe((function(){t._clockViewModel.clockStep=Zd.SYSTEM_CLOCK}),Dxe.getObservable(this,"_isSystemTimeAvailable"));this._playRealtimeViewModel=new qxe(a,{toggled:Dxe.computed((function(){return e.clockStep===Zd.SYSTEM_CLOCK})),tooltip:Dxe.computed((function(){return t._isSystemTimeAvailable?"Today (real-time)":"Current time not in range"}))}),this._slower=Bxe((function(){var e=t._clockViewModel,i=t._allShuttleRingTicks,n=mEe(e.multiplier,i)-1;n>=0&&(e.multiplier=i[n])})),this._faster=Bxe((function(){var e=t._clockViewModel,i=t._allShuttleRingTicks,n=mEe(e.multiplier,i)+1;n<i.length&&(e.multiplier=i[n])}))}_Ee.defaultDateFormatter=function(e,t){var i=Tr.toGregorianDate(e);return hEe[i.month-1]+" "+i.day+" "+i.year},_Ee.defaultTicks=[.001,.002,.005,.01,.02,.05,.1,.25,.5,1,2,5,10,15,30,60,120,300,600,900,1800,3600,7200,14400,21600,43200,86400,172800,345600,604800],_Ee.defaultTimeFormatter=function(e,t){var i=Tr.toGregorianDate(e),n=Math.round(i.millisecond);return Math.abs(t._clockViewModel.multiplier)<1?$n("%02d:%02d:%02d.%03d",i.hour,i.minute,i.second,n):$n("%02d:%02d:%02d UTC",i.hour,i.minute,i.second)},_Ee.prototype.getShuttleRingTicks=function(){return this._sortedFilteredPositiveTicks.slice(0)},_Ee.prototype.setShuttleRingTicks=function(e){if(!Object(u.a)(e))throw new h.a("positiveTicks is required.");var t,i,n,r={},a=this._sortedFilteredPositiveTicks;for(a.length=0,t=0,i=e.length;t<i;++t)n=e[t],r.hasOwnProperty(n)||(r[n]=!0,a.push(n));a.sort(pEe);var o=[];for(t=(i=a.length)-1;t>=0;--t)0!==(n=a[t])&&o.push(-n);Array.prototype.push.apply(o,a),this._allShuttleRingTicks=o},Object(O.a)(_Ee.prototype,{slower:{get:function(){return this._slower}},faster:{get:function(){return this._faster}},clockViewModel:{get:function(){return this._clockViewModel}},pauseViewModel:{get:function(){return this._pauseViewModel}},playReverseViewModel:{get:function(){return this._playReverseViewModel}},playForwardViewModel:{get:function(){return this._playForwardViewModel}},playRealtimeViewModel:{get:function(){return this._playRealtimeViewModel}},dateFormatter:{get:function(){return this._dateFormatter},set:function(e){if("function"!=typeof e)throw new h.a("dateFormatter must be a function");this._dateFormatter=e}},timeFormatter:{get:function(){return this._timeFormatter},set:function(e){if("function"!=typeof e)throw new h.a("timeFormatter must be a function");this._timeFormatter=e}}}),_Ee._maxShuttleRingAngle=fEe,_Ee._realtimeShuttleRingAngle=dEe;var gEe=_Ee;function vEe(e){var t=(e=Object(w.a)(e,w.a.EMPTY_OBJECT)).globe,i=Object(w.a)(e.imageryProviderViewModels,[]),n=Object(w.a)(e.terrainProviderViewModels,[]);if(!Object(u.a)(t))throw new h.a("globe is required");this._globe=t,this.imageryProviderViewModels=i.slice(0),this.terrainProviderViewModels=n.slice(0),this.dropDownVisible=!1,Dxe.track(this,["imageryProviderViewModels","terrainProviderViewModels","dropDownVisible"]);var r=Dxe.getObservable(this,"imageryProviderViewModels"),a=Dxe.pureComputed((function(){var e,t=r(),i={};for(e=0;e<t.length;e++){var n=t[e],a=n.category;Object(u.a)(i[a])?i[a].push(n):i[a]=[n]}var o=Object.keys(i),s=[];for(e=0;e<o.length;e++){var c=o[e];s.push({name:c,providers:i[c]})}return s}));this._imageryProviders=a;var o=Dxe.getObservable(this,"terrainProviderViewModels"),s=Dxe.pureComputed((function(){var e,t=o(),i={};for(e=0;e<t.length;e++){var n=t[e],r=n.category;Object(u.a)(i[r])?i[r].push(n):i[r]=[n]}var a=Object.keys(i),s=[];for(e=0;e<a.length;e++){var c=a[e];s.push({name:c,providers:i[c]})}return s}));this._terrainProviders=s,this.buttonTooltip=void 0,Dxe.defineProperty(this,"buttonTooltip",(function(){var e=this.selectedImagery,t=this.selectedTerrain,i=Object(u.a)(e)?e.name:void 0,n=Object(u.a)(t)?t.name:void 0;return Object(u.a)(i)&&Object(u.a)(n)?i+"\n"+n:Object(u.a)(i)?i:n})),this.buttonImageUrl=void 0,Dxe.defineProperty(this,"buttonImageUrl",(function(){var e=this.selectedImagery;if(Object(u.a)(e))return e.iconUrl})),this.selectedImagery=void 0;var c=Dxe.observable();this._currentImageryProviders=[],Dxe.defineProperty(this,"selectedImagery",{get:function(){return c()},set:function(e){if(c()!==e){var t,i=this._currentImageryProviders,n=i.length,r=this._globe.imageryLayers,a=!1;for(t=0;t<n;t++)for(var o=r.length,s=0;s<o;s++){var l=r.get(s);if(l.imageryProvider===i[t]){r.remove(l),a=!0;break}}if(Object(u.a)(e)){var h=e.creationCommand();if(Object(ym.a)(h)){for(t=h.length-1;t>=0;t--)r.addImageryProvider(h[t],0);this._currentImageryProviders=h.slice(0)}else if(this._currentImageryProviders=[h],a)r.addImageryProvider(h,0);else{var d=r.get(0);Object(u.a)(d)&&r.remove(d),r.addImageryProvider(h,0)}}c(e),this.dropDownVisible=!1}else this.dropDownVisible=!1}}),this.selectedTerrain=void 0;var l=Dxe.observable();Dxe.defineProperty(this,"selectedTerrain",{get:function(){return l()},set:function(e){var t;l()!==e?(Object(u.a)(e)&&(t=e.creationCommand()),this._globe.depthTestAgainstTerrain=!(t instanceof Jv),this._globe.terrainProvider=t,l(e),this.dropDownVisible=!1):this.dropDownVisible=!1}});var d=this;this._toggleDropDown=Bxe((function(){d.dropDownVisible=!d.dropDownVisible})),this.selectedImagery=Object(w.a)(e.selectedImageryProviderViewModel,i[0]),this.selectedTerrain=Object(w.a)(e.selectedTerrainProviderViewModel,n[0])}Object(O.a)(vEe.prototype,{toggleDropDown:{get:function(){return this._toggleDropDown}},globe:{get:function(){return this._globe}}});var bEe=vEe;function yEe(e,t){if(!Object(u.a)(e))throw new h.a("container is required.");e=zfe(e);var i=new bEe(t),n=document.createElement("button");n.type="button",n.className="cesium-button cesium-toolbar-button",n.setAttribute("data-bind","attr: { title: buttonTooltip },click: toggleDropDown"),e.appendChild(n);var r=document.createElement("img");r.setAttribute("draggable","false"),r.className="cesium-baseLayerPicker-selected",r.setAttribute("data-bind","attr: { src: buttonImageUrl }, visible: !!buttonImageUrl"),n.appendChild(r);var a=document.createElement("div");a.className="cesium-baseLayerPicker-dropDown",a.setAttribute("data-bind",'css: { "cesium-baseLayerPicker-dropDown-visible" : dropDownVisible }'),e.appendChild(a);var o=document.createElement("div");o.className="cesium-baseLayerPicker-sectionTitle",o.setAttribute("data-bind","visible: imageryProviderViewModels.length > 0"),o.innerHTML="Imagery",a.appendChild(o);var s=document.createElement("div");s.className="cesium-baseLayerPicker-section",s.setAttribute("data-bind","foreach: _imageryProviders"),a.appendChild(s);var c=document.createElement("div");c.className="cesium-baseLayerPicker-category",s.appendChild(c);var l=document.createElement("div");l.className="cesium-baseLayerPicker-categoryTitle",l.setAttribute("data-bind","text: name"),c.appendChild(l);var d=document.createElement("div");d.className="cesium-baseLayerPicker-choices",d.setAttribute("data-bind","foreach: providers"),c.appendChild(d);var f=document.createElement("div");f.className="cesium-baseLayerPicker-item",f.setAttribute("data-bind",'css: { "cesium-baseLayerPicker-selectedItem" : $data === $parents[1].selectedImagery },attr: { title: tooltip },visible: creationCommand.canExecute,click: function($data) { $parents[1].selectedImagery = $data; }'),d.appendChild(f);var p=document.createElement("img");p.className="cesium-baseLayerPicker-itemIcon",p.setAttribute("data-bind","attr: { src: iconUrl }"),p.setAttribute("draggable","false"),f.appendChild(p);var m=document.createElement("div");m.className="cesium-baseLayerPicker-itemLabel",m.setAttribute("data-bind","text: name"),f.appendChild(m);var _=document.createElement("div");_.className="cesium-baseLayerPicker-sectionTitle",_.setAttribute("data-bind","visible: terrainProviderViewModels.length > 0"),_.innerHTML="Terrain",a.appendChild(_);var g=document.createElement("div");g.className="cesium-baseLayerPicker-section",g.setAttribute("data-bind","foreach: _terrainProviders"),a.appendChild(g);var v=document.createElement("div");v.className="cesium-baseLayerPicker-category",g.appendChild(v);var b=document.createElement("div");b.className="cesium-baseLayerPicker-categoryTitle",b.setAttribute("data-bind","text: name"),v.appendChild(b);var y=document.createElement("div");y.className="cesium-baseLayerPicker-choices",y.setAttribute("data-bind","foreach: providers"),v.appendChild(y);var w=document.createElement("div");w.className="cesium-baseLayerPicker-item",w.setAttribute("data-bind",'css: { "cesium-baseLayerPicker-selectedItem" : $data === $parents[1].selectedTerrain },attr: { title: tooltip },visible: creationCommand.canExecute,click: function($data) { $parents[1].selectedTerrain = $data; }'),y.appendChild(w);var O=document.createElement("img");O.className="cesium-baseLayerPicker-itemIcon",O.setAttribute("data-bind","attr: { src: iconUrl }"),O.setAttribute("draggable","false"),w.appendChild(O);var x=document.createElement("div");x.className="cesium-baseLayerPicker-itemLabel",x.setAttribute("data-bind","text: name"),w.appendChild(x),Dxe.applyBindings(i,n),Dxe.applyBindings(i,a),this._viewModel=i,this._container=e,this._element=n,this._dropPanel=a,this._closeDropDown=function(e){n.contains(e.target)||a.contains(e.target)||(i.dropDownVisible=!1)},Ri.supportsPointerEvents()?document.addEventListener("pointerdown",this._closeDropDown,!0):(document.addEventListener("mousedown",this._closeDropDown,!0),document.addEventListener("touchstart",this._closeDropDown,!0))}Object(O.a)(yEe.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}}),yEe.prototype.isDestroyed=function(){return!1},yEe.prototype.destroy=function(){return Ri.supportsPointerEvents()?document.removeEventListener("pointerdown",this._closeDropDown,!0):(document.removeEventListener("mousedown",this._closeDropDown,!0),document.removeEventListener("touchstart",this._closeDropDown,!0)),Dxe.cleanNode(this._element),Dxe.cleanNode(this._dropPanel),this._container.removeChild(this._element),this._container.removeChild(this._dropPanel),rl(this)};var wEe=yEe;function OEe(e){if(!Object(u.a)(e.name))throw new h.a("options.name is required.");if(!Object(u.a)(e.tooltip))throw new h.a("options.tooltip is required.");if(!Object(u.a)(e.iconUrl))throw new h.a("options.iconUrl is required.");if("function"!=typeof e.creationFunction)throw new h.a("options.creationFunction is required.");var t=e.creationFunction;Object(u.a)(t.canExecute)||(t=Bxe(t)),this._creationCommand=t,this.name=e.name,this.tooltip=e.tooltip,this.iconUrl=e.iconUrl,this._category=Object(w.a)(e.category,""),Dxe.track(this,["name","tooltip","iconUrl"])}Object(O.a)(OEe.prototype,{creationCommand:{get:function(){return this._creationCommand}},category:{get:function(){return this._category}}});var xEe=OEe;var EEe=function(){var e=[];return e.push(new xEe({name:"Bing Maps Aerial",iconUrl:y("Widgets/Images/ImageryProviders/bingAerial.png"),tooltip:"Bing Maps aerial imagery, provided by Cesium ion",category:"Cesium ion",creationFunction:function(){return lle({style:cle.AERIAL})}})),e.push(new xEe({name:"Bing Maps Aerial with Labels",iconUrl:y("Widgets/Images/ImageryProviders/bingAerialLabels.png"),tooltip:"Bing Maps aerial imagery with labels, provided by Cesium ion",category:"Cesium ion",creationFunction:function(){return lle({style:cle.AERIAL_WITH_LABELS})}})),e.push(new xEe({name:"Bing Maps Roads",iconUrl:y("Widgets/Images/ImageryProviders/bingRoads.png"),tooltip:"Bing Maps standard road maps, provided by Cesium ion",category:"Cesium ion",creationFunction:function(){return lle({style:cle.ROAD})}})),e.push(new xEe({name:"Mapbox Satellite",tooltip:"Mapbox satellite imagery https://www.mapbox.com/maps/",iconUrl:y("Widgets/Images/ImageryProviders/mapboxSatellite.png"),category:"Other",creationFunction:function(){return new Pce({mapId:"mapbox.satellite"})}})),e.push(new xEe({name:"Mapbox Streets",tooltip:"Mapbox streets imagery https://www.mapbox.com/maps/",iconUrl:y("Widgets/Images/ImageryProviders/mapboxTerrain.png"),category:"Other",creationFunction:function(){return new Pce({mapId:"mapbox.streets"})}})),e.push(new xEe({name:"Mapbox Streets Classic",tooltip:"Mapbox streets basic imagery https://www.mapbox.com/maps/",iconUrl:y("Widgets/Images/ImageryProviders/mapboxStreets.png"),category:"Other",creationFunction:function(){return new Pce({mapId:"mapbox.streets-basic"})}})),e.push(new xEe({name:"ESRI World Imagery",iconUrl:y("Widgets/Images/ImageryProviders/esriWorldImagery.png"),tooltip:"World Imagery provides one meter or better satellite and aerial imagery in many parts of the world and lower resolution satellite imagery worldwide.  The map includes NASA Blue Marble: Next Generation 500m resolution imagery at small scales (above 1:1,000,000), i-cubed 15m eSAT imagery at medium-to-large scales (down to 1:70,000) for the world, and USGS 15m Landsat imagery for Antarctica. The map features 0.3m resolution imagery in the continental United States and 0.6m resolution imagery in parts of Western Europe from DigitalGlobe. In other parts of the world, 1 meter resolution imagery is available from GeoEye IKONOS, i-cubed Nationwide Prime, Getmapping, AeroGRID, IGN Spain, and IGP Portugal.  Additionally, imagery at different resolutions has been contributed by the GIS User Community.\nhttp://www.esri.com",category:"Other",creationFunction:function(){return new _re({url:"https://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",enablePickFeatures:!1})}})),e.push(new xEe({name:"ESRI World Street Map",iconUrl:y("Widgets/Images/ImageryProviders/esriWorldStreetMap.png"),tooltip:"This worldwide street map presents highway-level data for the world. Street-level data includes the United States; much of Canada; Japan; most countries in Europe; Australia and New Zealand; India; parts of South America including Argentina, Brazil, Chile, Colombia, and Venezuela; Ghana; and parts of southern Africa including Botswana, Lesotho, Namibia, South Africa, and Swaziland.\nhttp://www.esri.com",category:"Other",creationFunction:function(){return new _re({url:"https://services.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer",enablePickFeatures:!1})}})),e.push(new xEe({name:"ESRI National Geographic",iconUrl:y("Widgets/Images/ImageryProviders/esriNationalGeographic.png"),tooltip:"This web map contains the National Geographic World Map service. This map service is designed to be used as a general reference map for informational and educational purposes as well as a basemap by GIS professionals and other users for creating web maps and web mapping applications.\nhttp://www.esri.com",category:"Other",creationFunction:function(){return new _re({url:"https://services.arcgisonline.com/ArcGIS/rest/services/NatGeo_World_Map/MapServer/",enablePickFeatures:!1})}})),e.push(new xEe({name:"Open­Street­Map",iconUrl:y("Widgets/Images/ImageryProviders/openStreetMap.png"),tooltip:"OpenStreetMap (OSM) is a collaborative project to create a free editable map of the world.\nhttp://www.openstreetmap.org",category:"Other",creationFunction:function(){return wce({url:"https://a.tile.openstreetmap.org/"})}})),e.push(new xEe({name:"Stamen Watercolor",iconUrl:y("Widgets/Images/ImageryProviders/stamenWatercolor.png"),tooltip:"Reminiscent of hand drawn maps, Stamen watercolor maps apply raster effect area washes and organic edges over a paper texture to add warm pop to any map.\nhttp://maps.stamen.com",category:"Other",creationFunction:function(){return wce({url:"https://stamen-tiles.a.ssl.fastly.net/watercolor/",credit:"Map tiles by Stamen Design, under CC BY 3.0. Data by OpenStreetMap, under CC BY SA."})}})),e.push(new xEe({name:"Stamen Toner",iconUrl:y("Widgets/Images/ImageryProviders/stamenToner.png"),tooltip:"A high contrast black and white map.\nhttp://maps.stamen.com",category:"Other",creationFunction:function(){return wce({url:"https://stamen-tiles.a.ssl.fastly.net/toner/",credit:"Map tiles by Stamen Design, under CC BY 3.0. Data by OpenStreetMap, under CC BY SA."})}})),e.push(new xEe({name:"Sentinel-2",iconUrl:y("Widgets/Images/ImageryProviders/sentinel-2.png"),tooltip:"Sentinel-2 cloudless by EOX IT Services GmbH (Contains modified Copernicus Sentinel data 2016 and 2017).",category:"Cesium ion",creationFunction:function(){return new sle({assetId:3954})}})),e.push(new xEe({name:"Blue Marble",iconUrl:y("Widgets/Images/ImageryProviders/blueMarble.png"),tooltip:"Blue Marble Next Generation July, 2004 imagery from NASA.",category:"Cesium ion",creationFunction:function(){return new sle({assetId:3845})}})),e.push(new xEe({name:"Earth at night",iconUrl:y("Widgets/Images/ImageryProviders/earthAtNight.png"),tooltip:"The Earth at night, also known as The Black Marble, is a 500 meter resolution global composite imagery layer released by NASA.",category:"Cesium ion",creationFunction:function(){return new sle({assetId:3812})}})),e.push(new xEe({name:"Natural Earth II",iconUrl:y("Widgets/Images/ImageryProviders/naturalEarthII.png"),tooltip:"Natural Earth II, darkened for contrast.\nhttp://www.naturalearthdata.com/",category:"Cesium ion",creationFunction:function(){return xce({url:y("Assets/Textures/NaturalEarthII")})}})),e};var TEe=function(){var e=[];return e.push(new xEe({name:"WGS84 Ellipsoid",iconUrl:y("Widgets/Images/TerrainProviders/Ellipsoid.png"),tooltip:"WGS84 standard ellipsoid, also known as EPSG:4326",category:"Cesium ion",creationFunction:function(){return new Jv}})),e.push(new xEe({name:"Cesium World Terrain",iconUrl:y("Widgets/Images/TerrainProviders/CesiumWorldTerrain.png"),tooltip:"High-resolution global terrain tileset curated from several datasources and hosted by Cesium ion",category:"Cesium ion",creationFunction:function(){return zg({requestWaterMask:!0,requestVertexNormals:!0})}})),e};function CEe(e,t){t?e._eventHandler.setInputAction((function(t){var i=e._scene.pick(t.endPosition);Object(u.a)(i)&&i.primitive instanceof zse&&(e.tileset=i.primitive)}),TS.MOUSE_MOVE):(e._eventHandler.removeInputAction(TS.MOUSE_MOVE),e.picking=e.picking)}var SEe={maximumFractionDigits:3};function AEe(e){var t=e/1048576;return t<1?t.toLocaleString(void 0,SEe):Math.round(t).toLocaleString()}function PEe(e,t){if(!Object(u.a)(e))return"";var i=t?e._statisticsLastPick:e._statisticsLastRender,n='<ul class="cesium-cesiumInspector-statistics">';return n+="<li><strong>Visited: </strong>"+i.visited.toLocaleString()+"</li><li><strong>Selected: </strong>"+i.selected.toLocaleString()+"</li><li><strong>Commands: </strong>"+i.numberOfCommands.toLocaleString()+"</li>",n+="</ul>",t||(n+='<ul class="cesium-cesiumInspector-statistics">',n+="<li><strong>Requests: </strong>"+i.numberOfPendingRequests.toLocaleString()+"</li><li><strong>Attempted: </strong>"+i.numberOfAttemptedRequests.toLocaleString()+"</li><li><strong>Processing: </strong>"+i.numberOfTilesProcessing.toLocaleString()+"</li><li><strong>Content Ready: </strong>"+i.numberOfTilesWithContentReady.toLocaleString()+"</li><li><strong>Total: </strong>"+i.numberOfTilesTotal.toLocaleString()+"</li>",n+="</ul>",n+='<ul class="cesium-cesiumInspector-statistics">',n+="<li><strong>Features Selected: </strong>"+i.numberOfFeaturesSelected.toLocaleString()+"</li><li><strong>Features Loaded: </strong>"+i.numberOfFeaturesLoaded.toLocaleString()+"</li><li><strong>Points Selected: </strong>"+i.numberOfPointsSelected.toLocaleString()+"</li><li><strong>Points Loaded: </strong>"+i.numberOfPointsLoaded.toLocaleString()+"</li><li><strong>Triangles Selected: </strong>"+i.numberOfTrianglesSelected.toLocaleString()+"</li>",n+="</ul>",n+='<ul class="cesium-cesiumInspector-statistics">',n+="<li><strong>Tiles styled: </strong>"+i.numberOfTilesStyled.toLocaleString()+"</li><li><strong>Features styled: </strong>"+i.numberOfFeaturesStyled.toLocaleString()+"</li>",n+="</ul>",n+='<ul class="cesium-cesiumInspector-statistics">',n+="<li><strong>Children Union Culled: </strong>"+i.numberOfTilesCulledWithChildrenUnion.toLocaleString()+"</li>",n+="</ul>",n+='<ul class="cesium-cesiumInspector-statistics">',n+="<li><strong>Geometry Memory (MB): </strong>"+AEe(i.geometryByteLength)+"</li><li><strong>Texture Memory (MB): </strong>"+AEe(i.texturesByteLength)+"</li><li><strong>Batch Table Memory (MB): </strong>"+AEe(i.batchTableByteLength)+"</li>",n+="</ul>"),n}var IEe=[{text:"Highlight",value:gX.HIGHLIGHT},{text:"Replace",value:gX.REPLACE},{text:"Mix",value:gX.MIX}],DEe=new uf(1,1,0,.4),jEe=new uf,MEe=new uf;function REe(e,t){x.a.typeOf.object("scene",e),x.a.typeOf.object("performanceContainer",t);var i=this,n=e.canvas;this._eventHandler=new aA(n),this._scene=e,this._performanceContainer=t,this._canvas=n,this._performanceDisplay=new Vfe({container:t}),this._statisticsText="",this._pickStatisticsText="",this._editorError="",this.performance=!1,this.showStatistics=!0,this.showPickStatistics=!0,this.inspectorVisible=!0,this.tilesetVisible=!1,this.displayVisible=!1,this.updateVisible=!1,this.loggingVisible=!1,this.styleVisible=!1,this.tileDebugLabelsVisible=!1,this.optimizationVisible=!1,this.styleString="{}",this._tileset=void 0,this._feature=void 0,this._tile=void 0,Dxe.track(this,["performance","inspectorVisible","_statisticsText","_pickStatisticsText","_editorError","showPickStatistics","showStatistics","tilesetVisible","displayVisible","updateVisible","loggingVisible","styleVisible","optimizationVisible","tileDebugLabelsVisible","styleString","_feature","_tile"]),this._properties=Dxe.observable({}),this.properties=[],Dxe.defineProperty(this,"properties",(function(){var e=[],t=i._properties();for(var n in t)t.hasOwnProperty(n)&&e.push(n);return e}));var r=Dxe.observable();Dxe.defineProperty(this,"dynamicScreenSpaceError",{get:function(){return r()},set:function(e){r(e),Object(u.a)(i._tileset)&&(i._tileset.dynamicScreenSpaceError=e)}}),this.dynamicScreenSpaceError=!1;var a=Dxe.observable();Dxe.defineProperty(this,"colorBlendMode",{get:function(){return a()},set:function(e){a(e),Object(u.a)(i._tileset)&&(i._tileset.colorBlendMode=e,i._scene.requestRender())}}),this.colorBlendMode=gX.HIGHLIGHT;var o=Dxe.observable();Dxe.defineProperty(this,"picking",{get:function(){return o()},set:function(t){o(t),t?i._eventHandler.setInputAction((function(t){var n=e.pick(t.endPosition);if(n instanceof KX?(i.feature=n,i.tile=n.content.tile):Object(u.a)(n)&&Object(u.a)(n.content)?(i.feature=void 0,i.tile=n.content.tile):(i.feature=void 0,i.tile=void 0),Object(u.a)(i._tileset)){var r;if(p&&Object(u.a)(n)&&Object(u.a)(n.content))e.pickPositionSupported&&(r=e.pickPosition(t.endPosition),Object(u.a)(r)&&(i._tileset.debugPickPosition=r)),i._tileset.debugPickedTile=n.content.tile;else i._tileset.debugPickedTile=void 0;i._scene.requestRender()}}),TS.MOUSE_MOVE):(i.feature=void 0,i.tile=void 0,i._eventHandler.removeInputAction(TS.MOUSE_MOVE))}}),this.picking=!0;var s=Dxe.observable();Dxe.defineProperty(this,"colorize",{get:function(){return s()},set:function(e){s(e),Object(u.a)(i._tileset)&&(i._tileset.debugColorizeTiles=e,i._scene.requestRender())}}),this.colorize=!1;var c=Dxe.observable();Dxe.defineProperty(this,"wireframe",{get:function(){return c()},set:function(e){c(e),Object(u.a)(i._tileset)&&(i._tileset.debugWireframe=e,i._scene.requestRender())}}),this.wireframe=!1;var l=Dxe.observable();Dxe.defineProperty(this,"showBoundingVolumes",{get:function(){return l()},set:function(e){l(e),Object(u.a)(i._tileset)&&(i._tileset.debugShowBoundingVolume=e,i._scene.requestRender())}}),this.showBoundingVolumes=!1;var h=Dxe.observable();Dxe.defineProperty(this,"showContentBoundingVolumes",{get:function(){return h()},set:function(e){h(e),Object(u.a)(i._tileset)&&(i._tileset.debugShowContentBoundingVolume=e,i._scene.requestRender())}}),this.showContentBoundingVolumes=!1;var d=Dxe.observable();Dxe.defineProperty(this,"showRequestVolumes",{get:function(){return d()},set:function(e){d(e),Object(u.a)(i._tileset)&&(i._tileset.debugShowViewerRequestVolume=e,i._scene.requestRender())}}),this.showRequestVolumes=!1;var f=Dxe.observable();Dxe.defineProperty(this,"freezeFrame",{get:function(){return f()},set:function(e){f(e),Object(u.a)(i._tileset)&&(i._tileset.debugFreezeFrame=e,i._scene.debugShowFrustumPlanes=e,i._scene.requestRender())}}),this.freezeFrame=!1;var p=Dxe.observable();Dxe.defineProperty(this,"showOnlyPickedTileDebugLabel",{get:function(){return p()},set:function(e){p(e),Object(u.a)(i._tileset)&&(i._tileset.debugPickedTileLabelOnly=e,i._scene.requestRender())}}),this.showOnlyPickedTileDebugLabel=!1;var m=Dxe.observable();Dxe.defineProperty(this,"showGeometricError",{get:function(){return m()},set:function(e){m(e),Object(u.a)(i._tileset)&&(i._tileset.debugShowGeometricError=e,i._scene.requestRender())}}),this.showGeometricError=!1;var _=Dxe.observable();Dxe.defineProperty(this,"showRenderingStatistics",{get:function(){return _()},set:function(e){_(e),Object(u.a)(i._tileset)&&(i._tileset.debugShowRenderingStatistics=e,i._scene.requestRender())}}),this.showRenderingStatistics=!1;var g=Dxe.observable();Dxe.defineProperty(this,"showMemoryUsage",{get:function(){return g()},set:function(e){g(e),Object(u.a)(i._tileset)&&(i._tileset.debugShowMemoryUsage=e,i._scene.requestRender())}}),this.showMemoryUsage=!1;var v=Dxe.observable();Dxe.defineProperty(this,"showUrl",{get:function(){return v()},set:function(e){v(e),Object(u.a)(i._tileset)&&(i._tileset.debugShowUrl=e,i._scene.requestRender())}}),this.showUrl=!1;var b=Dxe.observable();Dxe.defineProperty(this,"maximumScreenSpaceError",{get:function(){return b()},set:function(e){e=Number(e),isNaN(e)||(b(e),Object(u.a)(i._tileset)&&(i._tileset.maximumScreenSpaceError=e))}}),this.maximumScreenSpaceError=16;var y=Dxe.observable();Dxe.defineProperty(this,"dynamicScreenSpaceErrorDensity",{get:function(){return y()},set:function(e){e=Number(e),isNaN(e)||(y(e),Object(u.a)(i._tileset)&&(i._tileset.dynamicScreenSpaceErrorDensity=e))}}),this.dynamicScreenSpaceErrorDensity=.00278,this.dynamicScreenSpaceErrorDensitySliderValue=void 0,Dxe.defineProperty(this,"dynamicScreenSpaceErrorDensitySliderValue",{get:function(){return Math.pow(y(),1/6)},set:function(e){y(Math.pow(e,6))}});var w=Dxe.observable();Dxe.defineProperty(this,"dynamicScreenSpaceErrorFactor",{get:function(){return w()},set:function(e){e=Number(e),isNaN(e)||(w(e),Object(u.a)(i._tileset)&&(i._tileset.dynamicScreenSpaceErrorFactor=e))}}),this.dynamicScreenSpaceErrorFactor=4;var O,E=(O=this,function(e){var t=O._scene.pick(e.position);Object(u.a)(t)&&t.primitive instanceof zse&&(O.tileset=t.primitive),O.pickActive=!1}),T=Dxe.observable();Dxe.defineProperty(this,"pickActive",{get:function(){return T()},set:function(e){T(e),e?i._eventHandler.setInputAction(E,TS.LEFT_CLICK):i._eventHandler.removeInputAction(TS.LEFT_CLICK)}});var C=Dxe.observable();Dxe.defineProperty(this,"pointCloudShading",{get:function(){return C()},set:function(e){C(e),Object(u.a)(i._tileset)&&(i._tileset.pointCloudShading.attenuation=e)}}),this.pointCloudShading=!1;var S=Dxe.observable();Dxe.defineProperty(this,"geometricErrorScale",{get:function(){return S()},set:function(e){e=Number(e),isNaN(e)||(S(e),Object(u.a)(i._tileset)&&(i._tileset.pointCloudShading.geometricErrorScale=e))}}),this.geometricErrorScale=1;var A=Dxe.observable();Dxe.defineProperty(this,"maximumAttenuation",{get:function(){return A()},set:function(e){e=Number(e),isNaN(e)||(A(e),Object(u.a)(i._tileset)&&(i._tileset.pointCloudShading.maximumAttenuation=0===e?void 0:e))}}),this.maximumAttenuation=0;var P=Dxe.observable();Dxe.defineProperty(this,"baseResolution",{get:function(){return P()},set:function(e){e=Number(e),isNaN(e)||(P(e),Object(u.a)(i._tileset)&&(i._tileset.pointCloudShading.baseResolution=0===e?void 0:e))}}),this.baseResolution=0;var I=Dxe.observable();Dxe.defineProperty(this,"eyeDomeLighting",{get:function(){return I()},set:function(e){I(e),Object(u.a)(i._tileset)&&(i._tileset.pointCloudShading.eyeDomeLighting=e)}}),this.eyeDomeLighting=!1;var D=Dxe.observable();Dxe.defineProperty(this,"eyeDomeLightingStrength",{get:function(){return D()},set:function(e){e=Number(e),isNaN(e)||(D(e),Object(u.a)(i._tileset)&&(i._tileset.pointCloudShading.eyeDomeLightingStrength=e))}}),this.eyeDomeLightingStrength=1;var j=Dxe.observable();Dxe.defineProperty(this,"eyeDomeLightingRadius",{get:function(){return j()},set:function(e){e=Number(e),isNaN(e)||(j(e),Object(u.a)(i._tileset)&&(i._tileset.pointCloudShading.eyeDomeLightingRadius=e))}}),this.eyeDomeLightingRadius=1,this.pickActive=!1;var M=Dxe.observable();Dxe.defineProperty(this,"skipLevelOfDetail",{get:function(){return M()},set:function(e){M(e),Object(u.a)(i._tileset)&&(i._tileset.skipLevelOfDetail=e)}}),this.skipLevelOfDetail=!0;var R=Dxe.observable();Dxe.defineProperty(this,"skipScreenSpaceErrorFactor",{get:function(){return R()},set:function(e){e=Number(e),isNaN(e)||(R(e),Object(u.a)(i._tileset)&&(i._tileset.skipScreenSpaceErrorFactor=e))}}),this.skipScreenSpaceErrorFactor=16;var L=Dxe.observable();Dxe.defineProperty(this,"baseScreenSpaceError",{get:function(){return L()},set:function(e){e=Number(e),isNaN(e)||(L(e),Object(u.a)(i._tileset)&&(i._tileset.baseScreenSpaceError=e))}}),this.baseScreenSpaceError=1024;var N=Dxe.observable();Dxe.defineProperty(this,"skipLevels",{get:function(){return N()},set:function(e){e=Number(e),isNaN(e)||(N(e),Object(u.a)(i._tileset)&&(i._tileset.skipLevels=e))}}),this.skipLevels=1;var F=Dxe.observable();Dxe.defineProperty(this,"immediatelyLoadDesiredLevelOfDetail",{get:function(){return F()},set:function(e){F(e),Object(u.a)(i._tileset)&&(i._tileset.immediatelyLoadDesiredLevelOfDetail=e)}}),this.immediatelyLoadDesiredLevelOfDetail=!1;var k=Dxe.observable();Dxe.defineProperty(this,"loadSiblings",{get:function(){return k()},set:function(e){k(e),Object(u.a)(i._tileset)&&(i._tileset.loadSiblings=e)}}),this.loadSiblings=!1,this._style=void 0,this._shouldStyle=!1,this._definedProperties=["properties","dynamicScreenSpaceError","colorBlendMode","picking","colorize","wireframe","showBoundingVolumes","showContentBoundingVolumes","showRequestVolumes","freezeFrame","maximumScreenSpaceError","dynamicScreenSpaceErrorDensity","baseScreenSpaceError","skipScreenSpaceErrorFactor","skipLevelOfDetail","skipLevels","immediatelyLoadDesiredLevelOfDetail","loadSiblings","dynamicScreenSpaceErrorDensitySliderValue","dynamicScreenSpaceErrorFactor","pickActive","showOnlyPickedTileDebugLabel","showGeometricError","showRenderingStatistics","showMemoryUsage","showUrl","pointCloudShading","geometricErrorScale","maximumAttenuation","baseResolution","eyeDomeLighting","eyeDomeLightingStrength","eyeDomeLightingRadius"],this._removePostRenderEvent=e.postRender.addEventListener((function(){i._update()})),Object(u.a)(this._tileset)||CEe(this,!0)}function LEe(e){if(e.featuresLength>0)return!0;var t=e.innerContents;if(Object(u.a)(t)){for(var i=t.length,n=0;n<i;++n)if(!LEe(t[n]))return!1;return!0}return!1}Object(O.a)(REe.prototype,{scene:{get:function(){return this._scene}},performanceContainer:{get:function(){return this._performanceContainer}},statisticsText:{get:function(){return this._statisticsText}},pickStatisticsText:{get:function(){return this._pickStatisticsText}},colorBlendModes:{get:function(){return IEe}},editorError:{get:function(){return this._editorError}},tileset:{get:function(){return this._tileset},set:function(e){if(this._tileset=e,this._style=void 0,this.styleString="{}",this.feature=void 0,this.tile=void 0,Object(u.a)(e)){var t=this;e.readyPromise.then((function(e){t.isDestroyed()||t._properties(e.properties)}));for(var i=["colorize","wireframe","showBoundingVolumes","showContentBoundingVolumes","showRequestVolumes","freezeFrame","showOnlyPickedTileDebugLabel","showGeometricError","showRenderingStatistics","showMemoryUsage","showUrl"],n=i.length,r=0;r<n;++r){var a=i[r];this[a]=this[a]}this.maximumScreenSpaceError=e.maximumScreenSpaceError,this.dynamicScreenSpaceError=e.dynamicScreenSpaceError,this.dynamicScreenSpaceErrorDensity=e.dynamicScreenSpaceErrorDensity,this.dynamicScreenSpaceErrorFactor=e.dynamicScreenSpaceErrorFactor,this.colorBlendMode=e.colorBlendMode,this.skipLevelOfDetail=e.skipLevelOfDetail,this.skipScreenSpaceErrorFactor=e.skipScreenSpaceErrorFactor,this.baseScreenSpaceError=e.baseScreenSpaceError,this.skipLevels=e.skipLevels,this.immediatelyLoadDesiredLevelOfDetail=e.immediatelyLoadDesiredLevelOfDetail,this.loadSiblings=e.loadSiblings;var o=e.pointCloudShading;this.pointCloudShading=o.attenuation,this.geometricErrorScale=o.geometricErrorScale,this.maximumAttenuation=o.maximumAttenuation?o.maximumAttenuation:0,this.baseResolution=o.baseResolution?o.baseResolution:0,this.eyeDomeLighting=o.eyeDomeLighting,this.eyeDomeLightingStrength=o.eyeDomeLightingStrength,this.eyeDomeLightingRadius=o.eyeDomeLightingRadius,this._scene.requestRender()}else this._properties({});this._statisticsText=PEe(e,!1),this._pickStatisticsText=PEe(e,!0),CEe(this,!1)}},feature:{get:function(){return this._feature},set:function(e){if(this._feature!==e){var t=this._feature;Object(u.a)(t)&&!t.content.isDestroyed()&&(!this.colorize&&Object(u.a)(this._style)?t.color=Object(u.a)(this._style.color)?this._style.color.evaluateColor(t,jEe):uf.WHITE:t.color=MEe,this._scene.requestRender()),Object(u.a)(e)&&(uf.clone(e.color,MEe),e.color=DEe,this._scene.requestRender()),this._feature=e}}},tile:{get:function(){return this._tile},set:function(e){if(this._tile!==e){var t=this._tile;!Object(u.a)(t)||t.isDestroyed()||LEe(t.content)||(t.color=MEe,this._scene.requestRender()),Object(u.a)(e)&&!LEe(e.content)&&(uf.clone(e.color,MEe),e.color=DEe,this._scene.requestRender()),this._tile=e}}}}),REe.prototype.togglePickTileset=function(){this.pickActive=!this.pickActive},REe.prototype.toggleInspector=function(){this.inspectorVisible=!this.inspectorVisible},REe.prototype.toggleTileset=function(){this.tilesetVisible=!this.tilesetVisible},REe.prototype.toggleDisplay=function(){this.displayVisible=!this.displayVisible},REe.prototype.toggleUpdate=function(){this.updateVisible=!this.updateVisible},REe.prototype.toggleLogging=function(){this.loggingVisible=!this.loggingVisible},REe.prototype.toggleStyle=function(){this.styleVisible=!this.styleVisible},REe.prototype.toggleTileDebugLabels=function(){this.tileDebugLabelsVisible=!this.tileDebugLabelsVisible},REe.prototype.toggleOptimization=function(){this.optimizationVisible=!this.optimizationVisible},REe.prototype.trimTilesCache=function(){Object(u.a)(this._tileset)&&this._tileset.trimLoadedTiles()},REe.prototype.compileStyle=function(){var e=this._tileset;if(Object(u.a)(e)&&this.styleString!==JSON.stringify(e.style)){this._editorError="";try{0===this.styleString.length&&(this.styleString="{}"),this._style=new Wse(JSON.parse(this.styleString)),this._shouldStyle=!0,this._scene.requestRender()}catch(e){this._editorError=e.toString()}this.feature=this._feature,this.tile=this._tile}},REe.prototype.styleEditorKeyPress=function(e,t){if(9===t.keyCode){t.preventDefault();var i,n=t.target,r=n.selectionStart,a=n.selectionEnd,o=a,s=n.value.slice(r,a).split("\n"),c=s.length;if(t.shiftKey)for(i=0;i<c;++i)" "===s[i][0]&&(" "===s[i][1]?(s[i]=s[i].substr(2),o-=2):(s[i]=s[i].substr(1),o-=1));else for(i=0;i<c;++i)s[i]="  "+s[i],o+=2;var l=s.join("\n");n.value=n.value.slice(0,r)+l+n.value.slice(a),n.selectionStart=r!==a?r:o,n.selectionEnd=o}else!t.ctrlKey||10!==t.keyCode&&13!==t.keyCode||this.compileStyle();return!0},REe.prototype._update=function(){var e=this._tileset;if(this.performance&&this._performanceDisplay.update(),Object(u.a)(e)){if(e.isDestroyed())return this.tile=void 0,this.feature=void 0,void(this.tileset=void 0);var t=e.style;this._style!==e.style&&(this._shouldStyle?(e.style=this._style,this._shouldStyle=!1):(this._style=t,this.styleString=JSON.stringify(t.style,null,"  ")))}this.showStatistics&&(this._statisticsText=PEe(e,!1),this._pickStatisticsText=PEe(e,!0))},REe.prototype.isDestroyed=function(){return!1},REe.prototype.destroy=function(){this._eventHandler.destroy(),this._removePostRenderEvent();var e=this;return this._definedProperties.forEach((function(t){Dxe.getObservable(e,t).dispose()})),rl(this)},REe.getStatistics=PEe;var NEe=REe;function FEe(e,t){x.a.defined("container",e),x.a.typeOf.object("scene",t),e=zfe(e);var i=document.createElement("div"),n=document.createElement("div");n.setAttribute("data-bind","visible: performance");var r=new NEe(t,n);this._viewModel=r,this._container=e,this._element=i;var a=document.createElement("div");a.textContent="3D Tiles Inspector",a.className="cesium-cesiumInspector-button",a.setAttribute("data-bind","click: toggleInspector"),i.appendChild(a),i.className="cesium-cesiumInspector cesium-3DTilesInspector",i.setAttribute("data-bind",'css: { "cesium-cesiumInspector-visible" : inspectorVisible, "cesium-cesiumInspector-hidden" : !inspectorVisible}'),e.appendChild(i);var o=document.createElement("div");this._panel=o,o.className="cesium-cesiumInspector-dropDown",i.appendChild(o);var s=Uxe.createSection,c=Uxe.createCheckbox,l=s(o,"Tileset","tilesetVisible","toggleTileset"),u=s(o,"Display","displayVisible","toggleDisplay"),h=s(o,"Update","updateVisible","toggleUpdate"),d=s(o,"Logging","loggingVisible","toggleLogging"),f=s(o,"Tile Debug Labels","tileDebugLabelsVisible","toggleTileDebugLabels"),p=s(o,"Style","styleVisible","toggleStyle"),m=s(o,"Optimization","optimizationVisible","toggleOptimization"),_=document.createElement("div");_.className="field-group";var g=document.createElement("label");g.className="field-label",g.appendChild(document.createTextNode("Properties: "));var v=document.createElement("div");v.setAttribute("data-bind","text: properties"),_.appendChild(g),_.appendChild(v),l.appendChild(_),l.appendChild(BEe("togglePickTileset","Pick Tileset","pickActive")),l.appendChild(BEe("trimTilesCache","Trim Tiles Cache")),l.appendChild(c("Enable Picking","picking")),u.appendChild(c("Colorize","colorize")),u.appendChild(c("Wireframe","wireframe")),u.appendChild(c("Bounding Volumes","showBoundingVolumes")),u.appendChild(c("Content Volumes","showContentBoundingVolumes")),u.appendChild(c("Request Volumes","showRequestVolumes")),u.appendChild(c("Point Cloud Shading","pointCloudShading"));var b=document.createElement("div");b.setAttribute("data-bind","visible: pointCloudShading"),b.appendChild(kEe("geometricErrorScale",0,2,.01,"Geometric Error Scale")),b.appendChild(kEe("maximumAttenuation",0,32,1,"Maximum Attenuation")),b.appendChild(kEe("baseResolution",0,1,.01,"Base Resolution")),b.appendChild(c("Eye Dome Lighting (EDL)","eyeDomeLighting")),u.appendChild(b);var y=document.createElement("div");y.setAttribute("data-bind","visible: eyeDomeLighting"),y.appendChild(kEe("eyeDomeLightingStrength",0,2,.1,"EDL Strength")),y.appendChild(kEe("eyeDomeLightingRadius",0,4,.1,"EDL Radius")),b.appendChild(y),h.appendChild(c("Freeze Frame","freezeFrame")),h.appendChild(c("Dynamic Screen Space Error","dynamicScreenSpaceError"));var w=document.createElement("div");w.appendChild(kEe("maximumScreenSpaceError",0,128,1,"Maximum Screen Space Error")),h.appendChild(w);var O=document.createElement("div");O.setAttribute("data-bind","visible: dynamicScreenSpaceError"),O.appendChild(kEe("dynamicScreenSpaceErrorDensitySliderValue",0,1,.005,"Screen Space Error Density","dynamicScreenSpaceErrorDensity")),O.appendChild(kEe("dynamicScreenSpaceErrorFactor",1,10,.1,"Screen Space Error Factor")),h.appendChild(O),d.appendChild(c("Performance","performance")),d.appendChild(n),d.appendChild(c("Statistics","showStatistics"));var E=document.createElement("div");E.className="cesium-3dTilesInspector-statistics",E.setAttribute("data-bind","html: statisticsText, visible: showStatistics"),d.appendChild(E),d.appendChild(c("Pick Statistics","showPickStatistics"));var T=document.createElement("div");T.className="cesium-3dTilesInspector-statistics",T.setAttribute("data-bind","html: pickStatisticsText, visible: showPickStatistics"),d.appendChild(T);var C=document.createElement("div");p.appendChild(C),C.appendChild(document.createTextNode("Color Blend Mode: "));var S=document.createElement("select");S.setAttribute("data-bind",'options: colorBlendModes, optionsText: "text", optionsValue: "value", value: colorBlendMode'),C.appendChild(S);var A=document.createElement("textarea");A.setAttribute("data-bind","textInput: styleString, event: { keydown: styleEditorKeyPress }"),C.className="cesium-cesiumInspector-styleEditor",C.appendChild(A);var P=BEe("compileStyle","Compile (Ctrl+Enter)");C.appendChild(P);var I=document.createElement("div");I.className="cesium-cesiumInspector-error",I.setAttribute("data-bind","text: editorError"),C.appendChild(I),f.appendChild(c("Show Picked Only","showOnlyPickedTileDebugLabel")),f.appendChild(c("Geometric Error","showGeometricError")),f.appendChild(c("Rendering Statistics","showRenderingStatistics")),f.appendChild(c("Memory Usage (MB)","showMemoryUsage")),f.appendChild(c("Url","showUrl")),m.appendChild(c("Skip Tile LODs","skipLevelOfDetail"));var D=document.createElement("div");D.appendChild(kEe("skipScreenSpaceErrorFactor",1,50,1,"Skip SSE Factor")),m.appendChild(D);var j=document.createElement("div");j.appendChild(kEe("baseScreenSpaceError",0,4096,1,"SSE before skipping LOD")),m.appendChild(j);var M=document.createElement("div");M.appendChild(kEe("skipLevels",0,10,1,"Min. levels to skip")),m.appendChild(M),m.appendChild(c("Load only tiles that meet the max SSE.","immediatelyLoadDesiredLevelOfDetail")),m.appendChild(c("Load siblings of visible tiles","loadSiblings")),Dxe.applyBindings(r,i)}function kEe(e,t,i,n,r,a){a=Object(w.a)(a,e);var o=document.createElement("input");o.setAttribute("data-bind","value: "+a),o.type="number";var s=document.createElement("input");s.type="range",s.min=t,s.max=i,s.step=n,s.setAttribute("data-bind",'valueUpdate: "input", value: '+e);var c=document.createElement("div");c.appendChild(s);var l=document.createElement("div");return l.className="cesium-cesiumInspector-slider",l.appendChild(document.createTextNode(r)),l.appendChild(o),l.appendChild(c),l}function BEe(e,t,i){var n=document.createElement("button");n.type="button",n.textContent=t,n.className="cesium-cesiumInspector-pickButton";var r="click: "+e;return Object(u.a)(i)&&(r+=', css: {"cesium-cesiumInspector-pickButtonHighlight" : '+i+"}"),n.setAttribute("data-bind",r),n}Object(O.a)(FEe.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}}),FEe.prototype.isDestroyed=function(){return!1},FEe.prototype.destroy=function(){return Dxe.cleanNode(this._element),this._container.removeChild(this._element),this.viewModel.destroy(),rl(this)};var zEe=FEe;function UEe(e,t,i){var n=Math.min(i,t);return n=Math.max(n,e)}function VEe(e,t){if(!Object(u.a)(e))throw new h.a("scene is required");if(!Object(u.a)(t))throw new h.a("performanceContainer is required");var i=this,n=e.canvas,r=new aA(n);this._eventHandler=r,this._scene=e,this._canvas=n,this._primitive=void 0,this._tile=void 0,this._modelMatrixPrimitive=void 0,this._performanceDisplay=void 0,this._performanceContainer=t;var a,o=this._scene.globe;function s(e){var t=i._scene.pick({x:e.position.x,y:e.position.y});Object(u.a)(t)&&(i.primitive=Object(u.a)(t.collection)?t.collection:t.primitive),i._scene.requestRender(),i.pickPrimitiveActive=!1}function c(e){var t,n=o.ellipsoid,r=i._scene.camera.pickEllipsoid({x:e.position.x,y:e.position.y},n);if(Object(u.a)(r))for(var a=n.cartesianToCartographic(r),s=o._surface.tileProvider._tilesToRenderByTextureCount,c=0;!t&&c<s.length;++c){var l=s[c];if(Object(u.a)(l))for(var h=0;!t&&h<l.length;++h){var d=l[h];Ve.contains(d.rectangle,a)&&(t=d)}}i.tile=t,i.pickTileActive=!1}o.depthTestAgainstTerrain=!0,this.frustums=!1,this.frustumPlanes=!1,this.performance=!1,this.shaderCacheText="",this.primitiveBoundingSphere=!1,this.primitiveReferenceFrame=!1,this.filterPrimitive=!1,this.tileBoundingSphere=!1,this.filterTile=!1,this.wireframe=!1,this.globeDepth=!1,this.pickDepth=!1,this.depthFrustum=1,this._numberOfFrustums=1,this.suspendUpdates=!1,this.tileCoordinates=!1,this.frustumStatisticText=!1,this.tileText="",this.hasPickedPrimitive=!1,this.hasPickedTile=!1,this.pickPrimitiveActive=!1,this.pickTileActive=!1,this.dropDownVisible=!0,this.generalVisible=!0,this.primitivesVisible=!1,this.terrainVisible=!1,this.depthFrustumText="",Dxe.track(this,["frustums","frustumPlanes","performance","shaderCacheText","primitiveBoundingSphere","primitiveReferenceFrame","filterPrimitive","tileBoundingSphere","filterTile","wireframe","globeDepth","pickDepth","depthFrustum","suspendUpdates","tileCoordinates","frustumStatisticText","tileText","hasPickedPrimitive","hasPickedTile","pickPrimitiveActive","pickTileActive","dropDownVisible","generalVisible","primitivesVisible","terrainVisible","depthFrustumText"]),this._toggleDropDown=Bxe((function(){i.dropDownVisible=!i.dropDownVisible})),this._toggleGeneral=Bxe((function(){i.generalVisible=!i.generalVisible})),this._togglePrimitives=Bxe((function(){i.primitivesVisible=!i.primitivesVisible})),this._toggleTerrain=Bxe((function(){i.terrainVisible=!i.terrainVisible})),this._frustumsSubscription=Dxe.getObservable(this,"frustums").subscribe((function(e){i._scene.debugShowFrustums=e,i._scene.requestRender()})),this._frustumPlanesSubscription=Dxe.getObservable(this,"frustumPlanes").subscribe((function(e){i._scene.debugShowFrustumPlanes=e,i._scene.requestRender()})),this._performanceSubscription=Dxe.getObservable(this,"performance").subscribe((function(e){e?i._performanceDisplay=new Vfe({container:i._performanceContainer}):i._performanceContainer.innerHTML=""})),this._showPrimitiveBoundingSphere=Bxe((function(){return i._primitive.debugShowBoundingVolume=i.primitiveBoundingSphere,i._scene.requestRender(),!0})),this._primitiveBoundingSphereSubscription=Dxe.getObservable(this,"primitiveBoundingSphere").subscribe((function(){i._showPrimitiveBoundingSphere()})),this._showPrimitiveReferenceFrame=Bxe((function(){if(i.primitiveReferenceFrame){var e=i._primitive.modelMatrix;i._modelMatrixPrimitive=new Fle({modelMatrix:e}),i._scene.primitives.add(i._modelMatrixPrimitive)}else Object(u.a)(i._modelMatrixPrimitive)&&(i._scene.primitives.remove(i._modelMatrixPrimitive),i._modelMatrixPrimitive=void 0);return i._scene.requestRender(),!0})),this._primitiveReferenceFrameSubscription=Dxe.getObservable(this,"primitiveReferenceFrame").subscribe((function(){i._showPrimitiveReferenceFrame()})),this._doFilterPrimitive=Bxe((function(){return i.filterPrimitive?i._scene.debugCommandFilter=function(e){return!(!Object(u.a)(i._modelMatrixPrimitive)||e.owner!==i._modelMatrixPrimitive._primitive)||!!Object(u.a)(i._primitive)&&(e.owner===i._primitive||e.owner===i._primitive._billboardCollection||e.owner.primitive===i._primitive)}:i._scene.debugCommandFilter=void 0,!0})),this._filterPrimitiveSubscription=Dxe.getObservable(this,"filterPrimitive").subscribe((function(){i._doFilterPrimitive(),i._scene.requestRender()})),this._wireframeSubscription=Dxe.getObservable(this,"wireframe").subscribe((function(e){o._surface.tileProvider._debug.wireframe=e,i._scene.requestRender()})),this._globeDepthSubscription=Dxe.getObservable(this,"globeDepth").subscribe((function(e){i._scene.debugShowGlobeDepth=e,i._scene.requestRender()})),this._pickDepthSubscription=Dxe.getObservable(this,"pickDepth").subscribe((function(e){i._scene.debugShowPickDepth=e,i._scene.requestRender()})),this._depthFrustumSubscription=Dxe.getObservable(this,"depthFrustum").subscribe((function(e){i._scene.debugShowDepthFrustum=e,i._scene.requestRender()})),this._incrementDepthFrustum=Bxe((function(){var e=i.depthFrustum+1;return i.depthFrustum=UEe(1,i._numberOfFrustums,e),i._scene.requestRender(),!0})),this._decrementDepthFrustum=Bxe((function(){var e=i.depthFrustum-1;return i.depthFrustum=UEe(1,i._numberOfFrustums,e),i._scene.requestRender(),!0})),this._suspendUpdatesSubscription=Dxe.getObservable(this,"suspendUpdates").subscribe((function(e){o._surface._debug.suspendLodUpdate=e,e||(i.filterTile=!1)})),this._showTileCoordinates=Bxe((function(){return i.tileCoordinates&&!Object(u.a)(a)?a=e.imageryLayers.addImageryProvider(new XOe({tilingScheme:e.terrainProvider.tilingScheme})):!i.tileCoordinates&&Object(u.a)(a)&&(e.imageryLayers.remove(a),a=void 0),!0})),this._tileCoordinatesSubscription=Dxe.getObservable(this,"tileCoordinates").subscribe((function(){i._showTileCoordinates(),i._scene.requestRender()})),this._tileBoundingSphereSubscription=Dxe.getObservable(this,"tileBoundingSphere").subscribe((function(){i._showTileBoundingSphere(),i._scene.requestRender()})),this._showTileBoundingSphere=Bxe((function(){return i.tileBoundingSphere?o._surface.tileProvider._debug.boundingSphereTile=i._tile:o._surface.tileProvider._debug.boundingSphereTile=void 0,i._scene.requestRender(),!0})),this._doFilterTile=Bxe((function(){return i.filterTile?(i.suspendUpdates=!0,o._surface._tilesToRender=[],Object(u.a)(i._tile)&&i._tile.renderable&&o._surface._tilesToRender.push(i._tile)):i.suspendUpdates=!1,!0})),this._filterTileSubscription=Dxe.getObservable(this,"filterTile").subscribe((function(){i.doFilterTile(),i._scene.requestRender()})),this._pickPrimitive=Bxe((function(){i.pickPrimitiveActive=!i.pickPrimitiveActive})),this._pickPrimitiveActiveSubscription=Dxe.getObservable(this,"pickPrimitiveActive").subscribe((function(e){e?r.setInputAction(s,TS.LEFT_CLICK):r.removeInputAction(TS.LEFT_CLICK)})),this._pickTile=Bxe((function(){i.pickTileActive=!i.pickTileActive})),this._pickTileActiveSubscription=Dxe.getObservable(this,"pickTileActive").subscribe((function(e){e?r.setInputAction(c,TS.LEFT_CLICK):r.removeInputAction(TS.LEFT_CLICK)})),this._removePostRenderEvent=e.postRender.addEventListener((function(){i._update()}))}Object(O.a)(VEe.prototype,{scene:{get:function(){return this._scene}},performanceContainer:{get:function(){return this._performanceContainer}},toggleDropDown:{get:function(){return this._toggleDropDown}},showPrimitiveBoundingSphere:{get:function(){return this._showPrimitiveBoundingSphere}},showPrimitiveReferenceFrame:{get:function(){return this._showPrimitiveReferenceFrame}},doFilterPrimitive:{get:function(){return this._doFilterPrimitive}},incrementDepthFrustum:{get:function(){return this._incrementDepthFrustum}},decrementDepthFrustum:{get:function(){return this._decrementDepthFrustum}},showTileCoordinates:{get:function(){return this._showTileCoordinates}},showTileBoundingSphere:{get:function(){return this._showTileBoundingSphere}},doFilterTile:{get:function(){return this._doFilterTile}},toggleGeneral:{get:function(){return this._toggleGeneral}},togglePrimitives:{get:function(){return this._togglePrimitives}},toggleTerrain:{get:function(){return this._toggleTerrain}},pickPrimitive:{get:function(){return this._pickPrimitive}},pickTile:{get:function(){return this._pickTile}},selectParent:{get:function(){var e=this;return Bxe((function(){e.tile=e.tile.parent}))}},selectNW:{get:function(){var e=this;return Bxe((function(){e.tile=e.tile.northwestChild}))}},selectNE:{get:function(){var e=this;return Bxe((function(){e.tile=e.tile.northeastChild}))}},selectSW:{get:function(){var e=this;return Bxe((function(){e.tile=e.tile.southwestChild}))}},selectSE:{get:function(){var e=this;return Bxe((function(){e.tile=e.tile.southeastChild}))}},primitive:{get:function(){return this._primitive},set:function(e){var t=this._primitive;e!==t&&(this.hasPickedPrimitive=!0,Object(u.a)(t)&&(t.debugShowBoundingVolume=!1),this._scene.debugCommandFilter=void 0,Object(u.a)(this._modelMatrixPrimitive)&&(this._scene.primitives.remove(this._modelMatrixPrimitive),this._modelMatrixPrimitive=void 0),this._primitive=e,e.show=!1,setTimeout((function(){e.show=!0}),50),this.showPrimitiveBoundingSphere(),this.showPrimitiveReferenceFrame(),this.doFilterPrimitive())}},tile:{get:function(){return this._tile},set:function(e){if(Object(u.a)(e)){if(this.hasPickedTile=!0,e!==this._tile){this.tileText="L: "+e.level+" X: "+e.x+" Y: "+e.y,this.tileText+="<br>SW corner: "+e.rectangle.west+", "+e.rectangle.south,this.tileText+="<br>NE corner: "+e.rectangle.east+", "+e.rectangle.north;var t=e.data;Object(u.a)(t)?this.tileText+="<br>Min: "+t.minimumHeight+" Max: "+t.maximumHeight:this.tileText+="<br>(Tile is not loaded)"}this._tile=e,this.showTileBoundingSphere(),this.doFilterTile()}else this.hasPickedTile=!1,this._tile=void 0}}}),VEe.prototype._update=function(){this.frustums&&(this.frustumStatisticText=function(e){var t;if(Object(u.a)(e)){t="Command Statistics";var i=e.commandsInFrustums;for(var n in i)if(i.hasOwnProperty(n)){var r,a=parseInt(n,10);if(7===a)r="1, 2 and 3";else{for(var o=[],s=2;s>=0;s--){var c=Math.pow(2,s);a>=c&&(o.push(s+1),a-=c)}r=o.reverse().join(" and ")}t+="<br>&nbsp;&nbsp;&nbsp;&nbsp;"+i[n]+" in frustum "+r}t+="<br>Total: "+e.totalCommands}return t}(this._scene.debugFrustumStatistics));var e=this._scene.numberOfFrustums;this._numberOfFrustums=e,this.depthFrustum=UEe(1,e,this.depthFrustum),this.depthFrustumText=this.depthFrustum+" of "+e,this.performance&&this._performanceDisplay.update(),this.primitiveReferenceFrame&&(this._modelMatrixPrimitive.modelMatrix=this._primitive.modelMatrix),this.shaderCacheText="Cached shaders: "+this._scene.context.shaderCache.numberOfShaders},VEe.prototype.isDestroyed=function(){return!1},VEe.prototype.destroy=function(){return this._eventHandler.destroy(),this._removePostRenderEvent(),this._frustumsSubscription.dispose(),this._frustumPlanesSubscription.dispose(),this._performanceSubscription.dispose(),this._primitiveBoundingSphereSubscription.dispose(),this._primitiveReferenceFrameSubscription.dispose(),this._filterPrimitiveSubscription.dispose(),this._wireframeSubscription.dispose(),this._globeDepthSubscription.dispose(),this._pickDepthSubscription.dispose(),this._depthFrustumSubscription.dispose(),this._suspendUpdatesSubscription.dispose(),this._tileCoordinatesSubscription.dispose(),this._tileBoundingSphereSubscription.dispose(),this._filterTileSubscription.dispose(),this._pickPrimitiveActiveSubscription.dispose(),this._pickTileActiveSubscription.dispose(),rl(this)};var HEe=VEe;function GEe(e,t){if(!Object(u.a)(e))throw new h.a("container is required.");if(!Object(u.a)(t))throw new h.a("scene is required.");e=zfe(e);var i=document.createElement("div"),n=new HEe(t,i);this._viewModel=n,this._container=e;var r=document.createElement("div");this._element=r;var a=document.createElement("div");a.textContent="Cesium Inspector",a.className="cesium-cesiumInspector-button",a.setAttribute("data-bind","click: toggleDropDown"),r.appendChild(a),r.className="cesium-cesiumInspector",r.setAttribute("data-bind",'css: { "cesium-cesiumInspector-visible" : dropDownVisible, "cesium-cesiumInspector-hidden" : !dropDownVisible }'),e.appendChild(this._element);var o=document.createElement("div");this._panel=o,o.className="cesium-cesiumInspector-dropDown",r.appendChild(o);var s=Uxe.createSection,c=Uxe.createCheckbox,l=s(o,"General","generalVisible","toggleGeneral"),d=c("Show Frustums","frustums"),f=document.createElement("div");f.className="cesium-cesiumInspector-frustumStatistics",f.setAttribute("data-bind","visible: frustums, html: frustumStatisticText"),d.appendChild(f),l.appendChild(d),l.appendChild(c("Show Frustum Planes","frustumPlanes")),l.appendChild(c("Performance Display","performance")),i.className="cesium-cesiumInspector-performanceDisplay",l.appendChild(i);var p=document.createElement("div");p.className="cesium-cesiumInspector-shaderCache",p.setAttribute("data-bind","html: shaderCacheText"),l.appendChild(p);var m=document.createElement("div");l.appendChild(m);var _=document.createElement("span");_.setAttribute("data-bind",'html: "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Frustum:"'),m.appendChild(_);var g=document.createElement("span");g.setAttribute("data-bind","text: depthFrustumText"),m.appendChild(g);var v=document.createElement("input");v.type="button",v.value="-",v.className="cesium-cesiumInspector-pickButton",v.setAttribute("data-bind","click: decrementDepthFrustum"),m.appendChild(v);var b=document.createElement("input");b.type="button",b.value="+",b.className="cesium-cesiumInspector-pickButton",b.setAttribute("data-bind","click: incrementDepthFrustum"),m.appendChild(b);var y=s(o,"Primitives","primitivesVisible","togglePrimitives"),w=document.createElement("div");w.className="cesium-cesiumInspector-pickSection",y.appendChild(w);var O=document.createElement("input");O.type="button",O.value="Pick a primitive",O.className="cesium-cesiumInspector-pickButton",O.setAttribute("data-bind",'css: {"cesium-cesiumInspector-pickButtonHighlight" : pickPrimitiveActive}, click: pickPrimitive');var x=document.createElement("div");x.className="cesium-cesiumInspector-center",x.appendChild(O),w.appendChild(x),w.appendChild(c("Show bounding sphere","primitiveBoundingSphere","hasPickedPrimitive")),w.appendChild(c("Show reference frame","primitiveReferenceFrame","hasPickedPrimitive")),this._primitiveOnly=c("Show only selected","filterPrimitive","hasPickedPrimitive"),w.appendChild(this._primitiveOnly);var E=s(o,"Terrain","terrainVisible","toggleTerrain"),T=document.createElement("div");T.className="cesium-cesiumInspector-pickSection",E.appendChild(T);var C=document.createElement("input");C.type="button",C.value="Pick a tile",C.className="cesium-cesiumInspector-pickButton",C.setAttribute("data-bind",'css: {"cesium-cesiumInspector-pickButtonHighlight" : pickTileActive}, click: pickTile'),(x=document.createElement("div")).appendChild(C),x.className="cesium-cesiumInspector-center",T.appendChild(x);var S=document.createElement("div");T.appendChild(S);var A=document.createElement("input");A.type="button",A.value="Parent",A.className="cesium-cesiumInspector-pickButton",A.setAttribute("data-bind","click: selectParent");var P=document.createElement("input");P.type="button",P.value="NW",P.className="cesium-cesiumInspector-pickButton",P.setAttribute("data-bind","click: selectNW");var I=document.createElement("input");I.type="button",I.value="NE",I.className="cesium-cesiumInspector-pickButton",I.setAttribute("data-bind","click: selectNE");var D=document.createElement("input");D.type="button",D.value="SW",D.className="cesium-cesiumInspector-pickButton",D.setAttribute("data-bind","click: selectSW");var j=document.createElement("input");j.type="button",j.value="SE",j.className="cesium-cesiumInspector-pickButton",j.setAttribute("data-bind","click: selectSE");var M=document.createElement("div");M.className="cesium-cesiumInspector-tileText",S.className="cesium-cesiumInspector-frustumStatistics",S.appendChild(M),S.setAttribute("data-bind","visible: hasPickedTile"),M.setAttribute("data-bind","html: tileText");var R=document.createElement("div");R.className="cesium-cesiumInspector-relativeText",R.textContent="Select relative:",S.appendChild(R);var L=document.createElement("table"),N=document.createElement("tr"),F=document.createElement("tr"),k=document.createElement("td");k.appendChild(A);var B=document.createElement("td");B.appendChild(P);var z=document.createElement("td");z.appendChild(I),N.appendChild(k),N.appendChild(B),N.appendChild(z);var U=document.createElement("td"),V=document.createElement("td");V.appendChild(D);var H=document.createElement("td");H.appendChild(j),F.appendChild(U),F.appendChild(V),F.appendChild(H),L.appendChild(N),L.appendChild(F),S.appendChild(L),T.appendChild(c("Show bounding volume","tileBoundingSphere","hasPickedTile")),T.appendChild(c("Show only selected","filterTile","hasPickedTile")),E.appendChild(c("Wireframe","wireframe")),E.appendChild(c("Suspend LOD update","suspendUpdates")),E.appendChild(c("Show tile coordinates","tileCoordinates")),Dxe.applyBindings(n,this._element)}Object(O.a)(GEe.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}}),GEe.prototype.isDestroyed=function(){return!1},GEe.prototype.destroy=function(){return Dxe.cleanNode(this._element),this._container.removeChild(this._element),this.viewModel.destroy(),rl(this)};var qEe=GEe;function WEe(e){return y("Assets/Textures/SkyBox/tycho2t3_80_"+e+".jpg")}function YEe(e){var t=e._canvas,i=t.clientWidth,n=t.clientHeight,r=e._resolutionScale;e._supportsImageRenderingPixelated||(r*=Object(w.a)(window.devicePixelRatio,1)),e._canvasWidth=i,e._canvasHeight=n,i*=r,n*=r,t.width=i,t.height=n,e._canRender=0!==i&&0!==n}function XEe(e){var t=e._canvas,i=t.width,n=t.height;if(0!==i&&0!==n){var r=e._scene.camera.frustum;Object(u.a)(r.aspectRatio)?r.aspectRatio=i/n:(r.top=r.right*(n/i),r.bottom=-r.top)}}function ZEe(e,t){if(!Object(u.a)(e))throw new h.a("container is required.");e=zfe(e),t=Object(w.a)(t,{});var i=document.createElement("div");i.className="cesium-widget",e.appendChild(i);var n=document.createElement("canvas"),r=Ri.supportsImageRenderingPixelated();this._supportsImageRenderingPixelated=r,r&&(n.style.imageRendering=Ri.imageRenderingValue()),n.oncontextmenu=function(){return!1},n.onselectstart=function(){return!1},i.appendChild(n);var a=document.createElement("div");a.className="cesium-widget-credits";var o=Object(u.a)(t.creditContainer)?zfe(t.creditContainer):i;o.appendChild(a);var s=Object(u.a)(t.creditViewport)?zfe(t.creditViewport):i,c=Object(w.a)(t.showRenderLoopErrors,!0);this._element=i,this._container=e,this._canvas=n,this._canvasWidth=0,this._canvasHeight=0,this._creditViewport=s,this._creditContainer=o,this._innerCreditContainer=a,this._canRender=!1,this._renderLoopRunning=!1,this._showRenderLoopErrors=c,this._resolutionScale=1,this._forceResize=!1,this._clock=Object(u.a)(t.clock)?t.clock:new tf,YEe(this);try{var l=new xOe({canvas:n,contextOptions:t.contextOptions,creditContainer:a,creditViewport:s,mapProjection:t.mapProjection,orderIndependentTranslucency:t.orderIndependentTranslucency,scene3DOnly:Object(w.a)(t.scene3DOnly,!1),terrainExaggeration:t.terrainExaggeration,shadows:t.shadows,mapMode2D:t.mapMode2D,requestRenderMode:t.requestRenderMode,maximumRenderTimeChange:t.maximumRenderTimeChange,ambientLight:t.ambientLight,lightScaleFactor:t.lightScaleFactor,taaEnabled:t.taaEnabled,gradualRenderMode:t.gradualRenderMode,vignetteMode:t.vignetteMode});this._scene=l,l.camera.constrainedAxis=z.UNIT_Z,XEe(this);var d=Object(w.a)(l.mapProjection.ellipsoid,ae.WGS84),f=t.globe;Object(u.a)(f)||(f=new Cde(d)),!1!==f&&(l.globe=f,l.globe.shadows=Object(w.a)(t.terrainShadows,rM.RECEIVE_ONLY));var p=t.skyBox;Object(u.a)(p)||(p=new DOe({sources:{positiveX:WEe("px"),negativeX:WEe("mx"),positiveY:WEe("py"),negativeY:WEe("my"),positiveZ:WEe("pz"),negativeZ:WEe("mz")}})),!1!==p&&(l.skyBox=p,l.sun=new GOe,l.moon=new afe);var m=t.skyAtmosphere;Object(u.a)(m)||(m=new SOe(d)),!1!==m&&(l.skyAtmosphere=m);var _=!1!==t.globe&&t.imageryProvider;Object(u.a)(_)||(_=lle()),!1!==_&&l.imageryLayers.addImageryProvider(_),Object(u.a)(t.terrainProvider)&&!1!==t.globe&&(l.terrainProvider=t.terrainProvider),this._screenSpaceEventHandler=new aA(n,!1),Object(u.a)(t.sceneMode)&&(t.sceneMode===xF.SCENE2D&&this._scene.morphTo2D(0),t.sceneMode===xF.COLUMBUS_VIEW&&this._scene.morphToColumbusView(0)),this._useDefaultRenderLoop=void 0,this.useDefaultRenderLoop=Object(w.a)(t.useDefaultRenderLoop,!0),this._targetFrameRate=void 0,this.targetFrameRate=t.targetFrameRate;var g=this;l.renderError.addEventListener((function(e,t){if(g._useDefaultRenderLoop=!1,g._renderLoopRunning=!1,g._showRenderLoopErrors){g.showErrorPanel("An error occurred while rendering.  Rendering has stopped.",void 0,t)}}))}catch(e){if(c){this.showErrorPanel("Error constructing CesiumWidget.",'Visit <a href="http://get.webgl.org">http://get.webgl.org</a> to verify that your web browser and hardware support WebGL.  Consider trying a different web browser or updating your video drivers.  Detailed error information is below:',e)}throw e}}Object(O.a)(ZEe.prototype,{container:{get:function(){return this._container}},canvas:{get:function(){return this._canvas}},creditContainer:{get:function(){return this._creditContainer}},creditViewport:{get:function(){return this._creditViewport}},scene:{get:function(){return this._scene}},imageryLayers:{get:function(){return this._scene.imageryLayers}},terrainProvider:{get:function(){return this._scene.terrainProvider},set:function(e){this._scene.terrainProvider=e}},camera:{get:function(){return this._scene.camera}},clock:{get:function(){return this._clock}},screenSpaceEventHandler:{get:function(){return this._screenSpaceEventHandler}},targetFrameRate:{get:function(){return this._targetFrameRate},set:function(e){if(e<=0)throw new h.a("targetFrameRate must be greater than 0, or undefined.");this._targetFrameRate=e}},useDefaultRenderLoop:{get:function(){return this._useDefaultRenderLoop},set:function(e){this._useDefaultRenderLoop!==e&&(this._useDefaultRenderLoop=e,e&&!this._renderLoopRunning&&function(e){e._renderLoopRunning=!0;var t=0;gS((function i(n){if(!e.isDestroyed())if(e._useDefaultRenderLoop)try{var r=e._targetFrameRate;if(Object(u.a)(r)){var a=1e3/r,o=n-t;o>a&&(e.resize(),e.render(),t=n-o%a),gS(i)}else e.resize(),e.render(),gS(i)}catch(t){if(e._useDefaultRenderLoop=!1,e._renderLoopRunning=!1,e._showRenderLoopErrors){e.showErrorPanel("An error occurred while rendering.  Rendering has stopped.",void 0,t)}}else e._renderLoopRunning=!1}))}(this))}},resolutionScale:{get:function(){return this._resolutionScale},set:function(e){if(e<=0)throw new h.a("resolutionScale must be greater than 0.");this._resolutionScale=e,this._forceResize=!0}}}),ZEe.prototype.showErrorPanel=function(e,t,i){var n=this._element,r=document.createElement("div");r.className="cesium-widget-errorPanel";var a=document.createElement("div");a.className="cesium-widget-errorPanel-content",r.appendChild(a);var o=document.createElement("div");o.className="cesium-widget-errorPanel-header",o.appendChild(document.createTextNode(e)),a.appendChild(o);var s=document.createElement("div");function c(){s.style.maxHeight=Math.max(Math.round(.9*n.clientHeight-100),30)+"px"}if(s.className="cesium-widget-errorPanel-scroll",a.appendChild(s),c(),Object(u.a)(window.addEventListener)&&window.addEventListener("resize",c,!1),Object(u.a)(t)){var l=document.createElement("div");l.className="cesium-widget-errorPanel-message",l.innerHTML="<p>"+t+"</p>",s.appendChild(l)}var h="(no error details available)";Object(u.a)(i)&&(h=cu(i));var d=document.createElement("div");d.className="cesium-widget-errorPanel-message",d.appendChild(document.createTextNode(h)),s.appendChild(d);var f=document.createElement("div");f.className="cesium-widget-errorPanel-buttonPanel",a.appendChild(f);var p=document.createElement("button");p.setAttribute("type","button"),p.className="cesium-button",p.appendChild(document.createTextNode("OK")),p.onclick=function(){Object(u.a)(c)&&Object(u.a)(window.removeEventListener)&&window.removeEventListener("resize",c,!1),n.removeChild(r)},f.appendChild(p),n.appendChild(r),"undefined"!=typeof console&&console.error(e+"\n"+t+"\n"+h)},ZEe.prototype.isDestroyed=function(){return!1},ZEe.prototype.destroy=function(){this._scene=this._scene&&this._scene.destroy(),this._container.removeChild(this._element),this._creditContainer.removeChild(this._innerCreditContainer),rl(this)},ZEe.prototype.resize=function(){var e=this._canvas,t=e.clientWidth,i=e.clientHeight;(this._forceResize||this._canvasWidth!==t||this._canvasHeight!==i)&&(this._forceResize=!1,YEe(this),XEe(this),this._scene.requestRender())},ZEe.prototype.render=function(){if(this._canRender){this._scene.initializeFrame();var e=this._clock.tick();this._scene.render(e)}else this._clock.tick()};var QEe=ZEe;function KEe(e){var t=this,i=Dxe.observable(wi.fullscreen),n=Dxe.observable(wi.enabled);this.isFullscreen=void 0,Dxe.defineProperty(this,"isFullscreen",{get:function(){return i()}}),this.isFullscreenEnabled=void 0,Dxe.defineProperty(this,"isFullscreenEnabled",{get:function(){return n()},set:function(e){n(e&&wi.enabled)}}),this.tooltip=void 0,Dxe.defineProperty(this,"tooltip",(function(){return this.isFullscreenEnabled?i()?"Exit full screen":"Full screen":"Full screen unavailable"})),this._command=Bxe((function(){wi.fullscreen?wi.exitFullscreen():wi.requestFullscreen(t._fullscreenElement)}),Dxe.getObservable(this,"isFullscreenEnabled")),this._fullscreenElement=Object(w.a)(zfe(e),document.body),this._callback=function(){i(wi.fullscreen)},document.addEventListener(wi.changeEventName,this._callback)}Object(O.a)(KEe.prototype,{fullscreenElement:{get:function(){return this._fullscreenElement},set:function(e){if(!(e instanceof Element))throw new h.a("value must be a valid Element.");this._fullscreenElement=e}},command:{get:function(){return this._command}}}),KEe.prototype.isDestroyed=function(){return!1},KEe.prototype.destroy=function(){document.removeEventListener(wi.changeEventName,this._callback),rl(this)};var JEe=KEe,$Ee="M 83.96875 17.5625 L 83.96875 17.59375 L 76.65625 24.875 L 97.09375 24.96875 L 76.09375 45.96875 L 81.9375 51.8125 L 102.78125 30.9375 L 102.875 51.15625 L 110.15625 43.875 L 110.1875 17.59375 L 83.96875 17.5625 z M 44.125 17.59375 L 17.90625 17.625 L 17.9375 43.90625 L 25.21875 51.1875 L 25.3125 30.96875 L 46.15625 51.8125 L 52 45.96875 L 31 25 L 51.4375 24.90625 L 44.125 17.59375 z M 46.0625 76.03125 L 25.1875 96.875 L 25.09375 76.65625 L 17.8125 83.9375 L 17.8125 110.21875 L 44 110.25 L 51.3125 102.9375 L 30.90625 102.84375 L 51.875 81.875 L 46.0625 76.03125 z M 82 76.15625 L 76.15625 82 L 97.15625 103 L 76.71875 103.0625 L 84.03125 110.375 L 110.25 110.34375 L 110.21875 84.0625 L 102.9375 76.8125 L 102.84375 97 L 82 76.15625 z",eTe="M 104.34375 17.5625 L 83.5 38.4375 L 83.40625 18.21875 L 76.125 25.5 L 76.09375 51.78125 L 102.3125 51.8125 L 102.3125 51.78125 L 109.625 44.5 L 89.1875 44.40625 L 110.1875 23.40625 L 104.34375 17.5625 z M 23.75 17.59375 L 17.90625 23.4375 L 38.90625 44.4375 L 18.5 44.53125 L 25.78125 51.8125 L 52 51.78125 L 51.96875 25.53125 L 44.6875 18.25 L 44.625 38.46875 L 23.75 17.59375 z M 25.6875 76.03125 L 18.375 83.3125 L 38.78125 83.40625 L 17.8125 104.40625 L 23.625 110.25 L 44.5 89.375 L 44.59375 109.59375 L 51.875 102.3125 L 51.875 76.0625 L 25.6875 76.03125 z M 102.375 76.15625 L 76.15625 76.1875 L 76.1875 102.4375 L 83.46875 109.71875 L 83.5625 89.53125 L 104.40625 110.375 L 110.25 104.53125 L 89.25 83.53125 L 109.6875 83.46875 L 102.375 76.15625 z";function tTe(e,t){if(!Object(u.a)(e))throw new h.a("container is required.");e=zfe(e);var i=new JEe(t);i._exitFullScreenPath=eTe,i._enterFullScreenPath=$Ee;var n=document.createElement("button");n.type="button",n.className="cesium-button cesium-fullscreenButton",n.setAttribute("data-bind","attr: { title: tooltip },click: command,enable: isFullscreenEnabled,cesiumSvgPath: { path: isFullscreen ? _exitFullScreenPath : _enterFullScreenPath, width: 128, height: 128 }"),e.appendChild(n),Dxe.applyBindings(i,n),this._container=e,this._viewModel=i,this._element=n}Object(O.a)(tTe.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}}),tTe.prototype.isDestroyed=function(){return!1},tTe.prototype.destroy=function(){return this._viewModel.destroy(),Dxe.cleanNode(this._element),this._container.removeChild(this._element),rl(this)};var iTe=tTe,nTe=1e3;function rTe(e){if(!Object(u.a)(e)||!Object(u.a)(e.scene))throw new h.a("options.scene is required.");Object(u.a)(e.geocoderServices)?this._geocoderServices=e.geocoderServices:this._geocoderServices=[new no,new ZO({scene:e.scene})],this._viewContainer=e.container,this._scene=e.scene,this._flightDuration=e.flightDuration,this._searchText="",this._isSearchInProgress=!1,this._geocodePromise=void 0,this._complete=new $o.a,this._suggestions=[],this._selectedSuggestion=void 0,this._showSuggestions=!0,this._handleArrowDown=oTe,this._handleArrowUp=aTe;var t=this;this._suggestionsVisible=Dxe.pureComputed((function(){var e=Dxe.getObservable(t,"_suggestions")().length>0,i=Dxe.getObservable(t,"_showSuggestions")();return e&&i})),this._searchCommand=Bxe((function(e){if(e=Object(w.a)(e,ty.SEARCH),t._focusTextbox=!1,Object(u.a)(t._selectedSuggestion))return t.activateSuggestion(t._selectedSuggestion),!1;var i;t.hideSuggestions(),t.isSearchInProgress?((i=t)._isSearchInProgress=!1,Object(u.a)(i._geocodePromise)&&(i._geocodePromise.cancel=!0,i._geocodePromise=void 0)):function(e,t,i){var n=e._searchText;if(cTe(n))return void e.showSuggestions();e._isSearchInProgress=!0;for(var r=Oi.a.resolve(),a=0;a<t.length;a++)r=sTe(r,t[a],n,i);e._geocodePromise=r,r.then((function(t){if(!r.cancel){e._isSearchInProgress=!1;var i=t.value;if("fulfilled"===t.state&&Object(u.a)(i)&&i.length>0)return e._searchText=i[0].displayName,void e.destinationFound(e,i[0].destination);e._searchText=n+" (not found)"}}))}(t,t._geocoderServices,e)})),this.deselectSuggestion=function(){t._selectedSuggestion=void 0},this.handleKeyDown=function(e,t){var i="ArrowDown"===t.key||"Down"===t.key||40===t.keyCode,n="ArrowUp"===t.key||"Up"===t.key||38===t.keyCode;return(i||n)&&t.preventDefault(),!0},this.handleKeyUp=function(e,i){var n="ArrowDown"===i.key||"Down"===i.key||40===i.keyCode,r="ArrowUp"===i.key||"Up"===i.key||38===i.keyCode,a="Enter"===i.key||13===i.keyCode;return r?aTe(t):n?oTe(t):a&&t._searchCommand(),!0},this.activateSuggestion=function(e){t.hideSuggestions(),t._searchText=e.displayName;var i=e.destination;lTe(t),t.destinationFound(t,i)},this.hideSuggestions=function(){t._showSuggestions=!1,t._selectedSuggestion=void 0},this.showSuggestions=function(){t._showSuggestions=!0},this.handleMouseover=function(e,i){e!==t._selectedSuggestion&&(t._selectedSuggestion=e)},this.keepExpanded=!1,this.autoComplete=Object(w.a)(e.autocomplete,!0),this.destinationFound=Object(w.a)(e.destinationFound,rTe.flyToDestination),this._focusTextbox=!1,Dxe.track(this,["_searchText","_isSearchInProgress","keepExpanded","_suggestions","_selectedSuggestion","_showSuggestions","_focusTextbox"]);var i=Dxe.getObservable(this,"_searchText");i.extend({rateLimit:{timeout:500}}),this._suggestionSubscription=i.subscribe((function(){rTe._updateSearchSuggestions(t)})),this.isSearchInProgress=void 0,Dxe.defineProperty(this,"isSearchInProgress",{get:function(){return this._isSearchInProgress}}),this.searchText=void 0,Dxe.defineProperty(this,"searchText",{get:function(){return this.isSearchInProgress?"Searching...":this._searchText},set:function(e){if("string"!=typeof e)throw new h.a("value must be a valid string.");this._searchText=e}}),this.flightDuration=void 0,Dxe.defineProperty(this,"flightDuration",{get:function(){return this._flightDuration},set:function(e){if(Object(u.a)(e)&&e<0)throw new h.a("value must be positive.");this._flightDuration=e}})}function aTe(e){if(0!==e._suggestions.length){var t,i=e._suggestions.indexOf(e._selectedSuggestion);-1!==i&&0!==i?(t=i-1,e._selectedSuggestion=e._suggestions[t],rTe._adjustSuggestionsScroll(e,t)):e._selectedSuggestion=void 0}}function oTe(e){if(0!==e._suggestions.length){var t=e._suggestions.length,i=(e._suggestions.indexOf(e._selectedSuggestion)+1)%t;e._selectedSuggestion=e._suggestions[i],rTe._adjustSuggestionsScroll(e,i)}}function sTe(e,t,i,n){return e.then((function(e){return Object(u.a)(e)&&"fulfilled"===e.state&&e.value.length>0?e:t.geocode(i,n).then((function(e){return{state:"fulfilled",value:e}})).otherwise((function(e){return{state:"rejected",reason:e}}))}))}function cTe(e){return/^\s*$/.test(e)}function lTe(e){Dxe.getObservable(e,"_suggestions").removeAll()}Object(O.a)(rTe.prototype,{complete:{get:function(){return this._complete}},scene:{get:function(){return this._scene}},search:{get:function(){return this._searchCommand}},selectedSuggestion:{get:function(){return this._selectedSuggestion}},suggestions:{get:function(){return this._suggestions}}}),rTe.prototype.destroy=function(){this._suggestionSubscription.dispose()},rTe.flyToDestination=function(e,t){var i,n=e._scene,r=n.mapProjection.ellipsoid,a=n.camera,o=n.terrainProvider,s=t;t instanceof Ve?I.equalsEpsilon(t.south,t.north,I.EPSILON7)&&I.equalsEpsilon(t.east,t.west,I.EPSILON7)?t=Ve.center(t):i=Qse(t,n):t=r.cartesianToCartographic(t),Object(u.a)(i)||(i=function(e,t){var i=Object(u.a)(t)?t.availability:void 0;return Object(u.a)(i)?ES(t,[e]).then((function(t){return(e=t[0]).height+=nTe,e})):(e.height+=nTe,Oi.a.resolve(e))}(t,o)),i.then((function(e){s=r.cartographicToCartesian(e)})).always((function(){a.flyTo({destination:s,complete:function(){e._complete.raiseEvent()},duration:e._flightDuration,endTransform:Be.IDENTITY})}))},rTe._updateSearchSuggestions=function(e){if(e.autoComplete){var t=e._searchText;if(lTe(e),!cTe(t)){var i=Oi.a.resolve([]);e._geocoderServices.forEach((function(e){i=i.then((function(i){return i.length>=5?i:e.geocode(t,ty.AUTOCOMPLETE).then((function(e){return i=i.concat(e)}))}))})),i.then((function(t){for(var i=e._suggestions,n=0;n<t.length;n++)i.push(t[n])}))}}},rTe._adjustSuggestionsScroll=function(e,t){var i=zfe(e._viewContainer),n=i.getElementsByClassName("search-results")[0],r=i.getElementsByTagName("li")[t];if(0!==t){var a=r.offsetTop;a+r.clientHeight>n.clientHeight?n.scrollTop=a+r.clientHeight:a<n.scrollTop&&(n.scrollTop=a)}else n.scrollTop=0};var uTe=rTe,hTe="M29.772,26.433l-7.126-7.126c0.96-1.583,1.523-3.435,1.524-5.421C24.169,8.093,19.478,3.401,13.688,3.399C7.897,3.401,3.204,8.093,3.204,13.885c0,5.789,4.693,10.481,10.484,10.481c1.987,0,3.839-0.563,5.422-1.523l7.128,7.127L29.772,26.433zM7.203,13.885c0.006-3.582,2.903-6.478,6.484-6.486c3.579,0.008,6.478,2.904,6.484,6.486c-0.007,3.58-2.905,6.476-6.484,6.484C10.106,20.361,7.209,17.465,7.203,13.885z",dTe="M24.778,21.419 19.276,15.917 24.777,10.415 21.949,7.585 16.447,13.087 10.945,7.585 8.117,10.415 13.618,15.917 8.116,21.419 10.946,24.248 16.447,18.746 21.948,24.248z";function fTe(e){if(!Object(u.a)(e)||!Object(u.a)(e.container))throw new h.a("options.container is required.");if(!Object(u.a)(e.scene))throw new h.a("options.scene is required.");var t=zfe(e.container),i=new uTe(e);i._startSearchPath=hTe,i._stopSearchPath=dTe;var n=document.createElement("form");n.setAttribute("data-bind","submit: search");var r=document.createElement("input");r.type="search",r.className="cesium-geocoder-input",r.setAttribute("placeholder","Enter an address or landmark..."),r.setAttribute("data-bind",'textInput: searchText,disable: isSearchInProgress,event: { keyup: handleKeyUp, keydown: handleKeyDown, mouseover: deselectSuggestion },css: { "cesium-geocoder-input-wide" : keepExpanded || searchText.length > 0 },hasFocus: _focusTextbox'),this._onTextBoxFocus=function(){setTimeout((function(){r.select()}),0)},r.addEventListener("focus",this._onTextBoxFocus,!1),n.appendChild(r),this._textBox=r;var a=document.createElement("span");a.className="cesium-geocoder-searchButton",a.setAttribute("data-bind","click: search,cesiumSvgPath: { path: isSearchInProgress ? _stopSearchPath : _startSearchPath, width: 32, height: 32 }"),n.appendChild(a),t.appendChild(n);var o=document.createElement("div");o.className="search-results",o.setAttribute("data-bind","visible: _suggestionsVisible");var s=document.createElement("ul");s.setAttribute("data-bind","foreach: _suggestions");var c=document.createElement("li");s.appendChild(c),c.setAttribute("data-bind","text: $data.displayName, click: $parent.activateSuggestion, event: { mouseover: $parent.handleMouseover}, css: { active: $data === $parent._selectedSuggestion }"),o.appendChild(s),t.appendChild(o),Dxe.applyBindings(i,n),Dxe.applyBindings(i,o),this._container=t,this._searchSuggestionsContainer=o,this._viewModel=i,this._form=n,this._onInputBegin=function(e){t.contains(e.target)||(i._focusTextbox=!1,i.hideSuggestions())},this._onInputEnd=function(e){t.contains(e.target)&&(i._focusTextbox=!0,i.showSuggestions())},Ri.supportsPointerEvents()?(document.addEventListener("pointerdown",this._onInputBegin,!0),document.addEventListener("pointerup",this._onInputEnd,!0),document.addEventListener("pointercancel",this._onInputEnd,!0)):(document.addEventListener("mousedown",this._onInputBegin,!0),document.addEventListener("mouseup",this._onInputEnd,!0),document.addEventListener("touchstart",this._onInputBegin,!0),document.addEventListener("touchend",this._onInputEnd,!0),document.addEventListener("touchcancel",this._onInputEnd,!0))}Object(O.a)(fTe.prototype,{container:{get:function(){return this._container}},searchSuggestionsContainer:{get:function(){return this._searchSuggestionsContainer}},viewModel:{get:function(){return this._viewModel}}}),fTe.prototype.isDestroyed=function(){return!1},fTe.prototype.destroy=function(){return Ri.supportsPointerEvents()?(document.removeEventListener("pointerdown",this._onInputBegin,!0),document.removeEventListener("pointerup",this._onInputEnd,!0)):(document.removeEventListener("mousedown",this._onInputBegin,!0),document.removeEventListener("mouseup",this._onInputEnd,!0),document.removeEventListener("touchstart",this._onInputBegin,!0),document.removeEventListener("touchend",this._onInputEnd,!0)),this._viewModel.destroy(),Dxe.cleanNode(this._form),Dxe.cleanNode(this._searchSuggestionsContainer),this._container.removeChild(this._form),this._container.removeChild(this._searchSuggestionsContainer),this._textBox.removeEventListener("focus",this._onTextBoxFocus,!1),rl(this)};var pTe=fTe;function mTe(e,t){if(!Object(u.a)(e))throw new h.a("scene is required.");this._scene=e,this._duration=t;var i=this;this._command=Bxe((function(){i._scene.camera.flyHome(i._duration)})),this.tooltip="View Home",Dxe.track(this,["tooltip"])}Object(O.a)(mTe.prototype,{scene:{get:function(){return this._scene}},command:{get:function(){return this._command}},duration:{get:function(){return this._duration},set:function(e){if(Object(u.a)(e)&&e<0)throw new h.a("value must be positive.");this._duration=e}}});var _Te=mTe;function gTe(e,t,i){if(!Object(u.a)(e))throw new h.a("container is required.");e=zfe(e);var n=new _Te(t,i);n._svgPath="M14,4l-10,8.75h20l-4.25-3.7188v-4.6562h-2.812v2.1875l-2.938-2.5625zm-7.0938,9.906v10.094h14.094v-10.094h-14.094zm2.1876,2.313h3.3122v4.25h-3.3122v-4.25zm5.8442,1.281h3.406v6.438h-3.406v-6.438z";var r=document.createElement("button");r.type="button",r.className="cesium-button cesium-toolbar-button cesium-home-button",r.setAttribute("data-bind","attr: { title: tooltip },click: command,cesiumSvgPath: { path: _svgPath, width: 28, height: 28 }"),e.appendChild(r),Dxe.applyBindings(n,r),this._container=e,this._viewModel=n,this._element=r}Object(O.a)(gTe.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}}),gTe.prototype.isDestroyed=function(){return!1},gTe.prototype.destroy=function(){return Dxe.cleanNode(this._element),this._container.removeChild(this._element),rl(this)};var vTe=gTe,bTe="M 13.84375 7.03125 C 11.412798 7.03125 9.46875 8.975298 9.46875 11.40625 L 9.46875 11.59375 L 2.53125 7.21875 L 2.53125 24.0625 L 9.46875 19.6875 C 9.4853444 22.104033 11.423165 24.0625 13.84375 24.0625 L 25.875 24.0625 C 28.305952 24.0625 30.28125 22.087202 30.28125 19.65625 L 30.28125 11.40625 C 30.28125 8.975298 28.305952 7.03125 25.875 7.03125 L 13.84375 7.03125 z",yTe="M 27.34375 1.65625 L 5.28125 27.9375 L 8.09375 30.3125 L 30.15625 4.03125 L 27.34375 1.65625 z M 13.84375 7.03125 C 11.412798 7.03125 9.46875 8.975298 9.46875 11.40625 L 9.46875 11.59375 L 2.53125 7.21875 L 2.53125 24.0625 L 9.46875 19.6875 C 9.4724893 20.232036 9.5676108 20.7379 9.75 21.21875 L 21.65625 7.03125 L 13.84375 7.03125 z M 28.21875 7.71875 L 14.53125 24.0625 L 25.875 24.0625 C 28.305952 24.0625 30.28125 22.087202 30.28125 19.65625 L 30.28125 11.40625 C 30.28125 9.8371439 29.456025 8.4902779 28.21875 7.71875 z";function wTe(){this._cameraClicked=new $o.a,this._closeClicked=new $o.a,this.maxHeight=500,this.enableCamera=!1,this.isCameraTracking=!1,this.showInfo=!1,this.titleText="",this.description="",Dxe.track(this,["showInfo","titleText","description","maxHeight","enableCamera","isCameraTracking"]),this._loadingIndicatorHtml='<div class="cesium-infoBox-loadingContainer"><span class="cesium-infoBox-loading"></span></div>',this.cameraIconPath=void 0,Dxe.defineProperty(this,"cameraIconPath",{get:function(){return!this.enableCamera||this.isCameraTracking?yTe:bTe}}),Dxe.defineProperty(this,"_bodyless",{get:function(){return!Object(u.a)(this.description)||0===this.description.length}})}wTe.prototype.maxHeightOffset=function(e){return this.maxHeight-e+"px"},Object(O.a)(wTe.prototype,{cameraClicked:{get:function(){return this._cameraClicked}},closeClicked:{get:function(){return this._closeClicked}}});var OTe=wTe;function xTe(e){x.a.defined("container",e),e=zfe(e);var t=document.createElement("div");t.className="cesium-infoBox",t.setAttribute("data-bind",'css: { "cesium-infoBox-visible" : showInfo, "cesium-infoBox-bodyless" : _bodyless }'),e.appendChild(t);var i=document.createElement("div");i.className="cesium-infoBox-title",i.setAttribute("data-bind","text: titleText"),t.appendChild(i);var n=document.createElement("button");n.type="button",n.className="cesium-button cesium-infoBox-camera",n.setAttribute("data-bind",'attr: { title: "Focus camera on object" },click: function () { cameraClicked.raiseEvent(this); },enable: enableCamera,cesiumSvgPath: { path: cameraIconPath, width: 32, height: 32 }'),t.appendChild(n);var r=document.createElement("button");r.type="button",r.className="cesium-infoBox-close",r.setAttribute("data-bind","click: function () { closeClicked.raiseEvent(this); }"),r.innerHTML="&times;",t.appendChild(r);var a=document.createElement("iframe");a.className="cesium-infoBox-iframe",a.setAttribute("sandbox","allow-same-origin allow-popups allow-forms"),a.setAttribute("data-bind","style : { maxHeight : maxHeightOffset(40) }"),a.setAttribute("allowfullscreen",!0),t.appendChild(a);var o=new OTe;Dxe.applyBindings(o,t),this._container=e,this._element=t,this._frame=a,this._viewModel=o,this._descriptionSubscription=void 0;var s=this;a.addEventListener("load",(function(){var e=a.contentDocument,i=e.createElement("link");i.href=y("Widgets/InfoBox/InfoBoxDescription.css"),i.rel="stylesheet",i.type="text/css";var n=e.createElement("div");n.className="cesium-infoBox-description",e.head.appendChild(i),e.body.appendChild(n),s._descriptionSubscription=Vxe(o,"description",(function(e){a.style.height="5px",n.innerHTML=e;var i=null,r=n.firstElementChild;if(null!==r&&1===n.childNodes.length){var o=window.getComputedStyle(r);if(null!==o){var s=o["background-color"],c=uf.fromCssColorString(s);Object(u.a)(c)&&0!==c.alpha&&(i=o["background-color"])}}t.style["background-color"]=i;var l=n.getBoundingClientRect().height;a.style.height=l+"px"}))})),a.setAttribute("src","about:blank")}Object(O.a)(xTe.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}},frame:{get:function(){return this._frame}}}),xTe.prototype.isDestroyed=function(){return!1},xTe.prototype.destroy=function(){var e=this._container;return Dxe.cleanNode(this._element),e.removeChild(this._element),Object(u.a)(this._descriptionSubscription)&&this._descriptionSubscription.dispose(),rl(this)};var ETe=xTe;function TTe(){this.showInstructions=!1;var e=this;this._command=Bxe((function(){e.showInstructions=!e.showInstructions})),this._showClick=Bxe((function(){e._touch=!1})),this._showTouch=Bxe((function(){e._touch=!0})),this._touch=!1,this.tooltip="Navigation Instructions",Dxe.track(this,["tooltip","showInstructions","_touch"])}Object(O.a)(TTe.prototype,{command:{get:function(){return this._command}},showClick:{get:function(){return this._showClick}},showTouch:{get:function(){return this._showTouch}}});var CTe=TTe;function STe(e){if(!Object(u.a)(e)||!Object(u.a)(e.container))throw new h.a("options.container is required.");var t=zfe(e.container),i=new CTe,n=Object(w.a)(e.instructionsInitiallyVisible,!1);i.showInstructions=n,i._svgPath="M16,1.466C7.973,1.466,1.466,7.973,1.466,16c0,8.027,6.507,14.534,14.534,14.534c8.027,0,14.534-6.507,14.534-14.534C30.534,7.973,24.027,1.466,16,1.466z M17.328,24.371h-2.707v-2.596h2.707V24.371zM17.328,19.003v0.858h-2.707v-1.057c0-3.19,3.63-3.696,3.63-5.963c0-1.034-0.924-1.826-2.134-1.826c-1.254,0-2.354,0.924-2.354,0.924l-1.541-1.915c0,0,1.519-1.584,4.137-1.584c2.487,0,4.796,1.54,4.796,4.136C21.156,16.208,17.328,16.627,17.328,19.003z";var r=document.createElement("span");r.className="cesium-navigationHelpButton-wrapper",t.appendChild(r);var a=document.createElement("button");a.type="button",a.className="cesium-button cesium-toolbar-button cesium-navigation-help-button",a.setAttribute("data-bind","attr: { title: tooltip },click: command,cesiumSvgPath: { path: _svgPath, width: 32, height: 32 }"),r.appendChild(a);var o=document.createElement("div");o.className="cesium-navigation-help",o.setAttribute("data-bind",'css: { "cesium-navigation-help-visible" : showInstructions}'),r.appendChild(o);var s=document.createElement("button");s.type="button",s.className="cesium-navigation-button cesium-navigation-button-left",s.setAttribute("data-bind",'click: showClick, css: {"cesium-navigation-button-selected": !_touch, "cesium-navigation-button-unselected": _touch}');var c=document.createElement("img");c.src=y("Widgets/Images/NavigationHelp/Mouse.svg"),c.className="cesium-navigation-button-icon",c.style.width="25px",c.style.height="25px",s.appendChild(c),s.appendChild(document.createTextNode("Mouse"));var l=document.createElement("button");l.type="button",l.className="cesium-navigation-button cesium-navigation-button-right",l.setAttribute("data-bind",'click: showTouch, css: {"cesium-navigation-button-selected": _touch, "cesium-navigation-button-unselected": !_touch}');var d=document.createElement("img");d.src=y("Widgets/Images/NavigationHelp/Touch.svg"),d.className="cesium-navigation-button-icon",d.style.width="25px",d.style.height="25px",l.appendChild(d),l.appendChild(document.createTextNode("Touch")),o.appendChild(s),o.appendChild(l);var f=document.createElement("div");f.className="cesium-click-navigation-help cesium-navigation-help-instructions",f.setAttribute("data-bind",'css: { "cesium-click-navigation-help-visible" : !_touch}'),f.innerHTML='            <table>                <tr>                    <td><img src="'+y("Widgets/Images/NavigationHelp/MouseLeft.svg")+'" width="48" height="48" /></td>                    <td>                        <div class="cesium-navigation-help-pan">Pan view</div>                        <div class="cesium-navigation-help-details">Left click + drag</div>                    </td>                </tr>                <tr>                    <td><img src="'+y("Widgets/Images/NavigationHelp/MouseRight.svg")+'" width="48" height="48" /></td>                    <td>                        <div class="cesium-navigation-help-zoom">Zoom view</div>                        <div class="cesium-navigation-help-details">Right click + drag, or</div>                        <div class="cesium-navigation-help-details">Mouse wheel scroll</div>                    </td>                </tr>                <tr>                    <td><img src="'+y("Widgets/Images/NavigationHelp/MouseMiddle.svg")+'" width="48" height="48" /></td>                    <td>                        <div class="cesium-navigation-help-rotate">Rotate view</div>                        <div class="cesium-navigation-help-details">Middle click + drag, or</div>                        <div class="cesium-navigation-help-details">CTRL + Left/Right click + drag</div>                    </td>                </tr>            </table>',o.appendChild(f);var p=document.createElement("div");p.className="cesium-touch-navigation-help cesium-navigation-help-instructions",p.setAttribute("data-bind",'css: { "cesium-touch-navigation-help-visible" : _touch}'),p.innerHTML='            <table>                <tr>                    <td><img src="'+y("Widgets/Images/NavigationHelp/TouchDrag.svg")+'" width="70" height="48" /></td>                    <td>                        <div class="cesium-navigation-help-pan">Pan view</div>                        <div class="cesium-navigation-help-details">One finger drag</div>                    </td>                </tr>                <tr>                    <td><img src="'+y("Widgets/Images/NavigationHelp/TouchZoom.svg")+'" width="70" height="48" /></td>                    <td>                        <div class="cesium-navigation-help-zoom">Zoom view</div>                        <div class="cesium-navigation-help-details">Two finger pinch</div>                    </td>                </tr>                <tr>                    <td><img src="'+y("Widgets/Images/NavigationHelp/TouchTilt.svg")+'" width="70" height="48" /></td>                    <td>                        <div class="cesium-navigation-help-rotate">Tilt view</div>                        <div class="cesium-navigation-help-details">Two finger drag, same direction</div>                    </td>                </tr>                <tr>                    <td><img src="'+y("Widgets/Images/NavigationHelp/TouchRotate.svg")+'" width="70" height="48" /></td>                    <td>                        <div class="cesium-navigation-help-tilt">Rotate view</div>                        <div class="cesium-navigation-help-details">Two finger drag, opposite direction</div>                    </td>                </tr>            </table>',o.appendChild(p),Dxe.applyBindings(i,r),this._container=t,this._viewModel=i,this._wrapper=r,this._closeInstructions=function(e){r.contains(e.target)||(i.showInstructions=!1)},Ri.supportsPointerEvents()?document.addEventListener("pointerdown",this._closeInstructions,!0):(document.addEventListener("mousedown",this._closeInstructions,!0),document.addEventListener("touchstart",this._closeInstructions,!0))}Object(O.a)(STe.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}}),STe.prototype.isDestroyed=function(){return!1},STe.prototype.destroy=function(){return Ri.supportsPointerEvents()?document.removeEventListener("pointerdown",this._closeInstructions,!0):(document.removeEventListener("mousedown",this._closeInstructions,!0),document.removeEventListener("touchstart",this._closeInstructions,!0)),Dxe.cleanNode(this._wrapper),this._container.removeChild(this._wrapper),rl(this)};var ATe=STe;function PTe(e){if(!Object(u.a)(e)||!Object(u.a)(e.scene))throw new h.a("options.scene is required.");this._scene=e.scene,this.lowFrameRateMessage=Object(w.a)(e.lowFrameRateMessage,"This application appears to be performing poorly on your system.  Please try using a different web browser or updating your video drivers."),this.lowFrameRateMessageDismissed=!1,this.showingLowFrameRateMessage=!1,Dxe.track(this,["lowFrameRateMessage","lowFrameRateMessageDismissed","showingLowFrameRateMessage"]);var t=this;this._dismissMessage=Bxe((function(){t.showingLowFrameRateMessage=!1,t.lowFrameRateMessageDismissed=!0}));var i=Cue.fromScene(e.scene);this._unsubscribeLowFrameRate=i.lowFrameRate.addEventListener((function(){t.lowFrameRateMessageDismissed||(t.showingLowFrameRateMessage=!0)})),this._unsubscribeNominalFrameRate=i.nominalFrameRate.addEventListener((function(){t.showingLowFrameRateMessage=!1}))}Object(O.a)(PTe.prototype,{scene:{get:function(){return this._scene}},dismissMessage:{get:function(){return this._dismissMessage}}}),PTe.prototype.destroy=function(){return this._unsubscribeLowFrameRate(),this._unsubscribeNominalFrameRate(),rl(this)};var ITe=PTe;function DTe(e){if(!Object(u.a)(e)||!Object(u.a)(e.container))throw new h.a("options.container is required.");if(!Object(u.a)(e.scene))throw new h.a("options.scene is required.");var t=zfe(e.container),i=new ITe(e),n=document.createElement("div");n.className="cesium-performance-watchdog-message-area",n.setAttribute("data-bind","visible: showingLowFrameRateMessage");var r=document.createElement("button");r.setAttribute("type","button"),r.className="cesium-performance-watchdog-message-dismiss",r.innerHTML="&times;",r.setAttribute("data-bind","click: dismissMessage"),n.appendChild(r);var a=document.createElement("div");a.className="cesium-performance-watchdog-message",a.setAttribute("data-bind","html: lowFrameRateMessage"),n.appendChild(a),t.appendChild(n),Dxe.applyBindings(i,n),this._container=t,this._viewModel=i,this._element=n}Object(O.a)(DTe.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}}),DTe.prototype.isDestroyed=function(){return!1},DTe.prototype.destroy=function(){return this._viewModel.destroy(),Dxe.cleanNode(this._element),this._container.removeChild(this._element),rl(this)};var jTe=DTe;function MTe(e){if(!Object(u.a)(e))throw new h.a("scene is required.");this._scene=e,this._orthographic=e.camera.frustum instanceof hb,this._flightInProgress=!1,this.dropDownVisible=!1,this.tooltipPerspective="Perspective Projection",this.tooltipOrthographic="Orthographic Projection",this.selectedTooltip=void 0,this.sceneMode=e.mode,Dxe.track(this,["_orthographic","_flightInProgress","sceneMode","dropDownVisible","tooltipPerspective","tooltipOrthographic"]);var t=this;Dxe.defineProperty(this,"selectedTooltip",(function(){return t._orthographic?t.tooltipOrthographic:t.tooltipPerspective})),this._toggleDropDown=Bxe((function(){t.sceneMode===xF.SCENE2D||t._flightInProgress||(t.dropDownVisible=!t.dropDownVisible)})),this._eventHelper=new eb,this._eventHelper.add(e.morphComplete,(function(e,i,n,r){t.sceneMode=n,t._orthographic=n===xF.SCENE2D||t._scene.camera.frustum instanceof hb})),this._eventHelper.add(e.preRender,(function(){t._flightInProgress=Object(u.a)(e.camera._currentFlight)})),this._switchToPerspective=Bxe((function(){t.sceneMode!==xF.SCENE2D&&(t._scene.camera.switchToPerspectiveFrustum(),t._orthographic=!1,t.dropDownVisible=!1)})),this._switchToOrthographic=Bxe((function(){t.sceneMode!==xF.SCENE2D&&(t._scene.camera.switchToOrthographicFrustum(),t._orthographic=!0,t.dropDownVisible=!1)})),this._sceneMode=xF}Object(O.a)(MTe.prototype,{scene:{get:function(){return this._scene}},toggleDropDown:{get:function(){return this._toggleDropDown}},switchToPerspective:{get:function(){return this._switchToPerspective}},switchToOrthographic:{get:function(){return this._switchToOrthographic}},isOrthographicProjection:{get:function(){return this._orthographic}}}),MTe.prototype.isDestroyed=function(){return!1},MTe.prototype.destroy=function(){this._eventHelper.removeAll(),rl(this)};var RTe=MTe,LTe="M 28.15625,10.4375 9.125,13.21875 13.75,43.25 41.75,55.09375 50.8125,37 54.5,11.9375 z m 0.125,3 19.976451,0.394265 L 43.03125,16.875 22.6875,14.28125 z M 50.971746,15.705477 47.90625,36.03125 42.53125,46 44.84375,19.3125 z M 12.625,16.03125 l 29.15625,3.6875 -2.65625,31 L 16.4375,41.125 z",NTe="m 31.560594,6.5254438 -20.75,12.4687502 0.1875,24.5625 22.28125,11.8125 19.5,-12 0.65625,-0.375 0,-0.75 0.0312,-23.21875 z m 0.0625,3.125 16.65625,9.5000002 -16.125,10.28125 -17.34375,-9.71875 z m 18.96875,11.1875002 0.15625,20.65625 -17.46875,10.59375 0.15625,-20.28125 z m -37.0625,1.25 17.21875,9.625 -0.15625,19.21875 -16.9375,-9 z";function FTe(e,t){if(!Object(u.a)(e))throw new h.a("container is required.");if(!Object(u.a)(t))throw new h.a("scene is required.");e=zfe(e);var i=new RTe(t);i._perspectivePath=LTe,i._orthographicPath=NTe;var n=document.createElement("span");n.className="cesium-projectionPicker-wrapper cesium-toolbar-button",e.appendChild(n);var r=document.createElement("button");r.type="button",r.className="cesium-button cesium-toolbar-button",r.setAttribute("data-bind",'css: { "cesium-projectionPicker-buttonPerspective": !_orthographic,       "cesium-projectionPicker-buttonOrthographic": _orthographic,       "cesium-button-disabled" : sceneMode === _sceneMode.SCENE2D || _flightInProgress,        "cesium-projectionPicker-selected": dropDownVisible },attr: { title: selectedTooltip },click: toggleDropDown'),r.innerHTML='\x3c!-- ko cesiumSvgPath: { path: _perspectivePath, width: 64, height: 64, css: "cesium-projectionPicker-iconPerspective" } --\x3e\x3c!-- /ko --\x3e\x3c!-- ko cesiumSvgPath: { path: _orthographicPath, width: 64, height: 64, css: "cesium-projectionPicker-iconOrthographic" } --\x3e\x3c!-- /ko --\x3e',n.appendChild(r);var a=document.createElement("button");a.type="button",a.className="cesium-button cesium-toolbar-button cesium-projectionPicker-dropDown-icon",a.setAttribute("data-bind",'css: { "cesium-projectionPicker-visible" : (dropDownVisible && _orthographic),       "cesium-projectionPicker-none" : !_orthographic,       "cesium-projectionPicker-hidden" : !dropDownVisible },attr: { title: tooltipPerspective },click: switchToPerspective,cesiumSvgPath: { path: _perspectivePath, width: 64, height: 64 }'),n.appendChild(a);var o=document.createElement("button");o.type="button",o.className="cesium-button cesium-toolbar-button cesium-projectionPicker-dropDown-icon",o.setAttribute("data-bind",'css: { "cesium-projectionPicker-visible" : (dropDownVisible && !_orthographic),       "cesium-projectionPicker-none" : _orthographic,       "cesium-projectionPicker-hidden" : !dropDownVisible},attr: { title: tooltipOrthographic },click: switchToOrthographic,cesiumSvgPath: { path: _orthographicPath, width: 64, height: 64 }'),n.appendChild(o),Dxe.applyBindings(i,n),this._viewModel=i,this._container=e,this._wrapper=n,this._closeDropDown=function(e){n.contains(e.target)||(i.dropDownVisible=!1)},Ri.supportsPointerEvents()?document.addEventListener("pointerdown",this._closeDropDown,!0):(document.addEventListener("mousedown",this._closeDropDown,!0),document.addEventListener("touchstart",this._closeDropDown,!0))}Object(O.a)(FTe.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}}),FTe.prototype.isDestroyed=function(){return!1},FTe.prototype.destroy=function(){return this._viewModel.destroy(),Ri.supportsPointerEvents()?document.removeEventListener("pointerdown",this._closeDropDown,!0):(document.removeEventListener("mousedown",this._closeDropDown,!0),document.removeEventListener("touchstart",this._closeDropDown,!0)),Dxe.cleanNode(this._wrapper),this._container.removeChild(this._wrapper),rl(this)};var kTe=FTe;function BTe(e,t){if(!Object(u.a)(e))throw new h.a("scene is required.");this._scene=e;var i=this;this._eventHelper=new eb,this._eventHelper.add(e.morphStart,(function(e,t,n,r){i.sceneMode=n,i.dropDownVisible=!1})),this._duration=Object(w.a)(t,2),this.sceneMode=e.mode,this.dropDownVisible=!1,this.tooltip2D="2D",this.tooltip3D="3D",this.tooltipColumbusView="Columbus View",Dxe.track(this,["sceneMode","dropDownVisible","tooltip2D","tooltip3D","tooltipColumbusView"]),this.selectedTooltip=void 0,Dxe.defineProperty(this,"selectedTooltip",(function(){var e=i.sceneMode;return e===xF.SCENE2D?i.tooltip2D:e===xF.SCENE3D?i.tooltip3D:i.tooltipColumbusView})),this._toggleDropDown=Bxe((function(){i.dropDownVisible=!i.dropDownVisible})),this._morphTo2D=Bxe((function(){e.morphTo2D(i._duration)})),this._morphTo3D=Bxe((function(){e.morphTo3D(i._duration)})),this._morphToColumbusView=Bxe((function(){e.morphToColumbusView(i._duration)})),this._sceneMode=xF}Object(O.a)(BTe.prototype,{scene:{get:function(){return this._scene}},duration:{get:function(){return this._duration},set:function(e){if(e<0)throw new h.a("duration value must be positive.");this._duration=e}},toggleDropDown:{get:function(){return this._toggleDropDown}},morphTo2D:{get:function(){return this._morphTo2D}},morphTo3D:{get:function(){return this._morphTo3D}},morphToColumbusView:{get:function(){return this._morphToColumbusView}}}),BTe.prototype.isDestroyed=function(){return!1},BTe.prototype.destroy=function(){this._eventHelper.removeAll(),rl(this)};var zTe=BTe,UTe="m 32.401392,4.9330437 c -7.087603,0 -14.096095,2.884602 -19.10793,7.8946843 -5.0118352,5.010083 -7.9296167,11.987468 -7.9296167,19.072999 0,7.085531 2.9177815,14.097848 7.9296167,19.107931 4.837653,4.835961 11.541408,7.631372 18.374354,7.82482 0.05712,0.01231 0.454119,0.139729 0.454119,0.139729 l 0.03493,-0.104797 c 0.08246,7.84e-4 0.162033,0.03493 0.244525,0.03493 0.08304,0 0.161515,-0.03414 0.244526,-0.03493 l 0.03493,0.104797 c 0,0 0.309474,-0.129487 0.349323,-0.139729 6.867765,-0.168094 13.582903,-2.965206 18.444218,-7.82482 2.558195,-2.5573 4.551081,-5.638134 5.903547,-8.977584 1.297191,-3.202966 2.02607,-6.661489 2.02607,-10.130347 0,-6.237309 -2.366261,-12.31219 -6.322734,-17.116794 -0.0034,-0.02316 0.0049,-0.04488 0,-0.06986 -0.01733,-0.08745 -0.104529,-0.278855 -0.104797,-0.279458 -5.31e-4,-0.0012 -0.522988,-0.628147 -0.523984,-0.62878         -3.47e-4,-2.2e-4 -0.133444,-0.03532 -0.244525,-0.06987 C 51.944299,13.447603 51.751076,13.104317 51.474391,12.827728 46.462556,7.8176457 39.488996,4.9330437 32.401392,4.9330437 z m -2.130866,3.5281554 0.104797,9.6762289 c -4.111695,-0.08361 -7.109829,-0.423664 -9.257041,-0.943171 1.198093,-2.269271 2.524531,-4.124404 3.91241,-5.414496 2.167498,-2.0147811 3.950145,-2.8540169 5.239834,-3.3185619 z m 2.794579,0 c 1.280302,0.4754953 3.022186,1.3285948 5.065173,3.2486979 1.424667,1.338973 2.788862,3.303645 3.982275,5.728886 -2.29082,0.403367 -5.381258,0.621049 -8.942651,0.698645 L 33.065105,8.4611991 z m 5.728886,0.2445256 c 4.004072,1.1230822 7.793098,3.1481363 10.724195,6.0782083 0.03468,0.03466 0.07033,0.06991 0.104797,0.104797 -0.45375,0.313891 -0.923054,0.663002 -1.956205,1.082899 -0.647388,0.263114 -1.906242,0.477396 -2.829511,0.733577 -1.382296,-2.988132         -3.027146,-5.368585 -4.785716,-7.0213781 -0.422866,-0.397432 -0.835818,-0.6453247 -1.25756,-0.9781032 z m -15.33525,0.7685092 c -0.106753,0.09503 -0.207753,0.145402 -0.31439,0.244526 -1.684973,1.5662541 -3.298068,3.8232211 -4.680919,6.5672591 -0.343797,-0.14942 -1.035052,-0.273198 -1.292493,-0.419186 -0.956528,-0.542427 -1.362964,-1.022024 -1.537018,-1.292493 -0.0241,-0.03745 -0.01868,-0.0401 -0.03493,-0.06986 2.250095,-2.163342 4.948824,-3.869984 7.859752,-5.0302421 z m -9.641296,7.0912431 c 0.464973,0.571618 0.937729,1.169056 1.956205,1.746612 0.349907,0.198425 1.107143,0.335404 1.537018,0.523983 -1.20166,3.172984 -1.998037,7.051901 -2.165798,11.772162 C 14.256557,30.361384 12.934823,30.161483 12.280427,29.90959 10.644437,29.279855 9.6888882,28.674891 9.1714586,28.267775 8.6540289,27.860658 8.6474751,27.778724 8.6474751,27.778724 l -0.069864,0.03493 C 9.3100294,23.691285         11.163248,19.798527 13.817445,16.565477 z m 37.552149,0.523984 c 2.548924,3.289983 4.265057,7.202594 4.890513,11.318043 -0.650428,0.410896 -1.756876,1.001936 -3.563088,1.606882 -1.171552,0.392383 -3.163859,0.759153 -4.960377,1.117832 -0.04367,-4.752703 -0.784809,-8.591423 -1.88634,-11.807094 0.917574,-0.263678 2.170552,-0.486495 2.864443,-0.76851 1.274693,-0.518066 2.003942,-1.001558 2.654849,-1.467153 z m -31.439008,2.619917 c 2.487341,0.672766 5.775813,1.137775 10.479669,1.222628 l 0.104797,10.689263 0,0.03493 0,0.733577 c -5.435005,-0.09059 -9.512219,-0.519044 -12.610536,-1.117831 0.106127,-4.776683 0.879334,-8.55791 2.02607,-11.562569 z m 23.264866,0.31439 c 1.073459,3.067541 1.833795,6.821314 1.816476,11.702298 -3.054474,0.423245 -7.062018,0.648559 -11.702298,0.698644 l 0,-0.838373 -0.104796,-10.654331 c 4.082416,-0.0864 7.404468,-0.403886 9.990618,-0.908238 z         M 8.2632205,30.922625 c 0.7558676,0.510548 1.5529563,1.013339 3.0041715,1.57195 0.937518,0.360875 2.612202,0.647642 3.91241,0.978102 0.112814,3.85566 0.703989,7.107756 1.606883,9.920754 -1.147172,-0.324262 -2.644553,-0.640648 -3.423359,-0.978102 -1.516688,-0.657177 -2.386627,-1.287332 -2.864443,-1.71168 -0.477816,-0.424347 -0.489051,-0.489051 -0.489051,-0.489051 L 9.8002387,40.319395 C 8.791691,37.621767 8.1584238,34.769583 8.1584238,31.900727 c 0,-0.330153 0.090589,-0.648169 0.1047967,-0.978102 z m 48.2763445,0.419186 c 0.0047,0.188973 0.06986,0.36991 0.06986,0.558916 0,2.938869 -0.620228,5.873558 -1.676747,8.628261 -0.07435,0.07583 -0.06552,0.07411 -0.454119,0.349323 -0.606965,0.429857 -1.631665,1.042044 -3.318562,1.676747 -1.208528,0.454713 -3.204964,0.850894 -5.135038,1.25756 0.84593,-2.765726 1.41808,-6.005357 1.606883,-9.815957 2.232369,-0.413371 4.483758,-0.840201         5.938479,-1.327425 1.410632,-0.472457 2.153108,-0.89469 2.96924,-1.327425 z m -38.530252,2.864443 c 3.208141,0.56697 7.372279,0.898588 12.575603,0.978103 l 0.174662,9.885821 c -4.392517,-0.06139 -8.106722,-0.320566 -10.863925,-0.803441 -1.051954,-2.664695 -1.692909,-6.043794 -1.88634,-10.060483 z m 26.793022,0.31439 c -0.246298,3.923551 -0.877762,7.263679 -1.816476,9.885822 -2.561957,0.361954 -5.766249,0.560708 -9.431703,0.62878 l -0.174661,-9.815957 c 4.491734,-0.04969 8.334769,-0.293032 11.42284,-0.698645 z M 12.035901,44.860585 c 0.09977,0.04523 0.105535,0.09465 0.209594,0.139729 1.337656,0.579602 3.441099,1.058072 5.589157,1.537018 1.545042,3.399208 3.548524,5.969402 5.589157,7.789888 -3.034411,-1.215537 -5.871615,-3.007978 -8.174142,-5.309699 -1.245911,-1.245475 -2.271794,-2.662961 -3.213766,-4.156936 z m 40.69605,0 c -0.941972,1.493975 -1.967855,2.911461         -3.213765,4.156936 -2.74253,2.741571 -6.244106,4.696717 -9.955686,5.868615 0.261347,-0.241079 0.507495,-0.394491 0.768509,-0.663713 1.674841,-1.727516 3.320792,-4.181056 4.645987,-7.265904 2.962447,-0.503021 5.408965,-1.122293 7.161107,-1.781544 0.284034,-0.106865 0.337297,-0.207323 0.593848,-0.31439 z m -31.404076,2.305527 c 2.645807,0.376448 5.701178,0.649995 9.466635,0.698645 l 0.139729,7.789888 c -1.38739,-0.480844 -3.316218,-1.29837 -5.659022,-3.388427 -1.388822,-1.238993 -2.743668,-3.0113 -3.947342,-5.100106 z m 20.365491,0.104797 c -1.04872,2.041937 -2.174337,3.779068 -3.353494,4.995309 -1.853177,1.911459 -3.425515,2.82679 -4.611055,3.353494 l -0.139729,-7.789887 c 3.13091,-0.05714 5.728238,-0.278725 8.104278,-0.558916 z",VTe="m 2.9825053,17.550598 0,1.368113 0,26.267766 0,1.368113 1.36811,0 54.9981397,0 1.36811,0 0,-1.368113 0,-26.267766 0,-1.368113 -1.36811,0 -54.9981397,0 -1.36811,0 z m 2.73623,2.736226 10.3292497,0 0,10.466063 -10.3292497,0 0,-10.466063 z m 13.0654697,0 11.69737,0 0,10.466063 -11.69737,0 0,-10.466063 z m 14.43359,0 11.69737,0 0,10.466063 -11.69737,0 0,-10.466063 z m 14.43359,0 10.32926,0 0,10.466063 -10.32926,0 0,-10.466063 z m -41.9326497,13.202288 10.3292497,0 0,10.329252 -10.3292497,0 0,-10.329252 z m 13.0654697,0 11.69737,0 0,10.329252 -11.69737,0 0,-10.329252 z m 14.43359,0 11.69737,0 0,10.329252 -11.69737,0 0,-10.329252 z m 14.43359,0 10.32926,0 0,10.329252 -10.32926,0 0,-10.329252 z",HTe="m 14.723969,17.675598 -0.340489,0.817175 -11.1680536,26.183638 -0.817175,1.872692 2.076986,0 54.7506996,0 2.07698,0 -0.81717,-1.872692 -11.16805,-26.183638 -0.34049,-0.817175 -0.91933,0 -32.414586,0 -0.919322,0 z m 1.838643,2.723916 6.196908,0 -2.928209,10.418977 -7.729111,0 4.460412,-10.418977 z m 9.02297,0 4.903049,0 0,10.418977 -7.831258,0 2.928209,-10.418977 z m 7.626964,0 5.584031,0 2.62176,10.418977 -8.205791,0 0,-10.418977 z m 8.410081,0 5.51593,0 4.46042,10.418977 -7.38863,0 -2.58772,-10.418977 z m -30.678091,13.142892 8.103649,0 -2.89416,10.282782 -9.6018026,0 4.3923136,-10.282782 z m 10.929711,0 8.614384,0 0,10.282782 -11.508544,0 2.89416,-10.282782 z m 11.338299,0 8.852721,0 2.58772,10.282782 -11.440441,0 0,-10.282782 z m 11.678781,0 7.86531,0 4.39231,10.282782 -9.6699,0 -2.58772,-10.282782 z";function GTe(e,t,i){if(!Object(u.a)(e))throw new h.a("container is required.");if(!Object(u.a)(t))throw new h.a("scene is required.");e=zfe(e);var n=new zTe(t,i);n._globePath=UTe,n._flatMapPath=VTe,n._columbusViewPath=HTe;var r=document.createElement("span");r.className="cesium-sceneModePicker-wrapper cesium-toolbar-button",e.appendChild(r);var a=document.createElement("button");a.type="button",a.className="cesium-button cesium-toolbar-button",a.setAttribute("data-bind",'css: { "cesium-sceneModePicker-button2D": sceneMode === _sceneMode.SCENE2D,       "cesium-sceneModePicker-button3D": sceneMode === _sceneMode.SCENE3D,       "cesium-sceneModePicker-buttonColumbusView": sceneMode === _sceneMode.COLUMBUS_VIEW,       "cesium-sceneModePicker-selected": dropDownVisible },attr: { title: selectedTooltip },click: toggleDropDown'),a.innerHTML='\x3c!-- ko cesiumSvgPath: { path: _globePath, width: 64, height: 64, css: "cesium-sceneModePicker-slide-svg cesium-sceneModePicker-icon3D" } --\x3e\x3c!-- /ko --\x3e\x3c!-- ko cesiumSvgPath: { path: _flatMapPath, width: 64, height: 64, css: "cesium-sceneModePicker-slide-svg cesium-sceneModePicker-icon2D" } --\x3e\x3c!-- /ko --\x3e\x3c!-- ko cesiumSvgPath: { path: _columbusViewPath, width: 64, height: 64, css: "cesium-sceneModePicker-slide-svg cesium-sceneModePicker-iconColumbusView" } --\x3e\x3c!-- /ko --\x3e',r.appendChild(a);var o=document.createElement("button");o.type="button",o.className="cesium-button cesium-toolbar-button cesium-sceneModePicker-dropDown-icon",o.setAttribute("data-bind",'css: { "cesium-sceneModePicker-visible" : (dropDownVisible && (sceneMode !== _sceneMode.SCENE3D)) || (!dropDownVisible && (sceneMode === _sceneMode.SCENE3D)),       "cesium-sceneModePicker-none" : sceneMode === _sceneMode.SCENE3D,       "cesium-sceneModePicker-hidden" : !dropDownVisible },attr: { title: tooltip3D },click: morphTo3D,cesiumSvgPath: { path: _globePath, width: 64, height: 64 }'),r.appendChild(o);var s=document.createElement("button");s.type="button",s.className="cesium-button cesium-toolbar-button cesium-sceneModePicker-dropDown-icon",s.setAttribute("data-bind",'css: { "cesium-sceneModePicker-visible" : (dropDownVisible && (sceneMode !== _sceneMode.SCENE2D)),       "cesium-sceneModePicker-none" : sceneMode === _sceneMode.SCENE2D,       "cesium-sceneModePicker-hidden" : !dropDownVisible },attr: { title: tooltip2D },click: morphTo2D,cesiumSvgPath: { path: _flatMapPath, width: 64, height: 64 }'),r.appendChild(s);var c=document.createElement("button");c.type="button",c.className="cesium-button cesium-toolbar-button cesium-sceneModePicker-dropDown-icon",c.setAttribute("data-bind",'css: { "cesium-sceneModePicker-visible" : (dropDownVisible && (sceneMode !== _sceneMode.COLUMBUS_VIEW)) || (!dropDownVisible && (sceneMode === _sceneMode.COLUMBUS_VIEW)),       "cesium-sceneModePicker-none" : sceneMode === _sceneMode.COLUMBUS_VIEW,       "cesium-sceneModePicker-hidden" : !dropDownVisible},attr: { title: tooltipColumbusView },click: morphToColumbusView,cesiumSvgPath: { path: _columbusViewPath, width: 64, height: 64 }'),r.appendChild(c),Dxe.applyBindings(n,r),this._viewModel=n,this._container=e,this._wrapper=r,this._closeDropDown=function(e){r.contains(e.target)||(n.dropDownVisible=!1)},Ri.supportsPointerEvents()?document.addEventListener("pointerdown",this._closeDropDown,!0):(document.addEventListener("mousedown",this._closeDropDown,!0),document.addEventListener("touchstart",this._closeDropDown,!0))}Object(O.a)(GTe.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}}),GTe.prototype.isDestroyed=function(){return!1},GTe.prototype.destroy=function(){return this._viewModel.destroy(),Ri.supportsPointerEvents()?document.removeEventListener("pointerdown",this._closeDropDown,!0):(document.removeEventListener("mousedown",this._closeDropDown,!0),document.removeEventListener("touchstart",this._closeDropDown,!0)),Dxe.cleanNode(this._wrapper),this._container.removeChild(this._wrapper),rl(this)};var qTe=GTe,WTe=new Rt,YTe="-1000px";function XTe(e,t,i){if(!Object(u.a)(e))throw new h.a("scene is required.");if(!Object(u.a)(t))throw new h.a("selectionIndicatorElement is required.");if(!Object(u.a)(i))throw new h.a("container is required.");this._scene=e,this._screenPositionX=YTe,this._screenPositionY=YTe,this._tweens=e.tweens,this._container=Object(w.a)(i,document.body),this._selectionIndicatorElement=t,this._scale=1,this.position=void 0,this.showSelection=!1,Dxe.track(this,["position","_screenPositionX","_screenPositionY","_scale","showSelection"]),this.isVisible=void 0,Dxe.defineProperty(this,"isVisible",{get:function(){return this.showSelection&&Object(u.a)(this.position)}}),Dxe.defineProperty(this,"_transform",{get:function(){return"scale("+this._scale+")"}}),this.computeScreenSpacePosition=function(t,i){return gV.wgs84ToWindowCoordinates(e,t,i)}}XTe.prototype.update=function(){if(this.showSelection&&Object(u.a)(this.position)){var e=this.computeScreenSpacePosition(this.position,WTe);if(Object(u.a)(e)){var t=this._container,i=t.parentNode.clientWidth,n=t.parentNode.clientHeight,r=this._selectionIndicatorElement.clientWidth,a=.5*r;e.x=Math.min(Math.max(e.x,-r),i+r)-a,e.y=Math.min(Math.max(e.y,-r),n+r)-a,this._screenPositionX=Math.floor(e.x+.25)+"px",this._screenPositionY=Math.floor(e.y+.25)+"px"}else this._screenPositionX=YTe,this._screenPositionY=YTe}},XTe.prototype.animateAppear=function(){this._tweens.addProperty({object:this,property:"_scale",startValue:2,stopValue:1,duration:.8,easingFunction:Pv.EXPONENTIAL_OUT})},XTe.prototype.animateDepart=function(){this._tweens.addProperty({object:this,property:"_scale",startValue:this._scale,stopValue:1.5,duration:.8,easingFunction:Pv.EXPONENTIAL_OUT})},Object(O.a)(XTe.prototype,{container:{get:function(){return this._container}},selectionIndicatorElement:{get:function(){return this._selectionIndicatorElement}},scene:{get:function(){return this._scene}}});var ZTe=XTe;function QTe(e,t){if(!Object(u.a)(e))throw new h.a("container is required.");e=zfe(e),this._container=e;var i=document.createElement("div");i.className="cesium-selection-wrapper",i.setAttribute("data-bind",'style: { "top" : _screenPositionY, "left" : _screenPositionX },css: { "cesium-selection-wrapper-visible" : isVisible }'),e.appendChild(i),this._element=i;var n="http://www.w3.org/2000/svg",r=document.createElementNS(n,"svg:svg");r.setAttribute("width",160),r.setAttribute("height",160),r.setAttribute("viewBox","0 0 160 160");var a=document.createElementNS(n,"g");a.setAttribute("transform","translate(80,80)"),r.appendChild(a);var o=document.createElementNS(n,"path");o.setAttribute("data-bind","attr: { transform: _transform }"),o.setAttribute("d","M -34 -34 L -34 -11.25 L -30 -15.25 L -30 -30 L -15.25 -30 L -11.25 -34 L -34 -34 z M 11.25 -34 L 15.25 -30 L 30 -30 L 30 -15.25 L 34 -11.25 L 34 -34 L 11.25 -34 z M -34 11.25 L -34 34 L -11.25 34 L -15.25 30 L -30 30 L -30 15.25 L -34 11.25 z M 34 11.25 L 30 15.25 L 30 30 L 15.25 30 L 11.25 34 L 34 34 L 34 11.25 z"),a.appendChild(o),i.appendChild(r);var s=new ZTe(t,this._element,this._container);this._viewModel=s,Dxe.applyBindings(this._viewModel,this._element)}Object(O.a)(QTe.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}}),QTe.prototype.isDestroyed=function(){return!1},QTe.prototype.destroy=function(){var e=this._container;return Dxe.cleanNode(this._element),e.removeChild(this._element),rl(this)};var KTe=QTe;function JTe(e,t,i){this._color=e,this._height=t,this._base=Object(w.a)(i,0)}JTe.prototype.getHeight=function(){return this._height},JTe.prototype.getBase=function(){return this._base},JTe.prototype.getStartTime=function(){return this._start},JTe.prototype.getStopTime=function(){return this._stop},JTe.prototype.setRange=function(e,t){this._start=e,this._stop=t},JTe.prototype.render=function(e){var t="";if(this._start&&this._stop&&this._color){var i=Tr.secondsDifference(this._start,e.epochJulian),n=Math.round(e.timeBarWidth*e.getAlpha(i)),r=Tr.secondsDifference(this._stop,e.epochJulian),a=Math.round(e.timeBarWidth*e.getAlpha(r))-n;n<0&&(a+=n,n=0),n+a>e.timeBarWidth&&(a=e.timeBarWidth-n),a>0&&(t='<span class="cesium-timeline-highlight" style="left: '+n.toString()+"px; width: "+a.toString()+"px; bottom: "+this._base.toString()+"px; height: "+this._height+"px; background-color: "+this._color+';"></span>')}return t};var $Te=JTe;function eCe(e,t,i,n){this.interval=e,this.height=t,this.color=i||new uf(.5,.5,.5,1),this.backgroundColor=n||new uf(0,0,0,0)}eCe.prototype.render=function(e,t){var i=this.interval.start,n=this.interval.stop,r=t.startJulian,a=Tr.addSeconds(t.startJulian,t.duration,new Tr);if(Tr.lessThan(i,r)&&Tr.greaterThan(n,a))e.fillStyle=this.color.toCssColorString(),e.fillRect(0,t.y,t.timeBarWidth,this.height);else if(Tr.lessThanOrEquals(i,a)&&Tr.greaterThanOrEquals(n,r)){var o,s,c;for(o=0;o<t.timeBarWidth;++o){var l=Tr.addSeconds(t.startJulian,o/t.timeBarWidth*t.duration,new Tr);!Object(u.a)(s)&&Tr.greaterThanOrEquals(l,i)?s=o:!Object(u.a)(c)&&Tr.greaterThanOrEquals(l,n)&&(c=o)}e.fillStyle=this.backgroundColor.toCssColorString(),e.fillRect(0,t.y,t.timeBarWidth,this.height),Object(u.a)(s)&&(Object(u.a)(c)||(c=t.timeBarWidth),e.fillStyle=this.color.toCssColorString(),e.fillRect(s,t.y,Math.max(c-s,1),this.height))}};var tCe=eCe,iCe=1e12,nCe={none:0,scrub:1,slide:2,zoom:3,touchOnly:4},rCe={none:0,scrub:1,slideZoom:2,singleTap:3,ignore:4},aCe=[.001,.002,.005,.01,.02,.05,.1,.25,.5,1,2,5,10,15,30,60,120,300,600,900,1800,3600,7200,14400,21600,43200,86400,172800,345600,604800,1296e3,2592e3,5184e3,7776e3,15552e3,31536e3,63072e3,126144e3,15768e4,31536e4,63072e4,126144e4,15768e5,31536e5,63072e5,126144e5,15768e6,31536e6],oCe=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function sCe(e,t){if(!Object(u.a)(e))throw new h.a("container is required.");if(!Object(u.a)(t))throw new h.a("clock is required.");e=zfe(e),this.container=e;var i,n=document.createElement("div");n.className="cesium-timeline-main",e.appendChild(n),this._topDiv=n,this._endJulian=void 0,this._epochJulian=void 0,this._lastXPos=void 0,this._scrubElement=void 0,this._startJulian=void 0,this._timeBarSecondsSpan=void 0,this._clock=t,this._scrubJulian=t.currentTime,this._mainTicSpan=-1,this._mouseMode=nCe.none,this._touchMode=rCe.none,this._touchState={centerX:0,spanX:0},this._mouseX=0,this._timelineDrag=0,this._timelineDragLocation=void 0,this._lastHeight=void 0,this._lastWidth=void 0,this._topDiv.innerHTML='<div class="cesium-timeline-bar"></div><div class="cesium-timeline-trackContainer"><canvas class="cesium-timeline-tracks" width="10" height="1"></canvas></div><div class="cesium-timeline-needle"></div><span class="cesium-timeline-ruler"></span>',this._timeBarEle=this._topDiv.childNodes[0],this._trackContainer=this._topDiv.childNodes[1],this._trackListEle=this._topDiv.childNodes[1].childNodes[0],this._needleEle=this._topDiv.childNodes[2],this._rulerEle=this._topDiv.childNodes[3],this._context=this._trackListEle.getContext("2d"),this._trackList=[],this._highlightRanges=[],this.zoomTo(t.startTime,t.stopTime),this._onMouseDown=(i=this,function(e){i._mouseMode!==nCe.touchOnly&&(0===e.button?(i._mouseMode=nCe.scrub,i._scrubElement&&(i._scrubElement.style.backgroundPosition="-16px 0"),i._onMouseMove(e)):(i._mouseX=e.clientX,2===e.button?i._mouseMode=nCe.zoom:i._mouseMode=nCe.slide)),e.preventDefault()}),this._onMouseUp=function(e){return function(t){e._mouseMode=nCe.none,e._scrubElement&&(e._scrubElement.style.backgroundPosition="0 0"),e._timelineDrag=0,e._timelineDragLocation=void 0}}(this),this._onMouseMove=function(e){return function(t){var i;if(e._mouseMode===nCe.scrub){t.preventDefault();var n=t.clientX-e._topDiv.getBoundingClientRect().left;n<0?(e._timelineDragLocation=0,e._timelineDrag=-.01*e._timeBarSecondsSpan):n>e._topDiv.clientWidth?(e._timelineDragLocation=e._topDiv.clientWidth,e._timelineDrag=.01*e._timeBarSecondsSpan):(e._timelineDragLocation=void 0,e._setTimeBarTime(n,n*e._timeBarSecondsSpan/e._topDiv.clientWidth))}else if(e._mouseMode===nCe.slide){if(i=e._mouseX-t.clientX,e._mouseX=t.clientX,0!==i){var r=i*e._timeBarSecondsSpan/e._topDiv.clientWidth;e.zoomTo(Tr.addSeconds(e._startJulian,r,new Tr),Tr.addSeconds(e._endJulian,r,new Tr))}}else e._mouseMode===nCe.zoom&&(i=e._mouseX-t.clientX,e._mouseX=t.clientX,0!==i&&e.zoomFrom(Math.pow(1.01,i)))}}(this),this._onMouseWheel=function(e){return function(t){var i=t.wheelDeltaY||t.wheelDelta||-t.detail;i/=iCe=Math.max(Math.min(Math.abs(i),iCe),1),e.zoomFrom(Math.pow(1.05,-i))}}(this),this._onTouchStart=function(e){return function(t){var i,n,r=t.touches.length,a=e._topDiv.getBoundingClientRect().left;t.preventDefault(),e._mouseMode=nCe.touchOnly,1===r?(i=Tr.secondsDifference(e._scrubJulian,e._startJulian),n=Math.round(i*e._topDiv.clientWidth/e._timeBarSecondsSpan+a),Math.abs(t.touches[0].clientX-n)<50?(e._touchMode=rCe.scrub,e._scrubElement&&(e._scrubElement.style.backgroundPosition=1===r?"-16px 0":"0 0")):(e._touchMode=rCe.singleTap,e._touchState.centerX=t.touches[0].clientX-a)):2===r?(e._touchMode=rCe.slideZoom,e._touchState.centerX=.5*(t.touches[0].clientX+t.touches[1].clientX)-a,e._touchState.spanX=Math.abs(t.touches[0].clientX-t.touches[1].clientX)):e._touchMode=rCe.ignore}}(this),this._onTouchMove=function(e){return function(t){var i,n,r,a,o,s,c=1,l=e._topDiv.getBoundingClientRect().left;e._touchMode===rCe.singleTap&&(e._touchMode=rCe.slideZoom),e._mouseMode=nCe.touchOnly,e._touchMode===rCe.scrub?(t.preventDefault(),1===t.changedTouches.length&&(n=t.changedTouches[0].clientX-l)>=0&&n<=e._topDiv.clientWidth&&e._setTimeBarTime(n,n*e._timeBarSecondsSpan/e._topDiv.clientWidth)):e._touchMode===rCe.slideZoom&&(2===(r=t.touches.length)?(a=.5*(t.touches[0].clientX+t.touches[1].clientX)-l,o=Math.abs(t.touches[0].clientX-t.touches[1].clientX)):1===r&&(a=t.touches[0].clientX-l,o=0),Object(u.a)(a)&&(o>0&&e._touchState.spanX>0?(c=e._touchState.spanX/o,s=Tr.addSeconds(e._startJulian,(e._touchState.centerX*e._timeBarSecondsSpan-a*e._timeBarSecondsSpan*c)/e._topDiv.clientWidth,new Tr)):(i=e._touchState.centerX-a,s=Tr.addSeconds(e._startJulian,i*e._timeBarSecondsSpan/e._topDiv.clientWidth,new Tr)),e.zoomTo(s,Tr.addSeconds(s,e._timeBarSecondsSpan*c,new Tr)),e._touchState.centerX=a,e._touchState.spanX=o))}}(this),this._onTouchEnd=function(e){return function(t){var i=t.touches.length,n=e._topDiv.getBoundingClientRect().left;e._touchMode===rCe.singleTap?(e._touchMode=rCe.scrub,e._onTouchMove(t)):e._touchMode===rCe.scrub&&e._onTouchMove(t),e._mouseMode=nCe.touchOnly,1!==i?e._touchMode=i>0?rCe.ignore:rCe.none:e._touchMode===rCe.slideZoom&&(e._touchState.centerX=t.touches[0].clientX-n),e._scrubElement&&(e._scrubElement.style.backgroundPosition="0 0")}}(this);var r=this._timeBarEle;document.addEventListener("mouseup",this._onMouseUp,!1),document.addEventListener("mousemove",this._onMouseMove,!1),r.addEventListener("mousedown",this._onMouseDown,!1),r.addEventListener("DOMMouseScroll",this._onMouseWheel,!1),r.addEventListener("mousewheel",this._onMouseWheel,!1),r.addEventListener("touchstart",this._onTouchStart,!1),r.addEventListener("touchmove",this._onTouchMove,!1),r.addEventListener("touchend",this._onTouchEnd,!1),r.addEventListener("touchcancel",this._onTouchEnd,!1),this._topDiv.oncontextmenu=function(){return!1},t.onTick.addEventListener(this.updateFromClock,this),this.updateFromClock()}function cCe(e){return e<10?"0"+e.toString():e.toString()}sCe.prototype.addEventListener=function(e,t,i){this._topDiv.addEventListener(e,t,i)},sCe.prototype.removeEventListener=function(e,t,i){this._topDiv.removeEventListener(e,t,i)},sCe.prototype.isDestroyed=function(){return!1},sCe.prototype.destroy=function(){this._clock.onTick.removeEventListener(this.updateFromClock,this),document.removeEventListener("mouseup",this._onMouseUp,!1),document.removeEventListener("mousemove",this._onMouseMove,!1);var e=this._timeBarEle;e.removeEventListener("mousedown",this._onMouseDown,!1),e.removeEventListener("DOMMouseScroll",this._onMouseWheel,!1),e.removeEventListener("mousewheel",this._onMouseWheel,!1),e.removeEventListener("touchstart",this._onTouchStart,!1),e.removeEventListener("touchmove",this._onTouchMove,!1),e.removeEventListener("touchend",this._onTouchEnd,!1),e.removeEventListener("touchcancel",this._onTouchEnd,!1),this.container.removeChild(this._topDiv),rl(this)},sCe.prototype.addHighlightRange=function(e,t,i){var n=new $Te(e,t,i);return this._highlightRanges.push(n),this.resize(),n},sCe.prototype.addTrack=function(e,t,i,n){var r=new tCe(e,t,i,n);return this._trackList.push(r),this._lastHeight=void 0,this.resize(),r},sCe.prototype.zoomTo=function(e,t){if(!Object(u.a)(e))throw new h.a("startTime is required.");if(!Object(u.a)(t))throw new h.a("stopTime is required");if(Tr.lessThanOrEquals(t,e))throw new h.a("Start time must come before end time.");if(this._startJulian=e,this._endJulian=t,this._timeBarSecondsSpan=Tr.secondsDifference(t,e),this._clock&&this._clock.clockRange!==Xd.UNBOUNDED){var i=this._clock.startTime,n=this._clock.stopTime,r=Tr.secondsDifference(n,i),a=Tr.secondsDifference(i,this._startJulian),o=Tr.secondsDifference(n,this._endJulian);this._timeBarSecondsSpan>=r?(this._timeBarSecondsSpan=r,this._startJulian=this._clock.startTime,this._endJulian=this._clock.stopTime):a>0?(this._endJulian=Tr.addSeconds(this._endJulian,a,new Tr),this._startJulian=i,this._timeBarSecondsSpan=Tr.secondsDifference(this._endJulian,this._startJulian)):o<0&&(this._startJulian=Tr.addSeconds(this._startJulian,o,new Tr),this._endJulian=n,this._timeBarSecondsSpan=Tr.secondsDifference(this._endJulian,this._startJulian))}this._makeTics();var s=document.createEvent("Event");s.initEvent("setzoom",!0,!0),s.startJulian=this._startJulian,s.endJulian=this._endJulian,s.epochJulian=this._epochJulian,s.totalSpan=this._timeBarSecondsSpan,s.mainTicSpan=this._mainTicSpan,this._topDiv.dispatchEvent(s)},sCe.prototype.zoomFrom=function(e){var t=Tr.secondsDifference(this._scrubJulian,this._startJulian);e>1||t<0||t>this._timeBarSecondsSpan?t=.5*this._timeBarSecondsSpan:t+=t-.5*this._timeBarSecondsSpan;var i=this._timeBarSecondsSpan-t;this.zoomTo(Tr.addSeconds(this._startJulian,t-t*e,new Tr),Tr.addSeconds(this._endJulian,i*e-i,new Tr))},sCe.prototype.makeLabel=function(e){var t=Tr.toGregorianDate(e),i=t.millisecond,n=" UTC";if(i>0&&this._timeBarSecondsSpan<3600){for(n=Math.floor(i).toString();n.length<3;)n="0"+n;n="."+n}return oCe[t.month-1]+" "+t.day+" "+t.year+" "+cCe(t.hour)+":"+cCe(t.minute)+":"+cCe(t.second)+n},sCe.prototype.smallestTicInPixels=7,sCe.prototype._makeTics=function(){var e,t=this._timeBarEle,i=Tr.secondsDifference(this._scrubJulian,this._startJulian),n=Math.round(i*this._topDiv.clientWidth/this._timeBarSecondsSpan),r=n-8,a=this;this._needleEle.style.left=n.toString()+"px";var o="",s=0,c=this._timeBarSecondsSpan;c<.01?(c=.01,this._timeBarSecondsSpan=.01,this._endJulian=Tr.addSeconds(this._startJulian,.01,new Tr)):c>31536e6&&(c=31536e6,this._timeBarSecondsSpan=31536e6,this._endJulian=Tr.addSeconds(this._startJulian,31536e6,new Tr));var l=this._timeBarEle.clientWidth;l<10&&(l=10);var u,h=this._startJulian,d=Math.min(c/l*1e-5,.4),f=Tr.toGregorianDate(h);u=c>31536e4?Tr.fromDate(new Date(Date.UTC(100*Math.floor(f.year/100),0))):c>31536e3?Tr.fromDate(new Date(Date.UTC(10*Math.floor(f.year/10),0))):c>86400?Tr.fromDate(new Date(Date.UTC(f.year,0))):Tr.fromDate(new Date(Date.UTC(f.year,f.month,f.day)));var p=Tr.secondsDifference(this._startJulian,Tr.addSeconds(u,d,new Tr)),m=p+c;function _(e){return Math.floor(p/e)*e}function g(e,t){return Math.ceil(e/t+.5)*t}function v(e){return(e-p)/c}function b(e,t){return e-t*Math.round(e/t)}this._epochJulian=u,this._rulerEle.innerHTML=this.makeLabel(Tr.addSeconds(this._endJulian,-.01,new Tr));var y=this._rulerEle.offsetWidth+20;y<30&&(y=180);var w=s;s-=1e-10;var O={startTime:p,startJulian:h,epochJulian:u,duration:c,timeBarWidth:l,getAlpha:v};this._highlightRanges.forEach((function(e){o+=e.render(O)}));var x=0,E=0,T=0,C=y/l;C>1&&(C=1),C*=this._timeBarSecondsSpan;var S,A=-1,P=-1,I=aCe.length;for(S=0;S<I;++S){var D=aCe[S];if(++A,x=D,D>C&&D>s)break;P<0&&l*(D/this._timeBarSecondsSpan)>=this.smallestTicInPixels&&(P=A)}if(A>0){for(;A>0;)if(--A,Math.abs(b(x,aCe[A]))<1e-5){aCe[A]>=s&&(E=aCe[A]);break}if(P>=0)for(;P<A;){if(Math.abs(b(E,aCe[P]))<1e-5&&aCe[P]>=s){T=aCe[P];break}++P}}(s=w)>1e-10&&T<1e-5&&Math.abs(s-x)>1e-10&&(T=s,s<=x+1e-10&&(E=0));var j,M=-999999;if(l*(T/this._timeBarSecondsSpan)>=3)for(e=_(T);e<=m;e=g(e,T))o+='<span class="cesium-timeline-ticTiny" style="left: '+Math.round(l*v(e)).toString()+'px;"></span>';if(l*(E/this._timeBarSecondsSpan)>=3)for(e=_(E);e<=m;e=g(e,E))o+='<span class="cesium-timeline-ticSub" style="left: '+Math.round(l*v(e)).toString()+'px;"></span>';if(l*(x/this._timeBarSecondsSpan)>=2){this._mainTicSpan=x,m+=x,e=_(x);for(var R=Tr.computeTaiMinusUtc(u);e<=m;){var L=Tr.addSeconds(h,e-p,new Tr);if(x>2.1){var N=Tr.computeTaiMinusUtc(L);Math.abs(N-R)>.1&&(e+=N-R,L=Tr.addSeconds(h,e-p,new Tr))}var F=Math.round(l*v(e)),k=this.makeLabel(L);this._rulerEle.innerHTML=k,(j=this._rulerEle.offsetWidth)<10&&(j=y);var B=F-(j/2-1);B>M?(M=B+j+5,o+='<span class="cesium-timeline-ticMain" style="left: '+F.toString()+'px;"></span><span class="cesium-timeline-ticLabel" style="left: '+B.toString()+'px;">'+k+"</span>"):o+='<span class="cesium-timeline-ticSub" style="left: '+F.toString()+'px;"></span>',e=g(e,x)}}else this._mainTicSpan=-1;o+='<span class="cesium-timeline-icon16" style="left:'+r+'px;bottom:0;background-position: 0 0;"></span>',t.innerHTML=o,this._scrubElement=t.lastChild,this._context.clearRect(0,0,this._trackListEle.width,this._trackListEle.height),O.y=0,this._trackList.forEach((function(e){e.render(a._context,O),O.y+=e.height}))},sCe.prototype.updateFromClock=function(){this._scrubJulian=this._clock.currentTime;var e=this._scrubElement;if(Object(u.a)(this._scrubElement)){var t=Tr.secondsDifference(this._scrubJulian,this._startJulian),i=Math.round(t*this._topDiv.clientWidth/this._timeBarSecondsSpan);this._lastXPos!==i&&(this._lastXPos=i,e.style.left=i-8+"px",this._needleEle.style.left=i+"px")}Object(u.a)(this._timelineDragLocation)&&(this._setTimeBarTime(this._timelineDragLocation,this._timelineDragLocation*this._timeBarSecondsSpan/this._topDiv.clientWidth),this.zoomTo(Tr.addSeconds(this._startJulian,this._timelineDrag,new Tr),Tr.addSeconds(this._endJulian,this._timelineDrag,new Tr)))},sCe.prototype._setTimeBarTime=function(e,t){if(e=Math.round(e),this._scrubJulian=Tr.addSeconds(this._startJulian,t,new Tr),this._scrubElement){var i=e-8;this._scrubElement.style.left=i.toString()+"px",this._needleEle.style.left=e.toString()+"px"}var n=document.createEvent("Event");n.initEvent("settime",!0,!0),n.clientX=e,n.timeSeconds=t,n.timeJulian=this._scrubJulian,n.clock=this._clock,this._topDiv.dispatchEvent(n)},sCe.prototype.resize=function(){var e=this.container.clientWidth,t=this.container.clientHeight;if(e!==this._lastWidth||t!==this._lastHeight){this._trackContainer.style.height=t+"px";var i=1;this._trackList.forEach((function(e){i+=e.height})),this._trackListEle.style.height=i.toString()+"px",this._trackListEle.width=this._trackListEle.clientWidth,this._trackListEle.height=i,this._makeTics(),this._lastXPos=void 0,this._lastWidth=e,this._lastHeight=t}};var lCe=sCe;function uCe(){var e=window.screen;Object(u.a)(e)&&(Object(u.a)(e.unlockOrientation)?e.unlockOrientation():Object(u.a)(e.mozUnlockOrientation)?e.mozUnlockOrientation():Object(u.a)(e.msUnlockOrientation)?e.msUnlockOrientation():Object(u.a)(e.orientation&&e.orientation.unlock)&&e.orientation.unlock())}function hCe(e,t,i,n){var r,a,o;n()||(i()?(t.useWebVR=!1,e._locked&&(uCe(),e._locked=!1),e._noSleep.disable(),wi.exitFullscreen(),i(!1)):(wi.fullscreen||wi.requestFullscreen(e._vrElement),e._noSleep.enable(),e._locked||(e._locked=(r="landscape",a=!1,o=window.screen,Object(u.a)(o)&&(Object(u.a)(o.lockOrientation)?a=o.lockOrientation(r):Object(u.a)(o.mozLockOrientation)?a=o.mozLockOrientation(r):Object(u.a)(o.msLockOrientation)?a=o.msLockOrientation(r):Object(u.a)(o.orientation&&o.orientation.lock)&&(a=o.orientation.lock(r))),a)),t.useWebVR=!0,i(!0)))}function dCe(e,t){if(!Object(u.a)(e))throw new h.a("scene is required.");var i=this,n=Dxe.observable(wi.enabled),r=Dxe.observable(!1);this.isVRMode=void 0,Dxe.defineProperty(this,"isVRMode",{get:function(){return r()}}),this.isVREnabled=void 0,Dxe.defineProperty(this,"isVREnabled",{get:function(){return n()},set:function(e){n(e&&wi.enabled)}}),this.tooltip=void 0,Dxe.defineProperty(this,"tooltip",(function(){return n()?r()?"Exit VR mode":"Enter VR mode":"VR mode is unavailable"}));var a=Dxe.observable(!1);this._isOrthographic=void 0,Dxe.defineProperty(this,"_isOrthographic",{get:function(){return a()}}),this._eventHelper=new eb,this._eventHelper.add(e.preRender,(function(){a(e.camera.frustum instanceof hb)})),this._locked=!1,this._noSleep=new Lxe,this._command=Bxe((function(){hCe(i,e,r,a)}),Dxe.getObservable(this,"isVREnabled")),this._vrElement=Object(w.a)(zfe(t),document.body),this._callback=function(){!wi.fullscreen&&r()&&(e.useWebVR=!1,i._locked&&(uCe(),i._locked=!1),i._noSleep.disable(),r(!1))},document.addEventListener(wi.changeEventName,this._callback)}Object(O.a)(dCe.prototype,{vrElement:{get:function(){return this._vrElement},set:function(e){if(!(e instanceof Element))throw new h.a("value must be a valid Element.");this._vrElement=e}},command:{get:function(){return this._command}}}),dCe.prototype.isDestroyed=function(){return!1},dCe.prototype.destroy=function(){this._eventHelper.removeAll(),document.removeEventListener(wi.changeEventName,this._callback),rl(this)};var fCe=dCe,pCe="M 5.3125 6.375 C 4.008126 6.375 2.96875 7.4141499 2.96875 8.71875 L 2.96875 19.5 C 2.96875 20.8043 4.008126 21.875 5.3125 21.875 L 13.65625 21.875 C 13.71832 20.0547 14.845166 18.59375 16.21875 18.59375 C 17.592088 18.59375 18.71881 20.0552 18.78125 21.875 L 27.09375 21.875 C 28.398125 21.875 29.4375 20.8043 29.4375 19.5 L 29.4375 8.71875 C 29.4375 7.4141499 28.398125 6.375 27.09375 6.375 L 5.3125 6.375 z M 9.625 10.4375 C 11.55989 10.4375 13.125 12.03385 13.125 13.96875 C 13.125 15.90365 11.55989 17.46875 9.625 17.46875 C 7.69011 17.46875 6.125 15.90365 6.125 13.96875 C 6.125 12.03385 7.69011 10.4375 9.625 10.4375 z M 22.46875 10.4375 C 24.40364 10.4375 25.96875 12.03385 25.96875 13.96875 C 25.96875 15.90365 24.40364 17.46875 22.46875 17.46875 C 20.53386 17.46875 18.96875 15.90365 18.96875 13.96875 C 18.96875 12.03385 20.53386 10.4375 22.46875 10.4375 z",mCe="M 25.770585,2.4552065 C 15.72282,13.962707 10.699956,19.704407 8.1768352,22.580207 c -1.261561,1.4379 -1.902282,2.1427 -2.21875,2.5 -0.141624,0.1599 -0.208984,0.2355 -0.25,0.2813 l 0.6875,0.75 c 10e-5,-10e-5 0.679191,0.727 0.6875,0.7187 0.01662,-0.016 0.02451,-0.024 0.03125,-0.031 0.01348,-0.014 0.04013,-0.038 0.0625,-0.062 0.04474,-0.05 0.120921,-0.1315 0.28125,-0.3126 0.320657,-0.3619 0.956139,-1.0921 2.2187499,-2.5312 2.5252219,-2.8781 7.5454589,-8.6169 17.5937499,-20.1250005 l -1.5,-1.3125 z m -20.5624998,3.9063 c -1.304375,0 -2.34375,1.0391 -2.34375,2.3437 l 0,10.8125005 c 0,1.3043 1.039375,2.375 2.34375,2.375 l 2.25,0 c 1.9518039,-2.2246 7.4710958,-8.5584 13.5624998,-15.5312005 l -15.8124998,0 z m 21.1249998,0 c -1.855467,2.1245 -2.114296,2.4005 -3.59375,4.0936995 1.767282,0.1815 3.15625,1.685301 3.15625,3.500001 0,1.9349 -1.56511,3.5 -3.5,3.5 -1.658043,0 -3.043426,-1.1411 -3.40625,-2.6875 -1.089617,1.2461 -2.647139,2.9988 -3.46875,3.9375 0.191501,-0.062 0.388502,-0.094 0.59375,-0.094 1.373338,0 2.50006,1.4614 2.5625,3.2812 l 8.3125,0 c 1.304375,0 2.34375,-1.0707 2.34375,-2.375 l 0,-10.8125005 c 0,-1.3046 -1.039375,-2.3437 -2.34375,-2.3437 l -0.65625,0 z M 9.5518351,10.423906 c 1.9348899,0 3.4999999,1.596401 3.4999999,3.531301 0,1.9349 -1.56511,3.5 -3.4999999,3.5 -1.9348899,0 -3.4999999,-1.5651 -3.4999999,-3.5 0,-1.9349 1.56511,-3.531301 3.4999999,-3.531301 z m 4.2187499,10.312601 c -0.206517,0.2356 -0.844218,0.9428 -1.03125,1.1562 l 0.8125,0 c 0.01392,-0.4081 0.107026,-0.7968 0.21875,-1.1562 z";function _Ce(e,t,i){if(!Object(u.a)(e))throw new h.a("container is required.");if(!Object(u.a)(t))throw new h.a("scene is required.");e=zfe(e);var n=new fCe(t,i);n._exitVRPath=mCe,n._enterVRPath=pCe;var r=document.createElement("button");r.type="button",r.className="cesium-button cesium-vrButton",r.setAttribute("data-bind",'css: { "cesium-button-disabled" : _isOrthographic }, attr: { title: tooltip },click: command,enable: isVREnabled,cesiumSvgPath: { path: isVRMode ? _exitVRPath : _enterVRPath, width: 32, height: 32 }'),e.appendChild(r),Dxe.applyBindings(n,r),this._container=e,this._viewModel=n,this._element=r}Object(O.a)(_Ce.prototype,{container:{get:function(){return this._container}},viewModel:{get:function(){return this._viewModel}}}),_Ce.prototype.isDestroyed=function(){return!1},_Ce.prototype.destroy=function(){return this._viewModel.destroy(),Dxe.cleanNode(this._element),this._container.removeChild(this._element),rl(this)};var gCe=_Ce,vCe=new St;function bCe(e){var t=e.clock;t.currentTime=e.timeJulian,t.shouldAnimate=!1}function yCe(e,t){var i=e.scene.pick(t.position);if(Object(u.a)(i)){var n=Object(w.a)(i.id,i.primitive.id);if(n instanceof zz)return n}if(Object(u.a)(e.scene.globe))return function(e,t){var i=e.scene,n=i.camera.getPickRay(t),r=i.imageryLayers.pickImageryLayerFeatures(n,i);if(!Object(u.a)(r))return;var a=new zz({id:"Loading...",description:"Loading feature information..."});return Object(Oi.a)(r,(function(t){if(e.selectedEntity===a)if(Object(u.a)(t)&&0!==t.length){var i=t[0],n=new zz({id:i.name,description:i.description});if(Object(u.a)(i.position)){var r=e.scene.globe.ellipsoid.cartographicToCartesian(i.position,OCe);n.position=new XB(r)}e.selectedEntity=n}else e.selectedEntity=xCe()}),(function(){e.selectedEntity===a&&(e.selectedEntity=xCe())})),a}(e,t.position)}function wCe(e,t,i){if(Object(u.a)(i)){var n=i.clock;Object(u.a)(n)&&(n.getValue(t),Object(u.a)(e)&&(e.updateFromClock(),e.zoomTo(n.startTime,n.stopTime)))}}var OCe=new z;function xCe(){return new zz({id:"None",description:"No features found."})}function ECe(e,t){if(!Object(u.a)(e))throw new h.a("container is required.");e=zfe(e),t=Object(w.a)(t,w.a.EMPTY_OBJECT);var i=!(Object(u.a)(t.globe)&&!1===t.globe||Object(u.a)(t.baseLayerPicker)&&!1===t.baseLayerPicker);if(!i&&Object(u.a)(t.selectedImageryProviderViewModel))throw new h.a("options.selectedImageryProviderViewModel is not available when not using the BaseLayerPicker widget. Either specify options.imageryProvider instead or set options.baseLayerPicker to true.");if(!i&&Object(u.a)(t.selectedTerrainProviderViewModel))throw new h.a("options.selectedTerrainProviderViewModel is not available when not using the BaseLayerPicker widget. Either specify options.terrainProvider instead or set options.baseLayerPicker to true.");var n=this,r=document.createElement("div");r.className="cesium-viewer",e.appendChild(r);var a=document.createElement("div");a.className="cesium-viewer-cesiumWidgetContainer",r.appendChild(a);var o=document.createElement("div");o.className="cesium-viewer-bottom",r.appendChild(o);var s,c,l=Object(w.a)(t.scene3DOnly,!1),d=!1;Object(u.a)(t.clockViewModel)?s=(c=t.clockViewModel).clock:(s=new tf,c=new Fxe(s),d=!0),Object(u.a)(t.shouldAnimate)&&(s.shouldAnimate=t.shouldAnimate),Object(u.a)(t.globe)&&(fx.ellipsoidType=t.globe.ellipsoid);var f=new QEe(a,{imageryProvider:!i&&!Object(u.a)(t.imageryProvider)&&void 0,clock:s,skyBox:t.skyBox,skyAtmosphere:t.skyAtmosphere,sceneMode:t.sceneMode,mapProjection:t.mapProjection,globe:t.globe,orderIndependentTranslucency:t.orderIndependentTranslucency,contextOptions:t.contextOptions,useDefaultRenderLoop:t.useDefaultRenderLoop,targetFrameRate:t.targetFrameRate,showRenderLoopErrors:t.showRenderLoopErrors,creditContainer:Object(u.a)(t.creditContainer)?t.creditContainer:o,creditViewport:t.creditViewport,scene3DOnly:l,terrainExaggeration:t.terrainExaggeration,shadows:t.shadows,terrainShadows:t.terrainShadows,mapMode2D:t.mapMode2D,requestRenderMode:t.requestRenderMode,maximumRenderTimeChange:t.maximumRenderTimeChange}),p=t.dataSources,m=!1;Object(u.a)(p)||(p=new hX,m=!0);var _,g,v=f.scene,b=new Cee({scene:v,dataSourceCollection:p}),y=new eb;if(y.add(s.onTick,ECe.prototype._onTick,this),y.add(v.morphStart,ECe.prototype._clearTrackedObject,this),!Object(u.a)(t.selectionIndicator)||!1!==t.selectionIndicator){var O=document.createElement("div");O.className="cesium-viewer-selectionIndicatorContainer",r.appendChild(O),_=new KTe(O,v)}if(!Object(u.a)(t.infoBox)||!1!==t.infoBox){var x=document.createElement("div");x.className="cesium-viewer-infoBoxContainer",r.appendChild(x);var E=(g=new ETe(x)).viewModel;y.add(E.cameraClicked,ECe.prototype._onInfoBoxCameraClicked,this),y.add(E.closeClicked,ECe.prototype._onInfoBoxClockClicked,this)}var T,C,S,A,P,I,D,j,M,R,L,N,F,k,B,z=document.createElement("div");if(z.className="cesium-viewer-toolbar",r.appendChild(z),!Object(u.a)(t.geocoder)||!1!==t.geocoder){var U,V=document.createElement("div");V.className="cesium-viewer-geocoderContainer",z.appendChild(V),Object(u.a)(t.geocoder)&&"boolean"!=typeof t.geocoder&&(U=Object(ym.a)(t.geocoder)?t.geocoder:[t.geocoder]),T=new pTe({container:V,geocoderServices:U,scene:v}),y.add(T.viewModel.search.beforeExecute,ECe.prototype._clearObjects,this)}if(Object(u.a)(t.homeButton)&&!1===t.homeButton||(C=new vTe(z,v),Object(u.a)(T)&&y.add(C.viewModel.command.afterExecute,(function(){var e=T.viewModel;e.searchText="",e.isSearchInProgress&&e.search()})),y.add(C.viewModel.command.beforeExecute,ECe.prototype._clearTrackedObject,this)),!0===t.sceneModePicker&&l)throw new h.a("options.sceneModePicker is not available when options.scene3DOnly is set to true.");if(l||Object(u.a)(t.sceneModePicker)&&!1===t.sceneModePicker||(S=new qTe(z,v)),t.projectionPicker&&(A=new kTe(z,v)),i){var H=Object(w.a)(t.imageryProviderViewModels,EEe()),G=Object(w.a)(t.terrainProviderViewModels,TEe());P=new wEe(z,{globe:v.globe,imageryProviderViewModels:H,selectedImageryProviderViewModel:t.selectedImageryProviderViewModel,terrainProviderViewModels:G,selectedTerrainProviderViewModel:t.selectedTerrainProviderViewModel}),I=z.getElementsByClassName("cesium-baseLayerPicker-dropDown")[0]}if(Object(u.a)(t.imageryProvider)&&!1!==t.imageryProvider&&(i&&(P.viewModel.selectedImagery=void 0),v.imageryLayers.removeAll(),v.imageryLayers.addImageryProvider(t.imageryProvider)),Object(u.a)(t.terrainProvider)&&(i&&(P.viewModel.selectedTerrain=void 0),v.terrainProvider=t.terrainProvider),!Object(u.a)(t.navigationHelpButton)||!1!==t.navigationHelpButton){var q=!0;try{if(Object(u.a)(window.localStorage)){var W=window.localStorage.getItem("cesium-hasSeenNavHelp");Object(u.a)(W)&&Boolean(W)?q=!1:window.localStorage.setItem("cesium-hasSeenNavHelp","true")}}catch(e){}D=new ATe({container:z,instructionsInitiallyVisible:Object(w.a)(t.navigationInstructionsInitiallyVisible,q)})}if(!Object(u.a)(t.animation)||!1!==t.animation){var Y=document.createElement("div");Y.className="cesium-viewer-animationContainer",r.appendChild(Y),j=new uEe(Y,new gEe(c))}if(!Object(u.a)(t.timeline)||!1!==t.timeline){var X=document.createElement("div");X.className="cesium-viewer-timelineContainer",r.appendChild(X),(M=new lCe(X,s)).addEventListener("settime",bCe,!1),M.zoomTo(s.startTime,s.stopTime)}if(Object(u.a)(t.fullscreenButton)&&!1===t.fullscreenButton||((N=document.createElement("div")).className="cesium-viewer-fullscreenContainer",r.appendChild(N),R=new iTe(N,t.fullscreenElement),L=Vxe(R.viewModel,"isFullscreenEnabled",(function(e){N.style.display=e?"block":"none",Object(u.a)(M)&&(M.container.style.right=N.clientWidth+"px",M.resize())}))),t.vrButton){var Z=document.createElement("div");Z.className="cesium-viewer-vrContainer",r.appendChild(Z),F=new gCe(Z,v,t.fullScreenElement),k=Vxe(F.viewModel,"isVREnabled",(function(e){Z.style.display=e?"block":"none",Object(u.a)(R)&&(Z.style.right=N.clientWidth+"px"),Object(u.a)(M)&&(M.container.style.right=Z.clientWidth+"px",M.resize())})),B=Vxe(F.viewModel,"isVRMode",(function(e){!function(e,t){var i=e._geocoder,n=e._homeButton,r=e._sceneModePicker,a=e._projectionPicker,o=e._baseLayerPicker,s=e._animation,c=e._timeline,l=e._fullscreenButton,h=e._infoBox,d=e._selectionIndicator,f=t?"hidden":"visible";if(Object(u.a)(i)&&(i.container.style.visibility=f),Object(u.a)(n)&&(n.container.style.visibility=f),Object(u.a)(r)&&(r.container.style.visibility=f),Object(u.a)(a)&&(a.container.style.visibility=f),Object(u.a)(o)&&(o.container.style.visibility=f),Object(u.a)(s)&&(s.container.style.visibility=f),Object(u.a)(c)&&(c.container.style.visibility=f),Object(u.a)(l)&&l.viewModel.isFullscreenEnabled&&(l.container.style.visibility=f),Object(u.a)(h)&&(h.container.style.visibility=f),Object(u.a)(d)&&(d.container.style.visibility=f),e._container){var p=t||!Object(u.a)(l)?0:l.container.clientWidth;e._vrButton.container.style.right=p+"px",e.forceResize()}}(n,e)}))}this._baseLayerPickerDropDown=I,this._fullscreenSubscription=L,this._vrSubscription=k,this._vrModeSubscription=B,this._dataSourceChangedListeners={},this._automaticallyTrackDataSourceClocks=Object(w.a)(t.automaticallyTrackDataSourceClocks,!0),this._container=e,this._bottomContainer=o,this._element=r,this._cesiumWidget=f,this._selectionIndicator=_,this._infoBox=g,this._dataSourceCollection=p,this._destroyDataSourceCollection=m,this._dataSourceDisplay=b,this._clockViewModel=c,this._destroyClockViewModel=d,this._toolbar=z,this._homeButton=C,this._sceneModePicker=S,this._projectionPicker=A,this._baseLayerPicker=P,this._navigationHelpButton=D,this._animation=j,this._timeline=M,this._fullscreenButton=R,this._vrButton=F,this._geocoder=T,this._eventHelper=y,this._lastWidth=0,this._lastHeight=0,this._allowDataSourcesToSuspendAnimation=!0,this._entityView=void 0,this._enableInfoOrSelection=Object(u.a)(g)||Object(u.a)(_),this._clockTrackedDataSource=void 0,this._trackedEntity=void 0,this._needTrackedEntityUpdate=!1,this._selectedEntity=void 0,this._clockTrackedDataSource=void 0,this._forceResize=!1,this._zoomIsFlight=!1,this._zoomTarget=void 0,this._zoomPromise=void 0,this._zoomOptions=void 0,this._selectedEntityChanged=new $o.a,this._trackedEntityChanged=new $o.a,Dxe.track(this,["_trackedEntity","_selectedEntity","_clockTrackedDataSource"]),y.add(p.dataSourceAdded,ECe.prototype._onDataSourceAdded,this),y.add(p.dataSourceRemoved,ECe.prototype._onDataSourceRemoved,this),y.add(v.postUpdate,ECe.prototype.resize,this),y.add(v.postRender,ECe.prototype._postRender,this);for(var Q=p.length,K=0;K<Q;K++)this._dataSourceAdded(p,p.get(K));this._dataSourceAdded(void 0,b.defaultDataSource),y.add(p.dataSourceAdded,ECe.prototype._dataSourceAdded,this),y.add(p.dataSourceRemoved,ECe.prototype._dataSourceRemoved,this),f.screenSpaceEventHandler.setInputAction((function(e){n.selectedEntity=yCe(n,e)}),TS.LEFT_CLICK),f.screenSpaceEventHandler.setInputAction((function(e){var t=yCe(n,e);Object(u.a)(t)?aD.getValueOrUndefined(t.position,n.clock.currentTime)?n.trackedEntity=t:n.zoomTo(t):Object(u.a)(n.trackedEntity)&&(n.trackedEntity=void 0)}),TS.LEFT_DOUBLE_CLICK)}function TCe(e,t,i,n){if(!Object(u.a)(t))throw new h.a("zoomTarget is required.");SCe(e);var r=Oi.a.defer();return e._zoomPromise=r,e._zoomIsFlight=n,e._zoomOptions=i,Object(Oi.a)(t,(function(t){if(e._zoomPromise===r)if(t instanceof phe)t.getViewableRectangle().then((function(t){return Qse(t,e.scene)})).then((function(t){e._zoomPromise===r&&(e._zoomTarget=t)}));else if(t instanceof zse)e._zoomTarget=t;else if(t instanceof dxe)e._zoomTarget=t;else if(t.isLoading&&Object(u.a)(t.loadingEvent))var i=t.loadingEvent.addEventListener((function(){i(),e._zoomPromise===r&&(e._zoomTarget=t.entities.values.slice(0))}));else Object(ym.a)(t)?e._zoomTarget=t.slice(0):(t=Object(w.a)(t.values,t),Object(u.a)(t.entities)&&(t=t.entities.values),Object(ym.a)(t)?e._zoomTarget=t.slice(0):e._zoomTarget=[t])})),e.scene.requestRender(),r.promise}function CCe(e){e._zoomPromise=void 0,e._zoomTarget=void 0,e._zoomOptions=void 0}function SCe(e){var t=e._zoomPromise;Object(u.a)(t)&&(CCe(e),t.resolve(!1))}Object(O.a)(ECe.prototype,{container:{get:function(){return this._container}},bottomContainer:{get:function(){return this._bottomContainer}},cesiumWidget:{get:function(){return this._cesiumWidget}},selectionIndicator:{get:function(){return this._selectionIndicator}},infoBox:{get:function(){return this._infoBox}},geocoder:{get:function(){return this._geocoder}},homeButton:{get:function(){return this._homeButton}},sceneModePicker:{get:function(){return this._sceneModePicker}},projectionPicker:{get:function(){return this._projectionPicker}},baseLayerPicker:{get:function(){return this._baseLayerPicker}},navigationHelpButton:{get:function(){return this._navigationHelpButton}},animation:{get:function(){return this._animation}},timeline:{get:function(){return this._timeline}},fullscreenButton:{get:function(){return this._fullscreenButton}},vrButton:{get:function(){return this._vrButton}},dataSourceDisplay:{get:function(){return this._dataSourceDisplay}},entities:{get:function(){return this._dataSourceDisplay.defaultDataSource.entities}},dataSources:{get:function(){return this._dataSourceCollection}},canvas:{get:function(){return this._cesiumWidget.canvas}},scene:{get:function(){return this._cesiumWidget.scene}},shadows:{get:function(){return this.scene.shadowMap.enabled},set:function(e){this.scene.shadowMap.enabled=e}},terrainShadows:{get:function(){return this.scene.globe.shadows},set:function(e){this.scene.globe.shadows=e}},shadowMap:{get:function(){return this.scene.shadowMap}},imageryLayers:{get:function(){return this.scene.imageryLayers}},terrainProvider:{get:function(){return this.scene.terrainProvider},set:function(e){this.scene.terrainProvider=e}},camera:{get:function(){return this.scene.camera}},postProcessStages:{get:function(){return this.scene.postProcessStages}},clock:{get:function(){return this._clockViewModel.clock}},clockViewModel:{get:function(){return this._clockViewModel}},screenSpaceEventHandler:{get:function(){return this._cesiumWidget.screenSpaceEventHandler}},targetFrameRate:{get:function(){return this._cesiumWidget.targetFrameRate},set:function(e){this._cesiumWidget.targetFrameRate=e}},useDefaultRenderLoop:{get:function(){return this._cesiumWidget.useDefaultRenderLoop},set:function(e){this._cesiumWidget.useDefaultRenderLoop=e}},resolutionScale:{get:function(){return this._cesiumWidget.resolutionScale},set:function(e){this._cesiumWidget.resolutionScale=e,this._forceResize=!0}},allowDataSourcesToSuspendAnimation:{get:function(){return this._allowDataSourcesToSuspendAnimation},set:function(e){this._allowDataSourcesToSuspendAnimation=e}},trackedEntity:{get:function(){return this._trackedEntity},set:function(e){if(this._trackedEntity!==e){this._trackedEntity=e,SCe(this);var t=this.scene,i=t.mode;Object(u.a)(e)&&Object(u.a)(e.position)?this._needTrackedEntityUpdate=!0:(this._needTrackedEntityUpdate=!1,i!==xF.COLUMBUS_VIEW&&i!==xF.SCENE2D||(t.screenSpaceCameraController.enableTranslate=!0),i!==xF.COLUMBUS_VIEW&&i!==xF.SCENE3D||(t.screenSpaceCameraController.enableTilt=!0),this._entityView=void 0,this.camera.lookAtTransform(Be.IDENTITY)),this._trackedEntityChanged.raiseEvent(e),this.scene.requestRender()}}},selectedEntity:{get:function(){return this._selectedEntity},set:function(e){if(this._selectedEntity!==e){this._selectedEntity=e;var t=Object(u.a)(this._selectionIndicator)?this._selectionIndicator.viewModel:void 0;Object(u.a)(e)?Object(u.a)(t)&&t.animateAppear():Object(u.a)(t)&&t.animateDepart(),this._selectedEntityChanged.raiseEvent(e)}}},selectedEntityChanged:{get:function(){return this._selectedEntityChanged}},trackedEntityChanged:{get:function(){return this._trackedEntityChanged}},clockTrackedDataSource:{get:function(){return this._clockTrackedDataSource},set:function(e){this._clockTrackedDataSource!==e&&(this._clockTrackedDataSource=e,wCe(this._timeline,this.clock,e))}},ambientLight:{get:function(){return this.scene.ambientLight},set:function(e){this.scene.ambientLight=e}},lightScaleFactor:{get:function(){return this.scene.lightScaleFactor},set:function(e){this.scene.lightScaleFactor=e}}}),ECe.prototype.extend=function(e,t){if(!Object(u.a)(e))throw new h.a("mixin is required.");e(this,t)},ECe.prototype.resize=function(){var e=this._cesiumWidget,t=this._container,i=t.clientWidth,n=t.clientHeight,r=Object(u.a)(this._animation),a=Object(u.a)(this._timeline);if(this._forceResize||i!==this._lastWidth||n!==this._lastHeight){e.resize(),this._forceResize=!1;var o=n-125,s=this._baseLayerPickerDropDown;if(Object(u.a)(s)&&(s.style.maxHeight=o+"px"),Object(u.a)(this._geocoder))this._geocoder.searchSuggestionsContainer.style.maxHeight=o+"px";Object(u.a)(this._infoBox)&&(this._infoBox.viewModel.maxHeight=o);var c,l=this._timeline,h=0,d=0,f=0;if(r&&"hidden"!==window.getComputedStyle(this._animation.container).visibility){var p=this._lastWidth;c=this._animation.container,i>900?(h=169,p<=900&&(c.style.width="169px",c.style.height="112px",this._animation.resize())):i>=600?(h=136,(p<600||p>900)&&(c.style.width="136px",c.style.height="90px",this._animation.resize())):(h=106,(p>600||0===p)&&(c.style.width="106px",c.style.height="70px",this._animation.resize())),d=h+5}if(a&&"hidden"!==window.getComputedStyle(this._timeline.container).visibility){var m=this._fullscreenButton,_=this._vrButton,g=l.container,v=g.style;f=g.clientHeight+3,v.left=h+"px";var b=0;Object(u.a)(m)&&(b+=m.container.clientWidth),Object(u.a)(_)&&(b+=_.container.clientWidth),v.right=b+"px",l.resize()}this._bottomContainer.style.left=d+"px",this._bottomContainer.style.bottom=f+"px",this._lastWidth=i,this._lastHeight=n}},ECe.prototype.forceResize=function(){this._lastWidth=0,this.resize()},ECe.prototype.render=function(){this._cesiumWidget.render()},ECe.prototype.isDestroyed=function(){return!1},ECe.prototype.destroy=function(){var e;this.screenSpaceEventHandler.removeInputAction(TS.LEFT_CLICK),this.screenSpaceEventHandler.removeInputAction(TS.LEFT_DOUBLE_CLICK);var t=this.dataSources,i=t.length;for(e=0;e<i;e++)this._dataSourceRemoved(t,t.get(e));return this._dataSourceRemoved(void 0,this._dataSourceDisplay.defaultDataSource),this._container.removeChild(this._element),this._element.removeChild(this._toolbar),this._eventHelper.removeAll(),Object(u.a)(this._geocoder)&&(this._geocoder=this._geocoder.destroy()),Object(u.a)(this._homeButton)&&(this._homeButton=this._homeButton.destroy()),Object(u.a)(this._sceneModePicker)&&(this._sceneModePicker=this._sceneModePicker.destroy()),Object(u.a)(this._projectionPicker)&&(this._projectionPicker=this._projectionPicker.destroy()),Object(u.a)(this._baseLayerPicker)&&(this._baseLayerPicker=this._baseLayerPicker.destroy()),Object(u.a)(this._animation)&&(this._element.removeChild(this._animation.container),this._animation=this._animation.destroy()),Object(u.a)(this._timeline)&&(this._timeline.removeEventListener("settime",bCe,!1),this._element.removeChild(this._timeline.container),this._timeline=this._timeline.destroy()),Object(u.a)(this._fullscreenButton)&&(this._fullscreenSubscription.dispose(),this._element.removeChild(this._fullscreenButton.container),this._fullscreenButton=this._fullscreenButton.destroy()),Object(u.a)(this._vrButton)&&(this._vrSubscription.dispose(),this._vrModeSubscription.dispose(),this._element.removeChild(this._vrButton.container),this._vrButton=this._vrButton.destroy()),Object(u.a)(this._infoBox)&&(this._element.removeChild(this._infoBox.container),this._infoBox=this._infoBox.destroy()),Object(u.a)(this._selectionIndicator)&&(this._element.removeChild(this._selectionIndicator.container),this._selectionIndicator=this._selectionIndicator.destroy()),this._destroyClockViewModel&&(this._clockViewModel=this._clockViewModel.destroy()),this._dataSourceDisplay=this._dataSourceDisplay.destroy(),this._cesiumWidget=this._cesiumWidget.destroy(),this._destroyDataSourceCollection&&(this._dataSourceCollection=this._dataSourceCollection.destroy()),rl(this)},ECe.prototype._dataSourceAdded=function(e,t){t.entities.collectionChanged.addEventListener(ECe.prototype._onEntityCollectionChanged,this)},ECe.prototype._dataSourceRemoved=function(e,t){var i=t.entities;i.collectionChanged.removeEventListener(ECe.prototype._onEntityCollectionChanged,this),Object(u.a)(this.trackedEntity)&&i.getById(this.trackedEntity.id)===this.trackedEntity&&(this.trackedEntity=void 0),Object(u.a)(this.selectedEntity)&&i.getById(this.selectedEntity.id)===this.selectedEntity&&(this.selectedEntity=void 0)},ECe.prototype._onTick=function(e){var t=e.currentTime,i=this._dataSourceDisplay.update(t);this._allowDataSourcesToSuspendAnimation&&(this._clockViewModel.canAnimate=i);var n,r=this._entityView;if(Object(u.a)(r)){var a=this._trackedEntity;this._dataSourceDisplay.getBoundingSphere(a,!1,vCe)===nD.DONE&&r.update(t,vCe)}var o=!1,s=this.selectedEntity,c=Object(u.a)(s)&&this._enableInfoOrSelection;c&&s.isShowing&&s.isAvailable(t)&&(this._dataSourceDisplay.getBoundingSphere(s,!0,vCe)!==nD.FAILED?n=vCe.center:Object(u.a)(s.position)&&(n=s.position.getValue(t,n)),o=Object(u.a)(n));var l=Object(u.a)(this._selectionIndicator)?this._selectionIndicator.viewModel:void 0;Object(u.a)(l)&&(l.position=z.clone(n,l.position),l.showSelection=c&&o,l.update());var h=Object(u.a)(this._infoBox)?this._infoBox.viewModel:void 0;Object(u.a)(h)&&(h.showInfo=c,h.enableCamera=o,h.isCameraTracking=this.trackedEntity===this.selectedEntity,c?(h.titleText=Object(w.a)(s.name,s.id),h.description=aD.getValueOrDefault(s.description,t,"")):(h.titleText="",h.description=""))},ECe.prototype._onEntityCollectionChanged=function(e,t,i){for(var n=i.length,r=0;r<n;r++){var a=i[r];this.trackedEntity===a&&(this.trackedEntity=void 0),this.selectedEntity===a&&(this.selectedEntity=void 0)}},ECe.prototype._onInfoBoxCameraClicked=function(e){if(e.isCameraTracking&&this.trackedEntity===this.selectedEntity)this.trackedEntity=void 0;else{var t=this.selectedEntity.position;Object(u.a)(t)?this.trackedEntity=this.selectedEntity:this.zoomTo(this.selectedEntity)}},ECe.prototype._clearTrackedObject=function(){this.trackedEntity=void 0},ECe.prototype._onInfoBoxClockClicked=function(e){this.selectedEntity=void 0},ECe.prototype._clearObjects=function(){this.trackedEntity=void 0,this.selectedEntity=void 0},ECe.prototype._onDataSourceChanged=function(e){this.clockTrackedDataSource===e&&wCe(this.timeline,this.clock,e)},ECe.prototype._onDataSourceAdded=function(e,t){this._automaticallyTrackDataSourceClocks&&(this.clockTrackedDataSource=t);var i=t.entities.id,n=this._eventHelper.add(t.changedEvent,ECe.prototype._onDataSourceChanged,this);this._dataSourceChangedListeners[i]=n},ECe.prototype._onDataSourceRemoved=function(e,t){var i=this.clockTrackedDataSource===t,n=t.entities.id;if(this._dataSourceChangedListeners[n](),this._dataSourceChangedListeners[n]=void 0,i){var r=e.length;this._automaticallyTrackDataSourceClocks&&r>0?this.clockTrackedDataSource=e.get(r-1):this.clockTrackedDataSource=void 0}},ECe.prototype.zoomTo=function(e,t){return TCe(this,e,{offset:t},!1)},ECe.prototype.flyTo=function(e,t){return TCe(this,e,t,!0)},ECe.prototype._postRender=function(){!function(e){var t=e._zoomTarget;if(!Object(u.a)(t)||e.scene.mode===xF.MORPHING)return;var i,n,r=e.scene,a=r.camera,o=e._zoomPromise,s=Object(w.a)(e._zoomOptions,{});if(t instanceof zse)return t.readyPromise.then((function(){var n=t.boundingSphere;Object(u.a)(s.offset)||(s.offset=new xO(0,-.5,n.radius)),i={offset:s.offset,duration:s.duration,maximumHeight:s.maximumHeight,complete:function(){o.resolve(!0)},cancel:function(){o.resolve(!1)}},e._zoomIsFlight?a.flyToBoundingSphere(t.boundingSphere,i):(a.viewBoundingSphere(n,s.offset),a.lookAtTransform(Be.IDENTITY),o.resolve(!0)),CCe(e)}));if(t instanceof dxe)return t.readyPromise.then((function(){var n=t.boundingSphere;Object(u.a)(s.offset)||(s.offset=new xO(0,-.5,n.radius)),i={offset:s.offset,duration:s.duration,maximumHeight:s.maximumHeight,complete:function(){o.resolve(!0)},cancel:function(){o.resolve(!1)}},e._zoomIsFlight?a.flyToBoundingSphere(n,i):(a.viewBoundingSphere(n,s.offset),a.lookAtTransform(Be.IDENTITY),o.resolve(!0)),CCe(e)}));if(t instanceof K)return i={destination:r.mapProjection.ellipsoid.cartographicToCartesian(t),duration:s.duration,maximumHeight:s.maximumHeight,complete:function(){o.resolve(!0)},cancel:function(){o.resolve(!1)}},e._zoomIsFlight?a.flyTo(i):(a.setView(i),o.resolve(!0)),void CCe(e);for(var c=t,l=[],h=0,d=c.length;h<d;h++){var f=e._dataSourceDisplay.getBoundingSphere(c[h],!1,vCe);if(f===nD.PENDING)return;f!==nD.FAILED&&l.push(St.clone(vCe))}if(0===l.length)return void SCe(e);e.trackedEntity=void 0,n=St.fromBoundingSpheres(l),e._zoomIsFlight?(CCe(e),a.flyToBoundingSphere(n,{duration:s.duration,maximumHeight:s.maximumHeight,complete:function(){o.resolve(!0)},cancel:function(){o.resolve(!1)},offset:s.offset})):(a.viewBoundingSphere(n,s.offset),a.lookAtTransform(Be.IDENTITY),CCe(e),o.resolve(!0))}(this),function(e){if(!e._needTrackedEntityUpdate)return;var t=e._trackedEntity,i=e.clock.currentTime,n=aD.getValueOrUndefined(t.position,i);if(!Object(u.a)(n))return;var r=e.scene,a=e._dataSourceDisplay.getBoundingSphere(t,!1,vCe);if(a===nD.PENDING)return;var o=r.mode;o!==xF.COLUMBUS_VIEW&&o!==xF.SCENE2D||(r.screenSpaceCameraController.enableTranslate=!1);o!==xF.COLUMBUS_VIEW&&o!==xF.SCENE3D||(r.screenSpaceCameraController.enableTilt=!1);var s=a!==nD.FAILED?vCe:void 0;e._entityView=new Xee(t,r,r.mapProjection.ellipsoid),e._entityView.update(i,s),e._needTrackedEntityUpdate=!1}(this)};var ACe=ECe;var PCe=function(e){x.a.typeOf.object("viewer",e);var t=document.createElement("div");t.className="cesium-viewer-cesium3DTilesInspectorContainer",e.container.appendChild(t);var i=new zEe(t,e.scene);Object(O.a)(e,{cesium3DTilesInspector:{get:function(){return i}}})};var ICe=function(e){if(!Object(u.a)(e))throw new h.a("viewer is required.");var t=document.createElement("div");t.className="cesium-viewer-cesiumInspectorContainer",e.container.appendChild(t);var i=new qEe(t,e.scene);Object(O.a)(e,{cesiumInspector:{get:function(){return i}}})};function DCe(e){e.stopPropagation(),e.preventDefault()}function jCe(e,t){var i=e;Object(u.a)(i)&&(i.removeEventListener("drop",t,!1),i.removeEventListener("dragenter",DCe,!1),i.removeEventListener("dragover",DCe,!1),i.removeEventListener("dragexit",DCe,!1))}function MCe(e,t){e.addEventListener("drop",t,!1),e.addEventListener("dragenter",DCe,!1),e.addEventListener("dragover",DCe,!1),e.addEventListener("dragexit",DCe,!1)}function RCe(e,t,i,n){var r=e.scene;return function(a){var o=t.name;try{var s;if(/\.czml$/i.test(o))s=sX.load(JSON.parse(a.target.result),{sourceUri:o});else if(/\.geojson$/i.test(o)||/\.json$/i.test(o)||/\.topojson$/i.test(o))s=Pte.load(JSON.parse(a.target.result),{sourceUri:o,clampToGround:n});else{if(!/\.(kml|kmz)$/i.test(o))return void e.dropError.raiseEvent(e,o,"Unrecognized file: "+o);s=cne.load(t,{sourceUri:o,proxy:i,camera:r.camera,canvas:r.canvas,clampToGround:n})}Object(u.a)(s)&&e.dataSources.add(s).then((function(t){e.flyToOnDrop&&e.flyTo(t)})).otherwise((function(t){e.dropError.raiseEvent(e,o,t)}))}catch(t){e.dropError.raiseEvent(e,o,t)}}}function LCe(e,t){return function(i){e.dropError.raiseEvent(e,t.name,i.target.error)}}var NCe=function(e,t){if(!Object(u.a)(e))throw new h.a("viewer is required.");if(e.hasOwnProperty("dropTarget"))throw new h.a("dropTarget is already defined by another mixin.");if(e.hasOwnProperty("dropEnabled"))throw new h.a("dropEnabled is already defined by another mixin.");if(e.hasOwnProperty("dropError"))throw new h.a("dropError is already defined by another mixin.");if(e.hasOwnProperty("clearOnDrop"))throw new h.a("clearOnDrop is already defined by another mixin.");if(e.hasOwnProperty("flyToOnDrop"))throw new h.a("flyToOnDrop is already defined by another mixin.");t=Object(w.a)(t,w.a.EMPTY_OBJECT);var i=!0,n=Object(w.a)(t.flyToOnDrop,!0),r=new $o.a,a=Object(w.a)(t.clearOnDrop,!0),o=Object(w.a)(t.dropTarget,e.container),s=Object(w.a)(t.clampToGround,!0),c=t.proxy;function l(t){DCe(t),a&&(e.entities.removeAll(),e.dataSources.removeAll());for(var i=t.dataTransfer.files,n=i.length,r=0;r<n;r++){var o=i[r],l=new FileReader;l.onload=RCe(e,o,c,s),l.onerror=LCe(e,o),l.readAsText(o)}}o=zfe(o),Object(O.a)(e,{dropTarget:{get:function(){return o},set:function(e){if(!Object(u.a)(e))throw new h.a("value is required.");jCe(o,l),MCe(o=e,l)}},dropEnabled:{get:function(){return i},set:function(e){e!==i&&(e?MCe(o,l):jCe(o,l),i=e)}},dropError:{get:function(){return r}},clearOnDrop:{get:function(){return a},set:function(e){a=e}},flyToOnDrop:{get:function(){return n},set:function(e){n=e}},proxy:{get:function(){return c},set:function(e){c=e}},clampToGround:{get:function(){return s},set:function(e){s=e}}}),MCe(o,l),e.destroy=YI(e,e.destroy,(function(){e.dropEnabled=!1})),e._handleDrop=l};var FCe=function(e,t){if(!Object(u.a)(e))throw new h.a("viewer is required.");t=Object(w.a)(t,w.a.EMPTY_OBJECT);var i=new jTe({scene:e.scene,container:e.bottomContainer,lowFrameRateMessage:t.lowFrameRateMessage});Object(O.a)(e,{performanceWatchdog:{get:function(){return i}}})};var kCe=function(e){var t;return function(i){var n=i.data,r=[],a={id:n.id,result:void 0,error:void 0};return Object(Oi.a)(function(e,t,i){try{return e(t,i)}catch(e){return Oi.a.reject(e)}}(e,n.parameters,r)).then((function(e){a.result=e})).otherwise((function(e){e instanceof Error?a.error={name:e.name,message:e.message,stack:e.stack}:a.error=e})).always((function(){Object(u.a)(t)||(t=Object(w.a)(self.webkitPostMessage,self.postMessage)),n.canTransferArrayBuffer||(r.length=0);try{t(a,r)}catch(e){a.result=void 0,a.error="postMessage failed with error: "+cu(e)+"\n  with responseMessage: "+JSON.stringify(a),t(a)}}))}},BCe="1.54",zCe="uniform sampler2D u_colorTexture;\nuniform sampler2D u_waterTexture;\nvarying vec2 v_textureCoordinates;\nvoid main()\n{\nvec4 motionless = texture2D(u_colorTexture, v_textureCoordinates);\nvec4 water = texture2D(u_waterTexture, v_textureCoordinates);\ngl_FragColor = length(water) > 0.0 ? water : motionless;\n}\n",UCe="uniform float colorScale;\nvarying vec4 clipPos;\nvarying vec4 lastclipPos;\nvoid main() {\nvec3 motion = ((clipPos / clipPos.w) - (lastclipPos / lastclipPos.w)).xyz;\nvec3 motionColor = ((colorScale * motion) + 2.0) / 4.0;\ngl_FragColor = vec4(motionColor, 1.0);\n}\n",VCe="attribute vec3 a_position;\nuniform mat4 lastFrameModelViewProjection;\nvarying vec4 clipPos;\nvarying vec4 lastclipPos;\nvoid main() {\nclipPos = czm_modelViewProjection * vec4(a_position, 1.0);\nlastclipPos = lastFrameModelViewProjection * vec4(a_position, 1.0);\ngl_Position = clipPos;\n}\n",HCe="uniform sampler2D colorTexture;\nuniform vec4 color;\n#ifdef HORIZONTAL\n#define GET_UV(X) vec2((gl_FragCoord.xy / czm_viewport.zw).x + KERNEL_SCALE_H*(X), (gl_FragCoord.xy / czm_viewport.zw).y)\n#else\n#define GET_UV(Y) vec2((gl_FragCoord.xy / czm_viewport.zw).x, (gl_FragCoord.xy / czm_viewport.zw).y + KERNEL_SCALE_V*(Y))\n#endif\n#define PI 3.14159265358979\n#define SIGMA ((KERNEL_RADIUS+KERNEL_RADIUS+1.0) / 6.0)\n#define SIGMASQ2 (2.0 * SIGMA * SIGMA)\n#define GAUSSIAN(X) ( (1.0 / sqrt(PI * SIGMASQ2)) * exp(-(X)*(X)/SIGMASQ2) )\nvoid main() {\nvec2 st =  (gl_FragCoord.xy / czm_viewport.zw);\nvec4 texColSum = vec4(0.0);\nfloat gaussSum = 0.0;\nfor (float x=-KERNEL_RADIUS; x<=KERNEL_RADIUS; x+=1.0) {\nfloat gauss = GAUSSIAN(x);\nvec4 texCol = texture2D(colorTexture, GET_UV(x));\n#ifdef HAS_ALPHA\ntexCol.rgb *= texCol.a;\n#endif\ntexColSum += texCol * gauss;\ngaussSum += gauss;\n}\n#ifdef HAS_ALPHA\ntexColSum.rgb /= (texColSum.a == 0.0 ? 0.0001 : texColSum.a);\n#endif\n#ifdef HORIZONTAL\ngl_FragColor = texColSum/gaussSum;\n#else\ngl_FragColor = texColSum/gaussSum * color;\n#endif\n}\n",GCe="uniform sampler2D colorTexture;\nvarying vec2 vUv;\n#ifdef ENABLE_CLIPPING_PLANES\nuniform sampler2D u_clippingPlanes;\nuniform mat4 u_clippingPlanesMatrix;\nuniform vec4 u_clippingPlanesEdgeStyle;\n#endif\nvoid main()\n{\nvec4 color =  texture2D(colorTexture, vUv);\nfloat shadowIntensity = 0.5 * (1.0 - color.r);\nvec4 finalColor =  vec4(0.0,0.0,0.0,shadowIntensity);\n#ifdef ENABLE_CLIPPING_PLANES\nfloat clipDistance = clip(gl_FragCoord, u_clippingPlanes, u_clippingPlanesMatrix);\n#endif\n#ifdef ENABLE_CLIPPING_PLANES\nvec4 clippingPlanesEdgeColor = vec4(1.0);\nclippingPlanesEdgeColor.rgb = u_clippingPlanesEdgeStyle.rgb;\nfloat clippingPlanesEdgeWidth = u_clippingPlanesEdgeStyle.a;\nif (clipDistance > 0.0 && clipDistance < clippingPlanesEdgeWidth)\n{\nfinalColor = clippingPlanesEdgeColor;\n}\n#endif\ngl_FragColor =finalColor;\n}\n",qCe="attribute vec3 position;\nattribute vec2 uv;\nuniform mat4 u_modelViewMatrix;\nvarying vec2 vUv;\nvoid main()\n{\ngl_Position = czm_projection *  u_modelViewMatrix * vec4( position, 1.0 );\nvUv = uv;\n}\n",WCe="uniform float opacity;\nuniform float height;\nuniform float width;\nuniform sampler2D tDiffuse;\nuniform sampler2D tDepth;\nuniform sampler2D tMotion;\nuniform sampler2D tLastFrame;\nvarying vec2 v_textureCoordinates;\nvec2 getNearestUV(){\nfloat nearestDepth = 0.0;\nvec2 nearestUV;\nfor (int x = -1; x <= 1; x++) {\nfor (int y = -1; y <= 1; y++) {\nvec2 neighborUv = v_textureCoordinates + vec2(float(x) / width, float(y) / height);\nfloat neighDepth = czm_readDepth(tDepth,neighborUv);\nif(nearestDepth == 0.0 || neighDepth < nearestDepth){\nnearestDepth = neighDepth;\nnearestUV = neighborUv;\n}\n}\n}\nreturn nearestUV;\n}\nvec3 ClipAABB(vec3 aabbMin, vec3 aabbMax, vec3 prevSample, vec3 avg)\n{\nvec3 p_clip = 0.5 * (aabbMax + aabbMin);\nvec3 e_clip = 0.5 * (aabbMax - aabbMin);\nvec3 v_clip = prevSample - p_clip;\nvec3 v_unit = v_clip.xyz / e_clip;\nvec3 a_unit = abs(v_unit);\nfloat ma_unit = max(a_unit.x, max(a_unit.y, a_unit.z));\nif (ma_unit > 1.0)\nreturn p_clip + v_clip / ma_unit;\nelse\nreturn prevSample;\n}\nvoid main() {\nvec4 texel = texture2D(tDiffuse, v_textureCoordinates);\nvec4 pixelMovement = texture2D(tMotion, v_textureCoordinates);\nif(length(pixelMovement.xy) == 0.0){\ngl_FragColor = texel;\n}\nelse{\nvec2 oldPixelUv = v_textureCoordinates - ((pixelMovement.xy * 2.0) - 1.0);\nvec4 oldTexel = texture2D(tLastFrame, oldPixelUv);\nvec4 maxNeighbor = vec4(0.0, 0.0, 0.0, 1.0);\nvec4 minNeighbor = vec4(1.0);\nvec4 average = vec4(0.0);\nfor (int x = -1; x <= 1; x++) {\nfor (int y = -1; y <= 1; y++) {\nvec2 neighborUv = v_textureCoordinates + vec2(float(x) / width, float(y) / height);\nvec4 neighborTexel = texture2D(tDiffuse, neighborUv);\nmaxNeighbor = max(maxNeighbor, neighborTexel);\nminNeighbor = min(minNeighbor, neighborTexel);\naverage += neighborTexel / 9.0;\n}\n}\noldTexel = clamp(oldTexel, minNeighbor, maxNeighbor);\nfloat contrast = distance(average, texel);\nfloat weight = 0.05 * contrast;\nvec4 compositeColor = mix(oldTexel, texel, weight);\ngl_FragColor = opacity * compositeColor;\n}\n}\n",YCe="attribute vec4 position;\nattribute vec2 textureCoordinates;\nvarying vec2 v_textureCoordinates;\nvoid main()\n{\ngl_Position = czm_modelViewProjection * position;\nv_textureCoordinates = textureCoordinates;\n}\n",XCe="varying vec3 worldSpaceCoords;\nvoid main()\n{\ngl_FragColor = vec4( worldSpaceCoords.x , worldSpaceCoords.y, worldSpaceCoords.z, 1 );\n}\n",ZCe="attribute vec3 position;\nvarying vec3 worldSpaceCoords;\nuniform vec3 dimensions;\nvoid main()\n{\ngl_Position = czm_projection * czm_modelView * vec4( position, 1.0 );\nworldSpaceCoords = (position+dimensions/2.0)/dimensions;\n}\n",QCe="varying vec3 worldSpaceCoords;\nuniform sampler2D tex, cubeTex, transferTex;\nuniform float steps;\nuniform float alphaCorrection;\nuniform bool isRGB;\nconst int MAX_STEPS = 1024;\nconst float GRID_NUMBER_X = 5.0;\nconst float GRID_NUMBER_Y = 5.0;\nfloat decodeValue(vec3 cv) {\nreturn (cv.r + cv.g + cv.b) / 3.0;\n}\nvec4 texture3Dfrom2D(vec3 pos)\n{\nvec2 islices = vec2(1.0 /GRID_NUMBER_X, 1.0 /GRID_NUMBER_Y);\nfloat Z = pos.z * GRID_NUMBER_X * GRID_NUMBER_Y;\nint slice = int(Z);\nvec2 sampleOffset = pos.xy * islices;\nsampleOffset.x = islices.x-sampleOffset.x;\nfloat A = float(slice) * islices.x;\nfloat B = float(slice+1) * islices.x;\nvec2 z1offset = vec2(fract(A), floor(A) / GRID_NUMBER_Y) + sampleOffset;\nvec2 z2offset = vec2(fract(B), floor(B) / GRID_NUMBER_Y) + sampleOffset;\nz1offset.x = 1.0 - z1offset.x;\nz2offset.x = 1.0 - z2offset.x;\nif(isRGB){\nreturn mix(texture2D(cubeTex, z1offset), texture2D(cubeTex, z2offset), fract(Z));\n}\nfloat z1 = decodeValue(texture2D(cubeTex, z1offset).rgb);\nfloat z2 = decodeValue(texture2D(cubeTex, z2offset).rgb);\nvec4 color1 = texture2D( transferTex, vec2( z1, 1.0) );\nvec4 color2 = texture2D( transferTex, vec2( z2, 1.0) );\nreturn mix(color1, color2, fract(Z));\n}\nvec4 sampleAs3DTexture( vec3 texCoord )\n{\nvec4 colorSlice1, colorSlice2;\nvec2 texCoordSlice1, texCoordSlice2;\nfloat totalZ = GRID_NUMBER_X*GRID_NUMBER_Y-1.0;\nfloat zSliceNumber1 = floor(texCoord.z  * totalZ);\nfloat zSliceNumber2 = min( zSliceNumber1 + 1.0, totalZ);\ntexCoord.x /= GRID_NUMBER_X;\ntexCoord.y /= GRID_NUMBER_Y;\ntexCoordSlice1 = texCoordSlice2 = texCoord.xy;\ntexCoordSlice1.x += (mod(zSliceNumber1, GRID_NUMBER_X ) / GRID_NUMBER_X);\ntexCoordSlice1.y += floor((zSliceNumber1) / GRID_NUMBER_Y) / GRID_NUMBER_Y;\ntexCoordSlice2.x += (mod(zSliceNumber2, GRID_NUMBER_X ) /GRID_NUMBER_X);\ntexCoordSlice2.y += floor((zSliceNumber2) / GRID_NUMBER_Y) / GRID_NUMBER_Y;\ntexCoordSlice1.x = 1.0 - texCoordSlice1.x;\ntexCoordSlice2.x = 1.0 - texCoordSlice2.x;\nfloat zDifference = mod(texCoord.z * totalZ, 1.0);\ncolorSlice1 = texture2D( cubeTex, texCoordSlice1 );\ncolorSlice2 = texture2D( cubeTex, texCoordSlice2 );\nif(isRGB){\nreturn mix(colorSlice1, colorSlice2, zDifference) ;\n}\nfloat z1 = decodeValue(colorSlice1.rgb);\nfloat z2 = decodeValue(colorSlice2.rgb);\ncolorSlice1.rgb = texture2D( transferTex, vec2( colorSlice1.a, 1.0) ).rgb;\ncolorSlice2.rgb = texture2D( transferTex, vec2( colorSlice2.a, 1.0) ).rgb;\nreturn mix(colorSlice1, colorSlice2, zDifference);\n}\nvoid main( void ) {\nvec2 texc = gl_FragCoord.xy/czm_viewport.zw;\nvec3 backPos = texture2D(tex, texc).xyz;\nvec3 frontPos =  worldSpaceCoords;\nvec3 dir = backPos - frontPos;\nfloat rayLength = length(dir);\nfloat delta = 1.0 / steps;\nvec3 deltaDirection = normalize(dir) * delta;\nfloat deltaDirectionLength = length(deltaDirection);\nvec3 currentPosition = frontPos;\nvec4 accumulatedColor = vec4(0.0);\nfloat accumulatedAlpha = 0.0;\nfloat accumulatedLength = 0.0;\nfloat alphaScaleFactor = 25.6 * delta;\nvec4 colorSample;\nfloat alphaSample;\nfor(int i = 0; i < MAX_STEPS; i++)\n{\ncolorSample = texture3Dfrom2D( currentPosition );\nalphaSample = colorSample.a * alphaCorrection;\nalphaSample *= (1.0 - accumulatedAlpha);\nalphaSample *= alphaScaleFactor;\naccumulatedColor += colorSample * alphaSample;\naccumulatedAlpha += alphaSample;\ncurrentPosition += deltaDirection;\naccumulatedLength += deltaDirectionLength;\nif(accumulatedLength >= rayLength || accumulatedAlpha >= 1.0 )\nbreak;\n}\ngl_FragColor  =    accumulatedColor;\n}\n",KCe="attribute vec3 position;\nvarying vec3 worldSpaceCoords;\nuniform vec3 dimensions;\nvoid main()\n{\nworldSpaceCoords = (position+dimensions/2.0)/dimensions;\ngl_Position = czm_projection * czm_modelView * vec4( position, 1.0 );\n}\n",JCe="uniform sampler2D mirrorSampler;\nuniform float alpha;\nuniform float size;\nuniform float reflectFactor;\nuniform float distortionScale;\nuniform float speed;\nuniform sampler2D normalSampler;\nuniform vec3 sunColor;\nuniform vec3 waterColor;\nuniform vec2 u_flowDir;\nvarying vec4 mirrorCoord;\nvarying vec4 worldPosition;\nvarying vec2 uvOffset;\nvarying vec4 projectionCoord;\nvec4 getNoise( vec2 uv) {\nvec3 sam = vec3(u_flowDir, 1.0);\nvec2 flowdir = sam.xy -0.5;\nflowdir *= sam.b;\nmat2 rotmat = mat2(flowdir.x, -flowdir.y, flowdir.y ,flowdir.x);\nvec2 uv0 = ( (rotmat * uv  ) / 103.0 ) + vec2(czm_frameNumber * speed / 17.0, czm_frameNumber * speed / 29.0);\nvec2 uv1 = (rotmat * uv ) / 107.0-vec2( czm_frameNumber * speed / -19.0, czm_frameNumber* speed / 31.0 );\nvec2 uv2 = (rotmat * uv )/ vec2( 8907.0, 9803.0 ) + vec2( czm_frameNumber * speed  / 101.0, czm_frameNumber * speed / 97.0 );\nvec2 uv3 = (rotmat * uv ) / vec2( 1091.0, 1027.0 ) - vec2( czm_frameNumber * speed / 109.0, czm_frameNumber * speed / -113.0 );\nvec4 noise = texture2D( normalSampler, uv0 ) +\ntexture2D( normalSampler, uv1 ) +\ntexture2D( normalSampler, uv2 ) +\ntexture2D( normalSampler, uv3 );\nreturn noise * 0.5 - 1.0;\n}\nvoid sunLight( const vec3 surfaceNormal, const vec3 eyeDirection, float shiny, float spec, float diffuse, inout vec3 diffuseColor, inout vec3 specularColor ) {\nvec3 reflection = normalize( reflect( -czm_sunDirectionWC, surfaceNormal ) );\nfloat direction = max( 0.0, dot( eyeDirection, reflection ) );\nspecularColor += pow( direction, shiny ) * sunColor * spec;\ndiffuseColor += max( dot( czm_sunDirectionWC, surfaceNormal ), 0.0 ) * sunColor * diffuse;\n}\nvoid main() {\nvec2 final = projectionCoord.xy / projectionCoord.w;\nfinal = final * 0.5 + 0.5;\nfinal.y = 1.0 - final.y;\nvec4 noise = getNoise( uvOffset * size);\nvec3 surfaceNormal = noise.xyz * vec3( 1.5, 1.0, 1.5);\nsurfaceNormal = normalize(surfaceNormal);\nvec3 diffuseLight = waterColor;\nvec3 specularLight = vec3(0.0);\nvec3 worldToEye = czm_viewerPositionWC - worldPosition.xyz;\nvec3 eyeDirection = normalize( worldToEye );\nsunLight( surfaceNormal, eyeDirection, 100.0, 2.0, 0.0, diffuseLight, specularLight );\nfloat distance = length(worldToEye);\nvec2 distortion = surfaceNormal.xz * ( 0.001 + 1.0 / distance ) * distortionScale;\nvec3 reflectionSample = vec3( texture2D( mirrorSampler, final+ distortion) );\nfloat theta = max( dot( eyeDirection, surfaceNormal ), 0.0 );\nfloat rf0 = 0.3;\nfloat reflectance = rf0 + ( 1.0 - rf0 ) * pow( ( 1.0 - theta ), 5.0 );\nvec3 scatter = max( 0.0, dot( surfaceNormal, eyeDirection ) ) * waterColor;\nvec3 albedo = mix( ( sunColor * diffuseLight * 0.3 + scatter ), ( vec3( 0.1 ) + reflectionSample * 0.9 + reflectionSample * specularLight ), reflectance * reflectFactor );\nvec3 outgoingLight = albedo;\ngl_FragColor = vec4( outgoingLight, alpha );\n}\n",$Ce="attribute vec3 position;\nattribute vec2 uv;\nuniform mat4 textureMatrix;\nuniform mat4 u_modelViewMatrix;\nuniform mat4 u_modelMatrix;\nvarying vec4 mirrorCoord;\nvarying vec4 worldPosition;\nvarying vec4 projectionCoord;\nvarying vec2 uvOffset;\nvoid main() {\nvec4 mvPosition =  u_modelViewMatrix * vec4( position, 1.0 );\nmirrorCoord = u_modelMatrix * vec4( position, 1.0 );\nworldPosition = mirrorCoord.xyzw;\nmirrorCoord = textureMatrix * mirrorCoord;\nuvOffset = uv;\ngl_Position = czm_projection * mvPosition;\nprojectionCoord = gl_Position;\n}\n",eSe="uniform sampler2D u_normalMap;\nuniform sampler2D u_refractMap;\nuniform sampler2D u_reflectMap;\nuniform vec4 u_waterColor;\nuniform vec4 u_refractColor;\nuniform int u_useRefractTex;\nuniform vec4 u_reflectColor;\nuniform int u_reflection;\nuniform vec2 u_flowDir;\nvarying vec3 eyeDir;\nvarying vec2 texCoord;\nvarying vec4 projectionCoord;\nvoid main ()\n{\nfloat texScale = 35.0;\nfloat texScale2 = 10.0;\nfloat myangle;\nfloat transp;\nvec3 myNormal;\nvec2 mytexFlowCoord = texCoord * texScale;\nvec2 ff = abs(2.0*(fract(mytexFlowCoord)) - 1.0) -0.5;\nff = 0.5-4.0*ff*ff*ff;\nvec2 ffscale = sqrt(ff*ff + (1.0-ff)*(1.0-ff));\nvec2 Tcoord = texCoord  * texScale2;\nvec2 offset = vec2(czm_frameNumber * 0.0005,0.0);\nvec3 sam = vec3(u_flowDir, 1.0);\nvec2 flowdir = sam.xy -0.5;\nflowdir *= sam.b;\nmat2 rotmat = mat2(flowdir.x, -flowdir.y, flowdir.y ,flowdir.x);\nvec2 NormalT0 = texture2D(u_normalMap, rotmat * Tcoord - offset).rg;\nsam = vec3(u_flowDir, 1.0);\nflowdir = sam.b * (sam.xy - 0.5);\nrotmat = mat2(flowdir.x, -flowdir.y, flowdir.y ,flowdir.x);\nvec2 NormalT1 = texture2D(u_normalMap, rotmat * Tcoord - offset*1.06+0.62).rg;\nvec2 NormalTAB = ff.x * NormalT0 + (1.0-ff.x) * NormalT1;\nsam = vec3(u_flowDir, 1.0);\nflowdir = sam.b * (sam.xy - 0.5);\nrotmat = mat2(flowdir.x, -flowdir.y, flowdir.y ,flowdir.x);\nNormalT0 = texture2D(u_normalMap, rotmat * Tcoord - offset*1.33+0.27).rg;\nsam = vec3(u_flowDir, 1.0);\nflowdir = sam.b * (sam.xy - 0.5);\nrotmat = mat2(flowdir.x, -flowdir.y, flowdir.y ,flowdir.x);\nNormalT1 = texture2D(u_normalMap, rotmat * Tcoord - offset*1.24).rg ;\nvec2 NormalTCD = ff.x * NormalT0 + (1.0-ff.x) * NormalT1;\nvec2 NormalT = ff.y * NormalTAB + (1.0-ff.y) * NormalTCD;\nNormalT = (NormalT - 0.5) / (ffscale.y * ffscale.x);\nNormalT *= 0.3;\ntransp = 1.0;\nNormalT *= transp*transp;\nmyNormal = vec3(NormalT,sqrt(1.0-NormalT.x*NormalT.x - NormalT.y*NormalT.y));\nvec3 envColor = u_reflectColor.rgb;\nif (u_reflection == 1)\n{\nvec2 final = projectionCoord.xy / projectionCoord.w;\nfinal = final * 0.5 + 0.5;\nfinal.y = 1.0 - final.y;\nenvColor = texture2D(u_reflectMap, final + myNormal.xy/texScale2*transp).rgb;\n}\nmyangle = dot(myNormal,normalize(eyeDir));\nmyangle = 0.95-0.6*myangle*myangle;\nvec3 base = u_refractColor.rgb;\nif (u_useRefractTex == 1){\nbase = texture2D(u_refractMap,(texCoord + myNormal.xy/texScale2*0.03*transp)).rgb;\n}\nbase = mix(base, u_waterColor.rgb, u_waterColor.a);\ngl_FragColor = vec4(mix(base, envColor , myangle*transp), 1.0);\n}\n",tSe="attribute vec3 position;\nattribute vec2 st;\nuniform mat4 u_modelViewProjectionMatrix;\nuniform mat4 u_modelViewMatrix;\nuniform mat4 u_invWorldViewMatrix;\nuniform vec2 u_texCoordOffset;\nuniform vec2 u_texCoordScale;\nuniform int u_clampToGroud;\nuniform vec3 u_camPos;\nuniform vec3 u_scale;\nvarying vec3 eyeDir;\nvarying vec2 texCoord;\nvarying vec4 projectionCoord;\nvoid main()\n{\ngl_Position = u_modelViewProjectionMatrix * vec4(position.xyz,1.0);\nif (u_clampToGroud == 1)\n{\neyeDir = (u_camPos - position.xyz) * u_scale;\n} else {\nvec4 pos = u_modelViewMatrix * vec4(position.xyz,1.0);\neyeDir = vec3(u_invWorldViewMatrix*vec4(pos.xyz,0.0));\nprojectionCoord = gl_Position;\n}\ntexCoord = (st+u_texCoordOffset)*u_texCoordScale;\n}\n";function iSe(e){e=Object(w.a)(e,w.a.EMPTY_OBJECT),x.a.defined("options.url",e.url),this._url=void 0,this._basePath=void 0,this._root=void 0,this._asset=void 0,this._properties=void 0,this._geometricError=void 0,this._extensionsUsed=void 0,this._gltfUpAxis=void 0,this._cache=new y5,this._processingQueue=[],this._selectedTiles=[],this._emptyTiles=[],this._requestedTiles=[],this._selectedTilesToStyle=[],this._loadTimestamp=void 0,this._timeSinceLoad=0,this._extras=void 0,this._cullWithChildrenBounds=Object(w.a)(e.cullWithChildrenBounds,!0),this._allTilesAdditive=!0,this._hasMixedContent=!1,this._backfaceCommands=new Tx,this._maximumScreenSpaceError=Object(w.a)(e.maximumScreenSpaceError,16),this._maximumMemoryUsage=Object(w.a)(e.maximumMemoryUsage,512),this._styleEngine=new $5,this._modelMatrix=Object(u.a)(e.modelMatrix)?Be.clone(e.modelMatrix):Be.clone(Be.IDENTITY),this._statistics=new x5,this._statisticsLastColor=new x5,this._statisticsLastPick=new x5,this._tilesLoaded=!1,this._initialTilesLoaded=!1,this._tileDebugLabels=void 0,this._readyPromise=Oi.a.defer(),this._classificationType=e.classificationType,this._ellipsoid=Object(w.a)(e.ellipsoid,ae.WGS84),this._useBoundingSphereForClipping=!1,this._clippingPlaneOffsetMatrix=void 0,this._useGradual=Object(w.a)(e.useGradual,!1),this._planView=Object(w.a)(e.planView,!1),this._shouldAnimate=Object(w.a)(e.shouldAnimate,!1),this._centerPos=Object(w.a)(e.centerPos,z.ZERO),this._forceMipmap=Object(w.a)(e.forceMipmap,!1),this.dynamicScreenSpaceError=Object(w.a)(e.dynamicScreenSpaceError,!1),this.dynamicScreenSpaceErrorDensity=.00278,this.dynamicScreenSpaceErrorFactor=4,this.dynamicScreenSpaceErrorHeightFalloff=.25,this._dynamicScreenSpaceErrorComputedDensity=0,this.shadows=Object(w.a)(e.shadows,rM.ENABLED),this.show=Object(w.a)(e.show,!0),this.colorBlendMode=gX.HIGHLIGHT,this.colorBlendAmount=.5,this.pointCloudShading=new u6(e.pointCloudShading),this._pointCloudEyeDomeLighting=new c6,this.loadProgress=new $o.a,this.allTilesLoaded=new $o.a,this.initialTilesLoaded=new $o.a,this.tileLoad=new $o.a,this.tileUnload=new $o.a,this.tileFailed=new $o.a,this.tileVisible=new $o.a,this.skipLevelOfDetail=Object(w.a)(e.skipLevelOfDetail,!0),this._skipLevelOfDetail=this.skipLevelOfDetail,this._disableSkipLevelOfDetail=!1,this.baseScreenSpaceError=Object(w.a)(e.baseScreenSpaceError,1024),this.skipScreenSpaceErrorFactor=Object(w.a)(e.skipScreenSpaceErrorFactor,16),this.skipLevels=Object(w.a)(e.skipLevels,1),this.immediatelyLoadDesiredLevelOfDetail=Object(w.a)(e.immediatelyLoadDesiredLevelOfDetail,!1),this.loadSiblings=Object(w.a)(e.loadSiblings,!1),this._clippingPlanes=void 0,this.clippingPlanes=e.clippingPlanes,this.debugFreezeFrame=Object(w.a)(e.debugFreezeFrame,!1),this.debugColorizeTiles=Object(w.a)(e.debugColorizeTiles,!1),this.debugWireframe=Object(w.a)(e.debugWireframe,!1),this.debugShowBoundingVolume=Object(w.a)(e.debugShowBoundingVolume,!1),this.debugShowContentBoundingVolume=Object(w.a)(e.debugShowContentBoundingVolume,!1),this.debugShowViewerRequestVolume=Object(w.a)(e.debugShowViewerRequestVolume,!1),this._tileDebugLabels=void 0,this.debugPickedTileLabelOnly=!1,this.debugPickedTile=void 0,this.debugPickPosition=void 0,this.debugShowGeometricError=Object(w.a)(e.debugShowGeometricError,!1),this.debugShowRenderingStatistics=Object(w.a)(e.debugShowRenderingStatistics,!1),this.debugShowMemoryUsage=Object(w.a)(e.debugShowMemoryUsage,!1),this.debugShowUrl=Object(w.a)(e.debugShowUrl,!1),this._credits=void 0;var t,i,n=e.url;t=f.a.createIfNeeded(n);var r=e.access_token;if(Object(u.a)(r)&&(t.headers={access_token:r}),this._credits=t.credits,"gltf"===t.extension){i=t.getBaseUri(!0),this._basePath=i;var a=n.split("/");n=a[a.length-1];var o={asset:{version:"1.0"},root:{boundingVolume:{box:e.bboxArr},content:{uri:n+r?"?access_token="+r:""},transform:e.modelMatrixArr,geometricError:0,refine:"REPLACE"}};this._root=this.loadTileset(t,o);var s=Object(u.a)(o.asset.gltfUpAxis)?mX.fromName(o.asset.gltfUpAxis):mX.Y;this._asset=o.asset,this._properties=o.properties,this._geometricError=o.geometricError,this._extensionsUsed=o.extensionsUsed,this._gltfUpAxis=s,this._extras=o.extras,Object(u.a)(o.root.transform)||(this._useBoundingSphereForClipping=!0,this._clippingPlaneOffsetMatrix=xa.eastNorthUpToFixedFrame(this.boundingSphere.center)),this._readyPromise.resolve(this)}}Object(O.a)(iSe.prototype,{asset:{get:function(){if(!this.ready)throw new h.a("The tileset is not loaded.  Use Cesium3DTilesetForSingleGltf.readyPromise or wait for Cesium3DTilesetForSingleGltf.ready to be true.");return this._asset}},clippingPlanes:{get:function(){return this._clippingPlanes},set:function(e){iJ.setOwner(e,this,"_clippingPlanes")}},properties:{get:function(){if(!this.ready)throw new h.a("The tileset is not loaded.  Use Cesium3DTilesetForSingleGltf.readyPromise or wait for Cesium3DTilesetForSingleGltf.ready to be true.");return this._properties}},ready:{get:function(){return Object(u.a)(this._root)}},readyPromise:{get:function(){return this._readyPromise.promise}},tilesLoaded:{get:function(){return this._tilesLoaded}},url:{get:function(){return this._url}},basePath:{get:function(){return Object(mv.a)("Cesium3DTilesetForSingleGltf.basePath","Cesium3DTilesetForSingleGltf.basePath has been deprecated. All tiles are relative to the url of the tileset JSON file that contains them. Use the url property instead."),this._basePath}},style:{get:function(){return this._styleEngine.style},set:function(e){this._styleEngine.style=e}},maximumScreenSpaceError:{get:function(){return this._maximumScreenSpaceError},set:function(e){x.a.typeOf.number.greaterThanOrEquals("maximumScreenSpaceError",e,0),this._maximumScreenSpaceError=e}},maximumMemoryUsage:{get:function(){return this._maximumMemoryUsage},set:function(e){x.a.typeOf.number.greaterThanOrEquals("value",e,0),this._maximumMemoryUsage=e}},root:{get:function(){if(!this.ready)throw new h.a("The tileset is not loaded.  Use Cesium3DTilesetForSingleGltf.readyPromise or wait for Cesium3DTilesetForSingleGltf.ready to be true.");return this._root}},boundingSphere:{get:function(){if(!this.ready)throw new h.a("The tileset is not loaded.  Use Cesium3DTilesetForSingleGltf.readyPromise or wait for Cesium3DTilesetForSingleGltf.ready to be true.");return this._root.updateTransform(this._modelMatrix),this._root.boundingSphere}},modelMatrix:{get:function(){return this._modelMatrix},set:function(e){this._modelMatrix=Be.clone(e,this._modelMatrix)}},timeSinceLoad:{get:function(){return this._timeSinceLoad}},totalMemoryUsageInBytes:{get:function(){var e=this._statistics;return e.texturesByteLength+e.geometryByteLength+e.batchTableByteLength}},clippingPlaneOffsetMatrix:{get:function(){return this._useBoundingSphereForClipping?this._clippingPlaneOffsetMatrix:this.root.computedTransform}},styleEngine:{get:function(){return this._styleEngine}},statistics:{get:function(){return this._statistics}},classificationType:{get:function(){return this._classificationType}},ellipsoid:{get:function(){return this._ellipsoid}},extras:{get:function(){if(!this.ready)throw new h.a("The tileset is not loaded.  Use Cesium3DTilesetForSingleGltf.readyPromise or wait for Cesium3DTilesetForSingleGltf.ready to be true.");return this._extras}}}),iSe.loadJson=function(e){return f.a.createIfNeeded(e).fetchJson()},iSe.prototype.makeStyleDirty=function(){this._styleEngine.makeDirty()},iSe.prototype.loadTileset=function(e,t,i){var n=t.asset;if(!Object(u.a)(n))throw new Ce.a("Tileset must have an asset property.");if("0.0"!==n.version&&"1.0"!==n.version)throw new Ce.a("The tileset must be 3D Tiles version 0.0 or 1.0.");var r=this._statistics,a=n.tilesetVersion;Object(u.a)(a)?(this._basePath+="?v="+a,e.setQueryParameters({v:a})):delete e.queryParameters.v;var o=new r5(this,e,t.root,i);Object(u.a)(i)&&(i.children.push(o),o._depth=i._depth+1);var s=[];for(s.push(o);s.length>0;){var c=s.pop();++r.numberOfTilesTotal,this._allTilesAdditive=this._allTilesAdditive&&c.refine===H1.ADD;var l=c._header.children;if(Object(u.a)(l))for(var h=l.length,d=0;d<h;++d){var f=l[d],p=new r5(this,e,f,c);c.children.push(p),p._depth=c._depth+1,s.push(p)}this._cullWithChildrenBounds&&s5.checkChildrenWithinParent(c)}return o};var nSe=new z,rSe=new K,aSe=new Be,oSe=new z,sSe=new z,cSe=new z;function lSe(e,t){if(!t.hasEmptyContent){var i=e._statistics,n=t.contentExpired;t.requestContent()?(n&&(t.hasTilesetContent?function(e,t){var i=t,n=e._statistics,r=bSe;r.push(t);for(;r.length>0;){for(var a=(t=r.pop()).children,o=a.length,s=0;s<o;++s)r.push(a[s]);t!==i&&(wSe(e,t),--n.numberOfTilesTotal)}i.children=[]}(e,t):(i.decrementLoadCounts(t.content),--e._statistics.numberOfTilesWithContentReady)),++i.numberOfPendingRequests,t.contentReadyToProcessPromise.then(function(e,t){return function(){e._processingQueue.push(t),--e._statistics.numberOfPendingRequests,++e._statistics.numberOfTilesProcessing}}(e,t)),t.contentReadyPromise.then(function(e,t){return function(){--e._statistics.numberOfTilesProcessing,t.hasTilesetContent||(e._statistics.incrementLoadCounts(t.content),++e._statistics.numberOfTilesWithContentReady,e._cache.add(t)),e.tileLoad.raiseEvent(t)}}(e,t)).otherwise(function(e,t){return function(i){e._processingQueue.indexOf(t)>=0?--e._statistics.numberOfTilesProcessing:--e._statistics.numberOfPendingRequests;var n=t._contentResource.url,r=Object(u.a)(i.message)?i.message:i.toString();e.tileFailed.numberOfListeners>0?e.tileFailed.raiseEvent({url:n,message:r}):(console.log("A 3D tile failed to load: "+n),console.log("Error: "+r))}}(e,t))):++i.numberOfAttemptedRequests}}function uSe(e,t){return e._priority-t._priority}function hSe(e,t){!function(e){for(var t=e._processingQueue,i=t.length,n=0,r=0;r<i;++r){var a=t[r];a._contentState===y4.PROCESSING?n>0&&(t[r-n]=a):++n}t.length-=n}(e);for(var i=e._processingQueue,n=i.length,r=0;r<n;++r)i[r].process(e,t)}var dSe=new z,fSe={maximumFractionDigits:3};function pSe(e){var t=e/1048576;return t<1?t.toLocaleString(void 0,fSe):Math.round(t).toLocaleString()}function mSe(e){var t=e.boundingVolume.boundingVolume,i=t.halfAxes,n=t.radius,r=z.clone(t.center,dSe);if(Object(u.a)(i))r.x+=.75*(i[0]+i[3]+i[6]),r.y+=.75*(i[1]+i[4]+i[7]),r.z+=.75*(i[2]+i[5]+i[8]);else if(Object(u.a)(n)){var a=z.normalize(t.center,dSe);a=z.multiplyByScalar(a,.75*n,dSe),r=z.add(a,t.center,dSe)}return r}function _Se(e,t,i){var n="",r=0;(t.debugShowGeometricError&&(n+="\nGeometric error: "+e.geometricError,r++),t.debugShowRenderingStatistics)&&(n+="\nCommands: "+e.commandsLength,r++,e.content.pointsLength>0&&(n+="\nPoints: "+e.content.pointsLength,r++),e.content.trianglesLength>0&&(n+="\nTriangles: "+e.content.trianglesLength,r++),n+="\nFeatures: "+e.content.featuresLength,r++);t.debugShowMemoryUsage&&(n+="\nTexture Memory: "+pSe(e.content.texturesByteLength),n+="\nGeometry Memory: "+pSe(e.content.geometryByteLength),r+=2),t.debugShowUrl&&(n+="\nUrl: "+e._header.content.uri,r++);var a={text:n.substring(1),position:i,font:19-r+"px sans-serif",showBackground:!0,disableDepthTestDistance:Number.POSITIVE_INFINITY};return t._tileDebugLabels.add(a)}var gSe=new fX({stencil:0,pass:lM.CESIUM_3D_TILE});function vSe(e,t){e._styleEngine.applyStyle(e,t);var i,n,r=e._statistics,a=t.commandList,o=a.length,s=e._selectedTiles,c=s.length,l=e._emptyTiles,h=l.length,d=e.tileVisible,f=e._skipLevelOfDetail&&e._hasMixedContent&&t.context.stencilBuffer&&c>0;e._backfaceCommands.length=0,f&&a.push(gSe);var p=a.length;for(i=0;i<c;++i)n=s[i],d.raiseEvent(n),n.update(e,t),r.incrementSelectionCounts(n.content),++r.selected;for(i=0;i<h;++i)(n=l[i]).update(e,t);var m=a.length-p;if(e._backfaceCommands.trim(),f){var _=e._backfaceCommands.values,g=_.length;for(a.length+=g,i=m-1;i>=0;--i)a[p+g+i]=a[p+i];for(i=0;i<g;++i)a[p+i]=_[i]}r.numberOfCommands=a.length-o,e.pointCloudShading.attenuation&&e.pointCloudShading.eyeDomeLighting&&m>0&&e._pointCloudEyeDomeLighting.update(t,o,e.pointCloudShading),e.debugShowGeometricError||e.debugShowRenderingStatistics||e.debugShowMemoryUsage||e.debugShowUrl?(Object(u.a)(e._tileDebugLabels)||(e._tileDebugLabels=new jG),function(e,t){var i,n,r=e._selectedTiles,a=r.length,o=e._emptyTiles,s=o.length;if(e._tileDebugLabels.removeAll(),e.debugPickedTileLabelOnly){if(Object(u.a)(e.debugPickedTile)){var c=Object(u.a)(e.debugPickPosition)?e.debugPickPosition:mSe(e.debugPickedTile);_Se(e.debugPickedTile,e,c).pixelOffset=new Rt(15,-15)}}else{for(i=0;i<a;++i)_Se(n=r[i],e,mSe(n));for(i=0;i<s;++i)(n=o[i]).hasTilesetContent&&_Se(n,e,mSe(n))}e._tileDebugLabels.update(t)}(e,t)):e._tileDebugLabels=e._tileDebugLabels&&e._tileDebugLabels.destroy()}var bSe=[];function ySe(e,t){e.tileUnload.raiseEvent(t),e._statistics.decrementLoadCounts(t.content),--e._statistics.numberOfTilesWithContentReady,t.unloadContent()}function wSe(e,t){e._cache.unloadTile(e,t,ySe),t.destroy()}iSe.prototype.trimLoadedTiles=function(){this._cache.trim()},iSe.prototype.useGradual=function(e){this._useGradual=e},iSe.prototype.shouldAnimate=function(e){this._shouldAnimate=e},iSe.prototype.planView=function(e){this._planView=e},iSe.prototype.centerPos=function(e){this._centerPos=e},iSe.prototype.update=function(e){if(e.mode!==xF.MORPHING&&this.show&&this.ready){Object(u.a)(this._loadTimestamp)||(this._loadTimestamp=Tr.clone(e.time));var t=this._clippingPlanes;Object(u.a)(t)&&t.enabled&&(t.update(e),this._useBoundingSphereForClipping&&(this._clippingPlaneOffsetMatrix=xa.eastNorthUpToFixedFrame(this.boundingSphere.center))),this._timeSinceLoad=Math.max(1e3*Tr.secondsDifference(e.time,this._loadTimestamp),0),this._skipLevelOfDetail=this.skipLevelOfDetail&&!Object(u.a)(this._classificationType)&&!this._disableSkipLevelOfDetail&&!this._allTilesAdditive;var i,n=e.passes,r=n.render,a=n.pick,o=r,s=this._statistics;s.clear(),this.dynamicScreenSpaceError&&function(e,t){var i,n,r,a,o,s=t.camera,c=e._root,l=c.contentBoundingVolume;if(l instanceof B4)i=z.normalize(s.positionWC,nSe),n=s.directionWC,r=s.positionCartographic.height,a=l.minimumHeight,o=l.maximumHeight;else{var u=Be.inverseTransformation(c.computedTransform,aSe),h=t.mapProjection.ellipsoid,d=l.boundingVolume,f=Be.multiplyByPoint(u,d.center,oSe);if(z.magnitude(f)>h.minimumRadius){var p=K.fromCartesian(f,h,rSe);i=z.normalize(s.positionWC,nSe),n=s.directionWC,r=s.positionCartographic.height,a=0,o=2*p.height}else{var m=Be.multiplyByPoint(u,s.positionWC,sSe);if(i=z.UNIT_Z,n=Be.multiplyByPointAsVector(u,s.directionWC,cSe),n=z.normalize(n,n),r=m.z,l instanceof H4){var _=c._header.boundingVolume.box[11];a=f.z-_,o=f.z+_}else if(l instanceof U4){var g=d.radius;a=f.z-g,o=f.z+g}}}var v=a+(o-a)*e.dynamicScreenSpaceErrorHeightFalloff,b=o,y=I.clamp((r-v)/(b-v),0,1),w=1-Math.abs(z.dot(n,i));w*=1-y;var O=e.dynamicScreenSpaceErrorDensity;O*=w,e._dynamicScreenSpaceErrorComputedDensity=O}(this,e),o&&this._cache.reset(),this._requestedTiles.length=0,K5.selectTiles(this,e),o&&(!function(e){var t=e._requestedTiles,i=t.length;t.sort(uSe);for(var n=0;n<i;++n)lSe(e,t[n])}(this),hSe(this,e)),vSe(this,e),o&&(i=this)._cache.unloadTiles(i,ySe),function(e,t){var i=e._statistics,n=e._statisticsLastColor,r=i.numberOfPendingRequests,a=i.numberOfTilesProcessing,o=n.numberOfPendingRequests,s=n.numberOfTilesProcessing,c=r!==o||a!==s;c&&t.afterRender.push((function(){e.loadProgress.raiseEvent(r,a)})),e._tilesLoaded=0===i.numberOfPendingRequests&&0===i.numberOfTilesProcessing&&0===i.numberOfAttemptedRequests,c&&e._tilesLoaded&&(t.afterRender.push((function(){e.allTilesLoaded.raiseEvent()})),e._initialTilesLoaded||(e._initialTilesLoaded=!0,t.afterRender.push((function(){e.initialTilesLoaded.raiseEvent()}))))}(this,e);var c=a?this._statisticsLastPick:this._statisticsLastColor;if(x5.clone(s,c),0!==s.selected){var l=this._credits;if(Object(u.a)(l))for(var h=l.length,d=0;d<h;d++)e.creditDisplay.addCredit(l[d])}}},iSe.prototype.hasExtension=function(e){return!!Object(u.a)(this._extensionsUsed)&&this._extensionsUsed.indexOf(e)>-1},iSe.prototype.isDestroyed=function(){return!1},iSe.prototype.destroy=function(){if(this._tileDebugLabels=this._tileDebugLabels&&this._tileDebugLabels.destroy(),this._clippingPlanes=this._clippingPlanes&&this._clippingPlanes.destroy(),Object(u.a)(this._root)){var e=bSe;for(e.push(this._root);e.length>0;){var t=e.pop();t.destroy();for(var i=t.children,n=i.length,r=0;r<n;++r)e.push(i[r])}}return this._root=void 0,rl(this)};var OSe=iSe;function xSe(e){if(e=Object(w.a)(e,w.a.EMPTY_OBJECT),!Object(u.a)(e.position))throw new h.a("options.position未定义");var t=Object(w.a)(e.position,new z),i=K.fromCartesian(t);this._position=[i.longitude,i.latitude],this._color=Object(w.a)(e.color,new uf(0,0,0,0)),this._radius=Object(w.a)(e.radius,100),this._width=Object(w.a)(e.width,10)}Object(O.a)(xSe.prototype,{position:{get:function(){return this._position},set:function(e){this._position=e}},circleData:{get:function(){return new Te(this._position[0],this._position[1],this._width,1)}},colorData:{get:function(){return new Te(this._color.red,this._color.green,this._color.blue,this._radius)}}});var ESe=xSe;function TSe(){}TSe._frameBuffer=void 0,TSe._renderNormalToTexture=!1,TSe._passState=void 0,TSe._context=void 0,TSe.initialize=function(e){Object(u.a)(TSe._frameBuffer)||(TSe._frameBuffer=new cj({context:e,colorTextures:[new hj({context:e,width:e.drawingBufferWidth,height:e.drawingBufferHeight,pixelFormat:gx.RGBA,pixelDatatype:mx.FLOAT})],depthStencilRenderbuffer:new are({context:e,width:e.drawingBufferWidth,height:e.drawingBufferHeight,format:nre.DEPTH_STENCIL})}),TSe._passState=new bne(e),TSe._passState.viewport=new ln(0,0,e.drawingBufferWidth,e.drawingBufferHeight),TSe._passState.framebuffer=TSe._frameBuffer)},TSe.getNormal=function(e,t){if(Object(u.a)(TSe._frameBuffer)){var i=TSe._context.readPixels({x:e,y:t,width:1,height:1,framebuffer:TSe._frameBuffer}),n=i[0],r=i[1],a=i[2],o=(i[3],new z(n,r,a));return console.log("normal"+o.toString()),o}},TSe.update=function(e){if(TSe._renderNormalToTexture&&TSe._frameBuffer){var t=e.context;new fX({color:new uf(0,0,0,0),depth:1,framebuffer:TSe._passState.framebuffer}).execute(t,TSe._passState)}},TSe.createNormalCommand=function(e,t,i){var n=bR.fromCache({context:e,vertexShaderSource:"attribute vec3 aPosition;\nuniform mat4 u_modelViewMatrix; \nvarying vec3 v_positionEC;\nvoid main(){\n  v_positionEC = (u_modelViewMatrix * vec4( aPosition.xyz , 1.0 )).xyz;\n  gl_Position = czm_projection *  u_modelViewMatrix * vec4( aPosition , 1.0 ); \n}\n",fragmentShaderSource:"#ifdef GL_OES_standard_derivatives\n#extension GL_OES_standard_derivatives : enable\n#endif\nvarying vec3 v_positionEC;\n void main() \n{ \n   vec3 normalES  = normalize(cross(dFdx(v_positionEC),dFdy(v_positionEC)));\n   vec3 normalMS = czm_inverseNormal * normalES;\n   gl_FragColor = vec4(normalMS.xyz,1.0);\n} \n"}),r={u_modelViewMatrix:function(){return e.uniformState.modelView}},a=RM.fromCache({depthTest:{enabled:!0},depthMask:!0,blending:FD.DISABLED});Object(u.a)(TSe._frameBuffer)||(TSe.initialize(e),TSe._context=e);var o=new cM({cull:t.cull,modelMatrix:t.modelMatrix,primitiveType:t.primitiveType,boundingVolume:t.boundingVolume,vertexArray:t.vertexArray,framebuffer:TSe._frameBuffer,shaderProgram:n,uniformMap:r,renderState:a,pass:t.pass});i.normalCommand=o};var CSe=TSe;function SSe(e){this._viewer=e.viewer;var t=this._viewer.scene.context;this.context=t;var i=e.model;this.model=i;var n=i.modelMatrix,r=i.boundingSphere,a=r.center,o=r.radius;this.textureInit=!1;var s=new be;Be.getRotation(n,s);var c=new Be;Be.fromRotationTranslation(s,a,c),this.modelMatrix=Be.multiplyByTranslation(c,new z(0,0,-o),new Be);var l=new z;Be.getTranslation(this.modelMatrix,l),this._shadowCamera=new ose(this._viewer.scene),this._shadowCamera.switchToOrthographicFrustum(),this._shadowCamera.frustum.aspectRatio=1,this._shadowCamera.lookAt(l,new z(0,0,2*o));var u=t.canvas.clientWidth,h=t.canvas.clientHeight,d=new hj({context:t,width:u,height:h,pixelFormat:gx.RGBA}),f=new hj({context:t,width:u,height:h,pixelFormat:gx.DEPTH_COMPONENT,pixelDatatype:mx.UNSIGNED_SHORT,sampler:new tj({wrapS:$D.CLAMP_TO_EDGE,wrapT:$D.CLAMP_TO_EDGE,minificationFilter:KD.NEAREST,magnificationFilter:ZD.NEAREST})}),p=new cj({context:t,colorTextures:[d],depthTexture:f});this._shadowPassState=new bne(t),this._shadowPassState.viewport=new ln(0,0,u,h),this._shadowPassState.framebuffer=p,this.blurXBuffer=new cj({context:t,colorTextures:[new hj({context:t,width:u,height:h,minificationFilter:KD.LINEAR,magnificationFilter:ZD.LINEAR,pixelFormat:gx.RGBA})],depthTexture:new hj({context:t,width:u,height:h,pixelFormat:gx.DEPTH_COMPONENT,pixelDatatype:mx.UNSIGNED_SHORT,sampler:new tj({wrapS:$D.CLAMP_TO_EDGE,wrapT:$D.CLAMP_TO_EDGE,minificationFilter:KD.NEAREST,magnificationFilter:ZD.NEAREST})})}),this.blurYBuffer=new cj({context:t,colorTextures:[new hj({context:t,width:u,height:h,minificationFilter:KD.LINEAR,magnificationFilter:ZD.LINEAR,pixelFormat:gx.RGBA})],depthTexture:new hj({context:t,width:u,height:h,pixelFormat:gx.DEPTH_COMPONENT,pixelDatatype:mx.UNSIGNED_SHORT,sampler:new tj({wrapS:$D.CLAMP_TO_EDGE,wrapT:$D.CLAMP_TO_EDGE,minificationFilter:KD.NEAREST,magnificationFilter:ZD.NEAREST})})});var m=2*o/2,_=2*o/2,g=new z(-m,-_,0),v=new z(m,_,0),b=[],y=[],w=[];b[0]=g.x,b[1]=g.y,b[2]=0,b[3]=v.x,b[4]=g.y,b[5]=0,b[6]=v.x,b[7]=v.y,b[8]=0,b[9]=g.x,b[10]=v.y,b[11]=0,y[0]=0,y[1]=0,y[2]=1,y[3]=0,y[4]=0,y[5]=1,y[6]=0,y[7]=0,y[8]=1,y[9]=0,y[10]=0,y[11]=1,w[0]=0,w[1]=0,w[2]=1,w[3]=0,w[4]=1,w[5]=1,w[6]=0,w[7]=1;var O=new Uint16Array(6);O[0]=0,O[1]=1,O[2]=2,O[3]=0,O[4]=2,O[5]=3;var x=ZN.createVertexBuffer({context:t,typedArray:dn.createTypedArray(dn.FLOAT,b),usage:YN.STATIC_DRAW}),E=ZN.createVertexBuffer({context:t,typedArray:dn.createTypedArray(dn.FLOAT,w),usage:YN.STATIC_DRAW}),T=ZN.createIndexBuffer({context:t,typedArray:O,usage:YN.STATIC_DRAW,indexDatatype:Sl.UNSIGNED_SHORT}),C=[];C.push({index:0,enabled:!0,vertexBuffer:x,componentDatatype:dn.FLOAT,componentsPerAttribute:3,normalize:!1}),C.push({index:1,enabled:!0,vertexBuffer:E,componentDatatype:dn.FLOAT,componentsPerAttribute:2,normalize:!1}),this._vertexInfo=new tF({context:t,attributes:C,indexBuffer:T}),this.pickId=t.createPickId({primitive:this,id:"ShadowPlane"}),this.modelClipMatrix=new Be,this.drawCommand=void 0,this.lastFrameClippingPlanesNum=0}Object(O.a)(SSe.prototype,{}),SSe.prototype.update=function(e){if(void 0!==this._viewer.scene.camera.workingFrustums[0]){if(!this.textureInit){var t=new fX({color:new uf(0,0,0,0),depth:1,framebuffer:this._shadowPassState.framebuffer});this._viewer.scene.renderColorTexture(t,this._shadowPassState,this._shadowCamera),this.executeBlurX(),this.executeBlurY(),this.textureInit=!0}this.buildShadowPlane(e),this.lastFrameClippingPlanesNum=Object(u.a)(this.model.clippingPlanes)?this.model.clippingPlanes.length:0}},SSe.prototype.buildShadowPlane=function(e){var t=this,i=e.commandList;if(t.drawCommand){if((Object(u.a)(t.model.clippingPlanes)?t.model.clippingPlanes.length:0)!==t.lastFrameClippingPlanesNum){var n=GCe;void 0!==t.model.clippingPlanes&&t.model.clippingPlanes.length>0&&(n="#define ENABLE_CLIPPING_PLANES \n"+_J(t.model.clippingPlanes,t.context)+GCe),t.drawCommand.shaderProgram=bR.fromCache({context:t.context,vertexShaderSource:qCe,fragmentShaderSource:n})}}else{var r=RM.fromCache({depthTest:{enabled:!0},depthMask:!0,blending:FD.ALPHA_BELND}),a=GCe;void 0!==t.model.clippingPlanes&&t.model.clippingPlanes.length>0&&(a="#define ENABLE_CLIPPING_PLANES \n"+_J(t.model.clippingPlanes,t.context)+GCe);var o=bR.fromCache({context:t.context,vertexShaderSource:qCe,fragmentShaderSource:a}),s={u_modelViewMatrix:function(){return t.context.uniformState.modelView},colorTexture:function(){return t.blurYBuffer.getColorTexture(0)},u_clippingPlanes:function(){return t.model.clippingPlanes.texture},u_clippingPlanesMatrix:function(){return Be.multiply(t.context.uniformState.view3D,t.modelMatrix,t.modelClipMatrix)},u_clippingPlanesEdgeStyle:function(){return new Te(0,0,0,0)}},c=new St({center:z.ZERO,radius:1});t.drawCommand=new cM({owner:t,cull:!1,modelMatrix:t.modelMatrix,boundingVolume:c,primitiveType:yn.TRIANGLES,vertexArray:t._vertexInfo,shaderProgram:o,uniformMap:s,renderState:r,pass:lM.TRANSLUCENT,pickId:t.pickId})}i.push(t.drawCommand)},SSe.prototype.executeBlurX=function(){var e=this,t={colorTexture:function(){return e._shadowPassState.framebuffer.depthTexture},color:function(){return new Te(1,1,1,1)}},i="#define HORIZONTAL 1\n#define KERNEL_RADIUS 100.0\n#define KERNEL_SCALE_H "+(.5/e._viewer.scene.context.drawingBufferWidth).toFixed(4)+"\n"+HCe,n=new OX({fragmentShaderSource:i,uniformMap:t});n.outputTexture=e.blurXBuffer.getColorTexture(0),n.execute(e._viewer.scene._computeEngine)},SSe.prototype.executeBlurY=function(){var e=this,t={colorTexture:function(){return e.blurXBuffer.getColorTexture(0)},color:function(){return new Te(1,1,1,1)}},i="#define KERNEL_RADIUS 100.0\n#define KERNEL_SCALE_V "+(.5/e._viewer.scene.context.drawingBufferHeight).toFixed(4)+"\n"+HCe,n=new OX({fragmentShaderSource:i,uniformMap:t});n.outputTexture=e.blurYBuffer.getColorTexture(0),n.execute(e._viewer.scene._computeEngine)};var ASe=new ln;SSe.prototype.updateDebugMode=function(e,t){var i=t.context,n=t.context.drawingBufferWidth,r=t.context.drawingBufferHeight,a=.5*Math.min(n,r),o=ASe;o.x=n-a,o.y=0,o.width=a,o.height=a;var s=e._debugViewCommand;Object(u.a)(s)||(s=function(e,t){"uniform sampler2D shadowMap_texture; \nvarying vec2 v_textureCoordinates; \nvoid main() \n{ \n    vec4 shadow = texture2D(shadowMap_texture, v_textureCoordinates); \n    gl_FragColor = shadow; \n} \n";var i=t.createViewportQuadCommand("uniform sampler2D shadowMap_texture; \nvarying vec2 v_textureCoordinates; \nvoid main() \n{ \n    vec4 shadow = texture2D(shadowMap_texture, v_textureCoordinates); \n    gl_FragColor = shadow; \n} \n",{uniformMap:{shadowMap_texture:function(){return e.model.clippingPlanes.texture}}});return i.pass=lM.OVERLAY,i}(e,i),e._debugViewCommand=s),Object(u.a)(s.renderState)&&ln.equals(s.renderState.viewport,o)||(s.renderState=RM.fromCache({viewport:ln.clone(o)})),t.commandList.push(e._debugViewCommand)},SSe.prototype.destroy=function(){return this.blurXBuffer.destroy(),rl(this)};var PSe=SSe;function ISe(e){this._viewer=e.viewer,this._modelMatrix=e.modelMatrix,this._boundingSphere=e.boundingSphere,this._positions=e.positions,this._drawCommand=void 0,this._volumeBox=void 0,this._initialized=!1,this._pointsToCartographic=[],this.videoTexture=e.videoTexture,this._steps=256,this._alphaCorrection=Object(w.a)(e.alphaCorrection,.5),this._image=e.image,this._dimensions=Object(w.a)(e.dimensions,new z(1,1,1));var t=e.viewer.scene.frameState,i=e.viewer.scene.context;this._rtTexture=new hj({context:i,width:t.context.drawingBufferWidth,height:t.context.drawingBufferHeight,pixelFormat:gx.RGB,pixelDatatype:mx.FLOAT,sampler:new tj({wrapS:$D.CLAMP_TO_EDGE,wrapT:$D.CLAMP_TO_EDGE,minificationFilter:KD.NEAREST,magnificationFilter:ZD.NEAREST})}),this._cubeTexture=void 0,this._colorScheme=Object(w.a)(e.colorScheme,[{stop:0,color:"black"},{stop:1,color:"white"}]),this._isRGB=Object(w.a)(e.isRGB,!0),this._transferTexture=function(e,t){var i=document.createElement("canvas");i.height=20,i.width=256;var n=i.getContext("2d"),r=n.createLinearGradient(0,0,i.width-1,i.height-1);return t.forEach((function(e){r.addColorStop(e.stop,e.color)})),n.fillStyle=r,n.fillRect(0,0,i.width-1,i.height-1),new hj({context:e,width:i.width,height:i.height,source:i,sampler:new tj({wrapS:$D.CLAMP_TO_EDGE,wrapT:$D.CLAMP_TO_EDGE,minificationFilter:KD.LINEAR,magnificationFilter:ZD.LINEAR})})}(i,this._colorScheme),this._passState=void 0;var n=this;f.a.fetchImage(n._image).then((function(e){n._cubeTexture=new hj({context:i,width:e.width,height:e.height,source:e,sampler:new tj({wrapS:$D.CLAMP_TO_EDGE,wrapT:$D.CLAMP_TO_EDGE,minificationFilter:KD.LINEAR,magnificationFilter:ZD.LINEAR})})})),this.initialize();var r=this;this.removeCallback=this._viewer.scene.preRender.addEventListener((function(){if(void 0!==r._viewer.scene.camera.workingFrustums[0]){var e=new fX({color:new uf(0,0,0,0),depth:1,framebuffer:r._firstPassState.framebuffer});e.execute(i,r._firstPassState),r._viewer.scene.renderToTexture(e,r._firstPassState,r._viewer.scene.camera,r._drawCommand),r._rtTexture=r._firstPassState.framebuffer.getColorTexture(0)}}))}Object(O.a)(ISe.prototype,{volumeBox:{get:function(){return this._volumeBox},set:function(e){void 0!==e&&void 0!==this._volumeBox&&this.release(),this._volumeBox=e}},alphaCorrection:{get:function(){return this._alphaCorrection},set:function(e){this._alphaCorrection=e}}}),ISe.prototype.initialize=function(){var e=this._viewer.scene.context,t=function(e){var t=new hj({context:e,width:e.drawingBufferWidth,height:e.drawingBufferHeight,pixelFormat:gx.RGBA}),i=new are({context:e,format:nre.DEPTH_COMPONENT16,width:e.drawingBufferWidth,height:e.drawingBufferHeight});return new cj({context:e,colorTextures:[t],depthRenderbuffer:i})}(e);this._firstPassState=new bne(e),this._firstPassState.viewport=new ln(0,0,e.drawingBufferWidth,e.drawingBufferHeight),this._firstPassState.framebuffer=t,this._initialized=!0;var i=this,n=bR.fromCache({context:e,vertexShaderSource:ZCe,fragmentShaderSource:XCe}),r=bR.fromCache({context:e,vertexShaderSource:KCe,fragmentShaderSource:QCe}),a=RM.fromCache({cull:{enabled:!0,face:BD.FRONT},depthTest:{enabled:!0},depthMask:!0,blending:FD.ADDITIVE_BLEND}),o=RM.fromCache({cull:{enabled:!0,face:BD.BACK},depthTest:{enabled:!0},depthMask:!0,blending:FD.ADDITIVE_BLEND});this._uniformMap={dimensions:function(){return i._dimensions}},this._uniformMap2={tex:function(){return i._rtTexture},cubeTex:function(){return i._cubeTexture},transferTex:function(){return i._transferTexture},steps:function(){return i._steps},alphaCorrection:function(){return i._alphaCorrection},dimensions:function(){return i._dimensions},isRGB:function(){return i._isRGB}},i._geometry=Ya.createGeometry(Ya.fromDimensions({dimensions:i._dimensions,vertexFormat:Ba.POSITION_ONLY}));var s=function(e,t){var i=e._geometry.attributes.position.values,n=e._geometry.indices,r=ZN.createIndexBuffer({context:t,typedArray:new Uint32Array(n),usage:YN.STATIC_DRAW,indexDatatype:Sl.UNSIGNED_INT}),a=ZN.createVertexBuffer({context:t,typedArray:dn.createTypedArray(dn.FLOAT,i),usage:YN.STATIC_DRAW}),o=[];return o.push({index:0,enabled:!0,vertexBuffer:a,componentDatatype:dn.FLOAT,componentsPerAttribute:3,normalize:!1}),new tF({context:t,attributes:o,indexBuffer:r})}(this,e);i._drawCommand=new cM({owner:i,cull:!0,boundingVolume:i._boundingSphere,modelMatrix:i._modelMatrix,primitiveType:yn.TRIANGLES,vertexArray:s,shaderProgram:n,castShadows:!1,receiveShadows:!1,uniformMap:this._uniformMap,renderState:a,pass:lM.OVERLAY}),i._drawCommandSecond=new cM({owner:i,cull:!0,boundingVolume:i._boundingSphere,modelMatrix:i._modelMatrix,primitiveType:yn.TRIANGLES,vertexArray:s,shaderProgram:r,castShadows:!1,receiveShadows:!1,uniformMap:this._uniformMap2,renderState:o,pass:lM.OVERLAY})},ISe.prototype.update=function(e){var t=e.commandList;void 0!==this._cubeTexture&&t.push(this._drawCommandSecond)};var DSe=new ln;ISe.prototype.updateDebugMode=function(e,t){var i=t.context,n=t.context.drawingBufferWidth,r=t.context.drawingBufferHeight,a=.3*Math.min(n,r),o=DSe;o.x=n-a,o.y=0,o.width=a,o.height=a;var s=e._debugShadowViewCommand;Object(u.a)(s)||(s=function(e,t){"uniform sampler2D shadowMap_texture; \nvarying vec2 v_textureCoordinates; \nvoid main() \n{ \n    vec4 shadow = texture2D(shadowMap_texture, v_textureCoordinates); \n    gl_FragColor = shadow; \n} \n";var i=t.createViewportQuadCommand("uniform sampler2D shadowMap_texture; \nvarying vec2 v_textureCoordinates; \nvoid main() \n{ \n    vec4 shadow = texture2D(shadowMap_texture, v_textureCoordinates); \n    gl_FragColor = shadow; \n} \n",{uniformMap:{shadowMap_texture:function(){return e._cubeTexture}}});return i.pass=lM.OVERLAY,i}(e,i),e._debugShadowViewCommand=s),Object(u.a)(s.renderState)&&ln.equals(s.renderState.viewport,o)||(s.renderState=RM.fromCache({viewport:ln.clone(o)})),void 0!==e._cubeTexture&&s.execute(i,t.passState)},ISe.prototype.isDestroyed=function(){return!1},ISe.prototype.destroy=function(){return Object(u.a)(this.removeCallback)&&this.removeCallback(),rl(this)};var jSe=ISe,MSe="vec3 v = -normalize(v_positionEC);\n#ifndef USE_CUSTOM_LIGHT_COLOR\nvec3 lightColor = czm_lightColorHdr;\n#else\nvec3 lightColor = gltf_lightColor;\n#endif\nlightColor *= czm_lightScaleFactor;\nvec3 l = normalize(czm_sunDirectionEC);\nvec3 h = normalize(v + l);\nvec3 f0 = vec3(0.04);\n#ifndef USE_SPECGLOSS\nfloat roughness = 1.0 - glossiness;\nvec3 diffuseColor = diffuse.rgb * (1.0 - max(max(specular.r, specular.g), specular.b));\nvec3 specularColor = specular;\n#else\nvec3 diffuseColor = baseColor * (1.0 - metalness) * (1.0 - f0);\nvec3 specularColor = mix(f0, baseColor, metalness);\n#endif\nvec3 ambient = czm_ambientLight * lightColor * diffuseColor;\nfloat diff = max(dot(n, h),0.0);\nvec3 diffuse = lightColor * diff * diffuseColor;\nfloat shininess = pow(2.0,(1.0- roughness) * 10.0);\nvec3 halfwayDir = normalize(v + h);\nfloat spec = pow(max(dot(n, halfwayDir),0.0),shininess);\nvec3 specular = lightColor * spec * specularColor;\nvec3 color = ambient + diffuse + specular;\n",RSe="vec3 f0 = vec3(0.04);\n#ifdef USE_SPECGLOSS\nfloat roughness = 1.0 - glossiness;\nvec3 diffuseColor = diffuse.rgb * (1.0 - max(max(specular.r, specular.g), specular.b));\nvec3 specularColor = specular;\n#else\nvec3 diffuseColor = baseColor * (1.0 - metalness) * (1.0 - f0);\nvec3 specularColor = mix(f0, baseColor, metalness);\n#endif\nczm_lightStruct lightInfo;\nlightInfo.positionWC = positionWC;\nlightInfo.positionEC = v_positionEC;\nlightInfo.normal = n;\nlightInfo.baseColor = baseColor;\nlightInfo.diffuseColor = diffuseColor;\nlightInfo.specularColor = specularColor;\nlightInfo.roughness = roughness;\nlightInfo.alpha = baseColorWithAlpha.a;\n",LSe="const float M_PI = 3.1415926535897932384626433832795;\nconst float LinearEncodePowerApprox = 2.2;\nconst float GammaEncodePowerApprox = 1.0/LinearEncodePowerApprox;\nconst vec3 LuminanceEncodeApprox = vec3(0.2126, 0.7152, 0.0722);\nconst float Epsilon = 0.0000001;\nconst mat4 sunlightDiffuseMatrix = mat4(0.1682, 0.0032, -0.0543, -0.2457,0.0032, -0.0463, 0.0314, -0.0083,-0.0543, 0.0314, -0.1396, 0.1652,-0.2457, -0.0083, 0.1652, 0.6191);\n#define saturate(x) clamp(x, 0.0, 1.0)\n#define absEps(x) abs(x)+Epsilon\n#define maxEps(x) max(x, Epsilon)\n#define saturateEps(x) clamp(x, Epsilon, 1.0)\n#ifdef GL_OES_standard_derivatives\n#extension GL_OES_standard_derivatives : enable\n#endif\nvec3 lambertianDiffuse(vec3 diffuseColor)\n{\nreturn diffuseColor / M_PI;\n}\nvec3 fresnelSchlick2(vec3 f0, vec3 f90, float VdotH)\n{\nreturn f0 + (f90 - f0) * pow(clamp(1.0 - VdotH, 0.0, 1.0), 5.0);\n}\nvec3 fresnelSchlick(float metalness, float VdotH)\n{\nreturn metalness + (vec3(1.0) - metalness) * pow(1.0 - VdotH, 5.0);\n}\nfloat smithVisibilityG1(float NdotV, float roughness)\n{\nfloat k = (roughness + 1.0) * (roughness + 1.0) / 8.0;\nreturn NdotV / (NdotV * (1.0 - k) + k);\n}\nfloat smithVisibilityGGX(float roughness, float NdotL, float NdotV)\n{\nreturn smithVisibilityG1(NdotL, roughness) * smithVisibilityG1(NdotV, roughness);\n}\nfloat GGX(float roughness, float NdotH)\n{\nfloat roughnessSquared = roughness * roughness;\nfloat f = (NdotH * roughnessSquared - NdotH) * NdotH + 1.0;\nreturn roughnessSquared / (M_PI * f * f);\n}\nvec3 wgs84ToCartesian(vec3 p)\n{\nvec3 vn = vec3(cos(p.y) * cos(p.x), cos(p.y) * sin(p.x), sin(p.y));\nvn = normalize(vn);\nvec3 vk = vec3(40680631590769., 40680631590769., 40408299984661.445)* vn;\nfloat gamma = sqrt(dot(vn, vk));\nvk = vk / gamma;\nreturn vk ;\n}\nvec3 SRGBtoLINEAR3(vec3 srgbIn)\n{\nreturn pow(srgbIn, vec3(2.2));\n}\nvec4 SRGBtoLINEAR4(vec4 srgbIn)\n{\nvec3 linearOut = pow(srgbIn.rgb, vec3(2.2));\nreturn vec4(linearOut, srgbIn.a);\n}\nvec3 applyTonemapping(vec3 linearIn)\n{\n#ifndef HDR\nreturn czm_acesTonemapping(linearIn);\n#else\nreturn linearIn;\n#endif\n}\nvec3 LINEARtoSRGB(vec3 linearIn)\n{\n#ifndef HDR\nreturn pow(linearIn, vec3(1.0/2.2));\n#else\nreturn linearIn;\n#endif\n}\nvec3 decode_pnghdr( const in vec4 color )\n{\nvec4 res = color * color;\nfloat ri = pow( 2.0, res.w * 32.0 - 16.0 );\nres.xyz = res.xyz * ri;\nreturn res.xyz;\n}\nvec4 calculateCircleColor(vec4 color,vec4 dimensions)\n{\nfloat circle = 0.0;\nvec3 cColor = color.xyz;\nfloat radius = color.w;\nvec2 lonlat = dimensions.xy;\nfloat width = dimensions.z;\nvec3 centerPos = wgs84ToCartesian( vec3(lonlat,0.0));\nvec3 circlePos = (czm_inverseModel * vec4(centerPos,1.0)).xyz;\nfloat time = mod(czm_frameNumber, radius) * 1.0;\nfloat innerTail = width;\nfloat frontierBorder = 1.0;\nfloat r1 = length(circlePos.xy-(posMC.xy));\ncircle += smoothstep(time -  innerTail, time, r1) * smoothstep(time + frontierBorder,time, r1);\ncircle *= smoothstep(0.0, 0.0, distance(circlePos.xy ,posMC.xy));\nreturn vec4(circle,circle,circle,circle) * vec4(cColor,1.0);\n}\nfloat random(vec3 scale, float seed)\n{\nreturn fract(sin(dot(gl_FragCoord.xyz+seed, scale))*43758.5453+seed);\n}\nvec2 computeTexCoord(vec2 texCoords, vec2 offset, float rotation, vec2 scale)\n{\nrotation = -rotation;\nmat3 transform = mat3(\ncos(rotation) * scale.x, sin(rotation) * scale.x, 0.0,\n-sin(rotation) * scale.y, cos(rotation) * scale.y, 0.0,\noffset.x, offset.y, 1.0);\nvec2 transformedTexCoords = (transform * vec3(fract(texCoords), 1.0)).xy;\nreturn transformedTexCoords;\n}\nvec3 addSaturation(vec3 color){\nvec3 hsb = czm_RGBToHSB(color);\nhsb.y += 0.05;\nhsb.y = clamp(hsb.y,0.0, 1.0);\ncolor = czm_HSBToRGB(hsb);\nreturn color;\n}\nvec3 addNoise(vec3 color)\n{\nfloat noise = 0.02 * (0.5 - random(vec3(1.0), length(gl_FragCoord)));\ncolor += vec3( noise );\nreturn color;\n}\nstruct pbrColorStruct\n{\nvec3 lightColor;\nvec3 iblColor;\nfloat alpha;\n};\npbrColorStruct pbrPointLight(czm_lightStruct lightInfo)\n{\nvec3 n = lightInfo.normal;\nvec3 v = -normalize(lightInfo.positionEC);\nfloat roughness = lightInfo.roughness;\nvec3 diffuseColor = lightInfo.diffuseColor;\nvec3 specularColor = lightInfo.specularColor;\nfloat distance = length(lightInfo.lightPosition - lightInfo.positionEC);\nfloat lightIntensity = lightInfo.lightFalloff.x;\nfloat range = lightInfo.lightFalloff.y;\nfloat attenuation = 1.0;\nif(range > 0.0){\nattenuation = max(min(1.0 - pow(distance/range,4.0),1.0),0.0)/(distance * distance);\n}\nelse{\nattenuation = 1.0 / (1.0 + 0.09 * distance + 0.032 * distance * distance);\n}\nvec3 lightColorHdr = lightInfo.lightColor * lightIntensity * attenuation;\nvec3 l = normalize(lightInfo.lightPosition - lightInfo.positionEC);\nvec3 h = normalize(v + l);\nfloat NdotL = clamp(dot(n, l), 0.001, 1.0);\nfloat NdotV = abs(dot(n, v)) + 0.001;\nfloat NdotH = clamp(dot(n, h), 0.0, 1.0);\nfloat VdotH = clamp(dot(v, h), 0.0, 1.0);\nfloat alpha = roughness * roughness;\nfloat reflectance = max(max(specularColor.r, specularColor.g), specularColor.b);\nvec3 r90 = vec3(clamp(reflectance * 25.0, 0.0, 1.0));\nvec3 r0 = specularColor.rgb;\nvec3 F = fresnelSchlick2(r0, r90, VdotH);\nfloat G = smithVisibilityGGX(alpha, NdotL, NdotV);\nfloat D = GGX(alpha, NdotH);\nvec3 diffuseContribution = (1.0 - F) * lambertianDiffuse(diffuseColor);\nvec3 specularContribution = F * G * D / (4.0 * NdotL * NdotV);\npbrColorStruct pbrColor;\npbrColor.lightColor = NdotL * lightColorHdr * (diffuseContribution + specularContribution);\nreturn pbrColor;\n}\npbrColorStruct pbrSpotLight(czm_lightStruct lightInfo)\n{\nvec3 l = normalize(lightInfo.lightPosition - lightInfo.positionEC);\nfloat cosAngle = max(0.0, dot(lightInfo.lightDirection.xyz, -l));\npbrColorStruct pbrColor;\nif(cosAngle >= lightInfo.lightDirection.w)\n{\nvec3 n = lightInfo.normal;\nvec3 v = -normalize(lightInfo.positionEC);\nfloat roughness = lightInfo.roughness;\nvec3 diffuseColor = lightInfo.diffuseColor;\nvec3 specularColor = lightInfo.specularColor;\nfloat distance = length(lightInfo.lightPosition - lightInfo.positionEC);\nfloat lightIntensity = lightInfo.lightFalloff.x;\nfloat range = lightInfo.lightFalloff.y;\nfloat lightAngleScale = lightInfo.lightFalloff.z;\nfloat lightAngleOffset = lightInfo.lightFalloff.w;\nvec3 direction = normalize(lightInfo.lightDirection.xyz);\nfloat cd = dot(-direction, l);\nfloat attenuation = clamp(cd * lightAngleScale + lightAngleOffset,0.0, 1.0);\nattenuation *= attenuation;\nvec3 lightColorHdr = lightInfo.lightColor * lightIntensity * attenuation;\nvec3 h = normalize(v + l);\nfloat NdotL = clamp(dot(n, l), 0.001, 1.0);\nfloat NdotV = abs(dot(n, v)) + 0.001;\nfloat NdotH = clamp(dot(n, h), 0.0, 1.0);\nfloat VdotH = clamp(dot(v, h), 0.0, 1.0);\nfloat alpha = roughness * roughness;\nfloat reflectance = max(max(specularColor.r, specularColor.g), specularColor.b);\nvec3 r90 = vec3(clamp(reflectance * 25.0, 0.0, 1.0));\nvec3 r0 = specularColor.rgb;\nvec3 F = fresnelSchlick2(r0, r90, VdotH);\nfloat G = smithVisibilityGGX(alpha, NdotL, NdotV);\nfloat D = GGX(alpha, NdotH);\nvec3 diffuseContribution = (1.0 - F) * lambertianDiffuse(diffuseColor);\nvec3 specularContribution = F * G * D / (4.0 * NdotL * NdotV);\npbrColor.lightColor = NdotL * lightColorHdr * (diffuseContribution + specularContribution);\n}\nelse{\npbrColor.lightColor = vec3(0.0);\n}\nreturn pbrColor;\n}\npbrColorStruct pbrDirectionLight(czm_lightStruct lightInfo)\n{\nvec3 n = lightInfo.normal;\nvec3 v = -normalize(lightInfo.positionEC);\nfloat roughness = lightInfo.roughness;\nvec3 diffuseColor = lightInfo.diffuseColor;\nvec3 specularColor = lightInfo.specularColor;\nfloat lightIntensity = lightInfo.lightFalloff.x;\nvec3 lightColorHdr = lightInfo.lightColor * lightIntensity;\nvec3 l = normalize(-lightInfo.lightDirection.xyz);\nvec3 h = normalize(v + l);\nfloat NdotL = clamp(dot(n, l), 0.001, 1.0);\nfloat NdotV = abs(dot(n, v)) + 0.001;\nfloat NdotH = clamp(dot(n, h), 0.0, 1.0);\nfloat VdotH = clamp(dot(v, h), 0.0, 1.0);\nfloat alpha = roughness * roughness;\nfloat reflectance = max(max(specularColor.r, specularColor.g), specularColor.b);\nvec3 r90 = vec3(clamp(reflectance * 25.0, 0.0, 1.0));\nvec3 r0 = specularColor.rgb;\nvec3 F = fresnelSchlick2(r0, r90, VdotH);\nfloat G = smithVisibilityGGX(alpha, NdotL, NdotV);\nfloat D = GGX(alpha, NdotH);\nvec3 diffuseContribution = (1.0 - F) * lambertianDiffuse(diffuseColor);\nvec3 specularContribution = F * G * D / (4.0 * NdotL * NdotV);\npbrColorStruct pbrColor;\npbrColor.lightColor = NdotL * lightColorHdr * (diffuseContribution + specularContribution);\nreturn pbrColor;\n}\npbrColorStruct pbrCesiumjs(czm_lightStruct lightInfo)\n{\nvec3 n = lightInfo.normal;\nvec3 v = -normalize(lightInfo.positionEC);\nfloat roughness = lightInfo.roughness;\nvec3 diffuseColor = lightInfo.diffuseColor;\nvec3 specularColor = lightInfo.specularColor;\nvec3 positionWC = lightInfo.positionWC;\n#ifndef USE_CUSTOM_LIGHT_COLOR\nvec3 lightColorHdr = czm_lightColorHdr;\n#else\nvec3 lightColorHdr = gltf_lightColor;\n#endif\nlightColorHdr *= czm_lightScaleFactor;\nvec3 l = normalize(czm_lightDirectionEC);\nvec3 h = normalize(v + l);\nfloat NdotL = clamp(dot(n, l), 0.001, 1.0);\nfloat NdotV = abs(dot(n, v)) + 0.001;\nfloat NdotH = clamp(dot(n, h), 0.0, 1.0);\nfloat VdotH = clamp(dot(v, h), 0.0, 1.0);\nfloat alpha = roughness * roughness;\nfloat reflectance = max(max(specularColor.r, specularColor.g), specularColor.b);\nvec3 r90 = vec3(clamp(reflectance * 25.0, 0.0, 1.0));\nvec3 r0 = specularColor.rgb;\nvec3 F = fresnelSchlick2(r0, r90, VdotH);\nfloat G = smithVisibilityGGX(alpha, NdotL, NdotV);\nfloat D = GGX(alpha, NdotH);\nvec3 diffuseContribution = (1.0 - F) * lambertianDiffuse(diffuseColor);\nvec3 specularContribution = F * G * D / (4.0 * NdotL * NdotV);\npbrColorStruct pbrColor;\npbrColor.lightColor = NdotL * lightColorHdr * (diffuseContribution + specularContribution);\n#if defined(USE_IBL_LIGHTING) && !defined(DIFFUSE_IBL) && !defined(SPECULAR_IBL)\nvec3 r = normalize(czm_inverseViewRotation * normalize(reflect(v, n)));\nfloat vertexRadius = length(positionWC);\nfloat horizonDotNadir = 1.0 - min(1.0, czm_ellipsoidRadii.x / vertexRadius);\nfloat reflectionDotNadir = dot(r, normalize(positionWC));\nr.x = -r.x;\nr = -normalize(czm_temeToPseudoFixed * r);\nr.x = -r.x;\nfloat inverseRoughness = 1.04 - roughness;\ninverseRoughness *= inverseRoughness;\nvec3 sceneSkyBox = textureCube(czm_environmentMap, r).rgb * inverseRoughness;\nfloat atmosphereHeight = 0.05;\nfloat blendRegionSize = 0.1 * ((1.0 - inverseRoughness) * 8.0 + 1.1 - horizonDotNadir);\nfloat blendRegionOffset = roughness * -1.0;\nfloat farAboveHorizon = clamp(horizonDotNadir - blendRegionSize * 0.5 + blendRegionOffset, 1.0e-10 - blendRegionSize, 0.99999);\nfloat aroundHorizon = clamp(horizonDotNadir + blendRegionSize * 0.5, 1.0e-10 - blendRegionSize, 0.99999);\nfloat farBelowHorizon = clamp(horizonDotNadir + blendRegionSize * 1.5, 1.0e-10 - blendRegionSize, 0.99999);\nfloat smoothstepHeight = smoothstep(0.0, atmosphereHeight, horizonDotNadir);\nvec3 belowHorizonColor = mix(vec3(0.1, 0.15, 0.25), vec3(0.4, 0.7, 0.9), smoothstepHeight);\nvec3 nadirColor = belowHorizonColor * 0.5;\nvec3 aboveHorizonColor = mix(vec3(0.9, 1.0, 1.2), belowHorizonColor, roughness * 0.5);\nvec3 blueSkyColor = mix(vec3(0.18, 0.26, 0.48), aboveHorizonColor, reflectionDotNadir * inverseRoughness * 0.5 + 0.75);\nvec3 zenithColor = mix(blueSkyColor, sceneSkyBox, smoothstepHeight);\nvec3 blueSkyDiffuseColor = vec3(0.7, 0.85, 0.9);\nfloat diffuseIrradianceFromEarth = (1.0 - horizonDotNadir) * (reflectionDotNadir * 0.25 + 0.75) * smoothstepHeight;\nfloat diffuseIrradianceFromSky = (1.0 - smoothstepHeight) * (1.0 - (reflectionDotNadir * 0.25 + 0.25));\nvec3 diffuseIrradiance = blueSkyDiffuseColor * clamp(diffuseIrradianceFromEarth + diffuseIrradianceFromSky, 0.0, 1.0);\nfloat notDistantRough = (1.0 - horizonDotNadir * roughness * 0.8);\nvec3 specularIrradiance = mix(zenithColor, aboveHorizonColor, smoothstep(farAboveHorizon, aroundHorizon, reflectionDotNadir) * notDistantRough);\nspecularIrradiance = mix(specularIrradiance, belowHorizonColor, smoothstep(aroundHorizon, farBelowHorizon, reflectionDotNadir) * inverseRoughness);\nspecularIrradiance = mix(specularIrradiance, nadirColor, smoothstep(farBelowHorizon, 1.0, reflectionDotNadir) * inverseRoughness);\n#ifdef USE_SUN_LUMINANCE\nfloat LdotZenith = clamp(dot(normalize(czm_inverseViewRotation * l), normalize(positionWC * -1.0)), 0.001, 1.0);\nfloat S = acos(LdotZenith);\nfloat NdotZenith = clamp(dot(normalize(czm_inverseViewRotation * n), normalize(positionWC * -1.0)), 0.001, 1.0);\nfloat gamma = acos(NdotL);\nfloat numerator = ((0.91 + 10.0 * exp(-3.0 * gamma) + 0.45 * pow(NdotL, 2.0)) * (1.0 - exp(-0.32 / NdotZenith)));\nfloat denominator = (0.91 + 10.0 * exp(-3.0 * S) + 0.45 * pow(LdotZenith,2.0)) * (1.0 - exp(-0.32));\nfloat luminance = gltf_luminanceAtZenith * (numerator / denominator);\n#endif\nvec2 brdfLut = texture2D(czm_brdfLut, vec2(NdotV, roughness)).rg;\nvec3 IBLColor = (diffuseIrradiance * diffuseColor * gltf_iblFactor.x) + (specularIrradiance * SRGBtoLINEAR3(specularColor * brdfLut.x + brdfLut.y) * gltf_iblFactor.y);\nfloat maximumComponent = max(max(lightColorHdr.x, lightColorHdr.y), lightColorHdr.z);\nvec3 lightColor = lightColorHdr / max(maximumComponent, 1.0);\nIBLColor *= lightColor;\n#ifdef USE_SUN_LUMINANCE\npbrColor.iblColor = IBLColor * luminance;\n#else\npbrColor.iblColor = IBLColor;\n#endif\n#elif defined(DIFFUSE_IBL) || defined(SPECULAR_IBL)\nmat3 fixedToENU = mat3(gltf_clippingPlanesMatrix[0][0], gltf_clippingPlanesMatrix[1][0], gltf_clippingPlanesMatrix[2][0],\ngltf_clippingPlanesMatrix[0][1], gltf_clippingPlanesMatrix[1][1], gltf_clippingPlanesMatrix[2][1],\ngltf_clippingPlanesMatrix[0][2], gltf_clippingPlanesMatrix[1][2], gltf_clippingPlanesMatrix[2][2]);\n#ifdef BIM_MODE\nconst mat3 yUpToZUp = mat3(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, -1.0, 0.0);\nconst mat3 rotationZ = mat3(-1.0, 0.0, 0.0, 0.0, -1.0, 0.0, 0.0, 0.0, 1.0);\nvec3 cubeDir = normalize(rotationZ * yUpToZUp * fixedToENU * normalize(reflect(-v, n)));\n#else\nconst mat3 yUpToZUp = mat3(-1.0, 0.0, 0.0, 0.0, 0.0, -1.0, 0.0, 1.0, 0.0);\nvec3 cubeDir = normalize(yUpToZUp * fixedToENU * normalize(reflect(-v, n)));\n#endif\n#ifdef DIFFUSE_IBL\n#ifdef CUSTOM_SPHERICAL_HARMONICS\nvec3 diffuseIrradiance = czm_sphericalHarmonics(cubeDir, gltf_sphericalHarmonicCoefficients);\n#else\nvec3 diffuseIrradiance = czm_sphericalHarmonics(cubeDir, czm_sphericalHarmonicCoefficients);\n#endif\n#else\nvec3 diffuseIrradiance = vec3(0.0);\n#endif\n#ifdef SPECULAR_IBL\nvec2 brdfLut = texture2D(czm_brdfLut, vec2(NdotV, roughness)).rg;\n#ifdef CUSTOM_SPECULAR_IBL\nvec3 specularIBL = czm_sampleOctahedralProjection(gltf_specularMap, gltf_specularMapSize, cubeDir,  roughness * gltf_maxSpecularLOD, gltf_maxSpecularLOD);\n#else\nvec3 specularIBL = czm_sampleOctahedralProjection(czm_specularEnvironmentMaps, czm_specularEnvironmentMapSize, cubeDir,  roughness * czm_specularEnvironmentMapsMaximumLOD, czm_specularEnvironmentMapsMaximumLOD);\n#endif\nspecularIBL *= F * brdfLut.x + brdfLut.y;\n#else\nvec3 specularIBL = vec3(0.0);\n#endif\npbrColor.iblColor = diffuseIrradiance * diffuseColor + specularColor * specularIBL;\n#endif\nreturn pbrColor;\n}\nfloat square(float value) {\nreturn value*value;\n}\nfloat pow5(float value) {\nfloat sq = value*value;\nreturn sq*sq*value;\n}\nvec3 fresnelSchlickGGX(float VdotH, vec3 reflectance0, vec3 reflectance90) {\nreturn reflectance0+(reflectance90-reflectance0)*pow5(1.0-VdotH);\n}\nvec2 getAARoughnessFactors(vec3 normalVector) {\n#ifdef GL_OES_standard_derivatives\nvec3 nDfdx = dFdx(normalVector.xyz);\nvec3 nDfdy = dFdy(normalVector.xyz);\nfloat slopeSquare = max(dot(nDfdx, nDfdx), dot(nDfdy, nDfdy));\nfloat geometricRoughnessFactor = pow(saturate(slopeSquare), 0.333);\nfloat geometricAlphaGFactor = sqrt(slopeSquare);\ngeometricAlphaGFactor *= 0.75;\nreturn vec2(geometricRoughnessFactor, geometricAlphaGFactor);\n#else\nreturn vec2(1.0,1.0);\n#endif\n}\n#define MINIMUMVARIANCE 0.0005\nfloat convertRoughnessToAverageSlope(float roughness) {\nreturn square(roughness)+MINIMUMVARIANCE;\n}\nfloat normalDistributionFunction_TrowbridgeReitzGGX(float NdotH, float alphaG) {\nfloat a2 = square(alphaG);\nfloat d = NdotH*NdotH*(a2-1.0)+1.0;\nreturn a2/(M_PI*d*d);\n}\nfloat smithVisibility_GGXCorrelated(float NdotL, float NdotV, float alphaG) {\nfloat a2 = alphaG*alphaG;\nfloat GGXV = NdotL*sqrt(NdotV*(NdotV-a2*NdotV)+a2);\nfloat GGXL = NdotV*sqrt(NdotL*(NdotL-a2*NdotL)+a2);\nreturn 0.5/(GGXV+GGXL);\n}\nvec3 getEnergyConservationFactor(const vec3 specularEnvironmentR0, const vec3 environmentBrdf) {\nreturn 1.0+specularEnvironmentR0*(1.0/environmentBrdf.y-1.0);\n}\nvec3 toLinearSpace(vec3 color) {\nreturn pow(color, vec3(LinearEncodePowerApprox));\n}\nvec3 toGammaSpace(vec3 color) {\nreturn pow(color, vec3(GammaEncodePowerApprox));\n}\nvec3 fromRGBD(vec4 rgbd) {\nrgbd.rgb = toLinearSpace(rgbd.rgb);\nreturn rgbd.rgb/rgbd.a;\n}\nvec3 getBRDFLookup(float NdotV, float perceptualRoughness, sampler2D brdfSampler) {\nvec2 UV = vec2(NdotV, perceptualRoughness);\nvec4 brdfLookup = texture2D(brdfSampler, UV);\nbrdfLookup.rgb = fromRGBD(brdfLookup.rgba);\nreturn brdfLookup.rgb;\n}\nvec3 applyImageProcessing(vec3 result) {\nresult.rgb = toGammaSpace(result.rgb);\nresult.rgb = saturate(result.rgb);\nreturn result;\n}\nfloat getLuminance(vec3 color) {\nreturn clamp(dot(color, LuminanceEncodeApprox), 0., 1.);\n}\nstruct preLightingInfo {\nvec3 lightOffset;\nfloat lightDistanceSquared;\nfloat lightDistance;\nfloat attenuation;\nvec3 L;\nvec3 H;\nfloat NdotV;\nfloat NdotLUnclamped;\nfloat NdotL;\nfloat VdotH;\nfloat roughness;\n};\npreLightingInfo computeHemisphericPreLightingInfo(vec3 lightData, vec3 V, vec3 N) {\npreLightingInfo result;\nresult.NdotL = dot(N, lightData.xyz)*0.5+0.5;\nresult.NdotL = saturateEps(result.NdotL);\nresult.NdotLUnclamped = result.NdotL;\nresult.L = normalize(lightData.xyz);\nresult.H = normalize(V+result.L);\nresult.VdotH = saturate(dot(V, result.H));\nreturn result;\n}\nvec3 computeHemisphericDiffuseLighting(preLightingInfo info, vec3 lightColor, vec3 groundColor) {\nreturn mix(groundColor, lightColor, info.NdotL);\n}\nvec3 computeSpecularLighting(preLightingInfo info, vec3 N, vec3 reflectance0, vec3 reflectance90, float geometricRoughnessFactor, vec3 lightColor) {\nfloat NdotH = saturateEps(dot(N, info.H));\nfloat roughness = max(info.roughness, geometricRoughnessFactor);\nfloat alphaG = convertRoughnessToAverageSlope(roughness);\nvec3 fresnel = fresnelSchlickGGX(info.VdotH, reflectance0, reflectance90);\nfloat distribution = normalDistributionFunction_TrowbridgeReitzGGX(NdotH, alphaG);\nfloat visibility = smithVisibility_GGXCorrelated(info.NdotL, info.NdotV, alphaG);\nvec3 specTerm = fresnel*distribution*visibility;\nreturn specTerm*info.attenuation*info.NdotL*lightColor;\n}\npbrColorStruct pbrLuban(czm_lightStruct lightInfo)\n{\nvec3 n = lightInfo.normal;\nvec3 v = -normalize(lightInfo.positionEC);\nfloat roughness = lightInfo.roughness;\nvec3 baseColor = lightInfo.baseColor;\nvec3 diffuseColor = lightInfo.diffuseColor;\nvec3 specularColor = lightInfo.specularColor;\nvec3 positionWC = lightInfo.positionWC;\nfloat alpha = lightInfo.alpha;\n#ifndef USE_CUSTOM_LIGHT_COLOR\nvec3 lightColorHdr = czm_lightColorHdr;\n#else\nvec3 lightColorHdr = gltf_lightColor;\n#endif\nlightColorHdr *= czm_lightScaleFactor;\nvec3 l = normalize(czm_lightDirectionEC);\nvec3 h = normalize(v + l);\nfloat NdotVUnclamped = dot(n, v);\nfloat NdotV = absEps(NdotVUnclamped);\nfloat alphaG = convertRoughnessToAverageSlope(roughness);\nvec2 AARoughnessFactors = getAARoughnessFactors(n);\nalphaG += AARoughnessFactors.y;\nfloat reflectance = max(max(specularColor.r, specularColor.g), specularColor.b);\nvec3 reflectance90 = vec3(clamp(reflectance * 25.0, 0.0, 1.0));\nvec3 specularEnvironmentR0 = specularColor.rgb;\nvec3 specularEnvironmentR90 = vec3(1.0, 1.0, 1.0)*reflectance90;\nvec3 environmentBrdf = getBRDFLookup(NdotV, roughness, czm_environmentBrdfSampler);\nvec3 energyConservationFactor = getEnergyConservationFactor(specularColor, environmentBrdf);\nvec3 diffuseBase = vec3(0., 0., 0.);\nvec3 specularBase = vec3(0., 0., 0.);\npreLightingInfo preInfo;\npreInfo = computeHemisphericPreLightingInfo(l, v, n);\npreInfo.NdotV = NdotV;\npreInfo.attenuation = 1.0;\npreInfo.roughness = roughness;\ndiffuseBase += computeHemisphericDiffuseLighting(preInfo, lightColorHdr, vec3(0.0, 0.0, 0.0));\nspecularBase += computeSpecularLighting(preInfo, n, specularEnvironmentR0, specularEnvironmentR90, AARoughnessFactors.x, lightColorHdr);;\nvec3 finalDiffuse = diffuseBase;\nfinalDiffuse *= diffuseColor.rgb;\nfinalDiffuse = max(finalDiffuse, 0.0);\nvec3 finalSpecular = specularBase;\nfinalSpecular = max(finalSpecular, 0.0);\nvec3 finalSpecularScaled = finalSpecular;\nfinalSpecularScaled *= energyConservationFactor;\nfloat luminanceOverAlpha = 0.0;\nluminanceOverAlpha += getLuminance(finalSpecularScaled);\nalpha = saturate(alpha+luminanceOverAlpha*luminanceOverAlpha);\npbrColorStruct pbrColor;\npbrColor.lightColor = finalDiffuse + finalSpecularScaled;\npbrColor.alpha = alpha;\n#if defined(DIFFUSE_IBL) || defined(SPECULAR_IBL)\nmat3 fixedToENU = mat3(gltf_clippingPlanesMatrix[0][0], gltf_clippingPlanesMatrix[1][0], gltf_clippingPlanesMatrix[2][0],\ngltf_clippingPlanesMatrix[0][1], gltf_clippingPlanesMatrix[1][1], gltf_clippingPlanesMatrix[2][1],\ngltf_clippingPlanesMatrix[0][2], gltf_clippingPlanesMatrix[1][2], gltf_clippingPlanesMatrix[2][2]);\n#ifdef BIM_MODE\nconst mat3 yUpToZUp = mat3(1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, -1.0, 0.0);\nconst mat3 rotationZ = mat3(-1.0, 0.0, 0.0, 0.0, -1.0, 0.0, 0.0, 0.0, 1.0);\nvec3 cubeDir = normalize(rotationZ * yUpToZUp * fixedToENU * normalize(reflect(-v, n)));\n#else\nconst mat3 yUpToZUp = mat3(-1.0, 0.0, 0.0, 0.0, 0.0, -1.0, 0.0, 1.0, 0.0);\nvec3 cubeDir = normalize(yUpToZUp * fixedToENU * normalize(reflect(-v, n)));\n#endif\n#ifdef DIFFUSE_IBL\n#ifdef CUSTOM_SPHERICAL_HARMONICS\nvec3 diffuseIrradiance = czm_sphericalHarmonics(cubeDir, gltf_sphericalHarmonicCoefficients);\n#else\nvec3 diffuseIrradiance = czm_sphericalHarmonics(cubeDir, czm_sphericalHarmonicCoefficients);\n#endif\n#else\nvec3 diffuseIrradiance = vec3(0.0);\n#endif\n#ifdef SPECULAR_IBL\nvec2 brdfLut = texture2D(czm_environmentBrdfSampler, vec2(NdotV, roughness)).rg;\n#ifdef CUSTOM_SPECULAR_IBL\nvec3 specularIBL = czm_sampleOctahedralProjection(gltf_specularMap, gltf_specularMapSize, cubeDir,  roughness * gltf_maxSpecularLOD, gltf_maxSpecularLOD);\n#else\nvec3 specularIBL = czm_sampleOctahedralProjection(czm_specularEnvironmentMaps, czm_specularEnvironmentMapSize, cubeDir,  roughness * czm_specularEnvironmentMapsMaximumLOD, czm_specularEnvironmentMapsMaximumLOD);\n#endif\nvec3 fresnel = fresnelSchlick2(specularEnvironmentR0, specularEnvironmentR90, preInfo.VdotH);\nspecularIBL *= fresnel * brdfLut.x + brdfLut.y;\n#else\nvec3 specularIBL = vec3(0.0);\n#endif\npbrColor.iblColor = diffuseIrradiance * diffuseColor + specularColor * specularIBL;\n#endif\nreturn pbrColor;\n}\npbrColorStruct blinnPhong(czm_lightStruct lightInfo)\n{\nvec3 v = -normalize(lightInfo.positionEC);\nvec3 n = lightInfo.normal;\n#ifndef USE_CUSTOM_LIGHT_COLOR\nvec3 lightColor = czm_lightColorHdr;\n#else\nvec3 lightColor = gltf_lightColor;\n#endif\nvec3 l = normalize(czm_lightDirectionEC);\nvec3 h = normalize(v + l);\nvec3 diffuseColor = lightInfo.diffuseColor;\nvec3 specularColor = lightInfo.specularColor;\nfloat roughness = lightInfo.roughness;\nfloat diffuseTerm = dot(vec4(n, 1.0), sunlightDiffuseMatrix * vec4(n, 1.0));\nfloat nv = max(dot(n, v), 0.0);\nfloat vl = max(dot(v, l), 0.0);\ndiffuseTerm = diffuseTerm + (nv * (1.0 - vl)) * 0.8;\nvec3 color = 1.05 * vec3(0.5, 0.497, 0.49) * (diffuseColor * diffuseTerm) + diffuseColor * 0.5;\npbrColorStruct pbrColor;\npbrColor.lightColor = color;\nreturn pbrColor;\n}\n";function NSe(e,t){this._tileset=e,this._tileset.instanced3DModelContent=this,this._tile={_selectionDepth:0,_finalResolution:!0,tileset:this._tileset},this._modelMatrix=t.modelMatrix,this._resource=t.resource,this._modelInstanceCollection=void 0,this._batchTable=void 0,this._features=void 0,this.featurePropertiesDirty=!1,function(e,t){var i=t.clusterCollection,n=Object(w.a)(t.maxInstancesLength,i.instances.length);if(!Object(u.a)(n))throw new Ce.a("Feature table global property: INSTANCES_LENGTH must be defined");var r=i.batchTable;e._batchTable=new ZX(e,n,r);var a=e._tileset,o={instances:i.instances,batchTable:e._batchTable,cull:!1,url:e._resource,requestType:Hl.a.TILES3D,incrementallyLoadTextures:!1,upAxis:mX.Y,forwardAxis:mX.X,opaquePass:lM.CESIUM_3D_TILE,pickIdLoaded:FSe(e),imageBasedLightingFactor:a.imageBasedLightingFactor,lightColor:a.lightColor,luminanceAtZenith:a.luminanceAtZenith,sphericalHarmonicCoefficients:a.sphericalHarmonicCoefficients,specularEnvironmentMaps:a.specularEnvironmentMaps,forceMipmap:a._forceMipmap,maxInstancesLength:n};e._modelInstanceCollection=new N1(o),e._tileset.readyPromise=e._modelInstanceCollection.readyPromise,e._tileset.readyPromise.then((function(){e._tileset.ready=!0}))}(this,t)}function FSe(e){return function(){return e._batchTable.getPickId()}}NSe._deprecationWarning=mv.a,Object(O.a)(NSe.prototype,{featuresLength:{get:function(){return this._batchTable.featuresLength}},pointsLength:{get:function(){return 0}},trianglesLength:{get:function(){var e=this._modelInstanceCollection._model;return Object(u.a)(e)?e.trianglesLength:0}},geometryByteLength:{get:function(){var e=this._modelInstanceCollection._model;return Object(u.a)(e)?e.geometryByteLength:0}},texturesByteLength:{get:function(){var e=this._modelInstanceCollection._model;return Object(u.a)(e)?e.texturesByteLength:0}},batchTableByteLength:{get:function(){return this._batchTable.memorySizeInBytes}},innerContents:{get:function(){}},readyPromise:{get:function(){return this._modelInstanceCollection.readyPromise}},tileset:{get:function(){return this._tileset}},tile:{get:function(){return this._tile}},url:{get:function(){return this._resource.getUrlComponent(!0)}},batchTable:{get:function(){return this._batchTable}}});Uint32Array.BYTES_PER_ELEMENT,new Array(4),new Array(4);NSe.prototype.updateCollection=function(e){this._modelInstanceCollection.updateCollection(e)},NSe.prototype.hasProperty=function(e,t){return this._batchTable.hasProperty(e,t)},NSe.prototype.getFeature=function(e){var t=this.featuresLength;if(!Object(u.a)(e)||e<0||e>=t)throw new h.a("batchId is required and between zero and featuresLength - 1 ("+(t-1)+").");return function(e){var t=e.featuresLength;if(!Object(u.a)(e._features)&&t>0){for(var i=new Array(t),n=0;n<t;++n)i[n]=new KX(e,n);e._features=i}}(this),this._features[e]},NSe.prototype.applyDebugSettings=function(e,t){t=e?t:uf.WHITE,this._batchTable.setAllColor(t)},NSe.prototype.applyStyle=function(e){this._batchTable.applyStyle(e)},NSe.prototype.update=function(e){var t=e.commandList.length;this._batchTable.update(this._tileset,e),this._modelInstanceCollection.modelMatrix=this._modelMatrix,this._modelInstanceCollection.shadows=this._tileset.shadows,this._modelInstanceCollection.lightColor=this._tileset.lightColor,this._modelInstanceCollection.luminanceAtZenith=this._tileset.luminanceAtZenith,this._modelInstanceCollection.sphericalHarmonicCoefficients=this._tileset.sphericalHarmonicCoefficients,this._modelInstanceCollection.specularEnvironmentMaps=this._tileset.specularEnvironmentMaps,this._modelInstanceCollection.update(e),t<e.commandList.length&&(e.passes.render||e.passes.pick)&&this._batchTable.addDerivedCommands(e,t,!1)},NSe.prototype.isDestroyed=function(){return!1},NSe.prototype.destroy=function(){return this._modelInstanceCollection=this._modelInstanceCollection&&this._modelInstanceCollection.destroy(),this._batchTable=this._batchTable&&this._batchTable.destroy(),rl(this)};var kSe=NSe;function BSe(e){this.guid=Mg(),this.colorBlendMode=gX.HIGHLIGHT,this._statistics=new x5,this._styleEngine=new $5,this.instanced3DModelContent=new kSe(this,e),this._forceMipmap=Object(w.a)(e.forceMipmap,!1),this._dequantizeInShader=Object(w.a)(e.dequantizeInShader,!1),this._imageBasedLightingFactor=new Rt(1,1),Rt.clone(e.imageBasedLightingFactor,this._imageBasedLightingFactor),this.lightColor=e.lightColor,this.luminanceAtZenith=Object(w.a)(e.luminanceAtZenith,.5),this.sphericalHarmonicCoefficients=e.sphericalHarmonicCoefficients,this.specularEnvironmentMaps=e.specularEnvironmentMaps,this.shadows=Object(w.a)(e.shadows,rM.ENABLED),this._show=!0}Object(O.a)(BSe.prototype,{style:{get:function(){return this._styleEngine.style},set:function(e){this._styleEngine.style=e}},show:{get:function(){return this._show},set:function(e){this._show=e}}}),BSe.prototype.isDestroyed=function(){return!1},BSe.prototype.destroy=function(){Object(u.a)(this.instanced3DModelContent)&&!this.instanced3DModelContent.isDestroyed()&&this.instanced3DModelContent.destroy()},BSe.prototype.update=function(e){this.show&&Object(u.a)(this.instanced3DModelContent)&&this.instanced3DModelContent.update(e)},BSe.prototype.updateCollection=function(e){this.instanced3DModelContent.updateCollection(e)};var zSe=BSe;function USe(e){this._max_visible_distance=e.max_visible_distance,this._min_visible_distance=e.min_visible_distance,this._path=e.path,this._guid=Mg(),this._instances=[],this._lastFrameInstances=[],this._dirty=!1}Object(O.a)(USe.prototype,{max_visible_distance:{get:function(){return this._max_visible_distance}},min_visible_distance:{get:function(){return this._min_visible_distance}},path:{get:function(){return this._path}},guid:{get:function(){return this._guid}},instances:{get:function(){return this._instances}},dirty:{get:function(){return this._dirty||this._instances.length>0&&this._lastFrameInstances.length!==this._instances.length}},show:{get:function(){return this._instances.length>0}}}),USe.prototype.initInstancelod=function(){this._lastFrameInstances=this._instances,this._instances=[],this._dirty=!1},USe.prototype.addInstance=function(e){this._lastFrameInstances.indexOf(e)<0&&(this._dirty=!0),this._instances.push(e)};var VSe=USe;function HSe(e){this._collectionOptions=e,this.url=e.url,this.instances=e.instances,this._collectionOptions.maxInstancesLength=this.instances.length,this._access_token=e.access_token,this.config=[],this.dictModelInstancesCollecton=new Map,this.loadInstance()}HSe.prototype.loadInstance=function(){var e=this;f.a.fetchJson({url:this.url,headers:{access_token:this._access_token}}).then(t=>{for(var i of t.modlod){var n=new VSe(i);e.config.push(n)}})},HSe.prototype.update=function(e){var t;for(t of this.config)t.initInstancelod();var i=e.camera,n=new z;for(var r of this.instances){var a=r.modelMatrix;Be.getTranslation(a,n);var o=z.distance(i.positionWC,n);for(t of this.config)o>=t.min_visible_distance&&o<t.max_visible_distance&&t.addInstance(r)}for(t of this.config){var s=this.dictModelInstancesCollecton.get(t.guid);if(t.dirty){if(Object(u.a)(s))s.show=!0,s.updateCollection({instances:t.instances});else{var c=this.url.replace("modlod.json",t.path),l=f.a.createIfNeeded(c);Ri.isInternetExplorer()||Ri.isEdge()?l.setQueryParameters({access_token:this._access_token}):l.headers={access_token:this._access_token};var h=Object(nf.a)(this._collectionOptions);h.resource=l,h.clusterCollection={instances:t.instances,batchTable:h.batchTable},s=new zSe(h),this.dictModelInstancesCollecton.set(t.guid,s)}s.update(e)}else Object(u.a)(s)&&(s.show=t.show,s.update(e))}},HSe.prototype.destroy=function(){},HSe.prototype.isDestroyed=function(){return!1};var GSe=HSe;function qSe(e){var t=(e=Object(w.a)(e,w.a.EMPTY_OBJECT)).context;if(!Object(u.a)(t))throw new h.a("context is required.");if(!Object(u.a)(e.lightCamera))throw new h.a("lightCamera is required.");if(Object(u.a)(e.numberOfCascades)&&1!==e.numberOfCascades&&4!==e.numberOfCascades)throw new h.a("Only one or four cascades are supported.");this._enabled=Object(w.a)(e.enabled,!0),this._softShadows=Object(w.a)(e.softShadows,!1),this._normalOffset=Object(w.a)(e.normalOffset,!0),this.dirty=!0,this.fromLightSource=Object(w.a)(e.fromLightSource,!0),this.darkness=Object(w.a)(e.darkness,.3),this._darkness=this.darkness,this.maximumDistance=Object(w.a)(e.maximumDistance,5e3),this._outOfView=!1,this._outOfViewPrevious=!1,this._needsUpdate=!0;var i=!0;(Ri.isInternetExplorer()||Ri.isEdge()||(Ri.isChrome()||Ri.isFirefox())&&Ri.isWindows()&&!t.depthTexture)&&(i=!1),this._polygonOffsetSupported=i,this._terrainBias={polygonOffset:i,polygonOffsetFactor:1.1,polygonOffsetUnits:4,normalOffset:this._normalOffset,normalOffsetScale:.5,normalShading:!0,normalShadingSmooth:.3,depthBias:1e-4},this._primitiveBias={polygonOffset:i,polygonOffsetFactor:1.1,polygonOffsetUnits:4,normalOffset:this._normalOffset,normalOffsetScale:.1,normalShading:!0,normalShadingSmooth:.05,depthBias:2e-5},this._pointBias={polygonOffset:!1,polygonOffsetFactor:1.1,polygonOffsetUnits:4,normalOffset:this._normalOffset,normalOffsetScale:0,normalShading:!0,normalShadingSmooth:.1,depthBias:5e-4},this._depthAttachment=void 0,this._colorAttachment=void 0,this._shadowMapMatrix=new Be,this._shadowMapTexture=void 0,this._lightDirectionEC=new z,this._lightPositionEC=new Te,this._distance=0;var n,r=new hj({context:t,width:1,height:1});this._videoTexture=Object(w.a)(e.videoTexture,r),this._lightCamera=e.lightCamera,this._shadowMapCamera=new lAe,this._shadowMapCullingVolume=void 0,this._sceneCamera=void 0,this._boundingSphere=new St,this._isPointLight=Object(w.a)(e.isPointLight,!1),this._pointLightRadius=Object(w.a)(e.pointLightRadius,100),this._cascadesEnabled=!this._isPointLight&&Object(w.a)(e.cascadesEnabled,!0),this._numberOfCascades=this._cascadesEnabled?Object(w.a)(e.numberOfCascades,4):0,this._fitNearFar=!0,this._maximumCascadeDistances=[25,150,700,Number.MAX_VALUE],this._textureSize=new Rt,this._isSpotLight=!1,this._cascadesEnabled?this._shadowMapCamera.frustum=new cb:Object(u.a)(this._lightCamera.frustum.fov)&&(this._isSpotLight=!0),this._cascadeSplits=[new Te,new Te],this._cascadeMatrices=[new Be,new Be,new Be,new Be],this._cascadeDistances=new Te,n=this._isPointLight?6:this._cascadesEnabled?this._numberOfCascades:1,this._passes=new Array(n);for(var a=0;a<n;++a)this._passes[a]=new WSe(t);this.debugShow=!1,this.debugFreezeFrame=!1,this._debugFreezeFrame=!1,this._debugCascadeColors=!1,this._debugLightFrustum=void 0,this._debugCameraFrustum=void 0,this._debugCascadeFrustums=new Array(this._numberOfCascades),this._debugShadowViewCommand=void 0,this._usesDepthTexture=t.depthTexture,this._isPointLight&&(this._usesDepthTexture=!1),this._primitiveRenderState=void 0,this._terrainRenderState=void 0,this._pointRenderState=void 0,XSe(this),this._clearCommand=new fX({depth:1,color:new uf}),this._clearPassState=new bne(t),this._size=Object(w.a)(e.size,2048),this.size=this._size,this._viewerPosition=Object(w.a)(e.viewerPosition,new z(0,0,0)),this._direction=0,this._pitch=0,this._horizontalFov=60,this._verticalFov=60,this._distance=100,this._targetPoint=new z(0,0,0),this._modelMatrix=new Be,this._lineColor=uf.YELLOW,this._hintLineUpdated=!1,this._initialized=!1,this._cameraUpdated=!1,this._indices=void 0,this._positions=void 0,this._drawLineCommand=void 0,this.setPoseByTargetPoint(Object(w.a)(e.target,new z(0,0,0))),this._alpha=Object(w.a)(e.alpha,1),this._initialized||this._initialize(),this._cameraUpdated}function WSe(e){this.camera=new lAe,this.passState=new bne(e),this.framebuffer=void 0,this.textureOffsets=void 0,this.commandList=[],this.cullingVolume=void 0}function YSe(e,t){return RM.fromCache({cull:{enabled:!0,face:BD.BACK},depthTest:{enabled:!0},colorMask:{red:e,green:e,blue:e,alpha:e},depthMask:!0,polygonOffset:{enabled:t.polygonOffset,factor:t.polygonOffsetFactor,units:t.polygonOffsetUnits}})}function XSe(e){var t=!e._usesDepthTexture;e._primitiveRenderState=YSe(t,e._primitiveBias),e._terrainRenderState=YSe(t,e._terrainBias),e._pointRenderState=YSe(t,e._pointBias)}function ZSe(e){for(var t=e._passes.length,i=0;i<t;++i){var n=e._passes[i],r=n.framebuffer;Object(u.a)(r)&&!r.isDestroyed()&&r.destroy(),n.framebuffer=void 0}e._depthAttachment=e._depthAttachment&&e._depthAttachment.destroy(),e._colorAttachment=e._colorAttachment&&e._colorAttachment.destroy()}function QSe(){return new tj({wrapS:$D.CLAMP_TO_EDGE,wrapT:$D.CLAMP_TO_EDGE,minificationFilter:KD.NEAREST,magnificationFilter:ZD.NEAREST})}function KSe(e,t){e._isPointLight?function(e,t){for(var i=new are({context:t,width:e._textureSize.x,height:e._textureSize.y,format:nre.DEPTH_COMPONENT16}),n=new nj({context:t,width:e._textureSize.x,height:e._textureSize.y,pixelFormat:gx.RGBA,pixelDatatype:mx.UNSIGNED_BYTE,sampler:QSe()}),r=[n.negativeX,n.negativeY,n.negativeZ,n.positiveX,n.positiveY,n.positiveZ],a=0;a<6;++a){var o=new cj({context:t,depthRenderbuffer:i,colorTextures:[r[a]],destroyAttachments:!1}),s=e._passes[a];s.framebuffer=o,s.passState.framebuffer=o}e._shadowMapTexture=n,e._depthAttachment=i,e._colorAttachment=n}(e,t):e._usesDepthTexture?function(e,t){for(var i=new hj({context:t,width:e._textureSize.x,height:e._textureSize.y,pixelFormat:gx.DEPTH_STENCIL,pixelDatatype:mx.UNSIGNED_INT_24_8,sampler:QSe()}),n=new cj({context:t,depthStencilTexture:i,destroyAttachments:!1}),r=e._passes.length,a=0;a<r;++a){var o=e._passes[a];o.framebuffer=n,o.passState.framebuffer=n}e._shadowMapTexture=i,e._depthAttachment=i}(e,t):function(e,t){for(var i=new are({context:t,width:e._textureSize.x,height:e._textureSize.y,format:nre.DEPTH_COMPONENT16}),n=new hj({context:t,width:e._textureSize.x,height:e._textureSize.y,pixelFormat:gx.RGBA,pixelDatatype:mx.UNSIGNED_BYTE,sampler:QSe()}),r=new cj({context:t,depthRenderbuffer:i,colorTextures:[n],destroyAttachments:!1}),a=e._passes.length,o=0;o<a;++o){var s=e._passes[o];s.framebuffer=r,s.passState.framebuffer=r}e._shadowMapTexture=n,e._depthAttachment=i,e._colorAttachment=n}(e,t)}function JSe(e,t){Object(u.a)(e._passes[0].framebuffer)&&e._shadowMapTexture.width===e._textureSize.x||(ZSe(e),KSe(e,t),function(e,t){e._usesDepthTexture&&e._passes[0].framebuffer.status!==un.FRAMEBUFFER_COMPLETE&&(e._usesDepthTexture=!1,XSe(e),ZSe(e),KSe(e,t))}(e,t),$Se(e,t))}function $Se(e,t,i){i=Object(w.a)(i,0),(e._isPointLight||0===i)&&(e._clearCommand.framebuffer=e._passes[i].framebuffer,e._clearCommand.execute(t,e._clearPassState))}qSe.prototype.setPoseByHeading=function(e){this._direction=e},qSe.prototype.setPoseByPitch=function(e){this._pitch=e},qSe.prototype.setPoseByRoll=function(e){this._roll=e},qSe.prototype.setPoseByTargetPoint=function(e){this._distance=z.distance(this._viewerPosition,e);var t=new z,i=xa.eastNorthUpToFixedFrame(this._viewerPosition);Be.inverse(i,i),Be.multiplyByPoint(i,e,t),z.normalize(t,t),this._direction=I.toDegrees(Math.atan2(t.x,t.y)),this._pitch=I.toDegrees(Math.asin(t.z))},qSe.prototype._initialize=function(){this._positions=new Float32Array(633),this._indices=new Uint16Array(408);var e=this._indices,t=0;e[t++]=0,e[t++]=1,e[t++]=0,e[t++]=21,e[t++]=0,e[t++]=85,e[t++]=0,e[t++]=105;for(var i=0,n=0;n<5;++n){i++;for(var r=0;r<20;++r)e[t++]=i++,e[t++]=i}i++;for(var a=0;a<20;++a)for(var o=0;o<5;++o)e[t++]=i,e[t++]=5+i++;this._initialized=!0},qSe.prototype._updateCamera=function(){this._lightCamera.setView({destination:this._viewerPosition,orientation:{heading:I.toRadians(this._direction),pitch:I.toRadians(this._pitch)}}),this._modelMatrix=this._lightCamera.inverseViewMatrix},qSe.prototype._updateHintLine=function(e){var t,i;this._distance=600;var n=this._positions,r=I.toRadians(this._horizontalFov),a=I.toRadians(this._verticalFov),o=Math.tan(.5*r),s=Math.tan(.5*a);t=this._distance*o,i=this._distance*s;var c=new z(-t,-i,-this._distance),l=new z(t,i,0);Be.multiplyByPoint(this._modelMatrix,c,c),Be.multiplyByPoint(this._modelMatrix,l,l);var h=St.fromCornerPoints(c,l);if(e.cullingVolume.computeVisibility(h)!==ce.OUTSIDE){this._valid=!0;var d,f,p=0;n[p++]=0,n[p++]=0,n[p++]=0;for(var m=Math.PI-.5*r,_=r/4,g=0;g<5;++g){d=m+g*_;for(var v=i/(this._distance/Math.cos(d)),b=Math.atan(v),y=-b,w=b/10,O=0;O<21;++O)f=y+O*w,n[p++]=this._distance*Math.cos(f)*Math.sin(d),n[p++]=this._distance*Math.sin(f),n[p++]=this._distance*Math.cos(f)*Math.cos(d)}_=r/20;for(var x=0;x<21;++x){d=m+x*_;for(var E=i/(this._distance/Math.cos(d)),T=Math.atan(E),C=-T,S=T/2,A=0;A<5;++A)f=C+A*S,n[p++]=this._distance*Math.cos(f)*Math.sin(d),n[p++]=this._distance*Math.sin(f),n[p++]=this._distance*Math.cos(f)*Math.cos(d)}var P=e.context,D=ZN.createIndexBuffer({context:P,typedArray:new Uint32Array(this._indices),usage:YN.STATIC_DRAW,indexDatatype:Sl.UNSIGNED_INT}),j=ZN.createVertexBuffer({context:P,typedArray:dn.createTypedArray(dn.FLOAT,this._positions),usage:YN.STATIC_DRAW}),M=[];M.push({index:0,vertexBuffer:j,componentDatatype:dn.FLOAT,componentsPerAttribute:3,normalize:!1});var R=new tF({context:P,attributes:M,indexBuffer:D});if(Object(u.a)(this._drawLineCommand))this._drawLineCommand.vertexArray.destroy(),this._drawLineCommand.vertexArray=R,this._drawLineCommand.modelMatrix=this._modelMatrix,this._drawLineCommand.boundingVolume=h;else{var L=bR.fromCache({context:P,vertexShaderSource:kbe,fragmentShaderSource:Fbe}),N=RM.fromCache({depthTest:{enabled:!0}}),F=this,k={u_bgColor:function(){return F._lineColor},u_modelViewMatrix:function(){return P.uniformState.modelView}};this._drawLineCommand=new cM({boundingVolume:h,modelMatrix:F._modelMatrix,primitiveType:yn.LINES,vertexArray:R,shaderProgram:L,castShadows:!1,receiveShadows:!1,uniformMap:k,renderState:N,pass:lM.OPAQUE})}this._hintLineUpdated=!0}else this._valid=!1},qSe.MAXIMUM_DISTANCE=2e4,qSe.prototype.debugCreateRenderStates=function(){XSe(this)},Object(O.a)(qSe.prototype,{enabled:{get:function(){return this._enabled},set:function(e){this.dirty=this._enabled!==e,this._enabled=e}},viewerPosition:{get:function(){return this._viewerPosition},set:function(e){this._viewerPosition=e,this._cameraUpdated=!1}},normalOffset:{get:function(){return this._normalOffset},set:function(e){this.dirty=this._normalOffset!==e,this._normalOffset=e,this._terrainBias.normalOffset=e,this._primitiveBias.normalOffset=e,this._pointBias.normalOffset=e}},softShadows:{get:function(){return this._softShadows},set:function(e){this.dirty=this._softShadows!==e,this._softShadows=e}},size:{get:function(){return this._size},set:function(e){!function(e,t){e._size=t;var i=e._passes,n=i.length,r=e._textureSize;if(e._isPointLight){t=HD.maximumCubeMapSize>=t?t:HD.maximumCubeMapSize,r.x=t,r.y=t;var a=new ln(0,0,t,t);i[0].passState.viewport=a,i[1].passState.viewport=a,i[2].passState.viewport=a,i[3].passState.viewport=a,i[4].passState.viewport=a,i[5].passState.viewport=a}else 1===n?(t=HD.maximumTextureSize>=t?t:HD.maximumTextureSize,r.x=t,r.y=t,i[0].passState.viewport=new ln(0,0,t,t)):4===n&&(t=HD.maximumTextureSize>=2*t?t:HD.maximumTextureSize/2,r.x=2*t,r.y=2*t,i[0].passState.viewport=new ln(0,0,t,t),i[1].passState.viewport=new ln(t,0,t,t),i[2].passState.viewport=new ln(0,t,t,t),i[3].passState.viewport=new ln(t,t,t,t));e._clearPassState.viewport=new ln(0,0,r.x,r.y);for(var o=0;o<n;++o){var s=i[o],c=s.passState.viewport,l=c.x/r.x,u=c.y/r.y,h=c.width/r.x,d=c.height/r.y;s.textureOffsets=new Be(h,0,0,l,0,d,0,u,0,0,1,0,0,0,0,1)}}(this,e)}},outOfView:{get:function(){return this._outOfView}},shadowMapCullingVolume:{get:function(){return this._shadowMapCullingVolume}},passes:{get:function(){return this._passes}},isPointLight:{get:function(){return this._isPointLight}},debugCascadeColors:{get:function(){return this._debugCascadeColors},set:function(e){this.dirty=this._debugCascadeColors!==e,this._debugCascadeColors=e}}});var eAe=new ln;function tAe(e,t){var i;i=e._isPointLight?"uniform samplerCube shadowMap_textureCube; \nvarying vec2 v_textureCoordinates; \nvoid main() \n{ \n    vec2 uv = v_textureCoordinates; \n    vec3 dir; \n \n    if (uv.y < 0.5) \n    { \n        if (uv.x < 0.333) \n        { \n            dir.x = -1.0; \n            dir.y = uv.x * 6.0 - 1.0; \n            dir.z = uv.y * 4.0 - 1.0; \n        } \n        else if (uv.x < 0.666) \n        { \n            dir.y = -1.0; \n            dir.x = uv.x * 6.0 - 3.0; \n            dir.z = uv.y * 4.0 - 1.0; \n        } \n        else \n        { \n            dir.z = -1.0; \n            dir.x = uv.x * 6.0 - 5.0; \n            dir.y = uv.y * 4.0 - 1.0; \n        } \n    } \n    else \n    { \n        if (uv.x < 0.333) \n        { \n            dir.x = 1.0; \n            dir.y = uv.x * 6.0 - 1.0; \n            dir.z = uv.y * 4.0 - 3.0; \n        } \n        else if (uv.x < 0.666) \n        { \n            dir.y = 1.0; \n            dir.x = uv.x * 6.0 - 3.0; \n            dir.z = uv.y * 4.0 - 3.0; \n        } \n        else \n        { \n            dir.z = 1.0; \n            dir.x = uv.x * 6.0 - 5.0; \n            dir.y = uv.y * 4.0 - 3.0; \n        } \n    } \n \n    float shadow = czm_unpackDepth(textureCube(shadowMap_textureCube, dir)); \n    gl_FragColor = vec4(vec3(shadow), 1.0); \n} \n":"uniform sampler2D shadowMap_texture; \nvarying vec2 v_textureCoordinates; \nvoid main() \n{ \n"+(e._usesDepthTexture?"    float shadow = texture2D(shadowMap_texture, v_textureCoordinates).r; \n":"    float shadow = czm_unpackDepth(texture2D(shadowMap_texture, v_textureCoordinates)); \n")+"    gl_FragColor = vec4(vec3(shadow), 1.0); \n} \n";var n=t.createViewportQuadCommand(i,{uniformMap:{shadowMap_texture:function(){return e._videoTexture},shadowMap_textureCube:function(){return e._shadowMapTexture}}});return n.pass=lM.OVERLAY,n}qSe.prototype.updateDebugMode=function(e,t){var i=t.context,n=t.context.drawingBufferWidth,r=t.context.drawingBufferHeight,a=.3*Math.min(n,r),o=eAe;o.x=n-a,o.y=0,o.width=a,o.height=a;var s=e._debugShadowViewCommand;s=tAe(e,i),e._debugShadowViewCommand=s,Object(u.a)(s.renderState)&&ln.equals(s.renderState.viewport,o)||(s.renderState=RM.fromCache({viewport:ln.clone(o)})),t.commandList.push(e._debugShadowViewCommand)};var iAe=new Array(8);iAe[0]=new Te(-1,-1,-1,1),iAe[1]=new Te(1,-1,-1,1),iAe[2]=new Te(1,1,-1,1),iAe[3]=new Te(-1,1,-1,1),iAe[4]=new Te(-1,-1,1,1),iAe[5]=new Te(1,-1,1,1),iAe[6]=new Te(1,1,1,1),iAe[7]=new Te(-1,1,1,1);for(var nAe=new Be,rAe=new Array(8),aAe=0;aAe<8;++aAe)rAe[aAe]=new Te;var oAe=[uf.RED,uf.GREEN,uf.BLUE,uf.MAGENTA],sAe=new z;function cAe(e,t){!function(e,t){var i=t.context,n=t.context.drawingBufferWidth,r=t.context.drawingBufferHeight,a=.3*Math.min(n,r),o=eAe;o.x=n-a,o.y=0,o.width=a,o.height=a;var s=e._debugShadowViewCommand;Object(u.a)(s)||(s=tAe(e,i),e._debugShadowViewCommand=s),Object(u.a)(s.renderState)&&ln.equals(s.renderState.viewport,o)||(s.renderState=RM.fromCache({viewport:ln.clone(o)})),t.commandList.push(e._debugShadowViewCommand)}(e,t);var i=e.debugFreezeFrame&&!e._debugFreezeFrame;if(e._debugFreezeFrame=e.debugFreezeFrame,e.debugFreezeFrame&&(i&&(e._debugCameraFrustum=e._debugCameraFrustum&&e._debugCameraFrustum.destroy(),e._debugCameraFrustum=new Lle({camera:e._sceneCamera,color:uf.CYAN,updateOnChange:!1})),e._debugCameraFrustum.update(t)),e._cascadesEnabled){if(e.debugFreezeFrame){i&&(e._debugLightFrustum=e._debugLightFrustum&&e._debugLightFrustum.destroy(),e._debugLightFrustum=new Lle({camera:e._shadowMapCamera,color:uf.YELLOW,updateOnChange:!1})),e._debugLightFrustum.update(t);for(var n=0;n<e._numberOfCascades;++n)i&&(e._debugCascadeFrustums[n]=e._debugCascadeFrustums[n]&&e._debugCascadeFrustums[n].destroy(),e._debugCascadeFrustums[n]=new Lle({camera:e._passes[n].camera,color:oAe[n],updateOnChange:!1})),e._debugCascadeFrustums[n].update(t)}}else if(e._isPointLight){if(!Object(u.a)(e._debugLightFrustum)||e._needsUpdate){var r=e._shadowMapCamera.positionWC,a=Kn.IDENTITY,o=2*e._pointLightRadius,s=z.fromElements(o,o,o,sAe),c=Be.fromTranslationQuaternionRotationScale(r,a,s,nAe);e._debugLightFrustum=e._debugLightFrustum&&e._debugLightFrustum.destroy(),e._debugLightFrustum=function(e,t){var i=new Mu({geometry:new $a({minimum:new z(-.5,-.5,-.5),maximum:new z(.5,.5,.5)}),attributes:{color:df.fromColor(t)}}),n=new Mu({geometry:new NP({radius:.5}),attributes:{color:df.fromColor(t)}});return new ck({geometryInstances:[i,n],appearance:new $j({translucent:!1,flat:!0}),asynchronous:!1,modelMatrix:e})}(c,uf.YELLOW)}e._debugLightFrustum.update(t)}else Object(u.a)(e._debugLightFrustum)&&!e._needsUpdate||(e._debugLightFrustum=new Lle({camera:e._shadowMapCamera,color:uf.YELLOW,updateOnChange:!1})),e._debugLightFrustum.update(t)}function lAe(){this.viewMatrix=new Be,this.inverseViewMatrix=new Be,this.frustum=void 0,this.positionCartographic=new K,this.positionWC=new z,this.directionWC=z.clone(z.UNIT_Z),this.upWC=z.clone(z.UNIT_Y),this.rightWC=z.clone(z.UNIT_X),this.viewProjectionMatrix=new Be}lAe.prototype.clone=function(e){Be.clone(e.viewMatrix,this.viewMatrix),Be.clone(e.inverseViewMatrix,this.inverseViewMatrix),this.frustum=e.frustum.clone(this.frustum),K.clone(e.positionCartographic,this.positionCartographic),z.clone(e.positionWC,this.positionWC),z.clone(e.directionWC,this.directionWC),z.clone(e.upWC,this.upWC),z.clone(e.rightWC,this.rightWC)};var uAe=new Be(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1);lAe.prototype.getViewProjection=function(){var e=this.viewMatrix,t=this.frustum.projectionMatrix;return Be.multiply(t,e,this.viewProjectionMatrix),Be.multiply(uAe,this.viewProjectionMatrix,this.viewProjectionMatrix),this.viewProjectionMatrix};var hAe=new Array(5),dAe=new wb,fAe=new Array(4),pAe=new z,mAe=new z;var _Ae=new Be,gAe=new z,vAe=new z,bAe=new z;var yAe=[new z(-1,0,0),new z(0,-1,0),new z(0,0,-1),new z(1,0,0),new z(0,1,0),new z(0,0,1)],wAe=[new z(0,-1,0),new z(0,0,-1),new z(0,-1,0),new z(0,-1,0),new z(0,0,1),new z(0,-1,0)],OAe=[new z(0,0,1),new z(1,0,0),new z(-1,0,0),new z(0,0,-1),new z(1,0,0),new z(1,0,0)];var xAe=new z,EAe=new z,TAe=new St,CAe=TAe.center;function SAe(e,t){var i=t.camera,n=e._lightCamera,r=e._sceneCamera,a=e._shadowMapCamera;e._cascadesEnabled?z.clone(n.directionWC,a.directionWC):e._isPointLight?z.clone(n.positionWC,a.positionWC):a.clone(n);var o,s,c=e._lightDirectionEC;Be.multiplyByPointAsVector(i.viewMatrix,a.directionWC,c),z.normalize(c,c),z.negate(c,c),Be.multiplyByPoint(i.viewMatrix,a.positionWC,e._lightPositionEC),e._lightPositionEC.w=e._pointLightRadius,e._fitNearFar?(o=Math.min(t.shadowState.nearPlane,e.maximumDistance),s=Math.min(t.shadowState.farPlane,e.maximumDistance+1)):(o=i.frustum.near,s=e.maximumDistance),e._sceneCamera=ose.clone(i,r),i.frustum.clone(e._sceneCamera.workingFrustums[0]),e._sceneCamera.frustum.near=o,e._sceneCamera.frustum.far=s,e._distance=s-o,function(e,t){var i=e._sceneCamera,n=e._shadowMapCamera,r=TAe;if(e._cascadesEnabled){if(i.frustum.near>=e.maximumDistance)return e._outOfView=!0,void(e._needsUpdate=!1);var a=t.mapProjection.ellipsoid.geodeticSurfaceNormal(i.positionWC,xAe),o=z.negate(n.directionWC,EAe),s=z.dot(a,o),c=I.clamp(s/.1,0,1);if(e._darkness=I.lerp(1,e.darkness,c),s<0)return e._outOfView=!0,void(e._needsUpdate=!1);e._needsUpdate=!0,e._outOfView=!1}else if(e._isPointLight)r.center=n.positionWC,r.radius=e._pointLightRadius,e._outOfView=t.cullingVolume.computeVisibility(r)===ce.OUTSIDE,e._needsUpdate=!e._outOfView&&!e._boundingSphere.equals(r),St.clone(r,e._boundingSphere);else{var l=n.frustum.far/2,u=z.add(n.positionWC,z.multiplyByScalar(n.directionWC,l,CAe),CAe);r.center=u,r.radius=l,e._outOfView=t.cullingVolume.computeVisibility(r)===ce.OUTSIDE,e._needsUpdate=!e._outOfView&&!e._boundingSphere.equals(r),St.clone(r,e._boundingSphere)}}(e,t),!e._outOfViewPrevious&&e._outOfView&&(e._needsUpdate=!0),e._outOfViewPrevious=e._outOfView}qSe.prototype.updateVideoTexture=function(e,t,i){e._videoTexture.copyFrom(t),this._initialized||this._initialize(),this._cameraUpdated||this._updateCamera()},qSe.prototype.update=function(e){if(SAe(this,e),e.viewSheds.push(this),this._cameraUpdated||this._updateCamera(),this._needsUpdate)if(JSe(this,e.context),this._isPointLight&&function(e,t){var i=new wb;i.fov=I.PI_OVER_TWO,i.near=1,i.far=e._pointLightRadius,i.aspectRatio=1;for(var n=0;n<6;++n){var r=e._passes[n].camera;r.positionWC=e._shadowMapCamera.positionWC,r.positionCartographic=t.mapProjection.ellipsoid.cartesianToCartographic(r.positionWC,r.positionCartographic),r.directionWC=yAe[n],r.upWC=wAe[n],r.rightWC=OAe[n],Be.computeView(r.positionWC,r.directionWC,r.upWC,r.rightWC,r.viewMatrix),Be.inverse(r.viewMatrix,r.inverseViewMatrix),r.frustum=i}}(this,e),this._cascadesEnabled&&(function(e,t){var i=e._shadowMapCamera,n=e._sceneCamera,r=Be.multiply(n.frustum.projectionMatrix,n.viewMatrix,nAe),a=Be.inverse(r,nAe),o=i.directionWC,s=n.directionWC,c=z.cross(o,s,gAe);s=z.cross(c,o,vAe),z.normalize(s,s),z.normalize(c,c);for(var l=z.fromElements(0,0,0,bAe),u=Be.computeView(l,o,s,c,_Ae),h=Be.multiply(u,a,nAe),d=z.fromElements(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,pAe),f=z.fromElements(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE,mAe),p=0;p<8;++p){var m=Te.clone(iAe[p],rAe[p]);Be.multiplyByVector(h,m,m),z.divideByScalar(m,m.w,m),z.minimumByComponent(m,d,d),z.maximumByComponent(m,f,f)}f.z+=1e3,d.z-=10;var _=bAe;_.x=-.5*(d.x+f.x),_.y=-.5*(d.y+f.y),_.z=-f.z;var g=Be.fromTranslation(_,nAe);u=Be.multiply(g,u,u);var v=.5*(f.x-d.x),b=.5*(f.y-d.y),y=f.z-d.z,w=i.frustum;w.left=-v,w.right=v,w.bottom=-b,w.top=b,w.near=.01,w.far=y,Be.clone(u,i.viewMatrix),Be.inverse(u,i.inverseViewMatrix),Be.getTranslation(i.inverseViewMatrix,i.positionWC),t.mapProjection.ellipsoid.cartesianToCartographic(i.positionWC,i.positionCartographic),z.clone(o,i.directionWC),z.clone(s,i.upWC),z.clone(c,i.rightWC)}(this,e),this._numberOfCascades>1&&function(e,t){var i,n=e._shadowMapCamera,r=e._sceneCamera,a=r.frustum.near,o=r.frustum.far,s=e._numberOfCascades,c=o-a,l=o/a,u=.9,h=!1;t.shadowState.closestObjectSize<200&&(h=!0,u=.9);var d=fAe,f=hAe;for(f[0]=a,f[s]=o,i=0;i<s;++i){var p=(i+1)/s,m=a*Math.pow(l,p),_=a+c*p,g=I.lerp(_,m,u);f[i+1]=g,d[i]=g-f[i]}if(h){for(i=0;i<s;++i)d[i]=Math.min(d[i],e._maximumCascadeDistances[i]);var v=f[0];for(i=0;i<s-1;++i)v+=d[i],f[i+1]=v}Te.unpack(f,0,e._cascadeSplits[0]),Te.unpack(f,1,e._cascadeSplits[1]),Te.unpack(d,0,e._cascadeDistances);var b=n.frustum,y=b.left,w=b.right,O=b.bottom,x=b.top,E=b.near,T=b.far,C=n.positionWC,S=n.directionWC,A=n.upWC,P=r.frustum.clone(dAe),D=n.getViewProjection();for(i=0;i<s;++i){P.near=f[i],P.far=f[i+1];for(var j=Be.multiply(P.projectionMatrix,r.viewMatrix,nAe),M=Be.inverse(j,nAe),R=Be.multiply(D,M,nAe),L=z.fromElements(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,pAe),N=z.fromElements(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE,mAe),F=0;F<8;++F){var k=Te.clone(iAe[F],rAe[F]);Be.multiplyByVector(R,k,k),z.divideByScalar(k,k.w,k),z.minimumByComponent(k,L,L),z.maximumByComponent(k,N,N)}L.x=Math.max(L.x,0),L.y=Math.max(L.y,0),L.z=0,N.x=Math.min(N.x,1),N.y=Math.min(N.y,1),N.z=Math.min(N.z,1);var B=e._passes[i],U=B.camera;U.clone(n);var V=U.frustum;V.left=y+L.x*(w-y),V.right=y+N.x*(w-y),V.bottom=O+L.y*(x-O),V.top=O+N.y*(x-O),V.near=E+L.z*(T-E),V.far=E+N.z*(T-E),B.cullingVolume=U.frustum.computeCullingVolume(C,S,A);var H=e._cascadeMatrices[i];Be.multiply(U.getViewProjection(),r.inverseViewMatrix,H),Be.multiply(B.textureOffsets,H,H)}}(this,e)),this._isPointLight)this._shadowMapCullingVolume=Wg.fromBoundingSphere(this._boundingSphere);else{var t=this._shadowMapCamera,i=t.positionWC,n=t.directionWC,r=t.upWC;this._shadowMapCullingVolume=t.frustum.computeCullingVolume(i,n,r),1===this._passes.length&&this._passes[0].camera.clone(t)}if(1===this._passes.length){var a=this._sceneCamera.inverseViewMatrix;Be.multiply(this._shadowMapCamera.getViewProjection(),a,this._shadowMapMatrix)}this.debugShow&&cAe(this,e)},qSe.prototype.updatePass=function(e,t){$Se(this,e,t)};var AAe=new Rt;function PAe(e,t,i){var n=e._isPointLight?e._pointBias:i?e._terrainBias:e._primitiveBias,r={shadowMap_texture:function(){return e._shadowMapTexture},video_texture:function(){return e._videoTexture},shadowMap_textureCube:function(){return e._shadowMapTexture},shadowMap_matrix:function(){return e._shadowMapMatrix},shadowMap_cascadeSplits:function(){return e._cascadeSplits},shadowMap_cascadeMatrices:function(){return e._cascadeMatrices},shadowMap_lightDirectionEC:function(){return e._lightDirectionEC},shadowMap_lightPositionEC:function(){return e._lightPositionEC},shadowMap_cascadeDistances:function(){return e._cascadeDistances},shadowMap_texelSizeDepthBiasAndNormalShadingSmooth:function(){var t=AAe;return t.x=1/e._textureSize.x,t.y=1/e._textureSize.y,Te.fromElements(t.x,t.y,n.depthBias,n.normalShadingSmooth,this.combinedUniforms1)},shadowMap_normalOffsetScaleDistanceMaxDistanceAndDarkness:function(){return Te.fromElements(n.normalOffsetScale,e._distance,e.maximumDistance,e._darkness,this.combinedUniforms2)},combinedUniforms1:new Te,combinedUniforms2:new Te};return Object(ff.a)(t,r,!1)}function IAe(e,t,i,n,r,a){var o,s,c;if(Object(u.a)(a)&&(o=a.shaderProgram,s=a.renderState,c=a.uniformMap),(a=cM.shallowClone(i,a)).castShadows=!0,a.receiveShadows=!1,!Object(u.a)(o)||r!==i.shaderProgram.id||t){var l=i.shaderProgram,h=i.pass===lM.GLOBE,d=i.pass!==lM.TRANSLUCENT,f=e._isPointLight,p=e._usesDepthTexture,m=Nbe.getShadowCastShaderKeyword(f,h,p,d);if(o=n.shaderCache.getDerivedShaderProgram(l,m),!Object(u.a)(o)){var _=l.vertexShaderSource,g=l.fragmentShaderSource,v=Nbe.createShadowCastVertexShader(_,f,h),b=Nbe.createShadowCastFragmentShader(g,f,p,d);o=n.shaderCache.createDerivedShaderProgram(l,m,{vertexShaderSource:v,fragmentShaderSource:b,attributeLocations:l._attributeLocations})}s=e._primitiveRenderState,f?s=e._pointRenderState:h&&(s=e._terrainRenderState),i.renderState.cull.enabled||((s=Object(nf.a)(s,!1)).cull=Object(nf.a)(s.cull,!1),s.cull.enabled=!1,s=RM.fromCache(s)),c=PAe(e,i.uniformMap,h)}return a.shaderProgram=o,a.renderState=s,a.uniformMap=c,a}qSe.createReceiveDerivedCommand=function(e,t,i,n,r){Object(u.a)(r)||(r={});var a=e.length>0,o=t.shaderProgram,s=o.vertexShaderSource,c=o.fragmentShaderSource,l=t.pass===lM.GLOBE,h=!1;if(l&&(h=t.owner.data.pickTerrain.mesh.encoding.hasVertexNormals),t.receiveShadows&&a){var d,f;Object(u.a)(r.receiveCommand)&&(d=r.receiveCommand.shaderProgram,f=r.receiveCommand.uniformMap),r.receiveCommand=cM.shallowClone(t,r.receiveCommand),r.castShadows=!1,r.receiveShadows=!0;var p=r.receiveShaderCastShadows!==t.castShadows,m=r.receiveShaderProgramId!==t.shaderProgram.id;if(!Object(u.a)(d)||m||i||p){var _=Nbe.getShadowReceiveShaderKeyword(e[0],t.castShadows,l,h);if(d=n.shaderCache.getDerivedShaderProgram(o,_),!Object(u.a)(d)){var g=Nbe.createShadowReceiveVertexShader(s,l,h),v=Nbe.createShadowReceiveFragmentShader(c,e[0],t.castShadows,l,h,e[0]._alpha);d=n.shaderCache.createDerivedShaderProgram(o,_,{vertexShaderSource:g,fragmentShaderSource:v,attributeLocations:o._attributeLocations})}f=PAe(e[0],t.uniformMap,l)}r.receiveCommand.shaderProgram=d,r.receiveCommand.uniformMap=f,r.receiveShaderProgramId=t.shaderProgram.id,r.receiveShaderCastShadows=t.castShadows}return r},qSe.createCastDerivedCommand=function(e,t,i,n,r){if(Object(u.a)(r)||(r={}),t.castShadows){var a=r.castCommands;Object(u.a)(a)||(a=r.castCommands=[]);var o=r.castShaderProgramId,s=e.length;a.length=s;for(var c=0;c<s;++c)a[c]=IAe(e[c],i,t,n,o,a[c]);r.castShaderProgramId=t.shaderProgram.id}return r},qSe.prototype.isDestroyed=function(){return!1},qSe.prototype.destroy=function(){ZSe(this),this._debugLightFrustum=this._debugLightFrustum&&this._debugLightFrustum.destroy(),this._debugCameraFrustum=this._debugCameraFrustum&&this._debugCameraFrustum.destroy(),this._debugShadowViewCommand=this._debugShadowViewCommand&&this._debugShadowViewCommand.shaderProgram&&this._debugShadowViewCommand.shaderProgram.destroy();for(var e=0;e<this._numberOfCascades;++e)this._debugCascadeFrustums[e]=this._debugCascadeFrustums[e]&&this._debugCascadeFrustums[e].destroy();return rl(this)};var DAe=qSe;function jAe(e){this._viewer=e,this._pointsToCartographic=[],this._waterColor=new uf(.439,.564,.788,0),this._refractColor=new uf(0,0,0,0),this._reflectColor=new uf(.439,.564,.788,0),this._waveWidth=.2,this._flowDirection=90,this._flowSpeed=.7,this.m_spNormalTexture=void 0,this._m_startTime=0,this._reflectCamera=void 0,this._reflectPassState=void 0,this._initialized=!1,this._drawCommand=void 0,this._isVisible=!0;var t=e.scene._context,i=document.createElement("img"),n=this;f.a.fetchImage(y("Assets/Textures/w1-2-grey.png")).then((function(e){i=e,n.m_spNormalTexture=new hj({context:t,width:i.width,height:i.height,source:i,sampler:new tj({wrapS:$D.REPEAT,wrapT:$D.REPEAT,minificationFilter:KD.LINEAR,magnificationFilter:ZD.LINEAR})})}))}Object(O.a)(jAe.prototype,{waterPolygon:{get:function(){return this._waterPolygon},set:function(e){void 0!==e&&void 0!==this._waterPolygon&&this.release(),this._waterPolygon=e}},flowSpeed:{get:function(){return this._flowSpeed},set:function(e){this._flowSpeed=e}},flowDirection:{get:function(){return this._flowDirection},set:function(e){this._flowDirection=e}},waveWidth:{get:function(){return this._waveWidth},set:function(e){this._waveWidth=e}},isVisible:{get:function(){return this._isVisible},set:function(e){this._isVisible=e}}}),jAe.prototype.computeBoundingRectangle=function(){var e;e=this._waterPolygon._polygonHierarchy.positions;var t=K.fromCartesian(e[0]),i=I.toDegrees(t.longitude),n=I.toDegrees(t.latitude),r=I.toDegrees(t.longitude),a=I.toDegrees(t.latitude);this._zFactor=t.height;for(var o=0;o<e.length;o++){var s=K.fromCartesian(e[o]),c=I.toDegrees(s.longitude),l=I.toDegrees(s.latitude),u=new Rt(c,l);this._pointsToCartographic.push(u),c>r&&(r=c),c<i&&(i=c),l>a&&(a=l),l<n&&(n=l)}this._lonMin=i,this._latMin=n,this._waterCenterPos=new z.fromDegrees((i+r)/2,(a+n)/2,this._zFactor)},jAe.prototype.initialize=function(){var e=this._viewer.scene,t=e.context;if(this._reflectCamera=new ose(e),Object(u.a)(this._reflectCamera)||!Object(u.a)(this._reflectPassState)){var i=new hj({context:t,width:512,height:512,pixelFormat:gx.RGBA}),n=new are({context:t,format:nre.DEPTH_COMPONENT16,width:512,height:512}),r=new cj({context:t,colorTextures:[i],depthRenderbuffer:n});this._reflectPassState=new bne(t),this._reflectPassState.viewport=new ln(0,0,512,512),this._reflectPassState.framebuffer=r,this._initialized=!0,this.computeBoundingRectangle()}},jAe.prototype.update=function(e){var t=this._viewer.scene;if(0!==t.camera.workingFrustums.length){this._initialized||this.initialize();var i=t.context;this._fScale=1/(.001*this._waveWidth);var n=Be.IDENTITY,r=new z(this._waterCenterPos.x,this._waterCenterPos.y,this._waterCenterPos.z),a=K.fromCartesian(this._waterCenterPos),o=I.toDegrees(a.longitude),s=I.toDegrees(a.latitude),c=new z.fromDegrees(o,s,0);z.normalize(c,c);var l=new z(0,1,0),u=new z(0,1,0);u=z.cross(l,c,u),z.normalize(u,u),l=z.cross(c,u,l);var h=new be;be.setRow(h,0,u,h),be.setRow(h,1,l,h),be.setRow(h,2,c,h);var d=new be;be.transpose(h,d);var f=new z,p=new z(-r.x,-r.y,-r.z);if(be.multiplyByVector(h,p,f),n=new Be(h[0],h[3],h[6],f.x,h[1],h[4],h[7],f.y,h[2],h[5],h[8],f.z,0,0,0,1),this.invWorldViewMatrix=new Be,Be.multiply(n,e.camera.inverseViewMatrix,this.invWorldViewMatrix),this.modelMatrix=new Be(1,0,0,r.x,0,1,0,r.y,0,0,1,r.z,0,0,0,1),this.modelViewMatrix=new Be,this.modelViewProjection=new Be,this.modelViewMatrix=Be.multiply(e.camera.viewMatrix,this.modelMatrix,this.modelViewMatrix),this.modelViewProjection=Be.multiply(e.camera.workingFrustums[0].projectionMatrix,this.modelViewMatrix,this.modelViewProjection),this._bUpdate=!1,this._flowAngle=this._flowDirection*Math.PI/180,void 0===this._drawCommand){var m=bR.fromCache({context:i,vertexShaderSource:tSe,fragmentShaderSource:eSe}),_=RM.fromCache({depthTest:{enabled:!0},blending:FD.ADDITIVE_BLEND}),g=this;this._uniformMap={u_bgColor:function(){return g._waterColor},u_texCoordOffset:function(){return new Rt(-g._lonMin,-g._latMin)},u_texCoordScale:function(){return new Rt(g._fScale,g._fScale)},u_scale:function(){return new z(3,3,3)},u_camPos:function(){return new z(3,3,3)},u_modelViewProjectionMatrix:function(){return g.modelViewProjection},u_modelViewMatrix:function(){return g.modelViewMatrix},u_clampToGroud:function(){return 0},u_invWorldViewMatrix:function(){return g.invWorldViewMatrix},u_normalMap:function(){return g.m_spNormalTexture},u_refractMap:function(){return g.m_spNormalTexture},u_useRefractTex:function(){return 0},u_reflectMap:function(){return g._reflectPassState.framebuffer.getColorTexture(0)},u_reflection:function(){return 1},u_waterColor:function(){return g._waterColor},u_refractColor:function(){return g._refractColor},u_reflectColor:function(){return g._reflectColor},u_flowDir:function(){return new Rt(.5*Math.sin(g._flowAngle)+.5,.5*Math.cos(g._flowAngle)+.5)}},this._waterGeometry=lT.createGeometry(this._waterPolygon);for(var v=this._waterGeometry.indices,b=this._waterGeometry.attributes.position.values,y=0;y<b.length;y++)y%3==0&&(b[y]=b[y]-r.x),y%3==1&&(b[y]=b[y]-r.y),y%3==2&&(b[y]=b[y]-r.z);for(var w=[],O=0;O<this._pointsToCartographic.length;O++)w.push(this._pointsToCartographic[O].x,this._pointsToCartographic[O].y);var x=new Float64Array(w),E=ZN.createIndexBuffer({context:i,typedArray:new Uint32Array(v),usage:YN.STATIC_DRAW,indexDatatype:Sl.UNSIGNED_INT}),T=ZN.createVertexBuffer({context:i,typedArray:dn.createTypedArray(dn.FLOAT,b),usage:YN.STATIC_DRAW}),C=ZN.createVertexBuffer({context:i,typedArray:dn.createTypedArray(dn.FLOAT,x),usage:YN.STATIC_DRAW}),S=[];S.push({index:0,vertexBuffer:T,componentDatatype:dn.FLOAT,componentsPerAttribute:3,normalize:!1}),S.push({index:1,vertexBuffer:C,componentDatatype:dn.FLOAT,componentsPerAttribute:2,normalize:!1});var A=new tF({context:i,attributes:S,indexBuffer:E});this._drawCommand=new cM({boundingVolume:this._waterGeometry.boundingSphere,primitiveType:yn.TRIANGLES,vertexArray:A,shaderProgram:m,castShadows:!1,receiveShadows:!1,uniformMap:this._uniformMap,renderState:_,pass:lM.OPAQUE})}this._bUpdate=!0}},jAe.prototype.updateReflectTexture=function(e){if(0!==e.camera.workingFrustums.length&&this._bUpdate){var t=e.context;this.modelViewMatrix=Be.multiply(e.camera.viewMatrix,this.modelMatrix,this.modelViewMatrix),this.modelViewProjection=Be.multiply(e.camera.workingFrustums[0].projectionMatrix,this.modelViewMatrix,this.modelViewProjection);var i=new z(this._waterCenterPos.x,this._waterCenterPos.y,this._waterCenterPos.z),n=new z(i.x,i.y,i.z);z.normalize(n,n);var r=new oc.fromPointNormal(i,n),a=new z(n.x,n.y,n.z),o=-z.dot(n,i),s=new Be(-2*a.x*a.x+1,-2*a.x*a.y,-2*a.x*a.z,-2*a.x*o,-2*a.y*a.x,-2*a.y*a.y+1,-2*a.y*a.z,-2*a.y*o,-2*a.z*a.x,-2*a.z*a.y,-2*a.z*a.z+1,-2*a.z*o,0,0,0,1),c=new z;z.clone(e.camera.direction,c);var l=new z,u=new z;z.multiplyByScalar(a,2*z.dot(c,a),u),z.subtract(c,u,l),z.normalize(l,l);var h=new z;z.clone(e.camera.up,h);var d=new z,f=new z,p=z.dot(h,a);z.multiplyByScalar(a,2*p,f),z.add(h,f,d),z.normalize(d,d);var m=new z(-d.x,-d.y,-d.z),_=new z;z.clone(e.camera.position,_);var g=new z(s[0]*_.x+s[4]*_.y+s[8]*_.z+s[12],s[1]*_.x+s[5]*_.y+s[9]*_.z+s[13],s[2]*_.x+s[6]*_.y+s[10]*_.z+s[14]),v=new Be;e.camera.frustum.far=1e8,Be.clone(e.camera.frustum.projectionMatrix,v),this._reflectCamera.direction=l,p<.5&&(this._reflectCamera.up=m),p>=.5&&(this._reflectCamera.up=d),this._reflectCamera.position=g;var b=new Be;Be.inverse(this._reflectCamera.viewMatrix,b),Be.transpose(b,b);var y=new Te(r.normal.x,r.normal.y,r.normal.z,-z.dot(n,i));Be.multiplyByVector(b,y,y);var w=y.w/Math.sqrt(y.x*y.x+y.y*y.y+y.z*y.z),O=new z(y.x,y.y,y.z);z.normalize(O,O);var x=new z(O.x,O.y,O.z),E=new Te;E.x=(Math.asin(x.x)+v[8])/v[0],E.y=(Math.asin(x.y)+v[9])/v[5],E.z=-1,E.w=(1+v[10])/v[14];var T=new Te(x.x,x.y,x.z,w),C=new Te;Te.multiplyByScalar(T,2/Te.dot(T,E),C),v[2]=C.x,v[6]=C.y,v[10]=C.z+1,v[14]=C.w,Be.clone(v,this._reflectCamera.frustum.projectionMatrix);var S=new fX({color:uf.fromBytes(14,33,60,255),depth:1,framebuffer:this._reflectPassState.framebuffer});S.execute(t,this._reflectPassState),this._viewer.scene.renderColorTexture(S,this._reflectPassState,this._reflectCamera)}},jAe.prototype.execute=function(e,t){void 0!==this.m_spNormalTexture&&this._isVisible&&this._bUpdate&&e.draw(this._drawCommand,t)};var MAe=jAe;function RAe(e){this._viewer=e.viewer;var t=this._viewer.scene._context;this._boundingSphere=e.boundingSphere,this._drawCommand=void 0,this.modelViewMatrix=new Be,this.modelViewProjection=new Be,this._waterColor=Object(w.a)(e.waterColor,new uf(0,128/255,128/255)),this.normalTexture=e.normalTexture,this.width=e.width,this.height=e.height,this._flowAngle=Object(w.a)(e.flowAngle*Math.PI/180,0),this._reflectFactor=Object(w.a)(e.reflectFactor,.5),this._speed=Object(w.a)(e.speed,.03),this._waterCenterPos=void 0,this._alpha=1,this._pointsToCartographic=[],this.textureMatrix=new Be(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),this._reflectCamera=new ose(this._viewer.scene);var i=new hj({context:t,width:512,height:512,pixelFormat:gx.RGBA}),n=new are({context:t,format:nre.DEPTH_COMPONENT16,width:512,height:512}),r=new cj({context:t,colorTextures:[i],depthRenderbuffer:n});this._reflectPassState=new bne(t),this._reflectPassState.viewport=new ln(0,0,512,512),this._reflectPassState.framebuffer=r,this._waterPolygon=e.waterPolygon,this.computeWaterBounding(),this.init_waterPolygon(),this._modelMatrix=new Be(1,0,0,this._waterCenterPos.x,0,1,0,this._waterCenterPos.y,0,0,1,this._waterCenterPos.z,0,0,0,1);var a=this;this.removeWaterEventCallback=this._viewer.scene.postRender.addEventListener((function(){a.updateReflectTexture()}))}Object(O.a)(RAe.prototype,{waterPolygon:{get:function(){return this._waterPolygon},set:function(e){void 0!==e&&void 0!==this._waterPolygon&&this.release(),this._waterPolygon=e}},flowAngle:{get:function(){return this._flowAngle},set:function(e){this._flowAngle=e*Math.PI/180}},alpha:{get:function(){return this._alpha},set:function(e){this._alpha=e}},waterColor:{get:function(){return this._waterColor},set:function(e){this._waterColor=e}}}),RAe.prototype.update=function(e){var t=this,i=e.context,n=e.commandList,r=bR.fromCache({context:i,vertexShaderSource:$Ce,fragmentShaderSource:JCe}),a=RM.fromCache({depthTest:{enabled:!0},blending:FD.ALPHA_BLEND});this._uniformMap={u_modelViewMatrix:function(){return i.uniformState.modelView},u_modelMatrix:function(){return t._modelMatrix},normalSampler:function(){return t.normalTexture},alpha:function(){return t._alpha},waterColor:function(){return t._waterColor},sunColor:function(){return new uf(1,1,1)},size:function(){return t.width},distortionScale:function(){return 3},speed:function(){return t._speed},reflectFactor:function(){return t._reflectFactor},mirrorSampler:function(){return t._reflectPassState.framebuffer.getColorTexture(0)},u_flowDir:function(){return new Rt(.5*Math.sin(t._flowAngle)+.5,.5*Math.cos(t._flowAngle)+.5)},textureMatrix:function(){return t.textureMatrix}},t._drawCommand=new cM({boundingVolume:t.waterGeometry._boundingSphere,modelMatrix:t._modelMatrix,primitiveType:yn.TRIANGLES,vertexArray:t._va,shaderProgram:r,castShadows:!1,receiveShadows:!1,uniformMap:this._uniformMap,renderState:a,pass:lM.OPAQUE}),n.push(t._drawCommand)},RAe.prototype.init_waterPolygon=function(){this.waterGeometry=lT.createGeometry(this._waterPolygon);for(var e=this.waterGeometry.indices,t=this.waterGeometry.attributes.position.values,i=this.waterGeometry.attributes.st.values,n=0;n<t.length;n+=3)t[n]=t[n]-this._waterCenterPos.x,t[n+1]=t[n+1]-this._waterCenterPos.y,t[n+2]=t[n+2]-this._waterCenterPos.z;var r=ZN.createIndexBuffer({context:this._viewer.scene._context,typedArray:new Uint16Array(e),usage:YN.STATIC_DRAW,indexDatatype:Sl.UNSIGNED_SHORT}),a=ZN.createVertexBuffer({context:this._viewer.scene._context,typedArray:dn.createTypedArray(dn.FLOAT,t),usage:YN.STATIC_DRAW}),o=ZN.createVertexBuffer({context:this._viewer.scene._context,typedArray:dn.createTypedArray(dn.FLOAT,i),usage:YN.STATIC_DRAW}),s=[];s.push({index:0,enabled:!0,vertexBuffer:a,componentDatatype:dn.FLOAT,componentsPerAttribute:3,normalize:!1}),s.push({index:1,enabled:!0,vertexBuffer:o,componentDatatype:dn.FLOAT,componentsPerAttribute:2,normalize:!1}),this._va=new tF({context:this._viewer.scene._context,attributes:s,indexBuffer:r})},RAe.prototype.computeWaterBounding=function(){var e=this._waterPolygon._polygonHierarchy.positions,t=K.fromCartesian(e[0]),i=I.toDegrees(t.longitude),n=I.toDegrees(t.latitude),r=I.toDegrees(t.longitude),a=I.toDegrees(t.latitude);this._zFactor=t.height;for(var o=0;o<e.length;o++){var s=K.fromCartesian(e[o]),c=I.toDegrees(s.longitude),l=I.toDegrees(s.latitude);this._pointsToCartographic.push(new Rt(c,l)),c>r&&(r=c),c<i&&(i=c),l>a&&(a=l),l<n&&(n=l)}this._waterCenterPos=new z.fromDegrees((i+r)/2,(a+n)/2,this._zFactor)};var LAe=new ln;RAe.prototype.updateDebugMode=function(e,t){var i=t.context,n=t.context.drawingBufferWidth,r=t.context.drawingBufferHeight,a=.3*Math.min(n,r),o=LAe;o.x=n-a,o.y=0,o.width=a,o.height=a;var s=e._debugViewCommand;Object(u.a)(s)||(s=function(e,t){"uniform sampler2D shadowMap_texture; \nvarying vec2 v_textureCoordinates; \nvoid main() \n{ \n    vec4 shadow = texture2D(shadowMap_texture, v_textureCoordinates); \n    gl_FragColor = shadow; \n} \n";var i=t.createViewportQuadCommand("uniform sampler2D shadowMap_texture; \nvarying vec2 v_textureCoordinates; \nvoid main() \n{ \n    vec4 shadow = texture2D(shadowMap_texture, v_textureCoordinates); \n    gl_FragColor = shadow; \n} \n",{uniformMap:{shadowMap_texture:function(){return e._reflectPassState.framebuffer.getColorTexture(0)}}});return i.pass=lM.OVERLAY,i}(e,i),e._debugViewCommand=s),Object(u.a)(s.renderState)&&ln.equals(s.renderState.viewport,o)||(s.renderState=RM.fromCache({viewport:ln.clone(o)})),t.commandList.push(e._debugViewCommand)},RAe.prototype.updateReflectTexture=function(){var e=this._viewer.scene;if(0!==e.camera.workingFrustums.length&&void 0!==e.camera.workingFrustums[0]){var t=e.context;Be.multiply(e.camera.viewMatrix,this._modelMatrix,this.modelViewMatrix),Be.multiply(e.camera.workingFrustums[0].projectionMatrix,this.modelViewMatrix,this.modelViewProjection);var i=new z(this._waterCenterPos.x,this._waterCenterPos.y,this._waterCenterPos.z),n=new z(i.x,i.y,i.z);z.normalize(n,n);var r=new oc.fromPointNormal(i,n),a=new z(n.x,n.y,n.z),o=-z.dot(n,i),s=new Be(-2*a.x*a.x+1,-2*a.x*a.y,-2*a.x*a.z,-2*a.x*o,-2*a.y*a.x,-2*a.y*a.y+1,-2*a.y*a.z,-2*a.y*o,-2*a.z*a.x,-2*a.z*a.y,-2*a.z*a.z+1,-2*a.z*o,0,0,0,1),c=new z;z.clone(e.camera.direction,c);var l=new z,u=new z;z.multiplyByScalar(a,2*z.dot(c,a),u),z.subtract(c,u,l),z.normalize(l,l);var h=new z;z.clone(e.camera.up,h);var d=new z,f=new z,p=z.dot(h,a);z.multiplyByScalar(a,2*p,f),z.add(h,f,d),z.normalize(d,d);var m=new z(-d.x,-d.y,-d.z),_=new z;z.clone(e.camera.position,_);var g=new z(s[0]*_.x+s[4]*_.y+s[8]*_.z+s[12],s[1]*_.x+s[5]*_.y+s[9]*_.z+s[13],s[2]*_.x+s[6]*_.y+s[10]*_.z+s[14]),v=new Be;e.camera.workingFrustums[0].far=1e8,Be.clone(e.camera.workingFrustums[0].projectionMatrix,v),this._reflectCamera.direction=l,p<.5&&(this._reflectCamera.up=m),p>=.5&&(this._reflectCamera.up=d),this._reflectCamera.position=g;var b=new Be;Be.inverse(this._reflectCamera.viewMatrix,b),Be.transpose(b,b);var y=new Te(r.normal.x,r.normal.y,r.normal.z,-z.dot(n,i));Be.multiplyByVector(b,y,y);var w=y.w/Math.sqrt(y.x*y.x+y.y*y.y+y.z*y.z),O=new z(y.x,y.y,y.z);z.normalize(O,O);var x=new z(O.x,O.y,O.z),E=new Te;E.x=(Math.sign(x.x)+v[8])/v[0],E.y=(Math.sign(x.y)+v[9])/v[5],E.z=-1,E.w=(1+v[10])/v[14];var T=new Te(x.x,x.y,x.z,w),C=new Te;Te.multiplyByScalar(T,2/Te.dot(T,E),C),v[2]=C.x,v[6]=C.y,v[10]=C.z+1,v[14]=C.w,Be.clone(v,e.camera.workingFrustums[0].projectionMatrix);var S=new fX({color:uf.fromBytes(14,33,60,255),depth:1,framebuffer:this._reflectPassState.framebuffer});S.execute(t,this._reflectPassState),this._viewer.scene.renderColorTexture(S,this._reflectPassState,this._reflectCamera)}},RAe.prototype.isDestroyed=function(){return!1},RAe.prototype.destroy=function(){return this.removeWaterEventCallback(),rl(this)};var NAe=RAe,FAe="struct czm_combineMaterialStruct\n{\nvec4 pbrBaseColor;\nfloat pbrMetallic;\nfloat pbrRoughness;\nfloat pbrIZbufferPriority;\nfloat pbrPrepareData;\n};\n",kAe="struct czm_lightStruct {\nvec3 positionWC;\nvec3 positionEC;\nvec3 normal;\nvec3 baseColor;\nvec3 diffuseColor;\nvec3 specularColor;\nfloat roughness;\nfloat alpha;\nvec3 lightColor;\nvec3 lightPosition;\nvec4 lightDirection;\nvec4 lightFalloff;\n};\n",BAe="1.54";var zAe=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)};zAe.mapLinear=function(e,t,i,n,r){return n+(e-t)*(r-n)/(i-t)},zAe.getIntersectionByRayAndPlane=function(e,t,i){var n=z.dot(i,e.direction);if(0!==n){var r=z.dot(i,z.subtract(t,e.origin,new z))/n;return r>=0?z.add(e.origin,z.multiplyByScalar(e.direction,r,new z),new z):void 0}},zAe.setBaseUrl=function(e){try{MOTOR_BASE_URL&&(window.CESIUM_BASE_URL=MOTOR_BASE_URL)}catch(s){if(null!=e)window.CESIUM_BASE_URL=e,window.MOTOR_BASE_URL=e;else for(var t=/((?:.*\/)|^)motor[\w-]*\.js(?:\W|$)/i,i=document.getElementsByTagName("script"),n=0,r=i.length;n<r;n++){var a=i[n].getAttribute("src"),o=t.exec(a);if(null!==o)return window.CESIUM_BASE_URL=o[1],void(window.MOTOR_BASE_URL=o[1])}}};var UAe=zAe,VAe=(n(128),n(162),n(73),n(74),n(20),n(115),n(116),n(21),n(95),n(14),n(96),n(97),n(138),n(54),n(55),n(100),n(58),n(59),n(36),n(50),n(37),n(77),n(260),n(46),n(39),{rotateLeft:"rotateLeft",rotateRight:"rotateRight",rotateUp:"rotateUp",rotateDown:"rotateDown"});Object.freeze(VAe);function HAe(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var GAe={rotateLeft:{flag:!1,name:"左转"},rotateRight:{flag:!1,name:"右转"},rotateUp:{flag:!1,name:"上转"},rotateDown:{flag:!1,name:"下转"}},qAe=function(){function e(t){var i=this;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),!u.a(t))throw new h.a("options不存在");if(!u.a(t.scene))throw new h.a("options.scene不存在");this.scene=t.scene,this.clock=w.a(t.clock,void 0),u.a(t.origin)?this._origin=t.origin:u.a(t.globalMatrix)?(this.globalMatrix=t.globalMatrix,this._origin=Be.getTranslation(t.globalMatrix,new z)):u.a(t.model)&&(this._model=t.model,this._model.ready?this._origin=Be.multiplyByPoint(t.model.modelMatrix,t.model.boundingSphere.center,new z):this._model.readyPromise.then((function(e){i._origin=Be.multiplyByPoint(e.modelMatrix,e.boundingSphere.center,new z)}))),this.maximumPitch=t.maximumPitch,this.minimumPitch=t.minimumPitch,this.defaultHeading=w.a(t.defaultHeading,50),this.defaultPitch=w.a(t.defaultPitch,-40),this.defaultRange=w.a(t.defaultRange,100),this.maximumZoomDistance=w.a(t.maximumZoomDistance,this.defaultRange),this.defaultCameraPose,this.isResetCamera=!1,this._enableInputs=!0,this._invertZoom=!1,this._leftRotate=!1,this.lookAtCenter=new z,this.viewchanged=!1,this.moveDirection=new z,this.moveToMousePosition=w.a(t.moveToMousePosition,!0),this.panning=!1,this.mousePosition=this.startMousePosition=new Rt,this.alwaysAroundSceneCenter=w.a(t.alwaysAroundSceneCenter,!1),this.debug=w.a(t.debug,!1),this.debug&&(this.points=this.scene.primitives.add(new Tq),this.point=this.points.add({position:this.origin,color:uf.RED,pixelSize:10})),this.init()}var t,i,n;return t=e,(i=[{key:"init",value:function(){var e=this,t=this.scene;t.pickTranslucentDepth=!0;var i=t.screenSpaceCameraController;i.zoomEventTypes=[sse.PINCH],i.ellipsoid=ae.UNIT_SPHERE,i.enableTilt=!1,i.enableLook=!1,i.enableRotate=!1,i.inertiaSpin=0,i.enableCollisionDetection=!1;var n=t.canvas,r=this.handler=new aA(n);this.setRotateInput(!1),this.middledown=function(t){if(e._enableInputs){var i=new Rt(t.position.x,t.position.y);e.startMousePosition=z.clone(i),e.panning=!0}},r.setInputAction(this.middledown,TS.MIDDLE_DOWN),this.mousemove=function(t){if(e._enableInputs&&e.startMousePosition&&!e.pinchStart){var i=e.scene,n=i.camera,r=new Rt(t.endPosition.x,t.endPosition.y),a=e.startMousePosition,o=(r.x-a.x)/i.canvas.clientHeight,s=-(r.y-a.y)/i.canvas.clientHeight;if(e.rotating&&(n.rotateLeft(I.toRadians(180*o)),n.rotateUp(I.toRadians(180*s)),n.setView({destination:n.positionWC,orientation:{heading:n.heading,pitch:n.pitch,roll:0}}),e.startMousePosition=z.clone(r)),e.panning){var c=z.distance(n.positionWC,e.lookAtCenter);n.moveDown(s*c),n.moveLeft(o*c),e.startMousePosition=z.clone(r),n.changed.raiseEvent()}e.maximumPitch&&n.pitch>I.toRadians(e.maximumPitch)&&n.lookAt(e.lookAtCenter,new xO(n.heading,I.toRadians(e.maximumPitch-.1),z.distance(e.lookAtCenter,n.positionWC))),e.minimumPitch&&n.pitch<I.toRadians(e.minimumPitch)&&n.lookAt(e.lookAtCenter,new xO(n.heading,I.toRadians(e.minimumPitch+.1),z.distance(e.lookAtCenter,n.positionWC)))}},r.setInputAction(this.mousemove,TS.MOUSE_MOVE),this.middleup=function(t){e._enableInputs&&(e.panning=!1,Ri.isInternetExplorer()||e.setLookAtCenter())},r.setInputAction(this.middleup,TS.MIDDLE_UP),this.wheel=function(t){e.zoom(t)},r.setInputAction(this.wheel,TS.WHEEL),this.handler.setInputAction((function(t){e.pinchStart=!0}),TS.PINCH_START),this.handler.setInputAction((function(t){e.pinchStart=!1}),TS.PINCH_END),this.tickRemoveCallback=this.clock.onTick.addEventListener((function(){if(e._enableInputs)for(var i in GAe)GAe[i].flag&&(e.motionAmount?t.camera[i](e.motionAmount*Math.PI/180):t.camera[i](Math.PI/360))}))}},{key:"rotatedown",value:function(e){if(this._enableInputs){var t=new Rt(e.position.x,e.position.y);this.setLookAtCenter({windowPosition:t}),this.startMousePosition=z.clone(t),this.rotating=!0}}},{key:"rotateup",value:function(e){this._enableInputs&&(this.rotating=!1)}},{key:"zoomIn",value:function(e){this.zoom(e)}},{key:"zoomOut",value:function(e){this.zoom(-e)}},{key:"zoom",value:function(e){if(this._enableInputs){this.deltaY=e,this._invertZoom&&(this.deltaY=-this.deltaY);var t=this.scene.camera;if(this.moveToMousePosition){var i=this.scene.screenSpaceCameraController._aggregator.currentMousePosition;if(!i.equals(this.currentMousePosition)){this.currentMousePosition=i.clone(),this.setLookAtCenter({windowPosition:i});var n=new z;Be.multiplyByPoint(t.inverseTransform,this.lookAtCenter,n),z.subtract(n,t.position,this.moveDirection),z.normalize(this.moveDirection,this.moveDirection)}}else this.moveDirection=t.direction;var r=z.distance(t.positionWC,this.lookAtCenter);if(z.distance(t.positionWC,this._origin),this.deltaY>0)t.move(z.normalize(this.moveDirection,this.moveDirection),.1*r+.1);else{var a=this.moveDirection.clone();z.negate(a,a),t.move(z.normalize(a,a),.1*r+.1)}if(z.distance(t.positionWC,this._origin)>this.maximumZoomDistance)if(this.deltaY>0)t.move(z.normalize(this.moveDirection,this.moveDirection),.1*-r-.1);else{var o=this.moveDirection.clone();z.negate(o,o),t.move(z.normalize(o,o),.1*-r-.1)}}}},{key:"setRotateInput",value:function(e){var t=this.handler;e?(t.removeInputAction(TS.RIGHT_DOWN),t.setInputAction(this.rotatedown.bind(this),TS.LEFT_DOWN),t.removeInputAction(TS.RIGHT_UP),t.setInputAction(this.rotateup.bind(this),TS.LEFT_UP)):(t.removeInputAction(TS.LEFT_DOWN),t.setInputAction(this.rotatedown.bind(this),TS.RIGHT_DOWN),t.removeInputAction(TS.LEFT_UP),t.setInputAction(this.rotateup.bind(this),TS.RIGHT_UP))}},{key:"resetCamera",value:function(e){var t=this,i=this.scene;this.recomputeDefaultCameraPose(),this.lookAtCenter=this.defaultCameraPose.boundingSphere.center,i.camera.flyToBoundingSphere(this.defaultCameraPose.boundingSphere,{offset:this.defaultCameraPose.offset,duration:.5,complete:function(){i.camera.lookAt(t.defaultCameraPose.boundingSphere.center,t.defaultCameraPose.offset),e&&e()}})}},{key:"recomputeDefaultCameraPose",value:function(){var e;e=u.a(this.model)?2.5*this.model.boundingSphere.radius:this.defaultRange;var t=I.toRadians(this.defaultHeading),i=I.toRadians(this.defaultPitch),n=this.origin;this.defaultCameraPose={boundingSphere:new St(n,e),offset:new xO(t,i,e)}}},{key:"setMotion",value:function(e,t){GAe[e].flag=!0,this.motionAmount=t}},{key:"removeMotion",value:function(e){GAe[e].flag=!1}},{key:"setLookAtCenter",value:function(e){var t=e||{},i=t.windowPosition,n=t.pickTerrain,r=void 0===n||n;if(!this.alwaysAroundSceneCenter){var a,o=this.scene;u.a(i)||(i=new Rt(o.canvas.clientWidth/2,o.canvas.clientHeight/2));var s=o.pickPosition(i),c=o.camera.pickEllipsoid(i,o.globe.ellipsoid);if(u.a(s)?a=this.lookAtCenter=s:r&&u.a(c)?a=this.lookAtCenter=c:this.lookAtCenter.equals(z.ZERO)||(a=this.lookAtCenter),this.debug&&(this.point.position=a),u.a(a)){var l=xa.eastNorthUpToFixedFrame(a);o.camera.lookAtTransform(l)}}}},{key:"invertZoom",value:function(){this._invertZoom=!this._invertZoom}},{key:"isDestroyed",value:function(){return!1}},{key:"destroy",value:function(){u.a(this.cameraChangedRemoveCallback)&&this.cameraChangedRemoveCallback(),u.a(this.cameraMoveEndRemoveCallback)&&this.cameraMoveEndRemoveCallback(),u.a(this.tickRemoveCallback)&&this.tickRemoveCallback(),u.a(this.points)&&this.points.removeAll();var e=this.scene,t=e.camera;this.handler.destroy(),e.pickTranslucentDepth=!1,t.constrainedAxis=void 0;var i=e.screenSpaceCameraController;return i.zoomEventTypes=[sse.WHEEL,sse.PINCH],i.ellipsoid=void 0,i.enableTilt=!0,i.enableLook=!0,i.enableRotate=!0,i.enableZoom=!0,i.inertiaSpin=.9,i.enableCollisionDetection=!0,t.lookAtTransform(Be.IDENTITY),rl(this)}},{key:"origin",get:function(){return this._origin},set:function(e){this._origin=e}},{key:"model",get:function(){return this._model},set:function(e){var t=this;this._model=e,this._model.ready?this.origin=this._model.boundingSphere.center:this._model.readyPromise.then((function(e){t.origin=e.boundingSphere.center}))}},{key:"enableInputs",get:function(){return this._enableInputs},set:function(e){this._enableInputs=e,e?(this.scene.pickTranslucentDepth=!0,Ri.isInternetExplorer()||this.setLookAtCenter()):(this.scene.camera.lookAtTransform(Be.IDENTITY),this.scene.pickTranslucentDepth=!1,this.startMousePosition=void 0)}}])&&HAe(t.prototype,i),n&&HAe(t,n),e}(),WAe={CIM:0,BIM:1};Object.freeze(WAe);var YAe=WAe,XAe={NAV_FREE_MOUSE:0,NAV_FREE_KEY:1,NAV_WALK:2};Object.freeze(XAe);var ZAe=XAe,QAe={CLASSIC:0,MOTOR:1};Object.freeze(QAe);var KAe=QAe;function JAe(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function $Ae(e){u.a(e._marqueeCanvas)||(e._marqueeCanvas=document.createElement("canvas"),e._viewer.container.appendChild(e._marqueeCanvas),e._marqueeCanvas.width=e._viewer.container.clientWidth,e._marqueeCanvas.height=e._viewer.container.clientHeight,e._marqueeCanvas.style.margin="0",e._marqueeCanvas.style.padding="0",e._marqueeCanvas.style.overflow="hidden",e._marqueeCanvas.style.top=e._viewer.container.offsetTop+"px",e._marqueeCanvas.style.left=e._viewer.container.offsetLeft+"px",e._marqueeCanvas.style.position="absolute",e._marqueeCanvas.style.zIndex="10",e._marqueeCanvas.getContext("2d").fillStyle="rgba(255, 255, 255, 0)")}function ePe(e){e._marqueeCanvas.addEventListener("mousedown",e._mouseDownHandler)}function tPe(e){this.marqueeStart.raiseEvent(),this._mouseDownPoint=new Rt(e.offsetX,e.offsetY),this._marqueeCanvas.addEventListener("mouseup",this._mouseUpHandler),this._marqueeCanvas.addEventListener("mousemove",this._mouseMoveHandler),this._marqueeCanvas.addEventListener("mouseout",this._mouseOutHandler)}function iPe(e){oPe(this)}function nPe(e){var t=new Rt(e.offsetX,e.offsetY),i=Rt.subtract(t,this._mouseDownPoint,new Rt),n=new Rt(1,0),r=new Rt(0,1),a=Rt.dot(i,n),o=Rt.dot(i,r);!function(e,t,i,n,r){var a=e._marqueeCanvas.getContext("2d");a.clearRect(0,0,e._marqueeCanvas.width,e._marqueeCanvas.height),a.strokeStyle="#00ff00",a.strokeRect(t,i,n,r)}(this,a>0?this._mouseDownPoint.x:t.x,o>0?this._mouseDownPoint.y:t.y,Math.abs(a),Math.abs(o))}function rPe(e){var t=new Rt(e.offsetX,e.offsetY);if(u.a(this._mouseDownPoint)&&!t.equals(this._mouseDownPoint)){var i=Rt.subtract(t,this._mouseDownPoint,new Rt),n=new Rt(1,0),r=new Rt(0,1),a=Rt.dot(i,n),o=Rt.dot(i,r),s=Rt.multiplyByScalar(n,a,new Rt),c=Rt.multiplyByScalar(r,o,new Rt),l=Rt.add(this._mouseDownPoint,s,new Rt),h=Rt.add(this._mouseDownPoint,c,new Rt),d=Rt.distance(t,this._mouseDownPoint),f=Rt.normalize(i,new Rt);f=Rt.multiplyByScalar(f,d/2,new Rt);var p=Rt.add(this._mouseDownPoint,f,new Rt),m=this._viewer.scene.pickPositionWorldCoordinates(p);if(u.a(m)){var _=aPe(this,l,m),g=aPe(this,h,m),v=aPe(this,this._mouseDownPoint,m);if(u.a(_)&&u.a(v)){var b=z.subtract(v,_,new z),y=z.magnitude(b),w=z.subtract(v,g,new z),O=z.magnitude(w),x=(y=Math.max(y,O/this._viewer.scene.camera.frustum.aspectRatio))/2/Math.tan(this._viewer.scene.camera.frustum.fov/2);this._viewer.scene.camera.lookAt(m,new xO(this._viewer.scene.camera.heading,this._viewer.scene.camera.pitch,x)),this.isLookAtCenter||this._viewer.scene.camera.lookAtTransform(Be.IDENTITY)}}}this.marqueeStop.raiseEvent(),this.duringMarquee=!1,oPe(this)}function aPe(e,t,i){var n=i,r=e._viewer.scene.camera.direction;return UAe.getIntersectionByRayAndPlane(e._viewer.scene.camera.getPickRay(t),n,r)}function oPe(e){!function(e){e._marqueeCanvas&&(e._marqueeCanvas.removeEventListener("mousedown",e._mouseDownHandler),e._marqueeCanvas.removeEventListener("mouseup",e._mouseUpHandler),e._marqueeCanvas.removeEventListener("mousemove",e._mouseMoveHandler),e._marqueeCanvas.removeEventListener("mouseout",e._mouseOutHandler))}(e),e._mouseDownPoint=void 0,e._marqueeCanvas&&(e._viewer.container.removeChild(e._marqueeCanvas),e._marqueeCanvas=void 0)}var sPe=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._viewer=t.viewer.cesiumViewer,this.isLookAtCenter=w.a(t.isLookAtCenter,!0),this._mouseDownPoint=void 0,this._marqueeCanvas=void 0,this._mouseDownHandler=tPe.bind(this),this._mouseUpHandler=rPe.bind(this),this._mouseMoveHandler=nPe.bind(this),this._mouseOutHandler=iPe.bind(this),this.marqueeStart=new $o.a,this.marqueeStop=new $o.a,this.duringMarquee=!1}var t,i,n;return t=e,(i=[{key:"startMarquee",value:function(){this.duringMarquee||(this.duringMarquee=!0,this._mouseDownPoint=void 0,$Ae(this),ePe(this))}},{key:"isDestroyed",value:function(){return!1}},{key:"destroy",value:function(){return oPe(this),this._viewer=void 0,this._onKeyDownHandler=void 0,this._mouseDownHandler=void 0,this._mouseUpHandler=void 0,this._mouseMoveHandler=void 0,this._mouseOutHandler=void 0,rl(this)}}])&&JAe(t.prototype,i),n&&JAe(t,n),e}();function cPe(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function lPe(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=uPe(e),n=e._viewer.scene.camera;t||(e._headingPitchRange.heading=n.heading,e._headingPitchRange.pitch=n.pitch,e._headingPitchRange.range=e._currentRange),n.lookAt(i,e._headingPitchRange)}function uPe(e){return Be.getTranslation(e._target.modelMatrix,e._targetPosition)}function hPe(e,t,i){z.normalize(t,e._moveVector),z.multiplyByScalar(e._moveVector,i,e._moveVector);var n=Be.fromTranslation(e._moveVector);Be.multiply(n,e._target.modelMatrix,e._target.modelMatrix),lPe(e)}function dPe(e){var t=new Rt(e.position.x,e.position.y);this._startMousePosition=z.clone(t),this._rotating=!0}function fPe(e){this._rotating=!1}function pPe(e){var t=this._viewer.scene,i=t.camera,n=new Rt(e.endPosition.x,e.endPosition.y),r=this._startMousePosition;if(u.a(r)){var a=(n.x-r.x)/t.canvas.clientWidth,o=-(n.y-r.y)/t.canvas.clientHeight;this._rotating&&(i.rotateUp(I.toRadians(360*o)),i.rotateLeft(I.toRadians(360*a)),this._startMousePosition=z.clone(n))}}function mPe(e){var t=this._viewer.scene.camera;if(e>0){var i=z.distance(t.positionWC,uPe(this))-.01;i>1?(t.moveForward(1),this._currentRange-=1):(t.moveForward(i),this._currentRange-=i)}else e<0&&(t.moveBackward(1),this._currentRange+=1)}function _Pe(e){switch(e.keyCode){case 38:case 87:0===this._moving&&this.onMoveStart.raiseEvent(),this._moveForward||this._moving++,this._moveForward=!0;break;case 37:case 65:0===this._moving&&this.onMoveStart.raiseEvent(),this._moveLeft||this._moving++,this._moveLeft=!0;break;case 40:case 83:0===this._moving&&this.onMoveStart.raiseEvent(),this._moveBackward||this._moving++,this._moveBackward=!0;break;case 39:case 68:0===this._moving&&this.onMoveStart.raiseEvent(),this._moveRight||this._moving++,this._moveRight=!0;break;case 82:this._moveUp||this._moving++,this._moveUp=!0;break;case 70:this._moveDown||this._moving++,this._moveDown=!0}}function gPe(e){switch(console.log(this._moving),e.keyCode){case 38:case 87:this._moveForward=!1,this._moving--,0===this._moving&&this.onMoveEnd.raiseEvent();break;case 37:case 65:this._moveLeft=!1,this._moving--,0===this._moving&&this.onMoveEnd.raiseEvent();break;case 40:case 83:this._moveBackward=!1,this._moving--,0===this._moving&&this.onMoveEnd.raiseEvent();break;case 39:case 68:this._moveRight=!1,this._moving--,0===this._moving&&this.onMoveEnd.raiseEvent();break;case 82:this._moveUp=!1,this._moving--,0===this._moving&&this.onMoveEnd.raiseEvent();break;case 70:this._moveDown=!1,this._moving--,0===this._moving&&this.onMoveEnd.raiseEvent()}}function vPe(e,t,i){if(e._isCollision){var n=uPe(e),r=new Ts(n,t),a=e._viewer.scene.pickFromRay(r,[e._target]);if(u.a(a)&&u.a(a.object)&&u.a(a.position)){var o=a.position,s=z.subtract(o,n,new z),c=z.magnitude(s);if(c>.2){var l=c-.2;return i<=l?i:l}return 0}return i}return i}var bPe=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._viewer=t.viewer,this._target=t.target,this._camera=this._viewer.scene.camera;var i=this._camera,n=i.heading,r=i.pitch;this._defaultHeading=w.a(t.defaultHeading,n),this._defaultPitch=w.a(t.defaultPitch,r),this._defaultRange=w.a(t.defaultRange,.01),this._domElement=this._viewer.scene.canvas,this._handler=new aA(this._domElement),this._enabled=!1,this._movementSpeed=1,this._autoForward=!1,this._heightSpeed=!1,this._heightCoef=1,this._heightMin=0,this._heightMax=1,this._isGravitative=!1,this._gravitationalAcceleration=10,this._isCollision=!1,this._autoSpeedFactor=0,this._moveForward=!1,this._moveBackward=!1,this._moveLeft=!1,this._moveRight=!1,this._moveUp=!1,this._moveDown=!1,this._mouseDragOn=!1,this._verticalSpeed=0,this._startMousePosition=void 0,this._rotating=!1,this._targetPosition=new z,this._moveVector=new z,this._onKeyDown=_Pe.bind(this),this._onKeyUp=gPe.bind(this),this._rotatedown=dPe.bind(this),this._rotateup=fPe.bind(this),this._mousemove=pPe.bind(this),this._wheel=mPe.bind(this),function(e){e._handler.setInputAction(e._rotatedown,TS.LEFT_DOWN),e._handler.setInputAction(e._rotateup,TS.LEFT_UP),e._handler.setInputAction(e._mousemove,TS.MOUSE_MOVE),e._handler.setInputAction(e._wheel,TS.WHEEL),document.addEventListener("keydown",e._onKeyDown),document.addEventListener("keyup",e._onKeyUp)}(this),this._moving=0,this.onMoveStart=new $o.a,this.onMoveEnd=new $o.a,this.onLooking=new $o.a,this.onLookStart=new $o.a,this.onLookEnd=new $o.a,this._currentRange=this._defaultRange,this._headingPitchRange=new xO(this._defaultHeading,this._defaultPitch,this._defaultRange),this._surfaceNormal=new z,this._cameraRight=new z,this._cameraHorizontalDirection=new z,this._moveDirection=new z,lPe(this,!0)}var t,i,n;return t=e,(i=[{key:"update",value:function(e){if(!1!==this._enabled){if(this._heightSpeed){var t=I.clamp(this._camera.position.y,this._heightMin,this._heightMax)-this._heightMin;this._autoSpeedFactor=e*(t*this._heightCoef)}else this._autoSpeedFactor=0;var i=e*this._movementSpeed,n=this._viewer.scene.globe.ellipsoid.geodeticSurfaceNormalCartographic(this._camera.positionCartographic,this._surfaceNormal),r=z.cross(n,this._camera.directionWC,this._cameraRight),a=z.cross(n,r,this._cameraHorizontalDirection);if(this._target.modelMatrix=xa.headingPitchRollToFixedFrame(this._targetPosition,new Rr(this._camera.heading,0,0)),(this._moveForward||this._autoForward&&!this._moveBackward)&&hPe(this,a,-vPe(this,z.negate(a,this._moveDirection),i+this._autoSpeedFactor)),this._moveBackward&&hPe(this,a,vPe(this,a,i)),this._moveLeft&&hPe(this,r,vPe(this,z.negate(r,this._moveDirection),i)),this._moveRight&&hPe(this,r,-vPe(this,r,i)),this._isGravitative){var o=uPe(this),s=new Ts(o,z.negate(n,new z)),c=this._viewer.scene.pickFromRay(s,[this._target]);if(u.a(c)&&u.a(c.object)&&u.a(c.position)){var l=c.position,h=z.subtract(l,o,new z),d=z.magnitude(h),f=1,p=0;if(d>1.8?(p=d-1.8,f=-1):d<1.6&&(p=1.6-d),p>0){var m=this._verticalSpeed,_=m*e+.5*this._gravitationalAcceleration*e*e;_>=p?(_=p,this._verticalSpeed=0):this._verticalSpeed=m+this._gravitationalAcceleration*e,hPe(this,n,f*_)}else this._verticalSpeed=0}}else this._moveUp&&hPe(this,n,i),this._moveDown&&hPe(this,n,-i)}}},{key:"destroy",value:function(){this.enabled=!1,this._handler.removeInputAction(this._rotatedown,TS.LEFT_DOWN),this._handler.removeInputAction(this._rotateup,TS.LEFT_UP),this._handler.removeInputAction(this._mousemove,TS.MOUSE_MOVE),this._handler.removeInputAction(this._wheel,TS.WHEEL),this._handler.destroy(),document.removeEventListener("keydown",this._onKeyDown),document.removeEventListener("keyup",this._onKeyUp),this._viewer=void 0,this._target=void 0,this._camera=void 0,this._domElement=void 0,this._handler=void 0,this._onKeyDown=void 0,this._onKeyUp=void 0,this._rotatedown=void 0,this._rotateup=void 0,this._mousemove=void 0,this._wheel=void 0}},{key:"enabled",get:function(){return this._enabled},set:function(e){this._enabled=e}},{key:"movementSpeed",get:function(){return this._movementSpeed},set:function(e){this._movementSpeed=e}},{key:"isGravitative",get:function(){return this._isGravitative},set:function(e){this._isGravitative=e}},{key:"isCollision",get:function(){return this._isCollision},set:function(e){this._isCollision=e}},{key:"gravitationalAcceleration",get:function(){return this._gravitationalAcceleration},set:function(e){this._gravitationalAcceleration=e}},{key:"autoForward",get:function(){return this._autoForward},set:function(e){this._autoForward=e}},{key:"target",get:function(){return this._target},set:function(e){this._target=e,this._target.modelMatrix=xa.eastNorthUpToFixedFrame(this._camera.positionWC)}}])&&cPe(t.prototype,i),n&&cPe(t,n),e}();function yPe(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var wPe=new be,OPe=(new Be,new z(0,0,1.7)),xPe=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),!u.a(t.avatar))throw new h.a("options.viewer");if(this._motorViewer=t.viewer,this._viewer=t.viewer.cesiumViewer,!u.a(t.avatar))throw new h.a("options.avatar未定义");this.object=t.avatar,u.a(t.avatarHeight)?this._offset=new z(0,0,t.avatarHeight):u.a(this.object.boundingSphere)?this._offset=new z(0,0,2*this.object.boundingSphere.radius):this._offset=OPe,this._firstPersonControl=w.a(t.firstPersonControl,!1),this._firstPersonControlHeading=w.a(t.firstPersonControlHeading,0),this._firstPersonControlPitch=w.a(t.firstPersonControlPitch,-Math.PI/8),this._firstPersonControlRange=w.a(t.firstPersonControlRange,2*this.object.boundingSphere.radius),this._headingPitchRange=new xO(this._firstPersonControlHeading,this._firstPersonControlPitch,this._firstPersonControlRange),this._forwardVector=w.a(t.forwardVector,new z(0,1,0)),this._objectPosition=Be.multiplyByPoint(this.object.modelMatrix,this._offset,new z),this._objectDirection=Be.multiplyByPointAsVector(this.object.modelMatrix,this._forwardVector,new z),this._currentEllipsoid=this._viewer.scene.globe.ellipsoid,this._surfaceNormal=this._currentEllipsoid.geodeticSurfaceNormal(this._objectPosition,new z),this._objectRight=z.cross(this._surfaceNormal,this._objectDirection,new Be),this._enabled=!0,this._firstPersonControl&&(this._motorViewer.controller.enableInputs=!1,TPe(this)),this._movementSpeed=1,this._autoForward=!1,this._heightSpeed=!1,this._heightCoef=1,this._heightMin=0,this._heightMax=1,this._isGravitative=!0,this._gravitationalAcceleration=10,this._isCollision=!0,this._autoSpeedFactor=0,this._moveForward=!1,this._moveBackward=!1,this._moveLeft=!1,this._moveRight=!1,this._moveUp=!1,this._moveDown=!1,this._mouseDragOn=!1,this._verticalSpeed=0,this._moveDirection=new z,this._moveVector=new z,this._onKeyDown=SPe.bind(this),this._onKeyUp=APe.bind(this),function(e){document.addEventListener("keydown",e._onKeyDown),document.addEventListener("keyup",e._onKeyUp)}(this),this._moving=0,this.onMoveStart=new $o.a,this.onMoveEnd=new $o.a,this._looking=0,this.lookingSpeed=5,this.onLookStart=new $o.a,this.onLookEnd=new $o.a,this.onMoveForwardStart=new $o.a,this.onMoveBackwardStart=new $o.a,this.onMoveRightStart=new $o.a,this.onMoveLeftStart=new $o.a,this.onLookLeftStart=new $o.a,this.onLookRightStart=new $o.a,this.onMoveForwardEnd=new $o.a,this.onMoveBackwardEnd=new $o.a,this.onMoveLeftEnd=new $o.a,this.onMoveRightEnd=new $o.a,this.onLookLeftEnd=new $o.a,this.onLookRightEnd=new $o.a}var t,i,n;return t=e,(i=[{key:"update",value:function(e){if(!1!==this._enabled){if(this._heightSpeed){var t=I.clamp(this._camera.position.y,this._heightMin,this._heightMax)-this._heightMin;this._autoSpeedFactor=e*(t*this._heightCoef)}else this._autoSpeedFactor=0;var i=e*this._movementSpeed/2;this._lookingRight?(be.fromRotationZ(-Math.PI/180*this.lookingSpeed,wPe),Be.multiplyByMatrix3(this.object.modelMatrix,wPe,this.object.modelMatrix)):this._lookingLeft&&(be.fromRotationZ(Math.PI/180*this.lookingSpeed,wPe),Be.multiplyByMatrix3(this.object.modelMatrix,wPe,this.object.modelMatrix)),Be.multiplyByPoint(this.object.modelMatrix,this._offset,this._objectPosition);var n=this._currentEllipsoid.geodeticSurfaceNormal(this._objectPosition,this._surfaceNormal);Be.multiplyByPointAsVector(this.object.modelMatrix,new z(0,1,0),this._objectDirection);var r=z.cross(n,this._objectDirection,this._objectRight),a=0;if(this._moveForward&&(a=PPe(this,this._objectDirection,i),CPe(this,this._objectDirection,a)),this._moveBackward&&(a=PPe(this,z.negate(this._objectDirection,this._moveDirection),i),CPe(this,this._objectDirection,-a)),this._moveLeft&&CPe(this,r,(a=PPe(this,z.negate(r,this._moveDirection),i))/5),this._moveRight&&CPe(this,r,-(a=PPe(this,r,i))/5),this._isGravitative){var o=this._objectPosition,s=new Ts(o,z.negate(n,new z)),c=this._viewer.scene.pickFromRay(s,[this.object]);if(u.a(c)&&u.a(c.object)&&u.a(c.position)){var l=c.position,h=z.subtract(l,this._objectPosition,new z),d=z.magnitude(h),f=1,p=0;if(d>1.8*this._offset.z/1.7?(p=d-1.8*this._offset.z/1.7,f=-1):d<this._offset.z&&(p=this._offset.z-d),p>0){var m=this._verticalSpeed,_=m*e+.5*this._gravitationalAcceleration*e*e;_>=p?(_=p,this._verticalSpeed=0):this._verticalSpeed=m+this._gravitationalAcceleration*e,CPe(this,n,f*_)}else this._verticalSpeed=0}}else this._moveUp&&CPe(this,n,i),this._moveDown&&CPe(this,n,-i);this._firstPersonControl&&TPe(this)}}},{key:"destroy",value:function(){return this.enabled=!1,document.removeEventListener("keydown",this._onKeyDown),document.removeEventListener("keyup",this._onKeyUp),rl(this)}},{key:"isDestroyed",value:function(){return!1}},{key:"enabled",get:function(){return this._enabled},set:function(e){this._enabled=e}},{key:"enableFirstPersonControl",get:function(){return this._firstPersonControl},set:function(e){this._motorViewer.controller.enableInputs=!e,this._firstPersonControl=e}},{key:"movementSpeed",get:function(){return this._movementSpeed},set:function(e){this._movementSpeed=e}},{key:"isGravitative",get:function(){return this._isGravitative},set:function(e){this._isGravitative=e}},{key:"isCollision",get:function(){return this._isCollision},set:function(e){this._isCollision=e}},{key:"gravitationalAcceleration",get:function(){return this._gravitationalAcceleration},set:function(e){this._gravitationalAcceleration=e}},{key:"autoForward",get:function(){return this._autoForward},set:function(e){this._autoForward=e}},{key:"pitch",get:function(){return this._firstPersonControlPitch},set:function(e){this._firstPersonControlPitch=e,this._headingPitchRange.pitch=e}},{key:"range",get:function(){return this._firstPersonControlRange},set:function(e){this._firstPersonControlRange=e,this._headingPitchRange.range=e}}])&&yPe(t.prototype,i),n&&yPe(t,n),e}(),EPe=(new Be,new Rr);function TPe(e){xa.fixedFrameToHeadingPitchRoll(e.object.modelMatrix,e._currentEllipsoid,void 0,EPe),e._headingPitchRange.heading=EPe.heading,e._viewer.scene.camera.lookAt(e._objectPosition,e._headingPitchRange)}function CPe(e,t,i){z.normalize(t,e._moveVector),z.multiplyByScalar(e._moveVector,i,e._moveVector);var n=Be.fromTranslation(e._moveVector);Be.multiply(n,e.object.modelMatrix,e.object.modelMatrix)}function SPe(e){switch(e.keyCode){case 38:case 87:0===this._moving&&this.onMoveStart.raiseEvent(),this._moveForward||(this._moving++,this.onMoveForwardStart.raiseEvent()),this._moveForward=!0;break;case 37:case 65:0===this._moving&&this.onMoveStart.raiseEvent(),this._moveLeft||(this._moving++,this.onMoveLeftStart.raiseEvent()),this._moveLeft=!0;break;case 40:case 83:0===this._moving&&this.onMoveStart.raiseEvent(),this._moveBackward||(this._moving++,this.onMoveBackwardStart.raiseEvent()),this._moveBackward=!0;break;case 39:case 68:0===this._moving&&this.onMoveStart.raiseEvent(),this._moveRight||(this._moving++,this.onMoveRightStart.raiseEvent()),this._moveRight=!0;break;case 82:this._moveUp||this._moving++,this._moveUp=!0;break;case 70:this._moveDown||this._moving++,this._moveDown=!0;break;case 81:0==this._looking&&this.onLookStart.raiseEvent(),this._lookingLeft||(this._looking++,this.onLookLeftStart.raiseEvent()),this._lookingLeft=!0;break;case 69:0==this._looking&&this.onLookStart.raiseEvent(),this._lookingRight||(this._looking++,this.onLookRightStart.raiseEvent()),this._lookingRight=!0}}function APe(e){switch(e.keyCode){case 38:case 87:this._moveForward&&this.onMoveForwardEnd.raiseEvent(),this._moveForward=!1,this._moving--,0===this._moving&&this.onMoveEnd.raiseEvent();break;case 37:case 65:this._moveLeft&&this.onMoveLeftEnd.raiseEvent(),this._moveLeft=!1,this._moving--,0===this._moving&&this.onMoveEnd.raiseEvent();break;case 40:case 83:this._moveBackward&&this.onMoveBackwardEnd.raiseEvent(),this._moveBackward=!1,this._moving--,0===this._moving&&this.onMoveEnd.raiseEvent();break;case 39:case 68:this._moveRight&&this.onMoveRightEnd.raiseEvent(),this._moveRight=!1,this._moving--,0===this._moving&&this.onMoveEnd.raiseEvent();break;case 82:this._moveUp=!1,this._moving--,0===this._moving&&this.onMoveEnd.raiseEvent();break;case 70:this._moveDown=!1,this._moving--,0===this._moving&&this.onMoveEnd.raiseEvent();break;case 81:this._lookingLeft&&this.onLookLeftEnd.raiseEvent(),this._lookingLeft=!1,this._looking--,0===this._looking&&this.onLookEnd.raiseEvent();break;case 69:this._lookingRight&&this.onLookRightEnd.raiseEvent(),this._lookingRight=!1,this._looking--,0===this._looking&&this.onLookEnd.raiseEvent()}}function PPe(e,t,i){if(e._isCollision){var n=new Ts(e._objectPosition,t),r=e._viewer.scene.pickFromRay(n,[e.object]);if(u.a(r)&&u.a(r.object)&&u.a(r.position)){var a=r.position,o=z.subtract(a,e._objectPosition,new z),s=z.magnitude(o);if(s>.2){var c=s-.2;return i<=c?i:c}return 0}return i}return i}var IPe=xPe;n(179);function DPe(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var jPe=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),!u.a(t.model))throw new h.a("model不存在");if(!u.a(t.viewer))throw new h.a("viewer不存在");this._viewer=t.viewer,this._model=t.model,this._startTime=Tr.fromIso8601("2013-12-25"),this._clock=new tf({startTime:this._startTime,currentTime:this._startTime,stopTime:Tr.fromIso8601("2013-12-26"),clockRange:Xd.LOOP_STOP,shouldAnimate:!1,clockStep:Zd.SYSTEM_CLOCK_MULTIPLIER}),this._animationCollection=new LJ(this._model),this._currentPlayingAnimations=new Map,this._isPause=!1}var t,i,n;return t=e,(i=[{key:"get",value:function(e){return this._model._runtime.animations[e]}},{key:"play",value:function(e){var t,i=this,n=this._viewer.cesiumViewer.scene,r=e||{},a=r.index,o=void 0===a?0:a,s=r.multiplier,c=void 0===s?1:s,l=r.loop,h=void 0===l?CJ.REPEAT:l,d=r.name;return this._currentPlayingAnimations[o]?(this._clock.shouldAnimate||(console.log("replay"),this._clock.shouldAnimate=!0),this._currentPlayingAnimations[o]):(t=u.a(d)?this._animationCollection.add({name:d,multiplier:c,loop:h}):this._animationCollection.add({index:o,multiplier:c,loop:h}),this._clock.shouldAnimate=!0,this._removeCallback=n.preRender.addEventListener((function(){i._clock.tick(),i.update()})),this._currentPlayingAnimations[o]=t,t)}},{key:"update",value:function(){if(this._clock.shouldAnimate){var e={time:this._clock.currentTime,afterRender:[]};this._model._cesiumAnimationsDirty=!0,this._animationCollection.update(e)}}},{key:"playAll",value:function(e){var t=this,i=this._viewer.cesiumViewer.scene,n=e||{},r=n.multiplier,a=void 0===r?1:r,o=n.loop,s=void 0===o?CJ.REPEAT:o;return this._currentPlayingAnimations.length>0?(this._clock.shouldAnimate=!0,this._currentPlayingAnimations):(this._currentPlayingAnimations=this._animationCollection.addAll({multiplier:a,loop:s}),this._clock.shouldAnimate=!0,this._removeCallback=i.preRender.addEventListener((function(){if(t._clock.tick(),t._clock.shouldAnimate){var e={time:t._clock.currentTime,afterRender:[]};t._model._cesiumAnimationsDirty=!0,t._animationCollection.update(e)}})),this._currentPlayingAnimations)}},{key:"pause",value:function(){this._clock.shouldAnimate=!1}},{key:"stop",value:function(e){var t=this._currentPlayingAnimations[e];this._clock.currentTime=this._startTime,this.update(),this._animationCollection.remove(t),this._currentPlayingAnimations[e]=void 0,this._clock.shouldAnimate=!1,0===this._currentPlayingAnimations.filter((function(e){return void 0!==e})).length&&this._removeCallback()}},{key:"stopByName",value:function(e){for(var t=0;t<this._currentPlayingAnimations.length;t++){var i=this._currentPlayingAnimations[t];if(i&&e===i.name){this._clock.currentTime=this._startTime,this.update(),this._animationCollection.remove(i),this._currentPlayingAnimations[t]=void 0,this._clock.shouldAnimate=!1,0===this._currentPlayingAnimations.filter((function(e){return void 0!==e})).length&&this._removeCallback();break}}}},{key:"stopAll",value:function(){this._clock.currentTime=this._startTime,this.update(),this._animationCollection.removeAll(),this._currentPlayingAnimations=[],this._clock.shouldAnimate=!1,this._removeCallback&&this._removeCallback()}},{key:"destroy",value:function(){return this.stopAll(),rl(this)}},{key:"multiplier",get:function(){return this._clock.multiplier},set:function(e){this._clock.multiplier=e}},{key:"animationCount",get:function(){return this._model._runtime.animations.length}}])&&DPe(t.prototype,i),n&&DPe(t,n),e}();function MPe(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function RPe(e){if(u.a(this._controls)){var t=Qd();this._controls.update(.001*(t-this._oldTime)),this._oldTime=t}}var LPe=function(){function e(t){var i,n,r=this;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._motorViewer=t.viewer,this._viewer=t.viewer.cesiumViewer,this._controller=t.viewer.controller,this._controller.enableInputs=!1,this._type=w.a(t.type,"FirstPersonControl"),"FirstPersonControl"===this._type){var a=t.target,o=t.defaultRange;u.a(a)||(this._testTarget=(i=this._viewer,n=i.scene.camera,i.scene.primitives.add(new ck({geometryInstances:new Mu({geometry:Ya.fromDimensions({vertexFormat:$j.VERTEX_FORMAT,dimensions:new z(.1,.1,.1)}),attributes:{color:df.fromColor(uf.WHITE.withAlpha(0))}}),modelMatrix:Be.fromTranslation(n.positionWC),appearance:new $j({closed:!0})})))),this._controls=new bPe({viewer:this._viewer,target:a||this._testTarget,defaultRange:o||a?a.boundingSphere.radius:.01}),this.onRoamStart=this._controls.onMoveStart,this.onRoamEnd=this._controls.onMoveEnd,this._controls.movementSpeed=2,this._controls.isGravitative=!0,this._controls.isCollision=!0}else if("Walk"===this._type){var s=this._viewer.camera,c=s.positionWC,l=s.heading,h=(s.inverseViewMatrix,this._avatar=t.viewer.loadModel({origin:c,url:y("model/man_fbx.glb"),rotationZ:I.toDegrees(-l),scale:100}));h.readyPromise.then((function(){var e=r._animationPlayer=new jPe({viewer:t.viewer,model:h});e.play({name:"man|idle"});var i=r._controls=new IPe({viewer:t.viewer,avatar:h,firstPersonControlRange:1,firstPersonControlHeading:l,firstPersonControl:!0});r._controls.enabled=!0,r._controls.movementSpeed=1,r._controls.isGravitative=!0,r._controls.isCollision=!0,r._isRun=!1;r._animationNames=["man|walk","man|walk","man|step_left","man|step_right","man|turning_left","man|turning_right"],r._currentAnimationIndex=r._animationNames.length,["onMoveForward","onMoveBackward","onMoveLeft","onMoveRight","onLookLeft","onLookRight"].forEach((function(t,n){i[t+"Start"].addEventListener((function(){r._currentAnimationIndex>n&&(e.stopAll(),n<2&&r._isRun?e.play({name:"man|run"}):e.play({name:r._animationNames[n]}),r._currentAnimationIndex=n)})),i[t+"End"].addEventListener((function(){r._currentAnimationIndex===n&&(n<2&&r._isRun?e.stopByName("man|run"):e.stopByName(r._animationNames[n]),e.play({name:"man|idle"}),r._currentAnimationIndex=r._animationNames.length)}))}))}))}this._oldTime=Qd(),this._eventHelper=new eb,this._eventHelper.add(this._viewer.clock.onTick,RPe.bind(this),this),this._backUpRenderMode=this._viewer.scene.requestRenderMode,this.enabled=!0}var t,i,n;return t=e,(i=[{key:"isDestroyed",value:function(){return!1}},{key:"destroy",value:function(){return u.a(this._controller)&&(this._controller=void 0),u.a(this._controls)&&(this._controls.destroy(),this._controls=void 0),u.a(this._avatar)&&(this._motorViewer.remove(this._avatar),this._avatar=void 0),u.a(this._animationPlayer)&&(this._animationPlayer.destroy(),this._animationPlayer=void 0),u.a(this._eventHelper)&&(this._eventHelper.removeAll(),this._eventHelper=void 0),u.a(this._viewer)&&(u.a(this._testTarget)&&(this._viewer.scene.primitives.remove(this._testTarget),this._testTarget=void 0),this._viewer.scene.requestRenderMode=this._backUpRenderMode,this._viewer=void 0),rl(this)}},{key:"enabled",get:function(){return this._controls.enabled},set:function(e){u.a(this._controls)&&(this._controls.enabled=e,this._viewer.scene.requestRenderMode=e?!e:this._backUpRenderMode)}},{key:"movementSpeed",get:function(){return this._controls.movementSpeed},set:function(e){this._controls.movementSpeed=e,"Walk"===this._type&&(e>2?(this._isRun=!0,this._animationPlayer.multiplier=1+Math.log(this._controls.movementSpeed-2)/2):(this._isRun=!1,this._animationPlayer.multiplier=1+Math.log(this._controls.movementSpeed)/2),this._controls._moving&&this._currentAnimationIndex<2&&(this._isRun?(this._animationPlayer.stopByName("man|walk"),this._animationPlayer.play({name:"man|run"})):(this._animationPlayer.stopByName("man|run"),this._animationPlayer.play({name:"man|walk"}))))}},{key:"isGravitative",get:function(){return this._controls.isGravitative},set:function(e){this._controls.isGravitative=e}},{key:"isCollision",get:function(){return this._controls.isCollision},set:function(e){this._controls.isCollision=e}}])&&MPe(t.prototype,i),n&&MPe(t,n),e}();var NPe=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)};NPe.access_token="",NPe.defaultServer="https://open.lubansoft.com/api",NPe.server="https://open.lubansoft.com/api",NPe.token="/motor/"+(NPe.version="v1.0")+"/service/uc/auth/token",NPe.validateToken="/motor/"+NPe.version+"/service/uc/auth/validateToken",NPe.findProject="/motor/"+NPe.version+"/service/bp/project/find",NPe.projectlist="/motor/"+NPe.version+"/service/bp/project/list",NPe.listAssembly="/motor/"+NPe.version+"/service/bp/assembly/list",NPe.renderAssembly="/motor/"+NPe.version+"/service/bp/assembly/render",NPe.listStaticModByProjectId="/motor/"+NPe.version+"/service/bp/assembly/listStaticModByProjectId",NPe.componentPropertiesTree="/motor/"+NPe.version+"/service/bp/component/getComponentPropertiesTree",NPe.componentPropertiesTreeStructure="/motor/"+NPe.version+"/service/bp/component/getPropertiesTreeStructure",NPe.componentPropertiesTreeDetail="/motor/"+NPe.version+"/service/bp/component/getPropertiesTreeDetail",NPe.getStaticModByProjIdAndAssemblyId="/motor/"+NPe.version+"/service/bp/component/getStaticModByProjIdAndAssemblyId",NPe.getComponentBimPropByIdAndProjId="/motor/"+NPe.version+"/service/bp/component/bimProperties/find",NPe.getComponentCimPropByIdAndProjId="/motor/"+NPe.version+"/service/bp/component/find",NPe.getComponentConfigByProjId="/motor/"+NPe.version+"/service/bp/component/webConfig",NPe.findBimProperties="/motor/"+NPe.version+"/service/bp/component/findBimProperties",NPe.findByProperties="/motor/"+NPe.version+"/service/bp/component/listByProperties",NPe.listByIds="/motor/"+NPe.version+"/service/bp/component/listByIds",NPe.listByBimIds="/motor/"+NPe.version+"/service/bp/component/listByBimIds",NPe.readResource="/motor/"+NPe.version+"/service/rf/resource/read",NPe.readND="/motor/"+NPe.version+"/service/rf/resource/readND",NPe.lightUpdate="/motor/"+NPe.version+"/service/bp/project/light/update";var FPe=NPe,kPe=(n(182),{bimGuid:0,floor:1,main_type:2,sub_type:3,name:4,extent:5});Object.freeze(kPe);var BPe=kPe;n(28),n(29);function zPe(e){return(zPe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function UPe(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function VPe(e,t){return!t||"object"!==zPe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function HPe(e){return(HPe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function GPe(e,t){return(GPe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var qPe=function(e){function t(e){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=VPe(this,HPe(t).call(this,e))).options=e,i}var i,n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&GPe(e,t)}(t,e),i=t,(n=[{key:"init",value:function(){return this.options}},{key:"token",value:function(e){return e&&(Ri.isInternetExplorer()||Ri.isEdge()?this.options.queryParameters=ff.a(this.options.queryParameters,{access_token:FPe.access_token}):this.options.headers=ff.a(this.options.headers,{access_token:FPe.access_token})),this.options}},{key:"result",value:function(e){if("[object String]"===Object.prototype.toString.call(e)&&(e=JSON.parse(e)),200==e.code)return e.data;throw window.alert(e.msg),new h.a(e.msg)}},{key:"get",value:function(){var e=this;return this.init(),f.a.fetchJson(this.options).then((function(t){return e.result(t)}))}},{key:"post",value:function(){var e=this;return this.init(),f.a.post(this.options).then((function(t){return e.result(t)}))}},{key:"put",value:function(){var e=this;return this.init(),f.a.put(this.options).then((function(t){return e.result(t)}))}}])&&UPe(i.prototype,n),r&&UPe(i,r),t}(f.a);function WPe(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}qPe.get=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=new qPe(e);return i.token(t),i.get()},qPe.post=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=new qPe(e);return i.token(t),i.post()},qPe.put=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=new qPe(e);return i.token(t),i.put()};var YPe=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,i,n;return t=e,n=[{key:"findByProperties",value:function(e){var t={};for(var i in e)e[i]&&(t[i]=e[i]);var n={};return n.url=FPe.server+FPe.findByProperties,n.queryParameters=t,qPe.get(n)}},{key:"listByIds",value:function(e,t){if(!u.a(e))throw new h.a("请传入构件guid列表");if(!u.a(t))throw new h.a("请传入工程guid");var i={};return i.data=JSON.stringify(e),i.url=FPe.server+FPe.listByIds,i.queryParameters={projectId:t},i.headers={"Content-Type":"application/json"},qPe.post(i)}},{key:"listByBIMIds",value:function(e,t){if(!u.a(e))throw new h.a("请传入构件guid列表");if(!u.a(t))throw new h.a("请传入工程guid");var i={};return i.data=JSON.stringify(e),i.url=FPe.server+FPe.listByBimIds,i.queryParameters={guid:t},i.headers={"Content-Type":"application/json"},qPe.post(i)}},{key:"GetStaticModByProjIdAndAssemblyId",value:function(e,t){var i={};return i.url=FPe.server+FPe.getStaticModByProjIdAndAssemblyId,i.queryParameters={projectId:e,assemblyId:t},qPe.get(i)}},{key:"GetConfig",value:function(t){return(new e).getConfig(t)}},{key:"PropertiesTree",value:function(t){return(new e).propertiesTree(t)}},{key:"PropertiesTreeStructure",value:function(t){return(new e).propertiesTreeStructure(t)}},{key:"PropertiesTreeDetail",value:function(t,i,n,r){return(new e).propertiesTreeDetail(t,i,n,r)}},{key:"GetComponentBimPropByIdAndProjId",value:function(t,i){return(new e).getBimPropByIdAndProjId(t,i)}},{key:"GetComponentCimPropByIdAndProjId",value:function(t,i){return(new e).getCimPropByIdAndProjId(t,i)}},{key:"FindBimProperties",value:function(t){return(new e).findBimProperties(t)}}],(i=[{key:"propertiesTree",value:function(e){var t={};return t.url=FPe.server+FPe.componentPropertiesTree,t.queryParameters={projectId:e},qPe.get(t)}},{key:"propertiesTreeStructure",value:function(e){var t={};return t.url=FPe.server+FPe.componentPropertiesTreeStructure,t.queryParameters={projectId:e},qPe.get(t)}},{key:"propertiesTreeDetail",value:function(e){var t={};return t.url=FPe.server+FPe.componentPropertiesTreeDetail,t.data=JSON.stringify(e),t.headers={"Content-Type":"application/json"},qPe.post(t)}},{key:"getBimPropByIdAndProjId",value:function(e,t){var i={};return i.url=FPe.server+FPe.getComponentBimPropByIdAndProjId,i.queryParameters={id:e,projectId:t},qPe.get(i)}},{key:"getCimPropByIdAndProjId",value:function(e,t){var i={};return i.url=FPe.server+FPe.getComponentCimPropByIdAndProjId,i.queryParameters={id:e,projectId:t},qPe.get(i)}},{key:"getConfig",value:function(e){var t={};return t.url=FPe.server+FPe.getComponentConfigByProjId,t.queryParameters={projectId:e},qPe.get(t)}},{key:"findBimProperties",value:function(e){var t=e.pageNo,i=void 0===t?1:t,n=e.pageSize,r=void 0===n?10:n,a=e.projectId,o=e.name;return e.url=FPe.server+FPe.findBimProperties,e.queryParameters={pageNo:i,pageSize:r,projectId:a,name:o},qPe.get(e)}}])&&WPe(t.prototype,i),n&&WPe(t,n),e}(),XPe={TYPE_CIM:0,TYPE_BIM:1};Object.freeze(XPe);var ZPe=XPe;n(103);function QPe(e){return(QPe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function KPe(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function JPe(e,t){return!t||"object"!==QPe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function $Pe(e,t,i){return($Pe="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,i){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=eIe(e)););return e}(e,t);if(n){var r=Object.getOwnPropertyDescriptor(n,t);return r.get?r.get.call(i):r.value}})(e,t,i||e)}function eIe(e){return(eIe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function tIe(e,t){return(tIe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var iIe=0,nIe=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),JPe(this,eIe(t).call(this,e))}var i,n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&tIe(e,t)}(t,e),i=t,(n=[{key:"update",value:function(){iIe=this._colorCommands.length,$Pe(eIe(t.prototype),"update",this).apply(this,arguments);for(var e=iIe;e<this._colorCommands.length;e++)this._colorCommands[e].pass=lM.WATER,this._colorCommands[e].shaderProgram.fragmentShaderSource.defines.push("POLYGON_WATER")}}])&&KPe(i.prototype,n),r&&KPe(i,r),t}(ck);function rIe(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var aIe=new be,oIe=new Be,sIe=new Rr,cIe=new z,lIe=new Be,uIe=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,i,n;return t=e,n=[{key:"translateFromBoundingSphere",value:function(e,t,i){return Be.fromTranslation(e,i),St.transform(t,i,t),i}},{key:"rotateFromBoundingSphere",value:function(t,i,n){var r=i.center.clone();return sIe.heading=I.toRadians(-t.z),sIe.pitch=I.toRadians(-t.y),sIe.roll=I.toRadians(t.x),be.fromHeadingPitchRoll(sIe,aIe),Be.multiplyByMatrix3(Be.IDENTITY,aIe,oIe),St.transform(i,oIe,i),z.subtract(r,i.center,cIe),e.translateFromBoundingSphere(cIe,i,lIe),Be.multiply(lIe,oIe,n),n}},{key:"scaleFromBoundingSphere",value:function(t,i,n){var r=i.center.clone();return Be.fromScale(t,oIe),St.transform(i,oIe,i),z.subtract(r,i.center,cIe),e.translateFromBoundingSphere(cIe,i,lIe),Be.multiply(lIe,oIe,n),n}}],(i=null)&&rIe(t.prototype,i),n&&rIe(t,n),e}();function hIe(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var dIe=new K,fIe=new Be;function pIe(e,t){for(var i=0;i<t.length;i++){if(e===t[i].sysName)return t[i];if(t[i].children){var n=pIe(e,t[i].children);if(n)return n}else if(t[i].paramter){var r=pIe(e,t[i].paramter);if(r)return r}else;}}var mIe=function(){function e(t){var i=this;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),!u.a(t.guid))throw new h.a("options.guid未定义");if(this._guid=t.guid,!u.a(t.project))throw new h.a("options.project未定义");if(this._project=t.project,this._primitives=[],this._feature=t.feature,this._assemblyType=t.assemblyType,this._type=w.a(t.type,this._project.type),this._transformMatrix=w.a(t.transformMatrix,Be.IDENTITY.clone()),u.a(t.primitives)&&t.primitives.length>0&&this.addPrimitive(t.primitives[0]),this._infos={},u.a(t.infos)&&t.infos.length>0)for(var n in BPe){if(this._infos[n]=t.infos[BPe[n]],BPe[n]===t.infos.length-1){var r=t.infos[BPe[n]];r.trim();var a=r.substring(1,r.length-2).split(",");a=a.map((function(e){return parseFloat(e)}));var o=new z(a[0],a[1],a[2]),s=new z(a[3],a[4],a[5]),c=St.fromPoints([o,s],new St);u.a(this._project._externalMatrix)&&St.transform(c,this._project._externalMatrix,c),u.a(this._project.assignProjectMatrix)&&St.transform(c,this._project.assignProjectMatrix,c),this._boundingSphere=St.transform(c,this._project.originMatrix,new St)}"floor"===n&&u.a(this._project.parentProject.floorConfig)&&this._project.parentProject.floorConfig.forEach((function(e){e.mapping&&e.mapping.forEach((function(t){t.id===i._project.guid&&t.floor_list.forEach((function(t){if(t===i._infos.floor)return i._bimFloor=e.floor_name,void(i._infos.bimFloor=e.floor_name)}))}))}))}}var t,i,n;return t=e,n=[{key:"GetBIMProperties",value:function(e){var t=e.guid,i=e.projectId;return new Promise((function(e,n){YPe.GetComponentBimPropByIdAndProjId(t,i).then((function(t){var i={};for(var n in t.bimProperties){var r=t.bimProperties[n],a=void 0;for(var o in i)if(o===r.group){a=o;break}a?i[a].push({name:r.name,value:r.value,unit:r.unit}):i[r.group]=[{name:r.name,value:r.value,unit:r.unit}]}e(i)})).otherwise((function(e){console.warn(e),n(e)}))}))}}],(i=[{key:"addPrimitive",value:function(e){var t=this;this._primitives.push(e),u.a(e.modelMatrix)&&(e._originalMatrix=e.modelMatrix.clone()),u.a(e._externalMatrix)?e._oldexternalMatrix=e._externalMatrix.clone():(e._externalMatrix=Be.IDENTITY.clone(),e._oldexternalMatrix=Be.IDENTITY.clone()),e.readyPromise.then((function(){if(e instanceof tB)t._boundingSphere=e._primitive._boundingSpheres[0];else if(e instanceof nIe)t._boundingSphere=e._boundingSpheres[0];else{var i=e.boundingSphere.clone();u.a(t._boundingSphereLocalOld)?St.fromBoundingSpheres([t._boundingSphereLocalOld,i],t._boundingSphereLocalOld):t._boundingSphereLocalOld=i.clone(),St.transform(i,e._externalMatrix,i),u.a(t._boundingSphereLocal)?St.fromBoundingSpheres([t._boundingSphereLocal,i],t._boundingSphereLocal):t._boundingSphereLocal=i.clone(),Be.multiply(e._originalMatrix,e._externalMatrix,e.modelMatrix),t._boundingSphere=t._boundingSphereLocal.clone(),Be.multiplyByPoint(e._originalMatrix,t._boundingSphere.center,t._boundingSphere.center)}})).otherwise((function(e){console.warn(e)}))}},{key:"setColor",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(this.selected)i||(this._color=e);else{if(u.a(this._primitives))this._primitives.forEach((function(i){i instanceof tB?i.getGeometryInstanceAttributes(t.guid).color=e.toBytes():i.color=e})),this._project.forceRender();else if(!n&&this._feature)this._feature.color=e;else{var r,a=!0;for(var o in r=i?this._project.idHighlightPairs:this._project.idColorPairs){var s=r[o];if(s.guid===this.guid){s.color=e,a=!1;break}}a&&(r.push({guid:this.guid,color:e}),this._project.updateStyle())}i?this.selected=!0:this._color=e}}},{key:"resetColor",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(u.a(this._primitives)){if(this.selected&&!t)return void(this._color=void 0);if(!this._color&&!t)return;this._primitives.forEach((function(i){i instanceof tB?i.getGeometryInstanceAttributes(e.guid).color=uf.WHITE.withAlpha(0).toBytes():i.color=t&&e._color||uf.WHITE})),this._project.forceRender()}else if(!i&&this._feature){if(this.selected)return;if(!this._color)return;this._feature.color=uf.WHITE,this._project.forceRender()}else{var n,r=!1;for(var a in n=t?this._project.idHighlightPairs:this._project.idColorPairs){var o=n[a];if(o.guid===this.guid){n.splice(a,1),r=!0;break}}r&&this._project.updateStyle()}t||(this._color=void 0)}},{key:"select",value:function(){this.selected||("MODEL"===this._project._type?this._project.parentProject.selectComponents([this]):this._project.selectComponents([this]))}},{key:"deselect",value:function(){if(this.type===ZPe.TYPE_CIM){if(!this.selected)return;this.resetColor(!0),this.selected=!1}else this.resetColor(!0),this.selected=!1}},{key:"show",value:function(){this.setVisibility(!0)}},{key:"hide",value:function(){this.setVisibility(!1)}},{key:"setVisibility",value:function(e){if(e&&!0===this._project.hideAllComponents?(this._project.hideAllComponents=!1,this._project._isHide=!1):e||!1!==this._project.hideAllComponents||(this._project._isHide=!0),u.a(this._primitives))this._primitives.forEach((function(t){t.show!==e&&(t.show=e)})),this._project.forceRender();else{var t=this._project.idHideStrings.indexOf(this.guid);-1!==t?e&&this._project.idHideStrings.splice(t,1):e||this._project.idHideStrings.push(this.guid),this._project.updateStyle()}}},{key:"isolate",value:function(e){this._project.isolateComponents([this],e)}},{key:"translate",value:function(e){uIe.translateFromBoundingSphere(e,this._boundingSphereLocal,fIe),this._primitives.forEach((function(e){Be.multiply(fIe,e._externalMatrix,e._externalMatrix),Be.multiply(e._originalMatrix,e._externalMatrix,e.modelMatrix)}))}},{key:"rotate",value:function(e){uIe.rotateFromBoundingSphere(e,this._boundingSphereLocal,fIe),this._primitives.forEach((function(e){Be.multiply(fIe,e._externalMatrix,e._externalMatrix),Be.multiply(e._originalMatrix,e._externalMatrix,e.modelMatrix)}))}},{key:"scale",value:function(e){uIe.scaleFromBoundingSphere(e,this._boundingSphereLocal,fIe),this._primitives.forEach((function(e){Be.multiply(fIe,e._externalMatrix,e._externalMatrix),Be.multiply(e._originalMatrix,e._externalMatrix,e.modelMatrix)}))}},{key:"setMatrix",value:function(e){St.transform(this._boundingSphereLocalOld,e,this._boundingSphereLocal),this._primitives.forEach((function(t){t._externalMatrix=e.clone(),Be.multiply(t._originalMatrix,t._externalMatrix,t.modelMatrix)}))}},{key:"revertTransform",value:function(){this._primitives.forEach((function(e){return Be.multiply(e._originalMatrix,e._oldexternalMatrix,e.modelMatrix),e._externalMatrix=e._oldexternalMatrix.clone(),e.boundingSphere})),this._boundingSphereLocal=this._boundingSphereLocalOld.clone()}},{key:"placeOnEarth",value:function(e){}},{key:"updateBoundingSphere",value:function(){var e=this,t=this._primitives.map((function(t){return St.transform(e._boundingSphereLocal,t._originalMatrix,new St)}));return St.fromBoundingSpheres(t,this._boundingSphere),this._project.updateBoundingSphere(),this._boundingSphere}},{key:"getLinkedProject",value:function(){return this._subProject}},{key:"getProperties",value:function(){var e=this;return new Promise((function(t,i){e._project.type===ZPe.TYPE_CIM?YPe.GetComponentCimPropByIdAndProjId(e.guid,e.project.guid).then((function(i){if(u.a(i.cimProperties)){var n=e.project.getPropTemplateInfo(),r=i.cimProperties,a=[];for(var o in r){var s=r[o],c=pIe(o,n);c&&a.push({name:c.name,value:s,unit:c.unit,group:c.group})}t({guid:e.guid,projGuid:e._project.guid,name:i.name,props:a})}else t({guid:e.guid,projGuid:e._project.guid,name:i.name})})).otherwise((function(e){console.warn(e),i(e)})):YPe.GetComponentBimPropByIdAndProjId(e.guid,e.project.guid).then((function(i){var n,r=[];if(u.a(i)){for(var a in i.bimProperties?n=i.bimProperties:i.cimProperties&&(n=i.cimProperties),n){var o=n[a];r.push(o)}if(e._project.type===ZPe.TYPE_CIM)t({guid:e.guid,projGuid:e._project.guid,name:i.name,props:r});else{var s={guid:e.guid,projGuid:e._project.parentProject.guid,bimGuid:e.infos.bimGuid,mainCompGuid:"",major:e._project._major,floor:e.infos.floor,bimFloor:e.infos.bimFloor,main_type:e.infos.main_type,sub_type:e.infos.sub_type,name:e.infos.name,props:r};t(s)}}else t({guid:e.guid,projGuid:e._project.parentProject.guid,bimGuid:e.infos.bimGuid,mainCompGuid:"",major:e._project._major,floor:e.infos.floor,bimFloor:e.infos.bimFloor,main_type:e.infos.main_type,sub_type:e.infos.sub_type,name:e.infos.name})})).otherwise((function(e){console.warn(e),i(e)}))}))}},{key:"guid",get:function(){return this._guid}},{key:"name",get:function(){return this.infos&&this.infos.name}},{key:"subProject",get:function(){return this._subProject}},{key:"infos",get:function(){return this._infos}},{key:"color",get:function(){return this._color}},{key:"project",get:function(){return this._project}},{key:"type",get:function(){return this._type}},{key:"boundingSphere",get:function(){return this._boundingSphere}},{key:"position",get:function(){return this._boundingSphere.center}},{key:"positionCartographic",get:function(){return K.fromCartesian(this._boundingSphere.center,this._project._viewer.cesiumViewer.scene.globe.ellipsoid,dIe)}},{key:"flatten",get:function(){return this._project._viewer.cesiumViewer.scene.modelPlanishCollection.getBorderInfos(this.guid).flatten},set:function(e){this._project._viewer.cesiumViewer.scene.modelPlanishCollection.getBorderInfos(this.guid).flatten=e}}])&&hIe(t.prototype,i),n&&hIe(t,n),e}();n(183),n(285),n(286),n(287);function _Ie(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var gIe=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,i,n;return t=e,n=[{key:"ListByProjectId",value:function(t){return(new e).render({projectId:t}).then((function(e){return u.a(e)?e:void console.error("无法获取组件ID")}))}}],(i=[{key:"list",value:function(e){var t={};return t.url=FPe.server+FPe.listAssembly,t.queryParameters=e,qPe.get(t)}},{key:"listStaticModByProjectId",value:function(e){var t={};return t.url=FPe.listStaticModByProjectId,t.queryParameters=e,qPe.get(t)}},{key:"render",value:function(e){var t={};return t.url=FPe.server+FPe.renderAssembly,t.queryParameters=e,qPe.get(t)}}])&&_Ie(t.prototype,i),n&&_Ie(t,n),e}(),vIe={ARCH:"土建",STEEL:"钢筋",BENTLY:"bently",TEKLA:"tekla",RHINO:"rhino",REVIT:"revit",SITE:"场布",MEP:"安装",C3D:"civil",IFC:"ifc"};Object.freeze(vIe);var bIe=vIe;n(288);function yIe(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var wIe=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,i,n;return t=e,n=[{key:"list",value:function(){var e={};return e.url=FPe.server+FPe.projectlist,qPe.get(e)}},{key:"FindById",value:function(t){var i=new e;return i.find({id:t}),i.find({id:t})}},{key:"lightUpdate",value:function(e){var t={};return t.url=FPe.server+FPe.lightUpdate,t.data=JSON.stringify(e),t.headers={"Content-Type":"application/json"},qPe.put(t)}}],(i=[{key:"find",value:function(e){var t={};return t.url=FPe.server+FPe.findProject,t.queryParameters=e,qPe.get(t)}}])&&yIe(t.prototype,i),n&&yIe(t,n),e}(),OIe={GeographicTilingScheme:0,WebMercatorTilingScheme:1};Object.freeze(OIe);var xIe=OIe;function EIe(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var TIe=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),!u.a(t))throw new h.a("options未定义");this._tilingScheme=t.tilingScheme===xIe.WebMercatorTilingScheme?new GI:new Nt,this._maximumLevel=t.maximumLevel}var t,i,n;return t=e,(i=[{key:"destroy",value:function(){return rl(this)}},{key:"alpha",get:function(){return this.mapLayer.alpha},set:function(e){this.mapLayer.alpha=e}}])&&EIe(t.prototype,i),n&&EIe(t,n),e}();function CIe(e){return(CIe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function SIe(e,t){return!t||"object"!==CIe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function AIe(e){return(AIe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function PIe(e,t){return(PIe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var IIe,DIe,jIe=function(e){function t(e){var i;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),i=SIe(this,AIe(t).call(this,e)),!u.a(e.url))throw new h.a("options.url未定义");if(!u.a(e.layer))throw new h.a("options.layer未定义");if(!u.a(e.style))throw new h.a("options.style未定义");if(!u.a(e.tileMatrixSetID))throw new h.a("options.tileMatrixSetID未定义");return i.mapProvider=new nle({url:e.url,layer:e.layer,style:e.style,format:w.a(e.format,"image/jpeg"),tileMatrixSetID:e.tileMatrixSetID,tileMatrixLabels:e.tileMatrixLabels,maximumLevel:i._maximumLevel,tilingScheme:i._tilingScheme}),i.mapLayer=new phe(i.mapProvider),i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&PIe(e,t)}(t,e),t}(TIe);function MIe(e){return(MIe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function RIe(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function LIe(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?RIe(Object(i),!0).forEach((function(t){NIe(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):RIe(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function NIe(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function FIe(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}IIe=/Android|webOS|BlackBerry/i.test(navigator.userAgent)?"Android":/iPhone|iPod|iPad/i.test(navigator.userAgent)?"IOS":void 0,Ri.supportsWebAssembly()&&!IIe&&(DIe=n(186));var kIe="",BIe=new K,zIe=Be.IDENTITY.clone();function UIe(e,t){var i,n=[],r=[],a=e.path?e.path.split(".")[1]:"";if(e.path&&("gltf"===a||"json"===a||"b3dm"===a||"3D_TILES"===e.type)||"WATERMESH"===e.type){for(var o,s,c=0;c<e.border.length;){o=e.border[c],s=e.border[c+1];var l=new z(o,s,e.bottom),u=new z(o,s,e.bottom+(0==e.height?.05:e.height));if(e.matrix&&!e.matrix.equals(Be.IDENTITY)){var h=e.matrix.clone();e.externalMatrix&&!e.externalMatrix.equals(Be.IDENTITY)&&Be.multiply(h,e.externalMatrix,h),Be.multiplyByPoint(h,l,l),Be.multiplyByPoint(h,u,u)}n.push(l),n.push(u),c+=2}var d=Fc.fromPoints(n,new Fc);if(i=new St,St.fromOrientedBoundingBox(d,i),t&&St.transform(i,t,i),"CLUSTER"===e.type&&""!==e.clusterInfo){var f=new St,p=[];return e.clusterInfo.forEach((function(e){var t=new Be;Be.fromRowMajorArray(e.matrix,t);var a=new St;St.transform(i,t,a),p.push(a),n.forEach((function(e){r.push(Be.multiplyByPoint(t,e,new z))}))})),St.fromBoundingSpheres(p,f),{boundingSphere:f,positions:r}}}return{boundingSphere:i,positions:n}}function VIe(e){for(var t=1e7,i=1e7,n=1e7,r=-1e7,a=-1e7,o=-1e7,s=0;s<e.border.length;){var c=e.border[s],l=e.border[s+1],u=e.bottom,h=e.bottom+e.height;c<t&&(t=c),c>r&&(r=c),l<i&&(i=l),l>a&&(a=l),u<n&&(n=u),h>o&&(o=h),s+=2}return[t,i,n,r,a,o]}function HIe(e,t,i,n){if(t&&""!==t)if("string"==typeof t){for(var r=!1,a=0;a<e.typeStringColorPairs.length;a++)if(e.typeStringColorPairs[a].string===t){r=!0;break}r||e.typeStringColorPairs.push({string:".+"+t+".+",color:i})}else t.length&&t.length>0&&t.forEach((function(t){for(var n=!1,r=0;r<e.typeStringColorPairs.length;r++)if(t===e.typeStringColorPairs[r].string){n=!0;break}n||e.typeStringColorPairs.push({string:".+"+t+".+",color:i})}));else e.typeStringColorPairs=[{string:".+",color:i}];e.idColorPairs=[],e.updateStyle(n)}function GIe(e,t,i,n){if(t&&""!==t)if("string"==typeof t){var r=e.typeHideStrings.indexOf(t);-1===r?i||e.typeHideStrings.push(t):i&&e.typeHideStrings.splice(r,1)}else t.length&&t.length>0&&t.forEach((function(t){var n=e.typeHideStrings.indexOf(t);-1===n?i||e.typeHideStrings.push(t):i&&e.typeHideStrings.splice(n,1)}));else e.typeHideStrings=["@@"];e.updateStyle(n)}function qIe(e,t,i){t&&""!==t&&(e.isolatedTypeStringColorPairs=[],"string"==typeof t?e.isolatedTypeStringColorPairs.push(t):t.length&&t.length>0&&t.forEach((function(t){e.isolatedTypeStringColorPairs.push(t)})),e.updateStyle())}function WIe(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3e3;arguments.length>3&&arguments[3];return new Promise((function(n,r){var a=[];if("string"==typeof t)a.push(t);else{if(!(t.length&&t.length>0))throw new h.a("ruleString必须是字符串或者字符串数组");t.forEach((function(e){a.push(e)}))}var o=Date.now(),s=Date.now(),c=0,l=e._viewer.cesiumViewer.scene.postRender.addEventListener((function(){s=Date.now(),(c=s-o)<=i&&(e.typeStringColorPairs=a.map((function(e){return{string:".+"+e+".+",color:1-c/i}})),e.updateStyle())}));setTimeout((function(){l(),e.typeStringColorPairs=[],e.typeHideStrings=a,e.updateStyle(),n()}),i)}))}function YIe(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3e3;arguments.length>3&&arguments[3];return new Promise((function(n,r){var a=[];if("string"==typeof t)a.push(t);else{if(!(t.length&&t.length>0))throw new h.a("ruleString必须是字符串或者字符串数组");t.forEach((function(e){a.push(e)}))}e.typeStringColorPairs=a.map((function(e){return{string:".+"+e+".+",color:0}})),e.typeHideStrings=[];var o=Date.now(),s=Date.now(),c=0,l=e._viewer.cesiumViewer.scene.postRender.addEventListener((function(){s=Date.now(),(c=s-o)<=i&&(e.typeStringColorPairs=a.map((function(e){return{string:".+"+e+".+",color:c/i}})),e.updateStyle())}));setTimeout((function(){l(),e.typeStringColorPairs=[],e.typeHideStrings=[],e.updateStyle(),n()}),i)}))}var XIe=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),!u.a(t.guid))throw new h.a("options.guid");this._viewer=t.viewer,this._guid=t.guid,this._name=t.name,this._major=t.major,this._origin=t.origin,this._version=t.version,this.tileset=t.tileset,this.parentComponent=t.parentComponent,this.parentAssembly=t.parentAssembly,this._boundingSphereLocal=t.boundingSphereLocal;var i=new Be;this.parentMatrix=t.parentMatrix;var n=this.parentComponent;if(this.parentProject=t.parentProject,u.a(n)){if(n._primitives[0].webconfig.groupId){if(n._primitives[0].webconfig.groupTransf){i=this.parentProject.originMatrix.clone();var r=n._primitives[0].webconfig.groupTransf,a=new Be;Be.fromArray(r,0,a),console.log(Be.getTranslation(a,new Be)),Be.multiplyTransformation(i,a,i)}else if("Type_SimplifyMode"!==n._primitives[0].webconfig.innerType){if(i=xa.eastNorthUpToFixedFrame(n.boundingSphere.center),n._primitives[0].webconfig.bimTransf){var o=n._primitives[0].webconfig.bimTransf,s=new Be;Be.fromRowMajorArray(o,s),Be.multiplyTransformation(i,s,i)}}else if(i=this.parentMatrix?this.parentMatrix:n._primitives[0]._originalMatrix.clone(),Be.multiply(i,n._primitives[0]._externalMatrix,i),n._primitives[0].webconfig.bimTransf){var c=n._primitives[0].webconfig.bimTransf,l=new Be;Be.fromRowMajorArray(c,l),Be.multiplyTransformation(i,l,i)}}else if(i=this.parentMatrix?this.parentMatrix:n._primitives[0]._originalMatrix.clone(),Be.multiply(i,n._primitives[0]._externalMatrix,i),n._primitives[0].webconfig.bimTransf){var d=n._primitives[0].webconfig.bimTransf,f=new Be;Be.fromRowMajorArray(d,f),Be.multiplyTransformation(i,f,i)}this.parentMatrix=i}this.assignProjectMatrix=t.assignProjectMatrix,this.access_token=FPe.access_token,this._type=t.type,this.originMatrix=t.originMatrix,this.defaultView=t.defaultView,this._defaultPresetView=t.defaultPresetView,this.defaultRange=w.a(t.defaultRange,200),this.maximumZoomDistance=w.a(t.maximumZoomDistance,1e3),this.assemblies=w.a(t.assemblies,[]),this._components=[],this._projectList=[],this._clusterList=[],this._drawEdge=w.a(t.drawEdge,!1),this._skyBox=this._viewer.skyBox,this.isMobile=IIe,this._luminanceAtZenith=w.a(t.luminanceAtZenith,.2),this._lazyLoad=w.a(t.lazyLoad,!1),this._lazyLoadBlockSize=w.a(t.lazyLoadBlockSize,200),this._openlocal=w.a(t.openlocal,!1),this._localPath=t.localPath,this.defaultPresetView,u.a(this._skyBox)&&(this._environmentMapURL=this._skyBox.specularEnvironmentMaps,this._coefficients=this._skyBox.sphericalHarmonicCoefficients),this.isMobile?this._drawEdge=!1:this._drawEdge=w.a(t.drawEdge,!1),this.secondsForTimeout=180,this._isOpened=!1,this._realLoadedCompleteEvent=new $o.a,this._lazyLoadCompleteEvent=new $o.a,this._maxSearchTreeDepth=w.a(t.maxSearchTreeDepth,3),this.idColorPairs=[],this.idHighlightPairs=[],this.typeHighlightPairs=[],this.isolatedIds=[],this.typeStringColorPairs=[],this.isolatedTypeStringColorPairs=[],this.idHideStrings=[],this.typeHideStrings=[],this._isHide=!0,this._defaultHighLightColor=uf.fromCssColorString("#03f3f7").withAlpha(.5),this._defaultBlockColor=uf.WHITE.withAlpha(.02),this._notPickableComponents=[],this._maximumScreenSpaceError=w.a(t.maximumScreenSpaceError,16)}var t,i,n;return t=e,n=[{key:"getChildNodesFromTree",value:function(e){var t=e.getParentNode().getParentNode().name,i=e.getParentNode().name,n=e.getParentNode().projectId,r=e.name;return YPe.PropertiesTreeDetail({projectId:n,floor:t,mainType:i,subType:r})}},{key:"lightUpdate",value:function(e){return wIe.lightUpdate(e)}}],(i=[{key:"open",value:function(e){var t=this;if(!this.isOpened){if((e=e||{}).drawEdge&&(this._drawEdge=e.drawEdge),this._luminanceAtZenith=w.a(e.lightIntensity,.2),this._lazyLoad=w.a(e.lazyLoad,!1),this._enableShadowPlane=w.a(e.enableShadowPlane,!1),this._lazyLoadBlockSize=w.a(e.lazyLoadBlockSize,200),this._maximumScreenSpaceError=w.a(e.maximumScreenSpaceError,16),this._isFlyTo=w.a(e.isFlyTo,!0),this._openlocal=w.a(e.openlocal,!1),this._localPath=e.localPath,u.a(this.parentComponent)&&(this.parentComponent.project.setComponentsColor(uf.WHITE.withAlpha(.1)),this.parentComponent.setVisibility(!1)),0===this.assemblies.length)return this.initReadyPromise=this.loadAssemblies(),this.initReadyPromise.then((function(e){t._viewer._projectList.push(e),t._isFlyTo&&t._viewer.flyTo(e);var i=e.drawProject();return i.length&&i.length>1?new Promise((function(n,r){Promise.all(i).then((function(i){t._realLoadedCompleteEvent.raiseEvent(),t._isOpened||(t._isOpened=!0,n(e))})),setTimeout((function(){console.log("加载超时，直接resolve"),t._isOpened=!0,n(e)}),1e3*t.secondsForTimeout)})):new Promise((function(n,r){i.then((function(e){t._isOpened=!0,n(e),t._realLoadedCompleteEvent.raiseEvent()})),setTimeout((function(){console.log("加载超时，直接resolve"),t._isOpened=!0,n(e)}),1e3*t.secondsForTimeout)}))}));this._viewer._projectList.push(this),this._isFlyTo&&this._viewer.flyTo(this);var i=this.drawProject();return i.length&&i.length>1?new Promise((function(e,n){Promise.all(i).then((function(i){t._isOpened||(t._isOpened=!0,e(project))})),setTimeout((function(){console.log("加载超时，直接resolve"),t._isOpened=!0,e(project)}),1e3*t.secondsForTimeout)})):i}this._viewer.flyTo(this)}},{key:"close",value:function(e){e=e||{};var t=this.parentComponent;u.a(t)&&(t.setVisibility(!0),t._project.clearIsolation());var i=this._viewer._projectList.indexOf(this);i>-1&&this._viewer._projectList.splice(i,1),u.a(this.modelCollection)&&!this.modelCollection.isDestroyed()&&this.modelCollection.removeAll(),u.a(this.shadowPlanes)&&!this.shadowPlanes.isDestroyed()&&this.shadowPlanes.removeAll(),this._projectList.forEach((function(e){e.destroy()})),this._projectList=[],this.assemblies=[];var n=this.parentProject;return u.a(n)&&(e.isFlyTo&&this._viewer.flyTo(n),this._viewer.controller instanceof qAe&&(this._viewer.controller.defaultRange=n.defaultRange,this._viewer.controller.maximumZoomDistance=n.maximumZoomDistance)),this._isOpened=!1,n}},{key:"searchByPropertyValue",value:function(e,t){if(this[e]===t)return this;for(var i=0;i<this._projectList.length;i++){var n=this._projectList[i].searchByPropertyValue(e,t);if(n)return n}}},{key:"loadAssemblies",value:function(){var t=this;return new Promise((function(i,n){gIe.ListByProjectId(t._guid).then((function(r){var a=r.project,o=t._type=a.type;t._name=a.name,t._version=a.version,a.config&&(t._templateProps=function e(t){return t.length||(t=[t]),t.map((function(t){if(t.subType){var i=e(t.subType);return{name:t.name,sysName:t.sysName,children:i}}return t.paramter?t:{name:t.name,sysName:t.sysName}}))}(a.config)),u.a(t.parentComponent)?t._origin=t.parentComponent.project._origin:t._origin=z.fromDegrees(a.center.coordinates[0],a.center.coordinates[1],a.center.coordinates[2]),u.a(t.parentMatrix)?t.originMatrix=t.parentMatrix:t.originMatrix=t.parentMatrix=xa.eastNorthUpToFixedFrame(t._origin);var s=a.properties?a.properties.Pa_CSPosition:void 0;if(s){var c=s.split(",");c=c.map((function(e){return parseFloat(e)}));var l=xa.eastNorthUpToFixedFrame(t._origin),h=new z;Be.multiplyByPoint(l,new z(c[0],c[1],c[2]),h),t.defaultPresetView={position:h,heading:90+c[3],pitch:-c[4]}}var d=!1;a.floorConfig?t.floorConfig=JSON.parse(a.floorConfig):a.properties&&a.properties.pa_floor_mapping?t.floorConfig=JSON.parse(a.properties.pa_floor_mapping):u.a(t.parentProject)&&u.a(t.parentProject.floorConfig)?t.floorConfig=t.parentProject.floorConfig:"BIM"===o&&1===r.projAssemblyList.length&&(d=!0);var p=a.properties?a.properties.Param_LevelInfoMap:null;!p&&d&&(p=r.projAssemblyList[0].properties?r.projAssemblyList[0].properties.Param_LevelInfoMap:null);var m=[];if(p){var _=JSON.parse(p);for(var g in _)if(m.length>0){for(var v=!0,b=0;b<m.length;b++)if(_[g].order<m[b].order){var y=LIe({name:g},_[g]);m.splice(b,0,y),v=!1;break}if(v){var w=LIe({name:g},_[g]);m.push(w)}}else{var O=LIe({name:g},_[g]);m.push(O)}d&&(t.floorConfig=m.map((function(e){return{floor_name:e.name,mapping:[{id:project.id,floor_list:[e.name]}]}}))),t._floors=m}if(t.floorConfig&&(t._floorNames=t.floorConfig.map((function(e){return e.floor_name}))),!u.a(r.assemblyList)&&!u.a(r.projAssemblyList))return iE.a("未绑定子工程","未绑定子工程"),void i(t);var x=[],E=[];switch(o){case"CIM":case"SUBCIM":u.a(r.assemblyList)?t.assemblies=r.assemblyList.map((function(i){var n,r=Be.fromArray(i.matrix,0,new Be);u.a(i.externalMatrix)&&(n=Be.fromArray(i.externalMatrix,0,new Be));var a=i.path;if("TILE_PROVIDER"===i.type){if(i.properties.terServerUrl&&""!==i.properties.terServerUrl){a=i.properties.terServerUrl;var o=f.a.createIfNeeded(a),s=new vu({url:o});t._viewer.cesiumViewer.terrainProvider=s}else if(i.properties.mapServerUrl&&""!==i.properties.mapServerUrl){a=i.properties.mapServerUrl;var c=f.a.createIfNeeded(a),l=c.queryParameters,h={};for(var d in l)h[d.toLowerCase()]=l[d];for(var p=[],m=0;m<16;m++)p.push(h.tilematrixset+":"+m);t._viewer.mapCollection.removeAll();var _=new jIe({url:c.getUrlComponent(),layer:h.layer,style:h.style?h.style:"",tileMatrixSetID:h.tilematrixset,tileMatrixLabels:p,format:h.format,tilingScheme:"EPSG:900913"==h.tilematrixset?xIe.WebMercatorTilingScheme:xIe.GeographicTilingScheme});t.customMap=_,t._viewer.mapCollection.add(_)}}else if("PROJ_PROVIDER"===i.type){a=i.properties.relProjId;var g=new e({parentAssembly:i,viewer:t._viewer,guid:a,access_token:t.access_token,parentMatrix:t.parentMatrix.clone(),drawEdge:t._drawEdge,skyBox:t._skyBox,isMobile:t.isMobile,luminanceAtZenith:t._luminanceAtZenith,maxSearchTreeDepth:t._maxSearchTreeDepth,parentProject:t,maximumScreenSpaceError:t._maximumScreenSpaceError,openlocal:t._openlocal,localPath:t._localPath});t._projectList.push(g),x.push(g.loadAssemblies())}else"3D_TILES"===i.type&&(a=i.properties.baseUrl);var v={id:i.id,componentIds:i.componentIds,matrix:r,externalMatrix:n,border:i.border,bottom:i.bottom,height:i.height,path:a,version:i.version,type:i.type,borderInfos:i.properties&&i.properties.borderInfos,clusterInfo:i.properties&&i.properties.clusterInfo,properties:i.properties};if(i.border&&("RES"===i.type&&console.log(i),"PROJ_PROVIDER"!==i.type&&"TILE_PROVIDER"!==i.type&&"RES"!==i.type)){var b=UIe(v),y=b.boundingSphere,w=b.positions;return w&&w.forEach((function(e){E.push(e)})),LIe({boundingSphere:y,positions:w},v)}return v})):console.warn("CIM工程assemblyList不存在");break;case"BIM":u.a(r.projAssemblyList)?r.projAssemblyList.map((function(i){var n=i.project,a=n.properties?n.properties.Param_LevelInfoMap:null,o=[];if(a){var s=JSON.parse(a);for(var c in s)if(o.length>0){for(var l=!0,h=0;h<o.length;h++)if(s[c].order<o[h].order){var d=LIe({name:c},s[c]);o.splice(h,0,d),l=!1;break}if(l){var f=LIe({name:c},s[c]);o.push(f)}}else{var p=LIe({name:c},s[c]);o.push(p)}}var m,_=function(e,t){for(var i=0;i<e.length;i++)if(e[i].id===t)return e[i]}(r.project.assignProj,n.id),g=Be.fromArray(_.matrix,0,new Be),v=n.properties?n.properties.Param_ProjZhuanYeType:null;if(v)for(var b in bIe)if(bIe[b]===v.toLowerCase()){m=bIe[b];break}if("MODEL"===n.type||"DWG"===n.type)if(u.a(i.assemblyList)){var y=[],w=i.assemblyList.map((function(e){var t,i=Be.fromArray(e.matrix,0,new Be);u.a(e.externalMatrix)&&(t=Be.fromArray(e.externalMatrix,0,new Be));var n={id:e.id,componentIds:e.componentIds,matrix:i,externalMatrix:t,border:e.border,bottom:e.bottom,height:e.height,path:e.path,version:e.version,type:e.type,clusterInfo:e.properties&&e.properties.clusterInfo,properties:e.properties},r=UIe(n),a=r.boundingSphere,o=r.positions;return o&&o.forEach((function(e){E.push(e),y.push(e)})),LIe({boundingSphere:a,positions:o},n)})),O=new e({parentAssembly:t.parentAssembly,viewer:t._viewer,guid:n.id,name:n.name,version:n.version,major:m,access_token:t.access_token,assemblies:w,originMatrix:t.originMatrix,type:n.type,origin:t._origin,assignProjectMatrix:g,drawEdge:t._drawEdge,skyBox:t._skyBox,isMobile:t.isMobile,luminanceAtZenith:t._luminanceAtZenith,maxSearchTreeDepth:t._maxSearchTreeDepth,parentProject:t,maximumScreenSpaceError:t._maximumScreenSpaceError,openlocal:t._openlocal,localPath:t._localPath});O._boundingSphereLocal=St.fromPoints(y,new St),O._originalMatrix=Be.multiply(t.originMatrix,g,new Be),O._boundingSphereLocalOld=O._boundingSphereLocal.clone(),u.a(O.parentAssembly)?O._externalMatrix=Be.fromArray(O.parentAssembly.matrix,0,new Be):O._externalMatrix=Be.IDENTITY.clone(),O._floors=o,t._projectList.push(O)}else console.warn("MODEL工程assemblyList不存在");else if("3DTILES"===n.type)if(u.a(i.assemblyList)){var x=JSON.parse(n.properties.Param_BimResBox),T=new St(new z(x[0][0],x[0][1],x[0][2]),1);x.forEach((function(e){St.expand(T,new z(e[0],e[1],e[2]),T)}));var C=i.assemblyList.map((function(e){var t,i=Be.fromArray(e.matrix,0,new Be);return u.a(e.externalMatrix)&&(t=Be.fromArray(e.externalMatrix,0,new Be)),{id:e.id,componentIds:e.componentIds,matrix:i,externalMatrix:t,border:e.border,bottom:e.bottom,height:e.height,path:e.path,version:e.version,type:e.type,borderInfos:e.properties&&e.properties.borderInfos,clusterInfo:e.properties&&e.properties.clusterInfo,properties:e.properties}})),S=new e({parentAssembly:t.parentAssembly,viewer:t._viewer,guid:n.id,name:n.name,version:n.version,major:m,access_token:t.access_token,assemblies:C,originMatrix:t.originMatrix,type:n.type,origin:t._origin,assignProjectMatrix:g,drawEdge:t._drawEdge,skyBox:t._skyBox,isMobile:t.isMobile,luminanceAtZenith:t._luminanceAtZenith,maxSearchTreeDepth:t._maxSearchTreeDepth,parentProject:t,maximumScreenSpaceError:t._maximumScreenSpaceError,openlocal:t._openlocal,localPath:t._localPath});S._boundingSphereLocal=T.clone(),S._originalMatrix=Be.multiply(t.originMatrix,g,new Be),S._boundingSphereLocalOld=S._boundingSphereLocal.clone(),u.a(S.parentAssembly)?S._externalMatrix=Be.fromArray(S.parentAssembly.matrix,0,new Be):S._externalMatrix=Be.IDENTITY.clone(),St.transform(S._boundingSphereLocal,S._externalMatrix,S._boundingSphereLocal),S.boundingSphere=S._boundingSphereLocal.clone(),Be.multiplyByPoint(S._originalMatrix,S.boundingSphere.center,S.boundingSphere.center),S._floors=o,t._projectList.push(S)}else console.warn("分级加载工程assemblyList不存在")})):console.warn("BIM工程projAssemblyList不存在")}if(E.length>0){var T=Fc.fromPoints(E,new Fc);t.boundingSphere=new St,St.fromOrientedBoundingBox(T,t.boundingSphere),St.transform(t.boundingSphere,t.originMatrix,t.boundingSphere),console.log(t._type,t.boundingSphere.clone())}Promise.all(x).then((function(e){var n;if("3DTILES"===o)n=t.boundingSphere;else if("BIM"===o){var r=t._projectList.map((function(e){return St.transform(e._boundingSphereLocalOld,e.assignProjectMatrix,new St)}));r=r.filter((function(e){return e})),t._boundingSphereLocalOld=new St,St.fromBoundingSpheres(r,t._boundingSphereLocalOld),t._originalMatrix=t.originMatrix.clone(),u.a(t.parentAssembly)?t._externalMatrix=Be.fromArray(t.parentAssembly.matrix,0,new Be):t._externalMatrix=Be.IDENTITY.clone(),t._boundingSphereLocal=new St,St.transform(t._boundingSphereLocalOld,t._externalMatrix,t._boundingSphereLocal),t.boundingSphere=new St,St.transform(t._boundingSphereLocal,t._originalMatrix,t.boundingSphere),n=t.boundingSphere}else{var a=[];!function e(t,i){t.push(i.boundingSphere),i._projectList.forEach((function(i){u.a(i.boundingSphere)&&e(t,i)}))}(a,t),a=a.filter((function(e){return e})),n=t.boundingSphere=new St,St.fromBoundingSpheres(a,t.boundingSphere),console.log(t._type,t.boundingSphere.clone())}if(u.a(t.defaultPresetView)){var s=z.distance(t._origin,t.defaultPresetView.position);n.radius>s?(t.defaultRange=2*n.radius,t.maximumZoomDistance=4*n.radius,t.defaultView={boundingSphere:n,range:t.defaultRange}):(t.defaultRange=2*s,t.maximumZoomDistance=4*s,t.defaultView={boundingSphere:n,range:t.defaultRange})}else t.defaultRange=2*n.radius,t.maximumZoomDistance=4*n.radius,t.defaultView={boundingSphere:n,range:t.defaultRange};i(t)})).catch((function(e){n(e)}))})).otherwise((function(e){n(e)}))}))}},{key:"drawProject",value:function(){var e=this,t=[];u.a(this.parentComponent)&&this.parentComponent._primitives.forEach((function(e){e.show=!1})),this.modelCollection=this._viewer.cesiumViewer.scene.primitives.add(new R6),this.shadowPlanes=this._viewer.cesiumViewer.scene.primitives.add(new R6);var i=YPe.GetConfig(this._guid).then((function(t){return e.draw(t)})).otherwise((function(e){console.warn(e)}));return t.push(i),this._projectList.length>0&&this._projectList.forEach((function(e){var i=e.drawProject();i.length&&i.length>0?i.forEach((function(e){t.push(e)})):t.push(i)})),t.length>1&&Promise.all(t).then((function(t){var i=[];t.forEach((function(e){u.a(e)&&e.boundingSphere&&i.push(e.boundingSphere)}));var n=e.boundingSphere=new St;if(St.fromBoundingSpheres(i,n),console.log(e._type,e.boundingSphere.clone()),u.a(e.defaultPresetView)){var r=z.distance(e._origin,e.defaultPresetView.position);n.radius>r?(e.defaultRange=2*n.radius,e.maximumZoomDistance=4*n.radius,e.defaultView={boundingSphere:n,range:e.defaultRange}):(e.defaultRange=2*r,e.maximumZoomDistance=4*r,e.defaultView={boundingSphere:n,range:e.defaultRange})}else e.defaultRange=2*n.radius,e.maximumZoomDistance=4*n.radius,e.defaultView={boundingSphere:n,range:e.defaultRange}})),1===t.length?t[0]:t}},{key:"draw",value:function(e){var t=this,i=this._environmentMapURL,n=this._coefficients;return new Promise((function(r,a){t.webconfig=e;var o=t._lazyLoad,s=t._lazyLoadBlockSize,c=t.assemblies,l=t.access_token,h=t.originMatrix.clone();u.a(t.assignProjectMatrix)&&(u.a(t._externalMatrix)&&Be.multiplyTransformation(h,t._externalMatrix,h),Be.multiplyTransformation(h,t.assignProjectMatrix,h)),u.a(t._skyBox)&&(t._skyBox.modelMatrix=h);var d=[],p=[],m=[],_={};return t.isMobile||t._drawEdge&&DIe&&(_.dequantizeInShader=!1,_.dracoModel=!0,_.edgeWasmModule=DIe.default,_.calcEdge=!0),"MODEL"===t._type||"DWG"===t._type?function(){var e,r={asset:{version:"1.0"},root:{children:[],refine:"ADD"}},a=[];e="DWG"===t._type?f.a.createIfNeeded(FPe.server+FPe.readND+"/tileset.json"):f.a.createIfNeeded(FPe.server+FPe.readResource+"/tileset.json"),Ri.isInternetExplorer()||Ri.isEdge()?e.setQueryParameters({access_token:l}):e.headers={access_token:l};for(var o=0;o<c.length;o++){var s=c[o];if(s.path){var u=void 0;if(s.positions){s.positions.forEach((function(e){a.push(e)}));var p=Fc.fromPoints(s.positions,new Fc);u=[],Fc.pack(p,u,0),be.getColumn(p.halfAxes,2,new z).equals(z.ZERO)&&console.log(s)}var m=new Array(16);Be.pack(s.matrix,m,0);var g={boundingVolume:{box:u},transform:m,geometricError:0,content:{uri:"."+s.path}};r.root.children.push(g)}}var v=Fc.fromPoints(a,new Fc),b=[];Fc.pack(v,b,0),r.root.boundingVolume={box:b};var y,w=St.fromOrientedBoundingBox(v,new St);r.root.children.length>0&&(r.root.geometricError=w.radius,(y=new D6(LIe({tilesetJson:r,resource:e,forceMipmap:!0,modelMatrix:h,maximumScreenSpaceError:0,sphericalHarmonicCoefficients:"IOS"!==t.isMobile?n:void 0,specularEnvironmentMaps:"IOS"!==t.isMobile?i:void 0,luminanceAtZenith:t._luminanceAtZenith},_))).colorBlendMode=gX.REPLACE,t.tileset=y,t.modelCollection.add(y),d.push(y.readyPromise),y.readyPromise.then((function(e){})).otherwise((function(e){console.log(e)})))}():c.forEach((function(r){if(r.path&&"gltf"===r.path.split(".")[1]){if("MESH"===r.type&&r.path)if(o)p.push(r);else{var a=t.loadMeshPrimitive(r,h,l,n,i,e,_);a.then((function(e){m.push(St.transform(e.boundingSphere,e.modelMatrix,new St))})),d.push(a)}if("CLUSTER"===r.type)r.path&&""!==r.clusterInfo&&(t._clusterList.push({id:r.id,version:r.version,cluster:[]}),r.clusterInfo.forEach((function(a,o){var s=new Be;Be.multiplyTransformation(h,r.matrix,s);var c=f.a.createIfNeeded(FPe.server+FPe.readResource+r.path);Ri.isInternetExplorer()||Ri.isEdge()?c.setQueryParameters({access_token:l}):c.headers={access_token:l};var u=t.modelCollection.add(J0.fromGltf({id:r.id+"_"+o,url:t._openlocal?t._localPath+r.path:c,modelMatrix:s,forwardAxis:mX.X,forceMipmap:!0,dequantizeInShader:!1,luminanceAtZenith:t.luminanceAtZenith,sphericalHarmonicCoefficients:"IOS"!==t.isMobile?n:void 0,specularEnvironmentMaps:"IOS"!==t.isMobile?i:void 0}));u.readyPromise.then((function(e){m.push(St.transform(e.boundingSphere,s,new St))})),d.push(u.readyPromise),u.projectId=t.guid,u.assemblyId=r.id,u.componentId=a.guid,u.version=r.version,u._externalMatrix=Be.fromRowMajorArray(a.matrix,new Be);var p=t.createComponent(u,e,"cluster");t._clusterList[t._clusterList.length-1].cluster.push(p)})));else if("WATERMESH"===r.type){var s=Be.multiplyTransformation(h,r.matrix,new Be),c=f.a.createIfNeeded(FPe.server+FPe.readResource+r.path);Ri.isInternetExplorer()||Ri.isEdge()?c.setQueryParameters({access_token:l}):c.headers={access_token:l};var g=t.modelCollection.add(J0.fromGltf({id:r.id,url:t._openlocal?t._localPath+r.path:c,modelMatrix:s,forwardAxis:mX.X,forceMipmap:!0,dequantizeInShader:!1,luminanceAtZenith:t.luminanceAtZenith,opaquePass:lM.WATER}));if(g.projectId=t.projectId,g.componentId=r.componentIds[0],g.version=r.version,g._externalMatrix=r.externalMatrix,g._matrix=r.matrix,e&&e[g.componentId]&&(g.webconfig=e[g.componentId]),g.readyPromise.then((function(e){m.push(St.transform(e.boundingSphere,s,new St))})),d.push(g.readyPromise),g.webconfig&&g.webconfig.groupId){var v=t.getComponentById(g.webconfig.groupId);v?v.addPrimitive(g):(v=new mIe({guid:g.webconfig.groupId,project:t,primitives:[g]}),t._components.push(v))}else{var b=t.getComponentById(g.componentId);b?b.addPrimitive(g):(b=new mIe({guid:g.componentId,project:t,primitives:[g]}),t._components.push(b))}}}else if(r.path&&"json"===r.path.split(".")[1]){if("CLUSTER"===r.type){if(r.path&&""!==r.clusterInfo){var w,O,x=[],E={guids:[]};e&&(E.webconfig=[]);var T={};r.clusterInfo.forEach((function(t,i){var n=new Be,a=new Be;Be.multiplyTransformation(h,r.matrix,n),Be.fromRowMajorArray(t.matrix,a);var o=new Be;Be.multiplyTransformation(n,a,o),x.push({modelMatrix:o});var s=u.a(t.guid)&&""!==t.guid?t.guid:Mg();E.guids.push(s),e&&(w=e[s],E.webconfig.push(w)),w&&w.groupId&&((O=T[w.groupId])||(O=i,T[w.groupId]=O))}));var C=new GSe({url:t._openlocal?t._localPath+r.path:FPe.server+FPe.readResource+r.path,instances:x,dequantizeInShader:!1,luminanceAtZenith:t.luminanceAtZenith,sphericalHarmonicCoefficients:"IOS"!==t.isMobile?n:void 0,specularEnvironmentMaps:"IOS"!==t.isMobile?i:void 0,batchTable:E,originMatrix:h,staticTilesets:t.staticTilesets,access_token:l});t.modelCollection.add(C),m.push(new St(t.origin,100))}}else if("LBTILE_PROVIDER"===r.type){var S=f.a.createIfNeeded(FPe.server+FPe.readND+r.path);Ri.isInternetExplorer()||Ri.isEdge()?S.setQueryParameters({access_token:l}):S.headers={access_token:l};var A=new zse(LIe({url:t._openlocal?t._localPath+r.path:S,forceMipmap:!0,modelMatrix:h,sphericalHarmonicCoefficients:"IOS"!==t.isMobile?n:void 0,specularEnvironmentMaps:"IOS"!==t.isMobile?i:void 0,luminanceAtZenith:t._luminanceAtZenith,maximumScreenSpaceError:t._maximumScreenSpaceError},_));A.colorBlendMode=gX.REPLACE,t.tileset=A,t.modelCollection.add(A),d.push(A.readyPromise),A.readyPromise.then((function(e){Be.multiply(t._originalMatrix,t._externalMatrix,e.modelMatrix)}))}}else if("WATERMESH"===r.type){var P=[];r.properties.polygonInfo.forEach((function(e){P.push(new z(e[0],e[1],e[2]))}));var I=t.modelCollection.add(new nIe({geometryInstances:new Mu({geometry:new cm({polygonHierarchy:new uT(P)}),id:"water_"+r.id}),appearance:new Yj({material:new qj({fabric:{type:"Image",uniforms:{image:y("Assets/Textures/waterNormals.jpg")}}})}),modelMatrix:h}));if(I.projectId=t.projectId,I.componentId=r.componentIds[0],e&&e[I.componentId]&&(I.webconfig=e[I.componentId]),I.readyPromise.then((function(e){m.push(St.transform(e.boundingSphere,modelMatrix,new St))})),d.push(I.readyPromise),I.webconfig&&I.webconfig.groupId){var D=t.getComponentById(I.webconfig.groupId);D?D.addPrimitive(I):(D=new mIe({guid:I.webconfig.groupId,project:t,primitives:[I]}),t._components.push(D))}else{var j=t.getComponentById(I.componentId);j?j.addPrimitive(I):(j=new mIe({guid:I.componentId,project:t,primitives:[I]}),t._components.push(j))}}else if("3D_TILES"===r.type){var M=f.a.createIfNeeded(r.path+"/tileset.json");Ri.isInternetExplorer()||Ri.isEdge()?M.setQueryParameters({access_token:l}):M.headers={access_token:l};var R=new zse(LIe({url:r.path+"/tileset.json",forceMipmap:!0,sphericalHarmonicCoefficients:"IOS"!==t.isMobile?n:void 0,specularEnvironmentMaps:"IOS"!==t.isMobile?i:void 0,luminanceAtZenith:t._luminanceAtZenith},_));R.colorBlendMode=gX.REPLACE,t.tileset=R,t.modelCollection.add(R),d.push(R.readyPromise),R.readyPromise.then((function(e){t.boundingSphere=e.boundingSphere,t._boundingSphereLocal=new St,St.transform(t.boundingSphere,Be.inverse(h,new Be),t._boundingSphereLocal)})),R.lbtype="3D_TILES";var L=r.borderInfos;if(L&&L.length>0){var N=t._viewer.cesiumViewer.scene.modelPlanishCollection;N.addBorderInfos(L),N.infos.forEach((function(e,i){var n=t.modelCollection.add(new tB({geometryInstances:new Mu({geometry:new lT({polygonHierarchy:new uT(e.border),extrudedHeight:e.bottom+e.height,height:e.bottom-(e.flatten?.4:0),vertexFormat:$j.VERTEX_FORMAT}),attributes:{color:df.fromColor(uf.WHITE.withAlpha(0)),show:new sA(!0)},id:i}),classificationType:iM.CESIUM_3D_TILE}));n.projectId=t.guid;var r=new mIe({guid:i,project:t,primitives:[n]});t._components.push(r)}))}}})),o&&function(){console.time("lazyLoad");for(var r=new Promise((function(e,t){e(0)})),a=0,o=0;o<p.length;)r&&(r=new Promise((function(o,c){r.then((function(r){for(var c=[],u=r;u<r+s&&!(u>=p.length);u++){var d=p[u],f=t.loadMeshPrimitive(d,h,l,n,i,e,_,500);f.then((function(e){m.push(St.transform(e.boundingSphere,e.modelMatrix,new St))})),c.push(f)}Promise.all(c).then((function(e){a+=e.length,console.log("已加载"+a),o(a)}))}))}))),o+=s;r.then((function(e){console.log("加载完成，共"+e),console.timeEnd("lazyLoad"),t._lazyLoadCompleteEvent.raiseEvent()}))}(),Promise.all(d).then((function(e){u.a(t.boundingSphere)||m.length>0&&(t.boundingSphere=new St,St.fromBoundingSpheres(m,t.boundingSphere),t._boundingSphereLocal=new St,St.transform(t.boundingSphere,Be.inverse(h,new Be),t._boundingSphereLocal));var i=0;e.forEach((function(e){(e instanceof D6||e instanceof zse)&&(i++,e.initialTilesLoaded.addEventListener((function(){if("3D_TILES"!==e.lbtype&&t._viewer.shadowPlaneCount<1&&t._enableShadowPlane){var i=t._viewer._currentShadowPlane=new PSe({viewer:t._viewer.cesiumViewer,model:e});t.shadowPlanes.add(i),t._viewer.shadowPlaneCount++}r(t)})))})),0===i&&r(t)})).catch((function(e){console.warn(e),a(t)}))}))}},{key:"forceRender",value:function(){this._viewer.cesiumViewer.scene.requestRenderMode&&(this._viewer.cesiumViewer.scene._taaEnabled&&(fx.historicalInvalid=!0),this._viewer.cesiumViewer.scene.requestRender())}},{key:"getComponentById",value:function(e){for(var t=0;t<this._components.length;t++)if(this._components[t].guid===e)return this._components[t]}},{key:"loadMeshPrimitive",value:function(e,t,i,n,r,a,o,s){var c=f.a.createIfNeeded(FPe.server+FPe.readResource+e.path);Ri.isInternetExplorer()||Ri.isEdge()?c.setQueryParameters({access_token:i}):c.headers={access_token:i};var l=this.modelCollection.add(J0.fromGltf(LIe({id:e.id,url:this._openlocal?this._localPath+e.path:c,modelMatrix:t,forwardAxis:mX.X,forceMipmap:!0,dequantizeInShader:!1,luminanceAtZenith:this._luminanceAtZenith,sphericalHarmonicCoefficients:"IOS"!==this.isMobile?n:void 0,specularEnvironmentMaps:"IOS"!==this.isMobile?r:void 0,lazyLoadBlockSize:s,viewerId:this._viewerId},o)));return l.projectId=this.guid,l.componentId=e.componentIds[0],l.version=e.version,l._externalMatrix=e.matrix,this.createComponent(l,a),l.readyPromise}},{key:"createComponent",value:function(t,i,n){var r;if(i&&i[t.componentId]&&(t.webconfig=i[t.componentId]),t.webconfig&&t.webconfig.groupId?(r=this.getComponentById(t.webconfig.groupId))?r.addPrimitive(t):(r=new mIe({guid:t.webconfig.groupId,project:this,primitives:[t],type:this.type,assemblyType:n}),this._components.push(r)):(r=this.getComponentById(t.componentId))?r.addPrimitive(t):(r=new mIe({guid:t.componentId,project:this,primitives:[t],type:this.type,assemblyType:n}),this._components.push(r)),!u.a(r.subProject)&&t.webconfig&&t.webconfig.subProjectIds){var a=new e({guid:t.webconfig.subProjectIds[1],parentMatrix:this.parentMatrix,viewer:this._viewer,access_token:this.access_token,skyBox:this._skyBox,luminanceAtZenith:this._luminanceAtZenith,drawEdge:this._drawEdge,parentComponent:r,parentProject:this,maximumScreenSpaceError:this._maximumScreenSpaceError,openlocal:this._openlocal,localPath:this._localPath});r._subProject=a}return r}},{key:"updateStyle",value:function(e){var t=this;if(this._projectList.length>0&&(u.a(e)?this._projectList.forEach((function(i){e===i.guid&&(i.idHighlightPairs=t.idHighlightPairs,i.typeHighlightPairs=t.typeHighlightPairs,i.idColorPairs=t.idColorPairs,i.isBlock=t.isBlock,i.hasIsolatedComponents=t.hasIsolatedComponents,i.isolatedIds=t.isolatedIds,i.isolatedTypeStringColorPairs=t.isolatedTypeStringColorPairs,i.typeStringColorPairs=t.typeStringColorPairs,i.typeHideStrings=t.typeHideStrings,i.idHideStrings=t.idHideStrings,i.hideAllComponents=t.hideAllComponents,i._isHide=t._isHide,i.updateStyle())})):this._projectList.forEach((function(e){e.idHighlightPairs=t.idHighlightPairs,e.typeHighlightPairs=t.typeHighlightPairs,e.idColorPairs=t.idColorPairs,e.isBlock=t.isBlock,e.hasIsolatedComponents=t.hasIsolatedComponents,e.isolatedIds=t.isolatedIds,e.isolatedTypeStringColorPairs=t.isolatedTypeStringColorPairs,e.typeStringColorPairs=t.typeStringColorPairs,e.typeHideStrings=t.typeHideStrings,e.idHideStrings=t.idHideStrings,e.hideAllComponents=t.hideAllComponents,e.updateStyle()}))),this.tileset){var i=[],n=new Set,r={};for(var a in this.idHighlightPairs.forEach((function(e){var t=e.guid,n=e.color,a=e.type,o="";if("number"==typeof n)o="rgba(${red}, ${green}, ${blue},"+n+")";else{var s=n.toBytes();o="rgba("+s[0]+","+s[1]+","+s[2]+","+n.alpha+")"}"test"===a?i.push(["regExp('"+t+"').test(${guids}) === true",,o]):r[o]?r[o].push(t):r[o]=[t]})),r)i.push(["regExp(${guids}) =~ '"+r[a].join(",")+"'",a]);if(this.typeHighlightPairs.forEach((function(e){var t=e.string,r=e.color,a="";if("number"==typeof r)a="rgba(${red}, ${green}, ${blue},"+r+")";else{var o=r.toBytes();a="rgba("+o[0]+","+o[1]+","+o[2]+","+r.alpha+")"}var s=new RegExp("[(]","g"),c=new RegExp("[)]","g");t=(t=t.replace(s,"[(]")).replace(c,"[)]"),n.has(t)||(n.add(t),i.push(["regExp('"+t+"').test(${infos}) === true",a]))})),this.hasIsolatedComponents){var o=this._defaultBlockColor.toBytes();this.isolatedIds.length>0&&i.push(["regExp(${guids}) "+(this.isBlock?"=":"!")+"~ '"+this.isolatedIds.join(",")+"'","rgba("+o[0]+","+o[1]+","+o[2]+","+this._defaultBlockColor.alpha+")"]);var s=[];this.isolatedTypeStringColorPairs.forEach((function(e){var i=new RegExp("[(]","g"),n=new RegExp("[)]","g");e=(e=e.replace(i,"[(]")).replace(n,"[)]"),s.push("regExp('"+e+"').test(${infos}) "+(t.isBlock?"===":"!==")+" true")})),s.length>0&&i.push([s.join(this.isBlock?"||":"&&"),"rgba("+o[0]+","+o[1]+","+o[2]+","+this._defaultBlockColor.alpha+")"])}for(var c in r={},this.idColorPairs.forEach((function(e){var t=e.guid,n=e.color,a=e.type,o="";if("number"==typeof n)o="rgba(${red}, ${green}, ${blue},"+n+")";else{var s=n.toBytes();o="rgba("+s[0]+","+s[1]+","+s[2]+","+n.alpha+")"}"test"===a?i.push(["regExp('"+t+"').test(${guids}) === true",o]):r[o]?r[o].push(t):r[o]=[t]})),r)i.push(["regExp(${guids}) =~ '"+r[c].join(",")+"'",c]);n.clear(),this.typeStringColorPairs.forEach((function(e){var t=e.string,r=e.color,a="";if("number"==typeof r)a="rgba(${red}, ${green}, ${blue},"+r+")";else{var o=r.toBytes();a="rgba("+o[0]+","+o[1]+","+o[2]+","+r.alpha+")"}var s=new RegExp("[(]","g"),c=new RegExp("[)]","g");t=(t=t.replace(s,"[(]")).replace(c,"[)]"),n.has(t)||(n.add(t),i.push(["regExp('"+t+"').test(${infos}) === true",a]))}));var l=this.otherColor;if(l){var h=l.toBytes();i.push(["true","rgba("+h[0]+","+h[1]+","+h[2]+","+l.alpha+")"])}else i.push(["true","rgba(${red}, ${green}, ${blue},1.0)"]);var d=[];if(n.clear(),this.typeHideStrings.forEach((function(e){var i=new RegExp("[(]","g"),r=new RegExp("[)]","g");e=(e=e.replace(i,"[(]")).replace(r,"[)]"),n.has(e)||(n.add(e),d.push((t._isHide?"!":"")+"regExp('"+e+"').test(${infos})"))})),this.idHideStrings.length>0){var f="regExp(${guids}) "+(this._isHide?"!":"=")+"~'"+this.idHideStrings.join(",")+"'";d.push(f)}var p=d.join(this._isHide?"&&":"||");this.hideAllComponents&&(p=!1),kIe!==p&&(this._viewer._currentShadowPlane&&(this._viewer._currentShadowPlane._forceUpdate=!1),kIe=p),this.tileset.style=new Wse({color:{conditions:i},show:""===p||p}),this.forceRender()}}},{key:"setColorForAll",value:function(e){this._components.length>0?this._components.forEach((function(t){t.setColor(e)})):(this.idColorPairs=[{guid:".+",color:e,type:"test"}],this.updateStyle()),this._projectList.forEach((function(t){t.setColorForAll(e)}))}},{key:"resetDefaultColorForAll",value:function(){this._components.length>0?this._components.forEach((function(e){e.resetColor()})):(this.idColorPairs=[],this.typeStringColorPairs=[],this.updateStyle())}},{key:"selectAllComponents",value:function(e){this._components.length>0?this._components.forEach((function(e){e.selected||e.select()})):u.a(this.tileset)&&!this.tileset.isDestroyed()&&(this.idHighlightPairs=[{guid:".+",color:e,type:"test"}],this.updateStyle()),this._projectList.forEach((function(t){t.selectAllComponents(e)}))}},{key:"getPosition",value:function(){return this._origin}},{key:"getPropTemplateInfo",value:function(){return this._templateProps}},{key:"reset",value:function(){this.deselectAllComponents(),this.resetDefaultColorForAll(),this.clearIsolation(),this.setAllComponentsVisibility(!0),this.clearBlink()}},{key:"getFloors",value:function(){return this._floorNames}},{key:"queryComponents",value:function(){var e=this,t=arguments,i=[];if(!arguments[0])return new Promise((function(t,i){e.type===ZPe.TYPE_CIM?t(e._components):i("BIM场景构件过多，无法返回全部构件列表")}));if(ym.a(arguments[0])){if(this.type===ZPe.TYPE_CIM)return arguments[0].forEach((function(t){var n=e.getComponentById(t);n&&i.push(n)})),new Promise((function(e,t){e(i)}));var n=this._projectList.map((function(e){return YPe.listByIds(t[0],e.guid)}));return new Promise((function(t,r){Promise.all(n).then((function(n){var r,a,o;(n=n.filter((function(e){return void 0!==e}))).forEach((function(t,n){if(u.a(t)&&t.length>0){for(var s=0;s<e._projectList.length;s++)if(e._projectList[s].guid===t[0].projectId){a=e._projectList[s];break}t.forEach((function(e){a.components&&a.components.length>0&&(r=a.getComponentById(e.id)),o=(o=VIe(e)).map((function(e){return Math.round(1e3*e)/1e3})),r=new mIe({guid:e.id,project:a,infos:[e.bimId,e.floor,e.mainType,e.subType,e.name,JSON.stringify(o)]}),i.push(r)}))}})),t(i)}))}))}if("object"===MIe(arguments[0])){var r=arguments[0];if(this.type===ZPe.TYPE_CIM){u.a(r.sysNames)&&(r.sysNames=r.sysNames.join(","),r.sysName=void 0);var a=YPe.findByProperties(LIe({},r,{guid:this.guid}));return new Promise((function(t,n){a.then((function(n){u.a(n)&&n.forEach((function(t,n){var r=e.getComponentById(t.id);r&&(r._metaData=t,i.push(r))})),t(i)})).otherwise((function(e){n(e)}))}))}var o=this._projectList.map((function(e){return YPe.findByProperties(LIe({},r,{guid:e.guid}))}));return new Promise((function(t,n){Promise.all(o).then((function(n){var r,a,o;n.forEach((function(t,n){if(u.a(t)&&t.length>0){for(var s=0;s<e._projectList.length;s++)if(e._projectList[s].guid===t[0].projectId){a=e._projectList[s];break}t.forEach((function(e){a.components&&a.components.length>0&&(r=a.getComponentById(e.id)),o=(o=VIe(e)).map((function(e){return Math.round(1e3*e)/1e3})),r=new mIe({guid:e.id,project:a,infos:[e.bimId,e.floor,e.mainType,e.subType,e.name,JSON.stringify(o)]}),i.push(r)}))}})),t(i)})).catch((function(e){n(e)}))}))}}},{key:"queryComponentsByBIMGuid",value:function(e){var t=this,i=[];if(ym.a(e)){if(this.type===ZPe.TYPE_BIM){var n=this._projectList.map((function(t){return YPe.listByBIMIds(e,t.guid)}));return new Promise((function(e,r){Promise.all(n).then((function(n){var r,a,o;(n=n.filter((function(e){return void 0!==e}))).forEach((function(e,n){a=t._projectList[n],e.forEach((function(e){a.components&&a.components.length>0&&(r=a.getComponentById(e.id)),o=(o=VIe(e)).map((function(e){return Math.round(1e3*e)/1e3})),r=new mIe({guid:e.id,project:a,infos:[e.bimId,e.floor,e.mainType,e.subType,e.name,JSON.stringify(o)]}),i.push(r)}))})),e(i)}))}))}throw new h.a("只有BIM工程可以通过bimGuid查询构件")}}},{key:"getInnerProjectList",value:function(){return this.type===ZPe.TYPE_CIM?this._projectList:[]}},{key:"selectComponents",value:function(e){var t=this;if(e){if("object"!==MIe(e)||void 0===e.length)throw new h.a("请传入数组");if(!(e.length>0))throw new h.a("数组长度为0");this.type===ZPe.TYPE_CIM?(this.deselectAllComponents(),e.forEach((function(e){var i;e instanceof mIe?i=e:"string"==typeof e&&(i=t.getComponentById(e)),i.setColor(t._defaultHighLightColor,!0)}))):(this.idHighlightPairs=[],this.typeHighlightPairs=[],e.forEach((function(e){e instanceof mIe?t.idHighlightPairs.push({guid:e.guid,color:t._defaultHighLightColor}):"string"==typeof e&&t.idHighlightPairs.push({guid:e,color:t._defaultHighLightColor})})),this.updateStyle())}else this.selectAllComponents(this._defaultHighLightColor)}},{key:"selectComponentsByOption",value:function(e){var t=this;if(!u.a(e))throw new h.a("请传入筛选条件");if(ym.a(e)){if(this.type===ZPe.TYPE_CIM)throw new h.a("场景工程不支持多个筛选条件高亮");this.idHighlightPairs=[],this.typeHighlightPairs=[],e.forEach((function(e){t.selectBIMComponentsByOption(e)}))}else this.type===ZPe.TYPE_CIM?this.queryComponents(e).then((function(e){t.selectComponents(e)})):(this.idHighlightPairs=[],this.typeHighlightPairs=[],this.selectBIMComponentsByOption(e))}},{key:"selectBIMComponentsByOption",value:function(e){var t="@@";for(var i in e)"bimGuid"===i?t=e[i]+"@@":t+=e[i]+"@@";if(u.a(e.major)){for(var n=0;n<this._projectList.length;n++)if(project.major===e.major.toLowerCase()){for(var r=this._projectList[n],a=!1,o=0;o<r.typeHighlightPairs.length;o++)if(t===r.typeHighlightPairs[o].string){a=!0;break}a||(r.typeHighlightPairs.push({string:t,color:this._defaultHighLightColor}),r.updateStyle());break}}else{for(var s=!1,c=0;c<this.typeHighlightPairs.length;c++)if(t===this.typeHighlightPairs[c].string){s=!0;break}s||(this.typeHighlightPairs.push({string:t,color:this._defaultHighLightColor}),this.updateStyle())}}},{key:"deselectAllComponents",value:function(){this._projectList.length>0&&this._projectList.forEach((function(e){e.deselectAllComponents()})),this._components.length>0?this._components.forEach((function(e){e.deselect()})):(this.idHighlightPairs=[],this.typeHighlightPairs=[],this.updateStyle())}},{key:"setComponentsColor",value:function(e,t){var i=this;if(!u.a(e))throw new h.a("请传入颜色");if(t){if("object"!==MIe(t)||void 0===t.length)throw new h.a("请传入数组");if(!(t.length>0))throw new h.a("数组长度为0");this.type===ZPe.TYPE_CIM?t.forEach((function(t){var n;t instanceof mIe?n=t:"string"==typeof t&&(n=i.getComponentById(t)),n.setColor(e)})):(t.forEach((function(t){t instanceof mIe?i.idColorPairs.push({guid:t.guid,color:e}):"string"==typeof t&&i.idColorPairs.push({guid:t,color:e})})),this.updateStyle())}else this.setColorForAll(e)}},{key:"setComponentsColorByTypes",value:function(e,t,i){if(!u.a(t))throw new h.a("请传入颜色");u.a(i)?this._projectList.forEach((function(n){n.guid===i&&HIe(n,e,t)})):HIe(this,e,t,!1)}},{key:"setComponentsColorByOption",value:function(e,t){var i=this;if(!u.a(e))throw new h.a("请传入筛选条件");if(ym.a(e)){if(this.type===ZPe.TYPE_CIM)throw new h.a("场景工程不支持多个筛选条件");e.forEach((function(e){i.setBIMComponentsColorByOption(e,t)}))}else this.type===ZPe.TYPE_CIM?this.queryComponents(e).then((function(e){i.setComponentsColor(t,e)})):this.setBIMComponentsColorByOption(e,t)}},{key:"setBIMComponentsColorByOption",value:function(e,t){var i="@@";for(var n in e)"bimGuid"===n?i=e[n]+"@@":i+=e[n]+"@@";if(u.a(e.major)){for(var r=0;r<this._projectList.length;r++)if(project.major===e.major.toLowerCase()){for(var a=this._projectList[r],o=!1,s=0;s<a.typeStringColorPairs.length;s++)if(i===a.typeStringColorPairs[s].string){o=!0;break}o||(a.typeStringColorPairs.push({string:i,color:t}),a.updateStyle());break}}else{for(var c=!1,l=0;l<this.typeStringColorPairs.length;l++)if(i===this.typeStringColorPairs[l].string){c=!0;break}c||(this.typeStringColorPairs.push({string:i,color:t}),this.updateStyle())}}},{key:"resetComponentsDefaultColorByOption",value:function(e){var t=this;if(!u.a(e))throw new h.a("请传入筛选条件");if(ym.a(e)){if(this.type===ZPe.TYPE_CIM)throw new h.a("场景工程不支持多个筛选条件");e.forEach((function(e){t.resetBIMComponentsDefaultColorByOption(e)}))}else this.type===ZPe.TYPE_CIM?this.queryComponents(e).then((function(e){t.resetComponentsDefaultColor(e)})):this.resetBIMComponentsDefaultColorByOption(e)}},{key:"resetBIMComponentsDefaultColorByOption",value:function(e){var t="@@";for(var i in e)"bimGuid"===i?t=e[i]+"@@":t+=e[i]+"@@";if(u.a(e.major)){for(var n=0;n<this._projectList.length;n++)if(project.major===e.major.toLowerCase())for(var r=this._projectList[n],a=0;a<r.typeStringColorPairs.length;a++)if(r.typeStringColorPairs[a].string===t){r.typeStringColorPairs.splice(a,1),r.updateStyle();break}}else for(var o=0;o<this.typeStringColorPairs.length;o++)if(t===this.typeStringColorPairs[o].string){this.typeStringColorPairs.splice(o,1),this.updateStyle();break}}},{key:"resetComponentsDefaultColor",value:function(e){var t=this;if(e){if("object"!==MIe(e)||void 0===e.length)throw new h.a("请传入数组");if(!(e.length>0))throw new h.a("数组长度为0");if(this.type===ZPe.TYPE_CIM)e.forEach((function(e){var i;e instanceof mIe?i=e:"string"==typeof e&&(i=t.getComponentById(e)),i.resetColor()}));else{var i=this.idColorPairs;e.forEach((function(e){var t;e instanceof mIe?t=e.guid:"string"==typeof e&&(t=e);for(var n=0;n<i.length;n++)if(i[n].guid===t){i.splice(n,1);break}})),this.updateStyle()}}else this.resetDefaultColorForAll()}},{key:"setComponentsVisiblity",value:function(e,t){var i=this;if(void 0===e)throw new h.a("请填写bVisible参数");if(e&&!0===this.hideAllComponents&&(this.hideAllComponents=!1),t){if("object"!==MIe(t)||void 0===t.length)throw new h.a("请传入数组");if(!(t.length>0))throw new h.a("数组长度为0");this.type===ZPe.TYPE_CIM?t.forEach((function(t){var n;t instanceof mIe?n=t:"string"==typeof t&&(n=i.getComponentById(t)),n.setVisibility(e)})):(this._isHide?t.forEach((function(t){var n;t instanceof mIe?n=t.guid:"string"==typeof t&&(n=t);var r=i.idHideStrings.indexOf(n);-1!==r?e&&i.idHideStrings.splice(r,1):e||i.idHideStrings.push(n)})):t.forEach((function(t){var n;t instanceof mIe?n=t.guid:"string"==typeof t&&(n=t);var r=i.idHideStrings.indexOf(n);-1!==r?e||i.idHideStrings.splice(r,1):e&&i.idHideStrings.push(n)})),this.updateStyle())}else this.setAllComponentsVisibility(e)}},{key:"setComponentsVisibilityByTypes",value:function(e,t,i){if(!u.a(t))throw new h.a("请传入bVisible");u.a(i)?this._projectList.forEach((function(n){n.guid===i&&GIe(n,e,t)})):this._projectList.forEach((function(i){GIe(i,e,t)}))}},{key:"setComponentsVisibilityByOption",value:function(e,t){var i=this;if(!u.a(e))throw new h.a("请传入options属性");if(ym.a(e)&&0===e.length)throw new h.a("传入options为空数组");if(!u.a(t))throw new h.a("请传入bVisible属性");if(t&&!0===this.hideAllComponents&&(this.hideAllComponents=!1),!u.a(e))throw new h.a("请传入筛选条件");if(ym.a(e)){if(this.type===ZPe.TYPE_CIM)throw new h.a("场景工程不支持多个筛选条件");this.setBIMComponentsVisibilityByOption(e,t)}else this.type===ZPe.TYPE_CIM?this.queryComponents(e).then((function(e){i.setComponentsVisiblity(t,e)})):this.setBIMComponentsVisibilityByOption(e,t)}},{key:"setBIMComponentsVisibilityByOption",value:function(e,t){var i=this;if(ym.a(e))e.forEach((function(e){var n="@@";for(var r in e)"bimGuid"===r?n=e[r]+"@@":n+=e[r]+"@@";i.modifyTypeHideStrings(n,t,i)})),this.updateStyle();else{var n="@@";for(var r in e)"bimGuid"===r?n=e[r]+"@@":n+=e[r]+"@@";if(u.a(e.major)){for(var a=0;a<this._projectList.length;a++)if(project.major===e.major.toLowerCase()){var o=this._projectList[a];this.modifyTypeHideStrings(n,t,o),o.updateStyle();break}}else this.modifyTypeHideStrings(n,t,this),this.updateStyle()}}},{key:"modifyTypeHideStrings",value:function(e,t,i){if((i=w.a(i,this))._isHide){for(var n=-1,r=0;r<i.typeHideStrings.length;r++)if(e===i.typeHideStrings[r]){n=r;break}-1===n?t||i.typeHideStrings.push(e):t&&i.typeHideStrings.splice(n,1)}else{for(var a=-1,o=0;o<i.typeHideStrings.length;o++)if(e===i.typeHideStrings[o]){a=o;break}-1===a?t&&i.typeHideStrings.push(e):t||i.typeHideStrings.splice(a,1)}}},{key:"setAllComponentsVisibility",value:function(e){this.type===ZPe.TYPE_CIM?this._components.forEach((function(t){return t.setVisibility(e)})):(this.idHideStrings=[],this.typeHideStrings=[],this._isHide=e,this.hideAllComponents=!e,this.updateStyle(!0)),this._projectList.forEach((function(t){t.setAllComponentsVisibility(e)}))}},{key:"setVisiblityFromTree",value:function(e){for(var t=this,i=e,n=e.level;n>0;n--)i=i.getParentNode();this.floorConfig&&this.floorConfig.length>0?(this.typeHideStrings=[],i.children.forEach((function(e){e.isChecked?e.children.forEach((function(e){t.appendReg(e,1,"")})):e.children.forEach((function(e){t.typeHideStrings.push("@@"+e.realFloor+"@@.+")}))})),this.updateStyle()):this._projectList.forEach((function(t){t.guid===i.projectId&&(i.isChecked?(t.tileset.show=!0,i!==e?(t.typeHideStrings=[],i.children.forEach((function(e){t.appendReg2(e,0,"")})),t.updateStyle()):(t.typeHideStrings=[],t.updateStyle())):t.tileset.show=!1)}))}},{key:"setComponentsColorFromTree",value:function(e,t){var i=4===e.level?e.id:"";if(this.resetComponentsDefaultColor(),0!==e.level){if(1!==e.level)if(""===i){for(var n=["floor","main_type","sub_type","name"],r=e,a=[],o={},s=e.level;s>0;s--){if(a.push(r.name),r.realFloor){a.push(r.realFloor);break}r=r.getParentNode()}a.length>0?(a=a.reverse()).forEach((function(e,t){o[n[t]]=e})):o=void 0,o&&this.setComponentsColorByOption(o,t)}else this.setComponentsColor(t,[i]);else if(e.mapping&&e.mapping.length>0){var c=e.mapping.map((function(e){return{floor:e}}));this.setComponentsColorByOption(c,t)}}else e.projectId===this.guid?this.setComponentsColor(t):this._projectList.forEach((function(i){e.projectId===i.guid&&i.setComponentsColor(t)}))}},{key:"appendReg",value:function(e,t,i,n){var r=this;t>1?(i+=e.name,i+="@@"):1===t&&(i+=e.realFloor+"@@"+e.name,i+="@@"),!e.isChecked&&t>0?this.typeHideStrings.push("@@"+i+".+"):++t<this._maxSearchTreeDepth&&e.children.forEach((function(e){r.appendReg(e,t,i,n)}))}},{key:"appendReg2",value:function(e,t,i){var n=this;i+=e.name,i+="@@",e.isChecked?++t<this._maxSearchTreeDepth&&e.children.forEach((function(e){n.appendReg2(e,t,i)})):this.typeHideStrings.push("@@"+i+".+")}},{key:"getTreeStructure",value:function(){var e=this;if(this.type!==ZPe.TYPE_BIM)throw new h.a("CIM工程没有构件树");return YPe.PropertiesTreeStructure(this.guid).then((function(t){var i=[];return u.a(e.floorConfig)&&e.floorConfig.length>0?(e.floorConfig.forEach((function(e,n){if(i[n]={name:e.floor_name,children:[],mapping:[]},e.mapping)e.mapping.forEach((function(e){var r=!0,a=!1,o=void 0;try{for(var s,c=function(){var t=s.value;if(t.projectId===e.id)return t.children.filter((function(t){return e.floor_list.includes(t.name)})).forEach((function(e){e.children.forEach((function(r){r.projectId=t.projectId,r.realFloor=e.name,i[n].mapping.push(e.name),i[n].children.push(r)}))})),"break"},l=t[Symbol.iterator]();!(r=(s=l.next()).done)&&"break"!==c();r=!0);}catch(e){a=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw o}}}));else{var r=!0,a=!1,o=void 0;try{for(var s,c=function(){var t=s.value,r=t.children.filter((function(t){return t.name==e.floor_name}));if(void 0!==r[0])return r[0].children.forEach((function(i){i.projectId=t.projectId,i.realFloor=e.floor_name})),i[n]=LIe({},i[n],{},r[0]),i[n].mapping.push(e.floor_name),"break"},l=t[Symbol.iterator]();!(r=(s=l.next()).done)&&"break"!==c();r=!0);}catch(e){a=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw o}}}})),new Promise((function(t,n){t({name:e.name,children:i,projectId:e.guid})}))):(t.forEach((function(t){for(var i=e._projectList,n=0;n<i.length;n++)if(i[n].guid===t.projectId){t.children=i[n]._floors.map((function(e){for(var i=0;i<t.children.length;i++)if(e.name===t.children[i].name)return t.children[i].mapping=[e.name],t.children[i].children.forEach((function(i){i.projectId=t.projectId,i.realFloor=e.name})),t.children[i]}));break}})),new Promise((function(e,i){e(t)})))}))}},{key:"getComponentFromTree",value:function(e){var t=!0,i=!1,n=void 0;try{for(var r,a=this._projectList[Symbol.iterator]();!(t=(r=a.next()).done);t=!0){var o=r.value;if(e.projectId===o.guid){if(console.log(e.projectId),o.components&&o.components.length>0)return o.getComponentById(e.id);var s=VIe(e);return s=s.map((function(e){return Math.round(1e3*e)/1e3})),new mIe({guid:e.id,project:o,infos:[e.bimId,e.floor,e.mainType,e.subType,e.name,JSON.stringify(s)]})}}}catch(e){i=!0,n=e}finally{try{t||null==a.return||a.return()}finally{if(i)throw n}}}},{key:"isolateComponents",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e)throw new h.a("请填写components参数");if(ym.a(e)){if(e.length>0)return new Promise((function(n){if(t.isBlock=i,t.hasIsolatedComponents=!0,t.type===ZPe.TYPE_CIM)if(e[0]instanceof mIe)i?t._components.forEach((function(i){e.includes(i)&&(i.isIsolated=!0,i.setColor(t._defaultBlockColor),t._notPickableComponents.push(i))})):t._components.forEach((function(i){e.includes(i)?i.isIsolated=!0:(i.setColor(t._defaultBlockColor),t._notPickableComponents.push(i))}));else{if("string"!=typeof e[0])throw new h.a("components数组元素类型必须为Component或者String");i?t._components.forEach((function(i){var n=i.guid;e.includes(n)&&(i.isIsolated=!0,i.setColor(t._defaultBlockColor),t._notPickableComponents.push(i))})):t._components.forEach((function(i){var n=i.guid;e.includes(n)?i.isIsolated=!0:(i.setColor(t._defaultBlockColor),t._notPickableComponents.push(i))}))}else t.isolatedIds=[],t.isolatedTypeStringColorPairs=[],t._notPickableComponents=[],e.forEach((function(e){e instanceof mIe?t.isolatedIds.push(e.guid):"string"==typeof e&&t.isolatedIds.push(e)})),t.updateStyle();n(!0)}));throw new h.a("数组长度为0")}throw new h.a("请传入数组")}},{key:"isolateComponentsByTypes",value:function(e,t,i){if(!u.a(e))throw new h.a("请传入ruleString");this.isBlock=t,this.hasIsolatedComponents=!0,u.a(i)?this._projectList.forEach((function(n){n.guid===i&&(n.isBlock=t,n.hasIsolatedComponents=!0,qIe(n,e,t))})):qIe(this,e,t)}},{key:"isolateComponentsByOption",value:function(e,t){var i=this;if(!u.a(e))throw new h.a("请传入筛选条件");if(ym.a(e)){if(this.type===ZPe.TYPE_CIM)throw new h.a("场景工程不支持多个筛选条件");var n=[];e.forEach((function(e){var t="@@";for(var i in e)"major"!==i&&(t+=e[i]+"@@");n.push(t)})),this.isolateComponentsByTypes(n,t)}else if(this.type===ZPe.TYPE_CIM)this.queryComponents(e).then((function(e){i.isolateComponents(e,t)}));else{var r="@@";for(var a in e)"major"!==a&&(r+=e[a]+"@@");this.isolateComponentsByTypes(r,t)}}},{key:"clearIsolation",value:function(){this.isBlock=!1,this.hasIsolatedComponents=!1,this.isolatedIds=[],this.isolatedTypeStringColorPairs=[],this._notPickableComponents=[],this.type===ZPe.TYPE_CIM?this._components.forEach((function(e){e.resetColor()})):this.updateStyle()}},{key:"blinkComponents",value:function(e,t){var i=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,r=!0;this.setComponentsColor(e,t),r=!1,this.blinkTimer=setInterval((function(){r?i.setComponentsColor(e,t):i.resetComponentsDefaultColor(t),r=!r}),n)}},{key:"clearBlink",value:function(){this.blinkTimer&&clearInterval(this.blinkTimer),this.resetDefaultColorForAll()}},{key:"fadeOutComponents",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3e3;return arguments.length>2&&arguments[2],new Promise((function(n,r){if(t.type===ZPe.TYPE_CIM)!function(){var r=[];if(e[0]instanceof mIe)e.forEach((function(e){e._primitives.forEach((function(e){r.push(e)}))}));else for(var a,o=0;o<t._components.length;o++)a=t._components[o],e.includes(a.guid)&&a._primitives.forEach((function(e){r.push(e)}));var s=Date.now(),c=Date.now(),l=0,u=t._viewer.cesiumViewer.scene.postRender.addEventListener((function(){c=Date.now(),(l=c-s)<=i&&r.forEach((function(e){e.color=uf.WHITE.withAlpha(1-l/i)}))}));setTimeout((function(){u(),r.forEach((function(e){e.show=!1,e.color=uf.WHITE})),n()}),i)}();else{var a=[];e[0]instanceof mIe?e.forEach((function(e){a.push(e.guid)})):a=e;var o=Date.now(),s=Date.now(),c=0,l=t._viewer.cesiumViewer.scene.postRender.addEventListener((function(){s=Date.now(),(c=s-o)<=i&&(t.idColorPairs=a.map((function(e){return{guid:e,color:1-c/i}})),t.updateStyle())}));setTimeout((function(){l(),t.idColorPairs=[],t.idHideStrings=a,t.updateStyle(),n()}),i)}}))}},{key:"fadeInComponents",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3e3;return new Promise((function(n,r){if(t.type===ZPe.TYPE_CIM)!function(){var r=[];if(e[0]instanceof mIe)e.forEach((function(e){e._primitives.forEach((function(e){e.color=uf.WHITE.withAlpha(0),e.show=!0,r.push(e)}))}));else for(var a,o=0;o<t._components.length;o++)a=t._components[o],e.includes(a.guid)&&a._primitives.forEach((function(e){e.color=uf.WHITE.withAlpha(0),e.show=!0,r.push(e)}));var s=Date.now(),c=Date.now(),l=0,u=t._viewer.cesiumViewer.scene.postRender.addEventListener((function(){c=Date.now(),(l=c-s)<=i&&r.forEach((function(e){e.color=uf.WHITE.withAlpha(l/i)}))}));setTimeout((function(){u(),r.forEach((function(e){e.color=uf.WHITE})),n()}),i)}();else{var a=[];e[0]instanceof mIe?e.forEach((function(e){a.push(e.guid)})):a=e,t.idHideStrings=[],t.idColorPairs=a.map((function(e){return{guid:e,color:0}}));var o=Date.now(),s=Date.now(),c=0,l=t._viewer.cesiumViewer.scene.postRender.addEventListener((function(){s=Date.now(),(c=s-o)<=i&&(t.idColorPairs=a.map((function(e){return{guid:e,color:c/i}})),t.updateStyle())}));setTimeout((function(){l(),t.idColorPairs=[],t.idHideStrings=[],t.updateStyle(),n()}),i)}}))}},{key:"fadeOutComponentsByTypes",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3e3,i=arguments.length>2?arguments[2]:void 0;if(!u.a(i)){var n=this._projectList.map((function(i){return WIe(i,e,t)}));return Promise.all(n)}this._projectList.forEach((function(n){if(n.guid===i)return WIe(n,e,t)}))}},{key:"fadeInComponentsByTypes",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3e3,i=arguments.length>2?arguments[2]:void 0;if(!u.a(i)){var n=this._projectList.map((function(i){return YIe(i,e,t)}));return Promise.all(n)}this._projectList.forEach((function(n){if(n.guid===i)return YIe(n,e,t)}))}},{key:"fadeOutComponentsByOption",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3e3;if(!u.a(e))throw new h.a("请传入筛选条件");if(ym.a(e)){if(this.type===ZPe.TYPE_CIM)throw new h.a("场景工程不支持多个筛选条件");var n=[];return e.forEach((function(e){var t="@@";for(var i in e)"major"!==i&&(t+=e[i]+"@@");n.push(t)})),this.fadeOutComponentsByTypes(n,i)}if(this.type===ZPe.TYPE_CIM)return this.queryComponents(e).then((function(e){return t.fadeOutComponents(e,i)}));var r="@@";for(var a in e)"major"!==a&&(r+=e[a]+"@@");return this.fadeOutComponentsByTypes(r,i)}},{key:"fadeInComponentsByOption",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3e3;if(!u.a(e))throw new h.a("请传入筛选条件");if(ym.a(e)){if(this.type===ZPe.TYPE_CIM)throw new h.a("场景工程不支持多个筛选条件");var n=[];return e.forEach((function(e){var t="@@";for(var i in e)"major"!==i&&(t+=e[i]+"@@");n.push(t)})),this.fadeInComponentsByTypes(n,i)}if(this.type===ZPe.TYPE_CIM)return this.queryComponents(e).then((function(e){return t.fadeInComponents(e,i)}));var r="@@";for(var a in e)"major"!==a&&(r+=e[a]+"@@");return this.fadeInComponentsByTypes(r,i)}},{key:"findBIMComponentsByKeywords",value:function(e){var t=this,i=e.pageSize,n=e.pageNo,r=e.keyword,a=this._projectList.map((function(e){return e.guid}));return new Promise((function(e,o){YPe.FindBimProperties({projectId:a.join("|"),name:r,pageNo:n,pageSize:i}).then((function(i){i.list=i.list.map((function(e){var i,n=VIe(e);n=n.map((function(e){return Math.round(1e3*e)/1e3}));for(var r=0;r<t._projectList.length;r++){var a=t._projectList[r];if(e.projectId===a.guid){i=a;break}}return new mIe({guid:e.id,project:i,infos:[e.bimId,e.floor,e.mainType,e.subType,e.name,JSON.stringify(n)]})})),e(i)}))}))}},{key:"showFloors",value:function(e){var t=this,i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this._floorNames.indexOf(e);if(-1!==n)if(i){var r=function(){if(n===t.floorConfig.length-1)return t.setAllComponentsVisibility(!0),{v:void 0};var e={};t._projectList.forEach((function(t){e[t.guid]=[]}));for(var i=n+1;i<t.floorConfig.length;i++)t.floorConfig[i].mapping?t.floorConfig[i].mapping.forEach((function(t){t.floor_list.forEach((function(i){e[t.id].push("@@"+i+"@@")}))})):t.floorConfig[i].floor_name&&e[t._projectList[0].guid].push("@@"+t.floorConfig[i].floor_name+"@@");t.setAllComponentsVisibility(!0),t._projectList.forEach((function(i){e[i.guid].length>0?t.setComponentsVisibilityByTypes(e[i.guid],!1,i.guid):t.setAllComponentsVisibility(!0)}))}();if("object"===MIe(r))return r.v}else!function(){var e={};t._projectList.forEach((function(t){e[t.guid]=[]}));for(var i=0;i<t.floorConfig.length;i++){var r=t.floorConfig[i].mapping;r&&n!==i&&r.forEach((function(t){t.floor_list.forEach((function(i){e[t.id].push("@@"+i+"@@")}))}))}t._projectList.forEach((function(i){t.setComponentsVisibilityByTypes(e[i.guid],!1,i.guid)}))}()}},{key:"updateBoundingSphere",value:function(){if(u.a(this._components)&&this._components.length>0){var e=this._components.map((function(e){return e._boundingSphere}));St.fromBoundingSpheres(e,this.boundingSphere)}else u.a(this._originalMatrix)&&St.transform(this._boundingSphereLocal,this._originalMatrix,this.boundingSphere);this._projectList.forEach((function(e){e.updateBoundingSphere()}))}},{key:"translate",value:function(e){uIe.translateFromBoundingSphere(e,this._boundingSphereLocal,zIe),Be.multiply(zIe,this._externalMatrix,this._externalMatrix),u.a(this.tileset)&&Be.multiply(this._originalMatrix,this._externalMatrix,this.tileset.modelMatrix),this._projectList.forEach((function(t){t.translate(e)}))}},{key:"rotate",value:function(e){uIe.rotateFromBoundingSphere(e,this._boundingSphereLocal,zIe),Be.multiply(zIe,this._externalMatrix,this._externalMatrix),u.a(this.tileset)&&Be.multiply(this._originalMatrix,this._externalMatrix,this.tileset.modelMatrix),this._projectList.forEach((function(t){t.rotate(e)}))}},{key:"scale",value:function(e){uIe.scaleFromBoundingSphere(e,this._boundingSphereLocal,zIe),Be.multiply(zIe,this._externalMatrix,this._externalMatrix),u.a(this.tileset)&&Be.multiply(this._originalMatrix,this._externalMatrix,this.tileset.modelMatrix),this._projectList.forEach((function(t){t.scale(e)}))}},{key:"setMatrix",value:function(e){St.transform(this._boundingSphereLocalOld,e,this._boundingSphereLocal),this._externalMatrix=e.clone(),u.a(this.tileset)&&Be.multiply(this._originalMatrix,this._externalMatrix,this.tileset.modelMatrix),this._projectList.forEach((function(t){t.setMatrix(e)}))}},{key:"isDestroyed",value:function(){return!1}},{key:"destroy",value:function(){this._projectList.forEach((function(e){e.destroy()}));var e=this._viewer._projectList.indexOf(this);return e>-1&&this._viewer._projectList.splice(e,1),u.a(this.shadowPlanes)&&!this.shadowPlanes.isDestroyed()&&this.shadowPlanes.removeAll(),u.a(this.modelCollection)&&!this.modelCollection.isDestroyed()&&this.modelCollection.removeAll(),rl(this)}},{key:"guid",get:function(){return this._guid}},{key:"type",get:function(){return"CIM"===this._type||"SUBCIM"===this._type?ZPe.TYPE_CIM:ZPe.TYPE_BIM}},{key:"name",get:function(){return this._name}},{key:"version",get:function(){return this._version}},{key:"isOpened",get:function(){return this._isOpened}},{key:"lightIntensity",get:function(){return this._luminanceAtZenith},set:function(e){if(this._luminanceAtZenith=e,u.a(this.modelCollection))for(var t=0;t<this.modelCollection.length;t++)this.modelCollection.get(t).luminanceAtZenith=e;this._projectList&&this._projectList.length>0&&this._projectList.forEach((function(t){t.lightIntensity=e})),this.forceRender()}},{key:"drawEdge",get:function(){return this._drawEdge},set:function(e){this.isMobile?console.warn("移动端和IE浏览器暂时无法绘制边线"):(this._drawEdge=e,this._projectList.forEach((function(t){u.a(t.tileset)&&t.tileset instanceof D6&&(console.log(t.tileset),t.tileset._root.children.forEach((function(t){t.content._model.calcEdge=e})))})),this.forceRender())}},{key:"edgeColor",get:function(){return uf.fromCartesian4(h$._edgeColor,new uf)},set:function(e){h$._edgeColor=new Te(e.red,e.green,e.blue,e.alpha),this.forceRender()}},{key:"positionCartographic",get:function(){return K.fromCartesian(this._origin,this._viewer.cesiumViewer.scene.globe.ellipsoid,BIe)}}])&&FIe(t.prototype,i),n&&FIe(t,n),e}(),ZIe={IMAGE:"IMAGE",VECTOR:"VECTOR",TERRAIN:"TERRAIN",LABELS:"LABELS"};Object.freeze(ZIe);var QIe=ZIe;function KIe(e){return(KIe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function JIe(e,t){return!t||"object"!==KIe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function $Ie(e){return($Ie=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function eDe(e,t){return(eDe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var tDe=function(e){function t(e){var i;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),i=JIe(this,$Ie(t).call(this,e)),!u.a(e.token))throw new h.a("options.token未定义");i._token=e.token,i._mapStyle=w.a(e.mapStyle,QIe.IMAGE);i._mapStyle.indexOf("LABELS");var n,r=i._mapStyle.split("_")[0];return"IMAGE"===r?n="img":"VECTOR"===r?n="vec":"TERRAIN"===r?n="ter":"LABELS"===r&&(n="cva"),i.mapProvider=new bce({url:"http://t{s}.tianditu.gov.cn/"+n+"_c/wmts?SERVICE=WMTS&REQUEST=GetTile&VERSION=1.0.0&LAYER="+n+"&STYLE=default&TILEMATRIXSET=c&FORMAT=tiles&TILEMATRIX={newZ}&TILEROW={y}&TILECOL={x}&tk="+i._token,tilingScheme:i._tilingScheme,maximumLevel:i._maximumLevel,subdomains:["0","1","2","3","4","5","6","7"],customTags:{newZ:function(e,t,i,n){return n+1}}}),i.mapLayer=new phe(i.mapProvider),i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&eDe(e,t)}(t,e),t}(TIe);function iDe(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var nDe=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),!u.a(t.entity))throw new h.a("options.entity未定义");this._entity=t.entity,this._id=this._entity.id,u.a(this._entity.properties)&&(this._properties=this._entity.properties.getValue(Tr.now()))}var t,i,n;return t=e,(i=[{key:"id",get:function(){return this._id}},{key:"properties",get:function(){return this._properties}}])&&iDe(t.prototype,i),n&&iDe(t,n),e}();function rDe(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var aDe=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,i,n;return t=e,n=[{key:"Token",value:function(t,i){return(new e).getToken(t,i)}},{key:"ValidateToken",value:function(t){return(new e).validateToken(t)}},{key:"InitToken",value:function(t){var i=t.access_token;if(u.a(i))return e.ValidateToken(i).then((function(e){if(!e)throw new h.a("token校验失败");t.access_token=FPe.access_token=i})).otherwise((function(){throw new h.a("token校验请求失败")}));if(!u.a(t.appid))throw new h.a("未提供appid");if(!u.a(t.secret))throw new h.a("未提供secret");var n=t.appid,r=t.secret;return e.Token(n,r).then((function(e){t.access_token=FPe.access_token=e})).otherwise((function(){throw new h.a("token请求失败")}))}}],(i=[{key:"getToken",value:function(e,t){var i={};return i.url=FPe.server+FPe.token,i.queryParameters={appid:e,secret:t},qPe.get(i,!1)}},{key:"validateToken",value:function(e){var t={};return t.url=FPe.server+FPe.validateToken,t.headers=ff.a(t.headers,{access_token:e}),qPe.get(t,!1)}}])&&rDe(t.prototype,i),n&&rDe(t,n),e}();function oDe(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var sDe=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._viewer=t.view,this.enabled=!0,this._screenSpaceEventHandler=new aA(this._viewer.scene.canvas)}var t,i,n;return t=e,(i=[{key:"addEventListener",value:function(e,t,i){var n=this;this._screenSpaceEventHandler.setInputAction((function(e){n.enabled&&t(e)}),e,i)}},{key:"removeEventListener",value:function(e,t){this._screenSpaceEventHandler.removeInputAction(e)}}])&&oDe(t.prototype,i),n&&oDe(t,n),e}(),cDe={LEFT_DOWN:0,LEFT_UP:1,LEFT_CLICK:2,LEFT_DOUBLE_CLICK:3,RIGHT_DOWN:5,RIGHT_UP:6,RIGHT_CLICK:7,MIDDLE_DOWN:10,MIDDLE_UP:11,MIDDLE_CLICK:12,MOUSE_MOVE:15,WHEEL:16,PINCH_START:17,PINCH_END:18,PINCH_MOVE:19};Object.freeze(cDe);var lDe=cDe;function uDe(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var hDe=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),!u.a(t.viewer))throw new h.a("options.viewer未定义");if(!u.a(t.videoUrl)&&!u.a(t.videoElement))throw new h.a("options.videoUrl或options.videoElement未定义");this._viewer=t.viewer,this._videoUrl=t.videoUrl,this._videoWidth=t.videoWidth,this._videoHeight=t.videoHieght,this.videoElement=t.videoElement,this._near=w.a(t.near,1),this._far=w.a(t.far,100),this._viewerPosition=w.a(t.viewerPosition,new z),this._targetPosition=w.a(t.targetPosition,new z),this._heading=t.heading,this._pitch=t.pitch,this._roll=t.roll,this.init()}var t,i,n;return t=e,(i=[{key:"init",value:function(){var e=this,t=this._viewer.cesiumViewer,i=this;if(u.a(this.videoElement)){console.log(this.videoElement);var n,r=this.videoElement,a=!0,o=!1,s=void 0;try{for(var c,l=r.childNodes[Symbol.iterator]();!(a=(c=l.next()).done);a=!0){var h=c.value;if("SOURCE"===h.tagName){n=h;break}}}catch(e){o=!0,s=e}finally{try{a||null==l.return||l.return()}finally{if(o)throw s}}var d=ry.a(n.src);"mp4"===d?r.oncanplaythrough=function(n){var a=new ose(t.scene);a.frustum.fov=I.PI/4,a.frustum.aspectRatio=1,a.frustum.near=e._near,a.frustum.far=e._far;var o=new hj({context:t.scene.frameState.context,source:r}),s={context:t.scene.context,lightCamera:a,cascadesEnabled:!1,videoTexture:o,viewerPosition:i._viewerPosition,target:i._targetPosition},c=e.videoTarget=new Tye(s);u.a(e._heading)?c.setPoseByHeading(e._heading):e._heading=I.toDegrees(e.videoTarget._lightCamera.heading),u.a(e._pitch)?c.setPoseByPitch(e._pitch):e._pitch=I.toDegrees(e.videoTarget._lightCamera.pitch),u.a(e._roll)?c.setPoseByRoll(e._roll):e._roll=I.toDegrees(e.videoTarget._lightCamera.roll)}:"m3u8"===d&&(this.videoElement.oncanplaythrough=function(){var n,r,a=document.createElement("canvas");document.createElement("div").setAttribute("style","position:absolute;top:0;"),u.a(e._videoWidth)&&u.a(e._videoHeight)?(n=e._videoWidth,r=e._videoHeight):(n=parseInt(getComputedStyle(e.videoElement).width),r=parseInt(getComputedStyle(e.videoElement).height)),a.width=n,a.height=r;var o=new ose(t.scene);o.frustum.fov=I.PI/4,o.frustum.aspectRatio=1,o.frustum.near=e._near,o.frustum.far=e._far;var s=new hj({context:t.scene.frameState.context,source:a}),c={context:t.scene.context,lightCamera:o,cascadesEnabled:!1,videoTexture:s,viewerPosition:i._viewerPosition,target:i._targetPosition},l=e.videoTarget=new Tye(c);u.a(e._heading)?l.setPoseByHeading(e._heading):e._heading=I.toDegrees(e.videoTarget._lightCamera.heading),u.a(e._pitch)?l.setPoseByPitch(e._pitch):e._pitch=I.toDegrees(e.videoTarget._lightCamera.pitch),u.a(e._roll)?l.setPoseByRoll(e._roll):e._roll=I.toDegrees(e.videoTarget._lightCamera.roll)})}else if(u.a(this._videoUrl))if("mp4"===ry.a(this._videoUrl)){var f=document.createElement("video"),p=document.createElement("div");p.setAttribute("style","position:absolute;bottom:40px;visibility:hidden;"),f.setAttribute("id","example-video"),f.setAttribute("muted",""),f.setAttribute("autoplay",""),f.setAttribute("loop",""),f.setAttribute("crossorigin",""),f.setAttribute("controls","");var m=document.createElement("source");m.setAttribute("src",this._videoUrl),m.setAttribute("type","video/mp4"),f.innerHTML="Your browser does not support the <code>video</code> element.",f.appendChild(m),p.appendChild(f),t.container.appendChild(p),this.videoElement=f,this.container=p,f.oncanplaythrough=function(n){var r=new ose(t.scene);r.frustum.fov=I.PI/4,r.frustum.aspectRatio=1,r.frustum.near=e._near,r.frustum.far=e._far;var a=new hj({context:t.scene.frameState.context,source:f}),o={context:t.scene.context,lightCamera:r,cascadesEnabled:!1,videoTexture:a,viewerPosition:i._viewerPosition,target:i._targetPosition},s=e.videoTarget=new Tye(o);u.a(e._heading)?s.setPoseByHeading(e._heading):e._heading=I.toDegrees(e.videoTarget._lightCamera.heading),u.a(e._pitch)?s.setPoseByPitch(e._pitch):e._pitch=I.toDegrees(e.videoTarget._lightCamera.pitch),u.a(e._roll)?s.setPoseByRoll(e._roll):e._roll=I.toDegrees(e.videoTarget._lightCamera.roll)}}else{var _=this.imageElement=document.createElement("img");_.src=this._videoUrl,_.onload=function(){var n=new ose(t.scene);n.frustum.fov=I.PI/4,n.frustum.aspectRatio=1,n.frustum.near=e._near,n.frustum.far=e._far;var r=new hj({context:t.scene.frameState.context,source:_}),a={context:t.scene.context,lightCamera:n,cascadesEnabled:!1,videoTexture:r,viewerPosition:i._viewerPosition,target:i._targetPosition},o=e.videoTarget=new Tye(a);u.a(e._heading)?o.setPoseByHeading(e._heading):e._heading=I.toDegrees(e.videoTarget._lightCamera.heading),u.a(e._pitch)?o.setPoseByPitch(e._pitch):e._pitch=I.toDegrees(e.videoTarget._lightCamera.pitch),u.a(e._roll)?o.setPoseByRoll(e._roll):e._roll=I.toDegrees(e.videoTarget._lightCamera.roll)}}}},{key:"update",value:function(e){if(u.a(this.videoTarget)&&!this.videoTarget.isDestroyed()&&(e.viewSheds.push(this.videoTarget),this.videoElement&&this.videoElement.readyState===this.videoElement.HAVE_ENOUGH_DATA)){var t=this._viewer.cesiumViewer.scene;this.videoTarget.updateVideoTexture(this.videoTarget,this.videoElement,t.frameState,t._passState)}}},{key:"isDestroyed",value:function(){return!1}},{key:"destroy",value:function(){var e=this._viewer.cesiumViewer;return this.container&&e.container.removeChild(this.container),this.imageElement&&e.container.removeChild(this.container),this.player&&(this.player.dispose(),this.player=void 0),this.videoTarget.destroy(),rl(this)}},{key:"heading",get:function(){return this._heading},set:function(e){this._heading=e,this.videoTarget.setPoseByHeading(e)}},{key:"pitch",get:function(){return this._pitch},set:function(e){this._pitch=e,this.videoTarget.setPoseByPitch(e)}},{key:"roll",get:function(){return this._roll},set:function(e){this._roll=e,this.videoTarget.setPoseByRoll(e)}},{key:"viewerPosition",get:function(){return this._viewerPosition},set:function(e){this._viewerPosition=e,this.videoTarget.viewerPosition=e}},{key:"targetPosition",get:function(){return this._targetPosition},set:function(e){this._targetPosition=e,this.videoTarget.setPoseByTargetPoint(e)}}])&&uDe(t.prototype,i),n&&uDe(t,n),e}();function dDe(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var fDe=function(){function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{flowAngle:0,reflectFactor:.5,speed:.05,waterColor:new uf(0,128/255,128/255)};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.viewer=i.viewer;var n={viewer:this.viewer,width:5e3,height:16,flowAngle:w.a(i.flowAngle,0),reflectFactor:w.a(i.reflectFactor,.5),speed:w.a(i.speed,.05),waterColor:w.a(i.color,new uf(0,128/255,128/255))},r=this,a="";a=window.CESIUM_BASE_URL?window.CESIUM_BASE_URL+"/Assets/Textures/waterNormals.jpg":y("Assets/Textures/waterNormals.jpg"),f.a.fetchImage(a).then((function(e){var i=new hj({context:r.viewer.scene.context,width:e.width,height:e.height,source:e,sampler:new tj({wrapS:$D.REPEAT,wrapT:$D.REPEAT,minificationFilter:KD.LINEAR,magnificationFilter:ZD.LINEAR})});n.normalTexture=i;var a=new uT;n.boundingSphere=St.fromPoints(t);var o=t.map((function(e){var t=K.fromCartesian(e);return t.height+=2,K.toCartesian(t)}));a.positions=o;var s=new lT({polygonHierarchy:a,perPositionHeight:!0});n.waterPolygon=s,r.waterItem=new NAe(n),r.viewer.scene.primitives.add(r.waterItem)}))}var t,i,n;return t=e,(i=[{key:"destroy",value:function(){return u.a(this.waterItem)&&!this.waterItem.isDestroyed()&&this.viewer.scene.primitives.remove(this.waterItem),rl(this)}}])&&dDe(t.prototype,i),n&&dDe(t,n),e}();function pDe(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var mDe=Tr.fromIso8601("2020-06-20T09:00:00Z"),_De=new tf({startTime:mDe,currentTime:mDe,shouldAnimate:!0});var gDe=function(){function e(t){var i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._viewer=t.viewer,this._width=w.a(t.width,100),this._height=w.a(t.height,100),this._enableWebgl2=w.a(t.enableWebgl2,!1),this.container=t.container,this.container.innerHTML='<canvas id="motor-bimnav" width='.concat(this._width," height=").concat(this._height,">dfa</canvas>"),this.cesiumCanvas=document.getElementById("motor-bimnav"),this.creditContainer=document.createElement("div"),this.cesiumCanvas.oncontextmenu=function(e){e.preventDefault()},this.scene=new xOe({canvas:this.cesiumCanvas,creditContainer:this.creditContainer,contextOptions:{webgl:{alpha:!0,depth:!0,antialias:!0,premultipliedAlpha:!0,preserveDrawingBuffer:!1,failIfMajorPerformanceCaveat:!1},requestWebgl2:this._enableWebgl2,allowTextureFilterAnisotropic:!0}}),this.creditContainer.setAttribute("style","display:none;");var n=this.scene;n.rethrowRenderErrors=!0,n.camera.constrainedAxis=z.UNIT_Z,n.backgroundColor=uf.BLACK.withAlpha(0),this.startLoop(),this.createModels();var r=this.handler=new aA(n.canvas);r.setInputAction((function(e){i._viewer.controller.setLookAtCenter(),i.cursorPressNavBox=!0}),TS.LEFT_DOWN),r.setInputAction((function(e){i.cursorPressNavBox=!1}),TS.LEFT_UP),r.setInputAction((function(e){var t=n.pick(e.position).node.name;if(i.cursorDoubleClickNavBox=!0,"前"===t){var r=new St(i.center,0);n.camera.flyToBoundingSphere(r,{offset:new xO(0,0,i.range),duration:.5,complete:function(){i.cursorDoubleClickNavBox=!1}})}else if("后"===t){var a=new St(i.center,0);n.camera.flyToBoundingSphere(a,{offset:new xO(I.toRadians(-180),0,i.range),duration:.5,complete:function(){i.cursorDoubleClickNavBox=!1}})}else if("左"===t){var o=new St(i.center,0);n.camera.flyToBoundingSphere(o,{offset:new xO(I.toRadians(-270),0,i.range),duration:.5,complete:function(){i.cursorDoubleClickNavBox=!1}})}else if("右"===t){var s=new St(i.center,0);n.camera.flyToBoundingSphere(s,{offset:new xO(I.toRadians(-90),0,i.range),duration:.5,complete:function(){i.cursorDoubleClickNavBox=!1}})}else if("上"===t){var c=new St(i.center,0);n.camera.flyToBoundingSphere(c,{offset:new xO(0,-90,i.range),duration:.5,complete:function(){i.cursorDoubleClickNavBox=!1}})}else if("下"===t){var l=new St(i.center,0);n.camera.flyToBoundingSphere(l,{offset:new xO(0,90,i.range),duration:.5,complete:function(){i.cursorDoubleClickNavBox=!1}})}}),TS.LEFT_DOUBLE_CLICK)}var t,i,n;return t=e,(i=[{key:"isDestroyed",value:function(){return!1}},{key:"destroy",value:function(){return this.removeCallback1(),this.removeCallback2(),u.a(this.handler)&&!this.handler.isDestroyed()&&this.handler.destroy(),this.stopRenderLoop(),u.a(this.scene)&&!this.scene.isDestroyed()&&this.scene.destroy(),this._viewer.cesiumViewer.container.removeChild(this.container),rl(this)}},{key:"startRenderLoop",value:function(){var e=this.scene;e.initializeFrame();var t=_De.tick();t&&e.render(t),this.startLoop()}},{key:"startLoop",value:function(){var e=this;this.loopId=gS((function(){e.startRenderLoop()}))}},{key:"stopRenderLoop",value:function(){this.loopId&&(to(this.loopId),this.loopId=void 0)}},{key:"createModels",value:function(){var e=this,t=new Rr(0,0,0),i=xa.headingPitchRollToFixedFrame(z.fromDegrees(-100,40,100),t),n=this.scene,r=n.primitives.add(J0.fromGltf({url:y("model/webfile.glb"),modelMatrix:i,forwardAxis:mX.X}));r.readyPromise.then((function(){var t=function(e,t){var i=e.screenSpaceCameraController;i.inertiaSpin=0,i.ellipsoid=ae.UNIT_SPHERE,i.enableTilt=!1,i.enableZoom=!1;var n=t.boundingSphere.radius;i.minimumZoomDistance=0;var r=Be.multiplyByPoint(t.modelMatrix,t.boundingSphere.center,new z),a=I.toRadians(0),o=I.toRadians(0),s=2*n;return e.camera.lookAt(r,new xO(a,o,s)),{center:r,range:s}}(n,r),i=t.center,a=t.range;e.center=i,e.range=a;var o=0;e.removeCallback1=e._viewer.cesiumViewer.camera.changed.addEventListener((function(){if(!e.cursorPressNavBox){var t=e._viewer.cesiumViewer.camera,r=t.heading;t.pitch>I.toRadians(87)&&Math.abs(I.toDegrees(r)-I.toDegrees(o))>175&&(r+=(r>o?-1:1)*I.toRadians(180)),o=r,n.camera.lookAt(i,new xO(r,t.pitch,a))}}));var s=0;e.removeCallback2=n.camera.changed.addEventListener((function(){if(e.cursorPressNavBox||e.cursorDoubleClickNavBox){var t=e._viewer.cesiumViewer.camera,i=e._viewer.controller.lookAtCenter,r=xa.eastNorthUpToFixedFrame(i),a=z.distance(i,t.positionWC),o=n.camera.heading;n.camera.pitch>I.toRadians(87)&&Math.abs(I.toDegrees(o)-I.toDegrees(s))>175&&(o+=(o>s?-1:1)*I.toRadians(180)),s=o,t.lookAtTransform(r,new xO(o,n.camera.pitch,a))}}))})).otherwise((function(e){console.log(e)}))}}])&&pDe(t.prototype,i),n&&pDe(t,n),e}();function vDe(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var bDe=function(){function e(t,i){var n=this;(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._bloom=t,u.a(i))&&Object.keys(i).forEach((function(e){"viewer"===e?n.viewer=i[e]:n[e]=i[e]}))}var t,i,n;return t=e,(i=[{key:"enabled",get:function(){return this._bloom.enabled},set:function(e){this._bloom.enabled=e,this.viewer.forceRender()}},{key:"contrast",get:function(){return this._bloom.uniforms},set:function(e){this._bloom.uniforms.contrast=e,this.viewer.forceRender()}},{key:"brightness",get:function(){return this._bloom.uniforms},set:function(e){this._bloom.uniforms.brightness=e,this.viewer.forceRender()}},{key:"delta",get:function(){return this._bloom.uniforms},set:function(e){this._bloom.uniforms.delta=e,this.viewer.forceRender()}},{key:"sigma",get:function(){return this._bloom.uniforms},set:function(e){this._bloom.uniforms.sigma=e,this.viewer.forceRender()}},{key:"stepSize",get:function(){return this._bloom.uniforms},set:function(e){this._bloom.uniforms.stepSize=e,this.viewer.forceRender()}}])&&vDe(t.prototype,i),n&&vDe(t,n),e}();n(309);function yDe(e){return(yDe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function wDe(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ODe(e,t){return!t||"object"!==yDe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function xDe(e,t,i,n){return(xDe="undefined"!=typeof Reflect&&Reflect.set?Reflect.set:function(e,t,i,n){var r,a=TDe(e,t);if(a){if((r=Object.getOwnPropertyDescriptor(a,t)).set)return r.set.call(n,i),!0;if(!r.writable)return!1}if(r=Object.getOwnPropertyDescriptor(n,t)){if(!r.writable)return!1;r.value=i,Object.defineProperty(n,t,r)}else!function(e,t,i){t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i}(n,t,i);return!0})(e,t,i,n)}function EDe(e,t,i){return(EDe="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,i){var n=TDe(e,t);if(n){var r=Object.getOwnPropertyDescriptor(n,t);return r.get?r.get.call(i):r.value}})(e,t,i||e)}function TDe(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=CDe(e)););return e}function CDe(e){return(CDe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function SDe(e,t){return(SDe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ADe=function(e){function t(e){var i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=e.sources,r=e.show,a=e.specularEnvironmentMaps,o=e.sphericalHarmonicCoefficients;if((i=ODe(this,CDe(t).call(this,{sources:n,show:r})))._specularEnvironmentMaps=a,i._sphericalHarmonicCoefficients=o,u.a(i._specularEnvironmentMaps)&&!u.a(i._sphericalHarmonicCoefficients))throw new h.a("specularEnvironmentMaps存在时必须定义sphericalHarmonicCoefficients");return i}var i,n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&SDe(e,t)}(t,e),i=t,(n=[{key:"specularEnvironmentMaps",get:function(){return this._specularEnvironmentMaps}},{key:"sphericalHarmonicCoefficients",get:function(){return this._sphericalHarmonicCoefficients}},{key:"modelMatrix",get:function(){return EDe(CDe(t.prototype),"modelMatrix",this)},set:function(e){!function(e,t,i,n,r){if(!xDe(e,t,i,n||e)&&r)throw new Error("failed to set property")}(CDe(t.prototype),"modelMatrix",e,this,!0),this.viewer&&this.viewer.forceRender()}}])&&wDe(i.prototype,n),r&&wDe(i,r),t}(DOe);n(310);function PDe(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function IDe(e,t,i){var n=e[t];e[t]=e[i],e[i]=n}var DDe,jDe,MDe=function(){function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._imageryLayerCollection=t,this._maps=[i]}var t,i,n;return t=e,(i=[{key:"add",value:function(e){this._imageryLayerCollection.add(e.mapLayer),this._maps.push(e)}},{key:"remove",value:function(e){this._imageryLayerCollection.remove(e.mapLayer,!1);var t=this._maps.indexOf(e);this._maps.splice(t,1)}},{key:"removeAll",value:function(){this._imageryLayerCollection.removeAll(!1),this._maps=[]}},{key:"get",value:function(e){return this._maps[e]}},{key:"raise",value:function(e){this._imageryLayerCollection.raise(e.mapLayer);var t=this._maps.indexOf(e);IDe(this._maps,t,t+1)}},{key:"lower",value:function(e){this._imageryLayerCollection.lower(e.mapLayer);var t=this._maps.indexOf(e);IDe(this._maps,t,t-1)}},{key:"raiseToTop",value:function(e){this._imageryLayerCollection.raiseToTop(e.mapLayer);var t=this._maps.indexOf(e);this._maps.splice(t,1),this._maps.push(e)}},{key:"lowerToBottom",value:function(e){this._imageryLayerCollection.lowerToBottom(e.mapLayer);var t=this._maps.indexOf(e);this._maps.splice(t,1),this._maps.unshift(e)}}])&&PDe(t.prototype,i),n&&PDe(t,n),e}();function RDe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var i=[],n=!0,r=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(i.push(o.value),!t||i.length!==t);n=!0);}catch(e){r=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw a}}return i}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function LDe(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function NDe(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?LDe(Object(i),!0).forEach((function(t){FDe(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):LDe(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function FDe(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function kDe(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}DDe=/Android|webOS|BlackBerry/i.test(navigator.userAgent)?"Android":/iPhone|iPod|iPad/i.test(navigator.userAgent)?"IOS":void 0;var BDe,zDe=window.navigator.userAgent;zDe.indexOf("MSIE")>=0?jDe="ie":zDe.indexOf("Firefox")>=0?jDe="Firefox":zDe.indexOf("Chrome")>=0?jDe="Chrome":zDe.indexOf("Opera")>=0?jDe="Opera":zDe.indexOf("Safari")>=0&&(jDe="Safari"),Ri.supportsWebAssembly()&&!DDe&&(BDe=n(186)),en.defaultKey="Ap_cv0-3QHFzKgGUenjAWOcyLvh3xbpEqEJl5mglfJBF_rPrqtiYIGlWxdpauan2";var UDe=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),!u.a(t.container))throw new h.a("需要DOM元素容器");this.options=t}var t,i,n;return t=e,(i=[{key:"initialize",value:function(){var e=this,t=y("environmentMap/syferfontein_0d_clear_1k_white_ibl.ktx"),i=[new z(.483582802445095,.509107859565662,.645144255033483),new z(.012232077029828,.080451955581341,.218286766069223),new z(-.243243735560668,-.249924132076224,-.299943562047843),new z(.016109452512651,.01532565549071,.018127855074627),new z(-.004987170097604,-.004921911486914,-.0038633661905),new z(.086051535574703,.068545388587548,.038690499794242),new z(.05119532797069,.045546909969678,.042785926387475),new z(-.013678222111292,-.013862290918402,-.01443689238481),new z(.035095889317669,.034698788712205,.036058381423719)],n=this.options;return this.enableDefaultBIMSkyBox=w.a(n.enableDefaultBIMSkyBox,!0),n.skyBox?n.skyBox.specularEnvironmentMaps||(n.skyBox._specularEnvironmentMaps=t,n.skyBox._sphericalHarmonicCoefficients=i):this.defaultBIMSkyBox=new ADe({isBIM:!0,sphericalHarmonicCoefficients:i,specularEnvironmentMaps:t}),this.enableDefaultBIMSkyBox&&(this._skyBox=w.a(n.skyBox,this.defaultBIMSkyBox)),new Promise((function(t,i){aDe.InitToken(n).then((function(){e._userProjectList=[],e._userProjectFullList=[],e.projectListFetchReadyPromise=wIe.list().then((function(i){i.forEach((function(t){var i=new XIe({guid:t.id,name:t.name,viewer:e,skyBox:e._skyBox});"CIM"===t.type&&e._userProjectList.push(i),e._userProjectFullList.push(i)})),e._initializeAfterGetProjectList&&t(e.init(n))})),e._initializeAfterGetProjectList||t(e.init(n))})).otherwise((function(e){i(e)}))}))}},{key:"init",value:function(e){var t=this;this.server=w.a(e.server,FPe.server),this.projectId=e.projectId,this._projectList=[],this.currentProject,this.mapServeUrl=e.mapServeUrl,this._enableBloom=w.a(e.enableBloom,!1),this._enableAO=w.a(e.enableAO,!1),this._enableShadow=w.a(e.enableShadow,!1),this._enableBIMViewCube=w.a(e.enableBIMViewCube,!DDe),this._cimControlMode=w.a(e.cimControlMode,KAe.MOTOR),this._viewCubeConfig=w.a(e.viewCubeConfig,{}),this._taaEnabled=w.a(e.taaEnabled,!1),this._msaaEnabled=w.a(e.antialias,!0),fx.multipleSamples=this._msaaEnabled?4:1,this._enableVignetteMode=w.a(e.enableVignetteMode,!1),this._enableWebgl2=w.a(e.enableWebgl2,"Firefox"!==jDe),this._backgroundColor=w.a(e.backgroundColor,uf.fromBytes(250,250,242)),this._backgroundImageCss=e.backgroundImageCss,this._initializeAfterGetProjectList=w.a(e.initializeAfterGetProjectList,!1),this.enableTouchControl=w.a(e.enableTouchControl,!1),this._animatedSpeed=w.a(e.animatedSpeed,2),en.defaultKey="As7uJ50216xtsR20awXr8Irsf18GaYpJ3f6fzs0bJuw5dTrxXh1WPLB11X2jegJz",this.container=zfe(e.container),ose.DEFAULT_VIEW_RECTANGLE=new Ve(1.111889241775566,.02986665135249165,2.865179408696064,1.0751989151414314);var i=w.a(e.map,new tDe({token:"2b6bbb88d28124168e36297ab20c6fa0",maximumLevel:17}));fx.ultimatePerformance=w.a(e.ultimatePerformance,!0),Ri.maxDecodingWorkers=w.a(e.maxDecodingWorkers,Math.max(Ri.hardwareConcurrency-1,1)),fx.taaEnabled=this._taaEnabled,fx.gradualRenderMode=w.a(e.enableFixedFrameRate,!1),fx.vignetteMode=this._enableVignetteMode,fx.isBIMMode=u.a(e.viewerMode)&&e.viewerMode===YAe.BIM,h$._edgeWasm=BDe?BDe.default:null,this.cesiumViewer=new ACe(this.container,{imageryProvider:i.mapProvider,baseLayerPicker:!1,homeButton:w.a(e.homeButton,!1),animation:w.a(e.animation,!1),geocoder:w.a(e.geocoder,!1),timeline:w.a(e.timeline,!1),selectionIndicator:!1,sceneModePicker:w.a(e.sceneModePicker,!1),navigationHelpButton:!1,infoBox:!1,shouldAnimate:!1,fullscreenButton:!0,projectionPicker:w.a(e.sceneModePicker,!1),requestRenderMode:w.a(e.requestRenderMode,!1),contextOptions:{webgl:{alpha:!!this._backgroundImageCss},requestWebgl2:this._enableWebgl2},scene3DOnly:!0,globe:e.globe}),this.defaultCIMSkyBox=this.cesiumViewer.scene.skyBox,u.a(this._backgroundImageCss)&&this.container.setAttribute("style","background-image:"+this._backgroundImageCss),this._enableVignetteMode&&(this.cesiumViewer.scene.vignette.color1=w.a(e.backgroundColor1,uf.fromCssColorString("#ffffff")),this.cesiumViewer.scene.vignette.color2=w.a(e.backgroundColor2,uf.fromCssColorString("#283844"))),this.mapCollection=new MDe(this.cesiumViewer.imageryLayers,i);var n=this.cesiumViewer.canvas;if(n.setAttribute("tabindex","0"),n.onclick=function(){n.focus()},this.enableMarquee=!1,this.viewerMode=w.a(e.viewerMode,YAe.CIM),this.navigationMode=w.a(e.navigationMode,ZAe.NAV_FREE_MOUSE),!DDe){this.ambientOcclusion=this.cesiumViewer.scene.postProcessStages.ambientOcclusion;var r=this.ambientOcclusion;r.enabled=this._enableAO,r.uniforms.intensity=2,r.uniforms.bias=.1,r.uniforms.lengthCap=.15,r.uniforms.stepSize=2.28,r.uniforms.blurStepSize=4,this.shadowMap=this.cesiumViewer.shadowMap;var a=this.shadowMap;a.enabled=this._enableShadow,a.size=2048;var o={show:!0,contrast:128,brightness:-.3,delta:1,sigma:2,stepSize:1},s=this.cesiumViewer.scene.postProcessStages.bloom;this.bloom=new bDe(s,{viewer:this,enabled:this._enableBloom,contrast:o.contrast,brightness:o.brightness,delta:o.delta,sigma:o.sigma,stepSize:o.stepSize});var c=this.cesiumViewer.scene.postProcessStages,l=Upe;c.add(l.createSharpenStage())}e.debug&&(this.cesiumViewer.scene.debugShowFramesPerSecond=!0),e.debugTileset&&(this.cesiumViewer.extend(PCe),this.inspectorViewModel=this.cesiumViewer.cesium3DTilesInspector.viewModel,this.inspectorViewModel.picking=!1),Ri.supportsImageRenderingPixelated()&&!DDe&&(this.cesiumViewer.resolutionScale=window.devicePixelRatio),this.cesiumViewer.bottomContainer.style.display="none",this.cesiumViewer.scene.globe.depthTestAgainstTerrain=!0,this.screenspacehandler=this.cesiumViewer.screenSpaceEventHandler,this.screenspacehandler.removeInputAction(TS.LEFT_DOUBLE_CLICK),this.currentView={center:void 0,heading:50,pitch:-40,range:1e3},this.selectedPrimitive=void 0,this.selectedPrimitiveOriginalColor=void 0,this.modelCollection=this.cesiumViewer.scene.primitives.add(new R6),this.shadowPlaneCount=0,this.roamEditor=void 0;var h=0;this.cesiumViewer.scene.preRender.addEventListener((function(){t.cesiumViewer.scene.frameState.camera.pitch<-1.4?h=0:h+=t._animatedSpeed,t.cesiumViewer.scene.frameState.planNumber=h})),this.cameraMoveStart=this.cesiumViewer.camera.moveStart,this.cameraMoveEnd=this.cesiumViewer.camera.moveEnd,this.mouseEventHandler=new sDe({view:this.cesiumViewer}),u.a(e.ready)&&(0,e.ready)(),e.enableFixedFrameRate&&this.initGradualRenderState(),this._skyBox&&(this._skyBox.viewer=this),this.envDate=new Date(2019,10,19,12)}},{key:"initGradualRenderState",value:function(){var e=this,t=this;this.addMouseEventListener(lDe.MIDDLE_DOWN,(function(t){++e.cesiumViewer.scene.mouseDownFlag})),this.addMouseEventListener(lDe.RIGHT_DOWN,(function(t){++e.cesiumViewer.scene.mouseDownFlag})),this.addMouseEventListener(lDe.MIDDLE_UP,(function(t){--e.cesiumViewer.scene.mouseDownFlag})),this.addMouseEventListener(lDe.RIGHT_UP,(function(t){--e.cesiumViewer.scene.mouseDownFlag})),document.addEventListener("mouseout",(function(e){--t.cesiumViewer.scene.mouseDownFlag}))}},{key:"loadModel",value:function(e){var t=this,i=e.url,n=e.origin,r=e.zoomTo,a=void 0===r||r,o=e.rotationZ,s=void 0===o?0:o,c=e.translation,l=void 0===c?z.ZERO:c,d=e.luminanceAtZenith,f=void 0===d?.2:d,p=e.drawEdge,m=void 0!==p&&p;if(!u.a(i))throw new h.a("options.url不存在");if(!u.a(n))throw new h.a("options.origin不存在");var _=xa.eastNorthUpToFixedFrame(n),g=be.fromRotationZ(I.toRadians(s)),v=Kn.fromRotationMatrix(g),b=new z(1,1,1),y=Be.fromTranslationQuaternionRotationScale(l,v,b),w=new Be;Be.multiplyTransformation(_,y,w);var O={};DDe||m&&BDe&&(O.dequantizeInShader=!1,O.dracoModel=!0,O.edgeWasmModule=BDe.default,O.calcEdge=!0);var x=this.modelCollection.add(J0.fromGltf(NDe({modelMatrix:w,dequantizeInShader:!1,sphericalHarmonicCoefficients:this._skyBox&&this._skyBox.sphericalHarmonicCoefficients,specularEnvironmentMaps:this._skyBox&&this._skyBox.specularEnvironmentMaps,luminanceAtZenith:f},e,{},O)));return a&&x.readyPromise.then((function(e){var i=new St;St.transform(e.boundingSphere,w,i),t.viewerMode===YAe.BIM?(t.controller.origin=i.center,t.controller.defaultRange=3*i.radius,t.controller.resetCamera()):t.currentView={center:i.center,range:3*e.boundingSphere.radius}})).otherwise((function(e){console.warn(e)})),x}},{key:"loadTileset",value:function(e){var t=this,i=e.zoomTo,n=void 0===i||i,r=e.luminanceAtZenith,a=void 0===r?.2:r,o=this.cesiumViewer.scene.primitives.add(new zse(NDe({},e,{luminanceAtZenith:a,sphericalHarmonicCoefficients:this._skyBox&&this._skyBox.sphericalHarmonicCoefficients,specularEnvironmentMaps:this._skyBox&&this._skyBox.specularEnvironmentMaps})));return n&&o.readyPromise.then((function(e){t.viewerMode===YAe.BIM?(t.controller.model=e,t.controller.defaultRange=3*e.boundingSphere.radius,t.controller.maximumZoomDistance=3*e.boundingSphere.radius,t.controller.resetCamera()):t.cesiumViewer.zoomTo(e)})).otherwise((function(e){console.warn(e)})),o}},{key:"remove",value:function(e){if(u.a(e))if(this.cesiumViewer.scene.primitives.contains(e))this.cesiumViewer.scene.primitives.remove(e);else{if(!this.modelCollection.contains(e))throw new h.a("primitive不在场景中");this.modelCollection.remove(e)}else console.warn("primitive不存在")}},{key:"loadSubProject",value:function(e){var t=this,i=e.parentComponent;this.taaEnabled&&(this.cesiumViewer.scene.taaEnabled=!1);var n=w.a(e.drawEdge,!1),r=w.a(e.luminanceAtZenith,.5),a=w.a(e.lazyLoad,!1),o=w.a(e.lazyLoadBlockSize,200),s=new XIe({viewer:this,guid:e.projectId,access_token:this.access_token,skyBox:this._skyBox,luminanceAtZenith:r,lazyLoad:a,lazyLoadBlockSize:o,drawEdge:n,parentComponent:i,parentProject:i?i.project:void 0});return this.currentProject=s,this._projectList.push(s),s.loadAssemblies().then((function(e){console.log("drawProject"),t.flyToProject(s);var i=e.drawProject();return i.length&&i.length>1?new Promise((function(e,n){Promise.all(i).then((function(i){t.taaEnabled&&(t.cesiumViewer.scene.taaEnabled=!0),e(s)}))})):(i.then((function(){t.taaEnabled&&(t.cesiumViewer.scene.taaEnabled=!0)})),i)}))}},{key:"queryProject",value:function(e){var t;if(!this._initializeAfterGetProjectList)return new XIe({guid:e,viewer:this,skyBox:this._skyBox});for(var i=0;i<this._userProjectFullList.length;i++)if(e===(t=this._userProjectFullList[i]).guid)return t;console.warn("工程不存在")}},{key:"flyToProject",value:function(e,t){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(e)if(this.viewerMode!==YAe.BIM||DDe||this.enableTouchControl){if(i&&u.a(e.defaultPresetView))return void(this.currentView=NDe({},e.defaultPresetView,{callback:t}));this.currentView=NDe({},e.defaultView,{callback:t})}else{if(i&&u.a(e.defaultPresetView))return this.currentView=NDe({},e.defaultPresetView,{callback:t}),this.controller.origin=e.boundingSphere.center,this.controller.defaultRange=z.distance(e.defaultPresetView.position,this.controller.origin),this.controller.defaultHeading=e.defaultPresetView.heading,this.controller.defaultPitch=e.defaultPresetView.pitch,this.controller.maximumZoomDistance=e.maximumZoomDistance,void(this.controller.lookAtCenter=e.boundingSphere.center);this.navigationMode===ZAe.NAV_FREE_MOUSE?(e.boundingSphere?this.controller.origin=e.boundingSphere.center.clone():this.controller.origin=e.origin.clone(),this.controller.defaultRange=e.defaultRange,this.controller.maximumZoomDistance=e.maximumZoomDistance,this.controller.resetCamera(),t&&t()):this.currentView=NDe({},e.defaultView,{callback:t})}}},{key:"flyTo",value:function(e,t){var i=this;if(!u.a(e))throw new h.a("未传入参数");if(e instanceof XIe)this.flyToProject(e,t);else if(e instanceof mIe)this.zoomToComponent(e,t);else if(Array.isArray(e)){if(e.length>0){if(!(e[0]instanceof mIe))throw new h.a("传入数组不是构件列表");var n=St.fromBoundingSpheres(e.map((function(e){return e.boundingSphere})),new St),r=this.currentView,a=r.heading,o=r.pitch;this.currentView={boundingSphere:n,heading:a,pitch:-o,range:3*n.radius,callback:function(){i.setLookAtCenter(),t&&t()}}}}else u.a(e.pitch)&&(e.pitch=-e.pitch),u.a(t)&&(e.callback=t),this.currentView=e}},{key:"removeProject",value:function(e,t){if(u.a(t)){var i=t.parentComponent;u.a(i)&&i._primitives.forEach((function(e){e.show=!0}))}this._projectList.splice(this._projectList.indexOf(e),1),this.currentProject=e.parentProject,e.destroy(),this.flyToProject(this.currentProject)}},{key:"pick",value:function(e,t){var i,n=this;if(!u.a(t)){var r=this._projectList.map((function(t){return n.pick(e,t)}));return(r=r.filter((function(e){return e}))).length>0?1===r.length?r[0]:r:void 0}if(t.type===ZPe.TYPE_CIM){if("SUBCIM"===t._type){var a=t.parentProject;a.type===ZPe.TYPE_CIM&&a.hasIsolatedComponents&&a._notPickableComponents.forEach((function(e){e._primitives.forEach((function(e){e.show=!1}))}))}if(t.hasIsolatedComponents&&t._notPickableComponents.forEach((function(e){e._primitives.forEach((function(e){e.show=!1}))})),i=this.cesiumViewer.scene.pick(e),"SUBCIM"===t._type){var o=t.parentProject;o.type===ZPe.TYPE_CIM&&o.hasIsolatedComponents&&o._notPickableComponents.forEach((function(e){e._primitives.forEach((function(e){e.show=!0}))}))}t.hasIsolatedComponents&&t._components.forEach((function(e){e._primitives.forEach((function(e){e.show=!0}))}))}else t.type===ZPe.TYPE_BIM&&(function e(t){t._projectList.forEach((function(t){e(t)}));var i=[];t.hasIsolatedComponents&&(t.isolatedIds.forEach((function(e){t.isBlock?i.push("${guids}!=='"+e+"'"):i.push("${guids}==='"+e+"'")})),t.isolatedTypeStringColorPairs.forEach((function(e){var n=new RegExp("[(]","g"),r=new RegExp("[)]","g");e=(e=e.replace(n,"[(]")).replace(r,"[)]"),t.isBlock?i.push("!regExp('.?"+e+"').test(${infos})"):i.push("regExp('.?"+e+"').test(${infos})")})),t.tileset&&(t.tileset.originalStyle=NDe({},t.tileset.style._style),t.tileset.style=new Wse({show:t.isBlock?i.join("&&"):i.join("||")})))}(t),i=this.cesiumViewer.scene.pick(e),function e(t){t._projectList.forEach((function(t){e(t)})),t.hasIsolatedComponents&&t.tileset&&(t.tileset.style=new Wse(t.tileset.originalStyle))}(t));if(u.a(i))if(i.getProperty){var s=i.getProperty("guids");if(s){var c=t.searchByPropertyValue("tileset",i.tileset);if(c){var l=i.getProperty("infos").split("@@");return new mIe({project:c,guid:s,infos:l,feature:i,type:ZPe.TYPE_BIM})}}}else if(i.primitive&&i.primitive.componentId){var h=t.searchByPropertyValue("guid",i.primitive.projectId);if(h)return i.primitive.webconfig&&i.primitive.webconfig.groupId?h.getComponentById(i.primitive.webconfig.groupId):h.getComponentById(i.primitive.componentId)}else{if(u.a(i.id)&&i.id instanceof zz)return new nDe({entity:i.id});if(u.a(i.primitive)&&"geometryCollection"===i.primitive.type)return{geometryId:i.id,picked:i};if(u.a(i.primitive)&&i.primitive instanceof tB){var d=t.searchByPropertyValue("guid",i.primitive.projectId);if(d)return d.getComponentById(i.id)}}}},{key:"pickPosition",value:function(e){return this.cesiumViewer.scene.pickPosition(e)}},{key:"addMouseEventListener",value:function(e,t,i){this.mouseEventHandler.addEventListener(e,t,i)}},{key:"removeMouseEventListener",value:function(e){this.mouseEventHandler.removeEventListener(e)}},{key:"zoomToComponent",value:function(e,t){var i=this,n=this.currentView,r=n.heading,a=n.pitch;this.currentView={boundingSphere:e.boundingSphere,heading:r,pitch:-a,range:3*e.boundingSphere.radius,callback:function(){i.setLookAtCenter(),t&&t()}}}},{key:"setLookAtCenter",value:function(e){this.viewerMode===YAe.BIM&&u.a(this.controller)&&!this.controller.isDestroyed()&&this.controller instanceof qAe&&this.controller.setLookAtCenter({windowPosition:e})}},{key:"homeView",value:function(){this.viewerMode===YAe.CIM&&this.cesiumViewer.camera.flyHome()}},{key:"startOrbiting",value:function(){if(this.viewerMode===kLe.ViewerMode.CIM){var e=this.cesiumViewer;e.clock.multiplier=1800,e.scene.postUpdate.addEventListener(this.icrf,this),e.clock.shouldAnimate=!0}}},{key:"stopOrbiting",value:function(){if(this.viewerMode===kLe.ViewerMode.CIM){var e=this.cesiumViewer;e.camera.lookAtTransform(Be.IDENTITY),e.clock.multipliermultiplier=.5,e.scene.postUpdate.removeEventListener(this.icrf,this),e.clock.shouldAnimate=!1}}},{key:"icrf",value:function(e,t){if(e.mode===xF.SCENE3D){var i=xa.computeIcrfToFixedMatrix(t);if(u.a(i)){var n=this.cesiumViewer.camera,r=z.clone(n.position),a=Be.fromRotationTranslation(i);n.lookAtTransform(a,r)}}}},{key:"addWater",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{flowAngle:0,reflectFactor:.5,speed:.05,waterColor:new uf(0,128/255,128/255)};return new fDe(e,NDe({viewer:this.cesiumViewer},t))}},{key:"removeWater",value:function(e){e.destroy()}},{key:"createVolumeRender",value:function(e){u.a(this.volumeRender)&&!this.volumeRender.isDestroyed()&&this.removeVolumeRender();var t=e.dimensions,i=e.center,n=e.image,r=e.isRGB,a=void 0===r||r,o=e.colorScheme,s=e.debug,c=void 0!==s&&s,l=e.alphaCorrection,h=void 0===l?.5:l,d=xa.eastNorthUpToFixedFrame(i),f=be.fromRotationX(I.toRadians(180));Be.multiplyByMatrix3(d,f,d);var p=new St(z.ZERO,1e9),m=this.volumeRender=new jSe({viewer:this.cesiumViewer,modelMatrix:d,boundingSphere:p,image:n,dimensions:new z(t[0],t[1],t[2]),isRGB:a,colorScheme:o,alphaCorrection:h});return this.cesiumViewer.scene.primitives.add(m),c&&this.cesiumViewer.entities.add({position:z.fromDegrees(i[0],i[1],i[2]),box:{dimensions:new z(t[0],t[1],t[2]),fill:!1,outline:!0,outlineColor:uf.YELLOW}}),m}},{key:"removeVolumeRender",value:function(){u.a(this.volumeRender)&&!this.volumeRender.isDestroyed()&&(this.cesiumViewer.scene.primitives.remove(this.volumeRender),this.volumeRender=void 0)}},{key:"updateVolumeRender",value:function(e){var t=this;if(u.a(this.volumeRender)&&!this.volumeRender.isDestroyed())if(e instanceof Image)e.onload=function(){t.volumeRender._cubeTexture.updateTexture(img)};else{if("string"!=typeof e)throw new h.a("请传入正确的图片路径或Image对象");var i=new Image;i.src=e,i.onload=function(){t.volumeRender._cubeTexture.updateTexture(i)}}}},{key:"isDestroyed",value:function(){return!1}},{key:"destroy",value:function(){return this._projectList.forEach((function(e){e.isDestroyed()||e.destroy()})),this.navBox&&!this.navBox.isDestroyed()&&this.navBox.destroy(),this.marqueeEditor&&!this.marqueeEditor.isDestroyed()&&this.marqueeEditor.destroy(),this.roamEditor&&!this.roamEdito.isDestroyed()&&this.roamEditor.destroy(),this.cesiumViewer&&!this.cesiumViewer.isDestroyed()&&this.cesiumViewer.destroy(),kLe.Config.serverUrl=FPe.defaultServer,rl(this)}},{key:"loadAssemblies",value:function(e){var t=this,i=e.sceneView,n=e.data,r=e.flag,a=void 0===r?"BIM":r,o=e.parentMatrix,s=e.luminanceAtZenith,c=void 0===s?.5:s,l=e.assignProjectMatrix,h=e.lazyLoad,d=e.lazyLoadBlockSize,f=e.useSubFloorConfig,p=void 0!==f&&f,m=n.project,_=n.assemblyList;if(_){var g=n.project.properties?n.project.properties.Param_LevelInfoMap:null,v=[];if(g){var b=JSON.parse(g);for(var y in b)if(v.length>0){for(var w=!0,O=0;O<v.length;O++)if(b[y].order<v[O].order){var x=NDe({name:y},b[y]);v.splice(O,0,x),w=!1;break}if(w){var E=NDe({name:y},b[y]);v.push(E)}}else{var T=NDe({name:y},b[y]);v.push(T)}p&&(i.floorConfig=v.map((function(e){return{floor_name:e.name,mapping:[{id:m.id,floor_list:[e.name]}]}})))}var C,S,A=_.map((function(e){var t=Be.fromArray(e.matrix,0,new Be),i=e.path;return"TILE_PROVIDER"===e.type&&(i=e.properties.terServerUrl),"PROJ_PROVIDER"===e.type&&(i=e.properties.relProjId),{id:e.id,componentIds:"BIM"===a?void 0:e.componentIds,matrix:t,border:e.border,bottom:e.bottom,height:e.height,path:i,type:e.type,clusterInfo:e.properties&&e.properties.clusterInfo,isStatic:"BIM"===a}}));if(u.a(o))C=new z,S=new be,Be.getTranslation(o,C),Be.getRotation(o,S);else{var P=RDe(m.center.coordinates,3),I=P[0],D=P[1],j=P[2];C=z.fromDegrees(I,D,j)}var M=new ProjectView({scene:this.cesiumViewer.scene,projectId:m.id,name:m.name,assemblies:A,luminanceAtZenith:c,origin:C,rotation:S,parentMatrix:o,assignProjectMatrix:l,type:a,access_token:this.access_token,modelCollection:"BIM"===a?this.subModelCollection:this.modelCollection,floors:v,skyBox:this._skyBox,lazyLoad:h,lazyLoadBlockSize:d,isMobile:DDe,viewerId:this._guid}),R=i.addProject(M);return R.then((function(){u.a(M.terrainProvider)&&t.cesiumViewer.terrainProvider!==M.terrainProvider&&(console.log("terrain different"),t.cesiumViewer.terrainProvider=M.terrainProvider)})),R}}},{key:"addVideoProjection",value:function(e){var t=new hDe(NDe({viewer:this},e));return this.cesiumViewer.scene.primitives.add(t),t}},{key:"removeVideoProjection",value:function(e){this.cesiumViewer.scene.primitives.remove(e)}},{key:"addParticleSystem",value:function(e){return this.cesiumViewer.scene.primitives.add(e)}},{key:"removeParticleSystem",value:function(e){e&&this.cesiumViewer.scene.primitives.remove(e)}},{key:"switchToOrthographic",value:function(){this.logarithmicDepthBuffer=!1,this.cesiumViewer.scene.camera.switchToOrthographicFrustum()}},{key:"switchToPerspective",value:function(){this.logarithmicDepthBuffer=!0,this.cesiumViewer.scene.camera.switchToPerspectiveFrustum()}},{key:"forceRender",value:function(){fx.taaEnabled&&(fx.historicalInvalid=!0),this.cesiumViewer.scene.requestRenderMode&&this.cesiumViewer.scene.requestRender()}},{key:"isolateComponents",value:function(e){if(!u.a(e))throw new h.a("请传入参数");if(!u.a(e.project))throw new h.a("请传入工程对象");if(!u.a(e.components))throw new h.a("请传入构件对象");var t=w.a(e.block,!1);return e.project.isolateComponents(components,t)}},{key:"getOpeningProjectList",value:function(){return this._projectList.filter((function(e){return!0===e.isOpened}))}},{key:"getProjectList",value:function(){return this._userProjectList}},{key:"waterFlowSpeed",get:function(){return 100*this.cesiumViewer.scene._surfaceWater.speed},set:function(e){this.cesiumViewer.scene._surfaceWater.speed=e/100}},{key:"animatedSpeed",get:function(){return this._animatedSpeed},set:function(e){this._animatedSpeed=e}},{key:"navigationMode",get:function(){return this._navigationMode},set:function(e){switch(this._navigationMode=e,this.roamEditor&&(this.roamEditor.isDestroyed()||this.roamEditor.destroy()),e){case ZAe.NAV_FREE_MOUSE:u.a(this.controller)&&!this.controller.isDestroyed()&&(this.controller.enableInputs=!0),u.a(this.navBox)&&!this.navBox.isDestroyed()&&(this.navBox.container.style.display="block");break;case ZAe.NAV_FREE_KEY:this.roamEditor=new LPe({viewer:this}),u.a(this.navBox)&&!this.navBox.isDestroyed()&&(this.navBox.container.style.display="none");break;case ZAe.NAV_WALK:this.roamEditor=new LPe({viewer:this,type:"Walk"}),u.a(this.navBox)&&!this.navBox.isDestroyed()&&(this.navBox.container.style.display="none")}}},{key:"enableMarquee",get:function(){return this._enableMarquee},set:function(e){this._enableMarquee=e;var t=!1;e?(this.marqueeEditor?this.marqueeEditor.isDestroyed()&&(t=!0):t=!0,t&&(this.marqueeEditor=new sPe({viewer:this,isLookAtCenter:this.viewerMode===YAe.BIM}))):this.marqueeEditor&&(this.marqueeEditor.isDestroyed()||this.marqueeEditor.destroy())}},{key:"cimControlMode",get:function(){return this._cimControlMode},set:function(e){this._cimControlMode=e;var t=this.controller=this.cesiumViewer.scene.screenSpaceCameraController;this._cimControlMode===KAe.MOTOR?(t.tiltEventTypes=[sse.RIGHT_DRAG,sse.PINCH],t.translateEventTypes=DDe?sse.LEFT_DRAG:sse.MIDDLE_DRAG,t.rotateEventTypes=DDe?sse.LEFT_DRAG:sse.MIDDLE_DRAG,t.zoomEventTypes=[sse.WHEEL,sse.PINCH],t._minimumRotateRate=.5,t.minimumZoomDistance=.001):(t.tiltEventTypes=[DDe?sse.RIGHT_DRAG:sse.MIDDLE_DRAG,sse.PINCH],t.translateEventTypes=sse.LEFT_DRAG,t.rotateEventTypes=sse.LEFT_DRAG,t.zoomEventTypes=[sse.WHEEL,sse.PINCH])}},{key:"viewerMode",get:function(){return this._viewerMode},set:function(e){var t=this.cesiumViewer.scene,i=this.getOpeningProjectList()[0];if(e==YAe.CIM&&e!==this._viewerMode)this._enableBIMViewCube&&u.a(this.navBox)&&!this.navBox.isDestroyed()&&this.navBox.destroy(),this._viewerMode=e,u.a(this.controller)&&this.controller.destroy(),this.cimControlMode=this._cimControlMode,t.globe.show=!0,t.skyAtmosphere.show=!0,t.skyBox=this.defaultCIMSkyBox,t.sun.show=!0,t.moon.show=!0,u.a(this.marqueeEditor)&&(this.marqueeEditor.isLookAtCenter=!1);else if(e==YAe.BIM&&e!==this._viewerMode&&(this._viewerMode=e,t.globe.show=!1,t.skyAtmosphere.show=!1,this._skyBox?(t.skyBox=this._skyBox,t.skyBox.show=!0):t.skyBox.show=!1,t.sun.show=!1,t.moon.show=!1,t.backgroundColor=this._backgroundImageCss?uf.BLACK.withAlpha(0):this._backgroundColor,DDe||this.enableTouchControl||(this.controller=new qAe({scene:t,clock:this.cesiumViewer.clock}),u.a(i)&&(this.controller.origin=i.getPosition(),this.controller.defaultRange=i.defaultRange,this.controller.maximumZoomDistance=i.maximumZoomDistance)),u.a(this.marqueeEditor)&&(this.marqueeEditor.isLookAtCenter=!0),this._enableBIMViewCube)){var n=this._viewCubeConfig,r=n.width,a=n.height,o=n.containerStyle,s=void 0===o?"position:absolute;right:0;bottom:0;":o,c=document.createElement("div");c.setAttribute("style",s),this.cesiumViewer.container.appendChild(c),this.navBox=new gDe({viewer:this,container:c,width:r,height:a,enableWebgl2:this._enableWebgl2})}}},{key:"currentView",get:function(){var e=this.cesiumViewer.camera,t=e.positionWC,i=(e.position,e.heading),n=e.pitch,r=e.roll;return{positionWC:t,heading:I.toDegrees(i),pitch:-I.toDegrees(n),roll:I.toDegrees(r)}},set:function(e){var t=this,i=this.cesiumViewer,n=this._currentView;if(i.camera.lookAtTransform(Be.IDENTITY),this._currentView=NDe({},n,{},e),e.center){var r=this._currentView,a=r.center,o=r.heading,s=r.pitch,c=r.range,l=r.duration;o=I.toRadians(o),s=I.toRadians(s);var u=new St(a,c);i.camera.flyToBoundingSphere(u,{offset:new xO(o,s,c),duration:l,complete:function(){t.setLookAtCenter(),e.callback&&e.callback()}})}else if(e.boundingSphere){var h=this._currentView,d=h.boundingSphere,f=h.heading,p=h.pitch,m=h.range,_=h.duration;f=I.toRadians(f),p=I.toRadians(p),i.camera.flyToBoundingSphere(d,{offset:new xO(f,p,m),duration:_,complete:function(){t.setLookAtCenter(),e.callback&&e.callback()}})}else if(e.rectangle){var g=this._currentView,v=g.rectangle,b=g.duration;i.camera.flyTo({destination:v,complete:function(){t.setLookAtCenter(),e.callback&&e.callback()},duration:b})}else if(e.position){var y=this._currentView,w=y.position,O=y.heading,x=y.pitch,E=y.roll,T=void 0===E?0:E,C=y.duration;O=I.toRadians(O),x=I.toRadians(x),T=I.toRadians(T),i.camera.flyTo({destination:w,orientation:{heading:O,pitch:x,roll:T},duration:C,complete:function(){t.setLookAtCenter(),e.callback&&e.callback()}})}}},{key:"antialias",get:function(){return this._msaaEnabled}},{key:"taaEnabled",get:function(){return this._taaEnabled},set:function(e){this._taaEnabled=e,fx.taaEnabled=this._taaEnabled}},{key:"shouldAnimate",get:function(){return this.cesiumViewer.clock.shouldAnimate},set:function(e){this.cesiumViewer.clock.shouldAnimate=e}},{key:"skyBox",get:function(){return this._skyBox},set:function(e){this._skyBox=e,this.cesiumViewer.scene.skyBox=e,this._skyBox.viewer=this}},{key:"logarithmicDepthBuffer",get:function(){return this.cesiumViewer.scene.logarithmicDepthBuffer},set:function(e){this.cesiumViewer.scene.logarithmicDepthBuffer=e}},{key:"envDate",get:function(){return Tr.toDate(this.cesiumViewer.clock.currentTime)},set:function(e){this.cesiumViewer.clock.currentTime=Tr.fromDate(e)}},{key:"projectlist",get:function(){return this._projectList}},{key:"enableAO",get:function(){return this._enableAO},set:function(e){this._enableAO=e,this.ambientOcclusion.enabled=e}},{key:"enableShadow",get:function(){return this._enableShadow},set:function(e){this._enableShadow=e,this.shadowMap.enabled=e}},{key:"sunlightIntensity",get:function(){return fx.lightScaleFactor},set:function(e){fx.lightScaleFactor=e}}])&&kDe(t.prototype,i),n&&kDe(t,n),e}();function VDe(e){return(VDe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function HDe(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function GDe(e,t){return!t||"object"!==VDe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function qDe(e,t,i){return(qDe="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,i){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=WDe(e)););return e}(e,t);if(n){var r=Object.getOwnPropertyDescriptor(n,t);return r.get?r.get.call(i):r.value}})(e,t,i||e)}function WDe(e){return(WDe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function YDe(e,t){return(YDe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Object.defineProperties(J0.prototype,{_cachedGltf:{set:function(e){this._vtxf_cachedGltf=e,this._vtxf_cachedGltf&&this._vtxf_cachedGltf._gltf&&function(e){if(e.extensionsUsed){var t=e.extensionsUsed.indexOf("KHR_technique_webgl"),i=e.extensionsRequired.indexOf("KHR_technique_webgl");if(-1!==t){e.extensionsRequired.splice(i,1,"KHR_techniques_webgl"),e.extensionsUsed.splice(t,1,"KHR_techniques_webgl"),e.extensions=e.extensions||{},e.extensions.KHR_techniques_webgl={},e.extensions.KHR_techniques_webgl.programs=e.programs,e.extensions.KHR_techniques_webgl.shaders=e.shaders,e.extensions.KHR_techniques_webgl.techniques=e.techniques;var n=e.extensions.KHR_techniques_webgl.techniques;e.materials.forEach((function(t,i){e.materials[i].extensions||(e.materials[i].extensions={KHR_technique_webgl:{}}),e.materials[i].extensions.KHR_technique_webgl.values=e.materials[i].values,e.materials[i].extensions.KHR_techniques_webgl=e.materials[i].extensions.KHR_technique_webgl;var r=e.materials[i].extensions.KHR_techniques_webgl;for(var a in r.technique||(r.technique=e.materials[i].technique),r.values){var o=n[r.technique].uniforms;for(var s in o)if(o[s]===a){r.values[s]=r.values[a],delete r.values[a];break}}})),n.forEach((function(e){for(var t in e.attributes){var i=e.attributes[t];e.attributes[t]=e.parameters[i]}for(var n in e.uniforms){i=e.uniforms[n];e.uniforms[n]=e.parameters[i]}}))}}}(this._vtxf_cachedGltf._gltf)},get:function(){return this._vtxf_cachedGltf}}});var XDe=function(e){function t(e,i,n){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),GDe(this,WDe(t).call(this,e,i,n))}var i,n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&YDe(e,t)}(t,e),i=t,r=[{key:"getProjectVectorLength",value:function(e,i){return x.a.defined("a",e),x.a.defined("b",i),t.dot(e,i)/t.dot(i,i)}},{key:"fromDegrees",value:function(e,i,n){return qDe(WDe(t),"fromDegrees",this).call(this,e,i,n)}},{key:"fromRadians",value:function(e,i,n){return qDe(WDe(t),"fromRadians",this).call(this,e,i,n)}}],(n=null)&&HDe(i.prototype,n),r&&HDe(i,r),t}(z);function ZDe(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function QDe(e,t,i){var n=z.clone(sje(e)),r=xa.eastNorthUpToFixedFrame(n),a=Be.multiplyByPointAsVector(r,t,new z),o=z.normalize(a,new z);z.multiplyByScalar(o,e._boundingSphere.radius,o);var s=!0,c=!1,l=void 0;try{for(var u,h=e._aryEntities[Symbol.iterator]();!(s=(u=h.next()).done);s=!0){var d=u.value,f=cje(d),p=Be.inverse(f,new Be),m=Be.multiplyByPointAsVector(p,a,new z),_=d.boundingSphere.center,g=z.subtract(_,n,new z),v=XDe.getProjectVectorLength(g,a)+(i?XDe.getProjectVectorLength(o,a):0);z.normalize(m,m),d.clippingPlanes.add(new VK(m,v))}}catch(e){c=!0,l=e}finally{try{s||null==h.return||h.return()}finally{if(c)throw l}}var b=function(e){var t;t=z.equals(e,z.UNIT_X)||z.equals(z.negate(e,new z),z.UNIT_X)?be.fromRotationY(Math.PI/2):z.equals(e,z.UNIT_Y)||z.equals(z.negate(e,new z),z.UNIT_Y)?be.fromRotationX(Math.PI/2):be.IDENTITY;return t}(t),y=new Be;if(Be.multiplyByMatrix3(r,b,y),i){var w=Be.fromTranslation(z.negate(o,new z));Be.multiply(w,y,y)}var O=new z(2*e._boundingSphere.radius,2*e._boundingSphere.radius,1),x=Be.fromScale(O);Be.multiply(y,x,y);var E=e._viewer.scene.primitives.add(new ck({geometryInstances:new Mu({geometry:new xE({vertexFormat:$j.VERTEX_FORMAT}),attributes:{color:df.fromColor(new uf(.5,.8,1,.5))}}),appearance:new $j({closed:!0}),modelMatrix:y}));E.id=Mg(),e._mPlaneEntities.set(E.id,E),e._mPlaneEntitiesNormal.set(E.id,t)}function KDe(e){var t=this,i=t._viewer.scene.pick(e.position);if(u.a(i)&&u.a(i.primitive)&&u.a(t._mPlaneEntities.get(i.primitive.id))){t._screenSpaceEventHandler.setInputAction(t._onMouseLeftUp,TS.LEFT_UP),t._screenSpaceEventHandler.setInputAction(t._onMouseMove,TS.MOUSE_MOVE),document.addEventListener("mouseout",t._onMouseOut),t._selectedPlaneGraphics=i.primitive,t._controller.enableInputs=!1,t._mouseDownPoint=Rt.clone(e.position);var n=z.clone(sje(t)),r=xa.eastNorthUpToFixedFrame(n);t._clippingPanelNormal=Be.multiplyByPointAsVector(r,t._mPlaneEntitiesNormal.get(t._selectedPlaneGraphics.id),new z),t._pickPlanePosition=t._viewer.scene.pickPosition(e.position,new z),t._pickPlaneNormal=z.normalize(t._viewer.scene.camera.direction,new z),t._mPlaneEntitiesMatrix.size>0&&t._mPlaneEntitiesMatrix.clear(),t._mPlaneEntities.forEach((function(e,i){t._mPlaneEntitiesMatrix.set(i,e.modelMatrix.clone())})),t._mClippingPlanes.size>0&&t._mClippingPlanes.clear();var a=!0,o=!1,s=void 0;try{for(var c,l=t._aryEntities[Symbol.iterator]();!(a=(c=l.next()).done);a=!0){var h=c.value,d=[],f=!0,p=!1,m=void 0;try{for(var _,g=h.clippingPlanes._planes[Symbol.iterator]();!(f=(_=g.next()).done);f=!0){var v=_.value,b={normal:z.clone(v.normal),distance:v.distance};d.push(b)}}catch(e){p=!0,m=e}finally{try{f||null==g.return||g.return()}finally{if(p)throw m}}t._mClippingPlanes.set(h.id,d)}}catch(e){o=!0,s=e}finally{try{a||null==l.return||l.return()}finally{if(o)throw s}}}}function JDe(e){this._screenSpaceEventHandler.removeInputAction(TS.LEFT_UP),this._screenSpaceEventHandler.removeInputAction(TS.MOUSE_MOVE),document.removeEventListener("mouseout",self._onMouseOut),rje(this)}function $De(e){var t=this,i=tje(t,t._mouseDownPoint),n=tje(t,e.endPosition);if(u.a(i)&&u.a(n)){var r=z.subtract(n,i,new z),a=XDe.getProjectVectorLength(r,t._clippingPanelNormal),o=z.multiplyByScalar(t._clippingPanelNormal,a,new z),s=Be.fromTranslation(o);Be.multiply(s,t._mPlaneEntitiesMatrix.get(t._selectedPlaneGraphics.id),t._selectedPlaneGraphics.modelMatrix);var c=!0,l=!1,h=void 0;try{for(var d,f=t._aryEntities[Symbol.iterator]();!(c=(d=f.next()).done);c=!0){var p=d.value,m=t._mClippingPlanes.get(p.id),_=!0,g=!1,v=void 0;try{for(var b,y=m[Symbol.iterator]();!(_=(b=y.next()).done);_=!0){var w=b.value,O=w.normal,x=w.distance,E=cje(p),T=Be.inverse(E,new Be),C=Be.multiplyByPointAsVector(T,t._clippingPanelNormal,new z);if(I.equalsEpsilon(z.dot(C,O),1,I.EPSILON7)){var S=eje(p,O);u.a(S)&&(S.distance=x-a)}}}catch(e){g=!0,v=e}finally{try{_||null==y.return||y.return()}finally{if(g)throw v}}}}catch(e){l=!0,h=e}finally{try{c||null==f.return||f.return()}finally{if(l)throw h}}if(t._mPlaneEntities.size>1){var A=z.multiplyByScalar(t._clippingPanelNormal,a/2,new z),P=Be.fromTranslation(A);t._mPlaneEntities.forEach((function(e,i){if(e!==t._selectedPlaneGraphics){var n=t._mPlaneEntitiesNormal.get(t._selectedPlaneGraphics.id),r=t._mPlaneEntitiesNormal.get(e.id),a=z.dot(n,r);I.equalsEpsilon(a,0,I.EPSILON7)&&(e.modelMatrix=function(e,t,i){var n=e._mPlaneEntitiesMatrix.get(t.id).clone();Be.multiply(i,n,n);var r=new z;Be.getScale(n,r);var a=Be.fromScale(r),o=Be.inverse(a,new Be);Be.multiply(n,o,n);var s=function(e,t){var i=new z(2*e._boundingSphere.radius,2*e._boundingSphere.radius,1);if(e._mPlaneEntities.size>1){var n=aje(e,z.UNIT_X),r=aje(e,z.UNIT_Y),a=aje(e,z.UNIT_Z),o=e._mPlaneEntitiesNormal.get(t.id),s=z.dot(o,z.UNIT_X),c=z.dot(o,z.UNIT_Y),l=z.dot(o,z.UNIT_Z),u=I.equalsEpsilon(s,0,I.EPSILON7),h=I.equalsEpsilon(c,0,I.EPSILON7),d=I.equalsEpsilon(l,0,I.EPSILON7);u&&h?i=new z(n,r,1):u&&d?i=new z(n,a,1):h&&d&&(i=new z(a,r,1))}return i}(e,t),c=Be.fromScale(s);return Be.multiply(n,c,n),n}(t,e,P))}}))}}else console.log("mouse move pick error")}function eje(e,t){if(u.a(e.clippingPlanes)){var i=!0,n=!1,r=void 0;try{for(var a,o=e.clippingPlanes._planes[Symbol.iterator]();!(i=(a=o.next()).done);i=!0){var s=a.value;if(I.equalsEpsilon(z.dot(t,s.normal),1,I.EPSILON7))return s}}catch(e){n=!0,r=e}finally{try{i||null==o.return||o.return()}finally{if(n)throw r}}}}function tje(e,t){return UAe.getIntersectionByRayAndPlane(e._viewer.scene.camera.getPickRay(t),e._pickPlanePosition,e._pickPlaneNormal)}function ije(e){switch(e.keyCode){case 88:this.addClippingPlane("X");break;case 89:this.addClippingPlane("Y");break;case 90:this.addClippingPlane("Z");break;case 86:this.addClippingPlane("XYZ")}}function nje(e){this._screenSpaceEventHandler.removeInputAction(TS.LEFT_UP),this._screenSpaceEventHandler.removeInputAction(TS.MOUSE_MOVE),document.removeEventListener("mouseout",self._onMouseOut),rje(this)}function rje(e){u.a(e._selectedPlaneGraphics)&&(e._selectedPlaneGraphics=void 0),e._controller.enableInputs=!0,e._pickPlaneNormal=void 0,e._pickPlanePosition=void 0}function aje(e,t){var i=oje(e,t),n=oje(e,z.negate(t,new z)),r=Be.getTranslation(i.modelMatrix,new z),a=Be.getTranslation(n.modelMatrix,new z);return Math.abs(z.distance(r,a))}function oje(e,t){var i=!0,n=!1,r=void 0;try{for(var a,o=e._mPlaneEntities.values()[Symbol.iterator]();!(i=(a=o.next()).done);i=!0){var s=a.value,c=e._mPlaneEntitiesNormal.get(s.id);if(z.equals(c,t))return s}}catch(e){n=!0,r=e}finally{try{i||null==o.return||o.return()}finally{if(n)throw r}}}function sje(e){return e._boundingSphere.center}function cje(e){return e.modelMatrix}var lje=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),!u.a(t))throw new h.a("请传入工程对象");this._project=t,this._viewer=this._project._viewer.cesiumViewer,this._controller=this._project._viewer.controller,this._aryEntities=this._project._projectList.map((function(e){return e.tileset})),this._boundingSphere=this._project.boundingSphere,this._selectedPlaneGraphics=void 0,this._mPlaneEntities=new Map,this._mPlaneEntitiesNormal=new Map,this._mPlaneEntitiesMatrix=new Map,this._mClippingPlanes=new Map,this._clippingPanelNormal=void 0,this._pickPlanePosition=void 0,this._pickPlaneNormal=void 0,this._screenSpaceEventHandler=new aA(this._viewer.scene.canvas),this._mouseDownPoint=void 0,this._onMouseDown=KDe.bind(this),this._onMouseLeftUp=JDe.bind(this),this._onMouseMove=$De.bind(this),this._onMouseOut=nje.bind(this),this._onKeyDownHandler=ije.bind(this),this._backUpRenderMode=this._viewer.scene.requestRenderMode,this._viewer.scene.requestRenderMode=!1,function(e){e._screenSpaceEventHandler.setInputAction(e._onMouseDown,TS.LEFT_DOWN)}(this)}var t,i,n;return t=e,(i=[{key:"addClippingPlane",value:function(e){var t=this;switch(function(e){var t=!0,i=!1,n=void 0;try{for(var r,a=e._aryEntities[Symbol.iterator]();!(t=(r=a.next()).done);t=!0){var o=r.value;u.a(o.clippingPlanes)?o.clippingPlanes.removeAll():o.clippingPlanes=new iJ({edgeWidth:1,unionClippingRegions:!0}),u.a(o.id)||(o.id=Mg())}}catch(e){i=!0,n=e}finally{try{t||null==a.return||a.return()}finally{if(i)throw n}}}(t),u.a(t._boundingSphere)||(t._boundingSphere=function(e){if(1===e._aryEntities.length)return e._aryEntities[0].boundingSphere;var t=[],i=!0,n=!1,r=void 0;try{for(var a,o=e._aryEntities[Symbol.iterator]();!(i=(a=o.next()).done);i=!0){var s=a.value;t.push(s.boundingSphere.center)}}catch(e){n=!0,r=e}finally{try{i||null==o.return||o.return()}finally{if(n)throw r}}var c=St.fromPoints(t);return c.radius=120,c}(t)),t._mPlaneEntities.size>0&&(t._mPlaneEntities.forEach((function(e,i){t._viewer.scene.primitives.remove(e)})),t._mPlaneEntities.clear()),e){case"X":QDe(t,new z(-1,0,0),!1);break;case"Y":QDe(t,new z(0,-1,0),!1);break;case"Z":QDe(t,new z(0,0,-1),!1);break;case"XYZ":QDe(t,new z(1,0,0),!0),QDe(t,new z(-1,0,0),!0),QDe(t,new z(0,1,0),!0),QDe(t,new z(0,-1,0),!0),QDe(t,new z(0,0,1),!0),QDe(t,new z(0,0,-1),!0)}var i=[],n=!0,r=!1,a=void 0;try{for(var o,s=t._aryEntities[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var c=o.value;i.push(c.readyPromise)}}catch(e){r=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw a}}Oi.a.all(i,(function(){var e=!0,i=!1,n=void 0;try{for(var r,a=t._aryEntities[Symbol.iterator]();!(e=(r=a.next()).done);e=!0){var o=r.value,s=cje(o);if((o instanceof zse||o instanceof D6)&&!Be.equals(s,Be.IDENTITY)){var c=Be.getTranslation(o.modelMatrix,new z),l=z.subtract(c,o.boundingSphere.center,new z),u=Be.multiplyByPointAsVector(s,new z(-1,0,0),new z),h=XDe.getProjectVectorLength(l,u),d=Be.multiplyByPointAsVector(s,new z(0,-1,0),new z),f=XDe.getProjectVectorLength(l,d),p=Be.multiplyByPointAsVector(s,new z(0,0,-1),new z),m=XDe.getProjectVectorLength(l,p);o.clippingPlanes.modelMatrix=Be.fromTranslation(new z(h,f,m))}}}catch(e){i=!0,n=e}finally{try{e||null==a.return||a.return()}finally{if(i)throw n}}}))}},{key:"setPlaneVisibility",value:function(e){this._mPlaneEntities.forEach((function(t,i){t.show=e}))}},{key:"isDestroyed",value:function(){return!1}},{key:"destroy",value:function(){var e=this;if(u.a(e._mPlaneEntities)&&(e._mPlaneEntities.size>0&&u.a(e._viewer)&&e._mPlaneEntities.forEach((function(t,i){e._viewer.scene.primitives.remove(t)})),e._mPlaneEntities.clear(),e._mPlaneEntities=void 0),u.a(e._mPlaneEntitiesNormal)&&(e._mPlaneEntitiesNormal.clear(),e._mPlaneEntitiesNormal=void 0),u.a(e._mPlaneEntitiesMatrix)&&(e._mPlaneEntitiesMatrix.clear(),e._mPlaneEntitiesMatrix=void 0),u.a(e._mClippingPlanes)&&(e._mClippingPlanes.clear(),e._mClippingPlanes=void 0),e._selectedPlaneGraphics=void 0,e._mouseDownPoint=void 0,e._boundingSphere=void 0,e._clippingPanelNormal=void 0,e._pickPlanePosition=void 0,e._pickPlaneNormal=void 0,function(e){u.a(e._screenSpaceEventHandler)&&(e._screenSpaceEventHandler.removeInputAction(TS.LEFT_DOWN),e._screenSpaceEventHandler.removeInputAction(TS.LEFT_UP),e._screenSpaceEventHandler.removeInputAction(TS.MOUSE_MOVE)),document.removeEventListener("mouseout",e._onMouseOut)}(e),e._onMouseDown=void 0,e._onMouseLeftUp=void 0,e._onMouseMove=void 0,e._onMouseOut=void 0,e._onKeyDownHandler=void 0,e._screenSpaceEventHandler=void 0,u.a(e._aryEntities)){var t=!0,i=!1,n=void 0;try{for(var r,a=e._aryEntities[Symbol.iterator]();!(t=(r=a.next()).done);t=!0){var o=r.value;u.a(o.clippingPlanes)&&o.clippingPlanes.removeAll()}}catch(e){i=!0,n=e}finally{try{t||null==a.return||a.return()}finally{if(i)throw n}}e._aryEntities=void 0}return e._viewer.scene.requestRenderMode=e._backUpRenderMode,e._viewer.scene.requestRender(),e._controller=void 0,e._viewer=void 0,rl(e)}}])&&ZDe(t.prototype,i),n&&ZDe(t,n),e}();function uje(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var hje=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),!u.a(t))throw new h.a("viewer不存在");this.camera=t.cesiumViewer.camera,this.scene=t.cesiumViewer.scene,this._cameraPoses=[],this.cameraTweens=[],this.startIndex=0,this.roamState=0,this.tweensRemoveCallback=this.scene.postUpdate.addEventListener((function(){Sv.update()})),this.onPosePlayed=new $o.a}var t,i,n;return t=e,(i=[{key:"createRouteFromFile",value:function(e){var t=this;f.a.fetchJson({url:e}).then((function(e){t.cameraPoses=e}))}},{key:"createRouteFromArray",value:function(e){this.cameraPoses=e}},{key:"addPose",value:function(e){var t,i;u.a(e)?(t=w.a(e.duration,1),i=w.a(e.delay,0)):(e={},t=1,i=0);var n=this.camera,r=n.positionWC,a={x:r.x,y:r.y,z:r.z,heading:n.heading,pitch:n.pitch,roll:n.roll,duration:t,delay:i,wait:i,listen:e.listen,listenId:e.listenId};this._cameraPoses.push(a)}},{key:"removePose",value:function(e){this._cameraPoses.splice(e,1)}},{key:"createTweens",value:function(){for(var e=this,t=this.scene,i=function(i){var n=e.cameraPoses[i],r=n.duration,a=n.delay,o=n.x,s=n.y,c=n.z,l=n.heading,u=n.pitch,h=n.listen,d=n.listenId;if(i>0){var f=e.cameraPoses[i-1].heading,p=e.cameraPoses[i-1].pitch,m=new Sv.Tween(e.cameraPose).to({x:o,y:s,z:c,time:i*r},1e3*r).easing(Sv.Easing.Linear.None).onComplete((function(){e.startIndex++,h&&e.onPosePlayed.raiseEvent(d)})).onUpdate((function(){var n,a,o=(e.cameraPose.time-(i-1)*r)/r,s=(n=f,a=l,I.equalsEpsilon(n,I.TWO_PI,I.EPSILON11)&&(n=0),a>n+Math.PI?n+=I.TWO_PI:a<n-Math.PI&&(n-=I.TWO_PI),n);t.camera.setView({destination:new z(e.cameraPose.x,e.cameraPose.y,e.cameraPose.z),orientation:{heading:I.lerp(s,l,o),pitch:I.lerp(p,u,o)}})}));a&&m.delay(1e3*a),e.cameraTweens.length>=1&&e.cameraTweens[e.cameraTweens.length-1].chain(m),e.cameraTweens.push(m),i===e.cameraPoses.length-1&&m.onComplete((function(){e.startIndex=0,e.roamState=0,h&&e.onPosePlayed.raiseEvent(d)}))}else 0===i&&(e.cameraPose={x:o,y:s,z:c,time:0},t.camera.setView({destination:new z(o,s,c),orientation:{heading:l,pitch:u}}),h&&e.onPosePlayed.raiseEvent(d))},n=this.startIndex;n<this.cameraPoses.length;n++)i(n)}},{key:"createCameraFlights",value:function(){var e=this;this.cameraPoses.length>0&&(0===this.roamState||2===this.roamState)?function(){e.roamState=1;for(var t=e.scene,i=e.startIndex,n=i;n<e.cameraPoses.length;n++)e.tempPromise=n==i?new Promise(0==i?function(i,n){var r=e.cameraPoses[0],a=r.x,o=r.y,s=r.z,c=r.heading,l=r.pitch,u=r.duration,h=r.wait,d=Kre.createTween(t,{destination:new z(a,o,s),heading:c,pitch:l,duration:u,complete:function(){e.startIndex=1,0!==h?setTimeout((function(){i(1)}),1e3*h):i(1)},easingFunction:Pv.LINEAR_NONE});t.tweens.add(d)}:function(n,r){var a=e.cameraPoses[i],o=a.x,s=a.y,c=a.z,l=a.heading,u=a.pitch,h=a.duration,d=a.wait,f=Kre.createTween(t,{destination:new z(o,s,c),heading:l,pitch:u,duration:h,complete:function(){e.startIndex=i+1,0!==d?setTimeout((function(){n(e.startIndex)}),1e3*d):n(e.startIndex)},easingFunction:Pv.LINEAR_NONE});t.tweens.add(f)}):e.tempPromise.then((function(i){var n=e.cameraPoses[i],r=n.x,a=n.y,o=n.z,s=n.heading,c=n.pitch,l=n.duration,u=n.wait;return new Promise((function(n,h){var d=Kre.createTween(t,{destination:new z(r,a,o),heading:s,pitch:c,duration:l,complete:function(){e.startIndex=i+1,0!==u?setTimeout((function(){n(i+1)}),1e3*u):n(i+1)},easingFunction:Pv.LINEAR_NONE});t.tweens.add(d)}))}));e.tempPromise.then((function(){e.startIndex=0,e.roamState=0}))}():console.log("路径为空或者正在播放中")}},{key:"playRoam",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.cameraPoses.length>0&&(0===this.roamState||2===this.roamState)&&(this.roamState=1,e?(this.cameraTweens=[],this.createTweens(),this.cameraTweens[this.startIndex].start()):this.createCameraFlights())}},{key:"pauseRoam",value:function(){this.scene.tweens.removeAll(),this.cameraTweens[this.startIndex]&&(this.cameraTweens[this.startIndex].stop(),this.cameraTweens[this.startIndex+1]&&this.cameraTweens[this.startIndex+1].stop()),this.roamState=2}},{key:"stopRoam",value:function(){this.scene.tweens.removeAll(),Sv.removeAll(),this.startIndex=0,this.roamState=0}},{key:"emptyRoutes",value:function(){this.stopRoam(),this._cameraPoses=[],this.cameraTweens=[],this.tempPromise=void 0}},{key:"isDestroyed",value:function(){return!1}},{key:"destroy",value:function(){return this.emptyRoutes(),this.tweensRemoveCallback(),rl(this)}},{key:"cameraPoses",get:function(){return this._cameraPoses},set:function(e){this._cameraPoses=e}}])&&uje(t.prototype,i),n&&uje(t,n),e}();var dje={AERIAL:"Aerial",AERIAL_WITH_LABELS:"AerialWithLabels",ROAD:"Road",CANVAS_DARK:"CanvasDark",CANVAS_LIGHT:"CanvasLight",CANVAS_GRAY:"CanvasGray",COLLINS_BART:"CollinsBart"};Object.freeze(dje);var fje=dje;function pje(e){return(pje="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function mje(e,t){return!t||"object"!==pje(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function _je(e){return(_je=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function gje(e,t){return(gje=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var vje=function(e){function t(e){var i;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),i=mje(this,_je(t).call(this,e)),!u.a(e.url))throw new h.a("options.url未定义");return i._bingMapStyle=w.a(e.mapStyle,fje.AERIAL),i._url=e.url,en.defaultKey=w.a(e.key,en.defaultKey),i.mapProvider=new Are({url:"https://dev.virtualearth.net",mapStyle:i._bingMapStyle}),i.mapLayer=new phe(i.mapProvider),i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&gje(e,t)}(t,e),t}(TIe);function bje(e){return(bje="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function yje(e,t){return!t||"object"!==bje(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function wje(e){return(wje=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Oje(e,t){return(Oje=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var xje=function(e){function t(e){var i;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),i=yje(this,wje(t).call(this,e)),!u.a(e.url))throw new h.a("options.url未定义");return i._url=e.url,i.mapProvider=new _re({url:i._url,enablePickFeatures:w.a(e.enablePickFeatures,!1),maximumLevel:i._maximumLevel,tilingScheme:i._tilingScheme}),i.mapLayer=new phe(i.mapProvider),i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Oje(e,t)}(t,e),t}(TIe);function Eje(e){return(Eje="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Tje(e,t){return!t||"object"!==Eje(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Cje(e){return(Cje=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Sje(e,t){return(Sje=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Aje=function(e){function t(e){var i;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),i=Tje(this,Cje(t).call(this,e)),!u.a(e.url))throw new h.a("options.url未定义");if(!u.a(e.layers))throw new h.a("options.layers未定义");return i.mapProvider=new $ce({url:e.url,layers:e.layers,parameters:e.parameters,maximumLevel:i._maximumLevel,tilingScheme:i._tilingScheme,getFeatureInfoFormats:[new Gce("json",void 0,(function(t){e.pickCallback&&e.pickCallback(t.features.map((function(e){return e.properties})))}))]}),i.mapLayer=new phe(i.mapProvider),i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Sje(e,t)}(t,e),t}(TIe);function Pje(e){return(Pje="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ije(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Dje(e,t){return!t||"object"!==Pje(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function jje(e,t,i){return(jje="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,i){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Mje(e)););return e}(e,t);if(n){var r=Object.getOwnPropertyDescriptor(n,t);return r.get?r.get.call(i):r.value}})(e,t,i||e)}function Mje(e){return(Mje=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Rje(e,t){return(Rje=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Lje=function(e){function t(e,i,n,r){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Dje(this,Mje(t).call(this,e,i,n,r))}var i,n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Rje(e,t)}(t,e),i=t,r=[{key:"fromCssColorString",value:function(e){return jje(Mje(t),"fromCssColorString",this).call(this,e)}},{key:"fromHexString",value:function(e){if(!u.a(e))throw new h.a("颜色字符串未定义");if((e=e.trim()).length<6||e.length>7)throw new h.a("颜色字符串格式不正确");return"#"===e[0]?jje(Mje(t),"fromCssColorString",this).call(this,e):jje(Mje(t),"fromCssColorString",this).call(this,"#"+e)}}],(n=[{key:"toHexString",value:function(){return this.toHexString()}},{key:"withAlpha",value:function(e){return this.withAlpha(e)}}])&&Ije(i.prototype,n),r&&Ije(i,r),t}(uf);function Nje(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Fje=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,i,n;return t=e,(i=[{key:"serverUrl",get:function(){return FPe.server},set:function(e){FPe.server=e}},{key:"MOTOR_BASE_URL",get:function(){return window.CESIUM_BASE_URL},set:function(e){window.CESIUM_BASE_URL=e}}])&&Nje(t.prototype,i),n&&Nje(t,n),e}();function kje(e){return(kje="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Bje(e,t){return!t||"object"!==kje(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function zje(e){return(zje=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Uje(e,t){return(Uje=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Vje=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Bje(this,zje(t).call(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Uje(e,t)}(t,e),t}(Be);function Hje(e){return(Hje="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Gje(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function qje(e,t){return!t||"object"!==Hje(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Wje(e){return(Wje=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Yje(e,t){return(Yje=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Xje=function(e){function t(e,i){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),qje(this,Wje(t).call(this,e,i))}var i,n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Yje(e,t)}(t,e),i=t,r=[{key:"getProjectVectorLength",value:function(e,i){return x.a.defined("a",e),x.a.defined("b",i),t.dot(e,i)/t.dot(i,i)}}],(n=null)&&Gje(i.prototype,n),r&&Gje(i,r),t}(Rt);function Zje(e){return(Zje="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Qje(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Kje(e,t){return!t||"object"!==Zje(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Jje(e,t,i){return(Jje="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,i){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=$je(e)););return e}(e,t);if(n){var r=Object.getOwnPropertyDescriptor(n,t);return r.get?r.get.call(i):r.value}})(e,t,i||e)}function $je(e){return($je=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function eMe(e,t){return(eMe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var tMe=function(e){function t(e,i,n){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Kje(this,$je(t).call(this,e,i,n))}var i,n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&eMe(e,t)}(t,e),i=t,r=[{key:"fromCartesian",value:function(e){return Jje($je(t),"fromCartesian",this).call(this,e)}},{key:"toCartesian",value:function(e){return Jje($je(t),"toCartesian",this).call(this,e)}}],(n=null)&&Qje(i.prototype,n),r&&Qje(i,r),t}(K);function iMe(e){return(iMe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function nMe(e,t){return!t||"object"!==iMe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function rMe(e){return(rMe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function aMe(e,t){return(aMe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var oMe=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),nMe(this,rMe(t).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&aMe(e,t)}(t,e),t}(ESe),sMe=n(209),cMe=n.n(sMe);function lMe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(!(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)))return;var i=[],n=!0,r=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(n=(o=s.next()).done)&&(i.push(o.value),!t||i.length!==t);n=!0);}catch(e){r=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw a}}return i}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function uMe(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function hMe(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function dMe(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var fMe=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),!u.a(t.viewer))throw new h.a("options.viewer未定义");this.viewer=t.viewer.cesiumViewer;var i=t.animated,n=void 0!==i&&i,r=t.interval,a=t.loop,o=void 0!==a&&a,s={};if(this.startJTime=void 0,this.entJTime=void 0,n&&u.a(r)){s={availability:r,clock:{interval:r,range:o?"LOOP":"CLAMPED"}};var c=r.split("/");this.startJTime=Tr.fromIso8601(c[0]),this.entJTime=Tr.fromIso8601(c[1]),this.viewer.clock.currentTime=this.startJTime,this.viewer.clock.shouldAnimate=!0}this.staticCzmlDataSource=new sX,this.staticCzmlDataSource.load(function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?uMe(Object(i),!0).forEach((function(t){hMe(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):uMe(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({id:"document",name:"static",version:"1.0"},s)),this.viewer.dataSources.add(this.staticCzmlDataSource),this._packets=[],this.imageNameCollection=[],this.canvasCollection=[],this.billboardgroups=[],this.imageCollection=[],this._animatedSpeed=15}var t,i,n;return t=e,(i=[{key:"add",value:function(e){var t=this;if(ym.a(e))e.forEach((function(e){t.processPacket(e);for(var i=!0,n=0;n<t._packets.length;n++)if(t._packets[n].id===e.id){i=!1;break}i&&t._packets.push({id:e.id})}));else{this.processPacket(e);for(var i=!0,n=0;n<this._packets.length;n++)if(this._packets[n].id===e.id){i=!1;break}i&&this._packets.push({id:e.id})}}},{key:"update",value:function(e){this.processPacket(e)}},{key:"processPacket",value:function(e){var t=this;if(u.a(e.id)||(e.id=Mg()),u.a(e.billboard)){var i=e.billboard.image;if(i){var n=i.split(".");if("gif"===n[n.length-1]){var r=function(e,t){for(var i in t)if(e===t[i].imageName)return i;return-1}(i,this.imageCollection);if(r>-1){var a=this.imageCollection[r];e.billboard.image=a.image,e.billboard.width=a.width,e.billboard.height=a.height,this.processBillboard(e,a.collection)}else cMe()({url:i,frames:"all",outputType:"canvas",cumulative:e.billboard.cumulative}).then((function(e){var t=e.length,i=Math.ceil(Math.sqrt(t)),n=e[0].getImage().width,r=i,a=n*r,o=e[0].getImage().height,s=i,c=o*s,l=document.createElement("canvas");l.setAttribute("width",a),l.setAttribute("height",c);var u=l.getContext("2d"),h=0,d=0,f=document.createElement("canvas");f.setAttribute("width",n),f.setAttribute("height",o);var p=f.getContext("2d");return p.translate(0,o),p.scale(1,-1),e.forEach((function(e){var t=e.getImage();p.clearRect(0,0,a,o),p.drawImage(t,0,0);var i=p.getImageData(0,0,n,o);u.putImageData(i,h*n,d*o),++h>=r&&(h=0,d++),d>=s&&(d=0)})),Promise.resolve({image:l.toDataURL("image/png"),length:t,width:n,height:o,xdim:r,ydim:s})})).then((function(n){var r=n.image,a=n.length,o=n.width,s=n.height,c=n.xdim,l=n.ydim,u=new sX;u.clustering.animatedBillboardsOptions={numberOfCol:c,numberOfRow:l,frameNumber:a,speed:t._animatedSpeed},u.load({id:"document",name:i,version:"1.0"}),t.viewer.dataSources.add(u),e.billboard.image=r,e.billboard.width=o,e.billboard.height=s,t.processBillboard(e,u),t.imageCollection.push({imageName:i,collection:u,image:r,width:o,height:s})})).catch((function(e){console.warn(e)}))}else this.staticCzmlDataSource.process(e).then((function(){})).otherwise((function(e){throw new h.a(e)}))}}else this.staticCzmlDataSource.process(e).otherwise((function(e){throw new h.a(e)}))}},{key:"processBillboard",value:function(e,t){var i=this,n={id:e.id,position:e.position,billboard:e.billboard};n.position.reference?t.process(n).then((function(e){var t=lMe(n.position.reference.split("#"),2),r=t[0],a=(t[1],i.staticCzmlDataSource.entities.getById(r));e.entities.getById(n.id).position=a.position})).otherwise((function(e){throw new h.a(e)})):t.process(n).otherwise((function(e){throw new h.a(e)}));var r={};for(var a in e)"billboard"!==a&&(r[a]=e[a]);this.staticCzmlDataSource.process(r).otherwise((function(e){throw new h.a(e)}))}},{key:"removeById",value:function(e){this.imageCollection.forEach((function(t){t.collection.entities.removeById(e)})),this.staticCzmlDataSource.entities.removeById(e)}},{key:"removeAll",value:function(){this.imageCollection.forEach((function(e){e.collection.entities.removeAll()})),this.staticCzmlDataSource.entities.removeAll()}},{key:"length",get:function(){return this._packets.length}}])&&dMe(t.prototype,i),n&&dMe(t,n),e}();function pMe(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var mMe=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),!u.a(t.viewer))throw new h.a("options.viewer未定义");this._viewer=t.viewer.cesiumViewer,this._motorviewer=t.viewer,this.primitiveCollection=this._viewer.scene.primitives.add(new R6),this._geometryCollection=[]}var t,i,n;return t=e,(i=[{key:"addBox",value:function(e){if(!u.a(e.dimensions))throw new h.a("options.dimensions未定义");if(!u.a(e.center))throw new h.a("options.center未定义");var t=w.a(e.id,Mg()),i={id:t,primitives:[],properties:e.properties},n=this._viewer,r=e.dimensions,a=e.center,o=e.fillColor,s=w.a(e.outline,!1),c=e.outlineColor,l=w.a(e.depthTest,!0),d=Be.multiplyByTranslation(xa.eastNorthUpToFixedFrame(a),new z(0,0,0),new Be),f=new ck({geometryInstances:new Mu({id:t,geometry:Ya.fromDimensions({vertexFormat:$j.VERTEX_FORMAT,dimensions:r}),modelMatrix:d,attributes:{color:df.fromColor(o||uf.WHITE)}}),appearance:new $j({closed:!0,translucent:!0,renderState:{depthTest:{enabled:l}}})});if(f.type="geometryCollection",this.primitiveCollection.add(f),i.primitives.push(f),s){var p=$a.fromDimensions({dimensions:r}),m=new Mu({id:t,geometry:p,modelMatrix:d,attributes:{color:df.fromColor(c||uf.WHITE)}}),_=new ck({geometryInstances:m,appearance:new $j({flat:!0,renderState:{lineWidth:Math.min(2,n.scene.maximumAliasedLineWidth),depthTest:{enabled:l}}})});_.type="geometryCollection",this.primitiveCollection.add(_),i.primitives.push(_)}this._geometryCollection.push(i),this._motorviewer.forceRender()}},{key:"addPlane",value:function(e){if(!u.a(e.dimensions))throw new h.a("options.dimensions未定义");if(!u.a(e.center))throw new h.a("options.center未定义");var t,i,n=w.a(e.id,Mg()),r={id:n,primitives:[],properties:e.properties},a=this._viewer,o=e.dimensions,s=w.a(e.rotation,new z),c=e.center,l=e.fillColor,d=e.image,f=e.webglSetting,p=e.show,m=w.a(e.outline,!1),_=e.outlineColor,g=w.a(e.depthTest,!0),v=w.a(e.asynchronous,!0),b=new Rr(I.toRadians(s.z),I.toRadians(s.x),I.toRadians(s.y)),y=Kn.fromHeadingPitchRoll(b,new Kn),O=new aI(new z,y,new z(o.x,o.y,1)),x=Be.fromTranslationRotationScale(O,new Be);x=Be.multiply(xa.eastNorthUpToFixedFrame(c),x,x),f?(t=new Mu({id:n,geometry:new xE,modelMatrix:x}),i=new Yj({material:new qj({fabric:f}),closed:!0,translucent:!0,renderState:{cull:{enabled:!1},depthTest:{enabled:g}}})):d?(t=new Mu({id:n,geometry:new xE,modelMatrix:x}),i=new Yj({material:new qj({fabric:{type:"Image",uniforms:{image:e.image}}}),closed:!0,translucent:!0,renderState:{cull:{enabled:!1},depthTest:{enabled:g}}})):(t=new Mu({id:n,geometry:new xE,attributes:{color:df.fromColor(l||uf.WHITE.withAlpha(0))}}),i=new $j({closed:!0,translucent:!0,renderState:{depthTest:{enabled:g}}}));var E,T=new ck({geometryInstances:t,appearance:i,modelMatrix:x,show:p,asynchronous:v});if(T.type="geometryCollection",this.primitiveCollection.add(T),r.primitives.push(T),d&&(T.removePostRenderCallback=a.scene.postRender.addEventListener((function(){T&&(E=new hj({context:a.scene.context,width:d.width,height:d.height,source:d}),T.appearance.material.uniforms.image=E)}))),m){var C=new SE,S=new Mu({id:n,geometry:C,modelMatrix:x,attributes:{color:df.fromColor(_||uf.WHITE)}}),A=new ck({geometryInstances:S,appearance:new $j({flat:!0,renderState:{lineWidth:Math.min(2,a.scene.maximumAliasedLineWidth),depthTest:{enabled:g}}}),asynchronous:v});A.type="geometryCollection",this.primitiveCollection.add(A),r.primitives.push(A)}return this._geometryCollection.push(r),T}},{key:"addPolyline",value:function(e){if(!u.a(e.positions))throw new h.a("component未定义");var t,i=w.a(e.id,Mg()),n=e.positions,r=w.a(e.style,"color"),a=w.a(e.width,10),o=w.a(e.color,uf.WHITE),s=w.a(e.modelMatrix,xa.eastNorthUpToFixedFrame(e.origin));"color"===r&&(t=qj.fromType("Color",{color:o})),"arrow"===r&&(t=qj.fromType(qj.PolylineArrowType,{color:o}));var c={id:i,primitives:[],properties:e.properties},l=new ck({geometryInstances:new Mu({id:i,geometry:new PT({positions:n,width:a,arcType:Zt.NONE,vertexFormat:DB.VERTEX_FORMAT})}),appearance:new DB({material:t,renderState:{depthTest:{enabled:w.a(e.depthTest,!0)}}}),modelMatrix:s});return l.type="geometryCollection",c.primitives.push(l),this._geometryCollection.push(c),this.primitiveCollection.add(l),l}},{key:"addSphere",value:function(e){if(!u.a(e.origin)&&!u.a(e.modelMatrix))throw new h.a("中心点或者矩阵未定义");var t=w.a(e.id,Mg()),i=w.a(e.modelMatrix,xa.eastNorthUpToFixedFrame(e.origin)),n=w.a(e.color,uf.WHITE),r=w.a(e.radius,1),a={id:t,primitives:[],properties:e.properties},o=new ck({geometryInstances:new Mu({id:t,geometry:new jP({vertexFormat:$j.VERTEX_FORMAT,radius:r}),modelMatrix:i,attributes:{color:df.fromColor(n)}}),appearance:new $j({translucent:n.alpha<1,closed:!0,renderState:{depthTest:{enabled:w.a(e.depthTest,!0)}}})});return o.type="geometryCollection",a.primitives.push(o),this._geometryCollection.push(a),this.primitiveCollection.add(o),o}},{key:"addAxis",value:function(e){if(!u.a(e.component))throw new h.a("component未定义");var t=w.a(e.id,Mg()),i=e.component.boundingSphere,n=xa.eastNorthUpToFixedFrame(i.center),r=w.a(e.axisLength,1.5*i.radius),a=w.a(e.axisWidth,10),o=new A3({modelMatrix:n}),s={id:t,primitives:[],properties:e.properties},c=o.add({positions:[new z(0,0,0),new z(r,0,0)],width:a,material:qj.fromType(qj.PolylineArrowType,{color:uf.RED})});c.type="geometryCollection",s.primitives.push(c);var l=o.add({positions:[new z(0,0,0),new z(0,r,0)],width:a,material:qj.fromType(qj.PolylineArrowType,{color:uf.GREEN})});l.type="geometryCollection",s.primitives.push(l);var d=o.add({positions:[new z(0,0,0),new z(0,0,r)],width:a,material:qj.fromType(qj.PolylineArrowType,{color:uf.BLUE})});d.type="geometryCollection",s.primitives.push(d),o.type="geometryCollection",this.primitiveCollection.add(o)}},{key:"addGyroscope",value:function(e){if(!u.a(e.component))throw new h.a("component未定义");var t=w.a(e.id,Mg()),i=e.component.boundingSphere,n=xa.eastNorthUpToFixedFrame(i.center),r=w.a(e.axisLength,1.5*i.radius),a=w.a(e.axisWidth,10),o=new A3({modelMatrix:n}),s=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:32,i=[],n=360/t,r=0;r<=360;){var a=I.toRadians(r);i.push(new Rt(e*Math.cos(a),e*Math.sin(a))),r+=n}return i}(r),c={id:t,primitives:[],properties:e.properties},l=[];s.forEach((function(e){l.push(0,e.x,e.y)}));var d=o.add({positions:z.unpackArray(l),width:a/2,material:qj.fromType("Color",{color:uf.RED})});d.type="geometryCollection",c.primitives.push(d),l=[],s.forEach((function(e){l.push(e.x,0,e.y)}));var f=o.add({positions:z.unpackArray(l),width:a/2,material:qj.fromType("Color",{color:uf.GREEN})});f.type="geometryCollection",c.primitives.push(f),l=[],s.forEach((function(e){l.push(e.x,e.y,0)}));var p=o.add({positions:z.unpackArray(l),width:a/2,material:qj.fromType("Color",{color:uf.BLUE})});p.type="geometryCollection",c.primitives.push(p),o.type="geometryCollection",this.primitiveCollection.add(o)}},{key:"removeById",value:function(e){for(var t=this,i=0;i<this._geometryCollection.length;i++){var n=this._geometryCollection[i];if(n.id===e)return n.primitives.forEach((function(e){u.a(e.removePostRenderCallback)&&e.removePostRenderCallback(),t.primitiveCollection.remove(e)})),this._geometryCollection.splice(i,1),void this._motorviewer.forceRender()}}},{key:"removeAll",value:function(){for(var e=0;e<this._geometryCollection.length;e++)this._geometryCollection[e].primitives.forEach((function(e){u.a(e.removePostRenderCallback)&&e.removePostRenderCallback()}));this.primitiveCollection.removeAll(),this._geometryCollection=[]}},{key:"getPropertiesById",value:function(e){for(var t=0;t<this._geometryCollection.length;t++){var i=this._geometryCollection[t];if(i.id===e)return i.properties}}}])&&pMe(t.prototype,i),n&&pMe(t,n),e}();var _Me={POINTDISTANCE:0,POINTSDISTANCE:1,ANGLE:2};Object.freeze(_Me);var gMe=_Me;n(347);function vMe(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function bMe(e){if(gMe.POINTDISTANCE===e._measureMode||gMe.POINTSDISTANCE===e._measureMode||gMe.ANGLE===e._measureMode){if(u.a(e._quadCanvas)||(e._quadCanvas=yMe(e)),!u.a(e._measureCanvas))e._measureCanvas=yMe(e),e._measureCanvas.getContext("2d").lineWidth=2;e._viewer.camera.changed.addEventListener((function(){if(CMe(e),e._measureMode===gMe.POINTDISTANCE&&2===e._aryMouseClickPositions.length){var t=PMe(e),i=t.startScreen,n=t.startpScreen,r=t.endScreen,a=t.endpScreen;IMe(e,i,n,r,a)}})),e._screenSpaceEventHandler.setInputAction(e._onMouseMove,TS.MOUSE_MOVE)}}function yMe(e){var t=document.createElement("canvas");return e._viewer.container.appendChild(t),t.width=e._viewer.container.clientWidth,t.height=e._viewer.container.clientHeight,t.style.margin="0",t.style.padding="0",t.style.overflow="hidden",t.style.top="0",t.style.left="0",t.style.position="absolute",t.style.zIndex="10",t.style.pointerEvents="none",t.getContext("2d").fillStyle="rgba(255, 255, 255, 0)",t}function wMe(e){u.a(e)&&e.getContext("2d").clearRect(0,0,e.width,e.height)}function OMe(e){var t=this._viewer.scene.pickPosition(e.position);if(u.a(t))if(this._needReSet&&(this._aryMouseClickPositions.length=0,this._needReSet=!1,this._screenSpaceEventHandler.setInputAction(this._onMouseMove,TS.MOUSE_MOVE)),this._measureMode===gMe.ANGLE&&this._aryMouseClickPositions.length>=3&&(this._aryMouseClickPositions.length=0),this._measureMode===gMe.POINTDISTANCE&&this._aryMouseClickPositions.length>=2&&(this._aryMouseClickPositions.length=0),this._aryMouseClickPositions.push(t),CMe(this),this._measureMode===gMe.POINTSDISTANCE)u.a(this._callbackFunction)&&this._callbackFunction({distance:EMe(this._aryMouseClickPositions)});else if(this._measureMode===gMe.ANGLE)3===this._aryMouseClickPositions.length&&u.a(this._callbackFunction)&&this._callbackFunction({angle:TMe(this._aryMouseClickPositions)});else if(this._measureMode===gMe.POINTDISTANCE&&2===this._aryMouseClickPositions.length&&u.a(this._callbackFunction)){var i=PMe(this),n=i.startScreen,r=i.startpScreen,a=i.endScreen,o=i.endpScreen,s=i.startp,c=i.endp,l=this._aryMouseClickPositions[0],h=this._aryMouseClickPositions[1],d=z.distance(h,c),f=z.distance(c,s),p=z.distance(s,l);IMe(this,n,r,a,o),this._callbackFunction({distance:EMe(this._aryMouseClickPositions),x:p,y:f,z:d})}}function xMe(e){this._screenSpaceEventHandler.removeInputAction(TS.MOUSE_MOVE),this._needReSet=!0,CMe(this)}function EMe(e){var t=0;if(e.length>1)for(var i=0;i<e.length-1;++i){var n=e[i],r=e[i+1];t+=z.distance(n,r)}return t}function TMe(e){var t=0;if(e.length>=3){var i=z.subtract(e[0],e[1],new z),n=z.subtract(e[2],e[1],new z),r=z.dot(i,n)/(z.magnitude(i)*z.magnitude(n));t=I.toDegrees(I.acosClamped(r))}return t}function CMe(e,t){if(wMe(e._measureCanvas),e._aryMouseClickPositions&&e._aryMouseClickPositions.length>0){for(var i=0;i<e._aryMouseClickPositions.length;++i){var n=e._aryMouseClickPositions[i],r=gV.wgs84ToWindowCoordinates(e._viewer.scene,n,new Rt);u.a(r)&&SMe(e,r);var a=void 0;if(i<e._aryMouseClickPositions.length-1&&(a=e._aryMouseClickPositions[i+1]),!u.a(a)&&u.a(t)&&(a=t),u.a(a)){var o=gV.wgs84ToWindowCoordinates(e._viewer.scene,a,new Rt);u.a(r)&&u.a(o)&&AMe(e,r,o)}}!function(e){if(gMe.ANGLE===e._measureMode&&3===e._aryMouseClickPositions.length){var t=e._aryMouseClickPositions[0],i=gV.wgs84ToWindowCoordinates(e._viewer.scene,t,new Rt),n=e._aryMouseClickPositions[1],r=gV.wgs84ToWindowCoordinates(e._viewer.scene,n,new Rt),a=e._aryMouseClickPositions[2],o=gV.wgs84ToWindowCoordinates(e._viewer.scene,a,new Rt);if(u.a(i)&&u.a(r)&&u.a(o)){var s=Rt.subtract(i,r,new Rt),c=Rt.subtract(o,r,new Rt),l=new Rt(1,0),h=Rt.angleBetween(s,l),d=Rt.angleBetween(c,l);if(s.y<0&&(h=2*Math.PI-h),c.y<0&&(d=2*Math.PI-d),h>d){var f=h;h=d,d=f}var p=e._measureCanvas.getContext("2d");p.strokeStyle="orange",p.beginPath(),p.arc(r.x,r.y,20,h,d,d-h>Math.PI),p.stroke()}}}(e)}}function SMe(e,t){if(u.a(e._measureCanvas)){var i=e._measureCanvas.getContext("2d"),n=2*Math.PI;i.fillStyle="orange",i.beginPath(),i.moveTo(t.x,t.y),i.arc(t.x,t.y,5,0,n,!0),i.fill()}}function AMe(e,t,i){if(u.a(e._measureCanvas)){var n=e._measureCanvas.getContext("2d");n.strokeStyle="orange",n.beginPath(),n.moveTo(t.x,t.y),n.lineTo(i.x,i.y),n.stroke()}}function PMe(e){var t=e._aryMouseClickPositions[0],i=e._aryMouseClickPositions[1],n=e._motorViewer._projectList[0].originMatrix,r=Be.multiplyByPointAsVector(n,new z(0,0,1),new z),a=z.normalize(r,new z),o=oc.fromPointNormal(t,a),s=oc.projectPointOntoPlane(o,i),c=Be.multiplyByPointAsVector(n,new z(1,0,0),new z),l=z.normalize(c,new z),u=oc.fromPointNormal(i,l),h=oc.projectPointOntoPlane(u,t),d=gV.wgs84ToWindowCoordinates(e._viewer.scene,t,new Rt),f=gV.wgs84ToWindowCoordinates(e._viewer.scene,h,new Rt);return{startScreen:d,endScreen:gV.wgs84ToWindowCoordinates(e._viewer.scene,i,new Rt),startpScreen:f,endpScreen:gV.wgs84ToWindowCoordinates(e._viewer.scene,s,new Rt),startp:h,endp:s}}function IMe(e,t,i,n,r){if(u.a(e._measureCanvas)){var a=e._measureCanvas.getContext("2d");a.setLineDash([4]),u.a(n)&&u.a(r)&&(a.strokeStyle="blue",a.beginPath(),a.moveTo(n.x,n.y),a.lineTo(r.x,r.y),a.stroke()),u.a(r)&&u.a(i)&&(a.strokeStyle="green",a.beginPath(),a.moveTo(r.x,r.y),a.lineTo(i.x,i.y),a.stroke()),u.a(i)&&u.a(t)&&(a.strokeStyle="red",a.beginPath(),a.moveTo(i.x,i.y),a.lineTo(t.x,t.y),a.stroke(),a.setLineDash([]))}}function DMe(e){var t;this._mouseMovePoint=e.endPosition,this._measureMode===gMe.ANGLE&&3===this._aryMouseClickPositions.length||this._measureMode===gMe.POINTDISTANCE&&2===this._aryMouseClickPositions.length||(this._aryMouseClickPositions.length>0&&(this._measureMode===gMe.POINTSDISTANCE||this._measureMode===gMe.ANGLE&&this._aryMouseClickPositions.length<3||this._measureMode===gMe.POINTDISTANCE&&this._aryMouseClickPositions.length<2)&&(t=UAe.getIntersectionByRayAndPlane(this._viewer.scene.camera.getPickRay(e.endPosition),this._aryMouseClickPositions[0],this._viewer.scene.camera.direction)),CMe(this,t))}var jMe=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._viewer=t.viewer.cesiumViewer,this._motorViewer=t.viewer,this._entity=t.entity,this._callbackFunction=t.callback,this._measureMode=w.a(t.mode,gMe.ANGLE),this._screenSpaceEventHandler=new aA(this._viewer.scene.canvas),this._onMouseLeftClick=OMe.bind(this),this._onMouseRightClick=xMe.bind(this),this._onMouseMove=DMe.bind(this),this._aryMouseClickPositions=[],this._quadCanvas=void 0,this._measureCanvas=void 0,this._eventHelper=new eb,this._scratchCalculateCartesian={XAxis:new z,YAxis:new z,ZAxis:new z},this._localTransfrom=new Be,this._plane=void 0,this._needReSet=!1,function(e){e._screenSpaceEventHandler.setInputAction(e._onMouseLeftClick,TS.LEFT_CLICK),e._screenSpaceEventHandler.setInputAction(e._onMouseRightClick,TS.RIGHT_CLICK)}(this),bMe(this)}var t,i,n;return t=e,(i=[{key:"isDestroyed",value:function(){return!1}},{key:"destroy",value:function(){return function(e){u.a(e._screenSpaceEventHandler)&&(e._screenSpaceEventHandler.removeInputAction(TS.LEFT_CLICK),e._screenSpaceEventHandler.removeInputAction(TS.RIGHT_CLICK),e._screenSpaceEventHandler.removeInputAction(TS.MOUSE_MOVE))}(this),this._screenSpaceEventHandler=void 0,this._onMouseLeftClick=void 0,this._onMouseMove=void 0,this._onMouseOut=void 0,this._aryMouseClickPositions.length=0,this._aryMouseClickPositions=void 0,u.a(this._measureCanvas)&&(this._viewer.container.removeChild(this._measureCanvas),this._measureCanvas=void 0),u.a(this._quadCanvas)&&(this._viewer.container.removeChild(this._quadCanvas),this._quadCanvas=void 0),u.a(this._eventHelper)&&(this._eventHelper.removeAll(),this._eventHelper=void 0),rl(this)}},{key:"mode",get:function(){return this._measureMode},set:function(e){this._measureMode=e,this._eventHelper.removeAll(),this._aryMouseClickPositions.length=0,this._needReSet=!1,wMe(this._measureCanvas),wMe(this._quadCanvas),function(e){u.a(e._screenSpaceEventHandler)&&e._screenSpaceEventHandler.removeInputAction(TS.MOUSE_MOVE),e._mouseMovePoint=void 0}(this),bMe(this)}}])&&vMe(t.prototype,i),n&&vMe(t,n),e}(),MMe={SHIFT:0,CTRL:1,ALT:2};Object.freeze(MMe);var RMe=MMe;function LMe(e){return(LMe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function NMe(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function FMe(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function kMe(e,t){return!t||"object"!==LMe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function BMe(e){return(BMe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function zMe(e,t){return(zMe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var UMe=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var i,n=e.origin;return n&&(i=xa.eastNorthUpToFixedFrame(n)),kMe(this,BMe(t).call(this,function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?NMe(Object(i),!0).forEach((function(t){FMe(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):NMe(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({modelMatrix:i},e)))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&zMe(e,t)}(t,e),t}(Bfe);function VMe(e){return(VMe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function HMe(e,t){return!t||"object"!==VMe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function GMe(e){return(GMe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function qMe(e,t){return(qMe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var WMe=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),HMe(this,GMe(t).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&qMe(e,t)}(t,e),t}(jre);function YMe(e){return(YMe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function XMe(e,t){return!t||"object"!==YMe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ZMe(e){return(ZMe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function QMe(e,t){return(QMe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var KMe=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),XMe(this,ZMe(t).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&QMe(e,t)}(t,e),t}(Xse);function JMe(e){return(JMe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $Me(e,t){return!t||"object"!==JMe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function eRe(e){return(eRe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function tRe(e,t){return(tRe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var iRe=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),$Me(this,eRe(t).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&tRe(e,t)}(t,e),t}($se);function nRe(e){return(nRe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function rRe(e,t){return!t||"object"!==nRe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function aRe(e){return(aRe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function oRe(e,t){return(oRe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var sRe=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),rRe(this,aRe(t).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&oRe(e,t)}(t,e),t}(MOe),cRe={ARROWLINE:0,RECT:1,ELLIPSE:2,TEXT:3};Object.freeze(cRe);var lRe=cRe;
/**
 * @license Event
 * Visit http://createjs.com/ for documentation, updates and examples.
 *
 * Copyright (c) 2017 gskinner.com, inc.
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use,
 * copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the
 * Software is furnished to do so, subject to the following
 * conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
 * OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
 * HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
 * WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
 * OTHER DEALINGS IN THE SOFTWARE.
 */class uRe{constructor(e,t=!1,i=!1){this.type=e,this.target=null,this.currentTarget=null,this.eventPhase=0,this.bubbles=t,this.cancelable=i,this.timeStamp=(new Date).getTime(),this.defaultPrevented=!1,this.propagationStopped=!1,this.immediatePropagationStopped=!1,this.removed=!1}preventDefault(){return this.defaultPrevented=this.cancelable,this}stopPropagation(){return this.propagationStopped=!0,this}stopImmediatePropagation(){return this.immediatePropagationStopped=this.propagationStopped=!0,this}remove(){return this.removed=!0,this}clone(){const e=new uRe(this.type,this.bubbles,this.cancelable);for(let t in this)this.hasOwnProperty(t)&&(e[t]=this[t]);return e}set(e){for(let t in e)this[t]=e[t];return this}toString(){return`[${this.constructor.name} (type=${this.type})]`}}var hRe=uRe;
/**
 * @license EventDispatcher
 * Visit http://createjs.com/ for documentation, updates and examples.
 *
 * Copyright (c) 2017 gskinner.com, inc.
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use,
 * copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the
 * Software is furnished to do so, subject to the following
 * conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
 * OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
 * HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
 * WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
 * OTHER DEALINGS IN THE SOFTWARE.
 */class dRe{static initialize(e){const t=dRe.prototype;e.addEventListener=t.addEventListener,e.on=t.on,e.removeEventListener=e.off=t.removeEventListener,e.removeAllEventListeners=t.removeAllEventListeners,e.hasEventListener=t.hasEventListener,e.dispatchEvent=t.dispatchEvent,e._dispatchEvent=t._dispatchEvent,e.willTrigger=t.willTrigger}constructor(){this._listeners=null,this._captureListeners=null}addEventListener(e,t,i=!1){let n;n=i?this._captureListeners=this._captureListeners||{}:this._listeners=this._listeners||{};let r=n[e];return r&&(this.removeEventListener(e,t,i),r=n[e]),r?r.push(t):n[e]=[t],t}on(e,t,i=null,n=!1,r={},a=!1){return t.handleEvent&&(i=i||t,t=t.handleEvent),i=i||this,this.addEventListener(e,e=>{t.call(i,e,r),n&&e.remove()},a)}removeEventListener(e,t,i=!1){const n=i?this._captureListeners:this._listeners;if(!n)return;const r=n[e];if(!r)return;const a=r.length;for(let i=0;i<a;i++)if(r[i]===t){1===a?delete n[e]:r.splice(i,1);break}}off(e,t,i=!1){this.removeEventListener(e,t,i)}removeAllEventListeners(e=null){e?(this._listeners&&delete this._listeners[e],this._captureListeners&&delete this._captureListeners[e]):this._listeners=this._captureListeners=null}dispatchEvent(e,t=!1,i=!1){if("string"==typeof e){const n=this._listeners;if(!(t||n&&n[e]))return!0;e=new hRe(e,t,i)}else e.target&&e.clone&&(e=e.clone());try{e.target=this}catch(e){}if(e.bubbles&&this.parent){let t=this;const i=[t];for(;t.parent;)i.push(t=t.parent);const n=i.length;let r;for(r=n-1;r>=0&&!e.propagationStopped;r--)i[r]._dispatchEvent(e,1+(0==r));for(r=1;r<n&&!e.propagationStopped;r++)i[r]._dispatchEvent(e,3)}else this._dispatchEvent(e,2);return!e.defaultPrevented}hasEventListener(e){const t=this._listeners,i=this._captureListeners;return!!(t&&t[e]||i&&i[e])}willTrigger(e){let t=this;for(;t;){if(t.hasEventListener(e))return!0;t=t.parent}return!1}toString(){return`[${this.constructor.name+this.name?` ${this.name}`:""}]`}_dispatchEvent(e,t){const i=1===t?this._captureListeners:this._listeners;if(e&&i){let n,r=i[e.type];if(!r||0===(n=r.length))return;try{e.currentTarget=this}catch(e){}try{e.eventPhase=t}catch(e){}e.removed=!1,r=r.slice();for(let i=0;i<n&&!e.immediatePropagationStopped;i++){let n=r[i];n.handleEvent?n.handleEvent(e):n(e),e.removed&&(this.off(e.type,n,1===t),e.removed=!1)}}}}var fRe=dRe;
/**
 * @license Ticker
 * Visit http://createjs.com/ for documentation, updates and examples.
 *
 * Copyright (c) 2017 gskinner.com, inc.
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use,
 * copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the
 * Software is furnished to do so, subject to the following
 * conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
 * OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
 * HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
 * WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
 * OTHER DEALINGS IN THE SOFTWARE.
 */class pRe extends fRe{static get RAF_SYNCHED(){return"synched"}static get RAF(){return"raf"}static get TIMEOUT(){return"timeout"}constructor(e){super(),this.name=e,this.timingMode=pRe.TIMEOUT,this.maxDelta=0,this.paused=!1,this._inited=!1,this._startTime=0,this._pausedTime=0,this._ticks=0,this._pausedTicks=0,this._interval=50,this._lastTime=0,this._times=null,this._tickTimes=null,this._timerId=null,this._raf=!0}get interval(){return this._interval}set interval(e){this._interval=e,this._inited&&this._setupTick()}get framerate(){return 1e3/this._interval}set framerate(e){this.interval=1e3/e}init(){this._inited||(this._inited=!0,this._times=[],this._tickTimes=[],this._startTime=this._getTime(),this._times.push(this._lastTime=0),this._setupTick())}reset(){if(this._raf){let e=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.oCancelAnimationFrame||window.msCancelAnimationFrame;e&&e(this._timerId)}else clearTimeout(this._timerId);this.removeAllEventListeners("tick"),this._timerId=this._times=this._tickTimes=null,this._startTime=this._lastTime=this._ticks=0,this._inited=!1}addEventListener(e,t,i){return!this._inited&&this.init(),super.addEventListener(e,t,i)}getMeasuredTickTime(e=null){const t=this._tickTimes;return!t||t.length<1?-1:(e=Math.min(t.length,e||0|this.framerate),t.reduce((e,t)=>e+t,0)/e)}getMeasuredFPS(e=null){const t=this._times;return!t||t.length<2?-1:(e=Math.min(t.length-1,e||0|this.framerate),1e3/((t[0]-t[e])/e))}getTime(e=!1){return this._startTime?this._getTime()-(e?this._pausedTime:0):-1}getEventTime(e=!1){return this._startTime?(this._lastTime||this._startTime)-(e?this._pausedTime:0):-1}getTicks(e=!1){return this._ticks-(e?this._pausedTicks:0)}_handleSynch(){this._timerId=null,this._setupTick(),this._getTime()-this._lastTime>=.97*(this._interval-1)&&this._tick()}_handleRAF(){this._timerId=null,this._setupTick(),this._tick()}_handleTimeout(){this._timerId=null,this._setupTick(),this._tick()}_setupTick(){if(null!=this._timerId)return;const e=this.timingMode||this._raf&&pRe.RAF;if(e===pRe.RAF_SYNCHED||e===pRe.RAF){const t=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame;if(t)return this._timerId=t(e===pRe.RAF?this._handleRAF.bind(this):this._handleSynch.bind(this)),void(this._raf=!0)}this._raf=!1,this._timerId=setTimeout(this._handleTimeout.bind(this),this._interval)}_tick(){const e=this.paused,t=this._getTime(),i=t-this._lastTime;if(this._lastTime=t,this._ticks++,e&&(this._pausedTicks++,this._pausedTime+=i),this.hasEventListener("tick")){const n=new hRe("tick"),r=this.maxDelta;n.delta=r&&i>r?r:i,n.paused=e,n.time=t,n.runTime=t-this._pausedTime,this.dispatchEvent(n)}for(this._tickTimes.unshift(this._getTime()-t);this._tickTimes.length>100;)this._tickTimes.pop();for(this._times.unshift(t);this._times.length>100;)this._times.pop()}_getTime(){const e=window.performance&&window.performance.now;return(e&&e.call(performance)||(new Date).getTime())-this._startTime}static on(e,t,i,n,r,a){return _Re.on(e,t,i,n,r,a)}static removeEventListener(e,t,i){_Re.removeEventListener(e,t,i)}static off(e,t,i){_Re.off(e,t,i)}static removeAllEventListeners(e){_Re.removeAllEventListeners(e)}static dispatchEvent(e,t,i){return _Re.dispatchEvent(e,t,i)}static hasEventListener(e){return _Re.hasEventListener(e)}static willTrigger(e){return _Re.willTrigger(e)}static toString(){return _Re.toString()}static init(){_Re.init()}static reset(){_Re.reset()}static addEventListener(e,t,i){_Re.addEventListener(e,t,i)}static getMeasuredTickTime(e){return _Re.getMeasuredTickTime(e)}static getMeasuredFPS(e){return _Re.getMeasuredFPS(e)}static getTime(e){return _Re.getTime(e)}static getEventTime(e){return _Re.getEventTime(e)}static getTicks(e){return _Re.getTicks(e)}static get interval(){return _Re.interval}static set interval(e){_Re.interval=e}static get framerate(){return _Re.framerate}static set framerate(e){_Re.framerate=e}static get name(){return _Re.name}static set name(e){_Re.name=e}static get timingMode(){return _Re.timingMode}static set timingMode(e){_Re.timingMode=e}static get maxDelta(){return _Re.maxDelta}static set maxDelta(e){_Re.maxDelta=e}static get paused(){return _Re.paused}static set paused(e){_Re.paused=e}}var mRe=pRe;const _Re=new pRe("createjs.global");
/**
 * @license
 *
 * StageGL
 * Visit http://createjs.com/ for documentation, updates and examples.
 *
 * Copyright (c) 2017 gskinner.com, inc.
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use,
 * copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the
 * Software is furnished to do so, subject to the following
 * conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
 * OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
 * HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
 * WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
 * OTHER DEALINGS IN THE SOFTWARE.
 */var gRe=class{constructor(){throw new Error("\n\t\t\tStageGL is not currently supported on the EaselJS 2.0 branch.\n\t\t\tEnd of Q1 2018 is targetted for StageGL support.\n\t\t\tFollow @CreateJS on Twitter for updates.\n\t\t")}};
/**
 * @license Shadow
 * Visit http://createjs.com/ for documentation, updates and examples.
 *
 * Copyright (c) 2017 gskinner.com, inc.
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use,
 * copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the
 * Software is furnished to do so, subject to the following
 * conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
 * OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
 * HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
 * WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
 * OTHER DEALINGS IN THE SOFTWARE.
 */class vRe{constructor(e="black",t=0,i=0,n=0){this.color=e,this.offsetX=t,this.offsetY=i,this.blur=n}toString(){return`[${this.constructor.name}]`}clone(){return new vRe(this.color,this.offsetX,this.offsetY,this.blur)}}vRe.identity=new vRe("transparent");
/**
 * @license uid
 * Visit http://createjs.com/ for documentation, updates and examples.
 *
 * Copyright (c) 2017 gskinner.com, inc.
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use,
 * copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the
 * Software is furnished to do so, subject to the following
 * conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
 * OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
 * HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
 * WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
 * OTHER DEALINGS IN THE SOFTWARE.
 */
let bRe=0;
/**
 * @license Point
 * Visit http://createjs.com/ for documentation, updates and examples.
 *
 * Copyright (c) 2017 gskinner.com, inc.
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use,
 * copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the
 * Software is furnished to do so, subject to the following
 * conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
 * OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
 * HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
 * WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
 * OTHER DEALINGS IN THE SOFTWARE.
 */
class yRe{constructor(e,t){this.setValues(e,t)}setValues(e=0,t=0){return this.x=e,this.y=t,this}copy(e){return this.x=e.x,this.y=e.y,this}clone(){return new yRe(this.x,this.y)}toString(){return`[${this.constructor.name} (x=${this.x} y=${this.y})]`}}
/**
 * @license Matrix2D
 * Visit http://createjs.com/ for documentation, updates and examples.
 *
 * Copyright (c) 2017 gskinner.com, inc.
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use,
 * copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the
 * Software is furnished to do so, subject to the following
 * conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
 * OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
 * HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
 * WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
 * OTHER DEALINGS IN THE SOFTWARE.
 */class wRe{constructor(e,t,i,n,r,a){this.setValues(e,t,i,n,r,a)}setValues(e=1,t=0,i=0,n=1,r=0,a=0){return this.a=e,this.b=t,this.c=i,this.d=n,this.tx=r,this.ty=a,this}append(e,t,i,n,r,a){let o=this.a,s=this.b,c=this.c,l=this.d;return 1==e&&0==t&&0==i&&1==n||(this.a=o*e+c*t,this.b=s*e+l*t,this.c=o*i+c*n,this.d=s*i+l*n),this.tx=o*r+c*a+this.tx,this.ty=s*r+l*a+this.ty,this}prepend(e,t,i,n,r,a){let o=this.a,s=this.c,c=this.tx;return this.a=e*o+i*this.b,this.b=t*o+n*this.b,this.c=e*s+i*this.d,this.d=t*s+n*this.d,this.tx=e*c+i*this.ty+r,this.ty=t*c+n*this.ty+a,this}appendMatrix(e){return this.append(e.a,e.b,e.c,e.d,e.tx,e.ty)}prependMatrix(e){return this.prepend(e.a,e.b,e.c,e.d,e.tx,e.ty)}appendTransform(e,t,i,n,r,a,o,s,c){let l,u,h;return r%360?(l=r*wRe.DEG_TO_RAD,u=Math.cos(l),h=Math.sin(l)):(u=1,h=0),a||o?(a*=wRe.DEG_TO_RAD,o*=wRe.DEG_TO_RAD,this.append(Math.cos(o),Math.sin(o),-Math.sin(a),Math.cos(a),e,t),this.append(u*i,h*i,-h*n,u*n,0,0)):this.append(u*i,h*i,-h*n,u*n,e,t),(s||c)&&(this.tx-=s*this.a+c*this.c,this.ty-=s*this.b+c*this.d),this}prependTransform(e,t,i,n,r,a,o,s,c){let l,u,h;return r%360?(l=r*wRe.DEG_TO_RAD,u=Math.cos(l),h=Math.sin(l)):(u=1,h=0),(s||c)&&(this.tx-=s,this.ty-=c),a||o?(a*=wRe.DEG_TO_RAD,o*=wRe.DEG_TO_RAD,this.prepend(u*i,h*i,-h*n,u*n,0,0),this.prepend(Math.cos(o),Math.sin(o),-Math.sin(a),Math.cos(a),e,t)):this.prepend(u*i,h*i,-h*n,u*n,e,t),this}rotate(e){e*=wRe.DEG_TO_RAD;let t=Math.cos(e),i=Math.sin(e),n=this.a,r=this.b;return this.a=n*t+this.c*i,this.b=r*t+this.d*i,this.c=-n*i+this.c*t,this.d=-r*i+this.d*t,this}skew(e,t){return e*=wRe.DEG_TO_RAD,t*=wRe.DEG_TO_RAD,this.append(Math.cos(t),Math.sin(t),-Math.sin(e),Math.cos(e),0,0),this}scale(e,t){return this.a*=e,this.b*=e,this.c*=t,this.d*=t,this}translate(e,t){return this.tx+=this.a*e+this.c*t,this.ty+=this.b*e+this.d*t,this}identity(){return this.a=this.d=1,this.b=this.c=this.tx=this.ty=0,this}invert(){let e=this.a,t=this.b,i=this.c,n=this.d,r=this.tx,a=e*n-t*i;return this.a=n/a,this.b=-t/a,this.c=-i/a,this.d=e/a,this.tx=(i*this.ty-n*r)/a,this.ty=-(e*this.ty-t*r)/a,this}isIdentity(){return 0===this.tx&&0===this.ty&&1===this.a&&0===this.b&&0===this.c&&1===this.d}equals(e){return this.tx===e.tx&&this.ty===e.ty&&this.a===e.a&&this.b===e.b&&this.c===e.c&&this.d===e.d}transformPoint(e,t,i=new yRe){return i.x=e*this.a+t*this.c+this.tx,i.y=e*this.b+t*this.d+this.ty,i}decompose(e={}){e.x=this.tx,e.y=this.ty,e.scaleX=Math.sqrt(this.a*this.a+this.b*this.b),e.scaleY=Math.sqrt(this.c*this.c+this.d*this.d);let t=Math.atan2(-this.c,this.d),i=Math.atan2(this.b,this.a);return Math.abs(1-t/i)<1e-5?(e.rotation=i/wRe.DEG_TO_RAD,this.a<0&&this.d>=0&&(e.rotation+=e.rotation<=0?180:-180),e.skewX=e.skewY=0):(e.skewX=t/wRe.DEG_TO_RAD,e.skewY=i/wRe.DEG_TO_RAD),e}copy(e){return this.setValues(e.a,e.b,e.c,e.d,e.tx,e.ty)}clone(){return new wRe(this.a,this.b,this.c,this.d,this.tx,this.ty)}toString(){return`[${this.constructor.name} (a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty})]`}}wRe.DEG_TO_RAD=Math.PI/180,wRe.identity=new wRe;
/**
 * @license DisplayProps
 * Visit http://createjs.com/ for documentation, updates and examples.
 *
 * Copyright (c) 2017 gskinner.com, inc.
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use,
 * copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the
 * Software is furnished to do so, subject to the following
 * conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
 * OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
 * HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
 * WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
 * OTHER DEALINGS IN THE SOFTWARE.
 */
class ORe{constructor(e,t,i,n,r){this.setValues(e,t,i,n,r)}setValues(e=!0,t=1,i,n,r){return this.visible=e,this.alpha=t,this.shadow=i,this.compositeOperation=n,this.matrix=r||this.matrix&&this.matrix.identity()||new wRe,this}append(e,t,i,n,r){return this.alpha*=t,this.shadow=i||this.shadow,this.compositeOperation=n||this.compositeOperation,this.visible=this.visible&&e,r&&this.matrix.appendMatrix(r),this}prepend(e,t,i,n,r){return this.alpha*=t,this.shadow=this.shadow||i,this.compositeOperation=this.compositeOperation||n,this.visible=this.visible&&e,r&&this.matrix.prependMatrix(r),this}identity(){return this.visible=!0,this.alpha=1,this.shadow=this.compositeOperation=null,this.matrix.identity(),this}clone(){return new ORe(this.alpha,this.shadow,this.compositeOperation,this.visible,this.matrix.clone())}}
/**
 * @license Rectangle
 * Visit http://createjs.com/ for documentation, updates and examples.
 *
 * Copyright (c) 2017 gskinner.com, inc.
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use,
 * copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the
 * Software is furnished to do so, subject to the following
 * conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
 * OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
 * HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
 * WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
 * OTHER DEALINGS IN THE SOFTWARE.
 */class xRe{constructor(e,t,i,n){this.setValues(e,t,i,n)}setValues(e=0,t=0,i=0,n=0){return this.x=e,this.y=t,this.width=i,this.height=n,this}extend(e,t,i=0,n=0){return e+i>this.x+this.width&&(this.width=e+i-this.x),t+n>this.y+this.height&&(this.height=t+n-this.y),e<this.x&&(this.width+=this.x-e,this.x=e),t<this.y&&(this.height+=this.y-t,this.y=t),this}pad(e,t,i,n){return this.x-=t,this.y-=e,this.width+=t+n,this.height+=e+i,this}copy(e){return this.setValues(e.x,e.y,e.width,e.height)}contains(e,t,i=0,n=0){return e>=this.x&&e+i<=this.x+this.width&&t>=this.y&&t+n<=this.y+this.height}union(e){return this.clone().extend(e.x,e.y,e.width,e.height)}intersection(e){let t=e.x,i=e.y,n=t+e.width,r=i+e.height;return this.x>t&&(t=this.x),this.y>i&&(i=this.y),this.x+this.width<n&&(n=this.x+this.width),this.y+this.height<r&&(r=this.y+this.height),n<=t||r<=i?null:new xRe(t,i,n-t,r-i)}intersects(e){return e.x<=this.x+this.width&&this.x<=e.x+e.width&&e.y<=this.y+this.height&&this.y<=e.y+e.height}isEmpty(){return this.width<=0||this.height<=0}clone(){return new xRe(this.x,this.y,this.width,this.height)}toString(){return`[${this.constructor.name} (x=${this.x} y=${this.y} width=${this.width} height=${this.height})]`}}
/**
 * @license Filter
 * Visit http://createjs.com/ for documentation, updates and examples.
 *
 * Copyright (c) 2017 gskinner.com, inc.
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use,
 * copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the
 * Software is furnished to do so, subject to the following
 * conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
 * OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
 * HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
 * WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
 * OTHER DEALINGS IN THE SOFTWARE.
 */class ERe{constructor(){this.usesContext=!1,this._multiPass=null,this.VTX_SHADER_BODY=null,this.FRAG_SHADER_BODY=null}getBounds(e){}shaderParamSetup(e,t,i){}applyFilter(e,t,i,n,r,a,o,s){a=a||e,null==o&&(o=t),null==s&&(s=i);try{let c=e.getImageData(t,i,n,r);if(this._applyFilter(c))return a.putImageData(c,o,s),!0}catch(e){}return!1}toString(){return`[${this.constructor.name}]`}clone(){return new ERe}_applyFilter(e){}}
/**
 * @license BitmapCache
 * Visit http://createjs.com/ for documentation, updates and examples.
 *
 * Copyright (c) 2017 gskinner.com, inc.
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use,
 * copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the
 * Software is furnished to do so, subject to the following
 * conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
 * OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
 * HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
 * WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
 * OTHER DEALINGS IN THE SOFTWARE.
 */class TRe extends ERe{constructor(){super(),this.width=void 0,this.height=void 0,this.x=void 0,this.y=void 0,this.scale=1,this.offX=0,this.offY=0,this.cacheID=0,this._filterOffX=0,this._filterOffY=0,this._cacheDataURLID=0,this._cacheDataURL=null,this._drawWidth=0,this._drawHeight=0,this._boundRect=new xRe}static getFilterBounds(e,t=new xRe){let i=e.filters,n=i&&i.length;if(!!n<=0)return t;for(let e=0;e<n;e++){let n=i[e];if(!n||!n.getBounds)continue;let r=n.getBounds();r&&(0==e?t.setValues(r.x,r.y,r.width,r.height):t.extend(r.x,r.y,r.width,r.height))}return t}define(e,t=0,i=0,n=1,r=1,a=1,o){if(!e)throw"No symbol to cache";this._options=o,this._useWebGL=void 0!==o,this.target=e,this.width=n>=1?n:1,this.height=r>=1?r:1,this.x=t,this.y=i,this.scale=a,this.update()}update(e){if(!this.target)throw"define() must be called before update()";let t=TRe.getFilterBounds(this.target),i=this.target.cacheCanvas;this._drawWidth=Math.ceil(this.width*this.scale)+t.width,this._drawHeight=Math.ceil(this.height*this.scale)+t.height,i&&this._drawWidth==i.width&&this._drawHeight==i.height||this._updateSurface(),this._filterOffX=t.x,this._filterOffY=t.y,this.offX=this.x*this.scale+this._filterOffX,this.offY=this.y*this.scale+this._filterOffY,this._drawToCache(e),this.cacheID=this.cacheID?this.cacheID+1:1}release(){let e=this.target.stage;this._useWebGL&&this._webGLCache?(this._webGLCache.isCacheControlled||(this.__lastRT&&(this.__lastRT=void 0),this.__rtA&&this._webGLCache._killTextureObject(this.__rtA),this.__rtB&&this._webGLCache._killTextureObject(this.__rtB),this.target&&this.target.cacheCanvas&&this._webGLCache._killTextureObject(this.target.cacheCanvas)),this._webGLCache=!1):e instanceof gRe&&e.releaseTexture(this.target.cacheCanvas),this.target=this.target.cacheCanvas=null,this.cacheID=this._cacheDataURLID=this._cacheDataURL=void 0,this.width=this.height=this.x=this.y=this.offX=this.offY=0,this.scale=1}getCacheDataURL(){let e=this.target&&this.target.cacheCanvas;return e?(this.cacheID!=this._cacheDataURLID&&(this._cacheDataURLID=this.cacheID,this._cacheDataURL=e.toDataURL?e.toDataURL():null),this._cacheDataURL):null}draw(e){return!!this.target&&(e.drawImage(this.target.cacheCanvas,this.x+this._filterOffX/this.scale,this.y+this._filterOffY/this.scale,this._drawWidth/this.scale,this._drawHeight/this.scale),!0)}getBounds(){const e=this.scale;return this._boundRect.setValue(this._filterOffX/e,this._filterOffY/e,this.width/e,this.height/e)}_updateSurface(){let e;if(!this._useWebGL)return e=this.target.cacheCanvas,e||(e=this.target.cacheCanvas=window.createjs&&createjs.createCanvas?createjs.createCanvas():document.createElement("canvas")),e.width=this._drawWidth,void(e.height=this._drawHeight);if(!this._webGLCache)if("stage"===this._options.useGL){if(null==this.target.stage||!this.target.stage.isWebGL)throw`Cannot use 'stage' for cache because the object's parent stage is ${null!=this.target.stage?"non WebGL.":"not set, please addChild to the correct stage."}`;this.target.cacheCanvas=!0,this._webGLCache=this.target.stage}else{if("new"!==this._options.useGL)throw"Invalid option provided to useGL, expected ['stage', 'new', StageGL, undefined], got "+this._options.useGL;this.target.cacheCanvas=document.createElement("canvas"),this._webGLCache=new gRe(this.target.cacheCanvas,{antialias:!0,transparent:!0,autoPurge:-1}),this._webGLCache.isCacheControlled=!0}let t=this._webGLCache;e=this.target.cacheCanvas,t.isCacheControlled&&(e.width=this._drawWidth,e.height=this._drawHeight,t.updateViewport(this._drawWidth,this._drawHeight)),this.target.filters?(t.getTargetRenderTexture(this.target,this._drawWidth,this._drawHeight),t.getTargetRenderTexture(this.target,this._drawWidth,this._drawHeight)):t.isCacheControlled||t.getTargetRenderTexture(this.target,this._drawWidth,this._drawHeight)}_drawToCache(e){let t=this.target,i=t.cacheCanvas,n=this._webGLCache;if(!this._useWebGL||!n){let n=i.getContext("2d");return e||n.clearRect(0,0,this._drawWidth+1,this._drawHeight+1),n.save(),n.globalCompositeOperation=e,n.setTransform(this.scale,0,0,this.scale,-this._filterOffX,-this._filterOffY),n.translate(-this.x,-this.y),t.draw(n,!0),n.restore(),t.filters&&t.filters.length&&this._applyFilters(t),void(i._invalid=!0)}this._webGLCache.cacheDraw(t,t.filters,this),i=this.target.cacheCanvas,i.width=this._drawWidth,i.height=this._drawHeight,i._invalid=!0}_applyFilters(){let e=this.target.cacheCanvas,t=this.target.filters,i=this._drawWidth,n=this._drawHeight,r=e.getContext("2d").getImageData(0,0,i,n),a=t.length;for(let e=0;e<a;e++)t[e]._applyFilter(r);e.getContext("2d").putImageData(r,0,0)}}
/**
 * @license DisplayObject
 * Visit http://createjs.com/ for documentation, updates and examples.
 *
 * Copyright (c) 2017 gskinner.com, inc.
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use,
 * copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the
 * Software is furnished to do so, subject to the following
 * conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
 * OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
 * HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
 * WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
 * OTHER DEALINGS IN THE SOFTWARE.
 */class CRe extends fRe{constructor(){super(),this.alpha=1,this.cacheCanvas=null,this.bitmapCache=null,this.id=bRe++,this.mouseEnabled=!0,this.tickEnabled=!0,this.name=null,this.parent=null,this.regX=0,this.regY=0,this.rotation=0,this.scaleX=1,this.scaleY=1,this.skewX=0,this.skewY=0,this.shadow=null,this.visible=!0,this.x=0,this.y=0,this.transformMatrix=null,this.compositeOperation=null,this.snapToPixel=!0,this.filters=null,this.mask=null,this.hitArea=null,this.cursor=null,this._props=new ORe,this._rectangle=new xRe,this._bounds=null,this._webGLRenderStyle=CRe._StageGL_NONE}get stage(){let e=this;for(;e.parent;)e=e.parent;return/^\[Stage(GL)?(\s\(name=\w+\))?\]$/.test(e.toString())?e:null}set scale(e){this.scaleX=this.scaleY=e}get scale(){return this.scaleX}isVisible(){return!!(this.visible&&this.alpha>0&&0!=this.scaleX&&0!=this.scaleY)}draw(e,t=!1){return this.drawCache(e,t)}drawCache(e,t=!1){let i=this.bitmapCache;return!(!i||t)&&i.draw(e)}updateContext(e){let t=this,i=t.mask,n=t._props.matrix;i&&i.graphics&&!i.graphics.isEmpty()&&(i.getMatrix(n),e.transform(n.a,n.b,n.c,n.d,n.tx,n.ty),i.graphics.drawAsPath(e),e.clip(),n.invert(),e.transform(n.a,n.b,n.c,n.d,n.tx,n.ty)),this.getMatrix(n);let r=n.tx,a=n.ty;CRe._snapToPixelEnabled&&t.snapToPixel&&(r=r+(r<0?-.5:.5)|0,a=a+(a<0?-.5:.5)|0),e.transform(n.a,n.b,n.c,n.d,r,a),e.globalAlpha*=t.alpha,t.compositeOperation&&(e.globalCompositeOperation=t.compositeOperation),t.shadow&&this._applyShadow(e,t.shadow)}cache(e,t,i,n,r=1,a){this.bitmapCache||(this.bitmapCache=new TRe),this.bitmapCache.define(this,e,t,i,n,r,a)}updateCache(e){if(!this.bitmapCache)throw"No cache found. cache() must be called before updateCache()";this.bitmapCache.update(e)}uncache(){this.bitmapCache&&(this.bitmapCache.release(),this.bitmapCache=void 0)}getCacheDataURL(){return this.bitmapCache?this.bitmapCache.getDataURL():null}localToGlobal(e,t,i=new yRe){return this.getConcatenatedMatrix(this._props.matrix).transformPoint(e,t,i)}globalToLocal(e,t,i=new yRe){return this.getConcatenatedMatrix(this._props.matrix).invert().transformPoint(e,t,i)}localToLocal(e,t,i,n){return n=this.localToGlobal(e,t,n),i.globalToLocal(n.x,n.y,n)}setTransform(e=0,t=0,i=1,n=1,r=0,a=0,o=0,s=0,c=0){return this.x=e,this.y=t,this.scaleX=i,this.scaleY=n,this.rotation=r,this.skewX=a,this.skewY=o,this.regX=s,this.regY=c,this}getMatrix(e){let t=this,i=e&&e.identity()||new wRe;return t.transformMatrix?i.copy(t.transformMatrix):i.appendTransform(t.x,t.y,t.scaleX,t.scaleY,t.rotation,t.skewX,t.skewY,t.regX,t.regY)}getConcatenatedMatrix(e){let t=this,i=this.getMatrix(e);for(;t=t.parent;)i.prependMatrix(t.getMatrix(t._props.matrix));return i}getConcatenatedDisplayProps(e){e=e?e.identity():new ORe;let t=this,i=t.getMatrix(e.matrix);do{e.prepend(t.visible,t.alpha,t.shadow,t.compositeOperation),t!=this&&i.prependMatrix(t.getMatrix(t._props.matrix))}while(t=t.parent);return e}hitTest(e,t){let i=CRe._hitTestContext;i.setTransform(1,0,0,1,-e,-t),this.draw(i);let n=this._testHit(i);return i.setTransform(1,0,0,1,0,0),i.clearRect(0,0,2,2),n}set(e){for(let t in e)this[t]=e[t];return this}getBounds(){if(this._bounds)return this._rectangle.copy(this._bounds);let e=this.cacheCanvas;if(e){let t=this._cacheScale;return this._rectangle.setValues(this._cacheOffsetX,this._cacheOffsetY,e.width/t,e.height/t)}return null}getTransformedBounds(){return this._getBounds()}setBounds(e,t,i,n){null==e&&(this._bounds=null),this._bounds=(this._bounds||new xRe).setValues(e,t,i,n)}clone(){return this._cloneProps(new CRe)}toString(){return`[${this.constructor.name}${this.name?` (name=${this.name})`:""}]`}_cloneProps(e){return e.alpha=this.alpha,e.mouseEnabled=this.mouseEnabled,e.tickEnabled=this.tickEnabled,e.name=this.name,e.regX=this.regX,e.regY=this.regY,e.rotation=this.rotation,e.scaleX=this.scaleX,e.scaleY=this.scaleY,e.shadow=this.shadow,e.skewX=this.skewX,e.skewY=this.skewY,e.visible=this.visible,e.x=this.x,e.y=this.y,e.compositeOperation=this.compositeOperation,e.snapToPixel=this.snapToPixel,e.filters=null==this.filters?null:this.filters.slice(0),e.mask=this.mask,e.hitArea=this.hitArea,e.cursor=this.cursor,e._bounds=this._bounds,e}_applyShadow(e,t=vRe.identity){t=t,e.shadowColor=t.color,e.shadowOffsetX=t.offsetX,e.shadowOffsetY=t.offsetY,e.shadowBlur=t.blur}_tick(e){let t=this._listeners;t&&t.tick&&(e.target=null,e.propagationStopped=e.immediatePropagationStopped=!1,this.dispatchEvent(e))}_testHit(e){try{return e.getImageData(0,0,1,1).data[3]>1}catch(e){if(!CRe.suppressCrossDomainErrors)throw"An error has occurred. This is most likely due to security restrictions on reading canvas pixel data with local or cross-domain images.";return!1}}_getBounds(e,t){return this._transformBounds(this.getBounds(),e,t)}_transformBounds(e,t,i){if(!e)return e;let{x:n,y:r,width:a,height:o}=e,s=this._props.matrix;s=i?s.identity():this.getMatrix(s),(n||r)&&s.appendTransform(0,0,1,1,0,0,0,-n,-r),t&&s.prependMatrix(t);let c=a*s.a,l=a*s.b,u=o*s.c,h=o*s.d,d=s.tx,f=s.ty,p=d,m=d,_=f,g=f;return(n=c+d)<p?p=n:n>m&&(m=n),(n=c+u+d)<p?p=n:n>m&&(m=n),(n=u+d)<p?p=n:n>m&&(m=n),(r=l+f)<_?_=r:r>g&&(g=r),(r=l+h+f)<_?_=r:r>g&&(g=r),(r=h+f)<_?_=r:r>g&&(g=r),e.setValues(p,_,m-p,g-_)}_hasMouseEventListener(){let e=CRe._MOUSE_EVENTS;for(let t=0,i=e.length;t<i;t++)if(this.hasEventListener(e[t]))return!0;return!!this.cursor}}{let e=window.createjs&&createjs.createCanvas?createjs.createCanvas():document.createElement("canvas");e.getContext&&(CRe._hitTestCanvas=e,CRe._hitTestContext=e.getContext("2d"),e.width=e.height=1)}CRe._MOUSE_EVENTS=["click","dblclick","mousedown","mouseout","mouseover","pressmove","pressup","rollout","rollover"],CRe.suppressCrossDomainErrors=!1,CRe.snapToPixelEnabled=!1,CRe._StageGL_NONE=0,CRe._StageGL_SPRITE=1,CRe._StageGL_BITMAP=2;
/**
 * @license Container
 * Visit http://createjs.com/ for documentation, updates and examples.
 *
 * Copyright (c) 2017 gskinner.com, inc.
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use,
 * copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the
 * Software is furnished to do so, subject to the following
 * conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
 * OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
 * HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
 * WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
 * OTHER DEALINGS IN THE SOFTWARE.
 */
class SRe extends CRe{constructor(){super(),this.children=[],this.mouseChildren=!0,this.tickChildren=!0}get numChildren(){return this.children.length}isVisible(){let e=this.cacheCanvas||this.children.length;return!!(this.visible&&this.alpha>0&&0!=this.scaleX&&0!=this.scaleY&&e)}draw(e,t=!1){if(super.draw(e,t))return!0;let i=this.children.slice();for(let t=0,n=i.length;t<n;t++){let n=i[t];n.isVisible()&&(e.save(),n.updateContext(e),n.draw(e),e.restore())}return!0}addChild(...e){const t=e.length;if(0===t)return null;let i=e[0];if(t>1){for(let n=0;n<t;n++)i=this.addChild(e[n]);return i}let n=i.parent,r=n===this;return n&&n._removeChildAt(n.children.indexOf(i),r),i.parent=this,this.children.push(i),r||i.dispatchEvent("added"),i}addChildAt(...e){const t=e.length;if(0===t)return null;let i=e.pop();if(i<0||i>this.children.length)return e[t-2];if(t>2){for(let n=0;n<t-1;n++)this.addChildAt(e[n],i++);return e[t-2]}let n=e[0],r=n.parent,a=r===this;return r&&r._removeChildAt(r.children.indexOf(n),a),n.parent=this,this.children.splice(i++,0,n),a||n.dispatchEvent("added"),n}removeChild(...e){const t=e.length;if(0===t)return!0;if(t>1){let i=!0;for(let n=0;n<t;n++)i=i&&this.removeChild(e[n]);return i}return this._removeChildAt(this.children.indexOf(e[0]))}removeChildAt(...e){const t=e.length;if(0===t)return!0;if(t>1){e.sort((e,t)=>t-e);let i=!0;for(let n=0;n<t;n++)i=i&&this._removeChildAt(e[n]);return i}return this._removeChildAt(e[0])}removeAllChildren(){let e=this.children;for(;e.length;)this._removeChildAt(0)}getChildAt(e){return this.children[e]}getChildByName(e){let t=this.children;const i=t.length;for(let n=0;n<i;n++)if(t[n].name===e)return t[n];return null}sortChildren(e){this.children.sort(e)}getChildIndex(e){return this.children.indexOf(e)}swapChildrenAt(e,t){let i=this.children,n=i[e],r=i[t];n&&r&&(i[e]=r,i[t]=n)}swapChildren(e,t){let i=this.children;const n=i.length;let r,a;for(var o=0;o<n&&(i[o]===e&&(r=o),i[o]===t&&(a=o),null==r||null==a);o++);o!==n&&(i[r]=t,i[a]=e)}setChildIndex(e,t){let i=this.children;const n=i.length;if(!(e.parent!=this||t<0||t>=n)){for(var r=0;r<n&&i[r]!==e;r++);r!==n&&r!==t&&(i.splice(r,1),i.splice(t,0,e))}}contains(e){for(;e;){if(e===this)return!0;e=e.parent}return!1}hitTest(e,t){return null!=this.getObjectUnderPoint(e,t)}getObjectsUnderPoint(e,t,i=0){let n=[],r=this.localToGlobal(e,t);return this._getObjectsUnderPoint(r.x,r.y,n,i>0,1===i),n}getObjectUnderPoint(e,t,i=0){let n=this.localToGlobal(e,t);return this._getObjectsUnderPoint(n.x,n.y,null,i>0,1===i)}getBounds(){return this._getBounds(null,!0)}getTransformedBounds(){return this._getBounds()}clone(e=!1){let t=this._cloneProps(new SRe);return e&&this._cloneChildren(t),t}_tick(e){if(this.tickChildren)for(let t=this.children.length-1;t>=0;t--){let i=this.children[t];i.tickEnabled&&i._tick&&i._tick(e)}super._tick(e)}_cloneChildren(e){e.children.length&&e.removeAllChildren();let t=e.children;const i=this.children.length;for(let n=0;n<i;n++){let i=this.children[n].clone(!0);i.parent=e,t.push(i)}}_removeChildAt(e,t=!1){if(e<0||e>this.children.length-1)return!1;let i=this.children[e];return i&&(i.parent=null),this.children.splice(e,1),t||i.dispatchEvent("removed"),!0}_getObjectsUnderPoint(e,t,i,n,r,a=0){if(!a&&!this._testMask(this,e,t))return null;let o,s=CRe._hitTestContext;r=r||n&&this._hasMouseEventListener();let c=this.children;for(let l=c.length-1;l>=0;l--){let u=c[l],h=u.hitArea;if(u.visible&&(h||u.isVisible())&&(!n||u.mouseEnabled)&&(h||this._testMask(u,e,t)))if(!h&&u instanceof SRe){let o=u._getObjectsUnderPoint(e,t,i,n,r,a+1);if(!i&&o)return n&&!this.mouseChildren?this:o}else{if(n&&!r&&!u._hasMouseEventListener())continue;let a=u.getConcatenatedDisplayProps(u._props);if(o=a.matrix,h&&(o.appendMatrix(h.getMatrix(h._props.matrix)),a.alpha=h.alpha),s.globalAlpha=a.alpha,s.setTransform(o.a,o.b,o.c,o.d,o.tx-e,o.ty-t),(h||u).draw(s),!this._testHit(s))continue;if(s.setTransform(1,0,0,1,0,0),s.clearRect(0,0,2,2),!i)return n&&!this.mouseChildren?this:u;i.push(u)}}return null}_testMask(e,t,i){let n=e.mask;if(!n||!n.graphics||n.graphics.isEmpty())return!0;let r=this._props.matrix,a=e.parent;r=a?a.getConcatenatedMatrix(r):r.identity(),r=n.getMatrix(n._props.matrix).prependMatrix(r);let o=CRe._hitTestContext;return o.setTransform(r.a,r.b,r.c,r.d,r.tx-t,r.ty-i),n.graphics.drawAsPath(o),o.fillStyle="#000",o.fill(),!!this._testHit(o)&&(o.setTransform(1,0,0,1,0,0),o.clearRect(0,0,2,2),!0)}_getBounds(e,t){let i=super.getBounds();if(i)return this._transformBounds(i,e,t);let n=this._props.matrix;n=t?n.identity():this.getMatrix(n),e&&n.prependMatrix(e);const r=this.children.length;let a=null;for(let e=0;e<r;e++){let t=this.children[e];t.visible&&(i=t._getBounds(n))&&(a?a.extend(i.x,i.y,i.width,i.height):a=i.clone())}return a}}
/**
 * @license MouseEvent
 * Visit http://createjs.com/ for documentation, updates and examples.
 *
 * Copyright (c) 2017 gskinner.com, inc.
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use,
 * copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the
 * Software is furnished to do so, subject to the following
 * conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
 * OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
 * HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
 * WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
 * OTHER DEALINGS IN THE SOFTWARE.
 */class ARe extends hRe{constructor(e,t,i,n,r,a,o,s,c,l,u){super(e,t,i),this.stageX=n,this.stageY=r,this.rawX=null==c?n:c,this.rawY=null==l?r:l,this.nativeEvent=a,this.pointerID=o,this.primary=!!s,this.relatedTarget=u}get localX(){return this.currentTarget.globalToLocal(this.rawX,this.rawY).x}get localY(){return this.currentTarget.globalToLocal(this.rawX,this.rawY).y}get isTouch(){return-1!==this.pointerID}clone(){return new ARe(this.type,this.bubbles,this.cancelable,this.stageX,this.stageY,this.nativeEvent,this.pointerID,this.primary,this.rawX,this.rawY)}toString(){return`[${this.constructor.name} (type=${this.type} stageX=${this.stageX} stageY=${this.stageY})]`}}
/**
 * @license Stage
 * Visit http://createjs.com/ for documentation, updates and examples.
 *
 * Copyright (c) 2017 gskinner.com, inc.
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use,
 * copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the
 * Software is furnished to do so, subject to the following
 * conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
 * OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
 * HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
 * WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
 * OTHER DEALINGS IN THE SOFTWARE.
 */class PRe extends SRe{constructor(e){super(),this.autoClear=!0,this.canvas="string"==typeof e?document.getElementById(e):e,this.mouseX=0,this.mouseY=0,this.drawRect=null,this.snapToPixelEnabled=!1,this.mouseInBounds=!1,this.tickOnUpdate=!0,this.mouseMoveOutside=!1,this.preventSelection=!0,this._pointerData={},this._pointerCount=0,this._primaryPointerID=null,this._mouseOverIntervalID=null,this._nextStage=null,this._prevStage=null,this.enableDOMEvents(!0)}get nextStage(){return this._nextStage}set nextStage(e){this._nextStage&&(this._nextStage._prevStage=null),e&&(e._prevStage=this),this._nextStage=e}update(e){if(!this.canvas)return;if(this.tickOnUpdate&&this.tick(e),!1===this.dispatchEvent("drawstart",!1,!0))return;CRe._snapToPixelEnabled=this.snapToPixelEnabled;let t=this.drawRect,i=this.canvas.getContext("2d");i.setTransform(1,0,0,1,0,0),this.autoClear&&(t?i.clearRect(t.x,t.y,t.width,t.height):i.clearRect(0,0,this.canvas.width+1,this.canvas.height+1)),i.save(),this.drawRect&&(i.beginPath(),i.rect(t.x,t.y,t.width,t.height),i.clip()),this.updateContext(i),this.draw(i,!1),i.restore(),this.dispatchEvent("drawend")}tick(e){if(!this.tickEnabled||!1===this.dispatchEvent("tickstart",!1,!0))return;let t=new hRe("tick");if(e)for(let i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);this._tick(t),this.dispatchEvent("tickend")}handleEvent(e){"tick"===e.type&&this.update(e)}clear(){if(!this.canvas)return;let e=this.canvas.getContext("2d");e.setTransform(1,0,0,1,0,0),e.clearRect(0,0,this.canvas.width+1,this.canvas.height+1)}toDataURL(e,t="image/png"){let i,n=this.canvas.getContext("2d"),r=this.canvas.width,a=this.canvas.height;if(e){i=n.getImageData(0,0,r,a);var o=n.globalCompositeOperation;n.globalCompositeOperation="destination-over",n.fillStyle=e,n.fillRect(0,0,r,a)}let s=this.canvas.toDataURL(t);return e&&(n.putImageData(i,0,0),n.globalCompositeOperation=o),s}enableMouseOver(e=20){this._mouseOverIntervalID&&(clearInterval(this._mouseOverIntervalID),this._mouseOverIntervalID=null,0===e&&this._testMouseOver(!0)),e<=0||(this._mouseOverIntervalID=setInterval(()=>this._testMouseOver(),1e3/Math.min(50,e)))}enableDOMEvents(e=!0){let t=this._eventListeners;if(!e&&t){for(let e in t){let i=t[e];i.t.removeEventListener(e,i.f,!1)}this._eventListeners=null}else if(e&&!t&&this.canvas){let e=window.addEventListener?window:document;t=this._eventListeners={mouseup:{t:e,f:e=>this._handleMouseUp(e)},mousemove:{t:e,f:e=>this._handleMouseMove(e)},dblclick:{t:this.canvas,f:e=>this._handleDoubleClick(e)},mousedown:{t:this.canvas,f:e=>this._handleMouseDown(e)}};for(let e in t){let i=t[e];i.t.addEventListener&&i.t.addEventListener(e,i.f,!1)}}}clone(){throw"Stage cannot be cloned."}_getElementRect(e){let t;try{t=e.getBoundingClientRect()}catch(i){t={top:e.offsetTop,left:e.offsetLeft,width:e.offsetWidth,height:e.offsetHeight}}let i=(window.pageXOffset||document.scrollLeft||0)-(document.clientLeft||document.body.clientLeft||0),n=(window.pageYOffset||document.scrollTop||0)-(document.clientTop||document.body.clientTop||0),r=window.getComputedStyle?getComputedStyle(e,null):e.currentStyle,a=parseInt(r.paddingLeft)+parseInt(r.borderLeftWidth),o=parseInt(r.paddingTop)+parseInt(r.borderTopWidth),s=parseInt(r.paddingRight)+parseInt(r.borderRightWidth),c=parseInt(r.paddingBottom)+parseInt(r.borderBottomWidth);return{left:t.left+i+a,right:t.right+i-s,top:t.top+n+o,bottom:t.bottom+n-c}}_getPointerData(e){let t=this._pointerData[e];return t||(t=this._pointerData[e]={x:0,y:0}),t}_handleMouseMove(e=window.event){this._handlePointerMove(-1,e,e.pageX,e.pageY)}_handlePointerMove(e,t,i,n,r){if(this._prevStage&&void 0===r)return;if(!this.canvas)return;let a=this._nextStage,o=this._getPointerData(e),s=o.inBounds;this._updatePointerPosition(e,t,i,n),(s||o.inBounds||this.mouseMoveOutside)&&(-1===e&&o.inBounds===!s&&this._dispatchMouseEvent(this,s?"mouseleave":"mouseenter",!1,e,o,t),this._dispatchMouseEvent(this,"stagemousemove",!1,e,o,t),this._dispatchMouseEvent(o.target,"pressmove",!0,e,o,t)),a&&a._handlePointerMove(e,t,i,n,null)}_updatePointerPosition(e,t,i,n){let r=this._getElementRect(this.canvas);i-=r.left,n-=r.top;let a=this.canvas.width,o=this.canvas.height;i/=(r.right-r.left)/a,n/=(r.bottom-r.top)/o;let s=this._getPointerData(e);(s.inBounds=i>=0&&n>=0&&i<=a-1&&n<=o-1)?(s.x=i,s.y=n):this.mouseMoveOutside&&(s.x=i<0?0:i>a-1?a-1:i,s.y=n<0?0:n>o-1?o-1:n),s.posEvtObj=t,s.rawX=i,s.rawY=n,e!==this._primaryPointerID&&-1!==e||(this.mouseX=s.x,this.mouseY=s.y,this.mouseInBounds=s.inBounds)}_handleMouseUp(e){this._handlePointerUp(-1,e,!1)}_handlePointerUp(e,t,i,n){let r=this._nextStage,a=this._getPointerData(e);if(this._prevStage&&void 0===n)return;let o=null,s=a.target;n||!s&&!r||(o=this._getObjectsUnderPoint(a.x,a.y,null,!0)),a.down&&(this._dispatchMouseEvent(this,"stagemouseup",!1,e,a,t,o),a.down=!1),o===s&&this._dispatchMouseEvent(s,"click",!0,e,a,t),this._dispatchMouseEvent(s,"pressup",!0,e,a,t),i?(e==this._primaryPointerID&&(this._primaryPointerID=null),delete this._pointerData[e]):a.target=null,r&&r._handlePointerUp(e,t,i,n||o&&this)}_handleMouseDown(e){this._handlePointerDown(-1,e,e.pageX,e.pageY)}_handlePointerDown(e,t,i,n,r){this.preventSelection&&t.preventDefault(),null!=this._primaryPointerID&&-1!==e||(this._primaryPointerID=e),null!=n&&this._updatePointerPosition(e,t,i,n);let a=null,o=this._nextStage,s=this._getPointerData(e);r||(a=s.target=this._getObjectsUnderPoint(s.x,s.y,null,!0)),s.inBounds&&(this._dispatchMouseEvent(this,"stagemousedown",!1,e,s,t,a),s.down=!0),this._dispatchMouseEvent(a,"mousedown",!0,e,s,t),o&&o._handlePointerDown(e,t,i,n,r||a&&this)}_testMouseOver(e,t,i){if(this._prevStage&&void 0===t)return;let n=this._nextStage;if(!this._mouseOverIntervalID)return void(n&&n._testMouseOver(e,t,i));let r=this._getPointerData(-1);if(!r||!e&&this.mouseX===this._mouseOverX&&this.mouseY===this._mouseOverY&&this.mouseInBounds)return;let a=r.posEvtObj,o=i||a&&a.target===this.canvas,s=null,c=-1,l="";!t&&(e||this.mouseInBounds&&o)&&(s=this._getObjectsUnderPoint(this.mouseX,this.mouseY,null,!0),this._mouseOverX=this.mouseX,this._mouseOverY=this.mouseY);let u=this._mouseOverTarget||[],h=u[u.length-1],d=this._mouseOverTarget=[],f=s;for(;f;)d.unshift(f),l||(l=f.cursor),f=f.parent;this.canvas.style.cursor=l,!t&&i&&(i.canvas.style.cursor=l);for(let e=0,t=d.length;e<t&&d[e]==u[e];e++)c=e;h!=s&&this._dispatchMouseEvent(h,"mouseout",!0,-1,r,a,s);for(let e=u.length-1;e>c;e--)this._dispatchMouseEvent(u[e],"rollout",!1,-1,r,a,s);for(let e=d.length-1;e>c;e--)this._dispatchMouseEvent(d[e],"rollover",!1,-1,r,a,h);h!=s&&this._dispatchMouseEvent(s,"mouseover",!0,-1,r,a,h),n&&n._testMouseOver(e,t||s&&this,i||o&&this)}_handleDoubleClick(e,t){let i=null,n=this._nextStage,r=this._getPointerData(-1);t||(i=this._getObjectsUnderPoint(r.x,r.y,null,!0),this._dispatchMouseEvent(i,"dblclick",!0,-1,r,e)),n&&n._handleDoubleClick(e,t||i&&this)}_dispatchMouseEvent(e,t,i,n,r,a,o){if(!e||!i&&!e.hasEventListener(t))return;let s=new ARe(t,i,!1,r.x,r.y,a,n,n===this._primaryPointerID||-1===n,r.rawX,r.rawY,o);e.dispatchEvent(s)}}
/**
 * @license Canvas
 * Visit http://createjs.com/ for documentation, updates and examples.
 *
 * Copyright (c) 2017 gskinner.com, inc.
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use,
 * copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the
 * Software is furnished to do so, subject to the following
 * conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
 * OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
 * HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
 * WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
 * OTHER DEALINGS IN THE SOFTWARE.
 */function IRe(e=1,t=1){let i;if(void 0!==window.createjs&&void 0!==window.createjs.createCanvas&&(i=window.createjs.createCanvas()),void 0!==window.document&&void 0!==window.document.createElement&&(i=document.createElement("canvas")),void 0!==i)return i.width=e,i.height=t,i;throw"Canvas not supported in this environment."}
/**
 * @license VideoBuffer
 * Visit http://createjs.com/ for documentation, updates and examples.
 *
 * Copyright (c) 2010 gskinner.com, inc.
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use,
 * copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the
 * Software is furnished to do so, subject to the following
 * conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
 * OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
 * HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
 * WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
 * OTHER DEALINGS IN THE SOFTWARE.
 */
/**
 * @license Sprite
 * Visit http://createjs.com/ for documentation, updates and examples.
 *
 * Copyright (c) 2017 gskinner.com, inc.
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use,
 * copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the
 * Software is furnished to do so, subject to the following
 * conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
 * OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
 * HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
 * WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
 * OTHER DEALINGS IN THE SOFTWARE.
 */
class DRe extends CRe{constructor(e,t){super(),this.currentFrame=0,this.currentAnimation=null,this.paused=!0,this.spriteSheet=e,this.currentAnimationFrame=0,this.framerate=0,this._animation=null,this._currentFrame=null,this._skipAdvance=!1,this._webGLRenderStyle=CRe._StageGL_SPRITE,null!=t&&this.gotoAndPlay(t)}isVisible(){let e=this.cacheCanvas||this.spriteSheet.complete;return!!(this.visible&&this.alpha>0&&0!=this.scaleX&&0!=this.scaleY&&e)}draw(e,t){if(super.draw(e,t))return!0;this._normalizeFrame();let i=this.spriteSheet.getFrame(0|this._currentFrame);if(!i)return!1;let n=i.rect;return n.width&&n.height&&e.drawImage(i.image,n.x,n.y,n.width,n.height,-i.regX,-i.regY,n.width,n.height),!0}play(){this.paused=!1}stop(){this.paused=!0}gotoAndPlay(e){this.paused=!1,this._skipAdvance=!0,this._goto(e)}gotoAndStop(e){this.paused=!0,this._goto(e)}advance(e){let t=this.framerate||this.spriteSheet.framerate,i=t&&null!=e?e/(1e3/t):1;this._normalizeFrame(i)}getBounds(){return super.getBounds()||this.spriteSheet.getFrameBounds(this.currentFrame,this._rectangle)}clone(){return this._cloneProps(new DRe(this.spriteSheet))}_cloneProps(e){return super._cloneProps(e),e.currentFrame=this.currentFrame,e.currentAnimation=this.currentAnimation,e.paused=this.paused,e.currentAnimationFrame=this.currentAnimationFrame,e.framerate=this.framerate,e._animation=this._animation,e._currentFrame=this._currentFrame,e._skipAdvance=this._skipAdvance,e}_tick(e){this.paused||(this._skipAdvance||this.advance(e&&e.delta),this._skipAdvance=!1),super._tick(e)}_normalizeFrame(e=0){let t=this._animation,i=this.paused,n=this._currentFrame;if(t){let r=t.speed||1,a=this.currentAnimationFrame,o=t.frames.length;if(a+e*r>=o){let s=t.next;if(this._dispatchAnimationEnd(t,n,i,s,o-1))return;if(s)return this._goto(s,e-(o-a)/r);this.paused=!0,a=t.frames.length-1}else a+=e*r;this.currentAnimationFrame=a,this._currentFrame=t.frames[0|a]}else{n=this._currentFrame+=e;let r=this.spriteSheet.getNumFrames();if(n>=r&&r>0&&!this._dispatchAnimationEnd(t,n,i,r-1)&&(this._currentFrame-=r)>=r)return this._normalizeFrame()}n=0|this._currentFrame,this.currentFrame!=n&&(this.currentFrame=n,this.dispatchEvent("change"))}_dispatchAnimationEnd(e,t,i,n,r){let a=e?e.name:null;if(this.hasEventListener("animationend")){let e=new hRe("animationend");e.name=a,e.next=n,this.dispatchEvent(e)}let o=this._animation!=e||this._currentFrame!=t;return o||i||!this.paused||(this.currentAnimationFrame=r,o=!0),o}_goto(e,t=0){if(this.currentAnimationFrame=0,isNaN(e)){let i=this.spriteSheet.getAnimation(e);i&&(this._animation=i,this.currentAnimation=e,this._normalizeFrame(t))}else this.currentAnimation=this._animation=null,this._currentFrame=e,this._normalizeFrame()}}
/**
 * @license BitmapText
 * Visit http://createjs.com/ for documentation, updates and examples.
 *
 * Copyright (c) 2017 gskinner.com, inc.
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use,
 * copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the
 * Software is furnished to do so, subject to the following
 * conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
 * OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
 * HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
 * WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
 * OTHER DEALINGS IN THE SOFTWARE.
 */class jRe extends SRe{constructor(e="",t=null){super(),this.text=e,this.spriteSheet=t,this.lineHeight=0,this.letterSpacing=0,this.spaceWidth=0,this._oldProps={text:0,spriteSheet:0,lineHeight:0,letterSpacing:0,spaceWidth:0},this._oldStage=null,this._drawAction=null}draw(e,t){this.drawCache(e,t)||(this._updateState(),super.draw(e,t))}getBounds(){return this._updateText(),super.getBounds()}isVisible(){let e=this.cacheCanvas||this.spriteSheet&&this.spriteSheet.complete&&this.text;return!!(this.visible&&this.alpha>0&&0!==this.scaleX&&0!==this.scaleY&&e)}clone(){return this._cloneProps(new jRe(this.text,this.spriteSheet))}addChild(){}addChildAt(){}removeChild(){}removeChildAt(){}removeAllChildren(){}_updateState(){this._updateText()}_cloneProps(e){return super._cloneProps(e),e.lineHeight=this.lineHeight,e.letterSpacing=this.letterSpacing,e.spaceWidth=this.spaceWidth,e}_getFrameIndex(e,t){let i,n=t.getAnimation(e);return n||(e!=(i=e.toUpperCase())||e!=(i=e.toLowerCase())||(i=null),i&&(n=t.getAnimation(i))),n&&n.frames[0]}_getFrame(e,t){let i=this._getFrameIndex(e,t);return null==i?i:t.getFrame(i)}_getLineHeight(e){let t=this._getFrame("1",e)||this._getFrame("T",e)||this._getFrame("L",e)||e.getFrame(0);return t?t.rect.height:1}_getSpaceWidth(e){let t=this._getFrame("1",e)||this._getFrame("l",e)||this._getFrame("e",e)||this._getFrame("a",e)||e.getFrame(0);return t?t.rect.width:1}_tick(e){let t=this.stage;t&&t.on("drawstart",this._updateText,this,!0),super._tick(e)}_updateText(){let e,t=0,i=0,n=this._oldProps,r=!1,a=this.spaceWidth,o=this.lineHeight,s=this.spriteSheet,c=jRe._spritePool,l=this.children,u=0,h=l.length;for(let e in n)n[e]!=this[e]&&(n[e]=this[e],r=!0);if(!r)return;let d=!!this._getFrame(" ",s);d||a||(a=this._getSpaceWidth(s)),o||(o=this._getLineHeight(s));for(let n=0,r=this.text.length;n<r;n++){let r=this.text.charAt(n);if(" "===r&&!d){t+=a;continue}if("\n"===r||"\r"===r){"\r"===r&&"\n"===this.text.charAt(n+1)&&n++,t=0,i+=o;continue}let f=this._getFrameIndex(r,s);null!=f&&(u<h?e=l[u]:(l.push(e=c.length?c.pop():new DRe),e.parent=this,h++),e.spriteSheet=s,e.gotoAndStop(f),e.x=t,e.y=i,u++,t+=e.getBounds().width+this.letterSpacing)}for(;h>u;)c.push(e=l.pop()),e.parent=null,h--;c.length>jRe.maxPoolSize&&(c.length=jRe.maxPoolSize)}}jRe.maxPoolSize=100,jRe._spritePool=[];
/**
 * @license Graphics
 * Visit http://createjs.com/ for documentation, updates and examples.
 *
 * Copyright (c) 2017 gskinner.com, inc.
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use,
 * copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the
 * Software is furnished to do so, subject to the following
 * conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
 * OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
 * HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
 * WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
 * OTHER DEALINGS IN THE SOFTWARE.
 */
class MRe{constructor(){this.command=null,this._stroke=null,this._strokeStyle=null,this._oldStrokeStyle=null,this._strokeDash=null,this._oldStrokeDash=null,this._fill=null,this._strokeIgnoreScale=!1,this._commitIndex=0,this._instructions=[],this._activeInstructions=[],this._dirty=!1,this._storeIndex=0,this.curveTo=this.quadraticCurveTo,this.drawRect=this.rect,this.mt=this.moveTo,this.lt=this.lineTo,this.at=this.arcTo,this.bt=this.bezierCurveTo,this.qt=this.quadraticCurveTo,this.a=this.arc,this.r=this.rect,this.cp=this.closePath,this.c=this.clear,this.f=this.beginFill,this.lf=this.beginLinearGradientFill,this.rf=this.beginRadialGradientFill,this.bf=this.beginBitmapFill,this.ef=this.endFill,this.ss=this.setStrokeStyle,this.sd=this.setStrokeDash,this.s=this.beginStroke,this.ls=this.beginLinearGradientStroke,this.rs=this.beginRadialGradientStroke,this.bs=this.beginBitmapStroke,this.es=this.endStroke,this.dr=this.drawRect,this.rr=this.drawRoundRect,this.rc=this.drawRoundRectComplex,this.dc=this.drawCircle,this.de=this.drawEllipse,this.dp=this.drawPolyStar,this.p=this.decodePath,this.clear()}static getRGB(e,t,i,n){return null!=e&&null==i&&(n=t,i=255&e,t=e>>8&255,e=e>>16&255),null==n?`rgb(${e},${t},${i})`:`rgba(${e},${t},${i},${n})`}static getHSL(e,t,i,n){return null==n?`hsl(${e%360},${t}%,${i}%)`:`hsl(${e%360},${t}%,${i}%,${n})`}get instructions(){return this._updateInstructions(),this._instructions}isEmpty(){return!(this._instructions.length||this._activeInstructions.length)}draw(e,t){this._updateInstructions();let i=this._instructions;const n=i.length;for(let r=this._storeIndex;r<n;r++)i[r].exec(e,t)}drawAsPath(e){this._updateInstructions();let t,i=this._instructions;const n=i.length;for(let r=this._storeIndex;r<n;r++)!1!==(t=i[r]).path&&t.exec(e)}moveTo(e,t){return this.append(new LRe(e,t),!0)}lineTo(e,t){return this.append(new RRe(e,t))}arcTo(e,t,i,n,r){return this.append(new NRe(e,t,i,n,r))}arc(e,t,i,n,r,a){return this.append(new FRe(e,t,i,n,r,a))}quadraticCurveTo(e,t,i,n){return this.append(new kRe(e,t,i,n))}bezierCurveTo(e,t,i,n,r,a){return this.append(new BRe(e,t,i,n,r,a))}rect(e,t,i,n){return this.append(new zRe(e,t,i,n))}closePath(){return this._activeInstructions.length?this.append(new URe):this}clear(){return this._instructions.length=this._activeInstructions.length=this._commitIndex=0,this._strokeStyle=this._oldStrokeStyle=this._stroke=this._fill=this._strokeDash=this._oldStrokeDash=null,this._dirty=this._strokeIgnoreScale=!1,this}beginFill(e){return this._setFill(e?new HRe(e):null)}beginLinearGradientFill(e,t,i,n,r,a){return this._setFill((new HRe).linearGradient(e,t,i,n,r,a))}beginRadialGradientFill(e,t,i,n,r,a,o,s){return this._setFill((new HRe).radialGradient(e,t,i,n,r,a,o,s))}beginBitmapFill(e,t,i){return this._setFill(new HRe(null,i).bitmap(e,t))}endFill(){return this.beginFill()}setStrokeStyle(e,t=0,i=0,n=10,r=!1){return this._updateInstructions(!0),this._strokeStyle=this.command=new qRe(e,t,i,n,r),this._stroke&&(this._stroke.ignoreScale=r),this._strokeIgnoreScale=r,this}setStrokeDash(e,t=0){return this._updateInstructions(!0),this._strokeDash=this.command=new WRe(e,t),this}beginStroke(e){return this._setStroke(e?new GRe(e):null)}beginLinearGradientStroke(e,t,i,n,r,a){return this._setStroke((new GRe).linearGradient(e,t,i,n,r,a))}beginRadialGradientStroke(e,t,i,n,r,a,o,s){return this._setStroke((new GRe).radialGradient(e,t,i,n,r,a,o,s))}beginBitmapStroke(e,t="repeat"){return this._setStroke((new GRe).bitmap(e,t))}endStroke(){return this.beginStroke()}drawRoundRect(e,t,i,n,r){return this.drawRoundRectComplex(e,t,i,n,r,r,r,r)}drawRoundRectComplex(e,t,i,n,r,a,o,s){return this.append(new YRe(e,t,i,n,r,a,o,s))}drawCircle(e,t,i){return this.append(new XRe(e,t,i))}drawEllipse(e,t,i,n){return this.append(new ZRe(e,t,i,n))}drawPolyStar(e,t,i,n,r,a){return this.append(new QRe(e,t,i,n,r,a))}append(e,t){return this._activeInstructions.push(e),this.command=e,t||(this._dirty=!0),this}decodePath(e){let t=[this.moveTo,this.lineTo,this.quadraticCurveTo,this.bezierCurveTo,this.closePath],i=[2,2,4,6,0],n=0;const r=e.length;let a=[],o=0,s=0,c=MRe._BASE_64;for(;n<r;){let r=c[e.charAt(n)],l=r>>3,u=t[l];if(!u||3&r)throw`Bad path data (@${n}):c`;const h=i[l];l||(o=s=0),a.length=0,n++;let d=2+(r>>2&1);for(let t=0;t<h;t++){let i=c[e.charAt(n)],r=i>>5?-1:1;i=(31&i)<<6|c[e.charAt(n+1)],3===d&&(i=i<<6|c[e.charAt(n+2)]),i=r*i/10,t%2?o=i+=o:s=i+=s,a[t]=i,n+=d}u.apply(this,a)}return this}store(){return this._updateInstructions(!0),this._storeIndex=this._instructions.length,this}unstore(){return this._storeIndex=0,this}clone(){let e=new MRe;return e.command=this.command,e._stroke=this._stroke,e._strokeStyle=this._strokeStyle,e._strokeDash=this._strokeDash,e._strokeIgnoreScale=this._strokeIgnoreScale,e._fill=this._fill,e._instructions=this._instructions.slice(),e._commitIndex=this._commitIndex,e._activeInstructions=this._activeInstructions.slice(),e._dirty=this._dirty,e._storeIndex=this._storeIndex,e}toString(){return`[${this.constructor.name}]`}_updateInstructions(e){let t=this._instructions,i=this._activeInstructions,n=this._commitIndex;if(this._dirty&&i.length){t.length=n,t.push(MRe.beginCmd);const r=i.length,a=t.length;t.length=a+r;for(let e=0;e<r;e++)t[e+a]=i[e];this._fill&&t.push(this._fill),this._stroke&&(this._strokeDash!==this._oldStrokeDash&&t.push(this._strokeDash),this._strokeStyle!==this._oldStrokeStyle&&t.push(this._strokeStyle),e&&(this._oldStrokeDash=this._strokeDash,this._oldStrokeStyle=this._strokeStyle),t.push(this._stroke)),this._dirty=!1}e&&(i.length=0,this._commitIndex=t.length)}_setFill(e){return this._updateInstructions(!0),this.command=this._fill=e,this}_setStroke(e){return this._updateInstructions(!0),(this.command=this._stroke=e)&&(e.ignoreScale=this._strokeIgnoreScale),this}static get LineTo(){return RRe}static get MoveTo(){return LRe}static get ArcTo(){return NRe}static get Arc(){return FRe}static get QuadraticCurveTo(){return kRe}static get BezierCurveTo(){return BRe}static get Rect(){return zRe}static get ClosePath(){return URe}static get BeginPath(){return VRe}static get Fill(){return HRe}static get Stroke(){return GRe}static get StrokeStyle(){return qRe}static get StrokeDash(){return WRe}static get RoundRect(){return YRe}static get Circle(){return XRe}static get Ellipse(){return ZRe}static get PolyStar(){return QRe}}class RRe{constructor(e,t){this.x=e,this.y=t}exec(e){e.lineTo(this.x,this.y)}}class LRe{constructor(e,t){this.x=e,this.y=t}exec(e){e.moveTo(this.x,this.y)}}class NRe{constructor(e,t,i,n,r){this.x1=e,this.y1=t,this.x2=i,this.y2=n,this.radius=r}exec(e){e.arcTo(this.x1,this.y1,this.x2,this.y2,this.radius)}}class FRe{constructor(e,t,i,n,r,a=!1){this.x=e,this.y=t,this.radius=i,this.startAngle=n,this.endAngle=r,this.anticlockwise=a}exec(e){e.arc(this.x,this.y,this.radius,this.startAngle,this.endAngle,this.anticlockwise)}}class kRe{constructor(e,t,i,n){this.cpx=e,this.cpy=t,this.x=i,this.y=n}exec(e){e.quadraticCurveTo(this.cpx,this.cpy,this.x,this.y)}}class BRe{constructor(e,t,i,n,r,a){this.cp1x=e,this.cp1y=t,this.cp2x=i,this.cp2y=n,this.x=r,this.y=a}exec(e){e.bezierCurveTo(this.cp1x,this.cp1y,this.cp2x,this.cp2y,this.x,this.y)}}class zRe{constructor(e,t,i,n){this.x=e,this.y=t,this.w=i,this.h=n}exec(e){e.rect(this.x,this.y,this.w,this.h)}}class URe{constructor(){}exec(e){e.closePath()}}class VRe{constructor(){}exec(e){e.beginPath()}}class HRe{constructor(e,t){this.style=e,this.matrix=t,this.path=!1}exec(e){if(!this.style)return;e.fillStyle=this.style;let t=this.matrix;t&&(e.save(),e.transform(t.a,t.b,t.c,t.d,t.tx,t.ty)),e.fill(),t&&e.restore()}linearGradient(e,t,i,n,r,a){let o=this.style=MRe._ctx.createLinearGradient(i,n,r,a);const s=e.length;for(let i=0;i<s;i++)o.addColorStop(t[i],e[i]);return o.props={colors:e,ratios:t,x0:i,y0:n,x1:r,y1:a,type:"linear"},this}radialGradient(e,t,i,n,r,a,o,s){let c=this.style=MRe._ctx.createRadialGradient(i,n,r,a,o,s);const l=e.length;for(let i=0;i<l;i++)c.addColorStop(t[i],e[i]);return c.props={colors:e,ratios:t,x0:i,y0:n,r0:r,x1:a,y1:o,r1:s,type:"radial"},this}bitmap(e,t=""){if(e.naturalWidth||e.getContext||e.readyState>=2){(this.style=MRe._ctx.createPattern(e,t)).props={image:e,repetition:t,type:"bitmap"}}return this}}class GRe extends HRe{constructor(e,t){super(),this.style=e,this.ignoreScale=t,this.path=!1}exec(e){this.style&&(e.strokeStyle=this.style,this.ignoreScale&&(e.save(),e.setTransform(1,0,0,1,0,0)),e.stroke(),this.ignoreScale&&e.restore())}}class qRe{constructor(e=1,t="butt",i="miter",n=10,r=!1){this.width=e,this.caps=t,this.joints=i,this.miterLimit=n,this.ignoreScale=r,this.path=!1}exec(e){e.lineWidth=this.width,e.lineCap=isNaN(this.caps)?this.caps:MRe._STROKE_CAPS_MAP[this.caps],e.lineJoin=isNaN(this.joints)?this.joints:MRe._STROKE_JOINTS_MAP[this.joints],e.miterLimit=this.miterLimit,e.ignoreScale=this.ignoreScale}}class WRe{constructor(e=[],t=0){this.segments=e,this.offset=t}exec(e){e.setLineDash&&(e.setLineDash(this.segments),e.lineDashOffset=this.offset)}}class YRe{constructor(e,t,i,n,r,a,o,s){this.x=e,this.y=t,this.w=i,this.h=n,this.radiusTL=r,this.radiusTR=a,this.radiusBR=o,this.radiusBL=s}exec(e){let t=(this.w<this.h?this.w:this.h)/2,i=0,n=0,r=0,a=0,o=this.x,s=this.y,c=this.w,l=this.h,u=this.radiusTL,h=this.radiusTR,d=this.radiusBR,f=this.radiusBL;u<0&&(u*=i=-1),u>t&&(u=t),h<0&&(h*=n=-1),h>t&&(h=t),d<0&&(d*=r=-1),d>t&&(d=t),f<0&&(f*=a=-1),f>t&&(f=t),e.moveTo(o+c-h,s),e.arcTo(o+c+h*n,s-h*n,o+c,s+h,h),e.lineTo(o+c,s+l-d),e.arcTo(o+c+d*r,s+l+d*r,o+c-d,s+l,d),e.lineTo(o+f,s+l),e.arcTo(o-f*a,s+l+f*a,o,s+l-f,f),e.lineTo(o,s+u),e.arcTo(o-u*i,s-u*i,o+u,s,u),e.closePath()}}class XRe{constructor(e,t,i){this.x=e,this.y=t,this.radius=i}exec(e){e.arc(this.x,this.y,this.radius,0,2*Math.PI)}}class ZRe{constructor(e,t,i,n){this.x=e,this.y=t,this.w=i,this.h=n}exec(e){let t=this.x,i=this.y,n=this.w,r=this.h,a=.5522848,o=n/2*a,s=r/2*a,c=t+n,l=i+r,u=t+n/2,h=i+r/2;e.moveTo(t,h),e.bezierCurveTo(t,h-s,u-o,i,u,i),e.bezierCurveTo(u+o,i,c,h-s,c,h),e.bezierCurveTo(c,h+s,u+o,l,u,l),e.bezierCurveTo(u-o,l,t,h+s,t,h)}}class QRe{constructor(e,t,i,n,r=0,a=0){this.x=e,this.y=t,this.radius=i,this.sides=n,this.pointSize=r,this.angle=a}exec(e){let t=this.x,i=this.y,n=this.radius,r=this.angle/180*Math.PI,a=this.sides,o=1-this.pointSize,s=Math.PI/a;e.moveTo(t+Math.cos(r)*n,i+Math.sin(r)*n);for(let c=0;c<a;c++)r+=s,1!=o&&e.lineTo(t+Math.cos(r)*n*o,i+Math.sin(r)*n*o),r+=s,e.lineTo(t+Math.cos(r)*n,i+Math.sin(r)*n);e.closePath()}}MRe.beginCmd=new VRe,MRe._BASE_64={A:0,B:1,C:2,D:3,E:4,F:5,G:6,H:7,I:8,J:9,K:10,L:11,M:12,N:13,O:14,P:15,Q:16,R:17,S:18,T:19,U:20,V:21,W:22,X:23,Y:24,Z:25,a:26,b:27,c:28,d:29,e:30,f:31,g:32,h:33,i:34,j:35,k:36,l:37,m:38,n:39,o:40,p:41,q:42,r:43,s:44,t:45,u:46,v:47,w:48,x:49,y:50,z:51,0:52,1:53,2:54,3:55,4:56,5:57,6:58,7:59,8:60,9:61,"+":62,"/":63},MRe._STROKE_CAPS_MAP=["butt","round","square"],MRe._STROKE_JOINTS_MAP=["miter","round","bevel"],MRe._ctx=IRe().getContext("2d");
/**
 * @license AbstractTween
 * Visit http://createjs.com/ for documentation, updates and examples.
 *
 * Copyright (c) 2017 gskinner.com, inc.
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use,
 * copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the
 * Software is furnished to do so, subject to the following
 * conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
 * OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
 * HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
 * WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
 * OTHER DEALINGS IN THE SOFTWARE.
 */
class KRe extends fRe{constructor(e){super(),this.ignoreGlobalPause=!1,this.loop=0,this.useTicks=!1,this.reversed=!1,this.bounce=!1,this.timeScale=1,this.duration=0,this.position=0,this.rawPosition=-1,this._paused=!0,this._next=null,this._prev=null,this._parent=null,this._labels=null,this._labelList=null,e&&(this.useTicks=!!e.useTicks,this.ignoreGlobalPause=!!e.ignoreGlobalPause,this.loop=!0===e.loop?-1:e.loop||0,this.reversed=!!e.reversed,this.bounce=!!e.bounce,this.timeScale=e.timeScale||1,e.onChange&&this.addEventListener("change",e.onChange),e.onComplete&&this.addEventListener("complete",e.onComplete))}get labels(){let e=this._labelList;if(!e){e=this._labelList=[];let t=this._labels;for(let i in t)e.push({label:i,position:t[i]});e.sort((e,t)=>e.position-t.position)}return e}set labels(e){this._labels=e,this._labelList=null}get currentLabel(){let e=this.labels,t=this.position;for(let i=0,n=e.length;i<n&&!(t<e[i].position);i++);return 0===i?null:e[i-1].label}get paused(){return this._paused}set paused(e){nLe._register(this,e),this._paused=e}advance(e,t=!1){this.setPosition(this.rawPosition+e*this.timeScale,t)}setPosition(e,t=!1,i=!1,n){const r=this.duration,a=this.loop,o=this.rawPosition;let s=0,c=0,l=!1;if(e<0&&(e=0),0===r){if(l=!0,-1!==o)return l}else{if(s=e/r|0,c=e-s*r,l=-1!==a&&e>=a*r+r,l&&(e=(c=r)*(s=a)+r),e===o)return l;!this.reversed!=!(this.bounce&&s%2)&&(c=r-c)}this.position=c,this.rawPosition=e,this._updatePosition(i,l),l&&(this.paused=!0),n&&n(this),t||this._runActions(o,e,i,!i&&-1===o),this.dispatchEvent("change"),l&&this.dispatchEvent("complete")}calculatePosition(e){const t=this.duration,i=this.loop;let n=0,r=0;return 0===t?0:(-1!==i&&e>=i*t+t?(r=t,n=i):e<0?r=0:(n=e/t|0,r=e-n*t),!this.reversed!=!(this.bounce&&n%2)?t-r:r)}addLabel(e,t){this._labels||(this._labels={}),this._labels[e]=t;const n=this._labelList;if(n){for(let e=0,i=n.length;e<i&&!(t<n[e].position);e++);n.splice(i,0,{label:e,position:t})}}gotoAndPlay(e){this.paused=!1,this._goto(e)}gotoAndStop(e){this.paused=!0,this._goto(e)}resolve(e){const t=Number(e);return isNaN(t)?this._labels&&this._labels[e]:t}toString(){return`[${this.constructor.name}${this.name?` (name=${this.name})`:""}]`}clone(){throw"AbstractTween cannot be cloned."}_init(e){e&&e.paused||(this.paused=!1),e&&null!=e.position&&this.setPosition(e.position)}_goto(e){const t=this.resolve(e);null!=t&&this.setPosition(t,!1,!0)}_runActions(e,t,i,n){if(!this._actionHead&&!this.tweens)return;const r=this.duration,a=this.loop;let o,s,c,l,u=this.reversed,h=this.bounce;if(0===r?(o=s=c=l=0,u=h=!1):(o=e/r|0,s=t/r|0,c=e-o*r,l=t-s*r),-1!==a&&(s>a&&(l=r,s=a),o>a&&(c=r,o=a)),i)return this._runActionsRange(l,l,i,n);if(o===s&&c===l&&!i&&!n)return;-1===o&&(o=c=0);const d=e<=t;let f=o;do{let e=f===o?c:d?0:r,t=f===s?l:d?r:0;if(!u!=!(h&&f%2)&&(e=r-e,t=r-t),h&&f!==o&&e===t);else if(this._runActionsRange(e,t,i,n||f!==o&&!h))return!0;n=!1}while(d&&++f<=s||!d&&--f>=s)}_runActionsRange(e,t,i,n){throw"_runActionsRange is abstract and must be overridden by a subclass."}_updatePosition(e,t){throw"_updatePosition is abstract and must be overridden by a subclass."}}
/**
 * @license Ease
 * Visit http://createjs.com/ for documentation, updates and examples.
 *
 * Copyright (c) 2017 gskinner.com, inc.
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use,
 * copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the
 * Software is furnished to do so, subject to the following
 * conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
 * OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
 * HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
 * WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
 * OTHER DEALINGS IN THE SOFTWARE.
 */function JRe(e){return e}function $Re(e){return function(t){return Math.pow(t,e)}}function eLe(e){return function(t){return 1-Math.pow(1-t,e)}}function tLe(e){return function(t){return(t*=2)<1?.5*Math.pow(t,e):1-.5*Math.abs(Math.pow(2-t,e))}}$Re(2),eLe(2),tLe(2),$Re(3),eLe(3),tLe(3),$Re(4),eLe(4),tLe(4),$Re(5),eLe(5),tLe(5),iLe=1.7;var iLe;(function(e){e*=1.525})(1.7),function(e,t){let i=2*Math.PI}(1,.3),function(e,t){let i=2*Math.PI}(1,.3),function(e,t){let i=2*Math.PI}(1,.3*1.5);
/**
 * @license Tween
 * Visit http://createjs.com/ for documentation, updates and examples.
 *
 * Copyright (c) 2017 gskinner.com, inc.
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use,
 * copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the
 * Software is furnished to do so, subject to the following
 * conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
 * OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
 * HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
 * WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
 * OTHER DEALINGS IN THE SOFTWARE.
 */
class nLe extends KRe{constructor(e,t){super(t),this.pluginData=null,this.target=e,this.passive=!1,this._stepHead=new rLe(null,0,0,{},null,!0),this._stepTail=this._stepHead,this._stepPosition=0,this._actionHead=null,this._actionTail=null,this._plugins=null,this._pluginIds=null,this._injected=null,t&&(this.pluginData=t.pluginData,t.override&&nLe.removeTweens(e)),this.pluginData||(this.pluginData={}),this._init(t)}static get(e,t){return new nLe(e,t)}static tick(e,t){let i=nLe._tweenHead;for(;i;){let n=i._next;t&&!i.ignoreGlobalPause||i._paused||i.advance(i.useTicks?1:e),i=n}}static handleEvent(e){"tick"===e.type&&this.tick(e.delta,e.paused)}static removeTweens(e){if(!e.tweenjs_count)return;let t=nLe._tweenHead;for(;t;){let i=t._next;t.target===e&&(t.paused=!0),t=i}e.tweenjs_count=0}static removeAllTweens(){let e=nLe._tweenHead;for(;e;){let t=e._next;e._paused=!0,e.target&&(e.target.tweenjs_count=0),e._next=e._prev=null,e=t}nLe._tweenHead=nLe._tweenTail=null}static hasActiveTweens(e){return e?!!e.tweenjs_count:!!nLe._tweenHead}static installPlugin(e,t){e.install(t);const n=e.priority=e.priority||0,r=nLe._plugins=nLe._plugins||[];for(let e=0,t=r.length;e<t&&!(n<r[e].priority);e++);r.splice(i,0,e)}static _register(e,t){const i=e.target;if(!t&&e._paused){i&&(i.tweenjs_count=i.tweenjs_count?i.tweenjs_count+1:1);let t=nLe._tweenTail;t?(nLe._tweenTail=t._next=e,e._prev=t):nLe._tweenHead=nLe._tweenTail=e,nLe._inited||(mRe.addEventListener("tick",nLe),nLe._inited=!0)}else if(t&&!e._paused){i&&i.tweenjs_count--;let t=e._next,n=e._prev;t?t._prev=n:nLe._tweenTail=n,n?n._next=t:nLe._tweenHead=t,e._next=e._prev=null}}wait(e,t=!1){return e>0&&this._addStep(+e,this._stepTail.props,null,t),this}to(e,t=0,i=JRe){t<0&&(t=0);const n=this._addStep(+t,null,i);return this._appendProps(e,n),this}label(e){return this.addLabel(e,this.duration),this}call(e,t,i){return this._addAction(i||this.target,e,t||[this])}set(e,t){return this._addAction(t||this.target,this._set,[e])}play(e){return this._addAction(e||this,this._set,[{paused:!1}])}pause(e){return this._addAction(e||this,this._set,[{paused:!1}])}clone(){throw"Tween can not be cloned."}_addPlugin(e){let t=this._pluginIds||(this._pluginIds={}),i=e.id;if(!i||t[i])return;t[i]=!0;let n=this._plugins||(this._plugins=[]),r=e.priority||0;for(let t=0,i=n.length;t<i;t++)if(r<n[t].priority)return void n.splice(t,0,e);n.push(e)}_updatePosition(e,t){let i=this._stepHead.next,n=this.position,r=this.duration;if(this.target&&i){let e=i.next;for(;e&&e.t<=n;)i=i.next,e=i.next;let a=t?0===r?1:n/r:(n-i.t)/i.d;this._updateTargetProps(i,a,t)}this._stepPosition=i?n-i.t:0}_updateTargetProps(e,t,i){if(this.passive=!!e.passive)return;let n,r,a,o,s=e.prev.props,c=e.props;(o=e.ease)&&(t=o(t,0,1,1));let l=this._plugins;e:for(let o in s){if(r=s[o],a=c[o],n=r!==a&&"number"==typeof r?r+(a-r)*t:t>=1?a:r,l)for(let r=0,a=l.length;r<a;r++){let a=l[r].change(this,e,o,n,t,i);if(a===nLe.IGNORE)continue e;void 0!==a&&(n=a)}this.target[o]=n}}_runActionsRange(e,t,i,n){let r=e>t,a=r?this._actionTail:this._actionHead,o=t,s=e;r&&(o=e,s=t);let c=this.position;for(;a;){let i=a.t;if((i===t||i>s&&i<o||n&&i===e)&&(a.funct.apply(a.scope,a.params),c!==this.position))return!0;a=r?a.prev:a.next}}_appendProps(e,t,i){let n,r,a,o,s,c=this._stepHead.props,l=this.target,u=nLe._plugins,h=t.prev,d=h.props,f=t.props||(t.props=this._cloneProps(d)),p={};for(n in e)if(e.hasOwnProperty(n)&&(p[n]=f[n]=e[n],void 0===c[n])){if(o=void 0,u)for(r=u.length-1;r>=0;r--)if(a=u[r].init(this,n,o),void 0!==a&&(o=a),o===nLe.IGNORE){(ignored=ignored||{})[n]=!0,delete f[n],delete p[n];break}o!==nLe.IGNORE&&(void 0===o&&(o=l[n]),d[n]=void 0===o?null:o)}for(n in p){a=e[n];let t,i=h;for(;(t=i)&&(i=t.prev);)if(i.props!==t.props){if(void 0!==i.props[n])break;i.props[n]=d[n]}}if(i&&(u=this._plugins))for(r=u.length-1;r>=0;r--)u[r].step(this,t,p);(s=this._injected)&&(this._injected=null,this._appendProps(s,t,!1))}_injectProp(e,t){(this._injected||(this._injected={}))[e]=t}_addStep(e,t,i,n=!1){let r=new rLe(this._stepTail,this.duration,e,t,i,n);return this.duration+=e,this._stepTail=this._stepTail.next=r}_addAction(e,t,i){let n=new aLe(this._actionTail,this.duration,e,t,i);return this._actionTail?this._actionTail.next=n:this._actionHead=n,this._actionTail=n,this}_set(e){for(let t in e)this[t]=e[t]}_cloneProps(e){let t={};for(let i in e)t[i]=e[i];return t}}{let e=nLe.prototype;e.w=e.wait,e.t=e.to,e.c=e.call,e.s=e.set}nLe.IGNORE={},nLe._tweens=[],nLe._plugins=null,nLe._tweenHead=null,nLe._tweenTail=null;class rLe{constructor(e,t,i,n,r,a){this.next=null,this.prev=e,this.t=t,this.d=i,this.props=n,this.ease=r,this.passive=a,this.index=e?e.index+1:0}}class aLe{constructor(e,t,i,n,r){this.next=null,this.d=0,this.prev=e,this.t=t,this.scope=i,this.funct=n,this.params=r}}
/**
 * @license Timeline
 * Visit http://createjs.com/ for documentation, updates and examples.
 *
 * Copyright (c) 2010 gskinner.com, inc.
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use,
 * copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the
 * Software is furnished to do so, subject to the following
 * conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
 * OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
 * HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
 * WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
 * OTHER DEALINGS IN THE SOFTWARE.
 */class oLe extends KRe{constructor(e={}){super(e),this.tweens=[],e.tweens&&this.addTween(...e.tweens),e.labels&&(this.labels=e.labels),this._init(e)}addTween(...e){const t=e.length;if(1===t){const t=e[0];this.tweens.push(t),t._parent=this,t.paused=!0;let i=t.duration;return t.loop>0&&(i*=t.loop+1),i>this.duration&&(this.duration=i),this.rawPosition>=0&&t.setPosition(this.rawPosition),t}if(t>1){for(let i=0;i<t;i++)this.addTween(e[i]);return e[t-1]}return null}removeTween(...e){const t=e.length;if(1===t){const t=this.tweens,i=e[0];let n=t.length;for(;n--;)if(t[n]===i)return t.splice(n,1),i._parent=null,i.duration>=this.duration&&this.updateDuration(),!0;return!1}if(t>1){let i=!0;for(let n=0;n<t;n++)i=i&&this.removeTween(e[n]);return i}return!0}updateDuration(){this.duration=0;for(let e=0,t=this.tweens.length;e<t;e++){let t=this.tweens[e],i=t.duration;t.loop>0&&(i*=t.loop+1),i>this.duration&&(this.duration=i)}}clone(){throw"Timeline can not be cloned."}_updatePosition(e,t){const i=this.position;for(let t=0,n=this.tweens.length;t<n;t++)this.tweens[t].setPosition(i,!0,e)}_runActionsRange(e,t,i,n){const r=this.position;for(let a=0,o=this.tweens.length;a<o;a++)if(this.tweens[a]._runActions(e,t,i,n),r!==this.position)return!0}}
/**
 * @license MovieClip
 * Visit http://createjs.com/ for documentation, updates and examples.
 *
 * Copyright (c) 2017 gskinner.com, inc.
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use,
 * copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the
 * Software is furnished to do so, subject to the following
 * conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
 * OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
 * HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
 * WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
 * OTHER DEALINGS IN THE SOFTWARE.
 */class sLe extends SRe{constructor(e){super(),!sLe.inited&&sLe.init(),this.mode=null!=e.mode?e.mode:sLe.INDEPENDENT,this.startPosition=null!=e.startPosition?e.startPosition:0,"number"==typeof e.loop?this.loop=e.loop:!1===e.loop?this.loop=0:this.loop=-1,this.currentFrame=0,this.timeline=new oLe(Object.assign({useTicks:!0,paused:!0},e)),this.paused=null!=e.paused&&e.paused,this.actionsEnabled=!0,this.autoReset=!0,this.frameBounds=this.frameBounds||e.frameBounds,this.framerate=null,this._synchOffset=0,this._rawPosition=-1,this._t=0,this._managed={},this._bound_resolveState=this._resolveState.bind(this)}static init(){sLe.inited||(cLe.install(),sLe.inited=!0)}get labels(){return this.timeline.labels}get currentLabel(){return this.timeline.currentLabel}get duration(){return this.timeline.duration}get totalFrames(){return this.duration}isVisible(){return!!(this.visible&&this.alpha>0&&0!=this.scaleX&&0!=this.scaleY)}draw(e,t){return!!this.drawCache(e,t)||(this._updateState(),super.draw(e,t),!0)}play(){this.paused=!1}stop(){this.paused=!0}gotoAndPlay(e){this.play(),this._goto(e)}gotoAndStop(e){this.stop(),this._goto(e)}advance(e){if(this.mode!==sLe.INDEPENDENT)return;let t=this,i=t.framerate;for(;(t=t.parent)&&null===i;)t.mode===sLe.INDEPENDENT&&(i=t._framerate);if(this._framerate=i,this.paused)return;let n=null!==i&&-1!==i&&null!==e?e/(1e3/i)+this._t:1,r=0|n;for(this._t=n-r;r--;)this._updateTimeline(this._rawPosition+1,!1)}clone(){throw"MovieClip cannot be cloned."}_updateState(){-1!==this._rawPosition&&this.mode===sLe.INDEPENDENT||this._updateTimeline(-1)}_tick(e){this.advance(e&&e.delta),super._tick(e)}_goto(e){let t=this.timeline.resolve(e);null!=t&&(this._t=0,this._updateTimeline(t,!0))}_reset(){this._rawPosition=-1,this._t=this.currentFrame=0,this.paused=!1}_updateTimeline(e,t){let i=this.mode!==sLe.INDEPENDENT,n=this.timeline;i&&(e=this.startPosition+(this.mode===sLe.SINGLE_FRAME?0:this._synchOffset)),e<1&&(e=0),(this._rawPosition!==e||i)&&(this._rawPosition=e,n.loop=this.loop,n.setPosition(e,i||!this.actionsEnabled,t,this._bound_resolveState))}_renderFirstFrame(){const e=this.timeline,t=e.rawPosition;e.setPosition(0,!0,!0,this._bound_resolveState),e.rawPosition=t}_resolveState(){let e=this.timeline;this.currentFrame=e.position;for(let e in this._managed)this._managed[e]=1;let t=e.tweens;for(let e of t){let t=e.target;if(t===this||e.passive)continue;let i=e._stepPosition;t instanceof CRe?this._addManagedChild(t,i):this._setState(t.state,i)}let i=this.children;for(let e=i.length-1;e>=0;e--){let t=i[e].id;1===this._managed[t]&&(this.removeChildAt(e),delete this._managed[t])}}_setState(e,t){if(e)for(let i=e.length-1;i>=0;i--){let n=e[i],r=n.t,a=n.p;for(let e in a)r[e]=a[e];this._addManagedChild(r,t)}}_addManagedChild(e,t){e._off||(this.addChildAt(e,0),e instanceof sLe&&(e._synchOffset=t,e.mode===sLe.INDEPENDENT&&e.autoReset&&!this._managed[e.id]&&e._reset()),this._managed[e.id]=2)}_getBounds(e,t){let i=this.getBounds();return!i&&this.frameBounds&&(i=this._rectangle.copy(this.frameBounds[this.currentFrame])),i?this._transformBounds(i,e,t):super._getBounds(e,t)}}sLe.INDEPENDENT="independent",sLe.SINGLE_FRAME="single",sLe.SYNCHED="synched",sLe.inited=!1;class cLe{constructor(){throw"MovieClipPlugin cannot be instantiated."}static install(){nLe.installPlugin(cLe)}static init(e,t,i){return i}static tween(e,t,i,n,r,a,o,s){return e.target instanceof sLe?1===a?r[t]:n[t]:i}}cLe.priority=100;
/**
 * @license Shape
 * Visit http://createjs.com/ for documentation, updates and examples.
 *
 * Copyright (c) 2017 gskinner.com, inc.
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use,
 * copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the
 * Software is furnished to do so, subject to the following
 * conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
 * OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
 * HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
 * WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
 * OTHER DEALINGS IN THE SOFTWARE.
 */
class lLe extends CRe{constructor(e=new MRe){super(),this.graphics=e}isVisible(){let e=this.cacheCanvas||this.graphics&&!this.graphics.isEmpty();return!!(this.visible&&this.alpha>0&&0!=this.scaleX&&0!=this.scaleY&&e)}draw(e,t=!1){return!!super.draw(e,t)||(this.graphics.draw(e,this),!0)}clone(e=!1){let t=e&&this.graphics?this.graphics.clone():this.graphics;return this._cloneProps(new lLe(t))}}
/**
 * @license SpriteSheet
 * Visit http://createjs.com/ for documentation, updates and examples.
 *
 * Copyright (c) 2017 gskinner.com, inc.
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use,
 * copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the
 * Software is furnished to do so, subject to the following
 * conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPliED, INCLUDING BUT NOT liMITED TO THE WARRANTIES
 * OF MERCHANTABIliTY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
 * HolDERS BE liABLE FOR ANY CLAIM, DAMAGES OR OTHER liABIliTY,
 * WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
 * OTHER DEAliNGS IN THE SOFTWARE.
 */class uLe extends fRe{constructor(e){super(),this.complete=!0,this.framerate=0,this._animations=null,this._frames=null,this._images=null,this._data=null,this._loadCount=0,this._frameHeight=0,this._frameWidth=0,this._numFrames=0,this._regX=0,this._regY=0,this._spacing=0,this._margin=0,this._parseData(e)}get animations(){return this._animations.slice()}getNumFrames(e){if(null==e)return this._frames?this._frames.length:this._numFrames||0;{let t=this._data[e];return null==t?0:t.frames.length}}getAnimation(e){return this._data[e]}getFrame(e){let t;return this._frames&&(t=this._frames[e])?t:null}getFrameBounds(e,t=new xRe){let i=this.getFrame(e);return i?t.setValues(-i.regX,-i.regY,i.rect.width,i.rect.height):null}toString(){return`[${this.constructor.name}]`}clone(){throw"SpriteSheet cannot be cloned."}_parseData(e){if(null!=e){if(this.framerate=e.framerate||0,e.images)for(let t of e.images){let e,i=this._images=[];"string"==typeof t&&(e=t,t=document.createElement("img"),t.src=e),i.push(t),t.getContext||t.naturalWidth||(this._loadCount++,this.complete=!1,t.onload=()=>this._handleImageLoad(e),t.onerror=()=>this._handleImageError(e))}if(null!=e.frames)if(Array.isArray(e.frames)){this._frames=[];for(let t of e.frames)this._frames.push({image:this._images[t[4]?t[4]:0],rect:new xRe(t[0],t[1],t[2],t[3]),regX:t[5]||0,regY:t[6]||0})}else{let t=e.frames;this._frameWidth=t.width,this._frameHeight=t.height,this._regX=t.regX||0,this._regY=t.regY||0,this._spacing=t.spacing||0,this._margin=t.margin||0,this._numFrames=t.count,0===this._loadCount&&this._calculateFrames()}if(this._animations=[],null!=e.animations){this._data={};let t=e.animations;for(let e in t){let i,n={name:e},r=t[e];if("number"==typeof r)i=n.frames=[r];else if(Array.isArray(r))if(1===r.length)n.frames=[r[0]];else{n.speed=r[3],n.next=r[2],i=n.frames=[];for(let e=r[0];e<=r[1];e++)i.push(e)}else{n.speed=r.speed,n.next=r.next;let e=r.frames;i=n.frames="number"==typeof e?[e]:e.slice(0)}!0!==n.next&&void 0!==n.next||(n.next=e),(!1===n.next||i.length<2&&n.next===e)&&(n.next=null),n.speed||(n.speed=1),this._animations.push(e),this._data[e]=n}}}}_handleImageLoad(e){0==--this._loadCount&&(this._calculateFrames(),this.complete=!0,this.dispatchEvent("complete"))}_handleImageError(e){let t=new hRe("error");t.src=e,this.dispatchEvent(t),0==--this._loadCount&&this.dispatchEvent("complete")}_calculateFrames(){if(this._frames||0===this._frameWidth)return;this._frames=[];let e=this._numFrames||1e5,t=0,i=this._frameWidth,n=this._frameHeight,r=this._spacing,a=this._margin;e:for(let o=0,s=this._images,c=s.length;o<c;o++){let c=s[o],l=c.width||c.naturalWidth,u=c.height||c.naturalHeight,h=a;for(;h<=u-a-n;){let o=a;for(;o<=l-a-i;){if(t>=e)break e;t++,this._frames.push({image:c,rect:new xRe(o,h,i,n),regX:this._regX,regY:this._regY}),o+=i+r}h+=n+r}}this._numFrames=t}}
/**
 * @license Text
 * Visit http://createjs.com/ for documentation, updates and examples.
 *
 * Copyright (c) 2017 gskinner.com, inc.
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use,
 * copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the
 * Software is furnished to do so, subject to the following
 * conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
 * OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
 * HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
 * WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
 * OTHER DEALINGS IN THE SOFTWARE.
 */class hLe extends CRe{constructor(e,t,i){super(),this.text=e,this.font=t,this.color=i,this.textAlign="left",this.textBaseline="top",this.maxWidth=null,this.outline=0,this.lineHeight=0,this.lineWidth=null}isVisible(){let e=this.cacheCanvas||null!=this.text&&""!==this.text;return!!(this.visible&&this.alpha>0&&0!=this.scaleX&&0!=this.scaleY&&e)}draw(e,t){if(super.draw(e,t))return!0;let i=this.color||"#000";return this.outline?(e.strokeStyle=i,e.lineWidth=1*this.outline):e.fillStyle=i,this._drawText(this._prepContext(e)),!0}getMeasuredWidth(){return this._getMeasuredWidth(this.text)}getMeasuredLineHeight(){return 1.2*this._getMeasuredWidth("M")}getMeasuredHeight(){return this._drawText(null,{}).height}getBounds(){let e=super.getBounds();if(e)return e;if(null==this.text||""===this.text)return null;let t=this._drawText(null,{}),i=this.maxWidth&&this.maxWidth<t.width?this.maxWidth:t.width,n=i*hLe.H_OFFSETS[this.textAlign||"left"],r=(this.lineHeight||this.getMeasuredLineHeight())*hLe.V_OFFSETS[this.textBaseline||"top"];return this._rectangle.setValues(n,r,i,t.height)}getMetrics(){let e={lines:[]};return e.lineHeight=this.lineHeight||this.getMeasuredLineHeight(),e.vOffset=e.lineHeight*hLe.V_OFFSETS[this.textBaseline||"top"],this._drawText(null,e,e.lines)}clone(){return this._cloneProps(new hLe(this.text,this.font,this.color))}toString(){return`[${this.constructor.name} (text=${this.text.length>20?`${this.text.substr(0,17)}...`:this.text})]`}_cloneProps(e){return super._cloneProps(e),e.textAlign=this.textAlign,e.textBaseline=this.textBaseline,e.maxWidth=this.maxWidth,e.outline=this.outline,e.lineHeight=this.lineHeight,e.lineWidth=this.lineWidth,e}_prepContext(e){return e.font=this.font||"10px sans-serif",e.textAlign=this.textAlign||"left",e.textBaseline=this.textBaseline||"top",e.lineJoin="miter",e.miterLimit=2.5,e}_drawText(e,t,i){const n=!!e;n||((e=hLe._ctx).save(),this._prepContext(e));let r=this.lineHeight||this.getMeasuredLineHeight(),a=0,o=0,s=String(this.text).split(/(?:\r\n|\r|\n)/);for(let c of s){let s=null;if(null!=this.lineWidth&&(s=e.measureText(c).width)>this.lineWidth){let t=c.split(/(\s)/);c=t[0],s=e.measureText(c).width;const l=t.length;for(let u=1;u<l;u+=2){let l=e.measureText(t[u]+t[u+1]).width;s+l>this.lineWidth?(n&&this._drawTextLine(e,c,o*r),i&&i.push(c),s>a&&(a=s),c=t[u+1],s=e.measureText(c).width,o++):(c+=t[u]+t[u+1],s+=l)}}n&&this._drawTextLine(e,c,o*r),i&&i.push(c),t&&null==s&&(s=e.measureText(c).width),s>a&&(a=s),o++}return t&&(t.width=a,t.height=o*r),n||e.restore(),t}_drawTextLine(e,t,i){this.outline?e.strokeText(t,0,i,this.maxWidth||65535):e.fillText(t,0,i,this.maxWidth||65535)}_getMeasuredWidth(e){let t=hLe._ctx;t.save();let i=this._prepContext(t).measureText(e).width;return t.restore(),i}}hLe.H_OFFSETS={start:0,left:0,center:-.5,end:-1,right:-1},hLe.V_OFFSETS={top:0,hanging:-.01,middle:-.4,alphabetic:-.8,ideographic:-.85,bottom:-1},hLe._ctx=IRe().getContext("2d");
/**
 * @license BlurFilter
 * Visit http://createjs.com/ for documentation, updates and examples.
 *
 * Copyright (c) 2017 gskinner.com, inc.
 *
 * BoxBlur Algorithm by Mario Klingemann, quasimondo.com
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use,
 * copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the
 * Software is furnished to do so, subject to the following
 * conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
 * OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
 * HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
 * WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
 * OTHER DEALINGS IN THE SOFTWARE.
 */
class dLe extends ERe{constructor(e=0,t=0,i=1){super(),this._blurX=e,this._blurXTable=[],this._lastBlurX=null,this._blurY=t,this._blurYTable=[],this._lastBlurY=null,this._quality=isNaN(i)||i<1?1:i,this._lastQuality=null,this.FRAG_SHADER_TEMPLATE="\n\t\t\tuniform float xWeight[{{blurX}}];\n\t\t\tuniform float yWeight[{{blurY}}];\n\t\t\tuniform vec2 textureOffset;\n\t\t\tvoid main (void) {\n\t\t\t\tvec4 color = vec4(0.0);\n\n\t\t\t\tfloat xAdj = ({{blurX}}.0-1.0)/2.0;\n\t\t\t\tfloat yAdj = ({{blurY}}.0-1.0)/2.0;\n\t\t\t\tvec2 sampleOffset;\n\n\t\t\t\tfor(int i=0; i<{{blurX}}; i++) {\n\t\t\t\t\tfor(int j=0; j<{{blurY}}; j++) {\n\t\t\t\t\t\tsampleOffset = vRenderCoord + (textureOffset * vec2(float(i)-xAdj, float(j)-yAdj));\n\t\t\t\t\t\tcolor += texture2D(uSampler, sampleOffset) * (xWeight[i] * yWeight[j]);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tgl_FragColor = color.rgba;\n\t\t\t}\n\t\t"}get blurX(){return this._blurX}set blurX(e){(isNaN(e)||e<0)&&(e=0),this._blurX=e}get blurY(){return this._blurY}set blurY(e){(isNaN(e)||e<0)&&(e=0),this._blurY=e}get quality(){return 0|this._quality}set quality(e){(isNaN(e)||e<0)&&(e=0),this._quality=e}get _buildShader(){const e=this._lastBlurX!==this._blurX,t=this._lastBlurY!==this._blurY,i=this._lastQuality!==this._quality;return e||t||i?((e||i)&&(this._blurXTable=this._getTable(this._blurX*this._quality)),(t||i)&&(this._blurYTable=this._getTable(this._blurY*this._quality)),this._updateShader(),this._lastBlurX=this._blurX,this._lastBlurY=this._blurY,void(this._lastQuality=this._quality)):this._compiledShader}set _builtShader(e){this._compiledShader=e}shaderParamSetup(e,t,i){e.uniform1fv(e.getUniformLocation(i,"xWeight"),this._blurXTable),e.uniform1fv(e.getUniformLocation(i,"yWeight"),this._blurYTable),e.uniform2f(e.getUniformLocation(i,"textureOffset"),2/(t._viewportWidth*this._quality),2/(t._viewportHeight*this._quality))}getBounds(e){let t=0|this.blurX,i=0|this.blurY;if(t<=0&&i<=0)return e;let n=Math.pow(this.quality,.2);return(e||new xRe).pad(i*n+1,t*n+1,i*n+1,t*n+1)}clone(){return new dLe(this.blurX,this.blurY,this.quality)}_updateShader(){let e=this.FRAG_SHADER_TEMPLATE;e=e.replace(/{{blurX}}/g,this._blurXTable.length.toFixed(0)),e=e.replace(/{{blurY}}/g,this._blurYTable.length.toFixed(0)),this.FRAG_SHADER_BODY=e}_getTable(e){if(e<=1)return[1];let t=[],i=Math.ceil(2*e);i+=i%2?0:1;let n=i/2|0;for(let e=-n;e<=n;e++){let i=e/n*4.2;t.push(1/Math.sqrt(2*Math.PI)*Math.pow(Math.E,-Math.pow(i,2)/4))}let r=t.reduce((e,t)=>e+t,0);return t.map(e=>e/r)}_applyFilter(e){let t=this._blurX>>1;if(isNaN(t)||t<0)return!1;let i=this._blurY>>1;if(isNaN(i)||i<0)return!1;if(0===t&&0===i)return!1;let n=this.quality;(isNaN(n)||n<1)&&(n=1),n|=0,n>3&&(n=3),n<1&&(n=1);let r=e.data,a=0,o=0,s=0,c=0,l=0,u=0,h=0,d=0,f=0,p=0,m=0,_=0,g=0,v=0,b=0,y=t+t+1|0,w=i+i+1|0,O=0|e.width,x=0|e.height,E=O-1|0,T=x-1|0,C=t+1|0,S=i+1|0,A={r:0,b:0,g:0,a:0},P=A;for(s=1;s<y;s++)P=P.n={r:0,b:0,g:0,a:0};P.n=A;let I={r:0,b:0,g:0,a:0},D=I;for(s=1;s<w;s++)D=D.n={r:0,b:0,g:0,a:0};D.n=I;let j=null,M=0|dLe.MUL_TABLE[t],R=0|dLe.SHG_TABLE[t],L=0|dLe.MUL_TABLE[i],N=0|dLe.SHG_TABLE[i];for(;n-- >0;){h=u=0;let e=M,y=R;for(o=x;--o>-1;){for(d=C*(_=r[0|u]),f=C*(g=r[u+1|0]),p=C*(v=r[u+2|0]),m=C*(b=r[u+3|0]),P=A,s=C;--s>-1;)P.r=_,P.g=g,P.b=v,P.a=b,P=P.n;for(s=1;s<C;s++)c=u+((E<s?E:s)<<2)|0,d+=P.r=r[c],f+=P.g=r[c+1],p+=P.b=r[c+2],m+=P.a=r[c+3],P=P.n;for(j=A,a=0;a<O;a++)r[u++]=d*e>>>y,r[u++]=f*e>>>y,r[u++]=p*e>>>y,r[u++]=m*e>>>y,c=h+((c=a+t+1)<E?c:E)<<2,d-=j.r-(j.r=r[c]),f-=j.g-(j.g=r[c+1]),p-=j.b-(j.b=r[c+2]),m-=j.a-(j.a=r[c+3]),j=j.n;h+=O}for(e=L,y=N,a=0;a<O;a++){for(u=a<<2|0,d=S*(_=r[u])|0,f=S*(g=r[u+1|0])|0,p=S*(v=r[u+2|0])|0,m=S*(b=r[u+3|0])|0,D=I,s=0;s<S;s++)D.r=_,D.g=g,D.b=v,D.a=b,D=D.n;for(l=O,s=1;s<=i;s++)u=l+a<<2,d+=D.r=r[u],f+=D.g=r[u+1],p+=D.b=r[u+2],m+=D.a=r[u+3],D=D.n,s<T&&(l+=O);if(u=a,j=I,n>0)for(o=0;o<x;o++)c=u<<2,r[c+3]=b=m*e>>>y,b>0?(r[c]=d*e>>>y,r[c+1]=f*e>>>y,r[c+2]=p*e>>>y):r[c]=r[c+1]=r[c+2]=0,c=a+((c=o+S)<T?c:T)*O<<2,d-=j.r-(j.r=r[c]),f-=j.g-(j.g=r[c+1]),p-=j.b-(j.b=r[c+2]),m-=j.a-(j.a=r[c+3]),j=j.n,u+=O;else for(o=0;o<x;o++)c=u<<2,r[c+3]=b=m*e>>>y,b>0?(b=255/b,r[c]=(d*e>>>y)*b,r[c+1]=(f*e>>>y)*b,r[c+2]=(p*e>>>y)*b):r[c]=r[c+1]=r[c+2]=0,c=a+((c=o+S)<T?c:T)*O<<2,d-=j.r-(j.r=r[c]),f-=j.g-(j.g=r[c+1]),p-=j.b-(j.b=r[c+2]),m-=j.a-(j.a=r[c+3]),j=j.n,u+=O}}return!0}}dLe.MUL_TABLE=[1,171,205,293,57,373,79,137,241,27,391,357,41,19,283,265,497,469,443,421,25,191,365,349,335,161,155,149,9,278,269,261,505,245,475,231,449,437,213,415,405,395,193,377,369,361,353,345,169,331,325,319,313,307,301,37,145,285,281,69,271,267,263,259,509,501,493,243,479,118,465,459,113,446,55,435,429,423,209,413,51,403,199,393,97,3,379,375,371,367,363,359,355,351,347,43,85,337,333,165,327,323,5,317,157,311,77,305,303,75,297,294,73,289,287,71,141,279,277,275,68,135,67,133,33,262,260,129,511,507,503,499,495,491,61,121,481,477,237,235,467,232,115,457,227,451,7,445,221,439,218,433,215,427,425,211,419,417,207,411,409,203,202,401,399,396,197,49,389,387,385,383,95,189,47,187,93,185,23,183,91,181,45,179,89,177,11,175,87,173,345,343,341,339,337,21,167,83,331,329,327,163,81,323,321,319,159,79,315,313,39,155,309,307,153,305,303,151,75,299,149,37,295,147,73,291,145,289,287,143,285,71,141,281,35,279,139,69,275,137,273,17,271,135,269,267,133,265,33,263,131,261,130,259,129,257,1],dLe.SHG_TABLE=[0,9,10,11,9,12,10,11,12,9,13,13,10,9,13,13,14,14,14,14,10,13,14,14,14,13,13,13,9,14,14,14,15,14,15,14,15,15,14,15,15,15,14,15,15,15,15,15,14,15,15,15,15,15,15,12,14,15,15,13,15,15,15,15,16,16,16,15,16,14,16,16,14,16,13,16,16,16,15,16,13,16,15,16,14,9,16,16,16,16,16,16,16,16,16,13,14,16,16,15,16,16,10,16,15,16,14,16,16,14,16,16,14,16,16,14,15,16,16,16,14,15,14,15,13,16,16,15,17,17,17,17,17,17,14,15,17,17,16,16,17,16,15,17,16,17,11,17,16,17,16,17,16,17,17,16,17,17,16,17,17,16,16,17,17,17,16,14,17,17,17,17,15,16,14,16,15,16,13,16,15,16,14,16,15,16,12,16,15,16,17,17,17,17,17,13,16,15,17,17,17,16,15,17,17,17,16,15,17,17,14,16,17,17,16,17,17,16,15,17,16,14,17,16,15,17,16,17,17,16,17,15,16,17,14,17,16,15,17,16,17,13,17,16,17,17,16,17,14,17,16,17,16,17,16,17,9];
/**
 * @license ColorMatrix
 * Visit http://createjs.com/ for documentation, updates and examples.
 *
 * Copyright (c) 2017 gskinner.com, inc.
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use,
 * copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the
 * Software is furnished to do so, subject to the following
 * conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
 * OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
 * HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
 * WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
 * OTHER DEALINGS IN THE SOFTWARE.
 */
class fLe{constructor(e,t,i,n){this.setColor(e,t,i,n)}setColor(e,t,i,n){return this.reset().adjustColor(e,t,i,n)}reset(){return this.copy(fLe.IDENTITY_MATRIX)}adjustColor(e,t,i,n){return this.adjustBrightness(e).adjustContrast(t).adjustSaturation(i).adjustHue(n)}adjustBrightness(e){return 0===e||isNaN(e)?this:(e=this._cleanValue(e,255),this._multiplyMatrix([1,0,0,0,e,0,1,0,0,e,0,0,1,0,e,0,0,0,1,0,0,0,0,0,1]),this)}adjustContrast(e){if(0===e||isNaN(e))return this;let t;return(e=this._cleanValue(e,100))<0?t=127+e/100*127:(t=e%1,t=0===t?fLe.DELTA_INDEX[e]:fLe.DELTA_INDEX[e<<0]*(1-t)+fLe.DELTA_INDEX[1+(e<<0)]*t,t=127*t+127),this._multiplyMatrix([t/127,0,0,0,.5*(127-t),0,t/127,0,0,.5*(127-t),0,0,t/127,0,.5*(127-t),0,0,0,1,0,0,0,0,0,1]),this}adjustSaturation(e){if(0===e||isNaN(e))return this;let t=1+((e=this._cleanValue(e,100))>0?3*e/100:e/100);return this._multiplyMatrix([.3086*(1-t)+t,.6094*(1-t),.082*(1-t),0,0,.3086*(1-t),.6094*(1-t)+t,.082*(1-t),0,0,.3086*(1-t),.6094*(1-t),.082*(1-t)+t,0,0,0,0,0,1,0,0,0,0,0,1]),this}adjustHue(e){if(0===e||isNaN(e))return this;e=this._cleanValue(e,180)/180*Math.PI;let t=Math.cos(e),i=Math.sin(e);return this._multiplyMatrix([.213+.787*t+-.213*i,.715+-.715*t+-.715*i,.072+-.072*t+.928*i,0,0,.213+-.213*t+.143*i,.715+t*(1-.715)+.14*i,.072+-.072*t+-.283*i,0,0,.213+-.213*t+-.787*i,.715+-.715*t+.715*i,.072+.928*t+.072*i,0,0,0,0,0,1,0,0,0,0,0,1]),this}concat(e){return(e=this._fixMatrix(e)).length!=fLe.LENGTH?this:(this._multiplyMatrix(e),this)}clone(){return(new fLe).copy(this)}toArray(){const e=[],t=fLe.LENGTH;for(let i=0;i<t;i++)e[i]=this[i];return e}copy(e){const t=fLe.LENGTH;for(let i=0;i<t;i++)this[i]=e[i];return this}toString(){return`[${this.constructor.name}]`}_multiplyMatrix(e){let t=[];for(let i=0;i<5;i++){for(let e=0;e<5;e++)t[e]=this[e+5*i];for(let n=0;n<5;n++){let r=0;for(let i=0;i<5;i++)r+=e[n+5*i]*t[i];this[n+5*i]=r}}}_cleanValue(e,t){return Math.min(t,Math.max(-t,e))}_fixMatrix(e){return e instanceof fLe&&(e=e.toArray()),e.length<fLe.LENGTH?e=e.slice(0,e.length).concat(fLe.IDENTITY_MATRIX.slice(e.length,fLe.LENGTH)):e.length>fLe.LENGTH&&(e=e.slice(0,fLe.LENGTH)),e}}fLe.DELTA_INDEX=Object.freeze([0,.01,.02,.04,.05,.06,.07,.08,.1,.11,.12,.14,.15,.16,.17,.18,.2,.21,.22,.24,.25,.27,.28,.3,.32,.34,.36,.38,.4,.42,.44,.46,.48,.5,.53,.56,.59,.62,.65,.68,.71,.74,.77,.8,.83,.86,.89,.92,.95,.98,1,1.06,1.12,1.18,1.24,1.3,1.36,1.42,1.48,1.54,1.6,1.66,1.72,1.78,1.84,1.9,1.96,2,2.12,2.25,2.37,2.5,2.62,2.75,2.87,3,3.2,3.4,3.6,3.8,4,4.3,4.7,4.9,5,5.5,6,6.5,6.8,7,7.3,7.5,7.8,8,8.4,8.7,9,9.4,9.6,9.8,10]),fLe.IDENTITY_MATRIX=Object.freeze([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1]),fLe.LENGTH=25;
/**
 * @license SpriteSheetBuilder
 * Visit http://createjs.com/ for documentation, updates and examples.
 *
 * Copyright (c) 2017 gskinner.com, inc.
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use,
 * copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the
 * Software is furnished to do so, subject to the following
 * conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
 * OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
 * HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
 * WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
 * OTHER DEALINGS IN THE SOFTWARE.
 */
class pLe extends fRe{constructor(e=0){super(),this.maxWidth=2048,this.maxHeight=2048,this.spriteSheet=null,this.scale=1,this.padding=1,this.timeSlice=.3,this.progress=-1,this.framerate=e,this._frames=[],this._animations={},this._data=null,this._nextFrameIndex=0,this._index=0,this._timerID=null,this._scale=1}addFrame(e,t,i=1,n,r){if(this._data)throw pLe.ERR_RUNNING;let a=t||e.bounds||e.nominalBounds||e.getBounds&&e.getBounds();return a?this._frames.push({source:e,sourceRect:a,scale:i,funct:n,data:r,index:this._frames.length,height:a.height*i})-1:null}addAnimation(e,t,i,n){if(this._data)throw pLe.ERR_RUNNING;this._animations[e]={frames:t,next:i,speed:n}}addMovieClip(e,t,i=1,n,r,a){if(this._data)throw pLe.ERR_RUNNING;let o=e.frameBounds,s=t||e.bounds||e.nominalBounds||e.getBounds&&e.getBounds();if(!s&&!o)return;let c=this._frames.length;const l=e.timeline.duration;for(let t=0;t<l;t++){let a=o&&o[t]?o[t]:s;this.addFrame(e,a,i,this._setupMovieClipFrame,{i:t,f:n,d:r})}const u=e.timeline._labels;let h=[];for(let e in u)h.push({index:u[e],label:e});if(h.length){h.sort((e,t)=>e.index-t.index);for(let t=0,i=h.length;t<i;t++){let n=h[t].label,r=c+h[t].index,o=c+(t===i-1?l:h[t+1].index),s=[];for(let e=r;e<o;e++)s.push(e);a&&(n=a(n,e,r,o),!n)||this.addAnimation(n,s,!0)}}}build(){if(this._data)throw pLe.ERR_RUNNING;for(this._startBuild();this._drawNext(););return this._endBuild(),this.spriteSheet}buildAsync(e){if(this._data)throw pLe.ERR_RUNNING;this.timeSlice=e,this._startBuild(),this._timerID=setTimeout(()=>this._run(),50-50*Math.max(.01,Math.min(.99,this.timeSlice||.3)))}stopAsync(){clearTimeout(this._timerID),this._data=null}toString(){return`[${this.constructor.name}]`}_startBuild(){let e=this.padding||0;this.progress=0,this.spriteSheet=null,this._index=0,this._scale=this.scale;let t=[];this._data={images:[],frames:t,framerate:this.framerate,animations:this._animations};let i=this._frames.slice();if(i.sort((e,t)=>e.height<=t.height?-1:1),i[i.length-1].height+2*e>this.maxHeight)throw pLe.ERR_DIMENSIONS;let n=0,r=0,a=0;for(;i.length;){let o=this._fillRow(i,n,a,t,e);if(o.w>r&&(r=o.w),n+=o.h,!o.h||!i.length){let e=window.createjs&&createjs.createCanvas?createjs.createCanvas():document.createElement("canvas");e.width=this._getSize(r,this.maxWidth),e.height=this._getSize(n,this.maxHeight),this._data.images[a]=e,o.h||(r=n=0,a++)}}}_setupMovieClipFrame(e,t){let i=e.actionsEnabled;e.actionsEnabled=!1,e.gotoAndStop(t.i),e.actionsEnabled=i,t.f&&t.f(e,t.d,t.i)}_getSize(e,t){let i=4;for(;Math.pow(2,++i)<e;);return Math.min(t,Math.pow(2,i))}_fillRow(e,t,i,n,r){let a=this.maxWidth,o=this.maxHeight-(t+=r),s=r,c=0;for(let l=e.length-1;l>=0;l--){let u=e[l],h=this._scale*u.scale,d=u.sourceRect,f=u.source,p=Math.floor(h*d.x-r),m=Math.floor(h*d.y-r),_=Math.ceil(h*d.height+2*r),g=Math.ceil(h*d.width+2*r);if(g>a)throw pLe.ERR_DIMENSIONS;_>o||s+g>a||(u.img=i,u.rect=new xRe(s,t,g,_),c=c||_,e.splice(l,1),n[u.index]=[s,t,g,_,i,Math.round(-p+h*f.regX-r),Math.round(-m+h*f.regY-r)],s+=g)}return{w:s,h:c}}_endBuild(){this.spriteSheet=new uLe(this._data),this._data=null,this.progress=1,this.dispatchEvent("complete")}_run(){let e=50*Math.max(.01,Math.min(.99,this.timeSlice||.3)),t=(new Date).getTime()+e,i=!1;for(;t>(new Date).getTime();)if(!this._drawNext()){i=!0;break}i?this._endBuild():this._timerID=setTimeout(()=>this._run(),50-e);let n=this.progress=this._index/this._frames.length;if(this.hasEventListener("progress")){let e=new hRe("progress");e.progress=n,this.dispatchEvent(e)}}_drawNext(){let e=this._frames[this._index],t=e.scale*this._scale,i=e.rect,n=e.sourceRect,r=this._data.images[e.img].getContext("2d");return e.funct&&e.funct(e.source,e.data),r.save(),r.beginPath(),r.rect(i.x,i.y,i.width,i.height),r.clip(),r.translate(Math.ceil(i.x-n.x*t),Math.ceil(i.y-n.y*t)),r.scale(t,t),e.source.draw(r),r.restore(),++this._index<this._frames.length}}pLe.ERR_DIMENSIONS="frame dimensions exceed max spritesheet dimensions",pLe.ERR_RUNNING="a build is already running";
/*
* @license SpriteSheetUtils
* Visit http://createjs.com/ for documentation, updates and examples.
*
* Copyright (c) 2017 gskinner.com, inc.
*
* Permission is hereby granted, free of charge, to any person
* obtaining a copy of this software and associated documentation
* files (the "Software"), to deal in the Software without
* restriction, including without limitation the rights to use,
* copy, modify, merge, publish, distribute, sublicense, and/or sell
* copies of the Software, and to permit persons to whom the
* Software is furnished to do so, subject to the following
* conditions:
*
* The above copyright notice and this permission notice shall be
* included in all copies or substantial portions of the Software.
*
* THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
* EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
* OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
* NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
* HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
* WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
* FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
* OTHER DEALINGS IN THE SOFTWARE.
*/IRe();
/**
 * @license WebGLInspector
 * Visit http://createjs.com/ for documentation, updates and examples.
 *
 * Copyright (c) 2017 gskinner.com, inc.
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use,
 * copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the
 * Software is furnished to do so, subject to the following
 * conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
 * OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
 * HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
 * WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
 * OTHER DEALINGS IN THE SOFTWARE.
 */class mLe extends fRe{constructor(e){super(),this._stage=e}static dispProps(e,t=""){let i=`\tP: ${e.x.toFixed(2)}x${e.y.toFixed(2)}\t`,n=`\tR: ${e.regX.toFixed(2)}x${e.regY.toFixed(2)}\t`;mLe._log(t,`${e.toString()}\t`,i,n)}static _log(...e){mLe.alternateOutput?mLe.alternateOutput.log(...e):console.log(...e)}log(e){e||(e=this._stage),mLe._log(`Batches Per Draw: ${(e._batchID/e._drawID).toFixed(4)}`),this.logContextInfo(e._webGLContext),this.logDepth(e.children,""),this.logTextureFill(e)}toggleGPUDraw(e,t){e||(e=this._stage),void 0===t&&(t=!!e._drawBuffers_),t&&e._drawBuffers_?(e._drawBuffers=e._drawBuffers_,e._drawBuffers_=void 0):(e._drawBuffers_=e._drawBuffers,e._drawBuffers=function(e){this.vocalDebug&&mLe._log(`BlankDraw[${this._drawID}:${this._batchID}] : ${this.batchReason}`)})}logDepth(e,t="",i=mLe._log){e||(e=this._stage.children);const n=e.length;for(let r=0;r<n;r++){let n=e[r];i(`${t}-`,n),n.children&&n.children.length&&this.logDepth(n.children,`|${t}`,i)}}logContextInfo(e){e||(e=this._stage._webGLContext);let t=`\n\t\t\t== LOG:\n\n\t\t\tMax textures per draw: ${e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}\n\n\t\t\tMax textures active: ${e.getParameter(e.MAX_COMBINED_TEXTURE_IMAGE_UNITS)}\n\n\t\t\t\n\n\t\t\tMax texture size: ${e.getParameter(e.MAX_TEXTURE_SIZE)/2}\n\n\t\t\tMax cache size: ${e.getParameter(e.MAX_RENDERBUFFER_SIZE)/2}\n\n\t\t\t\n\n\t\t\tMax attributes per vertex: ${e.getParameter(e.MAX_VERTEX_ATTRIBS)}\n\n\t\t\tWebGL Version string: ${e.getParameter(e.VERSION)}\n\n\t\t\t======\n\t\t`;mLe._log(t)}logTextureFill(e){e||(e=this._stage);let t=e._textureDictionary,i=e._batchTextureCount;mLe._log(`${textureMax}: ${i}`);let n=[];for(let e in t){e.replace(window.location.origin,"");let i=t[e],r=!!i._lastActiveIndex&&i._lastActiveIndex===i._activeIndex;n.push({src:src,element:i,shifted:r}),i._lastActiveIndex=i._activeIndex}n.sort((t,i)=>t.element._drawID===e._drawID?1:t.element._drawID<i.element._drawID?-1:0);const r=n.length;for(let t=0;t<r;t++){let i=n[t],r=i.element._drawID===e._drawID;mLe._log(`[${i.src}] ${r?"ACTIVE":"stale"} ${i.shifted?"steady":"DRIFT"}`,i.element)}}}function _Le(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}mLe.alternateOutput=null;var gLe=function(){function e(t,i,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),n=n||{},this._lineWidth=w.a(n.lineWidth,6),this._color=w.a(n.color,uf.RED),this._stage=t;var r=this._line=new lLe,a=this._arrow=new lLe;this._start=i,t.addChild(this._line),t.addChild(this._arrow),r.styles=[r.graphics.beginStroke(this.color.toCssColorString()).command],this._startPointCommand=r.graphics.setStrokeStyle(this.lineWidth,"round").moveTo(i[0],i[1]),this._endPointCommand=r.graphics.lineTo(i[0],i[1]).command,r.child=a,a.parent=r,r.styles.push(a.graphics.beginStroke(this.color.toCssColorString()).command),a.graphics.setStrokeStyle(this.lineWidth).moveTo(-10,5).lineTo(0,0).lineTo(-10,-5)}var t,i,n;return t=e,(i=[{key:"setBounds",value:function(){var e,t,i=(e=this._start,t=this._end,[e[0]<t[0]?e[0]:t[0],e[1]<t[1]?e[1]:t[1],e[0]>t[0]?e[0]-t[0]:t[0]-e[0],e[1]>t[1]?e[1]-t[1]:t[1]-e[1]]);this._line.setBounds(i[0],i[1],i[2],i[3])}},{key:"addMouseEventListener",value:function(e,t){var i=this;this._line.on(e,(function(e){t(i)})),this._arrow.on(e,(function(e){t(i)}))}},{key:"finishSketch",value:function(){this.setBounds()}},{key:"startEdit",value:function(){var e=this._stage,t=this._start,i=new lLe;e.addChild(i),i.graphics.setStrokeStyle(1).beginStroke("blue").beginFill("rgba(255,255,255,0.5)").drawCircle(t[0],t[1],8);var n=this._end,r=new lLe;e.addChild(r),r.graphics.setStrokeStyle(1).beginStroke("blue").beginFill("rgba(255,255,255,0.5)").drawCircle(n[0],n[1],8);var a=new lLe;e.addChild(a),a.graphics.setStrokeStyle(1).beginStroke("blue"),e.update()}},{key:"setColor",value:function(e){this._line.styles.forEach((function(t){t.style=e.toCssColorString()})),this._stage.update()}},{key:"update",value:function(e){this._line;var t=this._arrow,i=this._start;this._endPointCommand.x=e[0],this._endPointCommand.y=e[1],this._end=e,function(e,t,i,n,r){var a=Math.atan2(i[1]-t[1],i[0]-t[0])/Math.PI*180;e.x=i[0],e.y=i[1],e.rotation=a}(t,i,e),this._stage.update()}},{key:"destroy",value:function(){var e=this._stage;e.removeChild(this._line),e.removeChild(this._arrow),e.update()}},{key:"lineWidth",get:function(){return this._lineWidth}},{key:"color",get:function(){return this._color}}])&&_Le(t.prototype,i),n&&_Le(t,n),e}();function vLe(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var bLe=function(){function e(t,i,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),n=n||{},this._lineWidth=w.a(n.lineWidth,6),this._color=w.a(n.color,uf.RED),this._stage=t,this._rect=new lLe,this._rect.styles=[],this._start=i,t.addChild(this._rect)}var t,i,n;return t=e,(i=[{key:"setBounds",value:function(){var e,t,i=(e=this._start,t=this._end,[e[0]<t[0]?e[0]:t[0],e[1]<t[1]?e[1]:t[1],e[0]>t[0]?e[0]-t[0]:t[0]-e[0],e[1]>t[1]?e[1]-t[1]:t[1]-e[1]]);this._rect.setBounds(i[0],i[1],i[2],i[3])}},{key:"addMouseEventListener",value:function(e,t){var i=this;this._rect.on(e,(function(e){t(i)}))}},{key:"finishSketch",value:function(){this.setBounds()}},{key:"setColor",value:function(e){this._rect.styles.forEach((function(t){t.style=e.toCssColorString()})),this._stage.update()}},{key:"update",value:function(e){var t=this._rect,i=this._start;t.graphics.clear(),t.styles.push(t.graphics.beginStroke(this.color.toCssColorString()).command),t.graphics.setStrokeStyle(this.lineWidth,"round").drawRect(i[0],i[1],e[0]-i[0],e[1]-i[1]),this._end=e,this._stage.update()}},{key:"destroy",value:function(){var e=this._stage;e.removeChild(this._rect),e.update()}},{key:"lineWidth",get:function(){return this._lineWidth}},{key:"color",get:function(){return this._color}}])&&vLe(t.prototype,i),n&&vLe(t,n),e}();function yLe(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var wLe=function(){function e(t,i,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),n=n||{},this._lineWidth=w.a(n.lineWidth,6),this._color=w.a(n.color,uf.RED),this._stage=t,this._rect=new lLe,this._rect.styles=[],this._start=i,t.addChild(this._rect)}var t,i,n;return t=e,(i=[{key:"setBounds",value:function(){var e,t,i=(e=this._start,t=this._end,[e[0]<t[0]?e[0]:t[0],e[1]<t[1]?e[1]:t[1],e[0]>t[0]?e[0]-t[0]:t[0]-e[0],e[1]>t[1]?e[1]-t[1]:t[1]-e[1]]);this._rect.setBounds(i[0],i[1],i[2],i[3])}},{key:"addMouseEventListener",value:function(e,t){var i=this;this._rect.on(e,(function(e){t(i)}))}},{key:"finishSketch",value:function(){this.setBounds()}},{key:"setColor",value:function(e){this._rect.styles.forEach((function(t){t.style=e.toCssColorString()})),this._stage.update()}},{key:"update",value:function(e){var t=this._rect,i=this._start;t.graphics.clear(),t.styles.push(t.graphics.beginStroke(this.color.toCssColorString()).command),t.graphics.setStrokeStyle(this.lineWidth,"round").drawEllipse(i[0],i[1],e[0]-i[0],e[1]-i[1]),this._end=e,this._stage.update()}},{key:"destroy",value:function(){var e=this._stage;e.removeChild(this._rect),e.update()}},{key:"lineWidth",get:function(){return this._lineWidth}},{key:"color",get:function(){return this._color}}])&&yLe(t.prototype,i),n&&yLe(t,n),e}();function OLe(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var xLe=function(){function e(t,i,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),r=r||{},this._lineWidth=w.a(r.lineWidth,6),this._color=w.a(r.color,uf.RED),this._stage=t,this._font=w.a(r.font,"20px Arial"),this._text=new hLe("",this._font,this._color.toCssColorString()),this._start=i,this._container=n,t.addChild(this._text);var a=this._text.localToGlobal(i[0],i[1]);this._text.x=a.x,this._text.y=a.y;var o=this.textarea=document.createElement("input");o.setAttribute("type","textarea"),o.setAttribute("style","position:absolute;top:"+a.y+"px; left:"+a.x+"px;z-index:1;font:"+this._font+";color:"+this._color.toCssColorString()+";"),this._container.appendChild(o),o.focus()}var t,i,n;return t=e,(i=[{key:"addMouseEventListener",value:function(e,t){var i=this;this._text.on(e,(function(e){t(i)}))}},{key:"finishSketch",value:function(){if(""!==this.textarea.value){this._text.text=this.textarea.value;var e=new lLe;e.graphics.beginFill("#000").drawRect(0,0,this._text.getMeasuredWidth(),this._text.getMeasuredHeight()),this._text.hitArea=e,this._stage.update()}this._container.removeChild(this.textarea),this.textarea=void 0}},{key:"setColor",value:function(e){this._text.color=e.toCssColorString(),this._stage.update()}},{key:"destroy",value:function(){var e=this._stage;e.removeChild(this._text),this.textarea&&(this._container.removeChild(this.textarea),this.textarea=void 0),e.update()}},{key:"lineWidth",get:function(){return this._lineWidth}},{key:"color",get:function(){return this._color}}])&&OLe(t.prototype,i),n&&OLe(t,n),e}();function ELe(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var TLe=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),!u.a(t.viewer))throw new h.a("options.viewer未定义");this._viewer=t.viewer,this._lineWidth=w.a(t.lineWidth,6),this._color=w.a(t.color,uf.RED),this._font=w.a(t.font,"20px Arial"),this._viewer.controller.enableInputs=!1,this.commentType=lRe.ARROWLINE,this._sketchs=[],this.initStage()}var t,i,n;return t=e,(i=[{key:"initStage",value:function(){var e=this._canvas=document.createElement("canvas");e.setAttribute("id","commentcanvas"),e.setAttribute("style","position:absolute;top: 0;");var t=this._viewer.cesiumViewer.container;e.setAttribute("width",t.clientWidth),e.setAttribute("height",t.clientHeight),t.appendChild(this._canvas),this._stage=new PRe("commentcanvas"),this.addMouseEventListener()}},{key:"addMouseEventListener",value:function(){var e=this,t=this._stage;t.enableMouseOver(),t.on("stagemousedown",(function(i){if(e._hover||e._typing)e._typing&&(e._currentSketch.finishSketch(),e._typing=!1);else{var n=[i.stageX,i.stageY];switch(e._drawing=!0,e.commentType){case lRe.ARROWLINE:e._currentSketch=new gLe(t,n,{lineWidth:e._lineWidth,color:e._color});break;case lRe.RECT:e._currentSketch=new bLe(t,n,{lineWidth:e._lineWidth,color:e._color});break;case lRe.ELLIPSE:e._currentSketch=new wLe(t,n,{lineWidth:e._lineWidth,color:e._color});break;case lRe.TEXT:e._currentSketch=new xLe(t,n,e._viewer.cesiumViewer.container,{font:e._font,color:e._color}),e._typing=!0,e._drawing=!1}e._sketchs.push(e._currentSketch)}})),t.on("stagemouseup",(function(t){if(e._currentSelectedGraphic&&(e._currentSelectedGraphic.setColor(e._currentSelectedGraphic.color),e._currentSelectedGraphic=void 0),e.commentType!==lRe.TEXT&&e._drawing){var i=[t.stageX,t.stageY];e._currentSketch.update(i),e._currentSketch.finishSketch()}e._drawing=!1,e._currentSketch.addMouseEventListener("mouseover",(function(t){e._drawing||(e._hover=!0,t.setColor(uf.YELLOW))})),e._currentSketch.addMouseEventListener("mouseout",(function(t){!e._drawing&&e._hover&&(t.setColor(t.color),e._hover=!1)})),e._currentSketch.addMouseEventListener("click",(function(t){e._currentSelectedGraphic&&e._currentSelectedGraphic.setColor(e._currentSelectedGraphic.color),e._currentSelectedGraphic=t,e._currentSelectedGraphic.setColor(uf.YELLOW),e._hover=!1}))})),t.on("stagemousemove",(function(t){if(e._drawing&&!e._hover){var i=[t.stageX,t.stageY];e._currentSketch.update(i)}})),document.body.addEventListener("keydown",this.keyDown.bind(this))}},{key:"keyDown",value:function(e){"Delete"===e.code&&this._currentSelectedGraphic&&this._currentSelectedGraphic.destroy()}},{key:"exportImage",value:function(){var e=this,t=this._viewer.cesiumViewer.canvas,i=this._canvas,n=document.createElement("canvas");n.setAttribute("width",i.width),n.setAttribute("height",i.height);var r=n.getContext("2d"),a=!0;return new Promise((function(o,s){e._viewer.cesiumViewer.scene.postRender.addEventListener((function(){a&&(r.drawImage(t,0,0),r.drawImage(i,0,0),o(n.toDataURL()),a=!1)}))}))}},{key:"isDestroyed",value:function(){return!1}},{key:"destroy",value:function(){return this._sketchs.forEach((function(e){e.destroy()})),this._stage.clear(),this._viewer.cesiumViewer.container.removeChild(this._canvas),document.body.removeEventListener("mousemove",this.keyDown),this._viewer.controller.enableInputs=!0,rl(this)}},{key:"lineWidth",get:function(){return this._lineWidth},set:function(e){this._lineWidth=e}},{key:"color",get:function(){return this._color},set:function(e){this._color=e}},{key:"font",get:function(){return this._font},set:function(e){this._font=e}}])&&ELe(t.prototype,i),n&&ELe(t,n),e}(),CLe={TRANSLATE:0,SCALE:1,ROTATION:2};Object.freeze(CLe);var SLe=CLe;n(348),n(349);function ALe(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var PLe=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._indexedDB=window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB,void 0===this._indexedDB&&console.warn("IndexedDB不可用"),this._name="motor-editor",this._version=1,this._database}var t,i,n;return t=e,(i=[{key:"init",value:function(){var e=this;return new Promise((function(t,i){var n=e._indexedDB.open(e._name,e._version);n.onupgradeneeded=function(e){var t=e.target.result;!1===t.objectStoreNames.contains("states")&&t.createObjectStore("states")},n.onsuccess=function(i){e._database=i.target.result,t(i.target.result)},n.onerror=function(e){console.error("IndexedDB",e)}}))}},{key:"get",value:function(){var e=this;if(void 0!==this._database)return new Promise((function(t,i){var n=e._database.transaction(["states"],"readwrite").objectStore("states").get(0);n.onsuccess=function(e){t(e.target.result)},n.onerror=function(e){i("IndexDB获取数据出错")}}))}},{key:"set",value:function(e){var t=this;if(void 0!==this._database)return new Promise((function(i,n){var r=performance.now(),a=t._database.transaction(["states"],"readwrite").objectStore("states").put(e,0);a.onsuccess=function(){i("["+/\d\d\:\d\d\:\d\d/.exec(new Date)[0]+"] 数据保存到IndexedDB "+(performance.now()-r).toFixed(2)+"ms")},a.onerror=function(e){n("IndexDB保存数据出错")}}))}},{key:"clear",value:function(){var e=this;if(void 0!==this._database)return new Promise((function(t,i){var n=e._database.transaction(["states"],"readwrite").objectStore("states").clear();n.onsuccess=function(){t("["+/\d\d\:\d\d\:\d\d/.exec(new Date)[0]+"]","清空IndexedDB.")},n.onerror=function(e){i("IndexDB清空数据出错")}}))}}])&&ALe(t.prototype,i),n&&ALe(t,n),e}();function ILe(e){return function(e){if(Array.isArray(e)){for(var t=0,i=new Array(e.length);t<e.length;t++)i[t]=e[t];return i}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function DLe(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var jLe=function(){function e(t){var i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._editor=t,this._undos=[],this._redos=[],this._maxUndos=20,this._currentState=void 0,this._historyStorage=new PLe,this.change=new $o.a,this.change.addEventListener((function(){i._historyStorage.set(i.toJSON()).then((function(e){console.log(e)}))}))}var t,i,n;return t=e,(i=[{key:"initialize",value:function(){var e=this;return new Promise((function(t,i){e._historyStorage.init().then((function(){e._historyStorage.clear(),e._historyStorage.get().then((function(i){i?(console.log(i),e.fromJSON(i)):console.log("历史数据为空"),t("编辑历史IndexDB初始化成功")})).catch((function(e){i("获取或写入历史数据失败: "+e)}))})).catch((function(e){i("编辑历史IndexDB初始化失败: "+e)}))}))}},{key:"addUndo",value:function(e){this._currentState&&(this._undos.length>this._maxUndos&&this._undos.shift(),this._undos.push(this._currentState)),this._currentState=e,this._redos=[],this.change.raiseEvent()}},{key:"undo",value:function(){if(this._undos.length>0){var e=this._undos.pop();e&&(this.doOperation(e),this._redos.push(this._currentState),this._currentState=e),this.change.raiseEvent()}}},{key:"redo",value:function(){if(this._redos.length>0){var e=this._redos.pop();e&&(this.doOperation(e),this._undos.push(this._currentState),this._currentState=e),this.change.raiseEvent()}}},{key:"gotoState",value:function(e){var t=ILe(this._redos).reverse(),i=[].concat(ILe(this._undos),[this._currentState],ILe(t));t=i.slice(e+1),this._redos=t.reverse(),this._undos=i.slice(0,e),this.doOperation(i[e]),this._currentState=i[e],this.change.raiseEvent()}},{key:"doOperation",value:function(e){if(e.guid){if(this._currentState.guid!==e.guid)if(this._editor.detach(!1),"component"===e.type)for(var t=this._editor._project._components,i=0;i<t.length;i++)e.guid===t[i].guid&&this._editor.attach(t[i],!1);else if("project"===e.type)for(var n=this._editor._project._projectList,r=0;r<n.length;r++)e.guid===n[r].guid&&this._editor.attach(n[r],!1);this._editor.mode!==e.mode&&this._editor.setModeWithoutAddToHistory(e.mode),e.matrix&&this.setTransform(e)}else this._editor.detach(!1)}},{key:"setTransform",value:function(e){this._editor.object.setMatrix(e.matrix),this._editor.object.updateBoundingSphere();var t=this._editor.object.boundingSphere.center;this._editor._axes.forEach((function(e){e.primitive&&(e.primitive.modelMatrix=xa.eastNorthUpToFixedFrame(t))}))}},{key:"toJSON",value:function(){if(this._currentState){var e={undos:this._undos.map((function(e){return{mode:e.mode,guid:e.guid,type:e.type,message:e.message,matrix:"detach"!==e.message?Be.pack(e.matrix,new Array(16)):void 0}})),redos:this._redos.map((function(e){return{mode:e.mode,guid:e.guid,type:e.type,message:e.message,matrix:"detach"!==e.message?Be.pack(e.matrix,new Array(16)):void 0}})),currentState:{mode:this._currentState.mode,guid:this._currentState.guid,type:this._currentState.type,message:this._currentState.message,matrix:"detach"!==this._currentState.message?Be.pack(this._currentState.matrix,new Array(16)):void 0}};return console.log(e),e}}},{key:"fromJSON",value:function(e){this._undos=e.undos.map((function(e){return{mode:e.mode,guid:e.guid,type:e.type,message:e.message,matrix:Array.isArray(e.matrix)?Be.fromArray(e.matrix):void 0}})),this._redos=e.redos.map((function(e){return{mode:e.mode,guid:e.guid,type:e.type,message:e.message,matrix:Array.isArray(e.matrix)?Be.fromArray(e.matrix):void 0}}));var t={mode:e.currentState.mode,guid:e.currentState.guid,type:e.currentState.type,message:e.currentState.message,matrix:Array.isArray(e.currentState.matrix)?Be.fromArray(e.currentState.matrix):void 0};this._currentState={guid:"-1"},this.doOperation(t),this._currentState=t}},{key:"clear",value:function(){this._editor.object&&this._editor.detach(!1),this._undos=[],this._redos=[],this._currentState=void 0,this.change.raiseEvent(),this.clearHistoryCache()}},{key:"clearHistoryCache",value:function(){this._historyStorage.clear()}},{key:"undos",get:function(){return this._undos}},{key:"currentState",get:function(){return this._currentState}},{key:"redos",get:function(){return this._redos}},{key:"maxUndos",get:function(){return this._maxUndos},set:function(e){if(e<0)throw new h.a("maxUndos不能为负数");if(e>100)throw new h.a("maxUndos不能超过100");this._maxUndos=e}}])&&DLe(t.prototype,i),n&&DLe(t,n),e}();function MLe(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var RLe=[{name:"X",unit:z.UNIT_X,color:uf.RED.withAlpha(.5),hover:uf.RED},{name:"Y",unit:z.UNIT_Y,color:uf.GREEN.withAlpha(.5),hover:uf.GREEN},{name:"Z",unit:z.UNIT_Z,color:uf.BLUE.withAlpha(.5),hover:uf.BLUE},{name:"XYZ",unit:new z,color:uf.WHITE.withAlpha(.05),hover:uf.WHITE.withAlpha(.2)}];new z(1,1,1);function LLe(e,t,i){for(var n=-1,r=0;r<e.length;r++)if(e[r][t]===i){n=r;break}return n}var NLe=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),!u.a(t.viewer))throw new h.a("optios.viewer未定义");if(!u.a(t.project))throw new h.a("optios.project未定义");this._viewer=t.viewer,this._project=t.project,this._modifiedComponents={},this._history=new jLe(this),this._currentSelectedObject=void 0,this._modifiedComponents={},this._axisLength,this._axisWidth=20,this._currentAxis,this._rotationSpeed=10,this._scaleFactor=.2,this._mode=SLe.TRANSLATE,this._axes=RLe,this._geoms=new mMe({viewer:this._viewer}),this.dragStart=new $o.a,this.dragEnd=new $o.a,this.modechange=new $o.a,this.componentChange=new $o.a,this._handler=new aA(this._viewer.cesiumViewer.scene.canvas),this.initHandlerEvent()}var t,i,n;return t=e,(i=[{key:"setModeWithoutAddToHistory",value:function(e){this._mode!==e&&(this._mode=e,this._geoms.removeAll(),this._currentSelectedObject&&this.createAxis(this._currentSelectedObject),this.modechange.raiseEvent())}},{key:"addHistory",value:function(e){var t=void 0,i="component";u.a(this._currentSelectedObject)&&(this._currentSelectedObject instanceof mIe?t=this._currentSelectedObject._primitives[0]._externalMatrix.clone():this._currentSelectedObject instanceof XIe&&(u.a(this._currentSelectedObject._externalMatrix)?t=this._currentSelectedObject._externalMatrix.clone():u.a(this._currentSelectedObject._projectList[0]._externalMatrix)&&(t=this._currentSelectedObject._projectList[0]._externalMatrix.clone()),i="project")),this._history.addUndo({mode:this._mode,type:i,message:e,guid:this._currentSelectedObject?this._currentSelectedObject.guid:void 0,matrix:t})}},{key:"attach",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(e instanceof mIe&&e.project.type!==ZPe.TYPE_CIM)throw new h.a("无法编辑BIM构件");this._currentSelectedObject&&this._currentSelectedObject.guid===e.guid||(this._currentSelectedObject&&this.detach(t),this._geoms.removeAll(),this._currentSelectedObject=e,this.createAxis(e),this.componentChange.raiseEvent(),t&&this.addHistory("attach"))}},{key:"detach",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._currentSelectedObject=void 0,this._geoms.removeAll(),this.componentChange.raiseEvent(),e&&this.addHistory("detach")}},{key:"createAxis",value:function(e){var t=this;if(e){var i=e.boundingSphere.center;this._axisLength=1.5*e.boundingSphere.radius,RLe.forEach((function(e){if("XYZ"===e.name){if(t.mode===SLe.ROTATION||t.mode===SLe.TRANSLATE){var n=t.mode===SLe.ROTATION?t._axisLength/2*9/10:t._axisLength/10,r=t._geoms.addSphere({id:"XYZ",radius:n>10?10:n,origin:i,color:uf.WHITE.withAlpha(.1),depthTest:t.mode===SLe.ROTATION,properties:{name:"XYZ"}});e.primitive=r}}else{var a,o=[];t.mode===SLe.ROTATION?(a=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:64,i=[],n=360/t,r=-45;r<=315;){var a=I.toRadians(r);i.push(new Rt(e*Math.cos(a),e*Math.sin(a))),r+=n}return i}(t._axisLength/2),"X"===e.name?a.forEach((function(e){o.push(new z(0,e.x,e.y))})):"Y"===e.name?a.forEach((function(e){o.push(new z(e.x,0,e.y))})):"Z"===e.name&&a.forEach((function(e){o.push(new z(e.x,e.y,0))}))):o=[new z(0,0,0),z.multiplyByScalar(e.unit,t._axisLength,new z)];var s=t._geoms.addPolyline({id:e.name,positions:o,origin:i,color:e.color,style:"arrow",depthTest:2==transform.value,width:t._axisWidth,properties:{name:e.name}});e.primitive=s}}))}}},{key:"initHandlerEvent",value:function(){var e,t,i,n,r,a,o,s,c=this,l=this._viewer,h=!1,d=!1,f=new z,p=new Be;this._handler.setInputAction((function(t){u.a(r)?(c._currentAxis=c._axes[r].unit,"XYZ"===c._axes[r].name&&(d=!0),o=c._currentSelectedObject.boundingSphere.center,s=l.cesiumViewer.camera.directionWC,e=UAe.getIntersectionByRayAndPlane(l.cesiumViewer.scene.camera.getPickRay(t.position),o,s),i=xa.eastNorthUpToFixedFrame(o),n=Be.inverse(i,new Be),h=!0,c.dragStart.raiseEvent()):(d=!1,h=!1)}),TS.LEFT_DOWN);var m=new z,_=new z;this._handler.setInputAction((function(i){if(h){var g=c._currentSelectedObject;if(t=UAe.getIntersectionByRayAndPlane(l.cesiumViewer.scene.camera.getPickRay(i.endPosition),o,s)){if(e&&t&&!e.equals(t))if(_=z.subtract(t,e,_),Be.multiplyByPoint(n,l.cesiumViewer.scene.camera.positionWC,m),Be.multiplyByPointAsVector(n,_,_),c.mode===SLe.ROTATION){d&&z.cross(_,m,c._currentAxis);var v=z.dot(_,z.normalize(z.cross(c._currentAxis,m,f),f));g.rotate(z.multiplyByScalar(c._currentAxis,v*c._rotationSpeed,new z))}else if(c.mode===SLe.TRANSLATE)d||z.projectVector(_,c._currentAxis,_),g.translate(_),p=Be.fromTranslation(_),c._axes.forEach((function(e){Be.multiply(e.primitive.modelMatrix,p,e.primitive.modelMatrix)}));else if(c.mode===SLe.SCALE){var b,y=z.magnitude(_)*c._scaleFactor;z.dot(_,c._currentAxis,new z)<0&&(y*=-1),b=new z(y+1,y+1,y+1),g.scale(b)}e=t}}else{var w=l.pick(i.endPosition,c._project);if(w&&w.geometryId)if(a){if(a.geometryId!==w.geometryId){c._axes[r].primitive.appearance.material&&(c._axes[r].primitive.appearance.material.uniforms.color=c._axes[r].color);var O=c._geoms.getPropertiesById(w.geometryId);if(a=w,O)for(var x=0;x<c._axes.length;x++)if(c._axes[x].name===O.name){r=x;var E=c._axes[x].primitive;E.appearance.material&&(E.appearance.material.uniforms.color=c._axes[x].hover);break}}}else{var T=c._geoms.getPropertiesById(w.geometryId);if(a=w,T)for(var C=0;C<c._axes.length;C++)if(c._axes[C].name===T.name){r=C;var S=c._axes[C].primitive;S.appearance.material&&(S.appearance.material.uniforms.color=c._axes[C].hover);break}}else u.a(r)&&(c._axes[r].primitive.appearance.material&&(c._axes[r].primitive.appearance.material.uniforms.color=c._axes[r].color),r=void 0,a=void 0)}}),TS.MOUSE_MOVE),this._handler.setInputAction((function(i){h&&(c.addHistory("transform"),h=!1,e=void 0,t=void 0,d=!1,c._currentSelectedObject&&(c._currentSelectedObject.updateBoundingSphere(),c._modifiedComponents[c._currentSelectedObject.guid]=c._currentSelectedObject),c.dragEnd.raiseEvent())}),TS.LEFT_UP),document.addEventListener("keydown",this.keyPress.bind(this))}},{key:"undo",value:function(){this._history.undo()}},{key:"redo",value:function(){this._history.redo()}},{key:"keyPress",value:function(e){90==e.keyCode&&e.ctrlKey?(console.log("undo"),this.undo()):89==e.keyCode&&e.ctrlKey&&(console.log("redo"),this.redo())}},{key:"saveToServer",value:function(){var e=this,t={projectId:this._project.guid,version:this._project.version,lightAssemblies:[]},i=this._project,n=this._modifiedComponents;for(var r in n){var a=n[r];if(a instanceof XIe){var o=new Array(16);Be.pack(a._externalMatrix,o,0),t.lightAssemblies.push({id:a.parentAssembly.id,version:a.parentAssembly.version,matrix:o})}else if("cluster"==a._assemblyType){var s=new Array(16),c=Be.transpose(a._primitives[0]._externalMatrix,new Be);Be.pack(c,s,0);var l=LLe(a.project._clusterList,"id",a._primitives[0].assemblyId),u=a.project._clusterList[l],h=LLe(t.lightAssemblies,"id",u.id);h>-1?t.lightAssemblies[h].updateCluster?t.lightAssemblies[h].updateCluster.push({guid:a.guid,matrix:s}):t.lightAssemblies[h].updateCluster=[{guid:a.guid,matrix:s}]:t.lightAssemblies.push({id:u.id,version:u.version,updateCluster:[{guid:a.guid,matrix:s}]})}else a._primitives.forEach((function(e){var i=new Array(16);Be.pack(e._externalMatrix,i,0),t.lightAssemblies.push({id:e.id,version:e.version,matrix:i})}))}console.log(t);var d=XIe.lightUpdate(t);return new Promise((function(t,r){d.then((function(r){console.log(r),r.projectId===i.guid&&(i._version=r.version);for(var a=function(e){var t=r.assemblies[e];if("PROJ_PROVIDER"===t.type)for(var a in n){var o=n[a];if(o.parentAssembly.id===t.id){o.parentAssembly.version=t.version;break}}else if("CLUSTER"===t.type){var s=LLe(i._clusterList,"id",t.id);i._clusterList[s].version=t.version,i._clusterList[s].cluster.forEach((function(e){e._primitives.forEach((function(e){e.version=t.version}))}))}else for(var c in n){var l=n[c];if(l instanceof mIe)for(var u=0;u<l._primitives.length;u++){var h=l._primitives[u];if(h.id===t.id){h.version=t.version;break}}}},o=0;o<r.assemblies.length;o++)a(o);e.history.clear(),t(n)})).otherwise((function(e){return r(e)}))}))}},{key:"isDestroyed",value:function(){return!1}},{key:"destroy",value:function(){document.removeEventListener("keydown",(function(e){90==evtobj.keyCode&&evtobj.ctrlKey&&alert("Ctrl+z")}))}},{key:"mode",get:function(){return this._mode},set:function(e){this._mode!==e&&(this._mode=e,this._geoms.removeAll(),this._currentSelectedObject&&this.createAxis(this._currentSelectedObject),this.modechange.raiseEvent(),this.addHistory("mode"))}},{key:"object",get:function(){return this._currentSelectedObject}},{key:"history",get:function(){return this._history}}])&&MLe(t.prototype,i),n&&MLe(t,n),e}();UAe.setBaseUrl();try{console.info("motor version is","2.3.8-2020-5-21-16:51:45")}catch(e){console.error("测试版本")}var FLe={Viewer:UDe,ViewerMode:YAe,NavigationMode:ZAe,ClippingPlaneEditor:lje,AutoRoamManager:hje,RoamEditor:LPe,Util:UAe,BingMapStyle:fje,BingMap:vje,TiandituMap:tDe,ArcGISMap:xje,WebMapTileService:jIe,WebMapService:Aje,BaseMap:TIe,MapCollection:MDe,Color:Lje,InfoField:BPe,ProjectService:wIe,ComponentService:YPe,App:aDe,ServiceConfig:FPe,Matrix4:Vje,Cartesian3:XDe,Cartographic:tMe,DynamicCircle:oMe,Cartesian2:Xje,MarkerCollection:fMe,MarkerView:nDe,Component:mIe,Project:XIe,ProjType:ZPe,MeasureEditor:jMe,MeasureMode:gMe,TiandituMapStyle:QIe,TilingScheme:xIe,MouseEventType:lDe,AnimationPlayer:jPe,CIMControlMode:KAe,GeometryCollection:mMe,ParticleSystem:UMe,BoxEmitter:WMe,CircleEmitter:KMe,ConeEmitter:iRe,SphereEmitter:sRe,CommentEditor:TLe,SkyBox:ADe,Config:new Fje,_Cesium:r,_Luban:a,TrustedServers:oI.a,KeyboardEventModifier:RMe,AvatarControls:IPe,SceneEditor:NLe,EditMode:SLe},kLe=t.default=FLe}]).default}));